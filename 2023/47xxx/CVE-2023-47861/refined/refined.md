- **Root cause of vulnerability:** Improper sanitization of the user name within the `channelBody.php` file. Specifically, the application uses `strip_tags` to remove HTML tags from the user's name. However, the user name is placed within the `alt` attribute of an `<img>` tag, allowing an attacker to inject JavaScript event handlers (like `onload`) without using HTML tags, which bypasses `strip_tags`.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to insufficient input sanitization. The vulnerability is a stored XSS since the malicious payload is stored within the user's profile.
- **Impact of exploitation:** Arbitrary Javascript execution. Attackers could potentially take over an administrator account by tricking them into visiting a crafted URL, or perform other malicious actions via Javascript.
- **Attack vectors:** A specially crafted HTTP request to modify a user's profile with a malicious user name, and a crafted URL to trigger the exploit.
- **Required attacker capabilities/position:** An attacker needs to have a user account and be able to modify their username. They also need to lure another user (possibly an admin) into viewing a page that triggers the stored XSS.