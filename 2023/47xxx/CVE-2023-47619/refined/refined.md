The provided content describes two vulnerabilities in audiobookshelf:

**Issue 1: SSRF and Arbitrary File Read/Deletion in `AuthorController.js` (GHSL-2023-203)**

*   **Root Cause:**  The `imagePath` from the request body is used without sufficient sanitization in the `AuthorController.js` file. This allows an attacker to control the path used for various operations.
*   **Weaknesses:**
    *   **Server-Side Request Forgery (SSRF):**  The application makes a GET request to a URL provided by the user in the `imagePath` parameter.
    *   **Arbitrary File Read (AFR):** The application checks if a file exists based on user-supplied `imagePath` value without validation. If a local path is specified it will be checked and it's existence verified before being returned.
    *   **Arbitrary File Deletion (AFD):** The application uses the user-supplied `imagePath` to delete a file via `CoverManager.removeFile`.
*  **Impact:**
    *   **Information Disclosure:** An attacker can read local files from the server and make requests to arbitrary URLs and read the response.
    *   **Arbitrary File Deletion**: An attacker can delete files on the server.
*   **Attack Vectors:**
    *   **SSRF:** Send a PATCH request to `/api/authors/author-id` with an `imagePath` starting with `http` containing a malicious URL.
    *   **AFR:** Send a PATCH request to `/api/authors/author-id` with an `imagePath` containing a path to a local file.
    *   **AFD:** Send a PATCH request to `/api/authors/author-id` with an `imagePath` containing a path to the local file to delete. Then, send another PATCH request to `/api/authors/author-id` with an empty `imagePath`.
*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to have `update` permissions on the author.

**Issue 2: Arbitrary File Read in `HlsRouter.js` (GHSL-2023-204)**

*   **Root Cause:** Path traversal vulnerability in the `/hls` endpoint due to insufficient sanitization of `req.params.file`.
*   **Weaknesses:**
    *   **Path Traversal:** The application uses `Path.join` to combine the `StreamsPath`, `streamId`, and the user-controlled `file` parameter from `req.params.file` to construct a file path, allowing traversal outside the intended directory.
*   **Impact:**
    *   **Information Disclosure:** An attacker can read any file on the server's file system that the application has permissions to access.
*   **Attack Vectors:** Send a GET request to `/hls/whatever/..%2F..%2F..%2F..%2F..%2F..%2F(url encoded full path here)` using URL-encoded forward slashes to traverse directories and specify the path of the file to read.
*   **Required Attacker Capabilities/Position:**
    *   Any user, regardless of their permissions.

These issues were discovered using CodeQL queries for SSRF and Path Injection. The advisory states that the issues were found in version `v2.4.3` of audiobookshelf.