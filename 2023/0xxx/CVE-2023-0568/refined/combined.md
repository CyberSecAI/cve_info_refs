=== Content from github.com_4b8e05be_20250115_125422.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fsecurity%2Fadvisories)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fsecurity%2Fadvisories)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Findex&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

# Security: php/php-src

## Security Navigation

* [Overview](/php/php-src/security)
* ### Reporting

  + [Policy](/php/php-src/security/policy)
  + [Advisories](/php/php-src/security/advisories)

## Security Advisories

View known security vulnerabilities and report new vulnerabilities privately to maintainers.
  [Report a vulnerability](/php/php-src/security/advisories/new)

* [Heap-Use-After-Free in sapi\_read\_post\_data Processing in CLI SAPI Interface](/php/php-src/security/advisories/GHSA-4w77-75f9-2c8w)
  GHSA-4w77-75f9-2c8w
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  Low
* [Single byte overread with convert.quoted-printable-decode filter](/php/php-src/security/advisories/GHSA-r977-prxv-hc43)
  GHSA-r977-prxv-hc43
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  Moderate
* [Integer overflow in the firebird and dblib quoters causing OOB writes](/php/php-src/security/advisories/GHSA-5hqh-c84r-qjcv)
  GHSA-5hqh-c84r-qjcv
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  Moderate
* [Configuring a proxy in a stream context might allow for CRLF injection in URIs](/php/php-src/security/advisories/GHSA-c5f2-jwm7-mmq2)
  GHSA-c5f2-jwm7-mmq2
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  Moderate
* [OOB access in ldap\_escape](/php/php-src/security/advisories/GHSA-g665-fm4p-vhff)
  GHSA-g665-fm4p-vhff
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  Moderate
* [[Mysqlnd] Leak partial content of the heap through heap buffer over-read](/php/php-src/security/advisories/GHSA-h35g-vwh6-m678)
  GHSA-h35g-vwh6-m678
  published
  Nov 21, 2024
  by
  [bukka](/bukka)

  High
* [[PHP-FPM] Logs from childrens may be altered](/php/php-src/security/advisories/GHSA-865w-9rf3-2wh5)
  GHSA-865w-9rf3-2wh5
  published
  Sep 27, 2024
  by
  [bukka](/bukka)

  Low
* [Erroneous parsing of multipart form data](/php/php-src/security/advisories/GHSA-9pqp-7h25-4f32)
  GHSA-9pqp-7h25-4f32
  published
  Sep 27, 2024
  by
  [bukka](/bukka)

  Low
* [PHP CGI Parameter Injection Vulnerability (CVE-2024-4577 bypass)](/php/php-src/security/advisories/GHSA-p99j-rfp4-xqvq)
  GHSA-p99j-rfp4-xqvq
  published
  Sep 27, 2024
  by
  [bukka](/bukka)

  Moderate
* [cgi.force\_redirect configuration is bypassable due to the environment variable collision](/php/php-src/security/advisories/GHSA-94p6-54jq-9mwp)
  GHSA-94p6-54jq-9mwp
  published
  Sep 27, 2024
  by
  [bukka](/bukka)

  Moderate

Previous *1* [2](/php/php-src/security/advisories?page=2) [3](/php/php-src/security/advisories?page=3) [Next](/php/php-src/security/advisories?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_a52dee7a_20250114_224926.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [February 2023 PHP Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20230517-0001)

## February 2023 PHP Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230517-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230517-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230517-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230517-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230517-0001
**Version:**
7.0

**Last updated:**
09/05/2023

**Status:**
Final.

**CVEs:** CVE-2023-0662, CVE-2023-0568

Overview
#### Summary

Multiple NetApp products incorporate PHP. PHP versions 8.0.0 prior to 8.0.28, 8.1.0 prior to 8.1.16, and 8.2.0 prior to 8.2.3 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-0568](https://nvd.nist.gov/vuln/detail/CVE-2023-0568) | 8.1 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2023-0662](https://nvd.nist.gov/vuln/detail/CVE-2023-0662) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/php/php-src/security/advisories/GHSA-54hq-v5wp-fqgv>
* <https://bugs.php.net/bug.php?id=81746>

Affected Products
#### Affected Products

* ONTAP 9 (formerly Clustered Data ONTAP)

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800/C800/A150
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **ONTAP 9 (formerly Clustered Data ONTAP)** | <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.7P23> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.8P20> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.9.1P17> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.10.1P14> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.11.1P8> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.12.1P3> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.13.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230517-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230517 | Initial Public Release, Final status |
| 2.0 | 20230519 | ONTAP 9 (formerly Clustered Data ONTAP) 9.12.1P3 added to Software Versions and Fixes |
| 3.0 | 20230627 | ONTAP 9 (formerly Clustered Data ONTAP) 9.13.1 added to Software Versions and Fixes |
| 4.0 | 20230728 | ONTAP 9 (formerly Clustered Data ONTAP) 9.7P28 added to Software Versions and Fixes |
| 5.0 | 20230821 | Changed CVE-2023-0568 CVSS to align to NVD change by request |
| 6.0 | 20230822 | ONTAP 9 (formerly Clustered Data ONTAP) 9.10.1P14 added to Software Versions and Fixes |
| 7.0 | 20230905 | ONTAP 9 (formerly Clustered Data ONTAP) 9.9.1P17 and 9.8P20 added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_7cd39f0b_20250115_125406.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fissues%2F9903)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fissues%2F9903)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# realpath and readfile (and probably others in zend\_virtual\_cwd) fail with valid path of length 4095 #9903

Closed

[SlivTaMere](/SlivTaMere) opened this issue
Nov 8, 2022
· 8 comments

Closed

# [realpath and readfile (and probably others in zend\_virtual\_cwd) fail with valid path of length 4095](#top) #9903

[SlivTaMere](/SlivTaMere) opened this issue
Nov 8, 2022
· 8 comments

Labels
[Bug](/php/php-src/labels/Bug)
[Category: Engine](/php/php-src/labels/Category%3A%20Engine)
[Status: Won't Fix](/php/php-src/labels/Status%3A%20Won%27t%20Fix)

## Comments

[![@SlivTaMere](https://avatars.githubusercontent.com/u/6403685?s=80&v=4)](/SlivTaMere)

Copy link

### **[SlivTaMere](/SlivTaMere)** commented [Nov 8, 2022](#issue-1440019913) • edited Loading

| Description The following code:  ``` <?php $p = "/bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/../bin/sh"; var_dump(PHP_MAXPATHLEN); var_dump(strlen($p)); var_dump(file_exists($p)); var_dump(realpath($p)); ```  Resulted in this output:  ``` int(4096) int(4095) bool(true) bool(false)  ```  But I expected this output instead:  ``` int(4096) int(4095) bool(true) string(7) "/bin/sh" //or similar  ```  I didn't dig much but I think the issue is at [Zend/zend\_virtual\_cwd.c](https://github.com/php/php-src/blob/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c#L1025)  , a path of length 4095 should be accepted as it is the case with file\_exists() and stat family functions.  I didn't test with PHP 8 but probably has the same issue. PHP Version PHP 7.4.33 Operating System Ubuntu 18.04.6 |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@SlivTaMere](https://avatars.githubusercontent.com/u/6403685?s=40&v=4)](/SlivTaMere)
[SlivTaMere](/SlivTaMere)
added
[Bug](/php/php-src/labels/Bug)
[Status: Needs Triage](/php/php-src/labels/Status%3A%20Needs%20Triage)
labels
[Nov 8, 2022](#event-7761779015)

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=80&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)

Copy link

Member

### **[cmb69](/cmb69)** commented [Nov 8, 2022](#issuecomment-1307191637)

| On non Windows systems, PHP defines its `MAXPATHLEN` according to POSIX's `PATH_MAX` or `MAX_PATH` if available:     [php-src/Zend/zend\_virtual\_cwd.h](https://github.com/php/php-src/blob/b3f3414ce9982b7fc7ee799f97a26fcc9890f698/Zend/zend_virtual_cwd.h#L39-L50)  Lines 39 to 50 in [b3f3414](/php/php-src/commit/b3f3414ce9982b7fc7ee799f97a26fcc9890f698)   |  | #ifndef MAXPATHLEN | | --- | --- | |  | # if \_WIN32 | |  | # include "win32/ioutil.h" | |  | # define MAXPATHLEN PHP\_WIN32\_IOUTIL\_MAXPATHLEN | |  | # elif PATH\_MAX | |  | # define MAXPATHLEN PATH\_MAX | |  | # elif defined(MAX\_PATH) | |  | # define MAXPATHLEN MAX\_PATH | |  | # else | |  | # define MAXPATHLEN 256 | |  | # endif | |  | #endif |      These are not unlikely to default to 4096 bytes (or even less), and I don't think there is anything we can do. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)
[cmb69](/cmb69)
added
the
[Category: Engine](/php/php-src/labels/Category%3A%20Engine)
label
[Nov 8, 2022](#event-7762598268)

[![@SlivTaMere](https://avatars.githubusercontent.com/u/6403685?s=80&v=4)](/SlivTaMere)

Copy link

Author

### **[SlivTaMere](/SlivTaMere)** commented [Nov 9, 2022](#issuecomment-1308134631) • edited Loading

| The issue I'm trying to convey is that realpath() and similar functions don't work with a valid path of 4095 (MAX\_PATH-1) whereas functions like file\_exists() do succeed.  This might lead to unexpected behavior where file\_exists() and is\_readable() return true but realpath() and readfile() will fail and return false. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tontyna](https://avatars.githubusercontent.com/u/35614937?s=80&v=4)](/Tontyna)

Copy link

### **[Tontyna](/Tontyna)** commented [Jan 10, 2023](#issuecomment-1376813826)

| [@SlivTaMere](https://github.com/SlivTaMere) is right, the comparison in   [php-src/Zend/zend\_virtual\_cwd.c](https://github.com/php/php-src/blob/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c#L1025)  Line 1025 in [c40dcf9](/php/php-src/commit/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd)   |  | if (!path\_length || path\_length >= MAXPATHLEN-1) { | | --- | --- |    should be   ``` if (!path_length || path_length+1 >= MAXPATHLEN-1) { ```  We need 1 byte for the null-termination, not 2. |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=80&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)

Copy link

Member

### **[cmb69](/cmb69)** commented [Jan 10, 2023](#issuecomment-1377003940)

| ``` if (!path_length || path_length+1 >= MAXPATHLEN-1) { ```  That would basically be equivalent to  ``` if (!path_length || path_length >= MAXPATHLEN-2) { ```  so the path would even have to be shorter. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tontyna](https://avatars.githubusercontent.com/u/35614937?s=80&v=4)](/Tontyna)

Copy link

### **[Tontyna](/Tontyna)** commented [Jan 10, 2023](#issuecomment-1377243287) • edited Loading

| Upps, of course you are right. Alt+Backspace, undo, ignore...  It's actually   [php-src/Zend/zend\_virtual\_cwd.c](https://github.com/php/php-src/blob/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c#L1074)  Line 1074 in [c40dcf9](/php/php-src/commit/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd)   |  | if (path\_length + state\_cwd\_length + 1 >= MAXPATHLEN-1) { | | --- | --- |      getting it wrong.  Nah, should read the complete code before telling things. Sorry for the noise. |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=80&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)

Copy link

Member

### **[cmb69](/cmb69)** commented [Jan 10, 2023](#issuecomment-1377274325)

| Nah, should read the complete code before telling things.  Hmm, not sure. It seems that `+1` is for the trailing slash, but if it is already there, its length shouldn't be added for that check. |
| --- |

All reactions

Sorry, something went wrong.

[![@iluuu1994](https://avatars.githubusercontent.com/u/1752683?s=80&v=4)](/iluuu1994)

Copy link

Member

### **[iluuu1994](/iluuu1994)** commented [Mar 30, 2023](#issuecomment-1490216040)

| Various checks fail, like `path_length >= MAXPATHLEN-1`. I'm not exactly sure why `>=` instead of just `>`. It also seems like `virtual_file_ex()` (which I don't understand because it's horribly complex) also seems to require a few bytes to move things around. I don't think making big changes to that function is worth the hassle. |
| --- |

All reactions

Sorry, something went wrong.

[![@iluuu1994](https://avatars.githubusercontent.com/u/1752683?s=80&v=4)](/iluuu1994)

Copy link

Member

### **[iluuu1994](/iluuu1994)** commented [Mar 30, 2023](#issuecomment-1490232867) • edited Loading

| [@nielsdos](https://github.com/nielsdos) also just mentioned that there was a security issue in that code recently, which confirms the fact that we shouldn't touch that code. PHP requiring a few bytes from `MAXPATHLEN` for path resolution doesn't seem like a big deal. It's not great that there are inconsistencies across functions but it's not worth opening a can of worms. |
| --- |

All reactions

Sorry, something went wrong.

[![@iluuu1994](https://avatars.githubusercontent.com/u/1752683?s=40&v=4)](/iluuu1994)
[iluuu1994](/iluuu1994)
closed this as [not planned](/php/php-src/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3A%22not+planned%22)
Won't fix, can't repro, duplicate, stale
[Mar 30, 2023](#event-8887050285)

[![@iluuu1994](https://avatars.githubusercontent.com/u/1752683?s=40&v=4)](/iluuu1994)
[iluuu1994](/iluuu1994)
added
[Status: Won't Fix](/php/php-src/labels/Status%3A%20Won%27t%20Fix)
and removed
[Status: Needs Triage](/php/php-src/labels/Status%3A%20Needs%20Triage)
labels
[Mar 30, 2023](#event-8887055781)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fissues%2F9903)

Assignees

No one assigned

Labels

[Bug](/php/php-src/labels/Bug)
[Category: Engine](/php/php-src/labels/Category%3A%20Engine)
[Status: Won't Fix](/php/php-src/labels/Status%3A%20Won%27t%20Fix)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@iluuu1994](https://avatars.githubusercontent.com/u/1752683?s=52&v=4)](/iluuu1994) [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=52&v=4)](/cmb69) [![@SlivTaMere](https://avatars.githubusercontent.com/u/6403685?s=52&v=4)](/SlivTaMere) [![@Tontyna](https://avatars.githubusercontent.com/u/35614937?s=52&v=4)](/Tontyna)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6b8e4c26_20250115_125420.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fc40dcf93d0b95d9a1026476b202f5aa965fb3fdd%2FZend%2Fzend_virtual_cwd.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fc40dcf93d0b95d9a1026476b202f5aa965fb3fdd%2FZend%2Fzend_virtual_cwd.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Files

 c40dcf9
## Breadcrumbs

1. [php-src](/php/php-src/tree/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd)
2. /[Zend](/php/php-src/tree/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend)
/
# zend\_virtual\_cwd.c

Copy path Blame  Blame
## Latest commit

## History

[History](/php/php-src/commits/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c)1750 lines (1532 loc) · 42.7 KB c40dcf9
## Breadcrumbs

1. [php-src](/php/php-src/tree/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd)
2. /[Zend](/php/php-src/tree/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend)
/
# zend\_virtual\_cwd.c

Top
## File metadata and controls

* Code
* Blame

1750 lines (1532 loc) · 42.7 KB[Raw](https://github.com/php/php-src/raw/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\* +----------------------------------------------------------------------+ | PHP Version 7 | +----------------------------------------------------------------------+ | Copyright (c) The PHP Group | +----------------------------------------------------------------------+ | This source file is subject to version 3.01 of the PHP license, | | that is bundled with this package in the file LICENSE, and is | | available through the world-wide-web at the following url: | | http://www.php.net/license/3\_01.txt | | If you did not receive a copy of the PHP license and are unable to | | obtain it through the world-wide-web, please send a note to | | license@php.net so we can mail you a copy immediately. | +----------------------------------------------------------------------+ | Authors: Andi Gutmans <andi@php.net> | | Sascha Schumann <sascha@schumann.cx> | | Pierre Joye <pierre@php.net> | +----------------------------------------------------------------------+\*/
#include <sys/types.h>#include <sys/stat.h>#include <string.h>#include <stdio.h>#include <limits.h>#include <errno.h>#include <stdlib.h>#include <fcntl.h>#include <time.h>
#include "zend.h"#include "zend\_virtual\_cwd.h"
#ifdef ZEND\_WIN32#include <io.h>#include "tsrm\_win32.h"# ifndef IO\_REPARSE\_TAG\_SYMLINK# define IO\_REPARSE\_TAG\_SYMLINK 0xA000000C# endif
# ifndef IO\_REPARSE\_TAG\_DEDUP# define IO\_REPARSE\_TAG\_DEDUP 0x80000013# endif
# ifndef IO\_REPARSE\_TAG\_CLOUD# define IO\_REPARSE\_TAG\_CLOUD (0x9000001AL)# endif/\* IO\_REPARSE\_TAG\_CLOUD\_1 through IO\_REPARSE\_TAG\_CLOUD\_F have values of 0x9000101AL to 0x9000F01AL, they can be checked against the mask. \*/#ifndef IO\_REPARSE\_TAG\_CLOUD\_MASK#define IO\_REPARSE\_TAG\_CLOUD\_MASK (0x0000F000L)#endif
#ifndef IO\_REPARSE\_TAG\_ONEDRIVE#define IO\_REPARSE\_TAG\_ONEDRIVE (0x80000021L)#endif
# ifndef IO\_REPARSE\_TAG\_ACTIVISION\_HSM# define IO\_REPARSE\_TAG\_ACTIVISION\_HSM (0x00000047L)# endif
# ifndef IO\_REPARSE\_TAG\_PROJFS# define IO\_REPARSE\_TAG\_PROJFS (0x9000001CL)# endif
# ifndef VOLUME\_NAME\_NT# define VOLUME\_NAME\_NT 0x2# endif
# ifndef VOLUME\_NAME\_DOS# define VOLUME\_NAME\_DOS 0x0# endif
# include <winioctl.h># include <winnt.h>#endif
#ifndef HAVE\_REALPATH#define realpath(x,y) strcpy(y,x)#endif
#define VIRTUAL\_CWD\_DEBUG 0
#include "TSRM.h"
/\* Only need mutex for popen() in Windows because it doesn't chdir() on UNIX \*/#if defined(ZEND\_WIN32) && defined(ZTS)MUTEX\_T cwd\_mutex;#endif
#ifdef ZTSts\_rsrc\_id cwd\_globals\_id;size\_t cwd\_globals\_offset;#elsevirtual\_cwd\_globals cwd\_globals;#endif
static cwd\_state main\_cwd\_state; /\* True global \*/
#ifndef ZEND\_WIN32#include <unistd.h>#else#include <direct.h>#include "zend\_globals.h"#include "zend\_globals\_macros.h"#endif
#define CWD\_STATE\_COPY(d, s) \ (d)->cwd\_length = (s)->cwd\_length; \ (d)->cwd = (char \*) emalloc((s)->cwd\_length+1); \ memcpy((d)->cwd, (s)->cwd, (s)->cwd\_length+1);
#define CWD\_STATE\_FREE(s) \ efree((s)->cwd); \ (s)->cwd\_length = 0;
#ifdef ZEND\_WIN32# define CWD\_STATE\_FREE\_ERR(state) do { \ DWORD last\_error = GetLastError(); \ CWD\_STATE\_FREE(state); \ SetLastError(last\_error); \ } while (0)#else# define CWD\_STATE\_FREE\_ERR(state) CWD\_STATE\_FREE(state)#endif
static int php\_is\_dir\_ok(const cwd\_state \*state) /\* {{{ \*/{ zend\_stat\_t buf;
 if (php\_sys\_stat(state->cwd, &buf) == 0 && S\_ISDIR(buf.st\_mode)) return (0);
 return (1);}/\* }}} \*/
static int php\_is\_file\_ok(const cwd\_state \*state) /\* {{{ \*/{ zend\_stat\_t buf;
 if (php\_sys\_stat(state->cwd, &buf) == 0 && S\_ISREG(buf.st\_mode)) return (0);
 return (1);}/\* }}} \*/
static void cwd\_globals\_ctor(virtual\_cwd\_globals \*cwd\_g) /\* {{{ \*/{ CWD\_STATE\_COPY(&cwd\_g->cwd, &main\_cwd\_state); cwd\_g->realpath\_cache\_size = 0; cwd\_g->realpath\_cache\_size\_limit = REALPATH\_CACHE\_SIZE; cwd\_g->realpath\_cache\_ttl = REALPATH\_CACHE\_TTL; memset(cwd\_g->realpath\_cache, 0, sizeof(cwd\_g->realpath\_cache));}/\* }}} \*/
static void realpath\_cache\_clean\_helper(uint32\_t max\_entries, realpath\_cache\_bucket \*\*cache, zend\_long \*cache\_size){ uint32\_t i;
 for (i = 0; i < max\_entries; i++) { realpath\_cache\_bucket \*p = cache[i]; while (p != NULL) { realpath\_cache\_bucket \*r = p; p = p->next; free(r); } cache[i] = NULL; } \*cache\_size = 0;}
static void cwd\_globals\_dtor(virtual\_cwd\_globals \*cwd\_g) /\* {{{ \*/{ realpath\_cache\_clean\_helper(sizeof(cwd\_g->realpath\_cache)/sizeof(cwd\_g->realpath\_cache[0]), cwd\_g->realpath\_cache, &cwd\_g->realpath\_cache\_size);}/\* }}} \*/
void virtual\_cwd\_main\_cwd\_init(uint8\_t reinit) /\* {{{ \*/{ char cwd[MAXPATHLEN]; char \*result;
 if (reinit) { free(main\_cwd\_state.cwd); }
#ifdef ZEND\_WIN32 ZeroMemory(&cwd, sizeof(cwd)); result = php\_win32\_ioutil\_getcwd(cwd, sizeof(cwd));#else result = getcwd(cwd, sizeof(cwd));#endif
 if (!result) { cwd[0] = '\0'; }
 main\_cwd\_state.cwd\_length = strlen(cwd);#ifdef ZEND\_WIN32 if (main\_cwd\_state.cwd\_length >= 2 && cwd[1] == ':') { cwd[0] = toupper(cwd[0]); }#endif main\_cwd\_state.cwd = strdup(cwd);}/\* }}} \*/
CWD\_API void virtual\_cwd\_startup(void) /\* {{{ \*/{ virtual\_cwd\_main\_cwd\_init(0);#ifdef ZTS ts\_allocate\_fast\_id(&cwd\_globals\_id, &cwd\_globals\_offset, sizeof(virtual\_cwd\_globals), (ts\_allocate\_ctor) cwd\_globals\_ctor, (ts\_allocate\_dtor) cwd\_globals\_dtor);#else cwd\_globals\_ctor(&cwd\_globals);#endif
#if (defined(ZEND\_WIN32)) && defined(ZTS) cwd\_mutex = tsrm\_mutex\_alloc();#endif}/\* }}} \*/
CWD\_API void virtual\_cwd\_shutdown(void) /\* {{{ \*/{#ifndef ZTS cwd\_globals\_dtor(&cwd\_globals);#endif#if (defined(ZEND\_WIN32)) && defined(ZTS) tsrm\_mutex\_free(cwd\_mutex);#endif
 free(main\_cwd\_state.cwd); /\* Don't use CWD\_STATE\_FREE because the non global states will probably use emalloc()/efree() \*/}/\* }}} \*/
CWD\_API int virtual\_cwd\_activate(void) /\* {{{ \*/{ if (CWDG(cwd).cwd == NULL) { CWD\_STATE\_COPY(&CWDG(cwd), &main\_cwd\_state); } return 0;}/\* }}} \*/
CWD\_API int virtual\_cwd\_deactivate(void) /\* {{{ \*/{ if (CWDG(cwd).cwd != NULL) { CWD\_STATE\_FREE(&CWDG(cwd)); CWDG(cwd).cwd = NULL; } return 0;}/\* }}} \*/
CWD\_API char \*virtual\_getcwd\_ex(size\_t \*length) /\* {{{ \*/{ cwd\_state \*state;
 state = &CWDG(cwd);
 if (state->cwd\_length == 0) { char \*retval;
 \*length = 1; retval = (char \*) emalloc(2); retval[0] = DEFAULT\_SLASH; retval[1] = '\0'; return retval; }
#ifdef ZEND\_WIN32 /\* If we have something like C: \*/ if (state->cwd\_length == 2 && state->cwd[state->cwd\_length-1] == ':') { char \*retval;
 \*length = state->cwd\_length+1; retval = (char \*) emalloc(\*length+1); memcpy(retval, state->cwd, \*length); retval[0] = toupper(retval[0]); retval[\*length-1] = DEFAULT\_SLASH; retval[\*length] = '\0'; return retval; }#endif if (!state->cwd) { \*length = 0; return NULL; }
 \*length = state->cwd\_length; return estrdup(state->cwd);}/\* }}} \*/
/\* Same semantics as UNIX getcwd() \*/CWD\_API char \*virtual\_getcwd(char \*buf, size\_t size) /\* {{{ \*/{ size\_t length; char \*cwd;
 cwd = virtual\_getcwd\_ex(&length);
 if (buf == NULL) { return cwd; } if (length > size-1) { efree(cwd); errno = ERANGE; /\* Is this OK? \*/ return NULL; } if (!cwd) { return NULL; } memcpy(buf, cwd, length+1); efree(cwd); return buf;}/\* }}} \*/
#ifdef ZEND\_WIN32static inline zend\_ulong realpath\_cache\_key(const char \*path, size\_t path\_len) /\* {{{ \*/{ register zend\_ulong h; size\_t bucket\_key\_len; char \*bucket\_key\_start = tsrm\_win32\_get\_path\_sid\_key(path, path\_len, &bucket\_key\_len); char \*bucket\_key = (char \*)bucket\_key\_start; const char \*e;
 if (!bucket\_key) { return 0; }
 e = bucket\_key + bucket\_key\_len; for (h = Z\_UL(2166136261); bucket\_key < e;) { h \*= Z\_UL(16777619); h ^= \*bucket\_key++; } if (bucket\_key\_start != path) { HeapFree(GetProcessHeap(), 0, (LPVOID)bucket\_key\_start); } return h;}/\* }}} \*/#elsestatic inline zend\_ulong realpath\_cache\_key(const char \*path, size\_t path\_len) /\* {{{ \*/{ register zend\_ulong h; const char \*e = path + path\_len;
 for (h = Z\_UL(2166136261); path < e;) { h \*= Z\_UL(16777619); h ^= \*path++; }
 return h;}/\* }}} \*/#endif /\* defined(ZEND\_WIN32) \*/
CWD\_API void realpath\_cache\_clean(void) /\* {{{ \*/{ realpath\_cache\_clean\_helper(sizeof(CWDG(realpath\_cache))/sizeof(CWDG(realpath\_cache)[0]), CWDG(realpath\_cache), &CWDG(realpath\_cache\_size));}/\* }}} \*/
CWD\_API void realpath\_cache\_del(const char \*path, size\_t path\_len) /\* {{{ \*/{ zend\_ulong key = realpath\_cache\_key(path, path\_len); zend\_ulong n = key % (sizeof(CWDG(realpath\_cache)) / sizeof(CWDG(realpath\_cache)[0])); realpath\_cache\_bucket \*\*bucket = &CWDG(realpath\_cache)[n];
 while (\*bucket != NULL) { if (key == (\*bucket)->key && path\_len == (\*bucket)->path\_len && memcmp(path, (\*bucket)->path, path\_len) == 0) { realpath\_cache\_bucket \*r = \*bucket; \*bucket = (\*bucket)->next;
 /\* if the pointers match then only subtract the length of the path \*/ if(r->path == r->realpath) { CWDG(realpath\_cache\_size) -= sizeof(realpath\_cache\_bucket) + r->path\_len + 1; } else { CWDG(realpath\_cache\_size) -= sizeof(realpath\_cache\_bucket) + r->path\_len + 1 + r->realpath\_len + 1; }
 free(r); return; } else { bucket = &(\*bucket)->next; } }}/\* }}} \*/
static inline void realpath\_cache\_add(const char \*path, size\_t path\_len, const char \*realpath, size\_t realpath\_len, int is\_dir, time\_t t) /\* {{{ \*/{ zend\_long size = sizeof(realpath\_cache\_bucket) + path\_len + 1; int same = 1;
 if (realpath\_len != path\_len || memcmp(path, realpath, path\_len) != 0) { size += realpath\_len + 1; same = 0; }
 if (CWDG(realpath\_cache\_size) + size <= CWDG(realpath\_cache\_size\_limit)) { realpath\_cache\_bucket \*bucket = malloc(size); zend\_ulong n;
 if (bucket == NULL) { return; }
 bucket->key = realpath\_cache\_key(path, path\_len); bucket->path = (char\*)bucket + sizeof(realpath\_cache\_bucket); memcpy(bucket->path, path, path\_len+1); bucket->path\_len = path\_len; if (same) { bucket->realpath = bucket->path; } else { bucket->realpath = bucket->path + (path\_len + 1); memcpy(bucket->realpath, realpath, realpath\_len+1); } bucket->realpath\_len = realpath\_len; bucket->is\_dir = is\_dir > 0;#ifdef ZEND\_WIN32 bucket->is\_rvalid = 0; bucket->is\_readable = 0; bucket->is\_wvalid = 0; bucket->is\_writable = 0;#endif bucket->expires = t + CWDG(realpath\_cache\_ttl); n = bucket->key % (sizeof(CWDG(realpath\_cache)) / sizeof(CWDG(realpath\_cache)[0])); bucket->next = CWDG(realpath\_cache)[n]; CWDG(realpath\_cache)[n] = bucket; CWDG(realpath\_cache\_size) += size; }}/\* }}} \*/
static inline realpath\_cache\_bucket\* realpath\_cache\_find(const char \*path, size\_t path\_len, time\_t t) /\* {{{ \*/{ zend\_ulong key = realpath\_cache\_key(path, path\_len); zend\_ulong n = key % (sizeof(CWDG(realpath\_cache)) / sizeof(CWDG(realpath\_cache)[0])); realpath\_cache\_bucket \*\*bucket = &CWDG(realpath\_cache)[n];
 while (\*bucket != NULL) { if (CWDG(realpath\_cache\_ttl) && (\*bucket)->expires < t) { realpath\_cache\_bucket \*r = \*bucket; \*bucket = (\*bucket)->next;
 /\* if the pointers match then only subtract the length of the path \*/ if(r->path == r->realpath) { CWDG(realpath\_cache\_size) -= sizeof(realpath\_cache\_bucket) + r->path\_len + 1; } else { CWDG(realpath\_cache\_size) -= sizeof(realpath\_cache\_bucket) + r->path\_len + 1 + r->realpath\_len + 1; } free(r); } else if (key == (\*bucket)->key && path\_len == (\*bucket)->path\_len && memcmp(path, (\*bucket)->path, path\_len) == 0) { return \*bucket; } else { bucket = &(\*bucket)->next; } } return NULL;}/\* }}} \*/
CWD\_API realpath\_cache\_bucket\* realpath\_cache\_lookup(const char \*path, size\_t path\_len, time\_t t) /\* {{{ \*/{ return realpath\_cache\_find(path, path\_len, t);}/\* }}} \*/
CWD\_API zend\_long realpath\_cache\_size(void){ return CWDG(realpath\_cache\_size);}
CWD\_API zend\_long realpath\_cache\_max\_buckets(void){ return (sizeof(CWDG(realpath\_cache)) / sizeof(CWDG(realpath\_cache)[0]));}
CWD\_API realpath\_cache\_bucket\*\* realpath\_cache\_get\_buckets(void){ return CWDG(realpath\_cache);}
#undef LINK\_MAX#define LINK\_MAX 32
static size\_t tsrm\_realpath\_r(char \*path, size\_t start, size\_t len, int \*ll, time\_t \*t, int use\_realpath, int is\_dir, int \*link\_is\_dir) /\* {{{ \*/{ size\_t i, j; int directory = 0, save;#ifdef ZEND\_WIN32 WIN32\_FIND\_DATAW dataw; HANDLE hFind = INVALID\_HANDLE\_VALUE; ALLOCA\_FLAG(use\_heap\_large) wchar\_t \*pathw = NULL; int may\_retry\_reparse\_point;#define FREE\_PATHW() \ do { free(pathw); } while(0);
#else zend\_stat\_t st;#endif realpath\_cache\_bucket \*bucket; char \*tmp; ALLOCA\_FLAG(use\_heap)
 while (1) { if (len <= start) { if (link\_is\_dir) { \*link\_is\_dir = 1; } return start; }
 i = len; while (i > start && !IS\_SLASH(path[i-1])) { i--; } assert(i < MAXPATHLEN);
 if (i == len || (i + 1 == len && path[i] == '.')) { /\* remove double slashes and '.' \*/ len = EXPECTED(i > 0) ? i - 1 : 0; is\_dir = 1; continue; } else if (i + 2 == len && path[i] == '.' && path[i+1] == '.') { /\* remove '..' and previous directory \*/ is\_dir = 1; if (link\_is\_dir) { \*link\_is\_dir = 1; } if (i <= start + 1) { return start ? start : len; } j = tsrm\_realpath\_r(path, start, i-1, ll, t, use\_realpath, 1, NULL); if (j > start && j != (size\_t)-1) { j--; assert(i < MAXPATHLEN); while (j > start && !IS\_SLASH(path[j])) { j--; } assert(i < MAXPATHLEN); if (!start) { /\* leading '..' must not be removed in case of relative path \*/ if (j == 0 && path[0] == '.' && path[1] == '.' && IS\_SLASH(path[2])) { path[3] = '.'; path[4] = '.'; path[5] = DEFAULT\_SLASH; j = 5; } else if (j > 0 && path[j+1] == '.' && path[j+2] == '.' && IS\_SLASH(path[j+3])) { j += 4; path[j++] = '.'; path[j++] = '.'; path[j] = DEFAULT\_SLASH; } } } else if (!start && !j) { /\* leading '..' must not be removed in case of relative path \*/ path[0] = '.'; path[1] = '.'; path[2] = DEFAULT\_SLASH; j = 2; } return j; }
 path[len] = 0;
 save = (use\_realpath != CWD\_EXPAND);
 if (start && save && CWDG(realpath\_cache\_size\_limit)) { /\* cache lookup for absolute path \*/ if (!\*t) { \*t = time(0); } if ((bucket = realpath\_cache\_find(path, len, \*t)) != NULL) { if (is\_dir && !bucket->is\_dir) { /\* not a directory \*/ return (size\_t)-1; } else { if (link\_is\_dir) { \*link\_is\_dir = bucket->is\_dir; } memcpy(path, bucket->realpath, bucket->realpath\_len + 1); return bucket->realpath\_len; } } }
#ifdef ZEND\_WIN32retry\_reparse\_point: may\_retry\_reparse\_point = 0; if (save) { pathw = php\_win32\_ioutil\_any\_to\_w(path); if (!pathw) { return (size\_t)-1; } hFind = FindFirstFileExW(pathw, FindExInfoBasic, &dataw, FindExSearchNameMatch, NULL, 0); if (INVALID\_HANDLE\_VALUE == hFind) { if (use\_realpath == CWD\_REALPATH) { /\* file not found \*/ FREE\_PATHW() return (size\_t)-1; } /\* continue resolution anyway but don't save result in the cache \*/ save = 0; } else { FindClose(hFind); } }
 tmp = do\_alloca(len+1, use\_heap); memcpy(tmp, path, len+1);
retry\_reparse\_tag\_cloud: if(save && !(IS\_UNC\_PATH(path, len) && len >= 3 && path[2] != '?') && (dataw.dwFileAttributes & FILE\_ATTRIBUTE\_REPARSE\_POINT) ) { /\* File is a reparse point. Get the target \*/ HANDLE hLink = NULL; PHP\_WIN32\_IOUTIL\_REPARSE\_DATA\_BUFFER \* pbuffer; DWORD retlength = 0; size\_t bufindex = 0; uint8\_t isabsolute = 0; wchar\_t \* reparsetarget; BOOL isVolume = FALSE;#if VIRTUAL\_CWD\_DEBUG char \*printname = NULL;#endif char \*substitutename = NULL; size\_t substitutename\_len; size\_t substitutename\_off = 0; wchar\_t tmpsubstname[MAXPATHLEN];
 if(++(\*ll) > LINK\_MAX) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }
 hLink = CreateFileW(pathw, 0, PHP\_WIN32\_IOUTIL\_DEFAULT\_SHARE\_MODE, NULL, OPEN\_EXISTING, FILE\_FLAG\_OPEN\_REPARSE\_POINT|FILE\_FLAG\_BACKUP\_SEMANTICS, NULL); if(hLink == INVALID\_HANDLE\_VALUE) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }
 pbuffer = (PHP\_WIN32\_IOUTIL\_REPARSE\_DATA\_BUFFER \*)do\_alloca(MAXIMUM\_REPARSE\_DATA\_BUFFER\_SIZE, use\_heap\_large); if (pbuffer == NULL) { CloseHandle(hLink); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } if(!DeviceIoControl(hLink, FSCTL\_GET\_REPARSE\_POINT, NULL, 0, pbuffer, MAXIMUM\_REPARSE\_DATA\_BUFFER\_SIZE, &retlength, NULL)) { BY\_HANDLE\_FILE\_INFORMATION fileInformation;
 free\_alloca(pbuffer, use\_heap\_large); if ((dataw.dwFileAttributes & FILE\_ATTRIBUTE\_REPARSE\_POINT) && (dataw.dwReserved0 & ~IO\_REPARSE\_TAG\_CLOUD\_MASK) == IO\_REPARSE\_TAG\_CLOUD && EG(windows\_version\_info).dwMajorVersion >= 10 && EG(windows\_version\_info).dwMinorVersion == 0 && EG(windows\_version\_info).dwBuildNumber >= 18362 && GetFileInformationByHandle(hLink, &fileInformation) && !(fileInformation.dwFileAttributes & FILE\_ATTRIBUTE\_REPARSE\_POINT)) { dataw.dwFileAttributes = fileInformation.dwFileAttributes; CloseHandle(hLink); (\*ll)--; goto retry\_reparse\_tag\_cloud; } free\_alloca(tmp, use\_heap); CloseHandle(hLink); FREE\_PATHW() return (size\_t)-1; }
 CloseHandle(hLink);
 if(pbuffer->ReparseTag == IO\_REPARSE\_TAG\_SYMLINK) { may\_retry\_reparse\_point = 1; reparsetarget = pbuffer->SymbolicLinkReparseBuffer.ReparseTarget; isabsolute = pbuffer->SymbolicLinkReparseBuffer.Flags == 0;#if VIRTUAL\_CWD\_DEBUG printname = php\_win32\_ioutil\_w\_to\_any(reparsetarget + pbuffer->MountPointReparseBuffer.PrintNameOffset / sizeof(WCHAR)); if (!printname) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }#endif
 substitutename\_len = pbuffer->MountPointReparseBuffer.SubstituteNameLength / sizeof(WCHAR); if (substitutename\_len >= MAXPATHLEN) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } memmove(tmpsubstname, reparsetarget + pbuffer->MountPointReparseBuffer.SubstituteNameOffset / sizeof(WCHAR), pbuffer->MountPointReparseBuffer.SubstituteNameLength); tmpsubstname[substitutename\_len] = L'\0'; substitutename = php\_win32\_cp\_conv\_w\_to\_any(tmpsubstname, substitutename\_len, &substitutename\_len); if (!substitutename || substitutename\_len >= MAXPATHLEN) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); free(substitutename);#if VIRTUAL\_CWD\_DEBUG free(printname);#endif FREE\_PATHW() return (size\_t)-1; } } else if(pbuffer->ReparseTag == IO\_REPARSE\_TAG\_MOUNT\_POINT) { isabsolute = 1; reparsetarget = pbuffer->MountPointReparseBuffer.ReparseTarget;#if VIRTUAL\_CWD\_DEBUG printname = php\_win32\_ioutil\_w\_to\_any(reparsetarget + pbuffer->MountPointReparseBuffer.PrintNameOffset / sizeof(WCHAR)); if (!printname) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }#endif
 substitutename\_len = pbuffer->MountPointReparseBuffer.SubstituteNameLength / sizeof(WCHAR); if (substitutename\_len >= MAXPATHLEN) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } memmove(tmpsubstname, reparsetarget + pbuffer->MountPointReparseBuffer.SubstituteNameOffset / sizeof(WCHAR), pbuffer->MountPointReparseBuffer.SubstituteNameLength); tmpsubstname[substitutename\_len] = L'\0'; substitutename = php\_win32\_cp\_conv\_w\_to\_any(tmpsubstname, substitutename\_len, &substitutename\_len); if (!substitutename || substitutename\_len >= MAXPATHLEN) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); free(substitutename);#if VIRTUAL\_CWD\_DEBUG free(printname);#endif FREE\_PATHW() return (size\_t)-1; } } else if (pbuffer->ReparseTag == IO\_REPARSE\_TAG\_DEDUP || /\* Starting with 1709. \*/ (pbuffer->ReparseTag & ~IO\_REPARSE\_TAG\_CLOUD\_MASK) == IO\_REPARSE\_TAG\_CLOUD || IO\_REPARSE\_TAG\_ONEDRIVE == pbuffer->ReparseTag || IO\_REPARSE\_TAG\_ACTIVISION\_HSM == pbuffer->ReparseTag || IO\_REPARSE\_TAG\_PROJFS == pbuffer->ReparseTag) { isabsolute = 1; substitutename = malloc((len + 1) \* sizeof(char)); if (!substitutename) { free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } memcpy(substitutename, path, len + 1); substitutename\_len = len; } else { /\* XXX this might be not the end, restart handling with REPARSE\_GUID\_DATA\_BUFFER should be implemented. \*/ free\_alloca(pbuffer, use\_heap\_large); free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }
 if(isabsolute && substitutename\_len > 4) { /\* Do not resolve volumes (for now). A mounted point can target a volume without a drive, it is not certain that all IO functions we use in php and its deps support path with volume GUID instead of the DOS way, like: d:\test\mnt\foo \\?\Volume{62d1c3f8-83b9-11de-b108-806e6f6e6963}\foo \*/ if (strncmp(substitutename, "\\??\\Volume{",11) == 0 || strncmp(substitutename, "\\\\?\\Volume{",11) == 0 || strncmp(substitutename, "\\??\\UNC\\", 8) == 0 ) { isVolume = TRUE; substitutename\_off = 0; } else /\* do not use the \??\ and \\?\ prefix\*/ if (strncmp(substitutename, "\\??\\", 4) == 0 || strncmp(substitutename, "\\\\?\\", 4) == 0) { substitutename\_off = 4; } }
 if (!isVolume) { char \* tmp2 = substitutename + substitutename\_off; for (bufindex = 0; bufindex + substitutename\_off < substitutename\_len; bufindex++) { \*(path + bufindex) = \*(tmp2 + bufindex); }
 \*(path + bufindex) = 0; j = bufindex; } else { j = len; }
#if VIRTUAL\_CWD\_DEBUG fprintf(stderr, "reparse: print: %s ", printname); fprintf(stderr, "sub: %s ", substitutename); fprintf(stderr, "resolved: %s ", path); free(printname);#endif free\_alloca(pbuffer, use\_heap\_large); free(substitutename);
 if (may\_retry\_reparse\_point) { DWORD attrs;
 FREE\_PATHW() pathw = php\_win32\_ioutil\_any\_to\_w(path); if (!pathw) { return (size\_t)-1; } attrs = GetFileAttributesW(pathw); if (!isVolume && attrs != INVALID\_FILE\_ATTRIBUTES && (attrs & FILE\_ATTRIBUTE\_REPARSE\_POINT)) { free\_alloca(tmp, use\_heap); FREE\_PATHW() goto retry\_reparse\_point; } }
 if(isabsolute == 1) { if (!((j == 3) && (path[1] == ':') && (path[2] == '\\'))) { /\* use\_realpath is 0 in the call below coz path is absolute\*/ j = tsrm\_realpath\_r(path, 0, j, ll, t, 0, is\_dir, &directory); if(j == (size\_t)-1) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } } } else { if(i + j >= MAXPATHLEN - 1) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; }
 memmove(path+i, path, j+1); memcpy(path, tmp, i-1); path[i-1] = DEFAULT\_SLASH; j = tsrm\_realpath\_r(path, start, i + j, ll, t, use\_realpath, is\_dir, &directory); if(j == (size\_t)-1) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } } directory = (dataw.dwFileAttributes & FILE\_ATTRIBUTE\_DIRECTORY);
 if(link\_is\_dir) { \*link\_is\_dir = directory; } } else { if (save) { directory = (dataw.dwFileAttributes & FILE\_ATTRIBUTE\_DIRECTORY) != 0; if (is\_dir && !directory) { /\* not a directory \*/ free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } }#else if (save && php\_sys\_lstat(path, &st) < 0) { if (use\_realpath == CWD\_REALPATH) { /\* file not found \*/ return (size\_t)-1; } /\* continue resolution anyway but don't save result in the cache \*/ save = 0; }
 tmp = do\_alloca(len+1, use\_heap); memcpy(tmp, path, len+1);
 if (save && S\_ISLNK(st.st\_mode)) { if (++(\*ll) > LINK\_MAX || (j = (size\_t)php\_sys\_readlink(tmp, path, MAXPATHLEN)) == (size\_t)-1) { /\* too many links or broken symlinks \*/ free\_alloca(tmp, use\_heap); return (size\_t)-1; } path[j] = 0; if (IS\_ABSOLUTE\_PATH(path, j)) { j = tsrm\_realpath\_r(path, 1, j, ll, t, use\_realpath, is\_dir, &directory); if (j == (size\_t)-1) { free\_alloca(tmp, use\_heap); return (size\_t)-1; } } else { if (i + j >= MAXPATHLEN-1) { free\_alloca(tmp, use\_heap); return (size\_t)-1; /\* buffer overflow \*/ } memmove(path+i, path, j+1); memcpy(path, tmp, i-1); path[i-1] = DEFAULT\_SLASH; j = tsrm\_realpath\_r(path, start, i + j, ll, t, use\_realpath, is\_dir, &directory); if (j == (size\_t)-1) { free\_alloca(tmp, use\_heap); return (size\_t)-1; } } if (link\_is\_dir) { \*link\_is\_dir = directory; } } else { if (save) { directory = S\_ISDIR(st.st\_mode); if (link\_is\_dir) { \*link\_is\_dir = directory; } if (is\_dir && !directory) { /\* not a directory \*/ free\_alloca(tmp, use\_heap); return (size\_t)-1; } }#endif if (i <= start + 1) { j = start; } else { /\* some leading directories may be unaccessable \*/ j = tsrm\_realpath\_r(path, start, i-1, ll, t, save ? CWD\_FILEPATH : use\_realpath, 1, NULL); if (j > start && j != (size\_t)-1) { path[j++] = DEFAULT\_SLASH; } }#ifdef ZEND\_WIN32 if (j == (size\_t)-1 || j + len >= MAXPATHLEN - 1 + i) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } if (save) { size\_t sz; char \*tmp\_path = php\_win32\_ioutil\_conv\_w\_to\_any(dataw.cFileName, PHP\_WIN32\_CP\_IGNORE\_LEN, &sz); if (!tmp\_path) { free\_alloca(tmp, use\_heap); FREE\_PATHW() return (size\_t)-1; } i = sz; memcpy(path+j, tmp\_path, i+1); free(tmp\_path); j += i; } else { /\* use the original file or directory name as it wasn't found \*/ memcpy(path+j, tmp+i, len-i+1); j += (len-i); } }#else if (j == (size\_t)-1 || j + len >= MAXPATHLEN - 1 + i) { free\_alloca(tmp, use\_heap); return (size\_t)-1; } memcpy(path+j, tmp+i, len-i+1); j += (len-i); }#endif
 if (save && start && CWDG(realpath\_cache\_size\_limit)) { /\* save absolute path in the cache \*/ realpath\_cache\_add(tmp, len, path, j, directory, \*t); }[View remainder of file in raw view](https://github.com/php/php-src/raw/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_75ec8e02_20250115_125422.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_79a0c0fd_20250115_125410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_f09741c7_20250115_125409.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@nielsdos](https://avatars.githubusercontent.com/u/7771979?s=64&v=4)](/nielsdos)

# [nielsdos](/nielsdos)/**[gist:fa19867a89b38b0137b6d91ffcbe749d](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d)** Secret

Created
January 30, 2023 07:29

Show Gist options

* [Download ZIP](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d/archive/cac042fa03ecb356f11d6a10ba66357f07e1d4ed.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/nielsdos/fa19867a89b38b0137b6d91ffcbe749d.js&quot;&gt;&lt;/script&gt;
* Save nielsdos/fa19867a89b38b0137b6d91ffcbe749d to your computer and use it in GitHub Desktop.

[Code](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d)
[Revisions
1](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/nielsdos/fa19867a89b38b0137b6d91ffcbe749d.js&quot;&gt;&lt;/script&gt;

Save nielsdos/fa19867a89b38b0137b6d91ffcbe749d to your computer and use it in GitHub Desktop.

[Download ZIP](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d/archive/cac042fa03ecb356f11d6a10ba66357f07e1d4ed.zip)

libxml url

 [Raw](/nielsdos/fa19867a89b38b0137b6d91ffcbe749d/raw/cac042fa03ecb356f11d6a10ba66357f07e1d4ed/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | https://gitlab.gnome.org/nwellnhof/libxml2/-/blob/master/uri.c#L2487 |
| --- | --- |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa19867a89b38b0137b6d91ffcbe749d)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_828506bd_20250115_125415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fext%2Fxmlreader%2Fphp_xmlreader.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fext%2Fxmlreader%2Fphp_xmlreader.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from people.php.net_5e3d1783_20250115_125422.html ===


[![php](//php.net/images/logo.php?people)people](/)

* [Manage](https://main.php.net/manage/users.php)
* [Help](https://wiki.php.net/web/people)

# Stanislav Malyshev

## stas

![Picture of Stanislav Malyshev](//www.gravatar.com/avatar/2abfb1613a54da98d2ad76907550d6eb.jpg?s=460)

* stas@php.net
* [0 open bugs assigned](https://bugs.php.net/search.php?cmd=display&order_by=ts2&direction=DESC&status=Open&assign=stas)
* [edit on main](https://main.php.net/manage/users.php?username=stas)

﻿

* [Copyright © 2001-2025 The PHP Group](//php.net/copyright)
* [Other PHP.net sites](//php.net/sites)
* [Privacy policy](//php.net/privacy)



=== Content from github.com_c8f4022a_20250115_125408.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fext%2Fdom%2Fdocument.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fext%2Fdom%2Fdocument.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.php.net_d3c17c4d_20250114_224925.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Sec Bug](bug.php?id=81746) #81746 | 1-byte array overrun in common path resolve code | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2023-01-20 22:19 UTC | Modified: | 2023-02-13 04:40 UTC |  | | From: | dossche dot niels at gmail dot com | Assigned: | [stas](search.php?cmd=display&assign=stas) ([profile](https://people.php.net/stas)) | | Status: | Closed | Package: | [\*Directory/Filesystem functions](search.php?cmd=display&package_name[]=%2ADirectory%2FFilesystem+functions) | | PHP Version: | 8.0.27 | OS: | Linux | | Private report: | No | CVE-ID: | [2023-0568](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0568) |   View [Developer](bug.php?id=81746&edit=1) [Edit](bug.php?id=81746&edit=2)   **[2023-01-20 22:19 UTC] dossche dot niels at gmail dot com** ``` Description: ------------ The following pieces of code all follow the same code pattern:  <https://github.com/php/php-src/blob/db6840bda42d0fa6e98515eb6f555b0df1e707ee/main/fopen_wrappers.c#L223-L226> <https://github.com/php/php-src/blob/db6840bda42d0fa6e98515eb6f555b0df1e707ee/main/fopen_wrappers.c#L228-L229> <https://github.com/php/php-src/blob/db6840bda42d0fa6e98515eb6f555b0df1e707ee/main/fopen_wrappers.c#L234-L237> <https://github.com/php/php-src/blob/db6840bda42d0fa6e98515eb6f555b0df1e707ee/ext/xmlreader/php_xmlreader.c#L1055-L1058> <https://github.com/php/php-src/blob/db6840bda42d0fa6e98515eb6f555b0df1e707ee/ext/dom/document.c#L1236-L1239>  These arrays can have at most MAXPATHLEN characters, including the NUL character. So the strlen(...) can be at most MAXPATHLEN-1. If it does not end in a slash, and a slash must be appended, a write of the NUL character to index MAXPATHLEN will occur, overrunning the array. If an attacker has influence over filenames, they could theoretically overwrite a byte of stack memory.  I'm not sure whether this actually qualifies as a security issue, because this situation would be very exceptional. According to the wiki I'm guessing this is either low severity or not a security issue. I wanted to play it safe by reporting in private first.    ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2023-01-20 22:22 UTC] dossche dot niels at gmail dot com** ``` Upon trying to add a patch I get ERROR:    The [bug #81746](bug.php?id=81746) is not available to public. So I'll add it here below:   diff --git a/ext/dom/document.c b/ext/dom/document.c index 4dee5548f1..c60198a3be 100644 --- a/ext/dom/document.c +++ b/ext/dom/document.c @@ -1182,7 +1182,7 @@ static xmlDocPtr dom_document_parser(zval *id, int mode, char *source, size_t so  	int validate, recover, resolve_externals, keep_blanks, substitute_ent;  	int resolved_path_len;  	int old_error_reporting = 0; -	char *directory=NULL, resolved_path[MAXPATHLEN]; +	char *directory=NULL, resolved_path[MAXPATHLEN + 1];    	if (id != NULL) {  		intern = Z_DOMOBJ_P(id); diff --git a/ext/xmlreader/php_xmlreader.c b/ext/xmlreader/php_xmlreader.c index c17884d960..39141c8c12 100644 --- a/ext/xmlreader/php_xmlreader.c +++ b/ext/xmlreader/php_xmlreader.c @@ -1017,7 +1017,7 @@ PHP_METHOD(XMLReader, XML)  	xmlreader_object *intern = NULL;  	char *source, *uri = NULL, *encoding = NULL;  	int resolved_path_len, ret = 0; -	char *directory=NULL, resolved_path[MAXPATHLEN]; +	char *directory=NULL, resolved_path[MAXPATHLEN + 1];  	xmlParserInputBufferPtr inputbfr;  	xmlTextReaderPtr reader;   diff --git a/main/fopen_wrappers.c b/main/fopen_wrappers.c index f6ce26e104..bb39987e77 100644 --- a/main/fopen_wrappers.c +++ b/main/fopen_wrappers.c @@ -129,8 +129,8 @@ PHPAPI ZEND_INI_MH(OnUpdateBaseDir)  */  PHPAPI int php_check_specific_open_basedir(const char *basedir, const char *path)  { -	char resolved_name[MAXPATHLEN]; -	char resolved_basedir[MAXPATHLEN]; +	char resolved_name[MAXPATHLEN + 1]; +	char resolved_basedir[MAXPATHLEN + 1];  	char local_open_basedir[MAXPATHLEN];  	char path_tmp[MAXPATHLEN];  	char *path_file;  ``` **[2023-01-20 22:22 UTC] dossche dot niels at gmail dot com** ``` Related To: [Bug #81746](bug.php?id=81746)  ``` **[2023-01-23 13:14 UTC] [cmb@php.net](//people.php.net/cmb)** ``` Thanks for reporting this issue!  > I'm not sure whether this actually qualifies as a security > issue, because this situation would be very exceptional.  Yeah, but nonetheless a buffer overrun is very bad.  Anyway, this might actually be the root case of GH-9903[1] (but let's not discuss there, because the issue is public).  > Upon trying to add a patch I get ERROR:  Yeah, known issue.  We often share sec patches via as *secret* Gist (<<https://gist.github.com/>>).  A better option might be to file a security advisory[2].  This is not publicly announced, since we're just trying out the feature, but there it should be possible to provide private forks which may give better code review options (and maybe could run CI in the future).  [1] <<https://github.com/php/php-src/issues/9903>> [1] <<https://github.com/php/php-src/security/advisories>>  ``` **[2023-01-23 18:42 UTC] dossche dot niels at gmail dot com** ``` > Anyway, this might actually be the root case of GH-9903[1] (but > let's not discuss there, because the issue is public).  I didn't see this before. I just checked this and my patch does not resolve that issue. The path of 4095 is not allowed because of this check: <https://github.com/php/php-src/blob/c40dcf93d0b95d9a1026476b202f5aa965fb3fdd/Zend/zend_virtual_cwd.c#L1025> This check is important as it prevents the buffer overrun for the trailing slash, so that code is not vulnerable right now. To fix that issue we should correct the check, and additionally check if we still have enough space for the trailing slash only if we actually need to add it.  In the patch I posted here, I proposed to grow the arrays by one, but perhaps we can use the same strategy as I described above: just check if we still have enough room to add a trailing slash and otherwise fail somehow.  > We often share sec patches via as *secret* Gist (<<https://gist.github.com/>>).  Ah, completely forgot that was a thing.   Shall I wait for more feedback to come in, or should try the proposed solution to both this issue and GH-9903?  Thanks in advance  ``` **[2023-01-27 07:56 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: +CVE-ID: needed **[2023-01-27 08:02 UTC] [stas@php.net](//people.php.net/stas)** ``` > In the patch I posted here, I proposed to grow the arrays by one, but perhaps we can use the same strategy as I described above: just check if we still have enough room to add a trailing slash and otherwise fail somehow.  I think either one would work, probably. So if you have a patch, please add a link to it as secret gist.  ``` **[2023-01-27 18:39 UTC] dossche dot niels at gmail dot com** ``` I *think* that this patch is correct: <https://gist.github.com/nielsdos/fa5a19ee190045ed362eea265774cd60>  Thanks  ``` **[2023-01-29 07:46 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: needed +CVE-ID: 2023-0568 **[2023-01-30 05:16 UTC] [stas@php.net](//people.php.net/stas)** ``` Looks good for open_basedir, for XML though I am not sure it's legit to send it overly long paths. It may have fixed buffers inside too. I'd rather add a check and have the parsing fail if the path is too long.  ``` **[2023-01-30 07:30 UTC] dossche dot niels at gmail dot com** ``` Thanks for the review.  As far as I understand for the XML case, the xmlCanonicPath function actually makes a URI from the path, it even extends the path in some cases: <https://gist.github.com/nielsdos/fa19867a89b38b0137b6d91ffcbe749d> (I couldn't link to GitLab directly because of the antispam system, so I had to paste the link in a gist)  So that's why I thought it is safe, because URI's aren't constrained to a platform's PATH_MAX, and otherwise the extending would be unsafe too. I can change it if you want, but I think that's not strictly necessary.  ``` **[2023-02-13 04:40 UTC] [stas@php.net](//people.php.net/stas)** -Status: Open +Status: Closed -Assigned To: +Assigned To: stas **[2023-02-13 04:40 UTC] [stas@php.net](//people.php.net/stas)** ``` The fix for this bug has been committed. If you are still experiencing this bug, try to check out latest source from <https://github.com/php/php-src> and re-test. Thank you for the report, and for helping us make PHP better.    ``` **[2023-04-09 11:48 UTC] anakloncatin at gmail dot com** ``` <https://github.com/mandiripinjamandana>  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Tue Jan 14 22:01:29 2025 UTC |



=== Content from github.com_7166b39e_20250115_125412.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

The PHP Interpreter

[www.php.net](https://www.php.net "https://www.php.net")

### License

[View license](/php/php-src/blob/master/LICENSE)

[38.5k
stars](/php/php-src/stargazers) [7.8k
forks](/php/php-src/forks) [Branches](/php/php-src/branches) [Tags](/php/php-src/tags) [Activity](/php/php-src/activity)
 [Star](/login?return_to=%2Fphp%2Fphp-src)

 [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

# php/php-src

    master[Branches](/php/php-src/branches)[Tags](/php/php-src/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[140,050 Commits](/php/php-src/commits/master/) | | |
| [.circleci](/php/php-src/tree/master/.circleci ".circleci") | | [.circleci](/php/php-src/tree/master/.circleci ".circleci") |  |  |
| [.github](/php/php-src/tree/master/.github ".github") | | [.github](/php/php-src/tree/master/.github ".github") |  |  |
| [TSRM](/php/php-src/tree/master/TSRM "TSRM") | | [TSRM](/php/php-src/tree/master/TSRM "TSRM") |  |  |
| [Zend](/php/php-src/tree/master/Zend "Zend") | | [Zend](/php/php-src/tree/master/Zend "Zend") |  |  |
| [benchmark](/php/php-src/tree/master/benchmark "benchmark") | | [benchmark](/php/php-src/tree/master/benchmark "benchmark") |  |  |
| [build](/php/php-src/tree/master/build "build") | | [build](/php/php-src/tree/master/build "build") |  |  |
| [docs-old](/php/php-src/tree/master/docs-old "docs-old") | | [docs-old](/php/php-src/tree/master/docs-old "docs-old") |  |  |
| [docs](/php/php-src/tree/master/docs "docs") | | [docs](/php/php-src/tree/master/docs "docs") |  |  |
| [ext](/php/php-src/tree/master/ext "ext") | | [ext](/php/php-src/tree/master/ext "ext") |  |  |
| [main](/php/php-src/tree/master/main "main") | | [main](/php/php-src/tree/master/main "main") |  |  |
| [pear](/php/php-src/tree/master/pear "pear") | | [pear](/php/php-src/tree/master/pear "pear") |  |  |
| [sapi](/php/php-src/tree/master/sapi "sapi") | | [sapi](/php/php-src/tree/master/sapi "sapi") |  |  |
| [scripts](/php/php-src/tree/master/scripts "scripts") | | [scripts](/php/php-src/tree/master/scripts "scripts") |  |  |
| [tests](/php/php-src/tree/master/tests "tests") | | [tests](/php/php-src/tree/master/tests "tests") |  |  |
| [win32](/php/php-src/tree/master/win32 "win32") | | [win32](/php/php-src/tree/master/win32 "win32") |  |  |
| [.editorconfig](/php/php-src/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/php/php-src/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gdbinit](/php/php-src/blob/master/.gdbinit ".gdbinit") | | [.gdbinit](/php/php-src/blob/master/.gdbinit ".gdbinit") |  |  |
| [.gitattributes](/php/php-src/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/php/php-src/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/php/php-src/blob/master/.gitignore ".gitignore") | | [.gitignore](/php/php-src/blob/master/.gitignore ".gitignore") |  |  |
| [CODING\_STANDARDS.md](/php/php-src/blob/master/CODING_STANDARDS.md "CODING_STANDARDS.md") | | [CODING\_STANDARDS.md](/php/php-src/blob/master/CODING_STANDARDS.md "CODING_STANDARDS.md") |  |  |
| [CONTRIBUTING.md](/php/php-src/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/php/php-src/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [EXTENSIONS](/php/php-src/blob/master/EXTENSIONS "EXTENSIONS") | | [EXTENSIONS](/php/php-src/blob/master/EXTENSIONS "EXTENSIONS") |  |  |
| [LICENSE](/php/php-src/blob/master/LICENSE "LICENSE") | | [LICENSE](/php/php-src/blob/master/LICENSE "LICENSE") |  |  |
| [NEWS](/php/php-src/blob/master/NEWS "NEWS") | | [NEWS](/php/php-src/blob/master/NEWS "NEWS") |  |  |
| [README.REDIST.BINS](/php/php-src/blob/master/README.REDIST.BINS "README.REDIST.BINS") | | [README.REDIST.BINS](/php/php-src/blob/master/README.REDIST.BINS "README.REDIST.BINS") |  |  |
| [README.md](/php/php-src/blob/master/README.md "README.md") | | [README.md](/php/php-src/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/php/php-src/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/php/php-src/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING](/php/php-src/blob/master/UPGRADING "UPGRADING") | | [UPGRADING](/php/php-src/blob/master/UPGRADING "UPGRADING") |  |  |
| [UPGRADING.INTERNALS](/php/php-src/blob/master/UPGRADING.INTERNALS "UPGRADING.INTERNALS") | | [UPGRADING.INTERNALS](/php/php-src/blob/master/UPGRADING.INTERNALS "UPGRADING.INTERNALS") |  |  |
| [buildconf](/php/php-src/blob/master/buildconf "buildconf") | | [buildconf](/php/php-src/blob/master/buildconf "buildconf") |  |  |
| [buildconf.bat](/php/php-src/blob/master/buildconf.bat "buildconf.bat") | | [buildconf.bat](/php/php-src/blob/master/buildconf.bat "buildconf.bat") |  |  |
| [codecov.yml](/php/php-src/blob/master/codecov.yml "codecov.yml") | | [codecov.yml](/php/php-src/blob/master/codecov.yml "codecov.yml") |  |  |
| [configure.ac](/php/php-src/blob/master/configure.ac "configure.ac") | | [configure.ac](/php/php-src/blob/master/configure.ac "configure.ac") |  |  |
| [php.ini-development](/php/php-src/blob/master/php.ini-development "php.ini-development") | | [php.ini-development](/php/php-src/blob/master/php.ini-development "php.ini-development") |  |  |
| [php.ini-production](/php/php-src/blob/master/php.ini-production "php.ini-production") | | [php.ini-production](/php/php-src/blob/master/php.ini-production "php.ini-production") |  |  |
| [run-tests.php](/php/php-src/blob/master/run-tests.php "run-tests.php") | | [run-tests.php](/php/php-src/blob/master/run-tests.php "run-tests.php") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* Security
[![PHP](https://camo.githubusercontent.com/d3fa29c31c08000037c47e6551b3a42e5fcde1a65b1137b6e4c346d684eb242b/68747470733a2f2f7777772e7068702e6e65742f696d616765732f6c6f676f732f6e65772d7068702d6c6f676f2e737667)](https://www.php.net)

# The PHP Interpreter

PHP is a popular general-purpose scripting language that is especially suited to
web development. Fast, flexible and pragmatic, PHP powers everything from your
blog to the most popular websites in the world. PHP is distributed under the
[PHP License v3.01](/php/php-src/blob/master/LICENSE).

[![Push](https://github.com/php/php-src/actions/workflows/push.yml/badge.svg)](https://github.com/php/php-src/actions/workflows/push.yml)
[![Fuzzing Status](https://camo.githubusercontent.com/cc47c2b6137bb74bd3ef8b0144df512d6c2e1803811f53ecda03021258d0fc86/68747470733a2f2f6f73732d66757a7a2d6275696c642d6c6f67732e73746f726167652e676f6f676c65617069732e636f6d2f6261646765732f7068702e737667)](https://bugs.chromium.org/p/oss-fuzz/issues/list?sort=-opened&can=1&q=proj:php)

## Documentation

The PHP manual is available at [php.net/docs](https://www.php.net/docs).

## Installation

### Prebuilt packages and binaries

Prebuilt packages and binaries can be used to get up and running fast with PHP.

For Windows, the PHP binaries can be obtained from
[windows.php.net](https://windows.php.net). After extracting the archive the
`*.exe` files are ready to use.

For other systems, see the [installation chapter](https://www.php.net/install).

### Building PHP source code

*For Windows, see [Build your own PHP on Windows](https://wiki.php.net/internals/windows/stepbystepbuild_sdk_2).*

For a minimal PHP build from Git, you will need autoconf, bison, and re2c. For
a default build, you will additionally need libxml2 and libsqlite3.

On Ubuntu, you can install these using:

```
sudo apt install -y pkg-config build-essential autoconf bison re2c \
                    libxml2-dev libsqlite3-dev

```

On Fedora, you can install these using:

```
sudo dnf install re2c bison autoconf make libtool ccache libxml2-devel sqlite-devel

```

Generate configure:

```
./buildconf

```

Configure your build. `--enable-debug` is recommended for development, see
`./configure --help` for a full list of options.

```
# For development
./configure --enable-debug
# For production
./configure

```

Build PHP. To speed up the build, specify the maximum number of jobs using `-j`:

```
make -j4

```

The number of jobs should usually match the number of available cores, which
can be determined using `nproc`.

## Testing PHP source code

PHP ships with an extensive test suite, the command `make test` is used after
successful compilation of the sources to run this test suite.

It is possible to run tests using multiple cores by setting `-jN` in
`TEST_PHP_ARGS`:

```
make TEST_PHP_ARGS=-j4 test

```

Shall run `make test` with a maximum of 4 concurrent jobs: Generally the maximum
number of jobs should not exceed the number of cores available.

The [qa.php.net](https://qa.php.net) site provides more detailed info about
testing and quality assurance.

## Installing PHP built from source

After a successful build (and test), PHP may be installed with:

```
make install

```

Depending on your permissions and prefix, `make install` may need super user
permissions.

## PHP extensions

Extensions provide additional functionality on top of PHP. PHP consists of many
essential bundled extensions. Additional extensions can be found in the PHP
Extension Community Library - [PECL](https://pecl.php.net).

## Contributing

The PHP source code is located in the Git repository at
[github.com/php/php-src](https://github.com/php/php-src). Contributions are most
welcome by forking the repository and sending a pull request.

Discussions are done on GitHub, but depending on the topic can also be relayed
to the official PHP developer mailing list internals@lists.php.net.

New features require an RFC and must be accepted by the developers. See
[Request for comments - RFC](https://wiki.php.net/rfc) and
[Voting on PHP features](https://wiki.php.net/rfc/voting) for more information
on the process.

Bug fixes don't require an RFC. If the bug has a GitHub issue, reference it in
the commit message using `GH-NNNNNN`. Use `#NNNNNN` for tickets in the old
[bugs.php.net](https://bugs.php.net) bug tracker.

```
Fix GH-7815: php_uname doesn't recognise latest Windows versions
Fix #55371: get_magic_quotes_gpc() throws deprecation warning

```

See [Git workflow](https://wiki.php.net/vcs/gitworkflow) for details on how pull
requests are merged.

### Guidelines for contributors

See further documents in the repository for more information on how to
contribute:

* [Contributing to PHP](/php/php-src/blob/master/CONTRIBUTING.md)
* [PHP coding standards](/php/php-src/blob/master/CODING_STANDARDS.md)
* [Internal documentation](https://php.github.io/php-src/)
* [Mailing list rules](/php/php-src/blob/master/docs/mailinglist-rules.md)
* [PHP release process](/php/php-src/blob/master/docs/release-process.md)

## Credits

For the list of people who've put work into PHP, please see the
[PHP credits page](https://www.php.net/credits.php).

## About

The PHP Interpreter

[www.php.net](https://www.php.net "https://www.php.net")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/php/php-src/activity)
[Custom properties](/php/php-src/custom-properties)
### Stars

[**38.5k**
stars](/php/php-src/stargazers)
### Watchers

[**1.4k**
watching](/php/php-src/watchers)
### Forks

[**7.8k**
forks](/php/php-src/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src&report=php+%28user%29)

## [Releases 3](/php/php-src/releases)

[PHP 8.4.2
Latest

Dec 20, 2024](/php/php-src/releases/tag/php-8.4.2)
[+ 2 releases](/php/php-src/releases)

## [Contributors 975](/php/php-src/graphs/contributors)

* [![@dstogov](https://avatars.githubusercontent.com/u/2510034?s=64&v=4)](https://github.com/dstogov)
* [![@nikic](https://avatars.githubusercontent.com/u/216080?s=64&v=4)](https://github.com/nikic)
* [![@weltling](https://avatars.githubusercontent.com/u/22016?s=64&v=4)](https://github.com/weltling)
* [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=64&v=4)](https://github.com/cmb69)
* [![@laruence](https://avatars.githubusercontent.com/u/382813?s=64&v=4)](https://github.com/laruence)
* [![@tony2001](https://avatars.githubusercontent.com/u/42386?s=64&v=4)](https://github.com/tony2001)
* [![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=64&v=4)](https://github.com/smalyshev)
* [![@pierrejoye](https://avatars.githubusercontent.com/u/282408?s=64&v=4)](https://github.com/pierrejoye)
* [![@felipensp](https://avatars.githubusercontent.com/u/773947?s=64&v=4)](https://github.com/felipensp)
* [![@nielsdos](https://avatars.githubusercontent.com/u/7771979?s=64&v=4)](https://github.com/nielsdos)
* [![@zsuraski](https://avatars.githubusercontent.com/u/2006098?s=64&v=4)](https://github.com/zsuraski)
* [![@faizshukri](https://avatars.githubusercontent.com/u/1219518?s=64&v=4)](https://github.com/faizshukri)
* [![@remicollet](https://avatars.githubusercontent.com/u/270445?s=64&v=4)](https://github.com/remicollet)
* [![@krakjoe](https://avatars.githubusercontent.com/u/2236138?s=64&v=4)](https://github.com/krakjoe)

[+ 961 contributors](/php/php-src/graphs/contributors)

## Languages

* [C
  67.0%](/php/php-src/search?l=c)
* [PHP
  30.8%](/php/php-src/search?l=php)
* [C++
  0.6%](/php/php-src/search?l=c%2B%2B)
* [M4
  0.4%](/php/php-src/search?l=m4)
* [Shell
  0.3%](/php/php-src/search?l=shell)
* [Lua
  0.3%](/php/php-src/search?l=lua)
* Other
  0.6%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_0aef5dff_20250115_125413.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@nielsdos](https://avatars.githubusercontent.com/u/7771979?s=64&v=4)](/nielsdos)

# [nielsdos](/nielsdos)/**[0001-Fix-array-overrun-when-appending-slash-to-paths.patch](/nielsdos/fa5a19ee190045ed362eea265774cd60)** Secret

Created
January 27, 2023 18:38

Show Gist options

* [Download ZIP](/nielsdos/fa5a19ee190045ed362eea265774cd60/archive/d74e2aa5ff37b6494e86ae0ef77ce716709a9893.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/nielsdos/fa5a19ee190045ed362eea265774cd60.js&quot;&gt;&lt;/script&gt;
* Save nielsdos/fa5a19ee190045ed362eea265774cd60 to your computer and use it in GitHub Desktop.

[Code](/nielsdos/fa5a19ee190045ed362eea265774cd60)
[Revisions
1](/nielsdos/fa5a19ee190045ed362eea265774cd60/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/nielsdos/fa5a19ee190045ed362eea265774cd60.js&quot;&gt;&lt;/script&gt;

Save nielsdos/fa5a19ee190045ed362eea265774cd60 to your computer and use it in GitHub Desktop.

[Download ZIP](/nielsdos/fa5a19ee190045ed362eea265774cd60/archive/d74e2aa5ff37b6494e86ae0ef77ce716709a9893.zip)

 [Raw](/nielsdos/fa5a19ee190045ed362eea265774cd60/raw/d74e2aa5ff37b6494e86ae0ef77ce716709a9893/0001-Fix-array-overrun-when-appending-slash-to-paths.patch)

[**0001-Fix-array-overrun-when-appending-slash-to-paths.patch**](#file-0001-fix-array-overrun-when-appending-slash-to-paths-patch)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From bd57e09cc2881b024923ba85f0b0dd651f0315e9 Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: Niels Dossche <7771979+nielsdos@users.noreply.github.com> |
|  | Date: Fri, 27 Jan 2023 19:28:27 +0100 |
|  | Subject: [PATCH] Fix array overrun when appending slash to paths |
|  |  |
|  | Fix it by extending the array sizes by one character. As the input is |
|  | limited to the maximum path length, there will always be place to append |
|  | the slash. As the php\_check\_specific\_open\_basedir() simply uses the |
|  | strings to compare against each other, no new failures related to too |
|  | long paths are introduced. |
|  | We'll let the DOM and XML case handle a potentially too long path in the |
|  | library code. |
|  | --- |
|  | ext/dom/document.c | 2 +- |
|  | ext/xmlreader/php\_xmlreader.c | 2 +- |
|  | main/fopen\_wrappers.c | 6 +++--- |
|  | 3 files changed, 5 insertions(+), 5 deletions(-) |
|  |  |
|  | diff --git a/ext/dom/document.c b/ext/dom/document.c |
|  | index 4dee5548f1..c60198a3be 100644 |
|  | --- a/ext/dom/document.c |
|  | +++ b/ext/dom/document.c |
|  | @@ -1182,7 +1182,7 @@ static xmlDocPtr dom\_document\_parser(zval \*id, int mode, char \*source, size\_t so |
|  | int validate, recover, resolve\_externals, keep\_blanks, substitute\_ent; |
|  | int resolved\_path\_len; |
|  | int old\_error\_reporting = 0; |
|  | - char \*directory=NULL, resolved\_path[MAXPATHLEN]; |
|  | + char \*directory=NULL, resolved\_path[MAXPATHLEN + 1]; |
|  |  |
|  | if (id != NULL) { |
|  | intern = Z\_DOMOBJ\_P(id); |
|  | diff --git a/ext/xmlreader/php\_xmlreader.c b/ext/xmlreader/php\_xmlreader.c |
|  | index c17884d960..39141c8c12 100644 |
|  | --- a/ext/xmlreader/php\_xmlreader.c |
|  | +++ b/ext/xmlreader/php\_xmlreader.c |
|  | @@ -1017,7 +1017,7 @@ PHP\_METHOD(XMLReader, XML) |
|  | xmlreader\_object \*intern = NULL; |
|  | char \*source, \*uri = NULL, \*encoding = NULL; |
|  | int resolved\_path\_len, ret = 0; |
|  | - char \*directory=NULL, resolved\_path[MAXPATHLEN]; |
|  | + char \*directory=NULL, resolved\_path[MAXPATHLEN + 1]; |
|  | xmlParserInputBufferPtr inputbfr; |
|  | xmlTextReaderPtr reader; |
|  |  |
|  | diff --git a/main/fopen\_wrappers.c b/main/fopen\_wrappers.c |
|  | index f6ce26e104..12cc9c8b10 100644 |
|  | --- a/main/fopen\_wrappers.c |
|  | +++ b/main/fopen\_wrappers.c |
|  | @@ -129,10 +129,10 @@ PHPAPI ZEND\_INI\_MH(OnUpdateBaseDir) |
|  | \*/ |
|  | PHPAPI int php\_check\_specific\_open\_basedir(const char \*basedir, const char \*path) |
|  | { |
|  | - char resolved\_name[MAXPATHLEN]; |
|  | - char resolved\_basedir[MAXPATHLEN]; |
|  | + char resolved\_name[MAXPATHLEN + 1]; |
|  | + char resolved\_basedir[MAXPATHLEN + 1]; |
|  | char local\_open\_basedir[MAXPATHLEN]; |
|  | - char path\_tmp[MAXPATHLEN]; |
|  | + char path\_tmp[MAXPATHLEN + 1]; |
|  | char \*path\_file; |
|  | size\_t resolved\_basedir\_len; |
|  | size\_t resolved\_name\_len; |
|  | -- |
|  | 2.39.1 |
|  |  |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnielsdos%2Ffa5a19ee190045ed362eea265774cd60)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_597d2672_20250115_125413.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fstarred)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fstarred&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fstarred) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fstarred&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

# Discover gists

* [All gists](/discover)
* [Forked](/forked)
* [Starred](/starred)

* [1 file](/SebastianGrans/6ae5cab66e453a14a859b66cd9579239)
* [1 fork](/SebastianGrans/6ae5cab66e453a14a859b66cd9579239/forks)
* [6 comments](/SebastianGrans/6ae5cab66e453a14a859b66cd9579239#comments)
* [14 stars](/SebastianGrans/6ae5cab66e453a14a859b66cd9579239/stargazers)

[![@SebastianGrans](https://avatars.githubusercontent.com/u/10030015?s=60&v=4)](/SebastianGrans)

[SebastianGrans](/SebastianGrans)
/ [**pcd\_subscriber\_node.py**](/SebastianGrans/6ae5cab66e453a14a859b66cd9579239)

Created
July 27, 2020 16:29

ROS2 Node that subscribes to PointCloud2 messages and visualizes them using Open3D.

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import sys |
| --- | --- |
|  | import os |
|  |  |
|  | import rclpy |
|  | from rclpy.node import Node |
|  | import sensor\_msgs.msg as sensor\_msgs |
|  |  |
|  |  |
|  | import numpy as np |
|  | import open3d as o3d |

* [1 file](/nerovalerius/80133f409f9ed0573522432244298195)
* [0 forks](/nerovalerius/80133f409f9ed0573522432244298195/forks)
* [6 comments](/nerovalerius/80133f409f9ed0573522432244298195#comments)
* [4 stars](/nerovalerius/80133f409f9ed0573522432244298195/stargazers)

[![@nerovalerius](https://avatars.githubusercontent.com/u/19653931?s=60&v=4)](/nerovalerius)

[nerovalerius](/nerovalerius)
/ [**create\_semantic\_kitti\_dataset.md**](/nerovalerius/80133f409f9ed0573522432244298195)

Last active
January 15, 2025 12:51

Instructions on how to create a LIDAR dataset with semantic labels in "semantic KITTI" Format

## Prerequisites

Tested on Ubuntu 22.04 with an Nvidia RTX 3090

1. Install ROS2 Humble: [LINK](https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html)
2. Set up a ROS2 workspace: [LINK](https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html)

   2a. prepare automatic sourcing of the ROS2 installation and workspace:
   ```
   echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
   echo "source /home/user/ros2_ws/install/setup.bash" >> ~/.bashrc

   ```

* [1 file](/lisawolderiksen/a7b99d94c92c6671181611be1641c733)
* [85 forks](/lisawolderiksen/a7b99d94c92c6671181611be1641c733/forks)
* [28 comments](/lisawolderiksen/a7b99d94c92c6671181611be1641c733#comments)
* [640 stars](/lisawolderiksen/a7b99d94c92c6671181611be1641c733/stargazers)

[![@lisawolderiksen](https://avatars.githubusercontent.com/u/35797988?s=60&v=4)](/lisawolderiksen)

[lisawolderiksen](/lisawolderiksen)
/ [**git-commit-template.md**](/lisawolderiksen/a7b99d94c92c6671181611be1641c733)

Last active
January 15, 2025 12:49

Use a Git commit message template to write better commit messages

# Using Git Commit Message Templates to Write Better Commit Messages

The always enthusiastic and knowledgeable mr. [@jasaltvik](https://github.com/jasaltvik) shared with our team
an article on writing (good) Git commit messages:
[How to Write a Git Commit Message](https://cbea.ms/git-commit/).
This excellent article explains why *good* Git commit messages are important,
and explains what constitutes a good commit message. I wholeheartedly agree
with what [@cbeams](https://github.com/cbeams) writes in his article. (Have you read it yet? If not, go
[read it now](https://cbea.ms/git-commit/). I'll wait.)
It's sensible stuff. So I decided to start following the

* [1 file](/Nekodigi/b72a3f110ecca00d1c8b343fe58bf4e2)
* [0 forks](/Nekodigi/b72a3f110ecca00d1c8b343fe58bf4e2/forks)
* [0 comments](/Nekodigi/b72a3f110ecca00d1c8b343fe58bf4e2#comments)
* [3 stars](/Nekodigi/b72a3f110ecca00d1c8b343fe58bf4e2/stargazers)

[![@Nekodigi](https://avatars.githubusercontent.com/u/38092328?s=60&v=4)](/Nekodigi)

[Nekodigi](/Nekodigi)
/ [**Kaleidoscope.pde**](/Nekodigi/b72a3f110ecca00d1c8b343fe58bf4e2)

Created
August 17, 2020 13:35

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | PImage img; |
| --- | --- |
|  | float r;//kaleidoscope radius |
|  | float angle = radians(45);//" angle |
|  | float imgAngleOff = 0;//offset angle when uv mapping |
|  |  |
|  | void setup(){ |
|  | size(500, 500, P3D); |
|  | r = height/2; |
|  | img = loadImage("FujiPD.jpg"); |
|  | noStroke();textureMode(NORMAL); |

* [1 file](/karpathy/d4dee566867f8291f086)
* [1371 forks](/karpathy/d4dee566867f8291f086/forks)
* [188 comments](/karpathy/d4dee566867f8291f086#comments)
* [4123 stars](/karpathy/d4dee566867f8291f086/stargazers)

[![@karpathy](https://avatars.githubusercontent.com/u/241138?s=60&v=4)](/karpathy)

[karpathy](/karpathy)
/ [**min-char-rnn.py**](/karpathy/d4dee566867f8291f086)

Last active
January 15, 2025 12:49

Minimal character-level language model with a Vanilla Recurrent Neural Network, in Python/numpy

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | """ |
| --- | --- |
|  | Minimal character-level Vanilla RNN model. Written by Andrej Karpathy (@karpathy) |
|  | BSD License |
|  | """ |
|  | import numpy as np |
|  |  |
|  | # data I/O |
|  | data = open('input.txt', 'r').read() # should be simple plain text file |
|  | chars = list(set(data)) |
|  | data\_size, vocab\_size = len(data), len(chars) |

* [1 file](/hym3242/8e8bc10a2fed8e55973c500f1798c234)
* [2 forks](/hym3242/8e8bc10a2fed8e55973c500f1798c234/forks)
* [18 comments](/hym3242/8e8bc10a2fed8e55973c500f1798c234#comments)
* [7 stars](/hym3242/8e8bc10a2fed8e55973c500f1798c234/stargazers)

[![@hym3242](https://avatars.githubusercontent.com/u/40355816?s=60&v=4)](/hym3242)

[hym3242](/hym3242)
/ [**StandardKeyBinding.dict.dump.with.notes.txt**](/hym3242/8e8bc10a2fed8e55973c500f1798c234)

Last active
January 15, 2025 12:46

Dump of /System/Library/Frameworks/AppKit.framework/Resources/StandardKeyBinding.dict on macOS Ventura 13.4, plus some notes

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | $ # plz forgive this dumb method of visualization. |
| --- | --- |
|  | $ cp /System/Library/Frameworks/AppKit.framework/Resources/StandardKeyBinding.dict . |
|  | $ plutil -convert xml1 StandardKeyBinding.dict |
|  | $ plutil -p StandardKeyBinding.dict | unicode-vis | cat -v | tr '\t' '+' |
|  | { |
|  | "^C" => "insertNewline:" |
|  | "^H" => "deleteBackward:" |
|  | "^Y" => "insertBacktab:" //shift+tab |
|  | "^[" => "cancelOperation:" |
|  | "^?" => "deleteBackward:" |

* [1 file](/jensenb/8668000)
* [5 forks](/jensenb/8668000/forks)
* [3 comments](/jensenb/8668000#comments)
* [21 stars](/jensenb/8668000/stargazers)

[![@jensenb](https://avatars.githubusercontent.com/u/720535?s=60&v=4)](/jensenb)

[jensenb](/jensenb)
/ [**decompose\_essential\_matrix.py**](/jensenb/8668000)

Created
January 28, 2014 13:49

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import cv2 |
| --- | --- |
|  | import numpy as np |
|  |  |
|  |  |
|  | def in\_front\_of\_both\_cameras(first\_points, second\_points, rot, trans): |
|  | # check if the point correspondences are in front of both images |
|  | rot\_inv = rot |
|  | for first, second in zip(first\_points, second\_points): |
|  | first\_z = np.dot(rot[0, :] - second[0]\*rot[2, :], trans) / np.dot(rot[0, :] - second[0]\*rot[2, :], second) |
|  | first\_3d\_point = np.array([first[0] \* first\_z, second[0] \* first\_z, first\_z]) |

* [2 files](/richinseattle/6ee427e66db5ed54b0dc965ad0f8588e)
* [0 forks](/richinseattle/6ee427e66db5ed54b0dc965ad0f8588e/forks)
* [0 comments](/richinseattle/6ee427e66db5ed54b0dc965ad0f8588e#comments)
* [1 star](/richinseattle/6ee427e66db5ed54b0dc965ad0f8588e/stargazers)

[![@richinseattle](https://avatars.githubusercontent.com/u/1887673?s=60&v=4)](/richinseattle)

[richinseattle](/richinseattle)
/ [**\_idapro9\_macarm\_patch\_guide.md**](/richinseattle/6ee427e66db5ed54b0dc965ad0f8588e)

Created
October 2, 2024 03:49
— forked from [AutoScrape123TX/\_idapro9\_macarm\_patch\_guide.md](/AutoScrape123TX/40106f915919875e9704f154b0b8784f)

Guide: Patching IDA Pro 9.0 BETA

# Patching the IDA Pro 9.0 BETA

Note

**Obligatory disclaimer:** this is for educational purposes only. I am not responsible for any damages caused by following this guide, or using any of the script(s) herein.

This guide prioritizes arm64 macOS, but may also work for other platforms.

---

## Step 1 - Patching dylibs

* [5 files](/timcharper/d547fbe13bdd859f4836bfb02197e295)
* [3 forks](/timcharper/d547fbe13bdd859f4836bfb02197e295/forks)
* [0 comments](/timcharper/d547fbe13bdd859f4836bfb02197e295#comments)
* [9 stars](/timcharper/d547fbe13bdd859f4836bfb02197e295/stargazers)

[![@timcharper](https://avatars.githubusercontent.com/u/183?s=60&v=4)](/timcharper)

[timcharper](/timcharper)
/ [**README.md**](/timcharper/d547fbe13bdd859f4836bfb02197e295)

Last active
January 15, 2025 12:45

Macvlan using systemd

# Before

```
yum install -y systemd-networkd
modprobe macvlan # make sure this returns no errors

```
# Put config files in place

`eth0.network` and `mac0.{netdev,network}` go in `/etc/systemd/network/`

* [3 files](/nickw444/5eb50277e41be6a5d48bebfe51056c1c)
* [0 forks](/nickw444/5eb50277e41be6a5d48bebfe51056c1c/forks)
* [0 comments](/nickw444/5eb50277e41be6a5d48bebfe51056c1c#comments)
* [2 stars](/nickw444/5eb50277e41be6a5d48bebfe51056c1c/stargazers)

[![@nickw444](https://avatars.githubusercontent.com/u/1289759?s=60&v=4)](/nickw444)

[nickw444](/nickw444)
/ [**README.md**](/nickw444/5eb50277e41be6a5d48bebfe51056c1c)

Last active
January 15, 2025 12:43

moOde Audio - Toggle Home Assistant Switch Entity

# moOde Audio - Toggle Home Assistant Switch Entity

Script/service to monitor the playback status of moOde and toggle a Home Assistant
entity when playback starts/stops.

Based off <https://gist.github.com/michaelfdeberry/d3e7c9b4c4e1305be863d81a7e09f3de>

## Installation

Modify `powertoggle.sh` and fill in the relevant details. You can obtain HASS\_TOKEN

Newer[Older](https://gist.github.com/starred?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_666e5bb3_20250115_125415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fdb6840bda42d0fa6e98515eb6f555b0df1e707ee%2Fmain%2Ffopen_wrappers.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  562](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_495d804d_20250115_125414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiripinjamandana)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiripinjamandana)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@mandiripinjamandana](https://avatars.githubusercontent.com/u/35838435?s=64&v=4)

**mandiripinjamandana**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiripinjamandana)

[Overview](/mandiripinjamandana)
[Repositories
2](/mandiripinjamandana?tab=repositories)
[Projects
0](/mandiripinjamandana?tab=projects)
[Packages
0](/mandiripinjamandana?tab=packages)
[Stars
0](/mandiripinjamandana?tab=stars)

More

* [Overview](/mandiripinjamandana)
* [Repositories](/mandiripinjamandana?tab=repositories)
* [Projects](/mandiripinjamandana?tab=projects)
* [Packages](/mandiripinjamandana?tab=packages)
* [Stars](/mandiripinjamandana?tab=stars)

![@mandiripinjamandana](https://avatars.githubusercontent.com/u/35838435?s=64&v=4)

**mandiripinjamandana**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiripinjamandana)

[![View mandiripinjamandana's full-sized avatar](https://avatars.githubusercontent.com/u/35838435?v=4)](https://avatars.githubusercontent.com/u/35838435?v=4)

# Mandiri Pinjaman Dana mandiripinjamandana

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiripinjamandana)

Pinjaman dana paling tinggi dengan gadai bpkb mobil hingga batas maksimal dari nilai kendaraan yang telah ditentukan dan pembiayaan kredit mobil bekas

* Mandiri Pinjaman Dana
* Jl. Raya Narogong Kp. cikeriwis RT 07 / RW 02, Desa Limus Nunggal, Kec. Cileungsi, Bogor 16820
* <http://www.mandiripinjamandana.com/>

Block or Report

# Block or report mandiripinjamandana

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=mandiripinjamandana+%28user%29)

[Overview](/mandiripinjamandana)
[Repositories
2](/mandiripinjamandana?tab=repositories)
[Projects
0](/mandiripinjamandana?tab=projects)
[Packages
0](/mandiripinjamandana?tab=packages)
[Stars
0](/mandiripinjamandana?tab=stars)

More

* [Overview](/mandiripinjamandana)
* [Repositories](/mandiripinjamandana?tab=repositories)
* [Projects](/mandiripinjamandana?tab=projects)
* [Packages](/mandiripinjamandana?tab=packages)
* [Stars](/mandiripinjamandana?tab=stars)

## Popular repositories Loading

1. [gadai-bpkb-mobil](/mandiripinjamandana/gadai-bpkb-mobil) gadai-bpkb-mobil
   Public
2. [next-netlify-starter](/mandiripinjamandana/next-netlify-starter) next-netlify-starter
   Public

   JavaScript

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


