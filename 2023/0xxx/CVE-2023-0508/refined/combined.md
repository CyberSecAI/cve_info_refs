=== Content from gitlab.com_2766d00c_20250115_095430.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-0508.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-0508.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-0508.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-0508.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![Michael Henriksen's avatar](/uploads/-/system/user/avatar/7539010/avatar.png?width=64 "Michael Henriksen")](/mhenriksen)

  Oct 02, 2024

  [bf59a7f3](/gitlab-org/cves/-/commit/bf59a7f35332c84b95ae92e8460b2772a784e89c)
  [Update CVE-2023-0508 to CVE JSON Record 5.1 format](/gitlab-org/cves/-/commit/bf59a7f35332c84b95ae92e8460b2772a784e89c)
  Â·
  bf59a7f3

  [Michael Henriksen](/mhenriksen) authored Oct 02, 2024

  bf59a7f3

  [Update CVE-2023-0508 to CVE JSON Record 5.1 format](/gitlab-org/cves/-/commit/bf59a7f35332c84b95ae92e8460b2772a784e89c)
  [Michael Henriksen](/mhenriksen) authored Oct 02, 2024

Loading



=== Content from gitlab.com_410b3128_20250115_095431.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Open Redirection Through HTTP Response Splitting

**[HackerOne report #1842314](https://hackerone.com/reports/1842314)** by `akadrian` on 2023-01-20, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Endpoint responsible for downloading Packages from Gitlab Package Registry is vulnerable to HTTP Response splitting. By adding %0d%0a characters in URL its possible to cancel default redirection and set attacker value inside Location header. This way its possible to create open-redirection attack via HTTP Response Splitting.

##### Steps to reproduce

1. Vulnerability was tested on Self-Hosted Gitlab Instance version 15.6.1:
2. By using following URL user will be redirected to attacker website, in this case its <http://example.com> website:

   [http://gitlab.example.com/api/v4/projects/aaaa/packages/npm/%0d%0ahttp:/%2fexample.com?test](http://gitlab.example.com/api/v4/projects/aaaa/packages/npm/%0D%0Ahttp%3A//example.com?test)

##### Impact

Users can be lured to malicious websites believing that its legitimate Gitlab Instance. This could lead to

##### What is the current *bug* behavior?

User is able to change Location header to his own value leading to open redirection.

##### What is the expected *correct* behavior?

When no %0d and %0a characters are provided in vulnerable endpoint, redirection occurs to <https://registry.npmjs.org/> website. Characters %0d and %0a should be filtered so that they could not lead to changes in default Location header value.

#### Impact

User is able to change Location header to his own value leading to open redirection.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [recording-1674254776309.webm](https://h1.sec.gitlab.net/a/54d56e48-a9df-4a79-acb7-fe489564beb6/recording-1674254776309.webm)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

1. Have a public project ready.
2. `curl -vvv "http://gdk.test:8000/api/v4/projects/<project_id>/packages/npm/%0d%0ahttp:/%2fexample.com?test"`
3. Check the `Location:` header, it points to `http://example.com`

Edited Apr 19, 2023 by [David Fernandez](/10io)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


