```json
{
  "vulnerability": {
    "root_cause": "GitLab pages allows redirection to arbitrary protocols during the authentication flow.",
    "weaknesses": [
      "Improper input validation of the redirect URL.",
      "Lack of restriction on allowed protocols for redirection."
    ],
    "impact": "The vulnerability can be used to redirect users to arbitrary protocols, potentially leading to the exfiltration of authentication tokens via custom URL handlers, particularly on mobile devices.",
    "attack_vectors": "By crafting a malicious URL, an attacker can initiate an authentication flow that redirects the user to an arbitrary protocol (e.g., mailto), potentially exfiltrating sensitive information or performing actions via custom URL handlers.",
    "required_capabilities": "The attacker needs to be able to craft a malicious URL that is then used in an authentication flow.",
    "details": "The provided example demonstrates that a crafted URL such as `https://projects.gitlab.io/auth?domain=mailto://gitlab-com.gitlab.io?body=OMGWTF&state=aaa` can redirect the user to their mail client after the authentication flow, highlighting the lack of validation for the `domain` parameter in the authentication process. The expected behavior is that redirects should only be possible to `https` or `http` URLs."
  }
}
```