=== Content from gitlab.com_407a4b90_20250115_095326.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Arbitrary protocol redirection

### Summary

GitLab pages can be used to redirect to arbitrary protocols in the authentication flow.

### Steps to reproduce

Consider the following URL:

```
https://projects.gitlab.io/auth?domain=mailto://gitlab-com.gitlab.io?body=OMGWTF&state=aaa
```

It will, after the login redirect to `gitlab.com` redirect the user to their mail client.

[![image](data:image/gif;base64...)](/-/project/734943/uploads/44a20d4331d7cc8ee9699884c47d8bc7/image.png)

This might be potentially used e.g. on mobile devices to exfiltrate authentication token via custom URL handler.

### Example Project

### What is the current *bug* behavior?

Redirect to arbitrary protocols is possible.

### What is the expected *correct* behavior?

Redirect should only be possible to `https` or `http` URLs.

### Relevant logs and/or screenshots

### Output of checks

### Possible fixes

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_e2536095_20250115_095325.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-0042.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-0042.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-0042.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-0042.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 10, 2023

  [7a9997e8](/gitlab-org/cves/-/commit/7a9997e87c49dc01dfd0684b5d98c68773c87551)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/7a9997e87c49dc01dfd0684b5d98c68773c87551)
  ·
  7a9997e8

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 10, 2023

  7a9997e8

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/7a9997e87c49dc01dfd0684b5d98c68773c87551)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 10, 2023

Loading


