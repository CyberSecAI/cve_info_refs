=== Content from gitlab.com_652e27f9_20250114_182614.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Maintainer can leak Datadog API key by changing Datadog site

**[HackerOne report #1836466](https://hackerone.com/reports/1836466)** by `akadrian` on 2023-01-16, assigned to [@fvpotvin](/fvpotvin "Félix Veillette-Potvin"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

This is similar to [#377799 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/377799 "Maintainer can leak Datadog API key by changing integration URL").

This time URL is leaked when maintainer intentionally set Datadog Site field into invalid host and reviews logs after clicking "Test settings" button.

Gitlab will try to connect to the host but since the host name is invalid it will return information that "Host cannot be resolved or invalid"

and full URL will be added with API token.

##### Steps to reproduce

(Step-by-step guide to reproduce the issue, including:)

1 Create Victim Account

2 Create Attacker Account

3 Create victim-project in Victim Account

4 Invite Attacker Account to the victim-project as Maintainer

5 As Victim Go to Settings->Integration->Datadog and set Datadog Site to your Datadog Site

6 As Victim Go to Settings->Integration->Datadog and set Api Key to your Key

7 As Attacker Go to Settings->Integration->Datadog and set Datadog Site to invalid hostname such as lalalelelinvalidforsure123321.com

8 As Attacker Click "Test Settings"

9 As attacker review Recent events and notice that victim key is attached to the error

##### Impact

Datadog API key can be leaked. This could result in unauthorized actions on victim Datadog instance.

#### Impact

Datadog API key can be leaked. This could result in unauthorized actions on victim Datadog instance.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [recording-1673902364328.webm](https://h1.sec.gitlab.net/a/dbddef69-9c28-4f9d-9cc9-20fc70857bad/recording-1673902364328.webm)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_de9e43f8_20250114_182613.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-0483.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-0483.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-0483.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-0483.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 04, 2023

  [99d4779c](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  [Publishing 0 updated advisories and 4 new advisories](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  ·
  99d4779c

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

  99d4779c

  [Publishing 0 updated advisories and 4 new advisories](/gitlab-org/cves/-/commit/99d4779c165753b3df1319bd4c1c88c89e5568d5)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

Loading


