=== Content from onekey.com_762a6ed4_20250115_095521.html ===
Ready for the New EU Cyber Resilience Act?[Learn More](/cra-readiness-assessment)

Solutions

Roles[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)Use Cases[SBOM Management](/use-case/sbom-management)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[TELCO](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Product

ONEKEY PlatformYour All-in-One Cybersecurity and Compliance Solution[Platform Overview](/platform-overview)Features[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis)[Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)[![ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67121fed08268feb9f6b269b_whitepaperhero.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)WhitepapersSep 1, 2024ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](/resource/onekey-360deg-comprehensive-product-cybersecurity-compliance)[Expert Consulting](/expert-consulting)Resources

ONEKEY ResourcesAll our resources combined in one place[Resources](/resources)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)[![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)ResearchNov 26, 2024Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)Company

[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Release](/press-releases)[![Cyber Resilience Act bans products with known vulnerabilities](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b822e403bdc2f3221d575_6712ae1b7f657cc8b66be3ee_02.jpeg)Press ReleaseJun 6, 2024Cyber Resilience Act bans products with known vulnerabilities](/press-release/cyber-resilience-act-bans-products-with-known-vulnerabilities)[Book a Demo](/book-a-demo)[Book a Demo](/book-a-demo)

[Resources](/resources)>[Research](/resources/research)>Security Advisory: Multiple Vulnerabilities in NetModule Routers
# Security Advisory: Multiple Vulnerabilities in NetModule Routers

![Security Advisory: Multiple Vulnerabilities in NetModule Routers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8228097c5aad5c0c0b49_6712aea448102fa67cb3117a_15.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)February 23, 20233Â min readTablE of contentsExample H2
## READY TO UPGRADE YOUR RISK MANAGEMENT?

Make cybersecurity and compliance efficient and effective with ONEKEY.

[Book a Demo](/book-a-demo)
## Introduction

This is the third security advisory we release that is related to the introduction of a "zero-day identification" module that performs static code analysis on proprietary applications found within firmware uploaded to ONEKEY's platform. You can find the first two here: [Asus M25 NAS Vulnerability](https://b1eyc.myrdbx.io/blog/security-advisory-asus-m25-nas-vulnerability/) and [Unauthenticated Configuration Export in Multiple WAGO Products](https://b1eyc.myrdbx.io/blog/security-advisory-wago-unauthenticated-config-export-vulnerability/).

[NetModule](https://www.netmodule.com/en/) is an Original Equipment Manufacturer of industrial grade routers. The vulnerabilities identified within the web management interface allow authenticated users to execute arbitrary commands with elevated privileges or to access any file on the system.

These vulnerabilities were automatically identified by our platform during one of those industrial routers firmware scan:

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8ba83f607cce5d361c8f_netmodule_taint.png)

All our findings were validated using an emulated device and reported to NetModule, whose PSIRT team confirmed our findings.

| **Affected vendor & product** | * NetModule NB1601 * NetModule NB1800 * NetModule NB1810 * NetModule NB2800 * NetModule NB2810 * NetModule NB3701 * NetModule NB3800 * NetModule NB800 * NetModule NG800   Some of these models are also branded as "HOTSPLOTS" and "Hahlbrock Marine Technologie". |
| --- | --- |
| **Vendor Advisory** | <https://share.netmodule.com/public/system-software/4.7/4.7.0.103/NRSW-RN-4.7.0.103.pdf> |
| **Vulnerable version** | * < 4.3.0.119 * < 4.4.0.118 * < 4.6.0.105 * < 4.7.0.103 |
| **Fixed version** | * 4.3.0.119 * 4.4.0.118 * 4.6.0.105 * 4.7.0.103 |
| **CVE IDs** | [CVE-2023-0861](https://www.cve.org/cverecord?id=CVE-2023-0861)  [CVE-2023-0862](https://www.cve.org/cverecord?id=CVE-2023-0862) |
| **Impact (CVSS)** | 7.2 (high) - [AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H&version=3.1) |
| **Credit** | Q. Kaiser, ONEKEY Research LabResearch supported by [Certainity](https://www.certainity.com/) |

##

## Authenticated Command Injection

### Summary

The NetModule web administration interface executes an OS command constructed with unsanitized user input.

### Impact

A successful exploit could allow an authenticated user to execute arbitrary commands with elevated privileges.

### Description

The NetModule Router Software web admin interface is written in PHP and has a page allowing for GNSS receiver configuration at `/home/www-data/admin/gnssAutoAlign.php`.

On line 36, the script calls `exec` with an unsanitized `$device_id` variable obtained from the POST request on line 6:

```
<?php
require_once('config/config.php');
if (isset($c))
    $device_id = $c;
else
    $device_id = $_REQUEST['device_id'];

$status = "disabled";
define("STATUS_FILENAME", "/tmp/status/gnss". $device_id ."/dr-auto-align");
define("ANGLES_FILENAME", "/tmp/status/gnss". $device_id ."/dr-auto-align-angles");
define("PID_FILENAME", "/run/gnss". $device_id ."/dr-auto-align.pid");

if (file_exists(STATUS_FILENAME)) {
    $statusfile = fopen(STATUS_FILENAME, "r");
    $status = fread($statusfile, filesize(STATUS_FILENAME));
    fclose($statusfile);
}

$yaw = "n/a";
$pitch = "n/a";
$roll = "n/a";
if (file_exists(ANGLES_FILENAME)) {
    $anglesfile = fopen(ANGLES_FILENAME, "r");
    $angles = fread($anglesfile, filesize(ANGLES_FILENAME));
    fclose($anglesfile);

    $angles = explode("\n", $angles);
    $yaw = explode("yaw: ", $angles[0])[1];
    $pitch = explode("pitch: ", $angles[1])[1];
    $roll = explode("roll: ", $angles[2])[1];

}

if (isset($_POST['toggleAlignment'])) {
    if ($status == "disabled") {
        exec("/usr/local/sbin/www-scripts/various/doAutoAlignment " . $device_id . " > /dev/null &");
        $status = "starting";
    }
    else {
        exec("kill $(cat ". PID_FILENAME . ")");
        $status = "stopping";
    }
}
```

## Authenticated Path Traversal

### Summary

The NetModule web administration interface is vulnerable to path traversals, which could lead to arbitrary file uploads and deletion.

### Impact

By uploading a malicious PHP file within the web administration root directory, an authenticated user could gain unconstrained remote command execution.

### Description

The NetModule Router Software web admin interface is written in PHP and has a page to handle what they call "SDK jobs" at `/home/www-data/admin/include/sdkJobs.php`. This script calls `move_uploaded_file` on line 320 with unsanitized user input:

```
if (!move_uploaded_file($_FILES["scriptUpload"]["tmp_name"], $uploadpath))
```

The unsanitized user input is constructed this way:

```
$name = trim($_POST['scriptName']);
$uploadpath = UPLOAD_DIR . "/" . $name;
```

## Key Takeaways

Obviously, updates need to be installed to resolve the reported vulnerabilities. But although prior authentication is required to exploit this vulnerability, this issue serves as an example of a mission-critical device being shipped with high-risk vulnerabilities. Ideally, such issues would be discovered during the vendor's quality assurance processes, but operators of critical infrastructure in particular must practice due diligence. In this writeup, we demonstrate that this does not always need to be a manual test but that the better part of such an assessment can be automated.

## Timeline

**2022-09-20** â Sent coordinated disclosure request to support@netmodule.com

**2022-09-20** â Answer from NetModule Support, establishment of secure communication channel and report sent out.

**2022-10-17** â First feedback from NetModule dev team.

**2022-11-15** â Coordination between NetModule and ONEKEY on firmware release planning.

**2022-11-28** â NetModule releases fixed firmware for supported branches. ONEKEY and NetModule agree on embargo on publication to allow for NetModule clients to apply patches

**2023-02-24** â ONEKEY releases its advisory

Share
## About Onekey

[ONEKEY](/) is the leading European specialist in Product Cybersecurity & Compliance Management and part of the investment portfolio of [PricewaterhouseCoopers Germany (PwC)](https://www.pwc.de/de.html). The unique combination of an automated Product Cybersecurity & Compliance Platform (PCCP) with expert knowledge and consulting services provides fast and comprehensive analysis, support, and management to improve product cybersecurity and compliance from product purchasing, design, development, production to end-of-life.

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/67583204f930179edfad5cb3_2024-09%20ONEKEY-TEAM_Mallorca.avif)

CONTACT:

Marketing Manager
sara.fortmann@onekey.com

euromarcom public relations GmbH
+49 611 973 150
team@euromarcom.de

## RELATED RESEARCH ARTICLES

![Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/675192012562197008d3c477_Image%20Frame%20124.avif)ResearchDec 5, 202410Â min read
### Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones

Explore the latest developments in Unblob, including enhanced sandboxing with Landlock, improved carving reporting, and ÏÂ² randomness analysis. Celebrate community contributions, academic research collaborations, and new format handlers, while looking forward to exciting updates in 2025.

[Read More](/resource/unblob-2024-highlights-sandboxing-reporting-and-community-milestones)![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)ResearchNov 26, 202420Â min read
### Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers

Discover how severe security flaws, including unauthenticated remote command execution (CVE-2024-11665 & CVE-2024-11666), affect eCharge EV charging controllers. Learn about insecure firmware practices, cloud infrastructure issues, and actionable steps to mitigate risks in EV charging systems.

[Read More](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)![Security Advisory: Unauthenticated Command Injection in Mitel IP Phones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67209c8a2e0431878267653a_AdobeStock_493462234.jpeg)ResearchNov 17, 202415Â min read
### Security Advisory: Unauthenticated Command Injection in Mitel IP Phones

Discover critical vulnerabilities in Mitel SIP phones that allow unauthenticated command injection. Learn how outdated input parsing can expose your devices and why it's essential to scan firmware for security risks. Protect your network with our in-depth analysis and expert takeaways.

[Read More](/resource/security-advisory-unauthenticated-command-injection-in-mitel-ip-phones)
## Ready to automate your Product Cybersecurity & Compliance?

Make cybersecurity and compliance efficient and effective withÂ ONEKEY.

[Book a Demo](/book-a-demo)

![onekey logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66ec7d83c10fbfa879b33dd9_ONEKEY_Logo_Neon.svg)Solutions[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)[SBOM Management](/use-case/sbom-management)Product[Platform Overview](/platform-overview)[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis) [Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[Telco](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)Company[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Releases](/press-releases)Social[LinkedIn](https://www.linkedin.com/company/onekey-sec/)[Twitter (X)](https://x.com/onekey_sec)

[Privacy policy](/privacy-policy)[Impressum](/imprint)[Responsible Disclosure Policy](/responsible-disclosure-policy)![Security logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9c52cda15bb54ea28e_Frame%201000003145.png)![Allianz logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d773dfd7f6acbffc5_Frame%201000003146.avif)![Cybersecurity Made In Europe logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d6e4f46bc39d692ea_Frame%201000003144.avif)![ECSO logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d1b01b2cbe0045cea_Frame%201000003152.avif)ONEKeY 2024


