Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The script `find_full_subnets.php` did not verify if the user was authorized to access the data or if the script was executed from the command line interface (CLI).

**Weaknesses/Vulnerabilities Present:**
- **Lack of Authorization Check:** The script allowed access to sensitive data without verifying user permissions.
- **Lack of CLI Restriction:** The script could be executed through a web interface, potentially exposing it to unauthorized users.

**Impact of Exploitation:**
An unauthorized user could potentially gain access to sensitive subnet data by executing the script through a web interface.

**Attack Vectors:**
- Accessing the `find_full_subnets.php` script via a web interface.

**Required Attacker Capabilities/Position:**
- The attacker needs access to the web server where phpipam is deployed.
- The attacker does not need to be authenticated.

**Additional Notes:**
- The fix implemented adds a check to ensure the script is only executed from the CLI.
- The vulnerability was reported by "ovprophet."
- This commit also fixes a reflected XSS vulnerability in `bw-calulator-result.php`.