=== Content from gitlab.com_69a24986_20250114_191227.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Private project guests can leak source code using a fork

**[HackerOne report #1837937](https://hackerone.com/reports/1837937)** by `shells3c` on 2023-01-18, assigned to [@fvpotvin](/fvpotvin "Félix Veillette-Potvin"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Guests are not allowed to read the repository of private project, however, if they can have access to any fork of that project, they can read new code changes compared to the fork.

The exploit uses "Compare Git revisions" feature, even though the security checks are performed pretty well in the UI, the API lacks a bit.

##### Steps to reproduce

1. As user A, create a private project, create file `dummy.txt` with the content: `original content`
2. Invite user B to the private project as **Reporter**
3. As user B, fork the private project
4. Now user A downgrades user B permission to **Guest**, which means user B can't read the repository anymore
5. User A edits `dummy.txt` content to `edited content`
6. User B visits the following URL to see the recent change from user A: `https://gitlab.com/api/v4/projects/<FORK ID>/repository/compare?from=main&to=main&straight=true&from_project_id=<PROJECT ID>`

**Note**: It's not necessary that the fork must be yours, it can be anyone's fork as long as you have `read_code` access. For example, the private project was formally a public project and someone forked it, or a private fork changed the visibility to public, or you request access to a private fork, a lot of scenarios can happen

##### Output of checks

This bug happens on GitLab.com

#### Impact

Guests can read the repository of the private project through a fork

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_ebd25c1d_20250114_191225.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-0485.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-0485.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-0485.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-0485.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 03, 2023

  [acdee4fd](/gitlab-org/cves/-/commit/acdee4fdfaf2e44bd5cc887111e2280d131d6d20)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/acdee4fdfaf2e44bd5cc887111e2280d131d6d20)
  ·
  acdee4fd

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 03, 2023

  acdee4fd

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/acdee4fdfaf2e44bd5cc887111e2280d131d6d20)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 03, 2023

Loading


