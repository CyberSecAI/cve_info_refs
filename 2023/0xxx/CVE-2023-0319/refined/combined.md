=== Content from gitlab.com_49ea7d9d_20250115_093136.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2023](/gitlab-org/cves/-/tree/master/2023)
* [**CVE-2023-0319.json**](/gitlab-org/cves/-/blob/master/2023/CVE-2023-0319.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2023/CVE-2023-0319.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2023/CVE-2023-0319.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Mar 31, 2023

  [8d18172f](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  [Publishing 0 updated advisories and 14 new advisories](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  Â·
  8d18172f

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Mar 31, 2023

  8d18172f

  [Publishing 0 updated advisories and 14 new advisories](/gitlab-org/cves/-/commit/8d18172ffea7124ae2e70a8047ca676f0e4df091)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Mar 31, 2023

Loading



=== Content from gitlab.com_8ac50e89_20250115_093137.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Unauthenticated users can view Environment names from public projects limited to project members only

**[HackerOne report #1817586](https://hackerone.com/reports/1817586)** by `ashish_r_padelkar` on 2022-12-27, assigned to `Ottilia Westerlund`:

### Overview

The following issue was reported by `ashis_r_padelkar` via HackerOne:

> Hello,
>
> I reported this similar issue before #1083430 but then it was a different permission model than now. Now there is a separate permissions that can be set specifically for `Environments`.
>
> As per this <https://docs.gitlab.com/ee/ci/environments/index.html>, `You must have at least the Reporter role.` to view list of environments. However, it is possible for unauthenticated users to see the list of environment names even when environments are set to `Only Project Members`.

### Steps to reproduce

1. Create a public group as `Group_1` and then public project underneath as `Project_1`.
2. In `Project_1`, under **Settings** > **General**, set `Environments` to be visible for `Only Project Members`.
3. Create few environments from the **Environments** page.
4. If you browse as an unauthenticated user to the **Environments** page, you will get a not found error.
5. Now browse to: `/groups/Group_1/-/unfoldered_environment_names.json` and you'll see a list of the environment names.

### Examples

* <https://gitlab.com/groups/groupplanfree/-/unfoldered_environment_names.json>

### What is the current *bug* behavior?

Unauthenticated users can see a list of environment names despite they are set to be visible for `Only Project Members`.

### What is the expected *correct* behavior?

Only project members should see the names of environments when set as `Only Project Members`.

### Output of checks

This bug happens on GitLab.com â€“ `GitLab Enterprise Edition 15.8.0-pre 8831299643f`.

### Impact

Unauthenticated users can view environment names from public projects limited to project members only.

### Proposal

Use a `before_action` to authorize a user can read environments for that particular action.

As an example, you could do something similar to [`EnvironmentsController`](https://gitlab.com/gitlab-org/gitlab/-/blob/e063e2b2e40c7dae6543b54d63507620948e6149/app/controllers/projects/environments_controller.rb#L23):

```
  before_action :authorize_read_environment!, only: [:unfoldered_environment_names]
```

Edited Jan 27, 2023 by [Ahmed Hemdan](/ahmed.hemdan)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


