The provided content relates to CVE-2023-0549.

**Root cause of vulnerability:**
The vulnerability is due to the lack of proper input sanitization in the "Send Private Message" functionality of the YAF.NET forum software. Specifically, the subject and message fields of private messages were not being sanitized, allowing for the injection of arbitrary JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- Inadequate input sanitization of user-provided data in the subject and message fields of private messages.
- Lack of HTML stripping/encoding on user-provided input before rendering it in the context of private messages.

**Impact of exploitation:**
- Attackers can inject malicious JavaScript code into the subject and message fields of private messages.
- This injected code can be executed when a user views the crafted message, potentially leading to:
    - Credential disclosure (stealing cookies or session tokens).
    - Unauthorized actions on behalf of the victim user.
    - Defacement of the web page.
    - Other malicious activity depending on the attacker's injected payload.

**Attack vectors:**
- The attacker crafts a private message containing a malicious XSS payload in the subject or message fields.
- The attacker sends this message to the victim user.
- The victim user views the message, causing the malicious JavaScript to execute in their browser.

**Required attacker capabilities/position:**
- The attacker must have an account on the forum.
- The attacker must be able to send private messages to the victim user.
- No special privileges are required, a standard user account is enough.

**Additional details:**
- The vulnerability affects YAF.NET versions 3.1.9 and 3.1.10.
- The vulnerability is fixed in version 3.1.11 by implementing HTML stripping on the subject and message fields using `HtmlHelper.StripHtml()`.
- The vulnerable code is located in `PostPrivateMessage.cshtml.cs`, `PrivateMessage.ascx` and `PrivateMessage.ascx.cs` files.
- The provided PoC ( `<img src=/ onmouseover=alert('send\_XSS\_from\_chtsec\_user\_in\_the\_Subject')>`) demonstrates how an attacker can use an `onmouseover` event to trigger the payload when the user hovers over the message.
- The CVSS score is 8.2 which indicates a High severity.
- The attack vector is "Network", which means it can be exploited remotely.
- The attack complexity is "Low", which means it is relatively easy to perform.
- The attacker requires "Low" privileges.
- "User interaction" is required, because the victim must open the message.
- The scope is "Changed" which means the vulnerability can impact resources beyond the vulnerable component.
- The confidentiality impact is "High", as attackers could potentially access sensitive data.
- Integrity and Availability impacts are "Low".