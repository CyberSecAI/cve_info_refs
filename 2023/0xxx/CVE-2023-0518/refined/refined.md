```json
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is due to a lack of size checks when processing Helm chart files. When a Helm chart is uploaded, GitLab extracts metadata in a Sidekiq background job by reading the Chart.yaml file. The code does not limit the amount of data read from this file.",
    "weaknesses": [
      "Insufficient size checks on uploaded files",
      "Uncontrolled resource consumption (memory)"
    ],
    "impact": "An attacker can cause a denial-of-service (DoS) by exhausting the memory of Sidekiq worker processes. This can interrupt background jobs, delay their execution, or prevent them from running, which can impact core GitLab functionalities such as CI pipelines.",
    "attack_vectors": [
      "Uploading a specially crafted Helm chart (.tar.gz) file containing a large Chart.yaml file to a GitLab project's Helm package repository."
    ],
    "attacker_capabilities": "The attacker needs to have the ability to upload Helm packages to a project repository. This could be achieved through having a personal access token with write permissions to a project.",
    "additional_details": "The attacker can create a small (few megabyte) archive containing a large (2GB) Chart.yaml file. When this archive is processed by GitLab during Helm package upload, the Sidekiq job attempts to read the entire contents of this file into memory, leading to an out-of-memory (OOM) error and causing the worker process to crash. While there is a limitation in Ruby's Zlib where reading a file larger than 2147483647 bytes throws an exception, the memory consumption up to that limit is still enough to crash a typical Sidekiq instance."
  }
}
```