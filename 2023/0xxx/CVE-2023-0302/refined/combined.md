=== Content from github.com_562515b5_20250114_230838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F961f0e723903011d4f54c2396e44efa91fcc74ce)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F961f0e723903011d4f54c2396e44efa91fcc74ce)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

## Commit

[Permalink](/radareorg/radare2/commit/961f0e723903011d4f54c2396e44efa91fcc74ce)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix ANSI Escape Sequence Injection vulns via DWARF ##vuln

[Browse files](/radareorg/radare2/tree/961f0e723903011d4f54c2396e44efa91fcc74ce)
Browse the repository at this point in the history

```
* Reported by [@solid-snail](https://github.com/solid-snail) via huntrdev
* BountyID: 583133af-7ae6-4a21-beef-a4b0182cf82e
* Reproducer: dwarf_test_func_patched
```

* Loading branch information

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

[trufae](/radareorg/radare2/commits?author=trufae "View all commits by trufae")
authored
Jan 6, 2023

1 parent
[634219b](/radareorg/radare2/commit/634219b2e5e030aa94a31efac0d3697bc710cce7)

commit 961f0e7

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**107 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* libr

  + anal

    - libr/anal/meta.c
      [meta.c](#diff-c3197a98a0b0f4c7500a9e10a44baf5526d25b162c5f3ef41406ce849c4b52a0)
  + bin

    - libr/bin/dwarf.c
      [dwarf.c](#diff-2b22a8aedd59cf71f388f7657c4916ed9ade75c94cc493194f5181ae28695547)
  + cons

    - libr/cons/hud.c
      [hud.c](#diff-54b18d841b00dc0fa75fb388adda0a6b11b1ec481806d8aa4e2ac0d09964951b)
  + core

    - libr/core/cmd\_meta.c
      [cmd\_meta.c](#diff-a6e123608d10a5cb45febfa0d3f01fca0b178dfad46029918b3028406b6c12dd)
    - libr/core/cmd\_print.c
      [cmd\_print.c](#diff-10a42b0a50f2c0fb0a019fdf4f9fe0c245ef1d34d051af7ffe7c20ba2b3f62b0)
  + util

    - libr/util/str.c
      [str.c](#diff-635dc0dd3375613b5b5e511ca3c0bde84806fb5083e0dbb39cce9217797efb0c)
* test/db/cmd

  + test/db/cmd/dwarf
    [dwarf](#diff-5183c9c164f6d70e2b6495d63d19e490e6d86cc8a02280751728ebb0a932a1fb)

## There are no files selected for viewing

13 changes: 7 additions & 6 deletions

13
[libr/anal/meta.c](#diff-c3197a98a0b0f4c7500a9e10a44baf5526d25b162c5f3ef41406ce849c4b52a0 "libr/anal/meta.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/anal/meta.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -111,12 +111,13 @@ static bool meta\_set(RAnal \*a, RAnalMetaType type, int subtype, ut64 from, ut64 |
|  |  | item->subtype = subtype; |
|  |  | item->space = space; |
|  |  | free (item->str); |
|  |  | item->str = str ? strdup (str) : NULL; |
|  |  | if (str && !item->str) { |
|  |  | if (!node) { // If we just created this |
|  |  | free (item); |
|  |  | } |
|  |  | return false; |
|  |  | if (R\_STR\_ISNOTEMPTY (str)) { |
|  |  | item->str = strdup (str); |
|  |  | // this breaks the `ecHw` command |
|  |  | // (highlights word in current instruction, which uses ansi |
|  |  | // r\_str\_ansi\_strip (item->str); |
|  |  | } else { |
|  |  | item->str = NULL; |
|  |  | } |
|  |  | R\_DIRTY (a); |
|  |  | if (!node) { |
| Expand Down | |  |

47 changes: 36 additions & 11 deletions

47
[libr/bin/dwarf.c](#diff-2b22a8aedd59cf71f388f7657c4916ed9ade75c94cc493194f5181ae28695547 "libr/bin/dwarf.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/bin/dwarf.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -431,6 +431,7 @@ static const ut8 \*parse\_line\_header\_source(RBinFile \*bf, const ut8 \*buf, const u |
|  |  | int i = 0; |
|  |  | size\_t count; |
|  |  | const ut8 \*tmp\_buf = NULL; |
|  |  | char \*fn = NULL; |
|  |  |  |
|  |  | if (mode == R\_MODE\_PRINT) { |
|  |  | print (" The Directory Table:\n"); |
| Expand Down  Expand Up | | @@ -464,10 +465,12 @@ static const ut8 \*parse\_line\_header\_source(RBinFile \*bf, const ut8 \*buf, const u |
|  |  |  |
|  |  | for (i = 0; i < 2; i++) { |
|  |  | while (buf + 1 < buf\_end) { |
|  |  | const char \*filename = (const char \*)buf; |
|  |  | size\_t maxlen = R\_MIN ((size\_t) (buf\_end - buf - 1), 0xfff); |
|  |  | ut64 id\_idx, mod\_time, file\_len; |
|  |  | size\_t len = r\_str\_nlen (filename, maxlen); |
|  |  | free (fn); |
|  |  | fn = r\_str\_ndup ((const char \*)buf, maxlen); |
|  |  | r\_str\_ansi\_strip (fn); |
|  |  | size\_t len = strlen (fn); |
|  |  |  |
|  |  | if (!len) { |
|  |  | buf++; |
| Expand Down  Expand Up | | @@ -512,7 +515,7 @@ static const ut8 \*parse\_line\_header\_source(RBinFile \*bf, const ut8 \*buf, const u |
|  |  | } |
|  |  |  |
|  |  | if (hdr->file\_names) { |
|  |  | hdr->file\_names[count].name = r\_str\_newf("%s/%s", r\_str\_get (include\_dir), filename); |
|  |  | hdr->file\_names[count].name = r\_str\_newf("%s/%s", r\_str\_get (include\_dir), fn); |
|  |  | hdr->file\_names[count].id\_idx = id\_idx; |
|  |  | hdr->file\_names[count].mod\_time = mod\_time; |
|  |  | hdr->file\_names[count].file\_len = file\_len; |
| Expand All | | @@ -525,7 +528,8 @@ static const ut8 \*parse\_line\_header\_source(RBinFile \*bf, const ut8 \*buf, const u |
|  |  | } |
|  |  | count++; |
|  |  | if (mode == R\_MODE\_PRINT && i) { |
|  |  | print (" %d %" PFMT64d " %" PFMT64d " %" PFMT64d " %s\n", entry\_index++, id\_idx, mod\_time, file\_len, filename); |
|  |  | print (" %d %" PFMT64d " %" PFMT64d " %" PFMT64d " %s\n", |
|  |  | entry\_index++, id\_idx, mod\_time, file\_len, fn); |
|  |  | } |
|  |  | } |
|  |  | if (i == 0) { |
| Expand All | | @@ -544,6 +548,7 @@ static const ut8 \*parse\_line\_header\_source(RBinFile \*bf, const ut8 \*buf, const u |
|  |  | } |
|  |  |  |
|  |  | beach: |
|  |  | free (fn); |
|  |  | sdb\_free (sdb); |
|  |  |  |
|  |  | return buf; |
| Expand Down  Expand Up | | @@ -677,7 +682,6 @@ static const ut8 \*parse\_line\_header( |
|  |  |  |
|  |  | static inline void add\_sdb\_addrline(Sdb \*s, ut64 addr, const char \*file, ut64 line, int mode, PrintfCallback print) { |
|  |  | const char \*p; |
|  |  | char \*fileline; |
|  |  | char offset[SDB\_NUM\_BUFSZ]; |
|  |  | char \*offset\_ptr; |
|  |  |  |
| Expand Down  Expand Up | | @@ -706,7 +710,10 @@ static inline void add\_sdb\_addrline(Sdb \*s, ut64 addr, const char \*file, ut64 li |
|  |  | #else |
|  |  | p = file; |
|  |  | #endif |
|  |  | fileline = r\_str\_newf ("%s|%"PFMT64d, p, line); |
|  |  | char \*fileline = r\_str\_newf ("%s|%"PFMT64d, p, line); |
|  |  | r\_str\_ansi\_strip (fileline); |
|  |  | r\_str\_replace\_ch (fileline, '\n', 0, true); |
|  |  | r\_str\_replace\_ch (fileline, '\t', 0, true); |
|  |  | offset\_ptr = sdb\_itoa (addr, 16, offset, sizeof (offset)); |
|  |  | sdb\_add (s, offset\_ptr, fileline, 0); |
|  |  | sdb\_add (s, fileline, offset\_ptr, 0); |
| Expand Down  Expand Up | | @@ -1666,7 +1673,15 @@ static const ut8 \*parse\_attr\_value(const ut8 \*obuf, int obuf\_len, |
|  |  | break; |
|  |  | case DW\_FORM\_string: |
|  |  | value->kind = DW\_AT\_KIND\_STRING; |
|  |  | value->string.content = \*buf ? r\_str\_ndup ((const char \*)buf, buf\_end - buf) : NULL; |
|  |  | if (\*buf) { |
|  |  | char \*name = r\_str\_ndup ((const char \*)buf, buf\_end - buf); |
|  |  | r\_str\_ansi\_strip (name); |
|  |  | r\_str\_replace\_ch (name, '\n', 0, true); |
|  |  | r\_str\_replace\_ch (name, '\t', 0, true); |
|  |  | value->string.content = name; |
|  |  | } else { |
|  |  | value->string.content = NULL; |
|  |  | } |
|  |  | if (value->string.content) { |
|  |  | buf += strlen (value->string.content) + 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1711,8 +1726,15 @@ static const ut8 \*parse\_attr\_value(const ut8 \*obuf, int obuf\_len, |
|  |  | value->kind = DW\_AT\_KIND\_STRING; |
|  |  | value->string.offset = dwarf\_read\_offset (hdr->is\_64bit, &buf, buf\_end); |
|  |  | if (debug\_str && value->string.offset < debug\_str\_len) { |
|  |  | const char \*ds = (const char \*)(debug\_str + value->string.offset); |
|  |  | value->string.content = strdup (ds); // r\_str\_ndup (ds, debug\_str\_len - value->string.offset); |
|  |  | char \*ds = r\_str\_ndup ((const char \*)(debug\_str + value->string.offset), debug\_str\_len); |
|  |  | if (ds) { |
|  |  | r\_str\_ansi\_strip (ds); |
|  |  | r\_str\_replace\_ch (ds, '\n', 0, true); |
|  |  | r\_str\_replace\_ch (ds, '\t', 0, true); |
|  |  | value->string.content = ds; |
|  |  | } else { |
|  |  | value->string.content = NULL; |
|  |  | } |
|  |  | } else { |
|  |  | value->string.content = NULL; // Means malformed DWARF, should we print error message? |
|  |  | } |
| Expand Down  Expand Up | | @@ -1903,8 +1925,11 @@ static const ut8 \*parse\_die(const ut8 \*buf, const ut8 \*buf\_end, RBinDwarfAbbrevD |
|  |  | // Or atleast it needs to rework becase there will be |
|  |  | // more comp units -> more comp dirs and only the last one will be kept |
|  |  | if (attribute->attr\_name == DW\_AT\_comp\_dir && is\_valid\_string\_form) { |
|  |  | const char \*name = attribute->string.content; |
|  |  | sdb\_set (sdb, "DW\_AT\_comp\_dir", name, 0); |
|  |  | char \*name = strdup (attribute->string.content); |
|  |  | r\_str\_ansi\_strip (name); |
|  |  | r\_str\_replace\_ch (name, '\n', 0, true); |
|  |  | r\_str\_replace\_ch (name, '\t', 0, true); |
|  |  | sdb\_set\_owned (sdb, "DW\_AT\_comp\_dir", name, 0); |
|  |  | } |
|  |  | die->count++; |
|  |  | } |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[libr/cons/hud.c](#diff-54b18d841b00dc0fa75fb388adda0a6b11b1ec481806d8aa4e2ac0d09964951b "libr/cons/hud.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/cons/hud.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* radare - LGPL - Copyright 2008-2021 - pancake \*/ |
|  |  | /\* radare - LGPL - Copyright 2008-2023 - pancake \*/ |
|  |  |  |
|  |  | #include <r\_cons.h> |
|  |  | #include <ctype.h> |
| Expand All | | @@ -9,6 +9,7 @@ |
|  |  | R\_API char \*r\_cons\_hud\_file(const char \*f) { |
|  |  | char \*s = r\_file\_slurp (f, NULL); |
|  |  | if (s) { |
|  |  | r\_str\_ansi\_strip (s); |
|  |  | char \*ret = r\_cons\_hud\_string (s); |
|  |  | free (s); |
|  |  | return ret; |
| Expand All | | @@ -29,6 +30,7 @@ R\_API char \*r\_cons\_hud\_line\_string(const char \*s) { |
|  |  | } |
|  |  | r\_str\_replace\_ch (o, '\r', 0, true); |
|  |  | r\_str\_replace\_ch (o, '\t', 0, true); |
|  |  | r\_str\_ansi\_strip (o); |
|  |  | RList \*fl = r\_list\_new (); |
|  |  | int i; |
|  |  | if (!fl) { |
| Expand Down  Expand Up | | @@ -66,6 +68,7 @@ R\_API char \*r\_cons\_hud\_string(const char \*s) { |
|  |  | if (!o) { |
|  |  | return NULL; |
|  |  | } |
|  |  | r\_str\_ansi\_strip (o); |
|  |  | r\_str\_replace\_ch (o, '\r', 0, true); |
|  |  | r\_str\_replace\_ch (o, '\t', 0, true); |
|  |  | RList \*fl = r\_list\_new (); |
| Expand Down | |  |

5 changes: 3 additions & 2 deletions

5
[libr/core/cmd\_meta.c](#diff-a6e123608d10a5cb45febfa0d3f01fca0b178dfad46029918b3028406b6c12dd "libr/core/cmd_meta.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/core/cmd_meta.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -539,10 +539,10 @@ static int cmd\_meta\_comment(RCore \*core, const char \*input) { |
|  |  | break; |
|  |  | case '!': |
|  |  | { |
|  |  | char \*out; |
|  |  | const char \*comment = r\_meta\_get\_string (core->anal, R\_META\_TYPE\_COMMENT, addr); |
|  |  | out = r\_core\_editor (core, NULL, comment); |
|  |  | char \*out = r\_core\_editor (core, NULL, comment); |
|  |  | if (out) { |
|  |  | r\_str\_ansi\_strip (out); |
|  |  | //r\_meta\_set (core->anal->meta, R\_META\_TYPE\_COMMENT, addr, 0, out); |
|  |  | r\_core\_cmdf (core, "CC-@0x%08"PFMT64x, addr); |
|  |  | //r\_meta\_del (core->anal->meta, input[0], addr, addr+1); |
| Expand All | | @@ -560,6 +560,7 @@ static int cmd\_meta\_comment(RCore \*core, const char \*input) { |
|  |  | char \*text; |
|  |  | char \*nc = strdup (newcomment); |
|  |  | r\_str\_unescape (nc); |
|  |  | r\_str\_ansi\_strip (nc); |
|  |  | if (comment) { |
|  |  | text = malloc (strlen (comment) + strlen (newcomment) + 2); |
|  |  | if (text) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[libr/core/cmd\_print.c](#diff-10a42b0a50f2c0fb0a019fdf4f9fe0c245ef1d34d051af7ffe7c20ba2b3f62b0 "libr/core/cmd_print.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/core/cmd_print.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* radare - LGPL - Copyright 2009-2022 - pancake \*/ |
|  |  | /\* radare - LGPL - Copyright 2009-2023 - pancake \*/ |
|  |  |  |
|  |  | #include <r\_core.h> |
|  |  | #include <limits.h> |
| Expand Down | |  |

6 changes: 4 additions & 2 deletions

6
[libr/util/str.c](#diff-635dc0dd3375613b5b5e511ca3c0bde84806fb5083e0dbb39cce9217797efb0c "libr/util/str.c")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/libr/util/str.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1957,14 +1957,16 @@ R\_API size\_t r\_str\_ansi\_nlen(const char \*str, size\_t slen) { |
|  |  | } |
|  |  |  |
|  |  | // remove ansi escape codes from string, decolorizing it |
|  |  | // TODO : optimize by just using two counter variables instead of strcpy() |
|  |  | R\_API size\_t r\_str\_ansi\_strip(char \*str) { |
|  |  | size\_t i = 0; |
|  |  | while (str[i]) { |
|  |  | size\_t chlen = \_\_str\_ansi\_length (str + i); |
|  |  | if (chlen > 1) { |
|  |  | r\_str\_cpy (str + i + 1, str + i + chlen); |
|  |  | r\_str\_cpy (str + i, str + i + chlen); |
|  |  | } else { |
|  |  | i++; |
|  |  | } |
|  |  | i++; |
|  |  | } |
|  |  | return i; |
|  |  | } |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[test/db/cmd/dwarf](#diff-5183c9c164f6d70e2b6495d63d19e490e6d86cc8a02280751728ebb0a932a1fb "test/db/cmd/dwarf")

Show comments

[View file](/radareorg/radare2/blob/961f0e723903011d4f54c2396e44efa91fcc74ce/test/db/cmd/dwarf)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,55 @@ |
|  |  | NAME="ansi injection via dwarf" |
|  |  | FILE=bins/elf/dwarf\_test\_func\_patched |
|  |  | ARGS=-AA |
|  |  | CMDS=<<EOF |
|  |  | CL |
|  |  | xc |
|  |  | EOF |
|  |  | EXPECT=<<EOF |
|  |  | file: /\_test.c |
|  |  | line: 5 |
|  |  | addr: 0x00001159 |
|  |  | file: /\_test.c |
|  |  | line: 11 |
|  |  | addr: 0x00001184 |
|  |  | file: /\_test.c |
|  |  | line: 6 |
|  |  | addr: 0x00001165 |
|  |  | file: /\_test.c |
|  |  | line: 11 |
|  |  | addr: 0x00001186 |
|  |  | file: /\_test.c |
|  |  | line: 9 |
|  |  | addr: 0x00001170 |
|  |  | file: /\_test.c |
|  |  | line: 8 |
|  |  | addr: 0x00001168 |
|  |  | file: /\_test.c |
|  |  | line: 4 |
|  |  | addr: 0x00001149 |
|  |  | file: /\_test.c |
|  |  | line: 10 |
|  |  | addr: 0x0000117f |
|  |  | - offset - 6061 6263 6465 6667 6869 6A6B 6C6D 6E6F 0123456789ABCDEF comment |
|  |  | 0x00001060 f30f 1efa 31ed 4989 d15e 4889 e248 83e4 ....1.I..^H..H.. ; rip ; [16] -r-x section size 294 named .text ; arg3 |
|  |  | 0x00001070 f050 5445 31c0 31c9 488d 3de9 0000 00ff .PTE1.1.H.=..... |
|  |  | 0x00001080 1553 2f00 00f4 662e 0f1f 8400 0000 0000 .S/...f......... |
|  |  | 0x00001090 488d 3d79 2f00 0048 8d05 722f 0000 4839 H.=y/..H..r/..H9 ; sym.deregister\_tm\_clones |
|  |  | 0x000010a0 f874 1548 8b05 362f 0000 4885 c074 09ff .t.H..6/..H..t.. |
|  |  | 0x000010b0 e00f 1f80 0000 0000 c30f 1f80 0000 0000 ................ |
|  |  | 0x000010c0 488d 3d49 2f00 0048 8d35 422f 0000 4829 H.=I/..H.5B/..H) ; sym.register\_tm\_clones |
|  |  | 0x000010d0 fe48 89f0 48c1 ee3f 48c1 f803 4801 c648 .H..H..?H...H..H |
|  |  | 0x000010e0 d1fe 7414 488b 0505 2f00 0048 85c0 7408 ..t.H.../..H..t. |
|  |  | 0x000010f0 ffe0 660f 1f44 0000 c30f 1f80 0000 0000 ..f..D.......... |
|  |  | 0x00001100 f30f 1efa 803d 052f 0000 0075 2b55 4883 .....=./...u+UH. ; sym.\_\_do\_global\_dtors\_aux |
|  |  | 0x00001110 3de2 2e00 0000 4889 e574 0c48 8b3d e62e =.....H..t.H.=.. |
|  |  | 0x00001120 0000 e819 ffff ffe8 64ff ffff c605 dd2e ........d....... |
|  |  | 0x00001130 0000 015d c30f 1f00 c30f 1f80 0000 0000 ...]............ |
|  |  | 0x00001140 f30f 1efa e977 ffff fff3 0f1e fa55 4889 .....w.......UH. ; sym.frame\_dummy ; dbg.\_func ; void \_func(char \* msg); |
|  |  | 0x00001150 e548 83ec 1048 897d f848 8b45 f848 89c7 .H...H.}.H.E.H.. ; arg1 ; const char \*s |
|  |  | EOF |
|  |  | RUN |
|  |  |  |
|  |  | NAME="open companion file for macho dwarf" |
|  |  | FILE=bins/mach0/dwarf/a.out |
|  |  | CMDS=<<EOF |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `961f0e7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F961f0e723903011d4f54c2396e44efa91fcc74ce) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from huntr.dev_94727b8f_20250114_230838.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)
