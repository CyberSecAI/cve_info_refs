- **Root cause of vulnerability**: Improper sanitization of LDAP user IDs synced from an LDAP connection. The allowed characters for LDAP user IDs were not restricted in the same way as local user IDs.
- **Weaknesses/vulnerabilities present**: Lack of input validation for LDAP user IDs, allowing for special characters that can be interpreted as file paths or commands.
- **Impact of exploitation**:
    - Malicious actors with the ability to change an LDAP user's `uid` attribute could manipulate files on the server.
    - Attackers could override files in other users' `var/check_mk/web` folder, including deleting their stored two-factor authentication (2FA) credentials, disabling 2FA for the affected user.
    - Attackers could lock users out of their accounts by creating a 2FA-credentials file in the affected user's web folder.
    - Attackers could not directly impersonate other users or take over their accounts.
- **Attack vectors**:
    - Modifying the `uid` attribute of an LDAP user, which is then synchronized with Checkmk.
- **Required attacker capabilities/position**:
    - Ability to change an LDAP user's `uid` attribute.
    - The attacker needs a valid LDAP user account.
    - Access to the Checkmk system.