=== Content from discuss.hashicorp.com_15ffcdd2_20250115_101047.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-05 - Nomad Client Vulnerable to Decompression Bombs in Artifact Block](/t/hcsec-2023-05-nomad-client-vulnerable-to-decompression-bombs-in-artifact-block/50292)

[Security](/c/security/52)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

February 16, 2023, 9:18pm

1

**Bulletin ID:** HCSEC-2023-05

\*\*Affected Products / Versions:**Nomad and Nomad Enterprise 1.2.15 up to 1.3.8, and 1.4.3; fixed in 1.2.16 up to 1.3.9, and 1.4.4.**

**Publication Date:** February 15, 2023

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that a job submitted with a maliciously compressed source (a.k.a “Zip Bomb”) in an artifact stanza can cause excessive disk resource consumption, crashing a Nomad client agent. This vulnerability, CVE-2023-0821, was fixed in Nomad 1.2.16, 1.3.9, and 1.4.4.

**Background**

Nomad utilizes HashiCorp’s [go-getter](https://github.com/hashicorp/go-getter) library for its [artifact](https://developer.hashicorp.com/nomad/docs/job-specification/artifact) stanza that can be included in jobs submitted to the cluster. These custom artifacts (files) can be retrieved using various protocols.

**Details**

During internal investigation, we discovered it was possible to crash Nomad client agents using a malicious crafted compressed artifact source. This behavior may be used by a malicious operator or third party with authenticated access to the [submit-job](https://learn.hashicorp.com/tutorials/nomad/access-control-policies#submit-job) capability to perform a denial of service attack.

Nomad’s usage of go-getter has been modified to allow Nomad administrators to set decompression limits on client agents. These options can be set in a client agent configuration file using artifact.decompression\_size\_limit and artifact.decompression\_file\_count\_limit.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.2.16, 1.3.9, 1.4.4, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by HashiCorp’s Partner Solution engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Nomad 1.4.4, 1.3.9, and 1.2.16 released](https://discuss.hashicorp.com/t/nomad-1-4-4-1-3-9-and-1-2-16-released/50223)  [Release Notifications](/c/release-notifications/57) [nomad](https://discuss.hashicorp.com/tag/nomad) | 0 | 302 | February 15, 2023 |
| [HCSEC-2022-22 - Nomad Panics On Job Submission With Bad Artifact Stanza Source URL](https://discuss.hashicorp.com/t/hcsec-2022-22-nomad-panics-on-job-submission-with-bad-artifact-stanza-source-url/45420)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5733 | October 10, 2022 |
| [HCSEC-2020-21 - Nomad File Sandbox Escape via Template and Artifact Stanzas](https://discuss.hashicorp.com/t/hcsec-2020-21-nomad-file-sandbox-escape-via-template-and-artifact-stanzas/18106)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4245 | November 25, 2020 |
| [HCSEC-2022-14 - Nomad Impacted by go-getter Vulnerabilities](https://discuss.hashicorp.com/t/hcsec-2022-14-nomad-impacted-by-go-getter-vulnerabilities/39932)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6839 | May 24, 2022 |
| [HCSEC-2022-01 - Nomad Artifact Download Race Condition](https://discuss.hashicorp.com/t/hcsec-2022-01-nomad-artifact-download-race-condition/35559)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7462 | February 11, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


