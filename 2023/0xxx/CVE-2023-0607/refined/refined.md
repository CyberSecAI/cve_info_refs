The provided content relates to a commit in the projectsend repository that fixes an XSS vulnerability.

- **Root Cause:** The vulnerability stemmed from the lack of proper sanitization of the `activate_template` GET parameter when changing the client's template. This allowed an attacker to inject malicious code through this parameter.

- **Weaknesses:** The code was vulnerable to Cross-Site Scripting (XSS) due to the unsafe usage of user-supplied input in a redirect. Specifically, the `$_GET['activate_template']` parameter was used to set the selected client template through a `save_option` function, and then redirect the user using `ps_redirect`.  While there is a check to make sure the parameter is part of the allowed templates, this doesn't prevent the vulnerability in case a malicious string is injected. The redirect is vulnerable to XSS.

- **Impact:** By exploiting this XSS vulnerability, an attacker could potentially execute arbitrary JavaScript code in the context of the victim's browser. This could lead to session hijacking, defacement of the website, or other malicious actions.

- **Attack Vector:** The attack vector involves crafting a malicious URL with a crafted `activate_template` parameter. This malicious URL is then provided to a victim (e.g. through social engineering). When the victim accesses this malicious URL, the unsanitized parameter triggers the vulnerability, leading to the execution of attacker-controlled Javascript.

- **Required Attacker Capabilities:** The attacker needs to be able to craft a malicious URL and trick a user into clicking the crafted link.