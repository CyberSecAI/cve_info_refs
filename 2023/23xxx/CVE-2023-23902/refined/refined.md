- **Root cause of vulnerability**: A stack-based buffer overflow exists in the `decrypt_string` function of the Milesight UR32L router's `uhttpd` service when decrypting the login password. The function uses a fixed-size 72-byte stack buffer (`stack_decrypted_string`) to store the decrypted password after Base64 decoding and AES decryption.
- **Weaknesses/vulnerabilities present**: The `EVP_DecryptUpdate` function writes the decrypted content into a fixed-size stack buffer, without proper bounds checking, allowing for a stack-based buffer overflow if the decrypted data is larger than the buffer.
- **Impact of exploitation**: Successful exploitation of this vulnerability leads to remote code execution on the affected device.
- **Attack vectors**: The attacker sends a specially crafted network request to the router's web interface. The request includes a Base64-encoded and AES-encrypted password that, when decrypted, exceeds the size of the stack buffer in the `decrypt_string` function.
- **Required attacker capabilities/position**: The attacker needs to be able to send network requests to the affected device's web interface. No authentication is required prior to triggering the vulnerability.