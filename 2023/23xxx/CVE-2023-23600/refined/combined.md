=== Content from www.mozilla.org_a227e78f_20250114_194417.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-01

## Security Vulnerabilities fixed in Firefox 109

Announced
January 17, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 109

#### [#CVE-2023-23597: Logic bug in process allocation allowed to read arbitrary files](#CVE-2023-23597)

Reporter
Niklas Baumstark
Impact
high
##### Description

A compromised web child process could disable web security opening restrictions, leading to a new child process being spawned within the `file://` context. Given a reliable exploit primitive, this new process could be exploited again leading to arbitrary file read.

##### References

* [Bug 1538028](https://bugzilla.mozilla.org/show_bug.cgi?id=1538028)

#### [#CVE-2023-23598: Arbitrary file read from GTK drag and drop on Linux](#CVE-2023-23598)

Reporter
Tom Schuster
Impact
high
##### Description

Due to the Firefox GTK wrapper code's use of text/plain for drag data and GTK treating all text/plain MIMEs containing file URLs as being dragged a website could arbitrarily read a file via a call to `DataTransfer.setData`.

##### References

* [Bug 1800425](https://bugzilla.mozilla.org/show_bug.cgi?id=1800425)

#### [#CVE-2023-23599: Malicious command could be hidden in devtools output on Windows](#CVE-2023-23599)

Reporter
Vadim
Impact
moderate
##### Description

When copying a network request from the developer tools panel as a curl command the output was not being properly sanitized and could allow arbitrary commands to be hidden within.

##### References

* [Bug 1777800](https://bugzilla.mozilla.org/show_bug.cgi?id=1777800)

#### [#CVE-2023-23600: Notification permissions persisted between Normal and Private Browsing on Android](#CVE-2023-23600)

Reporter
Kazuki Nomoto of Waseda University
Impact
moderate
##### Description

Per origin notification permissions were being stored in a way that didn't take into account what browsing context the permission was granted in. This lead to the possibility of notifications to be displayed during different browsing sessions.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1787034](https://bugzilla.mozilla.org/show_bug.cgi?id=1787034)

#### [#CVE-2023-23601: URL being dragged from cross-origin iframe into same tab triggers navigation](#CVE-2023-23601)

Reporter
Luan Herrera
Impact
moderate
##### Description

Navigations were being allowed when dragging a URL from a cross-origin iframe into the same tab which could lead to website spoofing attacks

##### References

* [Bug 1794268](https://bugzilla.mozilla.org/show_bug.cgi?id=1794268)

#### [#CVE-2023-23602: Content Security Policy wasn't being correctly applied to WebSockets in WebWorkers](#CVE-2023-23602)

Reporter
Dave Vandyke
Impact
moderate
##### Description

A mishandled security check when creating a WebSocket in a WebWorker caused the Content Security Policy connect-src header to be ignored. This could lead to connections to restricted origins from inside WebWorkers.

##### References

* [Bug 1800890](https://bugzilla.mozilla.org/show_bug.cgi?id=1800890)

#### [#CVE-2023-23603: Calls to console.log allowed bypasing Content Security Policy via format directive](#CVE-2023-23603)

Reporter
Dan Veditz
Impact
low
##### Description

Regular expressions used to filter out forbidden properties and values from style directives in calls to `console.log` weren't accounting for external URLs. Data could then be potentially exfiltrated from the browser.

##### References

* [Bug 1800832](https://bugzilla.mozilla.org/show_bug.cgi?id=1800832)

#### [#CVE-2023-23604: Creation of duplicate SystemPrincipal from less secure contexts](#CVE-2023-23604)

Reporter
Nika Layzell
Impact
low
##### Description

A duplicate `SystemPrincipal` object could be created when parsing a non-system html document via `DOMParser::ParseFromSafeString`. This could have lead to bypassing web security checks.

##### References

* [Bug 1802346](https://bugzilla.mozilla.org/show_bug.cgi?id=1802346)

#### [#CVE-2023-23605: Memory safety bugs fixed in Firefox 109 and Firefox ESR 102.7](#CVE-2023-23605)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 108 and Firefox ESR 102.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 109 and Firefox ESR 102.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1764921%2C1802690%2C1806974)

#### [#CVE-2023-23606: Memory safety bugs fixed in Firefox 109](#CVE-2023-23606)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 108. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 109](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1764974%2C1798591%2C1799201%2C1800446%2C1801248%2C1802100%2C1803393%2C1804626%2C1804971%2C1807004)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_a1d94a5b_20250114_194416.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1787034)
* [XML](/show_bug.cgi?ctype=xml&id=1787034)

Closed
[Bug 1787034](/show_bug.cgi?id=1787034)
(CVE-2023-23600)

Opened 2 years ago
Closed 2 years ago

# The notification permission granted in normal browsing mode also applies to private browsing

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

The notification permission granted in normal browsing mode also applies to private browsing

## Categories

### (Fenix :: General, task, P2)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

task

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### (firefox105 wontfix, firefox106 wontfix, firefox107 wontfix, firefox108 wontfix, firefox109 verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox105 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=wontfix) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix) |
| firefox108 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=wontfix) |
| firefox109 | --- | [verified](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox105 |  | wontfix |
| firefox106 |  | wontfix |
| firefox107 |  | wontfix |
| firefox108 |  | wontfix |
| firefox109 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: csadilek, Assigned: amejia)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5b94ed5fbd4cd2feb68a13aa1ff2cde7?d=mm&size=40)  [amejia](/user_profile?user_id=623634)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/cacee3afc0d1d5e9fb61a861b0ed024b?d=mm&size=40)  [csadilek](/user_profile?user_id=590895)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1788720](/show_bug.cgi?id=1788720 "RESOLVED FIXED - Expose private browsing flag in StorageController.getPermissions")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1787034&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1787034)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [geckoview:m107] [geckoview:m108][adv-main109+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-23600

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[geckoview:m107] [geckoview:m108][adv-main109+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a28327092_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [NotificationNightly.mp4](/attachment.cgi?id=9306853)  [2 years ago](#c13)  [Adina Petridean QA [:apetridean]](/user_profile?user_id=709087)   3.76 MB, video/mp4 |  | [Details](/attachment.cgi?id=9306853&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9312390)  [2 years ago](#c15)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   452 bytes, text/plain |  | [Details](/attachment.cgi?id=9312390&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1787034#c0)• 2 years ago |
|  | |

Originated from bug report <https://bugzilla.mozilla.org/show_bug.cgi?id=1784741>

In Firefox on Android, the user's allow/deny selection in Normal Browsing Mode is carried over to Private Browsing Mode in Notification Permission. This vulnerability risks allowing the display of notifications that should not be displayed based on different sessions (e.g., past Private Browsing Mode sessions that should have been discarded or sessions in a different browsing mode).

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1787034#c1)• 2 years ago |
|  | |

The notification permission is granted per application currently. With the work required for Android 13 to switch to runtime permissions for notifications, we could also introduce separate notification channels for different browsing contexts.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1787034#c2)• 2 years ago |
|  | |

The per-app permission is the per-app permission: websites can't detect that. Assuming you've granted the permission to the app, and then grant it to an origin in Normal browsing (say, your webmail or chat site), does a private browsing session on the same origin get that permission or does it have to ask the user separately?

Flags: needinfo?(csadilek)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1787034#c3)• 2 years ago |
|  | |

> The per-app permission is the per-app permission: websites can't detect that.

Sure, sorry for the terse [comment#1](/show_bug.cgi?id=1787034#c1 "VERIFIED FIXED - The notification permission granted in normal browsing mode also applies to private browsing"). Fenix currently stores Notifications permissions per app (OS permission) and per origin (Gecko storage), but not per browsing context. We should fix both, in my opinion. Even the global app permissions could be separate for private browsing mode, but this bug is mainly about the latter.

> does a private browsing session on the same origin get that permission or does it have to ask the user separately?

For Notifications it currently gets it. Jon and I looked into this today and we'll file tickets for the changes we need tomorrow. This is mitigated in my testing because service workers don't run in private browsing, which would mostly trigger notifications. For other permissions, e.g., location, we display a "Remember decision for this site" checkbox, and once checked they will apply to private browsing as well. Both is wrong. We should ask again for private browsing mode.

Flags: needinfo?(csadilek)

|  | [Jonathan Almeida [:jonalmeida]](/user_profile?user_id=541581) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a672478_541581)• 2 years ago |

Depends on: [1788720](/show_bug.cgi?id=1788720 "RESOLVED FIXED - Expose private browsing flag in StorageController.getPermissions")

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a673725_430528)• 2 years ago |

Severity: -- → N/APriority: -- → P2Whiteboard: [geckoview:m107]

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a1884248_623634)• 2 years ago |

Assignee: nobody → amejiamarmol

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1787034#c4)• 2 years ago |
|  | |

107

[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=wontfix)
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=affected)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected)Priority: P2 → P1

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a2490164_430528)• 2 years ago |

Priority: P1 → P2

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1787034#c5)• 2 years ago |
|  | |

108

[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)Whiteboard: [geckoview:m107] → [geckoview:m107] [geckoview:m108]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a6146925_75935)• 2 years ago |

[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix)
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a6165220_430528)• 2 years ago |

Component: Security: Android → General

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1787034#c6)• 2 years ago |
|  | |

Daniel, this bug is marked as a security issue, but it has no `sec-` rating keyword. What priority do you recommend?

Flags: needinfo?(dveditz)Priority: P2 → --

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1787034#c7)• 2 years ago |
|  | |

sec-moderate.

I thought site permissions were handled by Gecko (not the UI part, obviously) and already handled origin attributes. Is Fenix rolling it's own?

Flags: needinfo?(dveditz)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1787034#c8)• 2 years ago |
|  | |

P2 for sec-moderate bug

> I thought site permissions were handled by Gecko (not the UI part, obviously) and already handled origin attributes. Is Fenix rolling it's own?

Fenix handles (some?) site permissions in the front end app. IIUC, GeckoView's original design was to be stateless, with no shared user profiles, but that caused a lot of code duplication so we've backed away from that design.

Severity: N/A → S3Priority: -- → P2

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1787034#c9)• 2 years ago |
|  | |

The AC patch that address this bug just [landed on 109](https://github.com/mozilla-mobile/firefox-android/commit/4ebb616f9a6633e5257850cf2894ebe8e9276ffd), the Fenix patch will land just after the new AC nightly version is available.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1787034#c10)• 2 years ago |
|  | |

The [Fenix patch landed on 109](https://github.com/mozilla-mobile/fenix/pull/27857), the fix should be available the next Fenix nightly update.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1787034#c11)• 2 years ago |
|  | |

Is this something we were thinking we'd eventually want to uplift to 108?

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed)Flags: needinfo?(amejiamarmol)Resolution: --- → FIXED

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1787034#c12)• 2 years ago |
|  | |

I think we could let it ride the trains.

Flags: needinfo?(amejiamarmol)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a7228888_75935)• 2 years ago |

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=wontfix)

|  | [Adina Petridean QA [:apetridean]](/user_profile?user_id=709087) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1787034#c13)• 2 years ago |
|  | |

Attached video
[NotificationNightly.mp4](attachment.cgi?id=9306853)
— [Details](attachment.cgi?id=9306853&action=edit)

|  | [Adina Petridean QA [:apetridean]](/user_profile?user_id=709087) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1787034#c14)• 2 years ago |
|  | |

Verified as fixed on Nightly 109.0a1 from 12/06 with OnePlus 9 Pro (Android 12). The user's allow/deny selection in Normal Browsing Mode is not carried over to Private Browsing Mode in Notification Permission.

If permission for Notifications was previously granted in Normal Browsing, when switching to Private and tapping the Notifications button, a dialog appears asking for the SITE's permission to send notifications.

|  | [Adina Petridean QA [:apetridean]](/user_profile?user_id=709087) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a8954455_709087)• 2 years ago |

Status: RESOLVED → VERIFIED
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=verified)

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a12228912_626341)• 2 years ago |

Whiteboard: [geckoview:m107] [geckoview:m108] → [geckoview:m107] [geckoview:m108][adv-main109+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1787034#c15)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9312390)
— [Details](attachment.cgi?id=9312390&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a12487375_428608)• 2 years ago |

Alias: CVE-2023-23600

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a28247138_1689)• 1 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a28327092_1689)• 1 years ago |

Flags: sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1787034#a55713084_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1787034&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Adina Petridean QA [:apetridean]](/user_profile?user_id=709087)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


