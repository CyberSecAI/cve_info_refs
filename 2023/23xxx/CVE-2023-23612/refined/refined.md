The provided content relates to CVE-2023-23612.

**Root Cause:** The vulnerability stems from how OpenSearch processes JWT role claims obtained from Identity Providers (IdP) via SAML or OpenID Connect. The system trims leading and trailing whitespace from the role claims.

**Vulnerabilities:**
- Improper handling of whitespace in JWT role claims. Specifically, leading and trailing whitespace is trimmed before role comparison.

**Impact:**
- Users can potentially claim roles they are not assigned to if a role exists that matches the whitespace-stripped version of the roles they are actually a member of.
- This allows for privilege escalation.

**Attack Vectors:**
- Authenticated users of OpenSearch where SAML or OpenID Connect are used for authentication.
- The Identity Provider must allow leading and trailing spaces in role names.
- There must exist roles in OpenSearch that match the whitespace-stripped versions of a user's actual roles or a user has the ability to create them.

**Required Attacker Capabilities/Position:**
- An attacker must be an authenticated user of the OpenSearch instance.
- They must have an IdP role name that includes leading or trailing whitespace.
- The OpenSearch instance must have a role that matches the whitespace-stripped version of the userâ€™s role name.
- The attacker needs to have roles assigned that, when whitespace is stripped, match roles they should not have access to.