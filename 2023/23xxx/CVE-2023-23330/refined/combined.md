=== Content from www.amano.eu_a22a98a6_20250114_194051.html ===


 [login](/en/login/ "Login")

[nl](https://www.amano.eu/nl/parking/xparc/)
[en](https://www.amano.eu/en/parking/xparc/)
[fr](https://www.amano.eu/fr/parking/xparc/)
[de](https://www.amano.eu/de/)
[es](https://www.amano.eu/es/aparcamiento/xparc/)
[ro](https://www.amano.eu/ro/)

* [Time](/en/time/)
  + [Astrow](/en/time/solutions/astrow/ "Astrow")
  + [Astrow Mobile](/en/time/solutions/astrow-mobile/ "Astrow Mobile")
  + [Success stories](/en/time/success-stories/ "Success stories")
  + [Terminals](/en/time/solutions/terminals/ "Astrow time registration hardware")
  + [Time Recorders](/en/time/solutions/tcts/ "Time Recorders")
  + [Vertical Markets](/en/time/vertical-markets/ "Vertical Markets")
* [Parking](/en/parking/)
  + [Xparc](/en/parking/xparc/ "Xparc")
  + [Mobile Apps](/en/parking/solutions/mobile-apps/ "Mobile Apps")
  + [Xcharge - Charging Solutions](/en/parking/solutions/charging-solutions/ "Xcharge - Charging Solutions")
  + [Xoffice](/en/parking/solutions/xoffice/ "Xoffice")
  + [Field Devices](/en/parking/solutions/field-devices/ "Field Devices")
  + [Success Stories](/en/parking/success-stories/ "Success Stories")
  + [Services](/en/parking/solutions/services/ "Services")
  + [Vertical Markets](/en/parking/vertical-markets/ "Vertical Markets")
* [Staff safety](/en/staff-safety/)
  + [AstrowACCESS](/en/staff-safety/solutions/astrowaccess/ "AstrowACCESS")
  + [PocketPIP](/en/staff-safety/solutions/pocketpip/ "PocketPIP")
  + [Visitor Management](/en/staff-safety/solutions/visitor-management/ "Visitor Management")
  + [AmanoNET](/en/staff-safety/solutions/amanonet/ "AmanoNET")
  + [Vertical Markets](/en/staff-safety/vertical-markets/ "Vertical Markets")
* [About us](/en/about/)
* [News](/en/news/)
* [Contact](/en/contact/)

**Parking: Xparc**

# Xparc

Amanoâs Xparc parking solutions provide an ideal solution for every type of carpark. With a clear focus on adaptability, daily operations and end-user experience, Xparc strongly contributes to the convenience of both drivers and operators.

| Clear focus on serviceability | Clear focus on serviceability Xparc can be installed locally or in the Cloud and has a clear focus on serviceability towards both the operators and end users. Not only does the software contain a Parking Management system, it also allows for remote intervention on the different field devices. This significantly reduces down time during maintenance works, and at the same prevents travel expenses to be paid by the customer. |
| --- | --- |
| Limitlessness in every aspect | Limitlessness in every aspect Xparc parking operators benefit from the numerous advantages of unlimited configuration of:   * Devices * Season cards * Tariff structures * Xoffice users * â¦ |
| HQ intercom system improving the parking experience | HQ intercom system improving the parking experience Xparc allows for a VoIP connection between IP Phones and the intercom modules in the devices. When used with CCTV, live video support can be activated when the driver presses the intercom request button. These calls can even be forwarded to mobile devices or land lines for off-site, centralized support. |
| User-friendly carpark management tool | User-friendly carpark management tool Xparc comes with a user-friendly carpark management tool, [Xoffice](/en/parking/solutions/xoffice/), of which the access rights can be defined on a strict need-to-know basis. This way, sensitive information like financial results can be limited to managers and / or executives.  Users can connect to Xoffice over a convenient web interface guaranteeing the highest possible degree of security. |
| High degree of extensibility and adaptability | High degree of extensibility and adaptability The open platform Xparc is built upon, allows for a high degree of extensibility and adaptability to:   * Third-party interfaces that either offer or retrieve data to/from Xparc * Functional needs like specific tariffs or reports * Local needs of any kind (e.g. integration of specific additional devices) |
| Full DDA compliancy | Full DDA compliancy  To optimize the parking experience for differently able drivers, the following add-ons can be incorporated:   * Intercom auto on This functionality automatically initiates the intercom when people arenât able to do so themselves. * 2nd screen on sitting height  A second screen can be installed on the sitting height of wheelchair users to make sure they have access to the same information as other parking users. * Hearing loop compatibility For improved support, the intercom can connect to hearing impaired personsâ hearing device. |

**Amano Europe NV**

 Westerring 2

 3600 Genk

 Belgium

 T +32 89 32 39 20

F +32 89 30 69 47

[global site](http://www.amano.co.jp/English/ "Amano International")

[![TeamViewer download](/static/icons/teamviewer-logo.svg "TeamViewer download") TeamViewer](https://download.teamviewer.com/download/TeamViewerQS.exe "Support tool")
[contact](/en/contact/ "Contact Amano")

[intellectual property rights](/en/intellectual-property-rights/)
[privacy policy](http://www.iubenda.com/privacy-policy/75006096/)
[terms of use](/en/terms-of-use/)
[Webdesign ![De Witte Communicatie](https://www.dewitte.be/static/svg/logo-dewitte-web.svg)](https://www.dewitte.be/online/websites/ "De Witte Communicatie")

manage cookies



=== Content from medium.com_38982fad_20250114_194050.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F672ae8fbfd1e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40saleh.py%2Famano-xparc-local-file-inclusion-cve-2023-23330-672ae8fbfd1e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40saleh.py%2Famano-xparc-local-file-inclusion-cve-2023-23330-672ae8fbfd1e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Amano Xparc Local File Inclusion (CVE-2023–23330)

[![Saleh](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](/%40saleh.py?source=post_page---byline--672ae8fbfd1e--------------------------------)

[Saleh](/%40saleh.py?source=post_page---byline--672ae8fbfd1e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5830c2aac68c&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40saleh.py%2Famano-xparc-local-file-inclusion-cve-2023-23330-672ae8fbfd1e&user=Saleh&userId=5830c2aac68c&source=post_page-5830c2aac68c--byline--672ae8fbfd1e---------------------post_header-----------)

4 min read·Feb 21, 2023

--

Listen

Share

# Introduction

Hello everyone, during one of the penetration testing assessments, we faced Amano Xparc parking solution web application. While conducting the assessment we discovered multiple vulnerabilities and we submitted it to <https://cve.mitre.org/>. For your reference the links for the other CVEs blogs:

* **SQL injection CVE-2023–23331:** <https://0xhunter20.medium.com/how-i-found-my-first-blind-sql-injection-cve-2023-23331-aef103a7f73c>

Today I will be demonstrating CVE-2023–23330.

# Vulnerability Details

* **Vulnerable Software**: Amano Xoffice parking solutions
* **Vulnerability:** Local File Inclusion
* **Affected Version:** 7.1 (7.1.3879)
* **Vendor Homepage:**<https://www.amano.eu/en/>
* **CVE:** CVE**-**2023–23330

**What is Local File Inclusion (LFI)?**

*“Local file inclusion (also known as LFI) is the process of including files, that are already locally present on the server, through the exploiting of vulnerable inclusion procedures implemented in the application”*

*- OWASP*

To simplify things, LFI is a vulnerability that abuses a flaw when a server tries to include a file. The idea is to let the include unattended files such as system files or non-published documents.

**Why LFI is there? and how to prevent it.**

It occurs due to the use of user input without validation.

Preventing LFI could be done by considering the following:

* Avoid passing user-submitted input to the system.
* Whitelist files that can be included.
* Reject un-defined/Whitelisted document.
* Do not permit file paths to be appended directly make them hard-coded.
* Use databases instead of filesystems. Either to store the files in the database or store the file path in the database.

# CVE Demo

While exploring the website manually, I noticed a page to download the user manual and guide. I intercepted the request in burp so I can use Burp repeater for easier request manipulation. The image below shows the parameter and user manual file:

![]()

So, clearly, the “file” parameter in the GET request is responsible for specifying the file name. interesting…

Let’s try to change the file name to “/etc/passwd” which is a default file in Linux/Unix servers and readable by all users. The image below shows the try to inject “/etc/passwd”:

![]()

So, it didn’t work directly, as the error shows in the HTTP response the file “../manuals/etc/passwd” was not found.

**No Problem!**

Instead of using the absolute path of “/etc/passwd” we will use the relative path. In file systems to get a file there are two main ways “absolute” or “relative”.

Now let’s fuzz the relative path to know what is the depth of the file. We can use Burp intruder, python scripts, or manually in Burp repeater. The image below shows the first try with a depth of 2 manually in the Burp repeater:

![]()

Didn’t work, let’s try depth 3

![]()

**It worked!**

We were able to include a file from the system without any validation.

The question now is, how to abuse that?

There are multiple ways to exploit this and gain more. Each case or scenario has its own way to go further. However, I may suggest looking into:

* **Config files & Source code**: most of the time DB credentials, API tokens …etc. Are stored in clear-text format either in Config files or source code.
* **Well-Known files**: You may try to access well-known files such as Shadow file, log files, bash history, SSH keys …etc.

For the sake of knowledge, let’s try an example of a source code and SSH key.

![]()

SSH key file

![]()

Version.php file

# **Acknowledgment:**

I would like to thank the teammates: [Fahad Almulhim (0xHunter)](https://medium.com/u/c1402cbf83d?source=post_page---user_mention--672ae8fbfd1e--------------------------------) and Osama Aldosari. Also, many thanks to the Saudi information and technology company — [SITE](https://site.sa/) for their continuous support.

# References:

* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23330>
* <https://0xhunter20.medium.com/how-i-found-my-first-blind-sql-injection-cve-2023-23331-aef103a7f73c>
* <https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion>
[Cve](/tag/cve?source=post_page-----672ae8fbfd1e--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----672ae8fbfd1e--------------------------------)[Penetration Testing](/tag/penetration-testing?source=post_page-----672ae8fbfd1e--------------------------------)[Local File Inclusion](/tag/local-file-inclusion?source=post_page-----672ae8fbfd1e--------------------------------)[Pentesting](/tag/pentesting?source=post_page-----672ae8fbfd1e--------------------------------)

--

--

[![Saleh](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](/%40saleh.py?source=post_page---post_author_info--672ae8fbfd1e--------------------------------)[![Saleh](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](/%40saleh.py?source=post_page---post_author_info--672ae8fbfd1e--------------------------------)Follow[## Written by Saleh](/%40saleh.py?source=post_page---post_author_info--672ae8fbfd1e--------------------------------)[7 Followers](/%40saleh.py/followers?source=post_page---post_author_info--672ae8fbfd1e--------------------------------)·[2 Following](/%40saleh.py/following?source=post_page---post_author_info--672ae8fbfd1e--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----672ae8fbfd1e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----672ae8fbfd1e--------------------------------)[About](/about?autoplay=1&source=post_page-----672ae8fbfd1e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----672ae8fbfd1e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----672ae8fbfd1e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----672ae8fbfd1e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----672ae8fbfd1e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----672ae8fbfd1e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----672ae8fbfd1e--------------------------------)[Teams](/business?source=post_page-----672ae8fbfd1e--------------------------------)


