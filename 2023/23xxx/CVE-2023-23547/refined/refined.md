- **Root cause of vulnerability:** The `file-export` function in `luci2-io` does not sanitize the `file` parameter when constructing the file path, allowing directory traversal. Specifically, the `filepath/dirpath` field is modified to include the unsanitized `file` parameter, which is later used by the `read_file` function.
- **Weaknesses/vulnerabilities present:** Path Traversal (CWE-22) due to insufficient input validation.
- **Impact of exploitation:** An attacker can read arbitrary files on the system by crafting a malicious `file` parameter that includes path traversal sequences like `../`.
- **Attack vectors:** A network request to the `cgi-bin/file-export` endpoint with a malicious `file` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send network requests to the vulnerable device and must have a valid session.