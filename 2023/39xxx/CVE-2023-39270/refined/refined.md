```
{
  "cve": "CVE-2023-39270",
  "description": "Multiple integer overflow vulnerabilities exist in the LXT2 facgeometry parsing functionality of GTKWave 3.3.115. A specially crafted .lxt2 file can lead to arbitrary code execution. A victim would need to open a malicious file to trigger these vulnerabilities.",
  "vulnerability_details": {
    "root_cause": "Integer overflow in the calculation of buffer size when parsing LXT2 facgeometry data, specifically in the allocation of the `rows` array.",
    "weaknesses": [
      "CWE-190 - Integer Overflow or Wraparound",
        "Heap-based buffer overflow"
    ],
      "impact": "Arbitrary code execution due to out-of-bounds write on the heap.",
    "attack_vectors": "A specially crafted .lxt2 file is opened by the victim, which triggers the parsing of a malicious facgeometry structure.",
        "required_capabilities": "The attacker needs to create a malicious .lxt2 file. The victim needs to open this file using GTKWave."
  },
  "affected_versions": [
    "GTKWave 3.3.115"
  ],
  "fixed_versions": [
    "GTKWave 3.3.118"
  ],
    "more_details": "The size of the `rows` array is calculated by multiplying `numfacs` by `sizeof(lxtint32_t)`. When `numfacs` is greater than 0x40000000, this multiplication will wrap around in 32-bit mode, leading to calling `malloc` with a smaller size. Later, a loop writes data to the allocated buffer using `numfacs` as the upper bound, leading to out-of-bounds write. This can overwrite other heap allocated memory, and with proper heap layout, can lead to arbitrary code execution."
}
```