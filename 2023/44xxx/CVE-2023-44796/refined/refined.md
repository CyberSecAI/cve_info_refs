```
{
  "vulnerability": {
    "CVE": "CVE-2023-44796",
    "description": "Cross Site Scripting (XSS) vulnerability in LimeSurvey before version 6.2.9-230925 allows a remote attacker to escalate privileges via a crafted script to the _generaloptions_panel.php component.",
    "affected_versions": "before version 6.2.9-230925",
    "patched_versions": "6.2.9-230925 and later",
    "root_cause": "The vulnerability stems from insufficient sanitization of the `templatename` parameter during the `importManifest` process, which allows an attacker to inject malicious JavaScript code that is then stored and executed when other users access the theme options.",
    "weaknesses": [
      "CWE-79 (Cross-site Scripting)"
    ],
    "impact": "Successful exploitation can lead to stored XSS attacks, enabling attackers to execute arbitrary JavaScript code in the context of other users' browsers, potentially leading to session hijacking, data theft, or other malicious activities.",
    "attack_vector": "Network",
    "attacker_capabilities": "Low privileges (theme permission)",
    "user_interaction": "Required (victim must access the affected pages)",
    "scope": "Changed (vulnerable component impacts resources beyond its security scope)",
     "confidentiality": "Low",
    "integrity": "Low",
    "availability": "None",
     "cvss_v3_base_metrics": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
   "details": [
    {
      "type": "github_commit",
      "url": "https://github.com/LimeSurvey/LimeSurvey/commit/135511073c51c332613dd7fad9a8ca0aad34a3fe",
      "description": "Fixes for the XSS vulnerability by sanitizing the template name in TemplateConfiguration.php and encoding theme names in several view files.",
       "changes": [
          {
            "file": "application/models/TemplateConfiguration.php",
            "changes": "Sanitizes the `template_name` using `sanitize_filename` in the rules() method and when generating URLs for theme-related actions."
          },
          {
            "file": "application/views/admin/globalsettings/_general.php",
            "changes": "Encodes theme names using `CHtml::encode` in the dropdown options for default and admin themes."
          },
           {
            "file": "application/views/admin/survey/subview/accordion/_generaloptions_panel.php",
            "changes": "Encodes theme names using `CHtml::encode` in the dropdown options for survey themes."
          }
      ]
    },
     {
      "type": "github_pull_request",
        "url": "https://github.com/LimeSurvey/LimeSurvey/pull/3483",
        "description": "The pull request that fixed the vulnerability. Includes code review and testing process.",
        "commits":[
              {
              "url":"https://github.com/LimeSurvey/LimeSurvey/pull/3483/commits/ee6ede9af6d9e304461e87f07385e4a72ab0cd46",
              "message":"Fixed issue [security] #19099: XSS vulnerability caused by themeOptions/importManifest Dev: XSS in global settings Dev: always sanitize template name : it's a directory"
             },
             {
             "url":"https://github.com/LimeSurvey/LimeSurvey/pull/3483/commits/d51e5bea25b3fd1dc3ca06fedac5f0cc443969d2",
              "message":"Dev: always encode in option (here add Admin Theme)"
             },
             {
             "url":"https://github.com/LimeSurvey/LimeSurvey/pull/3483/commits/452ca2a39f1fd8e55081bb7e128fe59d540c2ff2",
              "message":"Dev: more encoding"
             }
            ],
       "labels": [
          "Needs code review",
          "Needs testing",
          "Code review done",
           "Tested OK"
          ]
      },
    {
      "type":"github_issue",
        "url":"https://github.com/Hebing123/cve/issues/4",
         "description":"Issue report describing how an attacker can exploit the XSS vulnerability by importing a crafted theme name through importManifest endpoint.",
        "poc":"A user with theme permissions can send a POST request to `/index.php/themeOptions/importManifest` with a malicious `templatename`, which will be stored and trigger the XSS when administrators access the theme settings. The request includes the following parameters:\n  `YII_CSRF_TOKEN`: CSRF token for security.\n `templatename`: Malicious payload such as  `123\"><script>alert(1)</script>//`"
      }
   ]
  }
}
```