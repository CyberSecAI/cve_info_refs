=== Content from www.rfc-editor.org_331029e5_20250114_200538.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc2965.txt)|[PDF](/rfc/pdfrfc/rfc2965.txt.pdf)|[HTML](/rfc/rfc2965.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc2965 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=2965&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc2965)] [[Info page](https://www.rfc-editor.org/info/rfc2965 "Info page")]

Obsoleted by: [6265](/rfc/rfc6265) HISTORIC
 Errata Exist
```
Network Working Group                                         D. Kristol
Request for Comments: 2965        Bell Laboratories, Lucent Technologies
Obsoletes: [2109](./rfc2109)                                              L. Montulli
Category: Standards Track                             Epinions.com, Inc.
                                                            October 2000

                    HTTP State Management Mechanism

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

IESG Note

   The IESG notes that this mechanism makes use of the .local top-level
   domain (TLD) internally when handling host names that don't contain
   any dots, and that this mechanism might not work in the expected way
   should an actual .local TLD ever be registered.

Abstract

   This document specifies a way to create a stateful session with
   Hypertext Transfer Protocol (HTTP) requests and responses.  It
   describes three new headers, Cookie, Cookie2, and Set-Cookie2, which
   carry state information between participating origin servers and user
   agents.  The method described here differs from Netscape's Cookie
   proposal [[Netscape](#ref-Netscape "\"Persistent Client State -- HTTP Cookies\"")], but it can interoperate with HTTP/1.0 user
   agents that use Netscape's method.  (See the HISTORICAL section.)

   This document reflects implementation experience with [RFC 2109](./rfc2109) and
   obsoletes it.

[1](#section-1).  TERMINOLOGY

   The terms user agent, client, server, proxy, origin server, and
   http_URL have the same meaning as in the HTTP/1.1 specification
   [[RFC2616](./rfc2616 "\"Hypertext Transfer Protocol -- HTTP/1.1\"")].  The terms abs_path and absoluteURI have the same meaning
   as in the URI Syntax specification [[RFC2396](./rfc2396 "\"Uniform Resource Identifiers (URI): Generic Syntax\"")].

Kristol & Montulli          Standards Track                     [Page 1]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Host name (HN) means either the host domain name (HDN) or the numeric
   Internet Protocol (IP) address of a host.  The fully qualified domain
   name is preferred; use of numeric IP addresses is strongly
   discouraged.

   The terms request-host and request-URI refer to the values the client
   would send to the server as, respectively, the host (but not port)
   and abs_path portions of the absoluteURI (http_URL) of the HTTP
   request line.  Note that request-host is a HN.

   The term effective host name is related to host name.  If a host name
   contains no dots, the effective host name is that name with the
   string .local appended to it.  Otherwise the effective host name is
   the same as the host name.  Note that all effective host names
   contain at least one dot.

   The term request-port refers to the port portion of the absoluteURI
   (http_URL) of the HTTP request line.  If the absoluteURI has no
   explicit port, the request-port is the HTTP default, 80.  The
   request-port of a cookie is the request-port of the request in which
   a Set-Cookie2 response header was returned to the user agent.

   Host names can be specified either as an IP address or a HDN string.
   Sometimes we compare one host name with another.  (Such comparisons
   SHALL be case-insensitive.)  Host A's name domain-matches host B's if

      *  their host name strings string-compare equal; or

      * A is a HDN string and has the form NB, where N is a non-empty
         name string, B has the form .B', and B' is a HDN string.  (So,
         x.y.com domain-matches .Y.com but not Y.com.)

   Note that domain-match is not a commutative operation: a.b.c.com
   domain-matches .c.com, but not the reverse.

   The reach R of a host name H is defined as follows:

      *  If

         -  H is the host domain name of a host; and,

         -  H has the form A.B; and

         -  A has no embedded (that is, interior) dots; and

         -  B has at least one embedded dot, or B is the string "local".
            then the reach of H is .B.

Kristol & Montulli          Standards Track                     [Page 2]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

      *  Otherwise, the reach of H is H.

   For two strings that represent paths, P1 and P2, P1 path-matches P2
   if P2 is a prefix of P1 (including the case where P1 and P2 string-
   compare equal).  Thus, the string /tec/waldo path-matches /tec.

   Because it was used in Netscape's original implementation of state
   management, we will use the term cookie to refer to the state
   information that passes between an origin server and user agent, and
   that gets stored by the user agent.

[1.1](#section-1.1)  Requirements

   The key words "MAY", "MUST", "MUST NOT", "OPTIONAL", "RECOMMENDED",
   "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT" in this
   document are to be interpreted as described in [RFC 2119](./rfc2119) [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

[2](#section-2).  STATE AND SESSIONS

   This document describes a way to create stateful sessions with HTTP
   requests and responses.  Currently, HTTP servers respond to each
   client request without relating that request to previous or
   subsequent requests; the state management mechanism allows clients
   and servers that wish to exchange state information to place HTTP
   requests and responses within a larger context, which we term a
   "session".  This context might be used to create, for example, a
   "shopping cart", in which user selections can be aggregated before
   purchase, or a magazine browsing system, in which a user's previous
   reading affects which offerings are presented.

   Neither clients nor servers are required to support cookies.  A
   server MAY refuse to provide content to a client that does not return
   the cookies it sends.

[3](#section-3).  DESCRIPTION

   We describe here a way for an origin server to send state information
   to the user agent, and for the user agent to return the state
   information to the origin server.  The goal is to have a minimal
   impact on HTTP and user agents.

[3.1](#section-3.1)  Syntax:  General

   The two state management headers, Set-Cookie2 and Cookie, have common
   syntactic properties involving attribute-value pairs.  The following
   grammar uses the notation, and tokens DIGIT (decimal digits), token

Kristol & Montulli          Standards Track                     [Page 3]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   (informally, a sequence of non-special, non-white space characters),
   and http_URL from the HTTP/1.1 specification [[RFC2616](./rfc2616 "\"Hypertext Transfer Protocol -- HTTP/1.1\"")] to describe
   their syntax.

   av-pairs    =     av-pair *(";" av-pair)
   av-pair     =     attr ["=" value]              ; optional value
   attr        =     token
   value       =     token | quoted-string

   Attributes (names) (attr) are case-insensitive.  White space is
   permitted between tokens.  Note that while the above syntax
   description shows value as optional, most attrs require them.

   NOTE: The syntax above allows whitespace between the attribute and
   the = sign.

[3.2](#section-3.2)  Origin Server Role

   3.2.1  General  The origin server initiates a session, if it so
   desires.  To do so, it returns an extra response header to the
   client, Set-Cookie2.  (The details follow later.)

   A user agent returns a Cookie request header (see below) to the
   origin server if it chooses to continue a session.  The origin server
   MAY ignore it or use it to determine the current state of the
   session.  It MAY send back to the client a Set-Cookie2 response
   header with the same or different information, or it MAY send no
   Set-Cookie2 header at all.  The origin server effectively ends a
   session by sending the client a Set-Cookie2 header with Max-Age=0.

   Servers MAY return Set-Cookie2 response headers with any response.
   User agents SHOULD send Cookie request headers, subject to other
   rules detailed below, with every request.

   An origin server MAY include multiple Set-Cookie2 headers in a
   response.  Note that an intervening gateway could fold multiple such
   headers into a single header.

Kristol & Montulli          Standards Track                     [Page 4]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   3.2.2  Set-Cookie2 Syntax  The syntax for the Set-Cookie2 response
   header is

   set-cookie      =       "Set-Cookie2:" cookies
   cookies         =       1#cookie
   cookie          =       NAME "=" VALUE *(";" set-cookie-av)
   NAME            =       attr
   VALUE           =       value
   set-cookie-av   =       "Comment" "=" value
                   |       "CommentURL" "=" <"> http_URL <">
                   |       "Discard"
                   |       "Domain" "=" value
                   |       "Max-Age" "=" value
                   |       "Path" "=" value
                   |       "Port" [ "=" <"> portlist <"> ]
                   |       "Secure"
                   |       "Version" "=" 1*DIGIT
   portlist        =       1#portnum
   portnum         =       1*DIGIT

   Informally, the Set-Cookie2 response header comprises the token Set-
   Cookie2:, followed by a comma-separated list of one or more cookies.
   Each cookie begins with a NAME=VALUE pair, followed by zero or more
   semi-colon-separated attribute-value pairs.  The syntax for
   attribute-value pairs was shown earlier.  The specific attributes and
   the semantics of their values follows.  The NAME=VALUE attribute-
   value pair MUST come first in each cookie.  The others, if present,
   can occur in any order.  If an attribute appears more than once in a
   cookie, the client SHALL use only the value associated with the first
   appearance of the attribute; a client MUST ignore values after the
   first.

   The NAME of a cookie MAY be the same as one of the attributes in this
   specification.  However, because the cookie's NAME must come first in
   a Set-Cookie2 response header, the NAME and its VALUE cannot be
   confused with an attribute-value pair.

   NAME=VALUE
      REQUIRED.  The name of the state information ("cookie") is NAME,
      and its value is VALUE.  NAMEs that begin with $ are reserved and
      MUST NOT be used by applications.

      The VALUE is opaque to the user agent and may be anything the
      origin server chooses to send, possibly in a server-selected
      printable ASCII encoding.  "Opaque" implies that the content is of
      interest and relevance only to the origin server.  The content
      may, in fact, be readable by anyone that examines the Set-Cookie2
      header.

Kristol & Montulli          Standards Track                     [Page 5]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Comment=value
      OPTIONAL.  Because cookies can be used to derive or store private
      information about a user, the value of the Comment attribute
      allows an origin server to document how it intends to use the
      cookie.  The user can inspect the information to decide whether to
      initiate or continue a session with this cookie.  Characters in
      value MUST be in UTF-8 encoding. [[RFC2279](./rfc2279 "\"UTF-8, a transformation format of Unicode and ISO-10646\"")]

   CommentURL="http_URL"
      OPTIONAL.  Because cookies can be used to derive or store private
      information about a user, the CommentURL attribute allows an
      origin server to document how it intends to use the cookie.  The
      user can inspect the information identified by the URL to decide
      whether to initiate or continue a session with this cookie.

   Discard
      OPTIONAL.  The Discard attribute instructs the user agent to
      discard the cookie unconditionally when the user agent terminates.

   Domain=value
      OPTIONAL.  The value of the Domain attribute specifies the domain
      for which the cookie is valid.  If an explicitly specified value
      does not start with a dot, the user agent supplies a leading dot.

   Max-Age=value
      OPTIONAL.  The value of the Max-Age attribute is delta-seconds,
      the lifetime of the cookie in seconds, a decimal non-negative
      integer.  To handle cached cookies correctly, a client SHOULD
      calculate the age of the cookie according to the age calculation
      rules in the HTTP/1.1 specification [[RFC2616](./rfc2616 "\"Hypertext Transfer Protocol -- HTTP/1.1\"")].  When the age is
      greater than delta-seconds seconds, the client SHOULD discard the
      cookie.  A value of zero means the cookie SHOULD be discarded
      immediately.

   Path=value
      OPTIONAL.  The value of the Path attribute specifies the subset of
      URLs on the origin server to which this cookie applies.

   Port[="portlist"]
      OPTIONAL.  The Port attribute restricts the port to which a cookie
      may be returned in a Cookie request header.  Note that the syntax
      REQUIREs quotes around the OPTIONAL portlist even if there is only
      one portnum in portlist.

Kristol & Montulli          Standards Track                     [Page 6]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Secure
      OPTIONAL.  The Secure attribute (with no value) directs the user
      agent to use only (unspecified) secure means to contact the origin
      server whenever it sends back this cookie, to protect the
      confidentially and authenticity of the information in the cookie.

      The user agent (possibly with user interaction) MAY determine what
      level of security it considers appropriate for "secure" cookies.
      The Secure attribute should be considered security advice from the
      server to the user agent, indicating that it is in the session's
      interest to protect the cookie contents.  When it sends a "secure"
      cookie back to a server, the user agent SHOULD use no less than
      the same level of security as was used when it received the cookie
      from the server.

   Version=value
      REQUIRED.  The value of the Version attribute, a decimal integer,
      identifies the version of the state management specification to
      which the cookie conforms.  For this specification, Version=1
      applies.

   3.2.3  Controlling Caching  An origin server must be cognizant of the
   effect of possible caching of both the returned resource and the
   Set-Cookie2 header.  Caching "public" documents is desirable.  For
   example, if the origin server wants to use a public document such as
   a "front door" page as a sentinel to indicate the beginning of a
   session for which a Set-Cookie2 response header must be generated,
   the page SHOULD be stored in caches "pre-expired" so that the origin
   server will see further requests.  "Private documents", for example
   those that contain information strictly private to a session, SHOULD
   NOT be cached in shared caches.

   If the cookie is intended for use by a single user, the Set-Cookie2
   header SHOULD NOT be cached.  A Set-Cookie2 header that is intended
   to be shared by multiple users MAY be cached.

   The origin server SHOULD send the following additional HTTP/1.1
   response headers, depending on circumstances:

      *  To suppress caching of the Set-Cookie2 header:

         Cache-control: no-cache="set-cookie2"

   and one of the following:

      *  To suppress caching of a private document in shared caches:

         Cache-control: private

Kristol & Montulli          Standards Track                     [Page 7]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

      *  To allow caching of a document and require that it be validated
         before returning it to the client:

         Cache-Control: must-revalidate, max-age=0

      *  To allow caching of a document, but to require that proxy
         caches (not user agent caches) validate it before returning it
         to the client:

         Cache-Control: proxy-revalidate, max-age=0

      *  To allow caching of a document and request that it be validated
         before returning it to the client (by "pre-expiring" it):

         Cache-control: max-age=0

         Not all caches will revalidate the document in every case.

   HTTP/1.1 servers MUST send Expires: old-date (where old-date is a
   date long in the past) on responses containing Set-Cookie2 response
   headers unless they know for certain (by out of band means) that
   there are no HTTP/1.0 proxies in the response chain.  HTTP/1.1
   servers MAY send other Cache-Control directives that permit caching
   by HTTP/1.1 proxies in addition to the Expires: old-date directive;
   the Cache-Control directive will override the Expires: old-date for
   HTTP/1.1 proxies.

[3.3](#section-3.3)  User Agent Role

   3.3.1  Interpreting Set-Cookie2  The user agent keeps separate track
   of state information that arrives via Set-Cookie2 response headers
   from each origin server (as distinguished by name or IP address and
   port).  The user agent MUST ignore attribute-value pairs whose
   attribute it does not recognize.  The user agent applies these
   defaults for optional attributes that are missing:

   Discard The default behavior is dictated by the presence or absence
           of a Max-Age attribute.

   Domain  Defaults to the effective request-host.  (Note that because
           there is no dot at the beginning of effective request-host,
           the default Domain can only domain-match itself.)

   Max-Age The default behavior is to discard the cookie when the user
           agent exits.

   Path    Defaults to the path of the request URL that generated the
           Set-Cookie2 response, up to and including the right-most /.

Kristol & Montulli          Standards Track                     [Page 8]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Port    The default behavior is that a cookie MAY be returned to any
           request-port.

   Secure  If absent, the user agent MAY send the cookie over an
           insecure channel.

   3.3.2  Rejecting Cookies  To prevent possible security or privacy
   violations, a user agent rejects a cookie according to rules below.
   The goal of the rules is to try to limit the set of servers for which
   a cookie is valid, based on the values of the Path, Domain, and Port
   attributes and the request-URI, request-host and request-port.

   A user agent rejects (SHALL NOT store its information) if the Version
   attribute is missing.  Moreover, a user agent rejects (SHALL NOT
   store its information) if any of the following is true of the
   attributes explicitly present in the Set-Cookie2 response header:

      *  The value for the Path attribute is not a prefix of the
         request-URI.

      *  The value for the Domain attribute contains no embedded dots,
         and the value is not .local.

      *  The effective host name that derives from the request-host does
         not domain-match the Domain attribute.

      *  The request-host is a HDN (not IP address) and has the form HD,
         where D is the value of the Domain attribute, and H is a string
         that contains one or more dots.

      *  The Port attribute has a "port-list", and the request-port was
         not in the list.

   Examples:

      *  A Set-Cookie2 from request-host y.x.foo.com for Domain=.foo.com
         would be rejected, because H is y.x and contains a dot.

      *  A Set-Cookie2 from request-host x.foo.com for Domain=.foo.com
         would be accepted.

      *  A Set-Cookie2 with Domain=.com or Domain=.com., will always be
         rejected, because there is no embedded dot.

      *  A Set-Cookie2 with Domain=ajax.com will be accepted, and the
         value for Domain will be taken to be .ajax.com, because a dot
         gets prepended to the value.

Kristol & Montulli          Standards Track                     [Page 9]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

      *  A Set-Cookie2 with Port="80,8000" will be accepted if the
         request was made to port 80 or 8000 and will be rejected
         otherwise.

      *  A Set-Cookie2 from request-host example for Domain=.local will
         be accepted, because the effective host name for the request-
         host is example.local, and example.local domain-matches .local.

   3.3.3  Cookie Management  If a user agent receives a Set-Cookie2
   response header whose NAME is the same as that of a cookie it has
   previously stored, the new cookie supersedes the old when: the old
   and new Domain attribute values compare equal, using a case-
   insensitive string-compare; and, the old and new Path attribute
   values string-compare equal (case-sensitive).  However, if the Set-
   Cookie2 has a value for Max-Age of zero, the (old and new) cookie is
   discarded.  Otherwise a cookie persists (resources permitting) until
   whichever happens first, then gets discarded: its Max-Age lifetime is
   exceeded; or, if the Discard attribute is set, the user agent
   terminates the session.

   Because user agents have finite space in which to store cookies, they
   MAY also discard older cookies to make space for newer ones, using,
   for example, a least-recently-used algorithm, along with constraints
   on the maximum number of cookies that each origin server may set.

   If a Set-Cookie2 response header includes a Comment attribute, the
   user agent SHOULD store that information in a human-readable form
   with the cookie and SHOULD display the comment text as part of a
   cookie inspection user interface.

   If a Set-Cookie2 response header includes a CommentURL attribute, the
   user agent SHOULD store that information in a human-readable form
   with the cookie, or, preferably, SHOULD allow the user to follow the
   http_URL link as part of a cookie inspection user interface.

   The cookie inspection user interface may include a facility whereby a
   user can decide, at the time the user agent receives the Set-Cookie2
   response header, whether or not to accept the cookie.  A potentially
   confusing situation could arise if the following sequence occurs:

      *  the user agent receives a cookie that contains a CommentURL
         attribute;

      *  the user agent's cookie inspection interface is configured so
         that it presents a dialog to the user before the user agent
         accepts the cookie;

Kristol & Montulli          Standards Track                    [Page 10]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

      *  the dialog allows the user to follow the CommentURL link when
         the user agent receives the cookie; and,

      *  when the user follows the CommentURL link, the origin server
         (or another server, via other links in the returned content)
         returns another cookie.

   The user agent SHOULD NOT send any cookies in this context.  The user
   agent MAY discard any cookie it receives in this context that the
   user has not, through some user agent mechanism, deemed acceptable.

   User agents SHOULD allow the user to control cookie destruction, but
   they MUST NOT extend the cookie's lifetime beyond that controlled by
   the Discard and Max-Age attributes.  An infrequently-used cookie may
   function as a "preferences file" for network applications, and a user
   may wish to keep it even if it is the least-recently-used cookie. One
   possible implementation would be an interface that allows the
   permanent storage of a cookie through a checkbox (or, conversely, its
   immediate destruction).

   Privacy considerations dictate that the user have considerable
   control over cookie management.  The PRIVACY section contains more
   information.

   3.3.4  Sending Cookies to the Origin Server  When it sends a request
   to an origin server, the user agent includes a Cookie request header
   if it has stored cookies that are applicable to the request, based on

      * the request-host and request-port;

      * the request-URI;

      * the cookie's age.

   The syntax for the header is:

cookie          =  "Cookie:" cookie-version 1*((";" | ",") cookie-value)
cookie-value    =  NAME "=" VALUE [";" path] [";" domain] [";" port]
cookie-version  =  "$Version" "=" value
NAME            =  attr
VALUE           =  value
path            =  "$Path" "=" value
domain          =  "$Domain" "=" value
port            =  "$Port" [ "=" <"> value <"> ]

   The value of the cookie-version attribute MUST be the value from the
   Version attribute of the corresponding Set-Cookie2 response header.
   Otherwise the value for cookie-version is 0.  The value for the path

Kristol & Montulli          Standards Track                    [Page 11]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   attribute MUST be the value from the Path attribute, if one was
   present, of the corresponding Set-Cookie2 response header.  Otherwise
   the attribute SHOULD be omitted from the Cookie request header.  The
   value for the domain attribute MUST be the value from the Domain
   attribute, if one was present, of the corresponding Set-Cookie2
   response header.  Otherwise the attribute SHOULD be omitted from the
   Cookie request header.

   The port attribute of the Cookie request header MUST mirror the Port
   attribute, if one was present, in the corresponding Set-Cookie2
   response header.  That is, the port attribute MUST be present if the
   Port attribute was present in the Set-Cookie2 header, and it MUST
   have the same value, if any.  Otherwise, if the Port attribute was
   absent from the Set-Cookie2 header, the attribute likewise MUST be
   omitted from the Cookie request header.

   Note that there is neither a Comment nor a CommentURL attribute in
   the Cookie request header corresponding to the ones in the Set-
   Cookie2 response header.  The user agent does not return the comment
   information to the origin server.

   The user agent applies the following rules to choose applicable
   cookie-values to send in Cookie request headers from among all the
   cookies it has received.

   Domain Selection
      The origin server's effective host name MUST domain-match the
      Domain attribute of the cookie.

   Port Selection
      There are three possible behaviors, depending on the Port
      attribute in the Set-Cookie2 response header:

      1. By default (no Port attribute), the cookie MAY be sent to any
         port.

      2. If the attribute is present but has no value (e.g., Port), the
         cookie MUST only be sent to the request-port it was received
         from.

      3. If the attribute has a port-list, the cookie MUST only be
         returned if the new request-port is one of those listed in
         port-list.

   Path Selection
      The request-URI MUST path-match the Path attribute of the cookie.

Kristol & Montulli          Standards Track                    [Page 12]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Max-Age Selection
      Cookies that have expired should have been discarded and thus are
      not forwarded to an origin server.

   If multiple cookies satisfy the criteria above, they are ordered in
   the Cookie header such that those with more specific Path attributes
   precede those with less specific.  Ordering with respect to other
   attributes (e.g., Domain) is unspecified.

   Note: For backward compatibility, the separator in the Cookie header
   is semi-colon (;) everywhere.  A server SHOULD also accept comma (,)
   as the separator between cookie-values for future compatibility.

   3.3.5  Identifying What Version is Understood:  Cookie2  The Cookie2
   request header facilitates interoperation between clients and servers
   that understand different versions of the cookie specification.  When
   the client sends one or more cookies to an origin server, if at least
   one of those cookies contains a $Version attribute whose value is
   different from the version that the client understands, then the
   client MUST also send a Cookie2 request header, the syntax for which
   is

   cookie2 =       "Cookie2:" cookie-version

   Here the value for cookie-version is the highest version of cookie
   specification (currently 1) that the client understands.  The client
   needs to send at most one such request header per request.

   3.3.6  Sending Cookies in Unverifiable Transactions  Users MUST have
   control over sessions in order to ensure privacy.  (See PRIVACY
   section below.)  To simplify implementation and to prevent an
   additional layer of complexity where adequate safeguards exist,
   however, this document distinguishes between transactions that are
   verifiable and those that are unverifiable.  A transaction is
   verifiable if the user, or a user-designated agent, has the option to
   review the request-URI prior to its use in the transaction.  A
   transaction is unverifiable if the user does not have that option.
   Unverifiable transactions typically arise when a user agent
   automatically requests inlined or embedded entities or when it
   resolves redirection (3xx) responses from an origin server.
   Typically the origin transaction, the transaction that the user
   initiates, is verifiable, and that transaction may directly or
   indirectly induce the user agent to make unverifiable transactions.

   An unverifiable transaction is to a third-party host if its request-
   host U does not domain-match the reach R of the request-host O in the
   origin transaction.

Kristol & Montulli          Standards Track                    [Page 13]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   When it makes an unverifiable transaction, a user agent MUST disable
   all cookie processing (i.e., MUST NOT send cookies, and MUST NOT
   accept any received cookies) if the transaction is to a third-party
   host.

   This restriction prevents a malicious service author from using
   unverifiable transactions to induce a user agent to start or continue
   a session with a server in a different domain.  The starting or
   continuation of such sessions could be contrary to the privacy
   expectations of the user, and could also be a security problem.

   User agents MAY offer configurable options that allow the user agent,
   or any autonomous programs that the user agent executes, to ignore
   the above rule, so long as these override options default to "off".

   (N.B.  Mechanisms may be proposed that will automate overriding the
   third-party restrictions under controlled conditions.)

   Many current user agents already provide a review option that would
   render many links verifiable.  For instance, some user agents display
   the URL that would be referenced for a particular link when the mouse
   pointer is placed over that link.  The user can therefore determine
   whether to visit that site before causing the browser to do so.
   (Though not implemented on current user agents, a similar technique
   could be used for a button used to submit a form -- the user agent
   could display the action to be taken if the user were to select that
   button.)  However, even this would not make all links verifiable; for
   example, links to automatically loaded images would not normally be
   subject to "mouse pointer" verification.

   Many user agents also provide the option for a user to view the HTML
   source of a document, or to save the source to an external file where
   it can be viewed by another application.  While such an option does
   provide a crude review mechanism, some users might not consider it
   acceptable for this purpose.

[3.4](#section-3.4)  How an Origin Server Interprets the Cookie Header

   A user agent returns much of the information in the Set-Cookie2
   header to the origin server when the request-URI path-matches the
   Path attribute of the cookie.  When it receives a Cookie header, the
   origin server SHOULD treat cookies with NAMEs whose prefix is $
   specially, as an attribute for the cookie.

Kristol & Montulli          Standards Track                    [Page 14]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[3.5](#section-3.5)  Caching Proxy Role

   One reason for separating state information from both a URL and
   document content is to facilitate the scaling that caching permits.
   To support cookies, a caching proxy MUST obey these rules already in
   the HTTP specification:

      *  Honor requests from the cache, if possible, based on cache
         validity rules.

      *  Pass along a Cookie request header in any request that the
         proxy must make of another server.

      *  Return the response to the client.  Include any Set-Cookie2
         response header.

      *  Cache the received response subject to the control of the usual
         headers, such as Expires,

         Cache-control: no-cache

         and

         Cache-control: private

      *  Cache the Set-Cookie2 subject to the control of the usual
         header,

         Cache-control: no-cache="set-cookie2"

         (The Set-Cookie2 header should usually not be cached.)

   Proxies MUST NOT introduce Set-Cookie2 (Cookie) headers of their own
   in proxy responses (requests).

[4](#section-4).  EXAMPLES

[4.1](#section-4.1)  Example 1

   Most detail of request and response headers has been omitted.  Assume
   the user agent has no stored cookies.

      1. User Agent -> Server

        POST /acme/login HTTP/1.1
        [form data]

        User identifies self via a form.

Kristol & Montulli          Standards Track                    [Page 15]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

      2. Server -> User Agent

        HTTP/1.1 200 OK
        Set-Cookie2: Customer="WILE_E_COYOTE"; Version="1"; Path="/acme"

        Cookie reflects user's identity.

      3. User Agent -> Server

        POST /acme/pickitem HTTP/1.1
        Cookie: $Version="1"; Customer="WILE_E_COYOTE"; $Path="/acme"
        [form data]

        User selects an item for "shopping basket".

      4. Server -> User Agent

        HTTP/1.1 200 OK
        Set-Cookie2: Part_Number="Rocket_Launcher_0001"; Version="1";
                Path="/acme"

        Shopping basket contains an item.

      5. User Agent -> Server

        POST /acme/shipping HTTP/1.1
        Cookie: $Version="1";
                Customer="WILE_E_COYOTE"; $Path="/acme";
                Part_Number="Rocket_Launcher_0001"; $Path="/acme"
        [form data]

        User selects shipping method from form.

      6. Server -> User Agent

        HTTP/1.1 200 OK
        Set-Cookie2: Shipping="FedEx"; Version="1"; Path="/acme"

        New cookie reflects shipping method.

      7. User Agent -> Server

        POST /acme/process HTTP/1.1
        Cookie: $Version="1";
                Customer="WILE_E_COYOTE"; $Path="/acme";
                Part_Number="Rocket_Launcher_0001"; $Path="/acme";
                Shipping="FedEx"; $Path="/acme"
        [form data]

Kristol & Montulli          Standards Track                    [Page 16]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

        User chooses to process order.

      8. Server -> User Agent

        HTTP/1.1 200 OK

        Transaction is complete.

   The user agent makes a series of requests on the origin server, after
   each of which it receives a new cookie.  All the cookies have the
   same Path attribute and (default) domain.  Because the request-URIs
   all path-match /acme, the Path attribute of each cookie, each request
   contains all the cookies received so far.

[4.2](#section-4.2)  Example 2

   This example illustrates the effect of the Path attribute.  All
   detail of request and response headers has been omitted.  Assume the
   user agent has no stored cookies.

   Imagine the user agent has received, in response to earlier requests,
   the response headers

   Set-Cookie2: Part_Number="Rocket_Launcher_0001"; Version="1";
           Path="/acme"

   and

   Set-Cookie2: Part_Number="Riding_Rocket_0023"; Version="1";
           Path="/acme/ammo"

   A subsequent request by the user agent to the (same) server for URLs
   of the form /acme/ammo/...  would include the following request
   header:

   Cookie: $Version="1";
           Part_Number="Riding_Rocket_0023"; $Path="/acme/ammo";
           Part_Number="Rocket_Launcher_0001"; $Path="/acme"

   Note that the NAME=VALUE pair for the cookie with the more specific
   Path attribute, /acme/ammo, comes before the one with the less
   specific Path attribute, /acme.  Further note that the same cookie
   name appears more than once.

   A subsequent request by the user agent to the (same) server for a URL
   of the form /acme/parts/ would include the following request header:

Kristol & Montulli          Standards Track                    [Page 17]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Cookie: $Version="1"; Part_Number="Rocket_Launcher_0001";
   $Path="/acme"

   Here, the second cookie's Path attribute /acme/ammo is not a prefix
   of the request URL, /acme/parts/, so the cookie does not get
   forwarded to the server.

[5](#section-5).  IMPLEMENTATION CONSIDERATIONS

   Here we provide guidance on likely or desirable details for an origin
   server that implements state management.

[5.1](#section-5.1)  Set-Cookie2 Content

   An origin server's content should probably be divided into disjoint
   application areas, some of which require the use of state
   information.  The application areas can be distinguished by their
   request URLs.  The Set-Cookie2 header can incorporate information
   about the application areas by setting the Path attribute for each
   one.

   The session information can obviously be clear or encoded text that
   describes state.  However, if it grows too large, it can become
   unwieldy.  Therefore, an implementor might choose for the session
   information to be a key to a server-side resource.  Of course, using
   a database creates some problems that this state management
   specification was meant to avoid, namely:

      1. keeping real state on the server side;

      2. how and when to garbage-collect the database entry, in case the
         user agent terminates the session by, for example, exiting.

[5.2](#section-5.2)  Stateless Pages

   Caching benefits the scalability of WWW.  Therefore it is important
   to reduce the number of documents that have state embedded in them
   inherently.  For example, if a shopping-basket-style application
   always displays a user's current basket contents on each page, those
   pages cannot be cached, because each user's basket's contents would
   be different.  On the other hand, if each page contains just a link
   that allows the user to "Look at My Shopping Basket", the page can be
   cached.

Kristol & Montulli          Standards Track                    [Page 18]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[5.3](#section-5.3)  Implementation Limits

   Practical user agent implementations have limits on the number and
   size of cookies that they can store.  In general, user agents' cookie
   support should have no fixed limits.  They should strive to store as
   many frequently-used cookies as possible.  Furthermore, general-use
   user agents SHOULD provide each of the following minimum capabilities
   individually, although not necessarily simultaneously:

      *  at least 300 cookies

      *  at least 4096 bytes per cookie (as measured by the characters
         that comprise the cookie non-terminal in the syntax description
         of the Set-Cookie2 header, and as received in the Set-Cookie2
         header)

      *  at least 20 cookies per unique host or domain name

   User agents created for specific purposes or for limited-capacity
   devices SHOULD provide at least 20 cookies of 4096 bytes, to ensure
   that the user can interact with a session-based origin server.

   The information in a Set-Cookie2 response header MUST be retained in
   its entirety.  If for some reason there is inadequate space to store
   the cookie, it MUST be discarded, not truncated.

   Applications should use as few and as small cookies as possible, and
   they should cope gracefully with the loss of a cookie.

   5.3.1  Denial of Service Attacks  User agents MAY choose to set an
   upper bound on the number of cookies to be stored from a given host
   or domain name or on the size of the cookie information.  Otherwise a
   malicious server could attempt to flood a user agent with many
   cookies, or large cookies, on successive responses, which would force
   out cookies the user agent had received from other servers.  However,
   the minima specified above SHOULD still be supported.

[6](#section-6).  PRIVACY

   Informed consent should guide the design of systems that use cookies.
   A user should be able to find out how a web site plans to use
   information in a cookie and should be able to choose whether or not
   those policies are acceptable.  Both the user agent and the origin
   server must assist informed consent.

Kristol & Montulli          Standards Track                    [Page 19]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[6.1](#section-6.1)  User Agent Control

   An origin server could create a Set-Cookie2 header to track the path
   of a user through the server.  Users may object to this behavior as
   an intrusive accumulation of information, even if their identity is
   not evident.  (Identity might become evident, for example, if a user
   subsequently fills out a form that contains identifying information.)
   This state management specification therefore requires that a user
   agent give the user control over such a possible intrusion, although
   the interface through which the user is given this control is left
   unspecified.  However, the control mechanisms provided SHALL at least
   allow the user

      *  to completely disable the sending and saving of cookies.

      *  to determine whether a stateful session is in progress.

      *  to control the saving of a cookie on the basis of the cookie's
         Domain attribute.

   Such control could be provided, for example, by mechanisms

      *  to notify the user when the user agent is about to send a
         cookie to the origin server, to offer the option not to begin a
         session.

      * to display a visual indication that a stateful session is in
         progress.

      * to let the user decide which cookies, if any, should be saved
         when the user concludes a window or user agent session.

      * to let the user examine and delete the contents of a cookie at
         any time.

   A user agent usually begins execution with no remembered state
   information.  It SHOULD be possible to configure a user agent never
   to send Cookie headers, in which case it can never sustain state with
   an origin server.  (The user agent would then behave like one that is
   unaware of how to handle Set-Cookie2 response headers.)

   When the user agent terminates execution, it SHOULD let the user
   discard all state information.  Alternatively, the user agent MAY ask
   the user whether state information should be retained; the default
   should be "no".  If the user chooses to retain state information, it
   would be restored the next time the user agent runs.

Kristol & Montulli          Standards Track                    [Page 20]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   NOTE: User agents should probably be cautious about using files to
   store cookies long-term.  If a user runs more than one instance of
   the user agent, the cookies could be commingled or otherwise
   corrupted.

[6.2](#section-6.2)  Origin Server Role

   An origin server SHOULD promote informed consent by adding CommentURL
   or Comment information to the cookies it sends.  CommentURL is
   preferred because of the opportunity to provide richer information in
   a multiplicity of languages.

[6.3](#section-6.3)  Clear Text

   The information in the Set-Cookie2 and Cookie headers is unprotected.
   As a consequence:

      1. Any sensitive information that is conveyed in them is exposed
         to intruders.

      2. A malicious intermediary could alter the headers as they travel
         in either direction, with unpredictable results.

   These facts imply that information of a personal and/or financial
   nature should only be sent over a secure channel.  For less sensitive
   information, or when the content of the header is a database key, an
   origin server should be vigilant to prevent a bad Cookie value from
   causing failures.

   A user agent in a shared user environment poses a further risk.
   Using a cookie inspection interface, User B could examine the
   contents of cookies that were saved when User A used the machine.

[7](#section-7).  SECURITY CONSIDERATIONS

[7.1](#section-7.1)  Protocol Design

   The restrictions on the value of the Domain attribute, and the rules
   concerning unverifiable transactions, are meant to reduce the ways
   that cookies can "leak" to the "wrong" site.  The intent is to
   restrict cookies to one host, or a closely related set of hosts.
   Therefore a request-host is limited as to what values it can set for
   Domain.  We consider it acceptable for hosts host1.foo.com and
   host2.foo.com to share cookies, but not a.com and b.com.

   Similarly, a server can set a Path only for cookies that are related
   to the request-URI.

Kristol & Montulli          Standards Track                    [Page 21]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[7.2](#section-7.2)  Cookie Spoofing

   Proper application design can avoid spoofing attacks from related
   domains.  Consider:

      1. User agent makes request to victim.cracker.edu, gets back
         cookie session_id="1234" and sets the default domain
         victim.cracker.edu.

      2. User agent makes request to spoof.cracker.edu, gets back cookie
         session-id="1111", with Domain=".cracker.edu".

      3. User agent makes request to victim.cracker.edu again, and
         passes

         Cookie: $Version="1"; session_id="1234",
                 $Version="1"; session_id="1111"; $Domain=".cracker.edu"

         The server at victim.cracker.edu should detect that the second
         cookie was not one it originated by noticing that the Domain
         attribute is not for itself and ignore it.

[7.3](#section-7.3)  Unexpected Cookie Sharing

   A user agent SHOULD make every attempt to prevent the sharing of
   session information between hosts that are in different domains.
   Embedded or inlined objects may cause particularly severe privacy
   problems if they can be used to share cookies between disparate
   hosts.  For example, a malicious server could embed cookie
   information for host a.com in a URI for a CGI on host b.com.  User
   agent implementors are strongly encouraged to prevent this sort of
   exchange whenever possible.

[7.4](#section-7.4)  Cookies For Account Information

   While it is common practice to use them this way, cookies are not
   designed or intended to be used to hold authentication information,
   such as account names and passwords.  Unless such cookies are
   exchanged over an encrypted path, the account information they
   contain is highly vulnerable to perusal and theft.

[8](#section-8).  OTHER, SIMILAR, PROPOSALS

   Apart from [RFC 2109](./rfc2109), three other proposals have been made to
   accomplish similar goals.  This specification began as an amalgam of
   Kristol's State-Info proposal [[DMK95](#ref-DMK95 "\"Proposed HTTP State-Info Mechanism\"")] and Netscape's Cookie proposal
   [[Netscape](#ref-Netscape "\"Persistent Client State -- HTTP Cookies\"")].

Kristol & Montulli          Standards Track                    [Page 22]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   Brian Behlendorf proposed a Session-ID header that would be user-
   agent-initiated and could be used by an origin server to track
   "clicktrails".  It would not carry any origin-server-defined state,
   however.  Phillip Hallam-Baker has proposed another client-defined
   session ID mechanism for similar purposes.

   While both session IDs and cookies can provide a way to sustain
   stateful sessions, their intended purpose is different, and,
   consequently, the privacy requirements for them are different.  A
   user initiates session IDs to allow servers to track progress through
   them, or to distinguish multiple users on a shared machine.  Cookies
   are server-initiated, so the cookie mechanism described here gives
   users control over something that would otherwise take place without
   the users' awareness.  Furthermore, cookies convey rich, server-
   selected information, whereas session IDs comprise user-selected,
   simple information.

[9](#section-9).  HISTORICAL

[9.1](#section-9.1)  Compatibility with Existing Implementations

   Existing cookie implementations, based on the Netscape specification,
   use the Set-Cookie (not Set-Cookie2) header.  User agents that
   receive in the same response both a Set-Cookie and Set-Cookie2
   response header for the same cookie MUST discard the Set-Cookie
   information and use only the Set-Cookie2 information.  Furthermore, a
   user agent MUST assume, if it received a Set-Cookie2 response header,
   that the sending server complies with this document and will
   understand Cookie request headers that also follow this
   specification.

   New cookies MUST replace both equivalent old- and new-style cookies.
   That is, if a user agent that follows both this specification and
   Netscape's original specification receives a Set-Cookie2 response
   header, and the NAME and the Domain and Path attributes match (per
   the Cookie Management section) a Netscape-style cookie, the
   Netscape-style cookie MUST be discarded, and the user agent MUST
   retain only the cookie adhering to this specification.

   Older user agents that do not understand this specification, but that
   do understand Netscape's original specification, will not recognize
   the Set-Cookie2 response header and will receive and send cookies
   according to the older specification.

Kristol & Montulli          Standards Track                    [Page 23]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

   A user agent that supports both this specification and Netscape-style
   cookies SHOULD send a Cookie request header that follows the older
   Netscape specification if it received the cookie in a Set-Cookie
   response header and not in a Set-Cookie2 response header.  However,
   it SHOULD send the following request header as well:

        Cookie2: $Version="1"

   The Cookie2 header advises the server that the user agent understands
   new-style cookies.  If the server understands new-style cookies, as
   well, it SHOULD continue the stateful session by sending a Set-
   Cookie2 response header, rather than Set-Cookie.  A server that does
   not understand new-style cookies will simply ignore the Cookie2
   request header.

[9.2](#section-9.2)  Caching and HTTP/1.0

   Some caches, such as those conforming to HTTP/1.0, will inevitably
   cache the Set-Cookie2 and Set-Cookie headers, because there was no
   mechanism to suppress caching of headers prior to HTTP/1.1.  This
   caching can lead to security problems.  Documents transmitted by an
   origin server along with Set-Cookie2 and Set-Cookie headers usually
   either will be uncachable, or will be "pre-expired".  As long as
   caches obey instructions not to cache documents (following Expires:
   <a date in the past> or Pragma: no-cache (HTTP/1.0), or Cache-
   control:  no-cache (HTTP/1.1)) uncachable documents present no
   problem.  However, pre-expired documents may be stored in caches.
   They require validation (a conditional GET) on each new request, but
   some cache operators loosen the rules for their caches, and sometimes
   serve expired documents without first validating them.  This
   combination of factors can lead to cookies meant for one user later
   being sent to another user.  The Set-Cookie2 and Set-Cookie headers
   are stored in the cache, and, although the document is stale
   (expired), the cache returns the document in response to later
   requests, including cached headers.

[10](#section-10).  ACKNOWLEDGEMENTS

   This document really represents the collective efforts of the HTTP
   Working Group of the IETF and, particularly, the following people, in
   addition to the authors: Roy Fielding, Yaron Goland, Marc Hedlund,
   Ted Hardie, Koen Holtman, Shel Kaphan, Rohit Khare, Foteos Macrides,
   David W. Morris.

Kristol & Montulli          Standards Track                    [Page 24]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[11](#section-11).  AUTHORS' ADDRESSES

   David M. Kristol
   Bell Laboratories, Lucent Technologies
   600 Mountain Ave.  Room 2A-333
   Murray Hill, NJ  07974

   Phone: (908) 582-2250
   Fax: (908) 582-1239
   EMail: dmk@bell-labs.com

   Lou Montulli
   Epinions.com, Inc.
   2037 Landings Dr.
   Mountain View, CA  94301

   EMail: lou@montulli.org

[12](#section-12).  REFERENCES

   [DMK95]    Kristol, D.M., "Proposed HTTP State-Info Mechanism",
              available at <[http://portal.research.bell-](http://portal.research.bell-labs.com/~dmk/state-info.html)
              [labs.com/~dmk/state-info.html](http://portal.research.bell-labs.com/~dmk/state-info.html)>, September, 1995.

   [Netscape] "Persistent Client State -- HTTP Cookies", available at
              <<http://www.netscape.com/newsref/std/cookie_spec.html>>,
              undated.

   [RFC2109]  Kristol, D. and L. Montulli, "HTTP State Management
              Mechanism", [RFC 2109](./rfc2109), February 1997.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119), March 1997.

   [RFC2279]  Yergeau, F., "UTF-8, a transformation format of Unicode
              and ISO-10646", [RFC 2279](./rfc2279), January 1998.

   [RFC2396]  Berners-Lee, T., Fielding, R. and L. Masinter, "Uniform
              Resource Identifiers (URI): Generic Syntax", [RFC 2396](./rfc2396),
              August 1998.

   [RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H. and T.
              Berners-Lee, "Hypertext Transfer Protocol -- HTTP/1.1",
              [RFC 2616](./rfc2616), June 1999.

Kristol & Montulli          Standards Track                    [Page 25]
```

---

```

[RFC 2965](./rfc2965)            HTTP State Management Mechanism         October 2000

[13](#section-13).  Full Copyright Statement

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.

Kristol & Montulli          Standards Track                    [Page 26]

```


=== Content from github.com_214092be_20250114_200534.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9352)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9352)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=jetty%2Fjetty.project)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jetty](/jetty)
/
**[jetty.project](/jetty/jetty.project)**
Public

* [Notifications](/login?return_to=%2Fjetty%2Fjetty.project) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fjetty%2Fjetty.project)
* [Star
   3.9k](/login?return_to=%2Fjetty%2Fjetty.project)

* [Code](/jetty/jetty.project)
* [Issues
  341](/jetty/jetty.project/issues)
* [Pull requests
  36](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects
  7](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

Additional navigation options

* [Code](/jetty/jetty.project)
* [Issues](/jetty/jetty.project/issues)
* [Pull requests](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjetty%2Fjetty.project%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjetty%2Fjetty.project%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix/jetty 9.4.x cookie cutter legacy #9352

 Merged

[gregw](/gregw)
merged 6 commits into
[jetty-9.4.x](/jetty/jetty.project/tree/jetty-9.4.x "jetty/jetty.project:jetty-9.4.x")
from
[fix/jetty-9.4.x-cookie-cutter-legacy](/jetty/jetty.project/tree/fix/jetty-9.4.x-cookie-cutter-legacy "jetty/jetty.project:fix/jetty-9.4.x-cookie-cutter-legacy")

Feb 15, 2023

 Merged

# [Fix/jetty 9.4.x cookie cutter legacy](#top) #9352

[gregw](/gregw)
merged 6 commits into
[jetty-9.4.x](/jetty/jetty.project/tree/jetty-9.4.x "jetty/jetty.project:jetty-9.4.x")
from
[fix/jetty-9.4.x-cookie-cutter-legacy](/jetty/jetty.project/tree/fix/jetty-9.4.x-cookie-cutter-legacy "jetty/jetty.project:fix/jetty-9.4.x-cookie-cutter-legacy")

Feb 15, 2023

+157

−41

[Conversation
8](/jetty/jetty.project/pull/9352)
[Commits
6](/jetty/jetty.project/pull/9352/commits)
[Checks
0](/jetty/jetty.project/pull/9352/checks)
[Files changed
5](/jetty/jetty.project/pull/9352/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![gregw](https://avatars.githubusercontent.com/u/70829?s=60&v=4)](/gregw)

Copy link

Contributor

### @gregw **[gregw](/gregw)** commented [Feb 14, 2023](#issue-1584992059)

Less lenient RFC6265 parsing, but with a RFC6265\_LEGACY mode for those that want it.

Sorry, something went wrong.

All reactions

 [lorban](/lorban)
and others
added 4 commits
[February 10, 2023 14:19](#commits-pushed-6d331bf)

[![@lorban](https://avatars.githubusercontent.com/u/622925?s=40&v=4)](/lorban)

`[improve rfc6265 handling](/jetty/jetty.project/pull/9352/commits/6d331bf88c342751d106b380854686286a718598 "improve rfc6265 handling

Signed-off-by: Ludovic Orban <lorban@bitronix.be>")`
 …

`[6d331bf](/jetty/jetty.project/pull/9352/commits/6d331bf88c342751d106b380854686286a718598)`

```
Signed-off-by: Ludovic Orban <lorban@bitronix.be>
```

[![@lorban](https://avatars.githubusercontent.com/u/622925?s=40&v=4)](/lorban)

`[allow whitespaces in values](/jetty/jetty.project/pull/9352/commits/06ba736306cf26a61b95b1f8a706ccd7ad2c1597 "allow whitespaces in values

Signed-off-by: Ludovic Orban <lorban@bitronix.be>")`
 …

`[06ba736](/jetty/jetty.project/pull/9352/commits/06ba736306cf26a61b95b1f8a706ccd7ad2c1597)`

```
Signed-off-by: Ludovic Orban <lorban@bitronix.be>
```

[![@lorban](https://avatars.githubusercontent.com/u/622925?s=40&v=4)](/lorban)

`[align test suite](/jetty/jetty.project/pull/9352/commits/93f6586ea13449404e7d9dfe16e6aa15e42983eb "align test suite

Signed-off-by: Ludovic Orban <lorban@bitronix.be>")`
 …

`[93f6586](/jetty/jetty.project/pull/9352/commits/93f6586ea13449404e7d9dfe16e6aa15e42983eb)`

```
Signed-off-by: Ludovic Orban <lorban@bitronix.be>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Added RFC6265_LEGACY mode](/jetty/jetty.project/pull/9352/commits/4dd5d66ecc3fa1c5235b2b86a7e79776bbe16148 "Added RFC6265_LEGACY mode")`

`[4dd5d66](/jetty/jetty.project/pull/9352/commits/4dd5d66ecc3fa1c5235b2b86a7e79776bbe16148)`

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
requested review from
[lorban](/lorban) and
[sbordet](/sbordet)
[February 14, 2023 23:45](#event-8520733729)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[USed RFC6265_LEGACY mode for test](/jetty/jetty.project/pull/9352/commits/21bce6404144bc02c016afea9a74d7f93ac5b53d "USed RFC6265_LEGACY mode for test")`

`[21bce64](/jetty/jetty.project/pull/9352/commits/21bce6404144bc02c016afea9a74d7f93ac5b53d)`

[![sbordet](https://avatars.githubusercontent.com/u/414681?s=60&v=4)](/sbordet)

**[sbordet](/sbordet)**
previously approved these changes
[Feb 15, 2023](#pullrequestreview-1299215006)

 [View reviewed changes](/jetty/jetty.project/pull/9352/files/21bce6404144bc02c016afea9a74d7f93ac5b53d)

Copy link

Contributor

### @sbordet **[sbordet](/sbordet)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please add the suggested fix, otherwise LGTM.

Sorry, something went wrong.

All reactions

[jetty-server/src/main/java/org/eclipse/jetty/server/CookieCutter.java](/jetty/jetty.project/pull/9352/files/21bce6404144bc02c016afea9a74d7f93ac5b53d#diff-05071bfe4aa26c8eb06055139d1bb847438b88340bd46aae864b076aedf732ae)
Outdated

|  |  | \* ; US-ASCII characters excluding CTLs, |
| --- | --- | --- |
|  |  | \* ; whitespace DQUOTE, comma, semicolon, |
|  |  | \* ; and backslash |
|  |  | \*/ |

Copy link

Contributor

### @sbordet **[sbordet](/sbordet)** [Feb 15, 2023](#discussion_r1106936909)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'd remove the comment because it's not what the code does (the code does not check for , `"` and `\`.

Alternatively, can this block be merged with the block below which is identical and has a clarifying comment?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @gregw **[gregw](/gregw)** [Feb 15, 2023](#discussion_r1107024833)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'll remove the comment.

It is not identical to the code below. This is the original code and the code below is updated by [@lorban](https://github.com/lorban).

Sorry, something went wrong.

All reactions

[![lorban](https://avatars.githubusercontent.com/u/622925?s=60&v=4)](/lorban)

**[lorban](/lorban)**
previously approved these changes
[Feb 15, 2023](#pullrequestreview-1299257704)

 [View reviewed changes](/jetty/jetty.project/pull/9352/files/21bce6404144bc02c016afea9a74d7f93ac5b53d)

Copy link

Contributor

### @lorban **[lorban](/lorban)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I would clean up the commented-out bits of the test, otherwise LGTM.

Sorry, something went wrong.

All reactions

[jetty-server/src/test/java/org/eclipse/jetty/server/CookieCutterTest.java](/jetty/jetty.project/pull/9352/files/21bce6404144bc02c016afea9a74d7f93ac5b53d#diff-ccf3f2484ae74048d93fb0e709fd95aab600d2c69dbfe678108371278e15d67d)
Outdated

|  |  | new Param("A= 1; B=2; C=3", "A=1", "B=2", "C=3"), |
| --- | --- | --- |
|  |  | new Param("A=\"1; B=2\"; C=3", "C=3"), |
|  |  | new Param("A=\"1; B=2; C=3"), |
|  |  | new Param("A=\"1 B=2\"; C=3", "A=1 B=2", "C=3"), // Why should A be rejected? Shouldn't it be A=<1 B=2>? |

Copy link

Contributor

### @lorban **[lorban](/lorban)** [Feb 15, 2023](#discussion_r1106965803) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This comment either is outdated and should go away, or space characters should be rejected and there's a bug left.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @gregw **[gregw](/gregw)** [Feb 15, 2023](#discussion_r1107027667)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We want to keep us much legacy behaviour as possible for these lenient cases, so I don't want to change the code. I'll remove the comment.

Sorry, something went wrong.

All reactions

[jetty-server/src/test/java/org/eclipse/jetty/server/CookieCutterTest.java](/jetty/jetty.project/pull/9352/files/21bce6404144bc02c016afea9a74d7f93ac5b53d#diff-ccf3f2484ae74048d93fb0e709fd95aab600d2c69dbfe678108371278e15d67d)
Outdated

|  |  | new Param("A=1\"; B=2; C=3", "B=2", "C=3"), |
| --- | --- | --- |
|  |  | new Param("A=1\"1; B=2; C=3", "B=2", "C=3"), |
|  |  | /\* TODO Use Legacy mode for these |
|  |  | new Param("A=\" 1\"; B=2; C=3", "A=1", "B=2", "C=3"), // Why should the whitespaces be trimmed? They were not in the prev impl. |

Copy link

Contributor

### @lorban **[lorban](/lorban)** [Feb 15, 2023](#discussion_r1106967249)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

These assertions should be adapted. In these four cases, `A` should be ignored but `B` and `C` are still valid, aren't they?

Sorry, something went wrong.

 👍
1
 gregw reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Updates from review](/jetty/jetty.project/pull/9352/commits/13ba3126fd64b09dfe97cc414835c842c5e179ba "Updates from review")`

`[13ba312](/jetty/jetty.project/pull/9352/commits/13ba3126fd64b09dfe97cc414835c842c5e179ba)`

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
dismissed stale reviews from [lorban](/lorban) and [sbordet](/sbordet)
via
`[13ba312](/jetty/jetty.project/commit/13ba3126fd64b09dfe97cc414835c842c5e179ba)`
[February 15, 2023 11:58](#event-8525259579)

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
requested review from
[sbordet](/sbordet) and
[lorban](/lorban)
[February 15, 2023 11:58](#event-8525262387)

[![lorban](https://avatars.githubusercontent.com/u/622925?s=60&v=4)](/lorban)

**[lorban](/lorban)**
approved these changes
[Feb 15, 2023](#pullrequestreview-1299529351)

 [View reviewed changes](/jetty/jetty.project/pull/9352/files/13ba3126fd64b09dfe97cc414835c842c5e179ba)

[![sbordet](https://avatars.githubusercontent.com/u/414681?s=60&v=4)](/sbordet)

**[sbordet](/sbordet)**
approved these changes
[Feb 15, 2023](#pullrequestreview-1299608761)

 [View reviewed changes](/jetty/jetty.project/pull/9352/files/13ba3126fd64b09dfe97cc414835c842c5e179ba)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
merged commit [`1be1401`](/jetty/jetty.project/commit/1be1401bafb4c46fae3c234c8e93743a661dcf21)
into
jetty-9.4.x

[Feb 15, 2023](https://github.com/jetty/jetty.project/pull/9352#event-8530579477)

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
deleted the
fix/jetty-9.4.x-cookie-cutter-legacy

branch
[February 15, 2023 21:24](#event-8530580008)

[![@LuciferYang](https://avatars.githubusercontent.com/u/1475305?s=40&u=2ec39b6821641b15b9dda1803c1041650e8de136&v=4)](/LuciferYang)
[LuciferYang](/LuciferYang)
mentioned this pull request
[Feb 28, 2023](#ref-pullrequest-1602537560)

[[SPARK-42491][BUILD] Upgrade jetty to 9.4.51.v20230217
apache/spark#40214](/apache/spark/pull/40214)
 Closed

[srowen](/srowen)
pushed a commit
to apache/spark
that referenced
this pull request
[Mar 1, 2023](#ref-commit-e11b331)
[![@LuciferYang](https://avatars.githubusercontent.com/u/1475305?s=40&u=2ec39b6821641b15b9dda1803c1041650e8de136&v=4)](/LuciferYang) [![@srowen](https://avatars.githubusercontent.com/u/822522?s=40&v=4)](/srowen)

`[[](/apache/spark/commit/e11b331c637043bb48b885ee13e06bd7ce708ba8 "[SPARK-42491][BUILD] Upgrade jetty to 9.4.51.v20230217

### What changes were proposed in this pull request?
This pr aims upgrade jetty from 9.4.50.v20221201 to 9.4.51.v20230217.

### Why are the changes needed?
The main change of this version includes:

- https://github.com/eclipse/jetty.project/pull/9352
- https://github.com/eclipse/jetty.project/pull/9345

The release notes as follows:

- https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217

### Does this PR introduce _any_ user-facing change?
No

### How was this patch tested?
Pass Github Actions

Closes #40214 from LuciferYang/jetty-9451.

Authored-by: yangjie01 <yangjie01@baidu.com>
Signed-off-by: Sean Owen <srowen@gmail.com>")[SPARK-42491](https://issues.apache.org/jira/browse/SPARK-42491)[][BUILD] Upgrade jetty to 9.4.51.v20230217](/apache/spark/commit/e11b331c637043bb48b885ee13e06bd7ce708ba8 "[SPARK-42491][BUILD] Upgrade jetty to 9.4.51.v20230217

### What changes were proposed in this pull request?
This pr aims upgrade jetty from 9.4.50.v20221201 to 9.4.51.v20230217.

### Why are the changes needed?
The main change of this version includes:

- https://github.com/eclipse/jetty.project/pull/9352
- https://github.com/eclipse/jetty.project/pull/9345

The release notes as follows:

- https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217

### Does this PR introduce _any_ user-facing change?
No

### How was this patch tested?
Pass Github Actions

Closes #40214 from LuciferYang/jetty-9451.

Authored-by: yangjie01 <yangjie01@baidu.com>
Signed-off-by: Sean Owen <srowen@gmail.com>")`
…

`[e11b331](/apache/spark/commit/e11b331c637043bb48b885ee13e06bd7ce708ba8)`

```
### What changes were proposed in this pull request?
This pr aims upgrade jetty from 9.4.50.v20221201 to 9.4.51.v20230217.

### Why are the changes needed?
The main change of this version includes:

- [jetty/jetty.project#9352](https://github.com/jetty/jetty.project/pull/9352)
- [jetty/jetty.project#9345](https://github.com/jetty/jetty.project/pull/9345)

The release notes as follows:

- <https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217>

### Does this PR introduce _any_ user-facing change?
No

### How was this patch tested?
Pass Github Actions

Closes [#40214](https://github.com/apache/spark/pull/40214) from LuciferYang/jetty-9451.

Authored-by: yangjie01 <yangjie01@baidu.com>
Signed-off-by: Sean Owen <srowen@gmail.com>
```

[![@atennapel](https://avatars.githubusercontent.com/u/1489161?s=80&v=4)](/atennapel)

Copy link

### **[atennapel](/atennapel)** commented [May 1, 2023](#issuecomment-1529606453) • edited Loading

| This did not update the `getSetCookie` in `HttpCookie`. It will cause a `IllegalStateException` if `RFC6265_LEGACY` is used. Unless I am mistaken... Created issue here: [#9717](https://github.com/jetty/jetty.project/issues/9717) |
| --- |

All reactions

Sorry, something went wrong.

[![@atennapel](https://avatars.githubusercontent.com/u/1489161?s=40&v=4)](/atennapel)
[atennapel](/atennapel)
mentioned this pull request
[May 1, 2023](#ref-issue-1690706890)

[Jetty 9.4.51: `org.eclipse.jetty.http.HttpCookie.getSetCookie` does not handle `RFC6265_LEGACY`
#9717](/jetty/jetty.project/issues/9717)

Closed

[![@jeffalder](https://avatars.githubusercontent.com/u/49817386?s=40&v=4)](/jeffalder)
[jeffalder](/jeffalder)
mentioned this pull request
[Jun 13, 2023](#ref-pullrequest-1755352114)

[[GHSA-p26g-97m4-6q7c] Eclipse Jetty's cookie parsing of quoted values can exfiltrate values from other cookies
github/advisory-database#2404](/github/advisory-database/pull/2404)
 Merged

This was referenced Apr 26, 2023

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-server-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#527](/CxDemoInABoxRepos/Java-Webgoat/issues/527)

Open

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-http-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#531](/CxDemoInABoxRepos/Java-Webgoat/issues/531)

Open

This was referenced Jul 10, 2023

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-server-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#827](/CxDemoInABoxRepos/Java-Webgoat/issues/827)

Open

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-http-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#831](/CxDemoInABoxRepos/Java-Webgoat/issues/831)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9352)

Reviewers

[![@lorban](https://avatars.githubusercontent.com/u/622925?s=40&v=4)](/lorban) [lorban](/lorban)

lorban approved these changes

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet) [sbordet](/sbordet)

sbordet approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=52&v=4)](/gregw) [![@atennapel](https://avatars.githubusercontent.com/u/1489161?s=52&v=4)](/atennapel) [![@sbordet](https://avatars.githubusercontent.com/u/414681?s=52&v=4)](/sbordet) [![@lorban](https://avatars.githubusercontent.com/u/622925?s=52&v=4)](/lorban)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.rfc-editor.org_679df95e_20250114_200539.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc6265.txt)|[PDF](/rfc/pdfrfc/rfc6265.txt.pdf)|[HTML](/rfc/rfc6265.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc6265 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=6265&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc6265)] [[Info page](https://www.rfc-editor.org/info/rfc6265 "Info page")]

 PROPOSED STANDARD
 Errata Exist
```
Internet Engineering Task Force (IETF)                          A. Barth
Request for Comments: 6265                                 U.C. Berkeley
Obsoletes: [2965](./rfc2965)                                               April 2011
Category: Standards Track
ISSN: 2070-1721

                    HTTP State Management Mechanism

Abstract

   This document defines the HTTP Cookie and Set-Cookie header fields.
   These header fields can be used by HTTP servers to store state
   (called cookies) at HTTP user agents, letting the servers maintain a
   stateful session over the mostly stateless HTTP protocol.  Although
   cookies have many historical infelicities that degrade their security
   and privacy, the Cookie and Set-Cookie header fields are widely used
   on the Internet.  This document obsoletes [RFC 2965](./rfc2965).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in [Section 2 of RFC 5741](./rfc5741#section-2).

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   [http://www.rfc-editor.org/info/rfc6265](https://www.rfc-editor.org/info/rfc6265).

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to [BCP 78](https://www.rfc-editor.org/bcp/bcp78) and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<http://trustee.ietf.org/license-info>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Barth                        Standards Track                    [Page 1]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   [1](#section-1). Introduction ....................................................[3](#page-3)
   [2](#section-2). Conventions .....................................................[4](#page-4)
      [2.1](#section-2.1). Conformance Criteria .......................................[4](#page-4)
      [2.2](#section-2.2). Syntax Notation ............................................[5](#page-5)
      [2.3](#section-2.3). Terminology ................................................[5](#page-5)
   [3](#section-3). Overview ........................................................[6](#page-6)
      [3.1](#section-3.1). Examples ...................................................[6](#page-6)
   [4](#section-4). Server Requirements .............................................[8](#page-8)
      [4.1](#section-4.1). Set-Cookie .................................................[8](#page-8)
           [4.1.1](#section-4.1.1). Syntax ..............................................[8](#page-8)
           [4.1.2](#section-4.1.2). Semantics (Non-Normative) ..........................[10](#page-10)
      [4.2](#section-4.2). Cookie ....................................................[13](#page-13)
           [4.2.1](#section-4.2.1). Syntax .............................................[13](#page-13)
           [4.2.2](#section-4.2.2). Semantics ..........................................[13](#page-13)
   [5](#section-5). User Agent Requirements ........................................[14](#page-14)
      [5.1](#section-5.1). Subcomponent Algorithms ...................................[14](#page-14)
           [5.1.1](#section-5.1.1). Dates ..............................................[14](#page-14)
           [5.1.2](#section-5.1.2). Canonicalized Host Names ...........................[16](#page-16)
           [5.1.3](#section-5.1.3). Domain Matching ....................................[16](#page-16)
           [5.1.4](#section-5.1.4). Paths and Path-Match ...............................[16](#page-16)
      [5.2](#section-5.2). The Set-Cookie Header .....................................[17](#page-17)
           [5.2.1](#section-5.2.1). The Expires Attribute ..............................[19](#page-19)
           [5.2.2](#section-5.2.2). The Max-Age Attribute ..............................[20](#page-20)
           [5.2.3](#section-5.2.3). The Domain Attribute ...............................[20](#page-20)
           [5.2.4](#section-5.2.4). The Path Attribute .................................[21](#page-21)
           [5.2.5](#section-5.2.5). The Secure Attribute ...............................[21](#page-21)
           [5.2.6](#section-5.2.6). The HttpOnly Attribute .............................[21](#page-21)
      [5.3](#section-5.3). Storage Model .............................................[21](#page-21)
      [5.4](#section-5.4). The Cookie Header .........................................[25](#page-25)
   [6](#section-6). Implementation Considerations ..................................[27](#page-27)
      [6.1](#section-6.1). Limits ....................................................[27](#page-27)
      [6.2](#section-6.2). Application Programming Interfaces ........................[27](#page-27)
      [6.3](#section-6.3). IDNA Dependency and Migration .............................[27](#page-27)
   [7](#section-7). Privacy Considerations .........................................[28](#page-28)

Barth                        Standards Track                    [Page 2]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

      [7.1](#section-7.1). Third-Party Cookies .......................................[28](#page-28)
      [7.2](#section-7.2). User Controls .............................................[28](#page-28)
      [7.3](#section-7.3). Expiration Dates ..........................................[29](#page-29)
   [8](#section-8). Security Considerations ........................................[29](#page-29)
      [8.1](#section-8.1). Overview ..................................................[29](#page-29)
      [8.2](#section-8.2). Ambient Authority .........................................[30](#page-30)
      [8.3](#section-8.3). Clear Text ................................................[30](#page-30)
      [8.4](#section-8.4). Session Identifiers .......................................[31](#page-31)
      [8.5](#section-8.5). Weak Confidentiality ......................................[32](#page-32)
      [8.6](#section-8.6). Weak Integrity ............................................[32](#page-32)
      [8.7](#section-8.7). Reliance on DNS ...........................................[33](#page-33)
   [9](#section-9). IANA Considerations ............................................[33](#page-33)
      [9.1](#section-9.1). Cookie ....................................................[34](#page-34)
      [9.2](#section-9.2). Set-Cookie ................................................[34](#page-34)
      [9.3](#section-9.3). Cookie2 ...................................................[34](#page-34)
      [9.4](#section-9.4). Set-Cookie2 ...............................................[34](#page-34)
   [10](#section-10). References ....................................................[35](#page-35)
      [10.1](#section-10.1). Normative References .....................................[35](#page-35)
      [10.2](#section-10.2). Informative References ...................................[35](#page-35)
   [Appendix A](#appendix-A). Acknowledgements ......................................[37](#page-37)

[1](#section-1).  Introduction

   This document defines the HTTP Cookie and Set-Cookie header fields.
   Using the Set-Cookie header field, an HTTP server can pass name/value
   pairs and associated metadata (called cookies) to a user agent.  When
   the user agent makes subsequent requests to the server, the user
   agent uses the metadata and other information to determine whether to
   return the name/value pairs in the Cookie header.

   Although simple on their surface, cookies have a number of
   complexities.  For example, the server indicates a scope for each
   cookie when sending it to the user agent.  The scope indicates the
   maximum amount of time in which the user agent should return the
   cookie, the servers to which the user agent should return the cookie,
   and the URI schemes for which the cookie is applicable.

   For historical reasons, cookies contain a number of security and
   privacy infelicities.  For example, a server can indicate that a
   given cookie is intended for "secure" connections, but the Secure
   attribute does not provide integrity in the presence of an active
   network attacker.  Similarly, cookies for a given host are shared
   across all the ports on that host, even though the usual "same-origin
   policy" used by web browsers isolates content retrieved via different
   ports.

   There are two audiences for this specification: developers of cookie-
   generating servers and developers of cookie-consuming user agents.

Barth                        Standards Track                    [Page 3]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   To maximize interoperability with user agents, servers SHOULD limit
   themselves to the well-behaved profile defined in [Section 4](#section-4) when
   generating cookies.

   User agents MUST implement the more liberal processing rules defined
   in [Section 5](#section-5), in order to maximize interoperability with existing
   servers that do not conform to the well-behaved profile defined in
   [Section 4](#section-4).

   This document specifies the syntax and semantics of these headers as
   they are actually used on the Internet.  In particular, this document
   does not create new syntax or semantics beyond those in use today.
   The recommendations for cookie generation provided in [Section 4](#section-4)
   represent a preferred subset of current server behavior, and even the
   more liberal cookie processing algorithm provided in [Section 5](#section-5) does
   not recommend all of the syntactic and semantic variations in use
   today.  Where some existing software differs from the recommended
   protocol in significant ways, the document contains a note explaining
   the difference.

   Prior to this document, there were at least three descriptions of
   cookies: the so-called "Netscape cookie specification" [[Netscape](#ref-Netscape "\"Persistent Client State -- HTTP Cookies\"")],
   [RFC 2109](./rfc2109) [[RFC2109](./rfc2109 "\"HTTP State Management Mechanism\"")], and [RFC 2965](./rfc2965) [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")].  However, none of these
   documents describe how the Cookie and Set-Cookie headers are actually
   used on the Internet (see [[Kri2001](#ref-Kri2001 "\"HTTP Cookies: Standards, Privacy, and Politics\"")] for historical context).  In
   relation to previous IETF specifications of HTTP state management
   mechanisms, this document requests the following actions:

   1.  Change the status of [[RFC2109](./rfc2109 "\"HTTP State Management Mechanism\"")] to Historic (it has already been
       obsoleted by [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")]).

   2.  Change the status of [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")] to Historic.

   3.  Indicate that [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")] has been obsoleted by this document.

   In particular, in moving [RFC 2965](./rfc2965) to Historic and obsoleting it, this
   document deprecates the use of the Cookie2 and Set-Cookie2 header
   fields.

[2](#section-2).  Conventions

[2.1](#section-2.1).  Conformance Criteria

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

Barth                        Standards Track                    [Page 4]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   Requirements phrased in the imperative as part of algorithms (such as
   "strip any leading space characters" or "return false and abort these
   steps") are to be interpreted with the meaning of the key word
   ("MUST", "SHOULD", "MAY", etc.) used in introducing the algorithm.

   Conformance requirements phrased as algorithms or specific steps can
   be implemented in any manner, so long as the end result is
   equivalent.  In particular, the algorithms defined in this
   specification are intended to be easy to understand and are not
   intended to be performant.

[2.2](#section-2.2).  Syntax Notation

   This specification uses the Augmented Backus-Naur Form (ABNF)
   notation of [[RFC5234](./rfc5234 "\"Augmented BNF for Syntax Specifications: ABNF\"")].

   The following core rules are included by reference, as defined in
   [[RFC5234], Appendix B.1](./rfc5234#appendix-B.1): ALPHA (letters), CR (carriage return), CRLF
   (CR LF), CTLs (controls), DIGIT (decimal 0-9), DQUOTE (double quote),
   HEXDIG (hexadecimal 0-9/A-F/a-f), LF (line feed), NUL (null octet),
   OCTET (any 8-bit sequence of data except NUL), SP (space), HTAB
   (horizontal tab), CHAR (any [[USASCII](#ref-USASCII "\"Coded Character Set -- 7-bit American Standard Code for Information Interchange\"")] character), VCHAR (any visible
   [[USASCII](#ref-USASCII "\"Coded Character Set -- 7-bit American Standard Code for Information Interchange\"")] character), and WSP (whitespace).

   The OWS (optional whitespace) rule is used where zero or more linear
   whitespace characters MAY appear:

   OWS            = *( [ obs-fold ] WSP )
                    ; "optional" whitespace
   obs-fold       = CRLF

   OWS SHOULD either not be produced or be produced as a single SP
   character.

[2.3](#section-2.3).  Terminology

   The terms user agent, client, server, proxy, and origin server have
   the same meaning as in the HTTP/1.1 specification ([[RFC2616](./rfc2616 "\"Hypertext Transfer Protocol -- HTTP/1.1\"")], [Section](#section-1.3)
   [1.3](#section-1.3)).

   The request-host is the name of the host, as known by the user agent,
   to which the user agent is sending an HTTP request or from which it
   is receiving an HTTP response (i.e., the name of the host to which it
   sent the corresponding HTTP request).

   The term request-uri is defined in [Section 5.1.2 of [RFC2616]](./rfc2616#section-5.1.2).

Barth                        Standards Track                    [Page 5]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   Two sequences of octets are said to case-insensitively match each
   other if and only if they are equivalent under the i;ascii-casemap
   collation defined in [[RFC4790](./rfc4790 "\"Internet Application Protocol Collation Registry\"")].

   The term string means a sequence of non-NUL octets.

[3](#section-3).  Overview

   This section outlines a way for an origin server to send state
   information to a user agent and for the user agent to return the
   state information to the origin server.

   To store state, the origin server includes a Set-Cookie header in an
   HTTP response.  In subsequent requests, the user agent returns a
   Cookie request header to the origin server.  The Cookie header
   contains cookies the user agent received in previous Set-Cookie
   headers.  The origin server is free to ignore the Cookie header or
   use its contents for an application-defined purpose.

   Origin servers MAY send a Set-Cookie response header with any
   response.  User agents MAY ignore Set-Cookie headers contained in
   responses with 100-level status codes but MUST process Set-Cookie
   headers contained in other responses (including responses with 400-
   and 500-level status codes).  An origin server can include multiple
   Set-Cookie header fields in a single response.  The presence of a
   Cookie or a Set-Cookie header field does not preclude HTTP caches
   from storing and reusing a response.

   Origin servers SHOULD NOT fold multiple Set-Cookie header fields into
   a single header field.  The usual mechanism for folding HTTP headers
   fields (i.e., as defined in [[RFC2616](./rfc2616 "\"Hypertext Transfer Protocol -- HTTP/1.1\"")]) might change the semantics of
   the Set-Cookie header field because the %x2C (",") character is used
   by Set-Cookie in a way that conflicts with such folding.

[3.1](#section-3.1).  Examples

   Using the Set-Cookie header, a server can send the user agent a short
   string in an HTTP response that the user agent will return in future
   HTTP requests that are within the scope of the cookie.  For example,
   the server can send the user agent a "session identifier" named SID
   with the value 31d4d96e407aad42.  The user agent then returns the
   session identifier in subsequent requests.

Barth                        Standards Track                    [Page 6]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   == Server -> User Agent ==

   Set-Cookie: SID=31d4d96e407aad42

   == User Agent -> Server ==

   Cookie: SID=31d4d96e407aad42

   The server can alter the default scope of the cookie using the Path
   and Domain attributes.  For example, the server can instruct the user
   agent to return the cookie to every path and every subdomain of
   example.com.

   == Server -> User Agent ==

   Set-Cookie: SID=31d4d96e407aad42; Path=/; Domain=example.com

   == User Agent -> Server ==

   Cookie: SID=31d4d96e407aad42

   As shown in the next example, the server can store multiple cookies
   at the user agent.  For example, the server can store a session
   identifier as well as the user's preferred language by returning two
   Set-Cookie header fields.  Notice that the server uses the Secure and
   HttpOnly attributes to provide additional security protections for
   the more sensitive session identifier (see [Section 4.1.2](#section-4.1.2).)

   == Server -> User Agent ==

   Set-Cookie: SID=31d4d96e407aad42; Path=/; Secure; HttpOnly
   Set-Cookie: lang=en-US; Path=/; Domain=example.com

   == User Agent -> Server ==

   Cookie: SID=31d4d96e407aad42; lang=en-US

   Notice that the Cookie header above contains two cookies, one named
   SID and one named lang.  If the server wishes the user agent to
   persist the cookie over multiple "sessions" (e.g., user agent
   restarts), the server can specify an expiration date in the Expires
   attribute.  Note that the user agent might delete the cookie before
   the expiration date if the user agent's cookie store exceeds its
   quota or if the user manually deletes the server's cookie.

Barth                        Standards Track                    [Page 7]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   == Server -> User Agent ==

   Set-Cookie: lang=en-US; Expires=Wed, 09 Jun 2021 10:18:14 GMT

   == User Agent -> Server ==

   Cookie: SID=31d4d96e407aad42; lang=en-US

   Finally, to remove a cookie, the server returns a Set-Cookie header
   with an expiration date in the past.  The server will be successful
   in removing the cookie only if the Path and the Domain attribute in
   the Set-Cookie header match the values used when the cookie was
   created.

   == Server -> User Agent ==

   Set-Cookie: lang=; Expires=Sun, 06 Nov 1994 08:49:37 GMT

   == User Agent -> Server ==

   Cookie: SID=31d4d96e407aad42

[4](#section-4).  Server Requirements

   This section describes the syntax and semantics of a well-behaved
   profile of the Cookie and Set-Cookie headers.

[4.1](#section-4.1).  Set-Cookie

   The Set-Cookie HTTP response header is used to send cookies from the
   server to the user agent.

[4.1.1](#section-4.1.1).  Syntax

   Informally, the Set-Cookie response header contains the header name
   "Set-Cookie" followed by a ":" and a cookie.  Each cookie begins with
   a name-value-pair, followed by zero or more attribute-value pairs.
   Servers SHOULD NOT send Set-Cookie headers that fail to conform to
   the following grammar:

Barth                        Standards Track                    [Page 8]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

 set-cookie-header = "Set-Cookie:" SP set-cookie-string
 set-cookie-string = cookie-pair *( ";" SP cookie-av )
 cookie-pair       = cookie-name "=" cookie-value
 cookie-name       = token
 cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )
 cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E
                       ; US-ASCII characters excluding CTLs,
                       ; whitespace DQUOTE, comma, semicolon,
                       ; and backslash
 token             = <token, defined in [[RFC2616], Section 2.2](./rfc2616#section-2.2)>

 cookie-av         = expires-av / max-age-av / domain-av /
                     path-av / secure-av / httponly-av /
                     extension-av
 expires-av        = "Expires=" sane-cookie-date
 sane-cookie-date  = <[rfc1123](./rfc1123)-date, defined in [[RFC2616], Section 3.3.1](./rfc2616#section-3.3.1)>
 max-age-av        = "Max-Age=" non-zero-digit *DIGIT
                       ; In practice, both expires-av and max-age-av
                       ; are limited to dates representable by the
                       ; user agent.
 non-zero-digit    = %x31-39
                       ; digits 1 through 9
 domain-av         = "Domain=" domain-value
 domain-value      = <subdomain>
                       ; defined in [[RFC1034], Section 3.5](./rfc1034#section-3.5), as
                       ; enhanced by [[RFC1123], Section 2.1](./rfc1123#section-2.1)
 path-av           = "Path=" path-value
 path-value        = <any CHAR except CTLs or ";">
 secure-av         = "Secure"
 httponly-av       = "HttpOnly"
 extension-av      = <any CHAR except CTLs or ";">

   Note that some of the grammatical terms above reference documents
   that use different grammatical notations than this document (which
   uses ABNF from [[RFC5234](./rfc5234 "\"Augmented BNF for Syntax Specifications: ABNF\"")]).

   The semantics of the cookie-value are not defined by this document.

   To maximize compatibility with user agents, servers that wish to
   store arbitrary data in a cookie-value SHOULD encode that data, for
   example, using Base64 [[RFC4648](./rfc4648 "\"The Base16, Base32, and Base64 Data Encodings\"")].

   The portions of the set-cookie-string produced by the cookie-av term
   are known as attributes.  To maximize compatibility with user agents,
   servers SHOULD NOT produce two attributes with the same name in the
   same set-cookie-string.  (See [Section 5.3](#section-5.3) for how user agents handle
   this case.)

Barth                        Standards Track                    [Page 9]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   Servers SHOULD NOT include more than one Set-Cookie header field in
   the same response with the same cookie-name.  (See [Section 5.2](#section-5.2) for
   how user agents handle this case.)

   If a server sends multiple responses containing Set-Cookie headers
   concurrently to the user agent (e.g., when communicating with the
   user agent over multiple sockets), these responses create a "race
   condition" that can lead to unpredictable behavior.

   NOTE: Some existing user agents differ in their interpretation of
   two-digit years.  To avoid compatibility issues, servers SHOULD use
   the [rfc1123](./rfc1123)-date format, which requires a four-digit year.

   NOTE: Some user agents store and process dates in cookies as 32-bit
   UNIX time_t values.  Implementation bugs in the libraries supporting
   time_t processing on some systems might cause such user agents to
   process dates after the year 2038 incorrectly.

[4.1.2](#section-4.1.2).  Semantics (Non-Normative)

   This section describes simplified semantics of the Set-Cookie header.
   These semantics are detailed enough to be useful for understanding
   the most common uses of cookies by servers.  The full semantics are
   described in [Section 5](#section-5).

   When the user agent receives a Set-Cookie header, the user agent
   stores the cookie together with its attributes.  Subsequently, when
   the user agent makes an HTTP request, the user agent includes the
   applicable, non-expired cookies in the Cookie header.

   If the user agent receives a new cookie with the same cookie-name,
   domain-value, and path-value as a cookie that it has already stored,
   the existing cookie is evicted and replaced with the new cookie.
   Notice that servers can delete cookies by sending the user agent a
   new cookie with an Expires attribute with a value in the past.

   Unless the cookie's attributes indicate otherwise, the cookie is
   returned only to the origin server (and not, for example, to any
   subdomains), and it expires at the end of the current session (as
   defined by the user agent).  User agents ignore unrecognized cookie
   attributes (but not the entire cookie).

Barth                        Standards Track                   [Page 10]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[4.1.2.1](#section-4.1.2.1).  The Expires Attribute

   The Expires attribute indicates the maximum lifetime of the cookie,
   represented as the date and time at which the cookie expires.  The
   user agent is not required to retain the cookie until the specified
   date has passed.  In fact, user agents often evict cookies due to
   memory pressure or privacy concerns.

[4.1.2.2](#section-4.1.2.2).  The Max-Age Attribute

   The Max-Age attribute indicates the maximum lifetime of the cookie,
   represented as the number of seconds until the cookie expires.  The
   user agent is not required to retain the cookie for the specified
   duration.  In fact, user agents often evict cookies due to memory
   pressure or privacy concerns.

      NOTE: Some existing user agents do not support the Max-Age
      attribute.  User agents that do not support the Max-Age attribute
      ignore the attribute.

   If a cookie has both the Max-Age and the Expires attribute, the Max-
   Age attribute has precedence and controls the expiration date of the
   cookie.  If a cookie has neither the Max-Age nor the Expires
   attribute, the user agent will retain the cookie until "the current
   session is over" (as defined by the user agent).

[4.1.2.3](#section-4.1.2.3).  The Domain Attribute

   The Domain attribute specifies those hosts to which the cookie will
   be sent.  For example, if the value of the Domain attribute is
   "example.com", the user agent will include the cookie in the Cookie
   header when making HTTP requests to example.com, www.example.com, and
   www.corp.example.com.  (Note that a leading %x2E ("."), if present,
   is ignored even though that character is not permitted, but a
   trailing %x2E ("."), if present, will cause the user agent to ignore
   the attribute.)  If the server omits the Domain attribute, the user
   agent will return the cookie only to the origin server.

      WARNING: Some existing user agents treat an absent Domain
      attribute as if the Domain attribute were present and contained
      the current host name.  For example, if example.com returns a Set-
      Cookie header without a Domain attribute, these user agents will
      erroneously send the cookie to www.example.com as well.

Barth                        Standards Track                   [Page 11]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   The user agent will reject cookies unless the Domain attribute
   specifies a scope for the cookie that would include the origin
   server.  For example, the user agent will accept a cookie with a
   Domain attribute of "example.com" or of "foo.example.com" from
   foo.example.com, but the user agent will not accept a cookie with a
   Domain attribute of "bar.example.com" or of "baz.foo.example.com".

   NOTE: For security reasons, many user agents are configured to reject
   Domain attributes that correspond to "public suffixes".  For example,
   some user agents will reject Domain attributes of "com" or "co.uk".
   (See [Section 5.3](#section-5.3) for more information.)

[4.1.2.4](#section-4.1.2.4).  The Path Attribute

   The scope of each cookie is limited to a set of paths, controlled by
   the Path attribute.  If the server omits the Path attribute, the user
   agent will use the "directory" of the request-uri's path component as
   the default value.  (See [Section 5.1.4](#section-5.1.4) for more details.)

   The user agent will include the cookie in an HTTP request only if the
   path portion of the request-uri matches (or is a subdirectory of) the
   cookie's Path attribute, where the %x2F ("/") character is
   interpreted as a directory separator.

   Although seemingly useful for isolating cookies between different
   paths within a given host, the Path attribute cannot be relied upon
   for security (see [Section 8](#section-8)).

[4.1.2.5](#section-4.1.2.5).  The Secure Attribute

   The Secure attribute limits the scope of the cookie to "secure"
   channels (where "secure" is defined by the user agent).  When a
   cookie has the Secure attribute, the user agent will include the
   cookie in an HTTP request only if the request is transmitted over a
   secure channel (typically HTTP over Transport Layer Security (TLS)
   [[RFC2818](./rfc2818 "\"HTTP Over TLS\"")]).

   Although seemingly useful for protecting cookies from active network
   attackers, the Secure attribute protects only the cookie's
   confidentiality.  An active network attacker can overwrite Secure
   cookies from an insecure channel, disrupting their integrity (see
   [Section 8.6](#section-8.6) for more details).

Barth                        Standards Track                   [Page 12]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[4.1.2.6](#section-4.1.2.6).  The HttpOnly Attribute

   The HttpOnly attribute limits the scope of the cookie to HTTP
   requests.  In particular, the attribute instructs the user agent to
   omit the cookie when providing access to cookies via "non-HTTP" APIs
   (such as a web browser API that exposes cookies to scripts).

   Note that the HttpOnly attribute is independent of the Secure
   attribute: a cookie can have both the HttpOnly and the Secure
   attribute.

[4.2](#section-4.2).  Cookie

[4.2.1](#section-4.2.1).  Syntax

   The user agent sends stored cookies to the origin server in the
   Cookie header.  If the server conforms to the requirements in
   [Section 4.1](#section-4.1) (and the user agent conforms to the requirements in
   [Section 5](#section-5)), the user agent will send a Cookie header that conforms to
   the following grammar:

   cookie-header = "Cookie:" OWS cookie-string OWS
   cookie-string = cookie-pair *( ";" SP cookie-pair )

[4.2.2](#section-4.2.2).  Semantics

   Each cookie-pair represents a cookie stored by the user agent.  The
   cookie-pair contains the cookie-name and cookie-value the user agent
   received in the Set-Cookie header.

   Notice that the cookie attributes are not returned.  In particular,
   the server cannot determine from the Cookie header alone when a
   cookie will expire, for which hosts the cookie is valid, for which
   paths the cookie is valid, or whether the cookie was set with the
   Secure or HttpOnly attributes.

   The semantics of individual cookies in the Cookie header are not
   defined by this document.  Servers are expected to imbue these
   cookies with application-specific semantics.

   Although cookies are serialized linearly in the Cookie header,
   servers SHOULD NOT rely upon the serialization order.  In particular,
   if the Cookie header contains two cookies with the same name (e.g.,
   that were set with different Path or Domain attributes), servers
   SHOULD NOT rely upon the order in which these cookies appear in the
   header.

Barth                        Standards Track                   [Page 13]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[5](#section-5).  User Agent Requirements

   This section specifies the Cookie and Set-Cookie headers in
   sufficient detail that a user agent implementing these requirements
   precisely can interoperate with existing servers (even those that do
   not conform to the well-behaved profile described in [Section 4](#section-4)).

   A user agent could enforce more restrictions than those specified
   herein (e.g., for the sake of improved security); however,
   experiments have shown that such strictness reduces the likelihood
   that a user agent will be able to interoperate with existing servers.

[5.1](#section-5.1).  Subcomponent Algorithms

   This section defines some algorithms used by user agents to process
   specific subcomponents of the Cookie and Set-Cookie headers.

[5.1.1](#section-5.1.1).  Dates

   The user agent MUST use an algorithm equivalent to the following
   algorithm to parse a cookie-date.  Note that the various boolean
   flags defined as a part of the algorithm (i.e., found-time, found-
   day-of-month, found-month, found-year) are initially "not set".

   1.  Using the grammar below, divide the cookie-date into date-tokens.

   cookie-date     = *delimiter date-token-list *delimiter
   date-token-list = date-token *( 1*delimiter date-token )
   date-token      = 1*non-delimiter

   delimiter       = %x09 / %x20-2F / %x3B-40 / %x5B-60 / %x7B-7E
   non-delimiter   = %x00-08 / %x0A-1F / DIGIT / ":" / ALPHA / %x7F-FF
   non-digit       = %x00-2F / %x3A-FF

   day-of-month    = 1*2DIGIT ( non-digit *OCTET )
   month           = ( "jan" / "feb" / "mar" / "apr" /
                       "may" / "jun" / "jul" / "aug" /
                       "sep" / "oct" / "nov" / "dec" ) *OCTET
   year            = 2*4DIGIT ( non-digit *OCTET )
   time            = hms-time ( non-digit *OCTET )
   hms-time        = time-field ":" time-field ":" time-field
   time-field      = 1*2DIGIT

   2.  Process each date-token sequentially in the order the date-tokens
       appear in the cookie-date:

Barth                        Standards Track                   [Page 14]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

       1.  If the found-time flag is not set and the token matches the
           time production, set the found-time flag and set the hour-
           value, minute-value, and second-value to the numbers denoted
           by the digits in the date-token, respectively.  Skip the
           remaining sub-steps and continue to the next date-token.

       2.  If the found-day-of-month flag is not set and the date-token
           matches the day-of-month production, set the found-day-of-
           month flag and set the day-of-month-value to the number
           denoted by the date-token.  Skip the remaining sub-steps and
           continue to the next date-token.

       3.  If the found-month flag is not set and the date-token matches
           the month production, set the found-month flag and set the
           month-value to the month denoted by the date-token.  Skip the
           remaining sub-steps and continue to the next date-token.

       4.  If the found-year flag is not set and the date-token matches
           the year production, set the found-year flag and set the
           year-value to the number denoted by the date-token.  Skip the
           remaining sub-steps and continue to the next date-token.

   3.  If the year-value is greater than or equal to 70 and less than or
       equal to 99, increment the year-value by 1900.

   4.  If the year-value is greater than or equal to 0 and less than or
       equal to 69, increment the year-value by 2000.

       1.  NOTE: Some existing user agents interpret two-digit years
           differently.

   5.  Abort these steps and fail to parse the cookie-date if:

       *  at least one of the found-day-of-month, found-month, found-
          year, or found-time flags is not set,

       *  the day-of-month-value is less than 1 or greater than 31,

       *  the year-value is less than 1601,

       *  the hour-value is greater than 23,

       *  the minute-value is greater than 59, or

       *  the second-value is greater than 59.

       (Note that leap seconds cannot be represented in this syntax.)

Barth                        Standards Track                   [Page 15]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   6.  Let the parsed-cookie-date be the date whose day-of-month, month,
       year, hour, minute, and second (in UTC) are the day-of-month-
       value, the month-value, the year-value, the hour-value, the
       minute-value, and the second-value, respectively.  If no such
       date exists, abort these steps and fail to parse the cookie-date.

   7.  Return the parsed-cookie-date as the result of this algorithm.

[5.1.2](#section-5.1.2).  Canonicalized Host Names

   A canonicalized host name is the string generated by the following
   algorithm:

   1.  Convert the host name to a sequence of individual domain name
       labels.

   2.  Convert each label that is not a Non-Reserved LDH (NR-LDH) label,
       to an A-label (see [Section 2.3.2.1 of [RFC5890]](./rfc5890#section-2.3.2.1) for the former
       and latter), or to a "punycode label" (a label resulting from the
       "ToASCII" conversion in [Section 4 of [RFC3490]](./rfc3490#section-4)), as appropriate
       (see [Section 6.3](#section-6.3) of this specification).

   3.  Concatenate the resulting labels, separated by a %x2E (".")
       character.

[5.1.3](#section-5.1.3).  Domain Matching

   A string domain-matches a given domain string if at least one of the
   following conditions hold:

   o  The domain string and the string are identical.  (Note that both
      the domain string and the string will have been canonicalized to
      lower case at this point.)

   o  All of the following conditions hold:

      *  The domain string is a suffix of the string.

      *  The last character of the string that is not included in the
         domain string is a %x2E (".") character.

      *  The string is a host name (i.e., not an IP address).

[5.1.4](#section-5.1.4).  Paths and Path-Match

   The user agent MUST use an algorithm equivalent to the following
   algorithm to compute the default-path of a cookie:

Barth                        Standards Track                   [Page 16]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   1.  Let uri-path be the path portion of the request-uri if such a
       portion exists (and empty otherwise).  For example, if the
       request-uri contains just a path (and optional query string),
       then the uri-path is that path (without the %x3F ("?") character
       or query string), and if the request-uri contains a full
       absoluteURI, the uri-path is the path component of that URI.

   2.  If the uri-path is empty or if the first character of the uri-
       path is not a %x2F ("/") character, output %x2F ("/") and skip
       the remaining steps.

   3.  If the uri-path contains no more than one %x2F ("/") character,
       output %x2F ("/") and skip the remaining step.

   4.  Output the characters of the uri-path from the first character up
       to, but not including, the right-most %x2F ("/").

   A request-path path-matches a given cookie-path if at least one of
   the following conditions holds:

   o  The cookie-path and the request-path are identical.

   o  The cookie-path is a prefix of the request-path, and the last
      character of the cookie-path is %x2F ("/").

   o  The cookie-path is a prefix of the request-path, and the first
      character of the request-path that is not included in the cookie-
      path is a %x2F ("/") character.

[5.2](#section-5.2).  The Set-Cookie Header

   When a user agent receives a Set-Cookie header field in an HTTP
   response, the user agent MAY ignore the Set-Cookie header field in
   its entirety.  For example, the user agent might wish to block
   responses to "third-party" requests from setting cookies (see
   [Section 7.1](#section-7.1)).

   If the user agent does not ignore the Set-Cookie header field in its
   entirety, the user agent MUST parse the field-value of the Set-Cookie
   header field as a set-cookie-string (defined below).

   NOTE: The algorithm below is more permissive than the grammar in
   [Section 4.1](#section-4.1).  For example, the algorithm strips leading and trailing
   whitespace from the cookie name and value (but maintains internal
   whitespace), whereas the grammar in [Section 4.1](#section-4.1) forbids whitespace in
   these positions.  User agents use this algorithm so as to
   interoperate with servers that do not follow the recommendations in
   [Section 4](#section-4).

Barth                        Standards Track                   [Page 17]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   A user agent MUST use an algorithm equivalent to the following
   algorithm to parse a "set-cookie-string":

   1.  If the set-cookie-string contains a %x3B (";") character:

          The name-value-pair string consists of the characters up to,
          but not including, the first %x3B (";"), and the unparsed-
          attributes consist of the remainder of the set-cookie-string
          (including the %x3B (";") in question).

       Otherwise:

          The name-value-pair string consists of all the characters
          contained in the set-cookie-string, and the unparsed-
          attributes is the empty string.

   2.  If the name-value-pair string lacks a %x3D ("=") character,
       ignore the set-cookie-string entirely.

   3.  The (possibly empty) name string consists of the characters up
       to, but not including, the first %x3D ("=") character, and the
       (possibly empty) value string consists of the characters after
       the first %x3D ("=") character.

   4.  Remove any leading or trailing WSP characters from the name
       string and the value string.

   5.  If the name string is empty, ignore the set-cookie-string
       entirely.

   6.  The cookie-name is the name string, and the cookie-value is the
       value string.

   The user agent MUST use an algorithm equivalent to the following
   algorithm to parse the unparsed-attributes:

   1.  If the unparsed-attributes string is empty, skip the rest of
       these steps.

   2.  Discard the first character of the unparsed-attributes (which
       will be a %x3B (";") character).

   3.  If the remaining unparsed-attributes contains a %x3B (";")
       character:

          Consume the characters of the unparsed-attributes up to, but
          not including, the first %x3B (";") character.

Barth                        Standards Track                   [Page 18]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

       Otherwise:

          Consume the remainder of the unparsed-attributes.

       Let the cookie-av string be the characters consumed in this step.

   4.  If the cookie-av string contains a %x3D ("=") character:

          The (possibly empty) attribute-name string consists of the
          characters up to, but not including, the first %x3D ("=")
          character, and the (possibly empty) attribute-value string
          consists of the characters after the first %x3D ("=")
          character.

       Otherwise:

          The attribute-name string consists of the entire cookie-av
          string, and the attribute-value string is empty.

   5.  Remove any leading or trailing WSP characters from the attribute-
       name string and the attribute-value string.

   6.  Process the attribute-name and attribute-value according to the
       requirements in the following subsections.  (Notice that
       attributes with unrecognized attribute-names are ignored.)

   7.  Return to Step 1 of this algorithm.

   When the user agent finishes parsing the set-cookie-string, the user
   agent is said to "receive a cookie" from the request-uri with name
   cookie-name, value cookie-value, and attributes cookie-attribute-
   list.  (See [Section 5.3](#section-5.3) for additional requirements triggered by
   receiving a cookie.)

[5.2.1](#section-5.2.1).  The Expires Attribute

   If the attribute-name case-insensitively matches the string
   "Expires", the user agent MUST process the cookie-av as follows.

   Let the expiry-time be the result of parsing the attribute-value as
   cookie-date (see [Section 5.1.1](#section-5.1.1)).

   If the attribute-value failed to parse as a cookie date, ignore the
   cookie-av.

   If the expiry-time is later than the last date the user agent can
   represent, the user agent MAY replace the expiry-time with the last
   representable date.

Barth                        Standards Track                   [Page 19]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   If the expiry-time is earlier than the earliest date the user agent
   can represent, the user agent MAY replace the expiry-time with the
   earliest representable date.

   Append an attribute to the cookie-attribute-list with an attribute-
   name of Expires and an attribute-value of expiry-time.

[5.2.2](#section-5.2.2).  The Max-Age Attribute

   If the attribute-name case-insensitively matches the string "Max-
   Age", the user agent MUST process the cookie-av as follows.

   If the first character of the attribute-value is not a DIGIT or a "-"
   character, ignore the cookie-av.

   If the remainder of attribute-value contains a non-DIGIT character,
   ignore the cookie-av.

   Let delta-seconds be the attribute-value converted to an integer.

   If delta-seconds is less than or equal to zero (0), let expiry-time
   be the earliest representable date and time.  Otherwise, let the
   expiry-time be the current date and time plus delta-seconds seconds.

   Append an attribute to the cookie-attribute-list with an attribute-
   name of Max-Age and an attribute-value of expiry-time.

[5.2.3](#section-5.2.3).  The Domain Attribute

   If the attribute-name case-insensitively matches the string "Domain",
   the user agent MUST process the cookie-av as follows.

   If the attribute-value is empty, the behavior is undefined.  However,
   the user agent SHOULD ignore the cookie-av entirely.

   If the first character of the attribute-value string is %x2E ("."):

      Let cookie-domain be the attribute-value without the leading %x2E
      (".") character.

   Otherwise:

      Let cookie-domain be the entire attribute-value.

   Convert the cookie-domain to lower case.

   Append an attribute to the cookie-attribute-list with an attribute-
   name of Domain and an attribute-value of cookie-domain.

Barth                        Standards Track                   [Page 20]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[5.2.4](#section-5.2.4).  The Path Attribute

   If the attribute-name case-insensitively matches the string "Path",
   the user agent MUST process the cookie-av as follows.

   If the attribute-value is empty or if the first character of the
   attribute-value is not %x2F ("/"):

      Let cookie-path be the default-path.

   Otherwise:

      Let cookie-path be the attribute-value.

   Append an attribute to the cookie-attribute-list with an attribute-
   name of Path and an attribute-value of cookie-path.

[5.2.5](#section-5.2.5).  The Secure Attribute

   If the attribute-name case-insensitively matches the string "Secure",
   the user agent MUST append an attribute to the cookie-attribute-list
   with an attribute-name of Secure and an empty attribute-value.

[5.2.6](#section-5.2.6).  The HttpOnly Attribute

   If the attribute-name case-insensitively matches the string
   "HttpOnly", the user agent MUST append an attribute to the cookie-
   attribute-list with an attribute-name of HttpOnly and an empty
   attribute-value.

[5.3](#section-5.3).  Storage Model

   The user agent stores the following fields about each cookie: name,
   value, expiry-time, domain, path, creation-time, last-access-time,
   persistent-flag, host-only-flag, secure-only-flag, and http-only-
   flag.

   When the user agent "receives a cookie" from a request-uri with name
   cookie-name, value cookie-value, and attributes cookie-attribute-
   list, the user agent MUST process the cookie as follows:

   1.   A user agent MAY ignore a received cookie in its entirety.  For
        example, the user agent might wish to block receiving cookies
        from "third-party" responses or the user agent might not wish to
        store cookies that exceed some size.

Barth                        Standards Track                   [Page 21]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   2.   Create a new cookie with name cookie-name, value cookie-value.
        Set the creation-time and the last-access-time to the current
        date and time.

   3.   If the cookie-attribute-list contains an attribute with an
        attribute-name of "Max-Age":

           Set the cookie's persistent-flag to true.

           Set the cookie's expiry-time to attribute-value of the last
           attribute in the cookie-attribute-list with an attribute-name
           of "Max-Age".

        Otherwise, if the cookie-attribute-list contains an attribute
        with an attribute-name of "Expires" (and does not contain an
        attribute with an attribute-name of "Max-Age"):

           Set the cookie's persistent-flag to true.

           Set the cookie's expiry-time to attribute-value of the last
           attribute in the cookie-attribute-list with an attribute-name
           of "Expires".

        Otherwise:

           Set the cookie's persistent-flag to false.

           Set the cookie's expiry-time to the latest representable
           date.

   4.   If the cookie-attribute-list contains an attribute with an
        attribute-name of "Domain":

           Let the domain-attribute be the attribute-value of the last
           attribute in the cookie-attribute-list with an attribute-name
           of "Domain".

        Otherwise:

           Let the domain-attribute be the empty string.

   5.   If the user agent is configured to reject "public suffixes" and
        the domain-attribute is a public suffix:

           If the domain-attribute is identical to the canonicalized
           request-host:

              Let the domain-attribute be the empty string.

Barth                        Standards Track                   [Page 22]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

           Otherwise:

              Ignore the cookie entirely and abort these steps.

           NOTE: A "public suffix" is a domain that is controlled by a
           public registry, such as "com", "co.uk", and "pvt.k12.wy.us".
           This step is essential for preventing attacker.com from
           disrupting the integrity of example.com by setting a cookie
           with a Domain attribute of "com".  Unfortunately, the set of
           public suffixes (also known as "registry controlled domains")
           changes over time.  If feasible, user agents SHOULD use an
           up-to-date public suffix list, such as the one maintained by
           the Mozilla project at <[http://publicsuffix.org/](https://publicsuffix.org/)>.

   6.   If the domain-attribute is non-empty:

           If the canonicalized request-host does not domain-match the
           domain-attribute:

              Ignore the cookie entirely and abort these steps.

           Otherwise:

              Set the cookie's host-only-flag to false.

              Set the cookie's domain to the domain-attribute.

        Otherwise:

           Set the cookie's host-only-flag to true.

           Set the cookie's domain to the canonicalized request-host.

   7.   If the cookie-attribute-list contains an attribute with an
        attribute-name of "Path", set the cookie's path to attribute-
        value of the last attribute in the cookie-attribute-list with an
        attribute-name of "Path".  Otherwise, set the cookie's path to
        the default-path of the request-uri.

   8.   If the cookie-attribute-list contains an attribute with an
        attribute-name of "Secure", set the cookie's secure-only-flag to
        true.  Otherwise, set the cookie's secure-only-flag to false.

   9.   If the cookie-attribute-list contains an attribute with an
        attribute-name of "HttpOnly", set the cookie's http-only-flag to
        true.  Otherwise, set the cookie's http-only-flag to false.

Barth                        Standards Track                   [Page 23]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   10.  If the cookie was received from a "non-HTTP" API and the
        cookie's http-only-flag is set, abort these steps and ignore the
        cookie entirely.

   11.  If the cookie store contains a cookie with the same name,
        domain, and path as the newly created cookie:

        1.  Let old-cookie be the existing cookie with the same name,
            domain, and path as the newly created cookie.  (Notice that
            this algorithm maintains the invariant that there is at most
            one such cookie.)

        2.  If the newly created cookie was received from a "non-HTTP"
            API and the old-cookie's http-only-flag is set, abort these
            steps and ignore the newly created cookie entirely.

        3.  Update the creation-time of the newly created cookie to
            match the creation-time of the old-cookie.

        4.  Remove the old-cookie from the cookie store.

   12.  Insert the newly created cookie into the cookie store.

   A cookie is "expired" if the cookie has an expiry date in the past.

   The user agent MUST evict all expired cookies from the cookie store
   if, at any time, an expired cookie exists in the cookie store.

   At any time, the user agent MAY "remove excess cookies" from the
   cookie store if the number of cookies sharing a domain field exceeds
   some implementation-defined upper bound (such as 50 cookies).

   At any time, the user agent MAY "remove excess cookies" from the
   cookie store if the cookie store exceeds some predetermined upper
   bound (such as 3000 cookies).

   When the user agent removes excess cookies from the cookie store, the
   user agent MUST evict cookies in the following priority order:

   1.  Expired cookies.

   2.  Cookies that share a domain field with more than a predetermined
       number of other cookies.

   3.  All cookies.

   If two cookies have the same removal priority, the user agent MUST
   evict the cookie with the earliest last-access date first.

Barth                        Standards Track                   [Page 24]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   When "the current session is over" (as defined by the user agent),
   the user agent MUST remove from the cookie store all cookies with the
   persistent-flag set to false.

[5.4](#section-5.4).  The Cookie Header

   The user agent includes stored cookies in the Cookie HTTP request
   header.

   When the user agent generates an HTTP request, the user agent MUST
   NOT attach more than one Cookie header field.

   A user agent MAY omit the Cookie header in its entirety.  For
   example, the user agent might wish to block sending cookies during
   "third-party" requests from setting cookies (see [Section 7.1](#section-7.1)).

   If the user agent does attach a Cookie header field to an HTTP
   request, the user agent MUST send the cookie-string (defined below)
   as the value of the header field.

   The user agent MUST use an algorithm equivalent to the following
   algorithm to compute the "cookie-string" from a cookie store and a
   request-uri:

   1.  Let cookie-list be the set of cookies from the cookie store that
       meets all of the following requirements:

       *  Either:

             The cookie's host-only-flag is true and the canonicalized
             request-host is identical to the cookie's domain.

          Or:

             The cookie's host-only-flag is false and the canonicalized
             request-host domain-matches the cookie's domain.

       *  The request-uri's path path-matches the cookie's path.

       *  If the cookie's secure-only-flag is true, then the request-
          uri's scheme must denote a "secure" protocol (as defined by
          the user agent).

             NOTE: The notion of a "secure" protocol is not defined by
             this document.  Typically, user agents consider a protocol
             secure if the protocol makes use of transport-layer

Barth                        Standards Track                   [Page 25]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

             security, such as SSL or TLS.  For example, most user
             agents consider "https" to be a scheme that denotes a
             secure protocol.

       *  If the cookie's http-only-flag is true, then exclude the
          cookie if the cookie-string is being generated for a "non-
          HTTP" API (as defined by the user agent).

   2.  The user agent SHOULD sort the cookie-list in the following
       order:

       *  Cookies with longer paths are listed before cookies with
          shorter paths.

       *  Among cookies that have equal-length path fields, cookies with
          earlier creation-times are listed before cookies with later
          creation-times.

       NOTE: Not all user agents sort the cookie-list in this order, but
       this order reflects common practice when this document was
       written, and, historically, there have been servers that
       (erroneously) depended on this order.

   3.  Update the last-access-time of each cookie in the cookie-list to
       the current date and time.

   4.  Serialize the cookie-list into a cookie-string by processing each
       cookie in the cookie-list in order:

       1.  Output the cookie's name, the %x3D ("=") character, and the
           cookie's value.

       2.  If there is an unprocessed cookie in the cookie-list, output
           the characters %x3B and %x20 ("; ").

   NOTE: Despite its name, the cookie-string is actually a sequence of
   octets, not a sequence of characters.  To convert the cookie-string
   (or components thereof) into a sequence of characters (e.g., for
   presentation to the user), the user agent might wish to try using the
   UTF-8 character encoding [[RFC3629](./rfc3629 "\"UTF-8, a transformation format of ISO 10646\"")] to decode the octet sequence.
   This decoding might fail, however, because not every sequence of
   octets is valid UTF-8.

Barth                        Standards Track                   [Page 26]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[6](#section-6).  Implementation Considerations

[6.1](#section-6.1).  Limits

   Practical user agent implementations have limits on the number and
   size of cookies that they can store.  General-use user agents SHOULD
   provide each of the following minimum capabilities:

   o  At least 4096 bytes per cookie (as measured by the sum of the
      length of the cookie's name, value, and attributes).

   o  At least 50 cookies per domain.

   o  At least 3000 cookies total.

   Servers SHOULD use as few and as small cookies as possible to avoid
   reaching these implementation limits and to minimize network
   bandwidth due to the Cookie header being included in every request.

   Servers SHOULD gracefully degrade if the user agent fails to return
   one or more cookies in the Cookie header because the user agent might
   evict any cookie at any time on orders from the user.

[6.2](#section-6.2).  Application Programming Interfaces

   One reason the Cookie and Set-Cookie headers use such esoteric syntax
   is that many platforms (both in servers and user agents) provide a
   string-based application programming interface (API) to cookies,
   requiring application-layer programmers to generate and parse the
   syntax used by the Cookie and Set-Cookie headers, which many
   programmers have done incorrectly, resulting in interoperability
   problems.

   Instead of providing string-based APIs to cookies, platforms would be
   well-served by providing more semantic APIs.  It is beyond the scope
   of this document to recommend specific API designs, but there are
   clear benefits to accepting an abstract "Date" object instead of a
   serialized date string.

[6.3](#section-6.3).  IDNA Dependency and Migration

   IDNA2008 [[RFC5890](./rfc5890 "\"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework\"")] supersedes IDNA2003 [[RFC3490](./rfc3490 "\"Internationalizing Domain Names in Applications (IDNA)\"")].  However, there are
   differences between the two specifications, and thus there can be
   differences in processing (e.g., converting) domain name labels that
   have been registered under one from those registered under the other.
   There will be a transition period of some time during which IDNA2003-
   based domain name labels will exist in the wild.  User agents SHOULD
   implement IDNA2008 [[RFC5890](./rfc5890 "\"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework\"")] and MAY implement [[UTS46](#ref-UTS46 "\"Unicode IDNA Compatibility Processing\"")] or [[RFC5895](./rfc5895 "\"Mapping Characters for Internationalized Domain Names in Applications (IDNA) 2008\"")]

Barth                        Standards Track                   [Page 27]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   in order to facilitate their IDNA transition.  If a user agent does
   not implement IDNA2008, the user agent MUST implement IDNA2003
   [[RFC3490](./rfc3490 "\"Internationalizing Domain Names in Applications (IDNA)\"")].

[7](#section-7).  Privacy Considerations

   Cookies are often criticized for letting servers track users.  For
   example, a number of "web analytics" companies use cookies to
   recognize when a user returns to a web site or visits another web
   site.  Although cookies are not the only mechanism servers can use to
   track users across HTTP requests, cookies facilitate tracking because
   they are persistent across user agent sessions and can be shared
   between hosts.

[7.1](#section-7.1).  Third-Party Cookies

   Particularly worrisome are so-called "third-party" cookies.  In
   rendering an HTML document, a user agent often requests resources
   from other servers (such as advertising networks).  These third-party
   servers can use cookies to track the user even if the user never
   visits the server directly.  For example, if a user visits a site
   that contains content from a third party and then later visits
   another site that contains content from the same third party, the
   third party can track the user between the two sites.

   Some user agents restrict how third-party cookies behave.  For
   example, some of these user agents refuse to send the Cookie header
   in third-party requests.  Others refuse to process the Set-Cookie
   header in responses to third-party requests.  User agents vary widely
   in their third-party cookie policies.  This document grants user
   agents wide latitude to experiment with third-party cookie policies
   that balance the privacy and compatibility needs of their users.
   However, this document does not endorse any particular third-party
   cookie policy.

   Third-party cookie blocking policies are often ineffective at
   achieving their privacy goals if servers attempt to work around their
   restrictions to track users.  In particular, two collaborating
   servers can often track users without using cookies at all by
   injecting identifying information into dynamic URLs.

[7.2](#section-7.2).  User Controls

   User agents SHOULD provide users with a mechanism for managing the
   cookies stored in the cookie store.  For example, a user agent might
   let users delete all cookies received during a specified time period

Barth                        Standards Track                   [Page 28]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   or all the cookies related to a particular domain.  In addition, many
   user agents include a user interface element that lets users examine
   the cookies stored in their cookie store.

   User agents SHOULD provide users with a mechanism for disabling
   cookies.  When cookies are disabled, the user agent MUST NOT include
   a Cookie header in outbound HTTP requests and the user agent MUST NOT
   process Set-Cookie headers in inbound HTTP responses.

   Some user agents provide users the option of preventing persistent
   storage of cookies across sessions.  When configured thusly, user
   agents MUST treat all received cookies as if the persistent-flag were
   set to false.  Some popular user agents expose this functionality via
   "private browsing" mode [[Aggarwal2010](#ref-Aggarwal2010)].

   Some user agents provide users with the ability to approve individual
   writes to the cookie store.  In many common usage scenarios, these
   controls generate a large number of prompts.  However, some privacy-
   conscious users find these controls useful nonetheless.

[7.3](#section-7.3).  Expiration Dates

   Although servers can set the expiration date for cookies to the
   distant future, most user agents do not actually retain cookies for
   multiple decades.  Rather than choosing gratuitously long expiration
   periods, servers SHOULD promote user privacy by selecting reasonable
   cookie expiration periods based on the purpose of the cookie.  For
   example, a typical session identifier might reasonably be set to
   expire in two weeks.

[8](#section-8).  Security Considerations

[8.1](#section-8.1).  Overview

   Cookies have a number of security pitfalls.  This section overviews a
   few of the more salient issues.

   In particular, cookies encourage developers to rely on ambient
   authority for authentication, often becoming vulnerable to attacks
   such as cross-site request forgery [[CSRF](#ref-CSRF "\"Robust Defenses for Cross-Site Request Forgery\"")].  Also, when storing
   session identifiers in cookies, developers often create session
   fixation vulnerabilities.

   Transport-layer encryption, such as that employed in HTTPS, is
   insufficient to prevent a network attacker from obtaining or altering
   a victim's cookies because the cookie protocol itself has various
   vulnerabilities (see "Weak Confidentiality" and "Weak Integrity",

Barth                        Standards Track                   [Page 29]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   below).  In addition, by default, cookies do not provide
   confidentiality or integrity from network attackers, even when used
   in conjunction with HTTPS.

[8.2](#section-8.2).  Ambient Authority

   A server that uses cookies to authenticate users can suffer security
   vulnerabilities because some user agents let remote parties issue
   HTTP requests from the user agent (e.g., via HTTP redirects or HTML
   forms).  When issuing those requests, user agents attach cookies even
   if the remote party does not know the contents of the cookies,
   potentially letting the remote party exercise authority at an unwary
   server.

   Although this security concern goes by a number of names (e.g.,
   cross-site request forgery, confused deputy), the issue stems from
   cookies being a form of ambient authority.  Cookies encourage server
   operators to separate designation (in the form of URLs) from
   authorization (in the form of cookies).  Consequently, the user agent
   might supply the authorization for a resource designated by the
   attacker, possibly causing the server or its clients to undertake
   actions designated by the attacker as though they were authorized by
   the user.

   Instead of using cookies for authorization, server operators might
   wish to consider entangling designation and authorization by treating
   URLs as capabilities.  Instead of storing secrets in cookies, this
   approach stores secrets in URLs, requiring the remote entity to
   supply the secret itself.  Although this approach is not a panacea,
   judicious application of these principles can lead to more robust
   security.

[8.3](#section-8.3).  Clear Text

   Unless sent over a secure channel (such as TLS), the information in
   the Cookie and Set-Cookie headers is transmitted in the clear.

   1.  All sensitive information conveyed in these headers is exposed to
       an eavesdropper.

   2.  A malicious intermediary could alter the headers as they travel
       in either direction, with unpredictable results.

   3.  A malicious client could alter the Cookie header before
       transmission, with unpredictable results.

Barth                        Standards Track                   [Page 30]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   Servers SHOULD encrypt and sign the contents of cookies (using
   whatever format the server desires) when transmitting them to the
   user agent (even when sending the cookies over a secure channel).
   However, encrypting and signing cookie contents does not prevent an
   attacker from transplanting a cookie from one user agent to another
   or from replaying the cookie at a later time.

   In addition to encrypting and signing the contents of every cookie,
   servers that require a higher level of security SHOULD use the Cookie
   and Set-Cookie headers only over a secure channel.  When using
   cookies over a secure channel, servers SHOULD set the Secure
   attribute (see [Section 4.1.2.5](#section-4.1.2.5)) for every cookie.  If a server does
   not set the Secure attribute, the protection provided by the secure
   channel will be largely moot.

   For example, consider a webmail server that stores a session
   identifier in a cookie and is typically accessed over HTTPS.  If the
   server does not set the Secure attribute on its cookies, an active
   network attacker can intercept any outbound HTTP request from the
   user agent and redirect that request to the webmail server over HTTP.
   Even if the webmail server is not listening for HTTP connections, the
   user agent will still include cookies in the request.  The active
   network attacker can intercept these cookies, replay them against the
   server, and learn the contents of the user's email.  If, instead, the
   server had set the Secure attribute on its cookies, the user agent
   would not have included the cookies in the clear-text request.

[8.4](#section-8.4).  Session Identifiers

   Instead of storing session information directly in a cookie (where it
   might be exposed to or replayed by an attacker), servers commonly
   store a nonce (or "session identifier") in a cookie.  When the server
   receives an HTTP request with a nonce, the server can look up state
   information associated with the cookie using the nonce as a key.

   Using session identifier cookies limits the damage an attacker can
   cause if the attacker learns the contents of a cookie because the
   nonce is useful only for interacting with the server (unlike non-
   nonce cookie content, which might itself be sensitive).  Furthermore,
   using a single nonce prevents an attacker from "splicing" together
   cookie content from two interactions with the server, which could
   cause the server to behave unexpectedly.

   Using session identifiers is not without risk.  For example, the
   server SHOULD take care to avoid "session fixation" vulnerabilities.
   A session fixation attack proceeds in three steps.  First, the
   attacker transplants a session identifier from his or her user agent
   to the victim's user agent.  Second, the victim uses that session

Barth                        Standards Track                   [Page 31]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   identifier to interact with the server, possibly imbuing the session
   identifier with the user's credentials or confidential information.
   Third, the attacker uses the session identifier to interact with
   server directly, possibly obtaining the user's authority or
   confidential information.

[8.5](#section-8.5).  Weak Confidentiality

   Cookies do not provide isolation by port.  If a cookie is readable by
   a service running on one port, the cookie is also readable by a
   service running on another port of the same server.  If a cookie is
   writable by a service on one port, the cookie is also writable by a
   service running on another port of the same server.  For this reason,
   servers SHOULD NOT both run mutually distrusting services on
   different ports of the same host and use cookies to store security-
   sensitive information.

   Cookies do not provide isolation by scheme.  Although most commonly
   used with the http and https schemes, the cookies for a given host
   might also be available to other schemes, such as ftp and gopher.
   Although this lack of isolation by scheme is most apparent in non-
   HTTP APIs that permit access to cookies (e.g., HTML's document.cookie
   API), the lack of isolation by scheme is actually present in
   requirements for processing cookies themselves (e.g., consider
   retrieving a URI with the gopher scheme via HTTP).

   Cookies do not always provide isolation by path.  Although the
   network-level protocol does not send cookies stored for one path to
   another, some user agents expose cookies via non-HTTP APIs, such as
   HTML's document.cookie API.  Because some of these user agents (e.g.,
   web browsers) do not isolate resources received from different paths,
   a resource retrieved from one path might be able to access cookies
   stored for another path.

[8.6](#section-8.6).  Weak Integrity

   Cookies do not provide integrity guarantees for sibling domains (and
   their subdomains).  For example, consider foo.example.com and
   bar.example.com.  The foo.example.com server can set a cookie with a
   Domain attribute of "example.com" (possibly overwriting an existing
   "example.com" cookie set by bar.example.com), and the user agent will
   include that cookie in HTTP requests to bar.example.com.  In the
   worst case, bar.example.com will be unable to distinguish this cookie
   from a cookie it set itself.  The foo.example.com server might be
   able to leverage this ability to mount an attack against
   bar.example.com.

Barth                        Standards Track                   [Page 32]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   Even though the Set-Cookie header supports the Path attribute, the
   Path attribute does not provide any integrity protection because the
   user agent will accept an arbitrary Path attribute in a Set-Cookie
   header.  For example, an HTTP response to a request for
   http://example.com/foo/bar can set a cookie with a Path attribute of
   "/qux".  Consequently, servers SHOULD NOT both run mutually
   distrusting services on different paths of the same host and use
   cookies to store security-sensitive information.

   An active network attacker can also inject cookies into the Cookie
   header sent to https://example.com/ by impersonating a response from
   http://example.com/ and injecting a Set-Cookie header.  The HTTPS
   server at example.com will be unable to distinguish these cookies
   from cookies that it set itself in an HTTPS response.  An active
   network attacker might be able to leverage this ability to mount an
   attack against example.com even if example.com uses HTTPS
   exclusively.

   Servers can partially mitigate these attacks by encrypting and
   signing the contents of their cookies.  However, using cryptography
   does not mitigate the issue completely because an attacker can replay
   a cookie he or she received from the authentic example.com server in
   the user's session, with unpredictable results.

   Finally, an attacker might be able to force the user agent to delete
   cookies by storing a large number of cookies.  Once the user agent
   reaches its storage limit, the user agent will be forced to evict
   some cookies.  Servers SHOULD NOT rely upon user agents retaining
   cookies.

[8.7](#section-8.7).  Reliance on DNS

   Cookies rely upon the Domain Name System (DNS) for security.  If the
   DNS is partially or fully compromised, the cookie protocol might fail
   to provide the security properties required by applications.

[9](#section-9).  IANA Considerations

   The permanent message header field registry (see [[RFC3864](./rfc3864 "\"Registration Procedures for Message Header Fields\"")]) has been
   updated with the following registrations.

Barth                        Standards Track                   [Page 33]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[9.1](#section-9.1).  Cookie

   Header field name: Cookie

   Applicable protocol: http

   Status: standard

   Author/Change controller: IETF

   Specification document: this specification ([Section 5.4](#section-5.4))

[9.2](#section-9.2).  Set-Cookie

   Header field name: Set-Cookie

   Applicable protocol: http

   Status: standard

   Author/Change controller: IETF

   Specification document: this specification ([Section 5.2](#section-5.2))

[9.3](#section-9.3).  Cookie2

   Header field name: Cookie2

   Applicable protocol: http

   Status: obsoleted

   Author/Change controller: IETF

   Specification document: [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")]

[9.4](#section-9.4).  Set-Cookie2

   Header field name: Set-Cookie2

   Applicable protocol: http

   Status: obsoleted

   Author/Change controller: IETF

   Specification document: [[RFC2965](./rfc2965 "\"HTTP State Management Mechanism\"")]

Barth                        Standards Track                   [Page 34]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[10](#section-10).  References

[10.1](#section-10.1).  Normative References

   [RFC1034]  Mockapetris, P., "Domain names - concepts and facilities",
              STD 13, [RFC 1034](./rfc1034), November 1987.

   [RFC1123]  Braden, R., "Requirements for Internet Hosts - Application
              and Support", STD 3, [RFC 1123](./rfc1123), October 1989.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119), March 1997.

   [RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", [RFC 2616](./rfc2616), June 1999.

   [RFC3490]  Faltstrom, P., Hoffman, P., and A. Costello,
              "Internationalizing Domain Names in Applications (IDNA)",
              [RFC 3490](./rfc3490), March 2003.

              See [Section 6.3](#section-6.3) for an explanation why the normative
              reference to an obsoleted specification is needed.

   [RFC4790]  Newman, C., Duerst, M., and A. Gulbrandsen, "Internet
              Application Protocol Collation Registry", [RFC 4790](./rfc4790),
              March 2007.

   [RFC5234]  Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, [RFC 5234](./rfc5234), January 2008.

   [RFC5890]  Klensin, J., "Internationalized Domain Names for
              Applications (IDNA): Definitions and Document Framework",
              [RFC 5890](./rfc5890), August 2010.

   [USASCII]  American National Standards Institute, "Coded Character
              Set -- 7-bit American Standard Code for Information
              Interchange", ANSI X3.4, 1986.

[10.2](#section-10.2).  Informative References

   [RFC2109]  Kristol, D. and L. Montulli, "HTTP State Management
              Mechanism", [RFC 2109](./rfc2109), February 1997.

   [RFC2965]  Kristol, D. and L. Montulli, "HTTP State Management
              Mechanism", [RFC 2965](./rfc2965), October 2000.

Barth                        Standards Track                   [Page 35]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

   [RFC2818]  Rescorla, E., "HTTP Over TLS", [RFC 2818](./rfc2818), May 2000.

   [Netscape] Netscape Communications Corp., "Persistent Client State --
              HTTP Cookies", 1999, <<http://web.archive.org/web/>
              20020803110822/http://wp.netscape.com/newsref/std/
              cookie_spec.html>.

   [Kri2001]  Kristol, D., "HTTP Cookies: Standards, Privacy, and
              Politics", ACM Transactions on Internet Technology Vol. 1,
              #2, November 2001, <<http://arxiv.org/abs/cs.SE/0105018>>.

   [RFC3629]  Yergeau, F., "UTF-8, a transformation format of ISO
              10646", STD 63, [RFC 3629](./rfc3629), November 2003.

   [RFC4648]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", [RFC 4648](./rfc4648), October 2006.

   [RFC3864]  Klyne, G., Nottingham, M., and J. Mogul, "Registration
              Procedures for Message Header Fields", [BCP 90](https://www.rfc-editor.org/bcp/bcp90), [RFC 3864](./rfc3864),
              September 2004.

   [RFC5895]  Resnick, P. and P. Hoffman, "Mapping Characters for
              Internationalized Domain Names in Applications (IDNA)
              2008", [RFC 5895](./rfc5895), September 2010.

   [UTS46]    Davis, M. and M. Suignard, "Unicode IDNA Compatibility
              Processing", Unicode Technical Standards # 46, 2010,
              <<http://unicode.org/reports/tr46/>>.

   [CSRF]     Barth, A., Jackson, C., and J. Mitchell, "Robust Defenses
              for Cross-Site Request Forgery", 2008,
              <<http://portal.acm.org/citation.cfm?id=1455770.1455782>>.

   [Aggarwal2010]
              Aggarwal, G., Burzstein, E., Jackson, C., and D. Boneh,
              "An Analysis of Private Browsing Modes in Modern
              Browsers", 2010, <[http://www.usenix.org/events/sec10/tech/](http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf)
              [full_papers/Aggarwal.pdf](http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf)>.

Barth                        Standards Track                   [Page 36]
```

---

```

[RFC 6265](./rfc6265)             HTTP State Management Mechanism          April 2011

[Appendix A](#appendix-A).  Acknowledgements

   This document borrows heavily from [RFC 2109](./rfc2109) [[RFC2109](./rfc2109 "\"HTTP State Management Mechanism\"")].  We are
   indebted to David M. Kristol and Lou Montulli for their efforts to
   specify cookies.  David M. Kristol, in particular, provided
   invaluable advice on navigating the IETF process.  We would also like
   to thank Thomas Broyer, Tyler Close, Alissa Cooper, Bil Corry,
   corvid, Lisa Dusseault, Roy T. Fielding, Blake Frantz, Anne van
   Kesteren, Eran Hammer-Lahav, Jeff Hodges, Bjoern Hoehrmann, Achim
   Hoffmann, Georg Koppen, Dean McNamee, Alexey Melnikov, Mark Miller,
   Mark Pauley, Yngve N. Pettersen, Julian Reschke, Peter Saint-Andre,
   Mark Seaborn, Maciej Stachowiak, Daniel Stenberg, Tatsuhiro
   Tsujikawa, David Wagner, Dan Winship, and Dan Witte for their
   valuable feedback on this document.

Author's Address

   Adam Barth
   University of California, Berkeley

   EMail: abarth@eecs.berkeley.edu
   URI:   <http://www.adambarth.com/>

Barth                        Standards Track                   [Page 37]

```


=== Content from github.com_1ecbbdab_20250114_200535.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fsecurity%2Fadvisories%2FGHSA-p26g-97m4-6q7c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fsecurity%2Fadvisories%2FGHSA-p26g-97m4-6q7c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=jetty%2Fjetty.project)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jetty](/jetty)
/
**[jetty.project](/jetty/jetty.project)**
Public

* [Notifications](/login?return_to=%2Fjetty%2Fjetty.project) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fjetty%2Fjetty.project)
* [Star
   3.9k](/login?return_to=%2Fjetty%2Fjetty.project)

* [Code](/jetty/jetty.project)
* [Issues
  341](/jetty/jetty.project/issues)
* [Pull requests
  36](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects
  7](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

Additional navigation options

* [Code](/jetty/jetty.project)
* [Issues](/jetty/jetty.project/issues)
* [Pull requests](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

# Cookie parsing of quoted values can exfiltrate values from other cookies

Low

[jmcc0nn3ll](/jmcc0nn3ll)
published
GHSA-p26g-97m4-6q7c
Apr 18, 2023

## Package

maven

jetty-server
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<=9.4.50, <=10.013, <=11.0.13, <=12.0.0.alpha3

## Patched versions

9.4.51, 10.0.14, 11.0.14, 12.0.0.beta0

## Description

Nonstandard cookie parsing in Jetty may allow an attacker to smuggle cookies within other cookies, or otherwise perform unintended behavior by tampering with the cookie parsing mechanism.

If Jetty sees a cookie VALUE that starts with `"` (double quote), it will continue to read the cookie string until it sees a closing quote -- even if a semicolon is encountered.

So, a cookie header such as:

`DISPLAY_LANGUAGE="b; JSESSIONID=1337; c=d"` will be parsed as one cookie, with the name `DISPLAY_LANGUAGE` and a value of `b; JSESSIONID=1337; c=d`

instead of 3 separate cookies.

### Impact

This has security implications because if, say, `JSESSIONID` is an `HttpOnly` cookie, and the `DISPLAY_LANGUAGE` cookie value is rendered on the page, an attacker can smuggle the `JSESSIONID` cookie into the `DISPLAY_LANGUAGE` cookie and thereby exfiltrate it. This is significant when an intermediary is enacting some policy based on cookies, so a smuggled cookie can bypass that policy yet still be seen by the Jetty server.

### Patches

* 9.4.51.v20230217 - via PR [#9352](https://github.com/jetty/jetty.project/pull/9352)
* 10.0.15 - via PR [#9339](https://github.com/jetty/jetty.project/pull/9339)
* 11.0.15 - via PR [#9339](https://github.com/jetty/jetty.project/pull/9339)

### Workarounds

No workarounds

### References

* <https://www.rfc-editor.org/rfc/rfc2965>
* <https://www.rfc-editor.org/rfc/rfc6265>

### Severity

Low

3.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N

### CVE ID

CVE-2023-26049

### Weaknesses

[CWE-1286](/advisories?query=cwe%3A1286)

### Credits

* [![@arxenix](https://avatars.githubusercontent.com/u/1356005?s=40&v=4)](/arxenix)
  [arxenix](/arxenix)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_ad0e2833_20250114_200537.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [April 2023 Eclipse Jetty Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20230526-0001)

## April 2023 Eclipse Jetty Vulnerabilities in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230526-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230526-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230526-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230526-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230526-0001
**Version:**
6.0

**Last updated:**
07/19/2024

**Status:**
Interim.

**CVEs:** CVE-2023-26049, CVE-2023-26048

Overview
#### Summary

Multiple NetApp products incorporate Eclipse Jetty. Eclipse Jetty versions through 9.4.50, through 10.0.13, through 11.0.13, and through 12.0.0.alpha3 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-26048](https://nvd.nist.gov/vuln/detail/CVE-2023-26048) | 5.3 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L |
| [CVE-2023-26049](https://nvd.nist.gov/vuln/detail/CVE-2023-26049) | 5.3 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/eclipse/jetty.project/security/advisories/GHSA-qw69-rqj8-6qw8>
* <https://github.com/eclipse/jetty.project/security/advisories/GHSA-p26g-97m4-6q7c>

Affected Products
#### Affected Products

* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **E-Series SANtricity OS Controller Software 11.x** | <https://mysupport.netapp.com/site/products/all/details/eseries-santricityos/downloads-tab/download/62735/11.80GA> |
| **E-Series SANtricity Unified Manager and Web Services Proxy** | <https://mysupport.netapp.com/site/products/all/details/eseries-webservices/downloads-tab/download/62313/6.10> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230526-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230526 | Initial Public Release |
| 2.0 | 20230531 | Management Services for Element Software and NetApp HCI and SnapCenter Plug-in for VMware vSphere moved to Products Not Affected |
| 3.0 | 20230606 | Element Plug-in for vCenter Server moved to Products Not Affected |
| 4.0 | 20240621 | E-Series SANtricity OS Controller Software 11.x added to Software Versions and Fixes |
| 5.0 | 20240711 | E-Series SANtricity Unified Manager and Web Services Proxy added to Software Versions and Fixes |
| 6.0 | 20240719 | Corrected E-Series SANtricity OS Controller Software 11.x fix link |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.debian.org_7b6708c8_20250114_200537.html ===


---

[[Date Prev](msg00199.html)][[Date Next](msg00201.html)]
[[Thread Prev](msg00199.html)][[Thread Next](msg00201.html)]
[[Date Index](maillist.html#00200)]
[[Thread Index](threads.html#00200)]

# [SECURITY] [DSA 5507-1] jetty9 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5507-1] jetty9 security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Thu, 28 Sep 2023 22:37:26 +0000
* *Message-id*: <ZRYAJmhA/WFx3k7k@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5507-1                   security@debian.org
<https://www.debian.org/security/>                          Markus Koschany
September 28, 2023                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : jetty9
CVE ID         : CVE-2023-26048 CVE-2023-26049 CVE-2023-36479 CVE-2023-40167
                 CVE-2023-41900

Multiple security vulnerabilities were found in Jetty, a Java based web server
and servlet engine.

The org.eclipse.jetty.servlets.CGI class has been deprecated. It is potentially
unsafe to use it. The upstream developers of Jetty recommend to use Fast CGI
instead. See also CVE-2023-36479.

CVE-2023-26048

    In affected versions servlets with multipart support (e.g. annotated with
    `@MultipartConfig`) that call `HttpServletRequest.getParameter()` or
    `HttpServletRequest.getParts()` may cause `OutOfMemoryError` when the
    client sends a multipart request with a part that has a name but no
    filename and very large content. This happens even with the default
    settings of `fileSizeThreshold=0` which should stream the whole part
    content to disk.

CVE-2023-26049

    Nonstandard cookie parsing in Jetty may allow an attacker to smuggle
    cookies within other cookies, or otherwise perform unintended behavior by
    tampering with the cookie parsing mechanism.

CVE-2023-40167

    Prior to this version Jetty accepted the `+` character proceeding the
    content-length value in a HTTP/1 header field. This is more permissive than
    allowed by the RFC and other servers routinely reject such requests with
    400 responses. There is no known exploit scenario, but it is conceivable
    that request smuggling could result if jetty is used in combination with a
    server that does not close the connection after sending such a 400
    response.

CVE-2023-36479

    Users of the CgiServlet with a very specific command structure may have the
    wrong command executed. If a user sends a request to a
    org.eclipse.jetty.servlets.CGI Servlet for a binary with a space in its
    name, the servlet will escape the command by wrapping it in quotation
    marks. This wrapped command, plus an optional command prefix, will then be
    executed through a call to Runtime.exec. If the original binary name
    provided by the user contains a quotation mark followed by a space, the
    resulting command line will contain multiple tokens instead of one.

CVE-2023-41900

    Jetty is vulnerable to weak authentication. If a Jetty
    `OpenIdAuthenticator` uses the optional nested `LoginService`, and that
    `LoginService` decides to revoke an already authenticated user, then the
    current request will still treat the user as authenticated. The
    authentication is then cleared from the session and subsequent requests
    will not be treated as authenticated. So a request on a previously
    authenticated session could be allowed to bypass authentication after it
    had been rejected by the `LoginService`. This impacts usages of the
    jetty-openid which have configured a nested `LoginService` and where that
    `LoginService` is capable of rejecting previously authenticated users.

For the oldstable distribution (bullseye), these problems have been fixed
in version 9.4.39-3+deb11u2.

For the stable distribution (bookworm), these problems have been fixed in
version 9.4.50-4+deb12u1.

We recommend that you upgrade your jetty9 packages.

For the detailed security status of jetty9 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/jetty9>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAmUV6x5fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeTJGw//a9ZVCC9qHUG/KfAkJJs27UGuL4T1hRM5Azu+8jFxMHwuqKf62FCWlGUE
xM9fwQdUDvfkSBsrGlp+nAwqegOh+YBvAxh6DBdMpEYhZ+wUDLwZaPdR5iTj7q2e
JpjKs1hp7QRDfguL6+T/sJmMx9zk7soDwqd3QEjBXBhuYhlVfq7Wm4v5STKj28pD
Yjv6YmLKIHTv9/HaUWNDCFUjyRGZjmAvYVAIF3gNo9Qn2agq4z3+1Z2EPX4+qbVq
pp+JKr/vVSVHltaR1D0JyC5zjrHOo+dRFWYwG7K/V7kijyIbciNACTe/W2v6hM6F
w+0+8C7TMbof22nOHVcgBygukIvxdvnG6BQUUQaVeE36wi8cvBSVgTe0NJb0NIQt
Gr37tlG+9kJy9d02I+hgX8U90aWmaofTJsn3YbAL6wv2r7Klm6LJN6p8oAmqfEM6
IOOii4JpHaRDz1VQsjskhjw7Q1UigVX6lmx6BfPHzG2BFSe8v5vG+6OvH4oF+Egy
VTF3U/lvXcdqaZyNnCKn4NWLJZHVYE4ncgdDp8qomJXnDoMy6V9+DEDADiu9C2ox
4YvtBHVIZ1uYBRRDjutJw0dkKa7QotSlkmVnAV+oqHa1/Dp2Cytjb+rRhp83QLEw
kfBWYLpFIq9ARI08AyK4hzX27FFf3ojHp++Lau8ODwb/4s9bKE0=
=j7dG
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_a1ee96dc_20250114_200535.html ===


---

[[Date Prev](msg00038.html)][[Date Next](msg00040.html)]
[[Thread Prev](msg00038.html)][[Thread Next](msg00040.html)]
[[Date Index](maillist.html#00039)]
[[Thread Index](threads.html#00039)]

# [SECURITY] [DLA 3592-1] jetty9 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3592-1] jetty9 security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Sat, 30 Sep 2023 14:35:53 +0200
* *Message-id*: <[[🔎]](/msgid-search/1f06d12d2770754425e2913de7fd3322fbec011a.camel%40debian.org) [1f06d12d2770754425e2913de7fd3322fbec011a.camel@debian.org](msg00039.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3592-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
September 30, 2023                            <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : jetty9
Version        : 9.4.16-0+deb10u3
CVE ID         : CVE-2023-26048 CVE-2023-26049 CVE-2023-36479 CVE-2023-40167

Multiple security vulnerabilities were found in Jetty, a Java based web server
and servlet engine.

The org.eclipse.jetty.servlets.CGI class has been deprecated. It is potentially
unsafe to use it. The upstream developers of Jetty recommend to use Fast CGI
instead. See also CVE-2023-36479.

CVE-2023-26048

    In affected versions servlets with multipart support (e.g. annotated with
    `@MultipartConfig`) that call `HttpServletRequest.getParameter()` or
    `HttpServletRequest.getParts()` may cause `OutOfMemoryError` when the
    client sends a multipart request with a part that has a name but no
    filename and very large content. This happens even with the default
    settings of `fileSizeThreshold=0` which should stream the whole part
    content to disk.

CVE-2023-26049

    Nonstandard cookie parsing in Jetty may allow an attacker to smuggle
    cookies within other cookies, or otherwise perform unintended behavior by
    tampering with the cookie parsing mechanism.

CVE-2023-40167

    Prior to this version Jetty accepted the `+` character proceeding the
    content-length value in a HTTP/1 header field. This is more permissive than
    allowed by the RFC and other servers routinely reject such requests with
    400 responses. There is no known exploit scenario, but it is conceivable
    that request smuggling could result if jetty is used in combination with a
    server that does not close the connection after sending such a 400
    response.

CVE-2023-36479

    Users of the CgiServlet with a very specific command structure may have the
    wrong command executed. If a user sends a request to a
    org.eclipse.jetty.servlets.CGI Servlet for a binary with a space in its
    name, the servlet will escape the command by wrapping it in quotation
    marks. This wrapped command, plus an optional command prefix, will then be
    executed through a call to Runtime.exec. If the original binary name
    provided by the user contains a quotation mark followed by a space, the
    resulting command line will contain multiple tokens instead of one.

For Debian 10 buster, these problems have been fixed in version
9.4.16-0+deb10u3.

We recommend that you upgrade your jetty9 packages.

For the detailed security status of jetty9 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/jetty9>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgptgsP1PDF3g.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from github.com_55bc41d8_20250114_200531.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9339)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9339)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=jetty%2Fjetty.project)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jetty](/jetty)
/
**[jetty.project](/jetty/jetty.project)**
Public

* [Notifications](/login?return_to=%2Fjetty%2Fjetty.project) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fjetty%2Fjetty.project)
* [Star
   3.9k](/login?return_to=%2Fjetty%2Fjetty.project)

* [Code](/jetty/jetty.project)
* [Issues
  341](/jetty/jetty.project/issues)
* [Pull requests
  36](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects
  7](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

Additional navigation options

* [Code](/jetty/jetty.project)
* [Issues](/jetty/jetty.project/issues)
* [Pull requests](/jetty/jetty.project/pulls)
* [Actions](/jetty/jetty.project/actions)
* [Projects](/jetty/jetty.project/projects)
* [Security](/jetty/jetty.project/security)
* [Insights](/jetty/jetty.project/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjetty%2Fjetty.project%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjetty%2Fjetty.project%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Review Cookie Cutter #9339

 Merged

[gregw](/gregw)
merged 13 commits into
[jetty-10.0.x](/jetty/jetty.project/tree/jetty-10.0.x "jetty/jetty.project:jetty-10.0.x")
from
[fix/jetty-10-9334-review-cookie-cutter](/jetty/jetty.project/tree/fix/jetty-10-9334-review-cookie-cutter "jetty/jetty.project:fix/jetty-10-9334-review-cookie-cutter")

Feb 14, 2023

 Merged

# [Review Cookie Cutter](#top) #9339

[gregw](/gregw)
merged 13 commits into
[jetty-10.0.x](/jetty/jetty.project/tree/jetty-10.0.x "jetty/jetty.project:jetty-10.0.x")
from
[fix/jetty-10-9334-review-cookie-cutter](/jetty/jetty.project/tree/fix/jetty-10-9334-review-cookie-cutter "jetty/jetty.project:fix/jetty-10-9334-review-cookie-cutter")

Feb 14, 2023

[Conversation
2](/jetty/jetty.project/pull/9339)
[Commits
13](/jetty/jetty.project/pull/9339/commits)
[Checks
0](/jetty/jetty.project/pull/9339/checks)
[Files changed](/jetty/jetty.project/pull/9339/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sbordet](https://avatars.githubusercontent.com/u/414681?s=60&v=4)](/sbordet)

Copy link

Contributor

### @sbordet **[sbordet](/sbordet)** commented [Feb 9, 2023](#issue-1578576611)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [sbordet](/sbordet)
added 2 commits
[February 9, 2023 17:13](#commits-pushed-b932667)

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)

`[Initial work on reviewing CookieCutter.](/jetty/jetty.project/pull/9339/commits/b932667468347877aa04b9d7f6648549076d6616 "Initial work on reviewing CookieCutter.

Signed-off-by: Simone Bordet <simone.bordet@gmail.com>")`
 …

`[b932667](/jetty/jetty.project/pull/9339/commits/b932667468347877aa04b9d7f6648549076d6616)`

```
Signed-off-by: Simone Bordet <simone.bordet@gmail.com>
```

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)

`[More work on reviewing CookieCutter.](/jetty/jetty.project/pull/9339/commits/fcbf33eefe98a96484537bbd418d8f9b003b20f7 "More work on reviewing CookieCutter.
Trying to get a good code coverage.

Signed-off-by: Simone Bordet <simone.bordet@gmail.com>")`
 …

`[fcbf33e](/jetty/jetty.project/pull/9339/commits/fcbf33eefe98a96484537bbd418d8f9b003b20f7)`

```
Trying to get a good code coverage.

Signed-off-by: Simone Bordet <simone.bordet@gmail.com>
```

 [![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)
[sbordet](/sbordet)
requested a review
from [gregw](/gregw)
[February 9, 2023 20:38](#event-8483551707)

 [![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)
[sbordet](/sbordet)
marked this pull request as draft
[February 9, 2023 20:38](#event-8483553382)

 [sbordet](/sbordet)
and others
added 5 commits
[February 9, 2023 22:06](#commits-pushed-202e710)

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)

`[Allowing empty cookie value.](/jetty/jetty.project/pull/9339/commits/202e710c31ac63338bb8d97723bb7099923ac16f "Allowing empty cookie value.

Signed-off-by: Simone Bordet <simone.bordet@gmail.com>")`
 …

`[202e710](/jetty/jetty.project/pull/9339/commits/202e710c31ac63338bb8d97723bb7099923ac16f)`

```
Signed-off-by: Simone Bordet <simone.bordet@gmail.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[New CookieCutter](/jetty/jetty.project/pull/9339/commits/6546f37f496cfdd0585148380f6cec3ada96e107 "New CookieCutter

ignorable whitespace

Signed-off-by: Greg Wilkins <gregw@webtide.com>")`
 …

`[6546f37](/jetty/jetty.project/pull/9339/commits/6546f37f496cfdd0585148380f6cec3ada96e107)`

```
ignorable whitespace

Signed-off-by: Greg Wilkins <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/b94ee4096cbadb920272a57cdc1a74b09369a1b2 "Introduced CookieParser interface

Select between CookieCutter and RFC6265CookieParser in factory method.

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[b94ee40](/jetty/jetty.project/pull/9339/commits/b94ee4096cbadb920272a57cdc1a74b09369a1b2)`

```
Select between CookieCutter and RFC6265CookieParser in factory method.

Signed-off-by: gregw <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/bbc409f42a7faf19ccd0b45216bdbee0bcc8c74a "Introduced CookieParser interface

Select between CookieCutter and RFC6265CookieParser in factory method.

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[bbc409f](/jetty/jetty.project/pull/9339/commits/bbc409f42a7faf19ccd0b45216bdbee0bcc8c74a)`

```
Select between CookieCutter and RFC6265CookieParser in factory method.

Signed-off-by: gregw <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/c529321b638e344bfbb68195fc4de19c6e3d5d7e "Introduced CookieParser interface

Select between CookieCutter and RFC6265CookieParser in factory method.
Improved legacy modes

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[c529321](/jetty/jetty.project/pull/9339/commits/c529321b638e344bfbb68195fc4de19c6e3d5d7e)`

```
Select between CookieCutter and RFC6265CookieParser in factory method.
Improved legacy modes

Signed-off-by: gregw <gregw@webtide.com>
```

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
requested a review
from [lorban](/lorban)
[February 12, 2023 05:13](#event-8497760604)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/f5a9b1ebef2d247e2196ce33f99578ddbcd315bb "Introduced CookieParser interface

javadoc

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[f5a9b1e](/jetty/jetty.project/pull/9339/commits/f5a9b1ebef2d247e2196ce33f99578ddbcd315bb)`

```
javadoc

Signed-off-by: gregw <gregw@webtide.com>
```

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
marked this pull request as ready for review
[February 12, 2023 21:51](#event-8499070476)

 [gregw](/gregw)
added 2 commits
[February 13, 2023 09:07](#commits-pushed-5a81444)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/5a81444c1b1fed2acaed98f7256847cc7b6dbbcb "Introduced CookieParser interface

Improve violation naming and javadoc

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[5a81444](/jetty/jetty.project/pull/9339/commits/5a81444c1b1fed2acaed98f7256847cc7b6dbbcb)`

```
Improve violation naming and javadoc

Signed-off-by: gregw <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/61d8c16b756cee32ca4bbbae1fc78b5000ac64a2 "Introduced CookieParser interface

Updates and renames from review

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[61d8c16](/jetty/jetty.project/pull/9339/commits/61d8c16b756cee32ca4bbbae1fc78b5000ac64a2)`

```
Updates and renames from review

Signed-off-by: gregw <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=80&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)

Copy link

Contributor

### **[gregw](/gregw)** commented [Feb 13, 2023](#issuecomment-1427781111)

| [@sbordet](https://github.com/sbordet) [@lorban](https://github.com/lorban) updated as per our hangout. [@sbordet](https://github.com/sbordet) you can't review as it is your PR originally.... but comment and I'll get the idea. |
| --- |

All reactions

Sorry, something went wrong.

 [gregw](/gregw)
and others
added 3 commits
[February 14, 2023 10:06](#commits-pushed-d9f597b)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/d9f597b73f332c9fba01c81a15a34daa18b9442a "Introduced CookieParser interface

Support new compliance violations in old CookieCutter parser

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[d9f597b](/jetty/jetty.project/pull/9339/commits/d9f597b73f332c9fba01c81a15a34daa18b9442a)`

```
Support new compliance violations in old CookieCutter parser

Signed-off-by: gregw <gregw@webtide.com>
```

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw)

`[Introduced CookieParser interface](/jetty/jetty.project/pull/9339/commits/91339532a8f17e3d0d1134c0f839c06fd3ff1002 "Introduced CookieParser interface

Exclude deprecated violations from non LEGACY modes.

Signed-off-by: gregw <gregw@webtide.com>")`
 …

`[9133953](/jetty/jetty.project/pull/9339/commits/91339532a8f17e3d0d1134c0f839c06fd3ff1002)`

```
Exclude deprecated violations from non LEGACY modes.

Signed-off-by: gregw <gregw@webtide.com>
```

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=40&v=4)](/sbordet)

`[Improved javadocs and other minor code cleanups.](/jetty/jetty.project/pull/9339/commits/7071cef51d6bd1441ba879db89edd00e8586c9a5 "Improved javadocs and other minor code cleanups.

Signed-off-by: Simone Bordet <simone.bordet@gmail.com>")`
 …

`[7071cef](/jetty/jetty.project/pull/9339/commits/7071cef51d6bd1441ba879db89edd00e8586c9a5)`

```
Signed-off-by: Simone Bordet <simone.bordet@gmail.com>
```

[![sbordet](https://avatars.githubusercontent.com/u/414681?s=60&v=4)](/sbordet)

**[sbordet](/sbordet)**
commented
[Feb 14, 2023](#pullrequestreview-1298035030)

 [View reviewed changes](/jetty/jetty.project/pull/9339/files/7071cef51d6bd1441ba879db89edd00e8586c9a5)

Copy link

Contributor

Author

### @sbordet **[sbordet](/sbordet)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM.

Sorry, something went wrong.

All reactions

[![gregw](https://avatars.githubusercontent.com/u/70829?s=60&v=4)](/gregw)

**[gregw](/gregw)**
approved these changes
[Feb 14, 2023](#pullrequestreview-1298436276)

 [View reviewed changes](/jetty/jetty.project/pull/9339/files/7071cef51d6bd1441ba879db89edd00e8586c9a5)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
merged commit [`7b8c2c1`](/jetty/jetty.project/commit/7b8c2c1bf081c7f408e5da3371c8c3c9802f09fd)
into
jetty-10.0.x

[Feb 14, 2023](https://github.com/jetty/jetty.project/pull/9339#event-8520020625)

 [![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
deleted the
fix/jetty-10-9334-review-cookie-cutter

branch
[February 14, 2023 21:38](#event-8520021535)

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&u=6ff207312b2400f9d7132455a67c860b9ef2284b&v=4)](/gregw)
[gregw](/gregw)
linked an issue
[Feb 15, 2023](#event-8521024503)
that may be
closed
by this pull request

[Better support for Cookie RFC 2965 compliance
#9334](/jetty/jetty.project/issues/9334)

Closed

[gregpoulos](/gregpoulos)
pushed a commit
to gregpoulos/jetty.project
that referenced
this pull request
[Feb 15, 2023](#ref-commit-7505193)

`[Merge remote-tracking branch 'origin/jetty-12.0.x' into jetty-12.0.x-…](/gregpoulos/jetty.project/commit/7505193cf4ab58efb1da26f7aca939ec27f13391 "Merge remote-tracking branch 'origin/jetty-12.0.x' into jetty-12.0.x-old-docs-remove-logging-sections

* origin/jetty-12.0.x:
  Fixed FormAuthenticator redirection
  Happy no year
  Restore range test for ee10 DefaultServletTest.
  Restore non cross-context async session tests
  Jetty 12 - Restore ee10 tests (#9214)
  fixed commented out test in CookieCutterTest
  Fix/jetty 10 9334 review cookie cutter (#9339)
  remove section on remote debugging, as the information has already been incorporated into the operations and programming guides
  remove sections on debugging with IntelliJ and Eclipse
  remove Ant Jetty plugin section from the ToC
  Remove docs for the ant plugin
  Update SECURITY.md (#9333)")`
…

`[7505193](/gregpoulos/jetty.project/commit/7505193cf4ab58efb1da26f7aca939ec27f13391)`

```
…old-docs-remove-logging-sections

* origin/jetty-12.0.x:
  Fixed FormAuthenticator redirection
  Happy no year
  Restore range test for ee10 DefaultServletTest.
  Restore non cross-context async session tests
  Jetty 12 - Restore ee10 tests ([jetty#9214](https://github.com/jetty/jetty.project/pull/9214))
  fixed commented out test in CookieCutterTest
  Fix/jetty 10 9334 review cookie cutter ([jetty#9339](https://github.com/jetty/jetty.project/pull/9339))
  remove section on remote debugging, as the information has already been incorporated into the operations and programming guides
  remove sections on debugging with IntelliJ and Eclipse
  remove Ant Jetty plugin section from the ToC
  Remove docs for the ant plugin
  Update SECURITY.md ([jetty#9333](https://github.com/jetty/jetty.project/pull/9333))
```

[![@joakime](https://avatars.githubusercontent.com/u/191721?s=40&u=2979b26c4cd7f08202949495301b8bcf66dc721b&v=4)](/joakime)
[joakime](/joakime)
changed the title
~~Fix/jetty 10 9334 review cookie cutter~~
Review Cookie Cutter
[Feb 27, 2023](#event-8618365108)

This was referenced Apr 26, 2023

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-server-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#527](/CxDemoInABoxRepos/Java-Webgoat/issues/527)

Open

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-http-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#531](/CxDemoInABoxRepos/Java-Webgoat/issues/531)

Open

This was referenced Jul 10, 2023

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-server-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#827](/CxDemoInABoxRepos/Java-Webgoat/issues/827)

Open

[CVE-2023-26049 @ Maven-org.eclipse.jetty:jetty-http-9.4.36.v20210114
CxDemoInABoxRepos/Java-Webgoat#831](/CxDemoInABoxRepos/Java-Webgoat/issues/831)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjetty%2Fjetty.project%2Fpull%2F9339)

Reviewers

[![@gregw](https://avatars.githubusercontent.com/u/70829?s=40&v=4)](/gregw) [gregw](/gregw)

gregw approved these changes

[![@lorban](https://avatars.githubusercontent.com/u/622925?s=40&v=4)](/lorban) [lorban](/lorban)

 Awaiting requested review from lorban

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Better support for Cookie RFC 2965 compliance](https://github.com/jetty/jetty.project/issues/9334)

2 participants

[![@sbordet](https://avatars.githubusercontent.com/u/414681?s=52&v=4)](/sbordet) [![@gregw](https://avatars.githubusercontent.com/u/70829?s=52&v=4)](/gregw)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


