=== Content from github.com_23aefaa3_20250114_214028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Freleases%2Ftag%2Fv0.1.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Freleases%2Ftag%2Fv0.1.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=teler-sh%2Fteler-waf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[teler-sh](/teler-sh)
/
**[teler-waf](/teler-sh/teler-waf)**
Public

* [Notifications](/login?return_to=%2Fteler-sh%2Fteler-waf) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Fteler-sh%2Fteler-waf)
* [Star
   363](/login?return_to=%2Fteler-sh%2Fteler-waf)

* [Code](/teler-sh/teler-waf/tree/v0.1.1)
* [Issues
  4](/teler-sh/teler-waf/issues)
* [Pull requests
  9](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

Additional navigation options

* [Code](/teler-sh/teler-waf/tree/v0.1.1)
* [Issues](/teler-sh/teler-waf/issues)
* [Pull requests](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

1. [Releases](/teler-sh/teler-waf/releases)
2. [v0.1.1](/teler-sh/teler-waf/releases/tag/v0.1.1)

# v0.1.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/teler-sh/teler-waf/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.1.1)

 Loading

[View all tags](/teler-sh/teler-waf/tags)

![@dwisiswant0](https://avatars.githubusercontent.com/u/25837540?s=40&v=4)
[dwisiswant0](/dwisiswant0)
released this
11 Jan 03:23

·
[303 commits](/teler-sh/teler-waf/compare/v0.1.1...master)
to master
since this release

[v0.1.1](/teler-sh/teler-waf/tree/v0.1.1)

[`d1d49cf`](/teler-sh/teler-waf/commit/d1d49cfddfa3ec2adad962870f14b85cd1aaf739)

This commit was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/25837540?s=64&v=4)](/dwisiswant0)
[dwisiswant0](/dwisiswant0)
Dwi Siswanto

GPG key ID: D192CC08161630BD

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Changelog

* [d1d49cf](https://github.com/teler-sh/teler-waf/commit/d1d49cfddfa3ec2adad962870f14b85cd1aaf739): Any HTML entities should be unescaped.

**Full Changelog**: [v0.1.0...v0.1.1](https://github.com/teler-sh/teler-waf/compare/v0.1.0...v0.1.1)

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_13ac5b57_20250114_214031.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Fsecurity%2Fadvisories%2FGHSA-9f95-hhg4-pg4f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Fsecurity%2Fadvisories%2FGHSA-9f95-hhg4-pg4f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=teler-sh%2Fteler-waf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[teler-sh](/teler-sh)
/
**[teler-waf](/teler-sh/teler-waf)**
Public

* [Notifications](/login?return_to=%2Fteler-sh%2Fteler-waf) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Fteler-sh%2Fteler-waf)
* [Star
   363](/login?return_to=%2Fteler-sh%2Fteler-waf)

* [Code](/teler-sh/teler-waf)
* [Issues
  4](/teler-sh/teler-waf/issues)
* [Pull requests
  9](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

Additional navigation options

* [Code](/teler-sh/teler-waf)
* [Issues](/teler-sh/teler-waf/issues)
* [Pull requests](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

# Bypass Common Web Attack Threat Rule with HTML Entities Payload

Moderate

[dwisiswant0](/dwisiswant0)
published
GHSA-9f95-hhg4-pg4f
Mar 1, 2023

## Package

gomod

github.com/kitabisa/teler-waf
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<v0.1.1

## Patched versions

v0.1.1

## Description

### Description

teler-waf is a Go HTTP middleware that provides teler IDS functionality to protect against web-based attacks. In teler-waf prior to version v0.1.1 is vulnerable to bypassing common web attack rules when a specific HTML entities payload is used. This vulnerability allows an attacker to execute arbitrary JavaScript code on the victim's browser and compromise the security of the web application. The vulnerability exists due to teler-waf failure to properly sanitize and filter HTML entities in user input.

### Impact

An attacker can exploit this vulnerability to bypass common web attack threat rules in teler-waf and launch cross-site scripting (XSS) attacks. The attacker can execute arbitrary JavaScript code on the victim's browser and steal sensitive information, such as login credentials and session tokens, or take control of the victim's browser and perform malicious actions.

### Patches

Version [v0.1.1](https://github.com/kitabisa/teler-waf/releases/tag/v0.1.1) includes a patch for this vulnerability.

### Workarounds

We advised updating their installations to version `v0.1.1` and frontwards immediately.

### Credits

This vulnerability was reported by Aidil Arief ([@aidilarf](https://github.com/aidilarf)), a security researcher who discovered and reported the vulnerability to teler-waf developers. Their efforts have contributed to the improvement of teler-waf development.

### References

* [v0.1.0...v0.1.1](https://github.com/teler-sh/teler-waf/compare/v0.1.0...v0.1.1)

### Severity

Moderate

### CVE ID

CVE-2023-26046

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_03f9edef_20250114_214026.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Fcommit%2Fd1d49cfddfa3ec2adad962870f14b85cd1aaf739)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Fcommit%2Fd1d49cfddfa3ec2adad962870f14b85cd1aaf739)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=teler-sh%2Fteler-waf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[teler-sh](/teler-sh)
/
**[teler-waf](/teler-sh/teler-waf)**
Public

* [Notifications](/login?return_to=%2Fteler-sh%2Fteler-waf) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Fteler-sh%2Fteler-waf)
* [Star
   363](/login?return_to=%2Fteler-sh%2Fteler-waf)

* [Code](/teler-sh/teler-waf)
* [Issues
  4](/teler-sh/teler-waf/issues)
* [Pull requests
  9](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

Additional navigation options

* [Code](/teler-sh/teler-waf)
* [Issues](/teler-sh/teler-waf/issues)
* [Pull requests](/teler-sh/teler-waf/pulls)
* [Discussions](/teler-sh/teler-waf/discussions)
* [Actions](/teler-sh/teler-waf/actions)
* [Security](/teler-sh/teler-waf/security)
* [Insights](/teler-sh/teler-waf/pulse)

## Commit

[Permalink](/teler-sh/teler-waf/commit/d1d49cfddfa3ec2adad962870f14b85cd1aaf739)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

feat: unescape any HTML entities

[Browse files](/teler-sh/teler-waf/tree/d1d49cfddfa3ec2adad962870f14b85cd1aaf739)
Browse the repository at this point in the history

```
Any HTML entities of URL-decoded characters should be unescape before
perform the checks.

$ curl localhost:3000 -so /dev/null -w "%{http_code}\n" -A X -d "body=%22autofocus%20onFocUs=%27%26%2397%3blert()%27"
403
```

* Loading branch information

[![@dwisiswant0](https://avatars.githubusercontent.com/u/25837540?s=40&v=4)](/dwisiswant0)

[dwisiswant0](/teler-sh/teler-waf/commits?author=dwisiswant0 "View all commits by dwisiswant0")
committed
Jan 11, 2023

1 parent
[e036517](/teler-sh/teler-waf/commit/e036517d0598a126d074fd835e268971c98ed7e0)

commit d1d49cf

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**38 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* analyze.go
  [analyze.go](#diff-0066446cff253dced86e182cf4284779ad59a84820338db70f5d8cab30c8b9d4)
* utils.go
  [utils.go](#diff-8b7f25bac2ae04c2ce2abb628c6aa28103fd113103a62f3e9d232fa995684915)

## There are no files selected for viewing

30 changes: 15 additions & 15 deletions

30
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/teler-sh/teler-waf/blob/d1d49cfddfa3ec2adad962870f14b85cd1aaf739/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -194,22 +194,22 @@ goos: linux |
|  |  | goarch: amd64 |
|  |  | pkg: github.com/kitabisa/teler-waf |
|  |  | cpu: 11th Gen Intel(R) Core(TM) i9-11900H @ 2.50GHz |
|  |  | BenchmarkTelerDefaultOptions-4 4530 265197 ns/op 35710 B/op 1690 allocs/op |
|  |  | BenchmarkTelerCommonWebAttackOnly-4 32484 35325 ns/op 5949 B/op 118 allocs/op |
|  |  | BenchmarkTelerCVEOnly-4 6248 187397 ns/op 33402 B/op 1647 allocs/op |
|  |  | BenchmarkTelerBadIPAddressOnly-4 20649 54890 ns/op 5974 B/op 86 allocs/op |
|  |  | BenchmarkTelerBadReferrerOnly-4 48594 22629 ns/op 5548 B/op 87 allocs/op |
|  |  | BenchmarkTelerBadCrawlerOnly-4 41832 26891 ns/op 5634 B/op 85 allocs/op |
|  |  | BenchmarkTelerDirectoryBruteforceOnly-4 48087 22008 ns/op 5554 B/op 84 allocs/op |
|  |  | BenchmarkTelerCustomRule-4 50428 21523 ns/op 5323 B/op 84 allocs/op |
|  |  | BenchmarkTelerWithoutCommonWebAttack-4 5133 230608 ns/op 34619 B/op 1654 allocs/op |
|  |  | BenchmarkTelerWithoutCVE-4 15229 75995 ns/op 7169 B/op 124 allocs/op |
|  |  | BenchmarkTelerWithoutBadIPAddress-4 5677 211478 ns/op 34602 B/op 1685 allocs/op |
|  |  | BenchmarkTelerWithoutBadReferrer-4 4875 240689 ns/op 35127 B/op 1684 allocs/op |
|  |  | BenchmarkTelerWithoutBadCrawler-4 4922 238995 ns/op 35000 B/op 1686 allocs/op |
|  |  | BenchmarkTelerWithoutDirectoryBruteforce-4 4894 242973 ns/op 35241 B/op 1687 allocs/op |
|  |  | BenchmarkTelerDefaultOptions-4 4396 266918 ns/op 35944 B/op 1696 allocs/op |
|  |  | BenchmarkTelerCommonWebAttackOnly-4 30795 35602 ns/op 5990 B/op 118 allocs/op |
|  |  | BenchmarkTelerCVEOnly-4 6171 194193 ns/op 33533 B/op 1652 allocs/op |
|  |  | BenchmarkTelerBadIPAddressOnly-4 20464 55957 ns/op 5986 B/op 86 allocs/op |
|  |  | BenchmarkTelerBadReferrerOnly-4 48403 23128 ns/op 5551 B/op 87 allocs/op |
|  |  | BenchmarkTelerBadCrawlerOnly-4 42002 27165 ns/op 5633 B/op 85 allocs/op |
|  |  | BenchmarkTelerDirectoryBruteforceOnly-4 50103 23074 ns/op 5535 B/op 84 allocs/op |
|  |  | BenchmarkTelerCustomRule-4 49483 22086 ns/op 5332 B/op 84 allocs/op |
|  |  | BenchmarkTelerWithoutCommonWebAttack-4 5156 228950 ns/op 34683 B/op 1658 allocs/op |
|  |  | BenchmarkTelerWithoutCVE-4 15295 76501 ns/op 7167 B/op 124 allocs/op |
|  |  | BenchmarkTelerWithoutBadIPAddress-4 5484 216523 ns/op 34820 B/op 1691 allocs/op |
|  |  | BenchmarkTelerWithoutBadReferrer-4 4894 240202 ns/op 35133 B/op 1689 allocs/op |
|  |  | BenchmarkTelerWithoutBadCrawler-4 5012 239976 ns/op 34995 B/op 1691 allocs/op |
|  |  | BenchmarkTelerWithoutDirectoryBruteforce-4 4736 247549 ns/op 35496 B/op 1693 allocs/op |
|  |  | PASS |
|  |  | ok github.com/kitabisa/teler-waf 23.207s |
|  |  | ok github.com/kitabisa/teler-waf 23.660s |
|  |  | ``` |
|  |  |  |
|  |  | > \*\*Note\*\*: It's important to note that the benchmarking results may vary and may not be consistent. Those results were obtained when there were \*\*>1.5k\*\* CVE templates and the [teler-resources](https://github.com/kitabisa/teler-resources) dataset may have increased since then, which may impact the results. |
| Expand Down | |  |

16 changes: 8 additions & 8 deletions

16
[analyze.go](#diff-0066446cff253dced86e182cf4284779ad59a84820338db70f5d8cab30c8b9d4 "analyze.go")

Show comments

[View file](/teler-sh/teler-waf/blob/d1d49cfddfa3ec2adad962870f14b85cd1aaf739/analyze.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -110,8 +110,8 @@ func (t \*Teler) checkCustomRules(r \*http.Request) error { |
|  |  | // Converts map of headers to RAW string |
|  |  | headers := headersToRawString(r.Header) |
|  |  |  |
|  |  | // Decode the URL-encoded request URI of the URL |
|  |  | uri := toURLDecode(r.URL.RequestURI()) |
|  |  | // Decode the URL-encoded and unescape HTML entities request URI of the URL |
|  |  | uri := stringDeUnescape(r.URL.RequestURI()) |
|  |  |  |
|  |  | // Declare byte slice for request body. |
|  |  | var body string |
| Expand All | | @@ -130,8 +130,8 @@ func (t \*Teler) checkCustomRules(r \*http.Request) error { |
|  |  | body = buf.String() |
|  |  | } |
|  |  |  |
|  |  | // Decode the URL-encoded of body |
|  |  | body = toURLDecode(body) |
|  |  | // Decode the URL-encoded and unescape HTML entities of body |
|  |  | body = stringDeUnescape(body) |
|  |  |  |
|  |  | // Iterate over the Customs field of the Teler struct, which is a slice of custom rules |
|  |  | for \_, rule := range t.opt.Customs { |
| Expand Down  Expand Up | | @@ -201,8 +201,8 @@ func (t \*Teler) checkCustomRules(r \*http.Request) error { |
|  |  | // If a match is found, it returns an error indicating a common web attack has been detected. |
|  |  | // If no match is found, it returns nil. |
|  |  | func (t \*Teler) checkCommonWebAttack(r \*http.Request) error { |
|  |  | // Decode the URL-encoded request URI of the URL |
|  |  | uri := toURLDecode(r.URL.RequestURI()) |
|  |  | // Decode the URL-encoded and unescape HTML entities request URI of the URL |
|  |  | uri := stringDeUnescape(r.URL.RequestURI()) |
|  |  |  |
|  |  | // Declare byte slice for request body. |
|  |  | var body string |
| Expand All | | @@ -221,8 +221,8 @@ func (t \*Teler) checkCommonWebAttack(r \*http.Request) error { |
|  |  | body = buf.String() |
|  |  | } |
|  |  |  |
|  |  | // Decode the URL-encoded of body |
|  |  | body = toURLDecode(body) |
|  |  | // Decode the URL-encoded and unescape HTML entities of body |
|  |  | body = stringDeUnescape(body) |
|  |  |  |
|  |  | // Iterate over the filters in the CommonWebAttack data stored in the t.threat.cwa.Filters field |
|  |  | for \_, filter := range t.threat.cwa.Filters { |
| Expand Down | |  |

16 changes: 15 additions & 1 deletion

16
[utils.go](#diff-8b7f25bac2ae04c2ce2abb628c6aa28103fd113103a62f3e9d232fa995684915 "utils.go")

Show comments

[View file](/teler-sh/teler-waf/blob/d1d49cfddfa3ec2adad962870f14b85cd1aaf739/utils.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ package teler |
|  |  |  |
|  |  | import ( |
|  |  | "fmt" |
|  |  | "html" |
|  |  | "strings" |
|  |  |  |
|  |  | "net/http" |
| Expand Down  Expand Up | | @@ -69,11 +70,24 @@ func headersToRawString(headers http.Header) string { |
|  |  | return h.String() |
|  |  | } |
|  |  |  |
|  |  | // toURLDecode decode URL-decoded characters string using mdurl package |
|  |  | // unescapeHTML to unescapes any HTML entities, i.e. &aacute;" |
|  |  | // unescapes to "á", as does "&#225;" and "&#xE1;". |
|  |  | func unescapeHTML(s string) string { |
|  |  | return html.UnescapeString(s) |
|  |  | } |
|  |  |  |
|  |  | // toURLDecode decode URL-decoded characters string using mdurl |
|  |  | func toURLDecode(s string) string { |
|  |  | return mdurl.Decode(s) |
|  |  | } |
|  |  |  |
|  |  | // stringDeUnescape to decode URL-decoded characters, and |
|  |  | // unescapes any HTML entities |
|  |  | func stringDeUnescape(s string) string { |
|  |  | s = toURLDecode(s) |
|  |  | return unescapeHTML(s) |
|  |  | } |
|  |  |  |
|  |  | // isValidMethod check if the given request.Method is valid |
|  |  | func isValidMethod(method request.Method) bool { |
|  |  | switch method { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d1d49cf`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fteler-sh%2Fteler-waf%2Fcommit%2Fd1d49cfddfa3ec2adad962870f14b85cd1aaf739) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


