=== Content from medium.com_c2409aaa_20250114_203532.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4e969af7155b&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40iofinnet%2Fsecurity-disclosure-for-ecdsa-and-eddsa-threshold-signature-schemes-4e969af7155b&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40iofinnet%2Fsecurity-disclosure-for-ecdsa-and-eddsa-threshold-signature-schemes-4e969af7155b&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)![]()
# Security disclosure for ECDSA and EdDSA threshold signature schemes

[![io.finnet](https://miro.medium.com/v2/resize:fill:88:88/1*2kfFYQ4WaaEOPUmH_IfVIQ.jpeg)](/%40iofinnet?source=post_page---byline--4e969af7155b--------------------------------)

[io.finnet](/%40iofinnet?source=post_page---byline--4e969af7155b--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F86ae061e5220&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40iofinnet%2Fsecurity-disclosure-for-ecdsa-and-eddsa-threshold-signature-schemes-4e969af7155b&user=io.finnet&userId=86ae061e5220&source=post_page-86ae061e5220--byline--4e969af7155b---------------------post_header-----------)

9 min read·Mar 28, 2023

--

Listen

Share

At [io.finnet](https://iofinnet.com), we’re committed to elevating the finance industry by equipping institutions with advanced tools and systems.

With applied multi-party computation (MPC), enterprise blockchain, and innovative APIs, we’re driving progress in finance. Discover the potential of our offerings, io.vault and io.network, launching in Q1 2023.

We are immensely proud to announce our collaboration with Kudelski Security and the MPC Alliance, two leading organizations in the field of MPC and cybersecurity. Together, we are actively researching security vulnerabilities in the research and code libraries that we use.

In this post, we will provide details on a number of security vulnerabilities that were discovered in several threshold signature schemes for ECDSA and EdDSA, of which there are popular implementations in Go, Rust, and others, used by many projects and companies in the space.

But before we dive into the details, let us introduce you to some of the key concepts and players involved in this finding.

# What is a threshold signature scheme (TSS)?

Threshold signature schemes (TSS) are cryptographic protocols that allow a group of parties to generate and verify digital signatures without revealing their private keys to each other or to a third party. TSS can enhance the security and scalability of blockchain and digital asset applications, such as decentralized exchanges, wallets, custody solutions, and more.

A TSS has many applications in the blockchain and digital asset space, for instance:

* Secure key management and backup: split a private key into multiple shares, such that only a subset of the shares is needed to sign a transaction. This reduces the risk of losing or compromising the key, and enables distributed custody and recovery schemes;
* Decentralized governance and consensus: enable a group of nodes to sign blocks or transactions collectively, without relying on a single leader or coordinator. This enhances the scalability and resilience of the network, and prevents censorship or corruption;
* Privacy-preserving transactions: allow a group of parties to sign a transaction without revealing their identities or the details of the transaction. This enables confidential and anonymous transactions, and protects the privacy of the users and the data.

ECDSA and EdDSA are two widely used variants of digital signature schemes based on elliptic curve cryptography. While achieving similar goals, these schemes differ in several ways: ECDSA employs elliptic curve cryptography over prime fields, while EdDSA utilizes twisted Edwards curves, providing a more efficient, deterministic, and secure signing process.

# How, and where, are these schemes used?

There are several implementations of these schemes, both public and private, being used today.

The most widely used implementation of the ECDSA and EdDSA threshold signature schemes is known as [TSS-Lib](https://github.com/bnb-chain/tss-lib), and the vulnerabilities apply to both of these schemes within it.

TSS-Lib is an implementation of the paper *“Fast multiparty threshold ECDSA with fast trustless setup”* by Goldfeder et al. ([ref](https://eprint.iacr.org/2019/114)). Some versions of this library implement newer papers such as *“UC Non-Interactive, Proactive, Threshold ECDSA with Identifiable Aborts” (*[*ref*](https://eprint.iacr.org/2021/060)*)*, or are custom variants.

The original upstream version of TSS-Lib is written in Go and was [released](https://github.com/bnb-chain/tss-lib/releases) on GitHub in 2019. Other variants have appeared online since then, with many known crypto projects making use of that code.

While TSS-Lib is the main implementation that we have identified, there are other forms of the code in other programming languages such as Rust and for alternative runtime environments such as web browsers.

# Overview of the Vulnerabilities

The security vulnerabilities were uncovered during an audit of one of our projects by Kudelski Security. We decided to go public with the findings of the audit to raise awareness and help users of threshold signature scheme libraries to mitigate the risks.

After the audit, io.finnet decided to release four high severity issues publicly, [*CVE-2022–47930*](https://www.cve.org/CVERecord?id=CVE-2022-47930), [*CVE-2022–47931*](https://www.cve.org/CVERecord?id=CVE-2022-47931), [*CVE-2023–26556*](https://www.cve.org/CVERecord?id=CVE-2023-26556), and [*CVE-2023–26557*](https://www.cve.org/CVERecord?id=CVE-2023-26557), to help other projects secure their solutions. We will explore each of the disclosures below.

There are four vulnerabilities that we are disclosing, which affect both the ECDSA and EdDSA variants of the TSS implementations. In summary, these vulnerabilities are:

* **Replay Attacks Involving Proofs**
  This vulnerability allows an attacker to exploit the Fiat-Shamir transformation’s challenge generation, thereby enabling replay and spoofing of messages. The impact includes the potential for malicious users or eavesdroppers to undermine the integrity of the zero-knowledge proof system and compromise the security of the protocol.
  This issue was assigned the CVE number [*CVE-2022–47930*](https://www.cve.org/CVERecord?id=CVE-2022-47930).
* **Collision of Hash Values**
  The *SHA256* hash function (known as *SHA512\_256* in our implementation) and its variants concatenate input values with a “$” separator, which can also appear in the input values, resulting in hash collisions. This issue may compromise the security of the system, as the hash functions should behave like random oracles, making it difficult to find collisions. An example of this vulnerability can be seen in the computation of *V\_i* in Round 1 of the “Auxiliary Info & Key Refresh in Three Rounds”.
  This issue was assigned the CVE number [*CVE-2022–47931*](https://www.cve.org/CVERecord?id=CVE-2022-47931).
  This issue has been fixed in the upstream *bnb-chain/tss-lib* as of [pull request #233](https://github.com/bnb-chain/tss-lib/pull/233).
* **Non Constant-Time Arithmetic**
  The Go language’s *big.Int* arithmetic is not constant-time, which leaves the implementation vulnerable to timing attacks. This issue can be exploited by an attacker to obtain sensitive information, such as secret keys, by analyzing the execution time of cryptographic operations.
  This issue was assigned the CVE number [*CVE-2023–26556*](https://www.cve.org/CVERecord?id=CVE-2023-26556).
* **Non-Constant Time Scalar Multiplication**
  Scalar multiplication for the secp256k1 curve is not constant-time, which increases the risk of timing attacks. Similar to the issue in CVE-2023–26556, this vulnerability can be exploited by an attacker to obtain sensitive information by analyzing the execution time of cryptographic operations involving scalar multiplication on the secp256k1 curve.
  This issue was assigned the CVE number [*CVE-2023–26557*](https://www.cve.org/CVERecord?id=CVE-2023-26557).

We will explore each of the vulnerabilities and the solutions in detail in the next sections.

## **CVE-2022–47930: Replay Attacks Involving Proofs**

The Fiat-Shamir transformation’s challenge generation is susceptible to replay attacks. A challenge is computed as:

```
c = H(X.X() || X.Y() || g.X() || g.Y() || A.X() || A.Y())
```

This challenge lacks a unique session identifier (SSID), context string, or random nonce. As a result, a malicious user or eavesdropper can replay a valid proof sent previously, compromising the security of the system.

An attacker could potentially perform man-in-the-middle attacks by replaying valid proofs from past communication sessions. This could lead to unauthorized signing of transactions or manipulation of critical data, causing financial or reputational damage to the affected parties.

To address the issue of replay attacks, the challenge generation in the Fiat-Shamir transformation must be enhanced. The following steps outline the proposed modifications:

1. Generate a unique session ID (SSID).
2. Compute the challenge using a hash function that takes the SSID, public values, and the prover’s commitment as inputs.
3. Use rejection sampling with the computed challenge.

Remediation pseudo-code:

```
ssid = generate_ssid()
c = H(ssid || X.X() || X.Y() || g.X() || g.Y() || A.X() || A.Y())
c = rejectionSample(c)
```

The same modification should be applied to other zero-knowledge proofs identified in the paper, including dec, affg, enc, logstar, and mul.

## **CVE-2022–47931: Collision of Hash Values**

The SHA256 hash function (known as SHA512\_256 in our implementation) and its variants are prone to collisions due to the use of the “$” separator when concatenating input values. The current hash may be expressed as:

```
h = SHA256(b1 || “$” || b2 || “$” || …)
```

With such a function, an adversary could exploit hash collisions to craft malicious parameters that affect key computation, leading to the potential compromise of shared secrets. This could allow the attacker to gain unauthorized access to sensitive data or manipulate transactions, ultimately disrupting the integrity and trustworthiness of the system.

To address the issue of hash collisions, the function must be modified. Replace the “$” separator with a unique and non-conflicting delimiter. Additionally, use a more robust method to concatenate input values, such as length-prefixed encoding or a Merkle tree.

A fixed version of the function call above could look like this:

```
h = SHA256(b1 || len(b1) || “$” || b2 || len(b2) || “$” || …)
```

Where *len(x)* returns a fixed-size (e.g. 64-bit) integer representing the byte length of the data passed as its *x* argument.

Remediation pseudo-code:

```
function SHA256(inputs):
 if len(inputs) == 0:
 return None
 serialized_inputs = serialize(inputs)
 return SHA256.sum(serialized_inputs)

function serialize(input_list):
 result = bytearray()
 for input in input_list:
 result.extend(input)
 result.extend(uint64_to_bytes(len(input)))
 result.extend("$")
 return result
```
## **CVE-2023–26556: Golang’s big.Int Arithmetic Not Constant-Time**

Golang’s *big.Int* arithmetic operations are not constant time, which could lead to timing attacks.

By exploiting timing attacks, an adversary could gather sufficient information to reconstruct private key data. This could lead to a total compromise of the system’s confidentiality and enable the attacker to forge signatures, manipulate transactions, or steal sensitive information, causing significant financial or operational harm.

To address this issue, the code must implement constant-time arithmetic operations or use a third-party library that provides constant-time arithmetic for big integers. Any non-constant time operations in the code should be replaced with constant-time alternatives.

In our fix, we made use of [*cronokirby/saferith*](https://github.com/cronokirby/saferith), a Go library that implements constant-time versions of some *big.Int* methods.

Please note that in the Go 1.20 release, [significant changes](https://words.filippo.io/dispatches/go-1-20-cryptography) have been made to Go’s standard library. The *math/big* package, which is a general-purpose big integer library, is no longer recommended for cryptography due to its lack of constant-time operation guarantees. Instead, the *crypto/internal/bigmod* package has been introduced, specifically designed for operations modulo a prime number with constant-time behavior.

Moving forward, it is essential to use the constant-time *crypto/internal/bigmod* for Go apps that involve cryptography. If you’re currently using the *math/big* package for cryptography code, it is highly recommended to refactor your implementation to use the new *crypto/internal/bigmod* package.

## **CVE-2023–26557: Non-Constant Time Scalar Multiplication For secp256k1**

Scalar multiplication for the secp256k1 curve is not constant time, which could lead to timing side-channel attacks.

Similar to the impact of [*CVE-2023–26556*](https://www.cve.org/CVERecord?id=CVE-2023-26556), the non-constant time scalar multiplication for secp256k1 could be exploited by an attacker to perform timing attacks and deduce private key data. This could lead to the forgery of signatures, unauthorized manipulation of transactions, and the loss of sensitive information.

To address this issue, replacement of non-constant time arithmetic with an alternative constant-time version is essential. We used a constant-time scalar multiplication function based on Montgomery Ladder Point Multiplication by Prof. Bill Buchanan of Edinburgh Napier University, available [here](https://asecuritysite.com/golang/go_bitcoin).

[Montgomery Ladder Point Multiplication](https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication#Montgomery_ladder) is an efficient algorithm used for constant-time scalar multiplication in elliptic curve cryptography. The algorithm works by computing two intermediate points, R₀ and R₁, and updating them in each step of the “ladder”.

The main idea is to avoid conditional statements that could lead to variable execution times. The Montgomery Ladder performs point addition and point doubling operations simultaneously in a way that does not reveal information about the scalar being used.

# Remediation Process

By addressing these vulnerabilities and implementing the proposed modifications, the security of the threshold signature scheme (TSS) library can be significantly improved, making it more robust against potential attacks.

We have notified known users of the TSS-Lib library about these vulnerabilities and provided them with recommendations on how to fix them. We have also published a detailed technical report in the form of CVEs that describe the vulnerabilities, their impact, and their root causes.

We urge users of the TSS-Lib library to review the report and take the necessary actions to secure their applications. We also recommend users to contact us or Kudelski Security for further assistance or guidance.

We are collaborating with Kudelski Security and the MPC Alliance on this disclosure article release, as we share a common vision of advancing the security and privacy of data and digital assets through the application of MPC technology.

# About the MPC Alliance

The MPC Alliance is a group of nearly 40 companies of all sizes, from highly innovative startups to global players like Salesforce or Alibaba Group, with the shared mission to accelerate the adoption of multi-party computing (MPC) technology.

The alliance was originally co-founded by Sepior, Unbound Tech, and ZenGo in 2019 and has since grown to include more than 20 members from various industries and regions.

The MPC Alliance aims to increase market awareness, acceptance, and adoption of MPC-based technologies, products, and services, as well as to foster collaboration and innovation among its members.

Visit their website at [MPC Alliance](http://mpcalliance.org/).

# About Kudelski Security

Kudelski Security is the premier advisor and cybersecurity innovator for today’s most security-conscious organizations. Their long-term approach to client partnerships enables them to continuously evaluate their security posture to recommend solutions that reduce business risk, maintain compliance and increase overall security effectiveness.

With clients that include Fortune 500 enterprises and government organizations in Europe and across the United States, they address the most complex environments through an unparalleled set of solution capabilities including consulting, technology, managed security services and custom innovation.

You may reach Kudelski Security at info@kudelskisecurity.com or visit their website at [Kudelski Security](http://kudelskisecurity.com/).

# Closing Remarks

We are honored to work with these two organizations and we hope that this disclosure will contribute to the improvement of the security and reliability of the TSS technology and its applications. We also invite other users and developers of TSS technology to join us in this effort and to contact us or the MPC Alliance for more information.

You can reach us at security@iofinnet.com or visit our website at [io.finnet](http://iofinnet.com/).

***This article was authored by Luke Plaster, io.finnet Chief Crypto Architect.***

[Tech](/tag/tech?source=post_page-----4e969af7155b--------------------------------)[Technology](/tag/technology?source=post_page-----4e969af7155b--------------------------------)[Security](/tag/security?source=post_page-----4e969af7155b--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----4e969af7155b--------------------------------)[Cryptographic](/tag/cryptographic?source=post_page-----4e969af7155b--------------------------------)

--

--

[![io.finnet](https://miro.medium.com/v2/resize:fill:96:96/1*2kfFYQ4WaaEOPUmH_IfVIQ.jpeg)](/%40iofinnet?source=post_page---post_author_info--4e969af7155b--------------------------------)[![io.finnet](https://miro.medium.com/v2/resize:fill:128:128/1*2kfFYQ4WaaEOPUmH_IfVIQ.jpeg)](/%40iofinnet?source=post_page---post_author_info--4e969af7155b--------------------------------)Follow[## Written by io.finnet](/%40iofinnet?source=post_page---post_author_info--4e969af7155b--------------------------------)[1.3K Followers](/%40iofinnet/followers?source=post_page---post_author_info--4e969af7155b--------------------------------)·[22 Following](/%40iofinnet/following?source=post_page---post_author_info--4e969af7155b--------------------------------)

io.finnet is an industry leader in digital asset infrastructure catering to enterprise-grade clientele worldwide.

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4e969af7155b--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4e969af7155b--------------------------------)[About](/about?autoplay=1&source=post_page-----4e969af7155b--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4e969af7155b--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4e969af7155b--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4e969af7155b--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4e969af7155b--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4e969af7155b--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4e969af7155b--------------------------------)[Teams](/business?source=post_page-----4e969af7155b--------------------------------)



=== Content from gitlab.com_9b084058_20250114_203532.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

v0.1.3

[9c9f4b5a](/thorchain/tss/tss-lib/-/commit/9c9f4b5ac77dbd6d1a50ccbf411b933fe4e7200a)
·
[Merge branch 'add-check' into 'master'](/thorchain/tss/tss-lib/-/commit/9c9f4b5ac77dbd6d1a50ccbf411b933fe4e7200a)

·
Sep 15, 2022

Release:
[v0.1.3](/thorchain/tss/tss-lib/-/releases/v0.1.3)



=== Content from github.com_d0a5b1e0_20250114_203531.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbnb-chain%2Ftss-lib%2Ftree%2Fv1.3.5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbnb-chain%2Ftss-lib%2Ftree%2Fv1.3.5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=bnb-chain%2Ftss-lib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bnb-chain](/bnb-chain)
/
**[tss-lib](/bnb-chain/tss-lib)**
Public

* [Notifications](/login?return_to=%2Fbnb-chain%2Ftss-lib) You must be signed in to change notification settings
* [Fork
  284](/login?return_to=%2Fbnb-chain%2Ftss-lib)
* [Star
   832](/login?return_to=%2Fbnb-chain%2Ftss-lib)

Threshold Signature Scheme, for ECDSA and EDDSA

### License

[MIT license](/bnb-chain/tss-lib/blob/master/LICENSE)

[832
stars](/bnb-chain/tss-lib/stargazers) [284
forks](/bnb-chain/tss-lib/forks) [Branches](/bnb-chain/tss-lib/branches) [Tags](/bnb-chain/tss-lib/tags) [Activity](/bnb-chain/tss-lib/activity)
 [Star](/login?return_to=%2Fbnb-chain%2Ftss-lib)

 [Notifications](/login?return_to=%2Fbnb-chain%2Ftss-lib) You must be signed in to change notification settings

* [Code](/bnb-chain/tss-lib/tree/v1.3.5)
* [Issues
  62](/bnb-chain/tss-lib/issues)
* [Pull requests
  4](/bnb-chain/tss-lib/pulls)
* [Actions](/bnb-chain/tss-lib/actions)
* [Projects
  0](/bnb-chain/tss-lib/projects)
* [Security](/bnb-chain/tss-lib/security)
* [Insights](/bnb-chain/tss-lib/pulse)

Additional navigation options

* [Code](/bnb-chain/tss-lib/tree/v1.3.5)
* [Issues](/bnb-chain/tss-lib/issues)
* [Pull requests](/bnb-chain/tss-lib/pulls)
* [Actions](/bnb-chain/tss-lib/actions)
* [Projects](/bnb-chain/tss-lib/projects)
* [Security](/bnb-chain/tss-lib/security)
* [Insights](/bnb-chain/tss-lib/pulse)

# bnb-chain/tss-lib

    v1.3.5[Branches](/bnb-chain/tss-lib/branches)[Tags](/bnb-chain/tss-lib/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[374 Commits](/bnb-chain/tss-lib/commits/v1.3.5/) | | |
| [.github/workflows](/bnb-chain/tss-lib/tree/v1.3.5/.github/workflows "This path skips through empty directories") | | [.github/workflows](/bnb-chain/tss-lib/tree/v1.3.5/.github/workflows "This path skips through empty directories") |  |  |
| [.idea](/bnb-chain/tss-lib/tree/v1.3.5/.idea ".idea") | | [.idea](/bnb-chain/tss-lib/tree/v1.3.5/.idea ".idea") |  |  |
| [common](/bnb-chain/tss-lib/tree/v1.3.5/common "common") | | [common](/bnb-chain/tss-lib/tree/v1.3.5/common "common") |  |  |
| [crypto](/bnb-chain/tss-lib/tree/v1.3.5/crypto "crypto") | | [crypto](/bnb-chain/tss-lib/tree/v1.3.5/crypto "crypto") |  |  |
| [ecdsa](/bnb-chain/tss-lib/tree/v1.3.5/ecdsa "ecdsa") | | [ecdsa](/bnb-chain/tss-lib/tree/v1.3.5/ecdsa "ecdsa") |  |  |
| [eddsa](/bnb-chain/tss-lib/tree/v1.3.5/eddsa "eddsa") | | [eddsa](/bnb-chain/tss-lib/tree/v1.3.5/eddsa "eddsa") |  |  |
| [protob](/bnb-chain/tss-lib/tree/v1.3.5/protob "protob") | | [protob](/bnb-chain/tss-lib/tree/v1.3.5/protob "protob") |  |  |
| [test](/bnb-chain/tss-lib/tree/v1.3.5/test "test") | | [test](/bnb-chain/tss-lib/tree/v1.3.5/test "test") |  |  |
| [tss](/bnb-chain/tss-lib/tree/v1.3.5/tss "tss") | | [tss](/bnb-chain/tss-lib/tree/v1.3.5/tss "tss") |  |  |
| [.gitignore](/bnb-chain/tss-lib/blob/v1.3.5/.gitignore ".gitignore") | | [.gitignore](/bnb-chain/tss-lib/blob/v1.3.5/.gitignore ".gitignore") |  |  |
| [LICENSE](/bnb-chain/tss-lib/blob/v1.3.5/LICENSE "LICENSE") | | [LICENSE](/bnb-chain/tss-lib/blob/v1.3.5/LICENSE "LICENSE") |  |  |
| [Makefile](/bnb-chain/tss-lib/blob/v1.3.5/Makefile "Makefile") | | [Makefile](/bnb-chain/tss-lib/blob/v1.3.5/Makefile "Makefile") |  |  |
| [README.md](/bnb-chain/tss-lib/blob/v1.3.5/README.md "README.md") | | [README.md](/bnb-chain/tss-lib/blob/v1.3.5/README.md "README.md") |  |  |
| [SECURITY.md](/bnb-chain/tss-lib/blob/v1.3.5/SECURITY.md "SECURITY.md") | | [SECURITY.md](/bnb-chain/tss-lib/blob/v1.3.5/SECURITY.md "SECURITY.md") |  |  |
| [go.mod](/bnb-chain/tss-lib/blob/v1.3.5/go.mod "go.mod") | | [go.mod](/bnb-chain/tss-lib/blob/v1.3.5/go.mod "go.mod") |  |  |
| [go.sum](/bnb-chain/tss-lib/blob/v1.3.5/go.sum "go.sum") | | [go.sum](/bnb-chain/tss-lib/blob/v1.3.5/go.sum "go.sum") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* Security
# Multi-Party Threshold Signature Scheme

[![MIT licensed](https://camo.githubusercontent.com/6581c31c16c1b13ddc2efb92e2ad69a93ddc4a92fd871ff15d401c4c6c9155a4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e737667)](/bnb-chain/tss-lib/blob/v1.3.5/LICENSE) [![GoDoc](https://camo.githubusercontent.com/4009148a92c7ab8eb3e798788f85f9903f5559b741a92fb0d91a1bcae6db3f9e/68747470733a2f2f676f646f632e6f72672f6769746875622e636f6d2f626e622d636861696e2f7473732d6c69623f7374617475732e737667)](https://godoc.org/github.com/bnb-chain/tss-lib) [![Go Report Card](https://camo.githubusercontent.com/639fd0f0553264916972bd80310f8c70873b0c50606308bb6eb6c785e182d157/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f626e622d636861696e2f7473732d6c6962)](https://goreportcard.com/report/github.com/bnb-chain/tss-lib)

Permissively MIT Licensed.

Note! This is a library for developers. You may find a TSS tool that you can use with the Binance Chain CLI [here](https://docs.binance.org/tss.html).

## Introduction

This is an implementation of multi-party {t,n}-threshold ECDSA (Elliptic Curve Digital Signature Algorithm) based on Gennaro and Goldfeder CCS 2018 [1](https://img.shields.io/badge/license-MIT-blue.svg) and EdDSA (Edwards-curve Digital Signature Algorithm) following a similar approach.

This library includes three protocols:

* Key Generation for creating secret shares with no trusted dealer ("keygen").
* Signing for using the secret shares to generate a signature ("signing").
* Dynamic Groups to change the group of participants while keeping the secret ("resharing").

⚠️ Do not miss [these important notes](#how-to-use-this-securely) on implementing this library securely

## Rationale

ECDSA is used extensively for crypto-currencies such as Bitcoin, Ethereum (secp256k1 curve), NEO (NIST P-256 curve) and many more.

EdDSA is used extensively for crypto-currencies such as Cardano, Aeternity, Stellar Lumens and many more.

For such currencies this technique may be used to create crypto wallets where multiple parties must collaborate to sign transactions. See [MultiSig Use Cases](https://en.bitcoin.it/wiki/Multisignature#Multisignature_Applications)

One secret share per key/address is stored locally by each participant and these are kept safe by the protocol – they are never revealed to others at any time. Moreover, there is no trusted dealer of the shares.

In contrast to MultiSig solutions, transactions produced by TSS preserve the privacy of the signers by not revealing which `t+1` participants were involved in their signing.

There is also a performance bonus in that blockchain nodes may check the validity of a signature without any extra MultiSig logic or processing.

## Usage

You should start by creating an instance of a `LocalParty` and giving it the arguments that it needs.

The `LocalParty` that you use should be from the `keygen`, `signing` or `resharing` package depending on what you want to do.

### Setup

```
// When using the keygen party it is recommended that you pre-compute the "safe primes" and Paillier secret beforehand because this can take some time.
// This code will generate those parameters using a concurrency limit equal to the number of available CPU cores.
preParams, _ := keygen.GeneratePreParams(1 * time.Minute)

// Create a `*PartyID` for each participating peer on the network (you should call `tss.NewPartyID` for each one)
parties := tss.SortPartyIDs(getParticipantPartyIDs())

// Set up the parameters
// Note: The `id` and `moniker` fields are for convenience to allow you to easily track participants.
// The `id` should be a unique string representing this party in the network and `moniker` can be anything (even left blank).
// The `uniqueKey` is a unique identifying key for this peer (such as its p2p public key) as a big.Int.
thisParty := tss.NewPartyID(id, moniker, uniqueKey)
ctx := tss.NewPeerContext(parties)

// Select an elliptic curve
// use ECDSA
curve := tss.S256()
// or use EdDSA
// curve := tss.Edwards()

params := tss.NewParameters(curve, ctx, thisParty, len(parties), threshold)

// You should keep a local mapping of `id` strings to `*PartyID` instances so that an incoming message can have its origin party's `*PartyID` recovered for passing to `UpdateFromBytes` (see below)
partyIDMap := make(map[string]*PartyID)
for _, id := range parties {
    partyIDMap[id.Id] = id
}
```

### Keygen

Use the `keygen.LocalParty` for the keygen protocol. The save data you receive through the `endCh` upon completion of the protocol should be persisted to secure storage.

```
party := keygen.NewLocalParty(params, outCh, endCh, preParams) // Omit the last arg to compute the pre-params in round 1
go func() {
    err := party.Start()
    // handle err ...
}()
```

### Signing

Use the `signing.LocalParty` for signing and provide it with a `message` to sign. It requires the key data obtained from the keygen protocol. The signature will be sent through the `endCh` once completed.

Please note that `t+1` signers are required to sign a message and for optimal usage no more than this should be involved. Each signer should have the same view of who the `t+1` signers are.

```
party := signing.NewLocalParty(message, params, ourKeyData, outCh, endCh)
go func() {
    err := party.Start()
    // handle err ...
}()
```

### Re-Sharing

Use the `resharing.LocalParty` to re-distribute the secret shares. The save data received through the `endCh` should overwrite the existing key data in storage, or write new data if the party is receiving a new share.

Please note that `ReSharingParameters` is used to give this Party more context about the re-sharing that should be carried out.

```
party := resharing.NewLocalParty(params, ourKeyData, outCh, endCh)
go func() {
    err := party.Start()
    // handle err ...
}()
```

⚠️ During re-sharing the key data may be modified during the rounds. Do not ever overwrite any data saved on disk until the final struct has been received through the `end` channel.

## Messaging

In these examples the `outCh` will collect outgoing messages from the party and the `endCh` will receive save data or a signature when the protocol is complete.

During the protocol you should provide the party with updates received from other participating parties on the network.

A `Party` has two thread-safe methods on it for receiving updates.

```
// The main entry point when updating a party's state from the wire
UpdateFromBytes(wireBytes []byte, from *tss.PartyID, isBroadcast bool) (ok bool, err *tss.Error)
// You may use this entry point to update a party's state when running locally or in tests
Update(msg tss.ParsedMessage) (ok bool, err *tss.Error)
```

And a `tss.Message` has the following two methods for converting messages to data for the wire:

```
// Returns the encoded message bytes to send over the wire along with routing information
WireBytes() ([]byte, *tss.MessageRouting, error)
// Returns the protobuf wrapper message struct, used only in some exceptional scenarios (i.e. mobile apps)
WireMsg() *tss.MessageWrapper
```

In a typical use case, it is expected that a transport implementation will consume message bytes via the `out` channel of the local `Party`, send them to the destination(s) specified in the result of `msg.GetTo()`, and pass them to `UpdateFromBytes` on the receiving end.

This way there is no need to deal with Marshal/Unmarshalling Protocol Buffers to implement a transport.

## How to use this securely

⚠️ This section is important. Be sure to read it!

The transport for messaging is left to the application layer and is not provided by this library. Each one of the following paragraphs should be read and followed carefully as it is crucial that you implement a secure transport to ensure safety of the protocol.

When you build a transport, it should offer a broadcast channel as well as point-to-point channels connecting every pair of parties. Your transport should also employ suitable end-to-end encryption (TLS with an [AEAD cipher](https://en.wikipedia.org/wiki/Authenticated_encryption#Authenticated_encryption_with_associated_data_(AEAD)) is recommended) between parties to ensure that a party can only read the messages sent to it.

Within your transport, each message should be wrapped with a **session ID** that is unique to a single run of the keygen, signing or re-sharing rounds. This session ID should be agreed upon out-of-band and known only by the participating parties before the rounds begin. Upon receiving any message, your program should make sure that the received session ID matches the one that was agreed upon at the start.

Additionally, there should be a mechanism in your transport to allow for "reliable broadcasts", meaning parties can broadcast a message to other parties such that it's guaranteed that each one receives the same message. There are several examples of algorithms online that do this by sharing and comparing hashes of received messages.

Timeouts and errors should be handled by your application. The method `WaitingFor` may be called on a `Party` to get the set of other parties that it is still waiting for messages from. You may also get the set of culprit parties that caused an error from a `*tss.Error`.

## Security Audit

A full review of this library was carried out by Kudelski Security and their final report was made available in October, 2019. A copy of this report [`audit-binance-tss-lib-final-20191018.pdf`](https://github.com/bnb-chain/tss-lib/releases/download/v1.0.0/audit-binance-tss-lib-final-20191018.pdf) may be found in the v1.0.0 release notes of this repository.

## References

[1] <https://eprint.iacr.org/2019/114.pdf>

## About

Threshold Signature Scheme, for ECDSA and EDDSA

### Topics

[golang](/topics/golang "Topic: golang")
[cryptography](/topics/cryptography "Topic: cryptography")
[blockchain](/topics/blockchain "Topic: blockchain")
[tss](/topics/tss "Topic: tss")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](/bnb-chain/tss-lib/blob/master/LICENSE)
### Security policy

[Security policy](#security-ov-file)

[Activity](/bnb-chain/tss-lib/activity)
[Custom properties](/bnb-chain/tss-lib/custom-properties)
### Stars

[**832**
stars](/bnb-chain/tss-lib/stargazers)
### Watchers

[**33**
watching](/bnb-chain/tss-lib/watchers)
### Forks

[**284**
forks](/bnb-chain/tss-lib/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fbnb-chain%2Ftss-lib&report=bnb-chain+%28user%29)

## [Releases 12](/bnb-chain/tss-lib/releases)

[v2.0.2
Latest

Jan 16, 2024](/bnb-chain/tss-lib/releases/tag/v2.0.2)
[+ 11 releases](/bnb-chain/tss-lib/releases)

## [Packages 0](/orgs/bnb-chain/packages?repo_name=tss-lib)

No packages published

## [Contributors 19](/bnb-chain/tss-lib/graphs/contributors)

[+ 5 contributors](/bnb-chain/tss-lib/graphs/contributors)

## Languages

* [Go
  99.7%](/bnb-chain/tss-lib/search?l=go)
* [Makefile
  0.3%](/bnb-chain/tss-lib/search?l=makefile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


