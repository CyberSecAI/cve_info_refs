```
{
  "guidelines_version": "4",
  "cve_id": "CVE-2023-26919",
  "multipage_content": [
    {
      "page_number": 1,
      "content": "UNRELATED"
    },
    {
      "page_number": 2,
       "content": "UNRELATED"
    },
    {
      "page_number": 3,
      "content": "The vulnerability is in delight-nashorn-sandbox versions 0.2.4 and 0.2.5. It is a sandbox escape vulnerability. \n\n**Root cause of vulnerability:**\nThe `loadWithNewGlobal` function, when `allowExitFunctions` is set to false, can be used to invoke the `exit` and `quit` methods. This allows exiting the Java process, bypassing the intended sandbox restrictions.\n\n**Weaknesses/vulnerabilities present:**\n- Inadequate restriction of the `loadWithNewGlobal` function, which allows execution of arbitrary code including `exit` and `quit`.\n- The vulnerability exists when `allowExitFunctions` is false, meaning the intent is to restrict such functionality.\n\n**Impact of exploitation:**\n- Arbitrary code execution leading to a sandbox escape.\n- The attacker can exit the Java process.\n\n**Attack vectors:**\n- By using the `loadWithNewGlobal` function within the sandbox.\n\n**Required attacker capabilities/position:**\n- Ability to execute code within the Nashorn sandbox.\n- Knowledge of the vulnerable `loadWithNewGlobal` function and ability to provide inputs that include `exit` or `quit` calls"
    },
    {
      "page_number": 4,
      "content": "UNRELATED"
    },
    {
       "page_number": 5,
       "content": "UNRELATED"
    },
        {
      "page_number": 6,
      "content": "This content confirms the vulnerability in `delight-nashorn-sandbox` versions 0.2.4 and 0.2.5. It specifically describes how the `loadWithNewGlobal` function can bypass the `allowExitFunctions(false)` setting to invoke `exit` and `quit`, leading to a sandbox escape.\n\n**Root cause of vulnerability:**\nThe `loadWithNewGlobal` function allows invoking `exit` and `quit` methods even when `allowExitFunctions` is set to false, which is intended to prevent exiting the process.\n\n**Weaknesses/vulnerabilities present:**\n- The `loadWithNewGlobal` function does not respect the `allowExitFunctions` setting.\n- It allows execution of arbitrary code, including process termination commands.\n\n**Impact of exploitation:**\n- The attacker can terminate the Java process by using the `exit` or `quit` methods within the sandbox.\n- This is a sandbox escape that breaks the intended isolation.\n\n**Attack vectors:**\n- By calling `loadWithNewGlobal` with a script that contains `exit()` or `quit()`.\n\n**Required attacker capabilities/position:**\n- The attacker must be able to provide a script to be evaluated within the Nashorn sandbox.\n- The attacker must be able to call the `loadWithNewGlobal` function with the malicious script.\n\n**Additional Information**\n- The suggested fix is to disable the load function.  If not possible, the recommendation is to overwrite the `loadWithNewGlobal` variable."
    }
  ]
}
```