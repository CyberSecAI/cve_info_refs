=== Content from security.snyk.io_ca28319f_20250114_194259.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [Go](/vuln/golang)
4. github.com/gin-gonic/gin
# Improper Input Validation Affecting [github.com/gin-gonic/gin](/package/golang/github.com/gin-gonic/gin) package, versions **<1.9.0**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-GOLANG-GITHUBCOMGINGONICGIN-3324285#cvss)

### Threat Intelligence

EPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.16% (54th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)

* Snyk ID**SNYK-GOLANG-GITHUBCOMGINGONICGIN-3324285**
* published**3 May 2023**
* disclosed**17 Feb 2023**
* credit**t0rchwo0d**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 17 Feb 2023

[CVE-2023-26125  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2023-26125) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-20  (opens in a new tab)](https://cwe.mitre.org/data/definitions/20.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `github.com/gin-gonic/gin` to version 1.9.0 or higher.

## Overview

[github.com/gin-gonic/gin](https://github.com/gin-gonic/gin) is a package that implements a HTTP web framework called gin.

Affected versions of this package are vulnerable to Improper Input Validation by allowing an attacker to use a specially crafted request via the `X-Forwarded-Prefix` header, potentially leading to cache poisoning.

**Note:** Although this issue does not pose a significant threat on its own it can serve as an input vector for other more impactful vulnerabilities. However, successful exploitation may depend on the server configuration and whether the header is used in the application logic.

## PoC

```
package main

import (
    "net/http"

    "github.com/gin-gonic/gin"
)

func main() {

    r := gin.Default()

    r.GET("/bug", func(c *gin.Context) {
        c.JSON(http.StatusBadRequest, gin.H{"msg": "bug"})
    })

    r.Run()
}

```
## References

* [GitHub Commit](https://github.com/t0rchwo0d/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b)
* [GitHub PR](https://github.com/gin-gonic/gin/pull/3500)
* [GitHub PR](https://github.com/gin-gonic/gin/pull/3503)
* [GitHub Release](https://github.com/gin-gonic/gin/releases/tag/v1.9.0)
### CVSS Scores

version 3.1
### Snyk

5.6 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

7.3 high
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_8be2d7d2_20250114_194258.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ft0rchwo0d%2Fgin%2Fcommit%2Ffd9f98e70fb4107ee68c783482d231d35e60507b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ft0rchwo0d%2Fgin%2Fcommit%2Ffd9f98e70fb4107ee68c783482d231d35e60507b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=t0rchwo0d%2Fgin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[t0rchwo0d](/t0rchwo0d)
/
**[gin](/t0rchwo0d/gin)**
Public

forked from [gin-gonic/gin](/gin-gonic/gin)

* [Notifications](/login?return_to=%2Ft0rchwo0d%2Fgin) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Ft0rchwo0d%2Fgin)
* [Star
   0](/login?return_to=%2Ft0rchwo0d%2Fgin)

* [Code](/t0rchwo0d/gin)
* [Pull requests
  0](/t0rchwo0d/gin/pulls)
* [Actions](/t0rchwo0d/gin/actions)
* [Projects
  0](/t0rchwo0d/gin/projects)
* [Security](/t0rchwo0d/gin/security)
* [Insights](/t0rchwo0d/gin/pulse)

Additional navigation options

* [Code](/t0rchwo0d/gin)
* [Pull requests](/t0rchwo0d/gin/pulls)
* [Actions](/t0rchwo0d/gin/actions)
* [Projects](/t0rchwo0d/gin/projects)
* [Security](/t0rchwo0d/gin/security)
* [Insights](/t0rchwo0d/gin/pulse)

## Commit

[Permalink](/t0rchwo0d/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) Add escape logic for header

[Browse files](/t0rchwo0d/gin/tree/fd9f98e70fb4107ee68c783482d231d35e60507b)
Browse the repository at this point in the history

* Loading branch information

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&v=4)](/t0rchwo0d)

[t0rchwo0d](/t0rchwo0d/gin/commits?author=t0rchwo0d "View all commits by t0rchwo0d")
committed
Feb 17, 2023

1 parent
[81ac7d5](/t0rchwo0d/gin/commit/81ac7d55a09e34013225db0aeac6e70c1ae68928)

commit fd9f98e

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**10 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* gin.go
  [gin.go](#diff-447bee2da23875fead662441fef4b89e1918d4b5f01d1aa3f5d6cdc0cc51a4ac)
* routes\_test.go
  [routes\_test.go](#diff-c8964eb554f66441fb598b899eff3e0253a983fef3f328c7ff8f15c8d5484d10)

## There are no files selected for viewing

6 changes: 3 additions & 3 deletions

6
[gin.go](#diff-447bee2da23875fead662441fef4b89e1918d4b5f01d1aa3f5d6cdc0cc51a4ac "gin.go")

Show comments

[View file](/t0rchwo0d/gin/blob/fd9f98e70fb4107ee68c783482d231d35e60507b/gin.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,9 +9,9 @@ import ( |
|  |  | "html/template" |
|  |  | "net" |
|  |  | "net/http" |
|  |  | "net/url" |
|  |  | "os" |
|  |  | "path" |
|  |  | "regexp" |
|  |  | "strings" |
|  |  | "sync" |
|  |  |  |
| Expand Down  Expand Up | | @@ -669,8 +669,8 @@ func redirectTrailingSlash(c \*Context) { |
|  |  | req := c.Request |
|  |  | p := req.URL.Path |
|  |  | if prefix := path.Clean(c.Request.Header.Get("X-Forwarded-Prefix")); prefix != "." { |
|  |  | prefix = url.QueryEscape(prefix) |
|  |  | prefix = strings.ReplaceAll(prefix, "%2F", "/") |
|  |  | reg := regexp.MustCompile("[^a-zA-Z0-9/-]+") |
|  |  | prefix = reg.ReplaceAllString(prefix, "") |
|  |  |  |
|  |  | p = prefix + "/" + req.URL.Path |
|  |  | } |
| Expand Down | |  |

10 changes: 7 additions & 3 deletions

10
[routes\_test.go](#diff-c8964eb554f66441fb598b899eff3e0253a983fef3f328c7ff8f15c8d5484d10 "routes_test.go")

Show comments

[View file](/t0rchwo0d/gin/blob/fd9f98e70fb4107ee68c783482d231d35e60507b/routes_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -186,15 +186,19 @@ func TestRouteRedirectTrailingSlash(t \*testing.T) { |
|  |  | assert.Equal(t, 200, w.Code) |
|  |  |  |
|  |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "../../bug#?"}) |
|  |  | assert.Equal(t, "../../../bug%2523%253F/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, "//bug//path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, 301, w.Code) |
|  |  |  |
|  |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "https://gin-gonic.com/#"}) |
|  |  | assert.Equal(t, "https%3A/gin-gonic.com/%23/https%253A/gin-gonic.com/%2523/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, "https/gin-goniccom/https/gin-goniccom/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, 301, w.Code) |
|  |  |  |
|  |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "#bug"}) |
|  |  | assert.Equal(t, "%23bug/%2523bug/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, "bug/bug/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, 301, w.Code) |
|  |  |  |
|  |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "/nor-mal/#?a=1"}) |
|  |  | assert.Equal(t, "/nor-mal/a1/path", w.Header().Get("Location")) |
|  |  | assert.Equal(t, 301, w.Code) |
|  |  |  |
|  |  | router.RedirectTrailingSlash = false |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fd9f98e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ft0rchwo0d%2Fgin%2Fcommit%2Ffd9f98e70fb4107ee68c783482d231d35e60507b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_94234578_20250114_194257.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Freleases%2Ftag%2Fv1.9.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Freleases%2Ftag%2Fv1.9.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=gin-gonic%2Fgin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gin-gonic](/gin-gonic)
/
**[gin](/gin-gonic/gin)**
Public

* [Notifications](/login?return_to=%2Fgin-gonic%2Fgin) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fgin-gonic%2Fgin)
* [Star
   79.9k](/login?return_to=%2Fgin-gonic%2Fgin)

* [Code](/gin-gonic/gin/tree/v1.9.0)
* [Issues
  634](/gin-gonic/gin/issues)
* [Pull requests
  198](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

Additional navigation options

* [Code](/gin-gonic/gin/tree/v1.9.0)
* [Issues](/gin-gonic/gin/issues)
* [Pull requests](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

1. [Releases](/gin-gonic/gin/releases)
2. [v1.9.0](/gin-gonic/gin/releases/tag/v1.9.0)

# v1.9.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/gin-gonic/gin/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.9.0)

 Loading

[View all tags](/gin-gonic/gin/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
21 Feb 09:22

·
[129 commits](/gin-gonic/gin/compare/v1.9.0...master)
to master
since this release

[v1.9.0](/gin-gonic/gin/tree/v1.9.0)

[`ea03e10`](/gin-gonic/gin/commit/ea03e10384502e1baf6f560a2b0ea32c342ede5b)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Changelog

### BREAK CHANGES

* Stop useless panicking in context and render [#2150](https://github.com/gin-gonic/gin/pull/2150)

### BUG FIXES

* fix(router): tree bug where loop index is not decremented. [#3460](https://github.com/gin-gonic/gin/pull/3460)
* fix(context): panic on NegotiateFormat - index out of range [#3397](https://github.com/gin-gonic/gin/pull/3397)
* Add escape logic for header [#3500](https://github.com/gin-gonic/gin/pull/3500) and [#3503](https://github.com/gin-gonic/gin/pull/3503)

### SECURITY

* Fix the GO-2022-0969 and GO-2022-0288 vulnerabilities [#3333](https://github.com/gin-gonic/gin/pull/3333)
* fix(security): vulnerability GO-2023-1571 [#3505](https://github.com/gin-gonic/gin/pull/3505)

### ENHANCEMENTS

* feat: add sonic json support [#3184](https://github.com/gin-gonic/gin/pull/3184)
* chore(file): Creates a directory named path [#3316](https://github.com/gin-gonic/gin/pull/3316)
* fix: modify interface check way [#3327](https://github.com/gin-gonic/gin/pull/3327)
* remove deprecated of package io/ioutil [#3395](https://github.com/gin-gonic/gin/pull/3395)
* refactor: avoid calling strings.ToLower twice [#3343](https://github.com/gin-gonic/gin/pull/3433)
* console logger HTTP status code bug fixed [#3453](https://github.com/gin-gonic/gin/pull/3453)
* chore(yaml): upgrade dependency to v3 version [#3456](https://github.com/gin-gonic/gin/pull/3456)
* chore(router): match method added to routergroup for multiple HTTP methods supporting [#3464](https://github.com/gin-gonic/gin/pull/3464)
* chore(http): add support for go1.20 http.rwUnwrapper to gin.responseWriter [#3489](https://github.com/gin-gonic/gin/pull/3489)

### DOCS

* docs: update markdown format [#3260](https://github.com/gin-gonic/gin/pull/3260)
* docs(readme): Add the TOML rendering example [#3400](https://github.com/gin-gonic/gin/pull/3400)
* docs(readme): move more example to docs/doc.md [#3449](https://github.com/gin-gonic/gin/pull/3449)
* docs: update markdown format [#3446](https://github.com/gin-gonic/gin/pull/3446)

 Assets
2

 Loading

 👍
34
 DiOnFire, thinkerou, Lord-Y, thesobercoder, axiangcoding, ShadowUser17, hitenkoku, finaldzn, roharon, MHSanaei, and 24 more reacted with thumbs up emoji
 🎉
9
 fitrh, quan-xie, i0tool5, li1234yun, Fimeo, alxndr13, sunecko, Juandavi1, and gabriiels reacted with hooray emoji
 ❤️
7
 thinkerou, i0tool5, fengccp, EmasXP, scarshad, Juandavi1, and ryclos reacted with heart emoji
 👀
7
 KiddoV, 1995parham, i0tool5, Hasan-Kilici, Juandavi1, lemoba, and Tayennn reacted with eyes emoji

All reactions

* 👍
  34 reactions
* 🎉
  9 reactions
* ❤️
  7 reactions
* 👀
  7 reactions

 48 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_97b684c9_20250114_194257.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3503)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3503)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=gin-gonic%2Fgin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gin-gonic](/gin-gonic)
/
**[gin](/gin-gonic/gin)**
Public

* [Notifications](/login?return_to=%2Fgin-gonic%2Fgin) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fgin-gonic%2Fgin)
* [Star
   79.9k](/login?return_to=%2Fgin-gonic%2Fgin)

* [Code](/gin-gonic/gin)
* [Issues
  634](/gin-gonic/gin/issues)
* [Pull requests
  198](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

Additional navigation options

* [Code](/gin-gonic/gin)
* [Issues](/gin-gonic/gin/issues)
* [Pull requests](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgin-gonic%2Fgin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgin-gonic%2Fgin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix #3500 Add escape logic for header #3503

 Merged

[appleboy](/appleboy)
merged 1 commit into
[gin-gonic:master](/gin-gonic/gin/tree/master "gin-gonic/gin:master")
from
[t0rchwo0d:fix-3500-add-escape-logic](/t0rchwo0d/gin/tree/fix-3500-add-escape-logic "t0rchwo0d/gin:fix-3500-add-escape-logic")

Feb 19, 2023

 Merged

# [Fix #3500 Add escape logic for header](#top) #3503

[appleboy](/appleboy)
merged 1 commit into
[gin-gonic:master](/gin-gonic/gin/tree/master "gin-gonic/gin:master")
from
[t0rchwo0d:fix-3500-add-escape-logic](/t0rchwo0d/gin/tree/fix-3500-add-escape-logic "t0rchwo0d/gin:fix-3500-add-escape-logic")

Feb 19, 2023

[Conversation
16](/gin-gonic/gin/pull/3503)
[Commits
1](/gin-gonic/gin/pull/3503/commits)
[Checks
0](/gin-gonic/gin/pull/3503/checks)
[Files changed](/gin-gonic/gin/pull/3503/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=60&v=4)](/t0rchwo0d)

Copy link

Contributor

### @t0rchwo0d **[t0rchwo0d](/t0rchwo0d)** commented [Feb 17, 2023](#issue-1588710641) • edited Loading

Hi, [@appleboy](https://github.com/appleboy), [@thinkerou](https://github.com/thinkerou)

Excuse me, I again think about [#3500](https://github.com/gin-gonic/gin/pull/3500)

I'm sorry to bother you.

`.` delimiter & Repeated `/` delimiter was judged to need to be delete and merge,

So, I request PR again.

* Remove characters outside the allowed range (`alphabets`, `numeric`, `-`, `/`)
* Merge Repeated `/` delimiters into one
* Add Test Case

Sorry, something went wrong.

All reactions

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/c22614fad926e7737c7d75dc4e71a0988caddbd2..bd78de03c2113a94e666f2343dc9ce32995fb908)
the
fix-3500-add-escape-logic

branch
from
[`c22614f`](/gin-gonic/gin/commit/c22614fad926e7737c7d75dc4e71a0988caddbd2) to
[`bd78de0`](/gin-gonic/gin/commit/bd78de03c2113a94e666f2343dc9ce32995fb908)  [Compare](/gin-gonic/gin/compare/c22614fad926e7737c7d75dc4e71a0988caddbd2..bd78de03c2113a94e666f2343dc9ce32995fb908)
[February 17, 2023 03:57](#event-8543261817)

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Feb 17, 2023](#issuecomment-1434061782) • edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/gin-gonic/gin/pull/3503?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) Report Merging [#3503](https://codecov.io/gh/gin-gonic/gin/pull/3503?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) ([69e306f](https://github.com/gin-gonic/gin/commit/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)) into [master](https://codecov.io/gh/gin-gonic/gin/commit/81ac7d55a09e34013225db0aeac6e70c1ae68928?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) ([81ac7d5](https://github.com/gin-gonic/gin/commit/81ac7d55a09e34013225db0aeac6e70c1ae68928)) will **not change** coverage. The diff coverage is `100.00%`.  ``` @@           Coverage Diff           @@ ##           master    #3503   +/-   ## =======================================   Coverage   98.63%   98.63%            =======================================   Files          42       42              Lines        3151     3151            =======================================   Hits         3108     3108              Misses         29       29              Partials       14       14            ```  | Flag | Coverage Δ |  | | --- | --- | --- | |  | `98.63% <100.00%> (ø)` |  | | go-1.16 | `∅ <ø> (?)` |  | | go-1.17 | `98.54% <100.00%> (ø)` |  | | go-1.18 | `98.54% <100.00%> (ø)` |  | | go-1.19 | `98.63% <100.00%> (ø)` |  | | go-1.20 | `98.63% <100.00%> (ø)` |  | | macos-latest | `98.63% <100.00%> (ø)` |  | | ubuntu-latest | `98.63% <100.00%> (ø)` |  |   Flags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic#carryforward-flags-in-the-pull-request-comment) to find out more.   | [Impacted Files](https://codecov.io/gh/gin-gonic/gin/pull/3503?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) | Coverage Δ |  | | --- | --- | --- | | [gin.go](https://codecov.io/gh/gin-gonic/gin/pull/3503?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic#diff-Z2luLmdv) | `99.19% <100.00%> (ø)` |  |   Help us with your feedback. Take ten seconds to tell us [how you rate us](https://about.codecov.io/nps?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic). Have a feature suggestion? [Share it here.](https://app.codecov.io/gh/feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) |

All reactions

Sorry, something went wrong.

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
mentioned this pull request
[Feb 17, 2023](#ref-pullrequest-1584590591)

[Add escape logic for header
#3500](/gin-gonic/gin/pull/3500)
 Merged

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
added this to the [v1.9](/gin-gonic/gin/milestone/21) milestone
[Feb 17, 2023](#event-8543580647)

 [![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
requested review from
[appleboy](/appleboy) and
[thinkerou](/thinkerou)
[February 17, 2023 05:10](#event-8543581658)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/bd78de03c2113a94e666f2343dc9ce32995fb908..fd9f98e70fb4107ee68c783482d231d35e60507b)
the
fix-3500-add-escape-logic

branch
from
[`bd78de0`](/gin-gonic/gin/commit/bd78de03c2113a94e666f2343dc9ce32995fb908) to
[`fd9f98e`](/gin-gonic/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b)  [Compare](/gin-gonic/gin/compare/bd78de03c2113a94e666f2343dc9ce32995fb908..fd9f98e70fb4107ee68c783482d231d35e60507b)
[February 17, 2023 05:28](#event-8543679079)

[![t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=60&v=4)](/t0rchwo0d)

### This comment was marked as outdated.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3503)

Sorry, something went wrong.

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/2deb99676571672ad01201049b091b88001c5644..2c2e15f5fedb2ec168513fe9668a7cd215adc34f)
the
fix-3500-add-escape-logic

branch
2 times, most recently
from
[`2deb996`](/gin-gonic/gin/commit/2deb99676571672ad01201049b091b88001c5644) to
[`2c2e15f`](/gin-gonic/gin/commit/2c2e15f5fedb2ec168513fe9668a7cd215adc34f)  [Compare](/gin-gonic/gin/compare/2deb99676571672ad01201049b091b88001c5644..2c2e15f5fedb2ec168513fe9668a7cd215adc34f)
[February 17, 2023 15:15](#event-8548206217)

[![t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=60&v=4)](/t0rchwo0d)

### This comment was marked as outdated.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3503)

Sorry, something went wrong.

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 17, 2023](#issuecomment-1434802197) • edited Loading

| I finished the exception handling that cases I was considering. If `/` is continuous , all of it was not removed, so I added logic with Test case.   * Remove characters outside the allowed range (`alphabets`, `numeric`, `-`, `/`) * Merge Repeated `/` delimiters into one * Add Test Case |
| --- |

All reactions

Sorry, something went wrong.

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/2c2e15f5fedb2ec168513fe9668a7cd215adc34f..6e8f1867b96d28216e09346b868c8c5bf8c656ec)
the
fix-3500-add-escape-logic

branch
from
[`2c2e15f`](/gin-gonic/gin/commit/2c2e15f5fedb2ec168513fe9668a7cd215adc34f) to
[`6e8f186`](/gin-gonic/gin/commit/6e8f1867b96d28216e09346b868c8c5bf8c656ec)  [Compare](/gin-gonic/gin/compare/2c2e15f5fedb2ec168513fe9668a7cd215adc34f..6e8f1867b96d28216e09346b868c8c5bf8c656ec)
[February 17, 2023 15:35](#event-8548383826)

[![appleboy](https://avatars.githubusercontent.com/u/21979?s=60&v=4)](/appleboy)

**[appleboy](/appleboy)**
requested changes
[Feb 18, 2023](#pullrequestreview-1304335919)

 [View reviewed changes](/gin-gonic/gin/pull/3503/files)

[gin.go](/gin-gonic/gin/pull/3503/files#diff-447bee2da23875fead662441fef4b89e1918d4b5f01d1aa3f5d6cdc0cc51a4ac)
Outdated

Show resolved

Hide resolved

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/6e8f1867b96d28216e09346b868c8c5bf8c656ec..6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d)
the
fix-3500-add-escape-logic

branch
from
[`6e8f186`](/gin-gonic/gin/commit/6e8f1867b96d28216e09346b868c8c5bf8c656ec) to
[`6b8cd84`](/gin-gonic/gin/commit/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d)  [Compare](/gin-gonic/gin/compare/6e8f1867b96d28216e09346b868c8c5bf8c656ec..6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d)
[February 18, 2023 02:28](#event-8552154982)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
requested review from
[appleboy](/appleboy)
and removed request for
[thinkerou](/thinkerou)
[February 18, 2023 05:32](#event-8552404955)

[![appleboy](https://avatars.githubusercontent.com/u/21979?s=60&v=4)](/appleboy)

**[appleboy](/appleboy)**
reviewed
[Feb 18, 2023](#pullrequestreview-1304481462)

 [View reviewed changes](/gin-gonic/gin/pull/3503/files)

[gin.go](/gin-gonic/gin/pull/3503/files#diff-447bee2da23875fead662441fef4b89e1918d4b5f01d1aa3f5d6cdc0cc51a4ac)
Outdated

Show resolved

Hide resolved

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d..260f21b8c8bd3fe0bdfaf623564c127a2216291f)
the
fix-3500-add-escape-logic

branch
from
[`6b8cd84`](/gin-gonic/gin/commit/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d) to
[`260f21b`](/gin-gonic/gin/commit/260f21b8c8bd3fe0bdfaf623564c127a2216291f)  [Compare](/gin-gonic/gin/compare/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d..260f21b8c8bd3fe0bdfaf623564c127a2216291f)
[February 18, 2023 06:41](#event-8552485136)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
requested a review
from [appleboy](/appleboy)
[February 18, 2023 06:44](#event-8552489060)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 18, 2023](#issuecomment-1435501135)

| Update - Initialize regular expressions only once and simplify logic |
| --- |

All reactions

Sorry, something went wrong.

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/260f21b8c8bd3fe0bdfaf623564c127a2216291f..0cc8dca255bae16a20f61d0d5ee518e8d7581e6f)
the
fix-3500-add-escape-logic

branch
from
[`260f21b`](/gin-gonic/gin/commit/260f21b8c8bd3fe0bdfaf623564c127a2216291f) to
[`0cc8dca`](/gin-gonic/gin/commit/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f)  [Compare](/gin-gonic/gin/compare/260f21b8c8bd3fe0bdfaf623564c127a2216291f..0cc8dca255bae16a20f61d0d5ee518e8d7581e6f)
[February 18, 2023 06:52](#event-8552497963)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 18, 2023](#issuecomment-1435502359)

| Update - Test Case |
| --- |

All reactions

Sorry, something went wrong.

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&v=4)](/t0rchwo0d)

`[Fix](/gin-gonic/gin/pull/3503/commits/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/gin-gonic/gin/pull/3503/commits/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc "Fix #3500 Add escape logic for header")`

`[69e306f](/gin-gonic/gin/pull/3503/commits/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)`

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f..69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)
the
fix-3500-add-escape-logic

branch
from
[`0cc8dca`](/gin-gonic/gin/commit/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f) to
[`69e306f`](/gin-gonic/gin/commit/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)  [Compare](/gin-gonic/gin/compare/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f..69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)
[February 18, 2023 07:12](#event-8552521551)

 [![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
requested a review
from [thinkerou](/thinkerou)
[February 18, 2023 23:04](#event-8554095389)

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
mentioned this pull request
[Feb 18, 2023](#ref-pullrequest-1589943474)

[fix(security): vulnerability GO-2023-1571
#3505](/gin-gonic/gin/pull/3505)
 Merged

[![thinkerou](https://avatars.githubusercontent.com/u/4488261?s=60&v=4)](/thinkerou)

**[thinkerou](/thinkerou)**
approved these changes
[Feb 19, 2023](#pullrequestreview-1304725360)

 [View reviewed changes](/gin-gonic/gin/pull/3503/files/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)

[![appleboy](https://avatars.githubusercontent.com/u/21979?s=60&v=4)](/appleboy)

**[appleboy](/appleboy)**
approved these changes
[Feb 19, 2023](#pullrequestreview-1304777612)

 [View reviewed changes](/gin-gonic/gin/pull/3503/files/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
merged commit [`4cee78f`](/gin-gonic/gin/commit/4cee78f5382d5245c3652e6c15fee715eec505c3)
into
gin-gonic:master

[Feb 19, 2023](https://github.com/gin-gonic/gin/pull/3503#event-8555231889)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
deleted the
fix-3500-add-escape-logic

branch
[February 19, 2023 13:53](#event-8555270701)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[May 4, 2023](#ref-issue-1695312377)

[x/vulndb: potential Go vuln in github.com/gin-gonic/gin: CVE-2023-26125
golang/vulndb#1755](/golang/vulndb/issues/1755)

Closed

[![@yuri-potatoq](https://avatars.githubusercontent.com/u/47803046?s=40&v=4)](/yuri-potatoq)
[yuri-potatoq](/yuri-potatoq)
mentioned this pull request
[Jun 6, 2023](#ref-pullrequest-1743993311)

[go.mod: update github.com/gin-gonic/gin v1.7.7 to v1.9.1
DataDog/dd-trace-go#2021](/DataDog/dd-trace-go/pull/2021)
 Closed

[![@ksw2000](https://avatars.githubusercontent.com/u/13825170?s=80&u=3c790acf9827088d64f64cda5ac2c2ecc0d17adf&v=4)](/ksw2000)

Copy link

### **[ksw2000](/ksw2000)** commented [Nov 25, 2024](#issuecomment-2498127249)

| I have some questions in `routes_test.go`. Why the expectation of **Line205** is `//path` but not `/path`     [gin/routes\_test.go](https://github.com/gin-gonic/gin/blob/e46bd521859fdfc83c508f1d42c92cb7f91e9fcb/routes_test.go#L205-L211)  Lines 205 to 211 in [e46bd52](/gin-gonic/gin/commit/e46bd521859fdfc83c508f1d42c92cb7f91e9fcb)   |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "api/../../"}) | | --- | --- | |  | assert.Equal(t, "//path", w.Header().Get("Location")) | |  | assert.Equal(t, http.StatusMovedPermanently, w.Code) | |  |  | |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "api/../../../"}) | |  | assert.Equal(t, "/path", w.Header().Get("Location")) | |  | assert.Equal(t, http.StatusMovedPermanently, w.Code) |      Why the expectation of **Line221** is `https/gin-goniccom/https/gin-goniccom/path` but not `https/gin-goniccom/path`     [gin/routes\_test.go](https://github.com/gin-gonic/gin/blob/e46bd521859fdfc83c508f1d42c92cb7f91e9fcb/routes_test.go#L221-L223)  Lines 221 to 223 in [e46bd52](/gin-gonic/gin/commit/e46bd521859fdfc83c508f1d42c92cb7f91e9fcb)   |  | w = PerformRequest(router, http.MethodGet, "/path/", header{Key: "X-Forwarded-Prefix", Value: "https://gin-gonic.com/#"}) | | --- | --- | |  | assert.Equal(t, "https/gin-goniccom/https/gin-goniccom/path", w.Header().Get("Location")) | |  | assert.Equal(t, http.StatusMovedPermanently, w.Code) |      Additionally, is there any difference if the URL prefix returned by .Location() includes a leading slash or does not include one? |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3503)

Reviewers

[![@thinkerou](https://avatars.githubusercontent.com/u/4488261?s=40&v=4)](/thinkerou) [thinkerou](/thinkerou)

thinkerou approved these changes

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&v=4)](/appleboy) [appleboy](/appleboy)

appleboy approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v1.9**](/gin-gonic/gin/milestone/21 "v1.9")

Development

Successfully merging this pull request may close these issues.

4 participants

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=52&v=4)](/t0rchwo0d) [![@ksw2000](https://avatars.githubusercontent.com/u/13825170?s=52&v=4)](/ksw2000) [![@appleboy](https://avatars.githubusercontent.com/u/21979?s=52&v=4)](/appleboy) [![@thinkerou](https://avatars.githubusercontent.com/u/4488261?s=52&v=4)](/thinkerou)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_14dd50ec_20250114_194255.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3500)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3500)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=gin-gonic%2Fgin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gin-gonic](/gin-gonic)
/
**[gin](/gin-gonic/gin)**
Public

* [Notifications](/login?return_to=%2Fgin-gonic%2Fgin) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fgin-gonic%2Fgin)
* [Star
   79.9k](/login?return_to=%2Fgin-gonic%2Fgin)

* [Code](/gin-gonic/gin)
* [Issues
  634](/gin-gonic/gin/issues)
* [Pull requests
  198](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

Additional navigation options

* [Code](/gin-gonic/gin)
* [Issues](/gin-gonic/gin/issues)
* [Pull requests](/gin-gonic/gin/pulls)
* [Actions](/gin-gonic/gin/actions)
* [Security](/gin-gonic/gin/security)
* [Insights](/gin-gonic/gin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgin-gonic%2Fgin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgin-gonic%2Fgin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add escape logic for header #3500

 Merged

[thinkerou](/thinkerou)
merged 1 commit into
[gin-gonic:master](/gin-gonic/gin/tree/master "gin-gonic/gin:master")
from
[t0rchwo0d:add-escape-logic](/t0rchwo0d/gin/tree/add-escape-logic "t0rchwo0d/gin:add-escape-logic")

Feb 17, 2023

 Merged

# [Add escape logic for header](#top) #3500

[thinkerou](/thinkerou)
merged 1 commit into
[gin-gonic:master](/gin-gonic/gin/tree/master "gin-gonic/gin:master")
from
[t0rchwo0d:add-escape-logic](/t0rchwo0d/gin/tree/add-escape-logic "t0rchwo0d/gin:add-escape-logic")

Feb 17, 2023

[Conversation
9](/gin-gonic/gin/pull/3500)
[Commits
1](/gin-gonic/gin/pull/3500/commits)
[Checks
0](/gin-gonic/gin/pull/3500/checks)
[Files changed](/gin-gonic/gin/pull/3500/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=60&v=4)](/t0rchwo0d)

Copy link

Contributor

### @t0rchwo0d **[t0rchwo0d](/t0rchwo0d)** commented [Feb 14, 2023](#issue-1584590591) • edited Loading

# Add escape logic for header

Hi, Team.

I added a `escape logic` to the header reflecting user input values for the following.

I'd appreciate it if you could review it.

## Description

Basically `X-Forwarded-Prefix` is not required for any purpose other than the `/` delimiter. However, unintended execution by crafted request.

`X-Forwarded-Prefix` has a potential problems. Although actively exploiting this flaw is unlikely, Need to prevents abuse in scenarios such as [cache poisoning](https://portswigger.net/web-security/web-cache-poisoning).

## How to reproduce

```
package main

import (
	"net/http"

	"github.com/gin-gonic/gin"
)

func main() {

	r := gin.Default()

	r.GET("/bug", func(c *gin.Context) {
		c.JSON(http.StatusBadRequest, gin.H{"msg": "bug"})
	})

	r.Run()
}
```
## Case 1. Modulate

### Expectations

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: ../../bug#?"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: ../../../bug%2523%253F/bug
Date: Tue, 14 Feb 2023 17:17:42 GMT
Content-Length: 61

HTTP/1.1 404 Not Found
Content-Type: text/plain
Date: Tue, 14 Feb 2023 17:17:42 GMT
Content-Length: 18

404 page not found
```
## Actual result

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: ../../bug#?"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: ../../bug#?//../../bug%23%3F//bug
Date: Tue, 14 Feb 2023 17:10:43 GMT
Content-Length: 68

HTTP/1.1 400 Bad Request
Content-Type: application/json; charset=utf-8
Date: Tue, 14 Feb 2023 17:10:43 GMT
Content-Length: 13

{"msg":"bug"}
```
## Case 2. Redirect

### Expectations

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: https://gin-gonic.com/#"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: https%3A/gin-gonic.com/%23/https%253A/gin-gonic.com/%2523/bug
Date: Tue, 14 Feb 2023 17:16:27 GMT
Content-Length: 96

HTTP/1.1 404 Not Found
Content-Type: text/plain
Date: Tue, 14 Feb 2023 17:16:27 GMT
Content-Length: 18

404 page not found
```
## Actual result

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: https://gin-gonic.com/#"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: https:/gin-gonic.com/#/https:/gin-gonic.com/%23/bug
Date: Tue, 14 Feb 2023 17:13:50 GMT
Content-Length: 86

HTTP/2 200
server: GitHub.com
content-type: text/html; charset=utf-8
last-modified: Fri, 29 Apr 2022 07:17:57 GMT
access-control-allow-origin: *
etag: "626b9125-6605"
expires: Tue, 14 Feb 2023 17:23:50 GMT
cache-control: max-age=600
x-proxy-cache: MISS
x-github-request-id: 77D4:63EE:1951BF:1A6FCE:63EBC14E
accept-ranges: bytes
date: Tue, 14 Feb 2023 17:13:50 GMT
via: 1.1 varnish
age: 0
x-served-by: cache-tyo11949-TYO
x-cache: MISS
x-cache-hits: 0
x-timer: S1676394830.054868,VS0,VE181
vary: Accept-Encoding
x-fastly-request-id: a7775619919d2344b41c5b64e35a19b5f1db36c0
content-length: 26117

# ... skip ...
```
## Case 3. Infinite Loop

### Expectations

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: #bug"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: %23bug/%2523bug/bug
Date: Tue, 14 Feb 2023 17:19:00 GMT
Content-Length: 54

HTTP/1.1 404 Not Found
Content-Type: text/plain
Date: Tue, 14 Feb 2023 17:19:00 GMT
Content-Length: 18

404 page not found
```
## Actual result

```
$ curl -L --path-as-is -i "http://192.168.1.19:8080/bug/" -H "x-forwarded-prefix: #bug"

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: #bug/%23bug/bug
Date: Tue, 14 Feb 2023 17:20:09 GMT
Content-Length: 50

# ... Loop ...

HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: #bug/%23bug/bug
Date: Tue, 14 Feb 2023 17:20:19 GMT
Content-Length: 50

curl: (47) Maximum (50) redirects followed
```
## Environment

* go version: go version go1.19 windows/amd64
* gin version (or commit ref): latest
* operating system: windows

## Reference

* [GHSA-6qq8-5wq3-86rp](https://github.com/advisories/GHSA-6qq8-5wq3-86rp "GHSA-6qq8-5wq3-86rp")
* [GHSA-6vm3-jj99-7229](https://github.com/advisories/GHSA-6vm3-jj99-7229 "GHSA-6vm3-jj99-7229")
* <https://cwe.mitre.org/data/definitions/20.html>
* <https://cwe.mitre.org/data/definitions/601.html>
* <https://cwe.mitre.org/data/definitions/835.html>
* [Add mitigation for log injection #2237](https://github.com/gin-gonic/gin/pull/2237)

Sorry, something went wrong.

All reactions

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Feb 16, 2023](#issuecomment-1432675353) • edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/gin-gonic/gin/pull/3500?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) Report Merging [#3500](https://codecov.io/gh/gin-gonic/gin/pull/3500?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) ([cb5832c](https://github.com/gin-gonic/gin/commit/cb5832c4bacd4b4916e27245089b42b69efbf0f3)) into [master](https://codecov.io/gh/gin-gonic/gin/commit/c1d06e3d08692f9eddde381a5e277b41fff5a297?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) ([c1d06e3](https://github.com/gin-gonic/gin/commit/c1d06e3d08692f9eddde381a5e277b41fff5a297)) will **increase** coverage by `0.00%`. The diff coverage is `100.00%`.  ``` @@           Coverage Diff           @@ ##           master    #3500   +/-   ## =======================================   Coverage   98.63%   98.63%            =======================================   Files          42       42              Lines        3148     3151    +3      ======================================= + Hits         3105     3108    +3        Misses         29       29              Partials       14       14            ```  | Flag | Coverage Δ |  | | --- | --- | --- | |  | `98.63% <100.00%> (+<0.01%)` | ⬆️ | | go-1.16 | `∅ <ø> (∅)` |  | | go-1.17 | `98.54% <100.00%> (+<0.01%)` | ⬆️ | | go-1.18 | `98.54% <100.00%> (+<0.01%)` | ⬆️ | | go-1.19 | `98.63% <100.00%> (+<0.01%)` | ⬆️ | | go-1.20 | `98.63% <100.00%> (+<0.01%)` | ⬆️ | | macos-latest | `98.54% <100.00%> (-0.10%)` | ⬇️ | | ubuntu-latest | `98.63% <100.00%> (+<0.01%)` | ⬆️ |   Flags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic#carryforward-flags-in-the-pull-request-comment) to find out more.   | [Impacted Files](https://codecov.io/gh/gin-gonic/gin/pull/3500?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) | Coverage Δ |  | | --- | --- | --- | | [gin.go](https://codecov.io/gh/gin-gonic/gin/pull/3500?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic#diff-Z2luLmdv) | `99.19% <100.00%> (+<0.01%)` | ⬆️ |   Help us with your feedback. Take ten seconds to tell us [how you rate us](https://about.codecov.io/nps?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic). Have a feature suggestion? [Share it here.](https://app.codecov.io/gh/feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=gin-gonic) |

All reactions

Sorry, something went wrong.

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=80&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)

Copy link

Member

### **[appleboy](/appleboy)** commented [Feb 16, 2023](#issuecomment-1432678268)

| [@t0rchwo0d](https://github.com/t0rchwo0d) testing fail. Please take a look. |
| --- |

 👀
1
 t0rchwo0d reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 16, 2023](#issuecomment-1432816059) • edited Loading

| Hi, [@appleboy](https://github.com/appleboy) Thank you for your review.  Hmm, It's stuck down there. [macos-latest @ Go 1.19 -tags "sonic avx"](https://github.com/gin-gonic/gin/actions/runs/4176619637/jobs/7266803818#logs)  ``` === RUN   TestPathCleanMallocs     path_test.go:85:          	Error Trace:	/Users/runner/work/gin/gin/path_test.go:85         	Error:      	Not equal:          	            	expected: float64(3837)         	            	actual  : int(0)         	Test:       	TestPathCleanMallocs  ```  I think it's related to the following. Looks like probabilistic error occur. [#2596](https://github.com/gin-gonic/gin/pull/2596)  Can you plz start testing again? |
| --- |

All reactions

Sorry, something went wrong.

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/ec759ae9bcf486be5fbcb249a1c870cb5ac753d0..ff49e55d7c2753c30b7bc02d949e6a2fa4f9b70e)
the
add-escape-logic

branch
from
[`ec759ae`](/gin-gonic/gin/commit/ec759ae9bcf486be5fbcb249a1c870cb5ac753d0) to
[`ff49e55`](/gin-gonic/gin/commit/ff49e55d7c2753c30b7bc02d949e6a2fa4f9b70e)  [Compare](/gin-gonic/gin/compare/ec759ae9bcf486be5fbcb249a1c870cb5ac753d0..ff49e55d7c2753c30b7bc02d949e6a2fa4f9b70e)
[February 16, 2023 10:17](#event-8535281201)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 16, 2023](#issuecomment-1432849596)

| Update the same code for build test |
| --- |

All reactions

Sorry, something went wrong.

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 16, 2023](#issuecomment-1432986052)

| [@appleboy](https://github.com/appleboy) Oh, testing passed! I'd appreciate it if you could review it again. |
| --- |

All reactions

Sorry, something went wrong.

[![thinkerou](https://avatars.githubusercontent.com/u/4488261?s=60&v=4)](/thinkerou)

**[thinkerou](/thinkerou)**
reviewed
[Feb 16, 2023](#pullrequestreview-1301351278)

 [View reviewed changes](/gin-gonic/gin/pull/3500/files)

[gin.go](/gin-gonic/gin/pull/3500/files#diff-447bee2da23875fead662441fef4b89e1918d4b5f01d1aa3f5d6cdc0cc51a4ac)

|  |  | @@ -668,6 +669,9 @@ func redirectTrailingSlash(c \*Context) { | |
| --- | --- | --- | --- |
|  |  | req := c.Request |
|  |  | p := req.URL.Path |
|  |  | if prefix := path.Clean(c.Request.Header.Get("X-Forwarded-Prefix")); prefix != "." { |
|  |  | prefix = url.QueryEscape(prefix) |
|  |  | prefix = strings.ReplaceAll(prefix, "%2F", "/") |
|  |  |  |

Copy link

Member

### @thinkerou **[thinkerou](/thinkerou)** [Feb 16, 2023](#discussion_r1108412952)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

please add some unit test cases, thanks!

Sorry, something went wrong.

 👍
1
 t0rchwo0d reacted with thumbs up emoji
 👀
1
 t0rchwo0d reacted with eyes emoji

All reactions

* 👍
  1 reaction
* 👀
  1 reaction

Copy link

Contributor

Author

### @t0rchwo0d **[t0rchwo0d](/t0rchwo0d)** [Feb 16, 2023](#discussion_r1108492925)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi, [@thinkerou](https://github.com/thinkerou)

Thank you for your review!

I update "routes\_test.go", Plz check again : )

Sorry, something went wrong.

All reactions

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/da8520c19dd45a27ddc5db8c01506f134dc49f29..d1f3e5fa55e24cde20f2a4551823222dc8b739d6)
the
add-escape-logic

branch
2 times, most recently
from
[`da8520c`](/gin-gonic/gin/commit/da8520c19dd45a27ddc5db8c01506f134dc49f29) to
[`d1f3e5f`](/gin-gonic/gin/commit/d1f3e5fa55e24cde20f2a4551823222dc8b739d6)  [Compare](/gin-gonic/gin/compare/da8520c19dd45a27ddc5db8c01506f134dc49f29..d1f3e5fa55e24cde20f2a4551823222dc8b739d6)
[February 16, 2023 13:38](#event-8537012671)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&v=4)](/t0rchwo0d)

`[Add escape logic for header](/gin-gonic/gin/pull/3500/commits/cb5832c4bacd4b4916e27245089b42b69efbf0f3 "Add escape logic for header")`

`[cb5832c](/gin-gonic/gin/pull/3500/commits/cb5832c4bacd4b4916e27245089b42b69efbf0f3)`

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
[force-pushed](/gin-gonic/gin/compare/d1f3e5fa55e24cde20f2a4551823222dc8b739d6..cb5832c4bacd4b4916e27245089b42b69efbf0f3)
the
add-escape-logic

branch
from
[`d1f3e5f`](/gin-gonic/gin/commit/d1f3e5fa55e24cde20f2a4551823222dc8b739d6) to
[`cb5832c`](/gin-gonic/gin/commit/cb5832c4bacd4b4916e27245089b42b69efbf0f3)  [Compare](/gin-gonic/gin/compare/d1f3e5fa55e24cde20f2a4551823222dc8b739d6..cb5832c4bacd4b4916e27245089b42b69efbf0f3)
[February 16, 2023 13:41](#event-8537040722)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 16, 2023](#issuecomment-1433109930)

| update "routes\_test.go |
| --- |

All reactions

Sorry, something went wrong.

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
added this to the [v1.9](/gin-gonic/gin/milestone/21) milestone
[Feb 16, 2023](#event-8541674176)

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
added
the
[bug](/gin-gonic/gin/labels/bug)
label
[Feb 16, 2023](#event-8541674687)

 [![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&u=87d99e0ab35eb5d4c0ae898121878a4a9311d0cc&v=4)](/appleboy)
[appleboy](/appleboy)
requested review from
[appleboy](/appleboy) and
[thinkerou](/thinkerou)
[February 16, 2023 22:17](#event-8541675329)

[![appleboy](https://avatars.githubusercontent.com/u/21979?s=60&v=4)](/appleboy)

**[appleboy](/appleboy)**
approved these changes
[Feb 16, 2023](#pullrequestreview-1302371109)

 [View reviewed changes](/gin-gonic/gin/pull/3500/files/cb5832c4bacd4b4916e27245089b42b69efbf0f3)

[![thinkerou](https://avatars.githubusercontent.com/u/4488261?s=60&v=4)](/thinkerou)

**[thinkerou](/thinkerou)**
approved these changes
[Feb 17, 2023](#pullrequestreview-1302599741)

 [View reviewed changes](/gin-gonic/gin/pull/3500/files/cb5832c4bacd4b4916e27245089b42b69efbf0f3)

[![@thinkerou](https://avatars.githubusercontent.com/u/4488261?s=40&u=d7e34ddc55992dda7ff282f0d59e92c4dde5f3dd&v=4)](/thinkerou)
[thinkerou](/thinkerou)
merged commit [`81ac7d5`](/gin-gonic/gin/commit/81ac7d55a09e34013225db0aeac6e70c1ae68928)
into
gin-gonic:master

[Feb 17, 2023](https://github.com/gin-gonic/gin/pull/3500#event-8542829655)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
deleted the
add-escape-logic

branch
[February 17, 2023 02:07](#event-8542862293)

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
restored the
add-escape-logic

branch
[February 17, 2023 03:02](#event-8543071472)

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-c2c6952)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Revert "Add escape logic for header (](/t0rchwo0d/gin/commit/c2c69525c13741dcec582dc52f7ef59b1721859d "Revert \"Add escape logic for header (#3500)\"

This reverts commit 81ac7d55a09e34013225db0aeac6e70c1ae68928.")[gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500)[)"](/t0rchwo0d/gin/commit/c2c69525c13741dcec582dc52f7ef59b1721859d "Revert \"Add escape logic for header (#3500)\"

This reverts commit 81ac7d55a09e34013225db0aeac6e70c1ae68928.")`
…

`[c2c6952](/t0rchwo0d/gin/commit/c2c69525c13741dcec582dc52f7ef59b1721859d)`

```
This reverts commit [81ac7d5](https://github.com/t0rchwo0d/gin/commit/81ac7d55a09e34013225db0aeac6e70c1ae68928).
```

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-c22614f)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/c22614fad926e7737c7d75dc4e71a0988caddbd2 "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/c22614fad926e7737c7d75dc4e71a0988caddbd2 "Fix #3500 Add escape logic for header")`

`[c22614f](/t0rchwo0d/gin/commit/c22614fad926e7737c7d75dc4e71a0988caddbd2)`

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
mentioned this pull request
[Feb 17, 2023](#ref-pullrequest-1588710641)

[Fix #3500 Add escape logic for header
#3503](/gin-gonic/gin/pull/3503)
 Merged

3 tasks

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-bd78de0)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/bd78de03c2113a94e666f2343dc9ce32995fb908 "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/bd78de03c2113a94e666f2343dc9ce32995fb908 "Fix #3500 Add escape logic for header")`

`[bd78de0](/t0rchwo0d/gin/commit/bd78de03c2113a94e666f2343dc9ce32995fb908)`

 [![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)
[t0rchwo0d](/t0rchwo0d)
deleted the
add-escape-logic

branch
[February 17, 2023 03:57](#event-8543263687)

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=80&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

Copy link

Contributor

Author

### **[t0rchwo0d](/t0rchwo0d)** commented [Feb 17, 2023](#issuecomment-1434062828)

| Hi, [@appleboy](https://github.com/appleboy), [@thinkerou](https://github.com/thinkerou)  Sorry, There was a lack of additional filter consideration. So, I have opened the following. [#3503](https://github.com/gin-gonic/gin/pull/3503) |
| --- |

All reactions

Sorry, something went wrong.

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-fd9f98e)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b "Fix #3500 Add escape logic for header")`

`[fd9f98e](/t0rchwo0d/gin/commit/fd9f98e70fb4107ee68c783482d231d35e60507b)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-2deb996)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/2deb99676571672ad01201049b091b88001c5644 "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/2deb99676571672ad01201049b091b88001c5644 "Fix #3500 Add escape logic for header")`

`[2deb996](/t0rchwo0d/gin/commit/2deb99676571672ad01201049b091b88001c5644)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-2c2e15f)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/2c2e15f5fedb2ec168513fe9668a7cd215adc34f "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/2c2e15f5fedb2ec168513fe9668a7cd215adc34f "Fix #3500 Add escape logic for header")`

`[2c2e15f](/t0rchwo0d/gin/commit/2c2e15f5fedb2ec168513fe9668a7cd215adc34f)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 17, 2023](#ref-commit-6e8f186)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/6e8f1867b96d28216e09346b868c8c5bf8c656ec "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/6e8f1867b96d28216e09346b868c8c5bf8c656ec "Fix #3500 Add escape logic for header")`

`[6e8f186](/t0rchwo0d/gin/commit/6e8f1867b96d28216e09346b868c8c5bf8c656ec)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 18, 2023](#ref-commit-6b8cd84)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d "Fix #3500 Add escape logic for header")`

`[6b8cd84](/t0rchwo0d/gin/commit/6b8cd84e5eed9f414d66f2c267b921bef5ff4f1d)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 18, 2023](#ref-commit-260f21b)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/260f21b8c8bd3fe0bdfaf623564c127a2216291f "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/260f21b8c8bd3fe0bdfaf623564c127a2216291f "Fix #3500 Add escape logic for header")`

`[260f21b](/t0rchwo0d/gin/commit/260f21b8c8bd3fe0bdfaf623564c127a2216291f)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 18, 2023](#ref-commit-0cc8dca)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f "Fix #3500 Add escape logic for header")`

`[0cc8dca](/t0rchwo0d/gin/commit/0cc8dca255bae16a20f61d0d5ee518e8d7581e6f)`

[t0rchwo0d](/t0rchwo0d)
added a commit
to t0rchwo0d/gin
that referenced
this pull request
[Feb 18, 2023](#ref-commit-69e306f)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/t0rchwo0d/gin/commit/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc "Fix #3500 Add escape logic for header") [gin-gonic#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header](/t0rchwo0d/gin/commit/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc "Fix #3500 Add escape logic for header")`

`[69e306f](/t0rchwo0d/gin/commit/69e306f7e2dd2dc3fadfd83ef97e43bcf070c4bc)`

[appleboy](/appleboy)
pushed a commit
that referenced
this pull request
[Feb 19, 2023](#ref-commit-4cee78f)
[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=40&u=f72191472e379eef88d7d2596d656182a159f90e&v=4)](/t0rchwo0d)

`[Fix](/gin-gonic/gin/commit/4cee78f5382d5245c3652e6c15fee715eec505c3 "Fix #3500 Add escape logic for header (#3503)") [#3500](https://github.com/gin-gonic/gin/pull/3500) [Add escape logic for header (](/gin-gonic/gin/commit/4cee78f5382d5245c3652e6c15fee715eec505c3 "Fix #3500 Add escape logic for header (#3503)")[#3503](https://github.com/gin-gonic/gin/pull/3503)[)](/gin-gonic/gin/commit/4cee78f5382d5245c3652e6c15fee715eec505c3 "Fix #3500 Add escape logic for header (#3503)")`

`[4cee78f](/gin-gonic/gin/commit/4cee78f5382d5245c3652e6c15fee715eec505c3)`

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[May 4, 2023](#ref-issue-1695312377)

[x/vulndb: potential Go vuln in github.com/gin-gonic/gin: CVE-2023-26125
golang/vulndb#1755](/golang/vulndb/issues/1755)

Closed

[![@archfish](https://avatars.githubusercontent.com/u/5317064?s=40&v=4)](/archfish)
[archfish](/archfish)
mentioned this pull request
[May 18, 2023](#ref-issue-1643730295)

[gin 1.7.4 has redirect issue
#3552](/gin-gonic/gin/issues/3552)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgin-gonic%2Fgin%2Fpull%2F3500)

Reviewers

[![@thinkerou](https://avatars.githubusercontent.com/u/4488261?s=40&v=4)](/thinkerou) [thinkerou](/thinkerou)

thinkerou approved these changes

[![@appleboy](https://avatars.githubusercontent.com/u/21979?s=40&v=4)](/appleboy) [appleboy](/appleboy)

appleboy approved these changes

Assignees

No one assigned

Labels

[bug](/gin-gonic/gin/labels/bug)

Projects

None yet

Milestone

 [**v1.9**](/gin-gonic/gin/milestone/21 "v1.9")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@t0rchwo0d](https://avatars.githubusercontent.com/u/20869527?s=52&v=4)](/t0rchwo0d) [![@appleboy](https://avatars.githubusercontent.com/u/21979?s=52&v=4)](/appleboy) [![@thinkerou](https://avatars.githubusercontent.com/u/4488261?s=52&v=4)](/thinkerou)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


