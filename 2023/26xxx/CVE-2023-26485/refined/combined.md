=== Content from github.com_9826e914_20250115_093306.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgithub%2Fcmark-gfm%2Fcommit%2F07a66c9bc341f902878e37d7da8647d6ef150987)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgithub%2Fcmark-gfm%2Fcommit%2F07a66c9bc341f902878e37d7da8647d6ef150987)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=github%2Fcmark-gfm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[github](/github)
/
**[cmark-gfm](/github/cmark-gfm)**
Public

forked from [commonmark/cmark](/commonmark/cmark)

* [Notifications](/login?return_to=%2Fgithub%2Fcmark-gfm) You must be signed in to change notification settings
* [Fork
  176](/login?return_to=%2Fgithub%2Fcmark-gfm)
* [Star
   920](/login?return_to=%2Fgithub%2Fcmark-gfm)

* [Code](/github/cmark-gfm)
* [Issues
  103](/github/cmark-gfm/issues)
* [Pull requests
  18](/github/cmark-gfm/pulls)
* [Actions](/github/cmark-gfm/actions)
* [Security](/github/cmark-gfm/security)
* [Insights](/github/cmark-gfm/pulse)

Additional navigation options

* [Code](/github/cmark-gfm)
* [Issues](/github/cmark-gfm/issues)
* [Pull requests](/github/cmark-gfm/pulls)
* [Actions](/github/cmark-gfm/actions)
* [Security](/github/cmark-gfm/security)
* [Insights](/github/cmark-gfm/pulse)

## Commit

[Permalink](/github/cmark-gfm/commit/07a66c9bc341f902878e37d7da8647d6ef150987)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-r8vr-c48j-fcc5](https://github.com/github/cmark-gfm/security/advisories/GHSA-r8vr-c48j-fcc5 "GHSA-r8vr-c48j-fcc5")

[Browse files](/github/cmark-gfm/tree/07a66c9bc341f902878e37d7da8647d6ef150987)
Browse the repository at this point in the history

```
Fix quadratic behavior in rendering
```

* Loading branch information

[![@anticomputer](https://avatars.githubusercontent.com/u/13686387?s=40&v=4)](/anticomputer)

[anticomputer](/github/cmark-gfm/commits?author=anticomputer "View all commits by anticomputer")
authored
Mar 31, 2023

2 parents
[2300c1b](/github/cmark-gfm/commit/2300c1bd2c8226108885bf019655c4159cf26b59)
+
[bd4f96e](/github/cmark-gfm/commit/bd4f96e7fd06ce8cb61e6f4ba41972d2a8b91d24)

commit 07a66c9

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**80 additions**
and
**100 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/commonmark.c
    [commonmark.c](#diff-8a84f48458df6eb6274fc1f0eb3c58d7c8e295ed0873323f99b9567202acc392)
  + src/html.c
    [html.c](#diff-f801b405afaabf45c4def541082f2afa4140f36d620ddb6d0bf3c555445f353b)
  + src/latex.c
    [latex.c](#diff-4bffa0085f99b82f0166840a995e06c149eeaaf797e7c31dbd374d1a224a733e)
  + src/man.c
    [man.c](#diff-c81b401c4395aef34c5e3210e7ebab02710fcec97a9c55f8ec627ce857a5915c)
  + src/node.h
    [node.h](#diff-7c19dd5fd5584cd4a8111f4c82a9f49f4aa1bdb9470ad11daa90f3d394a23b4e)
  + src/plaintext.c
    [plaintext.c](#diff-3a0104e2f6c6ca374686de79aafb62f1f4b509adcf18cc6ee89aa9e776855978)
  + src/render.c
    [render.c](#diff-2d4534614d8fddc6fa5aa4a49a27a5112bd7116cd648fd3ede43193490279418)
  + src/render.h
    [render.h](#diff-995f5ae9cdef8eb163afc18d04ea1d6b96dd980257d82f5d778edbf1008f0932)
  + src/xml.c
    [xml.c](#diff-4757d5a71ae57a8335ff3356a37eda9cb9b391f8e234370c2b72677c40b11819)
* test

  + test/spec.txt
    [spec.txt](#diff-7edf444b4b80a31979539f070d7bd92766928df704f69209e8f47fec1713698e)

## There are no files selected for viewing

52 changes: 19 additions & 33 deletions

52
[src/commonmark.c](#diff-8a84f48458df6eb6274fc1f0eb3c58d7c8e295ed0873323f99b9567202acc392 "src/commonmark.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/commonmark.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -153,23 +153,8 @@ static bool is\_autolink(cmark\_node \*node) { |
|  |  | link\_text->as.literal.len) == 0); |
|  |  | } |
|  |  |  |
|  |  | // if node is a block node, returns node. |
|  |  | // otherwise returns first block-level node that is an ancestor of node. |
|  |  | // if there is no block-level ancestor, returns NULL. |
|  |  | static cmark\_node \*get\_containing\_block(cmark\_node \*node) { |
|  |  | while (node) { |
|  |  | if (CMARK\_NODE\_BLOCK\_P(node)) { |
|  |  | return node; |
|  |  | } else { |
|  |  | node = node->parent; |
|  |  | } |
|  |  | } |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | cmark\_event\_type ev\_type, int options) { |
|  |  | cmark\_node \*tmp; |
|  |  | int list\_number; |
|  |  | cmark\_delim\_type list\_delim; |
|  |  | int numticks; |
| Expand All | | @@ -189,14 +174,17 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | // Don't adjust tight list status til we've started the list. |
|  |  | // Otherwise we loose the blank line between a paragraph and |
|  |  | // a following list. |
|  |  | if (!(node->type == CMARK\_NODE\_ITEM && node->prev == NULL && entering)) { |
|  |  | tmp = get\_containing\_block(node); |
|  |  | renderer->in\_tight\_list\_item = |
|  |  | tmp && // tmp might be NULL if there is no containing block |
|  |  | ((tmp->type == CMARK\_NODE\_ITEM && |
|  |  | cmark\_node\_get\_list\_tight(tmp->parent)) || |
|  |  | (tmp && tmp->parent && tmp->parent->type == CMARK\_NODE\_ITEM && |
|  |  | cmark\_node\_get\_list\_tight(tmp->parent->parent))); |
|  |  | if (entering) { |
|  |  | if (node->parent && node->parent->type == CMARK\_NODE\_ITEM) { |
|  |  | renderer->in\_tight\_list\_item = node->parent->parent->as.list.tight; |
|  |  | } |
|  |  | } else { |
|  |  | if (node->type == CMARK\_NODE\_LIST) { |
|  |  | renderer->in\_tight\_list\_item = |
|  |  | node->parent && |
|  |  | node->parent->type == CMARK\_NODE\_ITEM && |
|  |  | node->parent->parent->as.list.tight; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (node->extension && node->extension->commonmark\_render\_func) { |
| Expand Down  Expand Up | | @@ -228,19 +216,15 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | LIT("<!-- end list -->"); |
|  |  | BLANKLINE(); |
|  |  | } |
|  |  | renderer->list\_number = cmark\_node\_get\_list\_start(node); |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_ITEM: |
|  |  | if (cmark\_node\_get\_list\_type(node->parent) == CMARK\_BULLET\_LIST) { |
|  |  | marker\_width = 4; |
|  |  | } else { |
|  |  | list\_number = cmark\_node\_get\_list\_start(node->parent); |
|  |  | list\_number = renderer->list\_number++; |
|  |  | list\_delim = cmark\_node\_get\_list\_delim(node->parent); |
|  |  | tmp = node; |
|  |  | while (tmp->prev) { |
|  |  | tmp = tmp->prev; |
|  |  | list\_number += 1; |
|  |  | } |
|  |  | // we ensure a width of at least 4 so |
|  |  | // we get nice transition from single digits |
|  |  | // to double |
| Expand Down  Expand Up | | @@ -405,10 +389,12 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_STRONG: |
|  |  | if (entering) { |
|  |  | LIT("\*\*"); |
|  |  | } else { |
|  |  | LIT("\*\*"); |
|  |  | if (node->parent == NULL || node->parent->type != CMARK\_NODE\_STRONG) { |
|  |  | if (entering) { |
|  |  | LIT("\*\*"); |
|  |  | } else { |
|  |  | LIT("\*\*"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  |  |
| Expand Down | |  |

10 changes: 6 additions & 4 deletions

10
[src/html.c](#diff-f801b405afaabf45c4def541082f2afa4140f36d620ddb6d0bf3c555445f353b "src/html.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/html.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -364,10 +364,12 @@ static int S\_render\_node(cmark\_html\_renderer \*renderer, cmark\_node \*node, |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_STRONG: |
|  |  | if (entering) { |
|  |  | cmark\_strbuf\_puts(html, "<strong>"); |
|  |  | } else { |
|  |  | cmark\_strbuf\_puts(html, "</strong>"); |
|  |  | if (node->parent == NULL || node->parent->type != CMARK\_NODE\_STRONG) { |
|  |  | if (entering) { |
|  |  | cmark\_strbuf\_puts(html, "<strong>"); |
|  |  | } else { |
|  |  | cmark\_strbuf\_puts(html, "</strong>"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  |  |
| Expand Down | |  |

10 changes: 6 additions & 4 deletions

10
[src/latex.c](#diff-4bffa0085f99b82f0166840a995e06c149eeaaf797e7c31dbd374d1a224a733e "src/latex.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/latex.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -385,10 +385,12 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_STRONG: |
|  |  | if (entering) { |
|  |  | LIT("\\textbf{"); |
|  |  | } else { |
|  |  | LIT("}"); |
|  |  | if (node->parent == NULL || node->parent->type != CMARK\_NODE\_STRONG) { |
|  |  | if (entering) { |
|  |  | LIT("\\textbf{"); |
|  |  | } else { |
|  |  | LIT("}"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  |  |
| Expand Down | |  |

19 changes: 8 additions & 11 deletions

19
[src/man.c](#diff-c81b401c4395aef34c5e3210e7ebab02710fcec97a9c55f8ec627ce857a5915c "src/man.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/man.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -74,7 +74,6 @@ static void S\_outc(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  |  |
|  |  | static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | cmark\_event\_type ev\_type, int options) { |
|  |  | cmark\_node \*tmp; |
|  |  | int list\_number; |
|  |  | bool entering = (ev\_type == CMARK\_EVENT\_ENTER); |
|  |  | bool allow\_wrap = renderer->width > 0 && !(CMARK\_OPT\_NOBREAKS & options); |
| Expand Down  Expand Up | | @@ -114,6 +113,7 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_LIST: |
|  |  | renderer->list\_number = cmark\_node\_get\_list\_start(node); |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_ITEM: |
| Expand All | | @@ -123,12 +123,7 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | if (cmark\_node\_get\_list\_type(node->parent) == CMARK\_BULLET\_LIST) { |
|  |  | LIT("\\[bu] 2"); |
|  |  | } else { |
|  |  | list\_number = cmark\_node\_get\_list\_start(node->parent); |
|  |  | tmp = node; |
|  |  | while (tmp->prev) { |
|  |  | tmp = tmp->prev; |
|  |  | list\_number += 1; |
|  |  | } |
|  |  | list\_number = renderer->list\_number++; |
|  |  | char list\_number\_s[LIST\_NUMBER\_SIZE]; |
|  |  | snprintf(list\_number\_s, LIST\_NUMBER\_SIZE, "\"%d.\" 4", list\_number); |
|  |  | LIT(list\_number\_s); |
| Expand Down  Expand Up | | @@ -225,10 +220,12 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_STRONG: |
|  |  | if (entering) { |
|  |  | LIT("\\f[B]"); |
|  |  | } else { |
|  |  | LIT("\\f[]"); |
|  |  | if (node->parent == NULL || node->parent->type != CMARK\_NODE\_STRONG) { |
|  |  | if (entering) { |
|  |  | LIT("\\f[B]"); |
|  |  | } else { |
|  |  | LIT("\\f[]"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  |  |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[src/node.h](#diff-7c19dd5fd5584cd4a8111f4c82a9f49f4aa1bdb9470ad11daa90f3d394a23b4e "src/node.h")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/node.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,6 +83,14 @@ struct cmark\_node { |
|  |  |  |
|  |  | cmark\_syntax\_extension \*extension; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Used during cmark\_render() to cache the most recent non-NULL |
|  |  | \* extension, if you go up the parent chain like this: |
|  |  | \* |
|  |  | \* node->parent->...parent->extension |
|  |  | \*/ |
|  |  | cmark\_syntax\_extension \*ancestor\_extension; |
|  |  |  |
|  |  | union { |
|  |  | int ref\_ix; |
|  |  | int def\_count; |
| Expand Down | |  |

42 changes: 13 additions & 29 deletions

42
[src/plaintext.c](#diff-3a0104e2f6c6ca374686de79aafb62f1f4b509adcf18cc6ee89aa9e776855978 "src/plaintext.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/plaintext.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,23 +16,8 @@ static CMARK\_INLINE void outc(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | cmark\_render\_code\_point(renderer, c); |
|  |  | } |
|  |  |  |
|  |  | // if node is a block node, returns node. |
|  |  | // otherwise returns first block-level node that is an ancestor of node. |
|  |  | // if there is no block-level ancestor, returns NULL. |
|  |  | static cmark\_node \*get\_containing\_block(cmark\_node \*node) { |
|  |  | while (node) { |
|  |  | if (CMARK\_NODE\_BLOCK\_P(node)) { |
|  |  | return node; |
|  |  | } else { |
|  |  | node = node->parent; |
|  |  | } |
|  |  | } |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | cmark\_event\_type ev\_type, int options) { |
|  |  | cmark\_node \*tmp; |
|  |  | int list\_number; |
|  |  | cmark\_delim\_type list\_delim; |
|  |  | int i; |
| Expand All | | @@ -46,14 +31,17 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | // Don't adjust tight list status til we've started the list. |
|  |  | // Otherwise we loose the blank line between a paragraph and |
|  |  | // a following list. |
|  |  | if (!(node->type == CMARK\_NODE\_ITEM && node->prev == NULL && entering)) { |
|  |  | tmp = get\_containing\_block(node); |
|  |  | renderer->in\_tight\_list\_item = |
|  |  | tmp && // tmp might be NULL if there is no containing block |
|  |  | ((tmp->type == CMARK\_NODE\_ITEM && |
|  |  | cmark\_node\_get\_list\_tight(tmp->parent)) || |
|  |  | (tmp && tmp->parent && tmp->parent->type == CMARK\_NODE\_ITEM && |
|  |  | cmark\_node\_get\_list\_tight(tmp->parent->parent))); |
|  |  | if (entering) { |
|  |  | if (node->parent && node->parent->type == CMARK\_NODE\_ITEM) { |
|  |  | renderer->in\_tight\_list\_item = node->parent->parent->as.list.tight; |
|  |  | } |
|  |  | } else { |
|  |  | if (node->type == CMARK\_NODE\_LIST) { |
|  |  | renderer->in\_tight\_list\_item = |
|  |  | node->parent && |
|  |  | node->parent->type == CMARK\_NODE\_ITEM && |
|  |  | node->parent->parent->as.list.tight; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (node->extension && node->extension->plaintext\_render\_func) { |
| Expand All | | @@ -73,19 +61,15 @@ static int S\_render\_node(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | node->next->type == CMARK\_NODE\_LIST)) { |
|  |  | CR(); |
|  |  | } |
|  |  | renderer->list\_number = cmark\_node\_get\_list\_start(node); |
|  |  | break; |
|  |  |  |
|  |  | case CMARK\_NODE\_ITEM: |
|  |  | if (cmark\_node\_get\_list\_type(node->parent) == CMARK\_BULLET\_LIST) { |
|  |  | marker\_width = 4; |
|  |  | } else { |
|  |  | list\_number = cmark\_node\_get\_list\_start(node->parent); |
|  |  | list\_number = renderer->list\_number++; |
|  |  | list\_delim = cmark\_node\_get\_list\_delim(node->parent); |
|  |  | tmp = node; |
|  |  | while (tmp->prev) { |
|  |  | tmp = tmp->prev; |
|  |  | list\_number += 1; |
|  |  | } |
|  |  | // we ensure a width of at least 4 so |
|  |  | // we get nice transition from single digits |
|  |  | // to double |
| Expand Down | |  |

17 changes: 8 additions & 9 deletions

17
[src/render.c](#diff-2d4534614d8fddc6fa5aa4a49a27a5112bd7116cd648fd3ede43193490279418 "src/render.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/render.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,13 +31,7 @@ static void S\_out(cmark\_renderer \*renderer, cmark\_node \*node, |
|  |  | cmark\_chunk remainder = cmark\_chunk\_literal(""); |
|  |  | int k = renderer->buffer->size - 1; |
|  |  |  |
|  |  | cmark\_syntax\_extension \*ext = NULL; |
|  |  | cmark\_node \*n = node; |
|  |  | while (n && !ext) { |
|  |  | ext = n->extension; |
|  |  | if (!ext) |
|  |  | n = n->parent; |
|  |  | } |
|  |  | cmark\_syntax\_extension \*ext = node->ancestor\_extension; |
|  |  | if (ext && !ext->commonmark\_escape\_func) |
|  |  | ext = NULL; |
|  |  |  |
| Expand Down  Expand Up | | @@ -177,11 +171,16 @@ char \*cmark\_render(cmark\_mem \*mem, cmark\_node \*root, int options, int width, |
|  |  |  |
|  |  | cmark\_renderer renderer = {mem, &buf, &pref, 0, width, |
|  |  | 0, 0, true, true, false, |
|  |  | false, outc, S\_cr, S\_blankline, S\_out, |
|  |  | 0}; |
|  |  | false, 0, outc,  S\_cr,  S\_blankline, |
|  |  | S\_out, 0}; |
|  |  |  |
|  |  | while ((ev\_type = cmark\_iter\_next(iter)) != CMARK\_EVENT\_DONE) { |
|  |  | cur = cmark\_iter\_get\_node(iter); |
|  |  | if (cur->extension) { |
|  |  | cur->ancestor\_extension = cur->extension; |
|  |  | } else if (cur->parent) { |
|  |  | cur->ancestor\_extension = cur->parent->ancestor\_extension; |
|  |  | } |
|  |  | if (!render\_node(&renderer, cur, ev\_type, options)) { |
|  |  | // a false value causes us to skip processing |
|  |  | // the node's contents. this is used for |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/render.h](#diff-995f5ae9cdef8eb163afc18d04ea1d6b96dd980257d82f5d778edbf1008f0932 "src/render.h")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/render.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,7 @@ struct cmark\_renderer { |
|  |  | bool begin\_content; |
|  |  | bool no\_linebreaks; |
|  |  | bool in\_tight\_list\_item; |
|  |  | int list\_number; |
|  |  | void (\*outc)(struct cmark\_renderer \*, cmark\_node \*, cmark\_escaping, int32\_t, unsigned char); |
|  |  | void (\*cr)(struct cmark\_renderer \*); |
|  |  | void (\*blankline)(struct cmark\_renderer \*); |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/xml.c](#diff-4757d5a71ae57a8335ff3356a37eda9cb9b391f8e234370c2b72677c40b11819 "src/xml.c")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/src/xml.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,6 +11,7 @@ |
|  |  | #include "syntax\_extension.h" |
|  |  |  |
|  |  | #define BUFFER\_SIZE 100 |
|  |  | #define MAX\_INDENT 40 |
|  |  |  |
|  |  | // Functions to convert cmark\_nodes to XML strings. |
|  |  |  |
| Expand All | | @@ -26,7 +27,7 @@ struct render\_state { |
|  |  |  |
|  |  | static CMARK\_INLINE void indent(struct render\_state \*state) { |
|  |  | int i; |
|  |  | for (i = 0; i < state->indent; i++) { |
|  |  | for (i = 0; i < state->indent && i < MAX\_INDENT; i++) { |
|  |  | cmark\_strbuf\_putc(state->xml, ' '); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

18 changes: 9 additions & 9 deletions

18
[test/spec.txt](#diff-7edf444b4b80a31979539f070d7bd92766928df704f69209e8f47fec1713698e "test/spec.txt")

Show comments

[View file](/github/cmark-gfm/blob/07a66c9bc341f902878e37d7da8647d6ef150987/test/spec.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -6926,7 +6926,7 @@ foo\_\_bar\_\_ |
|  |  | ```````````````````````````````` example |
|  |  | \_\_foo, \_\_bar\_\_, baz\_\_ |
|  |  | . |
|  |  | <p><strong>foo, <strong>bar</strong>, baz</strong></p> |
|  |  | <p><strong>foo, bar, baz</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -7197,7 +7197,7 @@ foo\*\*\*bar\*\*\*baz |
|  |  | ```````````````````````````````` example |
|  |  | foo\*\*\*\*\*\*bar\*\*\*\*\*\*\*\*\*baz |
|  |  | . |
|  |  | <p>foo<strong><strong><strong>bar</strong></strong></strong>\*\*\*baz</p> |
|  |  | <p>foo<strong>bar</strong>\*\*\*baz</p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -7268,21 +7268,21 @@ \_\_foo \_bar\_ baz\_\_ |
|  |  | ```````````````````````````````` example |
|  |  | \_\_foo \_\_bar\_\_ baz\_\_ |
|  |  | . |
|  |  | <p><strong>foo <strong>bar</strong> baz</strong></p> |
|  |  | <p><strong>foo bar baz</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
|  |  | ```````````````````````````````` example |
|  |  | \_\_\_\_foo\_\_ bar\_\_ |
|  |  | . |
|  |  | <p><strong><strong>foo</strong> bar</strong></p> |
|  |  | <p><strong>foo bar</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
|  |  | ```````````````````````````````` example |
|  |  | \*\*foo \*\*bar\*\*\*\* |
|  |  | . |
|  |  | <p><strong>foo <strong>bar</strong></strong></p> |
|  |  | <p><strong>foo bar</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -7567,14 +7567,14 @@ switching delimiters: |
|  |  | ```````````````````````````````` example |
|  |  | \*\*\*\*foo\*\*\*\* |
|  |  | . |
|  |  | <p><strong><strong>foo</strong></strong></p> |
|  |  | <p><strong>foo</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
|  |  | ```````````````````````````````` example |
|  |  | \_\_\_\_foo\_\_\_\_ |
|  |  | . |
|  |  | <p><strong><strong>foo</strong></strong></p> |
|  |  | <p><strong>foo</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand All | | @@ -7585,7 +7585,7 @@ delimiters: |
|  |  | ```````````````````````````````` example |
|  |  | \*\*\*\*\*\*foo\*\*\*\*\*\* |
|  |  | . |
|  |  | <p><strong><strong><strong>foo</strong></strong></strong></p> |
|  |  | <p><strong>foo</strong></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand All | | @@ -7601,7 +7601,7 @@ Rule 14: |
|  |  | ```````````````````````````````` example |
|  |  | \_\_\_\_\_foo\_\_\_\_\_ |
|  |  | . |
|  |  | <p><em><strong><strong>foo</strong></strong></em></p> |
|  |  | <p><em><strong>foo</strong></em></p> |
|  |  | ```````````````````````````````` |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `07a66c9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgithub%2Fcmark-gfm%2Fcommit%2F07a66c9bc341f902878e37d7da8647d6ef150987) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c5ea16ed_20250115_093307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgithub%2Fcmark-gfm%2Fsecurity%2Fadvisories%2FGHSA-r8vr-c48j-fcc5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgithub%2Fcmark-gfm%2Fsecurity%2Fadvisories%2FGHSA-r8vr-c48j-fcc5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=github%2Fcmark-gfm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[github](/github)
/
**[cmark-gfm](/github/cmark-gfm)**
Public

forked from [commonmark/cmark](/commonmark/cmark)

* [Notifications](/login?return_to=%2Fgithub%2Fcmark-gfm) You must be signed in to change notification settings
* [Fork
  176](/login?return_to=%2Fgithub%2Fcmark-gfm)
* [Star
   920](/login?return_to=%2Fgithub%2Fcmark-gfm)

* [Code](/github/cmark-gfm)
* [Issues
  103](/github/cmark-gfm/issues)
* [Pull requests
  18](/github/cmark-gfm/pulls)
* [Actions](/github/cmark-gfm/actions)
* [Security](/github/cmark-gfm/security)
* [Insights](/github/cmark-gfm/pulse)

Additional navigation options

* [Code](/github/cmark-gfm)
* [Issues](/github/cmark-gfm/issues)
* [Pull requests](/github/cmark-gfm/pulls)
* [Actions](/github/cmark-gfm/actions)
* [Security](/github/cmark-gfm/security)
* [Insights](/github/cmark-gfm/pulse)

# Quadratic complexity bug may lead to a denial of service

Moderate

[anticomputer](/anticomputer)
published
GHSA-r8vr-c48j-fcc5
Mar 31, 2023

## Package

cmark-gfm

## Affected versions

<= 0.29.0.gfm.9

## Patched versions

0.29.0.gfm.10

## Description

### Impact

A polynomial time complexity issue in cmark-gfm may lead to unbounded resource exhaustion and subsequent denial of service.

### Proof of concept

Each of the commands below triggers a different issue.

```
python3 -c 'pad = "_" * 10000; print(pad + "." + pad, end="")' | time ./build/src/cmark-gfm --to plaintext
python3 -c 'pad = "_" * 10000; print(pad + "." + pad, end="")' | time ./build/src/cmark-gfm --to commonmark
python3 -c 'n = 10000; print("1.\n" + " 2.\n"*n)' | time ./src/cmark-gfm -t commonmark
python3 -c 'n = 10000; print(" -"*n + "x\n")' | time ./src/cmark-gfm -t xml
python3 -c 'n = 10000; print(" -"*n + "x\n")' | time ./src/cmark-gfm -t man
```

Increasing the number 10000 in the above commands causes the running time to increase quadratically.

### Patches

This vulnerability has been patched in 0.29.0.gfm.10.

### Note on cmark and cmark-gfm

[cmark-gfm](https://github.com/github/cmark-gfm) is a fork of [cmark](https://github.com/commonmark/cmark) that adds the GitHub Flavored Markdown extensions. The two codebases have diverged over time, but share a common core. This bug only affects `cmark-gfm` as `cmark` had [already patched](https://github.com/commonmark/cmark/commit/2dca096d8e80353ba3ad3ca344b5adcb3c15832c) this issue in their commonmark renderer and they do not contain the plaintext renderer.

### Credit

We would like to thank [@gravypod](https://github.com/gravypod) for reporting this vulnerability.

### References

<https://en.wikipedia.org/wiki/Time_complexity>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [github/cmark-gfm](https://github.com/github/cmark-gfm)

### Severity

Moderate

### CVE ID

CVE-2023-26485

### Weaknesses

[CWE-407](/advisories?query=cwe%3A407)

### Credits

* [![@gravypod](https://avatars.githubusercontent.com/u/902107?s=40&v=4)](/gravypod)
  [gravypod](/gravypod)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


