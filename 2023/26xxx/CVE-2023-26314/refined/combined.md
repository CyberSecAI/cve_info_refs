=== Content from lists.debian.org_dd2cb2a8_20250114_193836.html ===


---

[[Date Prev](msg00036.html)][[Date Next](msg00038.html)]
[[Thread Prev](msg00036.html)][[Thread Next](msg00038.html)]
[[Date Index](maillist.html#00037)]
[[Thread Index](threads.html#00037)]

# [SECURITY] [DLA 3343-1] mono security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3343-1] mono security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Sat, 25 Feb 2023 11:42:03 +0200
* *Message-id*: <Y/nX6yuZOIrY51gr@localhost>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3343-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
February 24, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : mono
Version        : 5.18.0.240+dfsg-3+deb10u1
CVE ID         : CVE-2023-26314
Debian Bug     : 972146

Triggering arbitrary code execution was possible due to .desktop files
registered as application/x-ms-dos-executable MIME handlers in the open
source .NET framework Mono.

For Debian 10 buster, this problem has been fixed in version
5.18.0.240+dfsg-3+deb10u1.

We recommend that you upgrade your mono packages.

For the detailed security status of mono please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mono>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmP51+cACgkQiNJCh6LY
mLEVUg//SxvSPQUHmgCUSDx48KWq4dvQ/HdQsyKmo/3uUOhoU9+BmeK+dj0Spv+7
YVPMfKe+9aYG29ufKIh3O1Yk07eRtii4z3b0WnffUnhIbV58AziqutlKzhr6k4r/
NIB0zzg1+7XLUlViBJW3TV9JpytR+hObvRQnsSTEA70EEYPoRqmjql5RbC5gS+wU
ed6ZamPQoVvgbAng6j3rzsjYsfAkMM1rRukAeyPnJ6BRKUEsUsluLBsCX6OrBCRR
CaebbNo4d7sxUy2GoRMKNd+NJV0Tr0JjZ4oZpXD2sdxmkJ2UGaXVheOY428UDHNW
zeEFSq3dNu1GFSrjJE2YNcuIxJnB6J6k1/CaJbDLP/pls+5bgANcPiw089gRm1tq
WxjXEn3FAqQCwawGWJe5NTNXRRLZFC+CoHlS8YGzjWJI51n3LECJSbGxnWXfS7Nz
Rt/qbuCY6RtdJJOkTsI+itEdJEer8txfqAakEVFs6TWCX9MXMVy+f6N3V8BN9wHZ
nCc7GyL1h27Zx+p8Ie1QkfA588B8LDkfuPRQrHZKrr/aTJlkUUYm6e0uBRc55pDG
G5ZrsIuIC67hmrLa8T0EJsoh5GoJ5xixTR7kFbI2dc4Wu+HQIO6Rf7AdxKZPVmSO
tbCQF+g20q7yBW3iJi2mDxqidrH4/wIxIBpF+O0wLTDKF2CP1kY=
=A9BJ
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.debian.org_c0b5836b_20250114_193834.html ===

# Debian Bug report logs - #972146 /usr/share/applications/mono-runtime-common.desktop: should not handle MIME type by executing arbitrary code (CVE-2023-26314)

[![version graph](version.cgi?width=2;height=2;package=mono-runtime-common;found=mono%2F5.18.0.240%2Bdfsg-3;found=mono%2F6.8.0.105%2Bdfsg-3;collapse=1;absolute=0;fixed=mono%2F6.8.0.105%2Bdfsg-3.3;fixed=mono%2F6.8.0.105%2Bdfsg-3.3~deb11u1)](version.cgi?package=mono-runtime-common;info=1;collapse=1;found=mono%2F5.18.0.240%2Bdfsg-3;found=mono%2F6.8.0.105%2Bdfsg-3;absolute=0;fixed=mono%2F6.8.0.105%2Bdfsg-3.3;fixed=mono%2F6.8.0.105%2Bdfsg-3.3~deb11u1)

Package:
[mono-runtime-common](pkgreport.cgi?package=mono-runtime-common);
Maintainer for [mono-runtime-common](pkgreport.cgi?package=mono-runtime-common) is [Antoine Le Gonidec <debian@dotslashplay.it>](pkgreport.cgi?maint=debian%40dotslashplay.it); Source for [mono-runtime-common](pkgreport.cgi?package=mono-runtime-common) is [src:mono](pkgreport.cgi?src=mono) ([PTS](https://tracker.debian.org/pkg/mono), [buildd](https://buildd.debian.org/mono), [popcon](https://qa.debian.org/popcon.php?package=mono)).

Reported by: [Simon McVittie <smcv@debian.org>](pkgreport.cgi?submitter=smcv%40debian.org)

Date: Tue, 13 Oct 2020 10:33:01 UTC

Severity: *grave*

Tags: patch, security

Found in versions mono/5.18.0.240+dfsg-3, mono/6.8.0.105+dfsg-3

Fixed in versions mono/6.8.0.105+dfsg-3.3, mono/6.8.0.105+dfsg-3.3~deb11u1

**Done:** Salvatore Bonaccorso <carnil@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=972146;mbox=yes), [status mbox](bugreport.cgi?bug=972146;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=972146;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Tue, 13 Oct 2020 10:33:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=2), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Simon McVittie <smcv@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Tue, 13 Oct 2020 10:33:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=4), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=5), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=smcv%40debian.org)
From: Simon McVittie <smcv@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: /usr/share/applications/mono-runtime-common.desktop: should not
handle MIME type by executing arbitrary code
Date: Tue, 13 Oct 2020 11:27:47 +0100
```
Package: mono-runtime-common
Version: 6.8.0.105+dfsg-3
Severity: important
File: /usr/share/applications/mono-runtime-common.desktop
Tags: security
X-Debbugs-Cc: Debian Security Team <team@security.debian.org>

/usr/share/applications/mono-runtime-common.desktop and
/usr/share/applications/mono-runtime-terminal.desktop are registered
as freedesktop.org MIME handlers for the application/x-ms-dos-executable
MIME type. They run the executable under mono(1) without any further
prompting. This means that doing normal "open a document" actions
will result in arbitrary code execution with normal user privileges:

- follow a web link to a downloadable file and accept the browser's
  offer to open it (mitigation: the user is prompted, and major
  browsers might special-case application/x-ms-dos-executable as
  particularly dangerous)
- follow a file:/// link in a non-web format that allows links, such
  as PDF
- open an email attachment
- xdg-desktop-portal forwarding an "open file" action from a Flatpak
  app (mitigation: this one involves user action to confirm which
  app should be used to open the file)

I don't think this is *necessarily* a security vulnerability, as such
(everything is doing what it is designed to do), but in 2020 it seems
deeply inadvisable. In particular, web browsers, email clients, and
sandboxed app frameworks like Flatpak and Snap, which are not generally
aware of the specifics of particular MIME types, have little choice but
to assume that opening a file is not normally arbitrary code execution.

The analogous MIME handling in Wine was removed in 2013
(<<https://bugs.debian.org/327262>>).

I would expect that Mono would either not handle
application/x-ms-dos-executable, or handle it with an application
that shows a "this is probably dangerous, are you sure?" prompt
first (like Wine used to do). I would personally prefer it
to not handle application/x-ms-dos-executable at all, due to
<<https://en.wikipedia.org/wiki/Dancing_pigs>>.

This was brought to my attention by a commit in GNOME's evince PDF
viewer which removes its "launch action" feature (part of the PDF spec,
but in practice mostly used by Windows malware) as a form of security
hardening. See <<https://gitlab.gnome.org/GNOME/evince/-/issues/1333>>
(I'm preparing an upload with the change referenced there), which uses
mono in its proof-of-concept.

Mitigation: GNOME users will find that org.gnome.FileRoller.desktop is a
preferred handler for application/x-ms-dos-executable. It isn't clear to
me how useful this really is (opening an executable as a zip-like archive
with "filenames" like .text and .bss seems more like a proof-of-concept
than something people would genuinely use) but at least it's harmless.
MATE's equivalent (fork?) of file-roller, engrampa, does the same.

Another mitigation: I was surprised to find that gnome-games-app also
associates itself with application/x-ms-dos-executable, alongside lots
of ROM formats (presumably so it can offer to run them in a sandbox
environment with Dosbox). This is hopefully OK, because gnome-games-app
hopefully has a lot more prompting and sandboxing than a general-purpose
program interpreter.

    smcv

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Tue, 04 May 2021 20:33:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=7), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Gabriel Corona <gabriel.corona@enst-bretagne.fr>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Tue, 04 May 2021 20:33:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=9), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=10), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=gabriel.corona%40enst-bretagne.fr)
From: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
To: 972146@bugs.debian.org
Subject: Re: /usr/share/applications/mono-runtime-common.desktop: should not
handle MIME type by executing arbitrary code
Date: Tue, 4 May 2021 22:30:57 +0200
```
Hi,

Any update on this? This is actually very dangerous.

$ xdg-open hello.exe
Hello World!
$ cp hello.exe hello.ΡDF # <- actually not a P but a uppercase rho
$ xdg-open hello.PDF
Hello World!

Gabriel

```

---

**Severity set to 'grave' from 'important'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 18 May 2021 20:06:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=12), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=12), [link](#11)).

---

**Marked as found in versions mono/5.18.0.240+dfsg-3.**
Request was from `Adrian Bunk <bunk@debian.org>`
to `control@bugs.debian.org`.
(Sun, 23 May 2021 15:39:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=14), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=14), [link](#13)).

---

**Added tag(s) bullseye-ignore.**
Request was from `Paul Gevers <elbrus@debian.org>`
to `control@bugs.debian.org`.
(Fri, 30 Jul 2021 13:24:07 GMT) ([full text](bugreport.cgi?bug=972146;msg=16), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=16), [link](#15)).

---

**Removed tag(s) bullseye-ignore.**
Request was from `Paul Gevers <elbrus@debian.org>`
to `control@bugs.debian.org`.
(Sat, 14 Aug 2021 17:57:22 GMT) ([full text](bugreport.cgi?bug=972146;msg=18), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=18), [link](#17)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Tue, 17 Aug 2021 07:42:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=20), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=20), [link](#19)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Tue, 17 Aug 2021 07:42:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=22), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=23), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Gabriel Corona <gabriel.corona@enst-bretagne.fr>,
972146@bugs.debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Tue, 17 Aug 2021 09:39:29 +0200
```
Hi Monio Maintainers,

On Tue, May 04, 2021 at 10:30:57PM +0200, Gabriel Corona wrote:
> Hi,
>
> Any update on this? This is actually very dangerous.
>
> $ xdg-open hello.exe
> Hello World!
> $ cp hello.exe hello.ΡDF # <- actually not a P but a uppercase rho
> $ xdg-open hello.PDF
> Hello World!

Friendly ping on this issue. This issue was ingored for bullseye
release, at least during the freeze. Any suggestion for it's further
handling?

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Wed, 10 Nov 2021 21:21:05 GMT) ([full text](bugreport.cgi?bug=972146;msg=25), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=25), [link](#24)).

---

**Acknowledgement sent**
to `Gabriel Corona <gabriel.corona@enst-bretagne.fr>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Wed, 10 Nov 2021 21:21:05 GMT) ([full text](bugreport.cgi?bug=972146;msg=27), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=27), [link](#26)).

---

[Message #28](#28) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=28), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=28), reply):

![](/cgi-bin/libravatar.cgi?email=gabriel.corona%40enst-bretagne.fr)
From: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
To: 972146@bugs.debian.org
Subject: Re: /usr/share/applications/mono-runtime-common.desktop: should not
handle MIME type by executing arbitrary code
Date: Wed, 10 Nov 2021 22:17:55 +0100
```
Hi,

Any help needed for this?

Regards,

Gabriel

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Mon, 05 Dec 2022 21:00:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=30), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent**
to `Gabriel Corona <gabriel.corona@enst-bretagne.fr>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Mon, 05 Dec 2022 21:00:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=32), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=33), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=gabriel.corona%40enst-bretagne.fr)
From: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
To: 972146@bugs.debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Mon, 5 Dec 2022 21:57:29 +0100
```
As a workaround, you should be able to disable this feature (and have
the fix persist after a package update) with something like:

mkdir -p /usr/local/share/applications
cp /usr/share/applications/mono-runtime-*.desktop
/usr/local/share/applications
sed -i 's/^Exec=.*/Exec=false/'
/usr/local/share/applications/mono-runtime-*.desktop

Regards,

Gabriel

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Wed, 14 Dec 2022 09:42:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=35), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Wed, 14 Dec 2022 09:42:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=37), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=38), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 972146@bugs.debian.org
Subject: mono: diff for NMU version 6.8.0.105+dfsg-3.3
Date: Wed, 14 Dec 2022 10:39:14 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=972146;msg=38) (text/plain, inline)]
```
```
Control: tags 972146 + patch

Dear maintainer,

I've prepared an NMU for mono (versioned as 6.8.0.105+dfsg-3.3). The diff
is attached to this message.

Regards,
Salvatore

```
```
[[mono-6.8.0.105+dfsg-3.3-nmu.diff](bugreport.cgi?att=1;bug=972146;filename=mono-6.8.0.105%2Bdfsg-3.3-nmu.diff;msg=38) (text/x-diff, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `972146-submit@bugs.debian.org`.
(Wed, 14 Dec 2022 09:42:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=40), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=40), [link](#39)).

---

**Reply sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

You have taken responsibility.
(Wed, 14 Dec 2022 10:57:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=42), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=42), [link](#41)).

---

**Notification sent**
to `Simon McVittie <smcv@debian.org>`:

Bug acknowledged by developer.
(Wed, 14 Dec 2022 10:57:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=44), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 972146-close@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=45), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 972146-close@bugs.debian.org
Subject: Bug#972146: fixed in mono 6.8.0.105+dfsg-3.3
Date: Wed, 14 Dec 2022 10:54:34 +0000
```
Source: mono
Source-Version: 6.8.0.105+dfsg-3.3
Done: Salvatore Bonaccorso <carnil@debian.org>

We believe that the bug you reported is fixed in the latest version of
mono, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 972146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Salvatore Bonaccorso <carnil@debian.org> (supplier of updated mono package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 09 Dec 2022 14:33:03 +0100
Source: mono
Architecture: source
Version: 6.8.0.105+dfsg-3.3
Distribution: unstable
Urgency: medium
Maintainer: Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>
Changed-By: Salvatore Bonaccorso <carnil@debian.org>
Closes: [972146](bugreport.cgi?bug=972146)
Changes:
 mono (6.8.0.105+dfsg-3.3) unstable; urgency=medium
 .
   * Non-maintainer upload.
   * Revert "Added desktop file for mono with and without a terminal window"
     (Closes: #[972146](bugreport.cgi?bug=972146))
Checksums-Sha1:
 a6328f64e65334e8efe493449680434b23e9d8dc 19796 mono_6.8.0.105+dfsg-3.3.dsc
 c8cf23f89c835a3defa9fd1652bc733eae9efe79 136532 mono_6.8.0.105+dfsg-3.3.debian.tar.xz
 1faf68312140181825c77a857369e2c884dd7678 4830 mono_6.8.0.105+dfsg-3.3_source.buildinfo
Checksums-Sha256:
 691db0a4657222707277448467e33f05f19fa8eb80bb91113828187cc6e2d544 19796 mono_6.8.0.105+dfsg-3.3.dsc
 0d62c1d1ef2f0b00420d41b0a30db6dd172f3f6bdd6cfc8a8abe8bff6a5d5fc8 136532 mono_6.8.0.105+dfsg-3.3.debian.tar.xz
 a244550c997733965abe6499a3f0bce52926e134ca0b60b12340e052b3f72248 4830 mono_6.8.0.105+dfsg-3.3_source.buildinfo
Files:
 300c8a5c48320caa038d5ef742f6a8e5 19796 cli-mono optional mono_6.8.0.105+dfsg-3.3.dsc
 154fbda976a4c7a362336030aed8ba4e 136532 cli-mono optional mono_6.8.0.105+dfsg-3.3.debian.tar.xz
 8c31bf51e44371e238f854abc5b4c97c 4830 cli-mono optional mono_6.8.0.105+dfsg-3.3_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQKmBAEBCgCQFiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmOTPzxfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQSHGNhcm5pbEBk
ZWJpYW4ub3JnAAoJEAVMuPMTQ89EOTIQAJQsDM0YnWyE+20EYCHxtnHOOvPrZ7MR
rkhiz6blBSwCEed0voCR8el31O4lypX68hCzLG+izBDE98n6kzgspjMMa8hQzJi+
VnQOByWWLpnGleBA/JRpmC4BEkEn4yGJ3jmFgoIpE19dMqC+VplGZY/Ot8briBrY
KTJOnsg1/KTy8FfSzDdo7krpNhNGQ1zk262/uOQoIwSSBAjX72tEIrzCFe1SyqgV
p39zjIArnCEI501f5e62YFHLVuBuqG+02EdDSS2m0OCmAFZXy0PKtLqVmjhlm3D8
YhKFikkxXAOXqw/QVS5fb4JSLAVE32v8gCd6Cxk7moJJvEV4wkTcpc1anOdytY2B
S2YfypcjvjXk7FHKzmFLTWLIAPyFYXqdvJ+p7GxXt+Fvajxq/8O22dTWi6DyZ9IC
c+GwK1PSUvPH/7/UCSmN7lz3dyxHSaDxqZnN2Z2f7CstGffO3++Cop5+RAIaVszd
OSQnwWctfkumjqJuQnAXU9ntREFcFTSwgXYqPcer55HPPRPbclkI7niEo3Xtg5UL
wDnJPCi/6Go7pQzF26WZy1K60vzkgzcYOnp3GBFWdmPO0jLNSOQYuhDotH9wTX0p
w18cehFjVviBmNaj1IqDPMX2Ucg6bUTop0WP2JUSHZLHmFpwk8TBSAlkqZaFZ79+
esaOmULWu+pl
=84G1
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Thu, 16 Feb 2023 22:45:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=47), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=47), [link](#46)).

---

**Acknowledgement sent**
to `Gabriel Corona <gabriel.corona@enst-bretagne.fr>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Thu, 16 Feb 2023 22:45:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=49), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=50), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=gabriel.corona%40enst-bretagne.fr)
From: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
To: 972146@bugs.debian.org
Cc: security@debian.org
Subject: Re: /usr/share/applications/mono-runtime-common.desktop: should not
handle MIME type by executing arbitrary code
Date: Thu, 16 Feb 2023 23:37:57 +0100
```
Hi,

Thanks for the patch!

This has been fixed in Debian testing and sid. However, stable is still
affected. I believe it would make sense to port the patch to stable and
allocate a CVE for this.

Regards,

Gabriel

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Fri, 17 Feb 2023 21:39:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=52), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=52), [link](#51)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Fri, 17 Feb 2023 21:39:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=54), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=55), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Gabriel Corona <gabriel.corona@enst-bretagne.fr>,
972146@bugs.debian.org
Cc: security@debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Fri, 17 Feb 2023 22:34:18 +0100
```
Hi Gabriel,

On Thu, Feb 16, 2023 at 11:37:57PM +0100, Gabriel Corona wrote:
> Hi,
>
> Thanks for the patch!

Thanks for staying on top of the issue!
>
> This has been fixed in Debian testing and sid. However, stable is still
> affected. I believe it would make sense to port the patch to stable and
> allocate a CVE for this.

The last upload to unstable as NMU was for me personally to near to
the point release before christmas. A while has passed, and have now
proposed the same change for bullseye as well, cf. #1031527. Thanks
for pinging again on it, much appreciated! So the issue will/should be
fixed as well with the upcoming point release.

There is no CVE assigned, if you feel strong about it, can you try to
get one allocated by MITRE via the cveform? I think we won't go trough
the needed workflow to assign a Debian specific CVE id for it. But we
will see what MITRE will respond on the request.

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Sat, 18 Feb 2023 11:09:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=57), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `Gabriel Corona <gabriel.corona@enst-bretagne.fr>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Sat, 18 Feb 2023 11:09:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=59), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=60), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=gabriel.corona%40enst-bretagne.fr)
From: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 972146@bugs.debian.org, security@debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Sat, 18 Feb 2023 12:04:27 +0100
```
Hi!

> A while has passed, and have now proposed the same change for bullseye
> as well, cf. #1031527.

Great!

> There is no CVE assigned, if you feel strong about it, can you try to
> get one allocated by MITRE via the cveform? I think we won't go trough
> the needed workflow to assign a Debian specific CVE id for it. But we
> will see what MITRE will respond on the request.

I don't believe MITRE will accept such a request and redirect me to
Debian [1].

I believe obtaining a CVE ID would be beneficial so that this issue may
be tracked by downstream projects/distributions.

[1] <https://www.cve.org/PartnerInformation/ListofPartners/partner/debian>

Regards,

Gabriel

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Sat, 18 Feb 2023 18:33:06 GMT) ([full text](bugreport.cgi?bug=972146;msg=62), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Sat, 18 Feb 2023 18:33:06 GMT) ([full text](bugreport.cgi?bug=972146;msg=64), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=65), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Gabriel Corona <gabriel.corona@enst-bretagne.fr>
Cc: 972146@bugs.debian.org, security@debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Sat, 18 Feb 2023 19:31:40 +0100
```
On Sat, Feb 18, 2023 at 12:04:27PM +0100, Gabriel Corona wrote:
> I believe obtaining a CVE ID would be beneficial so that this issue may be
> tracked by downstream projects/distributions.

All those distros were notified via your post to oss-security. You can
try cveform, if there's no assignment via that channel, that's about it.

In the past assigning CVEs for Debian was simple, but with some recent changes
it has become a complicated, time-consuming process and now we only do it
in select cases.

Cheers,
        Moritz

```

---

**Reply sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

You have taken responsibility.
(Sat, 18 Feb 2023 19:33:05 GMT) ([full text](bugreport.cgi?bug=972146;msg=67), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=67), [link](#66)).

---

**Notification sent**
to `Simon McVittie <smcv@debian.org>`:

Bug acknowledged by developer.
(Sat, 18 Feb 2023 19:33:05 GMT) ([full text](bugreport.cgi?bug=972146;msg=69), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 972146-close@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=70), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 972146-close@bugs.debian.org
Subject: Bug#972146: fixed in mono 6.8.0.105+dfsg-3.3~deb11u1
Date: Sat, 18 Feb 2023 19:32:08 +0000
```
Source: mono
Source-Version: 6.8.0.105+dfsg-3.3~deb11u1
Done: Salvatore Bonaccorso <carnil@debian.org>

We believe that the bug you reported is fixed in the latest version of
mono, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 972146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Salvatore Bonaccorso <carnil@debian.org> (supplier of updated mono package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 17 Feb 2023 06:30:39 +0100
Source: mono
Architecture: source
Version: 6.8.0.105+dfsg-3.3~deb11u1
Distribution: bullseye
Urgency: medium
Maintainer: Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>
Changed-By: Salvatore Bonaccorso <carnil@debian.org>
Closes: [972146](bugreport.cgi?bug=972146)
Changes:
 mono (6.8.0.105+dfsg-3.3~deb11u1) bullseye; urgency=medium
 .
   * Rebuild for bullseye
 .
 mono (6.8.0.105+dfsg-3.3) unstable; urgency=medium
 .
   * Non-maintainer upload.
   * Revert "Added desktop file for mono with and without a terminal window"
     (Closes: #[972146](bugreport.cgi?bug=972146))
Checksums-Sha1:
 d299482a99e07ddf029a7af708349fbe7ce2c298 19828 mono_6.8.0.105+dfsg-3.3~deb11u1.dsc
 a1384f42844a91fe0694a53294b7ad80602b5a98 136612 mono_6.8.0.105+dfsg-3.3~deb11u1.debian.tar.xz
 391ef1d5d5fed5e5d8eaf70723ea44ef2f3fc19a 8639 mono_6.8.0.105+dfsg-3.3~deb11u1_source.buildinfo
Checksums-Sha256:
 c80858ad5831da11c1d2f41d737d98ad1799837a03c736b02b2ff971e908a853 19828 mono_6.8.0.105+dfsg-3.3~deb11u1.dsc
 ead2d8f25eee6a9583e2d721cf5f1798ef8620b1f7c5d335ee825669a63e74b8 136612 mono_6.8.0.105+dfsg-3.3~deb11u1.debian.tar.xz
 ad5250a2be26d40c9673a449ba04c016716de0eee8bd0e2db9aa2ffcfa38114e 8639 mono_6.8.0.105+dfsg-3.3~deb11u1_source.buildinfo
Files:
 59881fe1fbb0d47eee63b9cad4bb49a3 19828 cli-mono optional mono_6.8.0.105+dfsg-3.3~deb11u1.dsc
 07164271ff2a0471649877da2eea4801 136612 cli-mono optional mono_6.8.0.105+dfsg-3.3~deb11u1.debian.tar.xz
 97a141996471fbd9db3d6716550928ae 8639 cli-mono optional mono_6.8.0.105+dfsg-3.3~deb11u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQKmBAEBCgCQFiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmPv7QtfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQSHGNhcm5pbEBk
ZWJpYW4ub3JnAAoJEAVMuPMTQ89EWO0P/AihgX6WjxFqqnbIynGJwsICMriYVXmg
6c7CukOQSsVZFCnpZ7A3N/N+BSueics++yMNk3fy5yWV9FcQizlM28xp702b0Pan
h4phGEkoNYsSdfoe5ng98uI3KiiA7nxnG9B41XAmx3OM0ZjCDThkzTf7xostCPAT
o2Kdz3e2paEOVe/MAHKCKpLGGK3nTjwdWGxDDW0dxMzxgYL6QiI9Ov0oruXF0wN3
ApBAUIpzG08OCbmKDJtp1I6LtueKZZIQuCHPYiAOzC+pZ2uM3PSKlyEObsxC6p0c
80MsepKIeDlKLtcwe0EB7kbp9OMHWpeyZ9vIwISdnhUSb1oJ702AWtbL5egKxtGx
qfMX9lon/Gq7nNAL312MBHPmz6rEDM6mp0LvOpctN4c8HTx8cTVlvRVIwC9esVE2
iX+WpVtwZ5WGspTg8SjEfLIk5GyuAT+orRuoAyuK+/H5swO/8Qt1ZeLqXIYXsbaz
VqaliQjFnG5wj5k1sqojZATWIZB0HuRS+P1eo5VKnWDrMqWUcncCpdrO2KS3iS9i
7TPr+5qxx2xfh/dMAuI1baJ/6oSZpWq1M01MMcpd25XfTQzh7gumLJ70hamq7x9m
63Ill18FdVSGgsKIddPGXPKKmNtrs5x/kmSgbyrcx1dkaoZupnDWdsy7AAns2Fkg
l61u92DQGmtu
=KA6x
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to '/usr/share/applications/mono-runtime-common.desktop: should not handle MIME type by executing arbitrary code (CVE-2023-26314)' from '/usr/share/applications/mono-runtime-common.desktop: should not handle MIME type by executing arbitrary code'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Feb 2023 06:54:02 GMT) ([full text](bugreport.cgi?bug=972146;msg=72), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=72), [link](#71)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`:

`Bug#972146`; Package `mono-runtime-common`.
(Wed, 22 Feb 2023 06:57:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=74), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=74), [link](#73)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Mono Group <pkg-mono-group@lists.alioth.debian.org>`.
(Wed, 22 Feb 2023 06:57:03 GMT) ([full text](bugreport.cgi?bug=972146;msg=76), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=76), [link](#75)).

---

[Message #77](#77) received at 972146@bugs.debian.org ([full text](bugreport.cgi?bug=972146;msg=77), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=77), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Gabriel Corona <gabriel.corona@enst-bretagne.fr>,
972146@bugs.debian.org
Cc: security@debian.org
Subject: Re: Bug#972146: /usr/share/applications/mono-runtime-common.desktop:
should not handle MIME type by executing arbitrary code
Date: Wed, 22 Feb 2023 07:53:23 +0100
```
Hi Gabriel,

On Sat, Feb 18, 2023 at 12:04:27PM +0100, Gabriel Corona wrote:
> Hi!
>
> > A while has passed, and have now proposed the same change for bullseye
> > as well, cf. #1031527.
>
> Great!
>
> > There is no CVE assigned, if you feel strong about it, can you try to
> > get one allocated by MITRE via the cveform? I think we won't go trough
> > the needed workflow to assign a Debian specific CVE id for it. But we
> > will see what MITRE will respond on the request.
>
> I don't believe MITRE will accept such a request and redirect me to Debian
> [1].

I requested one directly from MITRE, it is now
<https://www.cve.org/CVERecord?id=CVE-2023-26314> .

Regards,
Salvatore

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 30 Apr 2023 07:27:11 GMT) ([full text](bugreport.cgi?bug=972146;msg=79), [mbox](bugreport.cgi?bug=972146;mbox=yes;msg=79), [link](#78)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=972146).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 14 19:38:33 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_0806e4de_20250114_193837.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/01/04/1) [[next>]](2) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <07c41f5e-dbe3-4ff4-0e2f-386776a07370@free.fr>
Date: Wed, 4 Jan 2023 23:47:12 +0100
From: Gabriel Corona <gabriel.corona@...e.fr>
To: oss-security@...ts.openwall.com
Subject: Code execution through MIME-type association of Mono interpreter and
 security expectations of MIME type associations

On Debian and derivatives, the mono-runtime-common package associates
the application/x-ms-dos-executable MIME type with the Mono CLR
interpreter [1]. This makes it very easy for an attacker to trigger
arbitrary code execution through programs such as Chromium [2], Firefox
[3] and Thunderbird [4] when the Mono packages are installed.

This has been fixed in package 6.8.0.105+dfsg-3.3 [5] which is available
in Debian testing, Debian Sid and Ubuntu Lunar (23.04). This has
currently not been fixed in any stable distribution.

On Firefox and Thunderbird, a user interface is used to let the user
confirm which program to use to open the file. In this case, we can
trick the user into thinking he is about to open the file with a
innocuous program by serving the file with a special MIME type such as
inode/directory or x-scheme-handler/trash [3,4]. These MIME types are
typically associated with a file manager. When called this way, several
file managers will try to open the file based on MIME-type associations
(where the MIME-type is inferred either from the file name extension or
from the file content). Thunar, PCManFM, PCManFM-Qt were found to
exhibit this behavior.

For Thunar, this behavior has been fixed in v4.16.7 and v4.17.2 [7].

We can use a visually confusable file name such as REPORT.ΡDF (notice
the non-ASCII first letter in the extension) in order to trick the user
into thinking he is opening a "safe" file type while disabling MIME-type
detection based on the file name extension.

Moreover, in Firefox and Thunderbird [8], we can corrupt the file
association database (handlers.json) in order to display a bogus file
type description associated with the inode/directory or x-scheme-
handler/trash MIME type. This is done by first serving a "safe" file
type (such as a PDF) with this MIME type.

This begs several questions about file associations:

* Is it legitimate to register file associations for programs
   which can exbibit arbitrary code execution such as unsandboxed
   program interpreters?
* When a program (such as a file manager) is called with a regular file
   it does not handle, should it spawn a new program for handling the
   file without user confirmation (as it may be exploited for file type
   spoofing)?
* Should a client program reject special/bogus MIME types such as
   inode/* and x-scheme-handler/* as they are not expected to be
   used in this context (and it may be exploited for file type spoofing)?

I would consider the following behaviors to be vulnerabilities:

* Association of the Mono interpreter with a MIME type in the
   Debian/Ubuntu packages;
* Thunar delegates to MIME type associations when opened with a regular
   file (CVE-2021-32563);
* PCManFM delegates to MIME type associations when opened with a regular
   file;
* PCManFM-Qt delegates to MIME type associations when opened with a
   regular file;
* Firefox and Thunderbird accept "special" MIME types (inode/* and
   x-scheme-handler/*) from remote servers;
* File type spoofing by corrupting the Firefox and Thunderbird
   handlers.json database.

[1] <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=972146>
[2] <https://www.gabriel.urdhr.fr/videos/chromium-filetype-spoofing-poc.ogv>
[3] <https://www.gabriel.urdhr.fr/videos/firefox-filetype-spoofing-poc.ogv>
[4]
<https://www.gabriel.urdhr.fr/videos/thunderbird-filetype-spoofing-poc.ogv>
[5] <https://packages.debian.org/buster/mono-runtime-common>
[6]
<https://packages.ubuntu.com/search?keywords=mono-runtime-common&searchon=names&suite=all&section=all>
[7] <https://nvd.nist.gov/vuln/detail/CVE-2021-32563>
[8] <https://www.gabriel.urdhr.fr/videos/firefox-filetype-spoofing-poc2.ogv>

Download attachment "[OpenPGP_signature](1/1)" of type "application/pgp-signature" (841 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


