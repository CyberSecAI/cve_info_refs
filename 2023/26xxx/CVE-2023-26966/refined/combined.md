=== Content from gitlab.com_5db12b24_20250114_211111.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SEGV at /libtiff/tif\_luv.c:961 in uv\_encode()

# Summary

An SIGSEGV caused when using tiffcrop.

# Version

```
$ ./tools/tiffcrop -v
Library Release: LIBTIFF, Version 4.5.0
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.
Tiffcp code: Copyright (c) 1988-1997 Sam Leffler
           : Copyright (c) 1991-1997 Silicon Graphics, Inc
Tiffcrop additions: Copyright (c) 2007-2010 Richard Nolde

$ git log --oneline -1
c861f25c (HEAD -> master, origin/master, origin/HEAD) Merge branch 'tiffcrop_dont_reuse_input_buffer_fix_527' into 'master'
```

# Steps to reproduce

## make

```
git clone https://gitlab.com/libtiff/libtiff.git
cd libtiff
./autogen.sh
./configure
make
```

## run

```
$ ./tools/tiffcrop -B poc temp
TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 12336 (0x3030) encountered.
TIFFReadDirectory: Warning, Unknown field with tag 3120 (0xc30) encountered.
TIFFFetchNormalTag: Defined set_field_type of custom tag 12336 (Tag 12336) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFFetchNormalTag: Defined set_field_type of custom tag 3120 (Tag 3120) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFAdvanceDirectory: Error fetching directory count.
fish: Job 1, './tools/tiffcrop -B poc temp' terminated by signal SIGSEGV (Address boundary error)
```

# Platform

```
$ uname -a
Linux 13579 5.15.0-56-generic #62~20.04.1-Ubuntu SMP Tue Nov 22 21:24:20 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux

$ gcc --version
gcc (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Copyright (C) 2019 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
```

# ASAN report

```
./tools/tiffcrop -B poc temp
TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 12336 (0x3030) encountered.
TIFFReadDirectory: Warning, Unknown field with tag 3120 (0xc30) encountered.
TIFFFetchNormalTag: Defined set_field_type of custom tag 12336 (Tag 12336) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFFetchNormalTag: Defined set_field_type of custom tag 3120 (Tag 3120) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFAdvanceDirectory: Error fetching directory count.
AddressSanitizer:DEADLYSIGNAL
=================================================================
==1381705==ERROR: AddressSanitizer: SEGV on unknown address 0x7f1876003420 (pc 0x7f1c75f78cb0 bp 0x7ffc95fdf630 sp 0x7ffc95fdf600 T0)
==1381705==The signal is caused by a READ memory access.
    #0 0x7f1c75f78caf in uv_encode /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:961
    #1 0x7f1c75f797b2 in LogLuv24fromXYZ /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:1057
    #2 0x7f1c75f79f58 in Luv24fromXYZ /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:1120
    #3 0x7f1c75f76522 in LogLuvEncode24 /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:569
    #4 0x7f1c75f775c7 in LogLuvEncodeStrip /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:722
    #5 0x7f1c75fcb6bb in TIFFWriteEncodedStrip /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_write.c:308
    #6 0x563fd6857160 in writeBufferToContigStrips /home/a13579/fuzz_lib_tiff/report/libtiff_asan/tools/tiffcrop.c:1317
    #7 0x563fd688022e in writeCroppedImage /home/a13579/fuzz_lib_tiff/report/libtiff_asan/tools/tiffcrop.c:9197
    #8 0x563fd685f4d5 in main /home/a13579/fuzz_lib_tiff/report/libtiff_asan/tools/tiffcrop.c:2834
    #9 0x7f1c75a96082 in __libc_start_main ../csu/libc-start.c:308
    #10 0x563fd6855b6d in _start (/home/a13579/fuzz_lib_tiff/report/libtiff_asan/tools/.libs/tiffcrop+0x9b6d)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tif_luv.c:961 in uv_encode
==1381705==ABORTING
```

# poc

[poc](/-/project/4720790/uploads/f08f3fad60d74ef290580cdb8f3e4918/poc)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from lists.debian.org_bdc4043c_20250114_211114.html ===


---

[[Date Prev](msg00033.html)][Date Next]
[[Thread Prev](msg00033.html)][Thread Next]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DLA 3513-1] tiff security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3513-1] tiff security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Mon, 31 Jul 2023 23:56:20 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZMhKJKxZFUd888sD%40localhost)Â [ZMhKJKxZFUd888sD@localhost](msg00034.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3513-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
July 31, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : tiff
Version        : 4.1.0+git191117-2~deb10u8
CVE ID         : CVE-2023-2908 CVE-2023-3316 CVE-2023-3618 CVE-2023-25433
                 CVE-2023-26965 CVE-2023-26966 CVE-2023-38288 CVE-2023-38289
Debian Bug     : 1040945

Multiple vulnerabilities were found in tiff, a library and tools
providing support for the Tag Image File Format (TIFF).

CVE-2023-2908

    NULL pointer dereference in tif_dir.c

CVE-2023-3316

    NULL pointer dereference in TIFFClose()

CVE-2023-3618

    Buffer overflow in tiffcrop

CVE-2023-25433

    Buffer overflow in tiffcrop

CVE-2023-26965

    Use after free in tiffcrop

CVE-2023-26966

    Buffer overflow in uv_encode()

CVE-2023-38288

    Integer overflow in tiffcp

CVE-2023-38289

    Integer overflow in raw2tiff

For Debian 10 buster, these problems have been fixed in version
4.1.0+git191117-2~deb10u8.

We recommend that you upgrade your tiff packages.

For the detailed security status of tiff please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tiff>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmTISiQACgkQiNJCh6LY
mLE4oxAAsLoU6HtnZqYIurv0h/+D1aJ1AkSSlp9pfLvJiuPl5nWa5h5E+jYEGkK1
O39SOJNVXoDqixLv4LfCqhyGWffY8NZB+d9fidV5lHml7PwOjsLECAN2to4WJW7m
tsCzG0STEwGn9W1kS12zGBKJt8La+h8V4T4ZrCZIW41RzkOhmUhFYIpKCrB1Z0qs
Z2wGLR2zBnMBr9RiwGVEHKiogZgOYr0VS0g0pZasDFGR++ra/JZfjotzIxmWTt4v
Nkued+JWymGMmieiM93SHPA6BRbWI3fU0bQ4mKXuJppMBy0wDL3DXdu9HG+NlU9T
U9WVWLoY5xqUGBaYaMirDcVslPTjYAuTyCiUtHIlkv8EV+6Eafl1CBZnzNPdyGId
wuMxCHPQjAScUue3WpYX8hd2xSpgC1M0q+CLUde1sav7v9idOJFNe4jZ656cMcKY
6NS5ZxIwHEj8GnbN15qvkpuvIfsrOfXQhkNr9TLE4iOs2V4bSBWumGK7FsML7uMR
HfHtZk1CYojq59yQFNIbV58oqLghsmDuJBgQOEOTnS9Kau0Bbjum5+I/LSlmdweF
Qjpv1ARfc5SMoDYSA6/Yl0Zwx0j58hWopK2wDyzY6HQduTCNk4XkRWHROCEaSmiC
G2wKf9KsM6lgruHhHNB1r817J5bwNZ42X6ClGvP5Je+WHBJffyY=
=GGoQ
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_239acc18_20250114_211113.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# tif\_luv: Check and correct for NaN data in uv\_encode().

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/libtiff/libtiff/-/merge_requests/473.patch)
* [Plain diff](/libtiff/libtiff/-/merge_requests/473.diff)

[Su Laus](/Su_Laus) requested to merge  [Su\_Laus/libtiff:tif\_luv\_check\_NaN\_fix\_#530](/Su_Laus/libtiff/-/tree/tif_luv_check_NaN_fix_%23530 "Su_Laus/libtiff:tif_luv_check_NaN_fix_#530")
 into [master](/libtiff/libtiff/-/tree/master "master") Feb 16, 2023

* [Overview
  2](/libtiff/libtiff/-/merge_requests/473)
* [Commits
  1](/libtiff/libtiff/-/merge_requests/473/commits)
* [Pipelines
  2](/libtiff/libtiff/-/merge_requests/473/pipelines)
* [Changes
  1](/libtiff/libtiff/-/merge_requests/473/diffs)

Expand

tif\_luv: Check and correct for NaN data in uv\_encode().

Closes [#530 (closed)](/libtiff/libtiff/-/issues/530 "SEGV at /libtiff/tif_luv.c:961 in uv_encode()")

See merge request [!473 (merged)](/libtiff/libtiff/-/merge_requests/473 "tif_luv: Check and correct for NaN data in uv_encode().")

Edited Feb 16, 2023 by [Su Laus](/Su_Laus)

## Merge request reports

Assignee
Loading

Reviewers
Loading

Select reviewersRequest review fromLoading

Time tracking
Loading

Loading


