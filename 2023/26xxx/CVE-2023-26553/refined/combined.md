=== Content from github.com_ee2e2132_20250114_181230.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspwpun%2Fntp-4.2.8p15-cves%2Fblob%2Fmain%2FCVE-2023-26553)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspwpun%2Fntp-4.2.8p15-cves%2Fblob%2Fmain%2FCVE-2023-26553)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=spwpun%2Fntp-4.2.8p15-cves)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spwpun](/spwpun)
/
**[ntp-4.2.8p15-cves](/spwpun/ntp-4.2.8p15-cves)**
Public

* [Notifications](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves)
* [Star
   12](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves)

* [Code](/spwpun/ntp-4.2.8p15-cves)
* [Issues
  0](/spwpun/ntp-4.2.8p15-cves/issues)
* [Pull requests
  0](/spwpun/ntp-4.2.8p15-cves/pulls)
* [Actions](/spwpun/ntp-4.2.8p15-cves/actions)
* [Projects
  0](/spwpun/ntp-4.2.8p15-cves/projects)
* [Security](/spwpun/ntp-4.2.8p15-cves/security)
* [Insights](/spwpun/ntp-4.2.8p15-cves/pulse)

Additional navigation options

* [Code](/spwpun/ntp-4.2.8p15-cves)
* [Issues](/spwpun/ntp-4.2.8p15-cves/issues)
* [Pull requests](/spwpun/ntp-4.2.8p15-cves/pulls)
* [Actions](/spwpun/ntp-4.2.8p15-cves/actions)
* [Projects](/spwpun/ntp-4.2.8p15-cves/projects)
* [Security](/spwpun/ntp-4.2.8p15-cves/security)
* [Insights](/spwpun/ntp-4.2.8p15-cves/pulse)

## Files

¬†main
## Breadcrumbs

1. [ntp-4.2.8p15-cves](/spwpun/ntp-4.2.8p15-cves/tree/main)
/
# CVE-2023-26553

Copy path Blame  Blame
## Latest commit

## History

[History](/spwpun/ntp-4.2.8p15-cves/commits/main/CVE-2023-26553)53 lines (53 loc) ¬∑ 1.3 KB¬†main
## Breadcrumbs

1. [ntp-4.2.8p15-cves](/spwpun/ntp-4.2.8p15-cves/tree/main)
/
# CVE-2023-26553

Top
## File metadata and controls

* Code
* Blame

53 lines (53 loc) ¬∑ 1.3 KB[Raw](https://github.com/spwpun/ntp-4.2.8p15-cves/raw/refs/heads/main/CVE-2023-26553)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253> [Suggested description]> mstolfp in> libntp/mstolfp.c in NTP 4.2.8p15 has an out-of-bounds write when copying the trailing number.>> ------------------------------------------>> [Additional Information]> There is a buffer overflow error in mstolfp.c:88>> ------------------------------------------>> [Vulnerability Type]> Buffer Overflow>> ------------------------------------------>> [Vendor of Product]> The NTP Project (R&D)>> ------------------------------------------>> [Affected Product Code Base]> ntp - ntp4.2.8p15>> ------------------------------------------>> [Affected Component]> libntp, mstolfp>> ------------------------------------------>> [Attack Type]> Remote>> ------------------------------------------>> [Impact Code execution]> true>> ------------------------------------------>> [Impact Denial of Service]> true>> ------------------------------------------>> [Attack Vectors]> mstolfp.o belongs to the libntp component. As an upstream library, the libntp component can affect many other components, such as ntpd. A remote attacker may trigger this vulnerability by sending malicious data packets to the ntp server.>> ------------------------------------------>> [Reference]> https://drive.google.com/drive/folders/1vw\_Ls\_0hQGNx\_K5etxUTUDZ4GlAxMByX?usp=sharing

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_2ba68588_20250114_181233.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspwpun%2Fntp-4.2.8p15-cves%2Fissues%2F1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspwpun%2Fntp-4.2.8p15-cves%2Fissues%2F1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=spwpun%2Fntp-4.2.8p15-cves)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spwpun](/spwpun)
/
**[ntp-4.2.8p15-cves](/spwpun/ntp-4.2.8p15-cves)**
Public

* [Notifications](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves)
* [Star
   12](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves)

* [Code](/spwpun/ntp-4.2.8p15-cves)
* [Issues
  0](/spwpun/ntp-4.2.8p15-cves/issues)
* [Pull requests
  0](/spwpun/ntp-4.2.8p15-cves/pulls)
* [Actions](/spwpun/ntp-4.2.8p15-cves/actions)
* [Projects
  0](/spwpun/ntp-4.2.8p15-cves/projects)
* [Security](/spwpun/ntp-4.2.8p15-cves/security)
* [Insights](/spwpun/ntp-4.2.8p15-cves/pulse)

Additional navigation options

* [Code](/spwpun/ntp-4.2.8p15-cves)
* [Issues](/spwpun/ntp-4.2.8p15-cves/issues)
* [Pull requests](/spwpun/ntp-4.2.8p15-cves/pulls)
* [Actions](/spwpun/ntp-4.2.8p15-cves/actions)
* [Projects](/spwpun/ntp-4.2.8p15-cves/projects)
* [Security](/spwpun/ntp-4.2.8p15-cves/security)
* [Insights](/spwpun/ntp-4.2.8p15-cves/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fspwpun%2Fntp-4.2.8p15-cves%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# ntpd is not vulnerable #1

Closed

[rma-x](/rma-x) opened this issue
Apr 12, 2023
¬∑ 24 comments

Closed

# [ntpd is not vulnerable](#top) #1

[rma-x](/rma-x) opened this issue
Apr 12, 2023
¬∑ 24 comments

## Comments

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

### **[rma-x](/rma-x)** commented [Apr 12, 2023](#issue-1665282791) ‚Ä¢ edited Loading

| * The first four of these CVEs affect a function in libntp that is only used by ntpq, but not by ntpd. * The last CVE affects the driver for a hardware clock (GPS receiver), so ntpd might be vulnerable to manipulated devices of that type, but not to remote attacks. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
4
 lehrhardt-tarent, spwpun, defnull, and tsahara reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

[![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=80&u=952035b7475c463ed15d2599642572da0997b8db&v=4)](/spwpun)

Copy link

Owner

### **[spwpun](/spwpun)** commented [Apr 13, 2023](#issuecomment-1506333692)

| [@rma-x](https://github.com/rma-x) Are you a member of ntp group? I have reported these issues to ntp group (security.ntp@rt.nwtime.org), but didn't receive any response in 1 month, if you are sure that you are right, then maybe you could submit a PR, so other researchers can obtain the correct information, maybe to fix NVD's analysis. |
| --- |

All reactions

Sorry, something went wrong.

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 13, 2023](#issuecomment-1506402620)

| I am the maintainer of the ntp package at SUSE, but SUSE is not a member of the Network Time Foundation.  But where did you get that email address you tried to contact? According to <https://www.ntp.org/bugs/> security issues should be reported to security@ntp.org . But OTOH, yes, ntp upstream tends to be unresponsive, I've experienced that myself in the past.  In the meantime I double-checked that `mstolfp()` does not get linked into ntpd, by adding a unique string to the function, which after compilation was only found in the ntpq binary, but not in ntpd with libntp being linked statically into both binaries.  I will now also double-check to make sure the buggy code in `refclock_palisade.c` never gets called with data received from the network. |
| --- |

 üëç
1
 rrzefox reacted with thumbs up emoji
 ‚ù§Ô∏è
2
 mnordhoff and abh reacted with heart emoji

All reactions

* üëç
  1 reaction
* ‚ù§Ô∏è
  2 reactions

Sorry, something went wrong.

[![@mburnicki](https://avatars.githubusercontent.com/u/13132937?s=80&u=33b522cdb7b777a3dbc5d023f09e09835a2df6bd&v=4)](/mburnicki)

Copy link

### **[mburnicki](/mburnicki)** commented [Apr 13, 2023](#issuecomment-1506514700)

| I'm in loose contact with the folks at ntp.org/nwtime.org. It's really bad that the email to security@ntp.org obviously wasn't handled, but now the maintainers are aware of the issues and are working on them. Since it should not be too hard to fix the issues, I guess the fix will be available really soon. |
| --- |

 ‚ù§Ô∏è
1
 abh reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 13, 2023](#issuecomment-1506522935)

| Thanks, [@mburnicki](https://github.com/mburnicki)  Yes, the bugs should be easy to fix for someone who is familiar with the code base, but I think it is important to state that the actual vulnerability they create is by far smaller than initially stated.  I meanwhile did a more in-depth analysis of `refclock_palisade.c`. It confirmed my former assumption that `praecis_parse()` only ever gets to see data that was received via a TTY from a certain GPS receiver, and only if such a GPS receiver is configured in `ntp.conf`, but it never gets called with data that was received over the network. |
| --- |

 üëç
3
 rrzefox, paulgear, and abh reacted with thumbs up emoji
 ‚ù§Ô∏è
1
 mnordhoff reacted with heart emoji

All reactions

* üëç
  3 reactions
* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@mburnicki](https://avatars.githubusercontent.com/u/13132937?s=80&u=33b522cdb7b777a3dbc5d023f09e09835a2df6bd&v=4)](/mburnicki)

Copy link

### **[mburnicki](/mburnicki)** commented [Apr 13, 2023](#issuecomment-1506535678)

| [@rma-x](https://github.com/rma-x)  Indeed the palisade driver is for a specific (old) GPS device, and in fact the driver is only used at all if a palisade GPS receiver has explicitly been configured in ntp.conf. I doubt that this type of GPS receiver is widely used today. |
| --- |

 üëç
1
 hildeb reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@mburnicki](https://avatars.githubusercontent.com/u/13132937?s=80&u=33b522cdb7b777a3dbc5d023f09e09835a2df6bd&v=4)](/mburnicki)

Copy link

### **[mburnicki](/mburnicki)** commented [Apr 13, 2023](#issuecomment-1506542825)

| I agree with [@rma-x](https://github.com/rma-x) that (beside the palisade driver) the CVEs only affect ntpq, not ntpd. |
| --- |

 üëç
2
 hildeb and paulgear reacted with thumbs up emoji
 üéâ
1
 hildeb reacted with hooray emoji

All reactions

* üëç
  2 reactions
* üéâ
  1 reaction

Sorry, something went wrong.

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 13, 2023](#issuecomment-1506546409)

| The palisade driver actually supports eight different GPS receiver models or protocols, but only one of them (Praecis) is affected by the bug. And even if it were used more widely, an exploit would require a manipulated GPS receiver that sends overlong lines to the driver. This means physical access or a compromised host would be needed (if the device allows firmware updates over serial), so we're not looking at an RCE vulnerability here, even on installations that do use this driver. |
| --- |

All reactions

Sorry, something went wrong.

[![@hstenn](https://avatars.githubusercontent.com/u/7874439?s=80&v=4)](/hstenn)

Copy link

### **[hstenn](/hstenn)** commented [Apr 13, 2023](#issuecomment-1506667321)

| I'm the NTP Project's PM, and we never saw your reports.  To summarize, the first 4 do not affect ntpd and would *seem* to require the attacker to make malicious changes to an ntpd instance that would then send bogus data to a client ntpq process. The last item seems "mild" given [@rma-x](https://github.com/rma-x)'s comment above.  [@spwpun](https://github.com/spwpun) where did you see that you should report security bugs in NTP to security.ntp@rt.nwtime.org? If you didn't get a response to your earlier report, why didn't you reach out some other way?  We've been upgrading our email and security@ subsystems lately, and that process is not yet complete. It seems likely that as part of this upgrade is part of that problem. |
| --- |

 üòï
1
 hildeb reacted with confused emoji

All reactions

* üòï
  1 reaction

Sorry, something went wrong.

[![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=80&u=952035b7475c463ed15d2599642572da0997b8db&v=4)](/spwpun)

Copy link

Owner

### **[spwpun](/spwpun)** commented [Apr 13, 2023](#issuecomment-1506740770)

| [@hstenn](https://github.com/hstenn) As you said, these cves maybe have lower affect then stated in description because my few expert's knowledge.  On the other hand, we first submit report to security@ntp.org, but received auto-reply from security.ntp@rt.nwtime.org. The following is a screenshot of the emailÔºö [image](https://user-images.githubusercontent.com/32606457/231733046-20968d22-7b66-41b6-922c-a00d201793e7.png) |
| --- |

 ‚ù§Ô∏è
1
 hildeb reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@hstenn](https://avatars.githubusercontent.com/u/7874439?s=80&v=4)](/hstenn)

Copy link

### **[hstenn](/hstenn)** commented [Apr 13, 2023](#issuecomment-1506764613)

| Fair enough, thanks, and now I have something to point to so our RT admin can fix that.  But when you didn't get a response other than from an automated system, why didn't you reach out to any of us in any other way? |
| --- |

 üòï
1
 mauke reacted with confused emoji

All reactions

* üòï
  1 reaction

Sorry, something went wrong.

[![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=80&u=952035b7475c463ed15d2599642572da0997b8db&v=4)](/spwpun)

Copy link

Owner

### **[spwpun](/spwpun)** commented [Apr 13, 2023](#issuecomment-1506769491)

| [@hstenn](https://github.com/hstenn) sorry for that, but I didn't find other way. |
| --- |

All reactions

Sorry, something went wrong.

[![@mlichvar](https://avatars.githubusercontent.com/u/2973047?s=80&v=4)](/mlichvar)

Copy link

### **[mlichvar](/mlichvar)** commented [Apr 13, 2023](#issuecomment-1506951643)

| To summarize, the first 4 do not affect ntpd and would *seem* to require the attacker to make malicious changes to an ntpd instance that would then send bogus data to a client ntpq process.  A MITM attacker sitting between ntpd and ntpq can simply craft a response containing a floating point variable which will be parsed by the problematic function. When I inject the value from the reproducer, it crashes ntpq built with the address sanitizer. valgrind doesn't report any issues.  It's not clear to me what is the difference between the four CVEs. They seem to point to the same document and reproducer. |
| --- |

All reactions

Sorry, something went wrong.

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 13, 2023](#issuecomment-1506979167)

| [@mlichvar](https://github.com/mlichvar) The four CVEs reference different code lines within `mstolfp()` that somehow participate in the overflow, but I agree that there should have been only one CVE claiming the missing length checking at the start of that function.  How did you inject that value? At the C level like the reproducers do, or as an actual packet that goes all the way through ntpq and triggers the overflow? |
| --- |

All reactions

Sorry, something went wrong.

[![@mlichvar](https://avatars.githubusercontent.com/u/2973047?s=80&v=4)](/mlichvar)

Copy link

### **[mlichvar](/mlichvar)** commented [Apr 13, 2023](#issuecomment-1506993671)

| Ok, so 3 CVEs should be marked as duplicates.  I modifed an actual response from ntpd to `ntpq -c rv` command. ntpq was not modified.  Until this is fixed and someone really needs to use ntpq over internet, a workaround is to use the `-c raw`  option to avoid reformatting the values. |
| --- |

All reactions

Sorry, something went wrong.

[![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=80&v=4)](/abergmann)

Copy link

### **[abergmann](/abergmann)** commented [Apr 13, 2023](#issuecomment-1507034339)

| I've sent an update request to MITRE.  We will keep [CVE-2023-26551](https://nvd.nist.gov/vuln/detail/CVE-2023-26551) open as the "**input validation issue with the mstolfp() function**" and mark [CVE-2023-26552](https://nvd.nist.gov/vuln/detail/CVE-2023-26552), [CVE-2023-26553](https://nvd.nist.gov/vuln/detail/CVE-2023-26553) and [CVE-2023-26554](https://nvd.nist.gov/vuln/detail/CVE-2023-26554) as duplicate.  [CVE-2023-26555](https://nvd.nist.gov/vuln/detail/CVE-2023-26555) will need an update as well. I will push this as well. |
| --- |

All reactions

Sorry, something went wrong.

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 13, 2023](#issuecomment-1507057119)

| The four CVEs reference different code lines within `mstolfp()` that somehow participate in the overflow  After looking more closely, these are lines that perform a write operation to the target location of the buffer pointer, but not all lines in the function that do so are covered. |
| --- |

All reactions

Sorry, something went wrong.

[![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=80&v=4)](/abergmann)

Copy link

### **[abergmann](/abergmann)** commented [Apr 13, 2023](#issuecomment-1507109927)

| MITRE sent a response and will not mark some of the already published CVEs as duplicated:  Thank you for your suggestions about the recent NTP CVE Records. We are generally not interested in changing the level of abstraction after CVE Records are already published. We have attempted to make improvements with:  <https://www.cve.org/CVERecord?id=CVE-2023-26551> <https://www.cve.org/CVERecord?id=CVE-2023-26552> <https://www.cve.org/CVERecord?id=CVE-2023-26553> <https://www.cve.org/CVERecord?id=CVE-2023-26554> <https://www.cve.org/CVERecord?id=CVE-2023-26555>  The first 4 CVEs are now reflecting that we have in deed a `ntpq` issue. The last CVE is mentioning that "Any attack method would be complex, e.g., with a manipulated GPS receiver." |
| --- |

 üëç
1
 mburnicki reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=80&u=952035b7475c463ed15d2599642572da0997b8db&v=4)](/spwpun)

Copy link

Owner

### **[spwpun](/spwpun)** commented [Apr 13, 2023](#issuecomment-1507131206)

| [@abergmann](https://github.com/abergmann) Thank you for your discussion, let me learn a lot. |
| --- |

 ‚ù§Ô∏è
2
 abergmann and dennisguse reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  2 reactions

Sorry, something went wrong.

[![@abh](https://avatars.githubusercontent.com/u/16861?s=80&v=4)](/abh)

Copy link

### **[abh](/abh)** commented [Apr 14, 2023](#issuecomment-1507772094)

| Thank you [@rma-x](https://github.com/rma-x), [@mburnicki](https://github.com/mburnicki) & [@mlichvar](https://github.com/mlichvar) for doing the analysis! (And [@hstenn](https://github.com/hstenn) for working on an update). |
| --- |

All reactions

Sorry, something went wrong.

[![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=40&u=952035b7475c463ed15d2599642572da0997b8db&v=4)](/spwpun)
[spwpun](/spwpun)
closed this as [completed](/spwpun/ntp-4.2.8p15-cves/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 16, 2023](#event-9015475198)

[![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=80&v=4)](/rma-x)

Copy link

Author

### **[rma-x](/rma-x)** commented [Apr 18, 2023](#issuecomment-1512672389)

| [@hstenn](https://github.com/hstenn) Can you estimate when an official fix will be available? |
| --- |

All reactions

Sorry, something went wrong.

[![@mlichvar](https://avatars.githubusercontent.com/u/2973047?s=80&v=4)](/mlichvar)

Copy link

### **[mlichvar](/mlichvar)** commented [Apr 20, 2023](#issuecomment-1516242868)

| If anyone needs to fix the four mstolfp() issues before the upstream releases their fix, here is a minimal patch:  ``` diff -up ntp-4.2.8p15/libntp/mstolfp.c.orig ntp-4.2.8p15/libntp/mstolfp.c --- ntp-4.2.8p15/libntp/mstolfp.c.orig  2020-03-04 00:41:29.000000000 +0100 +++ ntp-4.2.8p15/libntp/mstolfp.c       2023-04-20 14:13:52.944003519 +0200 @@ -14,7 +14,7 @@ mstolfp(         l_fp *lfp         )  { -       register const char *cp; +       register const char *cp, *end;         register char *bp;         register const char *cpdec;         char buf[100]; @@ -42,6 +42,15 @@ mstolfp(         if (*cp != '.' && !isdigit((unsigned char)*cp))             return 0;   +       /* +        * Make sure the buffer has enough room for the input string and the +        * extra characters, in the worst case replacing "." with "0.000" +        */ +       end = cp; +       while (isdigit((unsigned char)*end) || *end == '.') +           end++; +       if (end - cp + 4 >= sizeof (buf) - (bp - buf)) +           return 0;           /*          * Search forward for the decimal point or the end of the string.  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mlichvar](https://avatars.githubusercontent.com/u/2973047?s=80&v=4)](/mlichvar)

Copy link

### **[mlichvar](/mlichvar)** commented [Apr 20, 2023](#issuecomment-1516253354) ‚Ä¢ edited Loading

| For completeness, there are five lines in the source code where the overflow can occur. The one that doesn't have a CVE assigned corresponds to the "If we have more than three digits copy the excess over" comment in the `while ((cpdec - cp) > 3)` loop. |
| --- |

All reactions

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Jun 6, 2023](#issuecomment-1577973802) ‚Ä¢ edited Loading

| [@hstenn](https://github.com/hstenn) Can you estimate when an official fix will be available?  Version 4.2.8p16 has been released in the meantime which should include fixes (at least two entries out of the four are referring to `spwpun`):   * <https://www.ntp.org/support/securitynotice/#428p16> * <https://www.ntp.org/support/securitynotice/4_2_8p16-release-announcement/> |
| --- |

All reactions

Sorry, something went wrong.

[![@hstenn](https://avatars.githubusercontent.com/u/7874439?s=80&v=4)](/hstenn)

Copy link

### **[hstenn](/hstenn)** commented [Jun 6, 2023](#issuecomment-1578345198) via email

| p16 contained the fixes, and was published on 30 May. Sadly, that release contained a regression, and I'm in the process of releasing p17 now. ‚Ä¶ On 6/5/2023 11:09 PM, Christian Fischer wrote: [@hstenn](https://github.com/hstenn) <<https://github.com/hstenn>> Can you estimate when an official fix will be available? Version 4.2.8p16 has been released in the meantime which should include the fixes: \* <https://www.ntp.org/support/securitynotice/#428p16> <<https://www.ntp.org/support/securitynotice/#428p16>> \* <https://www.ntp.org/support/securitynotice/4_2_8p16-release-announcement/> <<https://www.ntp.org/support/securitynotice/4_2_8p16-release-announcement/>> ‚Äî Reply to this email directly, view it on GitHub <[#1 (comment)](https://github.com/spwpun/ntp-4.2.8p15-cves/issues/1#issuecomment-1577973802)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AB4CPB7L7M33I2CI3AJUK2LXJ3CTNANCNFSM6AAAAAAW4HBXJ4>>. You are receiving this because you were mentioned.Message ID: \*\*\*@\*\*\*.\*\*\*> |
| --- |

 üëç
1
 cfi-gb reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fspwpun%2Fntp-4.2.8p15-cves%2Fissues%2F1)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

8 participants

[![@abh](https://avatars.githubusercontent.com/u/16861?s=52&v=4)](/abh) [![@mlichvar](https://avatars.githubusercontent.com/u/2973047?s=52&v=4)](/mlichvar) [![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=52&v=4)](/abergmann) [![@rma-x](https://avatars.githubusercontent.com/u/4435732?s=52&v=4)](/rma-x) [![@hstenn](https://avatars.githubusercontent.com/u/7874439?s=52&v=4)](/hstenn) [![@mburnicki](https://avatars.githubusercontent.com/u/13132937?s=52&v=4)](/mburnicki) [![@spwpun](https://avatars.githubusercontent.com/u/32606457?s=52&v=4)](/spwpun) [![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=52&v=4)](/cfi-gb)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_c8f5f30d_20250115_111930.html ===
> [Suggested description]
> mstolfp in
> libntp/mstolfp.c in NTP 4.2.8p15 has an out-of-bounds write when copying the trailing number.
>
> ------------------------------------------
>
> [Additional Information]
> There is a buffer overflow error in mstolfp.c:88
>
> ------------------------------------------
>
> [Vulnerability Type]
> Buffer Overflow
>
> ------------------------------------------
>
> [Vendor of Product]
> The NTP Project (R&D)
>
> ------------------------------------------
>
> [Affected Product Code Base]
> ntp - ntp4.2.8p15
>
> ------------------------------------------
>
> [Affected Component]
> libntp, mstolfp
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> mstolfp.o belongs to the libntp component. As an upstream library, the libntp component can affect many other components, such as ntpd. A remote attacker may trigger this vulnerability by sending malicious data packets to the ntp server.
>
> ------------------------------------------
>
> [Reference]
> https://drive.google.com/drive/folders/1vw\_Ls\_0hQGNx\_K5etxUTUDZ4GlAxMByX?usp=sharing

