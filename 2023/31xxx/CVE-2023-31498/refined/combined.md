=== Content from gist.github.com_a435204f_20250114_210015.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832&source=header-gist)

[Sign¬†in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832) [Sign¬†up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@captain-noob](https://avatars.githubusercontent.com/u/56505395?s=64&v=4)](/captain-noob)

# [captain-noob](/captain-noob)/**[CVE-2023-31498.md](/captain-noob/aff11542477ddd0a92ad8b94ec75f832)**

Last active
May 9, 2023 19:00

Show Gist options

* [Download ZIP](/captain-noob/aff11542477ddd0a92ad8b94ec75f832/archive/3df33baf9888a2a57a7b356bfe59d9614f7a0da1.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/captain-noob/aff11542477ddd0a92ad8b94ec75f832.js&quot;&gt;&lt;/script&gt;
* Save captain-noob/aff11542477ddd0a92ad8b94ec75f832 to your computer and use it in GitHub Desktop.

[Code](/captain-noob/aff11542477ddd0a92ad8b94ec75f832)
[Revisions
4](/captain-noob/aff11542477ddd0a92ad8b94ec75f832/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/captain-noob/aff11542477ddd0a92ad8b94ec75f832.js&quot;&gt;&lt;/script&gt;

Save captain-noob/aff11542477ddd0a92ad8b94ec75f832 to your computer and use it in GitHub Desktop.

[Download ZIP](/captain-noob/aff11542477ddd0a92ad8b94ec75f832/archive/3df33baf9888a2a57a7b356bfe59d9614f7a0da1.zip)

Session hijacking leading to privilege escalation

 [Raw](/captain-noob/aff11542477ddd0a92ad8b94ec75f832/raw/3df33baf9888a2a57a7b356bfe59d9614f7a0da1/CVE-2023-31498.md)

[**CVE-2023-31498.md**](#file-cve-2023-31498-md)

# CVE-2023-31498 - Session hijacking leading to privilege escalation

```
Author: captain-noob
Vendor: PHPGurukul (https://phpgurukul.com/)
Software: Hospital Management System In PHP(https://phpgurukul.com/hospital-management-system-in-php)
```

## Description

The Hospital Management System (HMS) allows users to register as patients and provides separate logins for doctors and admins. However, the system does not have proper session management in place, making it vulnerable to session hijacking. An attacker can register as a patient and obtain a valid session token. With this token, the attacker can then access the Doctor and Admin panels without any authentication credentials. This vulnerability can be exploited to perform privilege escalation, enabling the attacker to access sensitive areas of the system beyond their intended privileges.

## Impact

An attacker can exploit this vulnerability to gain unauthorized access to sensitive areas of the system, such as patient records or administrative functions. This could potentially result in a data breach or other serious security incidents

## Proof of Concept:

```
1. Install The Hospital Management System
2. Navigate to the Patient Login page (http://<domain:port>/hms/user-login.php).
3. Click on create an account and register a patient  (http://<domain:port>/hms/registration.php)
4. Once patient is created, navigate to login page and login with the credientials.
5. After successuful login Navigate to Doctor dashboard (http://<domain:port>/hms/doctor/dashboard.php). Observe that without any authentication credientials attacker got access to doctor dashboard.
6.Similarly, try to access the Admin dashboard at http://domain:port/hms/admin/dashboard.php. Again, note that the attacker is able to access the dashboard without any admin credentials.

```
## Remediation

The system should implement proper session management to prevent session hijacking and privilege escalation. Specifically, the system should assign a specific role to each user upon registration and verify the role before allowing access to sensitive areas of the system. Additionally, the system should implement a mechanism to invalidate sessions upon logout or after a period of inactivity.

For example, you could use the following code to set the role of the user upon login:

```
// login as a patient
$_SESSION['role'] = 'patient';

// login as a doctor
$_SESSION['role'] = 'doctor';

// login as an admin
$_SESSION['role'] = 'admin';
```

Then, in the session check code, you can verify if the user has the correct role before allowing them access to the doctor or admin panel. Here's an example code:

```
if(!isset($_SESSION['role']) || $_SESSION['role'] !== 'doctor' || $_SESSION['role'] !== 'admin') {
 header('location:logout.php');
} else{
//login function
}
```

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcaptain-noob%2Faff11542477ddd0a92ad8b94ec75f832)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_1debbd1c_20250114_210016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcaptain-noob)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcaptain-noob)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@captain-noob](https://avatars.githubusercontent.com/u/56505395?s=64&v=4)

**captain-noob**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcaptain-noob)

[Overview](/captain-noob)
[Repositories
26](/captain-noob?tab=repositories)
[Projects
0](/captain-noob?tab=projects)
[Packages
0](/captain-noob?tab=packages)
[Stars
27](/captain-noob?tab=stars)

More

* [Overview](/captain-noob)
* [Repositories](/captain-noob?tab=repositories)
* [Projects](/captain-noob?tab=projects)
* [Packages](/captain-noob?tab=packages)
* [Stars](/captain-noob?tab=stars)

![@captain-noob](https://avatars.githubusercontent.com/u/56505395?s=64&v=4)

**captain-noob**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcaptain-noob)

[![View captain-noob's full-sized avatar](https://avatars.githubusercontent.com/u/56505395?v=4)](https://avatars.githubusercontent.com/u/56505395?v=4)
üåê

Exploiting

# Roshan Cheriyan captain-noob

üåê

Exploiting

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcaptain-noob)

Programmer, Pentester
Reverse Engineering
Cybersecurity Researcher
[10
followers](https://github.com/captain-noob?tab=followers) ¬∑ [3
following](https://github.com/captain-noob?tab=following)

* india
* <https://captainnoob.medium.com/>
* X
  [@captain\_\_noob](https://twitter.com/captain__noob)

## [Achievements](/captain-noob?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--light-medium-65b31ef2251e.png)](/captain-noob?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/captain-noob?achievement=pull-shark&tab=achievements)
## [Achievements](/captain-noob?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--light-medium-65b31ef2251e.png)](/captain-noob?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/captain-noob?achievement=pull-shark&tab=achievements)
## Highlights

* [Developer Program Member](https://docs.github.com/developers/overview/github-developer-program)

Block or Report

# Block or report captain-noob

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=captain-noob+%28user%29)

[Overview](/captain-noob)
[Repositories
26](/captain-noob?tab=repositories)
[Projects
0](/captain-noob?tab=projects)
[Packages
0](/captain-noob?tab=packages)
[Stars
27](/captain-noob?tab=stars)

More

* [Overview](/captain-noob)
* [Repositories](/captain-noob?tab=repositories)
* [Projects](/captain-noob?tab=projects)
* [Packages](/captain-noob?tab=packages)
* [Stars](/captain-noob?tab=stars)

## Pinned Loading

1. [background-remover](/captain-noob/background-remover) background-remover Public

   Python3 Based Background Remover (OpenCV) -[Works For All 60% images]

   Python

   [6](/captain-noob/background-remover/stargazers)
   [2](/captain-noob/background-remover/forks)
2. [username-wordlist-generator](/captain-noob/username-wordlist-generator) username-wordlist-generator Public

   This is a Python tool is used to generate username wordlist for bruteforcing or gussing..................

   Python

   [23](/captain-noob/username-wordlist-generator/stargazers)
   [2](/captain-noob/username-wordlist-generator/forks)
3. [su-bruteForcer](/captain-noob/su-bruteForcer) su-bruteForcer Public

   Simple brute forcer for su program. Very slow. Very terrible.. But accurate, Trying to make fast

   Python

   [4](/captain-noob/su-bruteForcer/stargazers)
4. [vulnscanner](/captain-noob/vulnscanner) vulnscanner Public

   vulnscanner is a web application source code vulnerability scanner. It could be used to detect if the target project contains any known vulnerabilities. One of the best ways we can do that is to he‚Ä¶

   PHP

   [4](/captain-noob/vulnscanner/stargazers)
   [2](/captain-noob/vulnscanner/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from twitter.com_bc65e669_20250114_210017.html ===


