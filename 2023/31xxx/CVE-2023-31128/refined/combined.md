=== Content from github.com_98f9b26d_20250115_085822.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2F489bb744)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2F489bb744)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=nextcloud%2Fcookbook)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextcloud](/nextcloud)
/
**[cookbook](/nextcloud/cookbook)**
Public

* [Notifications](/login?return_to=%2Fnextcloud%2Fcookbook) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fnextcloud%2Fcookbook)
* [Star
   546](/login?return_to=%2Fnextcloud%2Fcookbook)

* [Code](/nextcloud/cookbook)
* [Issues
  246](/nextcloud/cookbook/issues)
* [Pull requests
  22](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects
  1](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

Additional navigation options

* [Code](/nextcloud/cookbook)
* [Issues](/nextcloud/cookbook/issues)
* [Pull requests](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

## Commit

[Permalink](/nextcloud/cookbook/commit/489bb7442793d7fb1847aa1e8380d887c573ec4c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix typo in workflow file

[Browse files](/nextcloud/cookbook/tree/489bb7442793d7fb1847aa1e8380d887c573ec4c)
Browse the repository at this point in the history

```
Signed-off-by: Christian Wolf <github@christianwolf.email>
```

* Loading branch information

[![@christianlupus](https://avatars.githubusercontent.com/u/8202922?s=40&v=4)](/christianlupus)

[christianlupus](/nextcloud/cookbook/commits?author=christianlupus "View all commits by christianlupus")
committed
May 16, 2023

1 parent
[04110d3](/nextcloud/cookbook/commit/04110d309ca847ff26836177dde854a6e23f7bd2)

commit 489bb74

Showing
**1 changed file**
with
**5 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 5 additions & 2 deletions

7
[.github/workflows/pull-checks.yml](#diff-aa765b880864df1e05d3e7c7f7b30b1e108fa5ef68aad9b40696b1d8247769d6 ".github/workflows/pull-checks.yml")

Show comments

[View file](/nextcloud/cookbook/blob/489bb7442793d7fb1847aa1e8380d887c573ec4c/.github/workflows/pull-checks.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,11 +60,14 @@ jobs: |
|  |  |  |
|  |  | git clone --filter=tree:0 "$REPO" . |
|  |  | - name: Manual checkout of the app (PR head) |
|  |  | env: |
|  |  | URL: ${{ github.event.pull\_request.head.repo.html\_url }} |
|  |  | HEAD\_REF: ${{ github.head\_ref }} |
|  |  | run: | |
|  |  | git remote add head "${{ github.event.pull\_request.head.repo.html\_url }}" |
|  |  | git remote add head "$URL" |
|  |  | git fetch head --filter=tree:0 |
|  |  |  |
|  |  | git checkout -b head-branch head/${{ github.head\_ref }} |
|  |  | git checkout -b head-branch head/$HEAD\_REF |
|  |  | - name: Status of current git workspace |
|  |  | run: | |
|  |  | git branch |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `489bb74`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2F489bb744) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7b6d47ad_20250115_085823.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2Fa46d98559e2c64292da9ffb06138cccc2e50ae1b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2Fa46d98559e2c64292da9ffb06138cccc2e50ae1b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=nextcloud%2Fcookbook)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextcloud](/nextcloud)
/
**[cookbook](/nextcloud/cookbook)**
Public

* [Notifications](/login?return_to=%2Fnextcloud%2Fcookbook) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fnextcloud%2Fcookbook)
* [Star
   546](/login?return_to=%2Fnextcloud%2Fcookbook)

* [Code](/nextcloud/cookbook)
* [Issues
  246](/nextcloud/cookbook/issues)
* [Pull requests
  22](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects
  1](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

Additional navigation options

* [Code](/nextcloud/cookbook)
* [Issues](/nextcloud/cookbook/issues)
* [Pull requests](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

## Commit

[Permalink](/nextcloud/cookbook/commit/a46d98559e2c64292da9ffb06138cccc2e50ae1b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix typo in workflow file

[Browse files](/nextcloud/cookbook/tree/a46d98559e2c64292da9ffb06138cccc2e50ae1b)
Browse the repository at this point in the history

```
Signed-off-by: Christian Wolf <github@christianwolf.email>
```

* Loading branch information

[![@christianlupus](https://avatars.githubusercontent.com/u/8202922?s=40&v=4)](/christianlupus)

[christianlupus](/nextcloud/cookbook/commits?author=christianlupus "View all commits by christianlupus")
committed
May 16, 2023

1 parent
[7097b16](/nextcloud/cookbook/commit/7097b16872e872b8a7a9605f39710df9a4154f4f)

commit a46d985

Showing
**1 changed file**
with
**5 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 5 additions & 2 deletions

7
[.github/workflows/pull-checks.yml](#diff-aa765b880864df1e05d3e7c7f7b30b1e108fa5ef68aad9b40696b1d8247769d6 ".github/workflows/pull-checks.yml")

Show comments

[View file](/nextcloud/cookbook/blob/a46d98559e2c64292da9ffb06138cccc2e50ae1b/.github/workflows/pull-checks.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,11 +60,14 @@ jobs: |
|  |  |  |
|  |  | git clone --filter=tree:0 "$REPO" . |
|  |  | - name: Manual checkout of the app (PR head) |
|  |  | env: |
|  |  | URL: ${{ github.event.pull\_request.head.repo.html\_url }} |
|  |  | HEAD\_REF: ${{ github.head\_ref }} |
|  |  | run: | |
|  |  | git remote add head "${{ github.event.pull\_request.head.repo.html\_url }}" |
|  |  | git remote add head "$URL" |
|  |  | git fetch head --filter=tree:0 |
|  |  |  |
|  |  | git checkout -b head-branch head/${{ github.head\_ref }} |
|  |  | git checkout -b head-branch head/$HEAD\_REF |
|  |  | - name: Status of current git workspace |
|  |  | run: | |
|  |  | git branch |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a46d985`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fcommit%2Fa46d98559e2c64292da9ffb06138cccc2e50ae1b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ee32cb73_20250115_085824.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fsecurity%2Fadvisories%2FGHSA-c5pc-mf2f-xq8h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fsecurity%2Fadvisories%2FGHSA-c5pc-mf2f-xq8h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nextcloud%2Fcookbook)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextcloud](/nextcloud)
/
**[cookbook](/nextcloud/cookbook)**
Public

* [Notifications](/login?return_to=%2Fnextcloud%2Fcookbook) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fnextcloud%2Fcookbook)
* [Star
   546](/login?return_to=%2Fnextcloud%2Fcookbook)

* [Code](/nextcloud/cookbook)
* [Issues
  246](/nextcloud/cookbook/issues)
* [Pull requests
  22](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects
  1](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

Additional navigation options

* [Code](/nextcloud/cookbook)
* [Issues](/nextcloud/cookbook/issues)
* [Pull requests](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

# pull-checks.yml workflow is vulnerable

Moderate

[christianlupus](/christianlupus)
published
GHSA-c5pc-mf2f-xq8h
May 20, 2023

## Package

No package listed

## Affected versions

master <= 7097b168
main-0.9.x <= 04110d30

## Patched versions

master >= a46d9855
main-0.9.x >= 489bb744

## Description

### Summary

The **pull-checks.yml** workflow is vulnerable to command injection attacks because of using an untrusted **github.head\_ref** field.

### Details

[cookbook/.github/workflows/pull-checks.yml](https://github.com/nextcloud/cookbook/blob/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml#L67)

Line 67
in
[a14d6ff](/nextcloud/cookbook/commit/a14d6ffc4d45e1447556f68606129dfd6c1505cf)

|  | git checkout -b head-branch head/${{ github.head\_ref }} |
| --- | --- |

You can check this blog post for details: <https://securitylab.github.com/research/github-actions-untrusted-input/>

### PoC

The **github.head\_ref** value is an attacker-controlled value. Assigning the value to `zzz";echo${IFS}"hello";#` can lead to command injection.

### Impact

Since the permission is not restricted, the attacker has a write-access to the repository.

There is no risk for the user of the app within the nextcloud server. This only affects the main repository and possible forks of it. Make sure your fork is on the latest version to prevent code injection attacks and similar.

### Severity

Moderate

### CVE ID

CVE-2023-31128

### Weaknesses

[CWE-78](/advisories?query=cwe%3A78)

### Credits

* [![@igibek](https://avatars.githubusercontent.com/u/4621646?s=40&v=4)](/igibek)
  [igibek](/igibek)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securitylab.github.com_acc3fe91_20250115_085825.html ===


Redirecting…

# Redirecting…

[Click here if you are not redirected.](https://securitylab.github.com/resources/github-actions-untrusted-input)



=== Content from github.com_480b1578_20250115_085820.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fblob%2Fa14d6ffc4d45e1447556f68606129dfd6c1505cf%2F.github%2Fworkflows%2Fpull-checks.yml)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fcookbook%2Fblob%2Fa14d6ffc4d45e1447556f68606129dfd6c1505cf%2F.github%2Fworkflows%2Fpull-checks.yml)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nextcloud%2Fcookbook)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextcloud](/nextcloud)
/
**[cookbook](/nextcloud/cookbook)**
Public

* [Notifications](/login?return_to=%2Fnextcloud%2Fcookbook) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fnextcloud%2Fcookbook)
* [Star
   546](/login?return_to=%2Fnextcloud%2Fcookbook)

* [Code](/nextcloud/cookbook)
* [Issues
  246](/nextcloud/cookbook/issues)
* [Pull requests
  22](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects
  1](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

Additional navigation options

* [Code](/nextcloud/cookbook)
* [Issues](/nextcloud/cookbook/issues)
* [Pull requests](/nextcloud/cookbook/pulls)
* [Discussions](/nextcloud/cookbook/discussions)
* [Actions](/nextcloud/cookbook/actions)
* [Projects](/nextcloud/cookbook/projects)
* [Security](/nextcloud/cookbook/security)
* [Insights](/nextcloud/cookbook/pulse)

## Files

 a14d6ff
## Breadcrumbs

1. [cookbook](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf)
2. /[.github](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github)
3. /[workflows](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows)
/
# pull-checks.yml

Copy path [View Runs](/nextcloud/cookbook/actions/workflows/pull-checks.yml)Blame  Blame
## Latest commit

## History

[History](/nextcloud/cookbook/commits/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml)162 lines (136 loc) · 6.21 KB a14d6ff
## Breadcrumbs

1. [cookbook](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf)
2. /[.github](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github)
3. /[workflows](/nextcloud/cookbook/tree/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows)
/
# pull-checks.yml

Top
## File metadata and controls

* Code
* Blame

162 lines (136 loc) · 6.21 KB[Raw](https://github.com/nextcloud/cookbook/raw/a14d6ffc4d45e1447556f68606129dfd6c1505cf/.github/workflows/pull-checks.yml)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162
name: Additional tests for pull requests
on: pull\_request:
jobs:  changelog: name: Check if the changelog was updated runs-on: ubuntu-latest  steps: - name: Checkout the app uses: actions/checkout@v3 with: fetch-depth: 2  - name: Get the diff id: diff run: | git diff HEAD~1 -- CHANGELOG.md lines=$(git diff HEAD~1 -- CHANGELOG.md | wc -l) echo "lines=$lines" >> $GITHUB\_OUTPUT  - name: Get all changed file names id: file-names run: | lines="$(git diff HEAD~1 --name-only)" echo "Changed files:" echo "$lines" totalcnt="$(echo "$lines" | wc -l)" echo "totalcount=$totalcnt" >> $GITHUB\_OUTPUT # cnt="$(echo "$lines" | grep -v '^package-lock.json$' | grep -v '^\.github/workflows/' | wc -l)" echo "num=$cnt" >> $GITHUB\_OUTPUT # echo "That are $totalcnt changed files. After reducing the number there are $cnt files left."
 - name: Error/warn if the number of diff lines is zero run: | if [ ${{ steps.file-names.outputs.num }} -gt 0 ]; then echo "::error file=CHANGELOG.md::There was no change in the changelog detected. Please fill in a valid entry into that file." exit 1 else echo "::warning file=CHANGELOG.md::There was no change in the changelog detected. There are in total ${{ steps.file-names.outputs.totalcount }} changed files." fi if: ${{ steps.diff.outputs.lines == 0 }}  todo-checker: name: Check for added todo messages runs-on: ubuntu-latest steps: - name: Git version output run: git version - name: Manual checkout of the app (base repo) run: | REPO="https://${GITHUB\_ACTOR}:${GITHUB\_TOKEN}@github.com/${GITHUB\_REPOSITORY}.git" BRANCH="${GITHUB\_REF/#refs\/heads\//}"
 git clone --filter=tree:0 "$REPO" . - name: Manual checkout of the app (PR head) run: | git remote add head "${{ github.event.pull\_request.head.repo.html\_url }}" git fetch head --filter=tree:0  git checkout -b head-branch head/${{ github.head\_ref }} - name: Status of current git workspace run: | git branch git status - name: Check for open TODO annotations in source code uses: ./.github/actions/check-todo
 appinfo: name: Check for matching app info file runs-on: ubuntu-latest
 steps: - name: Checkout of the app uses: actions/checkout@v3 with: fetch-depth: 1  - name: Install dependencies run: | sudo apt-get update sudo apt-get install jq pip install yq
 - name: Perform the test env: MAIN\_FILE: appinfo/info.xml DIST\_FILE: .github/actions/deploy/appinfo/info.xml.dist run: | echo "Normalize the actual appinfo file"  xq -x 'del(.info.version)' "$MAIN\_FILE" > /tmp/main-info.xml xq -x 'del(.info.version)' "$DIST\_FILE" > /tmp/dist-info.xml
 echo '::group::Debug output' tail -n 100 /tmp/main-info.xml /tmp/dist-info.xml echo '::endgroup::'
 if ! diff -q /tmp/main-info.xml /tmp/dist-info.xml > /dev/null; then echo '::error::The app info file differs from the dist file. Please check manually!' exit 1 fi
 - name: Download schema run: wget https://raw.githubusercontent.com/nextcloud/appstore/master/nextcloudappstore/api/v1/release/info.xsd
 - name: Lint info.xml uses: ChristophWurst/xmllint-action@v1 with: xml-file: ./appinfo/info.xml xml-schema-file: ./info.xsd  package-lint: name: Make sure the package.json is well-formatted runs-on: ubuntu-latest
 steps: - name: Checkout of the app uses: actions/checkout@v3 with: fetch-depth: 1 - name: Get the date id: date run: echo "date=$(date +%Y-%m-%d)" >> $GITHUB\_OUTPUT - name: Cache NPM cache uses: actions/cache@v3.3.1 with: path: | ~/.npm node\_modules key: ${{ runner.os }}-node-${{ steps.date.outputs.date }}-${{ hashFiles('package-lock.json') }} restore-keys: | ${{ runner.os }}-node-${{ steps.date.outputs.date }}- ${{ runner.os }}-node-
 - name: Install NPM modules run: npm ci
 - name: Perform the test run: | npm run package-lint
 if [ $(git diff --name-only package.json | wc -l) -gt 0 ]; then echo '::error file=package.json::The package.json file is not validly formatted.' echo '::notice::It is suggested to run `npm run package-lint` and commit locally.' exit 1 fi
 fixup-check: name: Block fixup and squash commits runs-on: ubuntu-latest
 steps: - name: Run check uses: xt0rted/block-autosquash-commits-action@v2 with: repo-token: ${{ secrets.GITHUB\_TOKEN }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


