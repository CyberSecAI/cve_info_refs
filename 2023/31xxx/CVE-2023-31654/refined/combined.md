=== Content from seclists.org_965d09a0_20250114_191521.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](12)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](23)

![](/shared/images/nst-icons.svg#search)

# ODR violation in Redis Raft

---

*From*: Meng Ruijie <ruijie\_meng () u nus edu>

*Date*: Tue, 16 Jan 2024 13:34:52 +0000

---

```
[Suggested description]
Redis raft master-1b8bd86 to master-7b46079 was discovered to contain an ODR violation via the component
hiredisAllocFns at /opt/fs/redisraft/deps/hiredis/alloc.c.

[VulnerabilityType Other]
AddressSanitizer: odr-violation

[Vendor of Product]
Redis

[Affected Product Code Base]
raft - master-1b8bd86 to master-7b46079

[Affected Component]
affected executable

[Attack Type]
Remote

[Impact Code execution]
true

[Impact Denial of Service]
true

[Attack Vectors]
run redis with redisraft

[Reference]
<https://github.com/RedisLabs/redisraft/issues/600>

[Has vendor confirmed or acknowledged the vulnerability?]
true

[Discoverer]
jerrytesting
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](12)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](23)

### Current thread:

* **ODR violation in Redis Raft** *Meng Ruijie (Jan 17)*
  + [Re: ODR violation in Redis Raft](23) *Jeffrey Walton (Jan 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_7326d9de_20250114_191520.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRedisLabs%2Fredisraft%2Fissues%2F600)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRedisLabs%2Fredisraft%2Fissues%2F600)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=RedisLabs%2Fredisraft)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RedisLabs](/RedisLabs)
/
**[redisraft](/RedisLabs/redisraft)**
Public

* [Notifications](/login?return_to=%2FRedisLabs%2Fredisraft) You must be signed in to change notification settings
* [Fork
  63](/login?return_to=%2FRedisLabs%2Fredisraft)
* [Star
   826](/login?return_to=%2FRedisLabs%2Fredisraft)

* [Code](/RedisLabs/redisraft)
* [Issues
  13](/RedisLabs/redisraft/issues)
* [Pull requests
  2](/RedisLabs/redisraft/pulls)
* [Projects
  0](/RedisLabs/redisraft/projects)
* [Security](/RedisLabs/redisraft/security)
* [Insights](/RedisLabs/redisraft/pulse)

Additional navigation options

* [Code](/RedisLabs/redisraft)
* [Issues](/RedisLabs/redisraft/issues)
* [Pull requests](/RedisLabs/redisraft/pulls)
* [Projects](/RedisLabs/redisraft/projects)
* [Security](/RedisLabs/redisraft/security)
* [Insights](/RedisLabs/redisraft/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRedisLabs%2Fredisraft%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRedisLabs%2Fredisraft%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# AddressSanitizer: odr-violation #600

Closed

[jerrytesting](/jerrytesting) opened this issue
Apr 4, 2023
· 6 comments

Closed

# [AddressSanitizer: odr-violation](#top) #600

[jerrytesting](/jerrytesting) opened this issue
Apr 4, 2023
· 6 comments

## Comments

[![@jerrytesting](https://avatars.githubusercontent.com/u/10736214?s=80&v=4)](/jerrytesting)

Copy link

### **[jerrytesting](/jerrytesting)** commented [Apr 4, 2023](#issue-1654068667)

| Hey, we found one memory issue about odr-violation reported by AddressSanitizer. The following is the bug report:  ``` 3463035:M 31 Mar 2023 10:45:29.313 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect. ================================================================= ==3463035==ERROR: AddressSanitizer: odr-violation (0x000000daede0):   [1] size=40 'hiredisAllocFns' /opt/fs/redisraft/deps/hiredis/alloc.c:36:19   [2] size=40 'hiredisAllocFns' alloc.c:36:19 These globals were registered at these points:   [1]:     #0 0x46b2cd in __asan_register_globals (/opt/redis/redis-server+0x46b2cd)     #1 0x7fb714d66deb in asan.module_ctor (/opt/redis/redisraft.so+0x12cdeb)    [2]:     #0 0x46b2cd in __asan_register_globals (/opt/redis/redis-server+0x46b2cd)     #1 0xa90e0b in asan.module_ctor (/opt/redis/redis-server+0xa90e0b)  ==3463035==HINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_odr_violation=0 SUMMARY: AddressSanitizer: odr-violation: global 'hiredisAllocFns' at /opt/fs/redisraft/deps/hiredis/alloc.c:36:19 ==3463035==ABORTING  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@tezc](https://avatars.githubusercontent.com/u/17865367?s=80&v=4)](/tezc)

Copy link

Collaborator

### **[tezc](/tezc)** commented [Apr 4, 2023](#issuecomment-1496220577)

| [@jerrytesting](https://github.com/jerrytesting) thanks, this is interesting.. It makes sense, RedisRaft has hiredis in it and Redis also has hiredis in it. So, this global struct is defined in both places. I don't think it will cause a problem but probably, we should get rid of the warning. Maybe `-fvisibility=hidden` will fix the issue.  Can you share the compile flags with me so we can reproduce it?  We have sanitizer builds but it doesn't complain about this: Address sanitizer: [link](https://github.com/RedisLabs/redisraft/blob/7b4607946272340cb637fa152eae3aaa0ccad3d1/.github/workflows/daily.yml#L92) Undefined behavior sanitizer: [link](https://github.com/RedisLabs/redisraft/blob/7b4607946272340cb637fa152eae3aaa0ccad3d1/.github/workflows/daily.yml#L142) |
| --- |

All reactions

Sorry, something went wrong.

[![@jerrytesting](https://avatars.githubusercontent.com/u/10736214?s=80&v=4)](/jerrytesting)

Copy link

Author

### **[jerrytesting](/jerrytesting)** commented [Apr 5, 2023](#issuecomment-1496809547)

| Hey, sure! We just enable your sanitizer configuration. The compile flags are: For redis, `make SANITIZER=address`; For redisraft, `cmake .. -DSANITIZER=address`.  The following is the full log in one node:  ``` 2023-03-31 10:56:23 Jepsen starting  /opt/redis/redis-server --protected-mode no --bind 0.0.0.0 --dbfilename redis.rdb --loadmodule /opt/redis/redisraft.so --raft.loglevel debug --raft.log-filename raftlog.db --raft.log-max-file-size 32000 --raft.log-max-cache-size 1000000 --raft.follower-proxy no 3370038:C 31 Mar 2023 10:56:23.245 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo 3370038:C 31 Mar 2023 10:56:23.245 # Redis version=255.255.255, bits=64, commit=c297deb4, modified=0, pid=3370038, just started 3370038:C 31 Mar 2023 10:56:23.245 # Configuration loaded 3370038:M 31 Mar 2023 10:56:23.249 * Increased maximum number of open files to 10032 (it was originally set to 1024). 3370038:M 31 Mar 2023 10:56:23.249 * monotonic clock: POSIX clock_gettime 3370038:M 31 Mar 2023 10:56:23.253 * Running mode=standalone, port=6379. 3370038:M 31 Mar 2023 10:56:23.253 # Server initialized 3370038:M 31 Mar 2023 10:56:23.253 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect. ================================================================= ==3370038==ERROR: AddressSanitizer: odr-violation (0x000000daede0):   [1] size=40 'hiredisAllocFns' /opt/fs/redisraft/deps/hiredis/alloc.c:36:19   [2] size=40 'hiredisAllocFns' alloc.c:36:19 These globals were registered at these points:   [1]:     #0 0x46b2cd in __asan_register_globals (/opt/redis/redis-server+0x46b2cd)     #1 0x7fd6f8c66deb in asan.module_ctor (/opt/redis/redisraft.so+0x12cdeb)    [2]:     #0 0x46b2cd in __asan_register_globals (/opt/redis/redis-server+0x46b2cd)     #1 0xa90e0b in asan.module_ctor (/opt/redis/redis-server+0xa90e0b)  ==3370038==HINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_odr_violation=0 SUMMARY: AddressSanitizer: odr-violation: global 'hiredisAllocFns' at /opt/fs/redisraft/deps/hiredis/alloc.c:36:19 ==3370038==ABORTING  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@tezc](https://avatars.githubusercontent.com/u/17865367?s=80&v=4)](/tezc)

Copy link

Collaborator

### **[tezc](/tezc)** commented [Apr 5, 2023](#issuecomment-1497964282)

| I cannot reproduce this on my local. What is the compiler version & operating system? Do you run our Jepsen tests with address sanitizer build? |
| --- |

All reactions

Sorry, something went wrong.

[![@jerrytesting](https://avatars.githubusercontent.com/u/10736214?s=80&v=4)](/jerrytesting)

Copy link

Author

### **[jerrytesting](/jerrytesting)** commented [Apr 6, 2023](#issuecomment-1498424327)

| We use the Linux system with the clang-12. We use your Jepsen harness but run on our tool, which is one improved Jepsen but has not been open-sourced. |
| --- |

All reactions

Sorry, something went wrong.

[![@tezc](https://avatars.githubusercontent.com/u/17865367?s=80&v=4)](/tezc)

Copy link

Collaborator

### **[tezc](/tezc)** commented [Apr 6, 2023](#issuecomment-1498954471)

| I tried with clang-12, still I don't get any warning. If you can prepare a minimal setup to reproduce this issue (maybe with a docker container), we can try to fix the warning but otherwise, not sure how we can fix it.  Btw please use redis "unstable" branch with redisraft "master" branch. Redisraft is still being developed and currently, we only maintain compatibility with redisraft (master) and redis (unstable) branches. |
| --- |

All reactions

Sorry, something went wrong.

[![@tezc](https://avatars.githubusercontent.com/u/17865367?s=80&v=4)](/tezc)

Copy link

Collaborator

### **[tezc](/tezc)** commented [Jun 22, 2023](#issuecomment-1602626209)

| Possibly fixed by [#632](https://github.com/RedisLabs/redisraft/pull/632) [@jerrytesting](https://github.com/jerrytesting) Please try with the latest master, there is a big chance this issued might have been fixed. Let us know if you can reproduce the issue please. |
| --- |

All reactions

Sorry, something went wrong.

[![@tezc](https://avatars.githubusercontent.com/u/17865367?s=40&v=4)](/tezc)
[tezc](/tezc)
closed this as [completed](/RedisLabs/redisraft/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 22, 2023](#event-9606556591)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRedisLabs%2Fredisraft%2Fissues%2F600)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@jerrytesting](https://avatars.githubusercontent.com/u/10736214?s=52&v=4)](/jerrytesting) [![@tezc](https://avatars.githubusercontent.com/u/17865367?s=52&v=4)](/tezc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


