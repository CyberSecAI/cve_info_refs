=== Content from nobugescapes.com_254d1c04_20250115_095500.html ===

[![](https://nobugescapes.com/wp-content/uploads/2023/05/c14709d1c7e69779a6caff7bfd75a06f-1.png)](https://nobugescapes.com)

* [About me](https://nobugescapes.com/about-me/)
* [Contact](https://nobugescapes.com/contact/)

# Creating a new user with admin Privilege

CVE-2023-31923

### Product & Service Introduction:

[BioStar](https://www.supremainc.com/en/platform/hybrid-security-platform-biostar-2.asp) 2 is a web-based, open, and integrated security platform that provides comprehensive functionality for access control, time & attendance management, visitor management, and video log maintenance. It encrypts all personal data available and supports both SDKs and web APIs to integrate BioStar 2 with third-party software. In addition, users can control BioStar 2 platform remotely with the mobile app for BioStar 2 and manage a mobile access card that they can use to access sites.

### Technical Description:

On Bio star 2 web application there are 7 different Operator levels, each rule has a different privilege where the “**Administrator**” has full permission to do everything on the web application while the **“User Operator”** has limited privileges. But due to missing server-side validation, I identified a way to create a highly privileged user. An attacker should be authenticated to the target website and logged in as a “User Operator” to exploit this vulnerability.

The security risk of the vulnerability is High with a CVSS (common vulnerability scoring system) count of 8.8

Successful exploitation of the vulnerability results in gaining admin privilege giving the attacker the ability to control the entire system such as

* Delete, Modify and add any user
* Delete, Modify and add any door
* Access to all user’s information from the Active directory if the system was integrated with the AD and much more.

### Proof of Concept (POC):

* From the dashboard click on “Add user”

![](https://nobugescapes.com/wp-content/uploads/2022/09/47C61A0FA8738BA77308A8A600F88E4B-1024x494.png)

System dashboard

* Noticed the user’s level “User Operator” can’t create admin account

![](https://nobugescapes.com/wp-content/uploads/2022/09/31d6cfe0d16ae931b73c59d7e0c089c0-1024x444.png)

Operator level

![](https://nobugescapes.com/wp-content/uploads/2022/09/032f75b3ca02a393196a818328bd32e8-1.png)

*Original PUT request when adding new user*

* Using a proxy interceptor modify the value of the “id” parameter from 255 to 1 to change the user rule

![](https://nobugescapes.com/wp-content/uploads/2022/09/b469f8beeee7c831206bd577f9f2630d9177979203a9489e47e04df4e6deaa0f8e0c0.png)

*Modified PUT request, the value has been changed from 255 to 1*

* Login to the new account

![](https://nobugescapes.com/wp-content/uploads/2022/09/02ba4c4e5f8ecd1877fc52d64d3-1024x416.png)

*New admin account has been created on Bio star 2*

### Exploit using python:

![](https://nobugescapes.com/wp-content/uploads/2022/09/6b4e03423667dbb73b6e15454f0eb1abd45.png)

*Python script, that takes user token to generate a new admin account, by sending a PUT request.*

![](https://nobugescapes.com/wp-content/uploads/2022/09/a69f73cca23a9ac5c8b567dc18.png)

*Running the script.*

### Solution – Fix & Patch:

Suprema recommend using the latest version of Bio star 2, at the time of publishing the blog | 2022 Q4, v2.9.1.

---

Posted

October 12, 2022

in

[Blog](https://nobugescapes.com/category/blog/)

by

Turki

Tags:

######

Bugs Can Be Fixed But Will Never Escape


