=== Content from friends-of-presta.github.io_bab10de1_20250114_233835.html ===

[Friends-Of-Presta Security Advisories](/)

[Cybersecurity Glossary](/glossary/)[About](/about/)

**IMPORTANT NOTICE**: DO NOT REPORT VULNERABILITIES SOLELY TO THE AUTHOR OR MARKETPLACE.

We urge you to report any vulnerabilities directly to us. Our mission is to ensure the safety and security of the PrestaShop ecosystem. Unfortunately, many module developers may not always recognize or acknowledge the vulnerabilities in their code, whether due to lack of awareness, or inability to properly evaluate the associated risk, or other reasons.

Given the rise in professional cybercrime networks actively seeking out these vulnerabilities, it's crucial that any potential threats are promptly addressed and the community is informed. The most effective method to do this is by publishing a CVE, like the one provided below.

Should you discover any vulnerabilities, **please report them to us at: report[@]security-presta.org** or visit [https://security-presta.org](https://security-presta.org/) for more information.

Every vulnerability report helps make the community more secure, and we are profoundly grateful for any information shared with us.

# [CVE-2023-31671] Improper neutralization of SQL parameter in Postfinance module

Jun 13, 2023
• #modules • critical (9.8) •
202-ecommerce.com,
TouchWeb.fr,
Profileo.com,
Friends-Of-Presta.org

SQL injection vulnerability found in the module “Postfinance” edited by Webbax for PrestaShop before 17.1.14. (17.1.14 fix the issue) allow a remote attacker to perform SQL injection in affected versions.

## Summary

* **CVE ID**: [CVE-2023-31671](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31671)
* **Published at**: 2023-06-13
* **Advisory source**: Friends-Of-Presta
* **Platform**: PrestaShop
* **Product**: postfinance
* **Impacted release**: <= 17.1.13 (17.1.14 fix the issue).
* **Product author**: Webbax
* **Weakness**: [CWE-89](https://cwe.mitre.org/data/definitions/89.html)
* **Severity**: critical (9.8)

## Description

Before version 17.1.14, a sensitive SQL call in the class `PostfinanceValidationModuleFrontController::postProcess()` could be executed with a trivial HTTP call and exploited to forge a blind SQL injection by sending the `orderID` variable as a GET parameter. Its exploded version, `$get_id_cart` (a part of `orderID`), is then used in a SQL query.

This vulnerability can be exploited by an attacker to manipulate the SQL query and potentially gain unauthorized access to the database. It is important to update to version 17.1.14 or later to address this issue and ensure the security of the system.

## CVSS base metrics

* **Attack vector**: network
* **Attack complexity**: low
* **Privilege required**: none
* **User interaction**: none
* **Scope**: unchanged
* **Confidentiality**: high
* **Integrity**: high
* **Availability**: high

**Vector string**: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## Possible malicious usage

* Obtain admin access
* Remove data from the associated PrestaShop
* Copy/paste data from sensitive tables to FRONT to exposed tokens and unlock admins’ ajax scripts
* Rewrite SMTP settings to hijack emails

## Patch

```
--- a/modules/postfiannce/validation.php
+++ b/modules/postfiannce/validation.php
        if(Tools::strtoupper(sha1($string_crypt))==$sha){
        //if(Tools::strtoupper(sha1($string_crypt))==$sha && $getv_postfinance_upper['AMOUNT']==$cart->getOrderTotal(true,3)){

            $Postfinance = new Postfinance();

            // si le panier n'a pas été converti
-            $orderExists = (bool)Db::getInstance()->getValue('SELECT count(*) FROM `'._DB_PREFIX_.'orders` WHERE `id_cart`='.pSQL($get_id_cart));
+            $orderExists = (bool)Db::getInstance()->getValue('SELECT count(*) FROM `'._DB_PREFIX_.'orders` WHERE `id_cart`='. (int) $get_id_cart);
            if(

```
## Other recommendations

* + To help improve the security of your PrestaShop installation, we recommend upgrading to the latest version. One of the benefits of upgrading is that it will disable the use of multiquery executions (separated by semicolons). However, please be aware that this **will not protect** your shop against SQL injection attacks that use the UNION clause to steal data. Additionally, it’s important to note that PrestaShop includes a function called pSQL, which includes a strip\_tags function. This helps protect your shop against [Stored XSS (also known as XSS T2) of Category 1](https://security.friendsofpresta.org/modules/2023/02/07/stored-xss.html). If a pSQL function is missing, it could potentially expose your project to critical Stored XSS vulnerabilities due to edge cases. Therefore, it’s crucial to ensure that all relevant functions are properly implemented and used consistently throughout your project.
* Change the default database prefix `ps_` by a new longer arbitrary prefix. Nevertheless, be warned that this is useless against blackhats with DBA senior skills because of a design vulnerability in DBMS
* Activate OWASP 942’s rules on your WAF (Web application firewall), be warned that you will probably break your backoffice and you will need to pre-configure some bypasses against these set of rules.

## Timeline

| Date | Action |
| --- | --- |
| 2023-04-12 | Sensitive SQL parameter analysed by [202 ecommerce](https://www.202-ecommerce.com/) |
| 2023-04-14 | Contact the author |
| 2023-04-14 | Request a CVE ID |
| 2023-04-14 | The author confirm a fix is available on 17.1.14 |
| 2023-06-13 | Publication of this security advisory |

## Links

* [Author product page](https://shop.webbax.ch/modules-de-paiement/123-module-postfinance.html)
* [National Vulnerability Database](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31671)

**DISCLAIMER:** *The French Association Friends Of Presta (FOP) acts as an intermediary to help hosting this advisory. While we strive to ensure the information and advice provided are accurate, FOP cannot be held liable for any consequences arising from reported vulnerabilities or any subsequent actions taken.*

This advisory and patch is licensed under [CC BY-SA 4.0![](https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1)](https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1)

[Subscribe](https://security.friendsofpresta.org/feed.xml)

* Friends Of Presta

Friends Of Presta is a none profit organization that supports the open-source ecommerce platform PrestaShop.



=== Content from shop.webbax.ch_73be811f_20250114_233843.html ===
    [Connexion](https://shop.webbax.ch/mon-compte "Identifiez-vous")  [Site de Webbax](https://www.webbax.ch)  [![Webbax](https://shop.webbax.ch/img/logo_desktop.png) ![Webbax](https://shop.webbax.ch/img/logo_mobile.png)](https://shop.webbax.ch/ "Webbax")       Rechercher   [**Panier** 0 Produit Produits   (vide)](https://shop.webbax.ch/commande "Voir mon panier")

Aucun produit

 0.00 CHF Taxes 0.00 CHF Total

Les prix sont TTC

 [Commander](https://shop.webbax.ch/commande "Commander")

## Produit ajouté au panier avec succès

   **Quantité**  **Total**
## Il y a 0 produits dans votre panier. Il y a 1 produit dans votre panier.

  **Total produits TTC**     **Frais de port TTC**   À définir  **Taxes** 0.00 CHF  **Total TTC**      Continuer mes achats    [Commander](https://shop.webbax.ch/commande "Commander") Menu

* [Modules Prestashop](https://shop.webbax.ch/20-modules-prestashop "Modules Prestashop")
* [Demande de support](https://shop.webbax.ch/module/powerfulformgenerator/display?id=1 "Demande de support")
* [Demande de mise à jour](https://shop.webbax.ch/module/powerfulformgenerator/display?id=2  "Demande de mise à jour")
* [Contact](https://shop.webbax.ch/module/powerfulformgenerator/display?id=3 "Contact")
   > [Accueil](https://shop.webbax.ch/2-accueil "Accueil")>[Modules PrestaShop](https://shop.webbax.ch/20-modules-prestashop "Modules PrestaShop")>[Modules de paiement](https://shop.webbax.ch/13-modules-de-paiement "Modules de paiement")>Module PrestaShop Postfinance
## Catégories

* [Modules PrestaShop](https://shop.webbax.ch/20-modules-prestashop)
  + [Modules de paiement](https://shop.webbax.ch/13-modules-de-paiement "Découvrez nos modules de paiement pour Prestashop. Chaque méthode de paiement vous permettra d'offrir plus d'opportunités à vos acheteurs.")
  + [Modules pour WinBIZ](https://shop.webbax.ch/15-modules-pour-winbiz "Gagnez du temps en liant Prestashop à votre WinBIZ. Nous proposons des alternatives intéressantes pour vous faire gagner du temps.")
  + [Modules Utilitaire](https://shop.webbax.ch/17-modules-utilitaire "Des actions toujours plus poussées en back-office. Grâce à nos modules Prestashop améliorez la gestion de votre boutique.")
# Module PrestaShop Postfinance

  ![Module Postfinance](https://shop.webbax.ch/1529-large_default/module-postfinance.jpg "Module Postfinance") Agrandir l'image    Précédent

* [![Module Postfinance](https://shop.webbax.ch/1529-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1529-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1504-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1504-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1453-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1453-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1505-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1505-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1454-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1454-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1455-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1455-thickbox_default/module-postfinance.jpg "Module Postfinance")
* [![Module Postfinance](https://shop.webbax.ch/1506-cart_default/module-postfinance.jpg "Module Postfinance")](https://shop.webbax.ch/1506-thickbox_default/module-postfinance.jpg "Module Postfinance")
  Suivant

  [Afficher toutes les images](https://shop.webbax.ch/modules-de-paiement/123-module-postfinance.html)

Référence

État :  Nouveau produit

Ce module PrestaShop vous permet d'accepter des paiements via Postfinance, Postcard, Visa, Mastercard, Twint, American Express. Pour cela vous devez souscrire à la prestation e-payment auprès de Postfinance afin de choisir les différentes cartes que vous désirez proposer à vos clients.

Celui-ci est **compatible avec la nouvelle norme DSP2** (depuis le 14 septembre 2019). Le protocole **3D Secure 2.0 est aussi supporté** et permet d'assurer une meilleure authentification de l'acheteur, afin de limiter les risques de fraude.

Nouveau : Le module inclut le correctif avec l'exigence pour la méthode POST incluant les données de transaction dans le corps de la requête HTTP. Cette application est rendue obligatoire par PostFinance dès le 30 septembre 2022.

Présentation [Documentation](https://shop.webbax.ch/content/10-documentation-module-prestashop-postfinance) [Modifications](https://shop.webbax.ch/content/11-changelog-module-prestashop-postfinance)

 Plus de détails

Ce produit n'est plus en stock

Date de disponibilité:

* Imprimer

90.00 CHF TTC

 TTC

Quantité

La quantité minimale pour pouvoir commander ce produit est **1**

 Installation  Par moi-même (mise à jour)Par Webbax (mise à jour)

 L'accès au support technique est effectif pendant une période de 90 jours suivant la date d’achat du produit. Les mises à jour sont valables durant 12 mois (sauf upgrades).

 Ajouter au panier

### Informations

Après avoir enregistré votre personnalisation, n'oubliez pas d'ajouter le produit au panier.

##### Texte

* Url de la boutique où sera installé le module \*

   Sauver   ![loader](https://shop.webbax.ch/img/loader.gif)

### Caractéristiques

| Version - Date : V17.1.13 - 26.09.22 | | |
| --- | --- | --- |
| Compatibilité : 1.4+ / 1.5+ / 1.6+ / 1.7+ | | |
| Traductions : Français, Allemand, Anglais, Italien | | |
| Modification du coeur : Non | | |
| Mises à jour incluses : 12 mois | | |

* [Présentation détaillée](#idTab1)

## Démonstration

## Explications

Le paiement par Postfinance est la méthode de paiement la plus fréquemment mise en oeuvre par les e-commerçants en Suisse. La Poste suisse reste un gage de fiabilité pour l'acheteur, car il s'agit d'une entité importante et rassurante lorsqu'un achat est effectué via une boutique en ligne.

Actuellement selon notre expérience, Postfinance est la plateforme de paiement la plus demandée par nos clients et les tarifs proposés par la prestation E-payment restent les plus attractifs rapports qualité / prix.

**Exemples de cartes supportées :**

* Postcard
* E-finance
* Twint
* Visa
* Mastercard
* American express
* Diners Club
* JCB
* PayPal
* et d'autres encore...

Les cartes proposées sont variables en fonction du contrat que vous choisissez (Basic / Startup / Professionnal). L'interface de Postfinance s'ajustera ensuite automatiquement en fonction des prestations que vous déciderez de prendre auprès de leurs services.

Pour plus d'informations, consultez l'offre sur le site de Postfinance : [voir les différents packs](https://www.postfinance.ch/fr/biz/prod/eserv/epay/seller/detail.html)

## Alias Manager

Ce module supporte l'option Alias Manager de Postfinance. Avec cette option vous pouvez "mémoriser les coordonnées" de la carte du client, pour que celui-ci n'ai pas besoin de les re-saisir lors d'une prochaine commande. Cette prestation est activable sur demande (coût supplémentaire), voir le détail de leurs conditions (selon les différents pack mentionnés ci-dessus).

## Personnalisation masque de paiement

Vous pouvez modifier l'apparence du formulaire de paiement Postfinance en adaptant les couleurs de la page de paiement. Il est aussi possible d'intégrer le lien du logo de votre boutique, afin qu'il soit affiché sur le masque de paiement pour rassurer l'acheteur.

## Variantes

* Multi-boutiques : avec ce module vous pouvez exploiter l'option multi-boutiques tout en ayant un seul contrat E-payment chez Postfinance
* Multi-devises : vous devez posséder un compte CCP pour chacune des monnaies correspondante (ex. un compte en CHF et un compte en EUR)

   [L'entreprise Webbax](https://shop.webbax.ch/content/4-l-entreprise-webbax) | [Conditions générales](https://shop.webbax.ch/content/6-conditions-generales) | [Réglementation des Cookies](https://shop.webbax.ch/content/16-reglementation-des-cookies) ![](https://shop.webbax.ch/themes/default-bootstrap/img/logos_payment_footer.png) [![](https://shop.webbax.ch/themes/default-bootstrap/img/icon/youtube.svg)](https://www.youtube.com/webbax) [![](https://shop.webbax.ch/themes/default-bootstrap/img/icon/facebook.svg)](https://www.facebook.com/Webbax) [![](https://shop.webbax.ch/themes/default-bootstrap/img/icon/x.svg)](http://www.x.com/webbax_ch) [![](https://shop.webbax.ch/themes/default-bootstrap/img/icon/linkedin.svg)](https://www.linkedin.com/in/germain-tenthorey-79815938/) Webbax Sàrl - Ruelle des Cartes 16 - 1926 Fully - Suisse | Tél. +41(0)27 746 19 81 |  [contact](https://shop.webbax.ch/module/powerfulformgenerator/display?id=3 "contact")

En utilisant ce site, vous acceptez l'utilisation de cookies pour une meilleure navigation ([voir en détail](https://shop.webbax.ch/content/16-reglementation-des-cookies)).

J'accepte

