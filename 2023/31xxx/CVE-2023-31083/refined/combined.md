=== Content from git.kernel.org_80705bc1_20250114_181905.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=9c33663af9ad115f90c076a1828129a3fbadea98)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=9c33663af9ad115f90c076a1828129a3fbadea98)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9c33663af9ad115f90c076a1828129a3fbadea98)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=9c33663af9ad115f90c076a1828129a3fbadea98)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Lee, Chun-Yi <joeyli.kernel@gmail.com> | 2023-07-10 23:17:23 +0800 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-08-11 11:48:01 -0700 |
| commit | [9c33663af9ad115f90c076a1828129a3fbadea98](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9c33663af9ad115f90c076a1828129a3fbadea98) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=9c33663af9ad115f90c076a1828129a3fbadea98)) | |
| tree | [d78f687eae08153a850dacbe287d57d230d1b689](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=9c33663af9ad115f90c076a1828129a3fbadea98) | |
| parent | [82eae9dc438cd7932b5a1c79057378839f1e61e0](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=82eae9dc438cd7932b5a1c79057378839f1e61e0) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=9c33663af9ad115f90c076a1828129a3fbadea98&id2=82eae9dc438cd7932b5a1c79057378839f1e61e0)) | |
| download | [linux-9c33663af9ad115f90c076a1828129a3fbadea98.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-9c33663af9ad115f90c076a1828129a3fbadea98.tar.gz) | |

Bluetooth: hci\_ldisc: check HCI\_UART\_PROTO\_READY flag in HCIUARTGETPROTOThis patch adds code to check HCI\_UART\_PROTO\_READY flag before
accessing hci\_uart->proto. It fixes the race condition in
hci\_uart\_tty\_ioctl() between HCIUARTSETPROTO and HCIUARTGETPROTO.
This issue bug found by Yu Hao and Weiteng Chen:
BUG: general protection fault in hci\_uart\_tty\_ioctl [1]
The information of C reproducer can also reference the link [2]
Reported-by: Yu Hao <yhao016@ucr.edu>
Closes: https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/ [1]
Reported-by: Weiteng Chen <wchen130@ucr.edu>
Closes: https://lore.kernel.org/lkml/CA+UBctDPEvHdkHMwD340=n02rh+jNRJNNQ5LBZNA+Wm4Keh2ow@mail.gmail.com/T/ [2]
Signed-off-by: "Lee, Chun-Yi" <jlee@suse.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=9c33663af9ad115f90c076a1828129a3fbadea98)

| -rw-r--r-- | [drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/bluetooth/hci_ldisc.c?id=9c33663af9ad115f90c076a1828129a3fbadea98) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/bluetooth/hci\_ldisc.c b/drivers/bluetooth/hci\_ldisc.cindex efdda2c3fce8c8..a76eb98c0047a3 100644--- a/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/bluetooth/hci_ldisc.c?id=82eae9dc438cd7932b5a1c79057378839f1e61e0)+++ b/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/bluetooth/hci_ldisc.c?id=9c33663af9ad115f90c076a1828129a3fbadea98)@@ -770,7 +770,8 @@ static int hci\_uart\_tty\_ioctl(struct tty\_struct \*tty, unsigned int cmd, break;  case HCIUARTGETPROTO:- if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags))+ if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags) &&+ test\_bit(HCI\_UART\_PROTO\_READY, &hu->flags)) err = hu->proto->id; else err = -EUNATCH; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:17:42 +0000



=== Content from git.kernel.org_2923b167_20250115_112223.html ===


| [cgit logo](/) | [index](/) : [kernel/git/bluetooth/bluetooth-next.git](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/) | bluetooth-next for-upstream master |
| --- | --- | --- |
| Bluetooth kernel development tree | Bluetooth group |

| [about](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/about/)[summary](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/)[refs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)[log](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/)[tree](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)[commit](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)[diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)[stats](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Lee, Chun-Yi <joeyli.kernel@gmail.com> | 2023-07-10 23:17:23 +0800 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-07-21 16:39:18 -0700 |
| commit | [15ab2fa56dc00baca71266e17b0ba34036cd1efe](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe) ([patch](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/patch/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)) | |
| tree | [3702e5f591e81eb836660beefa16539b6fe9faf2](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe) | |
| parent | [d49a02940a4d5fd20b877599c6257b7ee73192f2](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=d49a02940a4d5fd20b877599c6257b7ee73192f2) ([diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe&id2=d49a02940a4d5fd20b877599c6257b7ee73192f2)) | |
| download | [bluetooth-next-15ab2fa56dc00baca71266e17b0ba34036cd1efe.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-15ab2fa56dc00baca71266e17b0ba34036cd1efe.tar.gz) | |

Bluetooth: hci\_ldisc: check HCI\_UART\_PROTO\_READY flag in HCIUARTGETPROTONotice: this object is not reachable from any branch.
This patch adds code to check HCI\_UART\_PROTO\_READY flag before
accessing hci\_uart->proto. It fixes the race condition in
hci\_uart\_tty\_ioctl() between HCIUARTSETPROTO and HCIUARTGETPROTO.
This issue bug found by Yu Hao and Weiteng Chen:
BUG: general protection fault in hci\_uart\_tty\_ioctl [1]
The information of C reproducer can also reference the link [2]
Reported-by: Yu Hao <yhao016@ucr.edu>
Closes: https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/ [1]
Reported-by: Weiteng Chen <wchen130@ucr.edu>
Closes: https://lore.kernel.org/lkml/CA+UBctDPEvHdkHMwD340=n02rh+jNRJNNQ5LBZNA+Wm4Keh2ow@mail.gmail.com/T/ [2]
Signed-off-by: "Lee, Chun-Yi" <jlee@suse.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Notice: this object is not reachable from any branch.
[Diffstat](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)

| -rw-r--r-- | [drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/drivers/bluetooth/hci_ldisc.c?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/bluetooth/hci\_ldisc.c b/drivers/bluetooth/hci\_ldisc.cindex efdda2c3fce8c8..a76eb98c0047a3 100644--- a/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/hci_ldisc.c?id=d49a02940a4d5fd20b877599c6257b7ee73192f2)+++ b/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/hci_ldisc.c?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe)@@ -770,7 +770,8 @@ static int hci\_uart\_tty\_ioctl(struct tty\_struct \*tty, unsigned int cmd, break;  case HCIUARTGETPROTO:- if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags))+ if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags) &&+ test\_bit(HCI\_UART\_PROTO\_READY, &hu->flags)) err = hu->proto->id; else err = -EUNATCH; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 11:21:01 +0000



=== Content from lore.kernel.org_b386733c_20250115_112223.html ===

```
[All of lore.kernel.org](../?t=20230418050033)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Yu Hao <yhao016@ucr.edu>
To: marcel@holtmann.org, johan.hedberg@gmail.com,
	luiz.dentz@gmail.com, [linux-bluetooth@vger.kernel.org](../../linux-bluetooth/?t=20230418050033),
	[linux-kernel@vger.kernel.org](../../lkml/?t=20230418050033)
Subject: [BUG: general protection fault in hci_uart_tty_ioctl](#r)
Date: Mon, 17 Apr 2023 21:59:12 -0700	[[thread overview]](#r)
Message-ID: <CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com> (<raw>)

Hello,

We found the following issue using syzkaller on Linux v6.2.0.

In function `hci_uart_tty_ioctl`, there is a race condition
between HCIUARTSETPROTO and HCIUARTGETPROTO.
HCI_UART_PROTO_SET is set before `hu->proto` is set.
Thus it may dereference a null pointer.

The full report including the Syzkaller reproducer & C reproducer:
<https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>

The brief report is below:

Syzkaller hit 'general protection fault in hci_uart_tty_ioctl' bug.

general protection fault, probably for non-canonical address
0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN
KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
CPU: 0 PID: 8770 Comm: syz-executor.0 Not tainted 6.2.0 #4
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
1.13.0-1ubuntu1.1 04/01/2014
RIP: 0010:hci_uart_tty_ioctl+0x244/0xc20 drivers/bluetooth/hci_ldisc.c:774
Code: df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 cf 08 00 00 48 8b 9b
b8 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 <0f> b6
04 02 84 c0 74 08 3c 03 0f 8e 5f 08 00 00 44 8b 23 e9 14 ff
RSP: 0018:ffffc900022a7d10 EFLAGS: 00010246
RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffff8710057c
RDX: 0000000000000000 RSI: ffff888046df8000 RDI: ffff88801cf510b8
RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed10039ea204
R10: ffff88801cf5101f R11: ffffed10039ea203 R12: ffff8880204eb000
R13: 0000000000000000 R14: ffffffffffffffe7 R15: 00000000800401c0
FS:  00007f203e7dd700(0000) GS:ffff88802ca00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00005587ec7f32d8 CR3: 000000004629e000 CR4: 0000000000350ef0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
 <TASK>
 tty_ioctl+0xac0/0x1420 drivers/tty/tty_io.c:2784
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x198/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
RIP: 0033:0x7f203f0902fd
Code: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48
89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d
01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007f203e7dcc58 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f203f1bc020 RCX: 00007f203f0902fd
RDX: 0000000000000000 RSI: 00000000800455c9 RDI: 0000000000000003
RBP: 00007f203f0fec89 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 00007ffee4615aef R14: 00007ffee4615ca0 R15: 00007f203e7dcdc0
 </TASK>

```

---

```
                 [reply](#R)other threads:[[~2023-04-18  5:00 UTC](../?t=20230418050033)|[newest](../)]

Thread overview: [no followups] expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com \
    --to=yhao016@ucr.edu \
    --cc=johan.hedberg@gmail.com \
    --cc=linux-bluetooth@vger.kernel.org \
    --cc=linux-kernel@vger.kernel.org \
    --cc=luiz.dentz@gmail.com \
    --cc=marcel@holtmann.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is an external index of several public inboxes,
see [mirroring instructions](../_/text/mirror/) on how to clone and mirror
all data and code used by this external index.
```


=== Content from www.suse.com_d4c8aec2_20250115_112222.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/support/update/announcement/2024/suse-su-20241669-1/)
[English](https://www.suse.com/support/update/announcement/2024/suse-su-20241669-1/)
[Español](https://www.suse.com/es-es/support/update/announcement/2024/suse-su-20241669-1/)
[Français](https://www.suse.com/fr-fr/support/update/announcement/2024/suse-su-20241669-1/)
[中文(简体)](https://www.suse.com/zh-cn/support/update/announcement/2024/suse-su-20241669-1/)
[日本語](https://www.suse.com/ja-jp/support/update/announcement/2024/suse-su-20241669-1/)
[한국어](https://www.suse.com/ko-kr/support/update/announcement/2024/suse-su-20241669-1/)
[Português (Brasil)](https://www.suse.com/pt-br/support/update/announcement/2024/suse-su-20241669-1/)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/en-us/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# Security update for the Linux Kernel

| Announcement ID: | SUSE-SU-2024:1669-1 |
| --- | --- |
| Rating: | important |
| References: | * [bsc#1210780](https://bugzilla.suse.com/show_bug.cgi?id=1210780) * [bsc#1213456](https://bugzilla.suse.com/show_bug.cgi?id=1213456) * [bsc#1218220](https://bugzilla.suse.com/show_bug.cgi?id=1218220) * [bsc#1218562](https://bugzilla.suse.com/show_bug.cgi?id=1218562) * [bsc#1218730](https://bugzilla.suse.com/show_bug.cgi?id=1218730) * [bsc#1218757](https://bugzilla.suse.com/show_bug.cgi?id=1218757) * [bsc#1219146](https://bugzilla.suse.com/show_bug.cgi?id=1219146) * [bsc#1219295](https://bugzilla.suse.com/show_bug.cgi?id=1219295) * [bsc#1219827](https://bugzilla.suse.com/show_bug.cgi?id=1219827) * [bsc#1220191](https://bugzilla.suse.com/show_bug.cgi?id=1220191) * [bsc#1220238](https://bugzilla.suse.com/show_bug.cgi?id=1220238) * [bsc#1220241](https://bugzilla.suse.com/show_bug.cgi?id=1220241) * [bsc#1220416](https://bugzilla.suse.com/show_bug.cgi?id=1220416) * [bsc#1220418](https://bugzilla.suse.com/show_bug.cgi?id=1220418) * [bsc#1220444](https://bugzilla.suse.com/show_bug.cgi?id=1220444) * [bsc#1220649](https://bugzilla.suse.com/show_bug.cgi?id=1220649) * [bsc#1221044](https://bugzilla.suse.com/show_bug.cgi?id=1221044) * [bsc#1221088](https://bugzilla.suse.com/show_bug.cgi?id=1221088) * [bsc#1221578](https://bugzilla.suse.com/show_bug.cgi?id=1221578) * [bsc#1221598](https://bugzilla.suse.com/show_bug.cgi?id=1221598) * [bsc#1222585](https://bugzilla.suse.com/show_bug.cgi?id=1222585) * [bsc#1222619](https://bugzilla.suse.com/show_bug.cgi?id=1222619) * [bsc#1223016](https://bugzilla.suse.com/show_bug.cgi?id=1223016) * [bsc#1223824](https://bugzilla.suse.com/show_bug.cgi?id=1223824) |
| Cross-References: | * [CVE-2021-46904](https://www.suse.com/security/cve/CVE-2021-46904.html) * [CVE-2021-46905](https://www.suse.com/security/cve/CVE-2021-46905.html) * [CVE-2021-46932](https://www.suse.com/security/cve/CVE-2021-46932.html) * [CVE-2022-48619](https://www.suse.com/security/cve/CVE-2022-48619.html) * [CVE-2023-28746](https://www.suse.com/security/cve/CVE-2023-28746.html) * [CVE-2023-31083](https://www.suse.com/security/cve/CVE-2023-31083.html) * [CVE-2023-51780](https://www.suse.com/security/cve/CVE-2023-51780.html) * [CVE-2023-51782](https://www.suse.com/security/cve/CVE-2023-51782.html) * [CVE-2023-52340](https://www.suse.com/security/cve/CVE-2023-52340.html) * [CVE-2023-52429](https://www.suse.com/security/cve/CVE-2023-52429.html) * [CVE-2023-52445](https://www.suse.com/security/cve/CVE-2023-52445.html) * [CVE-2023-52449](https://www.suse.com/security/cve/CVE-2023-52449.html) * [CVE-2023-52475](https://www.suse.com/security/cve/CVE-2023-52475.html) * [CVE-2023-52590](https://www.suse.com/security/cve/CVE-2023-52590.html) * [CVE-2023-52591](https://www.suse.com/security/cve/CVE-2023-52591.html) * [CVE-2023-6270](https://www.suse.com/security/cve/CVE-2023-6270.html) * [CVE-2024-23851](https://www.suse.com/security/cve/CVE-2024-23851.html) * [CVE-2024-26733](https://www.suse.com/security/cve/CVE-2024-26733.html) * [CVE-2024-26898](https://www.suse.com/security/cve/CVE-2024-26898.html) * [CVE-2024-27043](https://www.suse.com/security/cve/CVE-2024-27043.html) |
| CVSS scores: | * CVE-2021-46904   (   SUSE   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2021-46904   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2021-46905   (   SUSE   ):      4.0   CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L * CVE-2021-46905   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2021-46932   (   SUSE   ):      2.5   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L * CVE-2021-46932   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2022-48619   (   SUSE   ):      6.2   CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H * CVE-2022-48619   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-28746   (   SUSE   ):      6.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N * CVE-2023-31083   (   SUSE   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-31083   (   NVD   ):      4.7   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-51780   (   SUSE   ):      7.8   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-51780   (   NVD   ):      7.0   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-51782   (   SUSE   ):      6.7   CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H * CVE-2023-51782   (   NVD   ):      7.0   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-52340   (   SUSE   ):      7.5   CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52340   (   NVD   ):      7.5   CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52429   (   SUSE   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52429   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52445   (   SUSE   ):      6.3   CVSS:3.1/AV:P/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-52445   (   NVD   ):      7.8   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-52449   (   SUSE   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52449   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2023-52475   (   SUSE   ):      6.3   CVSS:3.1/AV:P/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-52590   (   SUSE   ):      4.4   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L * CVE-2023-52591   (   SUSE   ):      7.1   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H * CVE-2023-6270   (   SUSE   ):      7.0   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2023-6270   (   NVD   ):      7.0   CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2024-23851   (   SUSE   ):      4.4   CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H * CVE-2024-23851   (   NVD   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2024-26733   (   SUSE   ):      5.5   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H * CVE-2024-26898   (   SUSE   ):      7.8   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2024-26898   (   NVD   ):      7.8   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H * CVE-2024-27043   (   SUSE   ):      7.8   CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| Affected Products: | * SUSE Linux Enterprise Server 11 SP4 * SUSE Linux Enterprise Server 11 SP4 LTSS EXTREME CORE 11-SP4 |

An update that solves 20 vulnerabilities and has four security fixes can now be installed.

## Description:

The SUSE Linux Enterprise 11 SP4 kernel was updated to receive various security bugfixes.

The following security bugs were fixed:

* CVE-2024-27043: Fixed a use-after-free in edia/dvbdev in different places (bsc#1223824).
* CVE-2024-26733: Fixed an overflow in arp\_req\_get() in arp (bsc#1222585).
* CVE-2022-48619: Fixed a denial-of-service issue in drivers/input/input.c (bsc#1218220).
* CVE-2021-46904: Fixed NULL pointer dereference during tty device unregistration (bsc#1220416).
* CVE-2023-28746: Fixed Register File Data Sampling (bsc#1213456).
* CVE-2021-46905: Fixed NULL pointer dereference on disconnect regression (bsc#1220418).
* CVE-2023-52340: Fixed a denial of service related to ICMPv6 'Packet Too Big' packets (bsc#1219295).
* CVE-2021-46932: Initialized work before appletouch device registration (bsc#1220444).
* CVE-2023-52449: Fixed gluebi NULL pointer dereference caused by ftl notifier (bsc#1220238).
* CVE-2023-52475: Fixed a use-after-free in powermate\_config\_complete() (bsc#1220649).
* CVE-2023-52445: Fixed a use-after-free on context disconnection in pvrusb2 (bsc#1220241).
* CVE-2023-52429: Limited the number of targets and parameter size area for device mapper (bsc#1219146).
* CVE-2023-51780: Fixed a use-after-free in do\_vcc\_ioctl() related to a vcc\_recvmsg race condition (bsc#1218730).
* CVE-2023-51782: Fixed a use-after-free in rose\_ioctl() related to a rose\_accept race condition (bsc#1218757).
* CVE-2023-31083: Fixed a NULL pointer dereference in hci\_uart\_tty\_ioctl() (bsc#1210780).

The following non-security bugs were fixed:

* KVM: VMX: Move VERW closer to VMentry for MDS mitigation (git-fixes).
* KVM: VMX: Use BT+JNC, i.e. EFLAGS.CF to select VMRESUME vs. VMLAUNCH (git-fixes).
* tty: n\_gsm: require CAP\_NET\_ADMIN to attach N\_GSM0710 ldisc (bsc#1222619).
* x86/asm: Add \_ASM\_RIP() macro for x86-64 (%rip) suffix (git-fixes).
* x86/bugs: Add asm helpers for executing VERW (bsc#1213456).
* x86/bugs: Use ALTERNATIVE() instead of mds\_user\_clear static key (git-fixes).
* x86/entry\_32: Add VERW just before userspace transition (git-fixes).
* x86/entry\_64: Add VERW just before userspace transition (git-fixes).

## Special Instructions and Notes:

* Please reboot the system after installing this update.

## Patch Instructions:

To install this SUSE update use the SUSE recommended
installation methods like YaST online\_update or "zypper patch".

Alternatively you can run the command listed for your product:

* SUSE Linux Enterprise Server 11 SP4 LTSS EXTREME CORE 11-SP4

  `zypper in -t patch SUSE-SLE-SERVER-11-SP4-LTSS-EXTREME-CORE-2024-1669=1`
* SUSE Linux Enterprise Server 11 SP4

  `zypper in -t patch SUSE-SLE-SERVER-11-SP4-LTSS-EXTREME-CORE-2024-1669=1`

## Package List:

* SUSE Linux Enterprise Server 11 SP4 LTSS EXTREME CORE 11-SP4 (nosrc x86\_64)
  + kernel-ec2-3.0.101-108.153.1
  + kernel-default-3.0.101-108.153.1
  + kernel-trace-3.0.101-108.153.1
  + kernel-xen-3.0.101-108.153.1
* SUSE Linux Enterprise Server 11 SP4 LTSS EXTREME CORE 11-SP4 (x86\_64)
  + kernel-default-devel-3.0.101-108.153.1
  + kernel-xen-devel-3.0.101-108.153.1
  + kernel-default-base-3.0.101-108.153.1
  + kernel-ec2-devel-3.0.101-108.153.1
  + kernel-ec2-base-3.0.101-108.153.1
  + kernel-syms-3.0.101-108.153.1
  + kernel-xen-base-3.0.101-108.153.1
  + kernel-trace-base-3.0.101-108.153.1
  + kernel-source-3.0.101-108.153.1
  + kernel-trace-devel-3.0.101-108.153.1
* SUSE Linux Enterprise Server 11 SP4 (nosrc x86\_64)
  + kernel-ec2-3.0.101-108.153.1
  + kernel-default-3.0.101-108.153.1
  + kernel-trace-3.0.101-108.153.1
  + kernel-xen-3.0.101-108.153.1
* SUSE Linux Enterprise Server 11 SP4 (x86\_64)
  + kernel-default-devel-3.0.101-108.153.1
  + kernel-xen-devel-3.0.101-108.153.1
  + kernel-default-base-3.0.101-108.153.1
  + kernel-ec2-devel-3.0.101-108.153.1
  + kernel-ec2-base-3.0.101-108.153.1
  + kernel-syms-3.0.101-108.153.1
  + kernel-xen-base-3.0.101-108.153.1
  + kernel-trace-base-3.0.101-108.153.1
  + kernel-source-3.0.101-108.153.1
  + kernel-trace-devel-3.0.101-108.153.1

## References:

* <https://www.suse.com/security/cve/CVE-2021-46904.html>
* <https://www.suse.com/security/cve/CVE-2021-46905.html>
* <https://www.suse.com/security/cve/CVE-2021-46932.html>
* <https://www.suse.com/security/cve/CVE-2022-48619.html>
* <https://www.suse.com/security/cve/CVE-2023-28746.html>
* <https://www.suse.com/security/cve/CVE-2023-31083.html>
* <https://www.suse.com/security/cve/CVE-2023-51780.html>
* <https://www.suse.com/security/cve/CVE-2023-51782.html>
* <https://www.suse.com/security/cve/CVE-2023-52340.html>
* <https://www.suse.com/security/cve/CVE-2023-52429.html>
* <https://www.suse.com/security/cve/CVE-2023-52445.html>
* <https://www.suse.com/security/cve/CVE-2023-52449.html>
* <https://www.suse.com/security/cve/CVE-2023-52475.html>
* <https://www.suse.com/security/cve/CVE-2023-52590.html>
* <https://www.suse.com/security/cve/CVE-2023-52591.html>
* <https://www.suse.com/security/cve/CVE-2023-6270.html>
* <https://www.suse.com/security/cve/CVE-2024-23851.html>
* <https://www.suse.com/security/cve/CVE-2024-26733.html>
* <https://www.suse.com/security/cve/CVE-2024-26898.html>
* <https://www.suse.com/security/cve/CVE-2024-27043.html>
* <https://bugzilla.suse.com/show_bug.cgi?id=1210780>
* <https://bugzilla.suse.com/show_bug.cgi?id=1213456>
* <https://bugzilla.suse.com/show_bug.cgi?id=1218220>
* <https://bugzilla.suse.com/show_bug.cgi?id=1218562>
* <https://bugzilla.suse.com/show_bug.cgi?id=1218730>
* <https://bugzilla.suse.com/show_bug.cgi?id=1218757>
* <https://bugzilla.suse.com/show_bug.cgi?id=1219146>
* <https://bugzilla.suse.com/show_bug.cgi?id=1219295>
* <https://bugzilla.suse.com/show_bug.cgi?id=1219827>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220191>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220238>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220241>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220416>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220418>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220444>
* <https://bugzilla.suse.com/show_bug.cgi?id=1220649>
* <https://bugzilla.suse.com/show_bug.cgi?id=1221044>
* <https://bugzilla.suse.com/show_bug.cgi?id=1221088>
* <https://bugzilla.suse.com/show_bug.cgi?id=1221578>
* <https://bugzilla.suse.com/show_bug.cgi?id=1221598>
* <https://bugzilla.suse.com/show_bug.cgi?id=1222585>
* <https://bugzilla.suse.com/show_bug.cgi?id=1222619>
* <https://bugzilla.suse.com/show_bug.cgi?id=1223016>
* <https://bugzilla.suse.com/show_bug.cgi?id=1223824>

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)
* [![](https://www.suse.com/assets/img/icons/bsky-icon.png)](https://bsky.app/profile/suse.com)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from lore.kernel.org_cd8df527_20250115_112224.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../../?t=20230705122222)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#e060ec2531b9dba714c19e153f368dcb0d75430ce) How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
@ 2023-06-28 15:01 joeyli
  2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
  [0 siblings, 1 reply; 7+ messages in thread](#r060ec2531b9dba714c19e153f368dcb0d75430ce)
From: joeyli @ 2023-06-28 15:01 UTC ([permalink](../../20230628150140.GU21539%40linux-l9pv.suse/) / [raw](../../20230628150140.GU21539%40linux-l9pv.suse/raw))
  To: Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230628150224), [linux-kernel](../../../lkml/?t=20230628150224)

Hi Yu Hao,

I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":

[https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)

I am trying the C reproducer in your URL, but it is not success yet:
<https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>

I am using v6.2 mainline kernel to run the C reproducer.

Could you please provide suggestions for how to reproduce this issue?
And what is your qemu environment for reproducing issue?

Thanks a lot!
Joey Lee

[^](#m060ec2531b9dba714c19e153f368dcb0d75430ce) [permalink](../../20230628150140.GU21539%40linux-l9pv.suse/) [raw](../../20230628150140.GU21539%40linux-l9pv.suse/raw) [reply](../../20230628150140.GU21539%40linux-l9pv.suse/#R)	[[flat](../../20230628150140.GU21539%40linux-l9pv.suse/T/#u)|[nested](../../20230628150140.GU21539%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r060ec2531b9dba714c19e153f368dcb0d75430ce)
```

---

```
[*](#e21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-06-28 15:01 [How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?](#m060ec2531b9dba714c19e153f368dcb0d75430ce) joeyli
@ 2023-06-29  1:57 ` Yu Hao
  2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
  [0 siblings, 1 reply; 7+ messages in thread](#r21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
From: Yu Hao @ 2023-06-29  1:57 UTC ([permalink](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/) / [raw](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/raw))
  To: Weiteng Chen; +Cc: joeyli, [linux-bluetooth](../../../linux-bluetooth/?t=20230629015913), [linux-kernel](../../../lkml/?t=20230629015913)

Hi Weiteng,

Could you give more info about the bug, e.g., kernel configuration,
qemu arguments.

Thanks.
Yu Hao
Ph.D. student
Department of Computer Science & Engineering
University of California, Riverside

On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
>
> Hi Yu Hao,
>
> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
>
> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
>
> I am trying the C reproducer in your URL, but it is not success yet:
> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
>
> I am using v6.2 mainline kernel to run the C reproducer.
>
> Could you please provide suggestions for how to reproduce this issue?
> And what is your qemu environment for reproducing issue?
>
> Thanks a lot!
> Joey Lee

[^](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1) [permalink](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/) [raw](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/raw) [reply](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/#R)	[[flat](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/T/#u)|[nested](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/t/#u)] [7+ messages in thread](#r21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
```

---

```
[*](#e1ef6d7a0febac0e12404302774af1222732ceef6) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
@ 2023-07-04  3:01   ` joeyli
  2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
  [0 siblings, 1 reply; 7+ messages in thread](#r1ef6d7a0febac0e12404302774af1222732ceef6)
From: joeyli @ 2023-07-04  3:01 UTC ([permalink](../../20230704030131.GY5866%40linux-l9pv.suse/) / [raw](../../20230704030131.GY5866%40linux-l9pv.suse/raw))
  To: Yu Hao; +Cc: Weiteng Chen, [linux-bluetooth](../../../linux-bluetooth/?t=20230704030153), [linux-kernel](../../../lkml/?t=20230704030153)

Hi,

On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> Hi Weiteng,
>
> Could you give more info about the bug, e.g., kernel configuration,
> qemu arguments.
>

Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.

I have run the C reproducer a couple of days in qemu, but it did not
reproduce issue until now.

Does anyone know how to reproduce this issue easily?

Thanks
Joey Lee
>
> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> >
> > Hi Yu Hao,
> >
> > I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> >
> > [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> >
> > I am trying the C reproducer in your URL, but it is not success yet:
> > <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> >
> > I am using v6.2 mainline kernel to run the C reproducer.
> >
> > Could you please provide suggestions for how to reproduce this issue?
> > And what is your qemu environment for reproducing issue?
> >
> > Thanks a lot!
> > Joey Lee

[^](#m1ef6d7a0febac0e12404302774af1222732ceef6) [permalink](../../20230704030131.GY5866%40linux-l9pv.suse/) [raw](../../20230704030131.GY5866%40linux-l9pv.suse/raw) [reply](../../20230704030131.GY5866%40linux-l9pv.suse/#R)	[[flat](../../20230704030131.GY5866%40linux-l9pv.suse/T/#u)|[nested](../../20230704030131.GY5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r1ef6d7a0febac0e12404302774af1222732ceef6)
```

---

```
[*](#e170362c47de329ec565734f8f7ea5c03274f8ac7) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
@ 2023-07-04  4:07     ` Weiteng Chen
  2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
  [0 siblings, 1 reply; 7+ messages in thread](#r170362c47de329ec565734f8f7ea5c03274f8ac7)
From: Weiteng Chen @ 2023-07-04  4:07 UTC ([permalink](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/) / [raw](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/raw))
  To: joeyli; +Cc: Yu Hao, [linux-bluetooth](../../../linux-bluetooth/?t=20230704040848), [linux-kernel](../../../lkml/?t=20230704040848)

Hi Joey,

Sorry for my late response.

<https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>

switch (cmd) {
        case HCIUARTSETPROTO:
                if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
                        printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
                        err = hci_uart_set_proto(hu, arg);
                        if (err)
                                clear_bit(HCI_UART_PROTO_SET, &hu->flags);
                } else
                        err = -EBUSY;
                break;

        case HCIUARTGETPROTO:
                if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
                        err = hu->proto->id;  ←- null pointer deference
                else
                        err = -EUNATCH;
                break;

This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.

To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.

Best,
Weiteng Chen

> On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
>
> Hi,
>
> On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
>> Hi Weiteng,
>>
>> Could you give more info about the bug, e.g., kernel configuration,
>> qemu arguments.
>>
>
> Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
>
> I have run the C reproducer a couple of days in qemu, but it did not
> reproduce issue until now.
>
> Does anyone know how to reproduce this issue easily?
>
> Thanks
> Joey Lee
>>
>> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
>>>
>>> Hi Yu Hao,
>>>
>>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
>>>
>>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
>>>
>>> I am trying the C reproducer in your URL, but it is not success yet:
>>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
>>>
>>> I am using v6.2 mainline kernel to run the C reproducer.
>>>
>>> Could you please provide suggestions for how to reproduce this issue?
>>> And what is your qemu environment for reproducing issue?
>>>
>>> Thanks a lot!
>>> Joey Lee

[^](#m170362c47de329ec565734f8f7ea5c03274f8ac7) [permalink](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/) [raw](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/raw) [reply](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/#R)	[[flat](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/T/#u)|[nested](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/t/#u)] [7+ messages in thread](#r170362c47de329ec565734f8f7ea5c03274f8ac7)
```

---

```
[*](#e91f142c29c53fa1d643e0b91eb12436350c5e851) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
@ 2023-07-05  8:41       ` joeyli
  2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
  [0 siblings, 1 reply; 7+ messages in thread](#r91f142c29c53fa1d643e0b91eb12436350c5e851)
From: joeyli @ 2023-07-05  8:41 UTC ([permalink](../../20230705084148.GK5866%40linux-l9pv.suse/) / [raw](../../20230705084148.GK5866%40linux-l9pv.suse/raw))
  To: Weiteng Chen, Yu Hao; +Cc: Yu Hao, [linux-bluetooth](../../../linux-bluetooth/?t=20230705084222), [linux-kernel](../../../lkml/?t=20230705084222)

Hi Weiteng Chen, Yu Hao,

On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> Hi Joey,
>
> Sorry for my late response.
>
> <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
>
> switch (cmd) {
>         case HCIUARTSETPROTO:
>                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
>                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
>                         err = hci_uart_set_proto(hu, arg);
>                         if (err)
>                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
>                 } else
>                         err = -EBUSY;
>                 break;
>
>         case HCIUARTGETPROTO:
>                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
>                         err = hu->proto->id;  ←- null pointer deference
>                 else
>                         err = -EUNATCH;
>                 break;
>
> This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
>
> To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
>

Thanks! I can reproduce the issue now.

Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?

Joey Lee

> Best,
> Weiteng Chen
>
> > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> >
> > Hi,
> >
> > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> >> Hi Weiteng,
> >>
> >> Could you give more info about the bug, e.g., kernel configuration,
> >> qemu arguments.
> >>
> >
> > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> >
> > I have run the C reproducer a couple of days in qemu, but it did not
> > reproduce issue until now.
> >
> > Does anyone know how to reproduce this issue easily?
> >
> > Thanks
> > Joey Lee
> >>
> >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> >>>
> >>> Hi Yu Hao,
> >>>
> >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> >>>
> >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> >>>
> >>> I am trying the C reproducer in your URL, but it is not success yet:
> >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> >>>
> >>> I am using v6.2 mainline kernel to run the C reproducer.
> >>>
> >>> Could you please provide suggestions for how to reproduce this issue?
> >>> And what is your qemu environment for reproducing issue?
> >>>
> >>> Thanks a lot!
> >>> Joey Lee

[^](#m91f142c29c53fa1d643e0b91eb12436350c5e851) [permalink](../../20230705084148.GK5866%40linux-l9pv.suse/) [raw](../../20230705084148.GK5866%40linux-l9pv.suse/raw) [reply](../../20230705084148.GK5866%40linux-l9pv.suse/#R)	[[flat](../../20230705084148.GK5866%40linux-l9pv.suse/T/#u)|[nested](../../20230705084148.GK5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r91f142c29c53fa1d643e0b91eb12436350c5e851)
```

---

```
[*](#ec8f5237edd80632a7a607136e15c7b15162ae87b) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
@ 2023-07-05  9:36         ` joeyli
  2023-07-05 12:21           ` [joeyli](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d)
  [0 siblings, 1 reply; 7+ messages in thread](#rc8f5237edd80632a7a607136e15c7b15162ae87b)
From: joeyli @ 2023-07-05  9:36 UTC ([permalink](../../20230705093636.GL5866%40linux-l9pv.suse/) / [raw](../../20230705093636.GL5866%40linux-l9pv.suse/raw))
  To: Weiteng Chen, Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230705093701), [linux-kernel](../../../lkml/?t=20230705093701)

On Wed, Jul 05, 2023 at 04:41:48PM +0800, joeyli wrote:
> Hi Weiteng Chen, Yu Hao,
>
> On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> > Hi Joey,
> >
> > Sorry for my late response.
> >
> > <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
> >
> > switch (cmd) {
> >         case HCIUARTSETPROTO:
> >                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
> >                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
> >                         err = hci_uart_set_proto(hu, arg);
> >                         if (err)
> >                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
> >                 } else
> >                         err = -EBUSY;
> >                 break;
> >
> >         case HCIUARTGETPROTO:
> >                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> >                         err = hu->proto->id;  ←- null pointer deference
> >                 else
> >                         err = -EUNATCH;
> >                 break;
> >
> > This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
> >
> > To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
> >
>
> Thanks! I can reproduce the issue now.
>
> Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?
>
> Joey Lee

Looks that check HCI_UART_PROTO_READY is enough to avoid problem:

--- linux.orig/drivers/bluetooth/hci_ldisc.c
+++ linux/drivers/bluetooth/hci_ldisc.c
@@ -771,7 +771,7 @@ static int hci_uart_tty_ioctl(struct tty
                break;

        case HCIUARTGETPROTO:
-               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
+               if (test_bit(HCI_UART_PROTO_READY, &hu->flags))
                        err = hu->proto->id;
                else
                        err = -EUNATCH;

If you do not have plan to send patch, then I will send the above change.

Thanks
Joey Lee

>
>
> > Best,
> > Weiteng Chen
> >
> > > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> > >
> > > Hi,
> > >
> > > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> > >> Hi Weiteng,
> > >>
> > >> Could you give more info about the bug, e.g., kernel configuration,
> > >> qemu arguments.
> > >>
> > >
> > > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> > >
> > > I have run the C reproducer a couple of days in qemu, but it did not
> > > reproduce issue until now.
> > >
> > > Does anyone know how to reproduce this issue easily?
> > >
> > > Thanks
> > > Joey Lee
> > >>
> > >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> > >>>
> > >>> Hi Yu Hao,
> > >>>
> > >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> > >>>
> > >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> > >>>
> > >>> I am trying the C reproducer in your URL, but it is not success yet:
> > >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> > >>>
> > >>> I am using v6.2 mainline kernel to run the C reproducer.
> > >>>
> > >>> Could you please provide suggestions for how to reproduce this issue?
> > >>> And what is your qemu environment for reproducing issue?
> > >>>
> > >>> Thanks a lot!
> > >>> Joey Lee

[^](#mc8f5237edd80632a7a607136e15c7b15162ae87b) [permalink](../../20230705093636.GL5866%40linux-l9pv.suse/) [raw](../../20230705093636.GL5866%40linux-l9pv.suse/raw) [reply](../../20230705093636.GL5866%40linux-l9pv.suse/#R)	[[flat](../../20230705093636.GL5866%40linux-l9pv.suse/T/#u)|[nested](../../20230705093636.GL5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#rc8f5237edd80632a7a607136e15c7b15162ae87b)
```

---

```
[*](#eb3bb221407bc1d8e678da7217d8c0475515dbc3d) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
@ 2023-07-05 12:21           ` joeyli
  [0 siblings, 0 replies; 7+ messages in thread](#rb3bb221407bc1d8e678da7217d8c0475515dbc3d)
From: joeyli @ 2023-07-05 12:21 UTC ([permalink](../../20230705122159.GA26742%40linux-691t/) / [raw](../../20230705122159.GA26742%40linux-691t/raw))
  To: Weiteng Chen, Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230705122222), [linux-kernel](../../../lkml/?t=20230705122222)

On Wed, Jul 05, 2023 at 05:36:36PM +0800, joeyli wrote:
> On Wed, Jul 05, 2023 at 04:41:48PM +0800, joeyli wrote:
> > Hi Weiteng Chen, Yu Hao,
> >
> > On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> > > Hi Joey,
> > >
> > > Sorry for my late response.
> > >
> > > <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
> > >
> > > switch (cmd) {
> > >         case HCIUARTSETPROTO:
> > >                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
> > >                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
> > >                         err = hci_uart_set_proto(hu, arg);
> > >                         if (err)
> > >                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
> > >                 } else
> > >                         err = -EBUSY;
> > >                 break;
> > >
> > >         case HCIUARTGETPROTO:
> > >                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> > >                         err = hu->proto->id;  ←- null pointer deference
> > >                 else
> > >                         err = -EUNATCH;
> > >                 break;
> > >
> > > This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
> > >
> > > To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
> > >
> >
> > Thanks! I can reproduce the issue now.
> >
> > Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?
> >
> > Joey Lee
>
> Looks that check HCI_UART_PROTO_READY is enough to avoid problem:
>
> --- linux.orig/drivers/bluetooth/hci_ldisc.c
> +++ linux/drivers/bluetooth/hci_ldisc.c
> @@ -771,7 +771,7 @@ static int hci_uart_tty_ioctl(struct tty
>                 break;
>
>         case HCIUARTGETPROTO:
> -               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> +               if (test_bit(HCI_UART_PROTO_READY, &hu->flags))
>                         err = hu->proto->id;
>                 else
>                         err = -EUNATCH;
>
> If you do not have plan to send patch, then I will send the above change.
>

Updated patch. The HCI_UART_PROTO_SET should still be checked with
HCI_UART_PROTO_READY:

--- linux.orig/drivers/bluetooth/hci_ldisc.c
+++ linux/drivers/bluetooth/hci_ldisc.c
@@ -771,7 +771,8 @@ static int hci_uart_tty_ioctl(struct tty
                break;

        case HCIUARTGETPROTO:
-               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
+               if (test_bit(HCI_UART_PROTO_SET, &hu->flags) &&
+                   test_bit(HCI_UART_PROTO_READY, &hu->flags))
                        err = hu->proto->id;
                else
                        err = -EUNATCH;

I have tested this patch a couple of hours. I didn't reproduce
issue.

Regards
Joey Lee

> >
> >
> > > Best,
> > > Weiteng Chen
> > >
> > > > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> > > >
> > > > Hi,
> > > >
> > > > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> > > >> Hi Weiteng,
> > > >>
> > > >> Could you give more info about the bug, e.g., kernel configuration,
> > > >> qemu arguments.
> > > >>
> > > >
> > > > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > > > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> > > >
> > > > I have run the C reproducer a couple of days in qemu, but it did not
> > > > reproduce issue until now.
> > > >
> > > > Does anyone know how to reproduce this issue easily?
> > > >
> > > > Thanks
> > > > Joey Lee
> > > >>
> > > >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> > > >>>
> > > >>> Hi Yu Hao,
> > > >>>
> > > >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> > > >>>
> > > >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> > > >>>
> > > >>> I am trying the C reproducer in your URL, but it is not success yet:
> > > >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> > > >>>
> > > >>> I am using v6.2 mainline kernel to run the C reproducer.
> > > >>>
> > > >>> Could you please provide suggestions for how to reproduce this issue?
> > > >>> And what is your qemu environment for reproducing issue?
> > > >>>
> > > >>> Thanks a lot!
> > > >>> Joey Lee

[^](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d) [permalink](../../20230705122159.GA26742%40linux-691t/) [raw](../../20230705122159.GA26742%40linux-691t/raw) [reply](../../20230705122159.GA26742%40linux-691t/#R)	[[flat](../../20230705122159.GA26742%40linux-691t/T/#u)|[nested](../../20230705122159.GA26742%40linux-691t/t/#u)] [7+ messages in thread](#rb3bb221407bc1d8e678da7217d8c0475515dbc3d)
```

---

```
end of thread, other threads:[[~2023-07-05 12:22 UTC](../../?t=20230705122222) | [newest](../../)]

Thread overview: 7+ messages (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2023-06-28 15:01 [How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?](#m060ec2531b9dba714c19e153f368dcb0d75430ce) joeyli
2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
2023-07-05 12:21           ` [joeyli](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d)

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from bugzilla.suse.com_e0eed4a9_20250114_181905.html ===


| Bugzilla – Bug 1210780 | VUL-0: CVE-2023-31083: kernel: drivers/bluetooth/hci\_ldisc.c race condition in hci\_uart\_tty\_ioctl | Last modified: 2024-09-10 13:05:03 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1210780)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1210780**](show_bug.cgi?id=1210780)
(CVE-2023-31083)
- VUL-0: CVE-2023-31083: kernel: drivers/bluetooth/hci\_ldisc.c race condition in hci\_uart\_tty\_ioctl

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2023-31083: kernel: drivers/bluetooth/hci\_ldisc.c race condition i...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-31083 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/364290/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2023-31083:5.5:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2023-04-24 13:38 UTC by Robert Frohl | | --- | --- | | Modified: | 2024-09-10 13:05 UTC ([History](show_activity.cgi?id=1210780)) | | CC List: | 8 users (show)  jack meissner mhocko osalvador pmladek security-team steve.beattie vasant.karasulli | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1210780) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**0001-Bluetooth-hci\_ldisc-check-HCI\_UART\_PROTO\_READY-flag-.patch**](attachment.cgi?id=868126 "View the content of the attachment") (1.53 KB, patch)  [2023-07-10 15:53 UTC](#attach_868126 "Go to the comment associated with the attachment"), Joey Lee | [Details](attachment.cgi?id=868126&action=edit) | [Diff](attachment.cgi?id=868126&action=diff) | | [View All](attachment.cgi?bugid=1210780&action=viewall)  [Add an attachment](attachment.cgi?bugid=1210780&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1210780&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1210780#c0)  Robert Frohl   2023-04-24 13:38:43 UTC  ``` CVE-2023-31083  An issue was discovered in drivers/bluetooth/hci_ldisc.c in the Linux kernel 6.2. In hci_uart_tty_ioctl, there is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set. A NULL pointer dereference may occur.  References: <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2023-31083> <https://www.cve.org/CVERecord?id=CVE-2023-31083> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/) ``` [Comment 2](show_bug.cgi?id=1210780#c2)  Jan Kara   2023-04-25 13:09:32 UTC  ``` Joey, can you please take care of this? It is a syzkaller report so it may be just some bogus issue (the flawed logic like syzkaller crashed the kernel => CVE) but we should investigate... ``` [Comment 3](show_bug.cgi?id=1210780#c3)  Joey Lee   2023-04-28 08:02:56 UTC  ``` (In reply to Jan Kara from [comment #2](show_bug.cgi?id=1210780#c2)) > Joey, can you please take care of this? It is a syzkaller report so it may > be just some bogus issue (the flawed logic like syzkaller crashed the kernel > => CVE) but we should investigate...  I will waiting upstream status. If patch shows up, I will backport. ``` [Comment 6](show_bug.cgi?id=1210780#c6)  Joey Lee   2023-06-08 06:55:26 UTC  ``` I did see patch on upstream yet. ``` [Comment 7](show_bug.cgi?id=1210780#c7)  Joey Lee   2023-06-13 06:55:47 UTC  ``` (In reply to Joey Lee from [comment #6](show_bug.cgi?id=1210780#c6)) > I did see patch on upstream yet.  Still didn't see patch show up on upstream yet. ``` [Comment 11](show_bug.cgi?id=1210780#c11)  Joey Lee   2023-06-27 13:36:54 UTC  ``` Base on kernel code, the HCIUARTSETPROTO and HCIUARTGETPROTO blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.   I have tried to use reproducer to reproduce issue, but I didn't success:  <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>  I will continue to reproduce issue, then try to patch kernel. ``` [Comment 12](show_bug.cgi?id=1210780#c12)  Joey Lee   2023-06-28 15:12:32 UTC  ``` (In reply to Joey Lee from [comment #11](show_bug.cgi?id=1210780#c11)) > Base on kernel code, the HCIUARTSETPROTO and HCIUARTGETPROTO blocks in > hci_uart_tty_ioctl() should use hci_uart->proto_lock.  >  > I have tried to use reproducer to reproduce issue, but I didn't success: >  > <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb> >  > I will continue to reproduce issue, then try to patch kernel.  Not easy to reproduce, I have sent mail to Yu Hao for checking how to reproduce it. ``` [Comment 13](show_bug.cgi?id=1210780#c13)  Joey Lee   2023-07-05 08:46:31 UTC  ``` (In reply to Joey Lee from [comment #12](show_bug.cgi?id=1210780#c12)) > (In reply to Joey Lee from [comment #11](show_bug.cgi?id=1210780#c11)) > > Base on kernel code, the HCIUARTSETPROTO and HCIUARTGETPROTO blocks in > > hci_uart_tty_ioctl() should use hci_uart->proto_lock.  > >  > > I have tried to use reproducer to reproduce issue, but I didn't success: > >  > > <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb> > >  > > I will continue to reproduce issue, then try to patch kernel. >  > Not easy to reproduce, I have sent mail to Yu Hao for checking how to > reproduce it.  I can reproduce issue after contacted with CVE reporter on upstream:  [https://lore.kernel.org/lkml/191B9131-6E47-49B6-8089-108E2B12B9DC@ucr.edu/T/](https://lore.kernel.org/lkml/191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/T/) ``` [Comment 14](show_bug.cgi?id=1210780#c14)  Joey Lee   2023-07-05 09:38:12 UTC  ``` (In reply to Joey Lee from [comment #13](show_bug.cgi?id=1210780#c13)) > (In reply to Joey Lee from [comment #12](show_bug.cgi?id=1210780#c12)) > > (In reply to Joey Lee from [comment #11](show_bug.cgi?id=1210780#c11)) > > > Base on kernel code, the HCIUARTSETPROTO and HCIUARTGETPROTO blocks in > > > hci_uart_tty_ioctl() should use hci_uart->proto_lock.  > > >  > > > I have tried to use reproducer to reproduce issue, but I didn't success: > > >  > > > <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb> > > >  > > > I will continue to reproduce issue, then try to patch kernel. > >  > > Not easy to reproduce, I have sent mail to Yu Hao for checking how to > > reproduce it. >  > I can reproduce issue after contacted with CVE reporter on upstream: >  > [https://lore.kernel.org/lkml/191B9131-6E47-49B6-8089-108E2B12B9DC@ucr.edu/T/](https://lore.kernel.org/lkml/191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/T/)  Looks check HCI_UART_PROTO_READY is enough to fix problem:  --- linux.orig/drivers/bluetooth/hci_ldisc.c +++ linux/drivers/bluetooth/hci_ldisc.c @@ -771,7 +771,7 @@ static int hci_uart_tty_ioctl(struct tty                 break;           case HCIUARTGETPROTO: -               if (test_bit(HCI_UART_PROTO_SET, &hu->flags)) +               if (test_bit(HCI_UART_PROTO_READY, &hu->flags))                         err = hu->proto->id;                 else                         err = -EUNATCH;   I will look at the status on upstream. ``` [Comment 15](show_bug.cgi?id=1210780#c15)  Joey Lee   2023-07-10 15:53:57 UTC  ``` Created [attachment 868126](attachment.cgi?id=868126&action=diff "0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch") [[details]](attachment.cgi?id=868126&action=edit "0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch") 0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch  Sent this patch to linux-bluetooth@vger.kernel.org for reviewing. ``` [Comment 16](show_bug.cgi?id=1210780#c16)  Joey Lee   2023-07-13 06:57:25 UTC  ``` (In reply to Joey Lee from [comment #15](show_bug.cgi?id=1210780#c15)) > Created [attachment 868126](attachment.cgi?id=868126&action=diff "0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch") [[details]](attachment.cgi?id=868126&action=edit "0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch") > 0001-Bluetooth-hci_ldisc-check-HCI_UART_PROTO_READY-flag-.patch >  > Sent this patch to linux-bluetooth@vger.kernel.org for reviewing.  The patch be merged to bluetooth-next tree:    - Bluetooth: hci_ldisc: check HCI_UART_PROTO_READY flag in HCIUARTGETPROTO     <https://git.kernel.org/bluetooth/bluetooth-next/c/ff1b86784849>  I will backport it to SLE when it be merged to kernel mainline. ``` [Comment 17](show_bug.cgi?id=1210780#c17)  Marcus Meissner   2023-07-20 15:56:54 UTC  ``` not yet in mainline as far as i see.  is it missing anything? ``` [Comment 20](show_bug.cgi?id=1210780#c20)  Joey Lee   2023-07-26 05:18:26 UTC  ``` I have backported the following patch from bluetooth-next git tree to 15-SP4 kernel and wait to be merged:  <https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe> ``` [Comment 21](show_bug.cgi?id=1210780#c21)  Joey Lee   2023-07-28 14:56:12 UTC  ``` (In reply to Joey Lee from [comment #20](show_bug.cgi?id=1210780#c20)) > I have backported the following patch from bluetooth-next git tree to 15-SP4 > kernel and wait to be merged: >  > <https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/> > commit/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe  Backported patch be merged to 15-SP4 kernel now:  commit ad56bc87a28e422f0e2ad833dd6cfc8c9df2de41 (origin/users/jlee/SLE15-SP4/for-next, SLE15-SP4-bsc1210780) Author: Lee, Chun-Yi <jlee@suse.com> Date:   Wed Jul 26 11:42:04 2023 +0800      Bluetooth: hci_ldisc: check HCI_UART_PROTO_READY flag in     HCIUARTGETPROTO ([bsc#1210780](http://bugzilla.suse.com/show_bug.cgi?id=1210780) CVE-2023-31083).   I will backport to other SLE version after my patch be merged to kernel mainline. ``` [Comment 41](show_bug.cgi?id=1210780#c41)  Maintenance Automation   2023-08-14 08:30:09 UTC  ``` SUSE-SU-2023:3302-1: An update that solves 28 vulnerabilities, contains two features and has 115 fixes can now be installed.  Category: security (important) Bug References: 1150305, 1187829, 1193629, 1194869, 1206418, 1207129, 1207894, 1207948, 1208788, 1210335, 1210565, 1210584, 1210627, 1210780, 1210825, 1210853, 1211014, 1211131, 1211243, 1211738, 1211811, 1211867, 1212051, 1212256, 1212265, 1212301, 1212445, 1212456, 1212502, 1212525, 1212603, 1212604, 1212685, 1212766, 1212835, 1212838, 1212842, 1212846, 1212848, 1212861, 1212869, 1212892, 1212901, 1212905, 1212961, 1213010, 1213011, 1213012, 1213013, 1213014, 1213015, 1213016, 1213017, 1213018, 1213019, 1213020, 1213021, 1213024, 1213025, 1213032, 1213034, 1213035, 1213036, 1213037, 1213038, 1213039, 1213040, 1213041, 1213059, 1213061, 1213087, 1213088, 1213089, 1213090, 1213092, 1213093, 1213094, 1213095, 1213096, 1213098, 1213099, 1213100, 1213102, 1213103, 1213104, 1213105, 1213106, 1213107, 1213108, 1213109, 1213110, 1213111, 1213112, 1213113, 1213114, 1213116, 1213134, 1213167, 1213205, 1213206, 1213226, 1213233, 1213245, 1213247, 1213252, 1213258, 1213259, 1213263, 1213264, 1213272, 1213286, 1213287, 1213304, 1213417, 1213493, 1213523, 1213524, 1213533, 1213543, 1213578, 1213585, 1213586, 1213588, 1213601, 1213620, 1213632, 1213653, 1213705, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871, 1213872 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-1829, CVE-2023-20569, CVE-2023-20593, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-2430, CVE-2023-2985, CVE-2023-3090, CVE-2023-31083, CVE-2023-3111, CVE-2023-3117, CVE-2023-31248, CVE-2023-3212, CVE-2023-3268, CVE-2023-3389, CVE-2023-3390, CVE-2023-35001, CVE-2023-3567, CVE-2023-3609, CVE-2023-3611, CVE-2023-3776, CVE-2023-3812, CVE-2023-38409, CVE-2023-3863, CVE-2023-4004 Jira References: PED-4718, PED-4758 Sources used: openSUSE Leap 15.5 (src): kernel-livepatch-SLE15-SP5-RT_Update_3-1-150500.11.5.1, kernel-syms-rt-5.14.21-150500.13.11.1, kernel-source-rt-5.14.21-150500.13.11.1 SUSE Linux Enterprise Live Patching 15-SP5 (src): kernel-livepatch-SLE15-SP5-RT_Update_3-1-150500.11.5.1 SUSE Real Time Module 15-SP5 (src): kernel-syms-rt-5.14.21-150500.13.11.1, kernel-source-rt-5.14.21-150500.13.11.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 42](show_bug.cgi?id=1210780#c42)  Maintenance Automation   2023-08-14 16:30:14 UTC  ``` SUSE-SU-2023:3313-1: An update that solves 13 vulnerabilities and has 20 fixes can now be installed.  Category: security (important) Bug References: 1206418, 1207129, 1210627, 1210780, 1211131, 1211738, 1212502, 1212604, 1212901, 1213167, 1213272, 1213287, 1213304, 1213585, 1213586, 1213588, 1213620, 1213653, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213842, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-20569, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-31083, CVE-2023-3268, CVE-2023-3567, CVE-2023-3609, CVE-2023-3611, CVE-2023-3776, CVE-2023-4004 Sources used: SUSE Linux Enterprise Micro for Rancher 5.4 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3 SUSE Linux Enterprise Micro 5.4 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3 Basesystem Module 15-SP4 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3, kernel-source-5.14.21-150400.24.81.1 Development Tools Module 15-SP4 (src): kernel-source-5.14.21-150400.24.81.1, kernel-syms-5.14.21-150400.24.81.1, kernel-obs-build-5.14.21-150400.24.81.1 SUSE Linux Enterprise Live Patching 15-SP4 (src): kernel-livepatch-SLE15-SP4_Update_16-1-150400.9.3.3 openSUSE Leap 15.4 (src): kernel-obs-qa-5.14.21-150400.24.81.1, kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3, kernel-syms-5.14.21-150400.24.81.1, kernel-source-5.14.21-150400.24.81.1, kernel-obs-build-5.14.21-150400.24.81.1, kernel-livepatch-SLE15-SP4_Update_16-1-150400.9.3.3 openSUSE Leap Micro 5.3 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3 openSUSE Leap Micro 5.4 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3 SUSE Linux Enterprise Micro for Rancher 5.3 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3 SUSE Linux Enterprise Micro 5.3 (src): kernel-default-base-5.14.21-150400.24.81.1.150400.24.35.3  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 43](show_bug.cgi?id=1210780#c43)  Maintenance Automation   2023-08-14 16:30:29 UTC  ``` SUSE-SU-2023:3311-1: An update that solves 15 vulnerabilities and has 27 fixes can now be installed.  Category: security (important) Bug References: 1206418, 1207129, 1207948, 1210627, 1210780, 1210825, 1211131, 1211738, 1211811, 1212445, 1212502, 1212604, 1212766, 1212901, 1213167, 1213272, 1213287, 1213304, 1213417, 1213578, 1213585, 1213586, 1213588, 1213601, 1213620, 1213632, 1213653, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871, 1213872 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-20569, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-31083, CVE-2023-3268, CVE-2023-3567, CVE-2023-3609, CVE-2023-3611, CVE-2023-3776, CVE-2023-38409, CVE-2023-3863, CVE-2023-4004 Sources used: openSUSE Leap 15.5 (src): kernel-syms-5.14.21-150500.55.19.1, kernel-default-base-5.14.21-150500.55.19.1.150500.6.6.4, kernel-livepatch-SLE15-SP5_Update_3-1-150500.11.3.4, kernel-source-5.14.21-150500.55.19.1, kernel-obs-qa-5.14.21-150500.55.19.1, kernel-obs-build-5.14.21-150500.55.19.1 Basesystem Module 15-SP5 (src): kernel-default-base-5.14.21-150500.55.19.1.150500.6.6.4, kernel-source-5.14.21-150500.55.19.1 Development Tools Module 15-SP5 (src): kernel-obs-build-5.14.21-150500.55.19.1, kernel-syms-5.14.21-150500.55.19.1, kernel-source-5.14.21-150500.55.19.1 SUSE Linux Enterprise Live Patching 15-SP5 (src): kernel-livepatch-SLE15-SP5_Update_3-1-150500.11.3.4  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 44](show_bug.cgi?id=1210780#c44)  Maintenance Automation   2023-08-15 12:30:08 UTC  ``` SUSE-SU-2023:3318-1: An update that solves 20 vulnerabilities and has 89 fixes can now be installed.  Category: security (important) Bug References: 1150305, 1193629, 1194869, 1206418, 1207129, 1207894, 1208788, 1210565, 1210584, 1210627, 1210780, 1210853, 1211131, 1211243, 1211738, 1211811, 1211867, 1212301, 1212502, 1212604, 1212846, 1212901, 1212905, 1213010, 1213011, 1213012, 1213013, 1213014, 1213015, 1213016, 1213017, 1213018, 1213019, 1213020, 1213021, 1213024, 1213025, 1213032, 1213034, 1213035, 1213036, 1213037, 1213038, 1213039, 1213040, 1213041, 1213059, 1213061, 1213087, 1213088, 1213089, 1213090, 1213092, 1213093, 1213094, 1213095, 1213096, 1213098, 1213099, 1213100, 1213102, 1213103, 1213104, 1213105, 1213106, 1213107, 1213108, 1213109, 1213110, 1213111, 1213112, 1213113, 1213114, 1213134, 1213167, 1213245, 1213247, 1213252, 1213258, 1213259, 1213263, 1213264, 1213272, 1213286, 1213287, 1213304, 1213523, 1213524, 1213543, 1213585, 1213586, 1213588, 1213620, 1213653, 1213705, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-20569, CVE-2023-20593, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-2985, CVE-2023-31083, CVE-2023-3117, CVE-2023-31248, CVE-2023-3268, CVE-2023-3390, CVE-2023-35001, CVE-2023-3567, CVE-2023-3609, CVE-2023-3611, CVE-2023-3776, CVE-2023-3812, CVE-2023-4004 Sources used: openSUSE Leap 15.4 (src): kernel-syms-rt-5.14.21-150400.15.46.1, kernel-source-rt-5.14.21-150400.15.46.1 SUSE Linux Enterprise Live Patching 15-SP4 (src): kernel-livepatch-SLE15-SP4-RT_Update_11-1-150400.1.5.1 SUSE Real Time Module 15-SP4 (src): kernel-syms-rt-5.14.21-150400.15.46.1, kernel-source-rt-5.14.21-150400.15.46.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 45](show_bug.cgi?id=1210780#c45)  Maintenance Automation   2023-08-22 16:30:03 UTC  ``` SUSE-SU-2023:3376-1: An update that solves 15 vulnerabilities and has 27 fixes can now be installed.  Category: security (important) Bug References: 1206418, 1207129, 1207948, 1210627, 1210780, 1210825, 1211131, 1211738, 1211811, 1212445, 1212502, 1212604, 1212766, 1212901, 1213167, 1213272, 1213287, 1213304, 1213417, 1213578, 1213585, 1213586, 1213588, 1213601, 1213620, 1213632, 1213653, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871, 1213872 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-20569, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-31083, CVE-2023-3268, CVE-2023-3567, CVE-2023-3609, CVE-2023-3611, CVE-2023-3776, CVE-2023-38409, CVE-2023-3863, CVE-2023-4004 Sources used: openSUSE Leap 15.5 (src): kernel-syms-azure-5.14.21-150500.33.14.1, kernel-source-azure-5.14.21-150500.33.14.1 Public Cloud Module 15-SP5 (src): kernel-syms-azure-5.14.21-150500.33.14.1, kernel-source-azure-5.14.21-150500.33.14.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 46](show_bug.cgi?id=1210780#c46)  Maintenance Automation   2023-08-22 20:30:13 UTC  ``` SUSE-SU-2023:3377-1: An update that solves 11 vulnerabilities and has 19 fixes can now be installed.  Category: security (important) Bug References: 1206418, 1207129, 1210627, 1210780, 1211131, 1211738, 1212502, 1212604, 1212901, 1213167, 1213272, 1213287, 1213304, 1213588, 1213620, 1213653, 1213713, 1213715, 1213747, 1213756, 1213759, 1213777, 1213810, 1213812, 1213856, 1213857, 1213863, 1213867, 1213870, 1213871 CVE References: CVE-2022-40982, CVE-2023-0459, CVE-2023-20569, CVE-2023-21400, CVE-2023-2156, CVE-2023-2166, CVE-2023-31083, CVE-2023-3268, CVE-2023-3567, CVE-2023-3776, CVE-2023-4004 Sources used: openSUSE Leap 15.4 (src): kernel-source-azure-5.14.21-150400.14.63.1, kernel-syms-azure-5.14.21-150400.14.63.1 Public Cloud Module 15-SP4 (src): kernel-source-azure-5.14.21-150400.14.63.1, kernel-syms-azure-5.14.21-150400.14.63.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 47](show_bug.cgi?id=1210780#c47)  Joey Lee   2023-09-05 15:13:16 UTC  ``` (In reply to Joey Lee from [comment #21](show_bug.cgi?id=1210780#c21)) > (In reply to Joey Lee from [comment #20](show_bug.cgi?id=1210780#c20)) > > I have backported the following patch from bluetooth-next git tree to 15-SP4 > > kernel and wait to be merged: > >  > > <https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/> > > commit/?id=15ab2fa56dc00baca71266e17b0ba34036cd1efe >  > Backported patch be merged to 15-SP4 kernel now: >  > commit ad56bc87a28e422f0e2ad833dd6cfc8c9df2de41 > (origin/users/jlee/SLE15-SP4/for-next, SLE15-SP4-bsc1210780) > Author: Lee, Chun-Yi <jlee@suse.com> > Date:   Wed Jul 26 11:42:04 2023 +0800 >  >     Bluetooth: hci_ldisc: check HCI_UART_PROTO_READY flag in >     HCIUARTGETPROTO ([bsc#1210780](http://bugzilla.suse.com/show_bug.cgi?id=1210780) CVE-2023-31083). >  >  > I will backport to other SLE version after my patch be merged to kernel > mainline.  My patch be merged on upstream:  commit 9c33663af9ad115f90c076a1828129a3fbadea98 Author: Lee, Chun-Yi <joeyli.kernel@gmail.com> Date:   Mon Jul 10 23:17:23 2023 +0800      Bluetooth: hci_ldisc: check HCI_UART_PROTO_READY flag in HCIUARTGETPROTO  I will backport it to other SLE version. ``` [Comment 52](show_bug.cgi?id=1210780#c52)  Petr Mladek   2023-11-30 15:18:42 UTC  ``` Joey, it seems that the fix has been ported to almost all branches. The only exception is cve/linux-3.0.  Is cve/linux-3.0 (SLE11-SP4-LTSS) affected, please?  If not, then we might reassign the bug back to the security team for further tracking. ``` [Comment 65](show_bug.cgi?id=1210780#c65)  Maintenance Automation   2023-12-12 16:30:25 UTC  ``` SUSE-SU-2023:4735-1: An update that solves seven vulnerabilities, contains two features and has 19 security fixes can now be installed.  Category: security (important) Bug References: 1084909, 1176950, 1190208, 1203496, 1205462, 1208787, 1210780, 1214037, 1214285, 1214408, 1214764, 1216031, 1216058, 1216259, 1216584, 1216759, 1216965, 1216976, 1217036, 1217087, 1217206, 1217519, 1217525, 1217603, 1217604, 1217607 CVE References: CVE-2023-0461, CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717 Jira References: PED-3184, PED-5021 Sources used: SUSE Linux Enterprise Real Time 12 SP5 (src): kernel-source-rt-4.12.14-10.154.1, kernel-syms-rt-4.12.14-10.154.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 66](show_bug.cgi?id=1210780#c66)  Maintenance Automation   2023-12-12 16:30:42 UTC  ``` SUSE-SU-2023:4733-1: An update that solves seven vulnerabilities, contains two features and has eight security fixes can now be installed.  Category: security (important) Bug References: 1084909, 1210780, 1214037, 1214344, 1214764, 1215371, 1216058, 1216259, 1216584, 1216965, 1216976, 1217140, 1217332, 1217408, 1217780 CVE References: CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717, CVE-2023-6176 Jira References: PED-3184, PED-5021 Sources used:  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 68](show_bug.cgi?id=1210780#c68)  Maintenance Automation   2023-12-13 16:30:04 UTC  ``` SUSE-SU-2023:4784-1: An update that solves seven vulnerabilities, contains two features and has 19 security fixes can now be installed.  Category: security (important) Bug References: 1084909, 1176950, 1190208, 1203496, 1205462, 1208787, 1210780, 1214037, 1214285, 1214408, 1214764, 1216031, 1216058, 1216259, 1216584, 1216759, 1216965, 1216976, 1217036, 1217087, 1217206, 1217519, 1217525, 1217603, 1217604, 1217607 CVE References: CVE-2023-0461, CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717 Jira References: PED-3184, PED-5021 Sources used: SUSE Linux Enterprise Live Patching 12-SP5 (src): kgraft-patch-SLE12-SP5_Update_51-1-8.3.1 SUSE Linux Enterprise Software Development Kit 12 SP5 (src): kernel-obs-build-4.12.14-122.186.1 SUSE Linux Enterprise High Performance Computing 12 SP5 (src): kernel-source-4.12.14-122.186.1, kernel-syms-4.12.14-122.186.1 SUSE Linux Enterprise Server 12 SP5 (src): kernel-source-4.12.14-122.186.1, kernel-syms-4.12.14-122.186.1 SUSE Linux Enterprise Server for SAP Applications 12 SP5 (src): kernel-source-4.12.14-122.186.1, kernel-syms-4.12.14-122.186.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 69](show_bug.cgi?id=1210780#c69)  Maintenance Automation   2023-12-13 16:30:11 UTC  ``` SUSE-SU-2023:4783-1: An update that solves seven vulnerabilities, contains two features and has five security fixes can now be installed.  Category: security (important) Bug References: 1084909, 1210780, 1214037, 1214344, 1214764, 1216058, 1216259, 1216584, 1216965, 1216976, 1217332, 1217780 CVE References: CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717, CVE-2023-6176 Jira References: PED-3184, PED-5021 Sources used: SUSE Linux Enterprise Live Patching 15-SP2 (src): kernel-livepatch-SLE15-SP2_Update_43-1-150200.5.3.1 SUSE Linux Enterprise High Performance Computing 15 SP2 LTSS 15-SP2 (src): kernel-syms-5.3.18-150200.24.172.1, kernel-default-base-5.3.18-150200.24.172.1.150200.9.87.1, kernel-source-5.3.18-150200.24.172.1, kernel-obs-build-5.3.18-150200.24.172.1 SUSE Linux Enterprise Server 15 SP2 LTSS 15-SP2 (src): kernel-syms-5.3.18-150200.24.172.1, kernel-default-base-5.3.18-150200.24.172.1.150200.9.87.1, kernel-source-5.3.18-150200.24.172.1, kernel-obs-build-5.3.18-150200.24.172.1 SUSE Linux Enterprise Server for SAP Applications 15 SP2 (src): kernel-syms-5.3.18-150200.24.172.1, kernel-default-base-5.3.18-150200.24.172.1.150200.9.87.1, kernel-source-5.3.18-150200.24.172.1, kernel-obs-build-5.3.18-150200.24.172.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 70](show_bug.cgi?id=1210780#c70)  Maintenance Automation   2023-12-13 20:30:26 UTC  ``` SUSE-SU-2023:4811-1: An update that solves seven vulnerabilities, contains two features and has eight security fixes can now be installed.  Category: security (important) Bug References: 1084909, 1210780, 1214037, 1214344, 1214764, 1215371, 1216058, 1216259, 1216584, 1216965, 1216976, 1217140, 1217332, 1217408, 1217780 CVE References: CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717, CVE-2023-6176 Jira References: PED-3184, PED-5021 Sources used: openSUSE Leap 15.3 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-livepatch-SLE15-SP3_Update_39-1-150300.7.3.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-obs-qa-5.3.18-150300.59.144.1, kernel-source-5.3.18-150300.59.144.1 SUSE Linux Enterprise Live Patching 15-SP3 (src): kernel-livepatch-SLE15-SP3_Update_39-1-150300.7.3.1 SUSE Linux Enterprise High Performance Computing ESPOS 15 SP3 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-source-5.3.18-150300.59.144.1 SUSE Linux Enterprise High Performance Computing LTSS 15 SP3 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-source-5.3.18-150300.59.144.1 SUSE Linux Enterprise Server 15 SP3 LTSS 15-SP3 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-source-5.3.18-150300.59.144.1 SUSE Linux Enterprise Server for SAP Applications 15 SP3 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-source-5.3.18-150300.59.144.1 SUSE Enterprise Storage 7.1 (src): kernel-obs-build-5.3.18-150300.59.144.1, kernel-syms-5.3.18-150300.59.144.1, kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1, kernel-source-5.3.18-150300.59.144.1 SUSE Linux Enterprise Micro 5.1 (src): kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1 SUSE Linux Enterprise Micro 5.2 (src): kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1 SUSE Linux Enterprise Micro for Rancher 5.2 (src): kernel-default-base-5.3.18-150300.59.144.1.150300.18.84.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 71](show_bug.cgi?id=1210780#c71)  Maintenance Automation   2023-12-15 12:30:01 UTC  ``` SUSE-SU-2023:4882-1: An update that solves seven vulnerabilities, contains two features and has one security fix can now be installed.  Category: security (important) Bug References: 1084909, 1208787, 1210780, 1216058, 1216259, 1216584, 1216965, 1216976 CVE References: CVE-2023-0461, CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717 Jira References: PED-3184, PED-5021 Sources used: SUSE Linux Enterprise Live Patching 15-SP1 (src): kernel-livepatch-SLE15-SP1_Update_46-1-150100.3.5.1 SUSE Linux Enterprise High Performance Computing 15 SP1 LTSS 15-SP1 (src): kernel-syms-4.12.14-150100.197.165.1, kernel-obs-build-4.12.14-150100.197.165.1, kernel-source-4.12.14-150100.197.165.1 SUSE Linux Enterprise Server 15 SP1 LTSS 15-SP1 (src): kernel-syms-4.12.14-150100.197.165.1, kernel-obs-build-4.12.14-150100.197.165.1, kernel-source-4.12.14-150100.197.165.1 SUSE Linux Enterprise Server for SAP Applications 15 SP1 (src): kernel-syms-4.12.14-150100.197.165.1, kernel-obs-build-4.12.14-150100.197.165.1, kernel-source-4.12.14-150100.197.165.1 SUSE CaaS Platform 4.0 (src): kernel-syms-4.12.14-150100.197.165.1, kernel-obs-build-4.12.14-150100.197.165.1, kernel-source-4.12.14-150100.197.165.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 72](show_bug.cgi?id=1210780#c72)  Maintenance Automation   2023-12-15 12:30:07 UTC  ``` SUSE-SU-2023:4883-1: An update that solves seven vulnerabilities, contains two features and has 18 security fixes can now be installed.  Category: security (important) Bug References: 1176950, 1190208, 1203496, 1205462, 1208787, 1210780, 1214037, 1214285, 1214408, 1214764, 1216031, 1216058, 1216259, 1216584, 1216759, 1216965, 1216976, 1217036, 1217087, 1217206, 1217519, 1217525, 1217603, 1217604, 1217607 CVE References: CVE-2023-0461, CVE-2023-31083, CVE-2023-39197, CVE-2023-39198, CVE-2023-45863, CVE-2023-45871, CVE-2023-5717 Jira References: PED-3184, PED-5021 Sources used: SUSE Linux Enterprise Server for SAP Applications 12 SP5 (src): kernel-source-azure-4.12.14-16.160.1, kernel-syms-azure-4.12.14-16.160.1 SUSE Linux Enterprise High Performance Computing 12 SP5 (src): kernel-source-azure-4.12.14-16.160.1, kernel-syms-azure-4.12.14-16.160.1 SUSE Linux Enterprise Server 12 SP5 (src): kernel-source-azure-4.12.14-16.160.1, kernel-syms-azure-4.12.14-16.160.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 76](show_bug.cgi?id=1210780#c76)  Joey Lee   2024-03-20 12:50:03 UTC  ``` (In reply to Petr Mladek from [comment #52](show_bug.cgi?id=1210780#c52)) > Joey, it seems that the fix has been ported to almost all branches. > The only exception is cve/linux-3.0. >  > Is cve/linux-3.0 (SLE11-SP4-LTSS) affected, please? >  > If not, then we might reassign the bug back to the security team > for further tracking.  Thanks for your reminder. I just sent out the merge request to cve/linux-3.0. ``` [Comment 77](show_bug.cgi?id=1210780#c77)  Joey Lee   2024-03-20 12:51:55 UTC  ``` (In reply to Joey Lee from [comment #76](show_bug.cgi?id=1210780#c76)) > (In reply to Petr Mladek from [comment #52](show_bug.cgi?id=1210780#c52)) > > Joey, it seems that the fix has been ported to almost all branches. > > The only exception is cve/linux-3.0. > >  > > Is cve/linux-3.0 (SLE11-SP4-LTSS) affected, please? > >  > > If not, then we might reassign the bug back to the security team > > for further tracking. >  > Thanks for your reminder. I just sent out the merge request to cve/linux-3.0.  hm... My submit is not success. I am checking why kernel-source git reject. ``` [Comment 78](show_bug.cgi?id=1210780#c78)  Joey Lee   2024-03-20 13:29:08 UTC  ``` (In reply to Joey Lee from [comment #77](show_bug.cgi?id=1210780#c77)) > (In reply to Joey Lee from [comment #76](show_bug.cgi?id=1210780#c76)) > > (In reply to Petr Mladek from [comment #52](show_bug.cgi?id=1210780#c52)) > > > Joey, it seems that the fix has been ported to almost all branches. > > > The only exception is cve/linux-3.0. > > >  > > > Is cve/linux-3.0 (SLE11-SP4-LTSS) affected, please? > > >  > > > If not, then we might reassign the bug back to the security team > > > for further tracking. > >  > > Thanks for your reminder. I just sent out the merge request to cve/linux-3.0. >  > hm... My submit is not success. I am checking why kernel-source git reject.  The cve/linux-3.0 is deprecated. I direct backported to SLE11-SP4-LTSS and wait to be merged. ``` [Comment 84](show_bug.cgi?id=1210780#c84)  Robert Frohl   2024-05-07 09:09:19 UTC  ``` done, closing ``` [Comment 87](show_bug.cgi?id=1210780#c87)  Maintenance Automation   2024-08-19 12:40:53 UTC  ``` SUSE-SU-2024:1669-1: An update that solves 20 vulnerabilities and has four security fixes can now be installed.  URL: <https://www.suse.com/support/update/announcement/2024/suse-su-20241669-1> Category: security (important) Bug References: 1210780, 1213456, 1218220, 1218562, 1218730, 1218757, 1219146, 1219295, 1219827, 1220191, 1220238, 1220241, 1220416, 1220418, 1220444, 1220649, 1221044, 1221088, 1221578, 1221598, 1222585, 1222619, 1223016, 1223824 CVE References: CVE-2021-46904, CVE-2021-46905, CVE-2021-46932, CVE-2022-48619, CVE-2023-28746, CVE-2023-31083, CVE-2023-51780, CVE-2023-51782, CVE-2023-52340, CVE-2023-52429, CVE-2023-52445, CVE-2023-52449, CVE-2023-52475, CVE-2023-52590, CVE-2023-52591, CVE-2023-6270, CVE-2024-23851, CVE-2024-26733, CVE-2024-26898, CVE-2024-27043 Maintenance Incident: [SUSE:Maintenance:33814](<https://smelt.suse.de/incident/33814/>) Sources used: SUSE Linux Enterprise Server 11 SP4 LTSS EXTREME CORE 11-SP4 (src):  kernel-source-3.0.101-108.153.1, kernel-syms-3.0.101-108.153.1 SUSE Linux Enterprise Server 11 SP4 (src):  kernel-source-3.0.101-108.153.1, kernel-syms-3.0.101-108.153.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1210780)
* - [XML](show_bug.cgi?ctype=xml&id=1210780)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1210780)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1210780)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from gist.github.com_23fc4265_20250115_112224.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@ZHYfeng](https://avatars.githubusercontent.com/u/3368175?s=64&v=4)](/ZHYfeng)

# [ZHYfeng](/ZHYfeng)/**[6659a2b9281752acd5e92c19e2aa9abf7e9f1753](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb)** Secret

Last active
April 18, 2023 05:32

Show Gist options

* [Download ZIP](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb/archive/bd775148da87efadb72d5fbcabff46b09136f53a.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb.js&quot;&gt;&lt;/script&gt;
* Save ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb to your computer and use it in GitHub Desktop.

[Code](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb)
[Revisions
2](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb.js&quot;&gt;&lt;/script&gt;

Save ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb to your computer and use it in GitHub Desktop.

[Download ZIP](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb/archive/bd775148da87efadb72d5fbcabff46b09136f53a.zip)

 [Raw](/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb/raw/bd775148da87efadb72d5fbcabff46b09136f53a/6659a2b9281752acd5e92c19e2aa9abf7e9f1753)

[**6659a2b9281752acd5e92c19e2aa9abf7e9f1753**](#file-6659a2b9281752acd5e92c19e2aa9abf7e9f1753)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | Syzkaller hit 'general protection fault in hci\_uart\_tty\_ioctl' bug. |
| --- | --- |
|  |  |
|  | general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN |
|  | KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007] |
|  | CPU: 0 PID: 8770 Comm: syz-executor.0 Not tainted 6.2.0 #4 |
|  | Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014 |
|  | RIP: 0010:hci\_uart\_tty\_ioctl+0x244/0xc20 drivers/bluetooth/hci\_ldisc.c:774 |
|  | Code: df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 cf 08 00 00 48 8b 9b b8 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 <0f> b6 04 02 84 c0 74 08 3c 03 0f 8e 5f 08 00 00 44 8b 23 e9 14 ff |
|  | RSP: 0018:ffffc900022a7d10 EFLAGS: 00010246 |
|  | RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffff8710057c |
|  | RDX: 0000000000000000 RSI: ffff888046df8000 RDI: ffff88801cf510b8 |
|  | RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed10039ea204 |
|  | R10: ffff88801cf5101f R11: ffffed10039ea203 R12: ffff8880204eb000 |
|  | R13: 0000000000000000 R14: ffffffffffffffe7 R15: 00000000800401c0 |
|  | FS: 00007f203e7dd700(0000) GS:ffff88802ca00000(0000) knlGS:0000000000000000 |
|  | CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 |
|  | CR2: 00005587ec7f32d8 CR3: 000000004629e000 CR4: 0000000000350ef0 |
|  | DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 |
|  | DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 |
|  | Call Trace: |
|  | <TASK> |
|  | tty\_ioctl+0xac0/0x1420 drivers/tty/tty\_io.c:2784 |
|  | vfs\_ioctl fs/ioctl.c:51 [inline] |
|  | \_\_do\_sys\_ioctl fs/ioctl.c:870 [inline] |
|  | \_\_se\_sys\_ioctl fs/ioctl.c:856 [inline] |
|  | \_\_x64\_sys\_ioctl+0x198/0x210 fs/ioctl.c:856 |
|  | do\_syscall\_x64 arch/x86/entry/common.c:50 [inline] |
|  | do\_syscall\_64+0x35/0xb0 arch/x86/entry/common.c:80 |
|  | entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd |
|  | RIP: 0033:0x7f203f0902fd |
|  | Code: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 |
|  | RSP: 002b:00007f203e7dcc58 EFLAGS: 00000246 ORIG\_RAX: 0000000000000010 |
|  | RAX: ffffffffffffffda RBX: 00007f203f1bc020 RCX: 00007f203f0902fd |
|  | RDX: 0000000000000000 RSI: 00000000800455c9 RDI: 0000000000000003 |
|  | RBP: 00007f203f0fec89 R08: 0000000000000000 R09: 0000000000000000 |
|  | R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000 |
|  | R13: 00007ffee4615aef R14: 00007ffee4615ca0 R15: 00007f203e7dcdc0 |
|  | </TASK> |
|  | Modules linked in: |
|  | ---[ end trace 0000000000000000 ]--- |
|  | RIP: 0010:hci\_uart\_tty\_ioctl+0x244/0xc20 drivers/bluetooth/hci\_ldisc.c:774 |
|  | Code: df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 cf 08 00 00 48 8b 9b b8 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 <0f> b6 04 02 84 c0 74 08 3c 03 0f 8e 5f 08 00 00 44 8b 23 e9 14 ff |
|  | RSP: 0018:ffffc900022a7d10 EFLAGS: 00010246 |
|  | RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffff8710057c |
|  | RDX: 0000000000000000 RSI: ffff888046df8000 RDI: ffff88801cf510b8 |
|  | RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed10039ea204 |
|  | R10: ffff88801cf5101f R11: ffffed10039ea203 R12: ffff8880204eb000 |
|  | R13: 0000000000000000 R14: ffffffffffffffe7 R15: 00000000800401c0 |
|  | FS: 00007f203e7dd700(0000) GS:ffff88807ec00000(0000) knlGS:0000000000000000 |
|  | CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 |
|  | CR2: 00007fae9539b740 CR3: 000000004629e000 CR4: 0000000000350ee0 |
|  | DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 |
|  | DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 |
|  | ---------------- |
|  | Code disassembly (best guess): |
|  | 0: df 48 89 fisttps -0x77(%rax) |
|  | 3: fa cli |
|  | 4: 48 c1 ea 03 shr $0x3,%rdx |
|  | 8: 80 3c 02 00 cmpb $0x0,(%rdx,%rax,1) |
|  | c: 0f 85 cf 08 00 00 jne 0x8e1 |
|  | 12: 48 8b 9b b8 00 00 00 mov 0xb8(%rbx),%rbx |
|  | 19: 48 b8 00 00 00 00 00 movabs $0xdffffc0000000000,%rax |
|  | 20: fc ff df |
|  | 23: 48 89 da mov %rbx,%rdx |
|  | 26: 48 c1 ea 03 shr $0x3,%rdx |
|  | \* 2a: 0f b6 04 02 movzbl (%rdx,%rax,1),%eax <-- trapping instruction |
|  | 2e: 84 c0 test %al,%al |
|  | 30: 74 08 je 0x3a |
|  | 32: 3c 03 cmp $0x3,%al |
|  | 34: 0f 8e 5f 08 00 00 jle 0x899 |
|  | 3a: 44 8b 23 mov (%rbx),%r12d |
|  | 3d: e9 .byte 0xe9 |
|  | 3e: 14 ff adc $0xff,%al |
|  |  |
|  |  |
|  | Syzkaller reproducer: |
|  | # {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox:none Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:true VhciInjection:true Wifi:true IEEE802154:true Sysctl:true UseTmpDir:true HandleSegv:true Repro:false Trace:false LegacyOptions:{Fault:false FaultCall:0 FaultNth:0} InitResource:false} |
|  | ioctl$cec0\_Groupc05c6104\_25(0xffffffffffffffff, 0xc05c6104, 0x0) |
|  | r0 = openat$ptmx\_syzgen(0xffffffffffffff9c, &(0x7f0000000000), 0x0, 0x0) |
|  | ioctl$ptmx\_Group5423\_1(r0, 0x5423, &(0x7f0000000000)=0xf) |
|  | r1 = openat$ttyprintk\_syzgen(0xffffffffffffff9c, 0x0, 0x200, 0x0) |
|  | ioctl$ptmx\_Group5407\_2(r1, 0x5407, 0x0) |
|  | ioctl$ptmx\_Group5402\_3(r0, 0x400455c8, 0x0) |
|  | ioctl$ptmx\_Group5402\_3(r0, 0x800455c9, 0x0) |
|  |  |
|  |  |
|  | C reproducer: Note that I inserted a prink in the source code so that the C producer can easily trigger the bug. |
|  |  |
|  | // autogenerated by syzkaller (https://github.com/google/syzkaller) |
|  |  |
|  | #define \_GNU\_SOURCE |
|  |  |
|  | #include <endian.h> |
|  | #include <stdint.h> |
|  | #include <stdio.h> |
|  | #include <stdlib.h> |
|  | #include <string.h> |
|  | #include <sys/syscall.h> |
|  | #include <sys/types.h> |
|  | #include <unistd.h> |
|  | #include <pthread.h> |
|  |  |
|  | uint64\_t r[2] = {0xffffffffffffffff, 0xffffffffffffffff}; |
|  |  |
|  | void \*thr0(void \*arg) { |
|  | syscall(\_\_NR\_ioctl, r[0], 0x400455c8, 0ul); |
|  | } |
|  |  |
|  | void \*thr1(void \*arg) { |
|  | syscall(\_\_NR\_ioctl, r[0], 0x800455c9, 0ul); |
|  | } |
|  |  |
|  | int main(void) |
|  | { |
|  | pthread\_t th[4]; |
|  | int i = 0; |
|  | syscall(\_\_NR\_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul); |
|  | syscall(\_\_NR\_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul); |
|  | syscall(\_\_NR\_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul); |
|  | intptr\_t res = 0; |
|  | syscall(\_\_NR\_ioctl, -1, 0xc05c6104, 0ul); |
|  | memcpy((void\*)0x20000000, "/dev/pts/ptmx\000", 14); |
|  | \*(uint32\_t\*)0x20001000 = 0xf; |
|  | for (i = 0;; i++) { |
|  | res = syscall(\_\_NR\_openat, 0xffffffffffffff9cul, 0x20000000ul, 0ul, 0ul); |
|  | if (res != -1) |
|  | r[0] = res; |
|  | else |
|  | continue; |
|  |  |
|  | syscall(\_\_NR\_ioctl, r[0], 0x5423, 0x20001000ul); |
|  | pthread\_create(&th[0], 0, thr0, 0); |
|  | pthread\_create(&th[1], 0, thr1, 0); |
|  | pthread\_join(th[0], 0); |
|  | pthread\_join(th[1], 0); |
|  | close(r[0]); |
|  | } |
|  | return 0; |
|  | } |
|  |  |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FZHYfeng%2Fa3e3ff2bdfea5ed5de5475f0b54d55cb)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lore.kernel.org_67d53f5c_20250114_181906.html ===

```
[All of lore.kernel.org](../?t=20230418050033)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Yu Hao <yhao016@ucr.edu>
To: marcel@holtmann.org, johan.hedberg@gmail.com,
	luiz.dentz@gmail.com, [linux-bluetooth@vger.kernel.org](../../linux-bluetooth/?t=20230418050033),
	[linux-kernel@vger.kernel.org](../../lkml/?t=20230418050033)
Subject: [BUG: general protection fault in hci_uart_tty_ioctl](#r)
Date: Mon, 17 Apr 2023 21:59:12 -0700	[[thread overview]](#r)
Message-ID: <CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com> (<raw>)

Hello,

We found the following issue using syzkaller on Linux v6.2.0.

In function `hci_uart_tty_ioctl`, there is a race condition
between HCIUARTSETPROTO and HCIUARTGETPROTO.
HCI_UART_PROTO_SET is set before `hu->proto` is set.
Thus it may dereference a null pointer.

The full report including the Syzkaller reproducer & C reproducer:
<https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>

The brief report is below:

Syzkaller hit 'general protection fault in hci_uart_tty_ioctl' bug.

general protection fault, probably for non-canonical address
0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN
KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
CPU: 0 PID: 8770 Comm: syz-executor.0 Not tainted 6.2.0 #4
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
1.13.0-1ubuntu1.1 04/01/2014
RIP: 0010:hci_uart_tty_ioctl+0x244/0xc20 drivers/bluetooth/hci_ldisc.c:774
Code: df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 cf 08 00 00 48 8b 9b
b8 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 <0f> b6
04 02 84 c0 74 08 3c 03 0f 8e 5f 08 00 00 44 8b 23 e9 14 ff
RSP: 0018:ffffc900022a7d10 EFLAGS: 00010246
RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffff8710057c
RDX: 0000000000000000 RSI: ffff888046df8000 RDI: ffff88801cf510b8
RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed10039ea204
R10: ffff88801cf5101f R11: ffffed10039ea203 R12: ffff8880204eb000
R13: 0000000000000000 R14: ffffffffffffffe7 R15: 00000000800401c0
FS:  00007f203e7dd700(0000) GS:ffff88802ca00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00005587ec7f32d8 CR3: 000000004629e000 CR4: 0000000000350ef0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
 <TASK>
 tty_ioctl+0xac0/0x1420 drivers/tty/tty_io.c:2784
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x198/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
RIP: 0033:0x7f203f0902fd
Code: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48
89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d
01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007f203e7dcc58 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f203f1bc020 RCX: 00007f203f0902fd
RDX: 0000000000000000 RSI: 00000000800455c9 RDI: 0000000000000003
RBP: 00007f203f0fec89 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 00007ffee4615aef R14: 00007ffee4615ca0 R15: 00007f203e7dcdc0
 </TASK>

```

---

```
                 [reply](#R)other threads:[[~2023-04-18  5:00 UTC](../?t=20230418050033)|[newest](../)]

Thread overview: [no followups] expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com \
    --to=yhao016@ucr.edu \
    --cc=johan.hedberg@gmail.com \
    --cc=linux-bluetooth@vger.kernel.org \
    --cc=linux-kernel@vger.kernel.org \
    --cc=luiz.dentz@gmail.com \
    --cc=marcel@holtmann.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is an external index of several public inboxes,
see [mirroring instructions](../_/text/mirror/) on how to clone and mirror
all data and code used by this external index.
```


=== Content from lore.kernel.org_81ab2b07_20250115_112223.html ===

```
[All of lore.kernel.org](../?t=20230418050033)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Yu Hao <yhao016@ucr.edu>
To: marcel@holtmann.org, johan.hedberg@gmail.com,
	luiz.dentz@gmail.com, [linux-bluetooth@vger.kernel.org](../../linux-bluetooth/?t=20230418050033),
	[linux-kernel@vger.kernel.org](../../lkml/?t=20230418050033)
Subject: [BUG: general protection fault in hci_uart_tty_ioctl](#r)
Date: Mon, 17 Apr 2023 21:59:12 -0700	[[thread overview]](#r)
Message-ID: <CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com> (<raw>)

Hello,

We found the following issue using syzkaller on Linux v6.2.0.

In function `hci_uart_tty_ioctl`, there is a race condition
between HCIUARTSETPROTO and HCIUARTGETPROTO.
HCI_UART_PROTO_SET is set before `hu->proto` is set.
Thus it may dereference a null pointer.

The full report including the Syzkaller reproducer & C reproducer:
<https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>

The brief report is below:

Syzkaller hit 'general protection fault in hci_uart_tty_ioctl' bug.

general protection fault, probably for non-canonical address
0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN
KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
CPU: 0 PID: 8770 Comm: syz-executor.0 Not tainted 6.2.0 #4
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
1.13.0-1ubuntu1.1 04/01/2014
RIP: 0010:hci_uart_tty_ioctl+0x244/0xc20 drivers/bluetooth/hci_ldisc.c:774
Code: df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 cf 08 00 00 48 8b 9b
b8 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 <0f> b6
04 02 84 c0 74 08 3c 03 0f 8e 5f 08 00 00 44 8b 23 e9 14 ff
RSP: 0018:ffffc900022a7d10 EFLAGS: 00010246
RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffff8710057c
RDX: 0000000000000000 RSI: ffff888046df8000 RDI: ffff88801cf510b8
RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed10039ea204
R10: ffff88801cf5101f R11: ffffed10039ea203 R12: ffff8880204eb000
R13: 0000000000000000 R14: ffffffffffffffe7 R15: 00000000800401c0
FS:  00007f203e7dd700(0000) GS:ffff88802ca00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00005587ec7f32d8 CR3: 000000004629e000 CR4: 0000000000350ef0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
 <TASK>
 tty_ioctl+0xac0/0x1420 drivers/tty/tty_io.c:2784
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x198/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
RIP: 0033:0x7f203f0902fd
Code: 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa 48 89 f8 48
89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d
01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007f203e7dcc58 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f203f1bc020 RCX: 00007f203f0902fd
RDX: 0000000000000000 RSI: 00000000800455c9 RDI: 0000000000000003
RBP: 00007f203f0fec89 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 00007ffee4615aef R14: 00007ffee4615ca0 R15: 00007f203e7dcdc0
 </TASK>

```

---

```
                 [reply](#R)other threads:[[~2023-04-18  5:00 UTC](../?t=20230418050033)|[newest](../)]

Thread overview: [no followups] expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com \
    --to=yhao016@ucr.edu \
    --cc=johan.hedberg@gmail.com \
    --cc=linux-bluetooth@vger.kernel.org \
    --cc=linux-kernel@vger.kernel.org \
    --cc=luiz.dentz@gmail.com \
    --cc=marcel@holtmann.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is an external index of several public inboxes,
see [mirroring instructions](../_/text/mirror/) on how to clone and mirror
all data and code used by this external index.
```


=== Content from security.netapp.com_17df0aba_20250114_181906.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [April 2023 Linux Kernel 6.2 Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20230929-0003)

## April 2023 Linux Kernel 6.2 Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230929-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230929-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230929-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230929-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230929-0003
**Version:**
1.0

**Last updated:**
09/29/2023

**Status:**
Final.

**CVEs:** CVE-2023-31081, CVE-2023-31082, CVE-2023-31083, CVE-2023-31084, CVE-2023-31085

Overview
#### Summary

Multiple NetApp products incorporate Linux Kernel. Linux Kernel version 6.2 is susceptible to vulnerabilities which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-31081](https://nvd.nist.gov/vuln/detail/CVE-2023-31081) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-31082](https://nvd.nist.gov/vuln/detail/CVE-2023-31082) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-31083](https://nvd.nist.gov/vuln/detail/CVE-2023-31083) | 4.7 (MEDIUM) | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-31084](https://nvd.nist.gov/vuln/detail/CVE-2023-31084) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-31085](https://nvd.nist.gov/vuln/detail/CVE-2023-31085) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* [https://lore.kernel.org/all/CA+UBctDXyiosaiR7YNKCs8k0aWu4gU+YutRcnC+TDJkXpHjQag@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctDXyiosaiR7YNKCs8k0aWu4gU%2BYutRcnC%2BTDJkXpHjQag%40mail.gmail.com/)
* [https://lore.kernel.org/all/CA+UBctCZok5FSQ=LPRA+A-jocW=L8FuMVZ\_7MNqhh483P5yN8A@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctCZok5FSQ%3DLPRA%2BA-jocW%3DL8FuMVZ_7MNqhh483P5yN8A%40mail.gmail.com/)
* [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
* [https://lore.kernel.org/all/CA+UBctCu7fXn4q41O\_3=id1+OdyQ85tZY1x+TkT-6OVBL6KAUw@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctCu7fXn4q41O_3%3Did1%2BOdyQ85tZY1x%2BTkT-6OVBL6KAUw%40mail.gmail.com/)
* [https://lore.kernel.org/all/687864524.118195.1681799447034.JavaMail.zimbra@nod.at/](https://lore.kernel.org/all/687864524.118195.1681799447034.JavaMail.zimbra%40nod.at/)

Affected Products
#### Affected Products

* NetApp HCI Baseboard Management Controller (BMC) - H410C

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - Cloud Insights Telegraf Agent
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800/C800/A150
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230929-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230929 | Initial Public Release, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from git.kernel.org_858e7cbe_20250115_112220.html ===


| [cgit logo](/) | [index](/) : [kernel/git/bluetooth/bluetooth-next.git](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/) | bluetooth-next for-upstream master |
| --- | --- | --- |
| Bluetooth kernel development tree | Bluetooth group |

| [about](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/about/)[summary](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/)[refs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/?id=ff1b86784849)[log](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/)[tree](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=ff1b86784849)[commit](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=ff1b86784849)[diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=ff1b86784849)[stats](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Lee, Chun-Yi <joeyli.kernel@gmail.com> | 2023-07-10 23:17:23 +0800 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-07-12 14:13:20 -0700 |
| commit | [ff1b86784849f8e181641610f0acb4b77da7501d](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=ff1b86784849f8e181641610f0acb4b77da7501d) ([patch](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/patch/?id=ff1b86784849f8e181641610f0acb4b77da7501d)) | |
| tree | [9ff44aaa28f2a52413da707b67d58a245ef7c880](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=ff1b86784849) | |
| parent | [34ffc92ed051e8c81dbcf5efa347125fdb3b1dd7](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=34ffc92ed051e8c81dbcf5efa347125fdb3b1dd7) ([diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=ff1b86784849&id2=34ffc92ed051e8c81dbcf5efa347125fdb3b1dd7)) | |
| download | [bluetooth-next-ff1b86784849.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-ff1b86784849.tar.gz) | |

Bluetooth: hci\_ldisc: check HCI\_UART\_PROTO\_READY flag in HCIUARTGETPROTONotice: this object is not reachable from any branch.
This patch adds code to check HCI\_UART\_PROTO\_READY flag before
accessing hci\_uart->proto. It fixes the race condition in
hci\_uart\_tty\_ioctl() between HCIUARTSETPROTO and HCIUARTGETPROTO.
This issue bug found by Yu Hao and Weiteng Chen:
BUG: general protection fault in hci\_uart\_tty\_ioctl [1]
The information of C reproducer can also reference the link [2]
Reported-by: Yu Hao <yhao016@ucr.edu>
Closes: https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/ [1]
Reported-by: Weiteng Chen <wchen130@ucr.edu>
Closes: https://lore.kernel.org/lkml/CA+UBctDPEvHdkHMwD340=n02rh+jNRJNNQ5LBZNA+Wm4Keh2ow@mail.gmail.com/T/ [2]
Signed-off-by: "Lee, Chun-Yi" <jlee@suse.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Notice: this object is not reachable from any branch.
[Diffstat](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=ff1b86784849)

| -rw-r--r-- | [drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/drivers/bluetooth/hci_ldisc.c?id=ff1b86784849) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/bluetooth/hci\_ldisc.c b/drivers/bluetooth/hci\_ldisc.cindex efdda2c3fce8c8..a76eb98c0047a3 100644--- a/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/hci_ldisc.c?id=34ffc92ed051e8c81dbcf5efa347125fdb3b1dd7)+++ b/[drivers/bluetooth/hci\_ldisc.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/hci_ldisc.c?id=ff1b86784849f8e181641610f0acb4b77da7501d)@@ -770,7 +770,8 @@ static int hci\_uart\_tty\_ioctl(struct tty\_struct \*tty, unsigned int cmd, break;  case HCIUARTGETPROTO:- if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags))+ if (test\_bit(HCI\_UART\_PROTO\_SET, &hu->flags) &&+ test\_bit(HCI\_UART\_PROTO\_READY, &hu->flags)) err = hu->proto->id; else err = -EUNATCH; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 11:20:58 +0000



=== Content from git.kernel.org_6aa39863_20250115_112223.html ===


| [cgit logo](/) | [index](/) : [kernel/git/bluetooth/bluetooth-next.git](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/) | bluetooth-next for-upstream master |
| --- | --- | --- |
| Bluetooth kernel development tree | Bluetooth group |

| [about](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/about/)[summary](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/)[refs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/)[log](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/)[tree](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/)[commit](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/)[diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/)[stats](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/stats/) | log msg author committer range |
| --- | --- |

| Branch | Commit message | Author | Age | |
| --- | --- | --- | --- | --- |
| [master](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/) | [Bluetooth: MGMT: Fix slab-use-after-free Read in mgmt\_remove\_adv\_monitor\_sync](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/) | Mazin Al Haddad | 18 hours | |
| [bluetooth-next](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/?h=bluetooth-next) | [Bluetooth: hci\_sync: cancel cmd\_timer if hci\_open failed](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?h=bluetooth-next) | Archie Pusaka | 2 years | |
| [for-upstream](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/?h=for-upstream) | [Bluetooth: hci\_qca: Fixed issue during suspend](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?h=for-upstream) | Venkata Lakshmi Narayana Gubba | 4 years | |
|  | | | | |
| Tag | Download | Author | Age | |
| [for-net-next-2024-11-14](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-11-14) | [bluetooth-next-for-net-next-2024-11-14.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-11-14.tar.gz) | Luiz Augusto von Dentz | 2 months | |
| [for-net-next-2024-09-12](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-09-12) | [bluetooth-next-for-net-next-2024-09-12.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-09-12.tar.gz) | Luiz Augusto von Dentz | 4 months | |
| [for-net-next-2024-07-15](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-07-15) | [bluetooth-next-for-net-next-2024-07-15.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-07-15.tar.gz) | Luiz Augusto von Dentz | 6 months | |
| [for-net-next-2024-07-14](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-07-14) | [bluetooth-next-for-net-next-2024-07-14.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-07-14.tar.gz) | Luiz Augusto von Dentz | 6 months | |
| [for-net-next-2024-05-14](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-05-14) | [bluetooth-next-for-net-next-2024-05-14.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-05-14.tar.gz) | Luiz Augusto von Dentz | 8 months | |
| [for-net-next-2024-05-10](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-05-10) | [bluetooth-next-for-net-next-2024-05-10.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-05-10.tar.gz) | Luiz Augusto von Dentz | 8 months | |
| [for-net-next-2024-03-08](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2024-03-08) | [bluetooth-next-for-net-next-2024-03-08.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2024-03-08.tar.gz) | Luiz Augusto von Dentz | 10 months | |
| [for-net-2024-02-02](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-2024-02-02) | [bluetooth-next-for-net-2024-02-02.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-2024-02-02.tar.gz) | Luiz Augusto von Dentz | 11 months | |
| [for-net-next-2023-12-22](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2023-12-22) | [bluetooth-next-for-net-next-2023-12-22.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2023-12-22.tar.gz) | Luiz Augusto von Dentz | 13 months | |
| [for-net-next-2023-10-23](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tag/?h=for-net-next-2023-10-23) | [bluetooth-next-for-net-next-2023-10-23.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-for-net-next-2023-10-23.tar.gz) | Luiz Augusto von Dentz | 15 months | |
| [[...]](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/tags) | | | | |
|  | | | | |
| Age | Commit message | Author | Files | Lines |
| 18 hours | [Bluetooth: MGMT: Fix slab-use-after-free Read in mgmt\_remove\_adv\_monitor\_sync](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=1f2ae3fb1cdc552b38e625fa807800ffbb858ce3)[HEAD](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=1f2ae3fb1cdc552b38e625fa807800ffbb858ce3)[master](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/) | Mazin Al Haddad | 1 | -1/+11 |
| 18 hours | [Bluetooth: qca: Fix poor RF performance for WCN6855](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=67f8711aae4b64cd8c0c3dc1a3443e9b17d35e1c) | Zijun Hu | 1 | -2/+3 |
| 18 hours | [Bluetooth: Allow reset via sysfs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=c4e01540368c6d80f4d183e25dfa1be1adc912cc) | Hsin-chen Chuang | 1 | -0/+19 |
| 18 hours | [Bluetooth: Get rid of cmd\_timeout and use the reset callback](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=fd224b09eedd64d423b55bc171bc526127716be1) | Hsin-chen Chuang | 5 | -17/+16 |
| 18 hours | [Bluetooth: Remove the cmd timeout count in btusb](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=e52a5e074971c701c4d87ab63e2fbdd6049e8328) | Hsin-chen Chuang | 1 | -10/+0 |
| 18 hours | [Bluetooth: Use str\_enable\_disable-like helpers](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=ca1c320b045343ef23cf4757761828b73582a95a) | Krzysztof Kozlowski | 3 | -11/+14 |
| 18 hours | [Bluetooth: btmtk: Remove resetting mt7921 before downloading the fw](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=c8d46ea46991d2ed354293821f64e8126f57dd00) | Hao Qin | 1 | -2/+2 |
| 5 days | [Bluetooth: L2CAP: handle NULL sock pointer in l2cap\_sock\_alloc](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=a723753d039fd9a6c5998340ac65f4d9e2966ba8) | Fedor Pchelkin | 1 | -1/+2 |
| 5 days | [Bluetooth: btusb: Add RTL8851BE device 13d3:3600](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=79901504be6485fdd13c062066d0dc920438a348) | Garrett Wilke | 1 | -0/+3 |
| 5 days | [dt-bindings: bluetooth: Utilize PMU abstraction for WCN6750](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=3a6ff60b457cd0c68743393331efbaeaaa16e5aa) | Janaki Ramaiah Thota | 1 | -5/+0 |
| [[...]](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/) | | | | |
|  | | | | |
| Clone | | | | |
| git://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git | | | | |
| [https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git](https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git "kernel/git/bluetooth/bluetooth-next.git Git repository") | | | | |
| [https://kernel.googlesource.com/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git](https://kernel.googlesource.com/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git "kernel/git/bluetooth/bluetooth-next.git Git repository") | | | | |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 11:21:00 +0000



=== Content from lore.kernel.org_e369a31d_20250115_112223.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../../?t=20230705122222)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#e060ec2531b9dba714c19e153f368dcb0d75430ce) How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
@ 2023-06-28 15:01 joeyli
  2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
  [0 siblings, 1 reply; 7+ messages in thread](#r060ec2531b9dba714c19e153f368dcb0d75430ce)
From: joeyli @ 2023-06-28 15:01 UTC ([permalink](../../20230628150140.GU21539%40linux-l9pv.suse/) / [raw](../../20230628150140.GU21539%40linux-l9pv.suse/raw))
  To: Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230628150224), [linux-kernel](../../../lkml/?t=20230628150224)

Hi Yu Hao,

I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":

[https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)

I am trying the C reproducer in your URL, but it is not success yet:
<https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>

I am using v6.2 mainline kernel to run the C reproducer.

Could you please provide suggestions for how to reproduce this issue?
And what is your qemu environment for reproducing issue?

Thanks a lot!
Joey Lee

[^](#m060ec2531b9dba714c19e153f368dcb0d75430ce) [permalink](../../20230628150140.GU21539%40linux-l9pv.suse/) [raw](../../20230628150140.GU21539%40linux-l9pv.suse/raw) [reply](../../20230628150140.GU21539%40linux-l9pv.suse/#R)	[[flat](../../20230628150140.GU21539%40linux-l9pv.suse/T/#u)|[nested](../../20230628150140.GU21539%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r060ec2531b9dba714c19e153f368dcb0d75430ce)
```

---

```
[*](#e21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-06-28 15:01 [How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?](#m060ec2531b9dba714c19e153f368dcb0d75430ce) joeyli
@ 2023-06-29  1:57 ` Yu Hao
  2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
  [0 siblings, 1 reply; 7+ messages in thread](#r21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
From: Yu Hao @ 2023-06-29  1:57 UTC ([permalink](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/) / [raw](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/raw))
  To: Weiteng Chen; +Cc: joeyli, [linux-bluetooth](../../../linux-bluetooth/?t=20230629015913), [linux-kernel](../../../lkml/?t=20230629015913)

Hi Weiteng,

Could you give more info about the bug, e.g., kernel configuration,
qemu arguments.

Thanks.
Yu Hao
Ph.D. student
Department of Computer Science & Engineering
University of California, Riverside

On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
>
> Hi Yu Hao,
>
> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
>
> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
>
> I am trying the C reproducer in your URL, but it is not success yet:
> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
>
> I am using v6.2 mainline kernel to run the C reproducer.
>
> Could you please provide suggestions for how to reproduce this issue?
> And what is your qemu environment for reproducing issue?
>
> Thanks a lot!
> Joey Lee

[^](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1) [permalink](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/) [raw](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/raw) [reply](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/#R)	[[flat](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/T/#u)|[nested](../../CA%2BUBctDPEvHdkHMwD340%3Dn02rh%2BjNRJNNQ5LBZNA%2BWm4Keh2ow%40mail.gmail.com/t/#u)] [7+ messages in thread](#r21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
```

---

```
[*](#e1ef6d7a0febac0e12404302774af1222732ceef6) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
@ 2023-07-04  3:01   ` joeyli
  2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
  [0 siblings, 1 reply; 7+ messages in thread](#r1ef6d7a0febac0e12404302774af1222732ceef6)
From: joeyli @ 2023-07-04  3:01 UTC ([permalink](../../20230704030131.GY5866%40linux-l9pv.suse/) / [raw](../../20230704030131.GY5866%40linux-l9pv.suse/raw))
  To: Yu Hao; +Cc: Weiteng Chen, [linux-bluetooth](../../../linux-bluetooth/?t=20230704030153), [linux-kernel](../../../lkml/?t=20230704030153)

Hi,

On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> Hi Weiteng,
>
> Could you give more info about the bug, e.g., kernel configuration,
> qemu arguments.
>

Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.

I have run the C reproducer a couple of days in qemu, but it did not
reproduce issue until now.

Does anyone know how to reproduce this issue easily?

Thanks
Joey Lee
>
> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> >
> > Hi Yu Hao,
> >
> > I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> >
> > [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> >
> > I am trying the C reproducer in your URL, but it is not success yet:
> > <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> >
> > I am using v6.2 mainline kernel to run the C reproducer.
> >
> > Could you please provide suggestions for how to reproduce this issue?
> > And what is your qemu environment for reproducing issue?
> >
> > Thanks a lot!
> > Joey Lee

[^](#m1ef6d7a0febac0e12404302774af1222732ceef6) [permalink](../../20230704030131.GY5866%40linux-l9pv.suse/) [raw](../../20230704030131.GY5866%40linux-l9pv.suse/raw) [reply](../../20230704030131.GY5866%40linux-l9pv.suse/#R)	[[flat](../../20230704030131.GY5866%40linux-l9pv.suse/T/#u)|[nested](../../20230704030131.GY5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r1ef6d7a0febac0e12404302774af1222732ceef6)
```

---

```
[*](#e170362c47de329ec565734f8f7ea5c03274f8ac7) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
@ 2023-07-04  4:07     ` Weiteng Chen
  2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
  [0 siblings, 1 reply; 7+ messages in thread](#r170362c47de329ec565734f8f7ea5c03274f8ac7)
From: Weiteng Chen @ 2023-07-04  4:07 UTC ([permalink](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/) / [raw](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/raw))
  To: joeyli; +Cc: Yu Hao, [linux-bluetooth](../../../linux-bluetooth/?t=20230704040848), [linux-kernel](../../../lkml/?t=20230704040848)

Hi Joey,

Sorry for my late response.

<https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>

switch (cmd) {
        case HCIUARTSETPROTO:
                if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
                        printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
                        err = hci_uart_set_proto(hu, arg);
                        if (err)
                                clear_bit(HCI_UART_PROTO_SET, &hu->flags);
                } else
                        err = -EBUSY;
                break;

        case HCIUARTGETPROTO:
                if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
                        err = hu->proto->id;  ←- null pointer deference
                else
                        err = -EUNATCH;
                break;

This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.

To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.

Best,
Weiteng Chen

> On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
>
> Hi,
>
> On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
>> Hi Weiteng,
>>
>> Could you give more info about the bug, e.g., kernel configuration,
>> qemu arguments.
>>
>
> Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
>
> I have run the C reproducer a couple of days in qemu, but it did not
> reproduce issue until now.
>
> Does anyone know how to reproduce this issue easily?
>
> Thanks
> Joey Lee
>>
>> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
>>>
>>> Hi Yu Hao,
>>>
>>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
>>>
>>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
>>>
>>> I am trying the C reproducer in your URL, but it is not success yet:
>>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
>>>
>>> I am using v6.2 mainline kernel to run the C reproducer.
>>>
>>> Could you please provide suggestions for how to reproduce this issue?
>>> And what is your qemu environment for reproducing issue?
>>>
>>> Thanks a lot!
>>> Joey Lee

[^](#m170362c47de329ec565734f8f7ea5c03274f8ac7) [permalink](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/) [raw](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/raw) [reply](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/#R)	[[flat](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/T/#u)|[nested](../../191B9131-6E47-49B6-8089-108E2B12B9DC%40ucr.edu/t/#u)] [7+ messages in thread](#r170362c47de329ec565734f8f7ea5c03274f8ac7)
```

---

```
[*](#e91f142c29c53fa1d643e0b91eb12436350c5e851) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
@ 2023-07-05  8:41       ` joeyli
  2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
  [0 siblings, 1 reply; 7+ messages in thread](#r91f142c29c53fa1d643e0b91eb12436350c5e851)
From: joeyli @ 2023-07-05  8:41 UTC ([permalink](../../20230705084148.GK5866%40linux-l9pv.suse/) / [raw](../../20230705084148.GK5866%40linux-l9pv.suse/raw))
  To: Weiteng Chen, Yu Hao; +Cc: Yu Hao, [linux-bluetooth](../../../linux-bluetooth/?t=20230705084222), [linux-kernel](../../../lkml/?t=20230705084222)

Hi Weiteng Chen, Yu Hao,

On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> Hi Joey,
>
> Sorry for my late response.
>
> <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
>
> switch (cmd) {
>         case HCIUARTSETPROTO:
>                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
>                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
>                         err = hci_uart_set_proto(hu, arg);
>                         if (err)
>                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
>                 } else
>                         err = -EBUSY;
>                 break;
>
>         case HCIUARTGETPROTO:
>                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
>                         err = hu->proto->id;  ←- null pointer deference
>                 else
>                         err = -EUNATCH;
>                 break;
>
> This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
>
> To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
>

Thanks! I can reproduce the issue now.

Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?

Joey Lee

> Best,
> Weiteng Chen
>
> > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> >
> > Hi,
> >
> > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> >> Hi Weiteng,
> >>
> >> Could you give more info about the bug, e.g., kernel configuration,
> >> qemu arguments.
> >>
> >
> > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> >
> > I have run the C reproducer a couple of days in qemu, but it did not
> > reproduce issue until now.
> >
> > Does anyone know how to reproduce this issue easily?
> >
> > Thanks
> > Joey Lee
> >>
> >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> >>>
> >>> Hi Yu Hao,
> >>>
> >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> >>>
> >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> >>>
> >>> I am trying the C reproducer in your URL, but it is not success yet:
> >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> >>>
> >>> I am using v6.2 mainline kernel to run the C reproducer.
> >>>
> >>> Could you please provide suggestions for how to reproduce this issue?
> >>> And what is your qemu environment for reproducing issue?
> >>>
> >>> Thanks a lot!
> >>> Joey Lee

[^](#m91f142c29c53fa1d643e0b91eb12436350c5e851) [permalink](../../20230705084148.GK5866%40linux-l9pv.suse/) [raw](../../20230705084148.GK5866%40linux-l9pv.suse/raw) [reply](../../20230705084148.GK5866%40linux-l9pv.suse/#R)	[[flat](../../20230705084148.GK5866%40linux-l9pv.suse/T/#u)|[nested](../../20230705084148.GK5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#r91f142c29c53fa1d643e0b91eb12436350c5e851)
```

---

```
[*](#ec8f5237edd80632a7a607136e15c7b15162ae87b) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
@ 2023-07-05  9:36         ` joeyli
  2023-07-05 12:21           ` [joeyli](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d)
  [0 siblings, 1 reply; 7+ messages in thread](#rc8f5237edd80632a7a607136e15c7b15162ae87b)
From: joeyli @ 2023-07-05  9:36 UTC ([permalink](../../20230705093636.GL5866%40linux-l9pv.suse/) / [raw](../../20230705093636.GL5866%40linux-l9pv.suse/raw))
  To: Weiteng Chen, Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230705093701), [linux-kernel](../../../lkml/?t=20230705093701)

On Wed, Jul 05, 2023 at 04:41:48PM +0800, joeyli wrote:
> Hi Weiteng Chen, Yu Hao,
>
> On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> > Hi Joey,
> >
> > Sorry for my late response.
> >
> > <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
> >
> > switch (cmd) {
> >         case HCIUARTSETPROTO:
> >                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
> >                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
> >                         err = hci_uart_set_proto(hu, arg);
> >                         if (err)
> >                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
> >                 } else
> >                         err = -EBUSY;
> >                 break;
> >
> >         case HCIUARTGETPROTO:
> >                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> >                         err = hu->proto->id;  ←- null pointer deference
> >                 else
> >                         err = -EUNATCH;
> >                 break;
> >
> > This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
> >
> > To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
> >
>
> Thanks! I can reproduce the issue now.
>
> Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?
>
> Joey Lee

Looks that check HCI_UART_PROTO_READY is enough to avoid problem:

--- linux.orig/drivers/bluetooth/hci_ldisc.c
+++ linux/drivers/bluetooth/hci_ldisc.c
@@ -771,7 +771,7 @@ static int hci_uart_tty_ioctl(struct tty
                break;

        case HCIUARTGETPROTO:
-               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
+               if (test_bit(HCI_UART_PROTO_READY, &hu->flags))
                        err = hu->proto->id;
                else
                        err = -EUNATCH;

If you do not have plan to send patch, then I will send the above change.

Thanks
Joey Lee

>
>
> > Best,
> > Weiteng Chen
> >
> > > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> > >
> > > Hi,
> > >
> > > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> > >> Hi Weiteng,
> > >>
> > >> Could you give more info about the bug, e.g., kernel configuration,
> > >> qemu arguments.
> > >>
> > >
> > > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> > >
> > > I have run the C reproducer a couple of days in qemu, but it did not
> > > reproduce issue until now.
> > >
> > > Does anyone know how to reproduce this issue easily?
> > >
> > > Thanks
> > > Joey Lee
> > >>
> > >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> > >>>
> > >>> Hi Yu Hao,
> > >>>
> > >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> > >>>
> > >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> > >>>
> > >>> I am trying the C reproducer in your URL, but it is not success yet:
> > >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> > >>>
> > >>> I am using v6.2 mainline kernel to run the C reproducer.
> > >>>
> > >>> Could you please provide suggestions for how to reproduce this issue?
> > >>> And what is your qemu environment for reproducing issue?
> > >>>
> > >>> Thanks a lot!
> > >>> Joey Lee

[^](#mc8f5237edd80632a7a607136e15c7b15162ae87b) [permalink](../../20230705093636.GL5866%40linux-l9pv.suse/) [raw](../../20230705093636.GL5866%40linux-l9pv.suse/raw) [reply](../../20230705093636.GL5866%40linux-l9pv.suse/#R)	[[flat](../../20230705093636.GL5866%40linux-l9pv.suse/T/#u)|[nested](../../20230705093636.GL5866%40linux-l9pv.suse/t/#u)] [7+ messages in thread](#rc8f5237edd80632a7a607136e15c7b15162ae87b)
```

---

```
[*](#eb3bb221407bc1d8e678da7217d8c0475515dbc3d) Re: How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?
  2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
@ 2023-07-05 12:21           ` joeyli
  [0 siblings, 0 replies; 7+ messages in thread](#rb3bb221407bc1d8e678da7217d8c0475515dbc3d)
From: joeyli @ 2023-07-05 12:21 UTC ([permalink](../../20230705122159.GA26742%40linux-691t/) / [raw](../../20230705122159.GA26742%40linux-691t/raw))
  To: Weiteng Chen, Yu Hao; +Cc: [linux-bluetooth](../../../linux-bluetooth/?t=20230705122222), [linux-kernel](../../../lkml/?t=20230705122222)

On Wed, Jul 05, 2023 at 05:36:36PM +0800, joeyli wrote:
> On Wed, Jul 05, 2023 at 04:41:48PM +0800, joeyli wrote:
> > Hi Weiteng Chen, Yu Hao,
> >
> > On Mon, Jul 03, 2023 at 09:07:38PM -0700, Weiteng Chen wrote:
> > > Hi Joey,
> > >
> > > Sorry for my late response.
> > >
> > > <https://elixir.bootlin.com/linux/v6.3-rc7/source/drivers/bluetooth/hci_ldisc.c#L764>
> > >
> > > switch (cmd) {
> > >         case HCIUARTSETPROTO:
> > >                 if (!test_and_set_bit(HCI_UART_PROTO_SET, &hu->flags)) {
> > >                         printk(“test_and_set_bit…”) // insert a prink to make the race easy to trigger
> > >                         err = hci_uart_set_proto(hu, arg);
> > >                         if (err)
> > >                                 clear_bit(HCI_UART_PROTO_SET, &hu->flags);
> > >                 } else
> > >                         err = -EBUSY;
> > >                 break;
> > >
> > >         case HCIUARTGETPROTO:
> > >                 if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> > >                         err = hu->proto->id;  ←- null pointer deference
> > >                 else
> > >                         err = -EUNATCH;
> > >                 break;
> > >
> > > This is a race condition between HCIUARTSETPROTO and HCIUARTGETPROTO. HCI_UART_PROTO_SET is set before hu->proto is set and thus it may dereference a null pointer.
> > >
> > > To easily trigger this bug, I inserted a prink in the source code so that the C producer can easily trigger the bug. Please let me know if you have any questions.
> > >
> >
> > Thanks! I can reproduce the issue now.
> >
> > Weiteng, Yu Hao, do you have plan for sending patch to fix this problem?
> >
> > Joey Lee
>
> Looks that check HCI_UART_PROTO_READY is enough to avoid problem:
>
> --- linux.orig/drivers/bluetooth/hci_ldisc.c
> +++ linux/drivers/bluetooth/hci_ldisc.c
> @@ -771,7 +771,7 @@ static int hci_uart_tty_ioctl(struct tty
>                 break;
>
>         case HCIUARTGETPROTO:
> -               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
> +               if (test_bit(HCI_UART_PROTO_READY, &hu->flags))
>                         err = hu->proto->id;
>                 else
>                         err = -EUNATCH;
>
> If you do not have plan to send patch, then I will send the above change.
>

Updated patch. The HCI_UART_PROTO_SET should still be checked with
HCI_UART_PROTO_READY:

--- linux.orig/drivers/bluetooth/hci_ldisc.c
+++ linux/drivers/bluetooth/hci_ldisc.c
@@ -771,7 +771,8 @@ static int hci_uart_tty_ioctl(struct tty
                break;

        case HCIUARTGETPROTO:
-               if (test_bit(HCI_UART_PROTO_SET, &hu->flags))
+               if (test_bit(HCI_UART_PROTO_SET, &hu->flags) &&
+                   test_bit(HCI_UART_PROTO_READY, &hu->flags))
                        err = hu->proto->id;
                else
                        err = -EUNATCH;

I have tested this patch a couple of hours. I didn't reproduce
issue.

Regards
Joey Lee

> >
> >
> > > Best,
> > > Weiteng Chen
> > >
> > > > On Jul 3, 2023, at 8:01 PM, joeyli <jlee@suse.com> wrote:
> > > >
> > > > Hi,
> > > >
> > > > On Wed, Jun 28, 2023 at 06:57:47PM -0700, Yu Hao wrote:
> > > >> Hi Weiteng,
> > > >>
> > > >> Could you give more info about the bug, e.g., kernel configuration,
> > > >> qemu arguments.
> > > >>
> > > >
> > > > Base on kernel code, looks that the HCIUARTSETPROTO and HCIUARTGETPROTO
> > > > blocks in hci_uart_tty_ioctl() should use hci_uart->proto_lock.
> > > >
> > > > I have run the C reproducer a couple of days in qemu, but it did not
> > > > reproduce issue until now.
> > > >
> > > > Does anyone know how to reproduce this issue easily?
> > > >
> > > > Thanks
> > > > Joey Lee
> > > >>
> > > >> On Wed, Jun 28, 2023 at 8:02 AM joeyli <jlee@suse.com> wrote:
> > > >>>
> > > >>> Hi Yu Hao,
> > > >>>
> > > >>> I am looking at your "BUG: general protection fault in hci_uart_tty_ioctl":
> > > >>>
> > > >>> [https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/](https://lore.kernel.org/all/CA%2BUBctC3p49aTgzbVgkSZ2%2BTQcqq4fPDO7yZitFT5uBPDeCO2g%40mail.gmail.com/)
> > > >>>
> > > >>> I am trying the C reproducer in your URL, but it is not success yet:
> > > >>> <https://gist.github.com/ZHYfeng/a3e3ff2bdfea5ed5de5475f0b54d55cb>
> > > >>>
> > > >>> I am using v6.2 mainline kernel to run the C reproducer.
> > > >>>
> > > >>> Could you please provide suggestions for how to reproduce this issue?
> > > >>> And what is your qemu environment for reproducing issue?
> > > >>>
> > > >>> Thanks a lot!
> > > >>> Joey Lee

[^](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d) [permalink](../../20230705122159.GA26742%40linux-691t/) [raw](../../20230705122159.GA26742%40linux-691t/raw) [reply](../../20230705122159.GA26742%40linux-691t/#R)	[[flat](../../20230705122159.GA26742%40linux-691t/T/#u)|[nested](../../20230705122159.GA26742%40linux-691t/t/#u)] [7+ messages in thread](#rb3bb221407bc1d8e678da7217d8c0475515dbc3d)
```

---

```
end of thread, other threads:[[~2023-07-05 12:22 UTC](../../?t=20230705122222) | [newest](../../)]

Thread overview: 7+ messages (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2023-06-28 15:01 [How to reproduce the BUG general protection fault in hci_uart_tty_ioctl?](#m060ec2531b9dba714c19e153f368dcb0d75430ce) joeyli
2023-06-29  1:57 ` [Yu Hao](#m21f56dbdf29ee7fa0dc721f466a4de1a73f75ba1)
2023-07-04  3:01   ` [joeyli](#m1ef6d7a0febac0e12404302774af1222732ceef6)
2023-07-04  4:07     ` [Weiteng Chen](#m170362c47de329ec565734f8f7ea5c03274f8ac7)
2023-07-05  8:41       ` [joeyli](#m91f142c29c53fa1d643e0b91eb12436350c5e851)
2023-07-05  9:36         ` [joeyli](#mc8f5237edd80632a7a607136e15c7b15162ae87b)
2023-07-05 12:21           ` [joeyli](#mb3bb221407bc1d8e678da7217d8c0475515dbc3d)

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```

