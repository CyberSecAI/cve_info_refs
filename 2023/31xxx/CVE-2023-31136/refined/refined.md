```
{
  "CVE-2023-31136": [
    {
      "Root cause": "PostgresNIO processes unencrypted bytes from man-in-the-middle.",
      "Weaknesses": "The client library doesn't properly handle unencrypted data received after an SSL handshake is initiated, making it vulnerable to man-in-the-middle attacks.",
      "Impact": "A man-in-the-middle attacker can inject false responses to the client's first few queries, potentially leading to exfiltration of client passwords or other confidential data.",
      "Attack vectors": "Network based man-in-the-middle attack.",
      "Required attacker capabilities/position": "The attacker needs to be positioned to intercept and manipulate network traffic between the client and the PostgreSQL server."
    },
    {
        "Root cause": "The vulnerability stems from the `PostgresNIO` library not properly discarding unprocessed bytes after sending an SSL request during TLS handshake.",
        "Weaknesses": "The library's `NIOSingleStepByteToMessageProcessor` does not have an `unprocessedBytes` property, which would allow the detection of extra bytes after an SSL request. This allows for a man-in-the-middle attack injecting arbitrary SQL queries.",
        "Impact": "An attacker can potentially exfiltrate client passwords or other confidential data that might be transmitted early in a session. The attacker can also inject arbitrary SQL queries when a connection is first established.",
        "Attack vectors": "Network-based man-in-the-middle attack.",
         "Required attacker capabilities/position": "The attacker needs to be positioned to intercept and manipulate network traffic between the client and the PostgreSQL server. The server must be configured to use `trust` authentication with a `clientcert` requirement, or using `cert` authentication for an arbitrary SQL injection attack. For password exfiltration, the attacker must trick the clientâ€™s intended server to make confidential data accessible to the attacker and have some other way to access the server to retrieve the exfiltrated data."
    },
    {
      "Root cause": "The vulnerability arises because `libpq` processes unencrypted bytes from a man-in-the-middle, leading to potential information disclosure and/or arbitrary query execution.",
      "Weaknesses": "The vulnerability lies in the way `libpq` handles the initial connection phase, where unencrypted data can be processed before a secure TLS connection is fully established. This allows an attacker to inject data before encryption takes effect.",
      "Impact": "An attacker could inject false responses to the client, potentially leading to exfiltration of passwords and confidential data, or they could inject arbitrary SQL queries.",
      "Attack vectors": "Network-based man-in-the-middle attack.",
      "Required attacker capabilities/position": "The attacker must be able to intercept network traffic between the client and the PostgreSQL server. For password exfiltration, the attacker needs to trick the client's intended server to make confidential data accessible, and needs a way to access the server to retrieve the exfiltrated data. For arbitrary SQL query execution, the server must be configured to use `trust` authentication with a `clientcert` requirement or `cert` authentication."
    }
  ]
}
```