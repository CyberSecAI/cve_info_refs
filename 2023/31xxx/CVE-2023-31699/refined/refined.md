The provided content describes a stored Cross-Site Scripting (XSS) vulnerability in ChurchCRM version 4.5.4.

**Root cause of vulnerability:** The vulnerability is caused by the lack of sanitization of user-supplied data when uploading an image file on the "CSV Import" page. Specifically, malicious code inserted into an image file's metadata (using tools like exiftool) is executed when the uploaded image is processed by the application.

**Weaknesses/vulnerabilities present:**
*   Stored XSS: The malicious script is stored within the application (through the uploaded image) and executed when the application attempts to process the uploaded file.
*   Lack of Input Sanitization: The application fails to sanitize or validate the metadata of uploaded image files, allowing malicious scripts to be injected.

**Impact of exploitation:**
*   Attackers can use this vulnerability to perform various attacks such as:
    *   Phishing attacks
    *   Stealing user sessions
    *   Potentially gaining control of the application

**Attack vectors:**
*   The attacker needs to have access to the ChurchCRM admin panel to access the CSV Import page.
*   The attacker uploads a specially crafted image file that contains malicious XSS payload in its metadata.
*   The application executes the malicious script in the victim's browser upon processing the uploaded file.

**Required attacker capabilities/position:**
*   The attacker needs to be an authenticated user with admin privileges to access the CSV Import functionality of ChurchCRM.
*   The attacker needs to be able to modify image file metadata with XSS payloads using tools like exiftool.