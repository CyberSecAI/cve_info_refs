=== Content from github.com_08489079_20250114_224958.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Freleases%2Ftag%2Fv2.0.8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Freleases%2Ftag%2Fv2.0.8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=ecies%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ecies](/ecies)
/
**[go](/ecies/go)**
Public

* [Notifications](/login?return_to=%2Fecies%2Fgo) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fecies%2Fgo)
* [Star
   108](/login?return_to=%2Fecies%2Fgo)

* [Code](/ecies/go/tree/v2.0.8)
* [Issues
  1](/ecies/go/issues)
* [Pull requests
  2](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects
  0](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

Additional navigation options

* [Code](/ecies/go/tree/v2.0.8)
* [Issues](/ecies/go/issues)
* [Pull requests](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

1. [Releases](/ecies/go/releases)
2. [v2.0.8](/ecies/go/releases/tag/v2.0.8)

# v2.0.8

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/ecies/go/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.0.8)

 Loading

[View all tags](/ecies/go/tags)

![@savely-krasovsky](https://avatars.githubusercontent.com/u/5345489?s=40&v=4)
[savely-krasovsky](/savely-krasovsky)
released this
04 Dec 20:37

¬∑
[17 commits](/ecies/go/compare/v2.0.8...master)
to master
since this release

[v2.0.8](/ecies/go/tree/v2.0.8)

[`c6e7751`](/ecies/go/commit/c6e775163866d6ea5233eb8ec8530a9122101ebd)

## What's Changed

* security fix: invalid curve attack fixed, all thanks to [@Merricx](https://github.com/Merricx)
* Bump github.com/ethereum/go-ethereum from 1.12.0 to 1.12.2 by [@dependabot](https://github.com/dependabot) in [#73](https://github.com/ecies/go/pull/73)
* Bump golang.org/x/crypto from 0.11.0 to 0.12.0 by [@dependabot](https://github.com/dependabot) in [#71](https://github.com/ecies/go/pull/71)
* Bump golang.org/x/crypto from 0.12.0 to 0.13.0 by [@dependabot](https://github.com/dependabot) in [#75](https://github.com/ecies/go/pull/75)
* Bump github.com/ethereum/go-ethereum from 1.12.2 to 1.13.0 by [@dependabot](https://github.com/dependabot) in [#76](https://github.com/ecies/go/pull/76)
* Bump golang.org/x/crypto from 0.13.0 to 0.14.0 by [@dependabot](https://github.com/dependabot) in [#79](https://github.com/ecies/go/pull/79)
* Bump github.com/ethereum/go-ethereum from 1.13.0 to 1.13.4 by [@dependabot](https://github.com/dependabot) in [#81](https://github.com/ecies/go/pull/81)
* Bump golang.org/x/crypto from 0.14.0 to 0.16.0 by [@dependabot](https://github.com/dependabot) in [#85](https://github.com/ecies/go/pull/85)
* Bump github.com/ethereum/go-ethereum from 1.13.4 to 1.13.5 by [@dependabot](https://github.com/dependabot) in [#83](https://github.com/ecies/go/pull/83)

**Full Changelog**: [v2.0.7...v2.0.8](https://github.com/ecies/go/compare/v2.0.7...v2.0.8)

### Contributors

* [![@Merricx](https://avatars.githubusercontent.com/u/14103050?s=64&v=4)](https://github.com/Merricx)
* [![@dependabot](https://avatars.githubusercontent.com/u/27347476?s=64&v=4)](https://github.com/dependabot)

Merricx and dependabot

 Assets
2

 Loading

 üëç
1
 kigawas reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 1 person reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_9e1bca9b_20250114_225000.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Fsecurity%2Fadvisories%2FGHSA-8j98-cjfr-qx3h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Fsecurity%2Fadvisories%2FGHSA-8j98-cjfr-qx3h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ecies%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ecies](/ecies)
/
**[go](/ecies/go)**
Public

* [Notifications](/login?return_to=%2Fecies%2Fgo) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fecies%2Fgo)
* [Star
   108](/login?return_to=%2Fecies%2Fgo)

* [Code](/ecies/go)
* [Issues
  1](/ecies/go/issues)
* [Pull requests
  2](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects
  0](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

Additional navigation options

* [Code](/ecies/go)
* [Issues](/ecies/go/issues)
* [Pull requests](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

# Possible private key restoration

High

[savely-krasovsky](/savely-krasovsky)
published
GHSA-8j98-cjfr-qx3h
Dec 4, 2023

## Package

gomod

github.com/ecies/go
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<2.0.7

## Patched versions

2.0.8

## Description

### Impact

If functions `Encapsulate()`, `Decapsulate()` and `ECDH()` could be called by an attacker, he could recover any private key that he interacts with.

### Patches

Patched in v2.0.8

### Workarounds

You could manually check public key by calling `IsOnCurve()` function from secp256k1 libraries.

### References

<https://github.com/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md>

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-49292

### Weaknesses

No CWEs

### Credits

* [![@Merricx](https://avatars.githubusercontent.com/u/14103050?s=40&v=4)](/Merricx)
  [Merricx](/Merricx)
  Reporter
* [![@savely-krasovsky](https://avatars.githubusercontent.com/u/5345489?s=40&v=4)](/savely-krasovsky)
  [savely-krasovsky](/savely-krasovsky)
  Remediation developer

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e4229ef3_20250114_224957.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Fcommit%2Fc6e775163866d6ea5233eb8ec8530a9122101ebd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Fcommit%2Fc6e775163866d6ea5233eb8ec8530a9122101ebd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ecies%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ecies](/ecies)
/
**[go](/ecies/go)**
Public

* [Notifications](/login?return_to=%2Fecies%2Fgo) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fecies%2Fgo)
* [Star
   108](/login?return_to=%2Fecies%2Fgo)

* [Code](/ecies/go)
* [Issues
  1](/ecies/go/issues)
* [Pull requests
  2](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects
  0](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

Additional navigation options

* [Code](/ecies/go)
* [Issues](/ecies/go/issues)
* [Pull requests](/ecies/go/pulls)
* [Actions](/ecies/go/actions)
* [Projects](/ecies/go/projects)
* [Security](/ecies/go/security)
* [Insights](/ecies/go/pulse)

## Commit

[Permalink](/ecies/go/commit/c6e775163866d6ea5233eb8ec8530a9122101ebd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: additional security checks added

[Browse files](/ecies/go/tree/c6e775163866d6ea5233eb8ec8530a9122101ebd)
Browse the repository at this point in the history

* Loading branch information

[![@savely-krasovsky](https://avatars.githubusercontent.com/u/5345489?s=40&v=4)](/savely-krasovsky)

[savely-krasovsky](/ecies/go/commits?author=savely-krasovsky "View all commits by savely-krasovsky")
committed
Dec 4, 2023

1 parent
[82a1813](/ecies/go/commit/82a1813edd491c15288d7ae61801a41c32a150ab)

commit c6e7751

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**13 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* privatekey.go
  [privatekey.go](#diff-74a9db583130dc6b1c121244be8d7ed66fd7c34b3cd418818a3bd16667a2df87)
* publickey.go
  [publickey.go](#diff-875245a84484932ce0fc79b2c14520a89788815d15acfdabd64581cf623697bd)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[privatekey.go](#diff-74a9db583130dc6b1c121244be8d7ed66fd7c34b3cd418818a3bd16667a2df87 "privatekey.go")

Show comments

[View file](/ecies/go/blob/c6e775163866d6ea5233eb8ec8530a9122101ebd/privatekey.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -77,6 +77,10 @@ func (k \*PrivateKey) Encapsulate(pub \*PublicKey) ([]byte, error) { |
|  |  | return nil, fmt.Errorf("public key is empty") |
|  |  | } |
|  |  |  |
|  |  | if !k.Curve.IsOnCurve(pub.X, pub.Y) { |
|  |  | return nil, fmt.Errorf("invalid public key") |
|  |  | } |
|  |  |  |
|  |  | var secret bytes.Buffer |
|  |  | secret.Write(k.PublicKey.Bytes(false)) |
|  |  |  |
| Expand All | | @@ -98,6 +102,10 @@ func (k \*PrivateKey) ECDH(pub \*PublicKey) ([]byte, error) { |
|  |  | return nil, fmt.Errorf("public key is empty") |
|  |  | } |
|  |  |  |
|  |  | if !k.Curve.IsOnCurve(pub.X, pub.Y) { |
|  |  | return nil, fmt.Errorf("invalid public key") |
|  |  | } |
|  |  |  |
|  |  | // Shared secret generation |
|  |  | sx, sy := pub.Curve.ScalarMult(pub.X, pub.Y, k.D.Bytes()) |
|  |  |  |
| Expand Down | |  |

6 changes: 5 additions & 1 deletion

6
[publickey.go](#diff-875245a84484932ce0fc79b2c14520a89788815d15acfdabd64581cf623697bd "publickey.go")

Show comments

[View file](/ecies/go/blob/c6e775163866d6ea5233eb8ec8530a9122101ebd/publickey.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -137,8 +137,12 @@ func (k \*PublicKey) Hex(compressed bool) string { |
|  |  | // Decapsulate decapsulates key by using Key Encapsulation Mechanism and returns symmetric key; |
|  |  | // can be safely used as encryption key |
|  |  | func (k \*PublicKey) Decapsulate(priv \*PrivateKey) ([]byte, error) { |
|  |  | if !k.Curve.IsOnCurve(k.X, k.Y) { |
|  |  | return nil, fmt.Errorf("invalid public key") |
|  |  | } |
|  |  |  |
|  |  | if priv == nil { |
|  |  | return nil, fmt.Errorf("public key is empty") |
|  |  | return nil, fmt.Errorf("private key is empty") |
|  |  | } |
|  |  |  |
|  |  | var secret bytes.Buffer |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c6e7751`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fecies%2Fgo%2Fcommit%2Fc6e775163866d6ea5233eb8ec8530a9122101ebd) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_9b630178_20250114_224956.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fashutosh1206%2FCrypton%2Fblob%2Fmaster%2FDiffie-Hellman-Key-Exchange%2FAttack-Invalid-Curve-Point%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fashutosh1206%2FCrypton%2Fblob%2Fmaster%2FDiffie-Hellman-Key-Exchange%2FAttack-Invalid-Curve-Point%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ashutosh1206%2FCrypton)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Mar 24, 2022. It is now read-only.

[ashutosh1206](/ashutosh1206)
/
**[Crypton](/ashutosh1206/Crypton)**
Public archive

* [Notifications](/login?return_to=%2Fashutosh1206%2FCrypton) You must be signed in to change notification settings
* [Fork
  261](/login?return_to=%2Fashutosh1206%2FCrypton)
* [Star
   1.5k](/login?return_to=%2Fashutosh1206%2FCrypton)

* [Code](/ashutosh1206/Crypton)
* [Issues
  1](/ashutosh1206/Crypton/issues)
* [Pull requests
  2](/ashutosh1206/Crypton/pulls)
* [Actions](/ashutosh1206/Crypton/actions)
* [Projects
  0](/ashutosh1206/Crypton/projects)
* [Security](/ashutosh1206/Crypton/security)
* [Insights](/ashutosh1206/Crypton/pulse)

Additional navigation options

* [Code](/ashutosh1206/Crypton)
* [Issues](/ashutosh1206/Crypton/issues)
* [Pull requests](/ashutosh1206/Crypton/pulls)
* [Actions](/ashutosh1206/Crypton/actions)
* [Projects](/ashutosh1206/Crypton/projects)
* [Security](/ashutosh1206/Crypton/security)
* [Insights](/ashutosh1206/Crypton/pulse)

## Files

¬†master
## Breadcrumbs

1. [Crypton](/ashutosh1206/Crypton/tree/master)
2. /[Diffie-Hellman-Key-Exchange](/ashutosh1206/Crypton/tree/master/Diffie-Hellman-Key-Exchange)
3. /[Attack-Invalid-Curve-Point](/ashutosh1206/Crypton/tree/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/ashutosh1206/Crypton/commits/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md)134 lines (88 loc) ¬∑ 9 KB¬†master
## Breadcrumbs

1. [Crypton](/ashutosh1206/Crypton/tree/master)
2. /[Diffie-Hellman-Key-Exchange](/ashutosh1206/Crypton/tree/master/Diffie-Hellman-Key-Exchange)
3. /[Attack-Invalid-Curve-Point](/ashutosh1206/Crypton/tree/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

134 lines (88 loc) ¬∑ 9 KB[Raw](https://github.com/ashutosh1206/Crypton/raw/refs/heads/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md)
# Invalid Curve Point Attack

**Prerequisites**:

1. [Discrete Logarithm Problem](/ashutosh1206/Crypton/blob/master/Discrete-Logarithm-Problem/README.md)
2. [Diffie Hellman Key Exchange](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/README.md)
3. [Small Subgroup Confinement Attack](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Small-Subgroup-Confinement/README.md)
4. [Elliptic Curves](/ashutosh1206/Crypton/blob/master/Elliptic-Curves)
5. [Elliptic Curve Diffie Hellman](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point)

In this article, we will discuss an online attack on ECDH that arises due to incorrect check mechanism for points on an Elliptic Curve, eventually leading to leakage of secret key of the target involved, under specific circumstances.

The write-up is divided into three sections:

1. Attack Case Scenario
2. Invalid Curve Point Attack
3. Protections against the Attack

**Note**: The attack can be considered a variant of Small Subgroup Confinement Attack, but the circumstances under which a typical Small Subgroup Confinement works in ECDH and those under which Invalid Curve Point attack works are completely different.

> **Variable Notation**:

1. **E**: Elliptic Curve defined as [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)
2. **a**: Parameter of the Elliptic Curve [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)
3. **b**: Parameter of the Elliptic Curve [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/1.gif)
4. **e**: Cardinality of the curve E
5. **P**: Base point on the Elliptic Curve `E`.
6. **c**: Order of the subgroup generated by `P`
7. **Q**: Alice's public key
8. **x**: Alice's secret key
9. **u**: Upper limit in the range of `x` and is equal to `c`
10. **ni**: Cardinality of curve Ei, where (0 <= i <= 1)

## Attack Case Scenario and Background

Alice and Bob decide to exchange public keys using ECDH and derive the shared secret `S`. The x-coordinate of the shared secret is then used as a key for MAC.

As an attacker, our motive is to get Alice's secret key.

To send keys via ECDH, they need to choose a finite field over which all the necessary computations can happen. Assume it to be **GF(p)**. In most cases, `p` will chosen as be a prime number for convenience.

Suppose Alice and Bob choose `P` as the base point for ECDH computation.

We know that Small Subgroup Confinement attack will work in cases when order `c` of the subgroup generated by base point `P` on the curve has many smaller factors.

What if `c` doesn't have small factors? Can we do something in such a situation?

Suppose initialisation of any point on the curve looks like this:

```
class Point( object ):
    def __init__( self, curve, x, y, order = None ):
        self.__curve = curve
        self.__x = x
        self.__y = y
        self.__order = order
        if order:
            assert self * order == INFINITY
```

Do you see anything missing in the above code snippet?

**A point** that is **not on** the **curve** will be **initialised** without any error, since there is no mechanism to check that!

The question is, can we do something with it?

Let us dig into Elliptic Curves to find an answer to the above question
Have a look at the formula for point doubling in an Elliptic Curve

[![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/3.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/3.gif)

*[Point Doubling in Elliptic Curves](https://github.com/ashutosh1206/Crypton/tree/master/Elliptic-Curves#point-doubling)*

Notice that point doubling and point addition do not depend on `b` parameter of an Elliptic Curve, hence changing the value of `b` will not change the results of Elliptic Curve Arithmetic (Scalar Multiplication, Point Addition, Point Doubling) on any pair of points.

Using the above property, we can say that different points can be chosen from different curves having the same `a` but different values of `b`:

[![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/7.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/7.gif)

Now we have multiple curves from which we can choose our points and share as public keys, and this will not affect the results of Elliptic Curve Arithmetic due to reasons we discussed above. We can selectively choose points having small order of the subgroup, generated by scalar multiplication.

The remaining steps are the same as Small Subgroup Attacks on ECDH- find value of `x` mod different moduli and as soon as the moduli product exceeds the upper limit of `x`, calculate the CRT to get the value of `x`

But, it's not so easy as it sounds. There are some complications in the attack, as we will see in the next section.

## Invalid Curve Point Attack

The attack requires the attacker to be able to intercept the channel (Man-In-The-Middle)

1. At first, Alice calculates her public key as [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/5.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/5.gif), where `P` is the base point on an Elliptic Curve `E`, and shares it over the channel
2. Find the upper limit of `x` and assign it as `u`. The upper limit is equal to the order of the subgroup generated by point `P`. How do we calculate the order of the subgroup generated by point `P`?

   * We know from Lagrange's Theorem that order of the subgroup generated by any point on a curve is a divisor of the cardinality of that curve.
   * Calculating order of a point `P` on a curve `E`: Find smallest divisor `i` of cardinality of the curve `E` such that [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/6.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/6.gif)
3. Find suitable curves with cardinality having many small factors

   * [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/4.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/4.gif) --> E1
   * [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/8.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/8.gif) --> E2
   * To choose appropriate values of b1 & b2, iterate over possible values of bi, calculate the cardinality of the curve and check if it has multiple small factors.
4. Select a point Pi from a curve Ei (0 <= i <= 1), having a small order [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif), where pi is a prime number and is a factor of the cardinality ni of the curve Ei. Now, the question is: how do we select such a point?

   * Find a generator point `X` on the curve Ei. A generator point here means that `X` can be used to generate all points on the Elliptic Curve upon scalar multiplication.
   * Calculate [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/11.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/11.gif) and check if it is equal to arbitrary point at INFINITY(0, 0)

     + If True, then select another generator point `X` on the curve and repeat this process.
     + If False, then the resultant point Pi = [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/11.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/11.gif) has order [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif). Move to step-5.
5. Send this point Pi to Alice as your public key.
6. Alice calculates the shared secret `S` as [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/10.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/10.gif)
7. Alice computes **MAC(S[0], "testmessage")** and shares it over the channel. Let the value of MAC be `M`.

   * Notice that only the `x`-coordinate of the shared secret `S` is used for calculating the Message Authentication Code, hence the notation S[0]
8. We intercept the channel again and get the value of MAC `M`. Since order of Pi is [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif), we have effectively reduced the possible values of S[0]. All we need to do now is to find 1 < k < [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif) such that MAC((k\*Pi)[0], "testmessage") == `M`. Here is where a problem arises:

   * We can find two such values of `k` having the same (k\*Pi)[0]. **Why** does this **happen**? We know that P and (-P) have the same value of `x` coordinate. Hence, the x-coordinate of [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/12.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/12.gif) and that [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/13.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/13.gif) will be the same. Therefore, we have `k` and `-k mod p`, which when multiplied with Pi give the same value of x-coordinate.
   * **How** do we **solve this problem**? We know that [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/14.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/14.gif). So, what we can do is find [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/15.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/15.gif) instead of finding [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/16.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/16.gif), by finding any `k` in the range 1 < k < [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif) such that MAC((k\*Pi)[0], "testmessage") == `M`.

     + Finding `k` is very easy as we have reduced the range of possible values of `k` to less than or equal to [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif).
   * [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/17.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/17.gif)

Repeat steps 4-8 for different points Pi having different orders [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/18.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/18.gif) (where p1, p2, p3,..., pn are primes) on curves E1 and E2 to obtain:

[![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/19.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/19.gif)

^^ label the above system of equations as (1)

Since, p1, p2, p3,..., pn are primes, [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/18.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/18.gif) are pairwise coprime.

One thing to remember is that we can solve (1) only if [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif) >= u, where `u` is the upper limit of range of possible values of secret key `x`. Otherwise, find values of [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/15.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/15.gif) for more values of [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/9.gif) until the product [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif) >= u.

We can perform Chinese Remainder Theorem and get the value of [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/21.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/21.gif). Since, `x` < [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/20.gif). We can uniquely determine value of `x` from [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/21.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/21.gif) by using [Tonelli Shanks Algorithm](https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm) to get value of [![picture](/ashutosh1206/Crypton/raw/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/22.gif)](/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/Pictures/22.gif)!

# References

1. [Pratical Invalid Curve Point Attacks on TLS-ECDH](https://www.nds.ruhr-uni-bochum.de/media/nds/veroeffentlichungen/2015/09/14/main-full.pdf)
2. [Validation of Elliptic Curve Public Keys](https://www.iacr.org/archive/pkc2003/25670211/25670211.pdf)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


