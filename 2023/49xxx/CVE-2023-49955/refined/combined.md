=== Content from github.com_048d4056_20250115_094453.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdallmann-consulting%2FOCPP.Core%2Fissues%2F32)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdallmann-consulting%2FOCPP.Core%2Fissues%2F32)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=dallmann-consulting%2FOCPP.Core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dallmann-consulting](/dallmann-consulting)
/
**[OCPP.Core](/dallmann-consulting/OCPP.Core)**
Public

* [Notifications](/login?return_to=%2Fdallmann-consulting%2FOCPP.Core) You must be signed in to change notification settings
* [Fork
  93](/login?return_to=%2Fdallmann-consulting%2FOCPP.Core)
* [Star
   225](/login?return_to=%2Fdallmann-consulting%2FOCPP.Core)

* [Code](/dallmann-consulting/OCPP.Core)
* [Issues
  17](/dallmann-consulting/OCPP.Core/issues)
* [Pull requests
  5](/dallmann-consulting/OCPP.Core/pulls)
* [Actions](/dallmann-consulting/OCPP.Core/actions)
* [Projects
  0](/dallmann-consulting/OCPP.Core/projects)
* [Wiki](/dallmann-consulting/OCPP.Core/wiki)
* [Security](/dallmann-consulting/OCPP.Core/security)
* [Insights](/dallmann-consulting/OCPP.Core/pulse)

Additional navigation options

* [Code](/dallmann-consulting/OCPP.Core)
* [Issues](/dallmann-consulting/OCPP.Core/issues)
* [Pull requests](/dallmann-consulting/OCPP.Core/pulls)
* [Actions](/dallmann-consulting/OCPP.Core/actions)
* [Projects](/dallmann-consulting/OCPP.Core/projects)
* [Wiki](/dallmann-consulting/OCPP.Core/wiki)
* [Security](/dallmann-consulting/OCPP.Core/security)
* [Insights](/dallmann-consulting/OCPP.Core/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdallmann-consulting%2FOCPP.Core%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdallmann-consulting%2FOCPP.Core%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Possible DoS Vulnerability: No Control on length of 'chargePointVendor' property in 'BootNotification' OCPP message #32

Closed

[Tano-Coppoletta](/Tano-Coppoletta) opened this issue
Nov 2, 2023
· 4 comments

Closed

# [Possible DoS Vulnerability: No Control on length of 'chargePointVendor' property in 'BootNotification' OCPP message](#top) #32

[Tano-Coppoletta](/Tano-Coppoletta) opened this issue
Nov 2, 2023
· 4 comments

## Comments

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Nov 2, 2023](#issue-1974386343)

| **Description of the possible vulnerability**: While performing black box testing on OCPP.Core on my local machine, I discovered a potential security vulnerability that might lead to a Denial of Service (DoS) attack.  **Details**:   * There appears to be no control over the length of the `chargePointVendor` property of the `BootNotification` OCPP message. According to the protocol specifications, the `maxLength` of this property should be 20 characters. * I conducted a test by sending a `BootNotification` message with a `chargePointVendor` length of 442 MB, resulting in the server crashing.   **Attachments**:   * I have attached a screenshot of the server logs that displays the behavior when the oversized `BootNotification` message was received.   [dos_bootNotification_chargePointVendor](https://private-user-images.githubusercontent.com/62875720/280022363-2ea3c01a-4033-41f4-83a8-6d14954d33a2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MzQ1OTMsIm5iZiI6MTczNjkzNDI5MywicGF0aCI6Ii82Mjg3NTcyMC8yODAwMjIzNjMtMmVhM2MwMWEtNDAzMy00MWY0LTgzYTgtNmQxNDk1NGQzM2EyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDA5NDQ1M1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk5YzJhZmUwYjJhNTVkM2I4ZDgyNDdlZDlkODhmZTljN2QxZjUxZjQ4ZWU2N2Q2ODU3YTA0MWJhNTUwMzRjMTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HLWUkIPGq6yRd_uqUw2nYYHew7L_oOuCRhQJMsul9Us) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@dallmann-consulting](https://avatars.githubusercontent.com/u/51120629?s=80&u=7c37a33a36fd33dc9fe45f394774324de99fc2be&v=4)](/dallmann-consulting)

Copy link

Owner

### **[dallmann-consulting](/dallmann-consulting)** commented [Nov 2, 2023](#issuecomment-1791510718)

| Hi Gaetano,  thank you for your work and the notification!  I'm not sure what exactly causes the server to crash. I would expect that with such a large message the deserialization would simply fail with an exception:  ```             try             {                 Logger.LogTrace("Processing boot notification...");                 BootNotificationRequest bootNotificationRequest = JsonConvert.DeserializeObject<BootNotificationRequest>(msgIn.JsonPayload);             ...              }             catch (Exception exp)             {                 Logger.LogError(exp, "BootNotification => Exception: {0}", exp.Message);                 errorCode = ErrorCodes.FormationViolation;             }  ```  I don't see a realistic way to check specific fields because the whole message gets deserialized at once. And OCPP.Core doesn't have a problem with a too long vendor information (and other fields). A simple solution could be to define a max. size for incoming messages and check that. The ocpp messages have all small sizes and a configurable limit of 1-2 MB should be enough for all messages.  In general OCPP.Core is intended for use in a protected environment/network. For a public reachable API there should be more precautions. And the existing authentication mechanismens should be used as well and can avoid many attacks. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

Author

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Nov 6, 2023](#issuecomment-1795857954)

| Dear dalmann-consulting,  Thank you for addressing my previous concerns. I have observed that while the 'BootNotification' with an oversized 'chargePointVendor' field leads to a Denial of Service (DoS) attack by crashing the server, there is a broader issue at hand. Oversized 'idTag' values in 'Authorize' messages, although smaller in size (e.g., 10 MB), are being accepted and stored in the 'MessageLog' table of the database. This storage of excessively large entries without prior validation could be exploited to fill the database with large, non-standard data, potentially impacting performance and storage.  It seems prudent to consider implementing a pre-validation step to check message sizes against the protocol defined threshold before they are parsed and logged, ensuring database integrity and preventing possible storage abuse.  Kind regards, Gaetano Coppoletta |
| --- |

All reactions

Sorry, something went wrong.

[![@dallmann-consulting](https://avatars.githubusercontent.com/u/51120629?s=80&u=7c37a33a36fd33dc9fe45f394774324de99fc2be&v=4)](/dallmann-consulting)

Copy link

Owner

### **[dallmann-consulting](/dallmann-consulting)** commented [Nov 13, 2023](#issuecomment-1807871195)

| Please check with V1.2.0 and enabled message validation (and max. message size) |
| --- |

All reactions

Sorry, something went wrong.

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

Author

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Nov 17, 2023](#issuecomment-1817267097)

| It works now, it's not accepting long messages and so the server is not crashing anymore |
| --- |

All reactions

Sorry, something went wrong.

[![@dallmann-consulting](https://avatars.githubusercontent.com/u/51120629?s=40&u=7c37a33a36fd33dc9fe45f394774324de99fc2be&v=4)](/dallmann-consulting)
[dallmann-consulting](/dallmann-consulting)
closed this as [completed](/dallmann-consulting/OCPP.Core/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 30, 2023](#event-11113176691)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdallmann-consulting%2FOCPP.Core%2Fissues%2F32)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@dallmann-consulting](https://avatars.githubusercontent.com/u/51120629?s=52&v=4)](/dallmann-consulting) [![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=52&v=4)](/Tano-Coppoletta)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


