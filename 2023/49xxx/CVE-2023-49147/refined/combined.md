=== Content from packetstormsecurity.com_76a0e61f_20250115_090706.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from sec-consult.com_b28bfcda_20250115_090711.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/local-privilege-escalation-durch-msi-installer-in-pdf24-creator-geek-software-gmbh/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Local Privilege Escalation via MSI installer in PDF24 Creator (geek Software GmbH)
# Local Privilege Escalation via MSI installer in PDF24 Creator (geek Software GmbH)

Title

Local Privilege Escalation via MSI installer

Product

PDF24 Creator (geek Software GmbH)

Vulnerable Version

<=11.15.1

Fixed Version

11.15.2

CVE Number

CVE-2023-49147

Impact

high

Homepage

[https://tools.pdf24.org/en/creator/](https://tools.pdf24.org/en/creator/ "https://tools.pdf24.org/en/creator/")

Found

16.10.2023

By

Lukas Donaubauer, Mario Keck (Office Munich) | SEC Consult Vulnerability Lab

The MSI installer of PDF24 Creator contains a privilege escalation vulnerability. This enables an attacker with GUI access to a system, where PDF24 Creator is installed via MSI, to escalate the privileges to SYSTEM level.

## Vendor description

"*pdf24.org is a project of geek software GmbH, a German company based in Berlin, that was founded in 2006. PDF24 offers free and easy to use PDF solutions for many PDF problems, online and as software for download. Solutions include the well-known PDF24 Creator and PDF24 Online Tools.*"

Source: <https://www.pdf24.org/en/about-us>

## Business recommendation

The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product conducted by security professionals to identify and resolve potential further security issues.

## Vulnerability overview/description

### 1) Local Privilege Escalation via MSI installer (CVE-2023-49147)

The configuration of the PDF24 Creator MSI installer file was found to produce a visible cmd.exe window running as the SYSTEM user when using the repair function of msiexec.exe. This allows a local attacker to use a chain of actions, to open a fully functional cmd.exe with the privileges of the SYSTEM user.

Note: This attack does not work using a recent version of the Edge Browser or Internet Explorer. A different browser, such as Chrome or Firefox, needs to be used. Also make sure, that Edge or IE  have not been set to the default browser.

## Proof of concept

### 1) Local Privilege Escalation via MSI installer (CVE-2023-49147)

For the exploit to work, the PDF24 Creator has to be installed via the MSI file. Afterwards, any low-privileged user can run the following command to start the repair of PDF24 Creator and trigger the vulnerable actions without a UAC popup:

```
msiexec.exe /fa <PATH TO INSTALLERFILE>\pdf24-creator-11.14.0-x64.msi
```

At the very end of the repair process, the sub-process pdf24-PrinterInstall.exe gets called with SYSTEM privileges and performs a write action on the file "C:\Program Files\PDF24\faxPrnInst.log". This can be used by an attacker by simply setting an oplock on the file as soon as it gets read. To do that, one can use the 'SetOpLock.exe' tool from "https://github.com/googleprojectzero/symboliclink-testing-tools" with the following parameters:

```
SetOpLock.exe "C:\Program Files\PDF24\faxPrnInst.log" r
```

If the oplock is set, the cmd window that gets opened when pdf24-PrinterInstall.exe is executed doesn't close. The attacker can then perform the following actions to spawn a SYSTEM shell:

* right click on the top bar of the cmd window
* click on properties
* under options click on the "Legacyconsolemode" link
* open the link with a browser other than internet explorer or edge (both don't open as SYSTEM when on Win11)
* in the opened browser window press the key combination CTRL+o
* type cmd.exe in the top bar and press Enter

## Vulnerable / tested versions

The following version has been tested which was the latest version available at the time of the test:

* 11.14.0 (pdf24-creator-11.14.0-x64.msi)
* 11.15.1 (pdf24-creator-11.15.1-x64.msi)

A new version was released during our contact attempts (v11.15.1) which is also affected by the vulnerability.

The tests were conducted on an up to date Windows 10 system.

## Vendor contact timeline

| 2023-10-20: Contacting vendor through team@pdf24.org; no response. |
| --- |
| 2023-11-14: Contacting vendor again through team@pdf24.org and stefan@pdf24.org - No response. |
| 2023-11-17: Requesting CVE number |
| 2023-11-23: Received CVE number |
| 2023-11-27: Sending vendor CVE number and setting preliminary deadline for advisory release (11th December) |
| 2023-11-27: Identified that latest version 11.15.1 is also vulnerable. |
| 2023-11-28: Vendor response, seems our emails ended up in spam. Sending advisory unencrypted upon vendor request. |
| 2023-12-04: Asking for a status update. Further questions from vendor. Providing more details, clarification regarding Windows 11, browser usage and recommendation for fix. |
| 2023-12-08: Vendor releases fixed version 11.15.2. |
| 2023-12-11: Coordinated release of advisory. |

## Solution

The vendor provides a patched version 11.15.2 which can be downloaded from the vendor's website:

<https://tools.pdf24.org/en/creator>

Also check out the changelog from the vendor for further information: <https://creator.pdf24.org/changelog/en.html>

## Workaround

Use the available EXE installer.

## Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF Lukas Donaubauer, Mario Keck / @2023

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from seclists.org_58a5e6a9_20250115_090709.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20231211-0 :: Local Privilege Escalation via MSI installer in PDF24 Creator

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Mon, 11 Dec 2023 14:12:48 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20231211-0 >
=======================================================================
               title: Local Privilege Escalation via MSI installer
             product: PDF24 Creator (geek Software GmbH)
  vulnerable version: <=11.15.1
       fixed version: 11.15.2
          CVE number: CVE-2023-49147
              impact: High
            homepage: <https://tools.pdf24.org/en/creator/>
               found: 2023-10-16
                  by: Lukas Donaubauer (Office Munich)
                      Mario Keck (Office Munich)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"pdf24.org is a project of geek software GmbH, a German company based in Berlin,
that was founded in 2006. PDF24 offers free and easy to use PDF solutions for
many PDF problems, online and as software for download. Solutions include the
well-known PDF24 Creator and PDF24 Online Tools."

Source: <https://www.pdf24.org/en/about-us>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.

Vulnerability overview/description:
-----------------------------------
1) Local Privilege Escalation via MSI installer (CVE-2023-49147)
The configuration of the PDF24 Creator MSI installer file was found to
produce a visible cmd.exe window running as the SYSTEM user when using
the repair function of msiexec.exe. This allows a local attacker to use
a chain of actions, to open a fully functional cmd.exe with the privileges
of the SYSTEM user.

Note: This attack does not work using a recent version of the Edge Browser or
Internet Explorer. A different browser, such as Chrome or Firefox, needs to be
used. Also make sure, that Edge or IE have not been set to the default browser.

Proof of concept:
-----------------
1) Local Privilege Escalation via MSI installer (CVE-2023-49147)
For the exploit to work, the PDF24 Creator has to be installed via the MSI file.
Afterwards, any low-privileged user can run the following command to start the
repair of PDF24 Creator and trigger the vulnerable actions without a UAC popup:

msiexec.exe /fa <PATH TO INSTALLERFILE>\pdf24-creator-11.14.0-x64.msi

At the very end of the repair process, the sub-process pdf24-PrinterInstall.exe gets
called with SYSTEM privileges and performs a write action on the file
"C:\Program Files\PDF24\faxPrnInst.log". This can be used by an attacker by simply
setting an oplock on the file as soon as it gets read. To do that, one can use the
'SetOpLock.exe' tool from "[https://github.com/googleprojectzero/symboliclink-testing-tools"](https://github.com/googleprojectzero/symboliclink-testing-tools%22);
with the following parameters:

SetOpLock.exe "C:\Program Files\PDF24\faxPrnInst.log" r

If the oplock is set, the cmd window that gets opened when pdf24-PrinterInstall.exe
is executed doesn't close. The attacker can then perform the following actions to
spawn a SYSTEM shell:
- right click on the top bar of the cmd window
- click on properties
- under options click on the "Legacyconsolemode" link
- open the link with a browser other than internet explorer or edge (both don't open as SYSTEM when on Win11)
- in the opened browser window press the key combination CTRL+o
- type cmd.exe in the top bar and press Enter

Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:
* 11.14.0 (pdf24-creator-11.14.0-x64.msi)
* 11.15.1 (pdf24-creator-11.15.1-x64.msi)

A new version was released during our contact attempts (v11.15.1) which is
also affected by the vulnerability.

The tests were conducted on an up to date Windows 10 system.

Vendor contact timeline:
------------------------
2023-10-20: Contacting vendor through team () pdf24 org; no response.
2023-11-14: Contacting vendor again through team () pdf24 org and stefan () pdf24 org
             No response.
2023-11-17: Requesting CVE number
2023-11-23: Received CVE number
2023-11-27: Sending vendor CVE number and setting preliminary deadline for
             advisory release (11th December)
2023-11-27: Identified that latest version 11.15.1 is also vulnerable.
2023-11-28: Vendor response, seems our emails ended up in spam.
             Sending advisory unencrypted upon vendor request.
2023-12-04: Asking for a status update. Further questions from vendor.
             Providing more details, clarification regarding Windows 11, browser
             usage and recommendation for fix.
2023-12-08: Vendor releases fixed version 11.15.2.
2023-12-11: Coordinated release of advisory.

Solution:
---------
The vendor provides a patched version 11.15.2 which can be downloaded from the
vendor's website:

<https://tools.pdf24.org/en/creator>

Also check out the changelog from the vendor for further information:
<https://creator.pdf24.org/changelog/en.html>

Workaround:
-----------
Use the available EXE installer.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF L. Donaubauer, M. Keck / @2023
```

[![](att-18/sec-consult-h-msi-pdf24.png)](att-18/sec-consult-h-msi-pdf24.png)

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

### Current thread:

* **SEC Consult SA-20231211-0 :: Local Privilege Escalation via MSI installer in PDF24 Creator** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Dec 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


