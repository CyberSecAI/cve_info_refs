Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability stems from the use of an incorrect HTTP redirect status code (307 Temporary Redirect) when redirecting users to the Duo Security endpoint after successful Keycloak authentication.

**Weaknesses/vulnerabilities present:**

*   **Information Disclosure:** The use of HTTP 307 causes the browser to resend the original POST request (containing user credentials) to the Duo endpoint, potentially exposing sensitive information (username and password) to a third party.
*   **Incorrect HTTP Redirect:** The vulnerability is caused by the usage of `Response.temporaryRedirect` which uses the HTTP 307 status code instead of HTTP 303, which is the correct redirect status code for this case.

**Impact of exploitation:**

*   **Credential Exposure:** User credentials (usernames and passwords) are transmitted to the Duo Security endpoint during the redirect, outside of the Keycloak server's control. This exposes the credentials to the Duo server and any intermediary proxies or eavesdroppers.
*   The vulnerability allowed for the user's credentials to be inadvertently disclosed to duosecurity.com

**Attack vectors:**

*   **Network-based:** An attacker could potentially intercept the HTTP request during the redirect if they were in a position to perform a man-in-the-middle attack. This would allow them to capture the user's credentials sent to the Duo Security endpoint. However, the main vector is that users credentials are sent to the Duo endpoint.

**Required attacker capabilities/position:**

*   The attacker does not need to have any specific capabilities. The vulnerability can be triggered by a user simply logging into Keycloak when the DuoUniversalKeycloakAuthenticator plugin (version 1.0.7 or earlier) is used.
*   The attacker could potentially perform a man-in-the-middle attack to capture the credentials, however, that is not the main attack vector of the vulnerability.
*   The attack requires high privileges because it requires the attacker to configure and install the vulnerable plugin.
*   The attack requires user interaction as the user has to login to trigger the vulnerability.

**Additional details:**
*   The vulnerability is fixed in version 1.0.8 by changing the redirect status code from 307 to 303 (See Other).
*   The vulnerable code is located at `line 284` in the file which calls `Response.temporaryRedirect`.
*   The vulnerability is present in all versions of the plugin before 1.0.8.
*   The vulnerability is tracked as Cisco TALOS-2023-1907

This information is more detailed than the official CVE description which just states "An information disclosure vulnerability exists in the challenge functionality of instipod DuoUniversalKeycloakAuthenticator 1.0.7 plugin. A specially crafted HTTP request can lead to a disclosure of sensitive information. An user login to Keycloak using DuoUniversalKeycloakAuthenticator plugin triggers this vulnerability."