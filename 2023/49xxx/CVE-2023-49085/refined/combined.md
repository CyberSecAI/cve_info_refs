=== Content from github.com_9e05c174_20250115_091714.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fpollers.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fpollers.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

## Files

 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# pollers.php

Copy path Blame  Blame
## Latest commit

## History

[History](/Cacti/cacti/commits/5f6f65c215d663a775950b2d9db35edbaf07d680/pollers.php)1198 lines (1047 loc) · 39.3 KB 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# pollers.php

Top
## File metadata and controls

* Code
* Blame

1198 lines (1047 loc) · 39.3 KB[Raw](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/pollers.php)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000<?php/\* +-------------------------------------------------------------------------+ | Copyright (C) 2004-2023 The Cacti Group | | | | This program is free software; you can redistribute it and/or | | modify it under the terms of the GNU General Public License | | as published by the Free Software Foundation; either version 2 | | of the License, or (at your option) any later version. | | | | This program is distributed in the hope that it will be useful, | | but WITHOUT ANY WARRANTY; without even the implied warranty of | | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the | | GNU General Public License for more details. | +-------------------------------------------------------------------------+ | Cacti: The Complete RRDtool-based Graphing Solution | +-------------------------------------------------------------------------+ | This code is designed, written, and maintained by the Cacti Group. See | | about.php and/or the AUTHORS file for specific developer information. | +-------------------------------------------------------------------------+ | http://www.cacti.net/ | +-------------------------------------------------------------------------+\*/
require('./include/auth.php');require\_once(CACTI\_PATH\_LIBRARY . '/poller.php');
/\* performing a full sync can take a lot of memory and time \*/ini\_set('memory\_limit', '-1');ini\_set('max\_execution\_time', '900');
$actions = array( POLLER\_DISABLE => \_\_('Disable'), POLLER\_ENABLE => \_\_('Enable'), POLLER\_CLEAR\_STATS => \_\_('Clear Statistics'),);
if ($config['poller\_id'] == 1) { $actions += array(POLLER\_RESYNC => \_\_('Full Sync'));}
$poller\_status = array( POLLER\_STATUS\_NEW => '<div class="deviceUnknown">' . \_\_('New/Idle') . '</div>', POLLER\_STATUS\_RUNNING => '<div class="deviceUp">' . \_\_('Running') . '</div>', POLLER\_STATUS\_IDLE => '<div class="deviceRecovering">' . \_\_('Idle') . '</div>', POLLER\_STATUS\_DOWN => '<div class="deviceDown">' . \_\_('Down') . '</div>', POLLER\_STATUS\_DISABLED => '<div class="deviceDisabled">' . \_\_('Disabled') . '</div>', POLLER\_STATUS\_RECOVERING => '<div class="deviceDown">' . \_\_('Recovering') . '</div>', POLLER\_STATUS\_HEARTBEAT => '<div class="deviceDown">' . \_\_('Heartbeat') . '</div>',);
$logfile\_verbosity = array\_merge(array(-1 => \_\_('Use Cacti Log Level')), $logfile\_verbosity);
/\* file: pollers.php, action: edit \*/$fields\_poller\_edit = array( 'spacer0' => array( 'method' => 'spacer', 'friendly\_name' => \_\_('Data Collector Information'), ), 'name' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Name'), 'description' => \_\_('The primary name for this Data Collector.'), 'value' => '|arg1:name|', 'size' => '50', 'default' => \_\_('New Data Collector'), 'max\_length' => '100' ), 'hostname' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Data Collector Hostname'), 'description' => \_\_('The hostname for Data Collector. It may have to be a Fully Qualified Domain name for the remote Pollers to contact it for activities such as re-indexing, Real-time graphing, etc.'), 'value' => '|arg1:hostname|', 'size' => '50', 'default' => '', 'max\_length' => '100' ), 'log\_level' => array( 'method' => 'drop\_array', 'friendly\_name' => \_\_('Custom Log Level'), 'description' => \_\_('In Cases where you need to perform debugging for a single Data Collector Only, you can change it\'s log level here.'), 'value' => '|arg1:log\_level|', 'default' => '-1', 'array' => $logfile\_verbosity, ), 'timezone' => array( 'method' => 'drop\_callback', 'friendly\_name' => \_\_('TimeZone'), 'description' => \_\_('The TimeZone for the Data Collector.'), 'sql' => 'SELECT Name AS id, Name AS name FROM mysql.time\_zone\_name ORDER BY name', 'action' => 'ajax\_tz', 'id' => '|arg1:timezone|', 'value' => '|arg1:timezone|' ), 'notes' => array( 'method' => 'textarea', 'friendly\_name' => \_\_('Notes'), 'description' => \_\_('Notes for this Data Collectors Database.'), 'value' => '|arg1:notes|', 'textarea\_rows' => 4, 'textarea\_cols' => 50 ), 'spacer\_collection' => array( 'method' => 'spacer', 'friendly\_name' => \_\_('Collection Settings'), ), 'processes' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Processes'), 'description' => \_\_('The number of Data Collector processes to use to spawn.'), 'value' => '|arg1:processes|', 'size' => '10', 'default' => read\_config\_option('concurrent\_processes'), 'max\_length' => '4' ), 'threads' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Threads'), 'description' => \_\_('The number of Spine Threads to use per Data Collector process.'), 'value' => '|arg1:threads|', 'size' => '10', 'default' => read\_config\_option('max\_threads'), 'max\_length' => '4' ), 'sync\_interval' => array( 'method' => 'drop\_array', 'friendly\_name' => \_\_('Sync Interval'), 'description' => \_\_('The polling sync interval in use. This setting will affect how often this poller is checked and updated.'), 'value' => '|arg1:sync\_interval|', 'default' => read\_config\_option('poller\_sync\_interval'), 'array' => $poller\_sync\_intervals, ), 'spacer\_remotedb' => array( 'method' => 'spacer', 'friendly\_name' => \_\_('Remote Database Connection'), ), 'dbhost' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Hostname'), 'description' => \_\_('The hostname for the remote database server.'), 'value' => '|arg1:dbhost|', 'size' => '50', 'default' => '', 'max\_length' => '100' ), 'dbdefault' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database Name'), 'description' => \_\_('The name of the remote database.'), 'value' => '|arg1:dbdefault|', 'size' => '20', 'default' => $database\_default, 'max\_length' => '20' ), 'dbuser' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database User'), 'description' => \_\_('The user name to use to connect to the remote database.'), 'value' => '|arg1:dbuser|', 'size' => '20', 'default' => $database\_username, 'max\_length' => '20' ), 'dbpass' => array( 'method' => 'textbox\_password', 'friendly\_name' => \_\_('Remote Database Password'), 'description' => \_\_('The user password to use to connect to the remote database.'), 'value' => '|arg1:dbpass|', 'size' => '40', 'default' => $database\_password, 'max\_length' => '64' ), 'dbport' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database Port'), 'description' => \_\_('The TCP port to use to connect to the remote database.'), 'value' => '|arg1:dbport|', 'size' => '5', 'default' => $database\_port, 'max\_length' => '5' ), 'dbretries' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database Retries'), 'description' => \_\_('The number of times to attempt to retry to connect to the remote database.'), 'value' => '|arg1:dbretries|', 'size' => '5', 'default' => $database\_retries, 'max\_length' => '5' ), 'dbssl' => array( 'method' => 'checkbox', 'friendly\_name' => \_\_('Remote Database SSL'), 'description' => \_\_('If the remote database uses SSL to connect, check the checkbox below.'), 'value' => '|arg1:dbssl|', 'default' => $database\_ssl ? 'on' : '' ), 'dbsslkey' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database SSL Key'), 'description' => \_\_('The file holding the SSL Key to use to connect to the remote database.'), 'value' => '|arg1:dbsslkey|', 'size' => '50', 'default' => $database\_ssl\_key, 'max\_length' => '255' ), 'dbsslcert' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database SSL Certificate'), 'description' => \_\_('The file holding the SSL Certificate to use to connect to the remote database.'), 'value' => '|arg1:dbsslcert|', 'size' => '50', 'default' => $database\_ssl\_cert, 'max\_length' => '255' ), 'dbsslca' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database SSL Authority'), 'description' => \_\_('The file holding the SSL Certificate Authority to use to connect to the remote database. This is an optional parameter that can be required by the database provider if they have started SSL using the --ssl-mode=VERIFY\_CA option.'), 'value' => '|arg1:dbsslca|', 'size' => '50', 'default' => $database\_ssl\_ca, 'max\_length' => '255' ), 'dbsslcapath' => array( 'method' => 'textbox', 'friendly\_name' => \_\_('Remote Database SSL Authorities directory'), 'description' => \_\_('The file path to the directory that contains the trusted SSL Certificate Authority certificates. This is an optional parameter that can used instead of giving the path to an individual Certificate Authority file. This parameter can be required by the database provider if they have started SSL using the --ssl-mode=VERIFY\_CA option.'), 'value' => '|arg1:dbsslcapath|', 'size' => '50', 'default' => $database\_ssl\_capath, 'max\_length' => '255' ), 'dbsslverifyservercert' => array( 'method' => 'checkbox', 'friendly\_name' => \_\_('Remote Database SSL'), 'description' => \_\_("Provides a way to disable verification of the server's SSL certificate Common Name against the server's hostname when connecting. This verification is enabled by default."), 'value' => '|arg1:dbsslverifyservercert|', 'default' => $database\_ssl\_verify\_server\_cert ? 'on' : '' ), 'id' => array( 'method' => 'hidden', 'value' => '|arg1:id|', ), 'save\_component\_poller' => array( 'method' => 'hidden', 'value' => '1' ));
/\* set default action \*/set\_default\_action();
switch (get\_request\_var('action')) { case 'save': form\_save();
 break; case 'actions': form\_actions();
 break; case 'ajax\_tz': print json\_encode(db\_fetch\_assoc\_prepared( 'SELECT Name AS label, Name AS `value` FROM mysql.time\_zone\_name WHERE Name LIKE ? ORDER BY Name LIMIT ' . read\_config\_option('autocomplete\_rows'), array('%' . get\_nfilter\_request\_var('term') . '%') ));
 break; case 'ping': test\_database\_connection();
 break; case 'edit': top\_header();
 poller\_edit();
 bottom\_footer();
 break;
 default: top\_header();
 pollers();
 bottom\_footer();
 break;}
function form\_save() { if (isset\_request\_var('save\_component\_poller')) { // Common data $save['id'] = get\_filter\_request\_var('id'); $save['name'] = form\_input\_validate(get\_nfilter\_request\_var('name'), 'name', '', false, 3); $save['hostname'] = form\_input\_validate(get\_nfilter\_request\_var('hostname'), 'hostname', '', false, 3); $save['log\_level'] = form\_input\_validate(get\_nfilter\_request\_var('log\_level'), 'log\_level', '', false, 3); $save['timezone'] = form\_input\_validate(get\_nfilter\_request\_var('timezone'), 'timezone', '', false, 3); $save['notes'] = form\_input\_validate(get\_nfilter\_request\_var('notes'), 'notes', '', true, 3);
 // Process settings $save['processes'] = form\_input\_validate(get\_nfilter\_request\_var('processes'), 'processes', '^[0-9]+$', false, 3); $save['threads'] = form\_input\_validate(get\_nfilter\_request\_var('threads'), 'threads', '^[0-9]+$', false, 3);
 if ($save['id'] != 1) { $save['sync\_interval'] = form\_input\_validate(get\_nfilter\_request\_var('sync\_interval'), 'sync\_interval', '^[0-9]+$', false, 3);
 // Database settings $save['dbdefault'] = form\_input\_validate(get\_nfilter\_request\_var('dbdefault'), 'dbdefault', '', true, 3); $save['dbhost'] = form\_input\_validate(get\_nfilter\_request\_var('dbhost'), 'dbhost', '', true, 3); $save['dbuser'] = form\_input\_validate(get\_nfilter\_request\_var('dbuser'), 'dbuser', '', true, 3); $save['dbpass'] = form\_input\_validate(get\_nfilter\_request\_var('dbpass'), 'dbpass', '', true, 3); $save['dbport'] = form\_input\_validate(get\_nfilter\_request\_var('dbport'), 'dbport', '^[0-9]+$', true, 3); $save['dbretries'] = form\_input\_validate(get\_nfilter\_request\_var('dbretries'), 'dbretries', '^[0-9]+$', true, 3); $save['dbssl'] = isset\_request\_var('dbssl') ? 'on' : ''; $save['dbsslkey'] = form\_input\_validate(get\_nfilter\_request\_var('dbsslkey'), 'dbsslkey', '', true, 3); $save['dbsslcert'] = form\_input\_validate(get\_nfilter\_request\_var('dbsslcert'), 'dbsslcert', '', true, 3); $save['dbsslca'] = form\_input\_validate(get\_nfilter\_request\_var('dbsslca'), 'dbsslca', '', true, 3); $save['dbsslcapath'] = form\_input\_validate(get\_nfilter\_request\_var('dbsslcapath'), 'dbsslcapath', '', true, 3); $save['dbsslverifyservercert'] = isset\_request\_var('dbsslverifyservercert') ? 'on' : ''; }
 // Check for duplicate hostname $error = false;
 if (poller\_check\_duplicate\_poller\_id($save['id'], $save['hostname'], 'hostname')) { raise\_message('dupe\_hostname', \_\_esc('You have already used this hostname \'%s\'. Please enter a non-duplicate hostname.', $save['hostname']), MESSAGE\_LEVEL\_ERROR); $error = true; }
 if (isset($save['dbhost'])) { if (poller\_check\_duplicate\_poller\_id($save['id'], $save['dbhost'], 'dbhost')) { raise\_message('dupe\_dbhost', \_\_esc('You have already used this database hostname \'%s\'. Please enter a non-duplicate database hostname.', $save['hostname']), MESSAGE\_LEVEL\_ERROR); $error = true; } }
 if (isset($save['dbhost']) && $save['dbhost'] == 'localhost' && $save['id'] > 1) { raise\_message('poller\_dbhost'); } elseif ($save['id'] > 1 && poller\_host\_duplicate($save['id'], $save['dbhost'])) { raise\_message('poller\_nodupe'); } elseif (!is\_error\_message() && $error == false) { $poller\_id = sql\_save($save, 'poller');
 if ($poller\_id) { raise\_message(1); } else { raise\_message(2); } }
 header('Location: pollers.php?action=edit&id=' . (empty($poller\_id) ? get\_nfilter\_request\_var('id') : $poller\_id)); }}
function poller\_check\_duplicate\_poller\_id($poller\_id, $hostname, $column) { $ip\_addresses = array(); $ip\_hostnames = array();
 if (is\_ipaddress($hostname)) { $address = @gethostbyaddr($hostname);
 if ($address != $hostname) { $ip\_hostnames[$address] = $address; } else { $ip\_addresses[$address] = $address; }
 $ip\_addresses[$hostname] = $hostname; } elseif (strpos($hostname, '.') !== false) { $addresses = @dns\_get\_record($hostname); $ip = @gethostbyname($hostname);
 if ($ip != $hostname) { $ip\_addresses[$ip] = $ip; }
 $ip\_hostnames[$hostname] = $hostname;
 if (cacti\_sizeof($addresses)) { foreach ($addresses as $address) { if (isset($address['target'])) { $ip\_hostnames[$address['host']] = $address['host']; }
 if (isset($address['host'])) { $ip\_hostnames[$address['host']] = $address['host']; }
 if (isset($address['ip'])) { $ip\_addresses[$address['ip']] = $address['ip']; } } } } else { $ip\_hostname[$hostname] = $hostname;
 $address = @gethostbyname($hostname);
 if ($address != $hostname) { $ip\_addresses[$address] = $address; } }
 $sql\_where1 = '';
 if (cacti\_sizeof($ip\_addresses)) { $sql\_where1 = "$column IN ('" . implode("','", $ip\_addresses) . "')"; }
 $sql\_where2 = '';
 if (cacti\_sizeof($ip\_hostnames)) { foreach ($ip\_hostnames as $host) { $parts = explode('.', $host); $sql\_where2 .= ($sql\_where2 != '' ? ' OR ' : ' (') . "($column = " . db\_qstr($parts[0]) . " OR $column = " . db\_qstr($host) . ')'; } $sql\_where2 .= ')'; }
 if ($sql\_where1 != '' || $sql\_where2 != '') { $sql\_where = ' AND (' . $sql\_where1 . ($sql\_where1 != '' && $sql\_where2 != '' ? ' OR ' : '') . $sql\_where2 . ')'; } else { $sql\_where = ''; }
 $duplicate = db\_fetch\_cell\_prepared( "SELECT id FROM poller WHERE id != ? $sql\_where", array($poller\_id) );
 if (empty($duplicate)) { return false; } else { return true; }}
function poller\_host\_duplicate($poller\_id, $host) { if ($host == 'localhost') { return true; } else { return db\_fetch\_cell\_prepared( 'SELECT COUNT(\*) FROM poller WHERE dbhost LIKE ? AND id != ?', array($host . '%', $poller\_id)); }}
function form\_actions() { global $config, $actions;
 /\* ================= input validation ================= \*/ get\_filter\_request\_var('drp\_action', FILTER\_VALIDATE\_REGEXP, array('options' => array('regexp' => '/^([a-zA-Z0-9\_]+)$/'))); /\* ==================================================== \*/
 /\* if we are to save this form, instead of display it \*/ if (isset\_request\_var('selected\_items')) { $selected\_items = sanitize\_unserialize\_selected\_items(get\_nfilter\_request\_var('selected\_items'));
 if ($selected\_items != false) { if (get\_nfilter\_request\_var('drp\_action') == POLLER\_DELETE) { // delete db\_execute('DELETE FROM poller WHERE ' . array\_to\_sql\_or($selected\_items, 'id')); db\_execute('UPDATE host SET poller\_id=1 WHERE deleted="" AND ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE automation\_networks SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE automation\_processes SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE poller\_command SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE poller\_item SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE poller\_output\_realtime SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id')); db\_execute('UPDATE poller\_time SET poller\_id=1 WHERE ' . array\_to\_sql\_or($selected\_items, 'poller\_id'));
 cacti\_log('NOTE: The poller(s) with the id(s): ' . implode(',', $selected\_items) . ' deleted by user ' . $\_SESSION[SESS\_USER\_ID], false, 'WEBUI'); } elseif (get\_request\_var('drp\_action') == POLLER\_DISABLE) { // disable db\_execute('UPDATE poller SET disabled="on" WHERE ' . array\_to\_sql\_or($selected\_items, 'id'));
 cacti\_log('NOTE: The poller(s) with the id(s): ' . implode(',', $selected\_items) . ' disabled by user ' . $\_SESSION[SESS\_USER\_ID], false, 'WEBUI'); } elseif (get\_request\_var('drp\_action') == POLLER\_ENABLE) { // enable db\_execute('UPDATE poller SET disabled="" WHERE ' . array\_to\_sql\_or($selected\_items, 'id'));
 cacti\_log('NOTE: The poller(s) with the id(s): ' . implode(',', $selected\_items) . ' enabled by user ' . $\_SESSION[SESS\_USER\_ID], false, 'WEBUI'); } elseif (get\_request\_var('drp\_action') == POLLER\_RESYNC) { // full sync cacti\_session\_close();
 $success = array(); $failed = array(); $ids = array();
 foreach ($selected\_items as $item) { // Operation not allowed on the main poller if ($item == 1) { continue; }
 $ids[] = $item;
 $poller = db\_fetch\_row\_prepared( 'SELECT \* FROM poller WHERE id = ?', array($item) );
 if ($poller['dbhost'] == 'localhost') { raise\_message('poller\_dbhost');
 continue; }
 if ($item == 1) { raise\_message('poller\_nomain');
 continue; } else { if (replicate\_out($item)) { $success[] = $item;
 db\_execute\_prepared( 'UPDATE poller SET last\_sync = NOW() WHERE id = ?', array($item) ); } else { $failed[] = $item; } } }
 cacti\_session\_start();
 if (cacti\_sizeof($failed)) { cacti\_log('WARNING: Some selected Remote Data Collectors in [' . implode(', ', $ids) . '] failed synchronization by user ' . get\_username($\_SESSION[SESS\_USER\_ID]) . ', Successful/Failed[' . cacti\_sizeof($success) . '/' . cacti\_sizeof($failed) . ']. See log for details.', false, 'WEBUI'); } else { cacti\_log('NOTE: All selected Remote Data Collectors in [' . implode(', ', $ids) . '] synchronized correctly by user ' . get\_username($\_SESSION[SESS\_USER\_ID]), false, 'WEBUI'); } } elseif (get\_request\_var('drp\_action') == '5') { // clear statistics foreach ($selected\_items as $item) { db\_execute\_prepared( 'UPDATE poller SET total\_time = 0, max\_time = 0, min\_time = 9999999, avg\_time = 0, total\_polls = 0 WHERE id = ?', array($item) ); }
 raise\_message('poller\_clear', \_\_('Data Collector Statistics cleared.'), MESSAGE\_LEVEL\_INFO); } }
 header('Location: pollers.php');
 exit; } else { $ilist = ''; $iarray = array();
 /\* loop through each of the graphs selected on the previous page and get more info about them \*/ foreach ($\_POST as $var => $val) { if (preg\_match('/^chk\_([0-9]+)$/', $var, $matches)) { /\* ================= input validation ================= \*/ input\_validate\_input\_number($matches[1], 'chk[1]'); /\* ==================================================== \*/
 $ilist .= '<li>' . html\_escape(db\_fetch\_cell\_prepared('SELECT name FROM poller WHERE id = ?', array($matches[1]))) . '</li>';
 $iarray[] = $matches[1]; } }
 $form\_data = array( 'general' => array( 'page' => 'pollers.php', 'actions' => $actions, 'optvar' => 'drp\_action', 'item\_array' => $iarray, 'item\_list' => $ilist ), 'options' => array( POLLER\_DELETE => array( 'smessage' => \_\_('Click \'Continue\' to Delete the following Data Collector.'), 'pmessage' => \_\_('Click \'Continue\' to Delete the following Data Collectors.'), 'scont' => \_\_('Delete Data Collector'), 'pcont' => \_\_('Delete Data Collectors') ), POLLER\_DISABLE => array( 'smessage' => \_\_('Click \'Continue\' to Disable the following Data Collector.'), 'pmessage' => \_\_('Click \'Continue\' to Disable the following Data Collectors.'), 'scont' => \_\_('Disable Data Collector'), 'pcont' => \_\_('Disable Data Collectors') ), POLLER\_ENABLE => array( 'smessage' => \_\_('Click \'Continue\' to Enable the following Data Collector.'), 'pmessage' => \_\_('Click \'Continue\' to Enable the following Data Collectors.'), 'scont' => \_\_('Enable Data Collector'), 'pcont' => \_\_('Enable Data Collectors') ), POLLER\_RESYNC => array( 'smessage' => \_\_('Click \'Continue\' to Synchronize the Remote Data Collector for Offline Operation.'), 'pmessage' => \_\_('Click \'Continue\' to Synchronize the Remote Data Collectors for Offline Operation.'), 'scont' => \_\_('Resync Data Collector'), 'pcont' => \_\_('Resync Data Collectors') ), POLLER\_CLEAR\_STATS => array( 'smessage' => \_\_('Click \'Continue\' to Clear Statistics for the following Data Collector.'), 'pmessage' => \_\_('Click \'Continue\' to Clear Statistics for following Data Collectors.'), 'scont' => \_\_('Resync Data Collector'), 'pcont' => \_\_('Resync Data Collectors') ) ) );
 form\_continue\_confirmation($form\_data); }}
function poller\_edit() { global $fields\_poller\_edit;
 /\* ================= input validation ================= \*/ get\_filter\_request\_var('id'); /\* ==================================================== \*/
 if (!isempty\_request\_var('id')) { $poller = db\_fetch\_row\_prepared( 'SELECT \* FROM poller WHERE id = ?', array(get\_request\_var('id')) );
 $header\_label = \_\_esc('Site [edit: %s]', $poller['name']); } else { $poller = array();
 $header\_label = \_\_('Site [new]'); }
 form\_start('pollers.php', 'poller');
 html\_start\_box($header\_label, '100%', true, '3', 'center', '');
 if (cacti\_sizeof($poller)) { if ($poller['id'] == 1) { unset($fields\_poller\_edit['sync\_interval']); unset($fields\_poller\_edit['spacer\_remotedb']); unset($fields\_poller\_edit['dbdefault']); unset($fields\_poller\_edit['dbhost']); unset($fields\_poller\_edit['dbuser']); unset($fields\_poller\_edit['dbpass']); unset($fields\_poller\_edit['dbport']); unset($fields\_poller\_edit['dbretries']); unset($fields\_poller\_edit['dbssl']); unset($fields\_poller\_edit['dbsslkey']); unset($fields\_poller\_edit['dbsslcert']); unset($fields\_poller\_edit['dbsslca']); unset($fields\_poller\_edit['dbsslcapath']); unset($fields\_poller\_edit['dbsslverifyservercert']);
 $fields\_poller\_edit['log\_level']['method'] = 'hidden'; }
 if ($poller['timezone'] == '') { $poller['timezone'] = ini\_get('date.timezone'); } }
 draw\_edit\_form( array( 'config' => array('no\_form\_tag' => true), 'fields' => inject\_form\_variables($fields\_poller\_edit, (isset($poller) ? $poller : array())) ) );
 $tip\_text = \_\_('Remote Data Collectors must be able to communicate to the Main Data Collector, and vice versa. Use this button to verify that the Main Data Collector can communicate to this Remote Data Collector.');
 if (read\_config\_option('hide\_form\_description') == 'on') { $tooltip = '<br><span class="formFieldDescription">' . $tip\_text . '</span>'; } else { $tooltip = '<div class="formTooltip">' . str\_replace("\n", '', display\_tooltip($tip\_text)) . '</div>'; }
 $row\_html = '<div class="formRow odd"><div class="formColumnLeft"><div class="formFieldName">' . \_\_('Test Database Connection') . $tooltip . '</div></div><div class="formColumnRight"><input type="button" class="ui-button ui-corner-all ui-widget" id="dbtest" value="' . \_\_esc('Test Connection') . '"><span id="results"></span></div></div>';
 $pt = read\_config\_option('poller\_type');
 if (isset($poller) && cacti\_sizeof($poller)) { if ($poller['id'] > 1) { ?> <script type='text/javascript'> pt = <?php print $pt; ?>;
 function showHideRemoteDB() { var hasSSL = $('#dbssl').is(':checked'); toggleFields({ dbsslkey: hasSSL, dbsslcert: hasSSL, dbsslca: hasSSL, }); }
 $(function() { $('#row\_dbsslca').after('<?php print $row\_html; ?>'); $('#dbssl').click(function() { showHideRemoteDB(); });
 $('#dbtest').click(function(e) { e.preventDefault(); ping\_database(); });
 showHideRemoteDB();
 if (pt == 1) { $('#row\_threads').hide(); } });
 function ping\_database() { dbssl = $('#dbssl').is(':checked') ? 'on' : ''; dbsslverifyservercert = $('#dbsslverifyservercert').is(':checked') ? 'on' : '';
 var options = { url: 'pollers.php', funcEnd: 'pingDatabaseFinalize', handle: false };
 var data = { \_\_csrf\_magic: csrfMagicToken, action: 'ping', dbdefault: $('#dbdefault').val(), dbhost: $('#dbhost').val(), dbuser: $('#dbuser').val(), dbpass: $('#dbpass').val(), dbport: $('#dbport').val(), dbretries: $('#dbretries').val(), dbssl: dbssl, dbsslkey: $('#dbsslkey').val(), dbsslcert: $('#dbsslcert').val(), dbsslca: $('#dbsslca').val(), dbsslcapath: $('#dbsslcapath').val(), dbsslverifyservercert: dbsslverifyservercert };
 postUrl(options, data); }
 function pingDatabaseFinalize(options, data) { $('#results').empty().show().html(data).fadeOut(5000); } </script> <?php } else { ?> <script type='text/javascript'> pt = <?php print $pt; ?>;
 $(function() { if (pt == 1) { $('#row\_threads').hide(); } }); </script> <?php } }
 html\_end\_box(true, true);
 $form\_buttons = array( array( 'id' => 'return', 'value' => \_\_esc('Return'), 'url' => 'pollers.php', 'method' => 'return', ), array( 'id' => 'save', 'value' => \_\_esc('Save'), 'type' => 'submit' ) );
 form\_save\_buttons($form\_buttons);}
function test\_database\_connection($poller = array()) { if (!cacti\_sizeof($poller)) { $poller['dbtype'] = 'mysql';
 $fields = array( 'dbhost', 'dbuser', 'dbpass', 'dbdefault', 'dbport', 'dbretries', 'dbssl', 'dbsslkey', 'dbsslcert', 'dbsslca', 'dbsslcapath', 'dbsslverifyservercert' );
 foreach ($fields as $field) { if ($field == 'dbssl') { if (isset\_request\_var('dbssl') && get\_nfilter\_request\_var('dbssl') == 'on') { $poller['dbssl'] = 'on'; } else { $poller['dbssl'] = ''; } } elseif ($field == 'dbsslverifyservercert') { if (isset\_request\_var('dbsslverifyservercert') && get\_nfilter\_request\_var('dbsslverifyservercert') == 'on') { $poller['dbsslverifyservercert'] = 'on'; } else { $poller['dbsslverifyservercert'] = ''; } } elseif (isset\_request\_var($field)) { $poller[$field] = get\_nfilter\_request\_var($field); } else { print 'ERROR: DB Connection Column ' . $field . ' Missing';
 return false; } } }
 $connection = db\_connect\_real( $poller['dbhost'], $poller['dbuser'], $poller['dbpass'], $poller['dbdefault'], $poller['dbtype'], $poller['dbport'], $poller['dbretries'], $poller['dbssl'], $poller['dbsslkey'], $poller['dbsslcert'], $poller['dbsslca'], $poller['dbsslcapath'], $poller['dbsslverifyservercert'] );
 if (is\_object($connection)) { db\_close($connection); print '&nbsp;<i class="fas fa-check"></i>&nbsp;' . \_\_('Connection Successful'); } else { print '&nbsp;<i class="fas fa-times"></i>&nbsp;' . \_\_('Connection Failed'); }}
function pollers() { global $actions, $poller\_status, $item\_rows;
 /\* ================= input validation and session storage ================= \*/ $filters = array( 'rows' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'page' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '1' ), 'refresh' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '20' ), 'filter' => array( 'filter' => FILTER\_DEFAULT, 'pageset' => true, 'default' => '' ), 'sort\_column' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'name', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_direction' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'ASC', 'options' => array('options' => 'sanitize\_search\_string') ) );
 validate\_store\_request\_vars($filters, 'sess\_pollers'); /\* ================= input validation ================= \*/
 $refresh['page'] = 'pollers.php'; $refresh['seconds'] = get\_request\_var('refresh'); $refresh['logout'] = 'false';
 set\_page\_refresh($refresh);
 if (get\_request\_var('rows') == '-1') { $rows = read\_config\_option('num\_rows\_table'); } else { $rows = get\_request\_var('rows'); }
 html\_start\_box(\_\_('Data Collectors'), '100%', '', '3', 'center', '');
 ?> <tr class='even'> <td> <form id='form\_poller' action='pollers.php'> <table class='filterTable'> <tr> <td> <?php print \_\_('Search'); ?> </td> <td> <input type='text' class='ui-state-default ui-corner-all' id='filter' size='25' value='<?php print html\_escape\_request\_var('filter'); ?>'> </td> <td> <?php print \_\_('Collectors'); ?> </td> <td> <select id='rows' onChange='applyFilter()'> <option value='-1' <?php print(get\_request\_var('rows') == '-1' ? ' selected>' : '>') . \_\_('Default'); ?></option> <?php if (cacti\_sizeof($item\_rows)) { foreach ($item\_rows as $key => $value) { print "<option value='" . $key . "'";
 if (get\_request\_var('rows') == $key) { print ' selected'; } print '>' . html\_escape($value) . "</option>\n"; } } ?> </select> </td> <td> <?php print \_\_('Refresh'); ?> </td> <td> <select id='refresh' onChange='applyFilter()'> <?php $frequency = array( 5 => \_\_('%d Seconds', 5), 10 => \_\_('%d Seconds', 10), 20 => \_\_('%d Seconds', 20), 30 => \_\_('%d Seconds', 30), 45 => \_\_('%d Seconds', 45), 60 => \_\_('%d Minute', 1), 120 => \_\_('%d Minutes', 2), 300 => \_\_('%d Minutes', 5) );
 foreach ($frequency as $r => $row) { print "<option value='" . $r . "'" . (isset\_request\_var('refresh') && $r == get\_request\_var('refresh') ? ' selected' : '') . '>' . $row . '</option>'; } ?> </select> </td> <td> <span> <input type='submit' class='ui-button ui-corner-all ui-widget' id='go' value='<?php print \_\_esc('Go'); ?>' title='<?php print \_\_esc('Set/Refresh Filters'); ?>'> <input type='button' class='ui-button ui-corner-all ui-widget' id='clear' value='<?php print \_\_esc('Clear'); ?>' title='<?php print \_\_esc('Clear Filters'); ?>'> </span> </td> </tr> </table> </form> <script type='text/javascript'> function applyFilter() { strURL = 'pollers.php'; strURL += '?filter=' + $('#filter').val(); strURL += '&refresh=' + $('#refresh').val(); strURL += '&rows=' + $('#rows').val(); loadUrl({ url: strURL }) }
 function clearFilter() { strURL = 'pollers.php?clear=1'; loadUrl({ url: strURL }) }[View remainder of file in raw view](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/pollers.php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_a1598720_20250115_091711.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_3a3ac38f_20250115_091715.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-vr3c-38wh-g855)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-vr3c-38wh-g855)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

# SQL Injection vulnerability when managing poller devices

High

[netniV](/netniV)
published
GHSA-vr3c-38wh-g855
Dec 20, 2023

## Package

No package listed

## Affected versions

1.2.25

## Patched versions

None

## Description

## SQL Injection

**Product**: Cacti

**Version**: 1.2.25

**Description**: It is possible to execute arbitrary SQL code through the `pollers.php` script. Exploitation of the vulnerability is possible for an authorized user. The vulnerable component is the `pollers.php`. Impact of the vulnerability - arbitrary SQL code execution.

**Mitigation**: Improve user data escaping to prevent SQL injection.

### Research

SQL Injection was executed in the `pollers.php` file.

The `pollers.php` file has an action – `form_save`, which is called if the user receives an action parameter with the value `save`.

[![fig7_orig](https://user-images.githubusercontent.com/100608357/281408992-9ce44072-35fe-49e4-8346-09f4b8256930.png)](https://user-images.githubusercontent.com/100608357/281408992-9ce44072-35fe-49e4-8346-09f4b8256930.png)

*Figure 1. In the script `pollers.php` the form\_save function is called*

In the `form_save` function (line 321) the `poller_host_duplicate` function is called, and the second parameter passes the value without sanitization `get_nfilter_request_var('dbhost')`.

[![fig8_orig](https://user-images.githubusercontent.com/100608357/281409421-d193a3d6-8c9d-473d-95a4-59db74a2be9d.png)](https://user-images.githubusercontent.com/100608357/281409421-d193a3d6-8c9d-473d-95a4-59db74a2be9d.png)

*Figure 2. Getting the dbhost parameter and using it as the second parameter in the `poller_host_duplicate` function*

There is a SQL Injection vulnerability in the function `poller_host_duplicate` on the line 427.

[![fig9_orig](https://user-images.githubusercontent.com/100608357/281410137-6fd8911d-51d0-4852-9319-c5517dac4e14.png)](https://user-images.githubusercontent.com/100608357/281410137-6fd8911d-51d0-4852-9319-c5517dac4e14.png)

*Figure 3. SQL Injection using the `$host` variable, which is controlled by the attacker in the `poller_host_duplicate function`*

Researcher creates an HTTP request containing SQL Injection, which will put the database server to sleep for 5 seconds.

*Listing 1. HTTP request demonstrating SQL Injection*

```
POST /cacti/pollers.php?header=false HTTP/1.1
Host: ***.***.*.174:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101
Firefox/119.0
Accept: */*
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 274
Origin: http://***.***.*.174:8080
Connection: close
Referer: http://***.***.*.174:8080/cacti/pollers.php?action=edit&id=1
Cookie: CactiDateTime=Sat Oct 28 2023 22:47:22 GMT+0300 (Ð�Ð¾Ñ�ÐºÐ²Ð°,
Ñ�Ñ�Ð°Ð½Ð´Ð°Ñ�Ñ�Ð½Ð¾Ðµ Ð²Ñ�ÐµÐ¼Ñ�); CactiTimeZone=180;
Cacti=acbmsv2adk9forvpkqt0njd1oc;
cacti_remembers=1%2C0%2C28a320bc68fa35780e2f050b1f2eb14c0f0adc1d11112f87cf2360dd1
bbdc939; CactiDateTime=Fri Oct 27 2023 12:27:36 GMT+0300 (Ð�Ð¾Ñ�ÐºÐ²Ð°,
Ñ�Ñ�Ð°Ð½Ð´Ð°Ñ�Ñ�Ð½Ð¾Ðµ Ð²Ñ�ÐµÐ¼Ñ�); CactiTimeZone=180
__csrf_magic=sid%3Aa75547fddea89cbf28c4b77050af90283d0b7554%2C1698522443&name=Mai
n+Poller&hostname=unknown&timezone=&notes=&processes=1&threads=1&id=2&save_compon
ent_poller=1&dbhost=";%20select%20sleep(5);%20select%20*%20from%20poller%20where%
201=1%20and%20"%"="&action=save

```

Note that this SQL Injection successfully supports multiqueries. This means that during one access to the database you can execute several arbitrary SQL queries unrelated to each other.

[![fig10_](https://user-images.githubusercontent.com/100608357/281410680-3dcc2b19-4efa-47de-be65-e89201058c7d.png)](https://user-images.githubusercontent.com/100608357/281410680-3dcc2b19-4efa-47de-be65-e89201058c7d.png)

*Figure 4. HTTP request and HTTP response that returned from the server after more than 5 seconds*

**Researcher**: Aleksey Solovev (Positive Technologies)

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2023-49085

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

### Credits

* [![@012git012](https://avatars.githubusercontent.com/u/100608357?s=40&v=4)](/012git012)
  [012git012](/012git012)
  Reporter
* [![@TheWitness](https://avatars.githubusercontent.com/u/1439914?s=40&v=4)](/TheWitness)
  [TheWitness](/TheWitness)
  Analyst
* [![@netniV](https://avatars.githubusercontent.com/u/9052188?s=40&v=4)](/netniV)
  [netniV](/netniV)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_111ce00f_20250115_091716.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 3765-1] cacti security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3765-1] cacti security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Mon, 18 Mar 2024 19:26:19 +0100
* *Message-id*: <[[🔎]](/msgid-search/ZfiHS0jbmhLYtAEo%40mail.beuc.net) [ZfiHS0jbmhLYtAEo@mail.beuc.net](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3765-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Sylvain Beucler
March 18, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : cacti
Version        : 1.2.2+ds1-2+deb10u6
CVE ID         : CVE-2023-39357 CVE-2023-39360 CVE-2023-39361 CVE-2023-39362
                 CVE-2023-39364 CVE-2023-39365 CVE-2023-39513 CVE-2023-39515
                 CVE-2023-39516 CVE-2023-49084 CVE-2023-49085 CVE-2023-49086
                 CVE-2023-49088
Debian Bug     : 1059254

Multiple vulnerabilities were found in Cacti, a network monitoring
system. An attacker could manipulate the database, execute code
remotely, launch DoS (denial-of-service) attacks or impersonate Cacti
users, in some situations.

CVE-2023-39357

    When the column type is numeric, the sql_save function directly
    utilizes user input. Many files and functions calling the sql_save
    function do not perform prior validation of user input, leading to
    the existence of multiple SQL injection vulnerabilities in
    Cacti. This allows authenticated users to exploit these SQL
    injection vulnerabilities to perform privilege escalation and
    remote code execution.

CVE-2023-39360

    Stored Cross-Site-Scripting (XSS) Vulnerability allows an
    authenticated user to poison data. The vulnerability is found in
    `graphs_new.php`. Several validations are performed, but the
    `returnto` parameter is directly passed to `form_save_button`. In
    order to bypass this validation, returnto must contain `host.php`.

CVE-2023-39361

    SQL injection discovered in graph_view.php. Since guest users can
    access graph_view.php without authentication by default, if guest
    users are being utilized in an enabled state, there could be the
    potential for significant damage. Attackers may exploit this
    vulnerability, and there may be povssibilities for actions such as
    the usurpation of administrative privileges or remote code
    execution.

CVE-2023-39362

    An authenticated privileged user, can use a malicious string in
    the SNMP options of a Device, performing command injection and
    obtaining remote code execution on the underlying server. The
    `lib/snmp.php` file has a set of functions, with similar behavior,
    that accept in input some variables and place them into an `exec`
    call without a proper escape or validation.

CVE-2023-39364

    Users with console access can be redirected to an arbitrary
    website after a change password performed via a specifically
    crafted URL. The `auth_changepassword.php` file accepts `ref` as a
    URL parameter and reflects it in the form used to perform the
    change password. It's value is used to perform a redirect via
    `header` PHP function. A user can be tricked in performing the
    change password operation, e.g., via a phishing message, and then
    interacting with the malicious website where the redirection has
    been performed, e.g., downloading malwares, providing credentials,
    etc.

CVE-2023-39365

    Issues with Cacti Regular Expression validation combined with the
    external links feature can lead to limited SQL Injections and
    subsequent data leakage.

CVE-2023-39513

    Stored Cross-Site-Scripting (XSS) Vulnerability which allows an
    authenticated user to poison data stored in the _cacti_'s
    database. The script under `host.php` is used to monitor and
    manage hosts in the _cacti_ app, hence displays useful information
    such as data queries and verbose logs.

CVE-2023-39515

    Stored Cross-Site-Scripting (XSS) Vulnerability allows an
    authenticated user to poison data stored in the cacti's
    database. These data will be viewed by administrative cacti
    accounts and execute JavaScript code in the victim's browser at
    view-time. The script under `data_debug.php` displays data source
    related debugging information such as _data source paths, polling
    settings, meta-data on the data source.

CVE-2023-39516

    Stored Cross-Site-Scripting (XSS) Vulnerability which allows an
    authenticated user to poison data stored in the _cacti_'s
    database. These data will be viewed by administrative _cacti_
    accounts and execute JavaScript code in the victim's browser at
    view-time. The script under `data_sources.php` displays the data
    source management information (e.g. data source path, polling
    configuration etc.) for different data visualizations of the
    _cacti_ app.

CVE-2023-49084

    While using the detected SQL Injection and insufficient processing
    of the include file path, it is possible to execute arbitrary code
    on the server. Exploitation of the vulnerability is possible for
    an authorized user. The vulnerable component is the `link.php`.

CVE-2023-49085

    It is possible to execute arbitrary SQL code through the
    `pollers.php` script. An authorized user may be able to execute
    arbitrary SQL code. The vulnerable component is the `pollers.php`.

CVE-2023-49086

    Bypassing an earlier fix (CVE-2023-39360) that leads to a DOM XSS
    attack. Exploitation of the vulnerability is possible for an
    authorized user. The vulnerable component is the `graphs_new.php`.

CVE-2023-49088

    The fix applied for CVE-2023-39515 in version 1.2.25 is incomplete
    as it enables an adversary to have a victim browser execute
    malicious code when a victim user hovers their mouse over the
    malicious data source path in `data_debug.php`.

For Debian 10 buster, these problems have been fixed in version
1.2.2+ds1-2+deb10u6.

We recommend that you upgrade your cacti packages.

For the detailed security status of cacti please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/cacti>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmX4gD8ACgkQDTl9HeUl
XjBYcxAAmAYZrVh2A/WqKiYrOmjuBfrzZYoTsvHQ5vkFopsGmYxOX6UtiH2O0uCk
ECaq6eBEwUwkLz1DB8JP0CRoVGsRcs7aN9x0JUno+55/WfJ6BnxsBp7/0x/18IRx
FxbIrD4ndx2HhiU1KDzmsFNYo1usvY2AuoBU7HrWxmKculgb9Y1al4/K9PU2TKLY
D/J0jf1EAYQC8ieEd0bB4RocIbKUfgS/9Mzv+9zBZ0snpmnv+l1YmWTUbcI0lGsu
F8lw8Ap4AqE0SaPyj3PgkOAXAslcjQGTj2ZNbdL/8O38rJvyrA4KSnsvPOa2aJDH
3MHdYb6PyaCzuL7Yrp5hhAfQ41GDV1OomRAm7b9VZlDAu7nk2VGLG8hnCbVfZtay
+H7pPoONw3JMGL56ePNf1URjJgT3vwvseIL772BLnRVUpLM1NW+O0fTbxWf/uKbq
y51602YnA6jUByCqVrh1xRrx+gYR6QcS1ygcEkkA5qEFo/U2YorZn5JlSpZBPVM9
4fyPS2SKv/c+Dzq1Y+6dsihg55mVyB4cErn7HXPXhsExvkXE0fPXXlj86qvMX1Hd
xsAg5oCvBrIvPgYE7SGOKYfyhxihbkyWMLisXZBRWeW68CgQnOgV3GxpCl9IJIP4
CbhlOcW/+kXPU2aTEcVKf+8Wx/13ZG2C1kBjiQVdgtWxmRXXTIY=
=3CrP
-----END PGP SIGNATURE-----

```

---



=== Content from lists.fedoraproject.org_08df3a04_20250115_091718.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-RBEOAFKRARQHTDIYSL723XAFJ2Q6624X.mbox.gz?message=RBEOAFKRARQHTDIYSL723XAFJ2Q6624X "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

# [SECURITY] Fedora 39 Update: cacti-spine-1.2.27-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

31 May
2024

31 May
'24

4:14 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-27a594f71d
2024-05-31 02:13:07.316161
--------------------------------------------------------------------------------

Name : cacti-spine
Product : Fedora 39
Version : 1.2.27
Release : 1.fc39
URL : <https://cacti.net>
Summary : Threaded poller for Cacti written in C
Description :
Spine is a supplemental poller for Cacti that makes use of pthreads to achieve
excellent performance.

--------------------------------------------------------------------------------
Update Information:

Update cacti and cacti-spine to version 1.2.27. This includes the upstream fixes
for many CVEs, including a critical remote code execution bug.
<https://github.com/Cacti/cacti/blob/release/1.2.27/CHANGELOG>
<https://github.com/Cacti/spine/blob/release/1.2.27/CHANGELOG>
--------------------------------------------------------------------------------
ChangeLog:

\* Wed May 22 2024 Carl George carlwgeorge@fedoraproject.org - 1.2.27-1
- Update to version 1.2.27
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2255602 - CVE-2023-49084 cacti: RCE when managing links [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255602>
[ 2 ] Bug #2255606 - CVE-2023-49086 cacti: XSS when adding new devices [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255606>
[ 3 ] Bug #2255667 - CVE-2023-49085 CVE-2023-49088 CVE-2023-50250 CVE-2023-51448 cacti: Multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255667>
[ 4 ] Bug #2280482 - CVE-2024-34340 cacti: authentication bypass when using older password hashes [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280482>
[ 5 ] Bug #2280497 - CVE-2024-29894 cacti: XSS vulnerability when using JavaScript based messaging API [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280497>
[ 6 ] Bug #2280500 - CVE-2024-31458 CVE-2024-31459 CVE-2024-31460 cacti: multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280500>
[ 7 ] Bug #2280503 - CVE-2024-31443 CVE-2024-31444 CVE-2024-31445 cacti: multiple vulnerabilties [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280503>
[ 8 ] Bug #2280506 - CVE-2024-25641 cacti: remote code execution vulnerability [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280506>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-27a594f71d' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.


