The provided content relates to CVE-2023-49099.

**Root cause of vulnerability:**
Secure upload URLs associated with posts could be accessed by guest users even when login was required under specific circumstances.

**Weaknesses/vulnerabilities present:**
- Inadequate access control for secure uploads, allowing unauthorized access to files.

**Impact of exploitation:**
- Unauthorized access to secure uploads, potentially exposing sensitive information to guest users.
-  Low impact on confidentiality, no impact on integrity or availability.

**Attack vectors:**
- Network-based attack.
- Exploitation requires accessing a specific URL for secure uploads.

**Required attacker capabilities/position:**
- No privileges are required.
- User interaction is required by clicking the link to a secure upload.
- The attacker must be able to access a URL for a secure upload.

**Additional details:**
- The vulnerability was patched in the latest stable, beta, and test-passed versions of Discourse.
- A workaround is available by setting the `prevent_anons_from_downloading_files` site setting to `true`.
- The commit log includes changes to `app/controllers/uploads_controller.rb` and `spec/requests/uploads_controller_spec.rb`, which seem to enforce the login requirement and prevent unauthorized access to secure uploads.
- The CVSS score is 3.1, with a base metric of AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N.