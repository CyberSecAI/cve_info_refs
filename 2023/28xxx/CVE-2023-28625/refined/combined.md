=== Content from lists.fedoraproject.org_f49e1961_20250114_195400.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB.mbox.gz?message=WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/#WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB)

# [SECURITY] Fedora 38 Update: mod\_auth\_openidc-2.4.13.2-1.fc38

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

31 May
2023

31 May
'23

6:34 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2023-b534ca7056
2023-05-31 17:29:34.389836
--------------------------------------------------------------------------------

Name : mod\_auth\_openidc
Product : Fedora 38
Version : 2.4.13.2
Release : 1.fc38
URL : <https://github.com/zmartzone/mod_auth_openidc>
Summary : OpenID Connect auth module for Apache HTTP Server
Description :
This module enables an Apache 2.x web server to operate as
an OpenID Connect Relying Party and/or OAuth 2.0 Resource Server.

--------------------------------------------------------------------------------
Update Information:

Rebase to 2.4.13.2 version, fix CVE-2023-28625
--------------------------------------------------------------------------------
ChangeLog:

\* Tue May 23 2023 Tomas Halman thalman@redhat.com - 2.4.13.2-1
Rebase to 2.4.13.2 version
- Resolves: rhbz#2184119 - CVE-2023-28625 mod\_auth\_openidc: NULL pointer dereference
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2184118 - CVE-2023-28625 mod\_auth\_openidc: NULL pointer dereference when OIDCStripCookies is set and a crafted Cookie header is supplied
<https://bugzilla.redhat.com/show_bug.cgi?id=2184118>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2023-b534ca7056' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB/#WIBKFC22PDH6UXMSZ23PHTD7736ZC7BB)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.debian.org_be5bfa88_20250114_195358.html ===


---

[[Date Prev](msg00033.html)][Date Next]
[[Thread Prev](msg00033.html)][Thread Next]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DLA 3409-1] libapache2-mod-auth-openidc security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3409-1] libapache2-mod-auth-openidc security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Mon, 1 May 2023 00:14:15 +0300
* *Message-id*: <ZE7aJ0fv/vGlLBY1@localhost>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3409-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
April 30, 2023                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : libapache2-mod-auth-openidc
Version        : 2.3.10.2-1+deb10u2
CVE ID         : CVE-2019-20479 CVE-2021-32785 CVE-2021-32786 CVE-2021-32791
                 CVE-2021-32792 CVE-2023-28625
Debian Bug     : 991580 991581 991582 991583 1033916

Several vulnerabilities were fixed in libapache2-mod-auth-openidc,
an OpenID Connect Relying Party implementation for Apache.

CVE-2019-20479

    Insufficient validatation of URLs beginning with a slash and backslash.

CVE-2021-32785

    Crash when using an unencrypted Redis cache.

CVE-2021-32786

    Open Redirect vulnerability in the logout functionality.

CVE-2021-32791

    AES GCM encryption in used static IV and AAD.

CVE-2021-32792

    XSS vulnerability when using OIDCPreservePost.

CVE-2023-28625

    NULL pointer dereference with OIDCStripCookies.

For Debian 10 buster, these problems have been fixed in version
2.3.10.2-1+deb10u2.

We recommend that you upgrade your libapache2-mod-auth-openidc packages.

For the detailed security status of libapache2-mod-auth-openidc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libapache2-mod-auth-openidc>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmRO2icACgkQiNJCh6LY
mLGkPhAAg1hWzk52AhdbiwRuEj9zyyZKJd7ZQYDjbBMgOlgSXG28XtS8tTEp8oKP
/hyWoyyczyqkdVwv3UAoOwOcuXa8Fr9bcCdF/KWZsONFtAXaf1+IOvQmyg+orf5P
G4xG7EtMIXKb/JF0zNEov7dAr2TP1bAlE1lIdDbsNje+0lV7irXumnx8BVAoDJ0j
3Ea8ptrtDknTXNf8hEx7TNR5XoSi8soeaAZw0ckHVK7t9P+YLvd4HWBt1xwU4w5q
SryyVRgYe0s68AA2aIQYj205Zx4f5auLwkR+GPvW0cpoqUAbiy27JqBW2AysB5qO
GsFwUfUn9nVj6ViJxhEbW9KnrMRb2Xy2FqfGVqU9rMuEkTUjAbsUzTYWa2RccULJ
q4QskZrhowYqw7JhhOOyAbM0pU6RW9y0PWte7uQzfbw0mtK9vPLtnpPIBI0tPjg+
veko0oRGwS3FU4oAa3jWS8VOJhlR//lB5RpgMRqhd/Dm68+81UQ8+2lBSLRbfuXg
Le7CmV33DIuwixr6HCfSCrvSk4PpQm/GQDKgYo+LuVr+LNZ0J+NDdvbFfLRhV5NX
TvliSq3nfnfxSjQ/s8DdF+8StSVW2nOjPwfPQ3TK1VtFUpwWFl+d93vcr/uoh9yb
GJaFLbWVYjNu6EavWs/pqb+W7Qq5G7XTeE9Mdxq2KgE07ePuOwc=
=Tb3N
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_505b195d_20250114_195357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Freleases%2Ftag%2Fv2.4.13.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Freleases%2Ftag%2Fv2.4.13.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=OpenIDC%2Fmod_auth_openidc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenIDC](/OpenIDC)
/
**[mod\_auth\_openidc](/OpenIDC/mod_auth_openidc)**
Public

* [Notifications](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc) You must be signed in to change notification settings
* [Fork
  327](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)
* [Star
   1k](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)

* [Code](/OpenIDC/mod_auth_openidc/tree/v2.4.13.2)
* [Pull requests
  0](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

Additional navigation options

* [Code](/OpenIDC/mod_auth_openidc/tree/v2.4.13.2)
* [Pull requests](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

1. [Releases](/OpenIDC/mod_auth_openidc/releases)
2. [v2.4.13.2](/OpenIDC/mod_auth_openidc/releases/tag/v2.4.13.2)

# release 2.4.13.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OpenIDC/mod_auth_openidc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.4.13.2)

 Loading

[View all tags](/OpenIDC/mod_auth_openidc/tags)

![@zandbelt](https://avatars.githubusercontent.com/u/2339879?s=40&v=4)
[zandbelt](/zandbelt)
released this
03 Apr 09:36

Â·
[403 commits](/OpenIDC/mod_auth_openidc/compare/v2.4.13.2...master)
to master
since this release

[v2.4.13.2](/OpenIDC/mod_auth_openidc/tree/v2.4.13.2)

[`3f11976`](/OpenIDC/mod_auth_openidc/commit/3f11976dab56af0a46a7dddb7a275cc16d6eb726)

**Security**

* CVE-2023-28625: prevent core dump when `OIDCStripCookies` is set and a crafted `Cookie` header is supplied

  [GHSA-f5xw-rvfr-24qr](https://github.com/OpenIDC/mod_auth_openidc/security/advisories/GHSA-f5xw-rvfr-24qr "GHSA-f5xw-rvfr-24qr")
* fix code scanning alerts from 2 code scanning tools all over the place

**Features**

* add support for Elliptic Curve signing/encryption keys in addtiion to RSA keys,

  i.e. client keys configured in `OIDCPrivateKeyFiles`/`OIDCPublicKeyFiles`, published on `OIDCClientJwksUri`

  and used in `private_key_jwt` authentication, encrypted `id_token`'s, request objects/uri's,

  but also statically configured provider keys in `OIDCOAuthVerifyCertFiles` and `OIDCProviderVerifyCertFiles`
* record authorization errors in environment variable `OIDC_AUTHZ_ERROR`

  so its value can be used in logs e.g. with HTTP 401 responses in the access log:

   `LogFormat "%h %l %u %t %U %401{OIDC_AUTHZ_ERROR}e %>s %b" combined`

  also log authorization errors with `oidc_debug` instead of `oidc_info`

**Bugfixes**

* fix for omitting the `kid#` prefix in `OIDCPublicKeyFiles`/`OIDCPrivateKeyFiles` and other certificate configuration primitives when linked against OpenSSL <= 1.0.x
* allow `target_link_uri`'s without a path in 3rd-party-init SSO with a multi-provider setup
* correct cookie path printout in error log when `target_link_uri` does not match `OIDCCookiePath`

**Commercial**

* binary packages for various other platforms such as Microsoft Windows 64bit/32bit, Red Hat Enterprise Linux 6, Red Hat Enterprise Linux 7/8 on Power PC (ppc64, ppc64le), Oracle Linux 6/7, older Ubuntu and Debian distro's, Oracle HTTP Server 11.1/12.1/12.2, IBM HTTP Server 8/9, Solaris 11.4, IBM AIX 7.2 and Mac OS X are available under a commercial agreement via sales@openidc.com
* support for Redis over TLS, Redis (TLS) Sentinel, and Redis (TLS) Cluster is available under a commercial license via sales@openidc.com

 Assets
11

 Loading

All reactions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_c61ce6e8_20250114_195357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fsecurity%2Fadvisories%2FGHSA-f5xw-rvfr-24qr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fsecurity%2Fadvisories%2FGHSA-f5xw-rvfr-24qr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=OpenIDC%2Fmod_auth_openidc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenIDC](/OpenIDC)
/
**[mod\_auth\_openidc](/OpenIDC/mod_auth_openidc)**
Public

* [Notifications](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc) You must be signed in to change notification settings
* [Fork
  327](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)
* [Star
   1k](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests
  0](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

Additional navigation options

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

# segfault DoS when OIDCStripCookies is set

Moderate

[zandbelt](/zandbelt)
published
GHSA-f5xw-rvfr-24qr
Apr 3, 2023

## Package

mod\_auth\_openidc

## Affected versions

>=2.0.0 <=2.4.13.1

## Patched versions

>= 2.4.13.2

## Description

### Impact

When `OIDCStripCookies` is set and a crafted cookie supplied, a NULL pointer dereference would occur, resulting in a segmentation fault. This could be used in a Denial-of-Service attack and thus presents an availability risk.

### Patches

Upgrade to a version >= 2.4.13.2. The patch is recorded here:

<https://github.com/OpenIDC/mod_auth_openidc/blame/3f11976dab56af0a46a7dddb7a275cc16d6eb726/src/mod_auth_openidc.c#L178-L179>

### Workarounds

Avoid using `OIDCStripCookies`.

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

### CVE ID

CVE-2023-28625

### Weaknesses

No CWEs

### Credits

* [![@Amaury4sg](https://avatars.githubusercontent.com/u/108126388?s=40&v=4)](/Amaury4sg)
  [Amaury4sg](/Amaury4sg)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.debian.org_5282c400_20250114_195400.html ===


---

[[Date Prev](msg00095.html)][[Date Next](msg00097.html)]
[[Thread Prev](msg00095.html)][[Thread Next](msg00097.html)]
[[Date Index](maillist.html#00096)]
[[Thread Index](threads.html#00096)]

# [SECURITY] [DSA 5405-1] libapache2-mod-auth-openidc security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5405-1] libapache2-mod-auth-openidc security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 18 May 2023 13:12:35 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZGYkQ7a98XKCCs9m%40seger.debian.org)Â [ZGYkQ7a98XKCCs9m@seger.debian.org](msg00096.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5405-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
May 18, 2023                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libapache2-mod-auth-openidc
CVE ID         : CVE-2023-28625
Debian Bug     : 1033916

It was discovered that missing input sanitising in the implementation
of the OIDCStripCookie option in mod_auth_openidc could result in
denial of service.

For the stable distribution (bullseye), this problem has been fixed in
version 2.4.9.4-0+deb11u3.

We recommend that you upgrade your libapache2-mod-auth-openidc packages.

For the detailed security status of libapache2-mod-auth-openidc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libapache2-mod-auth-openidc>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmRmI/EACgkQEMKTtsN8
TjbcwQ//X8b4XxzVskGaPquONqmUjMN8ca0u/bEff7oguG9M+5MNDCWKY+8f6kyS
R7xd7zn2hXJJh5/+fiHcd+tuvE5stMBjATm0Y2f77GypHjoNwTa+G6JYKRhUGqul
b9CjiosjxtlmaSI2zsrnlVssckqqw56VdgCr7zZf8aw2yyxeZ0zeD81SujaScTm0
oqJ8Y5TQqrCzNldkmlSykZxjqQ6PPrpR/DrOXh5UB0i9YJqZWnz4ALib2rl4zJXt
VQhPkSbOEn1gUnN1ypj5IjP74EaLx3ezrMqzMPMmKlNKOerDcHLy04C1dpwg8lET
RFeT2JrFk9VYTriOjfbzTny55WubRZ3qQKCdoZWS8MwGcZfddt07iJ5746WOwmwp
mlJ/9WTVR4uX/Z2IldVdfCiSEEOAYk5hQSAV1BGnTQVAlfPQlN50YyDQAxH7D4hs
R5jBAbblsKyru9EnPrRIqNnYmoFbPoY1c+19LKGulCxtUyawH6gglkB3vq8+e9xv
yGSjyrTzSCxmkU+RpEExtU3qQiS2NV/MCwCMR5kVYRdGA5SVScSnOJzCR3SoCr8Q
WmhcCwWLqQCikuxtfmdSsYIHbIIG9XP1Lgwc4quGKD/f/JyySmW+odbIMdTjd61R
DmFRpb+kRRL54tuexl+xbMSgPhIKMljdetCuoBUZacgJVDpW1Jw=
=JOw9
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_a459a12c_20250114_195356.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fcommit%2Fc0e1edac3c4c19988ccdc7713d7aebfce6ff916a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fcommit%2Fc0e1edac3c4c19988ccdc7713d7aebfce6ff916a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OpenIDC%2Fmod_auth_openidc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenIDC](/OpenIDC)
/
**[mod\_auth\_openidc](/OpenIDC/mod_auth_openidc)**
Public

* [Notifications](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc) You must be signed in to change notification settings
* [Fork
  327](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)
* [Star
   1k](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests
  0](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

Additional navigation options

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

## Commit

[Permalink](/OpenIDC/mod_auth_openidc/commit/c0e1edac3c4c19988ccdc7713d7aebfce6ff916a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

2.4.13.2: prevent DoS core dump with OIDCStripCookies; CVE-2023-28625

[Browse files](/OpenIDC/mod_auth_openidc/tree/c0e1edac3c4c19988ccdc7713d7aebfce6ff916a)
Browse the repository at this point in the history

```
[GHSA-f5xw-rvfr-24qr](https://github.com/OpenIDC/mod_auth_openidc/security/advisories/GHSA-f5xw-rvfr-24qr "GHSA-f5xw-rvfr-24qr")

Signed-off-by: Hans Zandbelt <hans.zandbelt@openidc.com>
```

* Loading branch information

[![@zandbelt](https://avatars.githubusercontent.com/u/2339879?s=40&v=4)](/zandbelt)

[zandbelt](/OpenIDC/mod_auth_openidc/commits?author=zandbelt "View all commits by zandbelt")
committed
Mar 28, 2023

1 parent
[00b9b8a](/OpenIDC/mod_auth_openidc/commit/00b9b8a135e10361266e254847ac090ab5a3ddb0)

commit c0e1eda

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**7 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* ChangeLog
  [ChangeLog](#diff-91c5b46dc84a94604a4e4d0caed9bf85590a2eddbb12d2e8dc80badf324a9dfb)
* configure.ac
  [configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[ChangeLog](#diff-91c5b46dc84a94604a4e4d0caed9bf85590a2eddbb12d2e8dc80badf324a9dfb "ChangeLog")

Show comments

[View file](/OpenIDC/mod_auth_openidc/blob/c0e1edac3c4c19988ccdc7713d7aebfce6ff916a/ChangeLog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,10 @@ |
|  |  | 03/28/2023 |
|  |  | - CVE-2023-28625: prevent core dump when OIDCStripCookies is set and a crafted Cookie header is supplied |
|  |  | https://github.com/OpenIDC/mod\_auth\_openidc/security/advisories/GHSA-f5xw-rvfr-24qr |
|  |  | - release 2.4.13.2 |
|  |  |  |
|  |  | 03/27/2023 |
|  |  | - fix code scanning alerts: |
|  |  | - fix code scanning alerts |
|  |  | - bump to 2.4.13.2rc2 |
|  |  |  |
|  |  | 03/24/2023 |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/OpenIDC/mod_auth_openidc/blob/c0e1edac3c4c19988ccdc7713d7aebfce6ff916a/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | AC\_INIT([mod\_auth\_openidc],[2.4.13.2rc2],[hans.zandbelt@openidc.com]) |
|  |  | AC\_INIT([mod\_auth\_openidc],[2.4.13.2],[hans.zandbelt@openidc.com]) |
|  |  |  |
|  |  | AC\_SUBST(NAMEVER, AC\_PACKAGE\_TARNAME()-AC\_PACKAGE\_VERSION()) |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c0e1eda`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fcommit%2Fc0e1edac3c4c19988ccdc7713d7aebfce6ff916a) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_70b6e206_20250114_195354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fblame%2F3f11976dab56af0a46a7dddb7a275cc16d6eb726%2Fsrc%2Fmod_auth_openidc.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenIDC%2Fmod_auth_openidc%2Fblame%2F3f11976dab56af0a46a7dddb7a275cc16d6eb726%2Fsrc%2Fmod_auth_openidc.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fblame&source=header-repo&source_repo=OpenIDC%2Fmod_auth_openidc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenIDC](/OpenIDC)
/
**[mod\_auth\_openidc](/OpenIDC/mod_auth_openidc)**
Public

* [Notifications](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc) You must be signed in to change notification settings
* [Fork
  327](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)
* [Star
   1k](/login?return_to=%2FOpenIDC%2Fmod_auth_openidc)

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests
  0](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

Additional navigation options

* [Code](/OpenIDC/mod_auth_openidc)
* [Pull requests](/OpenIDC/mod_auth_openidc/pulls)
* [Discussions](/OpenIDC/mod_auth_openidc/discussions)
* [Actions](/OpenIDC/mod_auth_openidc/actions)
* [Wiki](/OpenIDC/mod_auth_openidc/wiki)
* [Security](/OpenIDC/mod_auth_openidc/security)
* [Insights](/OpenIDC/mod_auth_openidc/pulse)

## Files

Â 3f11976
## Breadcrumbs

1. [mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/tree/3f11976dab56af0a46a7dddb7a275cc16d6eb726)
2. /[src](/OpenIDC/mod_auth_openidc/tree/3f11976dab56af0a46a7dddb7a275cc16d6eb726/src)
/
# mod\_auth\_openidc.c

Copy path Blame  Blame
## Latest commit

## History

[History](/OpenIDC/mod_auth_openidc/commits/3f11976dab56af0a46a7dddb7a275cc16d6eb726/src/mod_auth_openidc.c)4405 lines (3625 loc) Â· 149 KBÂ 3f11976
## Breadcrumbs

1. [mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/tree/3f11976dab56af0a46a7dddb7a275cc16d6eb726)
2. /[src](/OpenIDC/mod_auth_openidc/tree/3f11976dab56af0a46a7dddb7a275cc16d6eb726/src)
/
# mod\_auth\_openidc.c

Top
## File metadata and controls

* Code
* Blame

4405 lines (3625 loc) Â· 149 KB[Raw](https://github.com/OpenIDC/mod_auth_openidc/raw/3f11976dab56af0a46a7dddb7a275cc16d6eb726/src/mod_auth_openidc.c)OlderNewerÂ Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 20141234567891011121314151617181920/\* \* Licensed to the Apache Software Foundation (ASF) under one \* or more contributor license agreements. See the NOTICE file \* distributed with this work for additional information \* regarding copyright ownership. The ASF licenses this file \* to you under the Apache License, Version 2.0 (the \* "License"); you may not use this file except in compliance \* with the License. You may obtain a copy of the License at \* \* http://www.apache.org/licenses/LICENSE-2.0 \* \* Unless required by applicable law or agreed to in writing, \* software distributed under the License is distributed on an \* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY \* KIND, either express or implied. See the License for the \* specific language governing permissions and limitations \* under the License. \*/
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*Jan 2, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[update copyright year](/OpenIDC/mod_auth_openidc/commit/6ae0fc99e5869e7d0753a4c882200d089602e6ed)Jan 2, 2023Blame prior to change 6ae0fc9, made on Jan 2, 202321 \* Copyright (C) 2017-2023 ZmartZone Holding BVJan 2, 2017[bump copyright year to 2017](/OpenIDC/mod_auth_openidc/commit/4ce50f8104a1150f96f0972c359b647f03fcfb43)Jan 2, 2017Blame prior to change 4ce50f8, made on Jan 2, 201722 \* Copyright (C) 2013-2017 Ping Identity CorporationMar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014232425262728293031323334353637383940414243444546 \* All rights reserved. \* \* DISCLAIMER OF WARRANTIES: \* \* THE SOFTWARE PROVIDED HEREUNDER IS PROVIDED ON AN "AS IS" BASIS, WITHOUT \* ANY WARRANTIES OR REPRESENTATIONS EXPRESS, IMPLIED OR STATUTORY; INCLUDING, \* WITHOUT LIMITATION, WARRANTIES OF QUALITY, PERFORMANCE, NONINFRINGEMENT, \* MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. NOR ARE THERE ANY \* WARRANTIES CREATED BY A COURSE OR DEALING, COURSE OF PERFORMANCE OR TRADE \* USAGE. FURTHERMORE, THERE ARE NO WARRANTIES THAT THE SOFTWARE WILL MEET \* YOUR NEEDS OR BE FREE FROM ERRORS, OR THAT THE OPERATION OF THE SOFTWARE \* WILL BE UNINTERRUPTED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR \* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, \* EXEMPLARY, OR CONSEQUENTIAL DAMAGES HOWEVER CAUSED AND ON ANY THEORY OF \* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING \* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS \* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. \* \* Initially based on mod\_auth\_cas.c: \* https://github.com/Jasig/mod\_auth\_cas \* \* Other code copied/borrowed/adapted: \* shared memory caching: mod\_auth\_mellon \*Jan 2, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[update references to openidc.com](/OpenIDC/mod_auth_openidc/commit/3a5bb8cff91a88639c42337222de01868c749210)Jan 2, 2023Blame prior to change 3a5bb8c, made on Jan 2, 202347 \* @Author: Hans Zandbelt - hans.zandbelt@openidc.comMar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014484950 \* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/
Oct 21, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[complete usage of autoconf/automake, see #674](/OpenIDC/mod_auth_openidc/commit/73c629b97ed9a9ef37428ec2aff180b2dcaf072b)Oct 21, 2021Blame prior to change 73c629b, made on Oct 21, 202151#include "mod\_auth\_openidc.h"Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 201452
Jul 30, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix doubled Set-Cookie behaviour when using `client-cookie`](/OpenIDC/mod_auth_openidc/commit/f37193045fbf1b2e94ff1272bc89e8e6156f47ea)Jul 30, 2020Blame prior to change f371930, made on Jul 30, 202053#define OIDC\_REFRESH\_ERROR 2Aug 9, 2019![](https://avatars.githubusercontent.com/u/1576140?s=80&v=4)[Add logout\_on\_error to OIDCRefreshAccessTokenBeforeExpiry](/OpenIDC/mod_auth_openidc/commit/772bbd17d529571c38076add389984eece5b5e97)Aug 9, 2019Blame prior to change 772bbd1, made on Aug 9, 201954555657
static int oidc\_handle\_logout\_request(request\_rec \*r, oidc\_cfg \*c, oidc\_session\_t \*session, const char \*url);
Feb 16, 2015[refactor response type handling; strictly match requested response type](/OpenIDC/mod_auth_openidc/commit/764f3940c41cb8197be7baac1317a01ea94674cf)Feb 16, 2015Blame prior to change 764f394, made on Feb 16, 2015585960616263// TODO:// - sort out oidc\_cfg vs. oidc\_dir\_cfg stuff// - rigid input checking on discovery responses// - check self-issued support// - README.quickstart// - refresh metadata once-per too? (for non-signing key changes)Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014646566676869
extern module AP\_MODULE\_DECLARE\_DATA auth\_openidc\_module;
/\* \* clean any suspicious headers in the HTTP request sent by the user agent \*/Jul 12, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use string defines for configuration directives](/OpenIDC/mod_auth_openidc/commit/4ca572779554d7465736f67c84181ea25d7b0f77)Jul 12, 2017Blame prior to change 4ca5727, made on Jul 12, 20177071static void oidc\_scrub\_request\_headers(request\_rec \*r, const char \*claim\_prefix, apr\_hash\_t \*scrub) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 201472
Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 202373 const int prefix\_len = claim\_prefix ? \_oidc\_strlen(claim\_prefix) : 0;Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 20147475
 /\* get an array representation of the incoming HTTP headers \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 202176 const apr\_array\_header\_t \*const h = apr\_table\_elts(r->headers\_in);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 20147778798081
 /\* table to keep the non-suspicious headers \*/ apr\_table\_t \*clean\_headers = apr\_table\_make(r->pool, h->nelts);
 /\* loop over the incoming HTTP headers \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 202182 const apr\_table\_entry\_t \*const e = (const apr\_table\_entry\_t\*) h->elts;Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 20148384 int i; for (i = 0; i < h->nelts; i++) {Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 202185 const char \*const k = e[i].key;Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 201486
May 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add support for an empty OIDCClaimPrefix; see #264](/OpenIDC/mod_auth_openidc/commit/fd208e65b6004f033994281a45942da91834e773)May 30, 2017Blame prior to change fd208e6, made on May 30, 2017878889909192 /\* is this header's name equivalent to a header that needs scrubbing? \*/ const char \*hdr = (k != NULL) && (scrub != NULL) ? apr\_hash\_get(scrub, k, APR\_HASH\_KEY\_STRING) : NULL; const int header\_matches = (hdr != NULL) && (oidc\_strnenvcmp(k, hdr, -1) == 0);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 201493949596979899100101102103104
 /\* \* would this header be interpreted as a mod\_auth\_openidc attribute? Note \* that prefix\_len will be zero if no attr\_prefix is defined, \* so this will always be false. Also note that we do not \* scrub headers if the prefix is empty because every header \* would match. \*/ const int prefix\_matches = (k != NULL) && prefix\_len && (oidc\_strnenvcmp(k, claim\_prefix, prefix\_len) == 0);
 /\* add to the clean\_headers if non-suspicious, skip and report otherwise \*/May 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add support for an empty OIDCClaimPrefix; see #264](/OpenIDC/mod_auth_openidc/commit/fd208e65b6004f033994281a45942da91834e773)May 30, 2017Blame prior to change fd208e6, made on May 30, 2017105 if (!prefix\_matches && !header\_matches) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014106107 apr\_table\_addn(clean\_headers, k, e[i].val); } else {Sep 17, 2014[use log macros that include function names](/OpenIDC/mod_auth_openidc/commit/3265fa0745d55e6d11c62d0074cac4eb1b66c000)Sep 17, 2014Blame prior to change 3265fa0, made on Sep 17, 2014108109 oidc\_warn(r, "scrubbed suspicious request header (%s: %.32s)", k, e[i].val);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014110111112113114115116 } }
 /\* overwrite the incoming headers with the cleaned result \*/ r->headers\_in = clean\_headers;}
Jan 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[security fix: scrub headers on `OIDCUnAuthAction pass`; closes #222](/OpenIDC/mod_auth_openidc/commit/e81822a7d5f5bdf04ba03ca92680821893303850)Jan 30, 2017Blame prior to change e81822a, made on Jan 30, 2017117118119/\* \* scrub all mod\_auth\_openidc related headers \*/Feb 20, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[release 2.1.6 : security fix: scrub headers for "AuthType oauth20"](/OpenIDC/mod_auth_openidc/commit/21e3728a825c41ab41efa75e664108051bb9665e)Feb 20, 2017Blame prior to change 21e3728, made on Feb 20, 2017120void oidc\_scrub\_headers(request\_rec \*r) {Jan 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[security fix: scrub headers on `OIDCUnAuthAction pass`; closes #222](/OpenIDC/mod_auth_openidc/commit/e81822a7d5f5bdf04ba03ca92680821893303850)Jan 30, 2017Blame prior to change e81822a, made on Jan 30, 2017121122123 oidc\_cfg \*cfg = ap\_get\_module\_config(r->server->module\_config, &auth\_openidc\_module);
Apr 21, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[remove option to skip scrubbing request headers](/OpenIDC/mod_auth_openidc/commit/3ed326648d2584c25983bcfa3a7821cf3b40c8f6)Apr 21, 2019Blame prior to change 3ed3266, made on Apr 21, 2019124125126 const char \*prefix = oidc\_cfg\_claim\_prefix(r); apr\_hash\_t \*hdrs = apr\_hash\_make(r->pool);
Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023127 if (\_oidc\_strcmp(prefix, "") == 0) {Apr 21, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[remove option to skip scrubbing request headers](/OpenIDC/mod_auth_openidc/commit/3ed326648d2584c25983bcfa3a7821cf3b40c8f6)Apr 21, 2019Blame prior to change 3ed3266, made on Apr 21, 2019128129 if ((cfg->white\_listed\_claims != NULL) && (apr\_hash\_count(cfg->white\_listed\_claims) > 0))May 17, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add client authentication to the revocation endpoint](/OpenIDC/mod_auth_openidc/commit/93fc5148a068e2c743f486d7bbb2789d06d8ad93)May 17, 2019Blame prior to change 93fc514, made on May 17, 2019130 hdrs = apr\_hash\_overlay(r->pool, cfg->white\_listed\_claims, hdrs);Apr 21, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[remove option to skip scrubbing request headers](/OpenIDC/mod_auth_openidc/commit/3ed326648d2584c25983bcfa3a7821cf3b40c8f6)Apr 21, 2019Blame prior to change 3ed3266, made on Apr 21, 2019131132133134 else oidc\_warn(r, "both " OIDCClaimPrefix " and " OIDCWhiteListedClaims " are empty: this renders an insecure setup!"); }Jan 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[security fix: scrub headers on `OIDCUnAuthAction pass`; closes #222](/OpenIDC/mod_auth_openidc/commit/e81822a7d5f5bdf04ba03ca92680821893303850)Jan 30, 2017Blame prior to change e81822a, made on Jan 30, 2017135
Apr 21, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[remove option to skip scrubbing request headers](/OpenIDC/mod_auth_openidc/commit/3ed326648d2584c25983bcfa3a7821cf3b40c8f6)Apr 21, 2019Blame prior to change 3ed3266, made on Apr 21, 2019136137138139140141142143144145146147148149150 char \*authn\_hdr = oidc\_cfg\_dir\_authn\_header(r); if (authn\_hdr != NULL) apr\_hash\_set(hdrs, authn\_hdr, APR\_HASH\_KEY\_STRING, authn\_hdr);
 /\* \* scrub all headers starting with OIDC\_ first \*/ oidc\_scrub\_request\_headers(r, OIDC\_DEFAULT\_HEADER\_PREFIX, hdrs);
 /\* \* then see if the claim headers need to be removed on top of that \* (i.e. the prefix does not start with the default OIDC\_) \*/ if ((strstr(prefix, OIDC\_DEFAULT\_HEADER\_PREFIX) != prefix)) { oidc\_scrub\_request\_headers(r, prefix, NULL);Jan 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[security fix: scrub headers on `OIDCUnAuthAction pass`; closes #222](/OpenIDC/mod_auth_openidc/commit/e81822a7d5f5bdf04ba03ca92680821893303850)Jan 30, 2017Blame prior to change e81822a, made on Jan 30, 2017151152153 }}
Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016154155156/\* \* strip the session cookie from the headers sent to the application/backend \*/May 19, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make OIDCStripCookies work on AuthType oauth20 paths; closes #273](/OpenIDC/mod_auth_openidc/commit/f495eee8fb1d44ce0c4a59dbbb6f93b063e7957d)May 19, 2017Blame prior to change f495eee, made on May 19, 2017157void oidc\_strip\_cookies(request\_rec \*r) {Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016158159160161162163164
 char \*cookie, \*ctx, \*result = NULL; const char \*name = NULL; int i;
 apr\_array\_header\_t \*strip = oidc\_dir\_cfg\_strip\_cookies(r);
Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor header calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/738a94ecf28bf8f3cacca56671a897d2defb2dd7)Feb 21, 2017Blame prior to change 738a94e, made on Feb 21, 2017165 char \*cookies = apr\_pstrdup(r->pool, oidc\_util\_hdr\_in\_cookie\_get(r));Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016166167168169170
 if ((cookies != NULL) && (strip != NULL)) {
 oidc\_debug(r, "looking for the following cookies to strip from cookie header: %s",Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017171 apr\_array\_pstrcat(r->pool, strip, OIDC\_CHAR\_COMMA));Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016172
Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017173 cookie = apr\_strtok(cookies, OIDC\_STR\_SEMI\_COLON, &ctx);Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016174175
 do {Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017176 while (cookie != NULL && \*cookie == OIDC\_CHAR\_SPACE)Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016177 cookie++;Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023178179 if (cookie == NULL) break;Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016180181182
 for (i = 0; i < strip->nelts; i++) { name = ((const char\*\*) strip->elts)[i];Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023183 if ((\_oidc\_strncmp(cookie, name, \_oidc\_strlen(name)) == 0)Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023184 && (cookie[\_oidc\_strlen(name)] == OIDC\_CHAR\_EQUAL)) {Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016185186187188189190 oidc\_debug(r, "stripping: %s", name); break; } }
 if (i == strip->nelts) {May 1, 2020![](https://avatars.githubusercontent.com/u/395621?s=80&v=4)[Add space after cookie-pair;](/OpenIDC/mod_auth_openidc/commit/d8d3bd58b38c708587101620760fb80b31dcabd7)May 1, 2020Blame prior to change d8d3bd5, made on May 1, 2020191 result = result ? apr\_psprintf(r->pool, "%s%s %s", result,Aug 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make](/OpenIDC/mod_auth_openidc/commit/96a27f502a159d498b6dfc5a141feb119c2b68bb) [#292](https://github.com/OpenIDC/mod_auth_openidc/pull/292) [backwards compatible again](/OpenIDC/mod_auth_openidc/commit/96a27f502a159d498b6dfc5a141feb119c2b68bb)Aug 29, 2017Blame prior to change 96a27f5, made on Aug 29, 2017192193 OIDC\_STR\_SEMI\_COLON, cookie) : cookie;Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016194195 }
Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017196 cookie = apr\_strtok(NULL, OIDC\_STR\_SEMI\_COLON, &ctx);Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016197198 } while (cookie != NULL);
Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor header calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/738a94ecf28bf8f3cacca56671a897d2defb2dd7)Feb 21, 2017Blame prior to change 738a94e, made on Feb 21, 2017199 oidc\_util\_hdr\_in\_cookie\_set(r, result);Sep 9, 2016[allow stripping cookies to the application/backend with OIDCStripCookies](/OpenIDC/mod_auth_openidc/commit/7132bf09506f73ec0c9a21a94f3fd4089f3c36de)Sep 9, 2016Blame prior to change 7132bf0, made on Sep 9, 2016200201202 }}
Jul 3, 2015[release 1.8.4: compile with MS VS 2013](/OpenIDC/mod_auth_openidc/commit/5b24dbf7adad8f2f353a7b5aa3456a5ab4a70983)Jul 3, 2015Blame prior to change 5b24dbf, made on Jul 3, 2015203204#define OIDC\_SHA1\_LEN 20
Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014205/\*Apr 28, 2014[support configurable response\_mode, including "form\_post"](/OpenIDC/mod_auth_openidc/commit/d584f73c33b6a5adcebf35745c3d382625fb188c)Apr 28, 2014Blame prior to change d584f73, made on Apr 28, 2014206 \* calculates a hash value based on request fingerprint plus a provided nonce string.Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014207 \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021208static char\* oidc\_get\_browser\_state\_hash(request\_rec \*r, oidc\_cfg \*c,Jun 10, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[prevent open redirect on refresh token requests; release 2.4.3](/OpenIDC/mod_auth_openidc/commit/8ea550f34ce51d8d41ba47843739c964407fa0ad)Jun 10, 2020Blame prior to change 8ea550f, made on Jun 10, 2020209 const char \*nonce) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014210
Sep 17, 2014[use log macros that include function names](/OpenIDC/mod_auth_openidc/commit/3265fa0745d55e6d11c62d0074cac4eb1b66c000)Sep 17, 2014Blame prior to change 3265fa0, made on Sep 17, 2014211 oidc\_debug(r, "enter");Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014212213214215216217218219220
 /\* helper to hold to header values \*/ const char \*value = NULL; /\* the hash context \*/ apr\_sha1\_ctx\_t sha1;
 /\* Initialize the hash context \*/ apr\_sha1\_init(&sha1);
Apr 25, 2020![](https://avatars.githubusercontent.com/u/28739?s=80&v=4)[Allow configuring which header value is used to calculate the](/OpenIDC/mod_auth_openidc/commit/2a97eced569ebbff82fc0370c4f741d04ba7cb13)Apr 25, 2020Blame prior to change 2a97ece, made on Apr 25, 2020221222223224225 if (c->state\_input\_headers & OIDC\_STATE\_INPUT\_HEADERS\_X\_FORWARDED\_FOR) { /\* get the X-FORWARDED-FOR header value \*/ value = oidc\_util\_hdr\_in\_x\_forwarded\_for\_get(r); /\* if we have a value for this header, concat it to the hash input \*/ if (value != NULL)Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023226 apr\_sha1\_update(&sha1, value, \_oidc\_strlen(value));Apr 25, 2020![](https://avatars.githubusercontent.com/u/28739?s=80&v=4)[Allow configuring which header value is used to calculate the](/OpenIDC/mod_auth_openidc/commit/2a97eced569ebbff82fc0370c4f741d04ba7cb13)Apr 25, 2020Blame prior to change 2a97ece, made on Apr 25, 2020227 }Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014228
Apr 25, 2020![](https://avatars.githubusercontent.com/u/28739?s=80&v=4)[Allow configuring which header value is used to calculate the](/OpenIDC/mod_auth_openidc/commit/2a97eced569ebbff82fc0370c4f741d04ba7cb13)Apr 25, 2020Blame prior to change 2a97ece, made on Apr 25, 2020229230231232233 if (c->state\_input\_headers & OIDC\_STATE\_INPUT\_HEADERS\_USER\_AGENT) { /\* get the USER-AGENT header value \*/ value = oidc\_util\_hdr\_in\_user\_agent\_get(r); /\* if we have a value for this header, concat it to the hash input \*/ if (value != NULL)Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023234 apr\_sha1\_update(&sha1, value, \_oidc\_strlen(value));Apr 25, 2020![](https://avatars.githubusercontent.com/u/28739?s=80&v=4)[Allow configuring which header value is used to calculate the](/OpenIDC/mod_auth_openidc/commit/2a97eced569ebbff82fc0370c4f741d04ba7cb13)Apr 25, 2020Blame prior to change 2a97ece, made on Apr 25, 2020235 }Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014236237
 /\* get the remote client IP address or host name \*/May 2, 2014[do not use ap\_get\_remote\_host for browser fingerprinting](/OpenIDC/mod_auth_openidc/commit/93bcc37959a6c4d67a94599d65ffeedc1210df83)May 2, 2014Blame prior to change 93bcc37, made on May 2, 2014238 /\*Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021239240241 int remotehost\_is\_ip; value = ap\_get\_remote\_host(r->connection, r->per\_dir\_config, REMOTE\_NOLOOKUP, &remotehost\_is\_ip);Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023242 apr\_sha1\_update(&sha1, value, \_oidc\_strlen(value));Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021243 \*/Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014244
Apr 28, 2014[support configurable response\_mode, including "form\_post"](/OpenIDC/mod_auth_openidc/commit/d584f73c33b6a5adcebf35745c3d382625fb188c)Apr 28, 2014Blame prior to change d584f73, made on Apr 28, 2014245 /\* concat the nonce parameter to the hash input \*/Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023246 apr\_sha1\_update(&sha1, nonce, \_oidc\_strlen(nonce));Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014247
Mar 23, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add token binding support for state and session cookies](/OpenIDC/mod_auth_openidc/commit/6b1ce7914c7faebc3c7f9e549e8baa9dbb9c1305)Mar 23, 2017Blame prior to change 6b1ce79, made on Mar 23, 2017248 /\* concat the token binding ID if present \*/Mar 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor token binding ID access into util function](/OpenIDC/mod_auth_openidc/commit/a7ad3f91e33bbc27eab5747cdeacc666dd85aeba)Mar 30, 2017Blame prior to change a7ad3f9, made on Mar 30, 2017249 value = oidc\_util\_get\_provided\_token\_binding\_id(r);Mar 23, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add token binding support for state and session cookies](/OpenIDC/mod_auth_openidc/commit/6b1ce7914c7faebc3c7f9e549e8baa9dbb9c1305)Mar 23, 2017Blame prior to change 6b1ce79, made on Mar 23, 2017250251 if (value != NULL) { oidc\_debug(r,Mar 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor token binding ID access into util function](/OpenIDC/mod_auth_openidc/commit/a7ad3f91e33bbc27eab5747cdeacc666dd85aeba)Mar 30, 2017Blame prior to change a7ad3f9, made on Mar 30, 2017252 "Provided Token Binding ID environment variable found; adding its value to the state");Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023253 apr\_sha1\_update(&sha1, value, \_oidc\_strlen(value));Mar 23, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add token binding support for state and session cookies](/OpenIDC/mod_auth_openidc/commit/6b1ce7914c7faebc3c7f9e549e8baa9dbb9c1305)Mar 23, 2017Blame prior to change 6b1ce79, made on Mar 23, 2017254255 }
Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014256 /\* finalize the hash input and calculate the resulting hash output \*/Jul 3, 2015[release 1.8.4: compile with MS VS 2013](/OpenIDC/mod_auth_openidc/commit/5b24dbf7adad8f2f353a7b5aa3456a5ab4a70983)Jul 3, 2015Blame prior to change 5b24dbf, made on Jul 3, 2015257 unsigned char hash[OIDC\_SHA1\_LEN];Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014258259 apr\_sha1\_final(hash, &sha1);
Sep 3, 2014[switch to base64url encoding instead of base64 for state cookie name](/OpenIDC/mod_auth_openidc/commit/47077da2e935fe85dd4b2fdfb1f883b1950ca3cc)Sep 3, 2014Blame prior to change 47077da, made on Sep 3, 2014260261 /\* base64url-encode the resulting hash and return it \*/ char \*result = NULL;Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021262 oidc\_base64url\_encode(r, &result, (const char\*) hash, OIDC\_SHA1\_LEN, TRUE);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014263264265 return result;}
Sep 1, 2014[add session management based on](/OpenIDC/mod_auth_openidc/commit/a4da1daf6d9b925184d3f73e2f58747bbff8ae59)Sep 1, 2014Blame prior to change a4da1da, made on Sep 1, 2014266267268/\* \* return the name for the state cookie \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021269static char\* oidc\_get\_state\_cookie\_name(request\_rec \*r, const char \*state) {Sep 3, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add SameSite attribute on cookie clearance / logout](/OpenIDC/mod_auth_openidc/commit/314000d179c2d08af6897725f37980e1f0891aa6)Sep 3, 2020Blame prior to change 314000d, made on Sep 3, 2020270271 return apr\_psprintf(r->pool, "%s%s", oidc\_cfg\_dir\_state\_cookie\_prefix(r), state);Sep 1, 2014[add session management based on](/OpenIDC/mod_auth_openidc/commit/a4da1daf6d9b925184d3f73e2f58747bbff8ae59)Sep 1, 2014Blame prior to change a4da1da, made on Sep 1, 2014272273}
Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014274275276/\* \* return the static provider configuration, i.e. from a metadata URL or configuration primitives \*/Oct 30, 2014[correct expires\_in conversion; HTML 4.01 Strict templating](/OpenIDC/mod_auth_openidc/commit/09ed7a540d4f74a85e9a4c93a63da9c4c30cccab)Oct 30, 2014Blame prior to change 09ed7a5, made on Oct 30, 2014277278static apr\_byte\_t oidc\_provider\_static\_config(request\_rec \*r, oidc\_cfg \*c, oidc\_provider\_t \*\*provider) {Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014279280
 json\_t \*j\_provider = NULL;Feb 27, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add encryption for all caches/entries instead of just session data](/OpenIDC/mod_auth_openidc/commit/7d47a76f2cc3918ca2d759a2a2a402b03f7bb13a)Feb 27, 2017Blame prior to change 7d47a76, made on Feb 27, 2017281 char \*s\_json = NULL;Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014282283
 /\* see if we should configure a static provider based on external (cached) metadata \*/Oct 2, 2014[1.6.0rc3: improve OIDCMetadataURL handling](/OpenIDC/mod_auth_openidc/commit/9c0b7b549c95ab2405956c4985b58a70d5b7c4b8)Oct 2, 2014Blame prior to change 9c0b7b5, made on Oct 2, 2014284285286287 if ((c->metadata\_dir != NULL) || (c->provider.metadata\_url == NULL)) { \*provider = &c->provider; return TRUE; }Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014288
Jun 7, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[also no longer escape provider get as it is done in the backend now](/OpenIDC/mod_auth_openidc/commit/493c778ff2d69e8b37c742a59f95e736ecc90f41)Jun 7, 2017Blame prior to change 493c778, made on Jun 7, 2017289 oidc\_cache\_get\_provider(r, c->provider.metadata\_url, &s\_json);Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014290291292293294295296
 if (s\_json == NULL) {
 if (oidc\_metadata\_provider\_retrieve(r, c, NULL, c->provider.metadata\_url, &j\_provider, &s\_json) == FALSE) { oidc\_error(r, "could not retrieve metadata from url: %s", c->provider.metadata\_url);Oct 2, 2014[1.6.0rc3: improve OIDCMetadataURL handling](/OpenIDC/mod_auth_openidc/commit/9c0b7b549c95ab2405956c4985b58a70d5b7c4b8)Oct 2, 2014Blame prior to change 9c0b7b5, made on Oct 2, 2014297 return FALSE;Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014298299 }
Jun 7, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix file-based caching of non-filename friendly keys; bump to 2.3.0rc3](/OpenIDC/mod_auth_openidc/commit/fe45101c4ee8a3398aeb1be2cde0cb226eb1a824)Jun 7, 2017Blame prior to change fe45101, made on Jun 7, 2017300 oidc\_cache\_set\_provider(r, c->provider.metadata\_url, s\_json,Oct 26, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix OIDCProviderMetadataRefreshInterval setting in seconds](/OpenIDC/mod_auth_openidc/commit/5533e5edf5d879404ce98f2e60fcc71a270d5b68)Oct 26, 2022Blame prior to change 5533e5e, made on Oct 26, 2022301 apr\_time\_now() + apr\_time\_from\_sec(c->provider\_metadata\_refresh\_interval <= 0 ? OIDC\_CACHE\_PROVIDER\_METADATA\_EXPIRY\_DEFAULT : c->provider\_metadata\_refresh\_interval));Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014302303304
 } else {
Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use oidc\_util\_decode\_json\_object where possible instead of json\_loads](/OpenIDC/mod_auth_openidc/commit/dc56d7d72a4e822c52bc300b26c7d14225af69ae)Feb 21, 2017Blame prior to change dc56d7d, made on Feb 21, 2017305 oidc\_util\_decode\_json\_object(r, s\_json, &j\_provider);Jun 15, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check to detect (stqtic) metadata cache corruption](/OpenIDC/mod_auth_openidc/commit/de58759f6ebb0ac8130a5588873752d95b7ca496)Jun 15, 2018Blame prior to change de58759, made on Jun 15, 2018306307308309310311312313
 /\* check to see if it is valid metadata \*/ if (oidc\_metadata\_provider\_is\_valid(r, c, j\_provider, NULL) == FALSE) { oidc\_error(r, "cache corruption detected: invalid metadata from url: %s", c->provider.metadata\_url); return FALSE; }Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014314315 }
Mar 10, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use deep-copy and cleanup functions for server and provider configs](/OpenIDC/mod_auth_openidc/commit/484f4358c302623ed63dedc7bbe810d7f6bd0f62)Mar 10, 2023Blame prior to change 484f435, made on Mar 10, 2023316 \*provider = oidc\_cfg\_provider\_copy(r->pool, &c->provider);Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014317
Oct 27, 2016[use private\_key\_jwt only if a private key is configured; closes #189](/OpenIDC/mod_auth_openidc/commit/3ee2ffb2ce4aef9840882d3dc2252110ae05d591)Oct 27, 2016Blame prior to change 3ee2ffb, made on Oct 27, 2016318 if (oidc\_metadata\_provider\_parse(r, c, j\_provider, \*provider) == FALSE) {Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014319320321322 oidc\_error(r, "could not parse metadata from url: %s", c->provider.metadata\_url); if (j\_provider) json\_decref(j\_provider);Oct 2, 2014[1.6.0rc3: improve OIDCMetadataURL handling](/OpenIDC/mod_auth_openidc/commit/9c0b7b549c95ab2405956c4985b58a70d5b7c4b8)Oct 2, 2014Blame prior to change 9c0b7b5, made on Oct 2, 2014323 return FALSE;Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014324325326327 }
 json\_decref(j\_provider);
Oct 2, 2014[1.6.0rc3: improve OIDCMetadataURL handling](/OpenIDC/mod_auth_openidc/commit/9c0b7b549c95ab2405956c4985b58a70d5b7c4b8)Oct 2, 2014Blame prior to change 9c0b7b5, made on Oct 2, 2014328 return TRUE;Oct 1, 2014[1.6.0rc2: support provider configuration from a metadata URL](/OpenIDC/mod_auth_openidc/commit/61b6b9bc4cb005dd48c653ec1b6b149d91a8eb78)Oct 1, 2014Blame prior to change 61b6b9b, made on Oct 1, 2014329330}
May 23, 2014[update to draft-bradley-oauth-jwt-encoded-state-01 and fix nonce cache](/OpenIDC/mod_auth_openidc/commit/b92c5efdbd6a44b41e66845803c33ac442a4524e)May 23, 2014Blame prior to change b92c5ef, made on May 23, 2014331332333/\* \* return the oidc\_provider\_t struct for the specified issuer \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021334static oidc\_provider\_t\* oidc\_get\_provider\_for\_issuer(request\_rec \*r,Aug 26, 2015[add CSRF protection to Discovery](/OpenIDC/mod_auth_openidc/commit/7dc4fabe6eb86369ac7038bd6473fec29fd103dd)Aug 26, 2015Blame prior to change 7dc4fab, made on Aug 26, 2015335 oidc\_cfg \*c, const char \*issuer, apr\_byte\_t allow\_discovery) {May 23, 2014[update to draft-bradley-oauth-jwt-encoded-state-01 and fix nonce cache](/OpenIDC/mod_auth_openidc/commit/b92c5efdbd6a44b41e66845803c33ac442a4524e)May 23, 2014Blame prior to change b92c5ef, made on May 23, 2014336337
 /\* by default we'll assume that we're dealing with a single statically configured OP \*/Oct 2, 2014[1.6.0rc3: improve OIDCMetadataURL handling](/OpenIDC/mod_auth_openidc/commit/9c0b7b549c95ab2405956c4985b58a70d5b7c4b8)Oct 2, 2014Blame prior to change 9c0b7b5, made on Oct 2, 2014338339340 oidc\_provider\_t \*provider = NULL; if (oidc\_provider\_static\_config(r, c, &provider) == FALSE) return NULL;May 23, 2014[update to draft-bradley-oauth-jwt-encoded-state-01 and fix nonce cache](/OpenIDC/mod_auth_openidc/commit/b92c5efdbd6a44b41e66845803c33ac442a4524e)May 23, 2014Blame prior to change b92c5ef, made on May 23, 2014341342343344345
 /\* unless a metadata directory was configured, so we'll try and get the provider settings from there \*/ if (c->metadata\_dir != NULL) {
 /\* try and get metadata from the metadata directory for the OP that sent this response \*/Aug 26, 2015[add CSRF protection to Discovery](/OpenIDC/mod_auth_openidc/commit/7dc4fabe6eb86369ac7038bd6473fec29fd103dd)Aug 26, 2015Blame prior to change 7dc4fab, made on Aug 26, 2015346347 if ((oidc\_metadata\_get(r, c, issuer, &provider, allow\_discovery) == FALSE) || (provider == NULL)) {May 23, 2014[update to draft-bradley-oauth-jwt-encoded-state-01 and fix nonce cache](/OpenIDC/mod_auth_openidc/commit/b92c5efdbd6a44b41e66845803c33ac442a4524e)May 23, 2014Blame prior to change b92c5ef, made on May 23, 2014348349
 /\* don't know nothing about this OP/issuer \*/Sep 17, 2014[use log macros that include function names](/OpenIDC/mod_auth_openidc/commit/3265fa0745d55e6d11c62d0074cac4eb1b66c000)Sep 17, 2014Blame prior to change 3265fa0, made on Sep 17, 2014350 oidc\_error(r, "no provider metadata found for issuer \"%s\"",May 23, 2014[update to draft-bradley-oauth-jwt-encoded-state-01 and fix nonce cache](/OpenIDC/mod_auth_openidc/commit/b92c5efdbd6a44b41e66845803c33ac442a4524e)May 23, 2014Blame prior to change b92c5ef, made on May 23, 2014351352353354355356357358359 issuer);
 return NULL; } }
 return provider;}
Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016360361362363364365366367/\* \* find out whether the request is a response from an IDP discovery page \*/static apr\_byte\_t oidc\_is\_discovery\_response(request\_rec \*r, oidc\_cfg \*cfg) { /\* \* prereq: this is a call to the configured redirect\_uri, now see if: \* the OIDC\_DISC\_OP\_PARAM is present \*/Sep 30, 2016[support WebFinger Discovery with URL-style user identifiers](/OpenIDC/mod_auth_openidc/commit/035b32f7f4c703c5a0fcf6cded499d6aea2bd164)Sep 30, 2016Blame prior to change 035b32f, made on Sep 30, 2016368369 return oidc\_util\_request\_has\_parameter(r, OIDC\_DISC\_OP\_PARAM) || oidc\_util\_request\_has\_parameter(r, OIDC\_DISC\_USER\_PARAM);Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016370371372373374}
/\* \* return the HTTP method being called: only for POST data persistence purposes \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021375static const char\* oidc\_original\_request\_method(request\_rec \*r, oidc\_cfg \*cfg,Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016376377378379380 apr\_byte\_t handle\_discovery\_response) { const char \*method = OIDC\_METHOD\_GET;
 char \*m = NULL; if ((handle\_discovery\_response == TRUE)Apr 20, 2017[Support relative RedirectURIs in mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/a73dc017984d1cdcda93ea5bbf0621d8825c5b81)Apr 20, 2017Blame prior to change a73dc01, made on Apr 20, 2017381 && (oidc\_util\_request\_matches\_url(r, oidc\_get\_redirect\_uri(r, cfg)))Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016382383384385386387388389390391392 && (oidc\_is\_discovery\_response(r, cfg))) { oidc\_util\_get\_request\_parameter(r, OIDC\_DISC\_RM\_PARAM, &m); if (m != NULL) method = apr\_pstrdup(r->pool, m); } else {
 /\* \* if POST preserve is not enabled for this location, there's no point in preserving \* the method either which would result in POSTing empty data on return; \* so we revert to legacy behavior \*/Sep 5, 2016[fix merging so values can be set back to default values in subdirs](/OpenIDC/mod_auth_openidc/commit/30a28c53533151411d20476a546b48c65bbf1453)Sep 5, 2016Blame prior to change 30a28c5, made on Sep 5, 2016393 if (oidc\_cfg\_dir\_preserve\_post(r) == 0)Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016394395 return OIDC\_METHOD\_GET;
Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor header calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/738a94ecf28bf8f3cacca56671a897d2defb2dd7)Feb 21, 2017Blame prior to change 738a94e, made on Feb 21, 2017396 const char \*content\_type = oidc\_util\_hdr\_in\_content\_type\_get(r);Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023397 if ((r->method\_number == M\_POST) && (\_oidc\_strcmp(content\_type,Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017398 OIDC\_CONTENT\_TYPE\_FORM\_ENCODED) == 0))Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016399400401402403404405406407408409410411412 method = OIDC\_METHOD\_FORM\_POST; }
 oidc\_debug(r, "return: %s", method);
 return method;}
/\* \* send an OpenID Connect authorization request to the specified provider preserving POST parameters using HTML5 storage \*/apr\_byte\_t oidc\_post\_preserve\_javascript(request\_rec \*r, const char \*location, char \*\*javascript, char \*\*javascript\_method) {
Sep 5, 2016[fix merging so values can be set back to default values in subdirs](/OpenIDC/mod_auth_openidc/commit/30a28c53533151411d20476a546b48c65bbf1453)Sep 5, 2016Blame prior to change 30a28c5, made on Sep 5, 2016413 if (oidc\_cfg\_dir\_preserve\_post(r) == 0)Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016414415416417418419420421422 return FALSE;
 oidc\_debug(r, "enter");
 oidc\_cfg \*cfg = ap\_get\_module\_config(r->server->module\_config, &auth\_openidc\_module);
 const char \*method = oidc\_original\_request\_method(r, cfg, FALSE);
Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023423 if (\_oidc\_strcmp(method, OIDC\_METHOD\_FORM\_POST) != 0)Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016424425426427 return FALSE;
 /\* read the parameters that are POST-ed to us \*/ apr\_table\_t \*params = apr\_table\_make(r->pool, 8);Aug 2, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix `OIDCOAuthAcceptTokenAs post`; see #443](/OpenIDC/mod_auth_openidc/commit/bc122ae0df1c033dac6b979e54084304c08d8afa)Aug 2, 2019Blame prior to change bc122ae, made on Aug 2, 2019428 if (oidc\_util\_read\_post\_params(r, params, FALSE, NULL) == FALSE) {Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016429430431432433434435436437438 oidc\_error(r, "something went wrong when reading the POST parameters"); return FALSE; }
 const apr\_array\_header\_t \*arr = apr\_table\_elts(params); const apr\_table\_entry\_t \*elts = (const apr\_table\_entry\_t\*) arr->elts; int i; char \*json = ""; for (i = 0; i < arr->nelts; i++) { json = apr\_psprintf(r->pool, "%s'%s': '%s'%s", json,Sep 1, 2016[improve POST handling](/OpenIDC/mod_auth_openidc/commit/78b4a1806704bf53f4c905b76294118ec2d1129c)Sep 1, 2016Blame prior to change 78b4a18, made on Sep 1, 2016439440 oidc\_util\_escape\_string(r, elts[i].key), oidc\_util\_escape\_string(r, elts[i].val),Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016441442443444445446447448449 i < arr->nelts - 1 ? "," : ""); } json = apr\_psprintf(r->pool, "{ %s }", json);
 const char \*jmethod = "preserveOnLoad"; const char \*jscript = apr\_psprintf(r->pool, " <script type=\"text/javascript\">\n" " function %s() {\n"Aug 27, 2019![](https://avatars.githubusercontent.com/u/2247817?s=80&v=4)[Update mod\_auth\_openidc.c](/OpenIDC/mod_auth_openidc/commit/e883e44f09c72c78880f14bc2f816c34ade59917)Aug 27, 2019Blame prior to change e883e44, made on Aug 27, 2019450 " sessionStorage.setItem('mod\_auth\_openidc\_preserve\_post\_params', JSON.stringify(%s));\n"Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016451452453454455 " %s" " }\n" " </script>\n", jmethod, json, location ? apr\_psprintf(r->pool, "window.location='%s';\n",Jun 28, 2021![](https://avatars.githubusercontent.com/u/37646647?s=80&v=4)[Add a function to escape Javascript characters](/OpenIDC/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56)Jun 28, 2021Blame prior to change 55ea0a0, made on Jun 28, 2021456 oidc\_util\_javascript\_escape(r->pool, location)) :Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016457458459460461462463464 ""); if (location == NULL) { if (javascript\_method) \*javascript\_method = apr\_pstrdup(r->pool, jmethod); if (javascript) \*javascript = apr\_pstrdup(r->pool, jscript); } else { oidc\_util\_html\_send(r, "Preserving...", jscript, jmethod,May 31, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[ensure all Apache processing is completed on OIDCRedirectURI](/OpenIDC/mod_auth_openidc/commit/6890b13c481f12debbd7c65a79e9dc5197deb794)May 31, 2019Blame prior to change 6890b13, made on May 31, 2019465 "<p>Preserving...</p>", OK);Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016466467468469470471 }
 return TRUE;}
/\*Dec 22, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix typo in comments about HTML 5 storage type](/OpenIDC/mod_auth_openidc/commit/e27c0988bd764359d9fda45401eeb96adcfb8290)Dec 22, 2022Blame prior to change e27c098, made on Dec 22, 2022472 \* restore POST parameters on original\_url from HTML5 session storageAug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016473474475476477478479480481482 \*/static int oidc\_request\_post\_preserved\_restore(request\_rec \*r, const char \*original\_url) {
 oidc\_debug(r, "enter: original\_url=%s", original\_url);
 const char \*method = "postOnLoad"; const char \*script = apr\_psprintf(r->pool, " <script type=\"text/javascript\">\n"May 15, 2018[fixes issue #338 (Restoring POST data)](/OpenIDC/mod_auth_openidc/commit/3725f0ea604ce63e8a47f1a36f04c03dc0552643)May 15, 2018Blame prior to change 3725f0e, made on May 15, 2018483484485486487488489490 " function str\_decode(string) {\n" " try {\n" " result = decodeURIComponent(string);\n" " } catch (e) {\n" " result = unescape(string);\n" " }\n" " return result;\n" " }\n"Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016491 " function %s() {\n"Aug 27, 2019![](https://avatars.githubusercontent.com/u/2247817?s=80&v=4)[Update mod\_auth\_openidc.c](/OpenIDC/mod_auth_openidc/commit/e883e44f09c72c78880f14bc2f816c34ade59917)Aug 27, 2019Blame prior to change e883e44, made on Aug 27, 2019492493 " var mod\_auth\_openidc\_preserve\_post\_params = JSON.parse(sessionStorage.getItem('mod\_auth\_openidc\_preserve\_post\_params'));\n" " sessionStorage.removeItem('mod\_auth\_openidc\_preserve\_post\_params');\n"Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016494495 " for (var key in mod\_auth\_openidc\_preserve\_post\_params) {\n" " var input = document.createElement(\"input\");\n"May 15, 2018[fixes issue #338 (Restoring POST data)](/OpenIDC/mod_auth_openidc/commit/3725f0ea604ce63e8a47f1a36f04c03dc0552643)May 15, 2018Blame prior to change 3725f0e, made on May 15, 2018496497 " input.name = str\_decode(key);\n" " input.value = str\_decode(mod\_auth\_openidc\_preserve\_post\_params[key]);\n"Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016498499500 " input.type = \"hidden\";\n" " document.forms[0].appendChild(input);\n" " }\n"Jun 25, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid XSS vulnerability when using OIDCPreservePost On](/OpenIDC/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751)Jun 25, 2021Blame prior to change 00c315c, made on Jun 25, 2021501 " document.forms[0].action = \"%s\";\n"Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016502503 " document.forms[0].submit();\n" " }\n"Jun 28, 2021![](https://avatars.githubusercontent.com/u/37646647?s=80&v=4)[Add a function to escape Javascript characters](/OpenIDC/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56)Jun 28, 2021Blame prior to change 55ea0a0, made on Jun 28, 2021504 " </script>\n", method, oidc\_util\_javascript\_escape(r->pool, original\_url));Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016505506507508509
 const char \*body = " <p>Restoring...</p>\n" " <form method=\"post\"></form>\n";
 return oidc\_util\_html\_send(r, "Restoring...", script, method, body,May 31, 2019![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[ensure all Apache processing is completed on OIDCRedirectURI](/OpenIDC/mod_auth_openidc/commit/6890b13c481f12debbd7c65a79e9dc5197deb794)May 31, 2019Blame prior to change 6890b13, made on May 31, 2019510 OK);Aug 29, 2016[preserve POST data across authentication requests and discovery](/OpenIDC/mod_auth_openidc/commit/cd8c8e3aca6c3af7685a546a20a3776359941f7e)Aug 29, 2016Blame prior to change cd8c8e3, made on Aug 29, 2016511512}
Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018513514515516517518typedef struct oidc\_state\_cookies\_t { char \*name; apr\_time\_t timestamp; struct oidc\_state\_cookies\_t \*next;} oidc\_state\_cookies\_t;
Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021519static int oidc\_delete\_oldest\_state\_cookies(request\_rec \*r, oidc\_cfg \*c,Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018520521 int number\_of\_valid\_state\_cookies, int max\_number\_of\_state\_cookies, oidc\_state\_cookies\_t \*first) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021522 oidc\_state\_cookies\_t \*cur = NULL, \*prev = NULL, \*prev\_oldest = NULL, \*oldest = NULL;Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018523524525526 while (number\_of\_valid\_state\_cookies >= max\_number\_of\_state\_cookies) { oldest = first; prev\_oldest = NULL; prev = first;Mar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023527 cur = first ? first->next : NULL;Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018528529530531532533534535 while (cur) { if ((cur->timestamp < oldest->timestamp)) { oldest = cur; prev\_oldest = prev; } prev = cur; cur = cur->next; }Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021536537 oidc\_warn(r, "deleting oldest state cookie: %s (time until expiry %" APR\_TIME\_T\_FMT " seconds)", oldest->name, apr\_time\_sec(oldest->timestamp - apr\_time\_now())); oidc\_util\_set\_cookie(r, oldest->name, "", 0, OIDC\_COOKIE\_EXT\_SAME\_SITE\_NONE(c, r));Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018538539540 if (prev\_oldest) prev\_oldest->next = oldest->next; elseMar 27, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix code scanning alerts](/OpenIDC/mod_auth_openidc/commit/4389182239c0f60cfa4873f9980c826a70047cc4)Mar 27, 2023Blame prior to change 4389182, made on Mar 27, 2023541 first = first ? first->next : NULL;Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018542543544545546 number\_of\_valid\_state\_cookies--; } return number\_of\_valid\_state\_cookies;}
Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018547548549550551552/\* \* clean state cookies that have expired i.e. for outstanding requests that will never return \* successfully and return the number of remaining valid cookies/outstanding-requests while \* doing so \*/static int oidc\_clean\_expired\_state\_cookies(request\_rec \*r, oidc\_cfg \*c,Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018553 const char \*currentCookieName, int delete\_oldest) {Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018554 int number\_of\_valid\_state\_cookies = 0;Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018555556 oidc\_state\_cookies\_t \*first = NULL, \*last = NULL; char \*cookie, \*tokenizerCtx = NULL;Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor header calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/738a94ecf28bf8f3cacca56671a897d2defb2dd7)Feb 21, 2017Blame prior to change 738a94e, made on Feb 21, 2017557 char \*cookies = apr\_pstrdup(r->pool, oidc\_util\_hdr\_in\_cookie\_get(r));Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016558 if (cookies != NULL) {Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017559 cookie = apr\_strtok(cookies, OIDC\_STR\_SEMI\_COLON, &tokenizerCtx);Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017560561 while (cookie != NULL) { while (\*cookie == OIDC\_CHAR\_SPACE)Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016562 cookie++;Aug 8, 2020![](https://avatars.githubusercontent.com/u/31416116?s=80&v=4)[Add OIDCStateCookiePrefix setting to enable definition the state cookâ€¦](/OpenIDC/mod_auth_openidc/commit/0e4e57ac93ef71b372d4b21d5af53f0d95ed4cb0)Aug 8, 2020Blame prior to change 0e4e57a, made on Aug 8, 2020563 if (strstr(cookie, oidc\_cfg\_dir\_state\_cookie\_prefix(r)) == cookie) {Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016564 char \*cookieName = cookie;Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017565 while (cookie != NULL && \*cookie != OIDC\_CHAR\_EQUAL)Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016566 cookie++;Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017567 if (\*cookie == OIDC\_CHAR\_EQUAL) {Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016568569 \*cookie = '\0'; cookie++;Jul 12, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use string defines for configuration directives](/OpenIDC/mod_auth_openidc/commit/4ca572779554d7465736f67c84181ea25d7b0f77)Jul 12, 2017Blame prior to change 4ca5727, made on Jul 12, 2017570 if ((currentCookieName == NULL)Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023571 || (\_oidc\_strcmp(cookieName, currentCookieName) != 0)) {Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017572573574 oidc\_proto\_state\_t \*proto\_state = oidc\_proto\_state\_from\_cookie(r, c, cookie); if (proto\_state != NULL) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021575 json\_int\_t ts = oidc\_proto\_state\_get\_timestamp(proto\_state);Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017576 if (apr\_time\_now() > ts + apr\_time\_from\_sec(c->state\_timeout)) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021577578 oidc\_warn(r, "state (%s) has expired (original\_url=%s)", cookieName, oidc\_proto\_state\_get\_original\_url(proto\_state)); oidc\_util\_set\_cookie(r, cookieName, "", 0, OIDC\_COOKIE\_EXT\_SAME\_SITE\_NONE(c, r));Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018579 } else {Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018580 if (first == NULL) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021581 first = apr\_pcalloc(r->pool, sizeof(oidc\_state\_cookies\_t));Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018582583 last = first; } else {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021584 last->next = apr\_pcalloc(r->pool, sizeof(oidc\_state\_cookies\_t));Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018585586587588589 last = last->next; } last->name = cookieName; last->timestamp = ts; last->next = NULL;Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018590 number\_of\_valid\_state\_cookies++;Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017591592 } oidc\_proto\_state\_destroy(proto\_state);Jul 22, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[delete state cookie when it cannot be decoded/decrypted](/OpenIDC/mod_auth_openidc/commit/7934313fe0e76fdc430999b5d42d19b8e14b37ee)Jul 22, 2020Blame prior to change 7934313, made on Jul 22, 2020593 } else {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021594595 oidc\_warn(r, "state cookie could not be retrieved/decoded, deleting: %s", cookieName); oidc\_util\_set\_cookie(r, cookieName, "", 0, OIDC\_COOKIE\_EXT\_SAME\_SITE\_NONE(c, r));Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016596597598599 } } } }Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use more string and char defines](/OpenIDC/mod_auth_openidc/commit/d3227e2ee512427c854272c5c95ab23cd7805bf4)Jun 6, 2017Blame prior to change d3227e2, made on Jun 6, 2017600 cookie = apr\_strtok(NULL, OIDC\_STR\_SEMI\_COLON, &tokenizerCtx);Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017601 }Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016602 }Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018603604
 if (delete\_oldest > 0)Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021605606 number\_of\_valid\_state\_cookies = oidc\_delete\_oldest\_state\_cookies(r, c, number\_of\_valid\_state\_cookies, c->max\_number\_of\_state\_cookies, first);Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018607
Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018608 return number\_of\_valid\_state\_cookies;Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016609610}
Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014611/\*Apr 25, 2014[support hybrid flows](/OpenIDC/mod_auth_openidc/commit/49b73f99a33013050bd133e957c0bd92402ba9a1)Apr 25, 2014Blame prior to change 49b73f9, made on Apr 25, 2014612 \* restore the state that was maintained between authorization request and response in an encrypted cookieMar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014613 \*/Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021614615static apr\_byte\_t oidc\_restore\_proto\_state(request\_rec \*r, oidc\_cfg \*c, const char \*state, oidc\_proto\_state\_t \*\*proto\_state) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014616
Sep 17, 2014[use log macros that include function names](/OpenIDC/mod_auth_openidc/commit/3265fa0745d55e6d11c62d0074cac4eb1b66c000)Sep 17, 2014Blame prior to change 3265fa0, made on Sep 17, 2014617 oidc\_debug(r, "enter");Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014618
Sep 1, 2014[add session management based on](/OpenIDC/mod_auth_openidc/commit/a4da1daf6d9b925184d3f73e2f58747bbff8ae59)Sep 1, 2014Blame prior to change a4da1da, made on Sep 1, 2014619620 const char \*cookieName = oidc\_get\_state\_cookie\_name(r, state);
Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017621 /\* clean expired state cookies to avoid pollution \*/Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018622 oidc\_clean\_expired\_state\_cookies(r, c, cookieName, FALSE);Jun 6, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[avoid cleaning our own state cookie twice when it is expired](/OpenIDC/mod_auth_openidc/commit/c41226419503aa475d51982bed8ffacf5d7e9ba1)Jun 6, 2017Blame prior to change c412264, made on Jun 6, 2017623
Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014624 /\* get the state cookie value first \*/Sep 1, 2014[add session management based on](/OpenIDC/mod_auth_openidc/commit/a4da1daf6d9b925184d3f73e2f58747bbff8ae59)Sep 1, 2014Blame prior to change a4da1da, made on Sep 1, 2014625 char \*cookieValue = oidc\_util\_get\_cookie(r, cookieName);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014626 if (cookieValue == NULL) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021627 oidc\_error(r, "no \"%s\" state cookie found: check domain and samesite cookie settings", cookieName);Dec 22, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[remove support for](/OpenIDC/mod_auth_openidc/commit/42e2a7bff0cea4d723e847ed610a924d0d9e7d8a)Dec 22, 2020Blame prior to change 42e2a7b, made on Dec 22, 2020628 return FALSE;Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014629630631 }
 /\* clear state cookie because we don't need it anymore \*/Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021632 oidc\_util\_set\_cookie(r, cookieName, "", 0, OIDC\_COOKIE\_EXT\_SAME\_SITE\_NONE(c, r));Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014633
Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017634 \*proto\_state = oidc\_proto\_state\_from\_cookie(r, c, cookieValue);Sep 5, 2016[fix merging so values can be set back to default values in subdirs](/OpenIDC/mod_auth_openidc/commit/30a28c53533151411d20476a546b48c65bbf1453)Sep 5, 2016Blame prior to change 30a28c5, made on Sep 5, 2016635636 if (\*proto\_state == NULL) return FALSE;Jun 3, 2014[change JSON parser from apr-json to jansson](/OpenIDC/mod_auth_openidc/commit/1e6774d7dfd7ed9e37474982809838a16072effc)Jun 3, 2014Blame prior to change 1e6774d, made on Jun 3, 2014637
Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017638 const char \*nonce = oidc\_proto\_state\_get\_nonce(\*proto\_state);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014639640
 /\* calculate the hash of the browser fingerprint concatenated with the nonce \*/Apr 25, 2020![](https://avatars.githubusercontent.com/u/28739?s=80&v=4)[Allow configuring which header value is used to calculate the](/OpenIDC/mod_auth_openidc/commit/2a97eced569ebbff82fc0370c4f741d04ba7cb13)Apr 25, 2020Blame prior to change 2a97ece, made on Apr 25, 2020641 char \*calc = oidc\_get\_browser\_state\_hash(r, c, nonce);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014642 /\* compare the calculated hash with the value provided in the authorization response \*/Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023643 if (\_oidc\_strcmp(calc, state) != 0) {Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021644 oidc\_error(r, "calculated state from cookie does not match state parameter passed back in URL: \"%s\" != \"%s\"", state, calc);Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017645 oidc\_proto\_state\_destroy(\*proto\_state);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014646647648 return FALSE; }
Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017649 apr\_time\_t ts = oidc\_proto\_state\_get\_timestamp(\*proto\_state);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014650
Apr 19, 2014[store response\_type in state and make state a JSON object](/OpenIDC/mod_auth_openidc/commit/c058a1ded44f44c897df2d190ad062d208a6db30)Apr 19, 2014Blame prior to change c058a1d, made on Apr 19, 2014651 /\* check that the timestamp is not beyond the valid interval \*/Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017652 if (apr\_time\_now() > ts + apr\_time\_from\_sec(c->state\_timeout)) {Sep 17, 2014[use log macros that include function names](/OpenIDC/mod_auth_openidc/commit/3265fa0745d55e6d11c62d0074cac4eb1b66c000)Sep 17, 2014Blame prior to change 3265fa0, made on Sep 17, 2014653 oidc\_error(r, "state has expired");Jun 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[do not send state timeout HTML document when OIDCDefaultURL is set](/OpenIDC/mod_auth_openidc/commit/3f7f3feeb50549d2e1de2ea00dd99a719c7911b4)Jun 2, 2021Blame prior to change 3f7f3fe, made on Jun 2, 2021654655656657658659660661662663 if ((c->default\_sso\_url == NULL) || (apr\_table\_get(r->subprocess\_env, "OIDC\_NO\_DEFAULT\_URL\_ON\_STATE\_TIMEOUT") != NULL)) { oidc\_util\_html\_send\_error(r, c->error\_template, "Invalid Authentication Response", apr\_psprintf(r->pool, "This is due to a timeout; please restart your authentication session by re-entering the URL/bookmark you originally wanted to access: %s", oidc\_proto\_state\_get\_original\_url(\*proto\_state)), OK); /\* \* a hack for Apache 2.4 to prevent it from writing its own 500/400/302 HTML document \* text by making ap\_send\_error\_response in http\_protocol.c return early... \*/ r->header\_only = 1; }Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017664 oidc\_proto\_state\_destroy(\*proto\_state);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014665666667 return FALSE; }
Feb 18, 2016[pass plain state to the token endpoint on code flows](/OpenIDC/mod_auth_openidc/commit/37ddf1efc7e44ff00d77949dec91b78913e19c0a)Feb 18, 2016Blame prior to change 37ddf1e, made on Feb 18, 2016668 /\* add the state \*/Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017669 oidc\_proto\_state\_set\_state(\*proto\_state, state);Dec 17, 2015[push a hash of state to the token endpoint on code flows](/OpenIDC/mod_auth_openidc/commit/1072ea68fe95db729d7e0b95cba106456e8ed455)Dec 17, 2015Blame prior to change 1072ea6, made on Dec 17, 2015670
Feb 27, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add encryption for all caches/entries instead of just session data](/OpenIDC/mod_auth_openidc/commit/7d47a76f2cc3918ca2d759a2a2a402b03f7bb13a)Feb 27, 2017Blame prior to change 7d47a76, made on Feb 27, 2017671 /\* log the restored state object \*/Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021672 oidc\_debug(r, "restored state: %s", oidc\_proto\_state\_to\_string(r, \*proto\_state));Jun 3, 2014[change JSON parser from apr-json to jansson](/OpenIDC/mod_auth_openidc/commit/1e6774d7dfd7ed9e37474982809838a16072effc)Jun 3, 2014Blame prior to change 1e6774d, made on Jun 3, 2014673
Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014674675676677678 /\* we've made it \*/ return TRUE;}
/\*Apr 25, 2014[support hybrid flows](/OpenIDC/mod_auth_openidc/commit/49b73f99a33013050bd133e957c0bd92402ba9a1)Apr 25, 2014Blame prior to change 49b73f9, made on Apr 25, 2014679680 \* set the state that is maintained between an authorization request and an authorization response \* in a cookie in the browser that is cryptographically bound to that stateMar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014681 \*/Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018682683static int oidc\_authorization\_request\_set\_cookie(request\_rec \*r, oidc\_cfg \*c, const char \*state, oidc\_proto\_state\_t \*proto\_state) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014684 /\*Sep 12, 2014[initialize apr\_uri\_t to 0](/OpenIDC/mod_auth_openidc/commit/908b0254381ad5a5797b62d505e9b2673f859a15)Sep 12, 2014Blame prior to change 908b025, made on Sep 12, 2014685686 \* create a cookie consisting of 8 elements: \* random value, original URL, original method, issuer, response\_type, response\_mod, prompt and timestampMar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017687 \* encoded as JSON, encrypting the resulting JSON valueMar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014688 \*/Mar 29, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor proto state into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/28235d385d02f7941f643d93cbd0099329c0b635)Mar 29, 2017Blame prior to change 28235d3, made on Mar 29, 2017689690 char \*cookieValue = oidc\_proto\_state\_to\_cookie(r, c, proto\_state); if (cookieValue == NULL)Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018691 return HTTP\_INTERNAL\_SERVER\_ERROR;Apr 25, 2014[support hybrid flows](/OpenIDC/mod_auth_openidc/commit/49b73f99a33013050bd133e957c0bd92402ba9a1)Apr 25, 2014Blame prior to change 49b73f9, made on Apr 25, 2014692
Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018693694 /\* \* clean expired state cookies to avoid pollution and optionallyAug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018695 \* try to avoid the number of state cookies exceeding a maxAug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018696 \*/Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018697698 int number\_of\_cookies = oidc\_clean\_expired\_state\_cookies(r, c, NULL, oidc\_cfg\_delete\_oldest\_state\_cookies(c));Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018699700701 int max\_number\_of\_cookies = oidc\_cfg\_max\_number\_of\_state\_cookies(c); if ((max\_number\_of\_cookies > 0) && (number\_of\_cookies >= max\_number\_of\_cookies)) {Dec 6, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[optionally delete the oldest state cookie(s); see #399](/OpenIDC/mod_auth_openidc/commit/46758a75eef8e3c91f2917fc7c6302136eb18809)Dec 6, 2018Blame prior to change 46758a7, made on Dec 6, 2018702
Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018703704705706707708709710711 oidc\_warn(r, "the number of existing, valid state cookies (%d) has exceeded the limit (%d), no additional authorization request + state cookie can be generated, aborting the request", number\_of\_cookies, max\_number\_of\_cookies); /\* \* TODO: the html\_send code below caters for the case that there's a user behind a \* browser generating this request, rather than a piece of XHR code; how would an \* XHR client handle this? \*/
Aug 4, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[don't return content with 503; see #331](/OpenIDC/mod_auth_openidc/commit/9e98f1a042fa14d6b0892638a0d87c2b951837b6)Aug 4, 2018Blame prior to change 9e98f1a, made on Aug 4, 2018712713714715716 /\* \* it appears that sending content with a 503 turns the HTTP status code \* into a 200 so we'll avoid that for now: the user will see Apache specific \* readable text anyway \*Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021717718719720721722723 return oidc\_util\_html\_send\_error(r, c->error\_template, "Too Many Outstanding Requests", apr\_psprintf(r->pool, "No authentication request could be generated since there are too many outstanding authentication requests already; you may have to wait up to %d seconds to be able to create a new request", c->state\_timeout), HTTP\_SERVICE\_UNAVAILABLE); \*/Aug 4, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[don't return content with 503; see #331](/OpenIDC/mod_auth_openidc/commit/9e98f1a042fa14d6b0892638a0d87c2b951837b6)Aug 4, 2018Blame prior to change 9e98f1a, made on Aug 4, 2018724725
 return HTTP\_SERVICE\_UNAVAILABLE;Aug 1, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add OIDCStateMaxNumberOfCookies to limit nr of state cookies; see #331](/OpenIDC/mod_auth_openidc/commit/5041e0f679f03525f106eaf0edc7c7d245b1d89c)Aug 1, 2018Blame prior to change 5041e0f, made on Aug 1, 2018726 }Jan 29, 2016[use session state cookies and clean them](/OpenIDC/mod_auth_openidc/commit/1724d01e9a7f1f4dc4712b1d4ccc30977efc6094)Jan 29, 2016Blame prior to change 1724d01, made on Jan 29, 2016727
Sep 1, 2014[add session management based on](/OpenIDC/mod_auth_openidc/commit/a4da1daf6d9b925184d3f73e2f58747bbff8ae59)Sep 1, 2014Blame prior to change a4da1da, made on Sep 1, 2014728729730 /\* assemble the cookie name for the state cookie \*/ const char \*cookieName = oidc\_get\_state\_cookie\_name(r, state);
Apr 25, 2014[support hybrid flows](/OpenIDC/mod_auth_openidc/commit/49b73f99a33013050bd133e957c0bd92402ba9a1)Apr 25, 2014Blame prior to change 49b73f9, made on Apr 25, 2014731 /\* set it as a cookie \*/Feb 28, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add cookie SameSite flag/policy through OIDCCookieSameSite](/OpenIDC/mod_auth_openidc/commit/4de91c6ef7cebe2340c4976dee96c8b280a9b25e)Feb 28, 2017Blame prior to change 4de91c6, made on Feb 28, 2017732 oidc\_util\_set\_cookie(r, cookieName, cookieValue, -1,Dec 7, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[don't set SameSite=None on cookies when on plain http](/OpenIDC/mod_auth_openidc/commit/791ae23f48984d81aa111c0b822fca774ccc1547)Dec 7, 2020Blame prior to change 791ae23, made on Dec 7, 2020733 OIDC\_COOKIE\_SAMESITE\_LAX(c, r));Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014734
Nov 5, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[fix content processing for info and JWKs handler; closes #497](/OpenIDC/mod_auth_openidc/commit/9111e56fa83fa05503b4b5e919b72a5641dd0942)Nov 5, 2020Blame prior to change 9111e56, made on Nov 5, 2020735 return OK;Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014736737738739740741}
/\* \* get the mod\_auth\_openidc related context from the (userdata in the) request \* (used for passing state between various Apache request processing stages and hook callbacks) \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021742static apr\_table\_t\* oidc\_request\_state(request\_rec \*rr) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014743744745746747748
 /\* our state is always stored in the main request \*/ request\_rec \*r = (rr->main != NULL) ? rr->main : rr;
 /\* our state is a table, get it \*/ apr\_table\_t \*state = NULL;Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021749 apr\_pool\_userdata\_get((void\*\*) &state, OIDC\_USERDATA\_KEY, r->pool);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014750751752753754755756757758759760761762763764765766767768769770
 /\* if it does not exist, we'll create a new table \*/ if (state == NULL) { state = apr\_table\_make(r->pool, 5); apr\_pool\_userdata\_set(state, OIDC\_USERDATA\_KEY, NULL, r->pool); }
 /\* return the resulting table, always non-null now \*/ return state;}
/\* \* set a name/value pair in the mod\_auth\_openidc-specific request context \* (used for passing state between various Apache request processing stages and hook callbacks) \*/void oidc\_request\_state\_set(request\_rec \*r, const char \*key, const char \*value) {
 /\* get a handle to the global state, which is a table \*/ apr\_table\_t \*state = oidc\_request\_state(r);
 /\* put the name/value pair in that table \*/Jul 4, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use apr\_table\_set instead of apr\_table\_add](/OpenIDC/mod_auth_openidc/commit/e5ab61e6c5e2d67cc7f72c7ccb651ce59aba53f0)Jul 4, 2017Blame prior to change e5ab61e, made on Jul 4, 2017771 apr\_table\_set(state, key, value);Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014772773774775776777}
/\* \* get a name/value pair from the mod\_auth\_openidc-specific request context \* (used for passing state between various Apache request processing stages and hook callbacks) \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021778const char\* oidc\_request\_state\_get(request\_rec \*r, const char \*key) {Mar 27, 2014[initial import named mod\_auth\_openidc](/OpenIDC/mod_auth_openidc/commit/fff2a454fa2b0fe38c90add5d75e450564bd6c79)Mar 27, 2014779780781782783784785786
 /\* get a handle to the global state, which is a table \*/ apr\_table\_t \*state = oidc\_request\_state(r);
 /\* return the value from the table \*/ return apr\_table\_get(state, key);}
Apr 26, 2014[correct code comments](/OpenIDC/mod_auth_openidc/commit/333f10cd87ce97a5281f7c20bd413388c3c462a8)Apr 26, 2014Blame prior to change 333f10c, made on Apr 26, 2014787788789790/\* \* set the claims from a JSON object (c.q. id\_token or user\_info response) stored \* in the session in to HTTP headers passed on to the application \*/Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021791792static apr\_byte\_t oidc\_set\_app\_claims(request\_rec \*r, const oidc\_cfg \*const cfg, oidc\_session\_t \*session, const char \*s\_claims) {Jun 24, 2015[support passing claims as environment variables (OIDCPassClaimsAs)](/OpenIDC/mod_auth_openidc/commit/ed7cab69abbbfb003d0831e140aeea7b2d6b5c1e)Jun 24, 2015Blame prior to change ed7cab6, made on Jun 24, 2015793
Jun 3, 2014[store stringified JSON in request state to avoid memory leakage](/OpenIDC/mod_auth_openidc/commit/00ae03420a8a732301241ba7caf6c927cdbec72d)Jun 3, 2014Blame prior to change 00ae034, made on Jun 3, 2014794 json\_t \*j\_claims = NULL;Apr 7, 2014[refactoring JOSE code, part 1](/OpenIDC/mod_auth_openidc/commit/6fca2fcb040df6dbbf1ee509d615eed157213d65)Apr 7, 2014Blame prior to change 6fca2fc, made on Apr 7, 2014795796
 /\* decode the string-encoded attributes in to a JSON structure \*/Jun 3, 2014[store stringified JSON in request state to avoid memory leakage](/OpenIDC/mod_auth_openidc/commit/00ae03420a8a732301241ba7caf6c927cdbec72d)Jun 3, 2014Blame prior to change 00ae034, made on Jun 3, 2014797 if (s\_claims != NULL) {Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use oidc\_util\_decode\_json\_object where possible instead of json\_loads](/OpenIDC/mod_auth_openidc/commit/dc56d7d72a4e822c52bc300b26c7d14225af69ae)Feb 21, 2017Blame prior to change dc56d7d, made on Feb 21, 2017798 if (oidc\_util\_decode\_json\_object(r, s\_claims, &j\_claims) == FALSE)Jun 3, 2014[change JSON parser from apr-json to jansson](/OpenIDC/mod_auth_openidc/commit/1e6774d7dfd7ed9e37474982809838a16072effc)Jun 3, 2014Blame prior to change 1e6774d, made on Jun 3, 2014799 return FALSE;Apr 7, 2014[refactoring JOSE code, part 1](/OpenIDC/mod_auth_openidc/commit/6fca2fcb040df6dbbf1ee509d615eed157213d65)Apr 7, 2014Blame prior to change 6fca2fc, made on Apr 7, 2014800801 }
Apr 16, 2014[set HTTP headers for OAuth 2.0 paths](/OpenIDC/mod_auth_openidc/commit/6eba9ae2a75672f3dfaeec397e55e0cff7a47357)Apr 16, 2014Blame prior to change 6eba9ae, made on Apr 16, 2014802 /\* set the resolved claims a HTTP headers for the application \*/Jun 3, 2014[store stringified JSON in request state to avoid memory leakage](/OpenIDC/mod_auth_openidc/commit/00ae03420a8a732301241ba7caf6c927cdbec72d)Jun 3, 2014Blame prior to change 00ae034, made on Jun 3, 2014803 if (j\_claims != NULL) {May 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add support for an empty OIDCClaimPrefix; see #264](/OpenIDC/mod_auth_openidc/commit/fd208e65b6004f033994281a45942da91834e773)May 30, 2017Blame prior to change fd208e6, made on May 30, 2017804 oidc\_util\_set\_app\_infos(r, j\_claims, oidc\_cfg\_claim\_prefix(r),Sep 5, 2016[fix merging so values can be set back to default values in subdirs](/OpenIDC/mod_auth_openidc/commit/30a28c53533151411d20476a546b48c65bbf1453)Sep 5, 2016Blame prior to change 30a28c5, made on Sep 5, 2016805 cfg->claim\_delimiter, oidc\_cfg\_dir\_pass\_info\_in\_headers(r),Jan 11, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[address #515; reformat](/OpenIDC/mod_auth_openidc/commit/2019f5421103a2114bb544a5ce01ac074842aac4)Jan 11, 2021Blame prior to change 2019f54, made on Jan 11, 2021806 oidc\_cfg\_dir\_pass\_info\_in\_envvars(r),Nov 8, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add latin-1 character encoding option for claim values](/OpenIDC/mod_auth_openidc/commit/5aded8079eefa613447acf8583967c35e9db62cd)Nov 8, 2022Blame prior to change 5aded80, made on Nov 8, 2022807 oidc\_cfg\_dir\_pass\_info\_encoding(r));Apr 7, 2014[refactoring JOSE code, part 1](/OpenIDC/mod_auth_openidc/commit/6fca2fcb040df6dbbf1ee509d615eed157213d65)Apr 7, 2014Blame prior to change 6fca2fc, made on Apr 7, 2014808
Jun 3, 2014[do free resources after storing JSON string in the request state..](/OpenIDC/mod_auth_openidc/commit/2a187ee413cd7aa7780802045dcafac686594909)Jun 3, 2014Blame prior to change 2a187ee, made on Jun 3, 2014809810 /\* release resources \*/ json\_decref(j\_claims);Apr 7, 2014[refactoring JOSE code, part 1](/OpenIDC/mod_auth_openidc/commit/6fca2fcb040df6dbbf1ee509d615eed157213d65)Apr 7, 2014Blame prior to change 6fca2fc, made on Apr 7, 2014811812813814815 }
 return TRUE;}
Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015816817818static int oidc\_authenticate\_user(request\_rec \*r, oidc\_cfg \*c, oidc\_provider\_t \*provider, const char \*original\_url, const char \*login\_hint, const char \*id\_token\_hint, const char \*prompt,May 30, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[support for OIDCPathAuthRequestParams and OIDCPathScope; see #263](/OpenIDC/mod_auth_openidc/commit/b1504d52bf046851960d94be40a5454eea9e66ef)May 30, 2017Blame prior to change b1504d5, made on May 30, 2017819 const char \*auth\_request\_params, const char \*path\_scope);Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015820821822823
/\* \* log message about max session duration \*/Feb 15, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session updates](/OpenIDC/mod_auth_openidc/commit/951f44c343534896cd59751704b642318c42e4e1)Feb 15, 2017Blame prior to change 951f44c, made on Feb 15, 2017824825static void oidc\_log\_session\_expires(request\_rec \*r, const char \*msg, apr\_time\_t session\_expires) {Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015826827 char buf[APR\_RFC822\_DATE\_LEN + 1]; apr\_rfc822\_date(buf, session\_expires);Feb 15, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session updates](/OpenIDC/mod_auth_openidc/commit/951f44c343534896cd59751704b642318c42e4e1)Feb 15, 2017Blame prior to change 951f44c, made on Feb 15, 2017828829 oidc\_debug(r, "%s: %s (in %" APR\_TIME\_T\_FMT " secs from now)", msg, buf, apr\_time\_sec(session\_expires - apr\_time\_now()));Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015830831}
Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018832/\*Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021833 \* see if this is a request that is capable of completing an authentication round trip to the ProviderAug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018834 \*/Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021835apr\_byte\_t oidc\_is\_auth\_capable\_request(request\_rec \*r) {Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018836837838839
 if ((oidc\_util\_hdr\_in\_x\_requested\_with\_get(r) != NULL) && (apr\_strnatcasecmp(oidc\_util\_hdr\_in\_x\_requested\_with\_get(r), OIDC\_HTTP\_HDR\_VAL\_XML\_HTTP\_REQUEST) == 0))Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021840 return FALSE;Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018841
Oct 27, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Mode header != "navigate" value](/OpenIDC/mod_auth_openidc/commit/ee891b1665be34b624df11a103a910d74869256c)Oct 27, 2021Blame prior to change ee891b1, made on Oct 27, 2021842843844 if ((oidc\_util\_hdr\_in\_sec\_fetch\_mode\_get(r) != NULL) && (apr\_strnatcasecmp(oidc\_util\_hdr\_in\_sec\_fetch\_mode\_get(r), OIDC\_HTTP\_HDR\_VAL\_NAVIGATE) != 0))Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021845846847848849850 return FALSE;
 if ((oidc\_util\_hdr\_in\_sec\_fetch\_dest\_get(r) != NULL) && (apr\_strnatcasecmp(oidc\_util\_hdr\_in\_sec\_fetch\_dest\_get(r), OIDC\_HTTP\_HDR\_VAL\_DOCUMENT) != 0)) return FALSE;Oct 27, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Mode header != "navigate" value](/OpenIDC/mod_auth_openidc/commit/ee891b1665be34b624df11a103a910d74869256c)Oct 27, 2021Blame prior to change ee891b1, made on Oct 27, 2021851
Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018852853854855856 if ((oidc\_util\_hdr\_in\_accept\_contains(r, OIDC\_CONTENT\_TYPE\_TEXT\_HTML) == FALSE) && (oidc\_util\_hdr\_in\_accept\_contains(r, OIDC\_CONTENT\_TYPE\_APP\_XHTML\_XML) == FALSE) && (oidc\_util\_hdr\_in\_accept\_contains(r, OIDC\_CONTENT\_TYPE\_ANY) == FALSE))Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021857 return FALSE;Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018858
Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021859 return TRUE;Aug 22, 2018![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve auto-detection of XMLHttpRequests via Accept header; see #331](/OpenIDC/mod_auth_openidc/commit/cff35bba8861ddb09d694ecfcd88d5fac1018453)Aug 22, 2018Blame prior to change cff35bb, made on Aug 22, 2018860861}
Feb 2, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[handle OIDCUnAuthAction after max session duration is exceeded; see #220](/OpenIDC/mod_auth_openidc/commit/129fc64d01826da35160f6e28f9cfee376411288)Feb 2, 2017Blame prior to change 129fc64, made on Feb 2, 2017862863864865866867868869870/\* \* find out which action we need to take when encountering an unauthenticated request \*/static int oidc\_handle\_unauthenticated\_user(request\_rec \*r, oidc\_cfg \*c) {
 /\* see if we've configured OIDCUnAuthAction for this path \*/ switch (oidc\_dir\_cfg\_unauth\_action(r)) { case OIDC\_UNAUTH\_RETURN410: return HTTP\_GONE;Jan 7, 2020![](https://avatars.githubusercontent.com/u/57939861?s=80&v=4)[support unauth action 407](/OpenIDC/mod_auth_openidc/commit/77ef5c7a1d927a15c1c2951d53e629225cabd9f6)Jan 7, 2020Blame prior to change 77ef5c7, made on Jan 7, 2020871872 case OIDC\_UNAUTH\_RETURN407: return HTTP\_PROXY\_AUTHENTICATION\_REQUIRED;Feb 2, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[handle OIDCUnAuthAction after max session duration is exceeded; see #220](/OpenIDC/mod_auth_openidc/commit/129fc64d01826da35160f6e28f9cfee376411288)Feb 2, 2017Blame prior to change 129fc64, made on Feb 2, 2017873874875876877878879880881882883884885886887888889890891892 case OIDC\_UNAUTH\_RETURN401: return HTTP\_UNAUTHORIZED; case OIDC\_UNAUTH\_PASS: r->user = "";
 /\* \* we're not going to pass information about an authenticated user to the application, \* but we do need to scrub the headers that mod\_auth\_openidc would set for security reasons \*/ oidc\_scrub\_headers(r);
 return OK;
 case OIDC\_UNAUTH\_AUTHENTICATE:
 /\* \* exception handling: if this looks like a XMLHttpRequest call we \* won't redirect the user and thus avoid creating a state cookie \* for a non-browser (= Javascript) call that will never return from the OP \*/Aug 1, 2020![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add Apache expression option to OIDCUnAuthAction; see](/OpenIDC/mod_auth_openidc/commit/1461634f75141df6386223bba9446ddb7bbf9ab1) [#479](https://github.com/OpenIDC/mod_auth_openidc/pull/479)Aug 1, 2020Blame prior to change 1461634, made on Aug 1, 2020893 if ((oidc\_dir\_cfg\_unauth\_expr\_is\_set(r) == FALSE)Nov 2, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[add check for Sec-Fetch-Dest header != "document" value](/OpenIDC/mod_auth_openidc/commit/143b63b8b25b2625730fa5db1941aee5613fcd70)Nov 2, 2021Blame prior to change 143b63b, made on Nov 2, 2021894 && (oidc\_is\_auth\_capable\_request(r) == FALSE))Feb 2, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[handle OIDCUnAuthAction after max session duration is exceeded; see #220](/OpenIDC/mod_auth_openidc/commit/129fc64d01826da35160f6e28f9cfee376411288)Feb 2, 2017Blame prior to change 129fc64, made on Feb 2, 2017895896897898899900901 return HTTP\_UNAUTHORIZED; }
 /\* \* else: no session (regardless of whether it is main or sub-request), \* and we need to authenticate the user \*/Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021902 return oidc\_authenticate\_user(r, c, NULL, oidc\_get\_current\_url(r, c->x\_forwarded\_headers), NULL,Jul 12, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[use string defines for configuration directives](/OpenIDC/mod_auth_openidc/commit/4ca572779554d7465736f67c84181ea25d7b0f77)Jul 12, 2017Blame prior to change 4ca5727, made on Jul 12, 2017903904 NULL, NULL, oidc\_dir\_cfg\_path\_auth\_request\_params(r), oidc\_dir\_cfg\_path\_scope(r));Feb 2, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[handle OIDCUnAuthAction after max session duration is exceeded; see #220](/OpenIDC/mod_auth_openidc/commit/129fc64d01826da35160f6e28f9cfee376411288)Feb 2, 2017Blame prior to change 129fc64, made on Feb 2, 2017905906}
Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015907908909/\* \* check if maximum session duration was exceeded \*/Jan 26, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve handling session duration expiry](/OpenIDC/mod_auth_openidc/commit/d7d80ed5db65556fceadb2c1f7b643d18717fe30)Jan 26, 2022Blame prior to change d7d80ed, made on Jan 26, 2022910911static apr\_byte\_t oidc\_check\_max\_session\_duration(request\_rec \*r, oidc\_cfg \*cfg, oidc\_session\_t \*session, int \*rc) {Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015912913
 /\* get the session expiry from the session data \*/Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session state calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/45797336f1c7284358043defc191d03f2f71ad77)Feb 21, 2017Blame prior to change 4579733, made on Feb 21, 2017914 apr\_time\_t session\_expires = oidc\_session\_get\_session\_expires(r, session);Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015915916917
 /\* check the expire timestamp against the current time \*/ if (apr\_time\_now() > session\_expires) {Feb 13, 2015[replace proto\_state struct with json\_t](/OpenIDC/mod_auth_openidc/commit/9761b44b0abcf189a0bbc0942659e1414d9b2fd0)Feb 13, 2015Blame prior to change 9761b44, made on Feb 13, 2015918919 oidc\_warn(r, "maximum session duration exceeded for user: %s", session->remote\_user);Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015920 oidc\_session\_kill(r, session);Jan 26, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve handling session duration expiry](/OpenIDC/mod_auth_openidc/commit/d7d80ed5db65556fceadb2c1f7b643d18717fe30)Jan 26, 2022Blame prior to change d7d80ed, made on Jan 26, 2022921922 \*rc = oidc\_handle\_unauthenticated\_user(r, cfg); return FALSE;Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015923924925 }
 /\* log message about max session duration \*/Feb 15, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session updates](/OpenIDC/mod_auth_openidc/commit/951f44c343534896cd59751704b642318c42e4e1)Feb 15, 2017Blame prior to change 951f44c, made on Feb 15, 2017926 oidc\_log\_session\_expires(r, "session max lifetime", session\_expires);Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015927
Jan 26, 2022![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[improve handling session duration expiry](/OpenIDC/mod_auth_openidc/commit/d7d80ed5db65556fceadb2c1f7b643d18717fe30)Jan 26, 2022Blame prior to change d7d80ed, made on Jan 26, 2022928929930 \*rc = OK;
 return TRUE;Feb 13, 2015[add support for configuration of maximum session duration](/OpenIDC/mod_auth_openidc/commit/6736a0a2675d6cb39e420d32f6aff380cf3042cd)Feb 13, 2015Blame prior to change 6736a0a, made on Feb 13, 2015931932}
Oct 12, 2015[enforce cookie domain check: issued domain vs. current domain](/OpenIDC/mod_auth_openidc/commit/265edf58343bd8110bbc477387cb6b3b813377fe)Oct 12, 2015Blame prior to change 265edf5, made on Oct 12, 2015933934935936937938939940941942/\* \* validate received session cookie against the domain it was issued for: \* \* this handles the case where the cache configured is a the same single memcache, Redis, or file \* backend for different (virtual) hosts, or a client-side cookie protected with the same secret \* \* it also handles the case that a cookie is unexpectedly shared across multiple hosts in \* name-based virtual hosting even though the OP(s) would be the same \*/static apr\_byte\_t oidc\_check\_cookie\_domain(request\_rec \*r, oidc\_cfg \*cfg,Jul 4, 2016[implement session handling with JSON objects](/OpenIDC/mod_auth_openidc/commit/4d2b9f8afa3feba71c6f10bf68130d56384a6206)Jul 4, 2016Blame prior to change 4d2b9f8, made on Jul 4, 2016943 oidc\_session\_t \*session) {Oct 12, 2015[enforce cookie domain check: issued domain vs. current domain](/OpenIDC/mod_auth_openidc/commit/265edf58343bd8110bbc477387cb6b3b813377fe)Oct 12, 2015Blame prior to change 265edf5, made on Oct 12, 2015944945 const char \*c\_cookie\_domain = cfg->cookie\_domain ?Dec 24, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make interpretation of X-Forwarded-\* headers configurable](/OpenIDC/mod_auth_openidc/commit/5215391ab1c54e7e606b9b735aab942e645417a1)Dec 24, 2021Blame prior to change 5215391, made on Dec 24, 2021946 cfg->cookie\_domain : oidc\_get\_current\_url\_host(r, cfg->x\_forwarded\_headers);Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session state calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/45797336f1c7284358043defc191d03f2f71ad77)Feb 21, 2017Blame prior to change 4579733, made on Feb 21, 2017947 const char \*s\_cookie\_domain = oidc\_session\_get\_cookie\_domain(r, session);Oct 12, 2015[enforce cookie domain check: issued domain vs. current domain](/OpenIDC/mod_auth_openidc/commit/265edf58343bd8110bbc477387cb6b3b813377fe)Oct 12, 2015Blame prior to change 265edf5, made on Oct 12, 2015948 if ((s\_cookie\_domain == NULL)Mar 28, 2023![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[replace apr\_strnatcmp/strcmp with \_oidc\_strcmp](/OpenIDC/mod_auth_openidc/commit/29ea79dea97cdab1b0d150af2c9a50a442e7216e)Mar 28, 2023Blame prior to change 29ea79d, made on Mar 28, 2023949 || (\_oidc\_strcmp(c\_cookie\_domain, s\_cookie\_domain) != 0)) {Oct 12, 2015[enforce cookie domain check: issued domain vs. current domain](/OpenIDC/mod_auth_openidc/commit/265edf58343bd8110bbc477387cb6b3b813377fe)Oct 12, 2015Blame prior to change 265edf5, made on Oct 12, 2015950951952953954955956957958 oidc\_warn(r, "aborting: detected attempt to play cookie against a different domain/host than issued for! (issued=%s, current=%s)", s\_cookie\_domain, c\_cookie\_domain); return FALSE; }
 return TRUE;}
Feb 26, 2016[refresh claims from the userinfo endpoint, see #119](/OpenIDC/mod_auth_openidc/commit/89f94016f033f1c5cfd9dc0ab6088c5b43a78d0a)Feb 26, 2016Blame prior to change 89f9401, made on Feb 26, 2016959960961/\* \* get a handle to the provider configuration via the "issuer" stored in the session \*/Sep 5, 2016[fix merging so values can be set back to default values in subdirs](/OpenIDC/mod_auth_openidc/commit/30a28c53533151411d20476a546b48c65bbf1453)Sep 5, 2016Blame prior to change 30a28c5, made on Sep 5, 2016962963apr\_byte\_t oidc\_get\_provider\_from\_session(request\_rec \*r, oidc\_cfg \*c, oidc\_session\_t \*session, oidc\_provider\_t \*\*provider) {Feb 26, 2016[refresh claims from the userinfo endpoint, see #119](/OpenIDC/mod_auth_openidc/commit/89f94016f033f1c5cfd9dc0ab6088c5b43a78d0a)Feb 26, 2016Blame prior to change 89f9401, made on Feb 26, 2016964965966967
 oidc\_debug(r, "enter");
 /\* get the issuer value from the session state \*/Feb 21, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[refactor session state calls into getters/setters functions](/OpenIDC/mod_auth_openidc/commit/45797336f1c7284358043defc191d03f2f71ad77)Feb 21, 2017Blame prior to change 4579733, made on Feb 21, 2017968 const char \*issuer = oidc\_session\_get\_issuer(r, session);Feb 26, 2016[refresh claims from the userinfo endpoint, see #119](/OpenIDC/mod_auth_openidc/commit/89f94016f033f1c5cfd9dc0ab6088c5b43a78d0a)Feb 26, 2016Blame prior to change 89f9401, made on Feb 26, 2016969 if (issuer == NULL) {May 18, 2021![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[make "no issuer found in session" a warning only](/OpenIDC/mod_auth_openidc/commit/99a8d9e52a9ce661cf9e649c99f865d90b2cee44)May 18, 2021Blame prior to change 99a8d9e, made on May 18, 2021970 oidc\_warn(r, "empty or invalid session: no issuer found");Feb 26, 2016[refresh claims from the userinfo endpoint, see #119](/OpenIDC/mod_auth_openidc/commit/89f94016f033f1c5cfd9dc0ab6088c5b43a78d0a)Feb 26, 2016Blame prior to change 89f9401, made on Feb 26, 2016971972973974975976977978979980981982983984985986987988989 return FALSE; }
 /\* get the provider info associated with the issuer value \*/ oidc\_provider\_t \*p = oidc\_get\_provider\_for\_issuer(r, c, issuer, FALSE); if (p == NULL) { oidc\_error(r, "session corrupted: no provider found for issuer: %s", issuer); return FALSE; }
 \*provider = p;
 return TRUE;}
/\* \* store claims resolved from the userinfo endpoint in the session \*/Nov 16, 2017![](https://avatars.githubusercontent.com/u/2339879?s=80&v=4)[release 2.3.3; add support for OIDCPassUserInfoAs](/OpenIDC/mod_auth_openidc/commit/56955b57c267bf3dcbec2abf634434ba4adeac67)Nov 16, 2017Blame prior to change 56955b5, made on Nov 16, 2017990991992static void oidc\_store\_userinfo\_claims(request\_rec \*r, oidc\_cfg \*c, oidc\_session\_t \*session, oidc\_provider\_t \*provider, const char \*claims, const char \*userinfo\_jwt) {Nov 9, 2016[remove stale claims from session when refreshing them fails; see #194](/OpenIDC/mod_auth_openidc/commit/348f282b94e932abf639613d81b0887b680d8920)Nov 9, 2016Blame prior to change 348f282, made on Nov 9, 2016993994995
 oidc\_debug(r, "enter");
Feb 26, 2016[refresh claims from the userinfo endpoint, see #119](/OpenIDC/mod_auth_openidc/commit/89f94016f033f1c5cfd9dc0ab6088c5b43a78d0a)Feb 26, 2016Blame prior to change 89f9401, made on Feb 26, 20169969979989991000 /\* see if we've resolved any claims \*/ if (claims != NULL) { /\* \* Successfully decoded a set claims from the response so we can store them \* (well actually the stringified representation in the response)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


