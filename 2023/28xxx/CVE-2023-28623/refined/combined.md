=== Content from github.com_6afc1639_20250114_211439.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fsecurity%2Fadvisories%2FGHSA-7p62-pjwg-56rv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fsecurity%2Fadvisories%2FGHSA-7p62-pjwg-56rv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=zulip%2Fzulip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zulip](/zulip)
/
**[zulip](/zulip/zulip)**
Public

* [Notifications](/login?return_to=%2Fzulip%2Fzulip) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fzulip%2Fzulip)
* [Star
   22k](/login?return_to=%2Fzulip%2Fzulip)

* [Code](/zulip/zulip)
* [Issues
  1.6k](/zulip/zulip/issues)
* [Pull requests
  890](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects
  2](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

Additional navigation options

* [Code](/zulip/zulip)
* [Issues](/zulip/zulip/issues)
* [Pull requests](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

# Unauthorized user can register an account in specific configurations involving LDAP and another external authentication backend

High

[alexmv](/alexmv)
published
GHSA-7p62-pjwg-56rv
May 19, 2023

## Package

Zulip

## Affected versions

2.1.0 through 6.1

## Patched versions

6.2

## Description

# Impact

If:

* `ZulipLDAPAuthBackend` and an external authentication backend (any aside of `ZulipLDAPAuthBackend` and `EmailAuthBackend`) are the only ones enabled in `AUTHENTICATION_BACKENDS` in `/etc/zulip/settings.py`
* The organization permissions don't require invitations to join

An attacker can create a new account in the organization with an arbitrary email address in their control that's not in the organization's LDAP directory.

The impact is limited to installations which have this specific combination of authentication backends as described above in addition to having `Invitations are required for joining this organization` organization permission disabled.

# Workaround

Enabling `Invitations are required for joining this organization` organization permission prevents this issue.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2023-28623

### Weaknesses

[CWE-285](/advisories?query=cwe%3A285)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_da460e72_20250114_211438.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F3df1b4dd7c210c21deb6f829df19412b74573f8d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F3df1b4dd7c210c21deb6f829df19412b74573f8d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=zulip%2Fzulip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zulip](/zulip)
/
**[zulip](/zulip/zulip)**
Public

* [Notifications](/login?return_to=%2Fzulip%2Fzulip) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fzulip%2Fzulip)
* [Star
   22k](/login?return_to=%2Fzulip%2Fzulip)

* [Code](/zulip/zulip)
* [Issues
  1.6k](/zulip/zulip/issues)
* [Pull requests
  890](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects
  2](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

Additional navigation options

* [Code](/zulip/zulip)
* [Issues](/zulip/zulip/issues)
* [Pull requests](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

## Commit

[Permalink](/zulip/zulip/commit/3df1b4dd7c210c21deb6f829df19412b74573f8d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

CVE-2023-28623: Prevent unauthorized signup with ldap + external auth.

[Browse files](/zulip/zulip/tree/3df1b4dd7c210c21deb6f829df19412b74573f8d)
Browse the repository at this point in the history

```
Since [74dd21c](https://github.com/zulip/zulip/commit/74dd21c8fa132f0e55691fc05cba812348a11d55) in Zulip Server 2.1.0, if:
- ZulipLDAPAuthBackend and an external authentication backend (any aside
  of ZulipLDAPAuthBackend and EmailAuthBackend) are the only ones
  enabled in AUTHENTICATION_BACKENDS in /etc/zulip/settings.py
- The organization permissions don't require invitations to join

...then an attacker can create a new account in the organization with
an arbitrary email address in their control that's not in the
organization's LDAP directory.

The impact is limited to installations which have the specific
combination of authentication backends described above, in addition to
having the "Invitations are required for joining this organization
organization" permission disabled.
```

* Loading branch information

[![@mateuszmandera](https://avatars.githubusercontent.com/u/45007152?s=40&v=4)](/mateuszmandera) [![@alexmv](https://avatars.githubusercontent.com/u/28347?s=40&v=4)](/alexmv)

[mateuszmandera](/zulip/zulip/commits?author=mateuszmandera "View all commits by mateuszmandera")
authored and
[alexmv](/zulip/zulip/commits?author=alexmv "View all commits by alexmv")
committed
May 18, 2023

1 parent
[baf9382](/zulip/zulip/commit/baf9382f2405d62ae387d6be24f0c7a0938bb4af)

commit 3df1b4d

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**90 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* zerver

  + tests

    - zerver/tests/test\_signup.py
      [test\_signup.py](#diff-940c870652d79870a457600e9cde59f74a5b9980268c9df6e62e0c0d846b7e66)
  + views

    - zerver/views/registration.py
      [registration.py](#diff-ef438982c0e0813a344af6f2022cad723baf88ca5b43807014e095ed9282bf84)

## There are no files selected for viewing

64 changes: 64 additions & 0 deletions

64
[zerver/tests/test\_signup.py](#diff-940c870652d79870a457600e9cde59f74a5b9980268c9df6e62e0c0d846b7e66 "zerver/tests/test_signup.py")

Show comments

[View file](/zulip/zulip/blob/3df1b4dd7c210c21deb6f829df19412b74573f8d/zerver/tests/test_signup.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4997,6 +4997,70 @@ def test\_ldap\_populate\_only\_registration\_from\_confirmation(self) -> None: |
|  |  | # EmailAuthBackend, there should be password field here. |
|  |  | self.assert\_in\_success\_response(["id\_password"], result) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=( |
|  |  | "zproject.backends.SAMLAuthBackend", |
|  |  | "zproject.backends.ZulipLDAPAuthBackend", |
|  |  | "zproject.backends.ZulipDummyBackend", |
|  |  | ) |
|  |  | ) |
|  |  | def test\_ldap\_registration\_email\_backend\_disabled\_bypass\_attempt(self) -> None: |
|  |  | """ |
|  |  | Tests for the case of LDAP + external auth backend being the ones enabled and |
|  |  | a user using the registration page to get a confirmation link and then trying |
|  |  | to use it to create a new account with their own email that's not authenticated |
|  |  | by either of the backends. |
|  |  | """ |
|  |  | email = "no\_such\_user\_in\_ldap@example.com" |
|  |  | subdomain = "zulip" |
|  |  |  |
|  |  | self.init\_default\_ldap\_database() |
|  |  | ldap\_user\_attr\_map = {"full\_name": "cn"} |
|  |  | full\_name = "New LDAP fullname" |
|  |  |  |
|  |  | result = self.client\_post("/register/", {"email": email}, subdomain=subdomain) |
|  |  |  |
|  |  | self.assertEqual(result.status\_code, 302) |
|  |  | self.assertTrue(result["Location"].endswith(f"/accounts/send\_confirm/{email}")) |
|  |  | result = self.client\_get(result["Location"]) |
|  |  | self.assert\_in\_response("Check your email", result) |
|  |  |  |
|  |  | with self.settings( |
|  |  | POPULATE\_PROFILE\_VIA\_LDAP=True, |
|  |  | LDAP\_APPEND\_DOMAIN="zulip.com", |
|  |  | AUTH\_LDAP\_USER\_ATTR\_MAP=ldap\_user\_attr\_map, |
|  |  | ): |
|  |  | # Click confirmation link |
|  |  | result = self.submit\_reg\_form\_for\_user( |
|  |  | email, |
|  |  | None, |
|  |  | full\_name="Ignore", |
|  |  | from\_confirmation="1", |
|  |  | # Pass HTTP\_HOST for the target subdomain |
|  |  | HTTP\_HOST=subdomain + ".testserver", |
|  |  | ) |
|  |  |  |
|  |  | self.assert\_in\_success\_response( |
|  |  | ["We just need you to do one last thing.", email], result |
|  |  | ) |
|  |  |  |
|  |  | # Submit the final form, attempting to register the user despite |
|  |  | # no match in ldap. |
|  |  | result = self.submit\_reg\_form\_for\_user( |
|  |  | email, |
|  |  | "newpassword", |
|  |  | full\_name=full\_name, |
|  |  | # Pass HTTP\_HOST for the target subdomain |
|  |  | HTTP\_HOST=subdomain + ".testserver", |
|  |  | ) |
|  |  | # Didn't create an account |
|  |  | with self.assertRaises(UserProfile.DoesNotExist): |
|  |  | UserProfile.objects.get(delivery\_email=email) |
|  |  | self.assertEqual(result.status\_code, 302) |
|  |  | self.assertEqual( |
|  |  | result["Location"], "/accounts/login/?email=no\_such\_user\_in\_ldap%40example.com" |
|  |  | ) |
|  |  |  |
|  |  | @override\_settings( |
|  |  | AUTHENTICATION\_BACKENDS=( |
|  |  | "zproject.backends.ZulipLDAPAuthBackend", |
| Expand Down | |  |

29 changes: 26 additions & 3 deletions

29
[zerver/views/registration.py](#diff-ef438982c0e0813a344af6f2022cad723baf88ca5b43807014e095ed9282bf84 "zerver/views/registration.py")

Show comments

[View file](/zulip/zulip/blob/3df1b4dd7c210c21deb6f829df19412b74573f8d/zerver/views/registration.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -394,9 +394,32 @@ def accounts\_register( |
|  |  | return\_data=return\_data, |
|  |  | ) |
|  |  | if user is None: |
|  |  | can\_use\_different\_backend = email\_auth\_enabled(realm) or ( |
|  |  | len(get\_external\_method\_dicts(realm)) > 0 |
|  |  | ) |
|  |  | # This logic is security-sensitive. The user has NOT been successfully authenticated |
|  |  | # with LDAP and we need to carefully decide whether they should be permitted to proceed |
|  |  | # with account creation anyway or be stopped. There are three scenarios to consider: |
|  |  | # |
|  |  | # 1. EmailAuthBackend is enabled for the realm. That explicitly means that a user |
|  |  | # with a valid confirmation link should be able to create an account, because |
|  |  | # they were invited or organization permissions allowed sign up. |
|  |  | # 2. EmailAuthBackend is disabled - that means the organization wants to be authenticating |
|  |  | # users with an external source (LDAP or one of the ExternalAuthMethods). If the user |
|  |  | # came here through one of the ExternalAuthMethods, their identity can be considered |
|  |  | # verified and account creation can proceed. |
|  |  | # 3. EmailAuthBackend is disabled and the user did not come here through an ExternalAuthMethod. |
|  |  | # That means they came here by entering their email address on the registration page |
|  |  | # and clicking the confirmation link received. That means their identity needs to be |
|  |  | # verified with LDAP - and that has just failed above. Thus the account should NOT be |
|  |  | # created. |
|  |  | # |
|  |  | if email\_auth\_enabled(realm): |
|  |  | can\_use\_different\_backend = True |
|  |  | # We can identify the user came here through an ExternalAuthMethod by password\_required |
|  |  | # being set to False on the PreregistrationUser object. |
|  |  | elif len(get\_external\_method\_dicts(realm)) > 0 and not password\_required: |
|  |  | can\_use\_different\_backend = True |
|  |  | else: |
|  |  | can\_use\_different\_backend = False |
|  |  |  |
|  |  | if settings.LDAP\_APPEND\_DOMAIN: |
|  |  | # In LDAP\_APPEND\_DOMAIN configurations, we don't allow making a non-LDAP account |
|  |  | # if the email matches the ldap domain. |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3df1b4d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F3df1b4dd7c210c21deb6f829df19412b74573f8d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


