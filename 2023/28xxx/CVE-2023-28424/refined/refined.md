Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from improper handling of user-supplied input in SQL queries. Specifically, the `searchTerm` parameter, used for searching packages, was directly concatenated into SQL queries without proper sanitization or escaping. This occurred in the `OrderExpr` clause and within the `BuildSearchQuery` function.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:** The direct insertion of the `searchTerm` into SQL queries creates a classic SQL injection vulnerability. This allows attackers to manipulate the queries to extract data, modify data, or even execute arbitrary commands on the database server.
*   **Unsafe Query Construction:** The `BuildSearchQuery` function was constructing SQL queries by concatenating strings, making it vulnerable to injection.
*   **Misuse of ORM:** The application used an ORM (`go-pg`), but misused its API by directly concatenating user input into query fragments instead of using placeholders.
*   **Lack of Prepared Statements:** The code was not using prepared statements correctly to handle user input, which would have prevented the SQL injection.

**Impact of Exploitation:**

*   **Arbitrary SQL Query Execution:** An attacker could execute arbitrary SQL queries on the database, bypassing access controls and potentially gaining access to sensitive information.
*   **Remote Code Execution (RCE):** Due to a misconfiguration of the PostgreSQL database container, attackers could leverage the SQL injection to execute arbitrary commands on the server hosting the database, potentially leading to full system compromise. This was achieved through the PostgreSQL `COPY FROM PROGRAM` feature.
*   **Data Manipulation:** Attackers could modify or delete data within the database.
*   **Loss of Integrity and Availability:** The ability to modify the database would lead to a loss of data integrity and system availability.

**Attack Vectors:**

*   **Network:** The vulnerability is accessible over the network through the application's search functionality on the web interface and the GraphQL API.
*   **HTTP Requests:** The `searchTerm` parameter was injectable via HTTP requests to the application's search endpoints.
*   **GraphQL API:** The `searchTerm` parameter was also injectable via the GraphQL API endpoint.

**Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The attacker requires no prior authentication to exploit the vulnerability.
*   **Network Access:** The attacker needs network access to the application's web server.
*   **Understanding of SQL Syntax:** Knowledge of SQL syntax is needed to craft malicious injection payloads, as well as knowledge of postgresql specifics for the RCE.

**Additional Notes:**

*   The vulnerability was discovered by SonarSource, who also provided a detailed blog post explaining the issue.
*   The maintainers of Soko quickly addressed the vulnerability by refactoring the query building logic and correctly using placeholders and prepared statements.
*   The fix involved passing the `pg.Query` object to the `BuildSearchQuery` function, allowing proper escaping of user-supplied data.
*  The SQL injection was present in both the standard HTTP search handlers, `Search` and `SearchFeed`, and the `PackageSearch` GraphQL resolver.
*  The `COPY FROM PROGRAM` is a documented feature of PostgreSQL and not a vulnerability in itself; however, the default container configuration allows the root user to use it.

This information is more detailed than the initial CVE description which was a placeholder.