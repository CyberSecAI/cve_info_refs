=== Content from github.com_6c1aefd5_20250114_205227.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpretalx%2Fpretalx%2Freleases%2Ftag%2Fv2.3.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpretalx%2Fpretalx%2Freleases%2Ftag%2Fv2.3.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=pretalx%2Fpretalx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pretalx](/pretalx)
/
**[pretalx](/pretalx/pretalx)**
Public

* [Notifications](/login?return_to=%2Fpretalx%2Fpretalx) You must be signed in to change notification settings
* [Fork
  211](/login?return_to=%2Fpretalx%2Fpretalx)
* [Star
   757](/login?return_to=%2Fpretalx%2Fpretalx)

* [Code](/pretalx/pretalx/tree/v2.3.2)
* [Issues
  75](/pretalx/pretalx/issues)
* [Pull requests
  12](/pretalx/pretalx/pulls)
* [Discussions](/pretalx/pretalx/discussions)
* [Actions](/pretalx/pretalx/actions)
* [Wiki](/pretalx/pretalx/wiki)
* [Security](/pretalx/pretalx/security)
* [Insights](/pretalx/pretalx/pulse)

Additional navigation options

* [Code](/pretalx/pretalx/tree/v2.3.2)
* [Issues](/pretalx/pretalx/issues)
* [Pull requests](/pretalx/pretalx/pulls)
* [Discussions](/pretalx/pretalx/discussions)
* [Actions](/pretalx/pretalx/actions)
* [Wiki](/pretalx/pretalx/wiki)
* [Security](/pretalx/pretalx/security)
* [Insights](/pretalx/pretalx/pulse)

1. [Releases](/pretalx/pretalx/releases)
2. [v2.3.2](/pretalx/pretalx/releases/tag/v2.3.2)

# v2.3.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/pretalx/pretalx/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.3.2)

 Loading

[View all tags](/pretalx/pretalx/tags)

![@rixx](https://avatars.githubusercontent.com/u/2657547?s=40&v=4)
[rixx](/rixx)
released this
07 Mar 12:22

·
[1771 commits](/pretalx/pretalx/compare/v2.3.2...main)
to main
since this release

[v2.3.2](/pretalx/pretalx/tree/v2.3.2)

[`44f4b4f`](/pretalx/pretalx/commit/44f4b4fb1531af24f9504a804028970193fa57c9)

Fixes a path traversal vulnerability in the static HTML exporter.

 Assets
6

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.sonarsource.com_c04c2e47_20250114_205228.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Pretalx Vulnerabilities: How to get accepted at every conference

![](data:image/svg+xml;charset=utf-8...)![Stefan Schiller photo]()![Stefan Schiller photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bfd8cc06-d437-4ab4-9039-66ec3affeeea/stefan.jpg?w=800&h=800&auto=format&fit=crop)

Stefan Schiller

Vulnerability Researcher

April 12, 2023

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/40870ddd-2321-4066-8441-13d3aa98ce7a/get-accepted-at-every-conference_blog-index.webp?w=1200&h=628&auto=format&fit=crop)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/40870ddd-2321-4066-8441-13d3aa98ce7a/get-accepted-at-every-conference_blog-index.webp?w=1200&h=628&auto=format&fit=crop)

[Pretalx](https://pretalx.com/p/about/ "Pretalx") is a web-based conference planning tool, which is used to manage call for papers (CfP) submissions, select talks, communicate with speakers, and publish conference schedules. Major IT security conferences like [OffensiveCon](https://cfp.offensivecon.org/offensivecon23/ "OffensiveCon"), [Hexacon](https://cfp.hexacon.fr/hexacon-2023/cfp "Hexacon"), and [TROOPERS](https://cfp.troopers.de/tr23/cfp "TROOPERS") are only a few of the numerous users of pretalx. Due to the call for papers functionality, a pretalx instance can contain data about yet undisclosed research, which makes it an interesting target for threat actors.

While submitting talks to some conferences, we wondered how secure the CfP platforms are and decided to audit the popular pretalx for security vulnerabilities. During this research, we identified an arbitrary file read and a limited file write vulnerability. When determining the impact of these vulnerabilities, we found a **generic technique to turn a file write into code execution** by leveraging a specific feature of Python.

In this article, we outline the impact of the vulnerabilities and dive into the technical details. Furthermore, we introduce the generic technique to gain code execution via a file write vulnerability. In the end, we explain how the vulnerabilities can be mitigated by having a look at the applied patches.

## Impact

We discovered the following vulnerabilities in pretalx, which affect versions `2.3.1` and prior:

* CVE-2023-28459: Arbitrary File Read
* CVE-2023-28458: Limited File Write

The first vulnerability allows a privileged user to **disclose any file** from the server's filesystem, which is accessible by the pretalx process.

The second vulnerability allows a user with access to a scheduled talk to write files on the server's filesystem. If the application is running in **debug mode**, the content of these files can be controlled, which leads to **remote code execution**.

Both vulnerabilities were fixed in pretalx version `2.3.2`, which was released in an incredible time of [fewer than 3 hours after our notification](https://pretalx.com/p/news/security-release-232/ "fewer than 3 hours after our notification"). The SaaS platform pretalx.com was immediately patched. We strongly recommend updating any self-hosted instance with a version before this release.

## Technical Details

In this section, we dive into the technical details of both vulnerabilities.

### Arbitrary File Read (CVE-2023-28459)

Pretalx allows privileged users to create and download a static HTML export of a schedule. The creation of the exported HTML is also triggered automatically on a regular basis, [usually via a cron job](https://docs.pretalx.org/administrator/installation.html#step-9-provide-periodic-tasks "usually via a cron job").

The function responsible for creating the export performs the following steps:

* Iterate over all URLs required for the schedule.
* Dump its content to a temporary folder which will later be archived in a zip file.
* Retrieve all URLs to additional assets.
* Dump all additional assets in a second iteration.

Since user-uploaded resources are also part of the schedule, attackers can make the application process arbitrary URLs in the second iteration by uploading an HTML file that references an asset using an `img` tag's `src` attribute.

URLs beginning with `STATIC_ROOT` or `MEDIA_ROOT` will first be read directly from disk:

```
def get_mediastatic_content(url):
  if url.startswith(settings.STATIC_URL):
    local_path = settings.STATIC_ROOT / url[len(settings.STATIC_URL):]
  elif url.startswith(settings.MEDIA_URL):
    local_path = settings.MEDIA_ROOT / url[len(settings.MEDIA_URL):]
  else:
    raise FileNotFoundError()

  with open(local_path, "rb") as f:
    return f.read()
```

Since there is no check whether the final `local_path` is within the `STATIC_ROOT` or `MEDIA_ROOT` folder, arbitrary files can be referenced using the path traversal sequence `../`. This can also be achieved by using an absolute path. If the second part of the path begins with a slash (`/`), the first part of the path is ignored:

```
MEDIA_ROOT = Path('/var/pretalx/data/media')
MEDIA_URL = '/media/'

url = '/media//etc/passwd'
local_path = MEDIA_ROOT / url[len(MEDIA_URL):]

print(local_path)
# '/etc/passwd'
```

You can read more about similar security pitfalls in Python in our blog post on [10 Unknown Security Pitfalls for Python](https://www.sonarsource.com/blog/10-unknown-security-pitfalls-for-python/ "10 Unknown Security Pitfalls for Python").

### Limited File Write (CVE-2023-28458)

The second vulnerability also resides within the HTML export feature. The function responsible for dumping the content retrieved from a URL is called `dump_content` and uses the URL (parameter `path`) to determine the destination path. Although leading slashes are removed from `path` before being added to the destination folder, it is not ensured that the final path is below the destination folder:

```
def dump_content(destination, path, getter):
  # retrieve content (path is the URL)
  content = getter(path)

  # create folders if necessary
  path = Path(destination) / path.lstrip("/")
  path.parent.mkdir(parents=True, exist_ok=True)

  # write content to file
  with open(path, "wb") as f:
    f.write(content)
  return content
```

Attackers can again leverage the string sequence `../` to traverse out of the destination folder, resulting in arbitrary file write. This could be exploited by a self-registered user with access to a talk that has been added to a schedule. However, the content of the file cannot be controlled in most cases, because referencing an invalid URL returns the 404 error page. This is different if the application is running in `DEBUG` mode as we will demonstrate now.

In `DEBUG` mode, user-uploaded resources are served from the Django application itself instead of a reverse proxy. When the content of a URL is retrieved and cannot be read from disk via the `get_mediastatic_content` function, the Django test client is used to read the content from the application:

```
def get(url):
  try:
    # Try getting the file from disk directly first, …
    return get_mediastatic_content(url)
  except FileNotFoundError:
    # … then fall back to asking the views.
    response = client.get(url, is_html_export=True, HTTP_ACCEPT="text/html")
    content = get_content(response)
    return content
```

In order to make the application read a user-uploaded resource via the Django test client, an attacker can simply URL-encode one of the first characters to prevent that the URL begins with `MEDIA_ROOT`. This is possible because the Django test client decodes the URL before accessing it.

The URL-decoding of the Django test client also introduces a significant difference from the filesystem path handling when the content is written to disk. The following URL is a valid reference to a user-uploaded resource for the Django test client:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/536f0169-6aa2-4cee-ad80-b91d4ce2a229/pretalx-01.png?w=1611&h=450&auto=format&fit=crop)

When the retrieved contents are written to disk, though, the path is **not** URL-decoded. This means that the following file is written:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e42a6861-0dd5-45d4-a17e-ad645922cc25/pretalx-02.png?w=1614&h=528&auto=format&fit=crop)

In conjunction with the path traversal, this can be leveraged to write the user-controlled resource to an arbitrary file. The following URL is still a valid reference to the user-uploaded resource for the Django test client:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ca5de244-7a34-45c3-8b86-566309e3b197/pretalx-03.png?w=1647&h=909&auto=format&fit=crop)

When the path is processed to write the file to disk, things look a little different:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/38bca44a-6ef8-4fbe-80af-c5872dcf4870/pretalx-04.png?w=1647&h=1020&auto=format&fit=crop)

Thus, the user-controlled content is written to `/tmp` in a file called `%2e%2e%2fmedia%2ftest-event%2fsubmissions%2fXXX%2fresources%2fupload.txt`.

When determining the impact of this arbitrary file write, we discovered a generic technique to gain code execution.

## Code Execution via Site-Specific Configuration Hooks

The requirements for this technique are the following:

* Control over the file extension
* Control over the beginning of any line in the file
* Ability to write the file to `~/.local/lib/pythonX.Y/site-packages/`
* At some point, a new Python process is launched with the same identity

Python supports a feature called [site-specific configuration hooks](https://docs.python.org/3/library/site.html "site-specific configuration hooks"). Its main purpose is to add custom paths to the module search path. To do this, a `.pth` file with an arbitrary name can be put in the `.local/lib/pythonX.Y/site-packages/` folder in a user's home directory:

```
user@host:~$ echo '/tmp' > ~/.local/lib/python3.10/site-packages/foo.pth
```

When a new Python process is spawned, the path `/tmp` is added to the module search path `sys.path`:

```
user@host:~$ python3
>>> import sys
>>> sys.path
[ ... '/tmp', ... ]
```

Although there might be some cases where the ability to add a path to the module search path can be leveraged to gain code execution, bear with us. It even gets better.

Looking at the [implementation](https://github.com/python/cpython/blob/3.11/Lib/site.py "implementation") of the site-specific configuration, the following part screams for attention:

```
def addpackage(sitedir, name, known_paths):
  # ...
  for n, line in enumerate(f):
    # ...
    try:
      if line.startswith(("import ", "import\t")):
        exec(line)
        continue
```

If a line in a `.pth` file starts with `"import "` or `"import\t"`, it will be evaluated as Python code! This is clearly described in the [docs](https://docs.python.org/3/library/site.html "docs"):

*[...] Lines starting with import (followed by space or tab) are executed. [...]*

[This video from anthonywritescode](https://youtu.be/mzxQrgvuRFg?t=107 "This video from anthonywritescode") also mentions that this feature could be used to gain arbitrary code execution.

So, let's see this in action. We create a new `.pth` file, which pipes the output of the `whoami` command to `/tmp/x`. Once a new Python process is spawned, the command is executed:

```
user@host:~$ echo 'import os;os.system("whoami>/tmp/x")' > .local/lib/python3.10/site-packages/arbitrary_name.pth
user@host:~$ cat /tmp/x
cat: /tmp/x: No such file or directory
user@host:~$ python3
>>> CTRL + D
user@host:~$ cat /tmp/x
user
```

The fact that this technique only requires a limited amount of file control makes it very appealing. Having control over the extension of a file and one single line in it is not that uncommon. The most restrictive requirements are that the destination path must be controllable and that a new Python process is spawned in the context of the targeted user.

Regarding the destination path, it is worth mentioning that the base path, from which the `.pth` files are read, can be changed via the `PYTHONUSERBASE` environment variable. If a file write vulnerability does not allow to write to the user's home directory but it is possible to influence this environment variable of any spawned Python process, the `.pth` file can be stored in another directory (the subfolders `lib/pythonX.Y/site-packages/` are still required):

```
user@host:~$ cat /tmp/x
cat: /tmp/x: No such file or directory
user@host:~$ mkdir -p /tmp/lib/python3.10/site-packages
user@host:~$ echo 'import os;os.system("whoami>/tmp/x")' > /tmp/lib/python3.10/site-packages/some_name.pth
user@host:~$ export PYTHONUSERBASE='/tmp'
user@host:~$ python3
>>> CTRL + D
user@host:~$ cat /tmp/x
user
```

Regarding pretalx, this technique can be used to turn the file write into code execution, if running in `DEBUG` mode. The payload is executed once a new Python process is spawned to perform [periodic tasks](https://docs.pretalx.org/administrator/installation.html#step-9-provide-periodic-tasks "periodic tasks").

## Patch

The file read vulnerability in pretalx was fixed by first resolving the `local_path` and then ensuring that it is either within the `MEDIA_ROOT` or `STATIC_ROOT`:

```
def get_mediastatic_content(url):
  # ...
  # Prevent directory traversal, make sure the path is inside the media or static root
  local_path = local_path.resolve(strict=True)
  if not any(
    path in local_path.parents
    for path in (settings.MEDIA_ROOT, settings.STATIC_ROOT)
  ):
    raise FileNotFoundError()
```

Similarly, the file write vulnerability was fixed by first resolving the destination path and then ensuring that it is below the destination folder:

```
def dump_content(destination, path, getter):
  # ...
  path = (Path(destination) / path.lstrip("/")).resolve()
  if not Path(destination) in path.parents:
    raise CommandError("Path traversal detected, aborting.")
```
## Timeline

| **Date** | **Action** |
| --- | --- |
| 2023-03-07, 11:09 CET | We report all issues to pretalx. |
| 2023-03-07, 12:55 CET | Vendor confirms the issues. |
| 2023-03-07, 13:50 CET | Vendor releases patched version 2.3.2 and publishes official announcement. |

## Summary

In this article, we detailed a file read and file write vulnerability we discovered in the conference planning tool pretalx. Furthermore, we introduced a generic technique to turn a file write vulnerability into code execution by leveraging Python's `.pth` files. We also learned how to prevent these vulnerabilities by looking at the applied patches.

At last, we would like to thank the pretalx maintainer for acknowledging the issues and providing a patch in an astonishing time of fewer than 3 hours.

## Related Blog Posts

* [10 Unknown Security Pitfalls for Python](https://www.sonarsource.com/blog/10-unknown-security-pitfalls-for-python/ "10 Unknown Security Pitfalls for Python")
* [Disclosing information with a side-channel in Django](https://www.sonarsource.com/blog/disclosing-information-with-a-side-channel-in-django/ "Disclosing information with a side-channel in Django")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from github.com_82d9a9cc_20250114_205226.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpretalx%2Fpretalx%2Fcommit%2F60722c43cf975f319e94102e6bff320723776890)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpretalx%2Fpretalx%2Fcommit%2F60722c43cf975f319e94102e6bff320723776890)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pretalx%2Fpretalx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pretalx](/pretalx)
/
**[pretalx](/pretalx/pretalx)**
Public

* [Notifications](/login?return_to=%2Fpretalx%2Fpretalx) You must be signed in to change notification settings
* [Fork
  211](/login?return_to=%2Fpretalx%2Fpretalx)
* [Star
   757](/login?return_to=%2Fpretalx%2Fpretalx)

* [Code](/pretalx/pretalx)
* [Issues
  75](/pretalx/pretalx/issues)
* [Pull requests
  12](/pretalx/pretalx/pulls)
* [Discussions](/pretalx/pretalx/discussions)
* [Actions](/pretalx/pretalx/actions)
* [Wiki](/pretalx/pretalx/wiki)
* [Security](/pretalx/pretalx/security)
* [Insights](/pretalx/pretalx/pulse)

Additional navigation options

* [Code](/pretalx/pretalx)
* [Issues](/pretalx/pretalx/issues)
* [Pull requests](/pretalx/pretalx/pulls)
* [Discussions](/pretalx/pretalx/discussions)
* [Actions](/pretalx/pretalx/actions)
* [Wiki](/pretalx/pretalx/wiki)
* [Security](/pretalx/pretalx/security)
* [Insights](/pretalx/pretalx/pulse)

## Commit

[Permalink](/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix path traversal in static HTML export

[Browse files](/pretalx/pretalx/tree/60722c43cf975f319e94102e6bff320723776890)
Browse the repository at this point in the history

```
This vulnerability was discovered by Sonar,
<https://www.sonarsource.com/>, who provided a detailled description of
the vulnerability, and also the fix as it is applied here.

The fix will be backported to the last release, v2.3.1, and released as
v2.3.2. A blog post will be published on pretalx.com.
```

* Loading branch information

[![@rixx](https://avatars.githubusercontent.com/u/2657547?s=40&v=4)](/rixx)

[rixx](/pretalx/pretalx/commits?author=rixx "View all commits by rixx")
committed
Mar 7, 2023

1 parent
[4732e8f](/pretalx/pretalx/commit/4732e8f5592eeeb3c75233a783985158e3dd12bb)

commit 60722c4

Showing
**1 changed file**
with
**11 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 11 additions & 1 deletion

12
[src/pretalx/agenda/management/commands/export\_schedule\_html.py](#diff-a6d8ddc5db49abfeb1da80ec428da177de475629763d4df206d6edb76bea627f "src/pretalx/agenda/management/commands/export_schedule_html.py")

Show comments

[View file](/pretalx/pretalx/blob/60722c43cf975f319e94102e6bff320723776890/src/pretalx/agenda/management/commands/export_schedule_html.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -115,7 +115,9 @@ def dump\_content(destination, path, getter): |
|  |  | if path.endswith("/"): |
|  |  | path = path + "index.html" |
|  |  |  |
|  |  | path = Path(destination) / path.lstrip("/") |
|  |  | path = (Path(destination) / path.lstrip("/")).resolve() |
|  |  | if not Path(destination) in path.parents: |
|  |  | raise CommandError("Path traversal detected, aborting.") |
|  |  | path.parent.mkdir(parents=True, exist\_ok=True) |
|  |  |  |
|  |  | with open(path, "wb") as f: |
| Expand All | | @@ -131,6 +133,14 @@ def get\_mediastatic\_content(url): |
|  |  | else: |
|  |  | raise FileNotFoundError() |
|  |  |  |
|  |  | # Prevent directory traversal, make sure the path is inside the media or static root |
|  |  | local\_path = local\_path.resolve(strict=True) |
|  |  | if not any( |
|  |  | path in local\_path.parents |
|  |  | for path in (settings.MEDIA\_ROOT, settings.STATIC\_ROOT) |
|  |  | ): |
|  |  | raise FileNotFoundError() |
|  |  |  |
|  |  | with open(local\_path, "rb") as f: |
|  |  | return f.read() |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `60722c4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpretalx%2Fpretalx%2Fcommit%2F60722c43cf975f319e94102e6bff320723776890) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from pretalx.com_a78d0993_20250114_205227.html ===

[![](/static/common/img/logo_white.b44a43e1f410.svg)](/p/about/)

* [Home](/p/about/)
* [Features](/p/features)
* [Pricing](/p/pricing)
* [Try it!](/p/try)
* [News](/p/news/)

* [![](/static/pretalx_com/img/noun_unlock.aa780847e42d.svg)
  Login](/orga/start/redirect)
* [Deutsch](/locale/set?locale=de&next=/p/news/security-release-232/%3F)

## Security release v2.3.2

March 7, 2023

We were hoping that our next blog post would be the announcement of the big new pretalx 3.0 release (which we still hope to release in the first half of 2023!), but sadly we have one security release to issue beforehand: pretalx v2.3.2 fixes a path traversal vulnerability in the "HTML export" functionality in pretalx.

**(Users of [pretalx.com](http://pretalx.com) don't need to take any action – [pretalx.com](http://pretalx.com) always has the latest security fixes installed already.)**

### The vulnerability

In the off-by-default static HTML export, all pages of an event are exported in a single zip archive, so that users can keep backups of their event without having to keep pretalx around, updates and all, and to make sure the pages look like they looked at the time of the event, and don't get updated when pretalx gets updated.

This HTML export includes user-uploaded files, like presentations and slides. Users were able to upload HTML files with malicious content, leading pretalx to read arbitrary files it had access to, and include those files in the HTML export provided to organisers. This way, organisers were able to exfiltrate files from the server pretalx was running on. The same way, organisers were able to trigger file writes, where they could choose to override files with the standard pretalx 404 page content.

### Timeline and impact

The two vulnerabilities were discovered by researchers at [Sonar](https://sonarsource.com/), who notified us today at 11:09 a.m CET. Their advisory not only included a detailed reproduction of both issues, but also recommendations for code fixes that we were able to apply to both the last pretalx release and our current development copy. After testing the report and the fix, we released pretalx v2.3.2 at ca. 1:30 p.m. CET and deployed the fix on [pretalx.com](http://pretalx.com).

The two vulnerabilities have not been exploited on [pretalx.com](http://pretalx.com).

### Updates

We urge all self-hosted pretalx instances to update to either pretalx v2.3.2 or the main branch, as documented in our [update guide](https://docs.pretalx.org/administrator/maintenance.html#updates). If you were running pretalx in the insecure and unrecommended development mode, please be advised that the second vulnerability may have opened you to arbitrary file writes and even code execution, depending on your setup. Never run the pretalx development mode in production!

Please follow this blog, our RSS feed, our [Twitter](https://twitter.com/pretalx) account, or a [feed of our releases](https://libraries.io/pypi/pretalx/versions.atom) to make sure your pretalx instance is up to date.

We'd like to thank the researchers at [Sonar](https://www.sonarsource.com/) for following our disclosure guidelines and their effort to not only identify, but also remediate these vulnerabilities. If you notice any security problems or have any questions on this topic, please contact us **in private** at security@pretalx.com.

## Contact pretalx

#### Looking forward to hearing from you!

![](/static/pretalx_com/img/mail2.12f691bc2fbf.svg)
###### Email

info@pretalx.com
![](/static/pretalx_com/img/phone.4b38b5f0e94e.svg)
###### Phone

+49 7154 96 02 404
![](/static/pretalx_com/img/location.46cf10c7af99.svg)
###### Address

Mühlenbecker Weg 1

16515 Oranienburg

![](/static/common/img/logo_success.a90e4d4cdb9d.svg)
#### Product

[pretalx](/p/about/)
[Features](/p/features)
[Hosting services](/p/pricing)
[Try it](/p/try)

#### About pretalx

[Blog](/p/news/)
[Documentation](https://docs.pretalx.org)
[GitHub](https://github.com/pretalx)
[rixx.de Software](https://rixx.de)

#### Tech

[Source](https://github.com/pretalx/pretalx)
[Documentation](https://docs.pretalx.org)
[REST API](https://docs.pretalx.org/api/fundamentals.html)
[Security](/p/security/)

#### Legal

[Imprint](/p/imprint)
[Pricing](/p/pricing)
[Terms of Service](/p/terms)
[Privacy](/p/privacy)

#### Contact

info@pretalx.com
+49 7154 96 02 404
[Twitter](https://twitter.com/pretalx)
[Mastodon](https://chaos.social/%40pretalx)
[LinkedIn](https://linkedin.com/company/pretalx)


