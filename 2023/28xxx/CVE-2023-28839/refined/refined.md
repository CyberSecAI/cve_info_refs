The provided content is related to CVE-2023-28839.

**Root cause of vulnerability:**
The vulnerability is caused by the lack of proper sanitization of the `token` parameter in the `ShoppingfeedToken::findByToken()` function. This allows for SQL injection via the POST or GET submitted variable `token`.

**Weaknesses/vulnerabilities present:**
- SQL injection vulnerability in `ShoppingfeedToken::findByToken()` function.
- Improper neutralization of input.

**Impact of exploitation:**
- Technical and personal data leaks.
- Obtain admin access.
- Remove all data of the linked PrestaShop.
- Display sensitive tables to front-office to unlock potential adminâ€™s ajax scripts of modules protected by token on the ecosystem.

**Attack vectors:**
- HTTP GET or POST requests with a malicious `token` parameter.

**Required attacker capabilities/position:**
- Remote attacker, no authentication required.

**Additional details:**

- The vulnerability is present in "Shoppingfeed Prestashop Plugin (Feed&Order)" (aka shoppingfeed) for PrestaShop versions from 1.4.0 to 1.8.2.
- The fix was implemented in version 1.8.3 by sanitizing the `token` parameter using `pSQL()`.
- The vulnerability is rated as critical with a CVSS score of 9.8.
- The vulnerability was discovered by Wargan Solutions.
- The advisory recommends upgrading the module beyond 1.8.3 and PrestaShop beyond 1.7.8.8 (and 8.0.1) to disable multiquery executions. It also recommends changing the default database prefix and activating OWASP 942's rules on WAF.
- The patch diff shows the change from `->where("content = '$token'")` to `->where('content = "' . pSQL($token) . '"')`