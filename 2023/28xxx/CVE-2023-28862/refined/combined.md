=== Content from gitlab.ow2.org_62c6324c_20250114_181830.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)



=== Content from lists.debian.org_52af44be_20250114_181830.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 3496-1] lemonldap-ng security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3496-1] lemonldap-ng security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Fri, 14 Jul 2023 12:43:11 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZLEmv3QcZPjL92aO%40debian.org)Â [ZLEmv3QcZPjL92aO@debian.org](msg00018.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3496-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
July 14, 2023                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : lemonldap-ng
Version        : 2.0.2+ds-7+deb10u9
CVE ID         : CVE-2023-28862

Issues were discovered in Lemonldap::NG, an OpenID-Connect, CAS and SAML
compatible Web-SSO system, which could lead to impersonation of users
with a second factor authentication.

Weak session ID generation in the AuthBasic handler and incorrect
failure handling during a password check allow attackers to bypass 2FA
verification.  Any plugin that tries to deny session creation after the
store step does not deny an AuthBasic session.

Using the AuthBasic handler is now refused for users with a second
factor.  Admins who are *absolutely sure* that such accounts should be
able to use AuthBasic handlers (which are password only) can append `and
not $ENV{AuthBasic}` to the 2FA activation rules.

For Debian 10 buster, these problems have been fixed in version
2.0.2+ds-7+deb10u9.

We recommend that you upgrade your lemonldap-ng packages.

For the detailed security status of lemonldap-ng please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/lemonldap-ng>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpDQCYI06wiI.pgp)**

*Description:* PGP signature

---



=== Content from gitlab.ow2.org_555b6260_20250114_181830.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# [Security][CVE-2023-28862] AuthBasic does not handle failure correctly

### Concerned version

Version: 2.0.16

### Summary

The AuthBasic handler works like this:

* It computes a sessionid from login+password
* If sessionid already exists in the session DB, authenticate user
* Else, try to create the corresponding session by sending the login+pass to the portal RESTServer plugin

However, the only required step in the login flow is `store`, if anything happens after the`store` step, AuthBasic will succeed because the fixed-id session has been successfully created, which means:

* Accounts that are supposed to be 2FA-protected are not 2FA protected when AuthBasic is used
* If a 2FA module returns an error, the *first* AuthBasic request will 401, but the *second* AuthBasic request will work correctly => *VERY CONFUSING*
* Any plugin that tries to deny session *after* the `store` step will not deny AuthBasic sessions

This is probably a security issue

### Possible fixes

If the AuthBasic login process fails (not PE\_OK), we need to remove the session created by `store` and return an error

This will cause a regression: users who relied on AuthBasic working for 2FA protected account will now see failures
Possible solution: use an env variable in 2FA activation rules if desired:

```
has2f("TOTP") and not $env->{"AuthBasic"}
```

or something of that sort

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


