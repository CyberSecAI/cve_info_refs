=== Content from github.com_4dd5b090_20250114_211253.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fsecurity%2Fadvisories%2FGHSA-pfm5-6vhv-3ff3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fsecurity%2Fadvisories%2FGHSA-pfm5-6vhv-3ff3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=OpenSIPS%2Fopensips)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenSIPS](/OpenSIPS)
/
**[opensips](/OpenSIPS/opensips)**
Public

* [Notifications](/login?return_to=%2FOpenSIPS%2Fopensips) You must be signed in to change notification settings
* [Fork
  583](/login?return_to=%2FOpenSIPS%2Fopensips)
* [Star
   1.3k](/login?return_to=%2FOpenSIPS%2Fopensips)

* [Code](/OpenSIPS/opensips)
* [Issues
  266](/OpenSIPS/opensips/issues)
* [Pull requests
  34](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects
  0](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

Additional navigation options

* [Code](/OpenSIPS/opensips)
* [Issues](/OpenSIPS/opensips/issues)
* [Pull requests](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

# Vulnerability in the ds\_is\_in\_list() function

Moderate

[liviuchircu](/liviuchircu)
published
GHSA-pfm5-6vhv-3ff3
Mar 15, 2023

## Package

opensips
(OpenSIPS Core)

## Affected versions

<= 3.1.8, <= 3.2.5

## Patched versions

3.1.9, 3.2.6

## Description

### Impact

If `ds_is_in_list()` is used with an invalid IP address string (`NULL` is illegal input), OpenSIPS will attempt to print a string from a random address (stack garbage), which could lead to a crash. All users of `ds_is_in_list()` without the `$si` variable as 1st parameter could be affected by this vulnerability to a larger, lesser or no extent at all, depending if the data passed to the function is a valid IPv4 or IPv6 address string or not.

### Patches

Fixed in [e2f13d374](https://github.com/OpenSIPS/opensips/commit/e2f13d374) and backported down to `3.1` branch. The fixes will be/are available starting with the `3.1.9` and `3.2.6` minor releases.

### Workarounds

No

### References

[#2780](https://github.com/OpenSIPS/opensips/issues/2780)

### For more information

If you have any questions or comments about this advisory:

* Open an issue under the [OpenSIPS Issues Tracker](https://github.com/OpenSIPS/opensips/issues)
* Email us at team@opensips.org

### Credits

Many thanks to [@Cossack9989](https://github.com/Cossack9989) for finding and reporting this issue!

### Severity

Moderate

5.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-28099

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5d804a0e_20250114_211251.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fissues%2F2780)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fissues%2F2780)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=OpenSIPS%2Fopensips)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenSIPS](/OpenSIPS)
/
**[opensips](/OpenSIPS/opensips)**
Public

* [Notifications](/login?return_to=%2FOpenSIPS%2Fopensips) You must be signed in to change notification settings
* [Fork
  583](/login?return_to=%2FOpenSIPS%2Fopensips)
* [Star
   1.3k](/login?return_to=%2FOpenSIPS%2Fopensips)

* [Code](/OpenSIPS/opensips)
* [Issues
  266](/OpenSIPS/opensips/issues)
* [Pull requests
  34](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects
  0](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

Additional navigation options

* [Code](/OpenSIPS/opensips)
* [Issues](/OpenSIPS/opensips/issues)
* [Pull requests](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FOpenSIPS%2Fopensips%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FOpenSIPS%2Fopensips%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vuln] Potential arbitrary-memory-log in ds\_is\_in\_list due to uninit varaible on stack #2780

Closed

[Cossack9989](/Cossack9989) opened this issue
Mar 16, 2022
· 9 comments

Closed

# [[Vuln] Potential arbitrary-memory-log in ds\_is\_in\_list due to uninit varaible on stack](#top) #2780

[Cossack9989](/Cossack9989) opened this issue
Mar 16, 2022
· 9 comments

Assignees
[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&v=4)](/liviuchircu)

Labels
[bug](/OpenSIPS/opensips/labels/bug)
[fixed](/OpenSIPS/opensips/labels/fixed)

Milestone
[3.1.17](/OpenSIPS/opensips/milestone/14 "3.1.17")

## Comments

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

### **[Cossack9989](/Cossack9989)** commented [Mar 16, 2022](#issue-1170721726)

| Sorry to issue this publicly, but when I mailed to security@opensips.org, googlemail told me that "Your message wasn't delivered to security@opensips.org because the address couldn't be found" Detail In `ds_is_in_list`, the first variable `val` has no initialization before <https://github.com/OpenSIPS/opensips/blob/master/modules/dispatcher/dispatch.c#L2327> ,and if variable `ip` is not valid(str2ip(ip)==NULL && str2ip6(ip==NULL)), the function will access `val.rs.len, val.rs.s` by `LM_ERR`. For that reason, in some cases/samples, users are allowed to use "ds\_is\_in\_list" cmd, then an attacker may be able to pollute the stack before calling `ds_is_in_list` in order to control the uninitialized `val.rs.s` to arbitrary memory address and `val.rs.len` to arbitrary integer, resulting in content of arbitrary memory address to be logged (such as passwords/cookies/sessions/....).  ``` /* Checks, if the request (sip_msg *_m) comes from a host in a set  * (set-id or -1 for all sets)  */ int ds_is_in_list(struct sip_msg *_m, str *_ip, int port, int set,                   ds_partition_t *partition, int active_only, str *pattern_s) {         pv_value_t val;         ds_set_p list;         struct ip_addr *ip;         int_str avp_val;         int j,k;         char *pattern = NULL;          if (!(ip = str2ip(_ip)) && !(ip = str2ip6(_ip))) {                 LM_ERR("IP val is not IP <%.*s>\n",val.rs.len,val.rs.s);                 return -1;         }          if (pattern_s) {                 pattern = pkg_malloc(pattern_s->len + 1);                 if (!pattern) {                         LM_ERR("oom for pattern!\n");                         return -1;                 }                 memcpy(pattern, pattern_s->s, pattern_s->len);                 pattern[pattern_s->len] = '\0';         }          memset(&val, 0, sizeof(pv_value_t));         val.flags = PV_VAL_INT|PV_TYPE_INT;          /* access ds data under reader's lock */ ....  ``` Suggestion Initialize `val` before accessing `val.rs` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)
[liviuchircu](/liviuchircu)
self-assigned this
[Mar 16, 2022](#event-6249143622)

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)
[liviuchircu](/liviuchircu)
added
the
[bug](/OpenSIPS/opensips/labels/bug)
label
[Mar 16, 2022](#event-6249143944)

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)
[liviuchircu](/liviuchircu)
added this to the [3.1.9](/OpenSIPS/opensips/milestone/14) milestone
[Mar 16, 2022](#event-6249144236)

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

Author

### **[Cossack9989](/Cossack9989)** commented [Mar 16, 2022](#issuecomment-1068900166)

| BTW, will a GHSA/CVE be assigned to this issue? [@liviuchircu](https://github.com/liviuchircu) |
| --- |

All reactions

Sorry, something went wrong.

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)
[liviuchircu](/liviuchircu)
closed this as [completed](/OpenSIPS/opensips/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[e2f13d3](/OpenSIPS/opensips/commit/e2f13d3747577937152346b031b86639b37bc2b5)`
[Mar 16, 2022](#event-6249685405)

[liviuchircu](/liviuchircu)
added a commit
that referenced
this issue
[Mar 16, 2022](#ref-commit-4dadf77)
[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

`[dispatcher: Fix IP printing on error case](/OpenSIPS/opensips/commit/4dadf7782725ddd8e047166c1a1296d1c7c2d74f "dispatcher: Fix IP printing on error case

Many thanks to @Cossack9989 for the report!

Fixes #2780

(cherry picked from commit e2f13d3747577937152346b031b86639b37bc2b5)")`
…

`[4dadf77](/OpenSIPS/opensips/commit/4dadf7782725ddd8e047166c1a1296d1c7c2d74f)`

```
Many thanks to [@Cossack9989](https://github.com/Cossack9989) for the report!

Fixes [#2780](https://github.com/OpenSIPS/opensips/issues/2780)

(cherry picked from commit [e2f13d3](https://github.com/OpenSIPS/opensips/commit/e2f13d3747577937152346b031b86639b37bc2b5))
```

[liviuchircu](/liviuchircu)
added a commit
that referenced
this issue
[Mar 16, 2022](#ref-commit-4ed384e)
[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

`[dispatcher: Fix IP printing on error case](/OpenSIPS/opensips/commit/4ed384ef685b3741740eacfc1337e06feae18cc5 "dispatcher: Fix IP printing on error case

Many thanks to @Cossack9989 for the report!

Fixes #2780

(cherry picked from commit e2f13d3747577937152346b031b86639b37bc2b5)")`
…

`[4ed384e](/OpenSIPS/opensips/commit/4ed384ef685b3741740eacfc1337e06feae18cc5)`

```
Many thanks to [@Cossack9989](https://github.com/Cossack9989) for the report!

Fixes [#2780](https://github.com/OpenSIPS/opensips/issues/2780)

(cherry picked from commit [e2f13d3](https://github.com/OpenSIPS/opensips/commit/e2f13d3747577937152346b031b86639b37bc2b5))
```

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)
[liviuchircu](/liviuchircu)
added
the
[fixed](/OpenSIPS/opensips/labels/fixed)
label
[Mar 16, 2022](#event-6249701753)

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=80&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

Copy link

Member

### **[liviuchircu](/liviuchircu)** commented [Mar 16, 2022](#issuecomment-1068969087) • edited Loading

| Thank you for the report, [@Cossack9989](https://github.com/Cossack9989)! I see this bug as a *minor* problem, as in the overwhelming majority of use-cases, `ds_is_in_list()` will be simply invoked as `ds_is_in_list($si, ...)`, which will guarantee a correctly-formatted IP address. Moreover, if the script writer were to use `$rd` instead of `$si`, thus making use of the Request-URI domain, they would run into the crash very early, during the platform testing phase. |
| --- |

 😕
2
 Cossack9989 and Esonhugh reacted with confused emoji

All reactions

* 😕
  2 reactions

Sorry, something went wrong.

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

Author

### **[Cossack9989](/Cossack9989)** commented [Mar 16, 2022](#issuecomment-1069081261)

| Although `ds_is_in_list()` will be simply invoked as `ds_is_in_list($si, ...)` in the overwhelming majority of use-cases, but no one can guarantee that an incorrectly-formatted ip will never be passed to `ds_is_in_list()` for various reasons caused by users(e.g in dispatcher's README, `ds_is_in_list($rd,...)` has appeared twice). What's more, if the invalid-ip code block will never be accessed, why design it?  For that reason, I think this issue is actually a vulnerability and deserves a GHSA/CVE(to remind anybody using dispatcher not to misuse `ds_is_in_list`). [@liviuchircu](https://github.com/liviuchircu) |
| --- |

All reactions

Sorry, something went wrong.

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

Author

### **[Cossack9989](/Cossack9989)** commented [Mar 16, 2022](#issuecomment-1069089736)

| What's more, if an incorrectly-formatted ip is passed to `ds_is_in_list()`, it may lead to secret information leak to log due to uninitialized `val`. From the effect, it can indeed be called a security vulnerability. [@liviuchircu](https://github.com/liviuchircu) |
| --- |

All reactions

Sorry, something went wrong.

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=80&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

Copy link

Member

### **[liviuchircu](/liviuchircu)** commented [Mar 16, 2022](#issuecomment-1069121611)

| [@Cossack9989](https://github.com/Cossack9989) - ultimately, you are right. If a single user can be affected by the vulnerability, then it is real and we cannot leave anything to chance. I have opened up a security advisory on the bug and gave you access to it.  So please do a full review of the security implications, as well as my own notes on the vulnerability and complete these with your own feedback. Once that is done, we will most likely release this advisory to the public along with the Security Audit update. |
| --- |

 👍
1
 Cossack9989 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

Author

### **[Cossack9989](/Cossack9989)** commented [Mar 16, 2022](#issuecomment-1069230317) • edited Loading

| [@liviuchircu](https://github.com/liviuchircu) I think that the patch [e2f13d374](https://github.com/OpenSIPS/opensips/commit/e2f13d374) works. Now you can release the sa to the public. BTW, could you request a CVE for the issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=80&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

Copy link

Member

### **[liviuchircu](/liviuchircu)** commented [Mar 16, 2022](#issuecomment-1069274200)

| I think a GHSA is more than enough, for this little bug. However, you have full permission to reserve, write and request an entire CVE ID and article with the same information I wrote in the advisory. |
| --- |

 👍
1
 Cossack9989 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=80&u=061f1fedcc2bbf522ff4d9deebfe6893a73705ef&v=4)](/Cossack9989)

Copy link

Author

### **[Cossack9989](/Cossack9989)** commented [Mar 17, 2022](#issuecomment-1070960173)

| When will the sa be released to the public? |
| --- |

All reactions

Sorry, something went wrong.

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=80&u=1e3f2e1d4000e88bbd4a6412b6287764dd6237a7&v=4)](/liviuchircu)

Copy link

Member

### **[liviuchircu](/liviuchircu)** commented [Mar 15, 2023](#issuecomment-1470170719)

| Hi, [@Cossack9989](https://github.com/Cossack9989)! It's been a while, but the OpenSIPS Security Audit findings have just been fully disclosed -- more info on [this blog](https://blog.opensips.org/2023/03/15/opensips-security-audit-fully-disclosed/). So I took the opportunity to also publish this Advisory and have also requested a CVE for it. Let's see how it goes! |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fissues%2F2780)

Assignees

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&v=4)](/liviuchircu) [liviuchircu](/liviuchircu)

Labels

[bug](/OpenSIPS/opensips/labels/bug)
[fixed](/OpenSIPS/opensips/labels/fixed)

Projects

None yet

Milestone

 [**3.1.17**](/OpenSIPS/opensips/milestone/14 "3.1.17")

Development

No branches or pull requests

2 participants

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=52&v=4)](/liviuchircu) [![@Cossack9989](https://avatars.githubusercontent.com/u/32336251?s=52&v=4)](/Cossack9989)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0d32edca_20250114_211249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fcommit%2Fe2f13d374)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fcommit%2Fe2f13d374)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OpenSIPS%2Fopensips)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenSIPS](/OpenSIPS)
/
**[opensips](/OpenSIPS/opensips)**
Public

* [Notifications](/login?return_to=%2FOpenSIPS%2Fopensips) You must be signed in to change notification settings
* [Fork
  583](/login?return_to=%2FOpenSIPS%2Fopensips)
* [Star
   1.3k](/login?return_to=%2FOpenSIPS%2Fopensips)

* [Code](/OpenSIPS/opensips)
* [Issues
  266](/OpenSIPS/opensips/issues)
* [Pull requests
  34](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects
  0](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

Additional navigation options

* [Code](/OpenSIPS/opensips)
* [Issues](/OpenSIPS/opensips/issues)
* [Pull requests](/OpenSIPS/opensips/pulls)
* [Actions](/OpenSIPS/opensips/actions)
* [Projects](/OpenSIPS/opensips/projects)
* [Wiki](/OpenSIPS/opensips/wiki)
* [Security](/OpenSIPS/opensips/security)
* [Insights](/OpenSIPS/opensips/pulse)

## Commit

[Permalink](/OpenSIPS/opensips/commit/e2f13d3747577937152346b031b86639b37bc2b5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

dispatcher: Fix IP printing on error case

[Browse files](/OpenSIPS/opensips/tree/e2f13d3747577937152346b031b86639b37bc2b5)
Browse the repository at this point in the history

```
Many thanks to [@Cossack9989](https://github.com/Cossack9989) for the report!

Fixes [#2780](https://github.com/OpenSIPS/opensips/issues/2780)
```

* Loading branch information

[![@liviuchircu](https://avatars.githubusercontent.com/u/4446084?s=40&v=4)](/liviuchircu)

[liviuchircu](/OpenSIPS/opensips/commits?author=liviuchircu "View all commits by liviuchircu")
committed
Mar 16, 2022

1 parent
[41587ad](/OpenSIPS/opensips/commit/41587ad88344271f9b4acbc4f675d44329d46cd0)

commit e2f13d3

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[modules/dispatcher/dispatch.c](#diff-a9417849f895dc964127ab86782b915f5a765c96d0b646685f8d404d9e662a0e "modules/dispatcher/dispatch.c")

Show comments

[View file](/OpenSIPS/opensips/blob/e2f13d3747577937152346b031b86639b37bc2b5/modules/dispatcher/dispatch.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2310,7 +2310,7 @@ int ds\_is\_in\_list(struct sip\_msg \*\_m, str \*\_ip, int port, int set, |
|  |  | char \*pattern = NULL; |
|  |  |  |
|  |  | if (!(ip = str2ip(\_ip)) && !(ip = str2ip6(\_ip))) { |
|  |  | LM\_ERR("IP val is not IP <%.\*s>\n",val.rs.len,val.rs.s); |
|  |  | LM\_ERR("IP val is not IP <%.\*s>\n", \_ip->len, \_ip->s); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e2f13d3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenSIPS%2Fopensips%2Fcommit%2Fe2f13d374) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


