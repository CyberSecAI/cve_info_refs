=== Content from www.mozilla.org_7e9e9b8c_20250114_192512.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-09

## Security Vulnerabilities fixed in Firefox 111

Announced
March 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 111

#### [#CVE-2023-28159: Fullscreen Notification could have been hidden by download popups on Android](#CVE-2023-28159)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

The fullscreen notification could have been hidden on Firefox for Android by using download popups, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1783561](https://bugzilla.mozilla.org/show_bug.cgi?id=1783561)

#### [#CVE-2023-25748: Fullscreen Notification could have been hidden by window prompts on Android](#CVE-2023-25748)

Reporter
Hafiizh
Impact
high
##### Description

By displaying a prompt with a long description, the fullscreen notification could have been hidden, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1798798](https://bugzilla.mozilla.org/show_bug.cgi?id=1798798)

#### [#CVE-2023-25749: Firefox for Android may have opened third-party apps without a prompt](#CVE-2023-25749)

Reporter
Kirtikumar Anandrao Ramchandani
Impact
high
##### Description

Android applications with unpatched vulnerabilities can be launched from a browser using Intents, exposing users to these vulnerabilities. Firefox will now confirm with users that they want to launch an external application before doing so.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1810705](https://bugzilla.mozilla.org/show_bug.cgi?id=1810705)

#### [#CVE-2023-25750: Potential ServiceWorker cache leak during private browsing mode](#CVE-2023-25750)

Reporter
Kagami Rosylight
Impact
high
##### Description

Under certain circumstances, a ServiceWorker's offline cache may have leaked to the file system when using private browsing mode.

##### References

* [Bug 1814733](https://bugzilla.mozilla.org/show_bug.cgi?id=1814733)

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28160: Redirect to Web Extension files may have leaked local path](#CVE-2023-28160)

Reporter
Rob Wu
Impact
moderate
##### Description

When following a redirect to a publicly accessible web extension file, the URL may have been translated to the actual local path, leaking potentially sensitive information.

##### References

* [Bug 1802385](https://bugzilla.mozilla.org/show_bug.cgi?id=1802385)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28161: One-time permissions granted to a local file were extended to other local files loaded in the same tab](#CVE-2023-28161)

Reporter
Khiem Tran
Impact
moderate
##### Description

If temporary "one-time" permissions, such as the ability to use the Camera, were granted to a document loaded using a file: URL, that permission persisted in that tab for all other documents loaded from a file: URL. This is potentially dangerous if the local files came from different sources, such as in a download directory.

##### References

* [Bug 1811181](https://bugzilla.mozilla.org/show_bug.cgi?id=1811181)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110 and Firefox ESR 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

#### [#CVE-2023-28177: Memory safety bugs fixed in Firefox 111](#CVE-2023-28177)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Calixte Denizet, Gabriele Svelto, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1803109%2C1808832%2C1809542%2C1817336)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_044f49d7_20250114_192511.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1802385)
* [XML](/show_bug.cgi?ctype=xml&id=1802385)

Closed
[Bug 1802385](/show_bug.cgi?id=1802385)
(CVE-2023-28160)

Opened 2 years ago
Closed 2 years ago

# After redirect to moz-extension:-URL in the parent process, the URL changes to the underlying jar/file-URL

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

After redirect to moz-extension:-URL in the parent process, the URL changes to the underlying jar/file-URL

## Categories

### (WebExtensions :: Request Handling, defect, P2)

[Product:](/describecomponents.cgi?product=WebExtensions)

WebExtensions
▾

WebExtensions
File feature requests and bugs related to the WebExtension add-on API.
[See Open Bugs in This Product](/buglist.cgi?product=WebExtensions&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=WebExtensions)
Watch This Product

[Component:](/describecomponents.cgi?product=WebExtensions&component=Request%20Handling#Request%20Handling)

Request Handling
▾

WebExtensions :: Request Handling
Bugs about request handling including webRequest and webNavigation.
[See Open Bugs in This Component](/buglist.cgi?product=WebExtensions&component=Request%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=WebExtensions&component=Request%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=WebExtensions&component=Request%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### (firefox-esr102 wontfix, firefox109 wontfix, firefox110 wontfix, firefox111 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 |  | wontfix |
| firefox111 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

[Blocking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Blocking_Flags)

| webextensions | --- |
| --- | --- |

## People

### (Reporter: robwu, Assigned: robwu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///")

[1535365](/show_bug.cgi?id=1535365 "RESOLVED FIXED - Add support for extension process."), [1745761](/show_bug.cgi?id=1745761 "RESOLVED FIXED - [DNR] Hook up rule engine with the network")

[mozilla-hub.atlassian.net/browse/WEBE...](https://mozilla-hub.atlassian.net/browse/WEBEXT-898 "https://mozilla-hub.atlassian.net/browse/WEBEXT-898")

## Details

### (Keywords: csectype-disclosure, sec-moderate, Whiteboard: [addons-jira][adv-main111+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-28160

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[addons-jira][adv-main111+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1802385 - Use NS\_GetFinalChannelURI in FetchDriver](/attachment.cgi?id=9310909)  [2 years ago](#c5)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9310909&action=edit) | [Review](/attachment.cgi?id=9310909) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9322645)  [2 years ago](#c10)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   228 bytes, text/plain |  | [Details](/attachment.cgi?id=9322645&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1802385#c0)• 2 years ago |
|  | |

STR:

1. Open the global browser console.
2. Run the following snippet:

   `await fetch("https://polished-glitter-21ad.hvfcetgxgijelkmhxy.workers.dev/redirect?url=" + WebExtensionPolicy.getByID('webcompat@mozilla.org').getURL('shims/live-test-shim.js') )`

   * Note: this snippet relies on [the built-in webcompat add-on that has a web-accessible file (shims/live-test-shim.js)](https://searchfox.org/mozilla-central/rev/fadd0a14d2a2724ee4733ef73970a2ddd457a43f/browser/extensions/webcompat/manifest.json#130). If the add-on ever disappears, create an extension with a file in `web_accessible_resources`, get the `moz-extension:`-URL to that file and call `fetch` on it.
3. Look at the reported URL.

Expected:

* It should be the `moz-extension://uuid/shims/live-test-shim.js` URL

Actual:

* It is the path to the underlying file or jar:-URL.
* Example from local Firefox build: `file:///path/to/mozilla-central/browser/extensions/webcompat/shims/live-test-shim.js`
* Example for a xpi file: `jar:file:///path/to/addon-file.xpi!/shims/live-test-shim.js`

This is especially a problem on Android, where extensions run in-process (i.e. `extensions.webextensions.remote` = false, until [bug 1535365](/show_bug.cgi?id=1535365 "RESOLVED FIXED - Add support for extension process.") is fixed). This means that a `fetch` from an extension page can leak the path of the underlying filesystem.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a182_447061)• 2 years ago |

See Also: → [1745761](/show_bug.cgi?id=1745761 "RESOLVED FIXED - [DNR] Hook up rule engine with the network")

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a1739_447061)• 2 years ago |

See Also: → [CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///")

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1802385#c1)• 2 years ago |
|  | |

I investigated this issue in [bug 1685403 comment 31](/show_bug.cgi?id=1685403#c31 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///"). Based on my current understanding, I think it has a similar source to the issue in that bug, but a fix for that bug wouldn't necessarily fix this bug.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a72455_534482)• 2 years ago |

Group: firefox-core-security

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1802385#c2)• 2 years ago |
|  | |

Marking as a sec bug out of an abundance of caution, as [bug 1685403](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///") is a security bug as well.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a512259_1689)• 2 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1802385#c3)• 2 years ago |
|  | |

The severity field is not set for this bug.

:zombie, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(tomica)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1802385#c4)• 2 years ago |
|  | |

The underlying bug is being fixed in [bug 1685403](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///"); I'm going to take this bug to attach a unit test for the specific scenarios.

I'm setting this as S2 because the other bug has the same severity. Marking as P2 because in practice the issue can only be triggered in this context on Android, where then number of supported extensions is limited.

Assignee: nobody → robSeverity: -- → S2Status: NEW → ASSIGNEDDepends on: [CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///")Flags: needinfo?(tomica)Priority: -- → P2See Also: [CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///") →

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1802385#c5)• 2 years ago |
|  | |

Attached file
[Bug 1802385 - Use NS\_GetFinalChannelURI in FetchDriver](attachment.cgi?id=9310909)
— [Details](attachment.cgi?id=9310909&action=edit)

Depends on D164656

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a4033310_447061)• 2 years ago |

See Also: → <https://mozilla-hub.atlassian.net/browse/WEBEXT-898>Whiteboard: [addons-jira]

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1802385#c6)• 2 years ago |
|  | |

I'm moving the relevant part for this bug from [bug 1685403](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///") to this patch as agreed upon in <https://phabricator.services.mozilla.com/D164656#5476661> .

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a4133413_600971)• 2 years ago |

[Attachment #9310909](/attachment.cgi?id=9310909&action=edit "Bug 1802385 - Use NS_GetFinalChannelURI in FetchDriver") -
Attachment description: Bug 1802385 - Remove Android-specific test expectation → Bug 1802385 - Use NS\_GetFinalChannelURI in FetchDriver

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1802385#c7)• 2 years ago |
|  | |

This bug was marked as a security bug out of caution ([comment 2](/show_bug.cgi?id=1802385#c2 "RESOLVED FIXED - After redirect to moz-extension:-URL in the parent process, the URL changes to the underlying jar/file-URL")), because it links to another bug that's also marked a security bug. As explained at <https://bugzilla.mozilla.org/show_bug.cgi?id=1685403#c42>, the "security bug" part of that bug has already been fixed a long time ago. Moreover, there are no comments in this bug or patch that disclose information from [bug 1685403](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///"). Therefore this bug does not automatically need to be flagged as a security bug.

The worst that this bug can do is that the path to Firefox's profile directory can be leaked on Android, e.g. as seen in the (failing) unit tests at <https://bugzilla.mozilla.org/show_bug.cgi?id=1745761#c7> .

On Android, it looks like this: `jar:file:///data/app/~~randomchars1==/org.mozilla.firefox_beta-randomchars2==/base.apk!/assets/extensions/webcompat/shims/live-test-shim.js`

A potential practical application of this is fingerprinting, but there are other ways to do so (e.g. [bug 1792377](/show_bug.cgi?id=1792377 "NEW")).

Severity: S2 → S3No longer depends on: [CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///")See Also: → [CVE-2023-29538](/show_bug.cgi?id=1685403 "RESOLVED FIXED - onLoadRequest contains translated jar:file:/// URI instead of moz-extension:///")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1802385#c8)• 2 years ago |
|  | |

Use NS\_GetFinalChannelURI in FetchDriver r=rpl,valentin

<https://hg.mozilla.org/integration/autoland/rev/554a5aa89673b88eda16bfe128656c5702afe5b9>

<https://hg.mozilla.org/mozilla-central/rev/554a5aa89673>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a4638070_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1802385#c9)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:robwu, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox110` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a4711745_447061)• 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)Flags: needinfo?(rob)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a8771824_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a9126520_578488)• 2 years ago |

Whiteboard: [addons-jira] → [addons-jira][adv-main111+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1802385#c10)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9322645)
— [Details](attachment.cgi?id=9322645&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a9393254_578488)• 2 years ago |

Alias: CVE-2023-28160

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1802385#a28265113_1689)• 1 year ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1802385&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rob Wu [:robwu]](/user_profile?user_id=447061)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


