=== Content from github.com_18c630ad_20250114_185223.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fcommit%2F67f4ba154a27a1b06e48bfabda38355a010dfca5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fcommit%2F67f4ba154a27a1b06e48bfabda38355a010dfca5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=minio%2Fminio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[minio](/minio)
/
**[minio](/minio/minio)**
Public

* [Notifications](/login?return_to=%2Fminio%2Fminio) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fminio%2Fminio)
* [Star
   49.4k](/login?return_to=%2Fminio%2Fminio)

* [Code](/minio/minio)
* [Issues
  23](/minio/minio/issues)
* [Pull requests
  11](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

Additional navigation options

* [Code](/minio/minio)
* [Issues](/minio/minio/issues)
* [Pull requests](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

## Commit

[Permalink](/minio/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: post policy request security bypass ([#16849](https://github.com/minio/minio/pull/16849))

[Browse files](/minio/minio/tree/67f4ba154a27a1b06e48bfabda38355a010dfca5)
Browse the repository at this point in the history

* Loading branch information

[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&v=4)](/donatello)

[donatello](/minio/minio/commits?author=donatello "View all commits by donatello")
authored
Mar 20, 2023

1 parent
[440ad20](/minio/minio/commit/440ad20c1d00eb4dddd0dfa9c2994b09079f5d97)

commit 67f4ba1

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**9 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* cmd

  + cmd/api-router.go
    [api-router.go](#diff-a13966712616a82be12644018e3971f9a210b62f4ebbcab07cf1049a20762f87)
  + cmd/auth-handler.go
    [auth-handler.go](#diff-da28a0c0b4e726eabd4cc316dedb9d6e86e2dfff586047857aa43864cdebb0d5)

## There are no files selected for viewing

5 changes: 3 additions & 2 deletions

5
[cmd/api-router.go](#diff-a13966712616a82be12644018e3971f9a210b62f4ebbcab07cf1049a20762f87 "cmd/api-router.go")

Show comments

[View file](/minio/minio/blob/67f4ba154a27a1b06e48bfabda38355a010dfca5/cmd/api-router.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -434,8 +434,9 @@ func registerAPIRouter(router \*mux.Router) { |
|  |  | router.Methods(http.MethodHead).HandlerFunc( |
|  |  | collectAPIStats("headbucket", maxClients(gz(httpTraceAll(api.HeadBucketHandler))))) |
|  |  | // PostPolicy |
|  |  | router.Methods(http.MethodPost).HeadersRegexp(xhttp.ContentType, "multipart/form-data\*").HandlerFunc( |
|  |  | collectAPIStats("postpolicybucket", maxClients(gz(httpTraceHdrs(api.PostPolicyBucketHandler))))) |
|  |  | router.Methods(http.MethodPost).MatcherFunc(func(r \*http.Request, \_ \*mux.RouteMatch) bool { |
|  |  | return isRequestPostPolicySignatureV4(r) |
|  |  | }).HandlerFunc(collectAPIStats("postpolicybucket", maxClients(gz(httpTraceHdrs(api.PostPolicyBucketHandler))))) |
|  |  | // DeleteMultipleObjects |
|  |  | router.Methods(http.MethodPost).HandlerFunc( |
|  |  | collectAPIStats("deletemultipleobjects", maxClients(gz(httpTraceAll(api.DeleteMultipleObjectsHandler))))).Queries("delete", "") |
| Expand Down | |  |

8 changes: 6 additions & 2 deletions

8
[cmd/auth-handler.go](#diff-da28a0c0b4e726eabd4cc316dedb9d6e86e2dfff586047857aa43864cdebb0d5 "cmd/auth-handler.go")

Show comments

[View file](/minio/minio/blob/67f4ba154a27a1b06e48bfabda38355a010dfca5/cmd/auth-handler.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,6 +25,7 @@ import ( |
|  |  | "encoding/hex" |
|  |  | "errors" |
|  |  | "io" |
|  |  | "mime" |
|  |  | "net/http" |
|  |  | "net/url" |
|  |  | "strconv" |
| Expand Down  Expand Up | | @@ -74,8 +75,11 @@ func isRequestPresignedSignatureV2(r \*http.Request) bool { |
|  |  |  |
|  |  | // Verify if request has AWS Post policy Signature Version '4'. |
|  |  | func isRequestPostPolicySignatureV4(r \*http.Request) bool { |
|  |  | return strings.Contains(r.Header.Get(xhttp.ContentType), "multipart/form-data") && |
|  |  | r.Method == http.MethodPost |
|  |  | mediaType, \_, err := mime.ParseMediaType(r.Header.Get(xhttp.ContentType)) |
|  |  | if err != nil { |
|  |  | return false |
|  |  | } |
|  |  | return mediaType == "multipart/form-data" && r.Method == http.MethodPost |
|  |  | } |
|  |  |  |
|  |  | // Verify if the request has AWS Streaming Signature Version '4'. This is only valid for 'PUT' operation. |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `67f4ba1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fcommit%2F67f4ba154a27a1b06e48bfabda38355a010dfca5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4558b27c_20250114_185226.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fsecurity%2Fadvisories%2FGHSA-2pxw-r47w-4p8c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fsecurity%2Fadvisories%2FGHSA-2pxw-r47w-4p8c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=minio%2Fminio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[minio](/minio)
/
**[minio](/minio/minio)**
Public

* [Notifications](/login?return_to=%2Fminio%2Fminio) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fminio%2Fminio)
* [Star
   49.4k](/login?return_to=%2Fminio%2Fminio)

* [Code](/minio/minio)
* [Issues
  23](/minio/minio/issues)
* [Pull requests
  11](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

Additional navigation options

* [Code](/minio/minio)
* [Issues](/minio/minio/issues)
* [Pull requests](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

# Privilege Escalation on Linux/MacOS

Critical

[harshavardhana](/harshavardhana)
published
GHSA-2pxw-r47w-4p8c
Mar 21, 2023

## Package

gomod

minio
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

all

## Patched versions

RELEASE.2023-03-20T20-16-18Z

## Description

### Impact

An attacker can use crafted requests to bypass metadata bucket name checking and put an object

into any bucket while processing `PostPolicyBucket`. To carry out this attack, the attacker

requires credentials with `arn:aws:s3:::*` permission, as well as enabled Console API access.

### Patches

```
commit 67f4ba154a27a1b06e48bfabda38355a010dfca5
Author: Aditya Manthramurthy <donatello@users.noreply.github.com>
Date:   Sun Mar 19 21:15:20 2023 -0700

    fix: post policy request security bypass (#16849)

```
### Workarounds

Browser API access must be enabled turning off `MINIO_BROWSER=off` allows for this workaround.

### References

The vulnerable code:

```
// minio/cmd/generic-handlers.go
func setRequestValidityHandler(h http.Handler) http.Handler {
  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
    // ...
    // For all other requests reject access to reserved buckets
    bucketName, _ := request2BucketObjectName(r)
    if isMinioReservedBucket(bucketName) || isMinioMetaBucket(bucketName) {
      if !guessIsRPCReq(r) && !guessIsBrowserReq(r) && !guessIsHealthCheckReq(r) && !guessIsMetricsReq(r) && !isAdminReq(r) && !isKMSReq(r) {
        if ok {
          tc.FuncName = "handler.ValidRequest"
          tc.ResponseRecorder.LogErrBody = true
        }
        writeErrorResponse(r.Context(), w, errorCodes.ToAPIErr(ErrAllAccessDisabled), r.URL)
        return
      }
    }
    // ...
```

### Severity

Critical

### CVE ID

CVE-2023-28434

### Weaknesses

No CWEs

### Credits

* [![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&v=4)](/donatello)
  [donatello](/donatello)
  Remediation developer
* [![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&v=4)](/harshavardhana)
  [harshavardhana](/harshavardhana)
  Remediation verifier
* [![@RicterZ](https://avatars.githubusercontent.com/u/5282759?s=40&v=4)](/RicterZ)
  [RicterZ](/RicterZ)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d7520617_20250115_113303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-2pxw-r47w-4p8c)

**CVE-2023-28434**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-2pxw-r47w-4p8c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2023-28434](/advisories/GHSA-2pxw-r47w-4p8c)

## Privilege Escalation on Linux/MacOS

High severity

GitHub Reviewed

Published
Mar 21, 2023
in
[minio/minio](/minio/minio)
•
Updated Sep 5, 2023

[Vulnerability details](/advisories/GHSA-2pxw-r47w-4p8c)
[Dependabot alerts
0](/advisories/GHSA-2pxw-r47w-4p8c/dependabot)

## Package

gomod

github.com/minio/minio
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 0.0.0-202303200415

## Patched versions

0.0.0-202303200415

## Description

### Impact

An attacker can use crafted requests to bypass metadata bucket name checking and put an object into any bucket while processing `PostPolicyBucket`. To carry out this attack, the attacker requires credentials with `arn:aws:s3:::*` permission, as well as enabled Console API access.

### Patches

```
commit 67f4ba154a27a1b06e48bfabda38355a010dfca5
Author: Aditya Manthramurthy <donatello@users.noreply.github.com>
Date:   Sun Mar 19 21:15:20 2023 -0700

    fix: post policy request security bypass (#16849)

```
### Workarounds

Browser API access must be enabled turning off `MINIO_BROWSER=off` allows for this workaround.

### References

The vulnerable code:

```
// minio/cmd/generic-handlers.go
func setRequestValidityHandler(h http.Handler) http.Handler {
  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
    // ...
    // For all other requests reject access to reserved buckets
    bucketName, _ := request2BucketObjectName(r)
    if isMinioReservedBucket(bucketName) || isMinioMetaBucket(bucketName) {
      if !guessIsRPCReq(r) && !guessIsBrowserReq(r) && !guessIsHealthCheckReq(r) && !guessIsMetricsReq(r) && !isAdminReq(r) && !isKMSReq(r) {
        if ok {
          tc.FuncName = "handler.ValidRequest"
          tc.ResponseRecorder.LogErrBody = true
        }
        writeErrorResponse(r.Context(), w, errorCodes.ToAPIErr(ErrAllAccessDisabled), r.URL)
        return
      }
    }
    // ...
```
### References

* [GHSA-2pxw-r47w-4p8c](https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c "GHSA-2pxw-r47w-4p8c")
* <https://nvd.nist.gov/vuln/detail/CVE-2023-28434>
* [minio/minio#16849](https://github.com/minio/minio/pull/16849)
* [minio/minio@67f4ba1](https://github.com/minio/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5)

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&v=4)](/harshavardhana)
[harshavardhana](/harshavardhana)
published to
[minio/minio](/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c)
Mar 21, 2023

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2023-28434)
Mar 22, 2023

Published to the GitHub Advisory Database
Sep 5, 2023

Reviewed
Sep 5, 2023

Last updated
Sep 5, 2023

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

13.321%
 (96th percentile)

### Weaknesses

[CWE-269](/advisories?query=cwe%3A269)

### CVE ID

CVE-2023-28434

### GHSA ID

GHSA-2pxw-r47w-4p8c

### Source code

[minio/minio](https://github.com/minio/minio)

### Credits

* [![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&v=4)](/donatello)
  [donatello](/donatello)
  Remediation developer
* [![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&v=4)](/harshavardhana)
  [harshavardhana](/harshavardhana)
  Remediation verifier
* [![@RicterZ](https://avatars.githubusercontent.com/u/5282759?s=40&v=4)](/RicterZ)
  [RicterZ](/RicterZ)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-2pxw-r47w-4p8c/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e29a0660_20250114_185225.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fpull%2F16849)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fpull%2F16849)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=minio%2Fminio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[minio](/minio)
/
**[minio](/minio/minio)**
Public

* [Notifications](/login?return_to=%2Fminio%2Fminio) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fminio%2Fminio)
* [Star
   49.4k](/login?return_to=%2Fminio%2Fminio)

* [Code](/minio/minio)
* [Issues
  23](/minio/minio/issues)
* [Pull requests
  11](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

Additional navigation options

* [Code](/minio/minio)
* [Issues](/minio/minio/issues)
* [Pull requests](/minio/minio/pulls)
* [Discussions](/minio/minio/discussions)
* [Actions](/minio/minio/actions)
* [Security](/minio/minio/security)
* [Insights](/minio/minio/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fminio%2Fminio%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fminio%2Fminio%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: post policy request security bypass #16849

 Merged

[harshavardhana](/harshavardhana)
merged 1 commit into
[minio:master](/minio/minio/tree/master "minio/minio:master")
from
[donatello:sec1](/donatello/minio/tree/sec1 "donatello/minio:sec1")

Mar 20, 2023

 Merged

# [fix: post policy request security bypass](#top) #16849

[harshavardhana](/harshavardhana)
merged 1 commit into
[minio:master](/minio/minio/tree/master "minio/minio:master")
from
[donatello:sec1](/donatello/minio/tree/sec1 "donatello/minio:sec1")

Mar 20, 2023

[Conversation
5](/minio/minio/pull/16849)
[Commits
1](/minio/minio/pull/16849/commits)
[Checks
0](/minio/minio/pull/16849/checks)
[Files changed](/minio/minio/pull/16849/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![donatello](https://avatars.githubusercontent.com/u/200059?s=60&v=4)](/donatello)

Copy link

Member

### @donatello **[donatello](/donatello)** commented [Mar 19, 2023](#issue-1631132841)

## Description

Due to inconstency between the check for routing post policy requests and for preventing access to reserved buckets, it is possible to bypass restrictions and write objects directly into system buckets allowing privilege escalation.

## Motivation and Context

## How to test this PR?

## Types of changes

* Bug fix (non-breaking change which fixes an issue)
* New feature (non-breaking change which adds functionality)
* Optimization (provides speedup with no functional changes)
* Breaking change (fix or feature that would cause existing functionality to change)

## Checklist:

* Fixes a regression (If yes, please add `commit-id` or `PR #` here)
* Unit tests added/updated
* Internal documentation updated
* Create a documentation update request [here](https://github.com/minio/docs/issues/new?label=doc-change,title=Doc+Updated+Needed+For+PR+github.com%2fminio%2fminio%2fpull%2fNNNNN)

Sorry, something went wrong.

All reactions

[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&v=4)](/donatello)

`[Fix post policy request security bypass](/minio/minio/pull/16849/commits/cbd5828dd9d23c97fc63284231e5f8ed84d867ed "Fix post policy request security bypass

Due to inconstency between the check for routing post policy requests
and for preventing access to reserved buckets, it is possible to bypass
restrictions and write objects directly into system buckets allowing
privilege escalation.")`
 …

`[cbd5828](/minio/minio/pull/16849/commits/cbd5828dd9d23c97fc63284231e5f8ed84d867ed)`

```
Due to inconstency between the check for routing post policy requests
and for preventing access to reserved buckets, it is possible to bypass
restrictions and write objects directly into system buckets allowing
privilege escalation.
```

[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)
[donatello](/donatello)
added
the
[priority: severe](/minio/minio/labels/priority%3A%20severe)
label
[Mar 19, 2023](#event-8788810367)

 [![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)
[donatello](/donatello)
requested review from
[vadmeste](/vadmeste),
[harshavardhana](/harshavardhana),
[klauspost](/klauspost) and
[aead](/aead)
[March 19, 2023 21:57](#event-8788810370)

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=80&u=1f4e3198b671d70f13407b2e6c14b4885e295a1b&v=4)](/harshavardhana)

Copy link

Member

### **[harshavardhana](/harshavardhana)** commented [Mar 19, 2023](#issuecomment-1475411284)

| [@donatello](https://github.com/donatello) do you have a reproducer for this? |
| --- |

All reactions

Sorry, something went wrong.

[![@minio-trusted](https://avatars.githubusercontent.com/u/21070888?s=80&u=dea40fc2b755017ae911f9fca3f94d09f111aef7&v=4)](/minio-trusted)

Copy link

Contributor

### **[minio-trusted](/minio-trusted)** commented [Mar 19, 2023](#issuecomment-1475416432)

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Mint Automation  | Test | Result | | --- | --- | | mint-erasure.sh | ✔️ | | mint-compress-encrypt-dist-erasure.sh | ❌ [more...](#0415861f-e641-4927-8419-f765f0117057) | | mint-pools.sh | ❌ [more...](#4886c27e-c78d-45f9-a3e4-bc81818d1d6e) | |  |  |  16849-cbd5828/mint-compress-encrypt-dist-erasure.sh.log: ``` Running with SERVER_ENDPOINT:      15.15.15.8:30399 ACCESS_KEY:           minio SECRET_KEY:           ***REDACTED*** ENABLE_HTTPS:         0 SERVER_REGION:        us-east-1 MINT_DATA_DIR:        /mint/data MINT_MODE:            full ENABLE_VIRTUAL_STYLE: 0 RUN_ON_FAIL:          0  To get logs, run 'docker cp 2f8b3fe782f0:/mint/log /tmp/mint-logs'  (1/14) Running aws-sdk-go tests ... done in 9 seconds (2/14) Running aws-sdk-java tests ... done in 1 seconds (3/14) Running aws-sdk-php tests ... done in 43 seconds (4/14) Running aws-sdk-ruby tests ... done in 9 seconds (5/14) Running awscli tests ... done in 1 minutes and 15 seconds (6/14) Running healthcheck tests ... done in 0 seconds (7/14) Running mc tests ... done in 20 seconds (8/14) Running minio-go tests ... done in 54 seconds (9/14) Running minio-java tests ... FAILED in 5 minutes and 14 seconds {   "name": "minio-java",   "function": "listenBucketNotification()",   "args": "prefix=prefix, suffix=suffix, events={\"s3:ObjectCreated:*\", \"s3:ObjectAccessed:*\"}",   "duration": 300072,   "status": "FAIL",   "error": "java.net.SocketTimeoutException: timeout >>> [okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147), okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158), okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337), okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427), okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320), okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29), okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178), okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106), okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201), okhttp3.internal.connection.RealCall$AsyncCall.run(RealCall.kt:517), java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128), java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628), java.base/java.lang.Thread.run(Thread.java:829)]" } (9/14) Running minio-js tests ... FAILED in 1 minutes and 53 seconds {   "name": "minio-js",   "function": "\"after all\" hook in \"functional tests\"",   "duration": 10,   "status": "FAIL",   "error": "S3Error: The bucket you tried to delete is not empty at Object.parseError (node_modules/minio/dist/main/xml-parsers.js:71:11) at /mint/run/core/minio-js/node_modules/minio/dist/main/transformers.js:166:22 at DestroyableTransform._flush (node_modules/minio/dist/main/transformers.js:90:10) at DestroyableTransform.prefinish (node_modules/readable-stream/lib/_stream_transform.js:129:10) at prefinish (node_modules/readable-stream/lib/_stream_writable.js:611:14) at finishMaybe (node_modules/readable-stream/lib/_stream_writable.js:620:5) at endWritable (node_modules/readable-stream/lib/_stream_writable.js:643:3) at DestroyableTransform.Writable.end (node_modules/readable-stream/lib/_stream_writable.js:571:22) at IncomingMessage.onend (internal/streams/readable.js:670:10) at endReadableNT (internal/streams/readable.js:1333:12) at processTicksAndRejections (internal/process/task_queues.js:82:21)" } (9/14) Running minio-py tests ... done in 2 minutes and 4 seconds (10/14) Running s3cmd tests ... done in 16 seconds (11/14) Running s3select tests ... done in 4 seconds (12/14) Running versioning tests ... done in 3 minutes and 32 seconds  Executed 12 out of 14 tests successfully.  ```   16849-cbd5828/mint-pools.sh.log: ``` Running with SERVER_ENDPOINT:      15.15.15.3:30723 ACCESS_KEY:           minio SECRET_KEY:           ***REDACTED*** ENABLE_HTTPS:         0 SERVER_REGION:        us-east-1 MINT_DATA_DIR:        /mint/data MINT_MODE:            full ENABLE_VIRTUAL_STYLE: 0 RUN_ON_FAIL:          0  To get logs, run 'docker cp c766782a85a7:/mint/log /tmp/mint-logs'  (1/14) Running aws-sdk-go tests ... done in 9 seconds (2/14) Running aws-sdk-java tests ... done in 2 seconds (3/14) Running aws-sdk-php tests ... done in 43 seconds (4/14) Running aws-sdk-ruby tests ... done in 9 seconds (5/14) Running awscli tests ... done in 1 minutes and 16 seconds (6/14) Running healthcheck tests ... done in 0 seconds (7/14) Running mc tests ... done in 19 seconds (8/14) Running minio-go tests ... done in 59 seconds (9/14) Running minio-java tests ... FAILED in 5 minutes and 1 seconds {   "name": "minio-java",   "function": "makeBucket()",   "args": "[basic check]",   "duration": 300092,   "status": "FAIL",   "error": "java.net.SocketTimeoutException: timeout >>> [okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147), okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158), okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337), okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427), okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320), okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29), okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178), okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106), okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76), okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109), okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201), okhttp3.internal.connection.RealCall$AsyncCall.run(RealCall.kt:517), java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128), java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628), java.base/java.lang.Thread.run(Thread.java:829)]" } (9/14) Running minio-js tests ... FAILED in 1 minutes and 59 seconds {   "name": "minio-js",   "function": "\"after all\" hook in \"functional tests\"",   "duration": 12,   "status": "FAIL",   "error": "S3Error: The bucket you tried to delete is not empty at Object.parseError (node_modules/minio/dist/main/xml-parsers.js:71:11) at /mint/run/core/minio-js/node_modules/minio/dist/main/transformers.js:166:22 at DestroyableTransform._flush (node_modules/minio/dist/main/transformers.js:90:10) at DestroyableTransform.prefinish (node_modules/readable-stream/lib/_stream_transform.js:129:10) at prefinish (node_modules/readable-stream/lib/_stream_writable.js:611:14) at finishMaybe (node_modules/readable-stream/lib/_stream_writable.js:620:5) at endWritable (node_modules/readable-stream/lib/_stream_writable.js:643:3) at DestroyableTransform.Writable.end (node_modules/readable-stream/lib/_stream_writable.js:571:22) at IncomingMessage.onend (internal/streams/readable.js:670:10) at endReadableNT (internal/streams/readable.js:1333:12) at processTicksAndRejections (internal/process/task_queues.js:82:21)" } (9/14) Running minio-py tests ... done in 2 minutes and 18 seconds (10/14) Running s3cmd tests ... done in 17 seconds (11/14) Running s3select tests ... done in 5 seconds (12/14) Running versioning tests ... done in 3 minutes and 33 seconds  Executed 12 out of 14 tests successfully.  ```  Deleting image on docker hub Deleting image locally |

All reactions

Sorry, something went wrong.

[![@donatello](https://avatars.githubusercontent.com/u/200059?s=80&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

Copy link

Member

Author

### **[donatello](/donatello)** commented [Mar 19, 2023](#issuecomment-1475424352)

| [@donatello](https://github.com/donatello) do you have a reproducer for this?  Yes. Will share privately. |
| --- |

All reactions

Sorry, something went wrong.

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=80&u=1f4e3198b671d70f13407b2e6c14b4885e295a1b&v=4)](/harshavardhana)

Copy link

Member

### **[harshavardhana](/harshavardhana)** commented [Mar 20, 2023](#issuecomment-1475578277)

| [@donatello](https://github.com/donatello) we need to add a test here so that this is always tested. |
| --- |

All reactions

Sorry, something went wrong.

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&u=1f4e3198b671d70f13407b2e6c14b4885e295a1b&v=4)](/harshavardhana)
[harshavardhana](/harshavardhana)
changed the title
~~Fix post policy request security bypass~~
fix: post policy request security bypass
[Mar 20, 2023](#event-8790045956)

[![harshavardhana](https://avatars.githubusercontent.com/u/622699?s=60&v=4)](/harshavardhana)

**[harshavardhana](/harshavardhana)**
approved these changes
[Mar 20, 2023](#pullrequestreview-1347763374)

 [View reviewed changes](/minio/minio/pull/16849/files/cbd5828dd9d23c97fc63284231e5f8ed84d867ed)

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=80&u=1f4e3198b671d70f13407b2e6c14b4885e295a1b&v=4)](/harshavardhana)

Copy link

Member

### **[harshavardhana](/harshavardhana)** commented [Mar 20, 2023](#issuecomment-1475600324)

| Taking this in, so that we can make a new release // cc [@donatello](https://github.com/donatello) |
| --- |

All reactions

Sorry, something went wrong.

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&u=1f4e3198b671d70f13407b2e6c14b4885e295a1b&v=4)](/harshavardhana)
[harshavardhana](/harshavardhana)
merged commit [`67f4ba1`](/minio/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5)
into
minio:master

[Mar 20, 2023](https://github.com/minio/minio/pull/16849#event-8790050157)

 [![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)
[donatello](/donatello)
deleted the
sec1

branch
[March 20, 2023 04:19](#event-8790064960)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Mar 22, 2023](#ref-issue-1636554080)

[x/vulndb: potential Go vuln in github.com/minio/minio: CVE-2023-28434
golang/vulndb#1669](/golang/vulndb/issues/1669)

Closed

[harshavardhana](/harshavardhana)
pushed a commit
to harshavardhana/minio
that referenced
this pull request
[Mar 30, 2023](#ref-commit-9a467bc)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello) [![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&v=4)](/harshavardhana)

`[fix: post policy request security bypass (](/harshavardhana/minio/commit/9a467bce80df85c722a0be5611d185c5cca8938f "fix: post policy request security bypass (#16849)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/harshavardhana/minio/commit/9a467bce80df85c722a0be5611d185c5cca8938f "fix: post policy request security bypass (#16849)")`

`[9a467bc](/harshavardhana/minio/commit/9a467bce80df85c722a0be5611d185c5cca8938f)`

[rluetzner](/rluetzner)
pushed a commit
to iternity-dotcom/minio
that referenced
this pull request
[May 4, 2023](#ref-commit-8a48678)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

`[fix: post policy request security bypass (](/iternity-dotcom/minio/commit/8a486788db7dbbe3cfa6784847eff05935708da2 "fix: post policy request security bypass (#16849)

This fixes security vulnerability CVE-2023-28434 where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

https://nvd.nist.gov/vuln/detail/CVE-2023-28434
https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c
https://github.com/minio/minio/pull/16849

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/iternity-dotcom/minio/commit/8a486788db7dbbe3cfa6784847eff05935708da2 "fix: post policy request security bypass (#16849)

This fixes security vulnerability CVE-2023-28434 where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

https://nvd.nist.gov/vuln/detail/CVE-2023-28434
https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c
https://github.com/minio/minio/pull/16849

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")`
…

`[8a48678](/iternity-dotcom/minio/commit/8a486788db7dbbe3cfa6784847eff05935708da2)`

```
This fixes security vulnerability [CVE-2023-28434](https://github.com/advisories/GHSA-2pxw-r47w-4p8c "CVE-2023-28434") where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

<https://nvd.nist.gov/vuln/detail/CVE-2023-28434>
[GHSA-2pxw-r47w-4p8c](https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c "GHSA-2pxw-r47w-4p8c")
[minio#16849](https://github.com/minio/minio/pull/16849)

(cherry picked from commit [67f4ba1](https://github.com/iternity-dotcom/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5))
```

[rluetzner](/rluetzner)
pushed a commit
to iternity-dotcom/minio
that referenced
this pull request
[May 4, 2023](#ref-commit-acb9b19)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

`[fix: post policy request security bypass (](/iternity-dotcom/minio/commit/acb9b197919b04e4b2dbbd17816273b912d33eaf "fix: post policy request security bypass (#16849)

This fixes security vulnerability CVE-2023-28434 where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

https://nvd.nist.gov/vuln/detail/CVE-2023-28434
https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c
https://github.com/minio/minio/pull/16849

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/iternity-dotcom/minio/commit/acb9b197919b04e4b2dbbd17816273b912d33eaf "fix: post policy request security bypass (#16849)

This fixes security vulnerability CVE-2023-28434 where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

https://nvd.nist.gov/vuln/detail/CVE-2023-28434
https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c
https://github.com/minio/minio/pull/16849

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")`
…

`[acb9b19](/iternity-dotcom/minio/commit/acb9b197919b04e4b2dbbd17816273b912d33eaf)`

```
This fixes security vulnerability [CVE-2023-28434](https://github.com/advisories/GHSA-2pxw-r47w-4p8c "CVE-2023-28434") where users that had
access to all resources (`arn:aws:s3:::*`) were able to put objects into
any bucket, including .minio.sys, the MinIO metabucket. By crafting
requests they would be able to escalate privileges.

As a workaround `MINIO_BROWSER=off` can be turned off, i.e. the MinIO
browser is enabled.

This is fixed upstream, but in a version that no longer supports a file
backend, which is why we backport it.

More information can be found here:

<https://nvd.nist.gov/vuln/detail/CVE-2023-28434>
[GHSA-2pxw-r47w-4p8c](https://github.com/minio/minio/security/advisories/GHSA-2pxw-r47w-4p8c "GHSA-2pxw-r47w-4p8c")
[minio#16849](https://github.com/minio/minio/pull/16849)

(cherry picked from commit [67f4ba1](https://github.com/iternity-dotcom/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5))
```

[![@bh4t](https://avatars.githubusercontent.com/u/109562845?s=40&v=4)](/bh4t)
[bh4t](/bh4t)
added
the
[bugfix](/minio/minio/labels/bugfix)
label
[May 23, 2023](#event-9321064495)

[alexanghh](/alexanghh)
pushed a commit
to alexanghh/minio
that referenced
this pull request
[Sep 14, 2023](#ref-commit-312d6fc)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello) [![@alexanghh](https://avatars.githubusercontent.com/u/1009722?s=40&v=4)](/alexanghh)

`[fix: post policy request security bypass (](/alexanghh/minio/commit/312d6fcb9c821b20df5168bdd3665bd2f86c72d3 "fix: post policy request security bypass (#16849)

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/alexanghh/minio/commit/312d6fcb9c821b20df5168bdd3665bd2f86c72d3 "fix: post policy request security bypass (#16849)

(cherry picked from commit 67f4ba154a27a1b06e48bfabda38355a010dfca5)")`
…

`[312d6fc](/alexanghh/minio/commit/312d6fcb9c821b20df5168bdd3665bd2f86c72d3)`

```
(cherry picked from commit [67f4ba1](https://github.com/alexanghh/minio/commit/67f4ba154a27a1b06e48bfabda38355a010dfca5))
```

[daveaugustus](/daveaugustus)
pushed a commit
to chef/minio
that referenced
this pull request
[Nov 15, 2023](#ref-commit-bc38363)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

`[fix: post policy request security bypass (](/chef/minio/commit/bc383638733e5c24c8996bb564a02c2dd381eede "fix: post policy request security bypass (#16849)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/chef/minio/commit/bc383638733e5c24c8996bb564a02c2dd381eede "fix: post policy request security bypass (#16849)")`

`[bc38363](/chef/minio/commit/bc383638733e5c24c8996bb564a02c2dd381eede)`

[daveaugustus](/daveaugustus)
pushed a commit
to chef/minio
that referenced
this pull request
[Nov 17, 2023](#ref-commit-01b119d)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

`[fix: post policy request security bypass (](/chef/minio/commit/01b119d4e05eb5d5a2e5ded4ce85a8ef54dfe99f "fix: post policy request security bypass (#16849)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/chef/minio/commit/01b119d4e05eb5d5a2e5ded4ce85a8ef54dfe99f "fix: post policy request security bypass (#16849)")`

`[01b119d](/chef/minio/commit/01b119d4e05eb5d5a2e5ded4ce85a8ef54dfe99f)`

[daveaugustus](/daveaugustus)
pushed a commit
to chef/minio
that referenced
this pull request
[Nov 17, 2023](#ref-commit-ca93b67)
[![@donatello](https://avatars.githubusercontent.com/u/200059?s=40&u=847a2f8b150d3b1fcbc4adb308784ae1cd4a0cd5&v=4)](/donatello)

`[fix: post policy request security bypass (](/chef/minio/commit/ca93b67b5ee36e36590766a2a97e22cb3d22018c "fix: post policy request security bypass (#16849)")[minio#16849](https://github.com/minio/minio/pull/16849)[)](/chef/minio/commit/ca93b67b5ee36e36590766a2a97e22cb3d22018c "fix: post policy request security bypass (#16849)")`

`[ca93b67](/chef/minio/commit/ca93b67b5ee36e36590766a2a97e22cb3d22018c)`

[robo-cap](/robo-cap)
added a commit
to robo-cap/minio-oci
that referenced
this pull request
[May 29, 2024](#ref-commit-bc67c52)
[![@robo-cap](https://avatars.githubusercontent.com/u/47058843?s=40&v=4)](/robo-cap)

`[add fix from upstream:](/robo-cap/minio-oci/commit/bc67c524c5e7988c69a496ac58b0d3bb63901846 "add fix from upstream: https://github.com/minio/minio/pull/16849") [minio#16849](https://github.com/minio/minio/pull/16849)`

`[bc67c52](/robo-cap/minio-oci/commit/bc67c524c5e7988c69a496ac58b0d3bb63901846)`

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fminio%2Fminio%2Fpull%2F16849)

Reviewers

[![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=40&v=4)](/harshavardhana) [harshavardhana](/harshavardhana)

harshavardhana approved these changes

[![@vadmeste](https://avatars.githubusercontent.com/u/283197?s=40&v=4)](/vadmeste) [vadmeste](/vadmeste)

 Awaiting requested review from vadmeste

[![@klauspost](https://avatars.githubusercontent.com/u/5663952?s=40&v=4)](/klauspost) [klauspost](/klauspost)

 Awaiting requested review from klauspost

[![@aead](https://avatars.githubusercontent.com/u/20368805?s=40&v=4)](/aead) [aead](/aead)

 Awaiting requested review from aead

Assignees

No one assigned

Labels

[bugfix](/minio/minio/labels/bugfix)
[priority: severe](/minio/minio/labels/priority%3A%20severe)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@donatello](https://avatars.githubusercontent.com/u/200059?s=52&v=4)](/donatello) [![@harshavardhana](https://avatars.githubusercontent.com/u/622699?s=52&v=4)](/harshavardhana) [![@minio-trusted](https://avatars.githubusercontent.com/u/21070888?s=52&v=4)](/minio-trusted) [![@bh4t](https://avatars.githubusercontent.com/u/109562845?s=52&v=4)](/bh4t)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


