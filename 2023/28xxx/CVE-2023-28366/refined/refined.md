```json
{
  "CVE-2023-28366": {
    "description": "The broker in Eclipse Mosquitto 1.3.2 through 2.x before 2.0.16 has a memory leak that can be abused remotely when a client sends many QoS 2 messages with duplicate message IDs, and fails to respond to PUBREC commands. This occurs because of mishandling of EAGAIN from the libc send function.",
    "root_cause": "The broker does not properly handle `EAGAIN` error codes from the `libc send()` function. The control flow catches the error but incorrectly returns success, skipping the process of freeing memory and leading to a memory leak.",
    "weaknesses": [
      "Memory leak due to improper error handling"
    ],
    "impact": "A remote attacker can cause a denial-of-service by exhausting the server's memory resources.",
    "attack_vectors": [
      "Sending a large number of QoS 2 messages with duplicate message IDs without responding to PUBREC commands."
    ],
    "attacker_capabilities": "A remote attacker with the ability to send MQTT messages to the broker.",
     "additional_details": [
        "The vulnerability is triggered when the broker receives QoS 2 messages with duplicate message IDs and does not receive a PUBREC response, resulting in the memory associated with the unsent packets not being freed.",
       "The issue stems from a failure to properly handle the EAGAIN error from the send() function, which causes the memory associated with the unsent packets to leak."
    ]
  }
}
```