=== Content from bugzilla.mozilla.org_f43aba55_20250115_082150.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1811181)
* [XML](/show_bug.cgi?ctype=xml&id=1811181)

Closed
[Bug 1811181](/show_bug.cgi?id=1811181)
(CVE-2023-28161)

Opened 2 years ago
Closed 2 years ago

# Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab

## Categories

### (Firefox :: Site Permissions, defect, P2)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
â–¾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Site%20Permissions#Site%20Permissions)

Site Permissions
â–¾

Firefox :: Site Permissions
Bugs and feature requests for the Firefox UI to give or revoke web page permissions to access device functionality such as camera, microphone, geolocation or notifications.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Site%20Permissions)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 109

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified) |
| firefox112 | --- | [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox110 |  | wontfix |
| firefox111 |  | verified |
| firefox112 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: duckhiem, Assigned: emz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e1b791d6f5815dc24007d9f684c49e71?d=mm&size=40)  [duckhiem](/user_profile?user_id=640561)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1817121](/show_bug.cgi?id=1817121 "RESOLVED INCOMPLETE - Giving camera permission with Remember this decision ticked to a local .html file will automatically give this permission to another .html file (in the same tab)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1816420](/show_bug.cgi?id=1816420 "RESOLVED FIXED - Land test for Bug 1811181")

Dependency [tree](/showdependencytree.cgi?id=1811181&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1811181)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1817167](/show_bug.cgi?id=1817167 "RESOLVED DUPLICATE - The behavior https://bugzilla.mozilla.org/show_bug.cgi?id=1811181 happens in Private Window on 111.0b1 (macOS)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1627210](/show_bug.cgi?id=1627210 "RESOLVED FIXED - PermissionUI: Allow setting persistent permissions for file URIs")

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [adv-main111+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-28161

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main111+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3496997_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!](/attachment.cgi?id=9314350)  [2 years ago](#c3)  [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c21 "2 years ago") | [Details](/attachment.cgi?id=9314350&action=edit) | [Review](/attachment.cgi?id=9314350) |
| --- | --- | --- |
| [Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!](/attachment.cgi?id=9316624)  [2 years ago](#c10)  [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9316624&action=edit) | [Review](/attachment.cgi?id=9316624) |
| [advisory.txt](/attachment.cgi?id=9322639)  [2 years ago](#c25)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   445 bytes, text/plain |  | [Details](/attachment.cgi?id=9322639&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1811181#c0)â€¢ 2 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1811181&comment_id=16241939 "1 revision") |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

Steps to reproduce:

Create two local .html files with two different names and the same code lines:

```
<div id="container">
    <h1><a href="//webrtc.github.io/samples/" title="WebRTC samples homepage">WebRTC samples</a>
        <span>getUserMedia</span></h1>

    <video id="gum-local" autoplay playsinline></video>
    <button id="showVideo">Open camera</button>

</div>

<script src="https://webrtc.github.io/samples/src/content/getusermedia/gum/js/main.js"></script>

```

Open the first .html file on Firefox, give the camera permission to the file, open the second .html file, the second .html file is granted the camera permission automatically.

Video of demonstration: please download from this link to watch a high-definition video: <https://drive.google.com/file/d/1YSdgDrxYTQZm2xLn86Q2cLTfdvtgZXKe/view?usp=sharing>.

Actual results:

Giving the camera permission to a local .html file means giving this permission to all the local .html files.

Expected results:

Should ask for giving the camera permission on each local .html file.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a7380_159069)â€¢ 2 years ago |

Group: firefox-core-security â†’ dom-core-securityComponent: Untriaged â†’ Permission ManagerProduct: Firefox â†’ Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1811181#c1)â€¢ 2 years ago |
|  | |

Paul: I may be misreading [bug 1627210](/show_bug.cgi?id=1627210 "RESOLVED FIXED - PermissionUI: Allow setting persistent permissions for file URIs"), but do we really support different permission settings for individual files? If not, wouldn't granting permanent permission lead to this issue permanently? Or is this something gUM is doing specific incorrectly?

Flags: needinfo?(pbz)See Also: â†’ [1627210](/show_bug.cgi?id=1627210 "RESOLVED FIXED - PermissionUI: Allow setting persistent permissions for file URIs")

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1811181#c2)â€¢ 2 years ago |
|  | |

There are two permission managers involved here, SitePermissions(.jsm) and nsIPermissionManager.

nsIPermissionManager accepts file principals, it will key permissions by origin which means two different files will have different permission keys isolating the permissions between the files.

SitePermissions is a layer on top of nsIPermissionManager which has an extra in-memory store for temporary permissions. Temporary block permissions are keyed by base-domain while temporary allow permissions are keyed by pre-path.

Two different local file URIs still share the same pre-path `file://` thus temporary allow grants are shared across all file URIs. I'm wondering if we should change this to use origin instead.

This bug should not affect permanent permissions only temporary ones. Those are stored per-browser (tab). That's why the bug STR does not work when you open the second local page in a new tab.

AFAIC the temporary allows are currently only used for WebRTC grace periods ([Bug 1693677](/show_bug.cgi?id=1693677 "VERIFIED FIXED - Grant a temporary grace period for re-requesting microphone or camera devices after the track stops")).

Flags: needinfo?(pbz)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1811181#c3)â€¢ 2 years ago |
|  | |

Attached file
[Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!](attachment.cgi?id=9314350)
â€” [Details](attachment.cgi?id=9314350&action=edit)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1811181#c4)â€¢ 2 years ago |
|  | |

I've submitted a WIP patch for how switching to origin scope for temporary ALLOW permissions could look like. There are probably some details we would still need to figure out, like checking for non content principals etc.

It would be nice to share some permission key logic with the permission manager, e.g. code around`PermissionManager::PermissionKey::CreateFromPrincipal`. This would make sure we align behavior.

Overall I'm not sure how critical this issue is given that it only affects temporary permissions and only local files. You could make the argument that it is unexpected for users to grant permission to one file and then have it apply to all local files. But then this would also be easy to be bypassed if the user saves a new file in the same location?

Dan, what do you think?

Also I'm looking at <https://phabricator.services.mozilla.com/D167888>. On fist glance this is probably fine given that persistent permissions end up in the permission manager anyway where they're handled correctly (key will include the file path).

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1811181#c5)â€¢ 2 years ago |
|  | |

So this bug could be re-titled "Giving the camera permission to a local .html file means giving this permission to any other local .html file you open in the same tab for an hour"?

If one page links to the next then we've got some kind of "local-disk" application (old-style web development not using a localhost server?) and that's not a terrible result at all--it's kind of acting like a "website". Or the user has a bookmark... those are not likely to be suspicious. One questionable case is if the first file was opened from a (download?) directory listing, and then the user hits back and picks another unrelated file on that list. It could happen, but would someone code a file to spy on you just hoping for that very narrow circumstance to happen?

That didn't seem like much of a problem with the original 50s timeout from [bug 1693677](/show_bug.cgi?id=1693677 "VERIFIED FIXED - Grant a temporary grace period for re-requesting microphone or camera devices after the track stops"), but `privacy.webrtc.deviceGracePeriodTimeoutMs` was bumped to an hour in [bug 1697284](/show_bug.cgi?id=1697284 "VERIFIED FIXED - Don't prompt web conference lurkers on unmute when they want to ask a question"). That's definitely long enough to give a user a nasty surprise, although the this still seems like a very unlikely scenario for an intentional attack.

I like where your patch is going. Using prePath is definitely problematic for anything security related like permissions. Does your patch need to deal with the use of `prePath` in the `GloballyBlockedPermissions` section? Or is that something for the [bug 1627210](/show_bug.cgi?id=1627210 "RESOLVED FIXED - PermissionUI: Allow setting persistent permissions for file URIs") patch to deal with (the D167888 you linked above) since that's the one removing the checks that prevent using file:// urls there?

Flags: needinfo?(dveditz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Summary: Giving the camera permission to a local .html file means giving this permission to all the local .html files â†’ Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1811181#c6)â€¢ 2 years ago |
|  | |

Thanks!

GloballyblockedPermissions should probably be switched to origin too. I don't think [bug 1627210](/show_bug.cgi?id=1627210 "RESOLVED FIXED - PermissionUI: Allow setting persistent permissions for file URIs") is really problematic because enabling that checkbox makes us store the permissions in the permission manager which keys correctly. A contributor has already submitted a patch for enabling the checkbox and I think this can land separately.

Since it's a bigger change perhaps we can land the SItePermissions origin key change in a separate non-sec bug. We don't have to mention local files explicitly. Would that work for you?

Flags: needinfo?(dveditz)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a1074298_636491)â€¢ 2 years ago |

Severity: -- â†’ S3Status: UNCONFIRMED â†’ NEWEver confirmed: truePriority: -- â†’ P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1811181#c7)â€¢ 2 years ago |
|  | |

> Since it's a bigger change perhaps we can land the SItePermissions origin key change in a separate non-sec bug.

A bigger change than what? You're talking about the patch in this bug (for temporary SitePermissions), right? By "bigger" do you mean it will affect more than just `file:///` URLs? The "more" seems pretty edge-casey, and then wouldn't it be odd to land a public change without any tests for it?

Other cases that might be similarly broken but fixed by switching to origin: `about:blank' documents, frames with`about:srcdoc`and non-sandboxed`data:`contents,`blob:` documents. Unless those are currently prevented from setting permissions, the prepath on those is also problematic.

I'm not seeing what you'd gain from checking this in under a public bug (which is why I wonder if I'm misunderstanding the question), but it should be fine if you want to.

Flags: needinfo?(dveditz)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1811181#c8)â€¢ 2 years ago |
|  | |

Hmm, fair, sounds like we should keep it in this bug then. I'll look into getting the draft production ready.

Assignee: nobody â†’ pbzStatus: NEW â†’ ASSIGNED

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1811181#c9)â€¢ 2 years ago |
|  | |

Moving to SitePermissions since that component is where we need to change the keying.

Group: dom-core-security â†’ firefox-core-securityComponent: Permission Manager â†’ Site PermissionsProduct: Core â†’ Firefox

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a1763926_600971)â€¢ 2 years ago |

[Attachment #9314350](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") -
Attachment description: WIP: Bug 1811181 - Switch SitePermissions TemporaryPermissions from prePath to origin key. â†’ WIP: Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a1765919_600971)â€¢ 2 years ago |

[Attachment #9314350](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") -
Attachment description: WIP: Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. â†’ Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1811181#c10)â€¢ 2 years ago |
|  | |

Attached file
[Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!](attachment.cgi?id=9316624) (obsolete)
â€” [Details](attachment.cgi?id=9316624&action=edit)

Depends on D167988

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2177446_636491)â€¢ 2 years ago |

Blocks: [1816420](/show_bug.cgi?id=1816420 "RESOLVED FIXED - Land test for Bug 1811181")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1811181#c11)â€¢ 2 years ago |
|  | |

Comment on [attachment 9316624](/attachment.cgi?id=9316624 "Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!") [[details]](/attachment.cgi?id=9316624&action=edit "Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!")

[Bug 1811181](/show_bug.cgi?id=1811181 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab") - Add a test case for temporary permissions for file URIs. r=prathiksha!

Revision D169233 was moved to [bug 1816420](/show_bug.cgi?id=1816420 "RESOLVED FIXED - Land test for Bug 1811181"). Setting [attachment 9316624](/attachment.cgi?id=9316624 "Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!") [[details]](/attachment.cgi?id=9316624&action=edit "Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!") to obsolete.

[Attachment #9316624](/attachment.cgi?id=9316624&action=edit "Bug 1811181 - Add a test case for temporary permissions for file URIs. r=prathiksha!") -
Attachment is obsolete: true

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1811181#c12)â€¢ 2 years ago |
|  | |

Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha

<https://hg.mozilla.org/integration/autoland/rev/2c2060b124711a821522638fef996e436e572958>

<https://hg.mozilla.org/mozilla-central/rev/2c2060b12471>

Group: firefox-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 112 Branch

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2389889_636491)â€¢ 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2418190_159069)â€¢ 2 years ago |

Depends on: [1817121](/show_bug.cgi?id=1817121 "RESOLVED INCOMPLETE - Giving camera permission with Remember this decision ticked to a local .html file will automatically give this permission to another .html file (in the same tab)")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2431113_159069)â€¢ 2 years ago |

Duplicate of this bug: [1817167](/show_bug.cgi?id=1817167 "RESOLVED DUPLICATE - The behavior https://bugzilla.mozilla.org/show_bug.cgi?id=1811181 happens in Private Window on 111.0b1 (macOS)")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1811181#c14)â€¢ 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:pbz, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox111` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(pbz)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1811181#c15)â€¢ 2 years ago |
|  | |

Comment on [attachment 9314350](/attachment.cgi?id=9314350 "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") [[details]](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!")

[Bug 1811181](/show_bug.cgi?id=1811181 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab") - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-moderate: Users granting a site permission (camera, microphone, geolocation etc) to a local file grant it to all local files temporarily. This may be unexpected.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See <https://bugzilla.mozilla.org/show_bug.cgi?id=1811181#c0>
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: Medium risk because we change permission keying in SitePermissions which may have unintended side effects. However this aligns with how we already key in nsIPermissionManager so it's well understood.
* **String changes made/needed**:
* **Is Android affected?**: No
Flags: needinfo?(pbz)
[Attachment #9314350](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") -
Flags: approval-mozilla-beta?

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2434600_636491)â€¢ 2 years ago |

Flags: qe-verify+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a2438013_551058)â€¢ 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1811181#c16)â€¢ 2 years ago |
|  | |

:pbz what's the impact on this for esr102?

It's a medium risk and doesn't graft cleanly - should we be looking to uplift this to esr102 after your consideration or should it be a wontfix?

Flags: needinfo?(pbz)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1811181#c17)â€¢ 2 years ago |
|  | |

I have reproduced this bug with STR from [comment 0](/show_bug.cgi?id=1811181#c0 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab") on Win 10 x64, with an affected Nightly build (2023-01-25).

The issue is verified as fixed on latest Nightly 112.0a1, under Win 10 x64, macOS 11 and Ubuntu 18.04 x64.

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified)Flags: qe-verify+

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1811181#c18)â€¢ 2 years ago |
|  | |

Same impact on ESR. Do we usually uplift sec-moderate? I'm asking because the uplift request has a field asking for special consideration if not sec-high or sec-crit. I don't have such a reason ðŸ™‚.

Flags: needinfo?(pbz) â†’ needinfo?(dmeehan)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1811181#c19)â€¢ 2 years ago |
|  | |

(In reply to Paul ZÃ¼hlcke [:pbz] from [comment #18](/show_bug.cgi?id=1811181#c18 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab"))

> Same impact on ESR. Do we usually uplift sec-moderate? I'm asking because the uplift request has a field asking for special consideration if not sec-high or sec-crit. I don't have such a reason ðŸ™‚.

Thanks for the response - we usually only aim to uplift sec-high/sec-critical but thought it worth reaching out.

Setting esr-102 to wontfix, and will follow up with the beta uplift approval.

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)Flags: needinfo?(dmeehan)

|  | [Khiem Tran](/user_profile?user_id=640561)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1811181#c20)â€¢ 2 years ago |
|  | |

Dear all,

So, I would ask does it has a reward?

Best regards,

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1811181#c21)â€¢ 2 years ago |
|  | |

Comment on [attachment 9314350](/attachment.cgi?id=9314350 "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") [[details]](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!")

[Bug 1811181](/show_bug.cgi?id=1811181 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab") - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!

Approved for 111.0b5

[Attachment #9314350](/attachment.cgi?id=9314350&action=edit "Bug 1811181 - Switch SitePermissions TemporaryPermissions and GloballyBlockedPermissions from prePath to origin key. r=prathiksha!") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1811181#c22)â€¢ 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/755f46abde2c>

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)

|  | [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1811181#c23)â€¢ 2 years ago |
|  | |

(In reply to Khiem Tran from [comment #20](/show_bug.cgi?id=1811181#c20 "VERIFIED FIXED - Giving the camera permission to a local .html file means giving this permission to all the local .html files opened in the same tab"))

> Dear all,
>
> So, I would ask does it has a reward?
>
> Best regards,

I'm not very familiar with that process, but I've set the flag for someone to take a look.

Flags: sec-bounty?

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1811181#c24)â€¢ 2 years ago |
|  | |

This is also verified as fixed on Beta 111.0b5, across platforms: Win 10 x64, macOS 11 and Ubuntu 18.04 x64.

Status: RESOLVED â†’ VERIFIED
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a3496997_1689)â€¢ 2 years ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a4347166_578488)â€¢ 2 years ago |

Whiteboard: [adv-main111+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1811181#c25)â€¢ 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9322639)
â€” [Details](attachment.cgi?id=9322639&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a4613938_578488)â€¢ 2 years ago |

Alias: CVE-2023-28161

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a23485782_1689)â€¢ 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811181#a42977610_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1811181&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Emma ZÃ¼hlcke [:emz]](/user_profile?user_id=636491)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_7e9e9b8c_20250115_082152.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-09

## Security Vulnerabilities fixed in Firefox 111

Announced
March 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 111

#### [#CVE-2023-28159: Fullscreen Notification could have been hidden by download popups on Android](#CVE-2023-28159)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

The fullscreen notification could have been hidden on Firefox for Android by using download popups, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1783561](https://bugzilla.mozilla.org/show_bug.cgi?id=1783561)

#### [#CVE-2023-25748: Fullscreen Notification could have been hidden by window prompts on Android](#CVE-2023-25748)

Reporter
Hafiizh
Impact
high
##### Description

By displaying a prompt with a long description, the fullscreen notification could have been hidden, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1798798](https://bugzilla.mozilla.org/show_bug.cgi?id=1798798)

#### [#CVE-2023-25749: Firefox for Android may have opened third-party apps without a prompt](#CVE-2023-25749)

Reporter
Kirtikumar Anandrao Ramchandani
Impact
high
##### Description

Android applications with unpatched vulnerabilities can be launched from a browser using Intents, exposing users to these vulnerabilities. Firefox will now confirm with users that they want to launch an external application before doing so.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1810705](https://bugzilla.mozilla.org/show_bug.cgi?id=1810705)

#### [#CVE-2023-25750: Potential ServiceWorker cache leak during private browsing mode](#CVE-2023-25750)

Reporter
Kagami Rosylight
Impact
high
##### Description

Under certain circumstances, a ServiceWorker's offline cache may have leaked to the file system when using private browsing mode.

##### References

* [Bug 1814733](https://bugzilla.mozilla.org/show_bug.cgi?id=1814733)

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28160: Redirect to Web Extension files may have leaked local path](#CVE-2023-28160)

Reporter
Rob Wu
Impact
moderate
##### Description

When following a redirect to a publicly accessible web extension file, the URL may have been translated to the actual local path, leaking potentially sensitive information.

##### References

* [Bug 1802385](https://bugzilla.mozilla.org/show_bug.cgi?id=1802385)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28161: One-time permissions granted to a local file were extended to other local files loaded in the same tab](#CVE-2023-28161)

Reporter
Khiem Tran
Impact
moderate
##### Description

If temporary "one-time" permissions, such as the ability to use the Camera, were granted to a document loaded using a file: URL, that permission persisted in that tab for all other documents loaded from a file: URL. This is potentially dangerous if the local files came from different sources, such as in a download directory.

##### References

* [Bug 1811181](https://bugzilla.mozilla.org/show_bug.cgi?id=1811181)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110 and Firefox ESR 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

#### [#CVE-2023-28177: Memory safety bugs fixed in Firefox 111](#CVE-2023-28177)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Calixte Denizet, Gabriele Svelto, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1803109%2C1808832%2C1809542%2C1817336)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


