=== Content from bugzilla.mozilla.org_3abd1920_20250114_230938.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1821155)
* [XML](/show_bug.cgi?ctype=xml&id=1821155)

Closed
[Bug 1821155](/show_bug.cgi?id=1821155)

Opened 2 years ago
Closed 2 years ago

# keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof

## Categories

### (Focus :: General, defect, P2)

[Product:](/describecomponents.cgi?product=Focus)

Focus
▾

Focus
For bugs in Firefox Focus for Android. Bugs in Firefox Focus for iOS should be filed on [GitHub](https://github.com/mozilla-mobile/firefox-ios/issues/new/choose)
[See Open Bugs in This Product](/buglist.cgi?product=Focus&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Focus)
Watch This Product

[Component:](/describecomponents.cgi?product=Focus&component=General#General)

General
▾

Focus :: General
For bugs in Focus Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Focus&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Focus&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Focus&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | --- |  |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/9cc8d316cd36043a6d25bc9649bf5ef8?d=mm&size=40)  [bclark](/user_profile?user_id=713010)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1821155&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1821155)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main112+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main112+]

QA Whiteboard:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c15 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 1 obsolete file)

| [video\_2023-03-09\_03-56-27.mp4](/attachment.cgi?id=9321962)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   802.04 KB, video/mp4 |  | [Details](/attachment.cgi?id=9321962&action=edit) |
| --- | --- | --- |
| [firefoxfocus.html](/attachment.cgi?id=9321967)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.91 KB, text/html |  | [Details](/attachment.cgi?id=9321967&action=edit) |
| [googlebar3.jpeg](/attachment.cgi?id=9321968)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   8.25 KB, image/jpeg |  | [Details](/attachment.cgi?id=9321968&action=edit) |
| [video\_2023-03-11\_09-51-21.mp4](/attachment.cgi?id=9322539)  [2 years ago](#c5)  [Hafiizh](/user_profile?user_id=694415)   845.23 KB, video/mp4 |  | [Details](/attachment.cgi?id=9322539&action=edit) |
| [nightlypoc.mp4](/attachment.cgi?id=9322550)  [2 years ago](#c7)  [Hafiizh](/user_profile?user_id=694415)   2.01 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322550&action=edit) |
| [Screenshot\_20230317-225230\_Firefox Nightly.jpg](/attachment.cgi?id=9323673)  [2 years ago](#c12)  [Hafiizh](/user_profile?user_id=694415)   202.35 KB, image/jpeg |  | [Details](/attachment.cgi?id=9323673&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327540)  [2 years ago](#c17)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   299 bytes, text/plain |  | [Details](/attachment.cgi?id=9327540&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327574)  [2 years ago](#c18)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   11 bytes, text/plain |  | [Details](/attachment.cgi?id=9327574&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1821155#c0)• 2 years ago |
|  | |

Attached video
[video\_2023-03-09\_03-56-27.mp4](attachment.cgi?id=9321962)
— [Details](attachment.cgi?id=9321962&action=edit)

I found a vulnerability in firefox focus (landscape mode) when click on the text box it opens keyboard layout when running fullscreen, keyboard layout covers fullscreen notification.

steps to generate

1. Go to <http://103.186.0.20/fullscreenfocus.html>
2. Click on TextBox (hide full screen notification)
Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1821155#c1)• 2 years ago |
|  | |

Attached file
[firefoxfocus.html](attachment.cgi?id=9321967)
— [Details](attachment.cgi?id=9321967&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1821155#c2)• 2 years ago |
|  | |

Attached image
[googlebar3.jpeg](attachment.cgi?id=9321968)
— [Details](attachment.cgi?id=9321968&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1821155#c3)• 2 years ago |
|  | |

update step to produces:

1. Go to <http://103.186.0.20/fullscreenfocus.html> (open on landscape mode)
2. Click on TextBox (hide full screen notification)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1821155#c4)• 2 years ago |
|  | |

I tested on Samsung M31 (Android 10)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a3753_1689)• 2 years ago |

Group: firefox-core-security → mobile-core-securityStatus: UNCONFIRMED → NEWComponent: Security → GeneralEver confirmed: trueKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Product: Firefox → Focus

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a169493_430528)• 2 years ago |

Severity: -- → S2Priority: -- → P2

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1821155#c5)• 2 years ago |
|  | |

Attached video
[video\_2023-03-11\_09-51-21.mp4](attachment.cgi?id=9322539)
— [Details](attachment.cgi?id=9322539&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1821155#c6)• 2 years ago |
|  | |

i updated the poc please see the new poc video. notification full screen closed by telegram notification (still on landscape mode)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1821155#c7)• 2 years ago |
|  | |

Attached video
[nightlypoc.mp4](attachment.cgi?id=9322550)
— [Details](attachment.cgi?id=9322550&action=edit)

its also affected on nightly

|  | [Joe M [:jmahon]](/user_profile?user_id=706732) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1821155#c8)• 2 years ago |
|  | |

Petru, based on your similar work for [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag"), do you know if a Toast would appear over the system keyboard? I'm wondering if we can just use that same fix here in Focus.

Flags: needinfo?(petru.lingurar)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1821155#c9)• 2 years ago |
|  | |

Yes, a Toast does not know what being shown on the screen, it will be shown at a specific location on top of anything that's showing so [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") would fix this also.

Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")Flags: needinfo?(petru.lingurar)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1821155#c10)• 2 years ago |
|  | |

@Hafiizh Can you confirm that the current Nightly avoids this issue?

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1821155#c11)• 2 years ago |
|  | |

Petru its fixed

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1821155#c12)• 2 years ago |
|  | |

Attached image
[Screenshot\_20230317-225230\_Firefox Nightly.jpg](attachment.cgi?id=9323673)
— [Details](attachment.cgi?id=9323673&action=edit)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1821155#c13)• 2 years ago |
|  | |

Thank you for the confirmation!

Assignee: nobody → petru.lingurarStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1821155#c14)• 2 years ago |
|  | |

This fix can ride the trains in 112. We don't need to uplift to a 111 dot release if the bug isn't being actively exploited.

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a1059315_75935)• 2 years ago |

Group: mobile-core-security → core-security-releaseTarget Milestone: --- → 113 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1821155#c15)• 2 years ago |
|  | |

As we expected, this did turn out to be fixed by the redesigned mechanism in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") making this essentially a dupe for purposes of the bug bounty.

Flags: sec-bounty? → sec-bounty-

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1821155#c16)• 2 years ago |
|  | |

hey daniel your development team decided to use toast or sneakbar 12 days ago on bug <https://bugzilla.mozilla.org/show_bug.cgi?id=1816059> (on [comment 13](/show_bug.cgi?id=1821155#c13 "RESOLVED FIXED - keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof") (petru)) while this [bug 1821155](/show_bug.cgi?id=1821155 "RESOLVED FIXED - keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof") opened the day before Your team decided to use a toast or sneakbar and it hasn't been fixed yet and your team went to <https://bugzilla.mozilla.org/show_bug.cgi?id=1822140> to decide to use a toast instead of a sneakbar. I also didn't know you would use toast . don't you say I redesigned it for bug bounty reasons .sigh

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a2397179_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1821155#c17)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327540) (obsolete)
— [Details](attachment.cgi?id=9327540&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1821155#c18)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327574)
— [Details](attachment.cgi?id=9327574&action=edit)

[Attachment #9327540](/attachment.cgi?id=9327540&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a19291145_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821155#a38782901_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1821155&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_b3d75f6d_20250114_230941.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1821906)
* [XML](/show_bug.cgi?ctype=xml&id=1821906)

Closed
[Bug 1821906](/show_bug.cgi?id=1821906)

Opened 2 years ago
Closed 2 years ago

# Geolocation permission hide notification fullscreen

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Geolocation permission hide notification fullscreen

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1821906&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1821906)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c11 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [video\_2023-03-12\_20-21-24.mp4](/attachment.cgi?id=9322600)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   1.72 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322600&action=edit) |
| --- | --- | --- |
| [video\_2023-03-12\_20-21-24.mp4](/attachment.cgi?id=9322602)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   1.72 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322602&action=edit) |
| [geofullscreen2.html](/attachment.cgi?id=9322603)  [2 years ago](#c3)  [Hafiizh](/user_profile?user_id=694415)   2.54 KB, text/html |  | [Details](/attachment.cgi?id=9322603&action=edit) |
| [google.jpg](/attachment.cgi?id=9322604)  [2 years ago](#c4)  [Hafiizh](/user_profile?user_id=694415)   22.18 KB, image/jpeg |  | [Details](/attachment.cgi?id=9322604&action=edit) |
| [video\_2023-03-13\_08-31-16.mp4](/attachment.cgi?id=9322623)  [2 years ago](#c5)  [Hafiizh](/user_profile?user_id=694415)   1.97 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322623&action=edit) |
| [Screenshot\_20230317-225623\_Firefox Nightly.jpg](/attachment.cgi?id=9323675)  [2 years ago](#c9)  [Hafiizh](/user_profile?user_id=694415)   128.25 KB, image/jpeg |  | [Details](/attachment.cgi?id=9323675&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327597)  [2 years ago](#c12)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   12 bytes, text/plain |  | [Details](/attachment.cgi?id=9327597&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1821906#c0)• 2 years ago |
|  | |

Attached video
[video\_2023-03-12\_20-21-24.mp4](attachment.cgi?id=9322600) (obsolete)
— [Details](attachment.cgi?id=9322600&action=edit)

I found a vulnerability in firefox nightly (i tested on Samsung M31 ) where a geolocation permission alert notification can cover fullscreen notifications which can lead to spoofs.

step to reproduces:

1. <https://pipabajabakrie.com/upload/geofullscreen.html>
2. click on button "Try it"
Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1821906#c1)• 2 years ago |
|  | |

new POC:

1. open <https://pipabajabakrie.com/upload/geofullscreen2.html>
2. click on button "Open GOOGLE"

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1821906#c2)• 2 years ago |
|  | |

Attached video
[video\_2023-03-12\_20-21-24.mp4](attachment.cgi?id=9322602)
— [Details](attachment.cgi?id=9322602&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1821906#c3)• 2 years ago |
|  | |

Attached file
[geofullscreen2.html](attachment.cgi?id=9322603)
— [Details](attachment.cgi?id=9322603&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1821906#c4)• 2 years ago |
|  | |

Attached image
[google.jpg](attachment.cgi?id=9322604)
— [Details](attachment.cgi?id=9322604&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a36812_159069)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Fenix

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1821906#c5)• 2 years ago |
|  | |

Attached video
[video\_2023-03-13\_08-31-16.mp4](attachment.cgi?id=9322623)
— [Details](attachment.cgi?id=9322623&action=edit)

[Attachment #9322600](/attachment.cgi?id=9322600&action=edit "video_2023-03-12_20-21-24.mp4") -
Attachment is obsolete: true

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1821906#c6)• 2 years ago |
|  | |

Thank you!

Important to note that this only affects the scenarios in which the toolbar is placed at the bottom (default).

Would be fixed with the same approach as on [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag").

Status: UNCONFIRMED → NEW
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")Ever confirmed: true

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1821906#c7)• 2 years ago |
|  | |

@Hafiizh Can you confirm that the current Nightly avoids this issue?

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1821906#c8)• 2 years ago |
|  | |

Petru its fixed

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1821906#c9)• 2 years ago |
|  | |

Attached image
[Screenshot\_20230317-225623\_Firefox Nightly.jpg](attachment.cgi?id=9323675)
— [Details](attachment.cgi?id=9323675&action=edit)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1821906#c10)• 2 years ago |
|  | |

Thank you for the confirmation!

Assignee: nobody → petru.lingurarStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a688196_695136)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)Target Milestone: --- → 113 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a741267_75935)• 2 years ago |

Group: mobile-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1821906#c11)• 2 years ago |
|  | |

As we expected, this did turn out to be fixed by the redesigned mechanism in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") making this essentially a dupe for purposes of the bug bounty.

Flags: sec-bounty? → sec-bounty-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1821906#c12)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327597)
— [Details](attachment.cgi?id=9327597&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a18973110_1689)• 1 year ago |

Group: core-security-release

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a24528900_159069)• 1 year ago |

See Also: → [1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821906#a38464904_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1821906&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_a9703fe8_20250114_230943.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1822305)
* [XML](/show_bug.cgi?ctype=xml&id=1822305)

Closed
[Bug 1822305](/show_bug.cgi?id=1822305)

Opened 2 years ago
Closed 2 years ago

# Block the fullscreen notification on Android using external protocol prompt

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Block the fullscreen notification on Android using external protocol prompt

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 111

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Other

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: haxatron1, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ece264081141db92a1ad0d985a5d3489?d=mm&size=40)  [haxatron1](/user_profile?user_id=704427)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1822305&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1822305)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof")

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c6 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [fullscreen-bypass.html](/attachment.cgi?id=9322976)  [2 years ago](#c0)  [haxatron1](/user_profile?user_id=704427)   95 bytes, text/html |  | [Details](/attachment.cgi?id=9322976&action=edit) |
| --- | --- | --- |
| [mobizen\_20230314\_213705.mp4](/attachment.cgi?id=9322978)  [2 years ago](#c1)  [haxatron1](/user_profile?user_id=704427)   1.26 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322978&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327595)  [2 years ago](#c7)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   12 bytes, text/plain |  | [Details](/attachment.cgi?id=9327595&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1822305#c0)• 2 years ago |
|  | |

Attached file
[fullscreen-bypass.html](attachment.cgi?id=9322976)
— [Details](attachment.cgi?id=9322976&action=edit)

The new external protocol prompt on Android seems to be asynchronous. Therefore it is possible to trigger a keyboard and the external protocol prompt and fullscreen at the same time which causes the fullscreen popup to be covered.

1. Go to fullscreen-bypass.html
2. Click the input bar
Flags: sec-bounty?

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822305#a29_704427)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralOS: Unspecified → AndroidProduct: Firefox → FenixHardware: Unspecified → OtherVersion: unspecified → Firefox 111

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1822305#c1)• 2 years ago |
|  | |

Attached video
[mobizen\_20230314\_213705.mp4](attachment.cgi?id=9322978)
— [Details](attachment.cgi?id=9322978&action=edit)

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1822305#c2)• 2 years ago |
|  | |

The solution should be if any prompt is encountered, Firefox should exit fullscreen as per Firefox for Desktop and Chrome for Android / Desktop does.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1822305#c3)• 2 years ago |
|  | |

Thank you!

Seems like a variation of an already reported issue regarding this prompt in [bug 1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof").

Would be fixed with the same approach as on [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag").

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822305#a113936_1689)• 2 years ago |

See Also: → [1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof")

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1822305#c4)• 2 years ago |
|  | |

This bug should bs fixed too

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1822305#c5)• 2 years ago |
|  | |

Thank you for the confirmation!

Status: NEW → RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fix-optional)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822305#a367840_75935)• 2 years ago |

Assignee: nobody → petru.lingurarGroup: mobile-core-security → core-security-release
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fix-optional) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)Target Milestone: --- → 113 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1822305#c6)• 2 years ago |
|  | |

As we expected, this did turn out to be fixed by the redesigned mechanism in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") making this essentially a dupe for purposes of the bug bounty.

Flags: sec-bounty? → sec-bounty-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1822305#c7)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327595)
— [Details](attachment.cgi?id=9327595&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822305#a18799678_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822305#a38291465_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1822305&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [haxatron1](/user_profile?user_id=704427)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_713807cd_20250114_230940.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1821576)
* [XML](/show_bug.cgi?ctype=xml&id=1821576)

Closed
[Bug 1821576](/show_bug.cgi?id=1821576)

Opened 2 years ago
Closed 2 years ago

# safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof

## Categories

### (Focus :: General, defect)

[Product:](/describecomponents.cgi?product=Focus)

Focus
▾

Focus
For bugs in Firefox Focus for Android. Bugs in Firefox Focus for iOS should be filed on [GitHub](https://github.com/mozilla-mobile/firefox-ios/issues/new/choose)
[See Open Bugs in This Product](/buglist.cgi?product=Focus&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Focus)
Watch This Product

[Component:](/describecomponents.cgi?product=Focus&component=General#General)

General
▾

Focus :: General
For bugs in Focus Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Focus&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Focus&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Focus&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | --- |  |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/9cc8d316cd36043a6d25bc9649bf5ef8?d=mm&size=40)  [bclark](/user_profile?user_id=713010)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1821576&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1821576)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1822305](/show_bug.cgi?id=1822305 "RESOLVED FIXED - Block the fullscreen notification on Android using external protocol prompt"), [1822298](/show_bug.cgi?id=1822298 "RESOLVED FIXED - Block the fullscreen notification on Android using download popups + keyboard + landscape")

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c8 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [video\_2023-03-10\_10-13-41.mp4](/attachment.cgi?id=9322281)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   2.25 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322281&action=edit) |
| --- | --- | --- |
| [focus.html](/attachment.cgi?id=9322282)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   3.29 KB, text/html |  | [Details](/attachment.cgi?id=9322282&action=edit) |
| [Screenshot\_20230317-230005\_Firefox Nightly.jpg](/attachment.cgi?id=9323676)  [2 years ago](#c6)  [Hafiizh](/user_profile?user_id=694415)   190.92 KB, image/jpeg |  | [Details](/attachment.cgi?id=9323676&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327598)  [2 years ago](#c11)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   12 bytes, text/plain |  | [Details](/attachment.cgi?id=9327598&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1821576#c0)• 2 years ago |
|  | |

Attached video
[video\_2023-03-10\_10-13-41.mp4](attachment.cgi?id=9322281)
— [Details](attachment.cgi?id=9322281&action=edit)

I found a vulnerability in firefox android where a safety browsing alert notification can cover fullscreen notifications which can lead to spoofs. i tested after fixed: <https://github.com/mozilla-mobile/firefox-android/pull/1133> ( <https://bugzilla.mozilla.org/show_bug.cgi?id=1819254> )

steps to produce

1, open <http://103.186.0.20/focus.html> or firefox.html

2. click on "go to google" button , (when the button clicked it show safety browsing alert it covers the fullscreen notification)

OS: Android 10 (Samsung M31)

i attached the poc video files.

thank you

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1821576#c1)• 2 years ago |
|  | |

Attached file
[focus.html](attachment.cgi?id=9322282)
— [Details](attachment.cgi?id=9322282&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1821576#c2)• 2 years ago |
|  | |

firefox focus version:

1.0.2310(Build #11)

112.0a1-20230306094520

AS:97.1.0

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a6954_691597)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Focus

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1821576#c3)• 2 years ago |
|  | |

Thank you!

Would be fixed with the same approach as on [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag").

Status: UNCONFIRMED → NEW
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")Ever confirmed: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a496673_1689)• 2 years ago |

See Also: → [1822305](/show_bug.cgi?id=1822305 "RESOLVED FIXED - Block the fullscreen notification on Android using external protocol prompt")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a496767_1689)• 2 years ago |

See Also: → [1822298](/show_bug.cgi?id=1822298 "RESOLVED FIXED - Block the fullscreen notification on Android using download popups + keyboard + landscape")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1821576#c4)• 2 years ago |
|  | |

@Hafiizh Can you confirm that the current Nightly avoids this issue?

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1821576#c5)• 2 years ago |
|  | |

Petru its fixed

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1821576#c6)• 2 years ago |
|  | |

Attached image
[Screenshot\_20230317-230005\_Firefox Nightly.jpg](attachment.cgi?id=9323676)
— [Details](attachment.cgi?id=9323676&action=edit)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1821576#c7)• 2 years ago |
|  | |

Thank you for the confirmation!

Assignee: nobody → petru.lingurarStatus: NEW → ASSIGNED
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a880152_613831)• 2 years ago |

Status: ASSIGNED → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a897421_695136)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)Target Milestone: --- → 112 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a897452_695136)• 2 years ago |

Target Milestone: 112 Branch → 113 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a950574_75935)• 2 years ago |

Group: mobile-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1821576#c8)• 2 years ago |
|  | |

As we expected, this did turn out to be fixed by the redesigned mechanism in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") making this essentially a dupe for purposes of the bug bounty.

Flags: sec-bounty? → sec-bounty-

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1821576#c9)• 2 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

hi daniel your development team decided to use toast or sneakbar 12 days ago (on the same day) on bug <https://bugzilla.mozilla.org/show_bug.cgi?id=1816059> (at [comment 13](/show_bug.cgi?id=1821576#c13 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof") (petru)) while bug this 1821576 opened on the day your Team has not decided to use toast or sneakbar and it has not been fixed and your team opened <https://bugzilla.mozilla.org/show_bug.cgi?id=1822140> to decide to use toast instead of sneakbar . I also didn't know you would use toast . didnt you say i redesigned for bug bounty reasons .sigh

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1821576#c10)• 2 years ago |
|  | |

Bounty questions should be directed to security@mozilla.com, thanks.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1821576#c11)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327598)
— [Details](attachment.cgi?id=9327598&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a19182427_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821576#a38674184_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1821576&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_acf64303_20250114_230944.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-13

## Security Vulnerabilities fixed in Firefox 112, Firefox for Android 112, Focus for Android 112

Announced
April 11, 2023
Impact
high
Products
Firefox, Firefox for Android, Focus for Android
Fixed in

* Firefox 112
* Firefox for Android 112
* Focus for Android 112

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-29534: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2023-29534)

Reporter
Shaheen Fazim and Hafiizh
Impact
high
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox and Focus for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox and Focus for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1816059](https://bugzilla.mozilla.org/show_bug.cgi?id=1816059)
* [Bug 1816007](https://bugzilla.mozilla.org/show_bug.cgi?id=1816007)
* [Bug 1821155](https://bugzilla.mozilla.org/show_bug.cgi?id=1821155)
* [Bug 1821576](https://bugzilla.mozilla.org/show_bug.cgi?id=1821576)
* [Bug 1821906](https://bugzilla.mozilla.org/show_bug.cgi?id=1821906)
* [Bug 1822298](https://bugzilla.mozilla.org/show_bug.cgi?id=1822298)
* [Bug 1822305](https://bugzilla.mozilla.org/show_bug.cgi?id=1822305)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29537: Data Races in font initialization code](#CVE-2023-29537)

Reporter
Looben Yang
Impact
high
##### Description

Multiple race conditions in the font initialization could have led to memory corruption and execution of attacker-controlled code.

##### References

* [Bug 1823365](https://bugzilla.mozilla.org/show_bug.cgi?id=1823365)
* [Bug 1824200](https://bugzilla.mozilla.org/show_bug.cgi?id=1824200)
* [Bug 1825569](https://bugzilla.mozilla.org/show_bug.cgi?id=1825569)

#### [#CVE-2023-29538: Directory information could have been leaked to WebExtensions](#CVE-2023-29538)

Reporter
Alexis aka zoracon
Impact
moderate
##### Description

Under specific circumstances a WebExtension may have received a `jar:file:///` URI instead of a `moz-extension:///` URI during a load request. This leaked directory paths on the user's machine.

##### References

* [Bug 1685403](https://bugzilla.mozilla.org/show_bug.cgi?id=1685403)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29540: Iframe sandbox bypass using redirects and sourceMappingUrls](#CVE-2023-29540)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Using a redirect embedded into `sourceMappingUrls` could allow for navigation to external protocol links in sandboxed iframes without `allow-top-navigation-to-custom-protocols`.

##### References

* [Bug 1790542](https://bugzilla.mozilla.org/show_bug.cgi?id=1790542)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29543: Use-after-free in debugging APIs](#CVE-2023-29543)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

An attacker could have caused memory corruption and a potentially exploitable use-after-free of a pointer in a global object's debugger vector.

##### References

* [Bug 1816158](https://bugzilla.mozilla.org/show_bug.cgi?id=1816158)

#### [#CVE-2023-29544: Memory Corruption in garbage collector](#CVE-2023-29544)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If multiple instances of resource exhaustion occurred at the incorrect time, the garbage collector could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1818781](https://bugzilla.mozilla.org/show_bug.cgi?id=1818781)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-29546: Screen recording in Private Browsing included address bar on Android](#CVE-2023-29546)

Reporter
Irwan
Impact
low
##### Description

When recording the screen while in Private Browsing on Firefox for Android the address bar and keyboard were not hidden, potentially leaking sensitive information.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1780842](https://bugzilla.mozilla.org/show_bug.cgi?id=1780842)

#### [#CVE-2023-29547: Secure document cookie could be spoofed with insecure cookie](#CVE-2023-29547)

Reporter
Marco Squarcina
Impact
low
##### Description

When a secure cookie existed in the Firefox cookie jar an insecure cookie for the same domain could have been created, when it should have silently failed. This could have led to a desynchronization in expected results when reading from the secure cookie.

##### References

* [Bug 1783536](https://bugzilla.mozilla.org/show_bug.cgi?id=1783536)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29549: Javascript's bind function may have failed](#CVE-2023-29549)

Reporter
Lukas Bernhard
Impact
low
##### Description

Under certain circumstances, a call to the `bind` function may have resulted in the incorrect realm. This may have created a vulnerability relating to JavaScript-implemented sandboxes such as SES.

##### References

* [Bug 1823042](https://bugzilla.mozilla.org/show_bug.cgi?id=1823042)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1812498%2C1814217%2C1818357%2C1751945%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

#### [#CVE-2023-29551: Memory safety bugs fixed in Firefox 112](#CVE-2023-29551)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763625%2C1814314%2C1815798%2C1815890%2C1819239%2C1819465%2C1819486%2C1819492%2C1819957%2C1820514%2C1820776%2C1821838%2C1822175%2C1823547)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_68ff9d32_20250114_230937.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1816059)
* [XML](/show_bug.cgi?ctype=xml&id=1816059)

Closed
[Bug 1816059](/show_bug.cgi?id=1816059)
(CVE-2023-29534)

Opened 2 years ago
Closed 2 years ago

# Obscuring the Full-Screen Toast in Android Through the Select Tag

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Obscuring the Full-Screen Toast in Android Through the Select Tag

## Categories

### (Fenix :: Browser Engine, defect, P2)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=Browser%20Engine#Browser%20Engine)

Browser Engine
▾

Fenix :: Browser Engine
Bugs related to web pages, prompts, error messages, text selection.
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=Browser%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox111 wontfix, firefox112+ fixed, firefox113+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 | + | fixed |
| firefox113 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1816007](/show_bug.cgi?id=1816007 "RESOLVED FIXED - Obscuring Full-Screen Toast in Android Through Google Assistant URI"), [1821155](/show_bug.cgi?id=1821155 "RESOLVED FIXED - keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof"), [1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof"), [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen"), [1822298](/show_bug.cgi?id=1822298 "RESOLVED FIXED - Block the fullscreen notification on Android using download popups + keyboard + landscape"), [1822305](/show_bug.cgi?id=1822305 "RESOLVED FIXED - Block the fullscreen notification on Android using external protocol prompt")

[1707956](/show_bug.cgi?id=1707956 "RESOLVED FIXED - Firefox for Android Entering Fullscreen Snackbar Notification Spoof using Dialogs or Text Selection Menu")

Dependency [tree](/showdependencytree.cgi?id=1816059&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1816059)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[CVE-2023-6870](/show_bug.cgi?id=1823316 "RESOLVED FIXED - open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1820697](/show_bug.cgi?id=1820697 "RESOLVED DUPLICATE - select option with non-breaking spaces hides fullscreen notification, leads to spoof")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1707956](/show_bug.cgi?id=1707956 "RESOLVED FIXED - Firefox for Android Entering Fullscreen Snackbar Notification Spoof using Dialogs or Text Selection Menu")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][geckoview:m113?] [adv-main112+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-29534

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][geckoview:m113?] [adv-main112+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3407833_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [cpeterson](/user_profile?user_id=430528) | [qe-verify](#a19732031_430528 "2 years ago") | - |
| --- | --- | --- |
| [cpeterson](/user_profile?user_id=430528) | qe-verify | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files, 1 obsolete file)

| [poc.rar](/attachment.cgi?id=9316962)  [2 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   19.08 KB, application/vnd.rar |  | [Details](/attachment.cgi?id=9316962&action=edit) |
| --- | --- | --- |
| [test.html](/attachment.cgi?id=9322155)  [2 years ago](#c12)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   3.54 KB, text/html |  | [Details](/attachment.cgi?id=9322155&action=edit) |
| [Selecting.mp4](/attachment.cgi?id=9322166)  [2 years ago](#c13)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   7.47 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322166&action=edit) |
| [Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch](/attachment.cgi?id=9322970)  [2 years ago](#c15)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   1.58 KB, patch | jonalmeida : [review+](#c17 "2 years ago") | [Details](/attachment.cgi?id=9322970&action=edit) | [Diff](/attachment.cgi?id=9322970&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322970) |
| [FullscreenToast.mp4](/attachment.cgi?id=9322971)  [2 years ago](#c16)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   3.27 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322971&action=edit) |
| [Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch](/attachment.cgi?id=9322994)  [2 years ago](#c18)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   3.47 KB, patch | jonalmeida : [review+](#a2787711_541581 "2 years ago")  tjr : [sec-approval+](#c21 "2 years ago") | [Details](/attachment.cgi?id=9322994&action=edit) | [Diff](/attachment.cgi?id=9322994&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322994) |
| [[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (#1260)](/attachment.cgi?id=9323274)  [2 years ago](#c22)  [BMO Github Automation](/user_profile?user_id=723884)   59 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9323274&action=edit) | [Review](/attachment.cgi?id=9323274) |
| [[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)](/attachment.cgi?id=9323463)  [2 years ago](#c25)  [BMO Github Automation](/user_profile?user_id=723884)   59 bytes, text/x-github-pull-request | diannaS : [approval-mozilla-beta+](#c28 "2 years ago") | [Details](/attachment.cgi?id=9323463&action=edit) | [Review](/attachment.cgi?id=9323463) |
| [advisory.txt](/attachment.cgi?id=9327542)  [2 years ago](#c29)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   344 bytes, text/plain |  | [Details](/attachment.cgi?id=9327542&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1816059#c0)• 2 years ago |
|  | |

Attached file
[poc.rar](attachment.cgi?id=9316962)
— [Details](attachment.cgi?id=9316962&action=edit)

In the Firefox Android (Fenix) browser, an attacker can conceal full-screen toast notifications using the following method.

I recently reported a similar method that uses a URI to launch an external app prompt to hide the Full-Screen Toast (<https://bugzilla.mozilla.org/show_bug.cgi?id=1816007>). This is a similar method, but it uses internal HTML elements such as the 'select' tag to obscure the full-screen toast from the victim.

When the victim clicks the button, the following proof-of-concept (POC) triggers the launch of Select Option and Fullscreen simultaneously. This obscures the full-screen toast and loads a spoofed page in the background.

Steps to Reproduce:

1. Download and extract the file `poc.rar` to a folder
2. Start a Python server on the same folder by running the command `python -m http.server 8080`.
3. Open the Android Firefox browser and navigate to the server at `http://{YOUR-SERVER-IP}:8080/poc.html` to Begin testing.

Video Demonstration: <https://youtu.be/kBPErXr197w> (YouTube Unlisted)

Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1816059#c1)• 2 years ago |
|  | |

Similar Chromium bug: <https://bugs.chromium.org/p/chromium/issues/detail?id=1259492>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a10892_159069)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Fenix

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1816059#c2)• 2 years ago |
|  | |

Can this be checked against the [Nightly build](https://github.com/mozilla-mobile/fenix/wiki#download). The intent should trigger a dialog that the user needs to approve.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1816059#c3)• 2 years ago |
|  | |

I tested the method on the nightly build and confirmed that the select option method does not trigger any dialogs. This vulnerability remains present in the nightly version.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1816059#c4)• 2 years ago |
|  | |

This is not an intent, this is an HTML select widget which is implemented as a floating panel. Would this be a GeckoView bug instead? Or is it the Fenix (and presumably Focus) front-ends that have to know about how select widgets might work?

Status: UNCONFIRMED → NEWComponent: General → CoreEver confirmed: trueFlags: needinfo?(jonalmeida942)Flags: needinfo?(jboek)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Product: Fenix → GeckoView

|  | [Jonathan Almeida [:jonalmeida]](/user_profile?user_id=541581) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1816059#c5)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1816059&comment_id=16283368 "1 revision") |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1816059#c4 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag"))

> Would this be a GeckoView bug instead? Or is it the Fenix (and presumably Focus) front-ends that have to know about how select widgets might work?

This is a Fenix/Focus front-end bug; something that can be fixed in our shared components layer.

Component: Core → Browser EngineFlags: needinfo?(jonalmeida942)Flags: needinfo?(jboek)Product: GeckoView → Fenix

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a949780_430528)• 2 years ago |

Severity: -- → S2
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)Priority: -- → P2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2182909_406194)• 2 years ago |

Duplicate of this bug: [1820697](/show_bug.cgi?id=1820697 "RESOLVED DUPLICATE - select option with non-breaking spaces hides fullscreen notification, leads to spoof")

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2206436_406670)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][geckoview:m113?]

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1816059#c7)• 2 years ago |
|  | |

I'm sorry I only now looked deeply into this.

Seems to me like this is the reverse of <https://bugzilla.mozilla.org/show_bug.cgi?id=1819254> which would ensure `select` prompts would not exit fullscreen.

Chrome seems to also be affected by the scenario described here and the only real "fix" would be to always exit fullscreen for prompts that could take over the entire screen and not enter fullscreen while such a prompt is shown. Which would break important flows the user is accustomed with.

Or we could look into a system in which the fullscreen snackbar is shown on top of everything else, including these prompts (which would probably have to not be implemented as Android Dialogs anymore).

Asking also Emilio for recommendations regarding the prompts and how could we reconcile this and the YouTube issue.

Flags: needinfo?(emilio)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1816059#c8)• 2 years ago |
|  | |

I was testing on an older Chrome Release which still had this issue.

Based on <https://bugs.chromium.org/p/chromium/issues/detail?id=1259492> the problem was resolved and indeed in the latest Canary the issue cannot be reproduced anymore with the provided steps.

What happens now in Chrome Canary is that:

* upon clicking the `select` the page would enter in fullscreen but
* the prompt would not be opened to cover the fullscreen message
* another click on the `select` is needed for the prompt to show

Another interesting detail (not sure how new) is that on Chrome a Toast is used instead of a Snackbar and even that on it's own would ensure the message is shown on top of any prompts from the app - this could be a quick fix for Fenix.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1816059#c9)• 2 years ago |
|  | |

Edgar would also be a good person to ask for ideas, as he's dealt with a ton of full screen security issues on desktop.

Flags: needinfo?(echen)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1816059#c10)• 2 years ago |
|  | |

Another detail from the current Chrome Canary (new behavior) is that for the YouTube scenario upon closing the `select` prompt I see the fullscreen message which would suggest they maybe had the same issue with the prompt exiting fullscreen but then the page immediately enters in fullscreen again.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1816059#c11)• 2 years ago |
|  | |

[NOTE: I wrote this before [comment 8](/show_bug.cgi?id=1816059#c8 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") / [comment 10](/show_bug.cgi?id=1816059#c10 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag"), but might still be useful so dropping verbatim]

Yeah, I agree exiting fullscreen is a no-go...

The obvious one is to somehow z-order the fullscreen toast always above prompts. Seems like that would solve it? But it's probably technically complicated...

Desktop fixes this by not allowing the select tag to overlap browser UI.

It seems chromium fixed this by showing the fullscreen toast *after* the dialogs (or maybe for longer until all dialogs are dismissed?) (see <https://bugs.chromium.org/p/chromium/issues/detail?id=1259492#c45>). That seems like it might be an acceptable solution?

Flags: needinfo?(emilio)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1816059#c12)• 2 years ago |
|  | |

Attached file
[test.html](attachment.cgi?id=9322155)
— [Details](attachment.cgi?id=9322155&action=edit)

I updated the original test and test Chrome Canary a bit with follow steps,

1. click `select` element to open `select` promp, but do not select a option immediately.
2. wait page requests fullscreen, prompt will closed automatically.
3. wait fullscreen notification is hidden automatically.
4. click `select` element again and select one of the options to close the prompt

The behavior I notice is:

* Entering fullscreen closes the existing prompt.
* Fullscreen notification is shown again whenever `select` prompt is closed, i.e. after step 4. It seems a new behavior as Chrome Release doesn't show notification again after step 4. And I believe it only shows notification, instead of exiting fullscreen and reentering again, since I didn't see additional `fullscreenchange` event get fired.

I agree that exiting fullscreen whenever a prompt is opened is a bit annoying. And like emilio said, It seems like showing fullscreen notification again while fullscreen content back to foreground is an acceptable solution?

Flags: needinfo?(echen)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1816059#c13)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1816059&comment_id=16318940 "1 revision") |
|  | |

Attached video
[Selecting.mp4](attachment.cgi?id=9322166)
— [Details](attachment.cgi?id=9322166&action=edit)

Tested a bit more to understand what overall improvement can we make while also offering a consistent UX for users.

I see that Chrome does two things differently and we should probably do the same.

Based on the attached video:

* show a [toast](https://developer.android.com/guide/topics/ui/notifiers/toasts) vs a [snackbar](https://m2.material.io/components/snackbars/android#snackbar)

  This allows Chrome to show the fullscreen message on top of everything else.

  This is something that we could easily do in Fenix (if approved by product and UX) but unfortunately styling options are non-existent for `toasts` and with Fenix using multiple `snackbars` all throughout the app this message will seem a bit out of place.

  If we want to keep using snackbars the groundwork for showing them on top of any other Views was already done in <https://bugzilla.mozilla.org/show_bug.cgi?id=1812518> and so we know it's possible. Medium size refactoring.
* the following line

  `<select id="mySelect" onclick="document.documentElement.requestFullscreen();"`

  does only one thing at a time:

  + first click will execute the `onClick` method
  + another click is needed to show the select prompt.

Seems like they don't allow both actions at a time while Fenix does. Maybe this is something that can be implemented in Gecko also?

Regarding this scenario it seems like there is 2-way communication betwqeen the engine and the app: if after the first click that triggers entering in fullscreen the user exits this mode then the second screen will again enter fullscreen. I think this would significantly add to the complexity of the implementation.

|  | [Joe M [:jmahon]](/user_profile?user_id=706732) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1816059#c14)• 2 years ago |
|  | |

Thanks for the thorough investigation, all. Joining in here after a 1:1 conversation with Petru - my recommendation would be to solve this quickly by updating the Snackbar to a Toast, and creating a follow-up ticket for any potential UX enhancements that we can work through with the design team. I've created a follow-up bug ([bug 1822140](/show_bug.cgi?id=1822140 "NEW")) for that; Petru, would you mind adding any relevant information over there?

Since this is a sec-high issue, I'm a bit worried about introducing more complexity into the solution than is *absolutely* necessary.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1816059#c15)• 2 years ago |
|  | |

Attached patch

[Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch](attachment.cgi?id=9322970&action=diff) (obsolete)
— [Details](attachment.cgi?id=9322970&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322970)

A Toast ensures the message will be shown on top of anything else.

Assignee: nobody → petru.lingurarStatus: NEW → ASSIGNED

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1816059#c16)• 2 years ago |
|  | |

Attached video
[FullscreenToast.mp4](attachment.cgi?id=9322971)
— [Details](attachment.cgi?id=9322971&action=edit)

Showing the updated UX with a Toast instead of a snackbar.

|  | [Jonathan Almeida [:jonalmeida]](/user_profile?user_id=541581) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1816059#c17)• 2 years ago |
|  | |

Comment on [attachment 9322970](/attachment.cgi?id=9322970 "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[details]](/attachment.cgi?id=9322970&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[diff]](/attachment.cgi?id=9322970&action=diff "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322970)

Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch

r+ from engineering; this fix is clean and safe to uplift.

[Attachment #9322970](/attachment.cgi?id=9322970&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") -
Flags: review+

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1816059#c18)• 2 years ago |
|  | |

Attached patch

[Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch](attachment.cgi?id=9322994&action=diff)
— [Details](attachment.cgi?id=9322994&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322994)

Also doing the same for Focus.

|  | [Jonathan Almeida [:jonalmeida]](/user_profile?user_id=541581) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2787711_541581)• 2 years ago |

[Attachment #9322994](/attachment.cgi?id=9322994&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") -
Flags: review+

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1816059#c19)• 2 years ago |
|  | |

Comment on [attachment 9322994](/attachment.cgi?id=9322994 "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[details]](/attachment.cgi?id=9322994&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[diff]](/attachment.cgi?id=9322994&action=diff "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322994)

Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: While it's an important change from an UX standpoint and might get some attention there is no clear indication about scenarios to exploit.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All but 111 which had a temporary fix in #1798798
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Given how small the patch is the same code can be uplifted.
* **How likely is this patch to cause regressions; how much testing does it need?**: Small, straightforward change. Don't expect any issue from it.
* **Is Android affected?**: Yes
[Attachment #9322994](/attachment.cgi?id=9322994&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") -
Flags: sec-approval?

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2788567_613831)• 2 years ago |

[Attachment #9322970](/attachment.cgi?id=9322970&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") -
Attachment is obsolete: true

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2791261_613831)• 2 years ago |

Blocks: [1821155](/show_bug.cgi?id=1821155 "RESOLVED FIXED - keyboard layout hides fullscreen notification on landscape mode on firefoxfocus, leads to spoof")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2791493_613831)• 2 years ago |

Blocks: [1822298](/show_bug.cgi?id=1822298 "RESOLVED FIXED - Block the fullscreen notification on Android using download popups + keyboard + landscape")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2792427_613831)• 2 years ago |

Blocks: [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2792794_613831)• 2 years ago |

Blocks: [1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2793287_613831)• 2 years ago |

Blocks: [1822305](/show_bug.cgi?id=1822305 "RESOLVED FIXED - Block the fullscreen notification on Android using external protocol prompt")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1816059#c20)• 2 years ago |
|  | |

Added here more recent issues about prompts covering the fullscreen Snackbar.

These all would be fixed by showing a Toast instead of the current Snackbar.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1816059#c21)• 2 years ago |
|  | |

Comment on [attachment 9322994](/attachment.cgi?id=9322994 "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[details]](/attachment.cgi?id=9322994&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[diff]](/attachment.cgi?id=9322994&action=diff "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9322994)

Bug\_1816059\_-\_Show\_the\_notification\_for\_entering\_fullscreen\_as\_a\_Toast.patch

Approved to land and uplift.

[Attachment #9322994](/attachment.cgi?id=9322994&action=edit "Bug_1816059_-_Show_the_notification_for_entering_fullscreen_as_a_Toast.patch") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a2822595_75935)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B)

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1816059#c22)• 2 years ago |
|  | |

Attached file
[[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (#1260)](attachment.cgi?id=9323274)
— [Details](attachment.cgi?id=9323274&action=edit)

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1816059#c23)• 2 years ago |
|  | |

Authored by <https://github.com/Mugurell>
<https://github.com/mozilla-mobile/firefox-android/commit/01042630c06dd25d529aa7edd73de1172676361a>
[main] [Bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") - Show the notification for entering fullscreen as a ToastStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Flags: qe-verify+Resolution: --- → FIXEDTarget Milestone: --- → 113 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1816059#c24)• 2 years ago |
|  | |

Go ahead and create the v112 backport PR and request Beta approval whenever you're comfortable doing so.

Group: mobile-core-security → core-security-releaseFlags: needinfo?(petru.lingurar)

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1816059#c25)• 2 years ago |
|  | |

Attached file
[[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)](attachment.cgi?id=9323463)
— [Details](attachment.cgi?id=9323463&action=edit)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1816059#c26)• 2 years ago |
|  | |

Comment on [attachment 9323463](/attachment.cgi?id=9323463 "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") [[details]](/attachment.cgi?id=9323463&action=edit "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9323463)

[mozilla-mobile/firefox-android] [Bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)

### Beta/Release Uplift Approval Request

* **User impact if declined**: URL spoofing is possible through hiding when the webpage enters fullscreen.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Small change, just about how a certain message is shown.
* **String changes made/needed**:
* **Is Android affected?**: Yes
Flags: needinfo?(petru.lingurar)
[Attachment #9323463](/attachment.cgi?id=9323463&action=edit "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") -
Flags: approval-mozilla-beta?

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1816059#c27)• 2 years ago |
|  | |

Authored by [https://github.com/mergify[bot](https://github.com/mergify%5Bbot)]
<https://github.com/mozilla-mobile/firefox-android/commit/e2ae2a040d1990cbc775bec5715aebd690cbe4a3>
[releases\_v112] [Bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") - Show the notification for entering fullscreen as a Toast (#1278)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected%20affected) → [fixed fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed%20fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1816059#c28)• 2 years ago |
|  | |

Comment on [attachment 9323463](/attachment.cgi?id=9323463 "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") [[details]](/attachment.cgi?id=9323463&action=edit "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1816059&attachment=9323463)
[mozilla-mobile/firefox-android] [Bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)
Approved for Mobile 112.0b3
[Attachment #9323463](/attachment.cgi?id=9323463&action=edit "[mozilla-mobile/firefox-android] Bug 1816059 - Show the notification for entering fullscreen as a Toast (backport #1260) (#1278)") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a3407833_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a3454020_1689)• 2 years ago |

Blocks: [1816007](/show_bug.cgi?id=1816007 "RESOLVED FIXED - Obscuring Full-Screen Toast in Android Through Google Assistant URI")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a3503634_406194)• 2 years ago |

Regressions: [CVE-2023-6870](/show_bug.cgi?id=1823316 "RESOLVED FIXED - open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a4688453_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][geckoview:m113?] → [reporter-external] [client-bounty-form] [verif?][geckoview:m113?] [adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1816059#c29)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327542)
— [Details](attachment.cgi?id=9327542&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a4878844_578488)• 2 years ago |

Alias: CVE-2023-29534

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a8498070_1689)• 2 years ago |

See Also: → [1707956](/show_bug.cgi?id=1707956 "RESOLVED FIXED - Firefox for Android Entering Fullscreen Snackbar Notification Spoof using Dialogs or Text Selection Menu")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a8848192_1689)• 2 years ago |

Blocks: [1707956](/show_bug.cgi?id=1707956 "RESOLVED FIXED - Firefox for Android Entering Fullscreen Snackbar Notification Spoof using Dialogs or Text Selection Menu")

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a19732031_430528)• 1 year ago |

Flags: qe-verify+ → qe-verify-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a21582483_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816059#a41074147_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1816059&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_5ef761eb_20250114_230935.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1816007)
* [XML](/show_bug.cgi?ctype=xml&id=1816007)

Closed
[Bug 1816007](/show_bug.cgi?id=1816007)

Opened 2 years ago
Closed 2 years ago

# Obscuring Full-Screen Toast in Android Through Google Assistant URI

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Obscuring Full-Screen Toast in Android Through Google Assistant URI

## Categories

### (Fenix :: Browser Engine, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=Browser%20Engine#Browser%20Engine)

Browser Engine
▾

Fenix :: Browser Engine
Bugs related to web pages, prompts, error messages, text selection.
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=Browser%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1816007&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1816007)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1259492 "https://bugs.chromium.org/p/chromium/issues/detail?id=1259492")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main112+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main112+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c12 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [poc.rar](/attachment.cgi?id=9316908)  [2 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   77.53 KB, application/vnd.rar |  | [Details](/attachment.cgi?id=9316908&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9327569)  [2 years ago](#c13)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   12 bytes, text/plain |  | [Details](/attachment.cgi?id=9327569&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1816007#c0)• 2 years ago |
|  | |

Attached file
[poc.rar](attachment.cgi?id=9316908)
— [Details](attachment.cgi?id=9316908&action=edit)

In Firefox, an Attacker Can Conceal Fullscreen Toast Notifications.

This vulnerability is similar to recently fixed Chromium bugs, such as <https://bugs.chromium.org/p/chromium/issues/detail?id=1370028> and <https://bugs.chromium.org/p/chromium/issues/detail?id=1320538>. Although Android Firefox is not vulnerable to the method used in these bugs, I have discovered a different method where the attacker can achieve the same result.

When the victim clicks the button, the following proof-of-concept (POC) triggers the launch of Google Assistant using an Android URI. This obscures the full-screen toast and loads a spoofed page in the background.

Steps to Reproduce:

1. Download and extract the file `poc.rar` to a folder
2. Start a Python server on the same folder by running the command `python -m http.server 8080`.
3. Open the Android Firefox browser and navigate to the server at `http://{YOUR-SERVER-IP}:8080/poc.html` to Begin testing.

Video Demonstration: <https://youtu.be/uhofqP649_o> (YouTube Unlisted)

Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1816007#c1)• 2 years ago |
|  | |

Similar Chromium bug: <https://bugs.chromium.org/p/chromium/issues/detail?id=1259492>

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a10272_691597)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Fenix

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1816007#c2)• 2 years ago |
|  | |

Can this be checked against the [Nightly build](https://github.com/mozilla-mobile/fenix/wiki#download). The intent should trigger a dialog that the user needs to approve.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1816007#c3)• 2 years ago |
|  | |

I tested this method on the nightly build and found that the URI intent method triggers a dialog that requires user approval.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1816007#c4)• 2 years ago |
|  | |

However, after approval on the nightly build the issue remains, where the full-screen toast notifications are being obscured by the intent. With the current POC code, full-screen launches directly with the dialog, but we could delay the launch of full-screen by increasing the timeout, thus providing the user with sufficient time to approve the intent before launching the full-screen.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1816007#c5)• 2 years ago |
|  | |

Here is a video testing the Nightly build of Fenix: <https://youtu.be/watch?v=NO8rr4R2gGM> (YouTube Unlisted)

I have set the timeout to 2500 and modified it to provide users with sufficient time to approve the intent before launching the full-screen, successfully hiding the notification toast if the user approves the intent on Nighty version of Fenix.

Note: It is also possible to delay the fullscreen using setTimeout Funtion, I am uncertain if this constitutes a problem.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1816007#c6)• 2 years ago |
|  | |

I guess this could be a problem with any intent that goes to any app with "draw on top" permission that draws in that part of the screen. The solution is the same as [bug 1816287](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)") -- if we send focus away we should exit (or not enter) fullscreen mode. I don't know if this would be handled in possibly in-common Gecko code, or if these two bugs are two separate fixes.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → [CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)"),
<https://bugs.chromium.org/p/chromium/issues/detail?id=1259492>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1816007#c7)• 2 years ago |
|  | |

The severity field is not set for this bug.

:cpeterson, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(cpeterson)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a1287237_430528)• 2 years ago |

Severity: -- → S2Component: General → Browser EngineFlags: needinfo?(cpeterson)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1816007#c8)• 2 years ago |
|  | |

If the bug severity is currently set to "moderate" because the user requires a special app intent to exploit it, I would like to draw attention to the fact that an attacker could also exploit the bug by targeting any URI, for example URI's such as "mailto:" and "geo:", on an Android device where the user has installed multiple apps. When the URI is opened, an "Open with" dialogue box may appear, which can potentially hide the full-screen toast as well. Therefore, I would like the team to re-evaluate this report with the possibility of a higher severity rating, if appropriate.

```
<a href="mailto:" onclick="run();">test Mailto</a>
<a href="geo:" onclick="run();">test Geo</a>
<script>
    function run() {
        setTimeout(function() {
            document.documentElement.requestFullscreen();
        }, 500);
    }
</script>

```

Video Demonstration: <https://youtu.be/fgANju3ZPbI> (YouTube Unlisted)

Flags: needinfo?(dveditz)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1816007#c9)• 2 years ago |
|  | |

(In reply to Shaheen Fazim from [comment #8](/show_bug.cgi?id=1816007#c8 "RESOLVED FIXED - Obscuring Full-Screen Toast in Android Through Google Assistant URI"))

> If the bug severity is currently set to "moderate" because the user requires a special app intent to exploit it, I would like to draw attention to the fact that an attacker could also exploit the bug by targeting any URI, for example URI's such as "mailto:" and "geo:", on an Android device where the user has installed multiple apps. When the URI is opened, an "Open with" dialogue box may appear, which can potentially hide the full-screen toast as well. Therefore, I would like the team to re-evaluate this report with the possibility of a higher severity rating, if appropriate.
>
> ```
> <a href="mailto:" onclick="run();">test Mailto</a>
> <a href="geo:" onclick="run();">test Geo</a>
> <script>
>     function run() {
>         setTimeout(function() {
>             document.documentElement.requestFullscreen();
>         }, 500);
>     }
> </script>
>
>
> ```
>
> Video Demonstration: <https://youtu.be/fgANju3ZPbI> (YouTube Unlisted)

Correction: I meant "security rating" instead of "severity"

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1816007#c10)• 2 years ago |
|  | |

Here, an attacker can use commonly used URI intents such as Google Assistant or URIs like mailto: or geo: thus Multiple apps may trigger a choose dialogue or in the future a different intent could be triggered with a new method. Therefore, I suggest a better fix would be to block all URI intents from loading with the full-screen API.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1816007#c11)• 2 years ago |
|  | |

This appears to be another variation fixed by the change of approach used to address [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag").

Status: NEW → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")Flags: needinfo?(dveditz)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a3616810_75935)• 2 years ago |

Assignee: nobody → petru.lingurarGroup: mobile-core-security → core-security-releaseTarget Milestone: --- → 113 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1816007#c12)• 2 years ago |
|  | |

The bounty was accounted for in the underlying fix in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

Flags: sec-bounty? → sec-bounty-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a4726180_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1816007#c13)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327569)
— [Details](attachment.cgi?id=9327569&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a21619092_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1816007#a41110794_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1816007&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_13a6c352_20250114_230942.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1822298)
* [XML](/show_bug.cgi?ctype=xml&id=1822298)

Closed
[Bug 1822298](/show_bug.cgi?id=1822298)

Opened 2 years ago
Closed 2 years ago

# Block the fullscreen notification on Android using download popups + keyboard + landscape

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Block the fullscreen notification on Android using download popups + keyboard + landscape

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 111

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Other

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox111 wontfix, firefox112 fixed, firefox113 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |
| firefox113 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox113 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: haxatron1, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ece264081141db92a1ad0d985a5d3489?d=mm&size=40)  [haxatron1](/user_profile?user_id=704427)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1822298&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1822298)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof")

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c11 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [fullscreen-bypass.html](/attachment.cgi?id=9322967)  [2 years ago](#c0)  [haxatron1](/user_profile?user_id=704427)   2.49 KB, text/html |  | [Details](/attachment.cgi?id=9322967&action=edit) |
| --- | --- | --- |
| [mobizen\_20230314\_212133.mp4](/attachment.cgi?id=9322968)  [2 years ago](#c1)  [haxatron1](/user_profile?user_id=704427)   1.72 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322968&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327596)  [2 years ago](#c12)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   12 bytes, text/plain |  | [Details](/attachment.cgi?id=9327596&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1822298#c0)• 2 years ago |
|  | |

Attached file
[fullscreen-bypass.html](attachment.cgi?id=9322967)
— [Details](attachment.cgi?id=9322967&action=edit)

Using a long download popup + keyboard, it is possible to push the fullscreen notification out of bounds on FF for Android.

STR

1. Go to landscape mode.
2. Click on input button in Firefox (tested on Nightly version)
Flags: sec-bounty?

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822298#a29_704427)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralOS: Unspecified → AndroidProduct: Firefox → FenixHardware: Unspecified → OtherVersion: unspecified → Firefox 111

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1822298#c1)• 2 years ago |
|  | |

Attached video
[mobizen\_20230314\_212133.mp4](attachment.cgi?id=9322968)
— [Details](attachment.cgi?id=9322968&action=edit)

Video.

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1822298#c2)• 2 years ago |
|  | |

cced petru.lingurar@softvision.com as they worked on <https://bugzilla.mozilla.org/show_bug.cgi?id=1783561>

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1822298#c3)• 2 years ago |
|  | |

Agree that this is a variation of [bug 1783561](/show_bug.cgi?id=1783561 "VERIFIED FIXED - Block the fullscreen notification on Android using download popups").

Even though the download dialog is smaller than the screen and there should be enough space left to show the fullscreen snackbar if the keyboard is also showing then there won't be any available space for the the snackbar.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1822298#c4)• 2 years ago |
|  | |

This would be fixed by [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag").

Depends on: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1822298#c5)• 2 years ago |
|  | |

Thanks, is this a duplicate of [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1822298#c6)• 2 years ago |
|  | |

It is provisionally a duplicate, but we'll see if that actually fixes this rather than jump the gun with an assumption.

See Also: → [1821576](/show_bug.cgi?id=1821576 "RESOLVED FIXED - safety browsing alert notification hides fullscreen notification on firefoxfocus, leads to spoof")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1822298#c7)• 2 years ago |
|  | |

The fix for [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") is now live in the latest Nightly.

It should ensure that the message informing users about the page entering fullscreen cannot be obscured anymore.

@haxatron1 Can you confirm that applies for this issue also?

Flags: needinfo?(haxatron1)

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1822298#c8)• 2 years ago |
|  | |

yes it seems fixed.

Flags: needinfo?(haxatron1)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1822298#c9)• 2 years ago |
|  | |

Thank you!

Closing this as fixed.

Tom to handle the bounty status.

Status: NEW → RESOLVEDClosed: 2 years agoFlags: needinfo?(tom)Resolution: --- → FIXED

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1822298#c10)• 2 years ago |
|  | |

We will address it in the weekly bounty meeting, thanks!

Flags: needinfo?(tom)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822298#a368888_75935)• 2 years ago |

Assignee: nobody → petru.lingurarGroup: mobile-core-security → core-security-release
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)Target Milestone: --- → 113 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1822298#c11)• 2 years ago |
|  | |

As we expected, this did turn out to be fixed by the redesigned mechanism in [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") making this essentially a dupe for purposes of the bug bounty.

Flags: sec-bounty? → sec-bounty-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1822298#c12)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327596)
— [Details](attachment.cgi?id=9327596&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822298#a18800724_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1822298#a38292514_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1822298&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [haxatron1](/user_profile?user_id=704427)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


