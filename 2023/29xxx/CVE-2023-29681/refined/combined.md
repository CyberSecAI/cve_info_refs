=== Content from medium.com_6625228e_20250115_094505.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa40f7ae6dc62&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400ta%2Ftenda-n301-v6-cve-2023-29680-cve-2023-29681-a40f7ae6dc62&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%400ta%2Ftenda-n301-v6-cve-2023-29680-cve-2023-29681-a40f7ae6dc62&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# TENDA–N301-v6–(CVE-2023–29680,CVE-2023–29681)

[![Mateus Pantoja](https://miro.medium.com/v2/resize:fill:88:88/1*RRNCPlHFAWSKfUOLx17LNw.jpeg)](/%400ta?source=post_page---byline--a40f7ae6dc62--------------------------------)

[Mateus Pantoja](/%400ta?source=post_page---byline--a40f7ae6dc62--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fcef16eb1e4f&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%400ta%2Ftenda-n301-v6-cve-2023-29680-cve-2023-29681-a40f7ae6dc62&user=Mateus+Pantoja&userId=cef16eb1e4f&source=post_page-cef16eb1e4f--byline--a40f7ae6dc62---------------------post_header-----------)

3 min read·Apr 30, 2023

--

Listen

Share

This post describes two weak-code implementations on Tenda routers using firmware v12.02.01.61\_multi and firmware v12.03.01.06\_pt, router version N301 from Tenda technology.

## Description

An Weak Encoding implementation is used in the Tenda N301v6 router when storing the password used to authenticate to the equipment, and the two firmwares do not implement settings that enable the use of https.

> Firmware: V12.03.01.06\_pt (CVE-2023–29680)
> Firmware: V12.02.01.61\_multi (CVE-2023–29681)

The base64 encoded password sent via cookie in the name-value pair attribute “cookie:ecos\_pw=”(Firmware: V12.03.01.06\_pt) and “set-cookie:ecos\_pw=”(Firmware: V12.02.01.61\_multi). This flaw allows an authenticated attacker on the LAN or WLAN to intercept communications with the router via arp spoofing and obtain the password that is passed in the request header via cookie in the “ecos\_pw=” attribute, making it possible to capture the encryption.

![Test scenario]()

Test scenario

If the password is successfully captured, the attacker is able to log into the equipment and set a new password, and it is possible to perform actions that interrupt the use of the network permanently.

## POC

Using an ARP spoofing technique to forward spoofed packets to the router, it is possible to intercept the communication using wireshark and thus obtain the credentials that were used when logging into the router.

![]()

sending fake packets

Credential obtained after packet interception, **Firmware: V12.03.01.06\_en (CVE-2023–29680)**

![]()

Credential obtained after packet interception, Firmware: V12.03.01.06\_en (CVE-2023–29680)

Credential obtained after packet interception, **Firmware: V12.02.01.61\_multi (CVE-2023–29681)**

![]()

Credential obtained after packet interception, Firmware: V12.02.01.61\_multi (CVE-2023–29681)

The credential is passed using base64, so it is possible to decode and login to the router.

![]()

Below is the link to the videos showing the exploration in both firmwares.

[POC\_TENDA\_N301\_V6\_firmware:V12.03.01.06.pt](https://youtu.be/Xy9_hmpvvA4)
[POC\_TENDA\_N301\_V6\_firmware-V12.02.01.61.multi](https://youtu.be/m7ZHfFcSKpU)

The PoC ends here.

As I said the poc ended here, below I make some observations.

This vulnerability was only possible because some important features were not implemented to ensure the security of the home user.

* Possibility to switch from HTTP to HTTPS
* Session management to avoid more than one admin connected at the same time
* Use of secure hash algorithms

Well, that’s it, this is my publication about CVEs and I believe this little contribution is useful for the cybersecurity community o/

Thanks and keep hacking !!!!!!!

[Cve](/tag/cve?source=post_page-----a40f7ae6dc62--------------------------------)[Hacking](/tag/hacking?source=post_page-----a40f7ae6dc62--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----a40f7ae6dc62--------------------------------)[Pentesting](/tag/pentesting?source=post_page-----a40f7ae6dc62--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----a40f7ae6dc62--------------------------------)

--

--

[![Mateus Pantoja](https://miro.medium.com/v2/resize:fill:96:96/1*RRNCPlHFAWSKfUOLx17LNw.jpeg)](/%400ta?source=post_page---post_author_info--a40f7ae6dc62--------------------------------)[![Mateus Pantoja](https://miro.medium.com/v2/resize:fill:128:128/1*RRNCPlHFAWSKfUOLx17LNw.jpeg)](/%400ta?source=post_page---post_author_info--a40f7ae6dc62--------------------------------)Follow[## Written by Mateus Pantoja](/%400ta?source=post_page---post_author_info--a40f7ae6dc62--------------------------------)[11 Followers](/%400ta/followers?source=post_page---post_author_info--a40f7ae6dc62--------------------------------)·[11 Following](/%400ta/following?source=post_page---post_author_info--a40f7ae6dc62--------------------------------)

Hi, I'm just a student and professional in the security area trying to share some knowledge =D

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----a40f7ae6dc62--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----a40f7ae6dc62--------------------------------)[About](/about?autoplay=1&source=post_page-----a40f7ae6dc62--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a40f7ae6dc62--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----a40f7ae6dc62--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----a40f7ae6dc62--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a40f7ae6dc62--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a40f7ae6dc62--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----a40f7ae6dc62--------------------------------)[Teams](/business?source=post_page-----a40f7ae6dc62--------------------------------)


