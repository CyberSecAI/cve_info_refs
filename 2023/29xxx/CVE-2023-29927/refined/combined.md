=== Content from www.controlgap.com_bda20c25_20250114_195642.html ===


[Skip to the main content.](#main-content)
[![ControlGap_CAC_LogoMark_Primary_Reversed](https://www.controlgap.com/hs-fs/hubfs/ControlGap_CAC_LogoMark_Primary_Reversed.png?width=3942&height=758&name=ControlGap_CAC_LogoMark_Primary_Reversed.png "ControlGap_CAC_LogoMark_Primary_Reversed")](//www.controlgap.com)

[![ControlGap_CAC_LogoMark_Primary_Reversed](https://www.controlgap.com/hs-fs/hubfs/ControlGap_CAC_LogoMark_Primary_Reversed.png?width=3942&height=758&name=ControlGap_CAC_LogoMark_Primary_Reversed.png "ControlGap_CAC_LogoMark_Primary_Reversed")](//www.controlgap.com)

* Services
  + [CyberSecurity](https://www.controlgap.com/services/cybersecurity)
  + [Offensive Security](https://www.controlgap.com/services/offensive-security)
  + [Penetration Testing](https://www.controlgap.com/services/penetration-testing)
  + [PCI Compliance](https://www.controlgap.com/services/pci-compliance)
  + [Data Remediation](https://www.controlgap.com/services/data-remediation)
  + [Forensics](https://www.controlgap.com/services/forensics)
* [Blog](https://www.controlgap.com/blog)
* [Who Is Control Gap?](https://www.controlgap.com/about-us)

[![Contact](https://no-cache.hubspot.com/cta/default/21079771/95b3c3f2-94cb-430b-ad2b-0df3c2e0059d.png)](https://cta-redirect.hubspot.com/cta/redirect/21079771/95b3c3f2-94cb-430b-ad2b-0df3c2e0059d)

Toggle Menu

Toggle Menu

[![Contact](https://no-cache.hubspot.com/cta/default/21079771/95b3c3f2-94cb-430b-ad2b-0df3c2e0059d.png)](https://cta-redirect.hubspot.com/cta/redirect/21079771/95b3c3f2-94cb-430b-ad2b-0df3c2e0059d)

* Services
  + [CyberSecurity](https://www.controlgap.com/services/cybersecurity)
  + [Offensive Security](https://www.controlgap.com/services/offensive-security)
  + [Penetration Testing](https://www.controlgap.com/services/penetration-testing)
  + [PCI Compliance](https://www.controlgap.com/services/pci-compliance)
  + [Data Remediation](https://www.controlgap.com/services/data-remediation)
  + [Forensics](https://www.controlgap.com/services/forensics)
* [Blog](https://www.controlgap.com/blog)
* [Who Is Control Gap?](https://www.controlgap.com/about-us)

[Facebook](#0)
[Instagram](#0)
[Linkedin](#0)
[X](#0)
[YouTube](#0)
[Medium](#0)

3 min read

# Critical Vulnerability Disclosure: Sage 300

[![Picture of Konrad Haase](https://www.controlgap.com/hubfs/Author%20Images/Konrad.jpg) Konrad Haase](https://www.controlgap.com/blog/author/konrad-hasse) :

Apr 27, 2023 11:08:45 AM

[offensivesecurity](https://www.controlgap.com/blog/tag/offensivesecurity)
[sage 300](https://www.controlgap.com/blog/tag/sage-300)

![Critical Vulnerability Disclosure: Sage 300](https://www.controlgap.com/hubfs/MicrosoftTeams-image%20%2862%29.png)

In 2022 Konrad Haase, a member of the Control Gap Offensive Security team, discovered a series of vulnerabilities in Sage 300, a well-established on-premises enterprise resource planning (ERP) solution, that could allow an attacker to bypass authentication and user-level access controls, decrypt sensitive data including stored passwords, and obtain direct database access to read/modify/delete all records. Over the past 10 months the Control Gap team has been working with Sage to develop a product update to address these issues, which Sage released on April 27, 2023. Users of the Sage 300 program are strongly encouraged to download and install this product update as soon as possible.

*On June 27 we published a [series of technical articles](/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-1) detailing the discovery and exploitation process for the six (6) vulnerabilities described below.*

#

#

# Disclosed Vulnerabilities

[CVE-2023-29927](https://nvd.nist.gov/vuln/detail/CVE-2023-29927): Versions of Sage 300 through 2022 implement role-based access controls that are only enforced client-side. Low-privileged Sage users, particularly those on a workstation setup in the "Windows Peer-to-Peer Network" or "Client Server Network" Sage 300 configurations, could recover the SQL connection strings being used by Sage 300 and interact directly with the underlying database(s) to create, update, and delete all company records, bypassing the program’s role-based access controls.

[CVE-2022-38583](https://nvd.nist.gov/vuln/detail/CVE-2022-38583): On versions of Sage 300 through 2022 that are setup in a "Windows Peer-to-Peer Network" or "Client Server Network" configuration, a low-privileged Sage 300 workstation user could leverage their access to the "SharedData" folder on the Sage 300 server to read and modify files containing encrypted Sage 300 user credentials, encrypted database connection strings, and application security settings. This can lead to privilege escalation within the Sage 300 platform.

[CVE-2022-41397](https://nvd.nist.gov/vuln/detail/CVE-2022-41397): The optional Web Screens and Global Search features for Sage 300 through version 2022 use a hard-coded 40-byte blowfish key ("LandlordPassKey") to encrypt and decrypt secrets stored in configuration files and in database tables.

[CVE-2022-41398](https://nvd.nist.gov/vuln/detail/CVE-2022-41398): The optional Global Search feature for Sage 300 through version 2022 uses a set of hard-coded credentials for the accompanying Apache Solr instance. This issue could allow attackers to login to the Solr dashboard with admin privileges and access sensitive information.

[CVE-2022-41399](https://nvd.nist.gov/vuln/detail/CVE-2022-41399): The optional Web Screens feature for Sage 300 through version 2022 uses a hard-coded 40-byte blowfish key ("PASS\_KEY") to encrypt and decrypt the database connection string for the PORTAL database found in the "dbconfig.xml" file. This issue could allow attackers to obtain access to the SQL database.

[CVE-2022-41400](https://nvd.nist.gov/vuln/detail/CVE-2022-41400): Sage 300 through 2022 uses a hard-coded 40-byte blowfish key to encrypt and decrypt user passwords and SQL connection strings stored in ISAM database files in the shared data directory. This issue could allow attackers to decrypt user passwords and SQL connection strings.

#

# Impact

The exploitation of the vulnerabilities described above could allow an attacker to gain unrestricted access to all Sage 300 data. This access could be leveraged to perform the following attacks:

1. Read and/or exfiltrate all ERP data, which may include sensitive financial and inventory information. This information could then be published to cause reputational damage to the company or leveraged to conduct further attacks against the organization.
2. Modify ERP data, which could allow attackers to commit fraud. For example, an attacker could modify payment information to reroute money transfers or inventory deliveries.
3. Delete the ERP data or hold ERP data for ransom to cause a business disruption.

Pictured below is the output of a tool developed by Control Gap to automatically exploit the disclosed issues. This output below shows the results after targeting the “WINDEV2204EVAL” system (a test system in a Control Gap lab environment) running Sage 300 2021 with both Web Screens and Global Search installed:

![MicrosoftTeams-image (60)](https://www.controlgap.com/hs-fs/hubfs/MicrosoftTeams-image%20(60).png?width=1484&height=842&name=MicrosoftTeams-image%20(60).png)

As depicted in the output above, these vulnerabilities could be exploited by an unauthenticated attacker to recover plaintext Sage 300 user passwords (including password history) and SQL login IDs that would allow that attacker to access all ERP data.

*After a 60-day patch adoption period, Control Gap published a [series of technical articles](/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-1) detailing the discovery and exploitation process for the six (6) vulnerabilities outlined in this disclosure. This series of articles could be used to produce a tool capable of the output pictured above. It is strongly recommended that Sage administrators apply the available product update as soon as possible if they have not already.*

#

# Mitigation

At time of publication, the newly released Sage 300 2023.2 product update addresses most of the disclosed issues and contains completely overhauled installation and administration instructions to mitigate the lone unpatched vulnerability (CVE-2023-29927).

Please refer to the official [Sage Knowledge Base article](https://support.na.sage.com/selfservice/viewdocument.do?noCount=true&externalId=119319) for updated security hardening guidance.

* [Tweet](https://twitter.com/share)

[![Access Control Facades and Hardcoded Secrets: A Sage 300 Case Study (Part 3)](https://www.controlgap.com/hubfs/MicrosoftTeams-image%20%2890%29.png)](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-3)

1 min read

#### [Access Control Facades and Hardcoded Secrets: A Sage 300 Case Study (Part 3)](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-3)

![Picture of Konrad Haase](https://www.controlgap.com/hs-fs/hubfs/Author%20Images/Konrad.jpg?width=30&name=Konrad.jpg)
[Konrad Haase](https://www.controlgap.com/blog/author/konrad-hasse) : Jun 27, 2023 5:05:04 PM

This is a continuation of the Sage 300 case study series where we explore the process of discovering and developing exploits for six (6) different...

[offensivesecurity](https://www.controlgap.com/blog/tag/offensivesecurity)
[sage 300](https://www.controlgap.com/blog/tag/sage-300)

[Read More](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-3)

[![Access Control Facades and Hardcoded Secrets: A Sage 300 Case Study (Part 2)](https://www.controlgap.com/hubfs/MicrosoftTeams-image%20%2889%29.png)](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-2)

1 min read

#### [Access Control Facades and Hardcoded Secrets: A Sage 300 Case Study (Part 2)](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-2)

![Picture of Konrad Haase](https://www.controlgap.com/hs-fs/hubfs/Author%20Images/Konrad.jpg?width=30&name=Konrad.jpg)
[Konrad Haase](https://www.controlgap.com/blog/author/konrad-hasse) : Jun 27, 2023 5:04:15 PM

This is a continuation of the Sage 300 case study series where we explore the process of discovering and developing exploits for six (6) different...

[offensivesecurity](https://www.controlgap.com/blog/tag/offensivesecurity)
[sage 300](https://www.controlgap.com/blog/tag/sage-300)

[Read More](https://www.controlgap.com/blog/access-control-facades-and-hardcoded-secrets-a-sage-300-case-study-part-2)

[![Control Gap Vulnerability Roundup: July 8th to 15th](https://www.controlgap.com/hubfs/Roundup/Vuln-roundup-red.png)](https://www.controlgap.com/blog/vulnerability-roundup-july-8th-15th)

1 min read

#### [Control Gap Vulnerability Roundup: July 8th to 15th](https://www.controlgap.com/blog/vulnerability-roundup-july-8th-15th)

![Picture of Zach Matthews](https://www.controlgap.com/hs-fs/hubfs/Author%20Images/Zach%20Matthews.gif?width=30&name=Zach%20Matthews.gif)
[Zach Matthews](https://www.controlgap.com/blog/author/zach-matthews) : Jul 18, 2022 2:09:29 PM

This week saw the publication of 561 new CVE IDs. Of those, 441 have not yet been assigned official CVSS scores, however, of the ones that were,...

[offensivesecurity](https://www.controlgap.com/blog/tag/offensivesecurity)
[Cybersecurity](https://www.controlgap.com/blog/tag/cybersecurity)
[Certified Zero](https://www.controlgap.com/blog/tag/certified-zero)
[CVE](https://www.controlgap.com/blog/tag/cve)

[Read More](https://www.controlgap.com/blog/vulnerability-roundup-july-8th-15th)

##### Services

Services

* [Cybersecurity](https://www.controlgap.com/services/cybersecurity)
* [Offensive Security](https://www.controlgap.com/services/offensive-security)
* [PCI Compliance](https://www.controlgap.com/services/pci-compliance)
* [Digital Innovation](https://www.controlgap.com/services/data-remediation)
* [Forensic](https://www.controlgap.com/services/forensics)

##### About Us

About Us

* [Our Story](https://www.controlgap.com/about-us)
* [Leadership](https://www.controlgap.com/about-us#leadership)
* [Credentials](https://www.controlgap.com/about-us#credentials)
* [Join Our Team](https://www.controlgap.com/careers)

##### Knowledge Base

Knowledge Base

* [Blog](https://www.controlgap.com/blog)
  + [Weekly [in]security](https://www.controlgap.com/blog)
  + [Blog Posts](https://www.controlgap.com/blog)
* [PCI Frequently Asked Questions](https://www.pcisecuritystandards.org/faqs/all/)
* [Webinars](https://www.youtube.com/channel/UCauJmiEDB4L13zp_7wwsNhQ)

##### Contact

Contact

* info@controlgap.com
* 1.866.644.8808

* [Terms Of Use](https://www.controlgap.com/terms-of-use)
* [Privacy Policy](https://www.controlgap.com/privacy-policy)
* [Security Policy](https://www.controlgap.com/security-policy)

© 2025 Control Gap Inc. All Rights Reserved

[Linkedin](https://www.linkedin.com/company/control-gap-inc/mycompany/)[YouTube](https://www.youtube.com/channel/UCauJmiEDB4L13zp_7wwsNhQ)

Return to top


