=== Content from github.com_06b408d6_20250114_193153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-spec-proposals%2Fpull%2F3401)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-spec-proposals%2Fpull%2F3401)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=matrix-org%2Fmatrix-spec-proposals)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-spec-proposals](/matrix-org/matrix-spec-proposals)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-spec-proposals) You must be signed in to change notification settings
* [Fork
  385](/login?return_to=%2Fmatrix-org%2Fmatrix-spec-proposals)
* [Star
   1k](/login?return_to=%2Fmatrix-org%2Fmatrix-spec-proposals)

* [Code](/matrix-org/matrix-spec-proposals)
* [Issues
  15](/matrix-org/matrix-spec-proposals/issues)
* [Pull requests
  501](/matrix-org/matrix-spec-proposals/pulls)
* [Actions](/matrix-org/matrix-spec-proposals/actions)
* [Projects
  1](/matrix-org/matrix-spec-proposals/projects)
* [Security](/matrix-org/matrix-spec-proposals/security)
* [Insights](/matrix-org/matrix-spec-proposals/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-spec-proposals)
* [Issues](/matrix-org/matrix-spec-proposals/issues)
* [Pull requests](/matrix-org/matrix-spec-proposals/pulls)
* [Actions](/matrix-org/matrix-spec-proposals/actions)
* [Projects](/matrix-org/matrix-spec-proposals/projects)
* [Security](/matrix-org/matrix-spec-proposals/security)
* [Insights](/matrix-org/matrix-spec-proposals/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmatrix-org%2Fmatrix-spec-proposals%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmatrix-org%2Fmatrix-spec-proposals%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# MSC3401: Native Group VoIP Signalling #3401

 Open

[ara4n](/ara4n)
wants to merge
24
commits into
[main](/matrix-org/matrix-spec-proposals/tree/main "matrix-org/matrix-spec-proposals:main")
*base:*
main

Choose a base branch

Branches
Tags

Could not load branches

Branch not found: **{{ refName }}**

 Loading

{{ refName }}
default

Could not load tags

Nothing to show

{{ refName }}
default

 Loading

### Are you sure you want to change the base?

Some commits from the old base branch may be removed from the timeline,
and old review comments may become outdated.

 Loading

Change base

from
[matthew/group-voip](/matrix-org/matrix-spec-proposals/tree/matthew/group-voip "matrix-org/matrix-spec-proposals:matthew/group-voip")

 Open

# [MSC3401: Native Group VoIP Signalling](#top) #3401

[ara4n](/ara4n)
wants to merge
24
commits into
[main](/matrix-org/matrix-spec-proposals/tree/main "matrix-org/matrix-spec-proposals:main")
from
[matthew/group-voip](/matrix-org/matrix-spec-proposals/tree/matthew/group-voip "matrix-org/matrix-spec-proposals:matthew/group-voip")

[Conversation
211](/matrix-org/matrix-spec-proposals/pull/3401)
[Commits
24](/matrix-org/matrix-spec-proposals/pull/3401/commits)
[Checks
0](/matrix-org/matrix-spec-proposals/pull/3401/checks)
[Files changed](/matrix-org/matrix-spec-proposals/pull/3401/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ara4n](https://avatars.githubusercontent.com/u/1294269?s=60&v=4)](/ara4n)

Copy link

Member

### @ara4n **[ara4n](/ara4n)** commented [Sep 19, 2021](#issue-1000454950) ‚Ä¢ edited Loading

[Rendered](https://github.com/matrix-org/matrix-doc/blob/matthew/group-voip/proposals/3401-group-voip.md)

Obsoletes [#2359](https://github.com/matrix-org/matrix-spec-proposals/pull/2359)

Sorry, something went wrong.

 üëç
27
 SimonBrandner, Tachi107, Esokrates, haslersn, a-andreyev, alangecker, barodeur, razzeee, Ernest1338, 6543, and 17 more reacted with thumbs up emoji
 üéâ
9
 SimonBrandner, lotsm-unix, Esokrates, Ernest1338, xaabi6, simulationguest, roland-5, tri2820, and boogiewoogit reacted with hooray emoji
 ‚ù§Ô∏è
6
 SimonBrandner, Esokrates, Ernest1338, charlag, roland-5, and hcsch reacted with heart emoji
 üöÄ
11
 ShadowJonathan, SimonBrandner, Esokrates, PeterCxy, Ernest1338, Genbuchan, robintown, bdelwood, roland-5, dubiousgit, and boogiewoogit reacted with rocket emoji
 üëÄ
5
 ShadowJonathan, SimonBrandner, Esokrates, Ernest1338, and 6543 reacted with eyes emoji

All reactions

* üëç
  27 reactions
* üéâ
  9 reactions
* ‚ù§Ô∏è
  6 reactions
* üöÄ
  11 reactions
* üëÄ
  5 reactions

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[MSC3401](https://github.com/matrix-org/matrix-doc/pull/3401)[: Native Group VoIP Signalling](/matrix-org/matrix-spec-proposals/pull/3401/commits/05fd5af890919fb864e983a044d2584a1425350b "MSC3401: Native Group VoIP Signalling")`

`[05fd5af](/matrix-org/matrix-spec-proposals/pull/3401/commits/05fd5af890919fb864e983a044d2584a1425350b)`

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&u=f76e582f26422d4e7e73419ade524f7e79aafb4a&v=4)](/ara4n)
[ara4n](/ara4n)
added
the
[proposal](/matrix-org/matrix-spec-proposals/labels/proposal)
A matrix spec change proposal
label
[Sep 19, 2021](#event-5325366708)

 [ara4n](/ara4n)
added 2 commits
[September 20, 2021 01:03](#commits-pushed-7f5ee49)

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[comments & cosmetics](/matrix-org/matrix-spec-proposals/pull/3401/commits/7f5ee49fd5424b91d521307c98dd67df380a7ca6 "comments & cosmetics")`

`[7f5ee49](/matrix-org/matrix-spec-proposals/pull/3401/commits/7f5ee49fd5424b91d521307c98dd67df380a7ca6)`

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[grammar](/matrix-org/matrix-spec-proposals/pull/3401/commits/083fd9a998e37485d8801509861190202b90a53a "grammar")`

`[083fd9a](/matrix-org/matrix-spec-proposals/pull/3401/commits/083fd9a998e37485d8801509861190202b90a53a)`

[![@turt2live](https://avatars.githubusercontent.com/u/1190097?s=40&u=4897d21a28d80c6f8e5762712720c6dc566e641e&v=4)](/turt2live)
[turt2live](/turt2live)
added
[kind:core](/matrix-org/matrix-spec-proposals/labels/kind%3Acore)
MSC which is critical to the protocol's success
[voip](/matrix-org/matrix-spec-proposals/labels/voip)
[needs-implementation](/matrix-org/matrix-spec-proposals/labels/needs-implementation)
This MSC does not have a qualifying implementation for the SCT to review. The MSC cannot enter FCP.
labels
[Sep 20, 2021](#event-5325537231)

[![ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=60&v=4)](/ShadowJonathan)

**[ShadowJonathan](/ShadowJonathan)**
reviewed
[Sep 20, 2021](#pullrequestreview-758322386)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

Copy link

Contributor

### @ShadowJonathan **[ShadowJonathan](/ShadowJonathan)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

üöÄ ‚òéÔ∏è

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  | } |
| --- | --- | --- |
|  |  | ``` |
|  |  |  |
|  |  | We mandate at most one call per room at any given point to avoid UX nightmares - if you want the user to participate in multiple parallel calls, you should simply create multiple rooms, each with one call. |

Copy link

Contributor

### @ShadowJonathan **[ShadowJonathan](/ShadowJonathan)** [Sep 20, 2021](#discussion_r711950320) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think that this is worth considering though, the UX nightmare might not be *that* bad (some clients might even work entirely with this possibility), and personally i think that putting the conf ID in a sub-field is just asking for problems (if the previous call information gets overridden by a person sending another state event for a "new" call while the last one is still in-progress.)

Why not move conf\_id into the state\_key, currently declare multiple calls UB and unsupported, while noting that speccing it and properly seating it would be a case for a future MSC?

Sorry, something went wrong.

 üëç
1
 aWeinzierl reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 22, 2021](#discussion_r714385392)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

have done.

Sorry, something went wrong.

 üëç
1
 ShadowJonathan reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Copy link

Member

### @dbkr **[dbkr](/dbkr)** [Aug 10, 2022](#discussion_r942645304)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Re-opening this one because we've just had a glare-like bug on Element Call where multiple people entered the call at the same time (as you do) and multiple conferences got created in the same room. In general, we're going to want some way to handle glare of several people hitting the 'start conference call' button at the same time. Allowing multiple calls in a room means we need to handle this somehow. It's not impossible (eg. we could define some common ID for 'the' call in a room allowing you to use other IDs for other calls?) but I'd just like to check that we really want to deal with this complexity.

Sorry, something went wrong.

 üëç
3
 SimonBrandner, daniel-abramov, and frebib reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Copy link

Contributor

### @SimonBrandner **[SimonBrandner](/SimonBrandner)** [Mar 29, 2023](#discussion_r1152255558) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am also very much in favour of having the `state_key` be just `""` because having multiple group calls in one room often leads to more problems rather than benefits

With [MSC3985](https://github.com/matrix-org/matrix-spec-proposals/pull/3985) we now also have a separate method to create break-out rooms, so it feels like multiple calls in one room are no longer necessary

I also think we should be able to use the `m.termintated` to calculate the call length

Sorry, something went wrong.

All reactions

Copy link

Member

### @robintown **[robintown](/robintown)** [Mar 29, 2023](#discussion_r1152270300)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think there is still an issue with relying on `m.terminated` to determine the call length: If a client wants to display a timeline tile with the duration at the point where the call was ended, then it works, but if clients want to display the tile at the point that the call was started (like Element Web does), and we're reusing the same state key for all calls, it's difficult to get the duration from that event. In fact, if there's a call ongoing in the room, there's no way to tell whether a given call event is part of the current call or not, short of crawling the timeline, so clients won't know whether to label it with "call ended".

With separate state keys, this is a lot easier, because it gives you a way to efficiently look up the current state of any call, current or historical.

Sorry, something went wrong.

 üëç
1
 SimonBrandner reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![deepbluev7](https://avatars.githubusercontent.com/u/16312324?s=60&v=4)](/deepbluev7)

**[deepbluev7](/deepbluev7)**
reviewed
[Sep 20, 2021](#pullrequestreview-758531889)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![robertlong](https://avatars.githubusercontent.com/u/1753624?s=60&v=4)](/robertlong)

**[robertlong](/robertlong)**
reviewed
[Sep 20, 2021](#pullrequestreview-758947542)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  | } |
| --- | --- | --- |
|  |  | ``` |
|  |  |  |
|  |  | Rather than sending arrays one can send `"all"` to either `start` or `stop` to start or stop all streams. |

Copy link

Contributor

### @robertlong **[robertlong](/robertlong)** [Sep 20, 2021](#discussion_r712399828)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Managing these streams via start/stop events seems a little prone to failure. Would it be easier to send the entire list of streams you wish to receive? This should be sufficiently small that the payload would never get too big and I think both the client/SFU logic would be simpler to manage.

Sorry, something went wrong.

 üëç
2
 SimonBrandner and kevincox reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 22, 2021](#discussion_r714379717)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

My reason for not doing this is that switching streams can happen very rapidly (e.g. the client could request different streams as they receive different active speaker notifications), and the idea of sending the whole list of all streams you care about every time just feels like a big waste of bandwidth. If you're in a big cascading conference with thousands of users (which this architecture could support!) do you really want to list out all the stream IDs when you want to switch from one speaker to the next?

Sorry, something went wrong.

All reactions

[![robertlong](https://avatars.githubusercontent.com/u/1753624?s=60&v=4)](/robertlong)

**[robertlong](/robertlong)**
reviewed
[Sep 20, 2021](#pullrequestreview-758951304)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  | C |
| --- | --- | --- |
|  |  | ``` |
|  |  |  |
|  |  | SFU (aka Focus): |

Copy link

Contributor

### @robertlong **[robertlong](/robertlong)** [Sep 20, 2021](#discussion_r712402750) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Bikeshedding warning: I'm relatively new to the WebRTC/VoIP industry, but I have never heard the term focus used in place of SFU. Is this a commonly known term? Should we be using SFU in this spec instead? Including renaming `m.foci` -> `m.sfus`?

Sorry, something went wrong.

 üëç
4
 SimonBrandner, jryans, kevincox, and kyrias reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 22, 2021](#discussion_r714378754)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

the reason i originally went with `foci` is because the field originally described the (mxid, deviceid) tuples where a given mxid could be contacted - which might either be a local device (for full mesh) or an SFU.

However, in the current simpler draft, the only time you include this field is if you are using a conferencing focus of some kind.

But, this proposal is not meant to just be for SFUs - the device you use to focus together your view of the conference could (in future) equally be an MCU as much as an SFU. Hence using the correct more generic term of 'focus' rather than making it specific to SFU technology. For instance, the server could advertise a stream which composites together a mosaic of different feeds for a non-E2EE call... at which point it's acting as a (hybrid) MCU.

The term 'focus' comes from SIP (e.g. <https://datatracker.ietf.org/doc/html/rfc3840#section-10.18>) and is the standard term there for "an endpoint you connect to which mixes together other endpoints". I'm slightly inclined to keep it, to keep thing flexible for future more sophisticated foci tech.

Sorry, something went wrong.

 üëç
3
 SimonBrandner, robertlong, and Tachi107 reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Copy link

Contributor

### @kevincox **[kevincox](/kevincox)** [Sep 22, 2021](#discussion_r714387053)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Can we call it `call_focus` or `stream_focus` or something a bit more descriptive than a not-well-known dictionary word?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 23, 2021](#discussion_r714390120)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

focus is a pretty well-known word, and foci is its plural. i don't particularly want to call it 'focuses', given that's a different word (the 3rd person present form of 'to focus'). not sure this is a showstopper.

Sorry, something went wrong.

 üëç
1
 reivilibre reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Copy link

Contributor

### @kevincox **[kevincox](/kevincox)** [Sep 23, 2021](#discussion_r714390785)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It definitely isn't a showstopper but I would like to come up with a better name if we can. It is also a bit of a red-flag that just about everything else in the MSC is calling it a SFU.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @kyrias **[kyrias](/kyrias)** [Sep 25, 2021](#discussion_r716036297) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

While focus is a well-known word, outside of Britain its plural *is* 'focuses', so I would expect that a lot of people are going to be similarly confused over its meaning. Even the Cambridge Dictionary [lists](https://dictionary.cambridge.org/dictionary/english/focus) 'focuses' as the plural, while listing 'foci' as the formal plural in the UK.

Might it be possible to at least mention in the spec that it's used in this sense?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @robertlong **[robertlong](/robertlong)** [Mar 9, 2022](#discussion_r823167486)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'm coming around to using "foci" as the word and there are references out there in the wild for "foci" being used in SIP terminology

<https://books.google.com/books?id=CyYAEAAAQBAJ&pg=PT66&lpg=PT66&dq=SIP+%22foci%22&source=bl&ots=zMu58i8hrj&sig=ACfU3U2VD7ts63JbE1HXkjWNoVRXi_3prA&hl=en&sa=X&ved=2ahUKEwjg9cT_j7r2AhUyGDQIHTtpCFoQ6AF6BAgCEAM#v=onepage&q=SIP%20%22foci%22&f=false>

<https://datatracker.ietf.org/doc/html/rfc4575#section-3.8>

I think we should keep foci.

Sorry, something went wrong.

All reactions

[![robertlong](https://avatars.githubusercontent.com/u/1753624?s=60&v=4)](/robertlong)

**[robertlong](/robertlong)**
reviewed
[Sep 20, 2021](#pullrequestreview-758957668)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![robertlong](https://avatars.githubusercontent.com/u/1753624?s=60&v=4)](/robertlong)

**[robertlong](/robertlong)**
reviewed
[Sep 20, 2021](#pullrequestreview-758959169)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 21, 2021](#pullrequestreview-759388351)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 21, 2021](#pullrequestreview-759402217)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 22, 2021](#pullrequestreview-760533528)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Comment on lines
71
 to
72

|  |  | \* `m.ring` if the call is meant to cause the room participants devices to ring (e.g. 1:1 call or group call) |
| --- | --- | --- |
|  |  | \* `m.conference` is the call should be presented as a conference call which users in the room may connect to |

Copy link

Contributor

### @SimonBrandner **[SimonBrandner](/SimonBrandner)** [Sep 22, 2021](#discussion_r713655752)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am wondering if these two are basically the same thing with different push rules? Is this influenced by push rules?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @kevincox **[kevincox](/kevincox)** [Sep 22, 2021](#discussion_r714374117)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It seems like there is a sort of intersection. I can see a use case where in the same room we may have "weekly sync" where we should buzz everyone and "debugging session" where people may drop in. Of course there are some rooms where I may not care about `m.ring`.

Maybe it is better to rephrase this as "priority"? Intent is very vague. Intent for what?

Sorry, something went wrong.

 üëç
1
 robertlong reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 22, 2021](#discussion_r714376561)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

i guess you could put this distinction into push rules, but it seems a bit simpler (especially given what a mess push rules are) to make it explicit here. After all, the difference between ringing and conferencing is not just the type of push notification you receive, but the whole UX (e.g. CallKit on iOS, or whether you display a dedicated ringing UX etc).

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @SimonBrandner **[SimonBrandner](/SimonBrandner)** [Sep 24, 2021](#discussion_r715796700)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

While that is true, I feel like we shouldn't use something that are not push rules for influencing notifications

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @robertlong **[robertlong](/robertlong)** [Mar 10, 2022](#discussion_r823230864)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@ara4n](https://github.com/ara4n) do you see any resolution to this? I agree, it probably should be separate to the push rules. Implementations should use `m.ring` as the first clue as to whether or not to ring a device and push rules should apply on top of it. The `m.ring` type also defines what UI to render in a client.

Sorry, something went wrong.

All reactions

Copy link

### @deepadmax **[deepadmax](/deepadmax)** [Feb 12, 2024](#discussion_r1485703542)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It would make sense to use intentional mentions for this. If none are included, it's like a conference call. Otherwise, in conjunction with the fact that it's a call event, the client would know to start ringing and not just pinging. To ring *everyone* in a room, you'd simply mention `@room`.

Sorry, something went wrong.

All reactions

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 22, 2021](#pullrequestreview-760537793)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![kevincox](https://avatars.githubusercontent.com/u/494012?s=60&v=4)](/kevincox)

**[kevincox](/kevincox)**
reviewed
[Sep 22, 2021](#pullrequestreview-761483889)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

Copy link

Contributor

### @kevincox **[kevincox](/kevincox)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think this is a solid improvement. I think there is a lot of minor massaging to rough edges but I think the code concepts are solid.

Sorry, something went wrong.

 üëç
1
 ara4n reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Comment on lines
71
 to
72

|  |  | \* `m.ring` if the call is meant to cause the room participants devices to ring (e.g. 1:1 call or group call) |
| --- | --- | --- |
|  |  | \* `m.conference` is the call should be presented as a conference call which users in the room may connect to |

Copy link

Contributor

### @kevincox **[kevincox](/kevincox)** [Sep 22, 2021](#discussion_r714374117)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It seems like there is a sort of intersection. I can see a use case where in the same room we may have "weekly sync" where we should buzz everyone and "debugging session" where people may drop in. Of course there are some rooms where I may not care about `m.ring`.

Maybe it is better to rephrase this as "priority"? Intent is very vague. Intent for what?

Sorry, something went wrong.

 üëç
1
 robertlong reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[incorporate review](/matrix-org/matrix-spec-proposals/pull/3401/commits/5ee96fb47c79e12c0a08d094a12634356b7d545f "incorporate review")`

`[5ee96fb](/matrix-org/matrix-spec-proposals/pull/3401/commits/5ee96fb47c79e12c0a08d094a12634356b7d545f)`

[![deepbluev7](https://avatars.githubusercontent.com/u/16312324?s=60&v=4)](/deepbluev7)

**[deepbluev7](/deepbluev7)**
reviewed
[Sep 22, 2021](#pullrequestreview-761500920)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/5ee96fb47c79e12c0a08d094a12634356b7d545f)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/5ee96fb47c79e12c0a08d094a12634356b7d545f#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | ## Encryption |
|  |  |  |
|  |  | We get E2EE for 1:1 and full mesh calls automatically in this model. |

Copy link

Contributor

### @deepbluev7 **[deepbluev7](/deepbluev7)** [Sep 22, 2021](#discussion_r714388808)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

One thing I don't like about this proposal, is that it uses quite a few unencrypted state events. If you join a conference, you are leaking metadata about

1. the call existing.
2. Who (tried to) participate in the call.
3. Maybe some info about the physical devices of the user

Normal calls are not affected by that, because they don't use state event. State events of course make it easier to track, that a room is a conference room or similar, but they currently can't be encrypted and calls are imo somewhat more sensitive metadata. Verification gets around that by using relations instead of state events.

I currently can't think of a good alternative to state events and maybe one day we will get magic encrypted state events, that none figured out so far. But maybe someone has an idea or we could at least call out this issue in the encryption, potential issues or security sections?

Sorry, something went wrong.

 üëÄ
1
 kevincox reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 23, 2021](#discussion_r714391315)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

fair point. i'm assuming we will have magic encrypted state events sooner or later, however.

Sorry, something went wrong.

 üëç
1
 deepbluev7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 23, 2021](#discussion_r714945429)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

. o O ( make `m.call` and `m.call.member` state events with no body, but a state\_key which contains an event\_id for a timeline E2EE event. clients then call `GET /event` on the event\_id in the state\_key of the state event in order to grab the encrypted contents of the event in question :P )

Sorry, something went wrong.

 üëç
1
 SimonBrandner reacted with thumbs up emoji
 üòÑ
1
 SimonBrandner reacted with laugh emoji

All reactions

* üëç
  1 reaction
* üòÑ
  1 reaction

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 23, 2021](#discussion_r714948080)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

or actually, keep the same state\_keys as before, but just have the contents be `{ "encrypted": "$event_id" }`. (shamelessly stolen from [@turt2live](https://github.com/turt2live))

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 27, 2021](#discussion_r717012159)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

...which has now turned into [#3414](https://github.com/matrix-org/matrix-spec-proposals/pull/3414)

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @robertlong **[robertlong](/robertlong)** [Mar 10, 2022](#discussion_r823233263)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Should we mark this resolved? Should we add [MSC3414](https://github.com/matrix-org/matrix-doc/pull/3414) to the spec?

Sorry, something went wrong.

All reactions

 [ara4n](/ara4n)
added 2 commits
[September 23, 2021 01:04](#commits-pushed-b90b85e)

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[more feedback](/matrix-org/matrix-spec-proposals/pull/3401/commits/b90b85eb0bfdd38bf0a17adb048deba2e8cfc557 "more feedback")`

`[b90b85e](/matrix-org/matrix-spec-proposals/pull/3401/commits/b90b85eb0bfdd38bf0a17adb048deba2e8cfc557)`

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&v=4)](/ara4n)

`[add](/matrix-org/matrix-spec-proposals/pull/3401/commits/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1 "add `purpose` from #3077") [purpose](/matrix-org/matrix-spec-proposals/pull/3401/commits/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1 "add `purpose` from #3077") [from](/matrix-org/matrix-spec-proposals/pull/3401/commits/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1 "add `purpose` from #3077") [#3077](https://github.com/matrix-org/matrix-spec-proposals/pull/3077)`

`[ed37a0d](/matrix-org/matrix-spec-proposals/pull/3401/commits/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)`

 [![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&u=f76e582f26422d4e7e73419ade524f7e79aafb4a&v=4)](/ara4n)
[ara4n](/ara4n)
[force-pushed](/matrix-org/matrix-spec-proposals/compare/3580f2fc1872e4590e76be639d80ced5cca3abcb..ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)
the
matthew/group-voip

branch
from
[`3580f2f`](/matrix-org/matrix-spec-proposals/commit/3580f2fc1872e4590e76be639d80ced5cca3abcb) to
[`ed37a0d`](/matrix-org/matrix-spec-proposals/commit/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)  [Compare](/matrix-org/matrix-spec-proposals/compare/3580f2fc1872e4590e76be639d80ced5cca3abcb..ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)
[September 23, 2021 00:10](#event-5346613712)

[![dbkr](https://avatars.githubusercontent.com/u/986903?s=60&v=4)](/dbkr)

**[dbkr](/dbkr)**
reviewed
[Sep 23, 2021](#pullrequestreview-761726333)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | ### Call participation |
|  |  |  |
|  |  | Users who want to participate in the call declare this by adding an `m.conf` field to their `m.room.member` state event. Ideally, we'd use a dedicated state event type for this, making it easier to rapidly spot who is in a conference. But given we don't want other people editing our state event and Matrix doesn't yet provide that level of access control, instead we (ab)use the `m.room.member` event to declare our participation in the conference in the context of the room. Therefore any profile updates need to be careful to preserve the `m.conf` field. |

Copy link

Member

### @dbkr **[dbkr](/dbkr)** [Sep 23, 2021](#discussion_r714577962)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Do we need to worry about clients setting a conf state event and then falling off a cliff, leaving the user stuck as if they're in a conference?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @SimonBrandner **[SimonBrandner](/SimonBrandner)** [Sep 23, 2021](#discussion_r714923185)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think <https://github.com/matrix-org/matrix-doc/pull/3401/files#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4dR177> answers that

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 23, 2021](#discussion_r715170774)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

that line handles clients setting an m.call.member event and falling off a cliff. if a client sets an m.call event and falls off a cliff, however, anyone with permission to overwrite the state event in the room can go and remove the 'stuck' call.

Sorry, something went wrong.

All reactions

[![ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=60&v=4)](/ShadowJonathan)

**[ShadowJonathan](/ShadowJonathan)**
reviewed
[Sep 23, 2021](#pullrequestreview-761819958)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a..ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=60&v=4)](/ShadowJonathan)

**[ShadowJonathan](/ShadowJonathan)**
reviewed
[Sep 23, 2021](#pullrequestreview-761825820)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a..ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  | @@ -252,13 +267,15 @@ An alternative to to-device messages is to use DMs. You still risk gappy sync p | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | ## Security considerations |
|  |  |  |
|  |  | State events are not encrypted currently, and so this leaks that a call is happening, and who is participating in it, and from which devices. |

Copy link

Contributor

### @ShadowJonathan **[ShadowJonathan](/ShadowJonathan)** [Sep 23, 2021](#discussion_r714653300) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

plus that it happened in the past and who there-and-then participated in it, by correlating it corresponding `m.call.member` state events.

Sorry, something went wrong.

All reactions

[![ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=60&v=4)](/ShadowJonathan)

**[ShadowJonathan](/ShadowJonathan)**
reviewed
[Sep 23, 2021](#pullrequestreview-761826571)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/083fd9a998e37485d8801509861190202b90a53a..ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 23, 2021](#pullrequestreview-762200878)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 23, 2021](#pullrequestreview-762214477)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Sep 23, 2021](#pullrequestreview-762216025)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/ed37a0dc7428f4f4510cc9124fc58bd5e760cab1#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

64 hidden items

Load more‚Ä¶

[![@giannissc](https://avatars.githubusercontent.com/u/20277283?s=40&v=4)](/giannissc)
[giannissc](/giannissc)
mentioned this pull request
[Jun 28, 2022](#ref-issue-759382094)

[Personal Wishlist Tracker (Ignore)
element-hq/element-android#2501](/element-hq/element-android/issues/2501)

Closed

11 tasks

[![SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=60&v=4)](/SimonBrandner)

**[SimonBrandner](/SimonBrandner)**
reviewed
[Jul 7, 2022](#pullrequestreview-1031340524)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![@robintown](https://avatars.githubusercontent.com/u/48614497?s=40&v=4)](/robintown)
[robintown](/robintown)
mentioned this pull request
[Jul 29, 2022](#ref-issue-1321676161)

[Port VideoChannelUtils to MSC3401
element-hq/element-web#22957](/element-hq/element-web/issues/22957)

Closed

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)
[SimonBrandner](/SimonBrandner)
mentioned this pull request
[Jul 29, 2022](#ref-pullrequest-1322257323)

[Add support for group calls using MSC3401
matrix-org/matrix-js-sdk#2553](/matrix-org/matrix-js-sdk/pull/2553)
 Merged

[![HarHarLinks](https://avatars.githubusercontent.com/u/2803622?s=60&v=4)](/HarHarLinks)

**[HarHarLinks](/HarHarLinks)**
reviewed
[Sep 21, 2022](#pullrequestreview-1115687056)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![bwindels](https://avatars.githubusercontent.com/u/274386?s=60&v=4)](/bwindels)

**[bwindels](/bwindels)**
reviewed
[Sep 23, 2022](#pullrequestreview-1118166206)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d)

Copy link

Contributor

### @bwindels **[bwindels](/bwindels)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

clarify how `m.expires_ts` should be interpreted

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

[![bwindels](https://avatars.githubusercontent.com/u/274386?s=60&v=4)](/bwindels)

**[bwindels](/bwindels)**
reviewed
[Sep 23, 2022](#pullrequestreview-1118494127)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

Show resolved

Hide resolved

This was referenced Sep 25, 2022

[Rip out SFU bits out of MSC3401
#3897](/matrix-org/matrix-spec-proposals/pull/3897)
 Merged

[[WIP] MSC3898: Native Matrix VoIP signalling for cascaded foci (SFUs, MCUs...)
#3898](/matrix-org/matrix-spec-proposals/pull/3898)
 Draft

[![ara4n](https://avatars.githubusercontent.com/u/1294269?s=60&v=4)](/ara4n)

**[ara4n](/ara4n)**
commented
[Sep 25, 2022](#pullrequestreview-1119456384)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  | Call setup then uses the normal `m.call.\*` events, except they are sent over to-device messages to the relevant devices (encrypted via Olm). This means: |
| --- | --- | --- |
|  |  |  |
|  |  | \* When initiating a 1:1 call, the `m.call.invite` is sent to the devices listed in `m.call.member` event's `m.devices` array using the `device\_id` field. |
|  |  | \* `m.call.\*` events sent via to-device messages should also include the following properties in their content: |

Copy link

Member

Author

### @ara4n **[ara4n](/ara4n)** [Sep 25, 2022](#discussion_r979462488)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

we seem to have completely missed `seq`, needed to make up for todevice events having no intrinsic ordering otherwise: [matrix-org/matrix-js-sdk@7f21f56](https://github.com/matrix-org/matrix-js-sdk/commit/7f21f569d53d0ec480176ee5f5fcaefd3ea7f8de)

Sorry, something went wrong.

All reactions

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038376348)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Maybe a dumb question here: does it mean that the order of the To-Device messages is not guaranteed? I'm asking since I've processed the To-Device messages on the SFU under the assumption that they come at the same order in which they were sent by the client. If the order is not guaranteed, it may cause some interesting (undesired) effects, e.g. if the "Invite -> Hangup" sequence comes as "Hangup -> Invite" on a server, the end effect will not be what the user expects. Or `Invite -> SelectAnswer` as `SelectAnswer -> Invite`.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @SimonBrandner **[SimonBrandner](/SimonBrandner)** [Dec 3, 2022](#discussion_r1038765481)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yes, it's not guaranteed and we should rely on the `seq` field

Sorry, something went wrong.

All reactions

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 5, 2022](#discussion_r1039553464) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

> Yes, it's not guaranteed and we should rely on the seq field

Oh, that's interesting. Should we document how to deal with it and what's the semantics? - I've noticed that a new commit has been pushed recently to add the `seq` to the request that says that it starts with 0 and gets incremented with each message. But where the counter is stored? I can imagine that it's a per-device counter (meaning that 2 different devices may generate the same `seq`)? And what happens when the overflow of the value occurs?

It also has some practical implications: how are we (as receivers) expected to handle it in a proper way? - I.e. imagine that we receive a "New ICE candidates message" on the SFU with a `seq=15` while the previous message from the sender had `seq=5`. We probably don't want to handle the message with `seq=15` right now if we have not yet received the previous 10 messages (since the current message with `seq=15` may not even be useful by the moment we process the previous 10, or maybe it's related to the invite that has been sent in `seq=10`). This means that in order to handle a message with `seq=15`, we would need to buffer a couple more messages (messages that went before `seq=15`) before we take a decision on whether to handle it.

However, this poses certain questions, namely if we're communicating with 1000 devices (SFU use case), this means we would need to store the `lastStoredSeq` for 1000 users, the problem is that we don't really know when to release the counter for a particular user from memory (i.e. when to remove it from the map since we don't know in advance the pool of devices that would communicate with us and we may theoretically receive a message from any of them) which means that the memory usage would grow indefinitely and once the SFU is restarted, we'll have the counters lost.

Another issue is that the sender can attack the receiver by sending a message with `seq=1` followed by a message with `seq=99999999999` and then another with `seq=99999999998` and another with `seq=99999999997` and, knowing that the other side buffers them since it can't process them, it will send them until the other side gets killed due to the OOM.

Sorry, something went wrong.

All reactions

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)
[SimonBrandner](/SimonBrandner)
mentioned this pull request
[Oct 20, 2022](#ref-pullrequest-1416825740)

[MSC3914: Matrix native group call push rule
#3914](/matrix-org/matrix-spec-proposals/pull/3914)
 Open

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)

`[Rip out SFU bits out of](/matrix-org/matrix-spec-proposals/pull/3401/commits/32f566aa6559a8501ed17ec47f11a5929cf177c8 "Rip out SFU bits out of MSC3401 (#3897)") [MSC3401](https://github.com/matrix-org/matrix-doc/pull/3401) [(](/matrix-org/matrix-spec-proposals/pull/3401/commits/32f566aa6559a8501ed17ec47f11a5929cf177c8 "Rip out SFU bits out of MSC3401 (#3897)")[#3897](https://github.com/matrix-org/matrix-spec-proposals/pull/3897)[)](/matrix-org/matrix-spec-proposals/pull/3401/commits/32f566aa6559a8501ed17ec47f11a5929cf177c8 "Rip out SFU bits out of MSC3401 (#3897)")`

`[32f566a](/matrix-org/matrix-spec-proposals/pull/3401/commits/32f566aa6559a8501ed17ec47f11a5929cf177c8)`

[![@robintown](https://avatars.githubusercontent.com/u/48614497?s=40&v=4)](/robintown)
[robintown](/robintown)
mentioned this pull request
[Nov 2, 2022](#ref-pullrequest-1432361820)

[Improve the README
element-hq/element-call#696](/element-hq/element-call/pull/696)
 Merged

[![dbkr](https://avatars.githubusercontent.com/u/986903?s=60&v=4)](/dbkr)

**[dbkr](/dbkr)**
reviewed
[Nov 18, 2022](#pullrequestreview-1185970763)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/32f566aa6559a8501ed17ec47f11a5929cf177c8)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/32f566aa6559a8501ed17ec47f11a5929cf177c8#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | The fields within the item in the `m.calls` contents are: |
|  |  |  |
|  |  | \* `m.call\_id` - the ID of the conference the user is claiming to participate in. If this doesn't match an unterminated `m.call` event, it should be ignored. |

Copy link

Member

### @dbkr **[dbkr](/dbkr)** [Nov 18, 2022](#discussion_r1026350548)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This probably ought to be `m.conf_id` to differentiate it from IDs of 1:1 calls and match the conf\_id field in m.call.\* to-device events?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @HarHarLinks **[HarHarLinks](/HarHarLinks)** [Nov 18, 2022](#discussion_r1026445260)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

See previous discussion at <https://github.com/matrix-org/matrix-spec-proposals/pull/3401/files#r823313876>

Sorry, something went wrong.

All reactions

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038372649)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Note: currently the `call_id` and `conf_id` are not identical. This seems to be confusing if we're talking about the SFU calls (not sure how it's handled in a full-mesh).

When working on an SFU recently, I realized that `conf_id` was the ID of a conference (or a call if you will) which was quite logical and expected. However, what I did not expect is that in addition to the `conf_id`, each To-Device message has a `call_id` which does not match the `conf_id` and which seems to be uniquely generated by each participant.

The thing is: `call_id` field does not make any sense for the SFU at the moment ([see the SFU MSC](https://github.com/matrix-org/matrix-spec-proposals/pull/3898)), since the SFU does not know what the `call_id` is (it looks like a randomly generated string that is different for each participant who tries to join a conference), but at the same time, the SFU is essentially obligated to store the `call_id` because the To-Device messages from the SFU to the participants are expected to have the `call_id` that matches the `call_id` value sent from participants to the SFU when they contact the SFU (I tried settings the `call_id` to match `conf_id` when sending a message from the SFU to the client, but the client discarded the message if the `call_id` did not match the `call_id` that the client sent to the SFU). So essentially, there is a `conf_id` the semantics of which is defined (it's the unique ID of a conference/call) and the `call_id` (which does not have any meaning for the SFU).

Sorry, something went wrong.

All reactions

 [robintown](/robintown)
added 2 commits
[November 30, 2022 11:07](#commits-pushed-3fde32b)

[![@robintown](https://avatars.githubusercontent.com/u/48614497?s=40&v=4)](/robintown)

`[Move expiration timestamps to be per-device (](/matrix-org/matrix-spec-proposals/pull/3401/commits/3fde32b16dfbb8c37494fcb0dfdd57c4d6afc3ce "Move expiration timestamps to be per-device (#3941)

As discussed with Robert Long")[#3941](https://github.com/matrix-org/matrix-spec-proposals/pull/3941)[)](/matrix-org/matrix-spec-proposals/pull/3401/commits/3fde32b16dfbb8c37494fcb0dfdd57c4d6afc3ce "Move expiration timestamps to be per-device (#3941)

As discussed with Robert Long")`
 ‚Ä¶

`[3fde32b](/matrix-org/matrix-spec-proposals/pull/3401/commits/3fde32b16dfbb8c37494fcb0dfdd57c4d6afc3ce)`

```
As discussed with Robert Long
```

[![@robintown](https://avatars.githubusercontent.com/u/48614497?s=40&v=4)](/robintown)

`[Specify who calls who (](/matrix-org/matrix-spec-proposals/pull/3401/commits/05b5db22d830d3ee2c3f230fba1bc3560af7912f "Specify who calls who (#3942)")[#3942](https://github.com/matrix-org/matrix-spec-proposals/pull/3942)[)](/matrix-org/matrix-spec-proposals/pull/3401/commits/05b5db22d830d3ee2c3f230fba1bc3560af7912f "Specify who calls who (#3942)")`

`[05b5db2](/matrix-org/matrix-spec-proposals/pull/3401/commits/05b5db22d830d3ee2c3f230fba1bc3560af7912f)`

[![daniel-abramov](https://avatars.githubusercontent.com/u/2765698?s=60&v=4)](/daniel-abramov)

**[daniel-abramov](/daniel-abramov)**
reviewed
[Dec 2, 2022](#pullrequestreview-1202842017)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/05b5db22d830d3ee2c3f230fba1bc3560af7912f)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/32f566aa6559a8501ed17ec47f11a5929cf177c8#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | The fields within the item in the `m.calls` contents are: |
|  |  |  |
|  |  | \* `m.call\_id` - the ID of the conference the user is claiming to participate in. If this doesn't match an unterminated `m.call` event, it should be ignored. |

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038372649)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Note: currently the `call_id` and `conf_id` are not identical. This seems to be confusing if we're talking about the SFU calls (not sure how it's handled in a full-mesh).

When working on an SFU recently, I realized that `conf_id` was the ID of a conference (or a call if you will) which was quite logical and expected. However, what I did not expect is that in addition to the `conf_id`, each To-Device message has a `call_id` which does not match the `conf_id` and which seems to be uniquely generated by each participant.

The thing is: `call_id` field does not make any sense for the SFU at the moment ([see the SFU MSC](https://github.com/matrix-org/matrix-spec-proposals/pull/3898)), since the SFU does not know what the `call_id` is (it looks like a randomly generated string that is different for each participant who tries to join a conference), but at the same time, the SFU is essentially obligated to store the `call_id` because the To-Device messages from the SFU to the participants are expected to have the `call_id` that matches the `call_id` value sent from participants to the SFU when they contact the SFU (I tried settings the `call_id` to match `conf_id` when sending a message from the SFU to the client, but the client discarded the message if the `call_id` did not match the `call_id` that the client sent to the SFU). So essentially, there is a `conf_id` the semantics of which is defined (it's the unique ID of a conference/call) and the `call_id` (which does not have any meaning for the SFU).

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/7a06ed7897586e364bb55a05e2515bf5cef4083d#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  | Call setup then uses the normal `m.call.\*` events, except they are sent over to-device messages to the relevant devices (encrypted via Olm). This means: |
| --- | --- | --- |
|  |  |  |
|  |  | \* When initiating a 1:1 call, the `m.call.invite` is sent to the devices listed in `m.call.member` event's `m.devices` array using the `device\_id` field. |
|  |  | \* `m.call.\*` events sent via to-device messages should also include the following properties in their content: |

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038376348)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Maybe a dumb question here: does it mean that the order of the To-Device messages is not guaranteed? I'm asking since I've processed the To-Device messages on the SFU under the assumption that they come at the same order in which they were sent by the client. If the order is not guaranteed, it may cause some interesting (undesired) effects, e.g. if the "Invite -> Hangup" sequence comes as "Hangup -> Invite" on a server, the end effect will not be what the user expects. Or `Invite -> SelectAnswer` as `SelectAnswer -> Invite`.

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/07f95477a06dda4891d38ef307fbffa49ead96a6#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  | { |
| --- | --- | --- |
|  |  | "kind": "audio", |
|  |  | "id": "zvhjiwqsx", // WebRTC MediaStreamTrack id |
|  |  | "label": "Sennheiser Mic", |

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038399850)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yeah, right. Should we remove it? (I also don't seem to find a case where we would want to let others know what are devices are called when publishing ü§î)

Sorry, something went wrong.

 üëç
1
 SimonBrandner reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/05b5db22d830d3ee2c3f230fba1bc3560af7912f#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

Comment on lines
+150
 to
+155

|  |  | "settings": { |
| --- | --- | --- |
|  |  | "width": 1280, |
|  |  | "height": 720, |
|  |  | "facingMode": "user", |
|  |  | "frameRate": 30.0, |
|  |  | "m.maxbr": 512000, |

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038559002)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Are these `settings` required for some matrix-specific logic? (maybe bridges that may need this data about a stream or a track?)

I'm just wondering if they are useful in a general case (like why would we need the information about a `facingMode` of a camera for intsance?). I.e. when we're talking about the SFU, the SFU does not really need to know the facing mode of a user I guess and I'm also not sure if the other call participants would benefit from this information.

The only case where I assume the information about camera mode etc might be useful is when there is a **specific app** that runs over Matrix and needs to advertise the properties of the video/audio streams in order to implement a specific logic. But in this case, we're talking about application-specific data, i.e. something that must be the logic of the app rather than part of a [generic] Matrix protocol.

I think generally we only need the stream and track IDs, a purpose (for the use case of conference / using WebRTC for calls), and, **perhaps** basic information about certain tracks like the width and height of the video (theoretically it's not required, because we'll be able to access it when the track is received, but practically we would need it for the simulcast implementation on the SFU side, so such information would be useful for the conference use cases).

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/05b5db22d830d3ee2c3f230fba1bc3560af7912f#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | This builds on [MSC3077](https://github.com/matrix-org/matrix-spec-proposals/pull/3077), which describes streams in `m.call.\*` events via a `sdp\_stream\_metadata` field. |
|  |  |  |
|  |  | \*\* TODO: Do we need all of this data? Why would we need it? \*\* |

Copy link

### @daniel-abramov **[daniel-abramov](/daniel-abramov)** [Dec 2, 2022](#discussion_r1038563086)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

IMHO we only need to submit the minimally required information about streams and tracks that would be enough for the calls to happen (with or without the SFU).

The details (`label`, `displaySurface`, `facingMode`, or even `bitrate`) are probably something that we generally speaking don't need. The **apps** that run on top of the Matrix could always exchange arbitrary metadata about their devices/tracks/streams if they need it: we anyway won't be able to describe **all possible** use cases for the matrixRTC in advance since we don't really know all of the use-cases - strictly speaking, video and audio tracks are not necessarily coming from a webcam or a microphone in a general [matrixRTC] case, they could be anything ranging from a mirrorless camera feed attached to the laptop to an audio output of digital instruments forwarded via a DAW).

Sorry, something went wrong.

 ‚ù§Ô∏è
1
 SimonBrandner reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

 [SimonBrandner](/SimonBrandner)
added 4 commits
[December 3, 2022 12:25](#commits-pushed-43dc42f)

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)

`[Clarify expires_ts](/matrix-org/matrix-spec-proposals/pull/3401/commits/43dc42fd84251f171527fe13246b68a5d808014d "Clarify `expires_ts`

Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>")`
 ‚Ä¶

`[43dc42f](/matrix-org/matrix-spec-proposals/pull/3401/commits/43dc42fd84251f171527fe13246b68a5d808014d)`

```
Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>
```

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)

`[Add seq](/matrix-org/matrix-spec-proposals/pull/3401/commits/5635cee60ce8b5bcffc050a246a0752291536b2b "Add `seq`

Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>")`
 ‚Ä¶

`[5635cee](/matrix-org/matrix-spec-proposals/pull/3401/commits/5635cee60ce8b5bcffc050a246a0752291536b2b)`

```
Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>
```

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)

`[Use heading for Legend](/matrix-org/matrix-spec-proposals/pull/3401/commits/b8ebe275b20f9f1b9652aa54a26ba8258d9641cb "Use heading for Legend

Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>")`
 ‚Ä¶

`[b8ebe27](/matrix-org/matrix-spec-proposals/pull/3401/commits/b8ebe275b20f9f1b9652aa54a26ba8258d9641cb)`

```
Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>
```

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner)

`[Fix-up some formatting](/matrix-org/matrix-spec-proposals/pull/3401/commits/6b98d667cf634f78c6604151276d5ef25d305aac "Fix-up some formatting

Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>")`
 ‚Ä¶

`[6b98d66](/matrix-org/matrix-spec-proposals/pull/3401/commits/6b98d667cf634f78c6604151276d5ef25d305aac)`

```
Signed-off-by: ≈†imon Brandner <simon.bra.ag@gmail.com>
```

[![@fkwp](https://avatars.githubusercontent.com/u/5071496?s=40&v=4)](/fkwp)
[fkwp](/fkwp)
mentioned this pull request
[Dec 8, 2022](#ref-issue-1484529683)

[Calls Support (MSC3401)
element-hq/hydrogen-web#946](/element-hq/hydrogen-web/issues/946)

Closed

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=40&u=f76e582f26422d4e7e73419ade524f7e79aafb4a&v=4)](/ara4n)
[ara4n](/ara4n)
mentioned this pull request
[Dec 27, 2022](#ref-pullrequest-1367651107)

[MSC3888: Voice Broadcast
#3888](/matrix-org/matrix-spec-proposals/pull/3888)
 Open

[![bwindels](https://avatars.githubusercontent.com/u/274386?s=60&v=4)](/bwindels)

**[bwindels](/bwindels)**
reviewed
[Feb 6, 2023](#pullrequestreview-1285349548)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac)

Copy link

Contributor

### @bwindels **[bwindels](/bwindels)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

a comment about scope of `seq` counter

Sorry, something went wrong.

All reactions

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  | discarded. |
| --- | --- | --- |
|  |  | \* `seq` - The sequence number of the to-device message. This is done since the |
|  |  | order of to-device messages is not guaranteed. With each new to-device |
|  |  | message this number gets incremented by `1` and it starts at `0` |

Copy link

Contributor

### @bwindels **[bwindels](/bwindels)** [Feb 6, 2023](#discussion_r1097482166)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Can we specify here whether this counter is scoped to the `dest_session_id` or the `call_id`? E.g. should it be reset or not when a webrtc connection between two peers is being retried with a new peer connection? Or only be reset after refreshing the client? Hydrogen currently does not reset when retrying a peer connection, nor does Element Call I think, but I think resetting in this case, e.g. scoping it to the call\_id, might actually make more sense as signalling between call\_id's should be independent (you always only have one call\_id per member in a group call) and there is no point in forcing clients to keep the counter in memory longer than needed, e.g. if they are not joined to the call.

Suggested change

|  | message this number gets incremented by `1` and it starts at `0` |
| --- | --- |
|  | message this number gets incremented by `1` and it starts at `0`. |
|  | This counter is scoped to the `call\_id`, not the `dest\_session\_id`, |
|  | e.g. it should be reset to 0 when the `call\_id` has changed, |
|  | for example when retrying a peer connection between two group |
|  | call members after a `m.call.hangup` has been sent. |

Sorry, something went wrong.

All reactions

[![@rriemann](https://avatars.githubusercontent.com/u/111932?s=40&v=4)](/rriemann)
[rriemann](/rriemann)
mentioned this pull request
[Mar 13, 2023](#ref-issue-1621498341)

[Multi-party E2EE voice calls via Jitsi
element-hq/element-meta#1147](/element-hq/element-meta/issues/1147)

Open

[![HybridEidolon](https://avatars.githubusercontent.com/u/141511?s=60&v=4)](/HybridEidolon)

**[HybridEidolon](/HybridEidolon)**
reviewed
[Jun 15, 2023](#pullrequestreview-1480644345)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  |  |
| --- | --- | --- |
|  |  | ### m.call state event |
|  |  |  |
|  |  | The user who wants to initiate a call sends a `m.call` state event into the room to inform the room participants that a call is happening in the room. This effectively becomes the placeholder event in the timeline which clients would use to display the call in their scrollback (including duration and termination reason using `m.terminated`). Its body has the following fields: |

Copy link

### @HybridEidolon **[HybridEidolon](/HybridEidolon)** [Jun 15, 2023](#discussion_r1230403885)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The `m.room.power_levels` state event specifies that posting state events requires a power level of 50 by default. From a user experience standpoint, I would think it is reasonable for normal users in a room to be able to start calls in that room by default, but with the current power\_levels policy it would need the `m.call` power level set lower. It may be desirable for room creation UX in clients to present the option to set this level upfront.

Perhaps there should be a way to specify a different power level requirement for different intents as well. A Discord user would expect to be able to start a room's call freely without disturbing other members of the room ala `m.room` intent. On the other hand, an `m.ring` is a much more disruptive intent that would be reserved for smaller group chats and should not normally be allowed in other kinds of rooms.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @MTRNord **[MTRNord](/MTRNord)** [Jun 15, 2023](#discussion_r1230492782)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Imho outside of DMs (where both users have PL100 anyway usually) calls should not be allowed for normal users. It is still a vector of spam. Just imagine having calls being started in Matrix HQ. It would just cause issues imho.

Imho it is a sane default to restrict this and need active changes to allow it in a room.

Sorry, something went wrong.

All reactions

Copy link

### @HybridEidolon **[HybridEidolon](/HybridEidolon)** [Jun 15, 2023](#discussion_r1231437419)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

> Just imagine having calls being started in Matrix HQ. It would just cause issues imho.

This is what I mean about the different call intents causing different levels of disruption. You're right, obviously `m.ring` has very different impact from `m.prompt` or `m.room` and the default should be to disallow that. But a room's administration may want users to be able to start calls with one intent and not the other.

Unless I'm misunderstanding the purpose of `m.room`? Is the idea for `m.room` intent that a room would *always* have a call "active", even if it has no participants, ala a "voice channel" in Discord, such that a level-0 user would typically not be able to end that call ergo not need to be able to publish state events for it other than `m.call.member`?

Sorry, something went wrong.

All reactions

[![HybridEidolon](https://avatars.githubusercontent.com/u/141511?s=60&v=4)](/HybridEidolon)

**[HybridEidolon](/HybridEidolon)**
reviewed
[Jun 15, 2023](#pullrequestreview-1480650978)

 [View reviewed changes](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac)

[proposals/3401-group-voip.md](/matrix-org/matrix-spec-proposals/pull/3401/files/6b98d667cf634f78c6604151276d5ef25d305aac#diff-a6d4763a98532010d751fbec7c898cb0fe27a757323befd0a1eb4ca443bbca4d)

|  |  |  |
| --- | --- | --- |
|  |  | ### Call participation |
|  |  |  |
|  |  | Users who want to participate in the call declare this by publishing a `m.call.member` state event using their matrix ID as the state key (thus ensuring other users cannot edit it). The event contains an array `m.calls` of objects describing which calls the user is participating in within that room. This array must contain one item (for now). |

Copy link

### @HybridEidolon **[HybridEidolon](/HybridEidolon)** [Jun 15, 2023](#discussion_r1230408649) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

~~What happens if the user does not publish an `m.call.member` event to leave a call?~~ (nevermind, saw the consideration at the bottom) Additionally, does a user convey they are leaving a call by publishing with `m.calls` as an empty array?

Sorry, something went wrong.

All reactions

[![@jplatte](https://avatars.githubusercontent.com/u/951129?s=40&v=4)](/jplatte)
[jplatte](/jplatte)
mentioned this pull request
[Oct 19, 2023](#ref-pullrequest-1949400165)

[Add CallMemberEvent (All state events required for matrixRTC)
ruma/ruma#1685](/ruma/ruma/pull/1685)
 Merged

[![@wrenix](https://avatars.githubusercontent.com/u/133280015?s=40&v=4)](/wrenix)
[wrenix](/wrenix)
mentioned this pull request
[Aug 29, 2024](#ref-issue-2495499148)

[support new/modern Matrix Call
krille-chan/fluffychat#1310](/krille-chan/fluffychat/issues/1310)

Open

[![@nyabinary](https://avatars.githubusercontent.com/u/97130632?s=80&u=291e7cbf0951d1bec50b3ec040c6fe2ba4c9b3cd&v=4)](/nyabinary)

Copy link

### **[nyabinary](/nyabinary)** commented [Sep 16, 2024](#issuecomment-2353204692)

| Any reason why this seemingly stalled? :p |
| --- |

 üëç
6
 nthnjhnsn, Xpl0itR, HybridEidolon, xxfogs, aviallon, and PseudoResonance reacted with thumbs up emoji
 üëÄ
6
 6543, mactan-sc, xxfogs, bitSheriff, quantenzitrone, and flightnut reacted with eyes emoji

All reactions

* üëç
  6 reactions
* üëÄ
  6 reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-spec-proposals%2Fpull%2F3401)

Reviewers

[![@HarHarLinks](https://avatars.githubusercontent.com/u/2803622?s=40&v=4)](/HarHarLinks) [HarHarLinks](/HarHarLinks)

HarHarLinks left review comments

[![@daniel-abramov](https://avatars.githubusercontent.com/u/2765698?s=40&v=4)](/daniel-abramov) [daniel-abramov](/daniel-abramov)

daniel-abramov left review comments

[![@MTRNord](https://avatars.githubusercontent.com/u/1374914?s=40&v=4)](/MTRNord) [MTRNord](/MTRNord)

MTRNord left review comments

[![@robintown](https://avatars.githubusercontent.com/u/48614497?s=40&v=4)](/robintown) [robintown](/robintown)

robintown left review comments

[![@HybridEidolon](https://avatars.githubusercontent.com/u/141511?s=40&v=4)](/HybridEidolon) [HybridEidolon](/HybridEidolon)

HybridEidolon left review comments

[![@deepbluev7](https://avatars.githubusercontent.com/u/16312324?s=40&v=4)](/deepbluev7) [deepbluev7](/deepbluev7)

deepbluev7 left review comments

[![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=40&v=4)](/SimonBrandner) [SimonBrandner](/SimonBrandner)

SimonBrandner left review comments

[![@turt2live](https://avatars.githubusercontent.com/u/1190097?s=40&v=4)](/turt2live) [turt2live](/turt2live)

turt2live left review comments

[![@bwindels](https://avatars.githubusercontent.com/u/274386?s=40&v=4)](/bwindels) [bwindels](/bwindels)

bwindels left review comments

[![@kevincox](https://avatars.githubusercontent.com/u/494012?s=40&v=4)](/kevincox) [kevincox](/kevincox)

kevincox left review comments

[![@richvdh](https://avatars.githubusercontent.com/u/1389908?s=40&v=4)](/richvdh) [richvdh](/richvdh)

richvdh left review comments

[![@deepadmax](https://avatars.githubusercontent.com/u/13934624?s=40&v=4)](/deepadmax) [deepadmax](/deepadmax)

deepadmax left review comments

[![@ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=40&v=4)](/ShadowJonathan) [ShadowJonathan](/ShadowJonathan)

ShadowJonathan left review comments

[![@kyrias](https://avatars.githubusercontent.com/u/2285387?s=40&v=4)](/kyrias) [kyrias](/kyrias)

kyrias left review comments

[![@anoadragon453](https://avatars.githubusercontent.com/u/1342360?s=40&v=4)](/anoadragon453) [anoadragon453](/anoadragon453)

anoadragon453 left review comments

[![@dbkr](https://avatars.githubusercontent.com/u/986903?s=40&v=4)](/dbkr) [dbkr](/dbkr)

dbkr left review comments

[![@robertlong](https://avatars.githubusercontent.com/u/1753624?s=40&v=4)](/robertlong) [robertlong](/robertlong)

robertlong left review comments

Assignees

No one assigned

Labels

[kind:core](/matrix-org/matrix-spec-proposals/labels/kind%3Acore)
MSC which is critical to the protocol's success
[needs-implementation](/matrix-org/matrix-spec-proposals/labels/needs-implementation)
This MSC does not have a qualifying implementation for the SCT to review. The MSC cannot enter FCP.
[proposal](/matrix-org/matrix-spec-proposals/labels/proposal)
A matrix spec change proposal
[voip](/matrix-org/matrix-spec-proposals/labels/voip)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

19 participants

[![@ara4n](https://avatars.githubusercontent.com/u/1294269?s=52&v=4)](/ara4n) [![@nyabinary](https://avatars.githubusercontent.com/u/97130632?s=52&v=4)](/nyabinary) [![@HybridEidolon](https://avatars.githubusercontent.com/u/141511?s=52&v=4)](/HybridEidolon) [![@bwindels](https://avatars.githubusercontent.com/u/274386?s=52&v=4)](/bwindels) [![@kevincox](https://avatars.githubusercontent.com/u/494012?s=52&v=4)](/kevincox) [![@dbkr](https://avatars.githubusercontent.com/u/986903?s=52&v=4)](/dbkr) [![@turt2live](https://avatars.githubusercontent.com/u/1190097?s=52&v=4)](/turt2live) [![@anoadragon453](https://avatars.githubusercontent.com/u/1342360?s=52&v=4)](/anoadragon453) [![@MTRNord](https://avatars.githubusercontent.com/u/1374914?s=52&v=4)](/MTRNord) [![@richvdh](https://avatars.githubusercontent.com/u/1389908?s=52&v=4)](/richvdh) [![@robertlong](https://avatars.githubusercontent.com/u/1753624?s=52&v=4)](/robertlong) [![@kyrias](https://avatars.githubusercontent.com/u/2285387?s=52&v=4)](/kyrias) [![@daniel-abramov](https://avatars.githubusercontent.com/u/2765698?s=52&v=4)](/daniel-abramov) [![@HarHarLinks](https://avatars.githubusercontent.com/u/2803622?s=52&v=4)](/HarHarLinks) [![@deepadmax](https://avatars.githubusercontent.com/u/13934624?s=52&v=4)](/deepadmax) [![@deepbluev7](https://avatars.githubusercontent.com/u/16312324?s=52&v=4)](/deepbluev7) [![@ShadowJonathan](https://avatars.githubusercontent.com/u/22740616?s=52&v=4)](/ShadowJonathan) [![@SimonBrandner](https://avatars.githubusercontent.com/u/25768714?s=52&v=4)](/SimonBrandner) [![@robintown](https://avatars.githubusercontent.com/u/48614497?s=52&v=4)](/robintown)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_5956fbde_20250114_193142.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Freleases%2Ftag%2Fv24.1.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Freleases%2Ftag%2Fv24.1.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=matrix-org%2Fmatrix-js-sdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-js-sdk](/matrix-org/matrix-js-sdk)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk) You must be signed in to change notification settings
* [Fork
  606](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)
* [Star
   1.7k](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)

* [Code](/matrix-org/matrix-js-sdk/tree/v24.1.0)
* [Issues
  228](/matrix-org/matrix-js-sdk/issues)
* [Pull requests
  28](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects
  0](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-js-sdk/tree/v24.1.0)
* [Issues](/matrix-org/matrix-js-sdk/issues)
* [Pull requests](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

1. [Releases](/matrix-org/matrix-js-sdk/releases)
2. [v24.1.0](/matrix-org/matrix-js-sdk/releases/tag/v24.1.0)

# v24.1.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/matrix-org/matrix-js-sdk/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v24.1.0)

 Loading

[View all tags](/matrix-org/matrix-js-sdk/tags)

![@RiotRobot](https://avatars.githubusercontent.com/u/24480685?s=40&v=4)
[RiotRobot](/RiotRobot)
released this
11 Apr 13:00

¬∑
[1451 commits](/matrix-org/matrix-js-sdk/compare/v24.1.0...develop)
to develop
since this release

[v24.1.0](/matrix-org/matrix-js-sdk/tree/v24.1.0)

[`7d45947`](/matrix-org/matrix-js-sdk/commit/7d45947fb3dc4b0e291e03adac5348ad8eeaf32a)

## ‚ú® Features

* Allow via\_servers property in findPredecessor (update to [MSC3946](https://github.com/matrix-org/matrix-spec-proposals/pull/3946)) ([#3240](https://github.com/matrix-org/matrix-js-sdk/pull/3240)). Contributed by [@andybalaam](https://github.com/andybalaam).
* Fire `closed` event when IndexedDB closes unexpectedly ([#3218](https://github.com/matrix-org/matrix-js-sdk/pull/3218)).
* Implement [MSC3952](https://github.com/matrix-org/matrix-spec-proposals/pull/3952): intentional mentions ([#3092](https://github.com/matrix-org/matrix-js-sdk/pull/3092)). Fixes [element-hq/element-web#24376](https://github.com/element-hq/element-web/issues/24376).
* Send one time key count and unused fallback keys for rust-crypto ([#3215](https://github.com/matrix-org/matrix-js-sdk/pull/3215)). Fixes [element-hq/element-web#24795](https://github.com/element-hq/element-web/issues/24795). Contributed by [@florianduros](https://github.com/florianduros).
* Improve `processBeaconEvents` hotpath ([#3200](https://github.com/matrix-org/matrix-js-sdk/pull/3200)).
* Implement [MSC3966](https://github.com/matrix-org/matrix-spec-proposals/pull/3966): a push rule condition to check if an array contains a value ([#3180](https://github.com/matrix-org/matrix-js-sdk/pull/3180)).

## üêõ Bug Fixes

* indexddb-local-backend - return the current sync to database promise ‚Ä¶ ([#3222](https://github.com/matrix-org/matrix-js-sdk/pull/3222)). Contributed by [@texuf](https://github.com/texuf).
* Revert "Add the call object to Call events" ([#3236](https://github.com/matrix-org/matrix-js-sdk/pull/3236)).
* Handle group call redaction ([#3231](https://github.com/matrix-org/matrix-js-sdk/pull/3231)). Fixes [element-hq/voip-internal#128](https://github.com/element-hq/voip-internal/issues/128).
* Stop doing O(n^2) work to find event's home (`eventShouldLiveIn`) ([#3227](https://github.com/matrix-org/matrix-js-sdk/pull/3227)). Contributed by [@jryans](https://github.com/jryans).
* Fix bug where video would not unmute if it started muted ([#3213](https://github.com/matrix-org/matrix-js-sdk/pull/3213)). Fixes [element-hq/element-call#925](https://github.com/element-hq/element-call/issues/925).
* Fixes to event encryption in the Rust Crypto implementation ([#3202](https://github.com/matrix-org/matrix-js-sdk/pull/3202)).

### Contributors

* [![@andybalaam](https://avatars.githubusercontent.com/u/76812?s=64&v=4)](https://github.com/andybalaam)
* [![@jryans](https://avatars.githubusercontent.com/u/279572?s=64&v=4)](https://github.com/jryans)
* [![@texuf](https://avatars.githubusercontent.com/u/950745?s=64&v=4)](https://github.com/texuf)
* [![@florianduros](https://avatars.githubusercontent.com/u/2621378?s=64&v=4)](https://github.com/florianduros)

andybalaam, jryans, and 2 other contributors

 Assets
6

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e28e0b81_20250114_193143.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fsecurity%2Fadvisories%2FGHSA-6g67-q39g-r79q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fsecurity%2Fadvisories%2FGHSA-6g67-q39g-r79q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=matrix-org%2Fmatrix-js-sdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-js-sdk](/matrix-org/matrix-js-sdk)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk) You must be signed in to change notification settings
* [Fork
  606](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)
* [Star
   1.7k](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)

* [Code](/matrix-org/matrix-js-sdk)
* [Issues
  228](/matrix-org/matrix-js-sdk/issues)
* [Pull requests
  28](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects
  0](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-js-sdk)
* [Issues](/matrix-org/matrix-js-sdk/issues)
* [Pull requests](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

# Invisible eavesdropping in group calls

Moderate

[dkasak](/dkasak)
published
GHSA-6g67-q39g-r79q
Apr 13, 2023

## Package

npm

 matrix-js-sdk
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 24.1.0

## Patched versions

24.1.0

## Description

### Impact

An attacker present in a room where an [MSC3401](https://github.com/matrix-org/matrix-spec-proposals/pull/3401) group call is taking place can eavesdrop on the video and audio of participants using matrix-js-sdk, without their knowledge. To affected matrix-js-sdk users, the attacker will not appear to be participating in the call.

This attack is possible because matrix-js-sdk's group call implementation accepts incoming direct calls from other users, even if they have not yet declared intent to participate in the group call, as a means of resolving a race condition in call setup. Affected versions do not restrict access to the user's outbound media in this case.

Legacy 1:1 calls are unaffected.

### Patches

This is fixed in matrix-js-sdk 24.1.0.

### Workarounds

Users may hold group calls in private rooms where only the exact users who are expected to participate in the call are present.

### References

None applicable.

### For more information

If you have any questions or comments about this advisory please email us at security at matrix.org.

### Severity

Moderate

5.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N

### CVE ID

CVE-2023-29529

### Weaknesses

[CWE-862](/advisories?query=cwe%3A862)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


