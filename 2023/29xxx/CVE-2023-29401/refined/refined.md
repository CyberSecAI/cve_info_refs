```
{
  "CVE-2023-29401": {
    "Metadata": {
      "CWE": "CWE-494",
      "Date Published": "2023-05-11",
      "Date Modified": "2024-05-20",
      "CVSS Score": "4.3",
       "CVSS Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N"
    },
    "Vulnerability Description": "The filename parameter of the Context.FileAttachment function is not properly sanitized. A maliciously crafted filename can cause the Content-Disposition header to be sent with an unexpected filename value or otherwise modify the Content-Disposition header. For example, a filename of 'setup.bat\";x=.txt' will be sent as a file named 'setup.bat'. If the FileAttachment function is called with names provided by an untrusted source, this may permit an attacker to cause a file to be served with a name different than provided. Maliciously crafted attachment file name can modify the Content-Disposition header." ,
    "Root Cause": "The vulnerability stems from the lack of proper sanitization or encoding of the filename parameter within the `Content-Disposition` header when using the `FileAttachment` function. Specifically, double quotes (`\"`), carriage returns (`\r`), and newlines (`\n`) are not escaped or encoded.",
    "Weaknesses": [
      "Improper handling of filename in the Content-Disposition response header",
        "Lack of sanitization/encoding of special characters in the filename"
    ],
    "Impact": "A malicious actor can manipulate the filename in the `Content-Disposition` header, leading to a Reflect File Download attack. This allows an attacker to potentially serve a file with a different extension than intended by the server (e.g., changing a '.txt' file download to a '.sh' executable), thus deceiving the victim and potentially leading to code execution on the victim's machine.",
    "Attack Vectors": [
      "By crafting a malicious filename containing specific characters such as double quotes, newlines, or carriage returns, an attacker can modify the Content-Disposition header.",
      "The attacker exploits the lack of input sanitization when the filename is set within the  Content-Disposition header."
    ],
    "Required Capabilities": [
       "The attacker needs to control the filename parameter passed to the `FileAttachment` function.",
       "No special privileges are required."
    ],
    "Additional Information": [
        "The fix implemented backslash encoding for the filename, rather than URL encoding, which is an acceptable solution but not mandatory for this case.",
        "The vulnerability can lead to Reflect File Download attacks. ",
        "The vulnerability is present in versions prior to 1.9.1.",
        "The vulnerability is addressed in version 1.9.1 through proper escaping of special characters (double quotes, newline and carriage return).",
      "The patch involves escaping `\"`, `\\r` and `\\n` using backslashes `\\\"`, `\\\\r` and `\\\\n`",
        "The vulnerability is also tracked as GO-2023-1737 in the Go Vulnerability Database."
    ]
  }
}
```