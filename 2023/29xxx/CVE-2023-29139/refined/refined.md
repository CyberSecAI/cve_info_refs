- **Root cause of vulnerability:** The vulnerability was caused by an inefficient database query within the CheckUser extension's API, specifically related to how the `actor` table was being joined when querying the CheckUser log. The code was adding the `actor` table to the table list and join conditions even when not needed, which caused performance issues and potential timeouts when fetching results.
- **Weaknesses/vulnerabilities present:** The primary weakness is a performance issue leading to a potential denial-of-service (DoS) vulnerability. The unnecessary join operation significantly slowed down the query, resulting in request timeouts when retrieving CheckUser log entries.
- **Impact of exploitation:** An attacker could trigger the vulnerability by sending multiple API requests to the CheckUserLog with parameters that would return a non-zero result, causing the server to experience request timeouts. This could potentially affect the availability of the affected wiki and could impact other services running on the same server.
- **Attack vectors:** The attack vector involves making requests to the API CheckUserLog while logged in with `checkuserlog` permission.
- **Required attacker capabilities/position:** The attacker needs to be logged in and have the `checkuserlog` permission. They must be able to make API requests to the affected system.