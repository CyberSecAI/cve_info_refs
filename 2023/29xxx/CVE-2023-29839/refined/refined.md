Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:** The root cause is the lack of proper input sanitization in the Hotel Druid application, specifically when handling user-provided data in the "Surname", "Name", and "Nickname" fields within the "Document" function.

**Weaknesses/Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):** The application fails to sanitize user-supplied input, allowing an attacker to inject malicious JavaScript code into the database. This code is then executed when other users view the affected data.

**Impact of Exploitation:**
- **Arbitrary Command Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code within the context of the victim's browser. This can lead to a range of malicious activities, including:
  - Session hijacking: Stealing session cookies and gaining access to the victim's account.
  - Data theft: Stealing sensitive information displayed on the page.
  - Phishing: Redirecting the victim to malicious websites.
  - Defacement: Altering the content of the website.
  - Malicious redirects: Redirecting the user to a malicious website.

**Attack Vectors:**
- **Vulnerable Fields:** The vulnerable fields are "Surname", "Name", and "Nickname" within the "Document" function of the application.
- **Affected Links:** The vulnerability can be triggered through the `/visualizza_contratto.php` page.
- **Triggering the Payload:** The payload is triggered when a user views the document using the preview function within the "Clients" or "Reservations" tabs. This occurs in the "Example" document preview function.

**Required Attacker Capabilities/Position:**
- **Low Privileged User:** The attacker needs to be able to create or modify client data, such as during room reservation or client registration. A low-privileged user account is sufficient.
- **Ability to Input Payload:** The attacker must be able to input a malicious XSS payload (e.g., `<script>alert(document.domain)</script>`) into the vulnerable fields.
- **Target User Interaction:** The attacker needs a user (potentially themselves) to navigate to the client or reservation page and view the document, triggering the malicious JavaScript code.

**Additional Details:**

- The vulnerability is located in Hotel Druid version 3.0.4.
- The provided steps to reproduce clearly outline how to inject and trigger the XSS payload.
- The content provides a CVSS score of 5.4 (Medium).
- The recommended remediation is to update to Hotel Druid version 3.0.5.