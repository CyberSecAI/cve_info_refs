### CVE-2023-29532
- **Root cause:** The Mozilla Maintenance Service's write-lock mechanism fails when the update file is located on a malicious SMB server. This allows an attacker to replace the update file after signature verification but before its application.
- **Weaknesses/vulnerabilities:** The vulnerability lies in the flawed implementation of the write-lock mechanism when accessing files over SMB. The service reads the file twice (first for signature check, second for actual update) and relies on the file not changing in between, but this assumption is not valid for SMB shares.
- **Impact of exploitation:** A local attacker can achieve privilege escalation by tricking the Mozilla Maintenance Service into applying a malicious, unsigned update file. The attacker can execute arbitrary code with LocalSystem privileges.
- **Attack vectors:**
  - The attacker needs local system access on a Windows machine.
  - The attacker needs to control a SMB server to host the malicious update file.
  - The attacker needs to trick the Mozilla Maintenance Service to use the malicious SMB server to get an update file.
- **Required attacker capabilities/position:** A local user on the target Windows system with SMB enabled. The attacker also needs to be able to set up a malicious SMB server accessible to the target machine.

**Additional details:**

- The vulnerability is specific to Windows systems and does not affect other operating systems.
- The proof-of-concept exploit demonstrates downgrading Firefox to an older version and then executing a reverse shell payload using the manipulated update file.
- The fix involves loading the update file into RAM before the signature check and the actual update, ensuring that the file content does not change between the two operations.