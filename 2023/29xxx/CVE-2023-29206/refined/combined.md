=== Content from github.com_01720222_20250114_231138.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-cmvg-w72j-7phx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-cmvg-w72j-7phx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

# Basic XSS by exploiting JSX or SSX plugins

Critical

[tmortagne](/tmortagne)
published
GHSA-cmvg-w72j-7phx
Apr 12, 2023

## Package

maven

org.xwiki.platform:xwiki-platform-skin-skinx
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

> 3.0-milestone-1

## Patched versions

14.9-rc-1

## Description

### Impact

There was no check in the author of a JavaScript xobject or StyleSheet xobject added in a XWiki document, so until now it was possible for a user having only Edit Right to create such object and to craft a script allowing to perform some operations when executing by a user with appropriate rights.

### Patches

This has been patched in XWiki 14.9-rc-1 by only executing the script if the author of it has Script right.

### Workarounds

The only known workaround consists in applying [the following patch](https://github.com/xwiki/xwiki-platform/commit/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb) and rebuilding and redeploying `xwiki-platform-skin-skinx`.

### References

* <https://jira.xwiki.org/browse/XWIKI-19514>
* <https://jira.xwiki.org/browse/XWIKI-9119>
* <https://jira.xwiki.org/browse/XWIKI-19583>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Jira](http://jira.xwiki.org)
* Email us at Security ML

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H

### CVE ID

CVE-2023-29206

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_44df90f7_20250114_231139.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19583)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19583)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19583](/browse/XWIKI-19583)

# Privilege escalation via style sheet skin extensions with just edit rights

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19583 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Solved By
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [14.9-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.9-rc-1 "14.9-rc-1 ")
* **Affects Version/s:**
  5.0
* **Component/s:**
  [Skin - Skinx](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Skin+-+Skinx%22 "Skin - Skinx ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  Medium
* **Difficulty:**
  Unknown
* **Similar issues:**

#### Description

It is possible with a full CSS style sheet (but not a simple style-attribute) to exfiltrate any attribute value with one request per character with the help of a specially crafted server, see [Better Exfiltration via HTML Injection](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b). A particular technique detailed there using @import-directives allows to execute this attack in a single request by the victim. This can be used to exfiltrate the token used as CSRF protection of the current user. As XWiki allows basically everything with just a get request, the external server that has the CSRF token can then directly deliver  (via a style sheet that is requested later via @import) a specially crafted URL as background image URL that changes, e.g., a user profile to grant more privileges or just saves a page with a groovy script. The attacker just requires edit privileges for creating a style sheet extension that is used on the current page.

This is basically the same as [~~XWIKI-9119~~](https://jira.xwiki.org/browse/XWIKI-9119 "JavaScriptExtension enables any user with edit right to execute any script he wants") just for style sheet extensions and with an attack scenario that is more complex as it requires a special external server that is reachable from the browser of the victim.

To protect against such attacks, we should consider either requiring programming rights (which might be a bit extreme) or at least prevent this attack by disallowing @import-directives unless the user has programming rights. There are also other attack vectors, though, and in particular if the attacker can modify the style sheet extension while the victim with programming rights is accessing them several times while a token is valid (currently as long as XWiki hasn't been restarted) this is not going to prevent anything (see the linked article for details how the attack is executed).

Note that as long as XWIKI-10009 hasn't been fixed and the attacker has script rights, no complex token extraction techniques must be used but the token can be obtained using ${services.csrf.getToken()} and directly used in the URL of a background image.

The affects version is tentative and taken from [~~XWIKI-9119~~](https://jira.xwiki.org/browse/XWIKI-9119 "JavaScriptExtension enables any user with edit right to execute any script he wants"). I haven't actually tried reproducing this in real as setting up the test server would require some time but I do not see why it shouldn't be feasible given that the blog article linked above demonstrated the attack, the token is readily available in an attribute of the top-level HTML element and there is no special filtering of CSS as far as I'm aware.

I'm giving this a medium priority for now as the attack seems far more complex than other issues and I think we should first fix XWIKI-10009 as it seems far more obvious to exploit.

#### Attachments

#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-9119](/browse/XWIKI-9119)
JavaScriptExtension enables any user with edit right to execute any script he wants

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

30/Mar/22 15:25

Updated:

16/Jun/23 17:35

Resolved:

12/Oct/22 14:32

Date of First Response:

10/Oct/22 5:17 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from jira.xwiki.org_5f60a495_20250114_231138.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19514)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19514)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19514](/browse/XWIKI-19514)

# XSS using a JSX object

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19514 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Duplicate
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  None
* **Affects Version/s:**
  13.10.3
* **Component/s:**
  [Skin - Skinx](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Skin+-+Skinx%22 "Skin - Skinx ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [bugfixingday](/issues/?jql=labels+%3D+bugfixingday "bugfixingday")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  High
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

It's possible to perform a XSS in JSX "on demand" or "on this document" which don't requires PR, just by creating a new JSX with edit right, and waiting for a PR user to execute it when accessing the page.

By doing so, we can request a PR user to create a page, or modify it, using any REST (or HTTP) request on the targeted wiki.

Basically it allows privilege escalation.

#### Attachments

#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-9119](/browse/XWIKI-9119)
JavaScriptExtension enables any user with edit right to execute any script he wants

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XRENDERING-663](/browse/XRENDERING-663)
XSS Javascript injection via XWiki 2.x syntax

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-9118](/browse/XWIKI-9118)
XSS in restricted context via html macro

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18049](/browse/XWIKI-18049)
Improve the html escaping mechanism for XSS protection

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19421](/browse/XWIKI-19421)
JSX XObjects with Use this extension=On this wiki requires PR rights

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

10/Mar/22 15:21

Updated:

12/Apr/23 13:50

Resolved:

10/Mar/22 16:20

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from github.com_0c5bc9f6_20250114_231137.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Ffe65bc35d5672dd2505b7ac4ec42aec57d500fbb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Ffe65bc35d5672dd2505b7ac4ec42aec57d500fbb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-9119: Refactoring of SkinExtensionPlugin

[Browse files](/xwiki/xwiki-platform/tree/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb)
Browse the repository at this point in the history

```
  * Provide some tests
```

* Loading branch information

[![@surli](https://avatars.githubusercontent.com/u/1478232?s=40&v=4)](/surli)

[surli](/xwiki/xwiki-platform/commits?author=surli "View all commits by surli")
committed
Oct 12, 2022

1 parent
[4fac9f2](/xwiki/xwiki-platform/commit/4fac9f2357dc9e9bad5c7e651f9608b908c737ad)

commit fe65bc3

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**553 additions**
and
**37 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx

  + xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/pom.xml
    [pom.xml](#diff-3d538814cffd68b9ab8adf94b95c604beb7ea000d21aaa9b7c4835f05aaba951)
  + src

    - main/java/com/xpn/xwiki/plugin/skinx

      * xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractDocumentSkinExtensionPlugin.java
        [AbstractDocumentSkinExtensionPlugin.java](#diff-f3a95d72c251026f65bfc6f479c5896c2cb15cbab0ca2be4772a90ff2c2a67d7)
      * xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractSkinExtensionPlugin.java
        [AbstractSkinExtensionPlugin.java](#diff-47002e7b67816f27333e3564e38344ff3ac0adb1a84ee14e4e0d4b006e0d82c0)
    - test/java/com/xpn/xwiki/plugin/skinx

      * xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/test/java/com/xpn/xwiki/plugin/skinx/CssSkinExtensionPluginTest.java
        [CssSkinExtensionPluginTest.java](#diff-8f16fb50147e75efdcc136da58a9196fde743e46a3360d357809739e1d6c111e)
      * xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/test/java/com/xpn/xwiki/plugin/skinx/JsSkinExtensionPluginTest.java
        [JsSkinExtensionPluginTest.java](#diff-8b9490634a64e36ae33b38d4767457f9f66cf07714a4efc85f7b959d2c22cfde)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/pom.xml](#diff-3d538814cffd68b9ab8adf94b95c604beb7ea000d21aaa9b7c4835f05aaba951 "xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/pom.xml")

Show comments

[View file](/xwiki/xwiki-platform/blob/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,7 +31,7 @@ |
|  |  | <name>XWiki Platform - Skin - Skin Extensions</name> |
|  |  | <description>XWiki Platform - Skin - Skin Extensions</description> |
|  |  | <properties> |
|  |  | <xwiki.jacoco.instructionRatio>0.18</xwiki.jacoco.instructionRatio> |
|  |  | <xwiki.jacoco.instructionRatio>0.25</xwiki.jacoco.instructionRatio> |
|  |  | </properties> |
|  |  | <dependencies> |
|  |  | <!-- Build tools --> |
| Expand Down | |  |

105 changes: 82 additions & 23 deletions

105
[...n-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractDocumentSkinExtensionPlugin.java](#diff-f3a95d72c251026f65bfc6f479c5896c2cb15cbab0ca2be4772a90ff2c2a67d7 "xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractDocumentSkinExtensionPlugin.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractDocumentSkinExtensionPlugin.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,7 @@ |
|  |  | import java.util.Set; |
|  |  |  |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.apache.commons.lang3.exception.ExceptionUtils; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  | import org.xwiki.bridge.event.DocumentCreatedEvent; |
| Expand All | | @@ -37,6 +38,7 @@ |
|  |  | import org.xwiki.bridge.event.WikiDeletedEvent; |
|  |  | import org.xwiki.model.EntityType; |
|  |  | import org.xwiki.model.reference.DocumentReference; |
|  |  | import org.xwiki.model.reference.DocumentReferenceResolver; |
|  |  | import org.xwiki.model.reference.EntityReferenceResolver; |
|  |  | import org.xwiki.model.reference.EntityReferenceSerializer; |
|  |  | import org.xwiki.observation.EventListener; |
| Expand Down  Expand Up | | @@ -85,6 +87,10 @@ public abstract class AbstractDocumentSkinExtensionPlugin extends AbstractSkinEx |
|  |  | \*/ |
|  |  | private final List<Event> events = new ArrayList<>(3); |
|  |  |  |
|  |  | private AuthorizationManager authorizationManager; |
|  |  | private DocumentReferenceResolver<String> stringDocumentReferenceResolver; |
|  |  | private EntityReferenceResolver<String> currentEntityReferenceResolver; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* XWiki plugin constructor. |
|  |  | \* |
| Expand Down  Expand Up | | @@ -174,7 +180,7 @@ public void virtualInit(XWikiContext context) |
|  |  | @Override |
|  |  | public Set<String> getAlwaysUsedExtensions(XWikiContext context) |
|  |  | { |
|  |  | EntityReferenceSerializer<String> serializer = Utils.getComponent(EntityReferenceSerializer.TYPE\_STRING); |
|  |  | EntityReferenceSerializer<String> serializer = getDefaultEntityReferenceSerializer(); |
|  |  | Set<DocumentReference> references = getAlwaysUsedExtensions(); |
|  |  | Set<String> names = new HashSet<>(references.size()); |
|  |  | for (DocumentReference reference : references) { |
| Expand Down  Expand Up | | @@ -214,7 +220,7 @@ public Set<DocumentReference> getAlwaysUsedExtensions() |
|  |  | XWikiDocument doc = context.getWiki().getDocument(extension, context); |
|  |  | // Only add the extension as being "always used" if the page holding it has been saved with |
|  |  | // programming rights. |
|  |  | if (Utils.getComponent(AuthorizationManager.class).hasAccess(Right.PROGRAM, |
|  |  | if (getAuthorizationManager().hasAccess(Right.PROGRAM, |
|  |  | doc.getAuthorReference(), doc.getDocumentReference())) { |
|  |  | extensions.add(extension); |
|  |  | } |
| Expand All | | @@ -236,36 +242,83 @@ public Set<DocumentReference> getAlwaysUsedExtensions() |
|  |  | public boolean hasPageExtensions(XWikiContext context) |
|  |  | { |
|  |  | XWikiDocument doc = context.getDoc(); |
|  |  | if (doc != null) { |
|  |  | List<BaseObject> objects = doc.getObjects(getExtensionClassName()); |
|  |  | if (objects != null) { |
|  |  | for (BaseObject obj : objects) { |
|  |  | if (obj == null) { |
|  |  | continue; |
|  |  | } |
|  |  | if (obj.getStringValue(USE\_FIELDNAME).equals("currentPage")) { |
|  |  | return true; |
|  |  | } |
|  |  | boolean result = false; |
|  |  | if (doc != null && this.hasCurrentPageExtensionObjects(doc)) { |
|  |  | if (getAuthorizationManager().hasAccess(Right.SCRIPT, doc.getAuthorReference(), |
|  |  | doc.getDocumentReference())) { |
|  |  | result = true; |
|  |  | } else { |
|  |  | displayScriptRightLog(doc.getDocumentReference()); |
|  |  | } |
|  |  | } |
|  |  | return result; |
|  |  | } |
|  |  |  |
|  |  | private void displayScriptRightLog(Object documentReference) |
|  |  | { |
|  |  | LOGGER.warn("Extensions present in [{}] ignored because of lack of script right from the author.", |
|  |  | documentReference); |
|  |  | } |
|  |  |  |
|  |  | private boolean hasCurrentPageExtensionObjects(XWikiDocument doc) |
|  |  | { |
|  |  | List<BaseObject> objects = doc.getObjects(getExtensionClassName()); |
|  |  | if (objects != null) { |
|  |  | for (BaseObject obj : objects) { |
|  |  | if (obj == null) { |
|  |  | continue; |
|  |  | } |
|  |  | if (StringUtils.equals(obj.getStringValue(USE\_FIELDNAME), "currentPage")) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void use(String resource, XWikiContext context) |
|  |  | public void use(String resource, Map<String, Object> parameters, XWikiContext context) |
|  |  | { |
|  |  | String canonicalResource = getCanonicalDocumentName(resource); |
|  |  |  |
|  |  | super.use(canonicalResource, context); |
|  |  | if (this.canResourceBeUsed(canonicalResource, context)) { |
|  |  | super.use(canonicalResource, parameters, context); |
|  |  | } else { |
|  |  | displayScriptRightLog(canonicalResource); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void use(String resource, Map<String, Object> parameters, XWikiContext context) |
|  |  | private DocumentReferenceResolver<String> getDocumentReferenceResolver() |
|  |  | { |
|  |  | String canonicalResource = getCanonicalDocumentName(resource); |
|  |  | if (this.stringDocumentReferenceResolver == null) { |
|  |  | this.stringDocumentReferenceResolver = Utils.getComponent(DocumentReferenceResolver.TYPE\_STRING); |
|  |  | } |
|  |  | return this.stringDocumentReferenceResolver; |
|  |  | } |
|  |  |  |
|  |  | super.use(canonicalResource, parameters, context); |
|  |  | private AuthorizationManager getAuthorizationManager() |
|  |  | { |
|  |  | if (this.authorizationManager == null) { |
|  |  | this.authorizationManager = Utils.getComponent(AuthorizationManager.class); |
|  |  | } |
|  |  | return this.authorizationManager; |
|  |  | } |
|  |  |  |
|  |  | private boolean canResourceBeUsed(String resource, XWikiContext context) |
|  |  | { |
|  |  | DocumentReferenceResolver<String> documentReferenceResolver = getDocumentReferenceResolver(); |
|  |  | DocumentReference documentReference = documentReferenceResolver.resolve(resource); |
|  |  |  |
|  |  | try { |
|  |  | XWikiDocument document = context.getWiki().getDocument(documentReference, context); |
|  |  | DocumentReference authorReference = document.getAuthorReference(); |
|  |  | return getAuthorizationManager().hasAccess(Right.SCRIPT, authorReference, documentReference); |
|  |  | } catch (XWikiException e) { |
|  |  | LOGGER.error("Error while loading [{}] for checking script right: [{}]", documentReference, |
|  |  | ExceptionUtils.getRootCauseMessage(e)); |
|  |  | LOGGER.debug("Original error stack trace: ", e); |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -332,7 +385,7 @@ private void onDocumentEvent(XWikiDocument document) |
|  |  | if (document.getObject(getExtensionClassName()) != null) { |
|  |  | // new or already existing object |
|  |  | if (document.getObject(getExtensionClassName(), USE\_FIELDNAME, "always", false) != null) { |
|  |  | if (Utils.getComponent(AuthorizationManager.class).hasAccess(Right.PROGRAM, |
|  |  | if (getAuthorizationManager().hasAccess(Right.PROGRAM, |
|  |  | document.getAuthorReference(), document.getDocumentReference())) { |
|  |  | getAlwaysUsedExtensions().add(document.getDocumentReference()); |
|  |  |  |
| Expand All | | @@ -355,6 +408,14 @@ private void onDocumentEvent(XWikiDocument document) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private EntityReferenceResolver<String> getCurrentEntityReferenceResolver() |
|  |  | { |
|  |  | if (this.currentEntityReferenceResolver == null) { |
|  |  | this.currentEntityReferenceResolver = Utils.getComponent(EntityReferenceResolver.TYPE\_STRING, "current"); |
|  |  | } |
|  |  | return this.currentEntityReferenceResolver; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get the canonical serialization of a document name, in the {@code wiki:Space.Document} format. |
|  |  | \* |
| Expand All | | @@ -363,10 +424,8 @@ private void onDocumentEvent(XWikiDocument document) |
|  |  | \*/ |
|  |  | private String getCanonicalDocumentName(String documentName) |
|  |  | { |
|  |  | @SuppressWarnings("unchecked") |
|  |  | EntityReferenceResolver<String> resolver = Utils.getComponent(EntityReferenceResolver.TYPE\_STRING, "current"); |
|  |  | @SuppressWarnings("unchecked") |
|  |  | EntityReferenceSerializer<String> serializer = Utils.getComponent(EntityReferenceSerializer.TYPE\_STRING); |
|  |  | EntityReferenceResolver<String> resolver = getCurrentEntityReferenceResolver(); |
|  |  | EntityReferenceSerializer<String> serializer = getDefaultEntityReferenceSerializer(); |
|  |  | return serializer.serialize(resolver.resolve(documentName, EntityType.DOCUMENT)); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

19 changes: 9 additions & 10 deletions

19
[...form-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractSkinExtensionPlugin.java](#diff-47002e7b67816f27333e3564e38344ff3ac0adb1a84ee14e4e0d4b006e0d82c0 "xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractSkinExtensionPlugin.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractSkinExtensionPlugin.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -229,14 +229,7 @@ private void useResource(String resource, XWikiContext context) |
|  |  | \*/ |
|  |  | public void use(String resource, XWikiContext context) |
|  |  | { |
|  |  | useResource(resource, context); |
|  |  |  |
|  |  | // In case a previous call added some parameters, remove them, since the last call for a resource always |
|  |  | // discards previous ones. |
|  |  | getParametersMap(context).remove(resource); |
|  |  |  |
|  |  | // Register the use of the resource in case the current execution is an asynchronous renderer |
|  |  | getSkinExtensionAsync().use(getName(), resource, null); |
|  |  | use(resource, null, context); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -256,8 +249,14 @@ public void use(String resource, Map<String, Object> parameters, XWikiContext co |
|  |  | { |
|  |  | useResource(resource, context); |
|  |  |  |
|  |  | // Associate parameters to the resource |
|  |  | getParametersMap(context).put(resource, parameters); |
|  |  | // In case a previous call added some parameters, remove them, since the last call for a resource always |
|  |  | // discards previous ones. |
|  |  | if (parameters == null) { |
|  |  | getParametersMap(context).remove(resource); |
|  |  | } else { |
|  |  | // Associate parameters to the resource |
|  |  | getParametersMap(context).put(resource, parameters); |
|  |  | } |
|  |  |  |
|  |  | getSkinExtensionAsync().use(getName(), resource, parameters); |
|  |  | } |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fe65bc3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Ffe65bc35d5672dd2505b7ac4ec42aec57d500fbb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_088ad366_20250114_231139.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-9119)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-9119)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-9119](/browse/XWIKI-9119)

# JavaScriptExtension enables any user with edit right to execute any script he wants

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-9119 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.9-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.9-rc-1 "14.9-rc-1 ")
* **Affects Version/s:**
  3.0 M1
* **Component/s:**
  [Skin - Skinx](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Skin+-+Skinx%22 "Skin - Skinx ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Development Priority:**
  High
* **Difficulty:**
  Hard
* **Documentation:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cmvg-w72j-7phx>
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

To my mind such a feature should be restricted to users with PR since such scripts can be dangerous.

#### Attachments

#### Issue Links

depends on

![New Feature - A new feature of the product, which has yet to be developed.](/secure/viewavatar?size=xsmall&avatarId=13511&avatarType=issuetype "New Feature - A new feature of the product, which has yet to be developed.")
[XWIKI-9282](/browse/XWIKI-9282)
Add a way to restrict access to some classes

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Open

is duplicated by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19514](/browse/XWIKI-19514)
XSS using a JSX object

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19583](/browse/XWIKI-19583)
Privilege escalation via style sheet skin extensions with just edit rights

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![thomas_delafosse](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Thomas Delafosse

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

#### Dates

Created:

07/May/13 17:13

Updated:

12/Jul/23 09:27

Resolved:

12/Oct/22 14:31

Date of First Response:

11/Mar/22 10:46 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


