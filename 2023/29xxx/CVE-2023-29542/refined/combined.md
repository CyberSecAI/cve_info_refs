=== Content from www.mozilla.org_8ef4d24a_20250115_200903.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-13

## Security Vulnerabilities fixed in Firefox 112, Firefox for Android 112, Focus for Android 112

Announced
April 11, 2023
Impact
high
Products
Firefox, Firefox for Android, Focus for Android
Fixed in

* Firefox 112
* Firefox for Android 112
* Focus for Android 112

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-29534: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2023-29534)

Reporter
Shaheen Fazim and Hafiizh
Impact
high
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox and Focus for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox and Focus for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1816059](https://bugzilla.mozilla.org/show_bug.cgi?id=1816059)
* [Bug 1816007](https://bugzilla.mozilla.org/show_bug.cgi?id=1816007)
* [Bug 1821155](https://bugzilla.mozilla.org/show_bug.cgi?id=1821155)
* [Bug 1821576](https://bugzilla.mozilla.org/show_bug.cgi?id=1821576)
* [Bug 1821906](https://bugzilla.mozilla.org/show_bug.cgi?id=1821906)
* [Bug 1822298](https://bugzilla.mozilla.org/show_bug.cgi?id=1822298)
* [Bug 1822305](https://bugzilla.mozilla.org/show_bug.cgi?id=1822305)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29537: Data Races in font initialization code](#CVE-2023-29537)

Reporter
Looben Yang
Impact
high
##### Description

Multiple race conditions in the font initialization could have led to memory corruption and execution of attacker-controlled code.

##### References

* [Bug 1823365](https://bugzilla.mozilla.org/show_bug.cgi?id=1823365)
* [Bug 1824200](https://bugzilla.mozilla.org/show_bug.cgi?id=1824200)
* [Bug 1825569](https://bugzilla.mozilla.org/show_bug.cgi?id=1825569)

#### [#CVE-2023-29538: Directory information could have been leaked to WebExtensions](#CVE-2023-29538)

Reporter
Alexis aka zoracon
Impact
moderate
##### Description

Under specific circumstances a WebExtension may have received a `jar:file:///` URI instead of a `moz-extension:///` URI during a load request. This leaked directory paths on the user's machine.

##### References

* [Bug 1685403](https://bugzilla.mozilla.org/show_bug.cgi?id=1685403)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29540: Iframe sandbox bypass using redirects and sourceMappingUrls](#CVE-2023-29540)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Using a redirect embedded into `sourceMappingUrls` could allow for navigation to external protocol links in sandboxed iframes without `allow-top-navigation-to-custom-protocols`.

##### References

* [Bug 1790542](https://bugzilla.mozilla.org/show_bug.cgi?id=1790542)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29543: Use-after-free in debugging APIs](#CVE-2023-29543)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

An attacker could have caused memory corruption and a potentially exploitable use-after-free of a pointer in a global object's debugger vector.

##### References

* [Bug 1816158](https://bugzilla.mozilla.org/show_bug.cgi?id=1816158)

#### [#CVE-2023-29544: Memory Corruption in garbage collector](#CVE-2023-29544)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If multiple instances of resource exhaustion occurred at the incorrect time, the garbage collector could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1818781](https://bugzilla.mozilla.org/show_bug.cgi?id=1818781)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-29546: Screen recording in Private Browsing included address bar on Android](#CVE-2023-29546)

Reporter
Irwan
Impact
low
##### Description

When recording the screen while in Private Browsing on Firefox for Android the address bar and keyboard were not hidden, potentially leaking sensitive information.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1780842](https://bugzilla.mozilla.org/show_bug.cgi?id=1780842)

#### [#CVE-2023-29547: Secure document cookie could be spoofed with insecure cookie](#CVE-2023-29547)

Reporter
Marco Squarcina
Impact
low
##### Description

When a secure cookie existed in the Firefox cookie jar an insecure cookie for the same domain could have been created, when it should have silently failed. This could have led to a desynchronization in expected results when reading from the secure cookie.

##### References

* [Bug 1783536](https://bugzilla.mozilla.org/show_bug.cgi?id=1783536)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29549: Javascript's bind function may have failed](#CVE-2023-29549)

Reporter
Lukas Bernhard
Impact
low
##### Description

Under certain circumstances, a call to the `bind` function may have resulted in the incorrect realm. This may have created a vulnerability relating to JavaScript-implemented sandboxes such as SES.

##### References

* [Bug 1823042](https://bugzilla.mozilla.org/show_bug.cgi?id=1823042)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1812498%2C1814217%2C1818357%2C1751945%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

#### [#CVE-2023-29551: Memory safety bugs fixed in Firefox 112](#CVE-2023-29551)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763625%2C1814314%2C1815798%2C1815890%2C1819239%2C1819465%2C1819486%2C1819492%2C1819957%2C1820514%2C1820776%2C1821838%2C1822175%2C1823547)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_47e07052_20250114_224120.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1810793)
* [XML](/show_bug.cgi?ctype=xml&id=1810793)

Closed
[Bug 1810793](/show_bug.cgi?id=1810793)

Opened 2 years ago
Closed 2 years ago

# FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues

## Categories

### (Firefox :: File Handling, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox110 |  | wontfix |
| firefox111 |  | wontfix |
| firefox112 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ameenbasha111, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/90e8173161a73c012cc62b9f3cdeede4?d=mm&size=40)  [ameenbasha111](/user_profile?user_id=719704)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

### (Regressed 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29542](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1810793&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1810793)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1827115](/show_bug.cgi?id=1827115 "NEW - browser.downloads.download will not save a .url file")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1814701](/show_bug.cgi?id=1814701 "RESOLVED DUPLICATE - Possible to download dangerous files .url/.scf/.lnk/.local using WebExtensions")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

[1819643](/show_bug.cgi?id=1819643 "NEW - downloads.download should report accurate error for clearly invalid filenames")

## Details

### (Keywords: reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main112+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main112+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4242769_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [manifest.json](/attachment.cgi?id=9312642)  [2 years ago](#c0)  [Ameen](/user_profile?user_id=719704)   436 bytes, application/json |  | [Details](/attachment.cgi?id=9312642&action=edit) |
| --- | --- | --- |
| [background.js](/attachment.cgi?id=9312643)  [2 years ago](#c1)  [Ameen](/user_profile?user_id=719704)   1.12 KB, text/javascript |  | [Details](/attachment.cgi?id=9312643&action=edit) |
| [Firefox Extension API Exploit.mp4](/attachment.cgi?id=9312674)  [2 years ago](#c4)  [Ameen](/user_profile?user_id=719704)   3.66 MB, video/mp4 |  | [Details](/attachment.cgi?id=9312674&action=edit) |
| [TestExtension.zip](/attachment.cgi?id=9312675)  [2 years ago](#c5)  [Ameen](/user_profile?user_id=719704)   2.05 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9312675&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327441)  [2 years ago](#c46)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   368 bytes, text/plain |  | [Details](/attachment.cgi?id=9327441&action=edit) |
| [advisory.txt](/attachment.cgi?id=9327576)  [2 years ago](#c47)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   11 bytes, text/plain |  | [Details](/attachment.cgi?id=9327576&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1810793#c0)• 2 years ago |
|  | |

Attached file
[manifest.json](attachment.cgi?id=9312642)
— [Details](attachment.cgi?id=9312642&action=edit)

Chromium Bug Reference: <https://bugs.chromium.org/p/chromium/issues/detail?id=1307930>

HI team i have already reported the same in another Place. Now i have found a alternate way to achieve the Same. Kindly have a look in to my below issue for POC Video.

Ref: <https://bugzilla.mozilla.org/show_bug.cgi?id=1809923>

While visiting a webpage if the download initiate for .lnk/ .local these file types are changed to .download by firefox. But i have found a way to download .lnk/.local/.url Files while lead to Arbitrary File Read etc.( based on file extension)

We can use browser.downloads.download API to download the .lnk/.local/.url file without changing it to .download

FIREFOX VERSION : 108.0.2 (64-bit)

REPRODUCTION CASE:

1. Add the Manifest File to the Extension in about:debugging#/runtime/this-firefox (keep backgroud.js file in same extension folder)
2. Once added Click on the extension
3. You can find the safe.url file is downloaded without renaming

Note: As stated in my previous issue the downloaded .url file can be used to achieve Arbitrary File Read

Same is possible for .lnk and .local too. tested

Flags: sec-bounty?

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1810793#c1)• 2 years ago |
|  | |

Attached file
[background.js](attachment.cgi?id=9312643)
— [Details](attachment.cgi?id=9312643&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1810793#c2)• 2 years ago |
|  | |

The example background script uses `.url`, can you provide one that uses `.lnk` that you say also reproduces the issue?

Component: Security → GeneralFlags: needinfo?(ameenbasha111)Product: Firefox → WebExtensionsSee Also: → [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1810793#c3)• 2 years ago |
|  | |

Kindly change the filenamed as safe.url in background.js to safe.lnk you can find safe.lnk file is downloaded.

Hope this is what you expected. Kindly respond if any further

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1810793#c4)• 2 years ago |
|  | |

Attached video
[Firefox Extension API Exploit.mp4](attachment.cgi?id=9312674)
— [Details](attachment.cgi?id=9312674&action=edit)

POC Video Attached

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1810793#c5)• 2 years ago |
|  | |

Attached file
[TestExtension.zip](attachment.cgi?id=9312675)
— [Details](attachment.cgi?id=9312675&action=edit)

I have Zipped the extension folder which i used in POC Video for Downloading .lnk file

POC Steps:

1. Host the Actual Shortcut file anywhere. i used my own python server. i have attached the same for your reference

Run the Server by running below command in CMD:

python server.py

2. Note down the URL in which the Server is UP:

   eg: 192.168.0.103:5000 (or) you can use 127.0.0.1:5000
3. Replace the Server IP in Background.js download Method.
4. add the extension. Click the extension.
5. You can find the .lnk file is downloaded and the notepad is opened

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1810793#c6)• 2 years ago |
|  | |

Query: why the component is changed to General?

Im new to this firefox bug bounty, i usually hunt on hackerone. here how can i find my issue is triaged and eligible for bounty. What are the process.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1810793#c7)• 2 years ago |
|  | |

(In reply to Ameen from [comment #6](/show_bug.cgi?id=1810793#c6 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> Query: why the component is changed to General?

WebExtensions:General means, that it is supposed to be fixed by the WebExtensions team

> Im new to this firefox bug bounty, i usually hunt on hackerone. here how can i find my issue is triaged and eligible for bounty. What are the process.

The bounty team usually look at bugs once they have been completely fixed, in order to make sure that we're assessing the security implications correctly. Our decision will be reflected in the `sec-bounty?` flag in this bug. `sec-bounty+` means bounty awarded, `sec-bounty-` means not awarded. If someone is being awarded a bounty, they will get an email in the coming days.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1810793#c8)• 2 years ago |
|  | |

Thanks for the update.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1810793#c9)• 2 years ago |
|  | |

If you have given the extension permission to download files, is it really a problem that it has downloaded files? If the extension is malicious it will do bad things, and extensions are allowed to do more than a web site which is why users have to agree to give them more permissions. I'm not sure what the Web Extension community expects to happen here.

Is the Extension download API not adding the Mark of the Web? It should, right?

Is the Extension API supposed to do anything different than regular download code? That is, if we fix the earlier bug in shared code, does this one automatically get fixed? At least with respect to .lnk/.local apparently not because the behavior is different -- maybe not using shared code is part of the problem?

Flags: needinfo?(rob)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1810793#c10)• 2 years ago |
|  | |

For now calling it `sec-low` because it seems less bad than [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"): the effects are more or less the same, but you have to first be convinced to install an extension and grant extra privileges.

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1810793#c11)• 2 years ago |
|  | |

> If you have given the extension permission to download files, is it really a problem that it has downloaded files? If the extension is malicious it will do bad things, and extensions are allowed to do more than a web site which is why users have to agree to give them more permissions. I'm not sure what the Web Extension community expects to happen here.

Have already tested the same in chromium Extension API and it is already fixed. So the same should be handled here too.

Just fyi the dangerous extension download should be prevent by any sort of way. the ultimate goal is to make sure the browser doesn't allow to download these extensions. alternatively it should be renamed to .download

I thought of sharing this info(chromium similar issue handled) could help you guys in some way.

Thanks

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1810793#c12)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #9](/show_bug.cgi?id=1810793#c9 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> If you have given the extension permission to download files, is it really a problem that it has downloaded files? If the extension is malicious it will do bad things, and extensions are allowed to do more than a web site which is why users have to agree to give them more permissions. I'm not sure what the Web Extension community expects to happen here.

Downloading itself is not an issue. If there is dangerous behavior, there should be a prompt before opening it, e.g. via MOTW on Windows. There is even an API to launch downloaded files (`browser.downloads.open()`) that requires the user to consent via an extension permission, and further user interaction to permit the API call.

> Is the Extension download API not adding the Mark of the Web? It should, right?

Last time I checked, it should, as elaborated at <https://bugzilla.mozilla.org/show_bug.cgi?id=1654819#c4>

If the MOTM is missing, then we have to investigate that.

> Is the Extension API supposed to do anything different than regular download code? That is, if we fix the earlier bug in shared code, does this one automatically get fixed? At least with respect to .lnk/.local apparently not because the behavior is different -- maybe not using shared code is part of the problem?

Firefox desktop's download implementation is shared with regular downloads. The filepicker initialization is extension-specific ([see nsIFilePicker instantiation in ext-downloads.js](https://searchfox.org/mozilla-central/rev/daf613efc5c358f3a94961d73b90472c00703838/toolkit/components/extensions/parent/ext-downloads.js#930-958)). This is a Save-as file picker, not an Open-file picker, so that difference in implementation is not significant, as the "exploit" requires the user to select the previously downloaded file in an Open-file picker..

In both this and [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), there is no "arbitrary file read" until the user is tricked into selecting the downloaded file with a second file picker..

Flags: needinfo?(rob)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1810793#c13)• 2 years ago |
|  | |

(In reply to Rob Wu [:robwu] from [comment #12](/show_bug.cgi?id=1810793#c12 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> Firefox desktop's download implementation is shared with regular downloads. The filepicker initialization is extension-specific ([see nsIFilePicker instantiation in ext-downloads.js](https://searchfox.org/mozilla-central/rev/daf613efc5c358f3a94961d73b90472c00703838/toolkit/components/extensions/parent/ext-downloads.js#930-958)). This is a Save-as file picker, not an Open-file picker, so that difference in implementation is not significant, as the "exploit" requires the user to select the previously downloaded file in an Open-file picker..
>
> In both this and [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), there is no "arbitrary file read" until the user is tricked into selecting the downloaded file with a second file picker..

OK. So it sounds like in this bug we should change the webextensions code that opens the save-as filepicker to apply the same filename sanitization that the "normal" downloads code does and picks a `.download` filename by default. Right?

Flags: needinfo?(rob)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1810793#c14)• 2 years ago |
|  | |

Hi Guys(Rob Wu). Can you have a look into this.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1810793#c15)• 2 years ago |
|  | |

Team. The impact was much more. that is without user interaction we can get their NTLM hash.

See the below comment for More details.

<https://bugzilla.mozilla.org/show_bug.cgi?id=1809923#c17>

Kindly Initiate the quick fix on this case.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1810793#c16)• 2 years ago |
|  | |

Since the impact is Same to issue 1809923. i have shared its comments no 17.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1810793#c17)• 2 years ago |
|  | |

(In reply to Ameen from [comment #15](/show_bug.cgi?id=1810793#c15 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> Team. The impact was much more. that is without user interaction

Without user interaction you can't install an extension.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1810793#c18)• 2 years ago |
|  | |

Hi Gijs, Yes for installing Extension we need the user interaction. The thing which i was try to convey is. After downloading the .url file there is no interaction needed it will leak the ntlm hash without interaction.

i.e: install the extension(user interaction needed) -> now when extension executes it leaks the ntlm hash.

Hope this clears. Sorry for the confusions if any.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1810793#c19)• 2 years ago |
|  | |

hey guys, is the fix started for this issue?

Since there is no update on this issue regarding fix / any progress so just asked for an update.

Also to keep this in track and deploy a quicker fix can we have the severity and priority sets for this issue.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a1384999_159069)• 2 years ago |

Duplicate of this bug: [1814701](/show_bug.cgi?id=1814701 "RESOLVED DUPLICATE - Possible to download dangerous files .url/.scf/.lnk/.local using WebExtensions")

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1810793#c21)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #13](/show_bug.cgi?id=1810793#c13 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> (In reply to Rob Wu [:robwu] from [comment #12](/show_bug.cgi?id=1810793#c12 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))
>
> > Firefox desktop's download implementation is shared with regular downloads. The filepicker initialization is extension-specific ([see nsIFilePicker instantiation in ext-downloads.js](https://searchfox.org/mozilla-central/rev/daf613efc5c358f3a94961d73b90472c00703838/toolkit/components/extensions/parent/ext-downloads.js#930-958)). This is a Save-as file picker, not an Open-file picker, so that difference in implementation is not significant, as the "exploit" requires the user to select the previously downloaded file in an Open-file picker..
> >
> > In both this and [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), there is no "arbitrary file read" until the user is tricked into selecting the downloaded file with a second file picker..
>
> OK. So it sounds like in this bug we should change the webextensions code that opens the save-as filepicker to apply the same filename sanitization that the "normal" downloads code does and picks a `.download` filename by default. Right?

The Save-as file picker is not relevant. The `downloads` API can be used to download to a file name of choice (within the Downloads directory), without further user interaction other than having the extension installed. They can do so by setting `saveAs: false` to skip the Save-as dialog.

The bug report here is overstating the issue: it claims arbitrary file read, which is not the case. What it shows is that an extension can download an arbitrary resource and then the user can open it with user interaction. I would rate that bug as invalid. Downloading arbitrary URLs is an explicit feature of the download API.

[Bug 1814701](/show_bug.cgi?id=1814701 "RESOLVED DUPLICATE - Possible to download dangerous files .url/.scf/.lnk/.local using WebExtensions") would be closer to a valid bug report. I'm going to change the duplicate order, since the other bug is more actionable than this one.

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a1387684_447061)• 2 years ago |

No longer duplicate of this bug: [1814701](/show_bug.cgi?id=1814701 "RESOLVED DUPLICATE - Possible to download dangerous files .url/.scf/.lnk/.local using WebExtensions")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1810793#c22)• 2 years ago |
|  | |

@Rob Wu i dont understand why it is considered as invalid bug and the other one is closer to valid one.

In this case i have shown that we can download .url/.lnk/.local files too. which is usually a dangerous files in windows

And also for a impact

1. With user interaction we can read files
2. Without user interaction just by downloading the url/.lnk file it leaks the user NTLM hash. (regarding this you can check my another report which shows this impact too)

There is some misunderstanding at your end. Have a look into this issue.

I have provided the necessary information for the issue from the beginning.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1810793#c23)• 2 years ago |
|  | |

Also fyi: the .lnk / .local are already fixed in chrome.downloads.download too.

I have Raised a separate ticket to Chrome to handle the .url too.

But in this case all 3 are acceptable

Friendly reminder to Re-Check my issue and assign it to the respective person for a fix

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a1458276_719704)• 2 years ago |

Summary: FireFox Extension API : .url extension Download leads to Arbitrary File Read → FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1810793#c24)• 2 years ago |
|  | |

I'm going to mark the other bug as a duplicate of this. Given the similarities, I previously thought that you were the author of the other bug, but that was not the case. To keep the discussion in one bug, here is my comment that I posted in the other bug. I'll discuss this bug with my team.

The ability to choose a file name is a feature. Extensions can currently download to an arbitrary file name or directory within the (user-configured) Downloads.

Being stricter on the file names or even changing their extension may not be backwards-compatible, but if there is a good reason to, we could consider that.

For comparison, I checked Chrome's behavior.

In the far past (e.g. Chrome 40), it prompted about dangerous files, to either keep or discard it (without creating the file in the destination).

These days, Chrome appears to change the file extension. E.g. if `foo.sh` is passed, `foo.txt` is created instead.

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a1465657_447061)• 2 years ago |

Duplicate of this bug: [1814701](/show_bug.cgi?id=1814701 "RESOLVED DUPLICATE - Possible to download dangerous files .url/.scf/.lnk/.local using WebExtensions")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1810793#c26)• 2 years ago |
|  | |

Hi Rob Wu.

> but if there is a good reason to, we could consider that.

The extensions which are all considered as dangerous should be blocked in all possible ways.

In this case Firefox also blocked / append the .download to .lnk/.url/.local extensions in general downloads.

Meantime chrome downloads api also don't allow to download those extensions. it will change them to .download (this is because the extension are having some special functionality which can be trick/ change the execution path)

Since firefox already restricts the normal download the same should be handled here too to avoid the same impact.

Also just fyi: .url / .lnk file leaks the user NTLM hash just by downloading without any clicks

Thanks

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1810793#c27)• 2 years ago |
|  | |

Guys its been 20 days since i raised this issue, Can we have a quick fix for this.

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1810793#c28)• 2 years ago |
|  | |

We're still evaluating solutions for this bug, and don't consider it a critical issue that needs to be fixed ASAP. Please wait for the completion of our normal process, we will inform you of any updates we might have.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1810793#c29)• 2 years ago |
|  | |

We're thinking of letting ext-downloads.js call mimeService.validateFileNameForSaving behind a pref (on by default), and potentially remove pref later (after ESR) if there are no reported regressions from extension developers.

That would make the filename sanitization behavior of extensions more consistent with Firefox's usual download functionality.

needinfo to me to look into this further over the next few weeks and to schedule the implementation effort.

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1810793#c30)• 2 years ago |
|  | |

I took a look, and it looks like we are already relying on `validateFileNameForSaving` via `DownloadPaths.sanitize`:

* [source](https://searchfox.org/mozilla-central/rev/1d6e2f82287c298f77f21ad0f62f1aed6155577c/toolkit/components/extensions/parent/ext-downloads.js#667-694) to validate when the filename is specified by the extension.
* [source](https://searchfox.org/mozilla-central/rev/1d6e2f82287c298f77f21ad0f62f1aed6155577c/toolkit/components/extensions/parent/ext-downloads.js#820) to sanitize the filename derived from the URL.

The [implementation of `DownloadPaths.sanitize`](https://searchfox.org/mozilla-central/rev/1d6e2f82287c298f77f21ad0f62f1aed6155577c/toolkit/components/downloads/DownloadPaths.sys.mjs#10-20) specifies the `VALIDATE_SANITIZE_ONLY` flag, which [triggers a simplified code path (using the `SanitizeFileName` method)](https://searchfox.org/mozilla-central/rev/1d6e2f82287c298f77f21ad0f62f1aed6155577c/uriloader/exthandler/nsExternalHelperAppService.cpp#3260-3262) that excludes [the part that adds `.download` for `.lnk` etc.](https://searchfox.org/mozilla-central/rev/1d6e2f82287c298f77f21ad0f62f1aed6155577c/uriloader/exthandler/nsExternalHelperAppService.cpp#3264-3265,3273-3275,3445-3454).

While I can fix the extension-specific use by directly calling `validateFileNameForSaving` with different flags, I think that that the fix should be more general considering that the helper is used in more places outside the realm of WebExtensions: <https://searchfox.org/mozilla-central/search?q=downloadPaths.sanitize&path=>

* `validateFileNameForSaving` should check the special filenames (.lnk, etc) even with `VALIDATE_SANITIZE_ONLY`,
* or `validateFileNameForSaving` should take a new flag that does it, and `DownloadPaths.sanitize` should pass the flag.

... since this work is not in the extensions framework, I'm moving this to `Firefox::File Handling`. An alternative component could be the home of the `DownloadPaths` module, i.e. `Toolkit::Downloads API`.

Component: General → File HandlingFlags: needinfo?(rob)Product: WebExtensions → Firefox

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1810793#c31)• 2 years ago |
|  | |

The patches in [bug 1815062](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters") cover the changes described here in [comment 30](/show_bug.cgi?id=1810793#c30 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues").

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1810793#c32)• 2 years ago |
|  | |

(In reply to Neil Deakin from [comment #31](/show_bug.cgi?id=1810793#c31 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> The patches in [bug 1815062](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters") cover the changes described here in [comment 30](/show_bug.cgi?id=1810793#c30 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues").

In the current version of the patch, the new `allowInvalidFilenames` flag defaults to `true`. I would expect `false` there - [every caller](https://searchfox.org/mozilla-central/search?q=downloadPaths.sanitize&path=) should receive a sanitized filename.

Depends on: [CVE-2023-29542](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1810793#c33)• 2 years ago |
|  | |

Team the issue is still unassigned can anyone have a look into it

its been a month since i raised this issue

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1810793#c34)• 2 years ago |
|  | |

(In reply to Ameen from [comment #33](/show_bug.cgi?id=1810793#c33 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> Team the issue is still unassigned can anyone have a look into it
>
> its been a month since i raised this issue

It's not acceptable to repeatedly comment on issues every week or whatever, just to "ping" them. **Please stop doing this.**

In any case, as the comments already indicated, a fix is in progress in a separate linked bug on which this bug is marked as dependent, so the issue is actually being looked at.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1810793#c35)• 2 years ago |
|  | |

@Gijs

I haven't asked for update in past some days. also i have asked for an update because of the below mentioned comment. which state the issue is still unassigned that means the fix is not started yet

So to avoid unnoticed. i have pinged in the tickets an hour back.

FYI: my last reply on this ticket is about 17 days back.

<https://bugzilla.mozilla.org/show_bug.cgi?id=1813299#c11>

Sorry for the inconvenience if any

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1810793#c36)• 2 years ago |
|  | |

(In reply to Ameen from [comment #35](/show_bug.cgi?id=1810793#c35 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> also i have asked for an update because of the below mentioned comment. which state the issue is still unassigned that means the fix is not started yet

That's not what the comment says. Also the comment is by a bot, and on a completely different bug, which someone tracked for a specific release. This bug is not tracked in that way (and marked `sec-low`), so finding an assignee is not as urgent.

> So to avoid unnoticed. i have pinged in the tickets an hour back.

And I'm telling you, please don't do that - certainly not for tickets like this one where there is already a discussion on the fix happening on a different bug, or which are marked `sec-low` - which is in fact the case for all but 1 of the tickets you pinged.

The only people it'll ping is people already copied on the ticket who happen to have emails turned on for comments (which many people don't, so then they just don't notice and you don't achieve your aim of drawing attention to the ticket anyway).

If the people copied on the ticket thought that particular ticket should be at the top of their list, it would be there already. If one of your reports with a high/critical severity is going unaddressed for a month+ at a time or something without any explanation in the comments of that bug, needinfo the triage owner specifically, use chat.m.o as you were told elsewhere, or email security@mozilla.org - but I don't believe that is the case for any of the tickets you pinged.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1810793#c37)• 2 years ago |
|  | |

Okey Gijs Thanks for the update. one final query

1. In general how long will it take for sec-low issue to get fix.
2. usually on which interval i can asked for an update on any sec-low issues

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1810793#c38)• 2 years ago |
|  | |

(In reply to Ameen from [comment #37](/show_bug.cgi?id=1810793#c37 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> 1. In general how long will it take for sec-low issue to get fix.

That's highly variable but generally they're not super high priority compared with sec-high/sec-crit or other issues that affect a lot of users.

> 2. usually on which interval i can asked for an update on any sec-low issues

I would suggest you don't, and focus on higher severity issues, unless something about the bug other than "time passed" has changed materially - e.g. someone has publicized the issue elsewhere, you're aware of it being actively exploited by malicious actors, it was fixed or also discovered in other browsers, you found a variation on the issue that warrants more serious investigation, etc.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1810793#c39)• 2 years ago |
|  | |

I think this should be fixed by Neil's patch in the dep, in current 112 nightly. Rob, can you confirm?

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1810793#c40)• 2 years ago |
|  | |

Confirmed.

When I test the following snippet from an extension with the `"downloads"` permission,

```
browser.downloads.download({
  url: URL.createObjectURL(new Blob(["x"])),
  filename: "x.url",
  saveAs: true, // or similarly, without this line.
});

```

In Firefox 111 and earlier:

* A file called "x.url" was created.

With the changes from <https://hg.mozilla.org/mozilla-central/rev/642008166aacd5c65b428365bdef287c4ee3bc15>:

* "Error: filename must not contain illegal characters"

The error message is slightly inaccurate, but if desired we could fix that in a separate follow-up (or at least add a unit test eventually).

For now, I think that no further action is needed.

Status: NEW → RESOLVEDClosed: 2 years agoFlags: needinfo?(rob)Resolution: --- → FIXED

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a3706467_447061)• 2 years ago |

Status: RESOLVED → VERIFIED

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a3707466_447061)• 2 years ago |

See Also: → [1819643](/show_bug.cgi?id=1819643 "NEW - downloads.download should report accurate error for clearly invalid filenames")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a3749617_75935)• 2 years ago |

Assignee: nobody → enndeakinGroup: firefox-core-security → core-security-release
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)Target Milestone: --- → 112 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a4224590_695136)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a4242769_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1810793#c41)• 2 years ago |
|  | |

Team still i haven't received mail for the bounty process for this issue, can someone initiate this?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1810793#c42)• 2 years ago |
|  | |

(In reply to Ameen from [comment #41](/show_bug.cgi?id=1810793#c41 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> Team still i haven't received mail for the bounty process for this issue, can someone initiate this?

Tom, are you the right person to look into this?

Flags: needinfo?(tom)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1810793#c43)• 2 years ago |
|  | |

Also kindly share the CVE-ID details registered for this issue.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1810793#c44)• 2 years ago |
|  | |

Bounty questions can be emailed to security@mozilla.com

A CVE will be assigned when this version is in the week before release. Firefox 112 ships on April 11

Flags: needinfo?(tom)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a6306954_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a6732229_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main112+]

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1810793#c45)• 2 years ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #44](/show_bug.cgi?id=1810793#c44 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"))

> A CVE will be assigned when this version is in the week before release. Firefox 112 ships on April 11

As per this comment firefox 112 ships in 4-5 days. Can i get the CVE ID details

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1810793#c46)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327441) (obsolete)
— [Details](attachment.cgi?id=9327441&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1810793#c47)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327576)
— [Details](attachment.cgi?id=9327576&action=edit)

[Attachment #9327441](/attachment.cgi?id=9327441&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a7506232_159069)• 2 years ago |

Regressions: [1827115](/show_bug.cgi?id=1827115 "NEW - browser.downloads.download will not save a .url file")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1810793#c48)• 2 years ago |
|  | |

<https://www.mozilla.org/en-US/security/advisories/mfsa2023-13/#CVE-2023-29542>

Team kindly update this CVE Id to this ticket. seems it was missed to update here and only updated in security advisory link

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1810793#c49)• 2 years ago |
|  | |

Because of the way Bugzilla works, we can only give the CVE alias to one of the bugs. However, the alias used in bugzilla is fairly meaningless - when the CVE details make their way into the MITRE database, it will reference both bugs in all mechanisms that display CVE details.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a23625392_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810793#a43117027_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1810793&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Ameen](/user_profile?user_id=719704)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_d9e6e0ca_20250115_200928.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1810191)
* [XML](/show_bug.cgi?ctype=xml&id=1810191)

Closed
[Bug 1810191](/show_bug.cgi?id=1810191)
(CVE-2023-29541)

Opened 2 years ago
Closed 2 years ago

# .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables \_if\_ desktop files are executed by the user's file manager.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

.desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables \_if\_ desktop files are executed by the user's file manager.

## Categories

### (Firefox :: File Handling, defect, P3)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

113 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified) |
| firefox113 | [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 112+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox111 |  | wontfix |
| firefox112 | + | verified |
| firefox113 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ameenbasha111, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/90e8173161a73c012cc62b9f3cdeede4?d=mm&size=40)  [ameenbasha111](/user_profile?user_id=719704)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-29542](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1824959](/show_bug.cgi?id=1824959 "RESOLVED FIXED - Add tests for .desktop sanitization")

Dependency [tree](/showdependencytree.cgi?id=1810191&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1810191)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=904182 "https://bugs.chromium.org/p/chromium/issues/detail?id=904182")

## Details

### (Keywords: reporter-external, sec-moderate, sec-vector, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-29541

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a7004735_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [desktopDangerousExtension-Linux.html](/attachment.cgi?id=9312210)  [2 years ago](#c0)  [Ameen](/user_profile?user_id=719704)   1.02 KB, text/html |  | [Details](/attachment.cgi?id=9312210&action=edit) |
| --- | --- | --- |
| [Bug 1810191 - r?NeilDeakin](/attachment.cgi?id=9320672)  [2 years ago](#c22)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9320672&action=edit) | [Review](/attachment.cgi?id=9320672) |
| [Bug 1810191 - r?NeilDeakin](/attachment.cgi?id=9325666)  [2 years ago](#c27)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9325666&action=edit) | [Review](/attachment.cgi?id=9325666) |
| [Bug 1810191 - r?NeilDeakin](/attachment.cgi?id=9325667)  [2 years ago](#c29)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9325667&action=edit) | [Review](/attachment.cgi?id=9325667) |
| [advisory.txt](/attachment.cgi?id=9327417)  [2 years ago](#c35)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   412 bytes, text/plain |  | [Details](/attachment.cgi?id=9327417&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1810191#c0)• 2 years ago |
|  | |

Attached file
[desktopDangerousExtension-Linux.html](attachment.cgi?id=9312210)
— [Details](attachment.cgi?id=9312210&action=edit)

Hi Team before starting this have a Look into the below issue description. in which it shows the shortcuts files are restricted and Changed to .download But the same for Linux are not prevented

<https://bugs.chromium.org/p/chromium/issues/detail?id=1307930>

<https://bugs.chromium.org/p/chromium/issues/detail?id=1140417>

.desktop is a Shortcut file in linux similar to .lnk in Windows which could have ability to invoke the executables

Tested in Latest Version of FireFox in Linux 5.7.0-kali1-amd64 (KERNEL)

REPRODUCTION CASE

1. Open the below attached html File in Firefox on linux
2. You can see the shortcut file is allowed and downloaded in linux without renaming

Impact: Lead to Executing Code

I have added a POC HTML The resultant download file will invoke Calc when it is trying to execute

Flags: sec-bounty?

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1810191#c1)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

.symlink extension also allowed, which also need to be restricted.

Symlink is a implicit shortcut file. so this is also considered to be dangerous and should be fixed to avoid any issues in future

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1810191#c2)• 2 years ago |
|  | |

Any update regarding this issue?

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1810191#c3)• 2 years ago |
|  | |

Team can i get some update on this issue.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1810191#c4)• 2 years ago |
|  | |

Serg said he can take a look.

Flags: needinfo?(sgalich)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1810191#c5)• 2 years ago |
|  | |

I can not reproduce it on Ubuntu 22.04.1 LTS.

Ameen, what happens when you download this .desktop file in Chromium?

Flags: needinfo?(sgalich) → needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1810191#c6)• 2 years ago |
|  | |

Hi serg. it is similar to .lnk files in windows.

I have tested the same in Kali Linux and found vulnerable. On visiting the above html it will download a .desktop file. while trying to open it will invoke calc.

if this not opening calc in ubuntu. it might be due to the calc name was different in ubuntu. Kindly change accordingly in the above html

Flags: needinfo?(ameenbasha111)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1810191#c7)• 2 years ago |
|  | |

(In reply to Ameen from [comment #6](/show_bug.cgi?id=1810191#c6 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."))

> Hi serg. it is similar to .lnk files in windows.
>
> I have tested the same in Kali Linux and found vulnerable. On visiting the above html it will download a .desktop file. while trying to open it will invoke calc.
>
> if this not opening calc in ubuntu. it might be due to the calc name was different in ubuntu. Kindly change accordingly in the above html

Ubuntu opens `.desktop` files in text editor by default, they don't launch the file the `.desktop` points at. See e.g. <https://askubuntu.com/questions/1187934/cannot-launch-desktop-files-opens-with-text-editor-instead>

You didn't answer the question about chromium... What do they do with this file?

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1810191#c8)• 2 years ago |
|  | |

> Ubuntu opens .desktop files in text editor by default, they don't launch the file the .desktop points at.

Regarding this can you check on kali linux once?

> You didn't answer the question about chromium... What do they do with this file?

Have reported to chromium regarding symlink extension in that i have mentioned the same but didn't get any much info from them

Flags: needinfo?(ameenbasha111)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1810191#c9)• 2 years ago |
|  | |

(In reply to Ameen from [comment #8](/show_bug.cgi?id=1810191#c8 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."))

> > Ubuntu opens .desktop files in text editor by default, they don't launch the file the .desktop points at.
>
> Regarding this can you check on kali linux once?
>
> > You didn't answer the question about chromium... What do they do with this file?
>
> Have reported to chromium regarding symlink extension in that i have mentioned the same but didn't get any much info from them

I didn't ask about the symlink file. Please just answer the question. What happens in chromium when you download the `.desktop` file?

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1810191#c10)• 2 years ago |
|  | |

> Have reported to chromium regarding symlink extension in that i have mentioned the same but didn't get any much info from them

> in that i have mentioned the same but didn't get any much info from them

Have already responded for your query. Chrome is also having same issue and i clubbed and report the .symlink and .desktop to them but didn't get any update on this

Hope this clarify the points you needed.

Flags: needinfo?(ameenbasha111)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1810191#c11)• 2 years ago |
|  | |

(In reply to Ameen from [comment #10](/show_bug.cgi?id=1810191#c10 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."))

> > Have reported to chromium regarding symlink extension in that i have mentioned the same but didn't get any much info from them
>
> > in that i have mentioned the same but didn't get any much info from them
>
> Have already responded for your query. Chrome is also having same issue and i clubbed and report the .symlink and .desktop to them but didn't get any update on this
>
> Hope this clarify the points you needed.

Sorry, it wasn't clear to me that you also reported `.desktop` - your previous comment only referenced `.symlink`.

Can you please link to the chromium ticket? We try and coordinate so we don't 0-day each other and such. (it's fine if it's confidential at the moment, but then if we need to reach out we can at least share a link)

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1810191#c12)• 2 years ago |
|  | |

Hi Gijs yes i can share some details about my issue in chromium. Currently my issue was marked as duplicate to some old ticket which is already fixed and not properly works.

From the Duplicate ticket i got the chromium fix link. i will share them hope it will give you some more clarity about this.

Fix Link: [https://chromium.googlesource.com/chromium/src.git/+/b32471d5abb3b3a4fe56e1dd79871400b51a0cca](https://chromium.googlesource.com/chromium/src.git/%2B/b32471d5abb3b3a4fe56e1dd79871400b51a0cca)

FYI: Regarding my issue in chrome i have asked my updates. if i got any ill update you the ticket id.

Flags: needinfo?(ameenbasha111)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1810191#c13)• 2 years ago |
|  | |

The severity field is not set for this bug.

:serg, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(sgalich)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a1724682_691597)• 2 years ago |

Severity: -- → S3Flags: needinfo?(sgalich)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1810191#c14)• 2 years ago |
|  | |

Hi guys its been 24 days since i raise this issue, can i get some progress update on this.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a2164008_406194)• 2 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=904182>

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a2223692_159069)• 2 years ago |

Status: UNCONFIRMED → NEWComponent: Security → File HandlingEver confirmed: trueOS: Unspecified → LinuxHardware: Unspecified → DesktopSee Also: → [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")Summary: FireFox Allows Allows .desktop File extension in Linux Leads to Code execution → .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables \_if\_ desktop files are executed by the user's file manager.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1810191#c15)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hi guys, is there any update on this issue? it was about a month since i raised this.

|  | [Micah [:mtigley] (she/her)](/user_profile?user_id=618808) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a3022502_618808)• 2 years ago |

Depends on: [CVE-2023-29542](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters")Priority: -- → P3

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1810191#c16)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Team the issue is still unassigned can anyone have a look into it

Its been a month since the issue is raised

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1810191#c17)• 2 years ago |
|  | |

Dan, this doesn't have a security rating. [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read") was sec-moderate. I'd want to argue this should be sec-low given it's linux-only and doesn't affect major distributions by default (because of what happens when you open `.desktop` files using the default file manager), and there's no case where credentials are shared across a network automatically or similar like for .url/.lnk/.local. On the flip side, AFAICT (although this wasn't explicit in the original report), it runs local executables *with* attacker-supplied commandline args, if executed, which seems worse than running things already on the user's machine without arguments, so maybe that means it should be sec-moderate or otherwise. Can you make a decision? Thanks!

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1810191#c18)• 2 years ago |
|  | |

Agreed that Kali is not major, but other than Ubuntu mentioned above do we know that it doesn't affect other distributions? The linked Chrome bug mentions it affected Debian using both GNOME and KDE desktops (but that was 2019!). In any case, a small affected population influences our priority for fixing more than the severity of the symptoms. We do sometimes temper a sec-high, but we shouldn't drop this further to sec-low. Especially not with the ability to include arbitrary arguments.

Flags: needinfo?(dveditz)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1810191#c19)• 2 years ago |
|  | |

> Hi Gijs yes i can share some details about my issue in chromium.

Gijs asked for the ***link***. If there's still a problem in Chrome (see below) we need to give them the reference so both sides know we're talking about the same thing. The old chrome bug does not appear to show the bug merged into it, at least not that an unprivileged account can see.

> Currently my issue was marked as duplicate to some old ticket which is already fixed and not properly works.

I'm not sure what you mean by that last bit. The simplest interpretations is that since the Chrome team duped it to a fixed bug, it's a simple typo for "now": now Chrome properly works. But if it was fixed 3 years ago you wouldn't have seen something that caused you to report it again. That argues that you meant something like "already fixed, but not properly/it doesn't work properly".

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1810191#c20)• 2 years ago |
|  | |

<https://bugs.chromium.org/p/chromium/issues/detail?id=1407082>

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1810191#c21)• 2 years ago |
|  | |

<https://bugs.chromium.org/p/chromium/issues/detail?id=1407119>

these two are my reports in chrome.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a4050746_159069)• 2 years ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1810191#c22)• 2 years ago |
|  | |

Attached file
[Bug 1810191 - r?NeilDeakin](attachment.cgi?id=9320672)
— [Details](attachment.cgi?id=9320672&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a6369493_159069)• 2 years ago |

Blocks: [1824959](/show_bug.cgi?id=1824959 "RESOLVED FIXED - Add tests for .desktop sanitization")

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1810191#c23)• 2 years ago |
|  | |

(In reply to Ameen from [comment #1](/show_bug.cgi?id=1810191#c1 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."))

> .symlink extension also allowed, which also need to be restricted.
>
> Symlink is a implicit shortcut file. so this is also considered to be dangerous and should be fixed to avoid any issues in future

Do you have a PoC/demo of `.symlink` as a file extension causing any issues? I'm familiar with symbolic links, but they don't need to have a specific extension. IOW, what software treats `.symlink` as a meaningful extension?

Flags: needinfo?(ameenbasha111)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1810191#c24)• 2 years ago |
|  | |

Hi Gijs, As a short form of symbolic link i have mentioned it has symlink. This doesn't work as i expected for an exploit.

Kindly ignore this case, sorry for confusion. it is good to go with desktop fix.

Flags: needinfo?(ameenbasha111)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1810191#c25)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/c32c6af3326a>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B)Resolution: --- → FIXEDTarget Milestone: --- → 113 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1810191#c26)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:Gijs, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox112` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1810191#c27)• 2 years ago |
|  | |

Attached file
[Bug 1810191 - r?NeilDeakin](attachment.cgi?id=9325666)
— [Details](attachment.cgi?id=9325666&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D171405>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1810191#c28)• 2 years ago |
|  | |

# Uplift Approval Request

* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: See <https://bugzilla.mozilla.org/show_bug.cgi?id=1810191#c0> - post-patch the .desktop file should be renamed when downloaded (suffixed with .download)
* **User impact if declined**: sec-moderate
* **Fix verified in Nightly**: no
* **Explanation of risk level**: Straightforward 2-line security fix.
* **Risk associated with taking this patch**: low
* **String changes made/needed**: Nope
* **Is Android affected?**: no
* **Code covered by automated testing**: no
Flags: qe-verify+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1810191#c29)• 2 years ago |
|  | |

Attached file
[Bug 1810191 - r?NeilDeakin](attachment.cgi?id=9325667)
— [Details](attachment.cgi?id=9325667&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D171405>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1810191#c30)• 2 years ago |
|  | |

# Uplift Approval Request

* **Fix verified in Nightly**: no
* **User impact if declined**: sec-moderate
* **Steps to reproduce for manual QE testing**: See <https://bugzilla.mozilla.org/show_bug.cgi?id=1810191#c0> - post-patch the .desktop file should be renamed when downloaded (suffixed with .download)
* **Needs manual QE test**: yes
* **Code covered by automated testing**: no
* **Is Android affected?**: no
* **String changes made/needed**: No
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: Straightforward 2-line security fix.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a6462760_159069)• 2 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a6515775_640478)• 2 years ago |

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1810191#c31)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/450608977fc4>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1810191#c32)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party. (Or: if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1810191#c33)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/f57ca611ed17>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a6988832_553429)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1810191#c34)• 2 years ago |
|  | |

I have reproduced this bug using an affected Nightly build (2023-01-13) with Ubuntu 18.04 x64.

The issue is verified on the fixed builds, latest Nightly 113.0a1, RC 112.0 and Esr 102.10 with Ubuntu 18.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a7004735_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a7077381_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a7078661_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1810191#c35)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327417)
— [Details](attachment.cgi?id=9327417&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1810191#c36)• 2 years ago |
|  | |

Team Kindly Share CVE ID for this issue

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a7267539_578488)• 2 years ago |

Alias: CVE-2023-29541

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a23971139_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810191#a43462750_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1810191&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Ameen](/user_profile?user_id=719704)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_a8484407_20250115_200901.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_1e5f9d4b_20250114_224122.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1815062)
* [XML](/show_bug.cgi?ctype=xml&id=1815062)

Closed
[Bug 1815062](/show_bug.cgi?id=1815062)
(CVE-2023-29542)

Opened 2 years ago
Closed 2 years ago

# url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 112+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox110 |  | wontfix |
| firefox111 |  | wontfix |
| firefox112 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-29541](/show_bug.cgi?id=1810191 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."), [1810793](/show_bug.cgi?id=1810793 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues")

[1824468](/show_bug.cgi?id=1824468 "RESOLVED FIXED - Add tests from bug 1815062 and 1809923")

Dependency [tree](/showdependencytree.cgi?id=1815062&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1815062)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1819760](/show_bug.cgi?id=1819760 "VERIFIED FIXED - Dragging and dropping the identity box to the desktop to create a .url shortcut is broken (creates .url.download instead of .url)")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1815204](/show_bug.cgi?id=1815204 "RESOLVED DUPLICATE - Extension sanitization (.lnk, .local) bypass using pipe (|)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-29542

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c22 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=9315984)  [2 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   1.66 KB, text/html |  | [Details](/attachment.cgi?id=9315984&action=edit) |
| --- | --- | --- |
| [solution.txt](/attachment.cgi?id=9316055)  [2 years ago](#c6)  [Shaheen Fazim](/user_profile?user_id=720428)   1.29 KB, text/plain |  | [Details](/attachment.cgi?id=9316055&action=edit) |
| [Bug 1815062, move filename and extension validity checks into SanitizeFileName so that they get called after sanitization is complete, r=gijs](/attachment.cgi?id=9316428)  [2 years ago](#c20)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9316428&action=edit) | [Review](/attachment.cgi?id=9316428) |
| [Bug 1815062, tests for problematic extensions, r=gijs](/attachment.cgi?id=9316646)  [2 years ago](#c21)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9316646&action=edit) | [Review](/attachment.cgi?id=9316646) |
| [Bug 1815062, modify callers of DownloadPaths.sanitize so that some use the allowInvalidFilenames argument, r=gijs](/attachment.cgi?id=9319866)  [2 years ago](#c25)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9319866&action=edit) | [Review](/attachment.cgi?id=9319866) |
| [WIP: Bug 1815062, part 1, esr version](/attachment.cgi?id=9326148)  [2 years ago](#c31)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#c35 "2 years ago") | [Details](/attachment.cgi?id=9326148&action=edit) | [Review](/attachment.cgi?id=9326148) |
| [WIP: Bug 1815062, part 2, esr version](/attachment.cgi?id=9326149)  [2 years ago](#c32)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#a4756005_75935 "2 years ago") | [Details](/attachment.cgi?id=9326149&action=edit) | [Review](/attachment.cgi?id=9326149) |
| [advisory.txt](/attachment.cgi?id=9327556)  [2 years ago](#c38)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   380 bytes, text/plain |  | [Details](/attachment.cgi?id=9327556&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1815062#c0)• 2 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9315984)
— [Details](attachment.cgi?id=9315984&action=edit)

Firefox has implemented a security measure aimed at protecting its users by replacing the download of malicious shortcut extensions, such as .url, .lnk, .scf, .local, and others, with the ".download" extension. However, it has been discovered that an attackers can use special character to bypass this filter.

A similar issue has been previously reported by me in Mozilla's bug tracking system (<https://bugzilla.mozilla.org/show_bug.cgi?id=1810143>) and has recently been addressed in the latest beta version of Firefox (110.0).

After conducting thorough testing on the latest version of Firefox, it has been determined that all dangerous extensions can still be downloaded using this bypass, indicating a lack of a filter to prevent this vulnerability.

I have provided a proof of concept (poc.html) file that downloads .url. Using the special character '\n' bypass, you can directly modify the fileName variable to test other dangerous extensions, including .scf, .lnk, and .local.

Note: This vulnerability is of a more severe nature, given the ability of not only .url extensions, but also .scf, .lnk, and .local extensions to be downloaded as well.

Solution: Block special characters.

Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1815062#c1)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Comment on [attachment 9315984](/attachment.cgi?id=9315984 "poc.html") [[details]](/attachment.cgi?id=9315984&action=edit "poc.html")
poc.html
><!DOCTYPE html>
><html>
>
><head>
> <title>Dangerous Download</title>
></head>
>
><body>
> <button onclick="downloadThis()">Download</button>
>
> <script type="text/javascript">
> function downloadThis() {
> var saveData = (function() {
> var a = document.createElement("a");
> document.body.appendChild(a);
> a.style = "display: none";
> return function(data, fileName) {
> var blob = new Blob([data], {
> type: "octet/stream"
> }),
> url = window.URL.createObjectURL(blob);
> a.href = url;
> a.download = fileName;
> a.click();
> window.URL.revokeObjectURL(url);
> };
> }());
>
> //Malicious code
> const binary = base64ToArrayBuffer("W3swMDAyMTRBMC0wMDAwLTAwMDAtQzAwMC0wMDAwMDAwMDAwNDZ9XQ0KUHJvcDM9MTksMg0KW0ludGVybmV0U2hvcnRjdXRdDQpJRExpc3Q9DQpVUkw9ZmlsZTovL0M6L1dpbmRvd3Mvc3lzdGVtLmluaQ0KSG90S2V5PTA=");
>
> function base64ToArrayBuffer(base64) {
> var binary\_string = window.atob(base64);
> var len = binary\_string.length;
> var bytes = new Uint8Array(len);
> for (var i = 0; i < len; i++) {
> bytes[i] = binary\_string.charCodeAt(i);
> }
> return bytes.buffer;
> }
>
> fileName = "wallet.url\n";
>
> var test = saveData(binary, fileName);
> //console.log(test.fileName);
>
> }
> </script>
>
></body>
>
></html>

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1815062#c2)• 2 years ago |
|  | |

This is a video demonstration that is testing the previously mentioned dangerous file extensions: <https://youtu.be/_GdMxVxcEKE> (YouTube Unlisted)

Note: It is also possible to bypass the DLL download prompt using this method, I am uncertain if this constitutes a problem.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1815062#c3)• 2 years ago |
|  | |

This vulnerability affects the latest version of Firefox Stable, and the method can be used to bypass the recently added .url and .scf filters, as demonstrated in testing on the Firefox beta.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1815062#c4)• 2 years ago |
|  | |

This method can be further exploited using the following techniques:

.lnk/.local: <https://bugzilla.mozilla.org/show_bug.cgi?id=1773894>

.url: <https://bugzilla.mozilla.org/show_bug.cgi?id=1810143>

.scf: <https://bugzilla.mozilla.org/show_bug.cgi?id=1812354>

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1815062#c5)• 2 years ago |
|  | |

Original code (from <https://hg.mozilla.org/mozilla-central/rev/ab7d32a004aa> ):

`if (StringEndsWith(fileName, u".lnk"_ns, nsCaseInsensitiveStringComparator) || StringEndsWith(fileName, u".local"_ns, nsCaseInsensitiveStringComparator) || StringEndsWith(fileName, u".url"_ns, nsCaseInsensitiveStringComparator) || StringEndsWith(fileName, u".scf"_ns, nsCaseInsensitiveStringComparator)) { fileName.AppendLiteral(".download"); }`

Revised code (Solution):

`#include <string>

#include <algorithm>

#include <cctype>

bool isSpecialCharacter(char c) {

return !std::isalnum(c);

}

void replaceSpecialCharacters(std::string& str) {

std::replace\_if(str.begin(), str.end(), isSpecialCharacter, '\_');

}

if (StringEndsWith(fileName, u".lnk"\_ns, nsCaseInsensitiveStringComparator) ||

StringEndsWith(fileName, u".local"\_ns, nsCaseInsensitiveStringComparator) ||

StringEndsWith(fileName, u".url"\_ns, nsCaseInsensitiveStringComparator) ||

StringEndsWith(fileName, u".scf"\_ns, nsCaseInsensitiveStringComparator)) {

replaceSpecialCharacters(fileName);

fileName.AppendLiteral(".download");

}

`

Solution: The revised code checks if the file name contains any special characters, and blocks them by replacing these characters with an underscore.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1815062#c6)• 2 years ago |
|  | |

Attached file
[solution.txt](attachment.cgi?id=9316055)
— [Details](attachment.cgi?id=9316055&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1815062#c7)• 2 years ago |
|  | |

Comment on [attachment 9316055](/attachment.cgi?id=9316055 "solution.txt") [[details]](/attachment.cgi?id=9316055&action=edit "solution.txt")

solution.txt

This attachment isn't patch-formatted. It also wouldn't work because we can't use `std`, and the solution posted is not unicode-compatible (ie if the C locale was en-US, you couldn't have any non-ascii filenames), and because we already do sanitization and we should probably just make sure that the filename checks get run after the sanitization, rather than before.

[Attachment #9316055](/attachment.cgi?id=9316055&action=edit "solution.txt") -
Attachment is patch: false

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1815062#c8)• 2 years ago |
|  | |

Neil, can you take a look?

Flags: needinfo?(enndeakin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a156680_159069)• 2 years ago |

Component: Security → File Handling

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a156714_159069)• 2 years ago |

Summary: Bypass all Extension filter using special character → url/local/lnk/scf .download filename manipulation can be bypassed by using final newline character

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1815062#c9)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #7](/show_bug.cgi?id=1815062#c7 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> Comment on [attachment 9316055](/attachment.cgi?id=9316055 "solution.txt") [[details]](/attachment.cgi?id=9316055&action=edit "solution.txt")
>
> solution.txt
>
> This attachment isn't patch-formatted. It also wouldn't work because we can't use `std`, and the solution posted is not unicode-compatible (ie if the C locale was en-US, you couldn't have any non-ascii filenames), and because we already do sanitization and we should probably just make sure that the filename checks get run after the sanitization, rather than before.

I apologize, I am unfamiliar with how the patch system works (Can you provide a documentation on this so I can learn how things work? Thank you.)

Yes, we could use the sanitation prior to checking the filename.

However, if the user intends to perform unusual actions, such as incorporating \u unicodes in their filename, I have considered incorporating the sanitation within the dangerous file check, while leaving other non-threatening file extensions open for user creativity.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1815062#c10)• 2 years ago |
|  | |

I believe my code also removes unicode characters, as an attacker could use unicode instead of a character, for example, "test.ln\u006B"

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1815062#c11)• 2 years ago |
|  | |

So my solution allows for the use of unicode and other unusual characters in non-threatening file extensions, while filtering them out if they are used in dangerous extensions, providing a proper resolution.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1815062#c12)• 2 years ago |
|  | |

This is why I thought my title should be "Special Character" and not just "Newline".

What is your opinion regarding the fact that the DLL is skipping the prompt, I am uncertain if this constitutes a problem.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1815062#c13)• 2 years ago |
|  | |

(In reply to Shaheen Fazim from [comment #9](/show_bug.cgi?id=1815062#c9 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> I apologize, I am unfamiliar with how the patch system works (Can you provide a documentation on this so I can learn how things work? Thank you.)

<https://firefox-source-docs.mozilla.org/contributing/contribution_quickref.html> has details on a bunch of this.

> However, if the user intends to perform unusual actions, such as incorporating \u unicodes in their filename, I have considered incorporating the sanitation within the dangerous file check, while leaving other non-threatening file extensions open for user creativity.

This doesn't really make sense. The existing code checks if the file name ends with `.lnk` (or any of the other extensions). If there is random stuff on the end of the filename, that check will fail, because the filename ends in `.lnk` **plus the extra stuff**, so we never enter the `if` condition in the first place.

To fix this, the code would need to do sanitization *before* checking the end of the filename.

I think this means the `if` condition just needs to move after [the call to `SanitizeFileName`](https://searchfox.org/mozilla-central/rev/ddbeacddc15008936e8f619c8c3a05fac6eab8d8/uriloader/exthandler/nsExternalHelperAppService.cpp#3480). Neil, does that sound right?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1815062#c14)• 2 years ago |
|  | |

(In reply to Shaheen Fazim from [comment #2](/show_bug.cgi?id=1815062#c2 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> This is a video demonstration that is testing the previously mentioned dangerous file extensions: <https://youtu.be/_GdMxVxcEKE> (YouTube Unlisted)
>
> Note: It is also possible to bypass the DLL download prompt using this method, I am uncertain if this constitutes a problem.

The prompt in your video is the "what do you want to do with this file" dialog. I don't think it will generally show up for DLLs in a clean Firefox profile anyway. It's not normally there as a security feature; that happens when you try to *open* a dangerous file, when Firefox will tell you the file is executable and ask if you're sure you want to continue. (Yes, this is different from Chrome where there is a warning prompt that happens when you download, not when you open.)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1815062#c15)• 2 years ago |
|  | |

Thank you for the information.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a160075_159069)• 2 years ago |

Summary: url/local/lnk/scf .download filename manipulation can be bypassed by using final newline character → url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a160088_159069)• 2 years ago |

Duplicate of this bug: [1815204](/show_bug.cgi?id=1815204 "RESOLVED DUPLICATE - Extension sanitization (.lnk, .local) bypass using pipe (|)")

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1815062#c17)• 2 years ago |
|  | |

Is Haxatron1 an external reporter or another assignee? I am confused because I have seen Haxatron1 on other bugs as well.

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1815062#c18)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #13](/show_bug.cgi?id=1815062#c13 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> I think this means the `if` condition just needs to move after [the call to `SanitizeFileName`](https://searchfox.org/mozilla-central/rev/ddbeacddc15008936e8f619c8c3a05fac6eab8d8/uriloader/exthandler/nsExternalHelperAppService.cpp#3480). Neil, does that sound right?

Yes, I think it could be moved afterwards. Perhaps though it should be placed inside at the end SanitizeFilename instead. This would handle the case where VALIDATE\_SANITIZE\_ONLY was passed. A brief inspection suggests that some callers should be checking for these sorts of invalid filenames. However, my understanding is that callers from the extension api should not be modifying the filename.

Flags: needinfo?(enndeakin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1815062#c19)• 2 years ago |
|  | |

(In reply to Neil Deakin from [comment #18](/show_bug.cgi?id=1815062#c18 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> (In reply to :Gijs (he/him) from [comment #13](/show_bug.cgi?id=1815062#c13 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))
>
> > I think this means the `if` condition just needs to move after [the call to `SanitizeFileName`](https://searchfox.org/mozilla-central/rev/ddbeacddc15008936e8f619c8c3a05fac6eab8d8/uriloader/exthandler/nsExternalHelperAppService.cpp#3480). Neil, does that sound right?
>
> Yes, I think it could be moved afterwards. Perhaps though it should be placed inside at the end SanitizeFilename instead. This would handle the case where VALIDATE\_SANITIZE\_ONLY was passed. A brief inspection suggests that some callers should be checking for these sorts of invalid filenames.

Makes sense to me. Are you able to pick up this bug? :-)

Flags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1815062#c20)• 2 years ago |
|  | |

Attached file
[Bug 1815062, move filename and extension validity checks into SanitizeFileName so that they get called after sanitization is complete, r=gijs](attachment.cgi?id=9316428)
— [Details](attachment.cgi?id=9316428&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a278622_600971)• 2 years ago |

Assignee: nobody → enndeakinStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1815062#c21)• 2 years ago |
|  | |

Attached file
[Bug 1815062, tests for problematic extensions, r=gijs](attachment.cgi?id=9316646) (obsolete)
— [Details](attachment.cgi?id=9316646&action=edit)

Depends on D169124

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a370710_1689)• 2 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a756844_447061)• 2 years ago |

Blocks: [1810793](/show_bug.cgi?id=1810793 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1815062#c22)• 2 years ago |
|  | |

This bug and [bug 1815204](/show_bug.cgi?id=1815204 "RESOLVED DUPLICATE - Extension sanitization (.lnk, .local) bypass using pipe (|)") were filed within the "collision window" specified in our bug bounty program. We are awarding a bounty split between the two reporters.

Flags: sec-bounty? → sec-bounty+

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1815062#c23)• 2 years ago |
|  | |

Thank you for the bounty. I appreciate the fact that the Mozilla team is quick to handle reports.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1815062#c24)• 2 years ago |
|  | |

This would be S3 but the fact that we've published an advisory and the fix can be bypassed so easily means I'm marking S2. We should try to get this fix into 111 if possible. Neil, let me know if there's anything I can do to help!

Severity: -- → S2OS: Unspecified → WindowsPriority: -- → P1Hardware: Unspecified → Desktop

|  | [Micah [:mtigley] (she/her)](/user_profile?user_id=618808) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a1127525_618808)• 2 years ago |

Blocks: [CVE-2023-29541](/show_bug.cgi?id=1810191 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager.")

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1815062#c25)• 2 years ago |
|  | |

Attached file
[Bug 1815062, modify callers of DownloadPaths.sanitize so that some use the allowInvalidFilenames argument, r=gijs](attachment.cgi?id=9319866)
— [Details](attachment.cgi?id=9319866&action=edit)

Callers that use the filename to assign the default filename in a filepicker or save without a filepicker should use the default arguments, callers that validate a filename entered from a filepicker should supply false for compressWhitespaces, and true for allowInvalidFilenames

Depends on D169124

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a2075194_6102)• 2 years ago |

Flags: needinfo?(enndeakin)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1815062#c26)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/642008166aac>

<https://hg.mozilla.org/mozilla-central/rev/bce007ba1a3f>

Is this something we want/need on ESR also? If so, it'll need rebasing.

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F)Flags: needinfo?(enndeakin)Resolution: --- → FIXEDTarget Milestone: --- → 112 Branch

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1815062#c27)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #26](/show_bug.cgi?id=1815062#c26 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"))

> Is this something we want/need on ESR also? If so, it'll need rebasing.

Given [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read") was uplifted to ESR, I suppose we should uplift this too.

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1815062#c28)• 2 years ago |
|  | |

Neil, can we get a beta uplfit request on this? Also ESR - see [comment 26](/show_bug.cgi?id=1815062#c26 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters") and [comment 27](/show_bug.cgi?id=1815062#c27 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters")

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a2335446_293623)• 2 years ago |

Regressions: [1819760](/show_bug.cgi?id=1819760 "VERIFIED FIXED - Dragging and dropping the identity box to the desktop to create a .url shortcut is broken (creates .url.download instead of .url)")

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a2584297_553429)• 2 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1815062#c29)• 2 years ago |
|  | |

Tracking for 112

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) → ---
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F) → [112+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=112%2B)

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1815062#c30)• 2 years ago |
|  | |

I was able to reproduce the issue on Firefox 111.0a1 (2023-02-04) on Windows 11 by using the informations provided in [Comment 0](/show_bug.cgi?id=1815062#c0 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters") and the demonstration on [Comment 2](/show_bug.cgi?id=1815062#c2 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters") where the ".download" was not used when editing the poc with "\n" (tried with url, lnk, local, scf and dll).

The issue is fixed on Firefox 112.0a1 (2023-03-07) on the same system and all of them have the ".download" added. Dll downloads seems to be behave like before as they are directly downloaded as they are.

Status: RESOLVED → VERIFIED
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified)Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a2682717_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4166838_6102)• 2 years ago |

Blocks: [1824468](/show_bug.cgi?id=1824468 "RESOLVED FIXED - Add tests from bug 1815062 and 1809923")

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1815062#c31)• 2 years ago |
|  | |

Attached file
[WIP: Bug 1815062, part 1, esr version](attachment.cgi?id=9326148)
— [Details](attachment.cgi?id=9326148&action=edit)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1815062#c32)• 2 years ago |
|  | |

Attached file
[WIP: Bug 1815062, part 2, esr version](attachment.cgi?id=9326149)
— [Details](attachment.cgi?id=9326149&action=edit)

Depends on D174190

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1815062#c33)• 2 years ago |
|  | |

A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party. (Or: if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1815062#c34)• 2 years ago |
|  | |

Comment on [attachment 9326148](/attachment.cgi?id=9326148 "WIP: Bug 1815062, part 1, esr version") [[details]](/attachment.cgi?id=9326148&action=edit "WIP: Bug 1815062, part 1, esr version")

WIP: [Bug 1815062](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"), part 1, esr version

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Host can use a specially crafted name and file that, if saved, ends up creating a shortcut on the desktop that can execute code.
* **User impact if declined**: security issue for user
* **Fix Landed on Version**: 112
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: Has various tests in [bug 1824468](/show_bug.cgi?id=1824468 "RESOLVED FIXED - Add tests from bug 1815062 and 1809923").

Note also that regression [bug 1819760](/show_bug.cgi?id=1819760 "VERIFIED FIXED - Dragging and dropping the identity box to the desktop to create a .url shortcut is broken (creates .url.download instead of .url)") is also needed.

Flags: needinfo?(enndeakin)
[Attachment #9326148](/attachment.cgi?id=9326148&action=edit "WIP: Bug 1815062, part 1, esr version") -
Flags: approval-mozilla-esr102?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4751640_6102)• 2 years ago |

[Attachment #9316428](/attachment.cgi?id=9316428&action=edit "Bug 1815062, move filename and extension validity checks into SanitizeFileName so that they get called after sanitization is complete, r=gijs") -
Flags: approval-mozilla-esr102?
[Attachment #9316646](/attachment.cgi?id=9316646&action=edit "Bug 1815062, tests for problematic extensions, r=gijs") -
Flags: approval-mozilla-esr102?
[Attachment #9319866](/attachment.cgi?id=9319866&action=edit "Bug 1815062, modify callers of DownloadPaths.sanitize so that some use the allowInvalidFilenames argument, r=gijs") -
Flags: approval-mozilla-esr102?
[Attachment #9326149](/attachment.cgi?id=9326149&action=edit "WIP: Bug 1815062, part 2, esr version") -
Flags: approval-mozilla-esr102?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4751660_6102)• 2 years ago |

[Attachment #9319866](/attachment.cgi?id=9319866&action=edit "Bug 1815062, modify callers of DownloadPaths.sanitize so that some use the allowInvalidFilenames argument, r=gijs") -
Flags: approval-mozilla-esr102?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4751672_6102)• 2 years ago |

[Attachment #9316646](/attachment.cgi?id=9316646&action=edit "Bug 1815062, tests for problematic extensions, r=gijs") -
Flags: approval-mozilla-esr102?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4751681_6102)• 2 years ago |

[Attachment #9316428](/attachment.cgi?id=9316428&action=edit "Bug 1815062, move filename and extension validity checks into SanitizeFileName so that they get called after sanitization is complete, r=gijs") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1815062#c35)• 2 years ago |
|  | |

Comment on [attachment 9326148](/attachment.cgi?id=9326148 "WIP: Bug 1815062, part 1, esr version") [[details]](/attachment.cgi?id=9326148&action=edit "WIP: Bug 1815062, part 1, esr version")

WIP: [Bug 1815062](/show_bug.cgi?id=1815062 "VERIFIED FIXED - url/local/lnk/scf .download filename manipulation can be bypassed by using final newline or other sanitized characters"), part 1, esr version

Approved for 102.10esr.

[Attachment #9326148](/attachment.cgi?id=9326148&action=edit "WIP: Bug 1815062, part 1, esr version") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a4756005_75935)• 2 years ago |

[Attachment #9326149](/attachment.cgi?id=9326149&action=edit "WIP: Bug 1815062, part 2, esr version") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1815062#c36)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/ebf42d0ec756>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/bee762d84bfd>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1815062#c37)• 2 years ago |
|  | |

Verified that the issue is fixed as well with Firefox ESR 102.10.0 on Windows 11 and all have the ".download" added.

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a5181845_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a5183526_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main112+][adv-esr102.10+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1815062#c38)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9327556)
— [Details](attachment.cgi?id=9327556&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a5372564_578488)• 2 years ago |

Alias: CVE-2023-29542

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a8982314_600971)• 2 years ago |

[Attachment #9316646](/attachment.cgi?id=9316646&action=edit "Bug 1815062, tests for problematic extensions, r=gijs") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a22076156_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1815062#a41567841_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1815062&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_4d973e86_20250114_224129.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-14

## Security Vulnerabilities fixed in Firefox ESR 102.10

Announced
April 11, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250115_200908.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_40585956_20250115_200859.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_acf64303_20250114_224128.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-13

## Security Vulnerabilities fixed in Firefox 112, Firefox for Android 112, Focus for Android 112

Announced
April 11, 2023
Impact
high
Products
Firefox, Firefox for Android, Focus for Android
Fixed in

* Firefox 112
* Firefox for Android 112
* Focus for Android 112

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Firefox for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-29534: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2023-29534)

Reporter
Shaheen Fazim and Hafiizh
Impact
high
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox and Focus for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox and Focus for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1816059](https://bugzilla.mozilla.org/show_bug.cgi?id=1816059)
* [Bug 1816007](https://bugzilla.mozilla.org/show_bug.cgi?id=1816007)
* [Bug 1821155](https://bugzilla.mozilla.org/show_bug.cgi?id=1821155)
* [Bug 1821576](https://bugzilla.mozilla.org/show_bug.cgi?id=1821576)
* [Bug 1821906](https://bugzilla.mozilla.org/show_bug.cgi?id=1821906)
* [Bug 1822298](https://bugzilla.mozilla.org/show_bug.cgi?id=1822298)
* [Bug 1822305](https://bugzilla.mozilla.org/show_bug.cgi?id=1822305)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-29537: Data Races in font initialization code](#CVE-2023-29537)

Reporter
Looben Yang
Impact
high
##### Description

Multiple race conditions in the font initialization could have led to memory corruption and execution of attacker-controlled code.

##### References

* [Bug 1823365](https://bugzilla.mozilla.org/show_bug.cgi?id=1823365)
* [Bug 1824200](https://bugzilla.mozilla.org/show_bug.cgi?id=1824200)
* [Bug 1825569](https://bugzilla.mozilla.org/show_bug.cgi?id=1825569)

#### [#CVE-2023-29538: Directory information could have been leaked to WebExtensions](#CVE-2023-29538)

Reporter
Alexis aka zoracon
Impact
moderate
##### Description

Under specific circumstances a WebExtension may have received a `jar:file:///` URI instead of a `moz-extension:///` URI during a load request. This leaked directory paths on the user's machine.

##### References

* [Bug 1685403](https://bugzilla.mozilla.org/show_bug.cgi?id=1685403)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29540: Iframe sandbox bypass using redirects and sourceMappingUrls](#CVE-2023-29540)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Using a redirect embedded into `sourceMappingUrls` could allow for navigation to external protocol links in sandboxed iframes without `allow-top-navigation-to-custom-protocols`.

##### References

* [Bug 1790542](https://bugzilla.mozilla.org/show_bug.cgi?id=1790542)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Firefox did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Firefox for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29543: Use-after-free in debugging APIs](#CVE-2023-29543)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

An attacker could have caused memory corruption and a potentially exploitable use-after-free of a pointer in a global object's debugger vector.

##### References

* [Bug 1816158](https://bugzilla.mozilla.org/show_bug.cgi?id=1816158)

#### [#CVE-2023-29544: Memory Corruption in garbage collector](#CVE-2023-29544)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If multiple instances of resource exhaustion occurred at the incorrect time, the garbage collector could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1818781](https://bugzilla.mozilla.org/show_bug.cgi?id=1818781)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-29546: Screen recording in Private Browsing included address bar on Android](#CVE-2023-29546)

Reporter
Irwan
Impact
low
##### Description

When recording the screen while in Private Browsing on Firefox for Android the address bar and keyboard were not hidden, potentially leaking sensitive information.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1780842](https://bugzilla.mozilla.org/show_bug.cgi?id=1780842)

#### [#CVE-2023-29547: Secure document cookie could be spoofed with insecure cookie](#CVE-2023-29547)

Reporter
Marco Squarcina
Impact
low
##### Description

When a secure cookie existed in the Firefox cookie jar an insecure cookie for the same domain could have been created, when it should have silently failed. This could have led to a desynchronization in expected results when reading from the secure cookie.

##### References

* [Bug 1783536](https://bugzilla.mozilla.org/show_bug.cgi?id=1783536)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29549: Javascript's bind function may have failed](#CVE-2023-29549)

Reporter
Lukas Bernhard
Impact
low
##### Description

Under certain circumstances, a call to the `bind` function may have resulted in the incorrect realm. This may have created a vulnerability relating to JavaScript-implemented sandboxes such as SES.

##### References

* [Bug 1823042](https://bugzilla.mozilla.org/show_bug.cgi?id=1823042)

#### [#CVE-2023-29550: Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111 and Firefox ESR 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112 and Firefox ESR 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1812498%2C1814217%2C1818357%2C1751945%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

#### [#CVE-2023-29551: Memory safety bugs fixed in Firefox 112](#CVE-2023-29551)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 111. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763625%2C1814314%2C1815798%2C1815890%2C1819239%2C1819465%2C1819486%2C1819492%2C1819957%2C1820514%2C1820776%2C1821838%2C1822175%2C1823547)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_db161f5b_20250114_224130.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-15

## Security Vulnerabilities fixed in Thunderbird 102.10

Announced
April 11, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.10

#### [#CVE-2023-29531: Out-of-bound memory access in WebGL on macOS](#CVE-2023-29531)

Reporter
DoHyun Lee
Impact
high
##### Description

An attacker could have caused an out of bounds memory access using WebGL APIs, leading to memory corruption and a potentially exploitable crash.
*This bug only affects Thunderbird for macOS. Other operating systems are unaffected.*

##### References

* [Bug 1794292](https://bugzilla.mozilla.org/show_bug.cgi?id=1794292)

#### [#CVE-2023-29532: Mozilla Maintenance Service Write-lock bypass](#CVE-2023-29532)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

A local attacker can trick the Mozilla Maintenance Service into applying an unsigned update file by pointing the service at an update file on a malicious SMB server. The update file can be replaced after the signature check, before the use, because the write-lock requested by the service does not work on a SMB server.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1806394](https://bugzilla.mozilla.org/show_bug.cgi?id=1806394)

#### [#CVE-2023-29533: Fullscreen notification obscured](#CVE-2023-29533)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A website could have obscured the fullscreen notification by using a combination of `window.open`, fullscreen requests, `window.name` assignments, and `setInterval` calls. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1814597](https://bugzilla.mozilla.org/show_bug.cgi?id=1814597)
* [Bug 1798219](https://bugzilla.mozilla.org/show_bug.cgi?id=1798219)

#### [#CVE-2023-1999: Double-free in libwebp](#CVE-2023-1999)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A double-free in libwebp could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1819244](https://bugzilla.mozilla.org/show_bug.cgi?id=1819244)

#### [#CVE-2023-29535: Potential Memory Corruption following Garbage Collector compaction](#CVE-2023-29535)

Reporter
Lukas Bernhard
Impact
high
##### Description

Following a Garbage Collector compaction, weak maps may have been accessed before they were correctly traced. This resulted in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1820543](https://bugzilla.mozilla.org/show_bug.cgi?id=1820543)

#### [#CVE-2023-29536: Invalid free from JavaScript code](#CVE-2023-29536)

Reporter
zx from qriousec
Impact
high
##### Description

An attacker could cause the memory manager to incorrectly free a pointer that addresses attacker-controlled memory, resulting in an assertion, memory corruption, or a potentially exploitable crash.

##### References

* [Bug 1821959](https://bugzilla.mozilla.org/show_bug.cgi?id=1821959)

#### [#CVE-2023-0547: Revocation status of S/Mime recipient certificates was not checked](#CVE-2023-0547)

Reporter
Paul Menzel
Impact
high
##### Description

OCSP revocation status of recipient certificates was not checked when sending S/Mime encrypted email, and revoked certificates would be accepted. Thunderbird versions from 68 to 102.9.1 were affected by this bug.

##### References

* [Bug 1811298](https://bugzilla.mozilla.org/show_bug.cgi?id=1811298)

#### [#CVE-2023-29479: Hang when processing certain OpenPGP messages](#CVE-2023-29479)

Reporter
Ribose RNP Team
Impact
moderate
##### Description

Certain malformed OpenPGP messages could trigger incorrect parsing of PKESK/SKESK packets due to a bug in the Ribose RNP library used by Thunderbird up to version 102.9.1, which would cause the Thunderbird user interface to hang. The issue was discovered using Google's oss-fuzz.

##### References

* [Bug 1824978](https://bugzilla.mozilla.org/show_bug.cgi?id=1824978)

#### [#CVE-2023-29539: Content-Disposition filename truncation leads to Reflected File Download](#CVE-2023-29539)

Reporter
Trung Pham
Impact
moderate
##### Description

When handling the filename directive in the Content-Disposition header, the filename would be truncated if the filename contained a NULL character. This could have led to reflected file download attacks potentially tricking users to install malware.

##### References

* [Bug 1784348](https://bugzilla.mozilla.org/show_bug.cgi?id=1784348)

#### [#CVE-2023-29541: Files with malicious extensions could have been downloaded unsafely on Linux](#CVE-2023-29541)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Thunderbird did not properly handle downloads of files ending in `.desktop`, which can be interpreted to run attacker-controlled commands.
*This bug only affects Thunderbird for Linux on certain Distributions. Other operating systems are unaffected, and Mozilla is unable to enumerate all affected Linux Distributions.*

##### References

* [Bug 1810191](https://bugzilla.mozilla.org/show_bug.cgi?id=1810191)

#### [#CVE-2023-29542: Bypass of file download extension restrictions](#CVE-2023-29542)

Reporter
Shaheen Fazim and Ameen Basha M K
Impact
moderate
##### Description

A newline in a filename could have been used to bypass the file extension security mechanisms that replace malicious file extensions such as .lnk with .download. This could have led to accidental execution of malicious code.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1815062](https://bugzilla.mozilla.org/show_bug.cgi?id=1815062)
* [Bug 1810793](https://bugzilla.mozilla.org/show_bug.cgi?id=1810793)

#### [#CVE-2023-29545: Windows Save As dialog resolved environment variables](#CVE-2023-29545)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

Similar to CVE-2023-28163, this time when choosing 'Save Link As', suggested filenames containing environment variable names would have resolved those in the context of the current user.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1823077](https://bugzilla.mozilla.org/show_bug.cgi?id=1823077)

#### [#CVE-2023-1945: Memory Corruption in Safe Browsing Code](#CVE-2023-1945)

Reporter
Gabriele Svelto
Impact
moderate
##### Description

Unexpected data returned from the Safe Browsing API could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1777588](https://bugzilla.mozilla.org/show_bug.cgi?id=1777588)

#### [#CVE-2023-29548: Incorrect optimization result on ARM64](#CVE-2023-29548)

Reporter
JunYoung Park
Impact
low
##### Description

A wrong lowering instruction in the ARM64 Ion compiler resulted in a wrong optimization result.

##### References

* [Bug 1822754](https://bugzilla.mozilla.org/show_bug.cgi?id=1822754)

#### [#CVE-2023-29550: Memory safety bugs fixed in Thunderbird 102.10](#CVE-2023-29550)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew Osmond, Sebastian Hengst, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1720594%2C1751945%2C1812498%2C1814217%2C1818357%2C1818762%2C1819493%2C1820389%2C1820602%2C1821448%2C1822413%2C1824828)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from searchfox.org_3d9fe551_20250115_200905.html ===

Find

Case-sensitive

Regexp search

Path

[mozilla-central](/mozilla-central/source/)

Navigation

Enable keyboard shortcuts

This page was generated by Searchfox:
[source code repository](https://github.com/mozsearch/mozsearch) |
[configuration repository](https://github.com/mozsearch/mozsearch-mozilla) |
[see open bugs](https://bugzilla.mozilla.org/buglist.cgi?product=Webtools&component=Searchfox&resolution=---) |
[file a new bug](https://bugzilla.mozilla.org/enter_bug.cgi?product=Webtools&component=Searchfox)


