```json
{
  "vulnerability": {
    "root_cause": "The \"restricted\" mode of the HTML cleaner in XWiki, introduced in version 4.2-milestone-1, only escaped <script> and <style> tags but not attributes that can be used to inject scripts or other dangerous HTML tags like <iframe>.",
    "weaknesses": [
      "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
       "Insufficient filtering of HTML attributes and elements."
    ],
    "impact": "JavaScript injection (cross-site scripting/XSS). A privileged user visiting a page containing malicious code can have it executed in the context of their session, allowing server-side code execution with programming rights, impacting the confidentiality, integrity, and availability of the XWiki instance.",
    "attack_vectors": "By injecting malicious HTML/JavaScript code through user-generated content such as comments.",
        "attacker_capabilities": "Attacker requires the ability to post content that will be rendered and viewed by another user.  The user viewing the rendered content must have programming rights to execute server-side code.",
        "details": "The vulnerability lies in the insufficient sanitization of HTML input when the 'restricted' mode is enabled. This mode failed to filter out attributes (e.g., onclick) and elements (e.g., iframe) that can be used to inject scripts. This vulnerability is present in versions of XWiki from 4.2-milestone-1 up to the patched version, 14.6-rc-1. The vulnerability is exploitable through injecting code into XWiki comments, leading to potential server-side code execution."
  }
}
```