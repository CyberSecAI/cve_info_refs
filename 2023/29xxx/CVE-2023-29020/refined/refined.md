```json
{
  "CVE-2023-29020": {
    "related_content": true,
    "details": {
      "root_cause": "The `@fastify/passport` library does not clear the session object upon authentication, which preserves the `_csrf` attribute between pre-login and authenticated sessions.",
      "weaknesses": [
        "CSRF token fixation",
        "Improper session management"
      ],
      "impact": "Attackers can obtain a CSRF token for a pre-session, fixate that pre-session in the victim's browser via cookie tossing, and then perform a CSRF attack after the victim authenticates. This can lead to unauthorized state-changing requests on the web application.",
       "attack_vectors": [
          "Network attacks",
          "Same-site attacks",
          "Cookie tossing"
      ],
      "attacker_capabilities": "The attacker needs the ability to perform network requests and manipulate cookies.",
      "more_information": "The vulnerability arises due to the combination of `@fastify/csrf-protection` and `@fastify/passport`. `fastify/csrf-protection` stores CSRF tokens in the `_csrf` attribute of a user's session. Because `@fastify/passport` does not clear the session upon authentication, pre-authentication CSRF tokens remain valid. This allows an attacker to fixate a session with a known CSRF token and then perform actions after the user logs in.",
    "fix": "Newer versions of `@fastify/passport` include options to clear the session upon login by default (`clearSessionOnLogin = true`), and to configure fields that should be ignored when clearing the session (`clearSessionIgnoreFields = ['session']`)."
    }
  }
}
```