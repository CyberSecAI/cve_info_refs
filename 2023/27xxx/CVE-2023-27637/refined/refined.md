- **Root cause of vulnerability**: The module `tshirtecommerce` for PrestaShop is vulnerable to SQL injection due to insecure handling of parameters in the `designer.php` file and in the `hookActionCartSave` and `updateCustomizationTable` functions.
- **Weaknesses/vulnerabilities present**:
    - Improper neutralization of SQL parameters leading to SQL injection (CWE-89).
    - Specifically, the `product_id` GET parameter in `designer.php` and the `tshirtecommerce_design_cart_id` GET parameter in `hookActionCartSave` and `updateCustomizationTable` are vulnerable.
- **Impact of exploitation**:
    - Attackers can gain unauthorized access to the database.
    - Attackers can remove data from the associated PrestaShop installation.
    - Attackers can copy/paste data from sensitive tables to the frontend to expose tokens and unlock admin's ajax scripts.
    - Attackers can rewrite SMTP settings to hijack emails.
- **Attack vectors**:
    - HTTP requests with compromised `product_id` GET parameters to `designer.php`.
    - HTTP requests with compromised `tshirtecommerce_design_cart_id` GET parameter to `hookActionCartSave` and `updateCustomizationTable`.
- **Required attacker capabilities/position**:
    - No privileges or user interaction are required, attackers can exploit the vulnerabilities over the network.
    - Attackers can be anonymous users.