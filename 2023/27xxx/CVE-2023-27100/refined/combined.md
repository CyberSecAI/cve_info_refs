=== Content from packetstormsecurity.com_72fd4187_20250114_193242.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from docs.netgate.com_49dace6a_20250114_193243.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
pfSense-SA-23\_05.webgui Security Advisory
pfSense
Topic: Anti-brute force protection bypass
Category: pfSense Base System
Module: webgui
Announced: 2023-02-15
Credits: Fabien MAISONNETTE (Alstom) https://fr.linkedin.com/in/fabdotnet
Affects: pfSense Plus software versions <= 22.05.1
pfSense CE software versions <= 2.6.0
Corrected: 2022-10-18 15:14:51 UTC (pfSense Plus master, 23.01)
2023-01-12 16:12:48 UTC (pfSense Plus 22.05)
2023-01-13 15:24:03 UTC (pfSense Plus 22.05.1)
2022-10-18 15:14:51 UTC (pfSense CE master, 2.7.0)
2023-01-12 16:12:37 UTC (pfSense CE 2.6.0)
0. Revision History
v1.1 2023-06-19 Updated with CE 2.7.0 release information
v1.0 2023-02-15 Initial SA draft
I. Background
pfSense® software is a free network firewall distribution based on the
FreeBSD operating system. The pfSense software distribution includes third-
party free software packages for additional functionality, and provides most of
the functionality of common commercial firewalls.
pfSense® Plus is the productized version of pfSense software from Netgate®,
previously referred to as pfSense Factory Edition (FE). It is available to
Netgate appliance and CSP customers.
The majority of users of pfSense software have never installed or used a stock
FreeBSD system. Unlike similar GNU/Linux-based firewall distributions, there
is no need for any UNIX knowledge. The command line is never used, and there
is no need to ever manually edit any rule sets. Instead, pfSense software
includes a web interface for the configuration of all included components.
Users familiar with commercial firewalls will quickly understand the web
interface, while those unfamiliar with commercial-grade firewalls may encounter
a short learning curve.
II. Problem Description
The authentication system attempts to be informative and print extra information
along with IP addresses to completely identify where a user logs in from when
they login using the GUI. This includes the authentication source (e.g. local
database, LDAP or RADIUS, authentication server name), plus contents of proxy
headers X-Forwarded-For and Client-IP to further clarify the exact user
location.
This extra information is printed after the IP address of the remote user in
various places, including log messages for authentication. In the case of GUI
login failures, the log entries included the contents of the proxy headers
(X-Forwarded-For or Client-IP) submitted by the client.
This extra information confused the sshguard authentication log parser which
made it fail to recognize the client IP address in authentication error
messages.
III. Impact
Login protection managed by sshguard, such as preventing brute force attempts,
may not be enforced depending on the content of the request headers in GUI
authentication attempts, which may allow an attacker to continue GUI login
attempts indefinitely.
IV. Workaround
To help mitigate the problem on older releases, use one or more of the
following:
\* Do not expose the WebGUI service to untrusted networks.
\* Use strong authentication credentials
\* Do not use the default accounts for management
V. Solution
Users can upgrade to pfSense Plus software version 23.01 or later, or pfSense CE
software version 2.7.0 or later. This upgrade may be performed in the web
interface or from the console.
See https://docs.netgate.com/pfsense/en/latest/install/upgrade-guide.html
Users on pfSense Plus version 22.05, pfSense Plus version 22.05.1, and pfSense
CE version 2.6.0 may apply the fix from the recommended patches list in the
System Patches package.
Users may also manually apply the relevant revisions below using the System
Patches package on earlier versions, or by manually making similar changes to
the affected files if the patches do not apply directly.
See https://docs.netgate.com/pfsense/en/latest/development/system-patches.html
VI. Correction details
The following list contains the correction revision commit ID for each
affected item.
Branch/path Revision
- - -------------------------------------------------------------------------
plus/plus-master 9633ec324eada0b870962d3682d264be577edc66
plus/plus-RELENG\_22\_05 6b53dc764a9f3147f7e714b217274447d7ffdeda
plus/plus-RELENG\_22\_05\_01 14c6644326eb55fd4ab3e6ec6fb598031eb4509b
pfSense/master 9633ec324eada0b870962d3682d264be577edc66
pfSense/RELENG\_2\_6\_0 70bfd0fda18012a01547a4eeff17c22c0adf8503
- - -------------------------------------------------------------------------
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE40XvjEU56XSUPIMdE7mH/ZIU+NoFAmSQer0ACgkQE7mH/ZIU
+NoCrQ/+I9vxQLPwpHZlvAaoRk3KSusOVs70eIr8smHAmkWhAdhvtWy+K7+j8tg8
yrx/2bSMi1h8KMpuUfr1/4Wfekv6MsBBgJ/iIuLMWXqXJCeXMjDhdNq0wd2+CYEO
lPXHU+UHAjafYuVqUGrgMaf9h333CfNDV4u6J+R54YzNdX6hT2yAnzKf8m2c42yJ
UIZ8gP2jb2G1M6zvT7jMBqyI12/1DkeE3ihtNa14kG7WT4/F+v+XEH88HyZBt8GJ
wdRv4tG8Pi5HGFgVq1J6Mag6N2TwHwMVREmhxhvynxM4NdOZIFaEq6gNZfazTiDL
Y5pAbyKYZ1pSZHW9aeCdtYLQLuiph5Xc5+H6aWLwY6L2E7K2F+TTa1FGzk4dXFA8
NzH7VrTodIONYGqPS+J8Fdg1Sio2OHSs7Ym5aZzbnF/Z+hmOmhtMLlhisBcQj6GJ
ZYBClRWIQFMJygjHv2Wyf3TTFbXOPV7yxTaLTzWnt7AbNQPCDRSI0lZUy2CMN5+o
9nC4mo2ny9rpr2jl/FcxD+F8ZW9D843tD1czemxMd9Yi2gP4UXr8vz1KiYdPCmPD
0Up4/dDCyr27F1irjLNbAUGhNpcyn9po3Q9s5qjjHFw2GyATf/XRS8fVxa/6k7RD
dkojVGN16oPKZD7+m0Mlzlky626/Dx6qLoLrR/83UsoWx+YjdWY=
=3Orj
-----END PGP SIGNATURE-----


=== Content from redmine.pfsense.org_3203fc82_20250114_193244.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/pfsense/search?scope=subprojects):

 pfSense[All Projects](/projects?jump=issues)
# pfSense

* [Overview](/projects/pfsense)
* [Activity](/projects/pfsense/activity)
* [Roadmap](/projects/pfsense/roadmap)
* [Issues](/projects/pfsense/issues)
* [Gantt](/projects/pfsense/issues/gantt)
* [Calendar](/projects/pfsense/issues/calendar)
* [News](/projects/pfsense/news)
* [Documents](/projects/pfsense/documents)
* [Repository](/projects/pfsense/repository)

### Custom queries

* [2.7.0 - Resolved/Closed](/projects/pfsense/issues?query_id=218)
* [2.7.1 - All Open Issues](/projects/pfsense/issues?query_id=250)
* [2.7.1 - Resolved/Closed](/projects/pfsense/issues?query_id=249)
* [2.7.2 - Resolved/Closed](/projects/pfsense/issues?query_id=254)
* [2.8.0 - All Open Bugs](/projects/pfsense/issues?query_id=164)
* [2.8.0 - All Open Features](/projects/pfsense/issues?query_id=161)
* [2.8.0 - All Open Issues](/projects/pfsense/issues?query_id=165)
* [2.8.0 - All Open Regressions](/projects/pfsense/issues?query_id=108)
* [2.8.0 - Feedback](/projects/pfsense/issues?query_id=105)
* [2.8.0 - Needs Attention](/projects/pfsense/issues?query_id=244)
* [2.8.0 - New/Confirmed](/projects/pfsense/issues?query_id=106)
* [2.8.0 - Pull Requests](/projects/pfsense/issues?query_id=142)
* [2.8.0 - Regressions affecting 2.7.0](/projects/pfsense/issues?query_id=202)
* [2.8.0 - Resolved/Closed](/projects/pfsense/issues?query_id=245)
* [23.01 Plus - All Closed Issues](/projects/pfsense/issues?query_id=224)
* [23.01 Target - All Closed Issues](/projects/pfsense/issues?query_id=223)
* [23.05 Plus - All Closed Issues](/projects/pfsense/issues?query_id=232)
* [23.05 Target - All Closed Issues](/projects/pfsense/issues?query_id=233)
* [23.05.1 Plus - All Closed Issues](/projects/pfsense/issues?query_id=240)
* [23.05.1 Target - All Closed Issues](/projects/pfsense/issues?query_id=239)
* [23.09 Plus - All Closed Issues](/projects/pfsense/issues?query_id=236)
* [23.09 Target - All Closed Issues](/projects/pfsense/issues?query_id=235)
* [23.09.1 Plus - All Closed Issues](/projects/pfsense/issues?query_id=255)
* [23.09.1 Target - All Closed Issues](/projects/pfsense/issues?query_id=257)
* [24.03 Plus - All Closed Issues](/projects/pfsense/issues?query_id=251)
* [24.03 Target - All Closed Issues](/projects/pfsense/issues?query_id=252)
* [24.11 Plus - All Closed Issues](/projects/pfsense/issues?query_id=259)
* [24.11 Target - All Closed Issues](/projects/pfsense/issues?query_id=260)
* [25.03 Plus - All Closed Issues](/projects/pfsense/issues?query_id=262)
* [25.03 Plus - All Open Issues](/projects/pfsense/issues?query_id=263)
* [25.03 Plus - Feedback Issues](/projects/pfsense/issues?query_id=264)
* [25.03 Plus - Needs Attention/Work](/projects/pfsense/issues?query_id=265)
* [25.03 Plus - New/Confirmed/In Progress Issues](/projects/pfsense/issues?query_id=266)
* [25.03 Plus - Pull Request Review](/projects/pfsense/issues?query_id=190)
* [25.03 Plus - Waiting on Merge](/projects/pfsense/issues?query_id=189)
* [25.03 Target - All Closed Issues](/projects/pfsense/issues?query_id=267)
* [25.03 Target - All Open Issues](/projects/pfsense/issues?query_id=268)
* [All Open Issues assigned to Me](/projects/pfsense/issues?query_id=57)
* [All Open Pull Requests](/projects/pfsense/issues?query_id=143)
* [Any Target - All Open Regressions](/projects/pfsense/issues?query_id=170)
* [Any Target - Feedback Issues](/projects/pfsense/issues?query_id=100)
* [CE-Next - All Closed Issues (Move to specific target)](/projects/pfsense/issues?query_id=171)
* [CE-Next - All Open Issues](/projects/pfsense/issues?query_id=167)
* [CE-Next - Feedback (Likely needs target changed)](/projects/pfsense/issues?query_id=181)
* [New Issues by Category - Future Target](/projects/pfsense/issues?query_id=137)
* [New Issues by Category - No Target](/projects/pfsense/issues?query_id=134)
* [New Issues by Category - No Target+Future](/projects/pfsense/issues?query_id=138)
* [No Target - All Open Issues (Base Only)](/projects/pfsense/issues?query_id=34)
* [No Target - New Issues (Base Only)](/projects/pfsense/issues?query_id=33)
* [No Target - New Issues (Base and Packages)](/projects/pfsense/issues?query_id=27)
* [Release Notes - Plus Target Version (DO NOT EDIT)](/projects/pfsense/issues?query_id=191)
* [Release Notes - Target Version (DO NOT EDIT)](/projects/pfsense/issues?query_id=169)

Actions
Copy link
## Bug #13574

closed
![](https://www.gravatar.com/avatar/a2838b99a49c651ce36cd2b4307a50ba?rating=PG&size=50&default=identicon "Author: Jim Pingle")
![](https://www.gravatar.com/avatar/a2838b99a49c651ce36cd2b4307a50ba?rating=PG&size=22&default=identicon "Assignee: Jim Pingle")

### Extra remote address information can confuse ``sshguard``

Added by [Jim Pingle](/users/10) [about 2 years](/projects/pfsense/activity?from=2022-10-18 "10/18/2022 10:09 AM") ago.
Updated [almost 2 years](/projects/pfsense/activity?from=2023-02-15 "02/15/2023 11:21 AM") ago.

Status:ResolvedPriority:HighAssignee:[Jim Pingle](/users/10)Category:AuthenticationTarget version:[2.7.0](/versions/70)Start date:Due date:% Done:

|  |
| --- |

100%

Estimated time:
Plus Target Version:23.01Release Notes:DefaultAffected Version:Affected Architecture:

---

**Description**

The authentication system attempts to be informative and print extra information along with IP addresses to completely identify where a user logs in from. This includes the authentication source (e.g. local database, LDAP or RADIUS, auth server name), contents of proxy headers such as `X-Forwarded-For` or `Client-IP` to further clarify exactly where a user is located.

This extra information is printed after the IP address of the remote user in various places, including log messages for authentication.

The extra information confuses the `sshguard` parser and it fails to recognize the client IP address in authentication error messages, so the protection may not be enforced depending on the content of the request headers.

While this extra information can be helpful, it isn't relevant for authentication failures since (a) the auth source is unknown/undefined as it failed every attempt and (b) since the login failed the rest of the headers shouldn't be trusted anyhow. Thus, we can safely remove it from the error messages.

* [History](/issues/13574?tab=history)
* [Notes](/issues/13574?tab=notes)
* [Property changes](/issues/13574?tab=properties)
* [Associated revisions](/issues/13574?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jim Pingle](/users/10) [about 2 years](/projects/pfsense/activity?from=2022-10-18 "10/18/2022 10:20 AM") ago

* **Status** changed from *In Progress* to *Feedback*
* **% Done** changed from *0* to *100*

Applied in changeset [9633ec324eada0b870962d3682d264be577edc66](/projects/pfsense/repository/2/revisions/9633ec324eada0b870962d3682d264be577edc66 "Omit irrelevant info from auth error. Fixes #13574").

ActionsCopy link
[#2](#note-2)
#### Updated by [Jim Pingle](/users/10) [about 2 years](/projects/pfsense/activity?from=2022-11-22 "11/22/2022 10:13 AM") ago

* **Status** changed from *Feedback* to *Resolved*

The extra information is no longer printed in the log, and sshguard properly recognizes the failed attempts even when the client provides the `X-Forwarded-For` or `Client-IP` headers.

ActionsCopy link
[#3](#note-3)
#### Updated by [Jim Pingle](/users/10) [almost 2 years](/projects/pfsense/activity?from=2023-02-15 "02/15/2023 11:21 AM") ago

* **Private** changed from *Yes* to *No*

Actions
Copy link

Also available in: [Atom](/issues/13574.atom)
[PDF](/issues/13574.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2023 Jean-Philippe Lang

Loading...


