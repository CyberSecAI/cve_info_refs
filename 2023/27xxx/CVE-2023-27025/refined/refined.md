Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability stems from insufficient filtering of user-provided input in the scheduled task functionality of the RuoYi framework. While a blacklist was implemented to prevent certain classes or packages from being used in scheduled tasks, it failed to account for bean conversion. This allowed an attacker to use a bean that was within the allowed package list (`com.ruoyi`) but could be used to access arbitrary files, effectively bypassing the blacklist.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Input Validation:** The primary weakness is inadequate input validation on the `invokeTarget` parameter when creating scheduled tasks. The system only checks the class name after a bean conversion, which allows bypassing the initial blacklist check by using a class in the allowed package to then execute an operation from a blacklisted class, in this case `ruoYiConfig`.
*   **Blacklist Bypass:** The blacklist approach, which is usually less robust, failed to consider the bean conversion process. The system only checked the package name before converting to a bean, leading to the bypass.
*   **Arbitrary File Download:** The `ruoYiConfig.setProfile()` method, when provided with a file path, can be abused to download any file on the server.
*   **Exposed Scheduled Task Functionality:** The scheduled task functionality, which allows defining arbitrary method calls with user-controlled parameters, is inherently risky if not properly secured.

**Impact of Exploitation:**

*   **Arbitrary File Download:** An attacker can download any file from the server that the application user has permission to access. This can lead to the exposure of sensitive data, including configuration files, source code, database credentials, etc.

**Attack Vectors:**

*   **HTTP POST Request:** The attacker sends a POST request to the `/monitor/job/add` endpoint with parameters that define a scheduled task that invokes the `ruoYiConfig.setProfile()` method with a file path controlled by the attacker.
*   **HTTP GET Request:** After creating the malicious task, the attacker issues a GET request to `/common/download/resource` with a crafted `resource` parameter that triggers the download of the file specified in the `setProfile()` method.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker must be logged in as an authenticated user to be able to create scheduled tasks.
*   **Network Access:** The attacker needs network access to the vulnerable application server to send the HTTP requests.
*   **Knowledge of Vulnerable Endpoints:** The attacker must be aware of the vulnerable `/monitor/job/add` and `/common/download/resource` endpoints.

**Technical Details:**

The exploit leverages the following steps:

1.  **Bypass Blacklist:** Create a scheduled task by setting `invokeTarget` to `ruoYiConfig.setProfile('e://xxx/xxxxx.log')`.  The `ruoYiConfig` is within the allowed `com.ruoyi` package.
2.  **Trigger File Download:** After execution of the scheduled task, the `setProfile` method is used to set the profile path, then an attacker can use the `/common/download/resource?resource=Info.xml:.zip` endpoint to download the file specified earlier using the `setProfile` method.

**Additional Notes:**

*   The provided content is more detailed than the typical CVE description. It includes the specific code snippets, the attack vector, and the remediation advice.
*   The vulnerability was reported by "superx" on Gitee.
*   The maintainers of RuoYi addressed the vulnerability with a commit that blocks the usage of `bean` with non-allowed packages.

This analysis provides a clear understanding of the vulnerability and its potential impact.