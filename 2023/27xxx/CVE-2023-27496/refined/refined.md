- **Root cause of vulnerability**: The OAuth filter in Envoy assumes that a `state` query parameter is always present in OAuth redirect responses.
- **Weaknesses/vulnerabilities present**: The vulnerability is a missing check for the presence of the `state` parameter in OAuth redirect responses. Specifically, it results in a null dereference and a segmentation fault when the parameter is missing. This is a CWE-20: Improper Input Validation vulnerability.
- **Impact of exploitation**: A malicious actor can cause a denial of service by sending crafted requests to Envoy, leading to a crash.
- **Attack vectors**: A malicious actor can send a request to Envoy with the URI path matching the OAuth redirect path but without the required `state` parameter.
- **Required attacker capabilities/position**: The attacker needs network access to Envoy with the OAuth filter enabled. No special privileges are required. User interaction is required since an authenticated user needs to click on the malformed link.