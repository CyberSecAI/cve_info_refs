=== Content from security.profileo.com_53df71bd_20250114_220247.html ===


* [Home](/)
* [FAQ](/faq)
* [Advisories](/advisories)
* [CVE](/cve)
* [üá´üá∑](/fr/cve/eo_tags_2023-27569-27570/)
  [üá¨üáß](/cve/eo_tags_2023-27569-27570/)
[![Logo](/images/logo.svg)](https://security.profileo.com/)[![Logo](/images/logo-mobile.svg)](https://security.profileo.com/)

* [Home](/)
* [FAQ](/faq)
* [Advisories](/advisories)
* [CVE](/cve)
[üá´üá∑](/fr/cve/eo_tags_2023-27569-27570/)
[üá¨üáß](/cve/eo_tags_2023-27569-27570/)
# [CVE-2023-27569]-[CVE-2023-27570] Improper neutralization of SQL parameters in Profileo : Tracking et Conversions (eo\_tags) module for PrestaShop

In the module Tracking et Conversions (eo\_tags) prior to version 1.4.19, an anonymous user can perform an SQL injection attack.

## Summary

* **CVE ID**: [CVE-2023-27569](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27569), [CVE-2023-27570](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27570)
* **Published at**: 2023-03-15
* **Advisory source**: security.profileo.com
* **Platform**: PrestaShop
* **Product**: eo\_tags
* **Impacted release**: >= 1.2.0, < 1.4.19 (1.4.19 fixed the vulnerability)
* **Product author**: Profileo
* **Weakness**: [CWE-89](https://cwe.mitre.org/data/definitions/89.html)
* **Severity**: critical (9.8)

## Description

From version 1.2.0 published on Nov 17, 2017 to 1.4.18 published on Feb 21, 2023 (fixed in 1.4.19, published on Feb 28, 2023), an HTTP request can be forged with a compromised `_ga` cookie in order to exploit an insecure parameter in function `saveGanalyticsCookie()` and `gaParseCookie()`, which could lead to a SQL injection.

From version 1.2.0 published on Nov 17, 2017 to 1.2.19 published on Oct 22, 2019 (fixed in 1.3.0), an HTTP request can be forged with a compromised User-Agent or Referer in order to exploit insecure parameters in `trackReferrer()` function, which could lead to a SQL injection. As of 1.2.1, the code has been migrated to classes/EoTagsStats.php (`EoTagsStats::setNewGuest()`) and the vulnerability now requires Privileges (PR) and user interaction (UI) to be exploited, reducing the severity to 8.0.

This exploit uses cookies (and referer) to perform the attack, therefore the module name will be hidden during the exploit, so you won‚Äôt be able to identify this vulnerability in your conventional frontend logs. **You will only see ‚ÄúGET /‚Äù or ‚ÄúPOST /‚Äù inside your conventional frontend logs.**. The compromised referer will be visible in your access logs, however you‚Äôll not be able to see the compromised cookie.

## CVSS base metrics

* **Attack vector**: network
* **Attack complexity**: low
* **Privilege required**: none
* **User interaction**: none
* **Scope**: unchanged
* **Confidentiality**: high
* **Integrity**: high
* **Availability**: high

**Vector string**: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## Possible malicious usage

* Obtain admin access
* Technical and personal data leaks

## Patch

If present in `eo_tags.php`

```
--- a/eo_tags.php
+++ b/eo_tags.php
@@ -1495,8 +1495,8 @@ class Eo_Tags extends Module
                 $old_cid = $this->getAnalyticsCID($this->context->cart->id);
                 $data = array(
                     'id_cart' => $this->context->cart->id,
-                    'cid'     => $cid,
-                    'cookie'  => serialize($_COOKIE['_ga']),
+                    'cid'     => pSQL($cid),
+                    'cookie'  => pSQL(serialize($_COOKIE['_ga'])),
                 );
                 if (!$old_cid) {
                     Db::getInstance()->insert('eo_tags_ga_cookie', $data);

```
```
--- a/eo_tags.php
+++ b/eo_tags.php
@@ -1356,11 +1356,11 @@ class Eo_Tags extends Module
                 ';
                 if ($referral = Db::getInstance()->getRow($sql2)) {
                     $data = array(
-                        'id_guest'     => $cookie->id_guest,
+                        'id_guest'     => (int)$cookie->id_guest,
                         'ip_address'   => $referral['ip_address'],
-                        'http_referer' => $referral['http_referer'],
-                        'request_uri'  => $referral['request_uri'],
-                        'user_agent'   => $user_agent,
+                        'http_referer' => pSQL($referral['http_referer']),
+                        'request_uri'  => pSQL($referral['request_uri']),
+                        'user_agent'   => pSQL($user_agent),
                         'date_add'     => $referral['date_add'],
                     );
                 }
@@ -1397,11 +1397,11 @@ class Eo_Tags extends Module
             $request_uri = substr($request_uri, 0, 255);

             $data = array(
-                'id_guest'     => $cookie->id_guest,
+                'id_guest'     => (int)$cookie->id_guest,
                 'ip_address'   => $ip_address,
-                'http_referer' => $http_referer,
-                'request_uri'  => $request_uri,
-                'user_agent'   => $user_agent,
+                'http_referer' => pSQL($http_referer),
+                'request_uri'  => pSQL($request_uri),
+                'user_agent'   => pSQL($user_agent),
                 'date_add'     => date('Y-m-d H:i:s'),
             );
         }

```

If present in `classes/EoTagsStats.php` `EoTagsStats::setNewGuest()`

```
--- a/classes/EoTagsStats.php
+++ b/classes/EoTagsStats.php
@@ -26,7 +26,7 @@ class EoTagsStats {
         $data = array(
             'id_customer' => $id_customer,
             'ip_address'  => $ip_address,
-            'user_agent'  => $user_agent,
+            'user_agent'  => pSQL($user_agent),
             'date_add'    => date('Y-m-d H:i:s'),
         );

```

Profileo thanks TouchWeb.fr for its help in discovering the vulnerability.
Feel free to contact security/at/profileo.com if you wish to receive a PHP script to automatically detect and patch this vulnerability on your website.

## Other recommendations

* Upgrade PrestaShop to the latest version to disable multiquery executions (separated by ‚Äú;‚Äù) - be warned that this functionality **WILL NOT** protect your SHOP against injection SQL which uses the UNION clause to steal data.
* Change the default database prefix ps\_ by a new longer arbitrary prefix. Nevertheless, be warned that this is useless against blackhats with DBA senior skill because of a design vulnerability in DBMS
* Activate OWASP 942‚Äôs rules on your WAF (Web application firewall), be warned that you will probably break your backoffice and you will need to pre-configure some bypasses against these set of rules.

## Timeline

| Date | Action |
| --- | --- |
| 2023-02-24 | Vulnerability discovered by TouchWeb.fr |
| 2023-02-25 | Vulnerability confirmed by Profileo.com |
| 2023-02-28 | Patch created by Profileo and release of version 1.4.19 fixing the issue |
| 2023-03-01 | Patch released to customers |
| 2023-03-15 | Publication on security.profileo.com |

## Links

* [Profileo.com](https://www.profileo.com/fr/)
* [TouchWeb.fr](https://www.touchweb.fr/)
* [National Vulnerability Database - CVE-2023-27569](https://nvd.nist.gov/vuln/detail/CVE-2023-27569)
* [National Vulnerability Database - CVE-2023-27570](https://nvd.nist.gov/vuln/detail/CVE-2023-27570)

* [www.profileo.com](https://www.profileo.com)



=== Content from profileo.com_b1a6f322_20250114_220245.html ===
     Our solutions  [![7724](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) 7724](https://www.772424.com/en/)   [![Zentria](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Zentria](https://www.profileo.com/en/miscellaneous/47802-zentria.html)   [![Performances](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Performances](https://www.profileo.com/en/28-performance)   [![Security](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Security](https://www.profileo.com/en/30-security)   [Blog](https://www.profileo.com/blog/)   [Contact](https://www.profileo.com/en/contact-us)       Our solutions  [![7724](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) 7724](https://www.772424.com/en/)   [![Zentria](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Zentria](https://www.profileo.com/en/miscellaneous/47802-zentria.html)   [![Performances](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Performances](https://www.profileo.com/en/28-performance)   [![Security](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Security](https://www.profileo.com/en/30-security)   [Blog](https://www.profileo.com/blog/)   [Contact](https://www.profileo.com/en/contact-us)   [0](https://www.profileo.com/en/order "View my shopping cart")     Product successfully added to your shopping cart    **Quantity :**   **Total :**    HT   There are 0 items in your cart.   There is 1 item in your cart.      Continue shopping    [Proceed to checkout](https://www.profileo.com/en/order "Proceed to checkout")    [Sign in](https://www.profileo.com/en/authentication?back=my-account&from_login=1 "Login to your customer account")

* [![fr](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) fr](https://www.profileo.com/fr/ "Fran√ßais (French)")
* [![es](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) es](https://www.profileo.com/es/ "Espa√±ol (Spanish)")
* ![en](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) en

#### Recover your password

 Enter your registered email address   Recover  ![Processing the request](https://www.profileo.com/modules/quickpass/views/img/indicator_bar.gif "Processing the request")  Our solutions  [![7724](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) 7724](https://www.772424.com/en/)   [![Zentria](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Zentria](https://www.profileo.com/en/miscellaneous/47802-zentria.html)   [![Performances](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Performances](https://www.profileo.com/en/28-performance)   [![Security](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Security](https://www.profileo.com/en/30-security)   [Blog](https://www.profileo.com/blog/)   [Contact](https://www.profileo.com/en/contact-us)       Our solutions  [![7724](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) 7724](https://www.772424.com/en/)   [![Zentria](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Zentria](https://www.profileo.com/en/miscellaneous/47802-zentria.html)   [![Performances](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Performances](https://www.profileo.com/en/28-performance)   [![Security](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) Security](https://www.profileo.com/en/30-security)   [Blog](https://www.profileo.com/blog/)   [Contact](https://www.profileo.com/en/contact-us)    [0](https://www.profileo.com/en/order "View my shopping cart")     Product successfully added to your shopping cart    **Quantity :**   **Total :**    HT   There are 0 items in your cart.   There is 1 item in your cart.      Continue shopping    [Proceed to checkout](https://www.profileo.com/en/order "Proceed to checkout")    [Sign in](https://www.profileo.com/en/authentication?back=my-account&from_login=1 "Login to your customer account")

* [![fr](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) fr](https://www.profileo.com/fr/ "Fran√ßais (French)")
* [![es](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) es](https://www.profileo.com/es/ "Espa√±ol (Spanish)")
* ![en](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) en

## Together, Let's Unleash the Power of Your PRESTASHOP!

Optimize your e-commerce with our smart solutions, detecting and suggesting improvements to accelerate your online business.

  [Discover the solutions](https://www.profileo.com/en/#solutions)
# Solutions for e-commerce sites that want to perform

Profileo is an ecosystem of solutions designed for e-merchants and their agencies who want to focus on the development of their core business: selling (a lot) online.

 [![7724](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp)](https://www.772424.com/en/our-offers)
## [7724](https://www.772424.com/en/our-offers)

The reference solution that accelerates, secures, and scales your PrestaShop.

  [I discover](https://www.772424.com/en/our-offers)  [![Zentria](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp)](https://www.profileo.com/en/miscellaneous/47802-zentria.html)
## [Zentria](https://www.profileo.com/en/miscellaneous/47802-zentria.html)

Zentria helps you improve your e-commerce site.

  [I discover](https://www.profileo.com/en/miscellaneous/47802-zentria.html)  [![Performance](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp)](https://www.profileo.com/en/performance/26576-performance-full-pack.html)
## [Performance](https://www.profileo.com/en/performance/26576-performance-full-pack.html)

We speed up the loading time of your PrestaShop!

  [I discover](https://www.profileo.com/en/performance/26576-performance-full-pack.html)  [![Security](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp)](https://www.profileo.com/en/interventions-772424com/965-safety-pack.html)
## [Security](https://www.profileo.com/en/interventions-772424com/965-safety-pack.html)

We clean up in case of hacking or secure your site.

  [I discover](https://www.profileo.com/en/interventions-772424com/965-safety-pack.html)  more than 1200 sites e-merchants

trust our expertise

 Need to boost your growth? Support technique
### Your personal information

### Your needs

   Send  ![](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) ![](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp) ![](https://www.profileo.com/modules/eo_webp/views/img/placeholder.webp)  Subscribe
to our newsletter   Ok  Follow us

* [facebook](https://www.facebook.com/profileo/)
* [twitter](https://twitter.com/profileo)
* [linkedin](https://www.linkedin.com/company/profileo/)
 Liens sur fond blanc

* [Maintenance](https://www.profileo.com/en/prestashop-maintenance)
* [FAQ](https://www.profileo.com/en/content/12-faq-and-operation-of-the-proposed-service)
* [Customer login](https://www.profileo.com/en/authentication?back=my-account)
* [Security](https://security.profileo.com/)
Copyright 2025 - Profileo.com is a trademark of the Profileo group

* [Legal mentions](https://www.profileo.com/en/content/2-legal-notice) -
* [GSC](https://www.profileo.com/en/content/52-terms-of-sales)¬†-
* [Contact us](https://www.profileo.com/en/contact-us)
   Les cookies

By clicking on this button, you accept our terms and conditions.

  [More infos](https://www.profileo.com/en/content/2-legal-notice?acb_cms=1)   Mandatory cookies  Marketing and social cookies Deny all Accept selected

