=== Content from notes.sjtu.edu.cn_a45838df_20250114_181124.html ===


39471 views

# request-baskets SSRF details
## Acknowledgment
\*\*Credit to [@beet1e](https://github.com/b33t1e) from Shanghai Jiao Tong University and [@chenlibo147](chenlibo147@mail.sdu.edu.cn) , [@houqinsheng](houqinsheng@mail.sdu.edu.cn), 202037049@mail.sdu.edu.cn from Shandong University.\*\*
## Vulnerability description
Follow the official documentation to start forem with docker installation.
![](https://notes.sjtu.edu.cn/uploads/upload\_f37294d56f74b588fac26542b22f7624.png)
Then, we log in to the administrator background:
![](https://notes.sjtu.edu.cn/uploads/upload\_4be69f354206903232c07b748e4d1314.png)
The following API's forward\_url parameter is vulnerable to SSRF：
1. /api/baskets/{name}
2. /baskets/{name}
Let's take /api/baskets/{name} API as an example, another API is the same vulnerability.
We use the following payload to post /api/baskets/{name} API：
```
{
"forward\_url": "http://127.0.0.1:80/test",
"proxy\_response": false,
"insecure\_tls": false,
"expand\_path": true,
"capacity": 250
}
```
![](https://notes.sjtu.edu.cn/uploads/upload\_2f8962255d21885cb2c34b95a1baa801.png)
Direct post can only set the url, you need to visit the url - http://192.168.175.213:55555/test to trigger the SSRF vulnerability.
![](https://notes.sjtu.edu.cn/uploads/upload\_8371c9701d7823878b9cc0cb4a6d44b4.png)
# Influence：
\*\*Information Disclosure and Exfiltration\*\*
This was previously identified as an issue. Requests for images that are unauthenticated can lead to the leak of all existing images in the server. However, this isn't limited to just images. Any resource that can be obtained via an HTTP request on the local network of the webserver can be obtained remotely via this request.
\*\*Unauthenticated Access to Internal Network HTTP Servers\*\*
The SSRF attack can be leveraged to connect to any HTTP Server connected to the same network as the request-baskets server, for instance an Nginx server exposed only internally, an internal RESTful API, such as a NoSQL database, or a GraphQL database. This is not limited just to services hosted on the local machine, but all the machines connected on the local network.
\*\*Port and IP Scanning and Enumeration\*\*
This vulnerability can be leveraged to port scan for HTTP servers both internal and external services on demand, as well as enumerating all the machines in the local network that have open HTTP ports.



=== Content from github.com_54366dfe_20250114_181122.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdarklynx%2Frequest-baskets)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdarklynx%2Frequest-baskets)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=darklynx%2Frequest-baskets)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[darklynx](/darklynx)
/
**[request-baskets](/darklynx/request-baskets)**
Public

* [Notifications](/login?return_to=%2Fdarklynx%2Frequest-baskets) You must be signed in to change notification settings
* [Fork
  56](/login?return_to=%2Fdarklynx%2Frequest-baskets)
* [Star
   362](/login?return_to=%2Fdarklynx%2Frequest-baskets)

HTTP requests collector to test webhooks, notifications, REST clients and more ...

[rbaskets.in](https://rbaskets.in "https://rbaskets.in")

### License

[MIT license](/darklynx/request-baskets/blob/master/LICENSE)

[362
stars](/darklynx/request-baskets/stargazers) [56
forks](/darklynx/request-baskets/forks) [Branches](/darklynx/request-baskets/branches) [Tags](/darklynx/request-baskets/tags) [Activity](/darklynx/request-baskets/activity)
 [Star](/login?return_to=%2Fdarklynx%2Frequest-baskets)

 [Notifications](/login?return_to=%2Fdarklynx%2Frequest-baskets) You must be signed in to change notification settings

* [Code](/darklynx/request-baskets)
* [Issues
  11](/darklynx/request-baskets/issues)
* [Pull requests
  8](/darklynx/request-baskets/pulls)
* [Discussions](/darklynx/request-baskets/discussions)
* [Actions](/darklynx/request-baskets/actions)
* [Wiki](/darklynx/request-baskets/wiki)
* [Security](/darklynx/request-baskets/security)
* [Insights](/darklynx/request-baskets/pulse)

Additional navigation options

* [Code](/darklynx/request-baskets)
* [Issues](/darklynx/request-baskets/issues)
* [Pull requests](/darklynx/request-baskets/pulls)
* [Discussions](/darklynx/request-baskets/discussions)
* [Actions](/darklynx/request-baskets/actions)
* [Wiki](/darklynx/request-baskets/wiki)
* [Security](/darklynx/request-baskets/security)
* [Insights](/darklynx/request-baskets/pulse)

# darklynx/request-baskets

    master[Branches](/darklynx/request-baskets/branches)[Tags](/darklynx/request-baskets/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[381 Commits](/darklynx/request-baskets/commits/master/) | | |
| [.github/workflows](/darklynx/request-baskets/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/darklynx/request-baskets/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [doc](/darklynx/request-baskets/tree/master/doc "doc") | | [doc](/darklynx/request-baskets/tree/master/doc "doc") |  |  |
| [docker](/darklynx/request-baskets/tree/master/docker "docker") | | [docker](/darklynx/request-baskets/tree/master/docker "docker") |  |  |
| [scripts](/darklynx/request-baskets/tree/master/scripts "scripts") | | [scripts](/darklynx/request-baskets/tree/master/scripts "scripts") |  |  |
| [web](/darklynx/request-baskets/tree/master/web "web") | | [web](/darklynx/request-baskets/tree/master/web "web") |  |  |
| [.gitignore](/darklynx/request-baskets/blob/master/.gitignore ".gitignore") | | [.gitignore](/darklynx/request-baskets/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/darklynx/request-baskets/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/darklynx/request-baskets/blob/master/.travis.yml ".travis.yml") |  |  |
| [Dockerfile](/darklynx/request-baskets/blob/master/Dockerfile "Dockerfile") | | [Dockerfile](/darklynx/request-baskets/blob/master/Dockerfile "Dockerfile") |  |  |
| [LICENSE](/darklynx/request-baskets/blob/master/LICENSE "LICENSE") | | [LICENSE](/darklynx/request-baskets/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/darklynx/request-baskets/blob/master/README.md "README.md") | | [README.md](/darklynx/request-baskets/blob/master/README.md "README.md") |  |  |
| [baskets.go](/darklynx/request-baskets/blob/master/baskets.go "baskets.go") | | [baskets.go](/darklynx/request-baskets/blob/master/baskets.go "baskets.go") |  |  |
| [baskets\_bolt.go](/darklynx/request-baskets/blob/master/baskets_bolt.go "baskets_bolt.go") | | [baskets\_bolt.go](/darklynx/request-baskets/blob/master/baskets_bolt.go "baskets_bolt.go") |  |  |
| [baskets\_bolt\_test.go](/darklynx/request-baskets/blob/master/baskets_bolt_test.go "baskets_bolt_test.go") | | [baskets\_bolt\_test.go](/darklynx/request-baskets/blob/master/baskets_bolt_test.go "baskets_bolt_test.go") |  |  |
| [baskets\_mem.go](/darklynx/request-baskets/blob/master/baskets_mem.go "baskets_mem.go") | | [baskets\_mem.go](/darklynx/request-baskets/blob/master/baskets_mem.go "baskets_mem.go") |  |  |
| [baskets\_mem\_test.go](/darklynx/request-baskets/blob/master/baskets_mem_test.go "baskets_mem_test.go") | | [baskets\_mem\_test.go](/darklynx/request-baskets/blob/master/baskets_mem_test.go "baskets_mem_test.go") |  |  |
| [baskets\_sql.go](/darklynx/request-baskets/blob/master/baskets_sql.go "baskets_sql.go") | | [baskets\_sql.go](/darklynx/request-baskets/blob/master/baskets_sql.go "baskets_sql.go") |  |  |
| [baskets\_sql\_mysql\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_mysql_test.go "baskets_sql_mysql_test.go") | | [baskets\_sql\_mysql\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_mysql_test.go "baskets_sql_mysql_test.go") |  |  |
| [baskets\_sql\_pg\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_pg_test.go "baskets_sql_pg_test.go") | | [baskets\_sql\_pg\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_pg_test.go "baskets_sql_pg_test.go") |  |  |
| [baskets\_sql\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_test.go "baskets_sql_test.go") | | [baskets\_sql\_test.go](/darklynx/request-baskets/blob/master/baskets_sql_test.go "baskets_sql_test.go") |  |  |
| [baskets\_test.go](/darklynx/request-baskets/blob/master/baskets_test.go "baskets_test.go") | | [baskets\_test.go](/darklynx/request-baskets/blob/master/baskets_test.go "baskets_test.go") |  |  |
| [config.go](/darklynx/request-baskets/blob/master/config.go "config.go") | | [config.go](/darklynx/request-baskets/blob/master/config.go "config.go") |  |  |
| [config\_test.go](/darklynx/request-baskets/blob/master/config_test.go "config_test.go") | | [config\_test.go](/darklynx/request-baskets/blob/master/config_test.go "config_test.go") |  |  |
| [go.mod](/darklynx/request-baskets/blob/master/go.mod "go.mod") | | [go.mod](/darklynx/request-baskets/blob/master/go.mod "go.mod") |  |  |
| [go.sum](/darklynx/request-baskets/blob/master/go.sum "go.sum") | | [go.sum](/darklynx/request-baskets/blob/master/go.sum "go.sum") |  |  |
| [handlers.go](/darklynx/request-baskets/blob/master/handlers.go "handlers.go") | | [handlers.go](/darklynx/request-baskets/blob/master/handlers.go "handlers.go") |  |  |
| [handlers\_test.go](/darklynx/request-baskets/blob/master/handlers_test.go "handlers_test.go") | | [handlers\_test.go](/darklynx/request-baskets/blob/master/handlers_test.go "handlers_test.go") |  |  |
| [main.go](/darklynx/request-baskets/blob/master/main.go "main.go") | | [main.go](/darklynx/request-baskets/blob/master/main.go "main.go") |  |  |
| [server.go](/darklynx/request-baskets/blob/master/server.go "server.go") | | [server.go](/darklynx/request-baskets/blob/master/server.go "server.go") |  |  |
| [server\_test.go](/darklynx/request-baskets/blob/master/server_test.go "server_test.go") | | [server\_test.go](/darklynx/request-baskets/blob/master/server_test.go "server_test.go") |  |  |
| [themes.go](/darklynx/request-baskets/blob/master/themes.go "themes.go") | | [themes.go](/darklynx/request-baskets/blob/master/themes.go "themes.go") |  |  |
| [themes\_test.go](/darklynx/request-baskets/blob/master/themes_test.go "themes_test.go") | | [themes\_test.go](/darklynx/request-baskets/blob/master/themes_test.go "themes_test.go") |  |  |
| [token.go](/darklynx/request-baskets/blob/master/token.go "token.go") | | [token.go](/darklynx/request-baskets/blob/master/token.go "token.go") |  |  |
| [version.go](/darklynx/request-baskets/blob/master/version.go "version.go") | | [version.go](/darklynx/request-baskets/blob/master/version.go "version.go") |  |  |
| [web\_basket.html.go](/darklynx/request-baskets/blob/master/web_basket.html.go "web_basket.html.go") | | [web\_basket.html.go](/darklynx/request-baskets/blob/master/web_basket.html.go "web_basket.html.go") |  |  |
| [web\_baskets.html.go](/darklynx/request-baskets/blob/master/web_baskets.html.go "web_baskets.html.go") | | [web\_baskets.html.go](/darklynx/request-baskets/blob/master/web_baskets.html.go "web_baskets.html.go") |  |  |
| [web\_index.html.go](/darklynx/request-baskets/blob/master/web_index.html.go "web_index.html.go") | | [web\_index.html.go](/darklynx/request-baskets/blob/master/web_index.html.go "web_index.html.go") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# Request Baskets [Build Status](https://travis-ci.org/darklynx/request-baskets) [Coverage Status](https://coveralls.io/github/darklynx/request-baskets?branch=master) [Go Report Card](https://goreportcard.com/report/github.com/darklynx/request-baskets)

[Request Baskets](https://rbaskets.in) is a web service to collect arbitrary HTTP requests and inspect them via RESTful API or simple web UI.

It is strongly inspired by ideas and application design of the [RequestHub](https://github.com/kyledayton/requesthub) project and reproduces functionality offered by [RequestBin](http://requestb.in/) service.

## Table of Contents

* [Introduction](#introduction)
  + [Features](#features)
  + [Screenshots](#screenshots)
* [Install](#install)
  + [Build from source](#build-from-source)
  + [Run docker container](#run-docker-container)
* [Configuration](#configuration)
  + [Parameters](#parameters)
* [Usage](#usage)
  + [Bolt database](#bolt-database)
  + [PostgreSQL database](#postgresql-database)
  + [MySQL database](#mysql-database)
* [Docker](#docker)
  + [Build docker image](#build-docker-image)
  + [Run container as a service](#run-container-as-a-service)
  + [Cleanup](#cleanup)

## Introduction

[Request Baskets](https://rbaskets.in) service is available on our demonstration server: <https://rbaskets.in>

However, we encourage you to set up your own server and keep control over the information passed through and collected by Request Baskets service.

### Features

Distinguishing features of Request Baskets service:

* [RESTful API](/darklynx/request-baskets/blob/master/doc/rbaskets-openapi.yaml) to manage and configure baskets, see [Request Baskets API](https://rbaskets.in/api.html) documentation in interactive mode
* All baskets are protected by **unique** tokens from unauthorized access; end-points to collect requests do not require authorization though
* Individually configurable capacity for every basket
* Pagination support to retrieve collections: basket names, collected requests
* Configurable responses for every HTTP method
* Alternative storage types for configured baskets and collected requests:
  + *In-memory* - ultra fast, but limited to available RAM and collected data is lost after service restart
  + *Bolt DB* - fast persistent storage for collected data based on embedded [bbolt](https://github.com/etcd-io/bbolt) database (maintained fork of [Bolt](https://github.com/boltdb/bolt)), service can be restarted without data loss and storage is not limited by available RAM
  + *SQL database* - classical data storage, multiple instances of service can run simultaneously and collect data in shared data storage, which makes the solution more robust and scaleable ([PostgreSQL](https://www.postgresql.org) and [MySQL](https://www.mysql.com) are only supported at the moment)
  + Can be extended by custom implementations of storage interface

### Screenshots

Basket requests overview:
[![Screenshot of the Request Baskets application showing multiple requests: DELETE, GET and POST. The POST requests shows also the request Body. In this case some JSON.](https://camo.githubusercontent.com/55536cdf2ce7815f3db13d461e62b9d37d55cc68638828a196adf204066921ea/687474703a2f2f692e696d6775722e636f6d2f4e574e745974592e706e67)](https://camo.githubusercontent.com/55536cdf2ce7815f3db13d461e62b9d37d55cc68638828a196adf204066921ea/687474703a2f2f692e696d6775722e636f6d2f4e574e745974592e706e67)

Configuration of basket responses:
[![Screenshot of the Request Baskets application showing the possibility how a response can be created for a specific HTTP Method and location. The sample Body is a JSON example.](https://camo.githubusercontent.com/31dab99901c26fb5b815156126f8cbc0220f0122328ebf9eb5bce3f384aecf86/687474703a2f2f692e696d6775722e636f6d2f6f6f55644269622e706e67)](https://camo.githubusercontent.com/31dab99901c26fb5b815156126f8cbc0220f0122328ebf9eb5bce3f384aecf86/687474703a2f2f692e696d6775722e636f6d2f6f6f55644269622e706e67)

## Install

### Build from source

Build latest:

```
$ go get github.com/darklynx/request-baskets
```

Run:

```
$ export PATH=$PATH:$GOPATH/bin
$ request-baskets
```

### Run docker container

```
$ docker pull darklynx/request-baskets
$ docker run -p 55555:55555 darklynx/request-baskets

```

## Configuration

Request Baskets service supports several command line configuration parameters. Use `-h` or `--help` to print command line help:

```
$ request-baskets --help
Usage of bin/request-baskets:
  -db string
      Baskets storage type: "mem" - in-memory, "bolt" - Bolt DB, "sql" - SQL database (default "mem")
  -file string
      Database location, only applicable for file or SQL databases (default "./baskets.db")
  -conn string
      Database connection string for SQL databases, if undefined "file" argument is considered
  -l string
      HTTP listen address (default "127.0.0.1")
  -p int
      HTTP service port (default 55555)
  -page int
      Default page size (default 20)
  -size int
      Initial basket size (capacity) (default 200)
  -maxsize int
      Maximum allowed basket size (max capacity) (default 2000)
  -token string
      Master token, random token is generated if not provided
  -basket value
      Name of a basket to auto-create during service startup (can be specified multiple times)
  -prefix string
      Service URL path prefix
  -mode string
      Service mode: "public" - any visitor can create a new basket, "restricted" - baskets creation requires master token (default "public")
  -theme string
      CSS theme for web UI, supported values: standard, adaptive, flatly (default "standard")

```

### Parameters

List of command line parameters with corresponding ENVVAR for [docker container](/darklynx/request-baskets/blob/master/docker/entrypoint.sh):

* `-p` *port* (`PORT`) - HTTP service listener port, default value is `55555`
* `-l` *IP address* (`LISTEN`) - HTTP listener IP address, default `127.0.0.1` (docker default: `0.0.0.0`)
* `-page` *size* (`PAGE`) - default page size when retrieving collections
* `-size` *size* (`SIZE`) - default new basket capacity, applied if basket capacity is not provided during creation
* `-maxsize` *size* (`MAXSIZE`) - maximum allowed basket capacity, basket capacity greater than this number will be rejected by service
* `-token` *token* (`TOKEN`) - master token to gain control over all baskets, if not defined a random token will be generated when service is launched and printed to *stdout*
* `-db` *type* (`DB`) - defines baskets storage type: `mem` - in-memory storage (default), `bolt` - [bbolt](https://github.com/etcd-io/bbolt) database (docker default), `sql` - SQL database
* `-file` *location* (`FILE`) - location of Bolt database file, only relevant if appropriate storage type is chosen
* `-conn` *connection* (`CONN`) - database connection string for SQL databases, if undefined `-file` argument is considered
* `-basket` *value* (`BASKET`) - name of a basket to auto-create during service startup, this parameter can be specified multiple times
* `-prefix` *URL path prefix* (`PATHPREFIX`) - allows to host API and web-UI of baskets service under a sub-path instead of domain ROOT
* `-mode` *mode* (`MODE`) - defines service operation mode: `public` - when any visitor can create a new basket, or `restricted` - baskets creation requires master token
* `-theme` *theme* (`THEME`) - CSS theme for web UI, supported values: `standard`, `adaptive`, `flatly`

## Usage

Open <http://localhost:55555> in your browser. The main page will display a list of baskets that may be accessed if the basket *token* is known. It is possible to create a new basket if the name is not in use.

If basket was successfully created the authorization *token* is displayed. It is **important** to remember the *token* because it authorizes the access to management features of created basket and allows to retrieve collected HTTP requests. The token is temporary stored in browser session to simplify UI integration and improve user experience. However, once browser tab is closed, the token will be lost.

To collect HTTP requests send them (GET, POST, PUT, DELETE, etc.) to `http://localhost:55555/<basket_name>`

To view collected requests and manage basket:

* Open basket web UI `http://localhost:55555/web/<basket_name>`
* Use [RESTful API](https://github.com/darklynx/request-baskets/blob/master/doc/rbaskets-openapi.yaml) exposed at `http://localhost:55555/api/baskets/<basket_name>/...`

It is possible to forward all incoming HTTP requests to arbitrary URL by configuring basket via web UI or RESTful API.

### Bolt database

By default Request Baskets service keeps configured baskets and collected HTTP requests in memory. This data is lost after service or server restart. However a service can be configured to store collected data on file system. In this case the service can be restarted without loosing created baskets and collected data.

To start service in persistent mode simply configure the appropriate storage type, such as [bbolt database](https://github.com/etcd-io/bbolt) (maintained fork of [Bolt](https://github.com/boltdb/bolt)):

```
$ request-baskets -db bolt -file /var/lib/request-baskets/baskets.db
2016/01/08 23:15:28 [info] generated master token: abcdefgh1234567...
2016/01/08 23:15:28 [info] using Bolt database to store baskets
2016/01/08 23:15:28 [info] Bolt database location: /var/lib/rbaskets/baskets.db
2016/01/08 23:15:28 [info] starting HTTP server on port: 55555
...
```

Any other kind of storages or databases (e.g. MySQL, MongoDb) to keep collected data can be introduced by implementing following interfaces: `BasketsDatabase` and `Basket`

### PostgreSQL database

The first attempt to implement SQL database storage for Request Baskets service is now available for evaluation. Even though the logic to organize the data within SQL database is written in the generic SQL dialect, the code make use of parametrized SQL queries that unfortunately do not have standard to express [parameter placeholders](http://go-database-sql.org/prepared.html#parameter-placeholder-syntax) across different databases.

Current implementation is based on PostgreSQL syntax. So running Request Baskets service with [PostgreSQL database](https://www.postgresql.org) as a storage is fully supported.

Use following example to start the Request Baskets service with PostgreSQL database:

```
$ request-baskets -db sql -conn "postgres://rbaskets:pwd@localhost/baskets?sslmode=disable"
2018/01/25 01:06:25 [info] generated master token: mSEAcYvpDlg...
2018/01/25 01:06:25 [info] using SQL database to store baskets
2018/01/25 01:06:25 [info] SQL database type: postgres
2018/01/25 01:06:25 [info] creating database schema
2018/01/25 01:06:25 [info] database is created, version: 1
2018/01/25 01:06:25 [info] HTTP server is listening on 127.0.0.1:55555
...
```

The documentation of [Go driver for PostgreSQL](https://godoc.org/github.com/lib/pq) provides detailed description of connection string and its parameters.

If no configured instance of PostgreSQL server is available to test the Request Baskets service with, there is a quick way to launch one using Docker with following command:

```
$ docker run --rm --name pg_baskets -e POSTGRES_USER=rbaskets -e POSTGRES_PASSWORD=pwd \
    -e POSTGRES_DB=baskets -d -p 5432:5432 postgres

# following command will stop and destroy the instance of PostgreSQL container
$ docker stop pg_baskets
```

### MySQL database

Added driver and application support within the SQL basket database for [MySQL](https://www.mysql.com) (or [MariaDB](https://mariadb.org)) database.

Use following example to start the Request Baskets service with MySQL database:

```
$ request-baskets -db sql -conn "mysql://rbaskets:pwd@/baskets"
2018/01/28 23:39:59 [info] generated master token: aPgyuLxw723q...
2018/01/28 23:39:59 [info] using SQL database to store baskets
2018/01/28 23:39:59 [info] SQL database type: mysql
2018/01/28 23:39:59 [info] creating database schema
2018/01/28 23:39:59 [info] database is created, version: 1
2018/01/28 23:39:59 [info] HTTP server is listening on 127.0.0.1:55555
...
```

The documentation of [Go driver for MySQL](https://github.com/go-sql-driver/mysql#usage) provides detailed description of connection string and its parameters.

If no configured instance of MySQL server is available to test the Request Baskets service with, there is a quick way to launch one using Docker with following command:

```
$ docker run --rm --name mysql_baskets -e MYSQL_USER=rbaskets -e MYSQL_PASSWORD=pwd \
    -e MYSQL_DATABASE=baskets -e MYSQL_RANDOM_ROOT_PASSWORD=yes -d -p 3306:3306 mysql

# following command will stop and destroy the instance of MySQL container
$ docker stop mysql_baskets
```

## Docker

### Build docker image

```
$ docker build -t request-baskets .
```

This will create a docker image using [multi-stage docker builds](https://docs.docker.com/develop/develop-images/multistage-build/) approach with 2 stages: compiling the service and packaging the result to a tiny alpine container. The resulting size of built image is ~12 Mb.

Note: since the first stage is using `golang:latest` container to build the service executable, there is no need to have Go lang SDK installed on the machine where process of building the container is taking place.

See [docker folder](/darklynx/request-baskets/blob/master/docker) for alternative docker builds with detailed explanation of the process for every variant.

### Run container as a service

```
$ docker run --name rbaskets -d -p 55555:55555 request-baskets
$ docker logs rbaskets
```

### Cleanup

Stop and delete docker container:

```
$ docker stop rbaskets
$ docker rm rbaskets
```

Delete docker image:

```
$ docker rmi request-baskets
```

## About

HTTP requests collector to test webhooks, notifications, REST clients and more ...

[rbaskets.in](https://rbaskets.in "https://rbaskets.in")

### Topics

[testing](/topics/testing "Topic: testing")
[webhooks](/topics/webhooks "Topic: webhooks")
[qa](/topics/qa "Topic: qa")
[rest](/topics/rest "Topic: rest")
[rest-api](/topics/rest-api "Topic: rest-api")
[restful](/topics/restful "Topic: restful")
[test-automation](/topics/test-automation "Topic: test-automation")
[http-requests](/topics/http-requests "Topic: http-requests")
[testing-tools](/topics/testing-tools "Topic: testing-tools")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/darklynx/request-baskets/activity)
### Stars

[**362**
stars](/darklynx/request-baskets/stargazers)
### Watchers

[**4**
watching](/darklynx/request-baskets/watchers)
### Forks

[**56**
forks](/darklynx/request-baskets/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fdarklynx%2Frequest-baskets&report=darklynx+%28user%29)

## [Releases 9](/darklynx/request-baskets/releases)

[v1.2.3
Latest

May 1, 2023](/darklynx/request-baskets/releases/tag/v1.2.3)
[+ 8 releases](/darklynx/request-baskets/releases)

## [Packages 0](/users/darklynx/packages?repo_name=request-baskets)

No packages published

## [Contributors 6](/darklynx/request-baskets/graphs/contributors)

## Languages

* [Go
  82.7%](/darklynx/request-baskets/search?l=go)
* [HTML
  15.8%](/darklynx/request-baskets/search?l=html)
* Other
  1.5%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_337e6851_20250114_181121.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@b33t1e](https://avatars.githubusercontent.com/u/33768821?s=64&v=4)](/b33t1e)

# [b33t1e](/b33t1e)/**[CVE-2023-27163](/b33t1e/3079c10c88cad379fb166c389ce3b7b3)**

Created
March 30, 2023 02:59

Show Gist options

* [Download ZIP](/b33t1e/3079c10c88cad379fb166c389ce3b7b3/archive/17104014e1b3521bf0f782d4842fefde17e3f199.zip)

* [Star
  (2)
  2](/login?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/b33t1e/3079c10c88cad379fb166c389ce3b7b3.js&quot;&gt;&lt;/script&gt;
* Save b33t1e/3079c10c88cad379fb166c389ce3b7b3 to your computer and use it in GitHub Desktop.

[Code](/b33t1e/3079c10c88cad379fb166c389ce3b7b3)
[Revisions
1](/b33t1e/3079c10c88cad379fb166c389ce3b7b3/revisions)
[Stars
2](/b33t1e/3079c10c88cad379fb166c389ce3b7b3/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/b33t1e/3079c10c88cad379fb166c389ce3b7b3.js&quot;&gt;&lt;/script&gt;

Save b33t1e/3079c10c88cad379fb166c389ce3b7b3 to your computer and use it in GitHub Desktop.

[Download ZIP](/b33t1e/3079c10c88cad379fb166c389ce3b7b3/archive/17104014e1b3521bf0f782d4842fefde17e3f199.zip)

 [Raw](/b33t1e/3079c10c88cad379fb166c389ce3b7b3/raw/17104014e1b3521bf0f782d4842fefde17e3f199/CVE-2023-27163)

[**CVE-2023-27163**](#file-cve-2023-27163)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [description] |
| --- | --- |
|  | request-baskets up to v1.2.1 was discovered to contain a Server-Side |
|  | Request Forgery (SSRF) via the component /api/baskets/{name}. This |
|  | vulnerability allows attackers to access network resources and |
|  | sensitive information via a crafted API request. |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [VulnerabilityType Other] |
|  | Server-Side Request Forgery (SSRF) |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Vendor of Product] |
|  | https://github.com/darklynx/request-baskets |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Affected Product Code Base] |
|  | request-baskets - <= Version 1.2.1 |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Affected Component] |
|  | The API endpoints /api/baskets/{name}, /baskets/{name} are vulnerable to unauthenticated Server-Side Request Forgery (SSRF) attacks via the forward\_url parameter. |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Attack Type] |
|  | Remote |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Impact Escalation of Privileges] |
|  | true |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Impact Information Disclosure] |
|  | true |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Attack Vectors] |
|  | POC: POST /api/baskets/{name} API with payload - {"forward\_url": "http://127.0.0.1:80/test","proxy\_response": false,"insecure\_tls": false,"expand\_path": true,"capacity": 250} |
|  | details can be seen: https://notes.sjtu.edu.cn/s/MUUhEymt7 |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Discoverer] |
|  | beet1e |
|  | > |
|  | ------------------------------------------ |
|  | > |
|  | [Reference] |
|  | http://request-baskets.com |
|  | https://github.com/darklynx/request-baskets |
|  | https://notes.sjtu.edu.cn/s/MUUhEymt7 |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fb33t1e%2F3079c10c88cad379fb166c389ce3b7b3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_dd7ffeeb_20250114_181119.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_0907f872_20250114_181120.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


