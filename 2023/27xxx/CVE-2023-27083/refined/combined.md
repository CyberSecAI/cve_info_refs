=== Content from medium.com_affe5ac3_20250114_231658.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc309ac1bd145&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40syed.pentester%2Fauthenticated-remote-code-execution-rce-on-pluckcms-4-7-15-c309ac1bd145&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40syed.pentester%2Fauthenticated-remote-code-execution-rce-on-pluckcms-4-7-15-c309ac1bd145&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Authenticated Remote Code Execution (RCE) on PluckCMS - 4.7.15

[![syed](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*eIsh1bDBmLMJHQV4)](/%40syed.pentester?source=post_page---byline--c309ac1bd145--------------------------------)

[syed](/%40syed.pentester?source=post_page---byline--c309ac1bd145--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11aa8ab23cc7&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40syed.pentester%2Fauthenticated-remote-code-execution-rce-on-pluckcms-4-7-15-c309ac1bd145&user=syed&userId=11aa8ab23cc7&source=post_page-11aa8ab23cc7--byline--c309ac1bd145---------------------post_header-----------)

3 min read·Jun 6, 2023

--

Listen

Share

# Description:

Found authenticated Remote Code Execution (RCE) on pluck 4.7.15.

# Affected Endpoint:

<http://192.168.0.211/admin.php?action=files>

# **Evidence:**

While reading the source code, I found blacklisted extension are mentioned in the file (data/inc/files.php) at line 44 and 45.

File upload function validating the file extension is match any one of the following extension (.php, php3, php4, php5, php6, php7, phtml, .phtm, .pht, .ph3, .ph4, .ph5, .asp, .cgi, .phar). If the extension matched then renaming the file with .txt extension at end.

![]()

And there is **.htaccess** file in files directory (upload file directory) where php\_flag engine is disabled. So we can’t ale to execute the file in this directory

![]()

For successful exploitation we required to upload web shell without the aforementioned extension and the file should not be in **files** directory.

So I created a simple webshell with “**.inc**” extension and upload the file.

Login to the admin account. Use the following URL (<http://192.168.0.211/admin.php?action=files>) or navigate to pages -> manage files.

![]()

Upload the webshell with “**.inc**” extension.

![]()

We already know there is no restriction for file upload if the file extension is aforementioned extension then it will renamed the file. So anyway our webshell is uploaded.

![]()

Try to execute the uploaded .inc file, as guessed our file is not executed.

![]()

Now we need to move the file to some other directory. While analysing I found that trash directory doesn’t have any validation.

![]()

So deleting the file will move webshell to trash directory. So we can able to execute from trash directory.

![]()

Once the file is deleted then navigate to the following directory (http://192.168.0.211/data/trash/files/<fileName>) to execute our web shell.

![]()![]()

Our web shell executing successfully.

This was fixed on PluckCMS - 4.7.16

# **Recommendation:**

* Instead of blacklisting the extension use whitelisted extension
* Remote execution permission from trash directory also.

# **WebShell Used:**

<?php

if (isset($\_GET[‘d’])) {

eval(passthru($\_GET[‘d’]));

};

--

--

[![syed](https://miro.medium.com/v2/resize:fill:96:96/0*eIsh1bDBmLMJHQV4)](/%40syed.pentester?source=post_page---post_author_info--c309ac1bd145--------------------------------)[![syed](https://miro.medium.com/v2/resize:fill:128:128/0*eIsh1bDBmLMJHQV4)](/%40syed.pentester?source=post_page---post_author_info--c309ac1bd145--------------------------------)Follow[## Written by syed](/%40syed.pentester?source=post_page---post_author_info--c309ac1bd145--------------------------------)0 Followers·[1 Following](/%40syed.pentester/following?source=post_page---post_author_info--c309ac1bd145--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c309ac1bd145--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c309ac1bd145--------------------------------)[About](/about?autoplay=1&source=post_page-----c309ac1bd145--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c309ac1bd145--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c309ac1bd145--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c309ac1bd145--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c309ac1bd145--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c309ac1bd145--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c309ac1bd145--------------------------------)[Teams](/business?source=post_page-----c309ac1bd145--------------------------------)


