=== Content from www.us-cert.gov_3d8497f8_20250114_201418.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Omron PLC CJ and CS Series (Update B)

Last RevisedApril 18, 2023
Alert CodeICSA-19-346-02

## 1. EXECUTIVE SUMMARY

* **CVSS v3 8.6**
* **ATTENTION**: Exploitable remotely/low skill level to exploit
* **Vendor**: Omron
* **Equipment**: PLC CJ and CS Series
* **Vulnerabilities**: Authentication Bypass by Spoofing, Authentication Bypass by Capture-replay, Unrestricted Externally Accessible Lock

## 2. UPDATE

This updated advisory is a follow-up to the original advisory titled ICSA-19-346-02 Omron PLC CJ and CS Series (Update A) published November 29, 2022, on the ICS webpage at cisa.gov.

## 3. RISK EVALUATION

Successful exploitation of these vulnerabilities could allow an attacker to pose as an authorized user to obtain the status information of the PLC.

## 4. TECHNICAL DETAILS

### 4.1 AFFECTED PRODUCTS

The following versions of Omron Programmable Logic Controllers are affected:

* Omron PLC CJ series, all versions
* Omron PLC CS series, all versions
* Omron PLC NX1P2 series, all versions

### 4.2 VULNERABILITY OVERVIEW

**4.2.1    [AUTHENTICATION BYPASS BY SPOOFING CWE-290](https://cwe.mitre.org/data/definitions/290.html)**

An attacker could spoof arbitrary messages or execute commands.

[CVE-2019-18259](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-18259) has been assigned to this vulnerability. A CVSS v3 base score of 5.6 has been calculated; the CVSS vector string is ([AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L)).

**4.2.2    [AUTHENTICATION BYPASS BY CAPTURE-REPLAY CWE-294](https://cwe.mitre.org/data/definitions/294.html)**

An attacker could monitor traffic between the PLC and the controller, and replay requests that could result in the opening and closing of industrial valves.

[CVE-2019-13533](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-13533) has been assigned to this vulnerability. A CVSS v3 base score of 8.1 has been calculated; the CVSS vector string is ([AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:H)).

**--------- Begin Update B Part 1 of 1 ---------**

**4.2.3 [UNRESTRICTED EXTERNALLY ACCESSIBLE LOCK CWE-412](https://cwe.mitre.org/data/definitions/412.html)**

Omron’s CS and CJ series PLCs have an unrestricted externally accessible lock vulnerability.

[CVE-2019-18269](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2019-18269) has been assigned to this vulnerability. A CVSS v3 base score of 8.6 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H)).

**--------- End Update B Part 1 of 1 ---------**

### 4.3 BACKGROUND

* **CRITICAL INFRASTRUCTURE SECTORS**: Critical Manufacturing
* **COUNTRIES/AREAS DEPLOYED**: Worldwide
* **COMPANY HEADQUARTERS LOCATION**: Japan

### 4.4 RESEARCHER

Jipeng You (XDU) and n0b0dy reported these vulnerabilities to CISA.

## 5. MITIGATIONS

Omron recommends the following mitigation measures:

* Filter FINS port: Protect access to Omron’s PLC with a firewall and blocking unnecessary remote access to FINS port (default: 9600).
* Filter IP addresses: Protect access to Omron’s PLC with a firewall and filtering devices connected to the PLC by IP address.

For more information provided by Omron on these vulnerabilities refer to [Vulnerabilities in Omron CS and CJ series CPU PLCs](https://gcc01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.omron-cxone.com%2Fsecurity%2F2019-12-06_PLC_EN.pdf&data=02%7C01%7Ckent.norris%40inl.gov%7C20bf150382654ea6bed508d77a33e9d1%7C4cf464b7869a42368da2a98566485554%7C0%7C1%7C637112235716101466&sdata=HF291pOMe65LwSvq4DynQqT%2FX7Sw%2BT92JGwRsXmC7WU%3D&reserved=0).

CISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:

* Minimize network exposure for all control system devices and/or systems, and ensure that they are [not accessible from the Internet](https://www.us-cert.gov/ics/alerts/ICS-ALERT-10-301-01).
* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.
* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.

CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

CISA also provides a section for [control systems security recommended practices](https://www.us-cert.gov/ics/recommended-practices) on the ICS webpage on [us-cert.gov](https://www.us-cert.gov/ics). Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies](https://www.us-cert.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf).

Additional mitigation guidance and recommended practices are publicly available on the [ICS webpage on us-cert.gov](https://www.us-cert.gov/ics) in the Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](https://www.us-cert.gov/ics/tips/ICS-TIP-12-146-01B).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.

No known public exploits specifically target these vulnerabilities.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-19-346-02); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from www.us-cert.gov_e6ff2fb5_20250114_201420.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Omron PLC CJ Series

Last RevisedMarch 03, 2020
Alert CodeICSA-20-063-03

## 1. EXECUTIVE SUMMARY

* **CVSS v3 7.5**
* ATTENTION: Exploitable remotely/low skill level to exploit
* Vendor: Omron
* Equipment: PLC CJ Series
* Vulnerability: Uncontrolled Resource Consumption

## 2. RISK EVALUATION

Successful exploitation of this vulnerability could cause a denial-of-service condition.

## 3. TECHNICAL DETAILS

### 3.1 AFFECTED PRODUCTS

The following versions of Omron programmable logic controllers are affected:

* Omron PLC CJ series, all versions

### 3.2 VULNERABILITY OVERVIEW

#### 3.2.1    [UNCONTROLLED RESOURCE CONSUMPTION CWE-400](https://cwe.mitre.org/data/definitions/400.html)

An attacker can send a series of specific data packets within a short period, causing a service error on the PLC Ethernet module, which in turn causes a PLC service denied result.

[CVE-2020-6986](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-6986) has been assigned to this vulnerability. A CVSS v3 base score of 7.5 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)).

### 3.3 BACKGROUND

* **CRITICAL INFRASTRUCTURE SECTORS:** Critical Manufacturing
* **COUNTRIES/AREAS DEPLOYED:** Worldwide
* **COMPANY HEADQUARTERS LOCATION:** Japan

### 3.4 RESEARCHER

Jipeng You (XDU) reported this vulnerability to CISA.

## 4. MITIGATIONS

Omron recommends the following mitigation measures:

* Filter FINS port: Protect access to Omron’s PLC with a firewall and by blocking unnecessary remote access to FINS port (default: 9600).
* Filter IP addresses: Protect access to Omron’s PLC with a firewall and filtering devices connected to the PLC by IP address.

For more information on Omron PLC CJ Series vulnerabilities, refer to [Vulnerabilities in Omron CJ series CPU PLCs](http://www.omron-cxone.com/security/2020-02-28_PLC_EN.pdf).

CISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:

* Minimize network exposure for all control system devices and/or systems, and ensure that they are [not accessible from the Internet](https://www.us-cert.gov/ics/alerts/ICS-ALERT-10-301-01).
* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.
* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.

CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

CISA also provides a section for [control systems security recommended practices](https://www.us-cert.gov/ics/recommended-practices) on the ICS webpage on [us-cert.gov](https://www.us-cert.gov/ics). Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies](https://www.us-cert.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf).

Additional mitigation guidance and recommended practices are publicly available on the [ICS webpage on us-cert.gov](https://www.us-cert.gov/ics) in the Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](https://www.us-cert.gov/ics/tips/ICS-TIP-12-146-01B).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.

No known public exploits specifically target this vulnerability.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Vendor

* Omron

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-20-063-03); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from www.fa.omron.co.jp_9003b184_20250114_201413.html ===
複数のオムロン製品に実装されている

FINS プロトコルにおける既知の問題について

公開日 2023 年 4 月 17 日

最終更新日 2023 年 9 月 19 日

オムロン株式会社

■概要

FINS(Factory Interface Network Service)は、オムロン社製品で構成された FA ネットワークで使用される

メッセージ通信のプロトコルです。オムロン社のプログラマブルコントローラ(PLC)には、FINS プロトコルの仕様に起因す

る既知の問題が報告されています。

■影響を受ける代表的な機器

⚫  プログラマブルコントローラ  CS シリーズ  CPU ユニット  全バージョン

⚫  プログラマブルコントローラ CJ シリーズ  CPU ユニット  全バージョン

⚫  プログラマブルコントローラ CP シリーズ  CPU ユニット  全バージョン

⚫  マシンオートメーションコントローラ NJ シリーズ  CPU ユニット  全バージョン

⚫  マシンオートメーションコントローラ NX1P シリーズ  CPU ユニット  全バージョン

⚫  マシンオートメーションコントローラ NX102 シリーズ  CPU ユニット  全バージョン

⚫  マシンオートメーションコントローラ NX7 データベース接続 CPU ユニット  全バージョン

■詳細情報

FINS プロトコルは、オムロン社製の PLC や PC ソフトウェアなど、FA(Factory Automation)ネットワークの制御

用途として開発された、軽量かつシンプルな通信プロトコルです。FINS プロトコルは、コマンド・レスポンス方式のメッセ

ージで通信を行い、FA 制御システムのモニタ・操作・設定をすることができます。

FINS  コマンドには、各種のコマンドが用意されおり、大別して、以下の種類があります。

・I/O  メモリエリアの読み出し/書き込み

・パラメータエリアの読み出し/書き込み

・プログラムエリアの読み出し/書き込み

・動作モード変更

・機器構成の読み出し

・CPU  ユニットのステータスの読み出し

・時間情報のアクセス

・メッセージの読み出し/解除

・アクセス権の獲得・開放

・異常履歴の読み出しなど

・ファイル操作

・強制セット/リセット

これらの情報は、マニュアル等で公開されており、仕様が開示されています。機種により、サポートする FINS コマンド

は異なります。

FINS コマンドのメッセージは、「FINS ヘッダ」「FINS コマンドコード」「パラメータ」の３つから構成されています。

FINS コマンドメッセージを受信した制御機器/ソフトウェアは、その「FINS コマンドコード」に対応する処理を実行し、

その処理結果を FINS レスポンスメッセージとして、「FINS ヘッダ」にある送信元へ返信します。

FINS のプロトコル設計当時、FA ネットワークは工場やライン・装置に閉じたローカルネットワークであることを前提と

していました。そのため、FA ネットワークがオープンネットワーク化した現在では、FINS 仕様に対して、いくつかの脆弱

性が指摘されています。

１．  平文通信

FINS プロトコル仕様では、暗号化通信を規定していません。よって、通信経路上の FINS メッセージは平文

で送受信されるため、容易に傍受することができます。また、FINS メッセージの改ざんを検知することが出来ま

せん。

・  機微な情報の平文通信（CWE-319）

・  データの信頼性についての不十分な検証（CWE-345）

２．  認証不要

FINS プロトコル仕様では、認証処理は規定していません。よって、悪意ある通信相手からの攻撃であることを

識別することはできません

・  なりすましによる認証回避  (CWE-290)

・  Capture-replay  攻撃による認証回避  (CWE-294)

・  重要な機能に対する認証の欠如  (CWE-306)

・  データの信頼性についての不十分な検証（CWE-345）

・  サービス運用妨害  (DoS)  の脆弱性  (CWE-400)

・  外部からの操作制限不備  (CWE-412)

・  インタラクション頻度の不適切な制御  (CWE-799)

これらの脆弱性は、FINS プロトコルの仕様に起因しますが、仕様改訂の予定はありません。

■想定される影響

第三者によって、通信内容が搾取されることや、不正な制御コマンド実行、制御システム情報への不正アクセス等

が行われる可能性があります。

■対策方法

本脆弱性の悪用リスクを最小限に抑えるため、以下に示す軽減策を講じることを推奨します。

1.FINS を使用しない(FINS を無効化する)

FINS を使用していない FA ネットワークの場合、以下の機種では FINS を無効化することで、FINS 仕様に起

因する脆弱性を防ぐことができます。

⚫  マシンオートメーションコントローラ NJ シリーズ  CPU ユニット  (Ver.1.49  以降)

⚫  マシンオートメーションコントローラ NX1P シリーズ  CPU ユニット  (Ver.1.50  以降)

⚫  マシンオートメーションコントローラ NX102 シリーズ  CPU ユニット  (Ver.1.50  以降)

⚫  マシンオートメーションコントローラ NX7 データベース接続 CPU ユニット  (Ver.1.29  以降)

2.不正アクセスの防止

次に示す回避策を適用することで、脆弱性の影響を軽減することが可能です。

⚫  アクセス元 IP アドレスを制限する

⚫  許可されていないネットワークアセスを制限する

⚫  FINS 書込プロテクト機能を有効にする

⚫  PLC 保護パスワードを使用することで、書き込み権限を制約する。

⚫  PLC 上のハードウェア DIP スイッチを使用することで、PLC プログラム変更を禁止する  (プログラマブルコ

ントローラ CS/CJ シリーズ  CPU ユニット、CP シリーズ CP1H/CP1L CPU ユニットの場合)

さらに以下に示す対策を講じることを推奨します。

⚫  制御システムや装置のネットワーク接続を最小限に抑え、信頼できないデバイスからのアクセス禁止

⚫  ファイアウォールの導入による IT ネットワークからの分離（未使用通信ポートの遮断、通信ホストの制

限、FINS ポート  (9600)  へのアクセスを制限）

⚫  制御システムや装置へのリモートアクセスが必要な場合、仮想プライベートネットワーク  (VPN)の使用

⚫  強固なパスワードの採用と頻繁な変更

⚫  権限保有者のみを制御システムや装置へのアクセスを可能とする物理的統制の導入

⚫  制御システムや装置で USB メモリなど外部ストレージデバイスを使用する場合の事前ウイルススキャン

⚫  制御システムや装置へのリモートアクセス時の多要素認証の導入

3.アンチウィルス保護

制御システムに接続するパソコンに最新の商用品質のウイルス対策ソフトの導入・保守。

4.データ入出力の保護

制御システムや装置への入出力データの意図せぬ改変に備えた、バックアップや範囲チェックなどの妥当性の確

認。

5.紛失データの復元

データ紛失対策としての定期的な設定データのバックアップと保守。

また、既知の問題について、以下に記載されていますので、ご参照の上、対策をご検討ください。

・JVNVU#91000130

オムロン製  PLC CJ  シリーズにおけるサービス運用妨害  (DoS)  の脆弱性

https://jvn.jp/vu/JVNVU91000130/

・JVNVU#91952379

複数のオムロン製  PLC  における複数の脆弱性

https://jvn.jp/vu/JVNVU91952379/

・JVNVU#97111518

オムロン製 SYSMAC CS/CJ/CP シリーズおよび NJ/NX シリーズにおける複数の脆弱性

https://jvn.jp/vu/JVNVU97111518/

既知の問題として報告されている機種以外において、本書で説明された FINS の仕様に起因する脆弱性である

場合は、既知の問題として取り扱い致します。

■関連文書

・弊社  PLC  に対する外部機関からの脆弱性指摘について

https://www.omron-cxone.com/security/2019-12-06_PLC_JP.pdf

・CS/CJ/CP/NSJ シリーズ  通信コマンド  リファレンスマニュアル  (SBCA-304)

・NX  シリーズ  CPU  ユニット  ユーザーズマニュアル  FINS  機能編（SBCD-375）

■更新履歴

日付

履歴

2023 年 4 月 17 日

初版発行

2023 年 9 月 19 日

誤記修正



=== Content from www.cisa.gov_bc450807_20250114_201408.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Omron SYSMAC CS/CJ/CP Series and NJ/NX Series

Last RevisedJune 28, 2022
Alert CodeICSA-22-179-02

## 1. EXECUTIVE SUMMARY

* **CVSS v3 6.5**
* **ATTENTION:** Exploitable remotely/low attack complexity
* **Vendor:** Omron
* **Equipment:** SYSMAC CS/CJ/CP Series and NJ/NX Series
* **Vulnerabilities:** Cleartext Transmission of Sensitive Information, Insufficient Verification of Data Authenticity, Plaintext Storage of a Password

CISA is aware of a public report, known as “OT:ICEFALL” that details vulnerabilities found in multiple operational technology (OT) vendors. CISA is issuing this advisory to provide notice of the reported vulnerabilities and identify baseline mitigations for reducing risks to these and other cybersecurity attacks.

## 2. RISK EVALUATION

Successful exploitation of these vulnerabilities could cause a denial-of-service condition and allow remote code execution.

## 3. TECHNICAL DETAILS

### 3.1 AFFECTED PRODUCTS

The following versions of the Omron SYSMAC CS/CJ/CP Series and NJ/NX Series, a programmable logic controller, are affected:

* SYSMAC CS1: Versions prior to 4.1
* SYSMAC CJ2M: Versions prior to 2.1
* SYSMAC CJ2H: Versions prior to 1.5
* SYSMAC CP1E/CP1H: Versions prior to 1.30
* SYSMAC CP1L: Versions prior to 1.10
* CP1W-CIF41: All versions
* SYSMAC CX-Programmer: Versions prior to 9.6
* SYSMAC NJ/NX Series: Versions prior to 1.49 (1.29 for NX7)

### 3.2 VULNERABILITY OVERVIEW

#### 3.2.1    [CLEARTEXT TRANSMISSION OF SENSITIVE INFORMATION CWE-319](https://cwe.mitre.org/data/definitions/319.html)

Omron SYSMAC CS1/CJ1/CP1/CP2 series is vulnerable to a password used to restrict engineering operation is transmitted in plaintext.

[CVE-2022-31204](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31204) has been assigned to this vulnerability. A CVSS v3 base score of 6.5 has been assigned; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)).

#### 3.2.2    [PLAINTEXT STORAGE OF A PASSWORD CWE-256](https://cwe.mitre.org/data/definitions/256.html)

The CP1W-CIF41 Ethernet Option Board is vulnerable to a Web UI password that can be read from memory using the Omron FINS protocol. An attacker obtaining this password could change the network settings of the option board.

[CVE-2022-31205](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31205) has been assigned to this vulnerability. A CVSS v3 base score of 6.5 has been assigned; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)).

#### 3.2.3    [INSUFFICIENT VERIFICATION OF DATA AUTHENTICITY CWE-345](https://cwe.mitre.org/data/definitions/345.html)

The logic that is downloaded to the PLC is not cryptographically authenticated, allowing an attacker to manipulate transmitted object code to an unprotected PLC without using the PLC protection password. An attacker could then execute arbitrary object code commands on the defined software logic for all versions of SYSMAC CS/CJ/CP series controllers and cause a denial-of-service condition.

[CVE-2022-31207](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31207) has been assigned to this vulnerability. A CVSS v3 base score of 5.9 has been assigned; the CVSS vector string is ([AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H)).

#### 3.2.4    [INSUFFICIENT VERIFICATION OF DATA AUTHENTICITY CWE-347](https://cwe.mitre.org/data/definitions/347.html)

The logic that is downloaded to the PLC is not cryptographically authenticated, allowing an attacker to manipulate transmitted object code to the PLC and execute arbitrary machine code on the processor of the PLC's CPU module for SYSMAC NJ/NX series controllers.

[CVE-2022-31206](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31206) has been assigned to this vulnerability. A CVSS v3 base score of 4.4 has been assigned; the CVSS vector string is ([AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N)).

### 3.3 BACKGROUND

* **CRITICAL INFRASTRUCTURE SECTORS:** Critical Manufacturing
* **COUNTRIES/AREAS DEPLOYED:** Worldwide
* **COMPANY HEADQUARTERS LOCATION:** Japan

### 3.4 RESEARCHER

Daniel dos Santos and Jos Wetzels from Forescout Technologies reported these vulnerabilities to CISA.

## 4. MITIGATIONS

For CVE-2022-31204: Omron recommends users implement an extended password protection function in the following product versions:

* CS1, v.4.1 or later
* CJ2M, v2.1 or later
* CJ2H, v1.5 or later
* CP1E/CP1H , v1.30 or later
* CP1L, v1.10 or later
* CX-Programmer, v9.6 or higher

For CVE-2022-31206: Omron intends to publish an update for SYSMAC NJ/NX in July 2022.

For CVE-2022-31207: Omron recommends users of SYSMAC CS/CJ/CP Series to use the PLC protection password and enable protection against unauthorized write access to address. Also, there are hardware DIP switches on the PLC which can prevent unauthorized PLC program changes regardless of password.

For CVE-2022-31205: Omron recommends using different passwords between the CP1W-CIF41 Ethernet Option Board and CP1 PLC itself. The Web UI password will not grant access to the PLC.

CISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:

* Minimize network exposure for all control system devices and/or systems, and ensure they are [not accessible from the Internet](https://www.cisa.gov/uscert/ics/alerts/ICS-ALERT-10-301-01).
* Locate control system networks and remote devices behind firewalls and isolate them from the business network.
* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize VPN is only as secure as its connected devices.

CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

CISA also provides a section for [control systems security recommended practices](https://www.cisa.gov/uscert/ics/recommended-practices) on the ICS webpage at [cisa.gov/ics](https://www.cisa.gov/uscert/ics). Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies](https://www.cisa.gov/uscert/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf).

Additional mitigation guidance and recommended practices are publicly available on the ICS webpage at [cisa.gov/ics](https://www.cisa.gov/uscert/ics) in the Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](https://www.cisa.gov/uscert/ics/tips/ICS-TIP-12-146-01B).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.

No known public exploits specifically target these vulnerabilities.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Vendor

* Omron

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-22-179-02); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from www.ia.omron.com_eefeb8b9_20250114_201416.html ===
About Known Issues in the FINS Protocol Implemented in

Omron Products

Release date: April 17, 2023

Last modified on September 19, 2023

Omron Corporation

■ Overview

FINS  (Factory  Interface Network Service) is  a  message communications protocol used  in  factory

automation (FA) networks built with Omron products. Known issues due to FINS protocol specifications

have been reported on the Omron Programmable Logic Controller (PLC).

■ Main products affected

⚫  Programmable Controller CS-series CPU Units, all versions

⚫  Programmable Controller CJ-series CPU Units, all versions

⚫  Programmable Controller CP-series CPU Units, all versions

⚫  Machine Automation Controller NJ-series CPU Units, all versions

⚫  Machine Automation Controller NX1P-series CPU Units, all versions

⚫  Machine Automation Controller NX102-series CPU Units, all versions

⚫  Machine Automation Controller NX7 Database Connection CPU Units, all versions

■ Detailed information

The FINS protocol is a lightweight and simple communications protocol developed for controlling FA

networks consisting of Omron PLCs and PC software. The FINS protocol can be used for command-

response message communications and enables monitoring, operation, and setting of the FA control

system.

Various FINS commands are available, which can be classified into the following types.

・Reading and writing values of I/O memory area

・Reading and writing values in parameter area

・Reading and writing values in program area

・Changing the operating mode

・Reading device configuration

・Reading CPU Unit status

・Access to time information

・Reading messages and clearing them

・Acquiring and releasing access right

・Reading error logs, etc.

・Operating files

・Forced set/reset

This information is published in manuals, etc., and the specifications are disclosed. Supported FINS

command differs depending on the product model.

The FINS command message consists of three elements: "FINS header", "FINS command code"

and "parameter". The control device/software that receives the FINS command message processes

the FINS command code and returns the processing result as a FINS response message to the source

of the command in the FINS header.

When  the  FINS  protocol  was  developed,  it  was  assumed  that  the  FA  network  would  be  a  local

network closed within factories, lines, and equipment, or devices. Now that FA networks have become

open networks, some vulnerabilities have been pointed out in the FINS specifications.

１．  Cleartext communications

The FINS protocol does not support encrypted communications in its specifications. Since FINS

messages  are  sent  and  received  without  being  encrypted,  they  can  be  intercepted.  Also,  it  is

difficult to detect falsification of FINS messages.

・  Cleartext Transmission of Sensitive Information (CWE-319)

・  Insufficient Verification of Data Authenticity (CWE-345)

２．  No verification or authentication is required

The FINS protocol does not support the authentication process in its specifications. Therefore,

an attack from a malicious communication device cannot be detected.

・  Authentication Bypass by Spoofing (CWE-290)

・  Authentication Bypass by Capture-replay (CWE-294)

・  Missing Authentication for Critical Function (CWE-306)

・  Insufficient Verification of Data Authenticity (CWE-345)

・  Uncontrolled Resource Consumption (CWE-400)

・  Unrestricted Externally Accessible Lock (CWE-412)

・  Improper Control of Interaction Frequency (CWE-799)

These vulnerabilities are due to the  specifications of the FINS protocol, but there are no plans to

revise the specifications.

■ Expected threats

A  third  party  may  exploit  the  content  of  communications  or  execute  unauthorized  command  or

malicious access to control system.

■ Countermeasures

To  minimize  the  risk  of  exploitation  of  this  vulnerability,  we  recommend  the  following  mitigation

measures.

1. Do not use FINS (disable FINS)

For FA networks that do not use FINS, vulnerabilities caused by the FINS specifications can be

prevented by disabling FINS on the following models.

⚫  Machine Automation Controller NJ-series CPU Units (Ver.1.49 or higher)

⚫  Machine Automation Controller NX1P-series CPU Units (Ver.1.50 or higher)

⚫  Machine Automation Controller NX102-series CPU Units (Ver.1.50 or higher)

⚫  Machine Automation Controller NX7 Database Connection CPU Units (Ver.1.29 or higher)

2. Security measures to prevent unauthorized access

Applying the following workarounds can mitigate the effects of the vulnerability.

・Restrict IP Address of access source

・Restrict unauthorized access to networks

・Enable the FINS write protection function

・Restrict write permissions by using a password for write-protecting the PLC

・Prohibit PLC programs changes by using hardware DIP switches on the PLC (Programmable

Controller CS/CJ -series CPU Units, CP-series CP1H/CP1L CPU Units)

In addition, it is recommended to take the following measures.

・  Reduce  connections  to  control  systems  and  equipment  via  networks  to  prevent  access  from

untrusted devices.

・   Separate  control  systems  from  the  IT  network  by  introducing  a  firewall  (blocking  unused

communication ports, limiting communication hosts, limiting access to the FINS port (9600))

・  Use a virtual private network (VPN) for remote access to control systems and equipment.

・  Set strong passwords and change them frequently.

・  Install  physical  controls  so  that  only  authorized  personnel  can  access  control  systems  and

equipment.

・  Scan virus to ensure safety of USB memory or other external storages before connecting them

to control systems and equipment.

・   Adopt  multifactor  authentication  to  devices  with  remote  access  to  control  systems  and

equipment.

3. Antivirus protection

Install the latest commercial-quality antivirus software on computers connected to control systems

and keep it up to date.

4. Data input and output protection

Validate backups and check ranges to cope with unintentional modification of input/output data to

control systems and equipment.

5. Data recovery

Regularly backup configuration data and maintain it in case of data loss.

In  addition,  the  known  issues  are  described  below,  so  please  refer  to  them  and  consider

implementing countermeasures.

・ICS Advisory (ICSA-20-063-03), Omron PLC CJ Series

https://www.us-cert.gov/ics/advisories/icsa-20-063-03

・ICS Advisory (ICSA-19-346-02), Omron PLC CJ and CS Series

https://www.us-cert.gov/ics/advisories/icsa-19-346-02

・ICS Advisory (ICSA-22-179-02), Omron SYSMAC CS/CJ/CP Series and NJ/NX Series

https://www.cisa.gov/news-events/ics-advisories/icsa-22-179-02

For models other than those reported for known issues, if the vulnerability is caused by the FINS

specifications described in this document, it will be treated as a known issue.

■ Related documents

・Vulnerabilities in Omron PLCs

  https://www.omron-cxone.com/security/2019-12-06_PLC_EN.pdf

・CS/CJ/CP/NSJ-series Communications Commands Reference Manual (Cat. No. W342)

・NX-series CPU Unit FINS Function User’s Manual (Cat. No. W596)

■ Revision history

Date

History

April 17, 2023

First edition

September 19, 2023

Clerical Corrections



=== Content from jvn.jp_1b6ae345_20250114_201408.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

å¬éæ¥ï¼2023/04/17ãæçµæ´æ°æ¥ï¼2023/09/19
# JVNTA#91513661 FINSãã­ãã³ã«ã«ãããã»ã­ã¥ãªãã£ä¸ã®åé¡ã«ã¤ãã¦

## æ¦è¦

FINS(Factory Interface Network Service)ã¯ããªã ã­ã³ç¤¾è£½åã§æ§æãããFA(Factory Automation)ãããã¯ã¼ã¯ã§ä½¿ç¨ãããã¡ãã»ã¼ã¸éä¿¡ãã­ãã³ã«ã§ããFINSã¯ã¯ã­ã¼ãºããªFAãããã¯ã¼ã¯ã§ä½¿ç¨ããããã¨ãåæã¨ãã¦è¨­è¨ããã¦ãã¾ããè¿å¹´ã®ç£æ¥­å¶å¾¡ã·ã¹ãã ã®ã»ã­ã¥ãªãã£ã®è¦ç¹ã§FINSãã­ãã³ã«ãå¯¾å¿æ©å¨ã®ã»ã­ã¥ãªãã£èª¿æ»ãè¡ãããçµæãFINSãã­ãã³ã«ã®ä»æ§ã«èµ·å ããåé¡ãå ±åããã¦ãã¾ãã

## å½±é¿ãåããã·ã¹ãã

FINSã³ãã³ããå®è£ããã¦ãããªã ã­ã³ç¤¾è£½åã¨ãã¦ã¯ãæ¬¡ã®ãããªè£½åãæãããã¾ãã

* SYSMAC CS ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC CJ ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC CP ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC NJ ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC NX1P ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC NX102 ã·ãªã¼ãº CPU ã¦ããã å¨ãã¼ã¸ã§ã³
* SYSMAC NX7 ãã¼ã¿ãã¼ã¹æ¥ç¶CPU ã¦ããã å¨ãã¼ã¸ã§ã³

## è©³ç´°æå ±

FINSãã­ãã³ã«ã¯ããªã ã­ã³ç¤¾è£½PLCãPCã½ããã¦ã§ã¢ãªã©ãFAãããã¯ã¼ã¯ãFAå¶å¾¡ã·ã¹ãã ã®å¶å¾¡ãã³ãã³ãã»ã¬ã¹ãã³ã¹æ¹å¼ã«ã¦è¡ãéä¿¡ãã­ãã³ã«ã§ããFINSã³ãã³ãã«ã¯ãæ¬¡ã®ãããªæ©è½ãããããããã®ã³ãã³ããä½¿ã£ã¦å¯¾è±¡æ©å¨ããã®æå ±ã®èª­ã¿æ¸ããåç¨®æä½ãè¨­å®ããããã¨ãã§ãã¾ããæ©ç¨®ã«ããããµãã¼ãããã¦ããFINSã³ãã³ãã¯ç°ãªãã¾ãã

* I/O ã¡ã¢ãªã¨ãªã¢ã®èª­ã¿åºã/æ¸ãè¾¼ã¿
* ãã©ã¡ã¼ã¿ã¨ãªã¢ã®èª­ã¿åºã/æ¸ãè¾¼ã¿
* ãã­ã°ã©ã ã¨ãªã¢ã®èª­ã¿åºã/æ¸ãè¾¼ã¿
* åä½ã¢ã¼ãå¤æ´
* æ©å¨æ§æã®èª­ã¿åºã
* CPU ã¦ãããã®ã¹ãã¼ã¿ã¹ã®èª­ã¿åºã
* æéæå ±ã®ã¢ã¯ã»ã¹
* ã¡ãã»ã¼ã¸ã®èª­ã¿åºã/è§£é¤
* ã¢ã¯ã»ã¹æ¨©ã®ç²å¾ã»éæ¾
* ç°å¸¸å±¥æ­´ã®èª­ã¿åºããªã©
* ãã¡ã¤ã«æä½
* å¼·å¶ã»ãã/ãªã»ãã

FINSã³ãã³ãã®ã¡ãã»ã¼ã¸ã¯ãFINSãããããFINSã³ãã³ãã³ã¼ããããã©ã¡ã¼ã¿ãã®ï¼ã¤ããæ§æããã¦ãã¾ããFINSã³ãã³ãã¡ãã»ã¼ã¸ãåä¿¡ããå¶å¾¡æ©å¨/ã½ããã¦ã§ã¢ã¯ããFINSã³ãã³ãã³ã¼ããã«å¯¾å¿ããå¦çãå®è¡ãããã®å¦ççµæãFINSã¬ã¹ãã³ã¹ã¡ãã»ã¼ã¸ã¨ãã¦ãFINSããããã«ããéä¿¡åã¸è¿ä¿¡ãã¾ããFINSã®ãã­ãã³ã«è¨­è¨ã§ã¯ãFAãããã¯ã¼ã¯ã¯å·¥å ´ãã©ã¤ã³ã»è£ç½®ã«éããã­ã¼ã«ã«ãããã¯ã¼ã¯ã§ãããã¨ãåæã¨ãã¦ãã¾ãããã®ããFINSã¡ãã»ã¼ã¸ã®æå·åãæ¤è¨¼ãèªè¨¼ãªã©ã®æ©è½ã¯å®ç¾©ããã¦ãã¾ãããFINSãã­ãã³ã«ã«å¯¾ãã¦ãæ¬¡ã«ç¤ºããããªåé¡ãææããã¦ãã¾ãã

## 1. å¹³æéä¿¡

FINSãã­ãã³ã«ã§ã¯æå·åéä¿¡ãå®ç¾©ãã¦ãã¾ãããéä¿¡çµè·¯ä¸ã®FINSã¡ãã»ã¼ã¸ã¯å¹³æã§éåä¿¡ããããããååãããã¨ã§å®¹æã«åå®¹ãèª­ã¿åããã¨ãå¯è½ã§ããã¾ããFINSã¡ãã»ã¼ã¸ã®æ¹ãããæ¤ç¥ããæ©è½ãå®ç¾©ããã¦ãã¾ããã

* æ©å¾®ãªæå ±ã®å¹³æéä¿¡ï¼[CWE-319](https://cwe.mitre.org/data/definitions/319.html)ï¼
* ãã¼ã¿ã®ä¿¡é ¼æ§ã«ã¤ãã¦ã®ä¸ååãªæ¤è¨¼ï¼[CWE-345](https://cwe.mitre.org/data/definitions/345.html)ï¼

## 2. èªè¨¼ä¸è¦

FINSãã­ãã³ã«ã§ã¯èªè¨¼å¦çãå®ç¾©ãã¦ãã¾ããããã£ã¦ãæªæããéä¿¡ç¸æããã®æ»æã§ãããã¨ãè­å¥ãããã¨ã¯ã§ãã¾ããã

* ãªããã¾ãã«ããèªè¨¼åé¿ ([CWE-290](https://cwe.mitre.org/data/definitions/290.html))
* Capture-replay æ»æã«ããèªè¨¼åé¿ ([CWE-294](https://cwe.mitre.org/data/definitions/294.html))
* éè¦ãªæ©è½ã«å¯¾ããèªè¨¼ã®æ¬ å¦ ([CWE-306](https://cwe.mitre.org/data/definitions/306.html))
* ãã¼ã¿ã®ä¿¡é ¼æ§ã«ã¤ãã¦ã®ä¸ååãªæ¤è¨¼ï¼[CWE-345](https://cwe.mitre.org/data/definitions/345.html)ï¼
* ãµã¼ãã¹éç¨å¦¨å®³ (DoS) ã®èå¼±æ§ ([CWE-400)](https://cwe.mitre.org/data/definitions/400.html)
* å¤é¨ããã®æä½å¶éä¸å ([CWE-412](https://cwe.mitre.org/data/definitions/412.html))
* ã¤ã³ã¿ã©ã¯ã·ã§ã³é »åº¦ã®ä¸é©åãªå¶é  ([CWE-799](https://cwe.mitre.org/data/definitions/799.html))

## æ³å®ãããå½±é¿

FINSã¡ãã»ã¼ã¸ãååãããå ´åããã®åå®¹ãèª­ã¿åãããå¯è½æ§ãããã¾ããã¾ããä¸æ­£ãªFINSã¡ãã»ã¼ã¸ãæ³¨å¥ãããå ´åãæ³å®å¤ã®å¶å¾¡ã³ãã³ããå®è¡ãããããããã¤ã¹åã®æå ±ã«ã¢ã¯ã»ã¹ããããããå¯è½æ§ãããã¾ãã

## å¯¾ç­æ¹æ³

ãªã ã­ã³ç¤¾ã«ããã°ãç¾å¨ã®ãã­ãã³ã«ä»æ§ãæ¹è¨ããäºå®ã¯ãªãã¨ã®ãã¨ã§ããFINSãã­ãã³ã«ãå®è£ããè£½åã®å©ç¨èã¯ã[è©³ç´°æå ±]ã[æ³å®ãããå½±é¿]ã«è¨è¼ãããåå®¹ãè¸ã¾ããè£½åãä½¿ç¨ããç°å¢ãé©åã«ä¿è­·ãã¦ãã ãããFINSã®æªç¨ãªã¹ã¯ãæå°éã«æãããããä»¥ä¸ã®å¯¾ç­ãæ¨å¥¨ããã¦ãã¾ãã
## 1. FINSãä½¿ç¨ããªã(FINSãç¡å¹åãã)

FINSãä½¿ç¨ãã¦ããªãFAãããã¯ã¼ã¯ã®å ´åãFINSãã­ãã³ã«ã®æ©è½ãç¡å¹åãã¦ãã ãããä»¥ä¸ã®æ©ç¨®ã§ã¯ãFINSãç¡å¹åãããã¨ãã§ãã¾ãã

* SYSMAC NJã·ãªã¼ãº CPUã¦ããã (Ver.1.49 ä»¥é)
* SYSMAC NX1Pã·ãªã¼ãº CPUã¦ããã (Ver.1.49 ä»¥é)
* SYSMAC NX102ã·ãªã¼ãº CPUã¦ããã (Ver.1.49 ä»¥é)
* SYSMAC NX7ãã¼ã¿ãã¼ã¹æ¥ç¶CPUã¦ããã (Ver.1.29 ä»¥é)

## 2.ä¸æ­£ã¢ã¯ã»ã¹ã®é²æ­¢

* ã¢ã¯ã»ã¹åIPã¢ãã¬ã¹ãå¶éãã
* è¨±å¯ããã¦ããªããããã¯ã¼ã¯ã¢ã»ã¹ãå¶éãã
* FINSæ¸è¾¼ãã­ãã¯ãæ©è½ãæå¹ã«ãã
* PLCä¿è­·ãã¹ã¯ã¼ããä½¿ç¨ãããã¨ã§ãæ¸ãè¾¼ã¿æ¨©éãå¶ç´ããã
* PLCä¸ã®ãã¼ãã¦ã§ã¢DIPã¹ã¤ãããä½¿ç¨ãããã¨ã§ãPLCãã­ã°ã©ã å¤æ´ãç¦æ­¢ãã

ããã«ä»¥ä¸ã«ç¤ºãå¯¾ç­ãæ¨å¥¨ããã¦ãã¾ãã

* å¶å¾¡ã·ã¹ãã ãè£ç½®ã®ãããã¯ã¼ã¯æ¥ç¶ãæå°éã«æããä¿¡é ¼ã§ããªãããã¤ã¹ããã®ã¢ã¯ã»ã¹ç¦æ­¢
* ãã¡ã¤ã¢ã¦ã©ã¼ã«ã®å°å¥ã«ããITãããã¯ã¼ã¯ããã®åé¢ï¼æªä½¿éä¿¡ãã¼ãã®é®æ­ãéä¿¡ãã¹ãã®å¶éãFINSãã¼ã (9600) ã¸ã®ã¢ã¯ã»ã¹ãå¶éï¼
* å¶å¾¡ã·ã¹ãã ãè£ç½®ã¸ã®ãªã¢ã¼ãã¢ã¯ã»ã¹ãå¿è¦ãªå ´åãä»®æ³ãã©ã¤ãã¼ããããã¯ã¼ã¯ (VPN)ã®ä½¿ç¨
* å¼·åºãªãã¹ã¯ã¼ãã®æ¡ç¨ã¨é »ç¹ãªå¤æ´
* æ¨©éä¿æèã®ã¿ãå¶å¾¡ã·ã¹ãã ãè£ç½®ã¸ã®ã¢ã¯ã»ã¹ãå¯è½ã¨ããç©çççµ±å¶ã®å°å¥
* å¶å¾¡ã·ã¹ãã ãè£ç½®ã§USBã¡ã¢ãªãªã©å¤é¨ã¹ãã¬ã¼ã¸ããã¤ã¹ãä½¿ç¨ããå ´åã®äºåã¦ã¤ã«ã¹ã¹ã­ã£ã³
* å¶å¾¡ã·ã¹ãã ãè£ç½®ã¸ã®ãªã¢ã¼ãã¢ã¯ã»ã¹æã®å¤è¦ç´ èªè¨¼ã®å°å¥

## 3. ã¢ã³ãã¦ã£ã«ã¹ä¿è­·

å¶å¾¡ã·ã¹ãã ã«æ¥ç¶ãããã½ã³ã³ã«ææ°ã®åç¨åè³ªã®ã¦ã¤ã«ã¹å¯¾ç­ã½ããã®å°å¥ã»ä¿å®
## 4. ãã¼ã¿å¥åºåã®ä¿è­·

å¶å¾¡ã·ã¹ãã ãè£ç½®ã¸ã®å¥åºåãã¼ã¿ã®æå³ãã¬æ¹å¤ã«åãããããã¯ã¢ãããç¯å²ãã§ãã¯ãªã©ã®å¦¥å½æ§ã®ç¢ºèª
## 5. ç´å¤±ãã¼ã¿ã®å¾©å

ãã¼ã¿ç´å¤±å¯¾ç­ã¨ãã¦ã®å®æçãªè¨­å®ãã¼ã¿ã®ããã¯ã¢ããã¨ä¿å®

ãªã ã­ã³ç¤¾ã«ããã¨ãFINSãã­ãã³ã«ã«èµ·å ããåé¡ã¯[CVE-2023-27396](https://www.cve.org/CVERecord?id=CVE-2023-27396)ã¨ãã¦æ±ãã¨ã®ãã¨ã§ãã

## ãã³ãæå ±

| ãã³ã | ãªã³ã¯ |
| --- | --- |
| ãªã ã­ã³æ ªå¼ä¼ç¤¾ | [è¤æ°ã®ãªã ã­ã³è£½åã«å®è£ããã¦ãã FINS ãã­ãã³ã«ã«ãããæ¢ç¥ã®åé¡ã«ã¤ãã¦](https://www.fa.omron.co.jp/product/security/assets/pdf/ja/OMSR-2023-003_ja.pdf) |

## åèæå ±

1. [JVNVU#91000130 ãªã ã­ã³è£½ PLC CJ ã·ãªã¼ãºã«ããããµã¼ãã¹éç¨å¦¨å®³ (DoS) ã®èå¼±æ§](https://jvn.jp/vu/JVNVU91000130/)
2. [JVNVU#91952379 è¤æ°ã®ãªã ã­ã³è£½ PLC ã«ãããè¤æ°ã®èå¼±æ§](https://jvn.jp/vu/JVNVU91952379/)
3. [JVNVU#97111518 ãªã ã­ã³è£½SYSMAC CS/CJ/CPã·ãªã¼ãºããã³NJ/NXã·ãªã¼ãºã«ãããè¤æ°ã®èå¼±æ§](https://jvn.jp/vu/JVNVU97111518/)

## JPCERT/CCããã®è£è¶³æå ±

## JPCERT/CCã«ããèå¼±æ§åæçµæ

## è¬è¾

æ¬ææ¸ã¯ãªã ã­ã³ããã³JPCERT/CCãå±åã§å·ç­ãã¾ããã

## é¢é£ææ¸

| JPCERT ç·æ¥å ±å |  |
| --- | --- |
| JPCERT REPORT |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2023-27396](https://www.cve.org/CVERecord?id=CVE-2023-27396) |
| JVN iPedia |  |

## æ´æ°å±¥æ­´

2023/09/19
ï¼»å½±é¿ãåããã·ã¹ãã ï¼½ãæ´æ°ãã¾ãã

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](/index.html)
* [![JVNã¨ã¯](/common/img/r_nav_2.gif)](/nav/jvn.html)
* [![èå¼±æ§ã¬ãã¼ãã®èª­ã¿æ¹](/common/img/r_nav_3.gif)](/nav/jvnhelp.html)
* [![èå¼±æ§ã¬ãã¼ãä¸è¦§](/common/img/r_nav_4.gif)](/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](/jp/index.html)
* [![VN_JPï¼é£çµ¡ä¸è½ï¼](/common/img/r_nav_4_4.gif)](/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](/vu/index.html)
* [![VN_TA](/common/img/r_nav_4_3.gif)](/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](/tr/index.html)
* [![JVN iPedia](/common/img/r_nav_10.gif)](http://jvndb.jvn.jp/)
* [![MyJVN](/common/img/r_nav_10_4.gif)](http://jvndb.jvn.jp/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](/rss/index.html)
* [![ãã³ãæå ±ä¸è¦§](/common/img/r_nav_7.gif)](/nav/index.html)
* [![é£çµ¡ä¸è½éçºèä¸è¦§](/common/img/r_nav_11.gif)](/reply/index.html)
* [![èå¼±æ§æå ±ã®å±åº](/common/img/r_nav_8.gif)](http://www.ipa.go.jp/security/vuln/report/)
* [![ãååãå](/common/img/r_nav_9.gif)](/contact/index.html)

Copyright (c) 2000-2023 JPCERT/CC and IPA. All rights reserved.



=== Content from jvn.jp_dd361a6a_20250114_201406.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2023/04/17  Last Updated:2023/09/19
# JVNTA#91513661 Security Issues in FINS protocol

## Overview

FINS (Factory Interface Network Service) is a message communication protocol, which is designed to be used in closed FA (Factory Automation) networks, and is used in FA networks composed of Omron products. Recent security researches show multiple issues against systems speaking FINS protocol.

## Products Affected

Omron products which implement FINS protocol include:

* SYSMAC CS-series CPU Units, all versions
* SYSMAC CJ-series CPU Units, all versions
* SYSMAC CP-series CPU Units, all versions
* SYSMAC NJ-series CPU Units, all versions
* SYSMAC NX1P-series CPU Units, all versions
* SYSMAC NX102-series CPU Units, all versions
* SYSMAC NX7 Database Connection CPU Units, all versions

## Description

FINS (Factory Interface Network Service) is a message communication protocol, which is designed to be used in closed FA (Factory Automation) networks, and is used in FA networks composed of Omron products. FINS commands enable to read/write information, conduct various operations and set the configuration on FINS-compliant devices. The supported FINS commands vary depending on the products.

* I/O memory area read/write
* Parameter area read/write
* Program area read/write
* Manage operation mode
* System configuration read
* CPU unit status read
* Time information access
* Message read/delete
* Manage access privileges
* Read fault history report, etc.
* File operation
* Forced set/reset

FINS message consists of "FINS header", "FINS command code" and "parameter". When receiving a FINS command message, the entity conducts the operation corresponding to the "FINS command code", and sends the result as a response message to the destinations listed in "FINS header" of the command message. FINS protocol is designed with the assumptions that the network is closed inside the device, the production lines, or within the factory, and does not provide any encryption, data verification, nor authentication functions. Recent security researches show multiple issues on FINS protocol, under the conditions which FINS protocol does not consider, e.g., a FINS network is connected to other outside networks, FINS network can be physically accessed, etc. The following issues on FINS protocol have been reported:
## 1. Plaintext communication

Encrypted communication is not defined in FINS protocol. FINS messages are transmitted unencrypted and the contents can be seen easily when intercepted. Also alterations of FINS messages cannot be detected.

* Clear-text Transmission of Sensitive Informationï¼[CWE-319](https://cwe.mitre.org/data/definitions/319.html)ï¼
* Insufficient Verification of Data Authenticityï¼[CWE-345](https://cwe.mitre.org/data/definitions/345.html)ï¼

## 2. No authentication required

Authentication is not defined in FINS protocol. Attacks from malicious devices cannot be detected.

* Authentication Bypass by Spoofing ([CWE-290](https://cwe.mitre.org/data/definitions/290.html))
* Authentication Bypass by Capture-replay ([CWE-294](https://cwe.mitre.org/data/definitions/294.html))
* Missing Authentication for Critical Function ([CWE-306](https://cwe.mitre.org/data/definitions/306.html))
* Insufficient Verification of Data Authenticityï¼[CWE-345](https://cwe.mitre.org/data/definitions/345.html)ï¼
* Uncontrolled Resource Consumption ([CWE-400)](https://cwe.mitre.org/data/definitions/400.html)
* Unrestricted Externally Accessible Lock([CWE-412](https://cwe.mitre.org/data/definitions/412.html))
* Improper Control of Interaction Frequency ([CWE-799](https://cwe.mitre.org/data/definitions/799.html))

## Impact

When FINS messages are intercepted, the contents may be retrieved. When arbitrary FINS messages are injected, any commands may be executed on, or the system information may be retrieved from, the affected device.

## Solution

According to the developer, no revision of FINS protocol is planned. Users of the FINS products should consider the issues described in

Description and Impact, and use the products in an appropriately protected environment. To minimize the risks, the vendor recommends the following:
## 1. Do not use FINS (Disable FINS)

In FA networks where FINS is not used, disable FINS functionality. The following products allow to disable FINS:

* SYSMAC NJ-series CPU Units (Ver.1.49 or later)
* SYSMAC NX1P-series CPU Units (Ver.1.49 or later)
* SYSMAC NX102-series CPU Units (Ver.1.49 or later)
* SYSMAC NX7 Database Connection CPU Units (Ver.1.29 or later)

## 2.Illegal access prevention

* Restrict the access source IP address
* Restrict unauthorized network access
* Enable FINS write protection function
* Restrict the write permission by using PLC protection password
* Prohibit PLC program changes by using the hardware DIP switch on PLC

Additional recommendations:

* Minimize the network access of control systems or devices, and restrict access from an untrusted device
* Separate from IT networks by using Firewall (Shut down unused ports, restrict communication hosts and restrict access to FINS port(9600))
* Use Virtual Private Network (VPN) when remote accessing to control systems or devices
* Use strong passwords and change them frequently
* Incorporate a physical security control which allows only authorized users to access control systems and devices
* Virus scan when using external storage device such as USB memory sticks on control systems or devices
* Incorporate multi-factor authentication for remote accessing the control systems or devices

## 3. Antivirus protection

Incorporate and maintain latest and commercial grade antivirus software
## 4. Data input/output protection

Validation of backups, range checks, etc. as a preparation for unintended alteration of input/output data of control systems or devices
## 5. Restoration of lost data

Frequent backups of the configuration data as a countermeasure for data loss

The developer states that the issues caused from FINS protocol will be treated as [CVE-2023-27396](https://www.cve.org/CVERecord?id=CVE-2023-27396).

## Vendor Status

| Vendor | Link |
| --- | --- |
| OMRON Corporation | [About Known Issues in the FINS Protocol Implemented in Omron Products](https://www.fa.omron.co.jp/product/security/assets/pdf/en/OMSR-2023-003_en.pdf) |

## References

1. [ICS Advisory (ICSA-20-063-03) Omron PLC CJ Series](https://www.us-cert.gov/ics/advisories/icsa-20-063-03)
2. [ICS Advisory (ICSA-19-346-02) Omron PLC CJ and CS Series](https://www.us-cert.gov/ics/advisories/icsa-19-346-02)
3. [ICS Advisory (ICSA-22-179-02) Omron SYSMAC CS/CJ/CP Series and NJ/NX Series](https://www.cisa.gov/uscert/ics/advisories/icsa-22-179-02)

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

This document is written by Omron and JPCERT/CC.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2023-27396](https://www.cve.org/CVERecord?id=CVE-2023-27396) |
| JVN iPedia |  |

## Update History

2023/09/19
Information under the section "Products Affected" was updated.

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2023 JPCERT/CC and IPA. All rights reserved.


