=== Content from plantplants213607121.wordpress.com_3d01a982_20250114_202321.html ===

[Skip to content](#content)

[Plant Plants' Ethical Hacking](https://plantplants213607121.wordpress.com/)

Ethical hacking, Penetration Testing, White hat, IT

Menu +
×
expanded
collapsed

* [Home](https://plantplants213607121.wordpress.com/)
* [Blog](https://plantplants213607121.wordpress.com/blog/)

# [CVE-2023-27008] ATutor 2.2.1 Cross-Site Scripting via the Token Body Parameter

Posted by[Plant Plants](https://plantplants213607121.wordpress.com/author/cactusisdelicious/)[2023-02-162023-03-28](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/)Posted in[Articles](https://plantplants213607121.wordpress.com/category/articles/)

# Introduction

While conducting a case study, I discovered a vulnerability, a reflected cross-site scripting (XSS), in ATtutor 2.2.1. Versions higher than 2.2.1 were also tested and I confirmed that they are not vulnerable to this attack.

# Reflected Cross-Site Scripting (XSS)

The vulnerability exists in login.tmpl.php and login\_functions.inc.php, and it can be exploited in login.php via a POST request. Login.php accepts a token parameter. The below is partial code in login\_functions.inc.php.

```
if (isset($_POST['token']))
{
    $_SESSION['token'] = $_POST['token'];
}
```

The code sets $\_SESSION[‘token’] to the submitted value of the token parameter via a POST request. Next is partial code in login.tmpl.php.

```
function encrypt_password() {
        document.form.form_password_hidden.value = hex_sha1(hex_sha1(document.form.form_password.value) + "<?php echo $_SESSION['token']; ?>");
        document.form.form_password.value = "";
        return true;
}
```

Within the function here, it plainly echoes out a string given to the token parameter.

![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-12.png?w=551)

Figure 1 – Submission of a POST request with the token parameter

![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-4.png?w=410)

Figure 2 – Response to Figure 1 with a reflected value

An input is reflected. It should be tested to check if there is any sanitization for special characters. The same request with a different token **asdf'”!@#$%^&\*)}** was sent.

![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-5.png?w=420)

Figure 3 – Unsanitized reflected value

It can be confirmed that the input is not sanitized at all. With this knowledge, the following payload can be crafted and sent.

```
asdf");}alert(1);+function+asdf()+{//
```
![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-6.png?w=429)

Figure 4 – Response to the request with the payload

The payload successfully closes the function **encrypt\_password()**, injects **alert(1);**, and deinfes a dummy function **asdf()** to close the trailing closing curly bracket. It also comments out the trailing part of the line starting with **hex\_sha1(document**.

![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-7.png?w=1024)

Figure 5 – Reflected XSS

It can be confirmed that the payload **alert(1)** successfully executed. This XSS is also possible through cross-site request forgery (CSRF).

![](https://plantplants213607121.wordpress.com/wp-content/uploads/2023/02/image-10.png?w=908)

Figure 6 – CSRF proof of concept code

Hosting and navigating to this file also resulted in the alert(1) function in the payload being executed.

# Later Versions

The same attack is confirmed mitigated and not exploitable in later versions. I suspect when other similar attacks were reported to the developers when the web application was actively developed, the prevention mechanism put in place stopped reported attacks, including this seemingly new XSS, altogether.

# Thoughts

Input sanitization is always an important part of web application development.

## Log

* 2023-02-16 CVE request was submitted. The author of ATutor was not contacted since ATutor was no longer supported and maintained at the time of the writing.
* 2023-03-28 The vulnerability was assigned CVE-2023-27008 and published.

### Share this:

* [Twitter](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?share=twitter "Click to share on Twitter")
* [Facebook](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Posted by[Plant Plants](https://plantplants213607121.wordpress.com/author/cactusisdelicious/)[2023-02-162023-03-28](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/)Posted in[Articles](https://plantplants213607121.wordpress.com/category/articles/)
## Published by Plant Plants

Hello, this is Plant Plants. [View more posts](https://plantplants213607121.wordpress.com/author/cactusisdelicious/)

## Post navigation

[Previous Post Previous post:
General Troubleshooting Guide](https://plantplants213607121.wordpress.com/2023/02/14/general-troubleshooting-guide/)[Next Post Next post:
OffSec #BetheResource – Torches Challenge 2023](https://plantplants213607121.wordpress.com/2023/06/20/offsec-betheresource-torches-challenge-2023/)

## 2 thoughts on “[CVE-2023-27008] ATutor 2.2.1 Cross-Site Scripting via the Token Body Parameter”

1. ![](https://1.gravatar.com/avatar/485e7ddc9b6d3f53e001201d6e300c552d4ded3a0748d32b2c7977fee6b6a434?s=32&d=identicon&r=G) **unspecified47** says:
   [2023-03-29 at 1:15 AM](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/#comment-1)

   Hi, Good job! Have you also tested previous version?

   [Like](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?like_comment=1&_wpnonce=e6bfd74b42)Like

   [Reply](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?replytocom=1#respond)
   1. ![](https://2.gravatar.com/avatar/5035df214c01854d14d6d2525d30957569a9f9a6983c1c8ae1c06cee51869bf9?s=32&d=identicon&r=G) **[Plant Plants](https://plantplants213607121.wordpress.com)** says:
      [2023-03-29 at 7:51 AM](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/#comment-2)

      Hello!

      I have not tested older versions.

      [Like](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?like_comment=2&_wpnonce=e6f91e9580)Like

      [Reply](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/?replytocom=2#respond)

### Leave a comment [Cancel reply](/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/#respond)

Δ

[Plant Plants' Ethical Hacking](https://plantplants213607121.wordpress.com/),
[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Plant Plants' Ethical Hacking](https://plantplants213607121.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fplantplants213607121.wordpress.com%2F2023%2F02%2F16%2Fatutor-2-2-1-cross-site-scripting-via-the-token-body-parameter%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Plant Plants' Ethical Hacking](https://plantplants213607121.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fplantplants213607121.wordpress.com%2F2023%2F02%2F16%2Fatutor-2-2-1-cross-site-scripting-via-the-token-body-parameter%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pdlpXY-4X)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://plantplants213607121.wordpress.com/2023/02/16/atutor-2-2-1-cross-site-scripting-via-the-token-body-parameter/)
  + [View post in Reader](https://wordpress.com/read/blogs/197197074/posts/307)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


