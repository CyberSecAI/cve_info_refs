=== Content from github.com_f81a6e57_20250115_093002.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fblob%2F3a7d5116244beb678ad9950bb9dd27d28ed2691f%2Flibrz%2Freg%2Fprofile.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fblob%2F3a7d5116244beb678ad9950bb9dd27d28ed2691f%2Flibrz%2Freg%2Fprofile.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rizinorg%2Frizin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rizinorg](/rizinorg)
/
**[rizin](/rizinorg/rizin)**
Public

* [Notifications](/login?return_to=%2Frizinorg%2Frizin) You must be signed in to change notification settings
* [Fork
  373](/login?return_to=%2Frizinorg%2Frizin)
* [Star
   2.8k](/login?return_to=%2Frizinorg%2Frizin)

* [Code](/rizinorg/rizin)
* [Issues
  411](/rizinorg/rizin/issues)
* [Pull requests
  50](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects
  10](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

Additional navigation options

* [Code](/rizinorg/rizin)
* [Issues](/rizinorg/rizin/issues)
* [Pull requests](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

## Files

 3a7d511
## Breadcrumbs

1. [rizin](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f)
2. /[librz](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz)
3. /[reg](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg)
/
# profile.c

Copy path Blame  Blame
## Latest commit

## History

[History](/rizinorg/rizin/commits/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c)678 lines (623 loc) · 18 KB 3a7d511
## Breadcrumbs

1. [rizin](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f)
2. /[librz](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz)
3. /[reg](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg)
/
# profile.c

Top
## File metadata and controls

* Code
* Blame

678 lines (623 loc) · 18 KB[Raw](https://github.com/rizinorg/rizin/raw/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678// SPDX-FileCopyrightText: 2009-2020 pancake <pancake@nopcode.org>// SPDX-License-Identifier: LGPL-3.0-only
#include <rz\_list.h>#include <rz\_util/rz\_log.h>#include <rz\_util/rz\_str.h>#include <rz\_reg.h>#include <rz\_util.h>#include <rz\_util/rz\_assert.h>#include <rz\_lib.h>#include <string.h>
static void rz\_reg\_profile\_def\_free(RzRegProfileDef \*def) { if (!def) { return; } free(def->name); free(def->comment); free(def->flags); free(def);}
static void rz\_reg\_profile\_alias\_free(RzRegProfileAlias \*alias) { if (!alias) { return; } free(alias->reg\_name); free(alias->alias); free(alias);}
/\*\* \* Like rz\_reg\_type\_by\_name, but warn if non-existent \*/static int expect\_reg\_type\_by\_name(const char \*str) { int r = rz\_reg\_type\_by\_name(str); if (r < 0) { RZ\_LOG\_WARN("No register type for type abbreviation \"%s\".\n", str); } return r;}
/\*\* \* \brief Parses a register type string. \* \* The type string must be of the following form: \* \* <sub-type>@<main-type> \* \* "<sub-type>@" is optional. \* \* \param item Register item whichs types are set. \* \param type\_str The type string. \* \return true On success. \* \return false On failure. \*/static bool parse\_type(RZ\_OUT RzRegProfileDef \*def, const char \*type\_str) { rz\_return\_val\_if\_fail(def && type\_str, false); char \*s = strdup(type\_str); char \*at = strchr(s, '@'); if (at) { // This register has a secondary type e.g. xmm@fpu def->arena\_type = expect\_reg\_type\_by\_name(at + 1); s[at - s] = '\0'; def->type = expect\_reg\_type\_by\_name(s); } else { def->type = expect\_reg\_type\_by\_name(s); def->arena\_type = def->type; if (def->type == RZ\_REG\_TYPE\_FLG) { // Hack to put flgs into gpr arena. def->arena\_type = RZ\_REG\_TYPE\_GPR; } else { def->arena\_type = def->type; } } bool res = true; if (def->type < 0 || def->arena\_type < 0) { RZ\_LOG\_ERROR("Illegal type abbreviation \"%s\"\n", s); res = false; } free(s); return res;}
/\*\* \* \brief Parses the size of a register definition. \* Sizes with . in front are in bits. Otherwise in bytes. \* \* \param s Size string. \* \return ut32 The size as integer or UT64\_MAX if it fails. \*/static ut32 parse\_size(char \*s) { rz\_return\_val\_if\_fail(s, UT32\_MAX); if (s[0] == '.') { return strtoul(s + 1, NULL, 0); } else { return strtoul(s, NULL, 0) \* 8; }}
/\*\* \* \brief Parses the offset of a register defintion and sets the offset in \p def->offset. \* \* Offset is of the form: <byte>.<bit> \* .<bit> is optional. \* \* \param s Offset string. \* \param def The defintion item to store the offset into \p def->offset in bits. \* \return false On failure (sets def->offset = UT32\_MAX). \* \return true On success. \*/static bool parse\_offset(const char \*s, RZ\_OUT RzRegProfileDef \*def) { rz\_return\_val\_if\_fail(s && def, false); if (s[0] == '?') { def->offset = UT32\_MAX; return true; } else if (s[0] == '.') { def->offset = strtoul(s + 1, NULL, 0); return true; } def->offset = strtoul(s, NULL, 0) \* 8;
 const char \*bi = strchr(s, '.'); if (!bi) { // No bit offset given. return true; }
 ut8 bit\_offset = strtoul(bi + 1, NULL, 0); def->offset += bit\_offset; return true;}
/\*\* \* \brief Parses a register alias. \* \* The alias is of the form: \* "=<alias> <reg name>" \* \* \param reg The RzReg struct with the register profile. \* \param tokens A list with both tokens of the alias string. \* \return true On success. \* \return false On Failure. \*/static bool parse\_alias(RZ\_OUT RzList /\*<RzRegProfileAlias \*>\*/ \*alias\_list, RZ\_BORROW RzList /\*<char \*>\*/ \*tokens) { rz\_return\_val\_if\_fail(alias\_list && tokens, false); RzRegProfileAlias \*pa = RZ\_NEW0(RzRegProfileAlias); if (!pa) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; }
 const char \*real\_name = rz\_list\_get\_n(tokens, 1); const char \*alias = rz\_list\_get\_n(tokens, 0); if (!alias) { RZ\_LOG\_WARN("Failed to get alias name from token.\n"); free(pa); return false; }
 RzRegisterId role = rz\_reg\_get\_name\_idx(alias + 1); if (!(role >= 0 && role < RZ\_REG\_NAME\_LAST)) { RZ\_LOG\_WARN("Invalid alias\n"); free(pa); return false; }
 pa->alias = strdup(alias); pa->reg\_name = strdup(real\_name); pa->role = role; rz\_list\_append(alias\_list, pa);
 return true;}
/\*\* \* \brief Parses a register definition. \* \* \param reg Register struct with the register profile. \* \param tokens List of strings of a single register definition. \* \return false On failure. \* \return true On success. \*/static bool parse\_def(RZ\_OUT RzList /\*<RzRegProfileDef \*>\*/ \*def\_list, RZ\_BORROW RzList /\*<char \*>\*/ \*tokens) { rz\_return\_val\_if\_fail(def\_list && tokens, false);
 RzRegProfileDef \*def = RZ\_NEW0(RzRegProfileDef); if (!def) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; } const char \*name = rz\_list\_get\_n(tokens, 1); if (!name) { goto reg\_parse\_error; } def->name = strdup(name);
 if (!parse\_type(def, rz\_list\_get\_n(tokens, 0))) { RZ\_LOG\_WARN("Invalid register type.\n"); goto reg\_parse\_error; }
 def->size = parse\_size(rz\_list\_get\_n(tokens, 2)); if (def->size == UT32\_MAX || def->size == 0) { RZ\_LOG\_WARN("Invalid register size.\n"); goto reg\_parse\_error; }
 def->packed = parse\_size(rz\_list\_get\_n(tokens, 4)); if (def->packed == UT32\_MAX) { RZ\_LOG\_WARN("Invalid register packed size.\n"); goto reg\_parse\_error; }
 if (!parse\_offset(rz\_list\_get\_n(tokens, 3), def)) { RZ\_LOG\_WARN("Invalid register offset.\n"); goto reg\_parse\_error; }
 // Comments and flags are optional if (rz\_list\_length(tokens) == 6) { const char \*comment\_flag = rz\_list\_get\_n(tokens, 5); if (!comment\_flag) { goto reg\_parse\_error; } if (comment\_flag[0] == '#') { // Remove # from the comment def->comment = strdup(comment\_flag + 1); } else { def->flags = strdup(comment\_flag); } } RZ\_LOG\_DEBUG("profile: register def: %s %d %d %s\n", def->name, def->size, def->offset, def->flags); rz\_list\_append(def\_list, def);
 return true;
reg\_parse\_error: rz\_reg\_profile\_def\_free(def); return false;}
/\*\* \* \brief Parses a register profile string. Each line is either a register alias or a register definiton. \* \* A register alias string is of the following form: \* "=<alias> <name>\n" \* \* A register definition string is of the following form: \* "(<sub-type>@)main-type <name> .<size> <byte offset>(.<bit offset>) <packed> (# <comment> OR <flags>)\n" \* \* Elements in "()" are optional. \* Each "<...>" token is separated by tab or space characters. \* \* \* alias: Register alias (e.g. PC, A1 etc.) \* \* name: Register name. \* \* size: Register size in bits. \* \* main-type: Register type: gpr, fpr, ctr, flg etc. \* \* sub-type: The second register type (e.g. xmm@fpu : xmm is sub-type of fpu) \* \* byte offset: Offset into register profile in bytes. \* \* bit offset: Offset into the byte offset in bits. \* \* packed: Packed size of the register in bytes. \* \* comment: A comment about the register. \* \* Flags this register holds. \* \* \param reg Register struct which holds all register items. \* \param profile Register profile string. \* \return false On failure. \* \return true On success. \*/static bool parse\_reg\_profile\_str(RZ\_OUT RzList /\*<RzRegProfileAlias \*>\*/ \*alias\_list, RZ\_OUT RzList /\*<RzRegProfileDef \*>\*/ \*def\_list, const char \*profile\_str) { rz\_return\_val\_if\_fail(alias\_list && def\_list && profile\_str, false);
 RzList \*def\_lines = rz\_str\_split\_duplist\_n(profile\_str, "\n", 0, true); rz\_return\_val\_if\_fail(def\_lines, false);
 st32 l = 0; // Line number const char \*line; bool is\_alias = false; RzListIter \*it; RzList \*toks = NULL; rz\_list\_foreach (def\_lines, it, line) { ++l; if (RZ\_STR\_ISEMPTY(line)) { continue; } if (rz\_str\_strchr(line, "#")) { RzList \*line\_and\_cmt = rz\_str\_split\_duplist\_n\_regex(line, "#", 0, true); char \*raw\_comment = strdup(rz\_list\_get\_top(line\_and\_cmt)); if (!raw\_comment) { RZ\_LOG\_WARN("Comment could not be split from register definition. Line: \"%s\"\n", line); continue; } char \*tmp = rz\_str\_prepend(raw\_comment, "#"); if (!tmp) { RZ\_LOG\_WARN("Could not prepend # to comment. Line: \"%s\".\n", line); continue; } char \*comment = strdup(tmp); toks = rz\_str\_split\_duplist\_n\_regex(rz\_list\_get\_bottom(line\_and\_cmt), "[[:blank:]]+", 0, true); rz\_list\_append(toks, comment); rz\_list\_free(line\_and\_cmt); } else { toks = rz\_str\_split\_duplist\_n\_regex(line, "[[:blank:]]+", 0, true); } ut32 toks\_len = rz\_list\_length(toks); if (rz\_list\_empty(toks)) { continue; }
 const char \*first\_tok = rz\_list\_get\_n(toks, 0); if (first\_tok[0] == '#') { // Comment line continue; } else if (first\_tok[0] == '=') { // Alias if (toks\_len != 2) { RZ\_LOG\_WARN("Invalid number of %d columns in alias \"%s\" at line %d. 2 needed.\n", toks\_len, line, l); continue; } is\_alias = true; } else if (isalpha(first\_tok[0])) { if (toks\_len != 5 && toks\_len != 6) { RZ\_LOG\_WARN("Invalid number of %d columns in definition \"%s\" at line %d. 5 or 6 needed.\n", toks\_len, line, l); continue; } } else { RZ\_LOG\_WARN("Invalid line \"%s\" at register profiles line %d.\n", line, l); continue; } bool success = is\_alias ? parse\_alias(alias\_list, toks) : parse\_def(def\_list, toks); if (!success) { RZ\_LOG\_WARN("Parsing error in \"%s\" at line %d.\n", line, l); rz\_list\_free(toks); rz\_list\_free(def\_lines); return false; } is\_alias = false; rz\_list\_free(toks); } rz\_list\_free(def\_lines);
 return true;}
static void add\_item\_to\_regset(RZ\_BORROW RzReg \*reg, RZ\_BORROW RzRegItem \*item) { rz\_return\_if\_fail(reg && item); RzRegisterType t = item->arena;
 if (!reg->regset[t].regs) { reg->regset[t].regs = rz\_list\_newf((RzListFree)rz\_reg\_item\_free); } if (!reg->regset[t].ht\_regs) { reg->regset[t].ht\_regs = ht\_pp\_new0(); }
 // Dynamically update the list of supported bit sizes reg->bits |= item->size; rz\_list\_append(reg->regset[t].regs, item); ht\_pp\_insert(reg->regset[t].ht\_regs, item->name, item);
 // Update the overall type of registers into a regset if (item->type == RZ\_REG\_TYPE\_ANY) { reg->regset[t].maskregstype = UT32\_MAX; return; } reg->regset[t].maskregstype |= ((int)1 << item->type);}
/\*\* \* \brief Fills \p reg->regset with the definitions and alias of the register profile. \* \* \param reg The RzReg struct which holds the register profile and an empty \p reg->regset \* \return false On failure. \* \return true On success. \*/RZ\_API bool rz\_reg\_set\_reg\_profile(RZ\_BORROW RzReg \*reg) { rz\_return\_val\_if\_fail(reg, false); rz\_return\_val\_if\_fail(reg->reg\_profile.alias && reg->reg\_profile.defs, false);
 RzListIter \*it; RzRegProfileAlias \*alias; rz\_list\_foreach (reg->reg\_profile.alias, it, alias) { if (!rz\_reg\_set\_name(reg, alias->role, alias->reg\_name)) { RZ\_LOG\_WARN("Invalid alias gviven.\n"); return false; } } RzRegProfileDef \*def; rz\_list\_foreach (reg->reg\_profile.defs, it, def) { RzRegItem \*item = RZ\_NEW0(RzRegItem); if (!item) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; }
 item->name = strdup(def->name);
 item->type = def->type; item->arena = def->arena\_type;
 item->size = def->size; item->offset = def->offset; // Update the overall profile size if (item->offset + item->size > reg->size) { reg->size = item->offset + item->size; }
 item->packed\_size = def->packed;
 if (def->comment) { item->comment = strdup(def->comment); } if (def->flags) { item->flags = strdup(def->flags); }
 add\_item\_to\_regset(reg, item); }
 return true;}
/\*\* \* \brief Parses a register profile string and sets up all registers accordingly in \p reg. \* \* \param reg The RzReg struct which should hold the register data. \* \param profile The register profile string. \* \return false On failure; \* \return true On success. \*/RZ\_API bool rz\_reg\_set\_profile\_string(RZ\_NONNULL RzReg \*reg, RZ\_NONNULL const char \*profile\_str) { rz\_return\_val\_if\_fail(reg && profile\_str, false); // Same profile, no need to change if (reg->reg\_profile\_str && !strcmp(reg->reg\_profile\_str, profile\_str)) { return true; }
 // we should reset all the arenas before setting the new reg profile rz\_reg\_arena\_pop(reg); // Purge the old registers rz\_reg\_free\_internal(reg, true); rz\_reg\_arena\_shrink(reg);
 // Cache the profile string reg->reg\_profile\_str = strdup(profile\_str); reg->reg\_profile.defs = rz\_list\_newf((RzListFree)rz\_reg\_profile\_def\_free); reg->reg\_profile.alias = rz\_list\_newf((RzListFree)rz\_reg\_profile\_alias\_free); rz\_return\_val\_if\_fail(reg->reg\_profile.defs && reg->reg\_profile.alias, true);
 if (!parse\_reg\_profile\_str(reg->reg\_profile.alias, reg->reg\_profile.defs, profile\_str)) { RZ\_LOG\_WARN("Could not parse register profile string.\n"); rz\_reg\_free\_internal(reg, false); return false; }
 // Check for duplicates RzListIter \*it, \*tmp; RzRegProfileDef \*def; rz\_list\_foreach\_safe (reg->reg\_profile.defs, it, tmp, def) { if (rz\_reg\_get(reg, def->name, RZ\_REG\_TYPE\_ANY)) { RZ\_LOG\_WARN("Ignoring duplicated register definition '%s'.\n", def->name); rz\_list\_delete(reg->reg\_profile.defs, it); } }
 if (!rz\_reg\_set\_reg\_profile(reg)) { RZ\_LOG\_WARN("Could not set reg profile.\n"); return false; }
 reg->size = 0; for (ut32 i = 0; i < RZ\_REG\_TYPE\_LAST; i++) { RzRegSet \*rs = &reg->regset[i]; if (rs && rs->arena) { reg->size += rs->arena->size; // Sums minimum arena size. } }
 rz\_reg\_fit\_arena(reg); // dup the last arena to allow regdiffing rz\_reg\_arena\_push(reg); rz\_reg\_reindex(reg); return true;}
RZ\_API bool rz\_reg\_set\_profile(RzReg \*reg, const char \*profile) { rz\_return\_val\_if\_fail(reg && profile, false); char \*base, \*file; char \*str = rz\_file\_slurp(profile, NULL); if (!str) { base = rz\_sys\_getenv(RZ\_LIB\_ENV); if (base) { file = rz\_str\_append(base, profile); str = rz\_file\_slurp(file, NULL); free(file); } } if (!str) { eprintf("rz\_reg\_set\_profile: Cannot find '%s'\n", profile); return false; } bool ret = rz\_reg\_set\_profile\_string(reg, str); free(str); return ret;}
static char \*gdb\_to\_rz\_profile(const char \*gdb) { rz\_return\_val\_if\_fail(gdb, NULL); RzStrBuf \*sb = rz\_strbuf\_new(""); if (!sb) { return NULL; } char \*ptr1, \*gptr, \*gptr1; char name[16], groups[128], type[16]; const int all = 1, gpr = 2, save = 4, restore = 8, float\_ = 16, sse = 32, vector = 64, system = 128, mmx = 256; int number, rel, offset, size, type\_bits, ret; // Every line is - // Name Number Rel Offset Size Type Groups const char \*ptr = rz\_str\_trim\_head\_ro(gdb);
 // It's possible someone includes the heading line too. Skip it if (rz\_str\_startswith(ptr, "Name")) { if (!(ptr = strchr(ptr, '\n'))) { rz\_strbuf\_free(sb); return NULL; } ptr++; } for (;;) { // Skip whitespace at beginning of line and empty lines while (isspace((ut8)\*ptr)) { ptr++; } if (!\*ptr) { break; } if ((ptr1 = strchr(ptr, '\n'))) { \*ptr1 = '\0'; } else { eprintf("Could not parse line: %s (missing \\n)\n", ptr); rz\_strbuf\_free(sb); return false; } ret = sscanf(ptr, " %s %d %d %d %d %s %s", name, &number, &rel, &offset, &size, type, groups); // Groups is optional, others not if (ret < 6) { if (\*ptr != '\*') { eprintf("Could not parse line: %s\n", ptr); rz\_strbuf\_free(sb); return NULL; } ptr = ptr1 + 1; continue; } // If name is '', then skip if (rz\_str\_startswith(name, "''")) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } // If size is 0, skip if (size == 0) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } type\_bits = 0; // Parse group if (ret >= 7) { gptr = groups; while (1) { if ((gptr1 = strchr(gptr, ','))) { \*gptr1 = '\0'; } if (rz\_str\_startswith(gptr, "general")) { type\_bits |= gpr; } else if (rz\_str\_startswith(gptr, "all")) { type\_bits |= all; } else if (rz\_str\_startswith(gptr, "save")) { type\_bits |= save; } else if (rz\_str\_startswith(gptr, "restore")) { type\_bits |= restore; } else if (rz\_str\_startswith(gptr, "float")) { type\_bits |= float\_; } else if (rz\_str\_startswith(gptr, "sse")) { type\_bits |= sse; } else if (rz\_str\_startswith(gptr, "mmx")) { type\_bits |= mmx; } else if (rz\_str\_startswith(gptr, "vector")) { type\_bits |= vector; } else if (rz\_str\_startswith(gptr, "system")) { type\_bits |= system; } if (!gptr1) { break; } gptr = gptr1 + 1; } } // If type is not defined, skip if (!\*type) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } // TODO: More mappings between gdb and rizin reg groups. For now, either fpu or gpr if (!(type\_bits & sse) && !(type\_bits & float\_)) { type\_bits |= gpr; } // Print line rz\_strbuf\_appendf(sb, "%s\t%s\t.%d\t%d\t0\n", // Ref: Comment above about more register type mappings ((type\_bits & mmx) || (type\_bits & float\_) || (type\_bits & sse)) ? "fpu" : "gpr", name, size \* 8, offset); // Go to next line if (!ptr1) { break; } ptr = ptr1 + 1; continue; } return rz\_strbuf\_drain(sb);}
RZ\_API char \*rz\_reg\_parse\_gdb\_profile(const char \*profile\_file) { char \*str = NULL; if (!(str = rz\_file\_slurp(profile\_file, NULL))) { char \*base = rz\_sys\_getenv(RZ\_LIB\_ENV); if (base) { char \*file = rz\_str\_appendf(base, RZ\_SYS\_DIR "%s", profile\_file); if (file) { str = rz\_file\_slurp(file, NULL); free(file); } } } if (str) { char \*ret = gdb\_to\_rz\_profile(str); free(str); return ret; } eprintf("rz\_reg\_parse\_gdb\_profile: Cannot find '%s'\n", profile\_file); return NULL;}
RZ\_API char \*rz\_reg\_profile\_to\_cc(RzReg \*reg) { const char \*r0 = rz\_reg\_get\_name\_by\_type(reg, "R0"); const char \*a0 = rz\_reg\_get\_name\_by\_type(reg, "A0"); const char \*a1 = rz\_reg\_get\_name\_by\_type(reg, "A1"); const char \*a2 = rz\_reg\_get\_name\_by\_type(reg, "A2"); const char \*a3 = rz\_reg\_get\_name\_by\_type(reg, "A3");
 if (!a0) { RZ\_LOG\_WARN("It is mandatory to have at least one argument register defined in the register profile.\n"); return NULL; } if (!r0) { r0 = a0; } if (a3 && a2 && a1) { return rz\_str\_newf("%s reg(%s, %s, %s, %s)", r0, a0, a1, a2, a3); } if (a2 && a1) { return rz\_str\_newf("%s reg(%s, %s, %s)", r0, a0, a1, a2); } if (a1) { return rz\_str\_newf("%s reg(%s, %s)", r0, a0, a1); } return rz\_str\_newf("%s reg(%s)", r0, a0);}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1063f6cc_20250115_093008.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fpull%2F3422)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fpull%2F3422)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rizinorg%2Frizin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rizinorg](/rizinorg)
/
**[rizin](/rizinorg/rizin)**
Public

* [Notifications](/login?return_to=%2Frizinorg%2Frizin) You must be signed in to change notification settings
* [Fork
  373](/login?return_to=%2Frizinorg%2Frizin)
* [Star
   2.8k](/login?return_to=%2Frizinorg%2Frizin)

* [Code](/rizinorg/rizin)
* [Issues
  411](/rizinorg/rizin/issues)
* [Pull requests
  50](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects
  10](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

Additional navigation options

* [Code](/rizinorg/rizin)
* [Issues](/rizinorg/rizin/issues)
* [Pull requests](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frizinorg%2Frizin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frizinorg%2Frizin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix conversion from GDB register profile to rizin profile #3422

 Merged

[ret2libc](/ret2libc)
merged 2 commits into
[dev](/rizinorg/rizin/tree/dev "rizinorg/rizin:dev")
from
[gdbr-profile-fix](/rizinorg/rizin/tree/gdbr-profile-fix "rizinorg/rizin:gdbr-profile-fix")

Mar 14, 2023

 Merged

# [Fix conversion from GDB register profile to rizin profile](#top) #3422

[ret2libc](/ret2libc)
merged 2 commits into
[dev](/rizinorg/rizin/tree/dev "rizinorg/rizin:dev")
from
[gdbr-profile-fix](/rizinorg/rizin/tree/gdbr-profile-fix "rizinorg/rizin:gdbr-profile-fix")

Mar 14, 2023

[Conversation
1](/rizinorg/rizin/pull/3422)
[Commits
2](/rizinorg/rizin/pull/3422/commits)
[Checks
0](/rizinorg/rizin/pull/3422/checks)
[Files changed](/rizinorg/rizin/pull/3422/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ret2libc](https://avatars.githubusercontent.com/u/562321?s=60&v=4)](/ret2libc)

Copy link

Member

### @ret2libc **[ret2libc](/ret2libc)** commented [Mar 13, 2023](#issue-1621976412)

**Your checklist for this pull request**

* I've read the [guidelines for contributing](https://github.com/rizinorg/rizin/blob/master/DEVELOPERS.md) to this repository
* I made sure to follow the project's [coding style](https://github.com/rizinorg/rizin/blob/master/DEVELOPERS.md#code-style)
* I've documented or updated the documentation of every function and struct this PR changes. If not so I've explained why.
* I've added tests that prove my fix is effective or that my feature works (if possible)
* I've updated the [rizin book](https://github.com/rizinorg/book) with the relevant information (if needed)

**Detailed description**

`scanf("%s")` uses are not safe, limit the number of characters read.

**Test plan**

...

**Closing issues**

...

Sorry, something went wrong.

All reactions

 [![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
requested review from
[XVilka](/XVilka),
[wargio](/wargio),
[yossizap](/yossizap),
[kazarmy](/kazarmy) and
[thestr4ng3r](/thestr4ng3r)
as [code owners](/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/CODEOWNERS#L1)
[March 13, 2023 17:55](#event-8734753722)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
[API](/rizinorg/rizin/labels/API)
[GDB](/rizinorg/rizin/labels/GDB)
[RzDebug](/rizinorg/rizin/labels/RzDebug)
[RzReg](/rizinorg/rizin/labels/RzReg)
labels
[Mar 13, 2023](#event-8734756147)

[![wargio](https://avatars.githubusercontent.com/u/561184?s=60&v=4)](/wargio)

**[wargio](/wargio)**
approved these changes
[Mar 14, 2023](#pullrequestreview-1338216036)

 [View reviewed changes](/rizinorg/rizin/pull/3422/files)

[![XVilka](https://avatars.githubusercontent.com/u/203261?s=60&v=4)](/XVilka)

**[XVilka](/XVilka)**
approved these changes
[Mar 14, 2023](#pullrequestreview-1338337405)

 [View reviewed changes](/rizinorg/rizin/pull/3422/files)

[![@XVilka](https://avatars.githubusercontent.com/u/203261?s=80&u=1f62654dd929e7c04961142f54d270675289da7f&v=4)](/XVilka)

Copy link

Member

### **[XVilka](/XVilka)** commented [Mar 14, 2023](#issuecomment-1467262594)

| ``` Translation unit diagnostic at <rizin/librz/debug/p/debug_gdb.c:221:4>: 'sscanf' may overflow; destination buffer in argument 3 has size 99, but the corresponding specifier may require size 101  ``` |
| --- |

All reactions

Sorry, something went wrong.

 [![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
[force-pushed](/rizinorg/rizin/compare/e963336b3b9348f527fd8c15cb4989794c889d43..ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807)
the
gdbr-profile-fix

branch
from
[`e963336`](/rizinorg/rizin/commit/e963336b3b9348f527fd8c15cb4989794c889d43) to
[`ee5827f`](/rizinorg/rizin/commit/ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807)  [Compare](/rizinorg/rizin/compare/e963336b3b9348f527fd8c15cb4989794c889d43..ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807)
[March 14, 2023 08:23](#event-8740468676)

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&v=4)](/ret2libc)

`[Fix conversion from GDB register profile to rizin profile](/rizinorg/rizin/pull/3422/commits/504bf2a911b316c1431f634027fe7e31045a1a29 "Fix conversion from GDB register profile to rizin profile")`

`[504bf2a](/rizinorg/rizin/pull/3422/commits/504bf2a911b316c1431f634027fe7e31045a1a29)`

 [![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
[force-pushed](/rizinorg/rizin/compare/ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807..504bf2a911b316c1431f634027fe7e31045a1a29)
the
gdbr-profile-fix

branch
from
[`ee5827f`](/rizinorg/rizin/commit/ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807) to
[`504bf2a`](/rizinorg/rizin/commit/504bf2a911b316c1431f634027fe7e31045a1a29)  [Compare](/rizinorg/rizin/compare/ee5827f51a4c1d5c0c4b9b2e746b90f98cc0b807..504bf2a911b316c1431f634027fe7e31045a1a29)
[March 14, 2023 08:40](#event-8740629099)

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
added this to the [0.5.2](/rizinorg/rizin/milestone/17) milestone
[Mar 14, 2023](#event-8740809407)

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&v=4)](/ret2libc)

`[Merge branch 'dev' into gdbr-profile-fix](/rizinorg/rizin/pull/3422/commits/731b55bd5e085f1bbc1d24fb305046e4713bc40b "Merge branch 'dev' into gdbr-profile-fix")`

`[731b55b](/rizinorg/rizin/pull/3422/commits/731b55bd5e085f1bbc1d24fb305046e4713bc40b)`

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
enabled auto-merge (rebase)
[March 14, 2023 10:16](#event-8741656806)

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&u=fe8de9fa20540877d7dcf11f7c229452a6a1c70d&v=4)](/ret2libc)
[ret2libc](/ret2libc)
merged commit [`d619670`](/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4)
into
dev

[Mar 14, 2023](https://github.com/rizinorg/rizin/pull/3422#event-8741921301)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fpull%2F3422)

Reviewers

[![@wargio](https://avatars.githubusercontent.com/u/561184?s=40&v=4)](/wargio) [wargio](/wargio)

wargio approved these changes

[![@XVilka](https://avatars.githubusercontent.com/u/203261?s=40&v=4)](/XVilka) [XVilka](/XVilka)

XVilka approved these changes

[![@yossizap](https://avatars.githubusercontent.com/u/5659696?s=40&v=4)](/yossizap) [yossizap](/yossizap)

 Awaiting requested review from yossizap

 yossizap is a code owner

[![@kazarmy](https://avatars.githubusercontent.com/u/12002672?s=40&v=4)](/kazarmy) [kazarmy](/kazarmy)

 Awaiting requested review from kazarmy

 kazarmy is a code owner

[![@thestr4ng3r](https://avatars.githubusercontent.com/u/1460997?s=40&v=4)](/thestr4ng3r) [thestr4ng3r](/thestr4ng3r)

 Awaiting requested review from thestr4ng3r

 thestr4ng3r is a code owner

Assignees

No one assigned

Labels

[API](/rizinorg/rizin/labels/API)
[GDB](/rizinorg/rizin/labels/GDB)
[RzDebug](/rizinorg/rizin/labels/RzDebug)
[RzReg](/rizinorg/rizin/labels/RzReg)

Projects

None yet

Milestone

 [**0.5.2**](/rizinorg/rizin/milestone/17 "0.5.2")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=52&v=4)](/ret2libc) [![@XVilka](https://avatars.githubusercontent.com/u/203261?s=52&v=4)](/XVilka) [![@wargio](https://avatars.githubusercontent.com/u/561184?s=52&v=4)](/wargio)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_352a343d_20250115_093005.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fcommit%2Fd6196703d89c84467b600ba2692534579dc25ed4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fcommit%2Fd6196703d89c84467b600ba2692534579dc25ed4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=rizinorg%2Frizin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rizinorg](/rizinorg)
/
**[rizin](/rizinorg/rizin)**
Public

* [Notifications](/login?return_to=%2Frizinorg%2Frizin) You must be signed in to change notification settings
* [Fork
  373](/login?return_to=%2Frizinorg%2Frizin)
* [Star
   2.8k](/login?return_to=%2Frizinorg%2Frizin)

* [Code](/rizinorg/rizin)
* [Issues
  411](/rizinorg/rizin/issues)
* [Pull requests
  50](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects
  10](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

Additional navigation options

* [Code](/rizinorg/rizin)
* [Issues](/rizinorg/rizin/issues)
* [Pull requests](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

## Commit

[Permalink](/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix conversion from GDB register profile to rizin profile

[Browse files](/rizinorg/rizin/tree/d6196703d89c84467b600ba2692534579dc25ed4)
Browse the repository at this point in the history

* Loading branch information

[![@ret2libc](https://avatars.githubusercontent.com/u/562321?s=40&v=4)](/ret2libc)

[ret2libc](/rizinorg/rizin/commits?author=ret2libc "View all commits by ret2libc")
committed
Mar 14, 2023

1 parent
[e7eae14](/rizinorg/rizin/commit/e7eae14ea1e9fe57d61dae325a380fb0c53b45c4)

commit d619670

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**26 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* librz

  + debug/p

    - librz/debug/p/debug\_gdb.c
      [debug\_gdb.c](#diff-610fb9ca5a5a573344204f461ece9f841782fd05f602a4d0b2a898222b552651)
    - librz/debug/p/debug\_io.c
      [debug\_io.c](#diff-d2cdcd92b70a1d8a231a7302202e875e6e6e38ec9c29269bca7fc38240c8c264)
  + include

    - librz/include/rz\_types\_base.h
      [rz\_types\_base.h](#diff-f76adc9753278faa4c82f0548eb09a5e2689b0ea7cdca191a3815e92a6764099)
  + reg

    - librz/reg/profile.c
      [profile.c](#diff-e8e7f73567a4e9345c38e8c28469fb10871e5d8452f6f35673f1c783ab6bcbf2)

## There are no files selected for viewing

13 changes: 10 additions & 3 deletions

13
[librz/debug/p/debug\_gdb.c](#diff-610fb9ca5a5a573344204f461ece9f841782fd05f602a4d0b2a898222b552651 "librz/debug/p/debug_gdb.c")

Show comments

[View file](/rizinorg/rizin/blob/d6196703d89c84467b600ba2692534579dc25ed4/librz/debug/p/debug_gdb.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,13 @@ typedef struct { |
|  |  | #define UNSUPPORTED 0 |
|  |  | #define SUPPORTED 1 |
|  |  |  |
|  |  | #define PROC\_NAME\_SZ 1024 |
|  |  | #define PROC\_REGION\_SZ 100 |
|  |  | // PROC\_REGION\_SZ - 2 (used for `0x`). Due to how RZ\_STR\_DEF works this can't be |
|  |  | // computed. |
|  |  | #define PROC\_REGION\_LEFT\_SZ 98 |
|  |  | #define PROC\_PERM\_SZ 5 |
|  |  |  |
|  |  | typedef struct rz\_debug\_gdb\_ctx\_t { |
|  |  | RzIOGdb \*\*origrziogdb; |
|  |  | libgdbr\_t \*desc; |
| Expand Down  Expand Up | | @@ -189,7 +196,7 @@ static RzList /\*<RzDebugMap \*>\*/ \*rz\_debug\_gdb\_map\_get(RzDebug \*dbg) { // TODO |
|  |  | int unk = 0, perm, i; |
|  |  | char \*ptr, \*pos\_1; |
|  |  | size\_t line\_len; |
|  |  | char name[1024], region1[100], region2[100], perms[5]; |
|  |  | char name[PROC\_NAME\_SZ + 1], region1[PROC\_REGION\_SZ + 1], region2[PROC\_REGION\_SZ + 1], perms[PROC\_PERM\_SZ + 1]; |
|  |  | RzDebugMap \*map = NULL; |
|  |  | region1[0] = region2[0] = '0'; |
|  |  | region1[1] = region2[1] = 'x'; |
| Expand All | | @@ -213,8 +220,8 @@ static RzList /\*<RzDebugMap \*>\*/ \*rz\_debug\_gdb\_map\_get(RzDebug \*dbg) { // TODO |
|  |  | } |
|  |  | // We assume Linux target, for now, so - |
|  |  | // 7ffff7dda000-7ffff7dfd000 r-xp 00000000 08:05 265428 /usr/lib/ld-2.25.so |
|  |  | ret = sscanf(ptr, "%s %s %" PFMT64x " %\*s %\*s %[^\n]", &region1[2], |
|  |  | perms, &offset, name); |
|  |  | ret = sscanf(ptr, "%" RZ\_STR\_DEF(PROC\_REGION\_LEFT\_SZ) "s %" RZ\_STR\_DEF(PROC\_PERM\_SZ) "s %" PFMT64x " %\*s %\*s %" RZ\_STR\_DEF(PROC\_NAME\_SZ) "[^\n]", |
|  |  | &region1[2], perms, &offset, name); |
|  |  | if (ret == 3) { |
|  |  | name[0] = '\0'; |
|  |  | } else if (ret != 4) { |
| Expand Down | |  |

9 changes: 6 additions & 3 deletions

9
[librz/debug/p/debug\_io.c](#diff-d2cdcd92b70a1d8a231a7302202e875e6e6e38ec9c29269bca7fc38240c8c264 "librz/debug/p/debug_io.c")

Show comments

[View file](/rizinorg/rizin/blob/d6196703d89c84467b600ba2692534579dc25ed4/librz/debug/p/debug_io.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,9 @@ |
|  |  | #include <rz\_io.h> |
|  |  | #include <rz\_debug.h> |
|  |  |  |
|  |  | #define IO\_MAPS\_PERM\_SZ 32 |
|  |  | #define IO\_MAPS\_NAME\_SZ 512 |
|  |  |  |
|  |  | static int \_\_io\_step(RzDebug \*dbg) { |
|  |  | free(dbg->iob.system(dbg->iob.io, "ds")); |
|  |  | return true; |
| Expand All | | @@ -23,8 +26,8 @@ static RzList /\*<RzDebugMap \*>\*/ \*\_\_io\_maps(RzDebug \*dbg) { |
|  |  | } |
|  |  | char \*ostr = str; |
|  |  | ut64 map\_start, map\_end; |
|  |  | char perm[32]; |
|  |  | char name[512]; |
|  |  | char perm[IO\_MAPS\_PERM\_SZ + 1]; |
|  |  | char name[IO\_MAPS\_NAME\_SZ + 1]; |
|  |  | for (;;) { |
|  |  | char \*nl = strchr(str, '\n'); |
|  |  | if (nl) { |
| Expand All | | @@ -48,7 +51,7 @@ static RzList /\*<RzDebugMap \*>\*/ \*\_\_io\_maps(RzDebug \*dbg) { |
|  |  | if (\_s\_) { |
|  |  | memmove(\_s\_, \_s\_ + 2, strlen(\_s\_)); |
|  |  | } |
|  |  | sscanf(str, "0x%" PFMT64x " - 0x%" PFMT64x " %s %s", |
|  |  | sscanf(str, "0x%" PFMT64x " - 0x%" PFMT64x " %" RZ\_STR\_DEF(IO\_MAPS\_PERM\_SZ) "s %" RZ\_STR\_DEF(IO\_MAPS\_NAME\_SZ) "s", |
|  |  | &map\_start, &map\_end, perm, name); |
|  |  | if (map\_end != 0LL) { |
|  |  | RzDebugMap \*map = rz\_debug\_map\_new(name, map\_start, map\_end, rz\_str\_rwx(perm), 0); |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[librz/include/rz\_types\_base.h](#diff-f76adc9753278faa4c82f0548eb09a5e2689b0ea7cdca191a3815e92a6764099 "librz/include/rz_types_base.h")

Show comments

[View file](/rizinorg/rizin/blob/d6196703d89c84467b600ba2692534579dc25ed4/librz/include/rz_types_base.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -214,4 +214,7 @@ typedef struct \_utX { |
|  |  | return m ? \*m = n, m : m; \ |
|  |  | } |
|  |  |  |
|  |  | #define RZ\_STR\_DEF(s) RZ\_STR(s) |
|  |  | #define RZ\_STR(s) #s |
|  |  |  |
|  |  | #endif // RZ\_TYPES\_BASE\_H |

10 changes: 7 additions & 3 deletions

10
[librz/reg/profile.c](#diff-e8e7f73567a4e9345c38e8c28469fb10871e5d8452f6f35673f1c783ab6bcbf2 "librz/reg/profile.c")

Show comments

[View file](/rizinorg/rizin/blob/d6196703d89c84467b600ba2692534579dc25ed4/librz/reg/profile.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,10 @@ |
|  |  | #include <rz\_lib.h> |
|  |  | #include <string.h> |
|  |  |  |
|  |  | #define GDB\_NAME\_SZ 16 |
|  |  | #define GDB\_TYPE\_SZ 16 |
|  |  | #define GDB\_GROUPS\_SZ 128 |
|  |  |  |
|  |  | static void rz\_reg\_profile\_def\_free(RzRegProfileDef \*def) { |
|  |  | if (!def) { |
|  |  | return; |
| Expand Down  Expand Up | | @@ -511,7 +515,7 @@ static char \*gdb\_to\_rz\_profile(const char \*gdb) { |
|  |  | return NULL; |
|  |  | } |
|  |  | char \*ptr1, \*gptr, \*gptr1; |
|  |  | char name[16], groups[128], type[16]; |
|  |  | char name[GDB\_NAME\_SZ + 1], groups[GDB\_GROUPS\_SZ + 1], type[GDB\_TYPE\_SZ + 1]; |
|  |  | const int all = 1, gpr = 2, save = 4, restore = 8, float\_ = 16, |
|  |  | sse = 32, vector = 64, system = 128, mmx = 256; |
|  |  | int number, rel, offset, size, type\_bits, ret; |
| Expand Down  Expand Up | | @@ -542,8 +546,8 @@ static char \*gdb\_to\_rz\_profile(const char \*gdb) { |
|  |  | rz\_strbuf\_free(sb); |
|  |  | return false; |
|  |  | } |
|  |  | ret = sscanf(ptr, " %s %d %d %d %d %s %s", name, &number, &rel, |
|  |  | &offset, &size, type, groups); |
|  |  | ret = sscanf(ptr, " %" RZ\_STR\_DEF(GDB\_NAME\_SZ) "s %d %d %d %d %" RZ\_STR\_DEF(GDB\_TYPE\_SZ) "s %" RZ\_STR\_DEF(GDB\_GROUPS\_SZ) "s", |
|  |  | name, &number, &rel, &offset, &size, type, groups); |
|  |  | // Groups is optional, others not |
|  |  | if (ret < 6) { |
|  |  | if (\*ptr != '\*') { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d619670`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fcommit%2Fd6196703d89c84467b600ba2692534579dc25ed4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_aa1d5752_20250115_093010.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fsecurity%2Fadvisories%2FGHSA-rqcp-m8m2-jcqf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fsecurity%2Fadvisories%2FGHSA-rqcp-m8m2-jcqf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=rizinorg%2Frizin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rizinorg](/rizinorg)
/
**[rizin](/rizinorg/rizin)**
Public

* [Notifications](/login?return_to=%2Frizinorg%2Frizin) You must be signed in to change notification settings
* [Fork
  373](/login?return_to=%2Frizinorg%2Frizin)
* [Star
   2.8k](/login?return_to=%2Frizinorg%2Frizin)

* [Code](/rizinorg/rizin)
* [Issues
  411](/rizinorg/rizin/issues)
* [Pull requests
  50](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects
  10](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

Additional navigation options

* [Code](/rizinorg/rizin)
* [Issues](/rizinorg/rizin/issues)
* [Pull requests](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

# Stack-based buffer overflow when parsing GDB registers profile files

Moderate

[ret2libc](/ret2libc)
published
GHSA-rqcp-m8m2-jcqf
Mar 14, 2023

## Package

rizin
(C)

## Affected versions

<=v0.5.1

## Patched versions

0.5.2

## Description

### Impact

Converting a GDB registers profile file into a Rizin register profile can result in a stack-based buffer overflow when the `name`, `type` or `groups` fields have longer values than expected. Users opening untrusted GDB registers files (e.g. with the `drpg` or `arpg` commands) are affected by this flaw.

### Patches

[#3422](https://github.com/rizinorg/rizin/pull/3422)

[d619670](https://github.com/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4)

### Workarounds

Review the GDB register profiles before loading them with `drpg`/`arpg` commands.

### References

* [rizin/librz/reg/profile.c](https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L514)

  Line 514
  in
  [3a7d511](/rizinorg/rizin/commit/3a7d5116244beb678ad9950bb9dd27d28ed2691f)

  |  | char name[16], groups[128], type[16]; |
  | --- | --- |
* [rizin/librz/reg/profile.c](https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L545)

  Line 545
  in
  [3a7d511](/rizinorg/rizin/commit/3a7d5116244beb678ad9950bb9dd27d28ed2691f)

  |  | ret = sscanf(ptr, " %s %d %d %d %d %s %s", name, &number, &rel, |
  | --- | --- |
* [#3422](https://github.com/rizinorg/rizin/pull/3422)

### Severity

Moderate

### CVE ID

CVE-2023-27590

### Weaknesses

[CWE-121](/advisories?query=cwe%3A121)

### Credits

* [![@yeggor](https://avatars.githubusercontent.com/u/22826617?s=40&v=4)](/yeggor)
  [yeggor](/yeggor)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_c2715667_20250115_093011.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y.mbox.gz?message=WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/#WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y)

# [SECURITY] Fedora 38 Update: rizin-0.5.2-1.fc38.2

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

12 Jul
2023

12 Jul
'23

3:26 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2023-3dc1f9ba12
2023-07-12 01:25:39.603769
--------------------------------------------------------------------------------

Name : rizin
Product : Fedora 38
Version : 0.5.2
Release : 1.fc38.2
URL : <https://rizin.re/>
Summary : UNIX-like reverse engineering framework and command-line tool-set
Description :
Rizin is a free and open-source Reverse Engineering framework, providing a
complete binary analysis experience with features like Disassembler,
Hexadecimal editor, Emulation, Binary inspection, Debugger, and more.

Rizin is a fork of radare2 with a focus on usability, working features and code
cleanliness.

--------------------------------------------------------------------------------
Update Information:

rebase to rizin 0.5.2 and cutter 2.2.1
--------------------------------------------------------------------------------
ChangeLog:

\* Wed May 17 2023 Riccardo Schirone rschirone91@gmail.com - 0.5.2-1
- Rebase to upstream version 0.5.2
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2178823 - CVE-2023-27590 rizin: stack-based buffer overflow [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2178823>
[ 2 ] Bug #2182162 - rizin-0.5.2 is available
<https://bugzilla.redhat.com/show_bug.cgi?id=2182162>
[ 3 ] Bug #2203912 - cutter-re-2.2.1 is available
<https://bugzilla.redhat.com/show_bug.cgi?id=2203912>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2023-3dc1f9ba12' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/#WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_d9ffb265_20250115_092958.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fblob%2F3a7d5116244beb678ad9950bb9dd27d28ed2691f%2Flibrz%2Freg%2Fprofile.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frizinorg%2Frizin%2Fblob%2F3a7d5116244beb678ad9950bb9dd27d28ed2691f%2Flibrz%2Freg%2Fprofile.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rizinorg%2Frizin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rizinorg](/rizinorg)
/
**[rizin](/rizinorg/rizin)**
Public

* [Notifications](/login?return_to=%2Frizinorg%2Frizin) You must be signed in to change notification settings
* [Fork
  373](/login?return_to=%2Frizinorg%2Frizin)
* [Star
   2.8k](/login?return_to=%2Frizinorg%2Frizin)

* [Code](/rizinorg/rizin)
* [Issues
  411](/rizinorg/rizin/issues)
* [Pull requests
  50](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects
  10](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

Additional navigation options

* [Code](/rizinorg/rizin)
* [Issues](/rizinorg/rizin/issues)
* [Pull requests](/rizinorg/rizin/pulls)
* [Discussions](/rizinorg/rizin/discussions)
* [Actions](/rizinorg/rizin/actions)
* [Projects](/rizinorg/rizin/projects)
* [Security](/rizinorg/rizin/security)
* [Insights](/rizinorg/rizin/pulse)

## Files

 3a7d511
## Breadcrumbs

1. [rizin](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f)
2. /[librz](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz)
3. /[reg](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg)
/
# profile.c

Copy path Blame  Blame
## Latest commit

## History

[History](/rizinorg/rizin/commits/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c)678 lines (623 loc) · 18 KB 3a7d511
## Breadcrumbs

1. [rizin](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f)
2. /[librz](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz)
3. /[reg](/rizinorg/rizin/tree/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg)
/
# profile.c

Top
## File metadata and controls

* Code
* Blame

678 lines (623 loc) · 18 KB[Raw](https://github.com/rizinorg/rizin/raw/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678// SPDX-FileCopyrightText: 2009-2020 pancake <pancake@nopcode.org>// SPDX-License-Identifier: LGPL-3.0-only
#include <rz\_list.h>#include <rz\_util/rz\_log.h>#include <rz\_util/rz\_str.h>#include <rz\_reg.h>#include <rz\_util.h>#include <rz\_util/rz\_assert.h>#include <rz\_lib.h>#include <string.h>
static void rz\_reg\_profile\_def\_free(RzRegProfileDef \*def) { if (!def) { return; } free(def->name); free(def->comment); free(def->flags); free(def);}
static void rz\_reg\_profile\_alias\_free(RzRegProfileAlias \*alias) { if (!alias) { return; } free(alias->reg\_name); free(alias->alias); free(alias);}
/\*\* \* Like rz\_reg\_type\_by\_name, but warn if non-existent \*/static int expect\_reg\_type\_by\_name(const char \*str) { int r = rz\_reg\_type\_by\_name(str); if (r < 0) { RZ\_LOG\_WARN("No register type for type abbreviation \"%s\".\n", str); } return r;}
/\*\* \* \brief Parses a register type string. \* \* The type string must be of the following form: \* \* <sub-type>@<main-type> \* \* "<sub-type>@" is optional. \* \* \param item Register item whichs types are set. \* \param type\_str The type string. \* \return true On success. \* \return false On failure. \*/static bool parse\_type(RZ\_OUT RzRegProfileDef \*def, const char \*type\_str) { rz\_return\_val\_if\_fail(def && type\_str, false); char \*s = strdup(type\_str); char \*at = strchr(s, '@'); if (at) { // This register has a secondary type e.g. xmm@fpu def->arena\_type = expect\_reg\_type\_by\_name(at + 1); s[at - s] = '\0'; def->type = expect\_reg\_type\_by\_name(s); } else { def->type = expect\_reg\_type\_by\_name(s); def->arena\_type = def->type; if (def->type == RZ\_REG\_TYPE\_FLG) { // Hack to put flgs into gpr arena. def->arena\_type = RZ\_REG\_TYPE\_GPR; } else { def->arena\_type = def->type; } } bool res = true; if (def->type < 0 || def->arena\_type < 0) { RZ\_LOG\_ERROR("Illegal type abbreviation \"%s\"\n", s); res = false; } free(s); return res;}
/\*\* \* \brief Parses the size of a register definition. \* Sizes with . in front are in bits. Otherwise in bytes. \* \* \param s Size string. \* \return ut32 The size as integer or UT64\_MAX if it fails. \*/static ut32 parse\_size(char \*s) { rz\_return\_val\_if\_fail(s, UT32\_MAX); if (s[0] == '.') { return strtoul(s + 1, NULL, 0); } else { return strtoul(s, NULL, 0) \* 8; }}
/\*\* \* \brief Parses the offset of a register defintion and sets the offset in \p def->offset. \* \* Offset is of the form: <byte>.<bit> \* .<bit> is optional. \* \* \param s Offset string. \* \param def The defintion item to store the offset into \p def->offset in bits. \* \return false On failure (sets def->offset = UT32\_MAX). \* \return true On success. \*/static bool parse\_offset(const char \*s, RZ\_OUT RzRegProfileDef \*def) { rz\_return\_val\_if\_fail(s && def, false); if (s[0] == '?') { def->offset = UT32\_MAX; return true; } else if (s[0] == '.') { def->offset = strtoul(s + 1, NULL, 0); return true; } def->offset = strtoul(s, NULL, 0) \* 8;
 const char \*bi = strchr(s, '.'); if (!bi) { // No bit offset given. return true; }
 ut8 bit\_offset = strtoul(bi + 1, NULL, 0); def->offset += bit\_offset; return true;}
/\*\* \* \brief Parses a register alias. \* \* The alias is of the form: \* "=<alias> <reg name>" \* \* \param reg The RzReg struct with the register profile. \* \param tokens A list with both tokens of the alias string. \* \return true On success. \* \return false On Failure. \*/static bool parse\_alias(RZ\_OUT RzList /\*<RzRegProfileAlias \*>\*/ \*alias\_list, RZ\_BORROW RzList /\*<char \*>\*/ \*tokens) { rz\_return\_val\_if\_fail(alias\_list && tokens, false); RzRegProfileAlias \*pa = RZ\_NEW0(RzRegProfileAlias); if (!pa) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; }
 const char \*real\_name = rz\_list\_get\_n(tokens, 1); const char \*alias = rz\_list\_get\_n(tokens, 0); if (!alias) { RZ\_LOG\_WARN("Failed to get alias name from token.\n"); free(pa); return false; }
 RzRegisterId role = rz\_reg\_get\_name\_idx(alias + 1); if (!(role >= 0 && role < RZ\_REG\_NAME\_LAST)) { RZ\_LOG\_WARN("Invalid alias\n"); free(pa); return false; }
 pa->alias = strdup(alias); pa->reg\_name = strdup(real\_name); pa->role = role; rz\_list\_append(alias\_list, pa);
 return true;}
/\*\* \* \brief Parses a register definition. \* \* \param reg Register struct with the register profile. \* \param tokens List of strings of a single register definition. \* \return false On failure. \* \return true On success. \*/static bool parse\_def(RZ\_OUT RzList /\*<RzRegProfileDef \*>\*/ \*def\_list, RZ\_BORROW RzList /\*<char \*>\*/ \*tokens) { rz\_return\_val\_if\_fail(def\_list && tokens, false);
 RzRegProfileDef \*def = RZ\_NEW0(RzRegProfileDef); if (!def) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; } const char \*name = rz\_list\_get\_n(tokens, 1); if (!name) { goto reg\_parse\_error; } def->name = strdup(name);
 if (!parse\_type(def, rz\_list\_get\_n(tokens, 0))) { RZ\_LOG\_WARN("Invalid register type.\n"); goto reg\_parse\_error; }
 def->size = parse\_size(rz\_list\_get\_n(tokens, 2)); if (def->size == UT32\_MAX || def->size == 0) { RZ\_LOG\_WARN("Invalid register size.\n"); goto reg\_parse\_error; }
 def->packed = parse\_size(rz\_list\_get\_n(tokens, 4)); if (def->packed == UT32\_MAX) { RZ\_LOG\_WARN("Invalid register packed size.\n"); goto reg\_parse\_error; }
 if (!parse\_offset(rz\_list\_get\_n(tokens, 3), def)) { RZ\_LOG\_WARN("Invalid register offset.\n"); goto reg\_parse\_error; }
 // Comments and flags are optional if (rz\_list\_length(tokens) == 6) { const char \*comment\_flag = rz\_list\_get\_n(tokens, 5); if (!comment\_flag) { goto reg\_parse\_error; } if (comment\_flag[0] == '#') { // Remove # from the comment def->comment = strdup(comment\_flag + 1); } else { def->flags = strdup(comment\_flag); } } RZ\_LOG\_DEBUG("profile: register def: %s %d %d %s\n", def->name, def->size, def->offset, def->flags); rz\_list\_append(def\_list, def);
 return true;
reg\_parse\_error: rz\_reg\_profile\_def\_free(def); return false;}
/\*\* \* \brief Parses a register profile string. Each line is either a register alias or a register definiton. \* \* A register alias string is of the following form: \* "=<alias> <name>\n" \* \* A register definition string is of the following form: \* "(<sub-type>@)main-type <name> .<size> <byte offset>(.<bit offset>) <packed> (# <comment> OR <flags>)\n" \* \* Elements in "()" are optional. \* Each "<...>" token is separated by tab or space characters. \* \* \* alias: Register alias (e.g. PC, A1 etc.) \* \* name: Register name. \* \* size: Register size in bits. \* \* main-type: Register type: gpr, fpr, ctr, flg etc. \* \* sub-type: The second register type (e.g. xmm@fpu : xmm is sub-type of fpu) \* \* byte offset: Offset into register profile in bytes. \* \* bit offset: Offset into the byte offset in bits. \* \* packed: Packed size of the register in bytes. \* \* comment: A comment about the register. \* \* Flags this register holds. \* \* \param reg Register struct which holds all register items. \* \param profile Register profile string. \* \return false On failure. \* \return true On success. \*/static bool parse\_reg\_profile\_str(RZ\_OUT RzList /\*<RzRegProfileAlias \*>\*/ \*alias\_list, RZ\_OUT RzList /\*<RzRegProfileDef \*>\*/ \*def\_list, const char \*profile\_str) { rz\_return\_val\_if\_fail(alias\_list && def\_list && profile\_str, false);
 RzList \*def\_lines = rz\_str\_split\_duplist\_n(profile\_str, "\n", 0, true); rz\_return\_val\_if\_fail(def\_lines, false);
 st32 l = 0; // Line number const char \*line; bool is\_alias = false; RzListIter \*it; RzList \*toks = NULL; rz\_list\_foreach (def\_lines, it, line) { ++l; if (RZ\_STR\_ISEMPTY(line)) { continue; } if (rz\_str\_strchr(line, "#")) { RzList \*line\_and\_cmt = rz\_str\_split\_duplist\_n\_regex(line, "#", 0, true); char \*raw\_comment = strdup(rz\_list\_get\_top(line\_and\_cmt)); if (!raw\_comment) { RZ\_LOG\_WARN("Comment could not be split from register definition. Line: \"%s\"\n", line); continue; } char \*tmp = rz\_str\_prepend(raw\_comment, "#"); if (!tmp) { RZ\_LOG\_WARN("Could not prepend # to comment. Line: \"%s\".\n", line); continue; } char \*comment = strdup(tmp); toks = rz\_str\_split\_duplist\_n\_regex(rz\_list\_get\_bottom(line\_and\_cmt), "[[:blank:]]+", 0, true); rz\_list\_append(toks, comment); rz\_list\_free(line\_and\_cmt); } else { toks = rz\_str\_split\_duplist\_n\_regex(line, "[[:blank:]]+", 0, true); } ut32 toks\_len = rz\_list\_length(toks); if (rz\_list\_empty(toks)) { continue; }
 const char \*first\_tok = rz\_list\_get\_n(toks, 0); if (first\_tok[0] == '#') { // Comment line continue; } else if (first\_tok[0] == '=') { // Alias if (toks\_len != 2) { RZ\_LOG\_WARN("Invalid number of %d columns in alias \"%s\" at line %d. 2 needed.\n", toks\_len, line, l); continue; } is\_alias = true; } else if (isalpha(first\_tok[0])) { if (toks\_len != 5 && toks\_len != 6) { RZ\_LOG\_WARN("Invalid number of %d columns in definition \"%s\" at line %d. 5 or 6 needed.\n", toks\_len, line, l); continue; } } else { RZ\_LOG\_WARN("Invalid line \"%s\" at register profiles line %d.\n", line, l); continue; } bool success = is\_alias ? parse\_alias(alias\_list, toks) : parse\_def(def\_list, toks); if (!success) { RZ\_LOG\_WARN("Parsing error in \"%s\" at line %d.\n", line, l); rz\_list\_free(toks); rz\_list\_free(def\_lines); return false; } is\_alias = false; rz\_list\_free(toks); } rz\_list\_free(def\_lines);
 return true;}
static void add\_item\_to\_regset(RZ\_BORROW RzReg \*reg, RZ\_BORROW RzRegItem \*item) { rz\_return\_if\_fail(reg && item); RzRegisterType t = item->arena;
 if (!reg->regset[t].regs) { reg->regset[t].regs = rz\_list\_newf((RzListFree)rz\_reg\_item\_free); } if (!reg->regset[t].ht\_regs) { reg->regset[t].ht\_regs = ht\_pp\_new0(); }
 // Dynamically update the list of supported bit sizes reg->bits |= item->size; rz\_list\_append(reg->regset[t].regs, item); ht\_pp\_insert(reg->regset[t].ht\_regs, item->name, item);
 // Update the overall type of registers into a regset if (item->type == RZ\_REG\_TYPE\_ANY) { reg->regset[t].maskregstype = UT32\_MAX; return; } reg->regset[t].maskregstype |= ((int)1 << item->type);}
/\*\* \* \brief Fills \p reg->regset with the definitions and alias of the register profile. \* \* \param reg The RzReg struct which holds the register profile and an empty \p reg->regset \* \return false On failure. \* \return true On success. \*/RZ\_API bool rz\_reg\_set\_reg\_profile(RZ\_BORROW RzReg \*reg) { rz\_return\_val\_if\_fail(reg, false); rz\_return\_val\_if\_fail(reg->reg\_profile.alias && reg->reg\_profile.defs, false);
 RzListIter \*it; RzRegProfileAlias \*alias; rz\_list\_foreach (reg->reg\_profile.alias, it, alias) { if (!rz\_reg\_set\_name(reg, alias->role, alias->reg\_name)) { RZ\_LOG\_WARN("Invalid alias gviven.\n"); return false; } } RzRegProfileDef \*def; rz\_list\_foreach (reg->reg\_profile.defs, it, def) { RzRegItem \*item = RZ\_NEW0(RzRegItem); if (!item) { RZ\_LOG\_WARN("Unable to allocate memory.\n"); return false; }
 item->name = strdup(def->name);
 item->type = def->type; item->arena = def->arena\_type;
 item->size = def->size; item->offset = def->offset; // Update the overall profile size if (item->offset + item->size > reg->size) { reg->size = item->offset + item->size; }
 item->packed\_size = def->packed;
 if (def->comment) { item->comment = strdup(def->comment); } if (def->flags) { item->flags = strdup(def->flags); }
 add\_item\_to\_regset(reg, item); }
 return true;}
/\*\* \* \brief Parses a register profile string and sets up all registers accordingly in \p reg. \* \* \param reg The RzReg struct which should hold the register data. \* \param profile The register profile string. \* \return false On failure; \* \return true On success. \*/RZ\_API bool rz\_reg\_set\_profile\_string(RZ\_NONNULL RzReg \*reg, RZ\_NONNULL const char \*profile\_str) { rz\_return\_val\_if\_fail(reg && profile\_str, false); // Same profile, no need to change if (reg->reg\_profile\_str && !strcmp(reg->reg\_profile\_str, profile\_str)) { return true; }
 // we should reset all the arenas before setting the new reg profile rz\_reg\_arena\_pop(reg); // Purge the old registers rz\_reg\_free\_internal(reg, true); rz\_reg\_arena\_shrink(reg);
 // Cache the profile string reg->reg\_profile\_str = strdup(profile\_str); reg->reg\_profile.defs = rz\_list\_newf((RzListFree)rz\_reg\_profile\_def\_free); reg->reg\_profile.alias = rz\_list\_newf((RzListFree)rz\_reg\_profile\_alias\_free); rz\_return\_val\_if\_fail(reg->reg\_profile.defs && reg->reg\_profile.alias, true);
 if (!parse\_reg\_profile\_str(reg->reg\_profile.alias, reg->reg\_profile.defs, profile\_str)) { RZ\_LOG\_WARN("Could not parse register profile string.\n"); rz\_reg\_free\_internal(reg, false); return false; }
 // Check for duplicates RzListIter \*it, \*tmp; RzRegProfileDef \*def; rz\_list\_foreach\_safe (reg->reg\_profile.defs, it, tmp, def) { if (rz\_reg\_get(reg, def->name, RZ\_REG\_TYPE\_ANY)) { RZ\_LOG\_WARN("Ignoring duplicated register definition '%s'.\n", def->name); rz\_list\_delete(reg->reg\_profile.defs, it); } }
 if (!rz\_reg\_set\_reg\_profile(reg)) { RZ\_LOG\_WARN("Could not set reg profile.\n"); return false; }
 reg->size = 0; for (ut32 i = 0; i < RZ\_REG\_TYPE\_LAST; i++) { RzRegSet \*rs = &reg->regset[i]; if (rs && rs->arena) { reg->size += rs->arena->size; // Sums minimum arena size. } }
 rz\_reg\_fit\_arena(reg); // dup the last arena to allow regdiffing rz\_reg\_arena\_push(reg); rz\_reg\_reindex(reg); return true;}
RZ\_API bool rz\_reg\_set\_profile(RzReg \*reg, const char \*profile) { rz\_return\_val\_if\_fail(reg && profile, false); char \*base, \*file; char \*str = rz\_file\_slurp(profile, NULL); if (!str) { base = rz\_sys\_getenv(RZ\_LIB\_ENV); if (base) { file = rz\_str\_append(base, profile); str = rz\_file\_slurp(file, NULL); free(file); } } if (!str) { eprintf("rz\_reg\_set\_profile: Cannot find '%s'\n", profile); return false; } bool ret = rz\_reg\_set\_profile\_string(reg, str); free(str); return ret;}
static char \*gdb\_to\_rz\_profile(const char \*gdb) { rz\_return\_val\_if\_fail(gdb, NULL); RzStrBuf \*sb = rz\_strbuf\_new(""); if (!sb) { return NULL; } char \*ptr1, \*gptr, \*gptr1; char name[16], groups[128], type[16]; const int all = 1, gpr = 2, save = 4, restore = 8, float\_ = 16, sse = 32, vector = 64, system = 128, mmx = 256; int number, rel, offset, size, type\_bits, ret; // Every line is - // Name Number Rel Offset Size Type Groups const char \*ptr = rz\_str\_trim\_head\_ro(gdb);
 // It's possible someone includes the heading line too. Skip it if (rz\_str\_startswith(ptr, "Name")) { if (!(ptr = strchr(ptr, '\n'))) { rz\_strbuf\_free(sb); return NULL; } ptr++; } for (;;) { // Skip whitespace at beginning of line and empty lines while (isspace((ut8)\*ptr)) { ptr++; } if (!\*ptr) { break; } if ((ptr1 = strchr(ptr, '\n'))) { \*ptr1 = '\0'; } else { eprintf("Could not parse line: %s (missing \\n)\n", ptr); rz\_strbuf\_free(sb); return false; } ret = sscanf(ptr, " %s %d %d %d %d %s %s", name, &number, &rel, &offset, &size, type, groups); // Groups is optional, others not if (ret < 6) { if (\*ptr != '\*') { eprintf("Could not parse line: %s\n", ptr); rz\_strbuf\_free(sb); return NULL; } ptr = ptr1 + 1; continue; } // If name is '', then skip if (rz\_str\_startswith(name, "''")) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } // If size is 0, skip if (size == 0) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } type\_bits = 0; // Parse group if (ret >= 7) { gptr = groups; while (1) { if ((gptr1 = strchr(gptr, ','))) { \*gptr1 = '\0'; } if (rz\_str\_startswith(gptr, "general")) { type\_bits |= gpr; } else if (rz\_str\_startswith(gptr, "all")) { type\_bits |= all; } else if (rz\_str\_startswith(gptr, "save")) { type\_bits |= save; } else if (rz\_str\_startswith(gptr, "restore")) { type\_bits |= restore; } else if (rz\_str\_startswith(gptr, "float")) { type\_bits |= float\_; } else if (rz\_str\_startswith(gptr, "sse")) { type\_bits |= sse; } else if (rz\_str\_startswith(gptr, "mmx")) { type\_bits |= mmx; } else if (rz\_str\_startswith(gptr, "vector")) { type\_bits |= vector; } else if (rz\_str\_startswith(gptr, "system")) { type\_bits |= system; } if (!gptr1) { break; } gptr = gptr1 + 1; } } // If type is not defined, skip if (!\*type) { if (!ptr1) { break; } ptr = ptr1 + 1; continue; } // TODO: More mappings between gdb and rizin reg groups. For now, either fpu or gpr if (!(type\_bits & sse) && !(type\_bits & float\_)) { type\_bits |= gpr; } // Print line rz\_strbuf\_appendf(sb, "%s\t%s\t.%d\t%d\t0\n", // Ref: Comment above about more register type mappings ((type\_bits & mmx) || (type\_bits & float\_) || (type\_bits & sse)) ? "fpu" : "gpr", name, size \* 8, offset); // Go to next line if (!ptr1) { break; } ptr = ptr1 + 1; continue; } return rz\_strbuf\_drain(sb);}
RZ\_API char \*rz\_reg\_parse\_gdb\_profile(const char \*profile\_file) { char \*str = NULL; if (!(str = rz\_file\_slurp(profile\_file, NULL))) { char \*base = rz\_sys\_getenv(RZ\_LIB\_ENV); if (base) { char \*file = rz\_str\_appendf(base, RZ\_SYS\_DIR "%s", profile\_file); if (file) { str = rz\_file\_slurp(file, NULL); free(file); } } } if (str) { char \*ret = gdb\_to\_rz\_profile(str); free(str); return ret; } eprintf("rz\_reg\_parse\_gdb\_profile: Cannot find '%s'\n", profile\_file); return NULL;}
RZ\_API char \*rz\_reg\_profile\_to\_cc(RzReg \*reg) { const char \*r0 = rz\_reg\_get\_name\_by\_type(reg, "R0"); const char \*a0 = rz\_reg\_get\_name\_by\_type(reg, "A0"); const char \*a1 = rz\_reg\_get\_name\_by\_type(reg, "A1"); const char \*a2 = rz\_reg\_get\_name\_by\_type(reg, "A2"); const char \*a3 = rz\_reg\_get\_name\_by\_type(reg, "A3");
 if (!a0) { RZ\_LOG\_WARN("It is mandatory to have at least one argument register defined in the register profile.\n"); return NULL; } if (!r0) { r0 = a0; } if (a3 && a2 && a1) { return rz\_str\_newf("%s reg(%s, %s, %s, %s)", r0, a0, a1, a2, a3); } if (a2 && a1) { return rz\_str\_newf("%s reg(%s, %s, %s)", r0, a0, a1, a2); } if (a1) { return rz\_str\_newf("%s reg(%s, %s)", r0, a0, a1); } return rz\_str\_newf("%s reg(%s)", r0, a0);}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


