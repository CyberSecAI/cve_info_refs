```
{
  "vulnerability": {
    "root_cause": "The vulnerability stems from the use of a pre-hashing technique with SHA-384, which is not binary-safe, before using bcrypt for password storage. Specifically, bcrypt in PHP's `crypt()` function treats the password as a null-terminated string and ignores characters after the first null byte. When pre-hashing with SHA-384, the raw output might contain null bytes, leading to the same bcrypt hash being generated for different passwords that have a common prefix up to the first null byte.",
    "weaknesses": [
      "Improper implementation of password storage using pre-hashing with a non-binary safe hash function",
      "Usage of bcrypt in a way that it truncates passwords at the first null byte"
    ],
    "impact": "An attacker who has access to both the bcrypt-hashed password from the vulnerable system and a SHA-384 hash of a password from another source can potentially bypass the bcrypt protection using a technique known as 'password shucking.' They can find collisions and crack the password more easily than expected. It was determined that, on average, 1 out of 256 passwords would have a leading null byte after SHA-256 hashing, which could be used to forge valid hashes.",
    "attack_vectors": [
        "An attacker obtains a user's bcrypt password hash from the vulnerable system.",
        "The attacker also has access to a SHA-384 hash (without salt) of the same user's password from a different compromised source.",
        "By comparing these hashes, the attacker can bypass bcrypt and focus on cracking the much weaker SHA-384 hash or using known SHA-384 hashes."
      ],
    "required_attacker_capabilities": "The attacker needs access to two separate pieces of information: a bcrypt hash from the vulnerable system and a corresponding unsalted SHA-384 hash of the same password from another source. The attacker also needs the ability to test the hashes and understand password shucking."
  }
}
```