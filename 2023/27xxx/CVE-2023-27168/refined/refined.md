**Root cause of vulnerability:**
- The vulnerability is due to an unrestricted file upload flaw in the Write-Back manager. Specifically, the file extension is validated *after* the file has already been written to disk. The error handling routines do not delete the invalid file when an `InvalidFileExtentionException` is thrown. This same code pattern is reused on other file upload endpoints, such as SSL certificate and JDBC driver uploads.

**Weaknesses/vulnerabilities present:**
- Unrestricted file upload: The system allows uploading files with unauthorized extensions, despite server-side validation attempts, since the validation occurs after the file is written to disk.
- Directory traversal (chained with CVE-2023-27170): By introducing special characters in the filename, an attacker can write files to arbitrary locations on the filesystem.
- Weak JWT secret (chained with CVE-2023-27172): An attacker can bypass authentication using a weak JWT secret.

**Impact of exploitation:**
- Remote code execution with SYSTEM privileges: By uploading a malicious file (e.g., a .jsp webshell) and exploiting the directory traversal vulnerability, an attacker can execute arbitrary code with the same privileges as the web server (NT Authority/System in this case).
- Full system control: Due to the high privileges of the web server, successful exploitation allows an attacker to take full control of the vulnerable system.
- Unauthenticated access (chained with CVE-2023-27172): An unauthenticated attacker can achieve remote code execution by chaining this with the weak JWT vulnerability.

**Attack vectors:**
- File upload functionality within the Write-Back Manager web UI, specifically the logo upload feature (also affects SSL certificate and JDBC driver uploads).
- Exploitation of directory traversal using special characters in the filename.
- Chaining with weak JWT secret to bypass authentication.

**Required attacker capabilities/position:**
- Network access to the vulnerable Write-Back Manager instance.
- Ability to upload files through the web interface.
- No authentication is needed if chaining with the weak JWT vulnerability.

**Additional notes:**
- This vulnerability is a chain of multiple vulnerabilities.
- The vulnerability affects Write-Back Manager v2.3.1.
- The vendor has released a patch in version 4.1 to address the vulnerability.