=== Content from github.com_482cf526_20250114_200421.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxpert-idea%2Fxipblog%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxpert-idea%2Fxipblog%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=xpert-idea%2Fxipblog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xpert-idea](/xpert-idea)
/
**[xipblog](/xpert-idea/xipblog)**
Public

* [Notifications](/login?return_to=%2Fxpert-idea%2Fxipblog) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fxpert-idea%2Fxipblog)
* [Star
   33](/login?return_to=%2Fxpert-idea%2Fxipblog)

Prestashop 1.6 & 1.7 Xpert Blog Module

[xpert-idea.com](http://xpert-idea.com "http://xpert-idea.com")

### License

[GPL-3.0 license](/xpert-idea/xipblog/blob/master/LICENSE)

[33
stars](/xpert-idea/xipblog/stargazers) [27
forks](/xpert-idea/xipblog/forks) [Branches](/xpert-idea/xipblog/branches) [Tags](/xpert-idea/xipblog/tags) [Activity](/xpert-idea/xipblog/activity)
 [Star](/login?return_to=%2Fxpert-idea%2Fxipblog)

 [Notifications](/login?return_to=%2Fxpert-idea%2Fxipblog) You must be signed in to change notification settings

* [Code](/xpert-idea/xipblog)
* [Issues
  22](/xpert-idea/xipblog/issues)
* [Pull requests
  0](/xpert-idea/xipblog/pulls)
* [Actions](/xpert-idea/xipblog/actions)
* [Projects
  0](/xpert-idea/xipblog/projects)
* [Security](/xpert-idea/xipblog/security)
* [Insights](/xpert-idea/xipblog/pulse)

Additional navigation options

* [Code](/xpert-idea/xipblog)
* [Issues](/xpert-idea/xipblog/issues)
* [Pull requests](/xpert-idea/xipblog/pulls)
* [Actions](/xpert-idea/xipblog/actions)
* [Projects](/xpert-idea/xipblog/projects)
* [Security](/xpert-idea/xipblog/security)
* [Insights](/xpert-idea/xipblog/pulse)

# xpert-idea/xipblog

    master[Branches](/xpert-idea/xipblog/branches)[Tags](/xpert-idea/xipblog/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[33 Commits](/xpert-idea/xipblog/commits/master/) | | |
| [classes](/xpert-idea/xipblog/tree/master/classes "classes") | | [classes](/xpert-idea/xipblog/tree/master/classes "classes") |  |  |
| [config](/xpert-idea/xipblog/tree/master/config "config") | | [config](/xpert-idea/xipblog/tree/master/config "config") |  |  |
| [controllers](/xpert-idea/xipblog/tree/master/controllers "controllers") | | [controllers](/xpert-idea/xipblog/tree/master/controllers "controllers") |  |  |
| [css](/xpert-idea/xipblog/tree/master/css "css") | | [css](/xpert-idea/xipblog/tree/master/css "css") |  |  |
| [data](/xpert-idea/xipblog/tree/master/data "data") | | [data](/xpert-idea/xipblog/tree/master/data "data") |  |  |
| [db](/xpert-idea/xipblog/tree/master/db "db") | | [db](/xpert-idea/xipblog/tree/master/db "db") |  |  |
| [img](/xpert-idea/xipblog/tree/master/img "img") | | [img](/xpert-idea/xipblog/tree/master/img "img") |  |  |
| [js](/xpert-idea/xipblog/tree/master/js "js") | | [js](/xpert-idea/xipblog/tree/master/js "js") |  |  |
| [views/templates](/xpert-idea/xipblog/tree/master/views/templates "This path skips through empty directories") | | [views/templates](/xpert-idea/xipblog/tree/master/views/templates "This path skips through empty directories") |  |  |
| [.gitignore](/xpert-idea/xipblog/blob/master/.gitignore ".gitignore") | | [.gitignore](/xpert-idea/xipblog/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE](/xpert-idea/xipblog/blob/master/LICENSE "LICENSE") | | [LICENSE](/xpert-idea/xipblog/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/xpert-idea/xipblog/blob/master/README.md "README.md") | | [README.md](/xpert-idea/xipblog/blob/master/README.md "README.md") |  |  |
| [ajax.php](/xpert-idea/xipblog/blob/master/ajax.php "ajax.php") | | [ajax.php](/xpert-idea/xipblog/blob/master/ajax.php "ajax.php") |  |  |
| [index.php](/xpert-idea/xipblog/blob/master/index.php "index.php") | | [index.php](/xpert-idea/xipblog/blob/master/index.php "index.php") |  |  |
| [logo.png](/xpert-idea/xipblog/blob/master/logo.png "logo.png") | | [logo.png](/xpert-idea/xipblog/blob/master/logo.png "logo.png") |  |  |
| [xipblog.php](/xpert-idea/xipblog/blob/master/xipblog.php "xipblog.php") | | [xipblog.php](/xpert-idea/xipblog/blob/master/xipblog.php "xipblog.php") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-3.0 license
# xipblog

This is blog module for prestashop. It has many many amazing features. Standard, Gallery, Audio, Video post format available on this blog module.

* For prestashop 1.7.x.x version : Avobe 2.0.0 module version.
* For prestashop 1.6.x.x version : 0.0.1 to 1.99.99 module version.

# Child Modules

If you can display xipblog posts on your theme, just installed bellow modules ....

* [xipblogdisplayposts](https://github.com/xpert-idea/xipblogdisplayposts)

# Demo

Please [click here](http://xpert-idea.com/prestashop/jakiro/demo/nine/en/)  to see the blog demo.

# Documentation

Please [click here](https://www.youtube.com/channel/UC0TS71jcnQ7pJJMTqluBI3Q)  to follow our youtube channel for the blog module documentation.

# Important Notice

If you are Theme author, you can use and include this Modules as free to build your themes for sale.

# Support

If you fetch any issue to use our blog module please go to our site and contact with us by comment your issue on this [post.](http://xpert-idea.com/2016/10/15/powerfull-prestashop-blog-module-is-free-from-now/)

# Who We Are

We are author of themeforest, Please [click here](https://themeforest.net/user/xpert-idea/portfolio?ref=xpert-idea) to see our profile . Also you can visit our website. <http://xpert-idea.com/>

You can also visit our premimum prestashop themes:

* [Platinum Prestashop 1.6 & 1.7 Theme](https://themeforest.net/item/platinum-fashion-accessories-prestashop-theme/19208559?ref=xpert-idea)
* [Jakiro Prestashop 1.6 & 1.7 Theme](https://themeforest.net/item/jakiro-fashion-shop-prestashop-theme/14100073?ref=xpert-idea)
* [Great Store Prestashop 1.6 Theme](https://themeforest.net/item/great-store-ecommerce-prestashop-theme/18303739?ref=xpert-idea)

## About

Prestashop 1.6 & 1.7 Xpert Blog Module

[xpert-idea.com](http://xpert-idea.com "http://xpert-idea.com")

### Topics

[blog](/topics/blog "Topic: blog")
[blog-engine](/topics/blog-engine "Topic: blog-engine")
[prestashop](/topics/prestashop "Topic: prestashop")
[prestashop-api](/topics/prestashop-api "Topic: prestashop-api")
[prestashop-webservice](/topics/prestashop-webservice "Topic: prestashop-webservice")
[blog-example](/topics/blog-example "Topic: blog-example")
[prestashop-module](/topics/prestashop-module "Topic: prestashop-module")
[prestashop-theme](/topics/prestashop-theme "Topic: prestashop-theme")
[prestashop-free-module](/topics/prestashop-free-module "Topic: prestashop-free-module")
[prestashop-1-6](/topics/prestashop-1-6 "Topic: prestashop-1-6")
[prestashop-1-7](/topics/prestashop-1-7 "Topic: prestashop-1-7")
[prestashop-webservices](/topics/prestashop-webservices "Topic: prestashop-webservices")
[prestashopblog](/topics/prestashopblog "Topic: prestashopblog")
[blogmodule](/topics/blogmodule "Topic: blogmodule")
[prestashop-blog](/topics/prestashop-blog "Topic: prestashop-blog")
[blog-module](/topics/blog-module "Topic: blog-module")
[prestashop-blog-theme](/topics/prestashop-blog-theme "Topic: prestashop-blog-theme")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-3.0 license](#GPL-3.0-1-ov-file)

[Activity](/xpert-idea/xipblog/activity)
### Stars

[**33**
stars](/xpert-idea/xipblog/stargazers)
### Watchers

[**7**
watching](/xpert-idea/xipblog/watchers)
### Forks

[**27**
forks](/xpert-idea/xipblog/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fxpert-idea%2Fxipblog&report=xpert-idea+%28user%29)

## [Releases](/xpert-idea/xipblog/releases)

No releases published

## [Packages 0](/users/xpert-idea/packages?repo_name=xipblog)

No packages published

## [Contributors 9](/xpert-idea/xipblog/graphs/contributors)

## Languages

* [PHP
  71.1%](/xpert-idea/xipblog/search?l=php)
* [Smarty
  23.5%](/xpert-idea/xipblog/search?l=smarty)
* [CSS
  5.4%](/xpert-idea/xipblog/search?l=css)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from friends-of-presta.github.io_be2c28f4_20250114_200419.html ===

[Friends-Of-Presta Security Advisories](/)

[Cybersecurity Glossary](/glossary/)[About](/about/)

**IMPORTANT NOTICE**: DO NOT REPORT VULNERABILITIES SOLELY TO THE AUTHOR OR MARKETPLACE.

We urge you to report any vulnerabilities directly to us. Our mission is to ensure the safety and security of the PrestaShop ecosystem. Unfortunately, many module developers may not always recognize or acknowledge the vulnerabilities in their code, whether due to lack of awareness, or inability to properly evaluate the associated risk, or other reasons.

Given the rise in professional cybercrime networks actively seeking out these vulnerabilities, it's crucial that any potential threats are promptly addressed and the community is informed. The most effective method to do this is by publishing a CVE, like the one provided below.

Should you discover any vulnerabilities, **please report them to us at: report[@]security-presta.org** or visit [https://security-presta.org](https://security-presta.org/) for more information.

Every vulnerability report helps make the community more secure, and we are profoundly grateful for any information shared with us.

# [CVE-2023-27847] Improper neutralization of multiple SQL parameters in the xipblog module for PrestaShop

Mar 23, 2023
• #modules • critical (9.8) •
202-ecommerce.com,
sorcery.ie,
Friends-Of-Presta.org

In the blog module (xipblog), an anonymous user can perform SQL injection. Even though the module has been patched in version 2.0.1, the version number was not incremented at the time. We consider the issue resolved in versions after 2.0.1.

## Summary

* **CVE ID**: [CVE-2023-27847](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27847)
* **Published at**: 2023-03-23
* **Advisory source**: Friends-of-Presta.org
* **Platform**: PrestaShop
* **Product**: xipblog
* **Impacted release**: <= 2.0.1
* **Product author**: xpert-idea
* **Weakness**: [CWE-89](https://cwe.mitre.org/data/definitions/89.html)
* **Severity**: critical (9.8)

## Description

In xipblog module for PrestaShop up to 2.0.1, multiple sensitive SQL calls on `xipcategoryclass` and `xippostsclass` can be executed with a trivial http call and exploited to forge a blind SQL injection, for instance, using the POST or GET submitted “rewrite” variable.

**WARNING**: this module is actively exploited by malicious networks to hijack shops, including deploying web skimmers (automatically substituting payment methods to massively steal credit card information).

This exploit uses a PrestaShop front controller and most attackers can conceal the module controller’s path during the exploit so you will never know within your conventional frontend logs that it exploits this vulnerability. **You will only see “POST /” inside your conventional frontend logs.** Activating the AuditEngine of mod\_security (or similar) is the only way to get data to confirm this exploit.

## CVSS base metrics

* **Attack vector**: network
* **Attack complexity**: low
* **Privilege required**: none
* **User interaction**: none
* **Scope**: unchanged
* **Confidentiality**: high
* **Integrity**: high
* **Availability**: high

**Vector string**: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## Possible malicious usage

* Technical and personal data leaks
* Obtain admin access
* Remove all data of the linked PrestaShop
* Display sensitives tables to front-office to unlock potential admin’s ajax scripts of modules protected by token on the ecosystem

## Proof of concept

```
curl -v 'https://domain.tld/module/xipblog/archive?rewrite=aaa%22;SELECT%20SLEEP(25);--'

```
## Patch

Created by [Emmet from sorcery.ie](https://patch-diff.githubusercontent.com/raw/xpert-idea/xipblog/pull/30.patch)

```
--- a/xipblog/classes/xipcategoryclass.php
+++ b/xipblog/classes/xipcategoryclass.php
@@ -121,7 +121,7 @@ class xipcategoryclass extends ObjectMod
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
 		$sql = 'SELECT xc.`id_xipcategory`,xcl.`name`,xcl.`link_rewrite` FROM `'._DB_PREFIX_.'xipcategory` xc INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.') INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.') ';
-		$sql .= ' WHERE xc.`category_type` = "'.($category_type ? $category_type : 'category').'" AND xc.`id_xipcategory` = '.$id_category;
+		$sql .= ' WHERE xc.`category_type` = "'.($category_type ? pSQL($category_type) : 'category').'" AND xc.`id_xipcategory` = '.$id_category;
 		$rslts = Db::getInstance()->getrow($sql);
 			return $rslts;
     }
@@ -132,7 +132,7 @@ class xipcategoryclass extends ObjectMod
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
 		$sql = 'SELECT xc.`id_xipcategory` FROM `'._DB_PREFIX_.'xipcategory` xc INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.') INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.') ';
-		$sql .= ' WHERE xc.`category_type` = "'.($category_type ? $category_type : 'category').'" AND xcl.`link_rewrite` = "'.$rewrite.'" ';
+		$sql .= ' WHERE xc.`category_type` = "'.($category_type ? pSQL($category_type) : 'category').'" AND xcl.`link_rewrite` = "'.pSQL($rewrite).'" ';
 		$rslts = Db::getInstance()->getrow($sql);
 			return isset($rslts['id_xipcategory']) ? $rslts['id_xipcategory'] : NULL;
     }
@@ -144,9 +144,9 @@ class xipcategoryclass extends ObjectMod
                INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.')
                INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
                ';
-       $sql .= ' WHERE xc.`active` = 1 AND  category_type = "'.$category_type.'" ';
+       $sql .= ' WHERE xc.`active` = 1 AND  category_type = "'.pSQL($category_type).'" ';
 		if($category_group != NULL){
-			$sql .= ' AND category_group = '.$category_group;
+			$sql .= ' AND category_group = "'.pSQL($category_type).'" ';
 		}
        $sql .= ' ORDER BY xc.`position` ASC ';
        return Db::getInstance()->executeS($sql);

--- a/xipblog/classes/xippostsclass.php
+++ b/xipblog/classes/xippostsclass.php
@@ -239,7 +239,7 @@ class xippostsclass extends ObjectModel
     		self::DeleteTagPost($id_post);
     		if(isset($category_ids) && !empty($category_ids)){
     			foreach ($category_ids as $id_category){
-    				$queryval .= '('.(int)$id_post.','.(int)$id_category.',"'.$tag.'"),';
+    				$queryval .= '('.(int)$id_post.','.(int)$id_category.',"'.pSQL($tag).'"),';
     			}
     			$queryval = rtrim($queryval, ',');
     			if(Db::getInstance()->execute('INSERT INTO `'._DB_PREFIX_.'xip_category_post`(`id_post`, `id_category`,`type`) VALUES '.$queryval)){
@@ -270,7 +270,7 @@ class xippostsclass extends ObjectModel
 		INNER JOIN `'._DB_PREFIX_.'xipposts_lang` xcl ON (xc.`id_xipposts` = xcl.`id_xipposts` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipposts_shop` xcs ON (xc.`id_xipposts` = xcs.`id_xipposts` AND xcs.`id_shop` = '.$id_shop.')
 		';
-       $sql .= ' WHERE xc.`post_type` = "'.($post_type?$post_type:'post').'" AND xc.`id_xipposts` = '.$id_post;
+       $sql .= ' WHERE xc.`post_type` = "'.($post_type?pSQL($post_type):'post').'" AND xc.`id_xipposts` = '.$id_post;
        $rslts = Db::getInstance()->getrow($sql);
        		return $rslts;
     }
@@ -281,7 +281,7 @@ class xippostsclass extends ObjectModel
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
 		$sql = 'SELECT xc.`id_xipposts` FROM `'._DB_PREFIX_.'xipposts` xc INNER JOIN `'._DB_PREFIX_.'xipposts_lang` xcl ON (xc.`id_xipposts` = xcl.`id_xipposts` AND xcl.`id_lang` = '.$id_lang.') INNER JOIN `'._DB_PREFIX_.'xipposts_shop` xcs ON (xc.`id_xipposts` = xcs.`id_xipposts` AND xcs.`id_shop` = '.$id_shop.') ';
-		$sql .= ' WHERE xc.`post_type` = "'.($post_type ? $post_type : 'post').'" AND xcl.`link_rewrite` = "'.$rewrite.'" ';
+		$sql .= ' WHERE xc.`post_type` = "'.($post_type ? pSQL($post_type) : 'post').'" AND xcl.`link_rewrite` = "'.pSQL($rewrite).'" ';
 		$rslts = Db::getInstance()->getrow($sql);
 			return isset($rslts['id_xipposts']) ? $rslts['id_xipposts'] : NULL;
     }
@@ -314,7 +314,7 @@ class xippostsclass extends ObjectModel
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
 		';
-       $sql .= ' WHERE xc.`category_type` = "'.($category_type ? $category_type : 'category').'" AND xc.`id_xipcategory` = '.$id_category;
+       $sql .= ' WHERE xc.`category_type` = "'.($category_type ? pSQL($category_type) : 'category').'" AND xc.`id_xipcategory` = '.$id_category;
        $rslts = Db::getInstance()->getrow($sql);
        		return $rslts;
     }
@@ -329,7 +329,7 @@ class xippostsclass extends ObjectModel
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
 		';
-       $sql .= ' WHERE xc.`category_type` = "tag" AND xcl.`name` = "'.$tag.'"';
+       $sql .= ' WHERE xc.`category_type` = "tag" AND xcl.`name` = "'.pSQL($tag).'"';
        $rslts = Db::getInstance()->getrow($sql);
        if(isset($rslts) && !empty($rslts)){
        		return $rslts['id_xipcategory'];
@@ -360,11 +360,11 @@ class xippostsclass extends ObjectModel
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
        $sql = 'SELECT xcl.`name` FROM `'._DB_PREFIX_.'xip_category_post` xcp
-		INNER JOIN `'._DB_PREFIX_.'xipcategory` xc ON (xcp.`id_category` = xc.`id_xipcategory` AND xc.`category_type` = "'.$tag.'")
+		INNER JOIN `'._DB_PREFIX_.'xipcategory` xc ON (xcp.`id_category` = xc.`id_xipcategory` AND xc.`category_type` = "'.pSQL($tag).'")
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xcp.`id_category` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_shop.')
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xcp.`id_category` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
 		';
-       $sql .= ' WHERE xcp.`id_post` = '.$id_post.' AND xcp.`type` = "'.$tag.'"';
+       $sql .= ' WHERE xcp.`id_post` = '.$id_post.' AND xcp.`type` = "'.pSQL($tag).'"';
        $rslts = Db::getInstance()->executeS($sql);
        if(isset($rslts) && !empty($rslts)){
        	$countrslts = count($rslts);
@@ -388,11 +388,11 @@ class xippostsclass extends ObjectModel
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
        $sql = 'SELECT xcp.`id_category`,xcl.`name`,xcl.`link_rewrite` FROM `'._DB_PREFIX_.'xip_category_post` xcp
-		INNER JOIN `'._DB_PREFIX_.'xipcategory` xc ON (xcp.`id_category` = xc.`id_xipcategory` AND xc.`category_type` = "'.$tag.'")
+		INNER JOIN `'._DB_PREFIX_.'xipcategory` xc ON (xcp.`id_category` = xc.`id_xipcategory` AND xc.`category_type` = "'.pSQL($tag).'")
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xcp.`id_category` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_shop.')
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xcp.`id_category` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
 		';
-       $sql .= ' WHERE xcp.`id_post` = '.$id_post.' AND xcp.`type` = "'.$tag.'"';
+       $sql .= ' WHERE xcp.`id_post` = '.$id_post.' AND xcp.`type` = "'.pSQL($tag).'"';
        $rslts = Db::getInstance()->executeS($sql);
        if(isset($rslts) && !empty($rslts)){
        		$i = 0;
@@ -419,7 +419,7 @@ class xippostsclass extends ObjectModel
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_lang` xcl ON (xc.`id_xipcategory` = xcl.`id_xipcategory` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipcategory_shop` xcs ON (xc.`id_xipcategory` = xcs.`id_xipcategory` AND xcs.`id_shop` = '.$id_shop.')
 		';
-		$sql .= ' WHERE xc.`category_type` = "'.$tag.'" ';
+		$sql .= ' WHERE xc.`category_type` = "'.pSQL($tag).'" ';
 		$sql .= ' ORDER BY xc.`id_xipcategory` DESC ';
 		$sql .= ' LIMIT '.(int)$count;
 		$rslts = Db::getInstance()->executeS($sql);
@@ -442,12 +442,13 @@ class xippostsclass extends ObjectModel
     public static function GetCategoryPostsCount($category_default = NULL,$post_type = 'post'){
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
+		$category_default = (int)$category_default;
 		$sql = 'SELECT count(xc.`id_xipposts`) as allxipposts FROM `'._DB_PREFIX_.'xipposts` xc
 		INNER JOIN `'._DB_PREFIX_.'xipposts_lang` xcl ON (xc.`id_xipposts` = xcl.`id_xipposts` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipposts_shop` xcs ON (xc.`id_xipposts` = xcs.`id_xipposts` AND xcs.`id_shop` = '.$id_shop.')
 		';
 		$sql .= ' WHERE xc.`active` = 1 ';
-		if((int)$category_default != 0){
+		if($category_default != 0){
 			$sql .= ' AND xc.category_default = '.$category_default;
 		}
 		if($post_type != NULL){
@@ -466,13 +467,14 @@ class xippostsclass extends ObjectModel
 		$results = array();
 		$id_lang = (int)Context::getContext()->language->id;
 		$id_shop = (int)Context::getContext()->shop->id;
+		$category_default = (int)$category_default;
 		$GetAllImageTypes = xipimagetypeclass::GetAllImageTypes();
 		$sql = 'SELECT * FROM `'._DB_PREFIX_.'xipposts` xc
 		INNER JOIN `'._DB_PREFIX_.'xipposts_lang` xcl ON (xc.`id_xipposts` = xcl.`id_xipposts` AND xcl.`id_lang` = '.$id_lang.')
 		INNER JOIN `'._DB_PREFIX_.'xipposts_shop` xcs ON (xc.`id_xipposts` = xcs.`id_xipposts` AND xcs.`id_shop` = '.$id_shop.')
 		';
 		$sql .= ' WHERE xc.`active` = 1 ';
-		if((int)$category_default != 0){
+		if($category_default != 0){
 			$sql .= ' AND xc.category_default = '.$category_default;
 		}
 		if($post_type != NULL){
@@ -559,7 +561,7 @@ class xippostsclass extends ObjectModel
 		';
 		$sql .= ' WHERE xc.`active` = 1 ';
 		if($post_type != NULL){
-			$sql .= ' AND xc.post_type = "'.$post_type.'" ';
+			$sql .= ' AND xc.post_type = "'.pSQL($post_type).'" ';
 		}
 		$sql .= ' ORDER BY xc.`comment_count` '.$order_by;
 		$sql .= ' LIMIT '.(int)$count;
@@ -642,7 +644,7 @@ class xippostsclass extends ObjectModel
 		';
 		$sql .= ' WHERE xc.`active` = 1 ';
 		if($post_type != NULL){
-			$sql .= ' AND xc.post_type = "'.$post_type.'" ';
+			$sql .= ' AND xc.post_type = "'.pSQL($post_type).'" ';
 		}
 		$sql .= ' ORDER BY xc.`id_xipposts` '.$order_by;
 		$sql .= ' LIMIT '.(int)$count;
@@ -727,7 +729,7 @@ class xippostsclass extends ObjectModel
     public static function PostCountUpdate($id = NULL){
     	if($id == NULL || $id == 0)
     		return false;
-	    $sql = 'UPDATE '._DB_PREFIX_.'xipposts as xc SET xc.comment_count = (xc.comment_count+1) where xc.id_xipposts = '.$id;
+	    $sql = 'UPDATE '._DB_PREFIX_.'xipposts as xc SET xc.comment_count = (xc.comment_count+1) where xc.id_xipposts = '.(int)$id;
 		if(Db::getInstance()->execute($sql))
 			return true;
 		else
@@ -745,7 +747,7 @@ class xippostsclass extends ObjectModel
                INNER JOIN `'._DB_PREFIX_.'xipposts_lang` xcl ON (xc.`id_xipposts` = xcl.`id_xipposts` AND xcl.`id_lang` = '.$id_lang.')
                INNER JOIN `'._DB_PREFIX_.'xipposts_shop` xcs ON (xc.`id_xipposts` = xcs.`id_xipposts` AND xcs.`id_shop` = '.$id_shop.')
                ';
-       $sql .= ' WHERE xc.`active` = 1 AND xc.post_type = "'.$post_type.'" AND xc.id_xipposts = '.(int)$id_post;
+       $sql .= ' WHERE xc.`active` = 1 AND xc.post_type = "'.pSQL($post_type).'" AND xc.id_xipposts = '.(int)$id_post;
        $queryexec = Db::getInstance()->getrow($sql);
        if(isset($queryexec) && !empty($queryexec)){
        		foreach ($queryexec as $qkey => $qvalue) {
@@ -827,7 +829,7 @@ class xippostsclass extends ObjectModel
 		';
 		$sql .= ' WHERE xc.`active` = 1 ';
 		if($post_type != NULL){
-			$sql .= ' AND xc.post_type = "'.$post_type.'" ';
+			$sql .= ' AND xc.post_type = "'.pSQL($post_type).'" ';
 		}
 		$sql .= ' ORDER BY xc.`position`  '.$order_by;
 		$sql .= ' LIMIT '.(((int)$p - 1) * (int)$n).','.(int)$n;

```
## Other recommendations

* It’s recommended to upgrade the module beyond 2.0.1.
* To help improve the security of your PrestaShop installation, we recommend upgrading to the latest version. One of the benefits of upgrading is that it will disable the use of multiquery executions (separated by semicolons). However, please be aware that this **will not protect** your shop against SQL injection attacks that use the UNION clause to steal data. Additionally, it’s important to note that PrestaShop includes a function called pSQL, which includes a strip\_tags function. This helps protect your shop against [Stored XSS (also known as XSS T2) of Category 1](https://security.friendsofpresta.org/modules/2023/02/07/stored-xss.html). If a pSQL function is missing, it could potentially expose your project to critical Stored XSS vulnerabilities due to edge cases. Therefore, it’s crucial to ensure that all relevant functions are properly implemented and used consistently throughout your project.
* Change the default database prefix ps\_ by a new longer arbitrary prefix. Nevertheless, be warned that this is useless against blackhats with DBA senior skill because of a design vulnerability in DBMS
* Activate OWASP 942’s rules on your WAF (Web application firewall), be warned that you will probably break your backoffice and you will need to pre-configure some bypasses against these set of rules.

## Timeline

| Date | Action |
| --- | --- |
| 2022-12-02 | Issue discovered during a code reviews by 202 ecommerce |
| 2023-02-15 | Contact the contributor sorcery.ie that make a fix in January 2021 |
| 2023-03-05 | Request a CVE ID |
| 2023-03-23 | Publication of this security advisory |

## Links

* [Github module product page](https://github.com/xpert-idea/xipblog/)
* [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2023-27847)

**DISCLAIMER:** *The French Association Friends Of Presta (FOP) acts as an intermediary to help hosting this advisory. While we strive to ensure the information and advice provided are accurate, FOP cannot be held liable for any consequences arising from reported vulnerabilities or any subsequent actions taken.*

This advisory and patch is licensed under [CC BY-SA 4.0![](https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1)](https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1)

[Subscribe](https://security.friendsofpresta.org/feed.xml)

* Friends Of Presta

Friends Of Presta is a none profit organization that supports the open-source ecommerce platform PrestaShop.


