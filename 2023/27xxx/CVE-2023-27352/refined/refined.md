- **Root cause of vulnerability**: The vulnerability exists within the processing of the SMB directory query command due to a lack of validation of an object's existence before performing operations on it. This leads to a use-after-free condition in the `libsmb2` library.
- **Weaknesses/vulnerabilities present**: Use-after-free vulnerability in the `libsmb2` library. Specifically, the code fails to check if an object exists before using it.
- **Impact of exploitation**: An attacker can execute arbitrary code with root privileges on the affected Sonos One Speaker.
- **Attack vectors**: Network-adjacent attackers can exploit the vulnerability by sending crafted SMB directory query commands.
- **Required attacker capabilities/position**: The attacker must be on the same network as the vulnerable Sonos device and does not require any prior authentication.