=== Content from security.netapp.com_54171e3c_20250115_113502.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2023-33250 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20230622-0006)

## CVE-2023-33250 Linux Kernel Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230622-0006 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230622-0006 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230622-0006 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230622-0006 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230622-0006
**Version:**
3.0

**Last updated:**
07/03/2023

**Status:**
Interim.

**CVEs:** CVE-2023-33250

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel version 6.3 is susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-33250](https://nvd.nist.gov/vuln/detail/CVE-2023-33250) | 9.8 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* [https://lore.kernel.org/linux-iommu/ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal/T/](https://lore.kernel.org/linux-iommu/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T/)

Affected Products
#### Affected Products

* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S

#### Products Under Investigation

* NetApp HCI Baseboard Management Controller (BMC) - H410C

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800/C800/A150
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230622-0006>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230622 | Initial Public Release |
| 2.0 | 20230622 | SnapCenter Plug-in for VMware vSphere moved to Products Not Affected |
| 3.0 | 20230703 | NetApp HCI Baseboard Management Controller (BMC) - H615C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H610C moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from groups.google.com_e08a1e0b_20250115_113500.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## syzkaller

[Conversations](./g/syzkaller)[About](./g/syzkaller/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# KASAN: slab-use-after-free Read in iopt\_unmap\_iova\_range

 537 viewsSkip to first unread message![Xingyuan Mo's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWqe6IIwTqRaoD4eYtzjamC9RP_fRmx4xNsa7zABcThVbqOyXY=s40-c)
### Xingyuan Mo

unread,Apr 12, 2023, 12:51:47 PM4/12/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Jason Gunthorpe, Kevin Tian, Joerg Roedel, Will Deacon, Robin Murphy, syzk...@googlegroups.com, io...@lists.linux.devHello,

Recently, when using our tool to fuzz kernel, the following bug was

triggered.

HEAD commit: 09a9639e56c0 ("Linux 6.3-rc6")

git tree: mainline

compiler: gcc (Ubuntu 10.3.0-1ubuntu1~20.04) 10.3.0

kernel config: <https://drive.google.com/file/d/1FoYieVV2RhjXXwTcmsUzz8dT6_DN61w8/view?usp=share_link>

C reproducer: <https://drive.google.com/file/d/1OGmuq_C9DsG78CTMex3Wiq7sPBB6fKkX/view?usp=share_link>

IMPORTANT: if you fix the issue, please add the following tag to the commit:

Reported-by: Xingyuan Mo <hdt...@gmail.com>

Kernel log:

BUG: KASAN: slab-use-after-free in iopt\_unmap\_iova\_range+0x5ba/0x5f0 drivers/iommu/iommufd/io\_pagetable.c:499

Read of size 4 at addr ffff88814fb28984 by task syz-executor410/8190

CPU: 0 PID: 8190 Comm: syz-executor410 Not tainted 6.3.0-rc6 #3

Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014

Call Trace:

 <TASK>

 \_\_dump\_stack lib/dump\_stack.c:88 [inline]

 dump\_stack\_lvl+0xd9/0x150 lib/dump\_stack.c:106

 print\_address\_description.constprop.0+0x2c/0x3c0 mm/kasan/report.c:319

 print\_report mm/kasan/report.c:430 [inline]

 kasan\_report+0x11c/0x130 mm/kasan/report.c:536

 iopt\_unmap\_iova\_range+0x5ba/0x5f0 drivers/iommu/iommufd/io\_pagetable.c:499

 iopt\_unmap\_all+0x27/0x50 drivers/iommu/iommufd/io\_pagetable.c:555

 iommufd\_ioas\_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300

 iommufd\_fops\_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337

 vfs\_ioctl fs/ioctl.c:51 [inline]

 \_\_do\_sys\_ioctl fs/ioctl.c:870 [inline]

 \_\_se\_sys\_ioctl fs/ioctl.c:856 [inline]

 \_\_x64\_sys\_ioctl+0x197/0x210 fs/ioctl.c:856

 do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]

 do\_syscall\_64+0x39/0xb0 arch/x86/entry/common.c:80

 entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd

RIP: 0033:0x7f5bc153dbdd

Code: c3 e8 97 2a 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64

 89 01 48

RSP: 002b:00007f5bc14c2d88 EFLAGS: 00000246 ORIG\_RAX: 0000000000000010

RAX: ffffffffffffffda RBX: 00007f5bc15d12f8 RCX: 00007f5bc153dbdd

RDX: 0000000020000000 RSI: 0000000000003b86 RDI: 0000000000000000

RBP: 00007f5bc15d12f0 R08: 00007f5bc14c3700 R09: 0000000000000000

R10: 00007f5bc14c3700 R11: 0000000000000246 R12: 00007f5bc15d12fc

R13: 00007f5bc159e074 R14: 6d6f692f7665642f R15: 00007f5bc14c2e80

 </TASK>

Allocated by task 8189:

 kasan\_save\_stack+0x22/0x40 mm/kasan/common.c:45

 kasan\_set\_track+0x25/0x30 mm/kasan/common.c:52

 \_\_\_\_kasan\_kmalloc mm/kasan/common.c:374 [inline]

 \_\_\_\_kasan\_kmalloc mm/kasan/common.c:333 [inline]

 \_\_kasan\_kmalloc+0xa2/0xb0 mm/kasan/common.c:383

 kmalloc include/linux/slab.h:580 [inline]

 kzalloc include/linux/slab.h:720 [inline]

 iopt\_alloc\_area\_pages+0x94/0x560 drivers/iommu/iommufd/io\_pagetable.c:234

 iopt\_map\_pages drivers/iommu/iommufd/io\_pagetable.c:339 [inline]

 iopt\_map\_user\_pages+0x205/0x4e0 drivers/iommu/iommufd/io\_pagetable.c:404

 iommufd\_ioas\_map+0x329/0x5f0 drivers/iommu/iommufd/ioas.c:222

 iommufd\_fops\_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337

 vfs\_ioctl fs/ioctl.c:51 [inline]

 \_\_do\_sys\_ioctl fs/ioctl.c:870 [inline]

 \_\_se\_sys\_ioctl fs/ioctl.c:856 [inline]

 \_\_x64\_sys\_ioctl+0x197/0x210 fs/ioctl.c:856

 do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]

 do\_syscall\_64+0x39/0xb0 arch/x86/entry/common.c:80

 entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd

Freed by task 8189:

 kasan\_save\_stack+0x22/0x40 mm/kasan/common.c:45

 kasan\_set\_track+0x25/0x30 mm/kasan/common.c:52

 kasan\_save\_free\_info+0x2e/0x40 mm/kasan/generic.c:521

 \_\_\_\_kasan\_slab\_free mm/kasan/common.c:236 [inline]

 \_\_\_\_kasan\_slab\_free+0x160/0x1c0 mm/kasan/common.c:200

 kasan\_slab\_free include/linux/kasan.h:162 [inline]

 slab\_free\_hook mm/slub.c:1781 [inline]

 slab\_free\_freelist\_hook+0x8b/0x1c0 mm/slub.c:1807

 slab\_free mm/slub.c:3787 [inline]

 \_\_kmem\_cache\_free+0xaf/0x2d0 mm/slub.c:3800

 iopt\_abort\_area drivers/iommu/iommufd/io\_pagetable.c:292 [inline]

 iopt\_unmap\_iova\_range+0x288/0x5f0 drivers/iommu/iommufd/io\_pagetable.c:509

 iopt\_unmap\_all+0x27/0x50 drivers/iommu/iommufd/io\_pagetable.c:555

 iommufd\_ioas\_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300

 iommufd\_fops\_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337

 vfs\_ioctl fs/ioctl.c:51 [inline]

 \_\_do\_sys\_ioctl fs/ioctl.c:870 [inline]

 \_\_se\_sys\_ioctl fs/ioctl.c:856 [inline]

 \_\_x64\_sys\_ioctl+0x197/0x210 fs/ioctl.c:856

 do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]

 do\_syscall\_64+0x39/0xb0 arch/x86/entry/common.c:80

 entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd

The buggy address belongs to the object at ffff88814fb28900

 which belongs to the cache kmalloc-cg-192 of size 192

The buggy address is located 132 bytes inside of

 freed 192-byte region [ffff88814fb28900, ffff88814fb289c0)

The buggy address belongs to the physical page:

page:ffffea00053eca00 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x14fb28

memcg:ffff888150318b01

flags: 0x57ff00000000200(slab|node=1|zone=2|lastcpupid=0x7ff)

raw: 057ff00000000200 ffff88801244ddc0 dead000000000122 0000000000000000

raw: 0000000000000000 0000000080100010 00000001ffffffff ffff888150318b01

page dumped because: kasan: bad access detected

page\_owner tracks the page as allocated

page last allocated via order 0, migratetype Unmovable, gfp\_mask 0x12cc0(GFP\_KERNEL|\_\_GFP\_NOWARN|\_\_GFP\_NORETRY), pid 8173, tgid 8172 (syz-executor410), ts 70683710169, free\_ts 67978925587

 prep\_new\_page mm/page\_alloc.c:2553 [inline]

 get\_page\_from\_freelist+0x1190/0x2e20 mm/page\_alloc.c:4326

 \_\_alloc\_pages+0x1cb/0x4a0 mm/page\_alloc.c:5592

 alloc\_pages+0x1aa/0x270 mm/mempolicy.c:2283

 alloc\_slab\_page mm/slub.c:1851 [inline]

 allocate\_slab+0x25f/0x390 mm/slub.c:1998

 new\_slab mm/slub.c:2051 [inline]

 \_\_\_slab\_alloc+0xa9b/0x13e0 mm/slub.c:3193

 \_\_slab\_alloc.constprop.0+0x56/0xa0 mm/slub.c:3292

 \_\_slab\_alloc\_node mm/slub.c:3345 [inline]

 slab\_alloc\_node mm/slub.c:3442 [inline]

 \_\_kmem\_cache\_alloc\_node+0x136/0x320 mm/slub.c:3491

 kmalloc\_trace+0x26/0xe0 mm/slab\_common.c:1061

 kmalloc include/linux/slab.h:580 [inline]

 kzalloc include/linux/slab.h:720 [inline]

 iommufd\_test\_alloc\_access drivers/iommu/iommufd/selftest.c:534 [inline]

 iommufd\_test\_create\_access drivers/iommu/iommufd/selftest.c:563 [inline]

 iommufd\_test+0x124a/0x2720 drivers/iommu/iommufd/selftest.c:810

 iommufd\_fops\_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337

 vfs\_ioctl fs/ioctl.c:51 [inline]

 \_\_do\_sys\_ioctl fs/ioctl.c:870 [inline]

 \_\_se\_sys\_ioctl fs/ioctl.c:856 [inline]

 \_\_x64\_sys\_ioctl+0x197/0x210 fs/ioctl.c:856

 do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]

 do\_syscall\_64+0x39/0xb0 arch/x86/entry/common.c:80

 entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd

page last free stack trace:

 reset\_page\_owner include/linux/page\_owner.h:24 [inline]

 free\_pages\_prepare mm/page\_alloc.c:1454 [inline]

 free\_pcp\_prepare+0x5d5/0xa50 mm/page\_alloc.c:1504

 free\_unref\_page\_prepare mm/page\_alloc.c:3388 [inline]

 free\_unref\_page+0x1d/0x490 mm/page\_alloc.c:3483

 \_\_folio\_put\_small mm/swap.c:106 [inline]

 \_\_folio\_put+0xc5/0x140 mm/swap.c:129

 folio\_put include/linux/mm.h:1309 [inline]

 put\_page include/linux/mm.h:1378 [inline]

 anon\_pipe\_buf\_release+0x3fb/0x4c0 fs/pipe.c:138

 pipe\_buf\_release include/linux/pipe\_fs\_i.h:203 [inline]

 pipe\_read+0x614/0x1110 fs/pipe.c:324

 call\_read\_iter include/linux/fs.h:1845 [inline]

 new\_sync\_read fs/read\_write.c:389 [inline]

 vfs\_read+0x7fa/0x930 fs/read\_write.c:470

 ksys\_read+0x1ec/0x250 fs/read\_write.c:613

 do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]

 do\_syscall\_64+0x39/0xb0 arch/x86/entry/common.c:80

 entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd

Memory state around the buggy address:

 ffff88814fb28880: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc

 ffff88814fb28900: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb

>ffff88814fb28980: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc

 ^

 ffff88814fb28a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

 ffff88814fb28a80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc

Reply allReply to authorForward0 new messages

=== Content from wiki.suse.net_9d5bd013_20250115_113458.html ===


# Connecting to Wiki

Sign in with your account to access Wiki

## Javascript is required

# Javascript is disabled on your browser.&nbspPlease enable Javascript and refresh this page.

[Refresh](.)

## Your OneDrive version is not supported

Upgrade now by installing the OneDrive for Business Next Generation Sync Client to login to Okta

[Learn how to upgrade](https://support.okta.com/help/articles/Knowledge_Article/Upgrading-to-OneDrive-for-Business-Next-Generation-Sync-Client)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

Powered by [Okta](https://www.okta.com/?internal_link=wic_login)

[Privacy Policy](/privacy)



=== Content from bugzilla.suse.com_285a81c5_20250114_185706.html ===


| Bugzilla – Bug 1211597 | VUL-0: CVE-2023-33250: kernel-source-azure,kernel-source-rt,kernel-source: use-after-free in iopt\_unmap\_iova\_range in drivers/iommu/iommufd/io\_pagetable.c | Last modified: 2024-05-07 11:39:45 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1211597)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1211597**](show_bug.cgi?id=1211597)
(CVE-2023-33250)
- VUL-0: CVE-2023-33250: kernel-source-azure,kernel-source-rt,kernel-source: use-after-free in iopt\_unmap\_iova\_range in drivers/iommu/iommufd/io\_pagetable.c

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2023-33250: kernel-source-azure,kernel-source-rt,kernel-source: us...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-33250 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/367082/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2023-33250:5.5:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2023-05-22 12:51 UTC by Thomas Leroy | | --- | --- | | Modified: | 2024-05-07 11:39 UTC ([History](show_activity.cgi?id=1211597)) | | CC List: | 6 users (show)  meissner mhocko mkoutny rfrohl security-team thomas.leroy | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1211597) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1211597&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1211597&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1211597#c0)  Thomas Leroy   2023-05-22 12:51:26 UTC  ``` CVE-2023-33250  The Linux kernel 6.3 has a use-after-free in iopt_unmap_iova_range in drivers/iommu/iommufd/io_pagetable.c.  References: <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2023-33250> <https://www.cve.org/CVERecord?id=CVE-2023-33250> <http://www.cvedetails.com/cve/CVE-2023-33250/> <https://groups.google.com/g/syzkaller/c/G6P9yecsTZ8/m/iiqFVOM9BwAJ> [https://lore.kernel.org/linux-iommu/ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal/T/](https://lore.kernel.org/linux-iommu/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T/) ``` [Comment 1](show_bug.cgi?id=1211597#c1)  Michal Koutný   2023-05-22 17:18:31 UTC  ``` Reassigning to a concrete person to ensure progress [1] (feel free to pass to next one), see also the process at [2].   Looks like an syzbot report with no identified fix so far. Might be interesting to watch for Jöerg.   [1] [https://confluence.suse.com/display/KSS/Kernel+Security+Sentinel](https://confluence.suse.com/display/KSS/Kernel%2BSecurity%2BSentinel) [2] <https://wiki.suse.net/index.php/SUSE-Labs/Kernel/Security> ``` [Comment 3](show_bug.cgi?id=1211597#c3)  Thomas Leroy   2023-05-23 14:07:43 UTC  ``` 51fe6141f0f6 (iommufd: Data structure to provide IOVA to PFN mapping) probably introduced the bug.  This commit is very recent and would only make stable branch affected. ``` [Comment 4](show_bug.cgi?id=1211597#c4)  Michal Hocko   2023-07-07 13:32:53 UTC  ``` Joerg, are you aware of any fix for this report? Also is it really worth tracking as security relevant? ``` [Comment 5](show_bug.cgi?id=1211597#c5)  Joerg Roedel   2023-08-14 09:18:23 UTC  ``` Upstream fixes are:  dbe245cdf518 iommufd: Call iopt_area_contig_done() under the lock 804ca14d04df iommufd: Do not access the area pointer after unlocking  Both are already in the stable branch via Linux 6.4.4 and in master branch via upstream.  SLE branches are not affected as commit 51fe6141f0f6 is not included in any of them. ``` [Comment 6](show_bug.cgi?id=1211597#c6)  Joerg Roedel   2023-08-14 09:18:36 UTC  ``` Assigning back. ``` [Comment 7](show_bug.cgi?id=1211597#c7)  Robert Frohl   2024-05-07 11:39:45 UTC  ``` nothing to do ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1211597)
* - [XML](show_bug.cgi?ctype=xml&id=1211597)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1211597)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1211597)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from security.netapp.com_da7382b5_20250114_185710.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2023-33250 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20230622-0006)

## CVE-2023-33250 Linux Kernel Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230622-0006 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230622-0006 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230622-0006 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230622-0006 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230622-0006
**Version:**
3.0

**Last updated:**
07/03/2023

**Status:**
Interim.

**CVEs:** CVE-2023-33250

Overview
#### Summary

Multiple NetApp products incorporate Linux kernel. Linux kernel version 6.3 is susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-33250](https://nvd.nist.gov/vuln/detail/CVE-2023-33250) | 9.8 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* [https://lore.kernel.org/linux-iommu/ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal/T/](https://lore.kernel.org/linux-iommu/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T/)

Affected Products
#### Affected Products

* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S

#### Products Under Investigation

* NetApp HCI Baseboard Management Controller (BMC) - H410C

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800/C800/A150
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230622-0006>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230622 | Initial Public Release |
| 2.0 | 20230622 | SnapCenter Plug-in for VMware vSphere moved to Products Not Affected |
| 3.0 | 20230703 | NetApp HCI Baseboard Management Controller (BMC) - H615C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H610C moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lore.kernel.org_5b309dd1_20250114_185709.html ===

```
[iommu.lists.linux-foundation.org archive mirror](../../?t=20230412115147)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#ecc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) KASAN: slab-use-after-free Read in iopt_unmap_iova_range
@ 2023-04-12 11:51 Xingyuan Mo
  [0 siblings, 0 replies; only message in thread](#rcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5)
From: Xingyuan Mo @ 2023-04-12 11:51 UTC ([permalink](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/) / [raw](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/raw))
  To: Jason Gunthorpe, Kevin Tian, Joerg Roedel, Will Deacon,
	Robin Murphy
  Cc: syzkaller, iommu

Hello,

Recently, when using our tool to fuzz kernel, the following bug was
triggered.

HEAD commit: 09a9639e56c0 ("Linux 6.3-rc6")
git tree: mainline
compiler: gcc (Ubuntu 10.3.0-1ubuntu1~20.04) 10.3.0
kernel config: <https://drive.google.com/file/d/1FoYieVV2RhjXXwTcmsUzz8dT6_DN61w8/view?usp=share_link>
C reproducer: <https://drive.google.com/file/d/1OGmuq_C9DsG78CTMex3Wiq7sPBB6fKkX/view?usp=share_link>

IMPORTANT: if you fix the issue, please add the following tag to the commit:
Reported-by: Xingyuan Mo <hdthky0@gmail.com>

Kernel log:

BUG: KASAN: slab-use-after-free in iopt_unmap_iova_range+0x5ba/0x5f0 drivers/iommu/iommufd/io_pagetable.c:499
Read of size 4 at addr ffff88814fb28984 by task syz-executor410/8190

CPU: 0 PID: 8190 Comm: syz-executor410 Not tainted 6.3.0-rc6 #3
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
Call Trace:
 <TASK>
 __dump_stack lib/dump_stack.c:88 [inline]
 dump_stack_lvl+0xd9/0x150 lib/dump_stack.c:106
 print_address_description.constprop.0+0x2c/0x3c0 mm/kasan/report.c:319
 print_report mm/kasan/report.c:430 [inline]
 kasan_report+0x11c/0x130 mm/kasan/report.c:536
 iopt_unmap_iova_range+0x5ba/0x5f0 drivers/iommu/iommufd/io_pagetable.c:499
 iopt_unmap_all+0x27/0x50 drivers/iommu/iommufd/io_pagetable.c:555
 iommufd_ioas_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
RIP: 0033:0x7f5bc153dbdd
Code: c3 e8 97 2a 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64
 89 01 48
RSP: 002b:00007f5bc14c2d88 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f5bc15d12f8 RCX: 00007f5bc153dbdd
RDX: 0000000020000000 RSI: 0000000000003b86 RDI: 0000000000000000
RBP: 00007f5bc15d12f0 R08: 00007f5bc14c3700 R09: 0000000000000000
R10: 00007f5bc14c3700 R11: 0000000000000246 R12: 00007f5bc15d12fc
R13: 00007f5bc159e074 R14: 6d6f692f7665642f R15: 00007f5bc14c2e80
 </TASK>

Allocated by task 8189:
 kasan_save_stack+0x22/0x40 mm/kasan/common.c:45
 kasan_set_track+0x25/0x30 mm/kasan/common.c:52
 ____kasan_kmalloc mm/kasan/common.c:374 [inline]
 ____kasan_kmalloc mm/kasan/common.c:333 [inline]
 __kasan_kmalloc+0xa2/0xb0 mm/kasan/common.c:383
 kmalloc include/linux/slab.h:580 [inline]
 kzalloc include/linux/slab.h:720 [inline]
 iopt_alloc_area_pages+0x94/0x560 drivers/iommu/iommufd/io_pagetable.c:234
 iopt_map_pages drivers/iommu/iommufd/io_pagetable.c:339 [inline]
 iopt_map_user_pages+0x205/0x4e0 drivers/iommu/iommufd/io_pagetable.c:404
 iommufd_ioas_map+0x329/0x5f0 drivers/iommu/iommufd/ioas.c:222
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

Freed by task 8189:
 kasan_save_stack+0x22/0x40 mm/kasan/common.c:45
 kasan_set_track+0x25/0x30 mm/kasan/common.c:52
 kasan_save_free_info+0x2e/0x40 mm/kasan/generic.c:521
 ____kasan_slab_free mm/kasan/common.c:236 [inline]
 ____kasan_slab_free+0x160/0x1c0 mm/kasan/common.c:200
 kasan_slab_free include/linux/kasan.h:162 [inline]
 slab_free_hook mm/slub.c:1781 [inline]
 slab_free_freelist_hook+0x8b/0x1c0 mm/slub.c:1807
 slab_free mm/slub.c:3787 [inline]
 __kmem_cache_free+0xaf/0x2d0 mm/slub.c:3800
 iopt_abort_area drivers/iommu/iommufd/io_pagetable.c:292 [inline]
 iopt_unmap_iova_range+0x288/0x5f0 drivers/iommu/iommufd/io_pagetable.c:509
 iopt_unmap_all+0x27/0x50 drivers/iommu/iommufd/io_pagetable.c:555
 iommufd_ioas_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

The buggy address belongs to the object at ffff88814fb28900
 which belongs to the cache kmalloc-cg-192 of size 192
The buggy address is located 132 bytes inside of
 freed 192-byte region [ffff88814fb28900, ffff88814fb289c0)

The buggy address belongs to the physical page:
page:ffffea00053eca00 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x14fb28
memcg:ffff888150318b01
flags: 0x57ff00000000200(slab|node=1|zone=2|lastcpupid=0x7ff)
raw: 057ff00000000200 ffff88801244ddc0 dead000000000122 0000000000000000
raw: 0000000000000000 0000000080100010 00000001ffffffff ffff888150318b01
page dumped because: kasan: bad access detected
page_owner tracks the page as allocated
page last allocated via order 0, migratetype Unmovable, gfp_mask 0x12cc0(GFP_KERNEL|__GFP_NOWARN|__GFP_NORETRY), pid 8173, tgid 8172 (syz-executor410), ts 70683710169, free_ts 67978925587
 prep_new_page mm/page_alloc.c:2553 [inline]
 get_page_from_freelist+0x1190/0x2e20 mm/page_alloc.c:4326
 __alloc_pages+0x1cb/0x4a0 mm/page_alloc.c:5592
 alloc_pages+0x1aa/0x270 mm/mempolicy.c:2283
 alloc_slab_page mm/slub.c:1851 [inline]
 allocate_slab+0x25f/0x390 mm/slub.c:1998
 new_slab mm/slub.c:2051 [inline]
 ___slab_alloc+0xa9b/0x13e0 mm/slub.c:3193
 __slab_alloc.constprop.0+0x56/0xa0 mm/slub.c:3292
 __slab_alloc_node mm/slub.c:3345 [inline]
 slab_alloc_node mm/slub.c:3442 [inline]
 __kmem_cache_alloc_node+0x136/0x320 mm/slub.c:3491
 kmalloc_trace+0x26/0xe0 mm/slab_common.c:1061
 kmalloc include/linux/slab.h:580 [inline]
 kzalloc include/linux/slab.h:720 [inline]
 iommufd_test_alloc_access drivers/iommu/iommufd/selftest.c:534 [inline]
 iommufd_test_create_access drivers/iommu/iommufd/selftest.c:563 [inline]
 iommufd_test+0x124a/0x2720 drivers/iommu/iommufd/selftest.c:810
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
page last free stack trace:
 reset_page_owner include/linux/page_owner.h:24 [inline]
 free_pages_prepare mm/page_alloc.c:1454 [inline]
 free_pcp_prepare+0x5d5/0xa50 mm/page_alloc.c:1504
 free_unref_page_prepare mm/page_alloc.c:3388 [inline]
 free_unref_page+0x1d/0x490 mm/page_alloc.c:3483
 __folio_put_small mm/swap.c:106 [inline]
 __folio_put+0xc5/0x140 mm/swap.c:129
 folio_put include/linux/mm.h:1309 [inline]
 put_page include/linux/mm.h:1378 [inline]
 anon_pipe_buf_release+0x3fb/0x4c0 fs/pipe.c:138
 pipe_buf_release include/linux/pipe_fs_i.h:203 [inline]
 pipe_read+0x614/0x1110 fs/pipe.c:324
 call_read_iter include/linux/fs.h:1845 [inline]
 new_sync_read fs/read_write.c:389 [inline]
 vfs_read+0x7fa/0x930 fs/read_write.c:470
 ksys_read+0x1ec/0x250 fs/read_write.c:613
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

Memory state around the buggy address:
 ffff88814fb28880: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ffff88814fb28900: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ffff88814fb28980: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ffff88814fb28a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff88814fb28a80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc

[^](#mcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) [permalink](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/) [raw](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/raw) [reply](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/#R)	[[flat](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T/#u)|[nested](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/t/#u)] [only message in thread](#rcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5)
```

---

```
only message in thread, other threads:[[~2023-04-12 11:51 UTC](../../?t=20230412115147) | [newest](../../)]

Thread overview: (only message) (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2023-04-12 11:51 [KASAN: slab-use-after-free Read in iopt_unmap_iova_range](#mcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) Xingyuan Mo

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from lore.kernel.org_33b5065d_20250115_113459.html ===

```
[iommu.lists.linux-foundation.org archive mirror](../../?t=20230412115147)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#ecc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) KASAN: slab-use-after-free Read in iopt_unmap_iova_range
@ 2023-04-12 11:51 Xingyuan Mo
  [0 siblings, 0 replies; only message in thread](#rcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5)
From: Xingyuan Mo @ 2023-04-12 11:51 UTC ([permalink](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/) / [raw](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/raw))
  To: Jason Gunthorpe, Kevin Tian, Joerg Roedel, Will Deacon,
	Robin Murphy
  Cc: syzkaller, iommu

Hello,

Recently, when using our tool to fuzz kernel, the following bug was
triggered.

HEAD commit: 09a9639e56c0 ("Linux 6.3-rc6")
git tree: mainline
compiler: gcc (Ubuntu 10.3.0-1ubuntu1~20.04) 10.3.0
kernel config: <https://drive.google.com/file/d/1FoYieVV2RhjXXwTcmsUzz8dT6_DN61w8/view?usp=share_link>
C reproducer: <https://drive.google.com/file/d/1OGmuq_C9DsG78CTMex3Wiq7sPBB6fKkX/view?usp=share_link>

IMPORTANT: if you fix the issue, please add the following tag to the commit:
Reported-by: Xingyuan Mo <hdthky0@gmail.com>

Kernel log:

BUG: KASAN: slab-use-after-free in iopt_unmap_iova_range+0x5ba/0x5f0 drivers/iommu/iommufd/io_pagetable.c:499
Read of size 4 at addr ffff88814fb28984 by task syz-executor410/8190

CPU: 0 PID: 8190 Comm: syz-executor410 Not tainted 6.3.0-rc6 #3
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
Call Trace:
 <TASK>
 __dump_stack lib/dump_stack.c:88 [inline]
 dump_stack_lvl+0xd9/0x150 lib/dump_stack.c:106
 print_address_description.constprop.0+0x2c/0x3c0 mm/kasan/report.c:319
 print_report mm/kasan/report.c:430 [inline]
 kasan_report+0x11c/0x130 mm/kasan/report.c:536
 iopt_unmap_iova_range+0x5ba/0x5f0 drivers/iommu/iommufd/io_pagetable.c:499
 iopt_unmap_all+0x27/0x50 drivers/iommu/iommufd/io_pagetable.c:555
 iommufd_ioas_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
RIP: 0033:0x7f5bc153dbdd
Code: c3 e8 97 2a 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64
 89 01 48
RSP: 002b:00007f5bc14c2d88 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f5bc15d12f8 RCX: 00007f5bc153dbdd
RDX: 0000000020000000 RSI: 0000000000003b86 RDI: 0000000000000000
RBP: 00007f5bc15d12f0 R08: 00007f5bc14c3700 R09: 0000000000000000
R10: 00007f5bc14c3700 R11: 0000000000000246 R12: 00007f5bc15d12fc
R13: 00007f5bc159e074 R14: 6d6f692f7665642f R15: 00007f5bc14c2e80
 </TASK>

Allocated by task 8189:
 kasan_save_stack+0x22/0x40 mm/kasan/common.c:45
 kasan_set_track+0x25/0x30 mm/kasan/common.c:52
 ____kasan_kmalloc mm/kasan/common.c:374 [inline]
 ____kasan_kmalloc mm/kasan/common.c:333 [inline]
 __kasan_kmalloc+0xa2/0xb0 mm/kasan/common.c:383
 kmalloc include/linux/slab.h:580 [inline]
 kzalloc include/linux/slab.h:720 [inline]
 iopt_alloc_area_pages+0x94/0x560 drivers/iommu/iommufd/io_pagetable.c:234
 iopt_map_pages drivers/iommu/iommufd/io_pagetable.c:339 [inline]
 iopt_map_user_pages+0x205/0x4e0 drivers/iommu/iommufd/io_pagetable.c:404
 iommufd_ioas_map+0x329/0x5f0 drivers/iommu/iommufd/ioas.c:222
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

Freed by task 8189:
 kasan_save_stack+0x22/0x40 mm/kasan/common.c:45
 kasan_set_track+0x25/0x30 mm/kasan/common.c:52
 kasan_save_free_info+0x2e/0x40 mm/kasan/generic.c:521
 ____kasan_slab_free mm/kasan/common.c:236 [inline]
 ____kasan_slab_free+0x160/0x1c0 mm/kasan/common.c:200
 kasan_slab_free include/linux/kasan.h:162 [inline]
 slab_free_hook mm/slub.c:1781 [inline]
 slab_free_freelist_hook+0x8b/0x1c0 mm/slub.c:1807
 slab_free mm/slub.c:3787 [inline]
 __kmem_cache_free+0xaf/0x2d0 mm/slub.c:3800
 iopt_abort_area drivers/iommu/iommufd/io_pagetable.c:292 [inline]
 iopt_unmap_iova_range+0x288/0x5f0 drivers/iommu/iommufd/io_pagetable.c:509
 iopt_unmap_all+0x27/0x50 drivers/iommu/iommufd/io_pagetable.c:555
 iommufd_ioas_unmap+0x3d1/0x480 drivers/iommu/iommufd/ioas.c:300
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

The buggy address belongs to the object at ffff88814fb28900
 which belongs to the cache kmalloc-cg-192 of size 192
The buggy address is located 132 bytes inside of
 freed 192-byte region [ffff88814fb28900, ffff88814fb289c0)

The buggy address belongs to the physical page:
page:ffffea00053eca00 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x14fb28
memcg:ffff888150318b01
flags: 0x57ff00000000200(slab|node=1|zone=2|lastcpupid=0x7ff)
raw: 057ff00000000200 ffff88801244ddc0 dead000000000122 0000000000000000
raw: 0000000000000000 0000000080100010 00000001ffffffff ffff888150318b01
page dumped because: kasan: bad access detected
page_owner tracks the page as allocated
page last allocated via order 0, migratetype Unmovable, gfp_mask 0x12cc0(GFP_KERNEL|__GFP_NOWARN|__GFP_NORETRY), pid 8173, tgid 8172 (syz-executor410), ts 70683710169, free_ts 67978925587
 prep_new_page mm/page_alloc.c:2553 [inline]
 get_page_from_freelist+0x1190/0x2e20 mm/page_alloc.c:4326
 __alloc_pages+0x1cb/0x4a0 mm/page_alloc.c:5592
 alloc_pages+0x1aa/0x270 mm/mempolicy.c:2283
 alloc_slab_page mm/slub.c:1851 [inline]
 allocate_slab+0x25f/0x390 mm/slub.c:1998
 new_slab mm/slub.c:2051 [inline]
 ___slab_alloc+0xa9b/0x13e0 mm/slub.c:3193
 __slab_alloc.constprop.0+0x56/0xa0 mm/slub.c:3292
 __slab_alloc_node mm/slub.c:3345 [inline]
 slab_alloc_node mm/slub.c:3442 [inline]
 __kmem_cache_alloc_node+0x136/0x320 mm/slub.c:3491
 kmalloc_trace+0x26/0xe0 mm/slab_common.c:1061
 kmalloc include/linux/slab.h:580 [inline]
 kzalloc include/linux/slab.h:720 [inline]
 iommufd_test_alloc_access drivers/iommu/iommufd/selftest.c:534 [inline]
 iommufd_test_create_access drivers/iommu/iommufd/selftest.c:563 [inline]
 iommufd_test+0x124a/0x2720 drivers/iommu/iommufd/selftest.c:810
 iommufd_fops_ioctl+0x317/0x4b0 drivers/iommu/iommufd/main.c:337
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:870 [inline]
 __se_sys_ioctl fs/ioctl.c:856 [inline]
 __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd
page last free stack trace:
 reset_page_owner include/linux/page_owner.h:24 [inline]
 free_pages_prepare mm/page_alloc.c:1454 [inline]
 free_pcp_prepare+0x5d5/0xa50 mm/page_alloc.c:1504
 free_unref_page_prepare mm/page_alloc.c:3388 [inline]
 free_unref_page+0x1d/0x490 mm/page_alloc.c:3483
 __folio_put_small mm/swap.c:106 [inline]
 __folio_put+0xc5/0x140 mm/swap.c:129
 folio_put include/linux/mm.h:1309 [inline]
 put_page include/linux/mm.h:1378 [inline]
 anon_pipe_buf_release+0x3fb/0x4c0 fs/pipe.c:138
 pipe_buf_release include/linux/pipe_fs_i.h:203 [inline]
 pipe_read+0x614/0x1110 fs/pipe.c:324
 call_read_iter include/linux/fs.h:1845 [inline]
 new_sync_read fs/read_write.c:389 [inline]
 vfs_read+0x7fa/0x930 fs/read_write.c:470
 ksys_read+0x1ec/0x250 fs/read_write.c:613
 do_syscall_x64 arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x63/0xcd

Memory state around the buggy address:
 ffff88814fb28880: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ffff88814fb28900: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ffff88814fb28980: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ffff88814fb28a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff88814fb28a80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc

[^](#mcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) [permalink](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/) [raw](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/raw) [reply](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/#R)	[[flat](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T/#u)|[nested](../../ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/t/#u)] [only message in thread](#rcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5)
```

---

```
only message in thread, other threads:[[~2023-04-12 11:51 UTC](../../?t=20230412115147) | [newest](../../)]

Thread overview: (only message) (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2023-04-12 11:51 [KASAN: slab-use-after-free Read in iopt_unmap_iova_range](#mcc7c03691ac0e11ad02f1c2c5d029a0f783fd0f5) Xingyuan Mo

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from git.kernel.org_677985c2_20250114_185706.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jason Gunthorpe <jgg@nvidia.com> | 2023-06-20 11:11:23 -0300 |
| --- | --- | --- |
| committer | Jason Gunthorpe <jgg@nvidia.com> | 2023-06-26 09:00:23 -0300 |
| commit | [804ca14d04df09bf7924bacc5ad22a4bed80c94f](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)) | |
| tree | [d94974a04827d0c814048884a0037cc2e8622b30](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f) | |
| parent | [6995e2de6891c724bfeb2db33d7b87775f913ad1](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6995e2de6891c724bfeb2db33d7b87775f913ad1) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f&id2=6995e2de6891c724bfeb2db33d7b87775f913ad1)) | |
| download | [linux-804ca14d04df09bf7924bacc5ad22a4bed80c94f.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-804ca14d04df09bf7924bacc5ad22a4bed80c94f.tar.gz) | |

iommufd: Do not access the area pointer after unlockingA concurrent unmap can trigger freeing of the area pointers while we are
generating an unmapping notification for accesses.
syzkaller reports:
BUG: KASAN: slab-use-after-free in iopt\_unmap\_iova\_range+0x5ba/0x5f0
Read of size 4 at addr ffff888075996184 by task syz-executor.2/31160
CPU: 1 PID: 31160 Comm: syz-executor.2 Not tainted 6.4.0-rc5-syzkaller-00313-g4c605260bc60 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/25/2023
Call Trace:
<TASK>
dump\_stack\_lvl+0xd9/0x150
print\_address\_description.constprop.0+0x2c/0x3c0
kasan\_report+0x11c/0x130
iopt\_unmap\_iova\_range+0x5ba/0x5f0
iopt\_unmap\_all+0x27/0x50
iommufd\_ioas\_unmap+0x3d0/0x490
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
RIP: 0033:0x7f0812c8c169
Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 f1 19 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007f0813914168 EFLAGS: 00000246 ORIG\_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007f0812dabf80 RCX: 00007f0812c8c169
RDX: 0000000020000100 RSI: 0000000000003b86 RDI: 0000000000000005
RBP: 00007f0812ce7ca1 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 00007f0812ecfb1f R14: 00007f0813914300 R15: 0000000000022000
</TASK>
Allocated by task 31160:
kasan\_save\_stack+0x22/0x40
kasan\_set\_track+0x25/0x30
\_\_kasan\_kmalloc+0xa2/0xb0
iopt\_alloc\_area\_pages+0x94/0x560
iopt\_map\_user\_pages+0x205/0x4e0
iommufd\_ioas\_map+0x329/0x5f0
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
Freed by task 31161:
kasan\_save\_stack+0x22/0x40
kasan\_set\_track+0x25/0x30
kasan\_save\_free\_info+0x2e/0x40
\_\_\_\_kasan\_slab\_free+0x160/0x1c0
slab\_free\_freelist\_hook+0x8b/0x1c0
\_\_kmem\_cache\_free+0xaf/0x2d0
iopt\_unmap\_iova\_range+0x288/0x5f0
iopt\_unmap\_all+0x27/0x50
iommufd\_ioas\_unmap+0x3d0/0x490
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
The buggy address belongs to the object at ffff888075996100
which belongs to the cache kmalloc-cg-192 of size 192
The buggy address is located 132 bytes inside of
freed 192-byte region [ffff888075996100, ffff8880759961c0)
The buggy address belongs to the physical page:
page:ffffea0001d66580 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x75996
memcg:ffff88801f1c2701
flags: 0xfff00000000200(slab|node=0|zone=1|lastcpupid=0x7ff)
page\_type: 0xffffffff()
raw: 00fff00000000200 ffff88801244ddc0 dead000000000122 0000000000000000
raw: 0000000000000000 0000000080100010 00000001ffffffff ffff88801f1c2701
page dumped because: kasan: bad access detected
page\_owner tracks the page as allocated
page last allocated via order 0, migratetype Unmovable, gfp\_mask 0x112cc0(GFP\_USER|\_\_GFP\_NOWARN|\_\_GFP\_NORETRY), pid 31157, tgid 31154 (syz-executor.0), ts 1984547323469, free\_ts 1983933451331
post\_alloc\_hook+0x2db/0x350
get\_page\_from\_freelist+0xf41/0x2c00
\_\_alloc\_pages+0x1cb/0x4a0
alloc\_pages+0x1aa/0x270
allocate\_slab+0x25f/0x390
\_\_\_slab\_alloc+0xa91/0x1400
\_\_slab\_alloc.constprop.0+0x56/0xa0
\_\_kmem\_cache\_alloc\_node+0x136/0x320
kmalloc\_trace+0x26/0xe0
iommufd\_test+0x1328/0x2c20
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
page last free stack trace:
free\_unref\_page\_prepare+0x62e/0xcb0
free\_unref\_page\_list+0xe3/0xa70
release\_pages+0xcd8/0x1380
tlb\_batch\_pages\_flush+0xa8/0x1a0
tlb\_finish\_mmu+0x14b/0x7e0
exit\_mmap+0x2b2/0x930
\_\_mmput+0x128/0x4c0
mmput+0x60/0x70
do\_exit+0x9b0/0x29b0
do\_group\_exit+0xd4/0x2a0
get\_signal+0x2318/0x25b0
arch\_do\_signal\_or\_restart+0x79/0x5c0
exit\_to\_user\_mode\_prepare+0x11f/0x240
syscall\_exit\_to\_user\_mode+0x1d/0x50
do\_syscall\_64+0x46/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
Precompute what is needed to call the access function and do not check the
area's num\_accesses again as the pointer may not be valid anymore. Use a
counter instead.
Fixes: 51fe6141f0f6 ("iommufd: Data structure to provide IOVA to PFN mapping")
Link: [https://lore.kernel.org/r/1-v2-9a03761d445d+54-iommufd\_syz2\_jgg@nvidia.com](https://lore.kernel.org/r/1-v2-9a03761d445d%2B54-iommufd_syz2_jgg%40nvidia.com)
Reviewed-by: Kevin Tian <kevin.tian@intel.com>
Reported-by: syzbot+1ad12d16afca0e7d2dde@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/r/0000000000001d40fc05fe385332@google.com
Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)

| -rw-r--r-- | [drivers/iommu/iommufd/io\_pagetable.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/iommu/iommufd/io_pagetable.c?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 3 deletions

| diff --git a/drivers/iommu/iommufd/io\_pagetable.c b/drivers/iommu/iommufd/io\_pagetable.cindex e0ae72b9e67f86..724c4c5742417a 100644--- a/[drivers/iommu/iommufd/io\_pagetable.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/iommu/iommufd/io_pagetable.c?id=6995e2de6891c724bfeb2db33d7b87775f913ad1)+++ b/[drivers/iommu/iommufd/io\_pagetable.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/iommu/iommufd/io_pagetable.c?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)@@ -458,6 +458,7 @@ static int iopt\_unmap\_iova\_range(struct io\_pagetable \*iopt, unsigned long start, { struct iopt\_area \*area; unsigned long unmapped\_bytes = 0;+ unsigned int tries = 0; int rc = -ENOENT;  /\*@@ -484,19 +485,26 @@ again: goto out\_unlock\_iova; } + if (area\_first != start)+ tries = 0;+ /\* \* num\_accesses writers must hold the iova\_rwsem too, so we can \* safely read it under the write side of the iovam\_rwsem \* without the pages->mutex. \*/ if (area->num\_accesses) {+ size\_t length = iopt\_area\_length(area);+ start = area\_first; area->prevent\_access = true; up\_write(&iopt->iova\_rwsem); up\_read(&iopt->domains\_rwsem);- iommufd\_access\_notify\_unmap(iopt, area\_first,- iopt\_area\_length(area));- if (WARN\_ON(READ\_ONCE(area->num\_accesses)))++ iommufd\_access\_notify\_unmap(iopt, area\_first, length);+ /\* Something is not responding to unmap requests. \*/+ tries++;+ if (WARN\_ON(tries > 100)) return -EDEADLOCK; goto again; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:55:44 +0000



=== Content from lore.kernel.org_eca5a4b2_20250115_113459.html ===

```
[iommu.lists.linux-foundation.org archive mirror](../)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
Message-ID <ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T>
not found

2 partial matches found:

[http://lore.kernel.org/linux-iommu/ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/](http://lore.kernel.org/linux-iommu/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/)

Perhaps try an external site:

[http://marc.info/?i=ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](http://marc.info/?i=ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal%2FT)
[http://www.mail-archive.com/search?l=mid&q=ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](http://www.mail-archive.com/search?l=mid&q=ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal%2FT)
nntp://news.gmane.io/ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T
[https://lists.debian.org/msgid-search/ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](https://lists.debian.org/msgid-search/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T)
[http://docs.FreeBSD.org/cgi/mid.cgi?db=mid&id=ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](http://docs.FreeBSD.org/cgi/mid.cgi?db=mid&id=ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal%2FT)
[https://www.w3.org/mid/ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](https://www.w3.org/mid/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T)
[http://www.postgresql.org/message-id/ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](http://www.postgresql.org/message-id/ZDabT/uRl/jxFhm0%40ip-172-31-85-199.ec2.internal/T)
[https://lists.debconf.org/cgi-lurker/keyword.cgi?doc-url=/lurker&format=en.html&query=id:ZDabT/uRl/jxFhm0@ip-172-31-85-199.ec2.internal/T](https://lists.debconf.org/cgi-lurker/keyword.cgi?doc-url=/lurker&format=en.html&query=id:ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal%2FT)

```

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from git.kernel.org_549dc178_20250114_185707.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=dbe245cdf5189e88d680379ed13901356628b650)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=dbe245cdf5189e88d680379ed13901356628b650)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=dbe245cdf5189e88d680379ed13901356628b650)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=dbe245cdf5189e88d680379ed13901356628b650)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jason Gunthorpe <jgg@nvidia.com> | 2023-06-20 11:11:24 -0300 |
| --- | --- | --- |
| committer | Jason Gunthorpe <jgg@nvidia.com> | 2023-06-26 09:00:23 -0300 |
| commit | [dbe245cdf5189e88d680379ed13901356628b650](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=dbe245cdf5189e88d680379ed13901356628b650) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=dbe245cdf5189e88d680379ed13901356628b650)) | |
| tree | [e49e4d294e727ae781a645e9d8f4ee4ecb45fc29](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=dbe245cdf5189e88d680379ed13901356628b650) | |
| parent | [804ca14d04df09bf7924bacc5ad22a4bed80c94f](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=dbe245cdf5189e88d680379ed13901356628b650&id2=804ca14d04df09bf7924bacc5ad22a4bed80c94f)) | |
| download | [linux-dbe245cdf5189e88d680379ed13901356628b650.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-dbe245cdf5189e88d680379ed13901356628b650.tar.gz) | |

iommufd: Call iopt\_area\_contig\_done() under the lockThe iter internally holds a pointer to the area and
iopt\_area\_contig\_done() will dereference it. The pointer is not valid
outside the iova\_rwsem.
syzkaller reports:
BUG: KASAN: slab-use-after-free in iommufd\_access\_unpin\_pages+0x363/0x370
Read of size 8 at addr ffff888022286e20 by task syz-executor669/5771
CPU: 0 PID: 5771 Comm: syz-executor669 Not tainted 6.4.0-rc5-syzkaller-00313-g4c605260bc60 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 05/25/2023
Call Trace:
<TASK>
dump\_stack\_lvl+0xd9/0x150
print\_address\_description.constprop.0+0x2c/0x3c0
kasan\_report+0x11c/0x130
iommufd\_access\_unpin\_pages+0x363/0x370
iommufd\_test\_access\_unmap+0x24b/0x390
iommufd\_access\_notify\_unmap+0x24c/0x3a0
iopt\_unmap\_iova\_range+0x4c4/0x5f0
iopt\_unmap\_all+0x27/0x50
iommufd\_ioas\_unmap+0x3d0/0x490
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
RIP: 0033:0x7fec1dae3b19
Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 11 15 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007fec1da74308 EFLAGS: 00000246 ORIG\_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007fec1db6b438 RCX: 00007fec1dae3b19
RDX: 0000000020000100 RSI: 0000000000003b86 RDI: 0000000000000003
RBP: 00007fec1db6b430 R08: 00007fec1da74700 R09: 0000000000000000
R10: 00007fec1da74700 R11: 0000000000000246 R12: 00007fec1db6b43c
R13: 00007fec1db39074 R14: 6d6f692f7665642f R15: 0000000000022000
</TASK>
Allocated by task 5770:
kasan\_save\_stack+0x22/0x40
kasan\_set\_track+0x25/0x30
\_\_kasan\_kmalloc+0xa2/0xb0
iopt\_alloc\_area\_pages+0x94/0x560
iopt\_map\_user\_pages+0x205/0x4e0
iommufd\_ioas\_map+0x329/0x5f0
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
Freed by task 5770:
kasan\_save\_stack+0x22/0x40
kasan\_set\_track+0x25/0x30
kasan\_save\_free\_info+0x2e/0x40
\_\_\_\_kasan\_slab\_free+0x160/0x1c0
slab\_free\_freelist\_hook+0x8b/0x1c0
\_\_kmem\_cache\_free+0xaf/0x2d0
iopt\_unmap\_iova\_range+0x288/0x5f0
iopt\_unmap\_all+0x27/0x50
iommufd\_ioas\_unmap+0x3d0/0x490
iommufd\_fops\_ioctl+0x317/0x4b0
\_\_x64\_sys\_ioctl+0x197/0x210
do\_syscall\_64+0x39/0xb0
entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
The parallel unmap free'd iter->area the instant the lock was released.
Fixes: 51fe6141f0f6 ("iommufd: Data structure to provide IOVA to PFN mapping")
Link: [https://lore.kernel.org/r/2-v2-9a03761d445d+54-iommufd\_syz2\_jgg@nvidia.com](https://lore.kernel.org/r/2-v2-9a03761d445d%2B54-iommufd_syz2_jgg%40nvidia.com)
Reviewed-by: Kevin Tian <kevin.tian@intel.com>
Reported-by: syzbot+6c8d756f238a75fc3eb8@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/r/000000000000905eba05fe38e9f2@google.com
Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=dbe245cdf5189e88d680379ed13901356628b650)

| -rw-r--r-- | [drivers/iommu/iommufd/device.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/iommu/iommufd/device.c?id=dbe245cdf5189e88d680379ed13901356628b650) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/iommu/iommufd/device.c b/drivers/iommu/iommufd/device.cindex 4f9b2142274ceb..29d05663d4d17a 100644--- a/[drivers/iommu/iommufd/device.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/iommu/iommufd/device.c?id=804ca14d04df09bf7924bacc5ad22a4bed80c94f)+++ b/[drivers/iommu/iommufd/device.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/iommu/iommufd/device.c?id=dbe245cdf5189e88d680379ed13901356628b650)@@ -553,8 +553,8 @@ void iommufd\_access\_unpin\_pages(struct iommufd\_access \*access, iopt\_area\_iova\_to\_index( area, min(last\_iova, iopt\_area\_last\_iova(area))));- up\_read(&iopt->iova\_rwsem); WARN\_ON(!iopt\_area\_contig\_done(&iter));+ up\_read(&iopt->iova\_rwsem); } EXPORT\_SYMBOL\_NS\_GPL(iommufd\_access\_unpin\_pages, IOMMUFD); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:55:44 +0000


