=== Content from github.com_4012a66c_20250114_210328.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fcommit%2Fcaaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fcommit%2Fcaaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=megaease%2Feaseprobe)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[megaease](/megaease)
/
**[easeprobe](/megaease/easeprobe)**
Public

* [Notifications](/login?return_to=%2Fmegaease%2Feaseprobe) You must be signed in to change notification settings
* [Fork
  235](/login?return_to=%2Fmegaease%2Feaseprobe)
* [Star
   2.2k](/login?return_to=%2Fmegaease%2Feaseprobe)

* [Code](/megaease/easeprobe)
* [Issues
  2](/megaease/easeprobe/issues)
* [Pull requests
  0](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects
  0](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

Additional navigation options

* [Code](/megaease/easeprobe)
* [Issues](/megaease/easeprobe/issues)
* [Pull requests](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

## Commit

[Permalink](/megaease/easeprobe/commit/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix the SQL Injection ([#330](https://github.com/megaease/easeprobe/pull/330))

[Browse files](/megaease/easeprobe/tree/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)
Browse the repository at this point in the history

* Loading branch information

[![@haoel](https://avatars.githubusercontent.com/u/1014558?s=40&v=4)](/haoel)

[haoel](/megaease/easeprobe/commits?author=haoel "View all commits by haoel")
authored
Apr 25, 2023

1 parent
[0e148b8](/megaease/easeprobe/commit/0e148b8563fa283e03c9fa820997d225ded6e56c)

commit caaf586

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**89 additions**
and
**46 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* global

  + global/global.go
    [global.go](#diff-cac14d900d52278116684e088e664b57fd14d95465c58e16fb476b0c710433e6)
  + global/global\_test.go
    [global\_test.go](#diff-84ae1408f4f2b644101bfb52ff76a31524dbe0abfb26732494c970e36e96721e)
* probe/client

  + mysql

    - probe/client/mysql/mysql.go
      [mysql.go](#diff-080d01df7cfc6388595a3d0abb447d7d09713915aaff411e67070a500b38e83b)
  + postgres

    - probe/client/postgres/postgres.go
      [postgres.go](#diff-2797cd21de3c5735a33004c01761c49fe16e065ef848f9e296b326bc03a377a7)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[global/global.go](#diff-cac14d900d52278116684e088e664b57fd14d95465c58e16fb476b0c710433e6 "global/global.go")

Show comments

[View file](/megaease/easeprobe/blob/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1/global/global.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -311,3 +311,22 @@ func CommandLine(cmd string, args []string) string { |
|  |  | } |
|  |  | return result |
|  |  | } |
|  |  |  |
|  |  | // EscapeQuote escape the string the single quote, double quote, and backtick |
|  |  | func EscapeQuote(str string) string { |
|  |  | type Escape struct { |
|  |  | From string |
|  |  | To string |
|  |  | } |
|  |  | escape := []Escape{ |
|  |  | {From: "`", To: ""}, // remove the backtick |
|  |  | {From: `\`, To: `\\`}, |
|  |  | {From: `'`, To: `\'`}, |
|  |  | {From: `"`, To: `\"`}, |
|  |  | } |
|  |  |  |
|  |  | for \_, e := range escape { |
|  |  | str = strings.ReplaceAll(str, e.From, e.To) |
|  |  | } |
|  |  | return str |
|  |  | } |

9 changes: 9 additions & 0 deletions

9
[global/global\_test.go](#diff-84ae1408f4f2b644101bfb52ff76a31524dbe0abfb26732494c970e36e96721e "global/global_test.go")

Show comments

[View file](/megaease/easeprobe/blob/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1/global/global_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -438,3 +438,12 @@ func TestCommandLine(t \*testing.T) { |
|  |  | s = CommandLine("kubectl", []string{"get", "pod", "--all-namespaces", "-o", "json"}) |
|  |  | assert.Equal(t, "kubectl get pod --all-namespaces -o json", s) |
|  |  | } |
|  |  |  |
|  |  | func TestEscape(t \*testing.T) { |
|  |  | assert.Equal(t, "test", EscapeQuote("test")) |
|  |  | assert.Equal(t, "test", EscapeQuote("`test`")) |
|  |  | assert.Equal(t, `\'test\'`, EscapeQuote("'test'")) |
|  |  | assert.Equal(t, `\"test\"`, EscapeQuote(`"test"`)) |
|  |  | assert.Equal(t, `\\test\\`, EscapeQuote(`\test\`)) |
|  |  |  |
|  |  | } |

95 changes: 55 additions & 40 deletions

95
[probe/client/mysql/mysql.go](#diff-080d01df7cfc6388595a3d0abb447d7d09713915aaff411e67070a500b38e83b "probe/client/mysql/mysql.go")

Show comments

[View file](/megaease/easeprobe/blob/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1/probe/client/mysql/mysql.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -106,50 +106,65 @@ func (r \*MySQL) Probe() (bool, string) { |
|  |  |  |
|  |  | // Check if we need to query specific data |
|  |  | if len(r.Data) > 0 { |
|  |  | for k, v := range r.Data { |
|  |  | log.Debugf("[%s / %s / %s] - Verifying Data - [%s] : [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, k, v) |
|  |  | sql, err := r.getSQL(k) |
|  |  | if err != nil { |
|  |  | return false, err.Error() |
|  |  | } |
|  |  | log.Debugf("[%s / %s / %s] - SQL - [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, sql) |
|  |  | rows, err := db.Query(sql) |
|  |  | if err != nil { |
|  |  | return false, err.Error() |
|  |  | } |
|  |  | if !rows.Next() { |
|  |  | rows.Close() |
|  |  | return false, fmt.Sprintf("No data found for [%s]", k) |
|  |  | } |
|  |  | //check the value is equal to the value in data |
|  |  | var value string |
|  |  | if err := rows.Scan(&value); err != nil { |
|  |  | rows.Close() |
|  |  | return false, err.Error() |
|  |  | } |
|  |  | if value != v { |
|  |  | rows.Close() |
|  |  | return false, fmt.Sprintf("Value not match for [%s] expected [%s] got [%s] ", k, v, value) |
|  |  | } |
|  |  | rows.Close() |
|  |  | log.Debugf("[%s / %s / %s] - Data Verified Successfully! - [%s] : [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, k, v) |
|  |  | } |
|  |  | } else { |
|  |  | err = db.Ping() |
|  |  | if err != nil { |
|  |  | if err := r.ProbeWithDataVerification(db); err != nil { |
|  |  | return false, err.Error() |
|  |  | } |
|  |  | row, err := db.Query("show status like \"uptime\"") // run a SQL to test |
|  |  | if err != nil { |
|  |  | } else { |
|  |  | if err := r.ProbeWithPing(db); err != nil { |
|  |  | return false, err.Error() |
|  |  | } |
|  |  | defer row.Close() |
|  |  | } |
|  |  |  |
|  |  | return true, "Check MySQL Server Successfully!" |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | // ProbeWithPing do the health check with ping |
|  |  | func (r \*MySQL) ProbeWithPing(db \*sql.DB) error { |
|  |  | if err := db.Ping(); err != nil { |
|  |  | return err |
|  |  | } |
|  |  | row, err := db.Query("show status like \"uptime\"") // run a SQL to test |
|  |  | if err != nil { |
|  |  | return err |
|  |  | } |
|  |  | defer row.Close() |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | // ProbeWithDataVerification do the health check with data verification |
|  |  | func (r \*MySQL) ProbeWithDataVerification(db \*sql.DB) error { |
|  |  | for k, v := range r.Data { |
|  |  | log.Debugf("[%s / %s / %s] - Verifying Data - [%s] : [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, k, v) |
|  |  | sql, err := r.getSQL(k) |
|  |  | if err != nil { |
|  |  | return err |
|  |  | } |
|  |  | log.Debugf("[%s / %s / %s] - SQL - [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, sql) |
|  |  | rows, err := db.Query(sql) |
|  |  | if err != nil { |
|  |  | return err |
|  |  | } |
|  |  | if !rows.Next() { |
|  |  | rows.Close() |
|  |  | return fmt.Errorf("No data found for [%s]", k) |
|  |  | } |
|  |  | //check the value is equal to the value in data |
|  |  | var value string |
|  |  | if err := rows.Scan(&value); err != nil { |
|  |  | rows.Close() |
|  |  | return err |
|  |  | } |
|  |  | if value != v { |
|  |  | rows.Close() |
|  |  | return fmt.Errorf("Value not match for [%s] expected [%s] got [%s] ", k, v, value) |
|  |  | } |
|  |  | rows.Close() |
|  |  | log.Debugf("[%s / %s / %s] - Data Verified Successfully! - [%s] : [%s]", r.ProbeKind, r.ProbeName, r.ProbeTag, k, v) |
|  |  | } |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | // getSQL get the SQL statement |
|  |  | // input: database:table:column:key:value |
|  |  | // output: SELECT column FROM database.table WHERE key = value |
| Expand All | | @@ -161,16 +176,16 @@ func (r \*MySQL) getSQL(str string) (string, error) { |
|  |  | if len(fields) != 5 { |
|  |  | return "", fmt.Errorf("Invalid SQL data - [%s]. (syntax: database:table:field:key:value)", str) |
|  |  | } |
|  |  | db := fields[0] |
|  |  | table := fields[1] |
|  |  | field := fields[2] |
|  |  | key := fields[3] |
|  |  | value := fields[4] |
|  |  | db := global.EscapeQuote(fields[0]) |
|  |  | table := global.EscapeQuote(fields[1]) |
|  |  | field := global.EscapeQuote(fields[2]) |
|  |  | key := global.EscapeQuote(fields[3]) |
|  |  | value := global.EscapeQuote(fields[4]) |
|  |  | //check value is int or not |
|  |  | if \_, err := strconv.Atoi(value); err != nil { |
|  |  | return "", fmt.Errorf("Invalid SQL data - [%s], the value must be int", str) |
|  |  | } |
|  |  |  |
|  |  | sql := fmt.Sprintf("SELECT %s FROM %s.%s WHERE %s = %s", field, db, table, key, value) |
|  |  | sql := fmt.Sprintf("SELECT `%s` FROM `%s`.`%s` WHERE `%s` = %s", field, db, table, key, value) |
|  |  | return sql, nil |
|  |  | } |

12 changes: 6 additions & 6 deletions

12
[probe/client/postgres/postgres.go](#diff-2797cd21de3c5735a33004c01761c49fe16e065ef848f9e296b326bc03a377a7 "probe/client/postgres/postgres.go")

Show comments

[View file](/megaease/easeprobe/blob/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1/probe/client/postgres/postgres.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -190,16 +190,16 @@ func (r \*PostgreSQL) getSQL(str string) (string, string, error) { |
|  |  | if len(fields) != 5 { |
|  |  | return "", "", fmt.Errorf("Invalid SQL data - [%s]. (syntax: database:table:field:key:value)", str) |
|  |  | } |
|  |  | db := fields[0] |
|  |  | table := fields[1] |
|  |  | field := fields[2] |
|  |  | key := fields[3] |
|  |  | value := fields[4] |
|  |  | db := global.EscapeQuote(fields[0]) |
|  |  | table := global.EscapeQuote(fields[1]) |
|  |  | field := global.EscapeQuote(fields[2]) |
|  |  | key := global.EscapeQuote(fields[3]) |
|  |  | value := global.EscapeQuote(fields[4]) |
|  |  | //check value is int or not |
|  |  | if \_, err := strconv.Atoi(value); err != nil { |
|  |  | return "", "", fmt.Errorf("Invalid SQL data - [%s], the value must be int", str) |
|  |  | } |
|  |  |  |
|  |  | sql := fmt.Sprintf("SELECT %s FROM %s WHERE %s = %s", field, table, key, value) |
|  |  | sql := fmt.Sprintf(`SELECT "%s" FROM "%s" WHERE "%s" = %s`, field, table, key, value) |
|  |  | return db, sql, nil |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `caaf586`

[![@oxeye-daniel](https://avatars.githubusercontent.com/u/86908774?s=80&v=4)](/oxeye-daniel)

Copy link

### @oxeye-daniel **[oxeye-daniel](/oxeye-daniel)** commented on `[caaf586](/megaease/easeprobe/commit/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)` [May 29, 2023](#commitcomment-115471695)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi [@haoel](https://github.com/haoel),

Thanks for fixing the SQL injection we reported. We kindly ask you to open a Github security advisory for the vulnerability.

Thanks

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fcommit%2Fcaaf5860df2aaa76acd29bc40ec9a578d0b1d6e1) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_619c542b_20250114_210330.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fpull%2F330)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fpull%2F330)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=megaease%2Feaseprobe)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[megaease](/megaease)
/
**[easeprobe](/megaease/easeprobe)**
Public

* [Notifications](/login?return_to=%2Fmegaease%2Feaseprobe) You must be signed in to change notification settings
* [Fork
  235](/login?return_to=%2Fmegaease%2Feaseprobe)
* [Star
   2.2k](/login?return_to=%2Fmegaease%2Feaseprobe)

* [Code](/megaease/easeprobe)
* [Issues
  2](/megaease/easeprobe/issues)
* [Pull requests
  0](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects
  0](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

Additional navigation options

* [Code](/megaease/easeprobe)
* [Issues](/megaease/easeprobe/issues)
* [Pull requests](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmegaease%2Feaseprobe%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmegaease%2Feaseprobe%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix the SQL Injection #330

 Merged

[haoel](/haoel)
merged 1 commit into
[megaease:main](/megaease/easeprobe/tree/main "megaease/easeprobe:main")
from
[haoel:security](/haoel/easeprobe/tree/security "haoel/easeprobe:security")

Apr 25, 2023

 Merged

# [Fix the SQL Injection](#top) #330

[haoel](/haoel)
merged 1 commit into
[megaease:main](/megaease/easeprobe/tree/main "megaease/easeprobe:main")
from
[haoel:security](/haoel/easeprobe/tree/security "haoel/easeprobe:security")

Apr 25, 2023

[Conversation
7](/megaease/easeprobe/pull/330)
[Commits
1](/megaease/easeprobe/pull/330/commits)
[Checks
0](/megaease/easeprobe/pull/330/checks)
[Files changed](/megaease/easeprobe/pull/330/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![haoel](https://avatars.githubusercontent.com/u/1014558?s=60&v=4)](/haoel)

Copy link

Contributor

### @haoel **[haoel](/haoel)** commented [Apr 25, 2023](#issue-1682445985)

The MySQL/PostgreSQL data checking could have the SQL injection problem, this PR tries to fix it by adding the quotes in SQL and escaping the quotes in configuration.

Sorry, something went wrong.

All reactions

[![@haoel](https://avatars.githubusercontent.com/u/1014558?s=40&v=4)](/haoel)

`[fix the SQL Injection](/megaease/easeprobe/pull/330/commits/450f0f099e5fe2a119c7d0aa0a83c448bca82d29 "fix the SQL Injection")`

`[450f0f0](/megaease/easeprobe/pull/330/commits/450f0f099e5fe2a119c7d0aa0a83c448bca82d29)`

 [![@haoel](https://avatars.githubusercontent.com/u/1014558?s=40&u=079ac90d9c84c3a96e0bb1d9a3f4528682541c63&v=4)](/haoel)
[haoel](/haoel)
requested review from
[localvar](/localvar) and
[samanhappy](/samanhappy)
[April 25, 2023 05:17](#event-9088083032)

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [Apr 25, 2023](#issuecomment-1521169059) ‚Ä¢ edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease) Report Patch coverage: **`100.00`**% and no project coverage change.  Comparison is base [(`682462a`)](https://codecov.io/gh/megaease/easeprobe/commit/682462a7e1fc40391fa8d8a12873478b15a3d740?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease) 99.67% compared to head [(`450f0f0`)](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease) 99.68%.  üì£ This organization is not using Codecov‚Äôs [GitHub App Integration](https://github.com/apps/codecov). We recommend you install it so Codecov can continue to function properly for your repositories. [Learn more](https://about.codecov.io/blog/codecov-is-updating-its-github-integration/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease) Additional details and impacted files ``` @@           Coverage Diff            @@ ##             main     #330    +/-   ## ========================================   Coverage   99.67%   99.68%             ========================================   Files          82       83     +1        Lines        5503     5643   +140      ======================================== + Hits         5485     5625   +140        Misses         12       12               Partials        6        6             ```  | [Impacted Files](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease) | Coverage Œî |  | | --- | --- | --- | | [conf/conf.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-Y29uZi9jb25mLmdv) | `96.73% <√∏> (√∏)` |  | | [channel/channel.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-Y2hhbm5lbC9jaGFubmVsLmdv) | `100.00% <100.00%> (√∏)` |  | | [global/global.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-Z2xvYmFsL2dsb2JhbC5nbw==) | `100.00% <100.00%> (√∏)` |  | | [global/probe.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-Z2xvYmFsL3Byb2JlLmdv) | `100.00% <100.00%> (√∏)` |  | | [probe/base/base.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvYmFzZS9iYXNlLmdv) | `100.00% <100.00%> (√∏)` |  | | [probe/client/mysql/mysql.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvY2xpZW50L215c3FsL215c3FsLmdv) | `100.00% <100.00%> (√∏)` |  | | [probe/client/postgres/postgres.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvY2xpZW50L3Bvc3RncmVzL3Bvc3RncmVzLmdv) | `100.00% <100.00%> (√∏)` |  | | [probe/data.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvZGF0YS5nbw==) | `100.00% <100.00%> (√∏)` |  | | [probe/notification\_strategy.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvbm90aWZpY2F0aW9uX3N0cmF0ZWd5Lmdv) | `100.00% <100.00%> (√∏)` |  | | [probe/result.go](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease#diff-cHJvYmUvcmVzdWx0Lmdv) | `100.00% <100.00%> (√∏)` |  |   Help us with your feedback. Take ten seconds to tell us [how you rate us](https://about.codecov.io/nps?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease). Have a feature suggestion? [Share it here.](https://app.codecov.io/gh/feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease)  [‚òî View full report in Codecov by Sentry](https://codecov.io/gh/megaease/easeprobe/pull/330?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease). üì¢ Do you have feedback about the report comment? [Let us know in this issue](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=megaease). |

All reactions

Sorry, something went wrong.

[![localvar](https://avatars.githubusercontent.com/u/504447?s=60&v=4)](/localvar)

**[localvar](/localvar)**
reviewed
[Apr 25, 2023](#pullrequestreview-1399287082)

 [View reviewed changes](/megaease/easeprobe/pull/330/files/450f0f099e5fe2a119c7d0aa0a83c448bca82d29)

[global/global.go](/megaease/easeprobe/pull/330/files/450f0f099e5fe2a119c7d0aa0a83c448bca82d29#diff-cac14d900d52278116684e088e664b57fd14d95465c58e16fb476b0c710433e6)

Comment on lines
+316
 to
+332

|  |  | func EscapeQuote(str string) string { |
| --- | --- | --- |
|  |  | type Escape struct { |
|  |  | From string |
|  |  | To string |
|  |  | } |
|  |  | escape := []Escape{ |
|  |  | {From: "`", To: ""}, // remove the backtick |
|  |  | {From: `\`, To: `\\`}, |
|  |  | {From: `'`, To: `\'`}, |
|  |  | {From: `"`, To: `\"`}, |
|  |  | } |
|  |  |  |
|  |  | for \_, e := range escape { |
|  |  | str = strings.ReplaceAll(str, e.From, e.To) |
|  |  | } |
|  |  | return str |
|  |  | } |

Copy link

Collaborator

### @localvar **[localvar](/localvar)** [Apr 25, 2023](#discussion_r1176110077)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

as a cornor case, `abc\'def` will be escaped to `abc\\\'def`, is this a correct result?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @haoel **[haoel](/haoel)** [Apr 25, 2023](#discussion_r1176116483)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's correct. The sql injection always needs a quote to close the previous statement. So escape the quote is key work to prevent injection.

Sorry, something went wrong.

All reactions

[![localvar](https://avatars.githubusercontent.com/u/504447?s=60&v=4)](/localvar)

**[localvar](/localvar)**
approved these changes
[Apr 25, 2023](#pullrequestreview-1399313310)

 [View reviewed changes](/megaease/easeprobe/pull/330/files/450f0f099e5fe2a119c7d0aa0a83c448bca82d29)

[![samanhappy](https://avatars.githubusercontent.com/u/2755122?s=60&v=4)](/samanhappy)

**[samanhappy](/samanhappy)**
approved these changes
[Apr 25, 2023](#pullrequestreview-1399325551)

 [View reviewed changes](/megaease/easeprobe/pull/330/files/450f0f099e5fe2a119c7d0aa0a83c448bca82d29)

[![@haoel](https://avatars.githubusercontent.com/u/1014558?s=40&u=079ac90d9c84c3a96e0bb1d9a3f4528682541c63&v=4)](/haoel)
[haoel](/haoel)
added this pull request to the merge queue
[Apr 25, 2023](#event-9089236100)

Merged
via the queue into
megaease:main

with commit [`caaf586`](/megaease/easeprobe/commit/caaf5860df2aaa76acd29bc40ec9a578d0b1d6e1)
[Apr 25, 2023](https://github.com/megaease/easeprobe/pull/330#event-9089239283)

[![@oxeye-daniel](https://avatars.githubusercontent.com/u/86908774?s=80&u=a4848bf7197c2dd3d246064aaae2eeca6c1fdba5&v=4)](/oxeye-daniel)

Copy link

### **[oxeye-daniel](/oxeye-daniel)** commented [May 14, 2023](#issuecomment-1546910878)

| Hi [@haoel](https://github.com/haoel), great to see the issue is addressed. Could you open a Github security advisory for the SQL injection vulnerability we found? |
| --- |

All reactions

Sorry, something went wrong.

[![@localvar](https://avatars.githubusercontent.com/u/504447?s=80&u=959675f109d8d289f082355cbd04d8d21449c173&v=4)](/localvar)

Copy link

Collaborator

### **[localvar](/localvar)** commented [May 30, 2023](#issuecomment-1567674293)

| [@oxeye-daniel](https://github.com/oxeye-daniel) , thanks for the reminder, we have open a github security advisory at: [GHSA-4c32-w6c7-77x4](https://github.com/megaease/easeprobe/security/advisories/GHSA-4c32-w6c7-77x4 "GHSA-4c32-w6c7-77x4")  please help review and let us know if anything is incorrect, as this is the first time we open such an advisory, thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@oxeye-daniel](https://avatars.githubusercontent.com/u/86908774?s=80&u=a4848bf7197c2dd3d246064aaae2eeca6c1fdba5&v=4)](/oxeye-daniel)

Copy link

### **[oxeye-daniel](/oxeye-daniel)** commented [May 30, 2023](#issuecomment-1567954925)

| Hi [@localvar](https://github.com/localvar) thanks a lot! No problem, you can go ahead and add me as editor for the advisory so I can suggest changes |
| --- |

All reactions

Sorry, something went wrong.

[![@localvar](https://avatars.githubusercontent.com/u/504447?s=80&u=959675f109d8d289f082355cbd04d8d21449c173&v=4)](/localvar)

Copy link

Collaborator

### **[localvar](/localvar)** commented [May 30, 2023](#issuecomment-1567959435)

| [@oxeye-daniel](https://github.com/oxeye-daniel) , added |
| --- |

All reactions

Sorry, something went wrong.

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[May 31, 2023](#ref-issue-1734824232)

[x/vulndb: potential Go vuln in github.com/megaease/easeprobe: CVE-2023-33967
golang/vulndb#1807](/golang/vulndb/issues/1807)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fpull%2F330)

Reviewers

[![@samanhappy](https://avatars.githubusercontent.com/u/2755122?s=40&v=4)](/samanhappy) [samanhappy](/samanhappy)

samanhappy approved these changes

[![@localvar](https://avatars.githubusercontent.com/u/504447?s=40&v=4)](/localvar) [localvar](/localvar)

localvar approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@haoel](https://avatars.githubusercontent.com/u/1014558?s=52&v=4)](/haoel) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@oxeye-daniel](https://avatars.githubusercontent.com/u/86908774?s=52&v=4)](/oxeye-daniel) [![@localvar](https://avatars.githubusercontent.com/u/504447?s=52&v=4)](/localvar) [![@samanhappy](https://avatars.githubusercontent.com/u/2755122?s=52&v=4)](/samanhappy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_2cde02bc_20250114_210332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fsecurity%2Fadvisories%2FGHSA-4c32-w6c7-77x4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Fsecurity%2Fadvisories%2FGHSA-4c32-w6c7-77x4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=megaease%2Feaseprobe)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[megaease](/megaease)
/
**[easeprobe](/megaease/easeprobe)**
Public

* [Notifications](/login?return_to=%2Fmegaease%2Feaseprobe) You must be signed in to change notification settings
* [Fork
  235](/login?return_to=%2Fmegaease%2Feaseprobe)
* [Star
   2.2k](/login?return_to=%2Fmegaease%2Feaseprobe)

* [Code](/megaease/easeprobe)
* [Issues
  2](/megaease/easeprobe/issues)
* [Pull requests
  0](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects
  0](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

Additional navigation options

* [Code](/megaease/easeprobe)
* [Issues](/megaease/easeprobe/issues)
* [Pull requests](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

# SQL injection when using MySQL/PostgreSQL data checking

High

[localvar](/localvar)
published
GHSA-4c32-w6c7-77x4
May 30, 2023

## Package

EaseProbe

## Affected versions

< 2.1.0

## Patched versions

2.1.0

## Description

An SQL injection issue was discovered in EaseProbe before 2.1.0 when using MySQL/PostgreSQL data checking. This problem has been fixed in v2.1.0; users should upgrade to this version.

The vulnerability was discovered by the [Oxeye research](https://www.oxeye.io/) team.

### Severity

High

8.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

### CVE ID

CVE-2023-33967

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

### Credits

* [![@oxeye-gal](https://avatars.githubusercontent.com/u/97847098?s=40&v=4)](/oxeye-gal)
  [oxeye-gal](/oxeye-gal)
  Reporter
* [![@oxeye-daniel](https://avatars.githubusercontent.com/u/86908774?s=40&v=4)](/oxeye-daniel)
  [oxeye-daniel](/oxeye-daniel)
  Reporter

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_1a790efb_20250114_210331.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Freleases%2Ftag%2Fv2.1.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmegaease%2Feaseprobe%2Freleases%2Ftag%2Fv2.1.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=megaease%2Feaseprobe)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[megaease](/megaease)
/
**[easeprobe](/megaease/easeprobe)**
Public

* [Notifications](/login?return_to=%2Fmegaease%2Feaseprobe) You must be signed in to change notification settings
* [Fork
  235](/login?return_to=%2Fmegaease%2Feaseprobe)
* [Star
   2.2k](/login?return_to=%2Fmegaease%2Feaseprobe)

* [Code](/megaease/easeprobe/tree/v2.1.0)
* [Issues
  2](/megaease/easeprobe/issues)
* [Pull requests
  0](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects
  0](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

Additional navigation options

* [Code](/megaease/easeprobe/tree/v2.1.0)
* [Issues](/megaease/easeprobe/issues)
* [Pull requests](/megaease/easeprobe/pulls)
* [Discussions](/megaease/easeprobe/discussions)
* [Actions](/megaease/easeprobe/actions)
* [Projects](/megaease/easeprobe/projects)
* [Security](/megaease/easeprobe/security)
* [Insights](/megaease/easeprobe/pulse)

1. [Releases](/megaease/easeprobe/releases)
2. [v2.1.0](/megaease/easeprobe/releases/tag/v2.1.0)

# easeprobe-v2.1.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/megaease/easeprobe/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.1.0)

 Loading

[View all tags](/megaease/easeprobe/tags)

![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)
[github-actions](/apps/github-actions)
released this
09 May 02:48

¬∑
[195 commits](/megaease/easeprobe/compare/v2.1.0...main)
to main
since this release

[v2.1.0](/megaease/easeprobe/tree/v2.1.0)

[`c4e2770`](/megaease/easeprobe/commit/c4e27709607bd8dc4945df273ef274a8ecd569d2)

# Change Logs

## Features

* feat: Introducing the Level Trigger Mode by [@haoel](https://github.com/haoel) in [#315](https://github.com/megaease/easeprobe/pull/315)
* feat: Auto-restart if the configuration file changed by [@haoel](https://github.com/haoel) in [#332](https://github.com/megaease/easeprobe/pull/332)
* Add Helm charts release workflow by [@samanhappy](https://github.com/samanhappy) in [#292](https://github.com/megaease/easeprobe/pull/292), [#307](https://github.com/megaease/easeprobe/pull/307), [#308](https://github.com/megaease/easeprobe/pull/308)
* Add the docker-compose deployment by [@haoel](https://github.com/haoel) in [#331](https://github.com/megaease/easeprobe/pull/331)

## Non-Functional

* upgrade to go 1.20 by [@haoel](https://github.com/haoel) in [#343](https://github.com/megaease/easeprobe/pull/343), [#347](https://github.com/megaease/easeprobe/pull/347)
* chore(deps): replace go-ping with pro-bing by [@haoqixu](https://github.com/haoqixu) in [#294](https://github.com/megaease/easeprobe/pull/294)

## Documents

* Reconstructing the user manual by [@haoel](https://github.com/haoel) in [#305](https://github.com/megaease/easeprobe/pull/305)
* fix the link error in README.md by [@haoel](https://github.com/haoel) in [#313](https://github.com/megaease/easeprobe/pull/313)
* fix typo by [@lostsquirrel](https://github.com/lostsquirrel) in [#316](https://github.com/megaease/easeprobe/pull/316), by [@haoel](https://github.com/haoel) in

  [#329](https://github.com/megaease/easeprobe/pull/329)
* Correct the document and json scheme by [@haoel](https://github.com/haoel) in [#346](https://github.com/megaease/easeprobe/pull/346)

## Bug-fixing

* refactor: avoid copying mutex by [@haoqixu](https://github.com/haoqixu) in [#296](https://github.com/megaease/easeprobe/pull/296)
* fix: use buffered os.Signal channel as argument to signal.Notify by [@haoqixu](https://github.com/haoqixu) in [#295](https://github.com/megaease/easeprobe/pull/295)
* Fix the version bug by [@haoel](https://github.com/haoel) in [#310](https://github.com/megaease/easeprobe/pull/310)

## Security

* Fix XSS attack bug by [@haoel](https://github.com/haoel) in [#291](https://github.com/megaease/easeprobe/pull/291)
* Fix the SQL Injection by [@haoel](https://github.com/haoel) in [#330](https://github.com/megaease/easeprobe/pull/330)

## New Contributors

* [@haoqixu](https://github.com/haoqixu) made their first contribution in [#294](https://github.com/megaease/easeprobe/pull/294)
* [@lostsquirrel](https://github.com/lostsquirrel) made their first contribution in [#316](https://github.com/megaease/easeprobe/pull/316)

**Full Changelog**: [v2.0.1...v2.1.0](https://github.com/megaease/easeprobe/compare/v2.0.1...v2.1.0)

### Contributors

* [![@haoel](https://avatars.githubusercontent.com/u/1014558?s=64&v=4)](https://github.com/haoel)
* [![@lostsquirrel](https://avatars.githubusercontent.com/u/1826206?s=64&v=4)](https://github.com/lostsquirrel)
* [![@samanhappy](https://avatars.githubusercontent.com/u/2755122?s=64&v=4)](https://github.com/samanhappy)
* [![@haoqixu](https://avatars.githubusercontent.com/u/9400582?s=64&v=4)](https://github.com/haoqixu)

haoel, lostsquirrel, and 2 other contributors

 Assets
11

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


