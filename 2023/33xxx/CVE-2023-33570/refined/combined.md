=== Content from siltonrenato02.medium.com_a2217428_20250115_090240.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe900ac450490&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fsiltonrenato02.medium.com%2Fa-brief-summary-about-a-ssti-to-rce-in-bagisto-e900ac450490&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fsiltonrenato02.medium.com%2Fa-brief-summary-about-a-ssti-to-rce-in-bagisto-e900ac450490&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# **A brief summary about a SSTI to RCE in Bagisto**

[![Silton Santos](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---byline--e900ac450490--------------------------------)

[Silton Santos](/?source=post_page---byline--e900ac450490--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffaa0112546aa&operation=register&redirect=https%3A%2F%2Fsiltonrenato02.medium.com%2Fa-brief-summary-about-a-ssti-to-rce-in-bagisto-e900ac450490&user=Silton+Santos&userId=faa0112546aa&source=post_page-faa0112546aa--byline--e900ac450490---------------------post_header-----------)

3 min read·Jun 21, 2023

--

Listen

Share

This is a summary of a Server Side Template Injection vulnerability found and used as RCE.

**The Beginning**

Sometimes, when a Red Team exercise is very hard, I look at things to unwind .

One given day, I was talking to my friend *cupc4k3* about life. He told me that he had just set up a server for an eCommerce platform called Bagisto. I was curious and decided to take a closer look at [**Bagisto**](https://demo.bagisto.com/) **version : 1.5.1.**

**The Functionality**

When I looked, I could see the **Pages** functionality. It is possible to create and customize pages of e-commerce, it looked interesting.

![]()

The Pages functionality

As you can see in the next image, there is the possibility of placing a snippet of HTML code on the page, looking at it, I immediately remember XSS vulnerabilities.

![]()

The feature to write HTML code

I was right about that, but something told me that I should look deeper, if this were a real red team engagement, the XSS would be an unreliable vector for further impact due to time constraints to make the most out of it.

![]()

The XSS vulnerability

**The Vulnerability**

I continued to analyze the functionality, then when inserted {{7\*7}}, in response, the number 49 is visible. A Server Side Template Injection (SSTI) was confirmed.

The [SSTI](https://portswigger.net/web-security/server-side-template-injection) is a vulnerability that allows injecting a native template content such as a payload and this is executed in the server, that is, that old problem of concatenating the input directly. With the vulnerability confirmed, we went into a probe of impact, and to our surprise, the first RCE payload test was legitimate. We knew it was a framework made in PHP which made it a lot easier.

To test, we used a known payload for RCE, reading the /etc/passwd file as shown in the image below

![]()

The payload to trigger RCE on SSTI

In the preview moment, I can see the file passwd content. Now I have a nice impact for a Red Team engagement, a vector of initial access to the network (of course that depends on where the application is stored). But, this would be a cool beginning.

![]()

Result of command injected

It’s important to note that through this vulnerability an attacker can execute commands on the application’s server, allowing access to files on it, such as ones with database credentials, API credentials and others.

If this is hosted at a cloud provider, an attacker may try to [read the instance’s metadata](https://medium.com/stolabs/hunting-for-low-hanging-fruit-in-applications-at-aws-environments-658737dc7983), extending the impact beyond that of a simple CMS admin user compromise.

**The Report**

When reporting to the vendor, they did not recognize it as a valid impact, according to them, there is no impact of gaining local user access to the machine, if you already are an admin user on the dashboard. Therefore, I decided to write this brief about the vulnerability, to not lose the tread, I registered the CVE-2023–33570 number.

![]()

This is simple, but I hope you enjoyed it… Thanks to review Mr. Bug\_Art

--

--

[![Silton Santos](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---post_author_info--e900ac450490--------------------------------)[![Silton Santos](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---post_author_info--e900ac450490--------------------------------)Follow[## Written by Silton Santos](/?source=post_page---post_author_info--e900ac450490--------------------------------)[38 Followers](/followers?source=post_page---post_author_info--e900ac450490--------------------------------)·[11 Following](/following?source=post_page---post_author_info--e900ac450490--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----e900ac450490--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----e900ac450490--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----e900ac450490--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e900ac450490--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----e900ac450490--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----e900ac450490--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e900ac450490--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e900ac450490--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----e900ac450490--------------------------------)[Teams](https://medium.com/business?source=post_page-----e900ac450490--------------------------------)


