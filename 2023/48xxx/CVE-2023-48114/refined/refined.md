Based on the provided information, here's a breakdown of the vulnerability described:

**CVE ID:** CVE-2023-48114

**Description:**
The vulnerability is a stored Cross-Site Scripting (XSS) issue found in the email body of SmarterMail versions 16.x, specifically from build 8495 up to 8664. This vulnerability stems from a flaw in the application's Anti-XSS mechanism.

**Root Cause:**
The root cause lies in a flawed sanitization function that uses both whitelists and blacklists to filter potentially malicious tags and attributes. The sanitizer had a vulnerability in its URL validation process against the whitelist.

**Weaknesses/Vulnerabilities:**
-   **Inadequate input sanitization:** The application's sanitization function, intended to prevent XSS, was flawed. It used a whitelist of allowed URLs for `src` attributes in `iframe` and `embed` tags, but incorrectly parsed URLs, allowing bypasses.
-   **URL Whitelist Bypass:** Specifically, a URL like `https://youtube.com@attacker.com` was considered valid by the sanitizer, enabling the attacker to specify their own server.
-   **Content Security Policy (CSP) and Content-Disposition Bypass:** While the CSP restricted the source of embedded content, the attacker bypassed this by exploiting a file upload feature and leveraging a specific endpoint that didn't set the `Content-Disposition` header, allowing the malicious SVG to render inline.

**Attack Vectors:**
-   **Email Injection:** An attacker injects malicious JavaScript code within an email's HTML body, specifically using a crafted embed tag with a malicious SVG payload.

**Required Attacker Capabilities/Position:**
-   **Normal Access Account:** An attacker only needs a standard user account on the SmarterMail system.
-   **Ability to Send Emails:** The attacker must be able to send emails to a victim on the same SmarterMail system.
-   **Ability to Upload Files:** The attacker needs the ability to upload files to the SmarterMail server (to host the malicious SVG).

**Impact of Exploitation:**
-   **Account Takeover:** Successful exploitation allows an attacker to execute arbitrary JavaScript code within the victim's webmail session when the victim opens the malicious email. This can lead to account compromise, data theft (e.g. stealing access tokens), and other malicious actions.
-   **Arbitrary JavaScript Execution**:  By crafting a specific payload including an SVG file, the attacker can execute any JavaScript code when the victim opens the email.

**Technical Details:**
1.  The attacker crafts an email with an `embed` tag. The `src` attribute of the tag is constructed to point to a malicious SVG file uploaded on the server, and bypasses the sanitization using a malformed URL, and the `type` attribute is set to `image/svg+xml`.
2.  The malicious SVG file is uploaded to the SmarterMail server using a file upload functionality.
3.  A specific SmarterMail endpoint that does not set the `Content-Disposition` header is used to access the uploaded SVG and have it render inline.
4.  The victim opens the crafted email, triggering the embedded SVG and executing the JavaScript payload. This payload is capable of extracting the victim's access token, refresh token, and sending them to the attacker.

**Mitigation:**
-   The vendor released a patch (Build 8747) which is recommended for users to install.

**Additional Notes**
- The provided write-up contains more technical details than the CVE description, outlining the specific bypass of the XSS filter using the combination of the embed tag and a malformed URL.

This analysis covers all the pertinent details regarding CVE-2023-48114, as derived from the provided content.