=== Content from github.com_50f71415_20250115_102643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcodeigniter4%2Fshield%2Fcommit%2F7e84c3fb3411294f70890819bfe51781bb9dc8e4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcodeigniter4%2Fshield%2Fcommit%2F7e84c3fb3411294f70890819bfe51781bb9dc8e4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=codeigniter4%2Fshield)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[codeigniter4](/codeigniter4)
/
**[shield](/codeigniter4/shield)**
Public

* [Notifications](/login?return_to=%2Fcodeigniter4%2Fshield) You must be signed in to change notification settings
* [Fork
  132](/login?return_to=%2Fcodeigniter4%2Fshield)
* [Star
   372](/login?return_to=%2Fcodeigniter4%2Fshield)

* [Code](/codeigniter4/shield)
* [Issues
  5](/codeigniter4/shield/issues)
* [Pull requests
  12](/codeigniter4/shield/pulls)
* [Discussions](/codeigniter4/shield/discussions)
* [Actions](/codeigniter4/shield/actions)
* [Projects
  0](/codeigniter4/shield/projects)
* [Security](/codeigniter4/shield/security)
* [Insights](/codeigniter4/shield/pulse)

Additional navigation options

* [Code](/codeigniter4/shield)
* [Issues](/codeigniter4/shield/issues)
* [Pull requests](/codeigniter4/shield/pulls)
* [Discussions](/codeigniter4/shield/discussions)
* [Actions](/codeigniter4/shield/actions)
* [Projects](/codeigniter4/shield/projects)
* [Security](/codeigniter4/shield/security)
* [Insights](/codeigniter4/shield/pulse)

## Commit

[Permalink](/codeigniter4/shield/commit/7e84c3fb3411294f70890819bfe51781bb9dc8e4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-j72f-h752-mx4w](https://github.com/advisories/GHSA-j72f-h752-mx4w "GHSA-j72f-h752-mx4w")

[Browse files](/codeigniter4/shield/tree/7e84c3fb3411294f70890819bfe51781bb9dc8e4)
Browse the repository at this point in the history

```
fix: raw token logging
```

* Loading branch information

[![@kenjis](https://avatars.githubusercontent.com/u/87955?s=40&v=4)](/kenjis)

[kenjis](/codeigniter4/shield/commits?author=kenjis "View all commits by kenjis")
authored
Nov 22, 2023

2 parents
[f77c6ae](/codeigniter4/shield/commit/f77c6ae20275ac1245330a2b9a523bf7e6f6202f)
+
[725baaa](/codeigniter4/shield/commit/725baaa6486c6d6ee8e923f7dc9287eb0ba006a8)

commit 7e84c3f

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**174 additions**
and
**70 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs

  + addons

    - docs/addons/jwt.md
      [jwt.md](#diff-7a4990061705df2c649ea34dbc2ab8b1975251570300453013cf9db2fc2e522a)
  + getting\_started

    - docs/getting\_started/configuration.md
      [configuration.md](#diff-6af609a81d15b0302c76a9032958ea268e0820137f80e81a7696b1a17241a415)
  + references/authentication

    - docs/references/authentication/hmac.md
      [hmac.md](#diff-9f5b4bf7694d7c6a7acdc75f3d93861c82038d40ce0ce58ac61d2524f7e2e245)
    - docs/references/authentication/tokens.md
      [tokens.md](#diff-319db53f64b78ae7cb10750c45dcafefb9a39b760a3c39b1d1908be948ef6d82)
* phpstan-baseline.php
  [phpstan-baseline.php](#diff-2d7a277ce37ae2b36daa2f4a61830d26f0994e4c6029cbadb5541f080df05a49)
* src

  + Authentication/Authenticators

    - src/Authentication/Authenticators/AccessTokens.php
      [AccessTokens.php](#diff-6ab5754a3b2605824618f5b7e8b9f2b8858d10456fcb1eb13c14b5752f4b32cf)
    - src/Authentication/Authenticators/HmacSha256.php
      [HmacSha256.php](#diff-e296899f7db51e66ae5504de03cb4c6f54637e9df9fb5685a645d40be4b11c43)
    - src/Authentication/Authenticators/JWT.php
      [JWT.php](#diff-6fb461d2a3d4e19febe32c56fd9297ffdd8ab5048ccc88d6b01637a869f0a17e)
  + Config

    - src/Config/AuthToken.php
      [AuthToken.php](#diff-030358efc956ecc8de95e9223e1ad956a988a25bbdabc40d7c0fd879989c5d89)
* tests/Authentication/Authenticators

  + tests/Authentication/Authenticators/AccessTokenAuthenticatorTest.php
    [AccessTokenAuthenticatorTest.php](#diff-eca75f332bd7644fe79ebe8664f850fe45e32246e99d6257feb107dc9ed33dc8)
  + tests/Authentication/Authenticators/HmacAuthenticatorTest.php
    [HmacAuthenticatorTest.php](#diff-c55cff55fb54e89b47faf5054701fab522cf25b39fe3aa1df27f64d7a5440a97)
  + tests/Authentication/Authenticators/JWTAuthenticatorTest.php
    [JWTAuthenticatorTest.php](#diff-7eef2ec4620532aed8b398766b17824338e8dd0ee9245c77f7c4dd0d2ca35b3b)

## There are no files selected for viewing

28 changes: 26 additions & 2 deletions

28
[docs/addons/jwt.md](#diff-7a4990061705df2c649ea34dbc2ab8b1975251570300453013cf9db2fc2e522a "docs/addons/jwt.md")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/docs/addons/jwt.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -34,9 +34,9 @@ To use JWT Authentication, you need additional setup and configuration. |
|  |  |  |
|  |  | ```php |
|  |  | <?php |
|  |  |  |
|  |  |  |
|  |  | // app/Config/AuthJWT.php |
|  |  |  |
|  |  |  |
|  |  | declare(strict\_types=1); |
|  |  |  |
|  |  | namespace Config; |
| Expand Down  Expand Up | | @@ -128,6 +128,19 @@ php -r 'echo base64\_encode(random\_bytes(32));' |
|  |  |  |
|  |  | The secret key is used for signing and validating tokens. |
|  |  |  |
|  |  | ### Login Attempt Logging |
|  |  |  |
|  |  | By default, only failed login attempts are recorded in the `auth\_token\_logins` table. |
|  |  |  |
|  |  | ```php |
|  |  | public int $recordLoginAttempt = Auth::RECORD\_LOGIN\_ATTEMPT\_FAILURE; |
|  |  | ``` |
|  |  |  |
|  |  | If you don't want any logs, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_NONE`. |
|  |  |  |
|  |  | If you want to log all login attempts, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_ALL`. |
|  |  | It means you log all requests. |
|  |  |  |
|  |  | ## Issuing JWTs |
|  |  |  |
|  |  | To use JWT Authentication, you need a controller that issues JWTs. |
| Expand Down  Expand Up | | @@ -351,3 +364,14 @@ It uses the `secret` and `alg` in the `Config\AuthJWT::$keys['default']`. |
|  |  | It sets the `Config\AuthJWT::$defaultClaims` to the token, and sets |
|  |  | `"iat"` (Issued At) and `"exp"` (Expiration Time) claims automatically even if |
|  |  | you don't pass them. |
|  |  |  |
|  |  | ## Logging |
|  |  |  |
|  |  | Login attempts are recorded in the `auth\_token\_logins` table, according to the |
|  |  | configuration above. |
|  |  |  |
|  |  | When a failed login attempt is logged, the raw token value sent is saved in |
|  |  | the `identifier` column. |
|  |  |  |
|  |  | When a successful login attempt is logged, the SHA256 hash value of the token |
|  |  | sent is saved in the `identifier` column. |

18 changes: 3 additions & 15 deletions

18
[docs/getting\_started/configuration.md](#diff-6af609a81d15b0302c76a9032958ea268e0820137f80e81a7696b1a17241a415 "docs/getting_started/configuration.md")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/docs/getting_started/configuration.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -8,20 +8,8 @@ If you have completed the setup according to this documentation, you will have |
|  |  | the following configuration files: |
|  |  |  |
|  |  | - \*\*app/Config/Auth.php\*\* |
|  |  | - \*\*app/Config/AuthGroups.php\*\* - For Authorization |
|  |  | - \*\*app/Config/AuthToken.php\*\* - For AccessTokens and HmacSha256 Authentication |
|  |  | - \*\*app/Config/AuthJWT.php\*\* - For JWT Authentication |
|  |  | - \*\*app/Config/AuthGroups.php\*\* - For [Authorization](../references/authorization.md) |
|  |  | - \*\*app/Config/AuthToken.php\*\* - For [AccessTokens](../references/authentication/tokens.md#configuration) and [HmacSha256](../references/authentication/hmac.md#configuration) Authentication |
|  |  | - \*\*app/Config/AuthJWT.php\*\* - For [JWT Authentication](../addons/jwt.md#configuration) |
|  |  |  |
|  |  | Note that you do not need to have configuration files for features you do not use. |
|  |  |  |
|  |  | This section describes the major Config items that are not described elsewhere. |
|  |  |  |
|  |  | ## AccessTokens Authenticator |
|  |  |  |
|  |  | ### Access Token Lifetime |
|  |  |  |
|  |  | By default, Access Tokens can be used for 1 year since the last use. This can be easily modified in the \*\*app/Config/AuthToken.php\*\* config file. |
|  |  |  |
|  |  | ```php |
|  |  | public int $unusedTokenLifetime = YEAR; |
|  |  | ``` |

61 changes: 47 additions & 14 deletions

61
[docs/references/authentication/hmac.md](#diff-9f5b4bf7694d7c6a7acdc75f3d93861c82038d40ce0ce58ac61d2524f7e2e245 "docs/references/authentication/hmac.md")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/docs/references/authentication/hmac.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -112,20 +112,6 @@ $token = $user->getHmacTokenById($id); |
|  |  | $tokens = $user->hmacTokens(); |
|  |  | ``` |
|  |  |  |
|  |  | ## HMAC Keys Lifetime |
|  |  |  |
|  |  | HMAC Keys/Tokens will expire after a specified amount of time has passed since they have been used. |
|  |  | This uses the same configuration value as AccessTokens. |
|  |  |  |
|  |  | By default, this is set to 1 year. You can change this value by setting the `$unusedTokenLifetime` |
|  |  | value in the \*\*app/Config/AuthToken.php\*\* config file. This is in seconds so that you can use the |
|  |  | [time constants](https://codeigniter.com/user\_guide/general/common\_functions.html#time-constants) |
|  |  | that CodeIgniter provides. |
|  |  |  |
|  |  | ```php |
|  |  | public $unusedTokenLifetime = YEAR; |
|  |  | ``` |
|  |  |  |
|  |  | ## HMAC Keys Scopes |
|  |  |  |
|  |  | Each token (set of keys) can be given one or more scopes they can be used within. These can be thought of as |
| Expand Down  Expand Up | | @@ -219,3 +205,50 @@ authtoken.hmacEncryptionCurrentKey = k2 |
|  |  | Depending on the set length of the Secret Key and the type of encryption used, it is possible for the encrypted value to |
|  |  | exceed the database column character limit of 255 characters. If this happens, creation of a new HMAC identity will |
|  |  | throw a `RuntimeException`. |
|  |  |  |
|  |  | ## Configuration |
|  |  |  |
|  |  | Configure \*\*app/Config/AuthToken.php\*\* for your needs. |
|  |  |  |
|  |  | !!! note |
|  |  |  |
|  |  | Shield does not expect you use the Access Token Authenticator and HMAC Authenticator |
|  |  | at the same time. Therefore, some Config items are common. |
|  |  |  |
|  |  | ### HMAC Keys Lifetime |
|  |  |  |
|  |  | HMAC Keys/Tokens will expire after a specified amount of time has passed since they have been used. |
|  |  |  |
|  |  | By default, this is set to 1 year. You can change this value by setting the `$unusedTokenLifetime` |
|  |  | value. This is in seconds so that you can use the |
|  |  | [time constants](https://codeigniter.com/user\_guide/general/common\_functions.html#time-constants) |
|  |  | that CodeIgniter provides. |
|  |  |  |
|  |  | ```php |
|  |  | public $unusedTokenLifetime = YEAR; |
|  |  | ``` |
|  |  |  |
|  |  | ### Login Attempt Logging |
|  |  |  |
|  |  | By default, only failed login attempts are recorded in the `auth\_token\_logins` table. |
|  |  | This can be modified by changing the `$recordLoginAttempt` value. |
|  |  |  |
|  |  | ```php |
|  |  | public int $recordLoginAttempt = Auth::RECORD\_LOGIN\_ATTEMPT\_FAILURE; |
|  |  | ``` |
|  |  |  |
|  |  | If you don't want any logs, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_NONE`. |
|  |  |  |
|  |  | If you want to log all login attempts, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_ALL`. |
|  |  | It means you log all requests. |
|  |  |  |
|  |  | ## Logging |
|  |  |  |
|  |  | Login attempts are recorded in the `auth\_token\_logins` table, according to the |
|  |  | configuration above. |
|  |  |  |
|  |  | When a failed login attempt is logged, the raw token value sent is saved in |
|  |  | the `identifier` column. |
|  |  |  |
|  |  | When a successful login attempt is logged, the token name is saved in the |
|  |  | `identifier` column. |

61 changes: 49 additions & 12 deletions

61
[docs/references/authentication/tokens.md](#diff-319db53f64b78ae7cb10750c45dcafefb9a39b760a3c39b1d1908be948ef6d82 "docs/references/authentication/tokens.md")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/docs/references/authentication/tokens.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -83,18 +83,6 @@ $token = $user->getAccessTokenById($id); |
|  |  | $tokens = $user->accessTokens(); |
|  |  | ``` |
|  |  |  |
|  |  | ## Access Token Lifetime |
|  |  |  |
|  |  | Tokens will expire after a specified amount of time has passed since they have been used. |
|  |  | By default, this is set to 1 year. You can change this value by setting the `$unusedTokenLifetime` |
|  |  | value in the \*\*app/Config/AuthToken.php\*\* config file. This is in seconds so that you can use the |
|  |  | [time constants](https://codeigniter.com/user\_guide/general/common\_functions.html#time-constants) |
|  |  | that CodeIgniter provides. |
|  |  |  |
|  |  | ```php |
|  |  | public $unusedTokenLifetime = YEAR; |
|  |  | ``` |
|  |  |  |
|  |  | ## Access Token Scopes |
|  |  |  |
|  |  | Each token can be given one or more scopes they can be used within. These can be thought of as |
| Expand Down  Expand Up | | @@ -125,3 +113,52 @@ if ($user->tokenCant('forums.manage')) { |
|  |  | // do something.... |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | ## Configuration |
|  |  |  |
|  |  | Configure \*\*app/Config/AuthToken.php\*\* for your needs. |
|  |  |  |
|  |  | !!! note |
|  |  |  |
|  |  | Shield does not expect you use the Access Token Authenticator and HMAC Authenticator |
|  |  | at the same time. Therefore, some Config items are common. |
|  |  |  |
|  |  | ### Access Token Lifetime |
|  |  |  |
|  |  | Tokens will expire after a specified amount of time has passed since they have been used. |
|  |  |  |
|  |  | By default, this is set to 1 year. |
|  |  | You can change this value by setting the `$unusedTokenLifetime` value. This is |
|  |  | in seconds so that you can use the |
|  |  | [time constants](https://codeigniter.com/user\_guide/general/common\_functions.html#time-constants) |
|  |  | that CodeIgniter provides. |
|  |  |  |
|  |  | ```php |
|  |  | public $unusedTokenLifetime = YEAR; |
|  |  | ``` |
|  |  |  |
|  |  | ### Login Attempt Logging |
|  |  |  |
|  |  | By default, only failed login attempts are recorded in the `auth\_token\_logins` table. |
|  |  |  |
|  |  | This can be modified by changing the `$recordLoginAttempt` value. |
|  |  |  |
|  |  | ```php |
|  |  | public int $recordLoginAttempt = Auth::RECORD\_LOGIN\_ATTEMPT\_FAILURE; |
|  |  | ``` |
|  |  |  |
|  |  | If you don't want any logs, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_NONE`. |
|  |  |  |
|  |  | If you want to log all login attempts, set it to `Auth::RECORD\_LOGIN\_ATTEMPT\_ALL`. |
|  |  | It means you log all requests. |
|  |  |  |
|  |  | ## Logging |
|  |  |  |
|  |  | Login attempts are recorded in the `auth\_token\_logins` table, according to the |
|  |  | configuration above. |
|  |  |  |
|  |  | When a failed login attempt is logged, the raw token value sent is saved in |
|  |  | the `identifier` column. |
|  |  |  |
|  |  | When a successful login attempt is logged, the token name is saved in the |
|  |  | `identifier` column. |

5 changes: 0 additions & 5 deletions

5
[phpstan-baseline.php](#diff-2d7a277ce37ae2b36daa2f4a61830d26f0994e4c6029cbadb5541f080df05a49 "phpstan-baseline.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/phpstan-baseline.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -361,11 +361,6 @@ |
|  |  | 'count' => 1, |
|  |  | 'path' => \_\_DIR\_\_ . '/src/Models/UserModel.php', |
|  |  | ]; |
|  |  | $ignoreErrors[] = [ |
|  |  | 'message' => '#^Call to method PHPUnit\\\\Framework\\\\Assert\\:\\:assertInstanceOf\\(\\) with \'CodeIgniter\\\\\\\\Shield\\\\\\\\Result\' and CodeIgniter\\\\Shield\\\\Result will always evaluate to true\\.$#', |
|  |  | 'count' => 2, |
|  |  | 'path' => \_\_DIR\_\_ . '/tests/Authentication/Authenticators/AccessTokenAuthenticatorTest.php', |
|  |  | ]; |
|  |  | $ignoreErrors[] = [ |
|  |  | 'message' => '#^Call to method PHPUnit\\\\Framework\\\\Assert\\:\\:assertInstanceOf\\(\\) with \'CodeIgniter\\\\\\\\Shield\\\\\\\\Result\' and CodeIgniter\\\\Shield\\\\Result will always evaluate to true\\.$#', |
|  |  | 'count' => 3, |
| Expand Down | |  |

11 changes: 5 additions & 6 deletions

11
[src/Authentication/Authenticators/AccessTokens.php](#diff-6ab5754a3b2605824618f5b7e8b9f2b8858d10456fcb1eb13c14b5752f4b32cf "src/Authentication/Authenticators/AccessTokens.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/src/Authentication/Authenticators/AccessTokens.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -77,14 +77,15 @@ public function attempt(array $credentials): Result |
|  |  | return $result; |
|  |  | } |
|  |  |  |
|  |  | $user = $result->extraInfo(); |
|  |  | $user = $result->extraInfo(); |
|  |  | $token = $user->getAccessToken($this->getBearerToken()); |
|  |  |  |
|  |  | if ($user->isBanned()) { |
|  |  | if ($config->recordLoginAttempt >= Auth::RECORD\_LOGIN\_ATTEMPT\_FAILURE) { |
|  |  | // Record a banned login attempt. |
|  |  | $this->loginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_ACCESS\_TOKEN, |
|  |  | $credentials['token'] ?? '', |
|  |  | $token->name ?? '', |
|  |  | false, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand All | | @@ -100,17 +101,15 @@ public function attempt(array $credentials): Result |
|  |  | ]); |
|  |  | } |
|  |  |  |
|  |  | $user = $user->setAccessToken( |
|  |  | $user->getAccessToken($this->getBearerToken()) |
|  |  | ); |
|  |  | $user = $user->setAccessToken($token); |
|  |  |  |
|  |  | $this->login($user); |
|  |  |  |
|  |  | if ($config->recordLoginAttempt === Auth::RECORD\_LOGIN\_ATTEMPT\_ALL) { |
|  |  | // Record a successful login attempt. |
|  |  | $this->loginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_ACCESS\_TOKEN, |
|  |  | $credentials['token'] ?? '', |
|  |  | $token->name ?? '', |
|  |  | true, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand Down | |  |

11 changes: 5 additions & 6 deletions

11
[src/Authentication/Authenticators/HmacSha256.php](#diff-e296899f7db51e66ae5504de03cb4c6f54637e9df9fb5685a645d40be4b11c43 "src/Authentication/Authenticators/HmacSha256.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/src/Authentication/Authenticators/HmacSha256.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -78,14 +78,15 @@ public function attempt(array $credentials): Result |
|  |  | return $result; |
|  |  | } |
|  |  |  |
|  |  | $user = $result->extraInfo(); |
|  |  | $user = $result->extraInfo(); |
|  |  | $token = $user->getHmacToken($this->getHmacKeyFromToken()); |
|  |  |  |
|  |  | if ($user->isBanned()) { |
|  |  | if ($config->recordLoginAttempt >= Auth::RECORD\_LOGIN\_ATTEMPT\_FAILURE) { |
|  |  | // Record a banned login attempt. |
|  |  | $this->loginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_HMAC\_TOKEN, |
|  |  | $credentials['token'] ?? '', |
|  |  | $token->name ?? '', |
|  |  | false, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand All | | @@ -101,17 +102,15 @@ public function attempt(array $credentials): Result |
|  |  | ]); |
|  |  | } |
|  |  |  |
|  |  | $user = $user->setHmacToken( |
|  |  | $user->getHmacToken($this->getHmacKeyFromToken()) |
|  |  | ); |
|  |  | $user = $user->setHmacToken($token); |
|  |  |  |
|  |  | $this->login($user); |
|  |  |  |
|  |  | if ($config->recordLoginAttempt === Auth::RECORD\_LOGIN\_ATTEMPT\_ALL) { |
|  |  | // Record a successful login attempt. |
|  |  | $this->loginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_HMAC\_TOKEN, |
|  |  | $credentials['token'] ?? '', |
|  |  | $token->name ?? '', |
|  |  | true, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/Authentication/Authenticators/JWT.php](#diff-6fb461d2a3d4e19febe32c56fd9297ffdd8ab5048ccc88d6b01637a869f0a17e "src/Authentication/Authenticators/JWT.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/src/Authentication/Authenticators/JWT.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,7 +103,7 @@ public function attempt(array $credentials): Result |
|  |  | // Record a banned login attempt. |
|  |  | $this->tokenLoginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_JWT, |
|  |  | $credentials['token'] ?? '', |
|  |  | 'sha256:' . hash('sha256', $credentials['token'] ?? ''), |
|  |  | false, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand All | | @@ -125,7 +125,7 @@ public function attempt(array $credentials): Result |
|  |  | // Record a successful login attempt. |
|  |  | $this->tokenLoginModel->recordLoginAttempt( |
|  |  | self::ID\_TYPE\_JWT, |
|  |  | $credentials['token'] ?? '', |
|  |  | 'sha256:' . hash('sha256', $credentials['token']), |
|  |  | true, |
|  |  | $ipAddress, |
|  |  | $userAgent, |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/Config/AuthToken.php](#diff-030358efc956ecc8de95e9223e1ad956a988a25bbdabc40d7c0fd879989c5d89 "src/Config/AuthToken.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/src/Config/AuthToken.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ class AuthToken extends BaseAuthToken |
|  |  |  |
|  |  | /\*\* |
|  |  | \* -------------------------------------------------------------------- |
|  |  | \* Unused Token Lifetime |
|  |  | \* Unused Token Lifetime for Token Auth and HMAC Auth |
|  |  | \* -------------------------------------------------------------------- |
|  |  | \* Determines the amount of time, in seconds, that an unused token can |
|  |  | \* be used. |
| Expand Down | |  |

35 changes: 32 additions & 3 deletions

35
[tests/Authentication/Authenticators/AccessTokenAuthenticatorTest.php](#diff-eca75f332bd7644fe79ebe8664f850fe45e32246e99d6257feb107dc9ed33dc8 "tests/Authentication/Authenticators/AccessTokenAuthenticatorTest.php")

Show comments

[View file](/codeigniter4/shield/blob/7e84c3fb3411294f70890819bfe51781bb9dc8e4/tests/Authentication/Authenticators/AccessTokenAuthenticatorTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,11 +17,11 @@ |
|  |  | use CodeIgniter\Shield\Authentication\Authentication; |
|  |  | use CodeIgniter\Shield\Authentication\Authenticators\AccessTokens; |
|  |  | use CodeIgniter\Shield\Config\Auth; |
|  |  | use CodeIgniter\Shield\Config\AuthToken; |
|  |  | use CodeIgniter\Shield\Entities\AccessToken; |
|  |  | use CodeIgniter\Shield\Entities\User; |
|  |  | use CodeIgniter\Shield\Models\UserIdentityModel; |
|  |  | use CodeIgniter\Shield\Models\UserModel; |
|  |  | use CodeIgniter\Shield\Result; |
|  |  | use CodeIgniter\Test\Mock\MockEvents; |
|  |  | use Config\Services; |
|  |  | use Tests\Support\DatabaseTestCase; |
| Expand Down  Expand Up | | @@ -182,7 +182,6 @@ public function testAttemptCannotFindUser(): void |
|  |  | 'token' => 'abc123', |
|  |  | ]); |
|  |  |  |
|  |  | $this->assertInstanceOf(Result::class, $result); |
|  |  | $this->assertFalse($result->isOK()); |
|  |  | $this->assertSame(lang('Auth.badToken'), $result->reason()); |
|  |  |  |
| Expand All | | @@ -205,7 +204,6 @@ public function testAttemptSuccess(): void |
|  |  | 'token' => $token->raw\_token, |
|  |  | ]); |
|  |  |  |
|  |  | $this->assertInstanceOf(Result::class, $result); |
|  |  | $this->assertTrue($result->isOK()); |
|  |  |  |
|  |  | $foundUser = $result->extraInfo(); |
| Expand All | | @@ -222,6 +220,37 @@ public function testAttemptSuccess(): void |
|  |  | ]); |
|  |  | } |
|  |  |  |
|  |  | public function testAttemptSuccessLog(): void |
|  |  | { |
|  |  | // Change $recordLoginAttempt in Config. |
|  |  | /\*\* @var AuthToken $config \*/ |
|  |  | $config = config('AuthToken'); |
|  |  | $config->recordLoginAttempt = Auth::RECORD\_LOGIN\_ATTEMPT\_ALL; |
|  |  |  |
|  |  | /\*\* @var User $user \*/ |
|  |  | $user = fake(UserModel::class); |
|  |  | $token = $user->generateAccessToken('foo'); |
|  |  | $this->setRequestHeader($token->raw\_token); |
|  |  |  |
|  |  | $result = $this->auth->attempt([ |
|  |  | 'token' => $token->raw\_token, |
|  |  | ]); |
|  |  |  |
|  |  | $this->assertTrue($result->isOK()); |
|  |  |  |
|  |  | $foundUser = $result->extraInfo(); |
|  |  | $this->assertInstanceOf(User::class, $foundUser); |
|  |  | $this->assertSame($user->id, $foundUser->id); |
|  |  | $this->assertInstanceOf(AccessToken::class, $foundUser->currentAccessToken()); |
|  |  | $this->assertSame($token->token, $foundUser->currentAccessToken()->token); |
|  |  |  |
|  |  | $this->seeInDatabase($this->tables['token\_logins'], [ |
|  |  | 'id\_type' => AccessTokens::ID\_TYPE\_ACCESS\_TOKEN, |
|  |  | 'identifier' => 'foo', |
|  |  | 'success' => 1, |
|  |  | ]); |
|  |  | } |
|  |  |  |
|  |  | protected function setRequestHeader(string $token): void |
|  |  | { |
|  |  | $request = service('request'); |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7e84c3f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcodeigniter4%2Fshield%2Fcommit%2F7e84c3fb3411294f70890819bfe51781bb9dc8e4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5c6f3fa1_20250115_102645.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcodeigniter4%2Fshield%2Fsecurity%2Fadvisories%2FGHSA-j72f-h752-mx4w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcodeigniter4%2Fshield%2Fsecurity%2Fadvisories%2FGHSA-j72f-h752-mx4w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=codeigniter4%2Fshield)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[codeigniter4](/codeigniter4)
/
**[shield](/codeigniter4/shield)**
Public

* [Notifications](/login?return_to=%2Fcodeigniter4%2Fshield) You must be signed in to change notification settings
* [Fork
  132](/login?return_to=%2Fcodeigniter4%2Fshield)
* [Star
   372](/login?return_to=%2Fcodeigniter4%2Fshield)

* [Code](/codeigniter4/shield)
* [Issues
  5](/codeigniter4/shield/issues)
* [Pull requests
  12](/codeigniter4/shield/pulls)
* [Discussions](/codeigniter4/shield/discussions)
* [Actions](/codeigniter4/shield/actions)
* [Projects
  0](/codeigniter4/shield/projects)
* [Security](/codeigniter4/shield/security)
* [Insights](/codeigniter4/shield/pulse)

Additional navigation options

* [Code](/codeigniter4/shield)
* [Issues](/codeigniter4/shield/issues)
* [Pull requests](/codeigniter4/shield/pulls)
* [Discussions](/codeigniter4/shield/discussions)
* [Actions](/codeigniter4/shield/actions)
* [Projects](/codeigniter4/shield/projects)
* [Security](/codeigniter4/shield/security)
* [Insights](/codeigniter4/shield/pulse)

# Insertion of Sensitive Information into Log

Moderate

[kenjis](/kenjis)
published
GHSA-j72f-h752-mx4w
Nov 23, 2023

## Package

composer

codeigniter4/shield
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

< 1.0.0-beta.8

## Patched versions

1.0.0-beta.8

## Description

### Impact

If successful login attempts are recorded, the raw tokens are stored in the log table.

If a malicious person somehow views the data in the log table, he or she can obtain a raw token, which can then be used to send a request with that user's authority.

When you (1) **use the following authentiactors**,

* [AccessTokens](https://codeigniter4.github.io/shield/references/authentication/tokens/) (`tokens`)
* [JWT](https://codeigniter4.github.io/shield/addons/jwt/) (`jwt`)
* [HmacSha256](https://codeigniter4.github.io/shield/references/authentication/hmac/) (`hmac`)

and you (2) **log successful login attempts**, the raw tokens are stored.

### Patches

Upgrade to Shield v1.0.0-beta.8 or later.

### Workarounds

Disable logging for successful login attempts by the configuration files.

* AccessTokens or HmacSha256
  + Set `Config\AuthToken::$recordLoginAttempt` to `Auth::RECORD_LOGIN_ATTEMPT_FAILURE` or `Auth::RECORD_LOGIN_ATTEMPT_NONE`
* JWT
  + Set `Config\AuthJWT::$recordLoginAttempt` to `Auth::RECORD_LOGIN_ATTEMPT_FAILURE` or `Auth::RECORD_LOGIN_ATTEMPT_NONE`

### References

* <https://codeigniter4.github.io/shield/getting_started/authenticators/>

### For more information

If you have any questions or comments about this advisory:

* Open an issue or discussion in [codeigniter4/shield](https://github.com/codeigniter4/shield)
* Email us at security@codeigniter.com

### Severity

Moderate

5.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:L/A:N

### CVE ID

CVE-2023-48708

### Weaknesses

[CWE-532](/advisories?query=cwe%3A532)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from codeigniter4.github.io_21b73994_20250115_102640.html ===


[Skip to content](#authenticators)

[![logo](../../assets/flame.svg)](https://codeigniter.com "CodeIgniter Shield")

CodeIgniter Shield

Authenticators

Initializing search

[GitHub](https://github.com/codeigniter4/shield "Go to repository")

[![logo](../../assets/flame.svg)](https://codeigniter.com "CodeIgniter Shield")
CodeIgniter Shield

[GitHub](https://github.com/codeigniter4/shield "Go to repository")

* [Home](../..)
* Getting Started

  Getting Started
  + [Concepts](../concepts/)
  + [Installation](../install/)
  + Authenticators

    [Authenticators](./)

    Table of contents
    - [Authenticator List](#authenticator-list)
  + [Configuration](../configuration/)
* Quick Start Guide

  Quick Start Guide
  + [Using Session Authenticator](../../quick_start_guide/using_session_auth/)
  + [Using Authorization](../../quick_start_guide/using_authorization/)
* Customization

  Customization
  + [Customizing Table Names](../../customization/table_names/)
  + [Customizing Views](../../customization/views/)
  + [Customizing Routes](../../customization/route_config/)
  + [Customizing Redirect URLs](../../customization/redirect_urls/)
  + [Customizing Validation Rules](../../customization/validation_rules/)
  + [Customizing User Provider](../../customization/user_provider/)
  + [Adding Attributes to Users](../../customization/adding_attributes_to_users/)
  + [Extending the Controllers](../../customization/extending_controllers/)
  + [Integrating Custom View Libraries](../../customization/integrating_custom_view_libs/)
  + [Customizing Login Identifier](../../customization/login_identifier/)
* User Management

  User Management
  + [Managing Users](../../user_management/managing_users/)
  + [Forcing Password Reset](../../user_management/forcing_password_reset/)
  + [Banning Users](../../user_management/banning_users/)
* Guides

  Guides
  + [Protecting an API with Access Tokens](../../guides/api_tokens/)
  + [Protecting an API with HMAC Keys](../../guides/api_hmac_keys/)
  + [Mobile Authentication with Access Tokens](../../guides/mobile_apps/)
  + [How to Strengthen the Password](../../guides/strengthen_password/)
* References

  References
  + [Controller Filters](../../references/controller_filters/)
  + Authentication

    Authentication
    - [Authentication](../../references/authentication/authentication/)
    - [Session Authenticator](../../references/authentication/session/)
    - [Token Authenticator](../../references/authentication/tokens/)
    - [HMAC Authenticator](../../references/authentication/hmac/)
    - [Auth Actions](../../references/authentication/auth_actions/)
  + [Magic Link Login](../../references/magic_link_login/)
  + [Authorization](../../references/authorization/)
  + [Events](../../references/events/)
  + [Testing](../../references/testing/)
* Addons

  Addons
  + [JWT Authentication](../../addons/jwt/)

Table of contents

* [Authenticator List](#authenticator-list)

# Authenticators

## Authenticator List

Shield provides the following Authenticators:

* **Session** authenticator provides traditional ID/Password authentication.
  It uses username/email/password to authenticate against and stores the user
  information in the session. See [Using Session Authenticator](../../quick_start_guide/using_session_auth/)
  and [Session Authenticator](../../references/authentication/session/) for usage.
* **AccessTokens** authenticator provides stateless authentication using Personal
  Access Tokens passed in the HTTP headers.
  See [Protecting an API with Access Tokens](../../guides/api_tokens/) and
  [Access Token Authenticator](../../references/authentication/tokens/) for usage.
* **HmacSha256** authenticator provides stateless authentication using HMAC Keys.
  See [Protecting an API with HMAC Keys](../../guides/api_hmac_keys/) and
  [HMAC SHA256 Token Authenticator](../../references/authentication/hmac/) for usage.
* **JWT** authenticator provides stateless authentication using JSON Web Token. To use this,
  you need additional setup. See [JWT Authentication](../../addons/jwt/).

September 22, 2023

September 17, 2023

Back to top

[Previous

Installation](../install/)
[Next

Configuration](../configuration/)

Copyright © 2023-2024 CodeIgniter Foundation.


