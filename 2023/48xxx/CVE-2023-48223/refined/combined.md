=== Content from github.com_dc80622b_20250114_230625.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Fsecurity%2Fadvisories%2FGHSA-c2ff-88x2-x9pg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Fsecurity%2Fadvisories%2FGHSA-c2ff-88x2-x9pg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nearform%2Ffast-jwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nearform](/nearform)
/
**[fast-jwt](/nearform/fast-jwt)**
Public

* [Notifications](/login?return_to=%2Fnearform%2Ffast-jwt) You must be signed in to change notification settings
* [Fork
  33](/login?return_to=%2Fnearform%2Ffast-jwt)
* [Star
   369](/login?return_to=%2Fnearform%2Ffast-jwt)

* [Code](/nearform/fast-jwt)
* [Issues
  3](/nearform/fast-jwt/issues)
* [Pull requests
  3](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

Additional navigation options

* [Code](/nearform/fast-jwt)
* [Issues](/nearform/fast-jwt/issues)
* [Pull requests](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

# JWT Algorithm Confusion

Moderate

[simoneb](/simoneb)
published
GHSA-c2ff-88x2-x9pg
Nov 20, 2023

## Package

npm

fast-jwt
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 3.3.1

## Patched versions

3.3.2

## Description

### Summary

The fast-jwt library does not properly prevent JWT algorithm confusion for all public key types.

### Details

The 'publicKeyPemMatcher' in 'fast-jwt/src/crypto.js' does not properly match all common PEM formats for public keys. To exploit this vulnerability, an attacker needs to craft a malicious JWT token containing the HS256 algorithm, signed with the public RSA key of the victim application. This attack will only work if the victim application utilizes a public key containing the `BEGIN RSA PUBLIC KEY` header.

### PoC

Take a server running the following code:

```
const express = require('express');
const { createSigner, createVerifier } = require('fast-jwt')
const fs = require('fs');
const path = require('path');

const app = express();
const port = 3000;

// Load the keys from the file
const publicKeyPath = path.join(__dirname, 'public_key.pem');
const publicKey = fs.readFileSync(publicKeyPath, 'utf8');
const privateKeyPath = path.join(__dirname, 'key');
const privateKey = fs.readFileSync(privateKeyPath, 'utf8');

app.use(express.json());

// Endpoint to generate a JWT token with admin: False
app.get('/generateToken', async (req, res) => {
  const payload = { admin: false, name: req.query.name };

  const signSync = createSigner({ algorithm: 'RS256', key: privateKey });
  const token = signSync(payload);

  res.json({ token });
});

// Middleware to verify the JWT token
function verifyToken(req, res, next) {
  const token = req.query.token;

  const verifySync = createVerifier({ key: publicKey });
  const payload = verifySync(token);

  req.decoded = payload;
  next();
}

// Endpoint to check if you are the admin or not
app.get('/checkAdmin', verifyToken, (req, res) => {
  res.json(req.decoded);
});

app.listen(port, () => {
  console.log(`Server is running on port ${port}`);
});
```

Assume the server generated their keys like follows:

```
ssh-keygen -t rsa -b 2048 -m PEM
ssh-keygen -f key.pub -e -m PEM > public_key.pem

```

**Public key recovery**

First, an attacker needs to recover the public key from the server in any way possible. It is possible to extract this from just two JWT tokens as shown below.

Grab two different JWT tokens and utilize the following tool: `https://github.com/silentsignal/rsa_sign2n/blob/release/standalone/jwt_forgery.py`

```
python3 jwt_forgery.py token1 token2

```

The tool will generate 4 different public keys, all in different formats. Try the following for all 4 formats.

**Algorithm confusion**

Change the JWT to the HS256 algorithm and modify any of the contents to your liking at `https://jwt.io/`.

Copy the resulting JWT token and use with the following tool: `https://github.com/ticarpi/jwt_tool`

```
python /opt/jwt_tool/jwt_tool.py --exploit k -pk public_key token

```

You will now get a resulting JWT token that is validly signed.

### Impact

Applications using the RS256 algorithm, a public key with a `BEGIN RSA PUBLIC KEY` header, and calling the verify function without explicitly providing an algorithm, are vulnerable to this algorithm confusion attack which allows attackers to sign arbitrary payloads which will be accepted by the verifier.

### Solution

Change <https://github.com/nearform/fast-jwt/blob/master/src/crypto.js#L29>

```
const publicKeyPemMatcher = '-----BEGIN PUBLIC KEY-----'
```

to be regex:

```
const publicKeyPemMatcher = /^-----BEGIN( RSA)? PUBLIC KEY-----/
```

### Severity

Moderate

5.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N

### CVE ID

CVE-2023-48223

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### Credits

* [![@PinkDraconian](https://avatars.githubusercontent.com/u/44903767?s=40&v=4)](/PinkDraconian)
  [PinkDraconian](/PinkDraconian)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_869e3a69_20250114_230622.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Fblob%2Fmaster%2Fsrc%2Fcrypto.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Fblob%2Fmaster%2Fsrc%2Fcrypto.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nearform%2Ffast-jwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nearform](/nearform)
/
**[fast-jwt](/nearform/fast-jwt)**
Public

* [Notifications](/login?return_to=%2Fnearform%2Ffast-jwt) You must be signed in to change notification settings
* [Fork
  33](/login?return_to=%2Fnearform%2Ffast-jwt)
* [Star
   369](/login?return_to=%2Fnearform%2Ffast-jwt)

* [Code](/nearform/fast-jwt)
* [Issues
  3](/nearform/fast-jwt/issues)
* [Pull requests
  3](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

Additional navigation options

* [Code](/nearform/fast-jwt)
* [Issues](/nearform/fast-jwt/issues)
* [Pull requests](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

## Files

 master
## Breadcrumbs

1. [fast-jwt](/nearform/fast-jwt/tree/master)
2. /[src](/nearform/fast-jwt/tree/master/src)
/
# crypto.js

Copy path Blame  Blame
## Latest commit

## History

[History](/nearform/fast-jwt/commits/master/src/crypto.js)327 lines (280 loc) · 9.36 KB master
## Breadcrumbs

1. [fast-jwt](/nearform/fast-jwt/tree/master)
2. /[src](/nearform/fast-jwt/tree/master/src)
/
# crypto.js

Top
## File metadata and controls

* Code
* Blame

327 lines (280 loc) · 9.36 KB[Raw](https://github.com/nearform/fast-jwt/raw/refs/heads/master/src/crypto.js)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327'use strict'
const asn = require('asn1.js')const { createHmac, createVerify, createSign, timingSafeEqual, createPublicKey, constants: { RSA\_PKCS1\_PSS\_PADDING, RSA\_PSS\_SALTLEN\_DIGEST, RSA\_PKCS1\_PADDING, RSA\_PSS\_SALTLEN\_MAX\_SIGN, RSA\_PSS\_SALTLEN\_AUTO }} = require('node:crypto')const { sign: directSign, verify: directVerify } = require('node:crypto')const { joseToDer, derToJose } = require('ecdsa-sig-formatter')const Cache = require('mnemonist/lru-cache')const { TokenError } = require('./error')
const base64UrlMatcher = /[=+/]/gconst encoderMap = { '=': '', '+': '-', '/': '\_' }
const privateKeyPemMatcher = /^-----BEGIN(?: (RSA|EC|ENCRYPTED))? PRIVATE KEY-----/const publicKeyPemMatcher = /^-----BEGIN(?: (RSA))? PUBLIC KEY-----/const publicKeyX509CertMatcher = '-----BEGIN CERTIFICATE-----'const privateKeysCache = new Cache(1000)const publicKeysCache = new Cache(1000)
const hsAlgorithms = ['HS256', 'HS384', 'HS512']const esAlgorithms = ['ES256', 'ES384', 'ES512']const rsaAlgorithms = ['RS256', 'RS384', 'RS512', 'PS256', 'PS384', 'PS512']const edAlgorithms = ['EdDSA']const ecCurves = { '1.2.840.10045.3.1.7': { bits: '256', names: ['P-256', 'prime256v1'] }, '1.3.132.0.10': { bits: '256', names: ['secp256k1'] }, '1.3.132.0.34': { bits: '384', names: ['P-384', 'secp384r1'] }, '1.3.132.0.35': { bits: '512', names: ['P-521', 'secp521r1'] }}
const PrivateKey = asn.define('PrivateKey', function () { this.seq().obj( this.key('version').int(), this.key('algorithm').seq().obj(this.key('algorithm').objid(), this.key('parameters').optional().objid()) )})
const PublicKey = asn.define('PublicKey', function () { this.seq().obj( this.key('algorithm').seq().obj(this.key('algorithm').objid(), this.key('parameters').optional().objid()) )})
const ECPrivateKey = asn.define('ECPrivateKey', function () { this.seq().obj( this.key('version').int(), this.key('privateKey').octstr(), this.key('parameters').explicit(0).optional().choice({ namedCurve: this.objid() }) )})
function base64UrlReplacer(c) { return encoderMap[c]}
function cacheSet(cache, key, value, error) { cache.set(key, [value, error]) return value || error}
function performDetectPrivateKeyAlgorithm(key) { if (key.match(publicKeyPemMatcher) || key.includes(publicKeyX509CertMatcher)) { throw new TokenError(TokenError.codes.invalidKey, 'Public keys are not supported for signing.') }
 const pemData = key.trim().match(privateKeyPemMatcher)
 if (!pemData) { return 'HS256' }
 let keyData let oid let curveId
 switch (pemData[1]) { case 'RSA': // pkcs1 format - Can only be RSA key return 'RS256' case 'EC': // sec1 format - Can only be a EC key keyData = ECPrivateKey.decode(key, 'pem', { label: 'EC PRIVATE KEY' }) curveId = keyData.parameters.value.join('.') break case 'ENCRYPTED': // Can be either RSA or EC key - we'll used the supplied algorithm return 'ENCRYPTED' default: // pkcs8 keyData = PrivateKey.decode(key, 'pem', { label: 'PRIVATE KEY' }) oid = keyData.algorithm.algorithm.join('.')
 switch (oid) { case '1.2.840.113549.1.1.1': // RSA return 'RS256' case '1.2.840.10045.2.1': // EC curveId = keyData.algorithm.parameters.join('.') break case '1.3.101.112': // Ed25519 case '1.3.101.113': // Ed448 return 'EdDSA' default: throw new TokenError(TokenError.codes.invalidKey, `Unsupported PEM PCKS8 private key with OID ${oid}.`) } }
 const curve = ecCurves[curveId]
 if (!curve) { throw new TokenError(TokenError.codes.invalidKey, `Unsupported EC private key with curve ${curveId}.`) }
 return `ES${curve.bits}`}
function performDetectPublicKeyAlgorithms(key) { const publicKeyPemMatch = key.match(publicKeyPemMatcher)
 if (key.match(privateKeyPemMatcher)) { throw new TokenError(TokenError.codes.invalidKey, 'Private keys are not supported for verifying.') } else if (publicKeyPemMatch && publicKeyPemMatch[1] === 'RSA') { // pkcs1 format - Can only be RSA key return rsaAlgorithms } else if (!publicKeyPemMatch && !key.includes(publicKeyX509CertMatcher)) { // Not a PEM, assume a plain secret return hsAlgorithms }
 // if the key is a X509 cert we need to convert it if (key.includes(publicKeyX509CertMatcher)) { key = createPublicKey(key).export({ type: 'spki', format: 'pem' }) }
 const keyData = PublicKey.decode(key, 'pem', { label: 'PUBLIC KEY' }) const oid = keyData.algorithm.algorithm.join('.') let curveId
 switch (oid) { case '1.2.840.113549.1.1.1': // RSA return rsaAlgorithms case '1.2.840.10045.2.1': // EC curveId = keyData.algorithm.parameters.join('.') break case '1.3.101.112': // Ed25519 case '1.3.101.113': // Ed448 return ['EdDSA'] default: throw new TokenError(TokenError.codes.invalidKey, `Unsupported PEM PCKS8 public key with OID ${oid}.`) }
 const curve = ecCurves[curveId]
 if (!curve) { throw new TokenError(TokenError.codes.invalidKey, `Unsupported EC public key with curve ${curveId}.`) }
 return [`ES${curve.bits}`]}
function detectPrivateKeyAlgorithm(key, providedAlgorithm) { if (key instanceof Buffer) { key = key.toString('utf-8') } else if (typeof key !== 'string') { throw new TokenError(TokenError.codes.invalidKey, 'The private key must be a string or a buffer.') }
 // Check cache first const [cached, error] = privateKeysCache.get(key) || []
 if (cached) { return cached } else if (error) { throw error }
 // Try detecting try { const detectedAlgorithm = performDetectPrivateKeyAlgorithm(key)
 if (detectedAlgorithm === 'ENCRYPTED') { return cacheSet(privateKeysCache, key, providedAlgorithm) } return cacheSet(privateKeysCache, key, detectedAlgorithm) } catch (e) { throw cacheSet( privateKeysCache, key, null, TokenError.wrap(e, TokenError.codes.invalidKey, 'Unsupported PEM private key.') ) }}
function detectPublicKeyAlgorithms(key) { if (!key) { return 'none' } // Check cache first const [cached, error] = publicKeysCache.get(key) || []
 if (cached) { return cached } else if (error) { throw error }
 // Try detecting try { if (key instanceof Buffer) { key = key.toString('utf-8') } else if (typeof key !== 'string') { throw new TokenError(TokenError.codes.invalidKey, 'The public key must be a string or a buffer.') } return cacheSet(publicKeysCache, key, performDetectPublicKeyAlgorithms(key)) } catch (e) { throw cacheSet( publicKeysCache, key, null, TokenError.wrap(e, TokenError.codes.invalidKey, 'Unsupported PEM public key.') ) }}
function createSignature(algorithm, key, input) { try { const type = algorithm.slice(0, 2) const alg = `sha${algorithm.slice(2)}`
 let raw let options
 switch (type) { case 'HS': raw = createHmac(alg, key).update(input).digest('base64') break case 'ES': raw = derToJose(directSign(alg, Buffer.from(input, 'utf-8'), key), algorithm).toString('base64') break case 'RS': case 'PS': options = { key, padding: RSA\_PKCS1\_PADDING, saltLength: RSA\_PSS\_SALTLEN\_MAX\_SIGN }
 if (type === 'PS') { options.padding = RSA\_PKCS1\_PSS\_PADDING options.saltLength = RSA\_PSS\_SALTLEN\_DIGEST }
 raw = createSign(alg).update(input).sign(options).toString('base64') break case 'Ed': raw = directSign(undefined, Buffer.from(input, 'utf-8'), key).toString('base64') }
 return raw.replace(base64UrlMatcher, base64UrlReplacer) } catch (e) { /\* istanbul ignore next \*/ throw new TokenError(TokenError.codes.signError, 'Cannot create the signature.', { originalError: e }) }}
function verifySignature(algorithm, key, input, signature) { try { const type = algorithm.slice(0, 2) const alg = `SHA${algorithm.slice(2)}`
 signature = Buffer.from(signature, 'base64')
 if (type === 'HS') { try { return timingSafeEqual(createHmac(alg, key).update(input).digest(), signature) } catch { return false } } else if (type === 'Ed') { // Check if supported on Node 10 /\* istanbul ignore next \*/ if (typeof directVerify === 'function') { return directVerify(undefined, Buffer.from(input, 'utf-8'), key, signature) } else { throw new TokenError(TokenError.codes.signError, 'EdDSA algorithms are not supported by your Node.js version.') } }
 const options = { key, padding: RSA\_PKCS1\_PADDING, saltLength: RSA\_PSS\_SALTLEN\_AUTO }
 if (type === 'PS') { options.padding = RSA\_PKCS1\_PSS\_PADDING options.saltLength = RSA\_PSS\_SALTLEN\_DIGEST } else if (type === 'ES') { signature = joseToDer(signature, algorithm) }
 return createVerify('RSA-' + alg) .update(input) .verify(options, signature) } catch (e) { /\* istanbul ignore next \*/ throw new TokenError(TokenError.codes.verifyError, 'Cannot verify the signature.', { originalError: e }) }}
module.exports = { base64UrlMatcher, base64UrlReplacer, hsAlgorithms, rsaAlgorithms, esAlgorithms, edAlgorithms, detectPrivateKeyAlgorithm, detectPublicKeyAlgorithms, createSignature, verifySignature}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_54f5c87d_20250114_230623.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Freleases%2Ftag%2Fv3.3.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnearform%2Ffast-jwt%2Freleases%2Ftag%2Fv3.3.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=nearform%2Ffast-jwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nearform](/nearform)
/
**[fast-jwt](/nearform/fast-jwt)**
Public

* [Notifications](/login?return_to=%2Fnearform%2Ffast-jwt) You must be signed in to change notification settings
* [Fork
  33](/login?return_to=%2Fnearform%2Ffast-jwt)
* [Star
   369](/login?return_to=%2Fnearform%2Ffast-jwt)

* [Code](/nearform/fast-jwt/tree/v3.3.2)
* [Issues
  3](/nearform/fast-jwt/issues)
* [Pull requests
  3](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

Additional navigation options

* [Code](/nearform/fast-jwt/tree/v3.3.2)
* [Issues](/nearform/fast-jwt/issues)
* [Pull requests](/nearform/fast-jwt/pulls)
* [Actions](/nearform/fast-jwt/actions)
* [Security](/nearform/fast-jwt/security)
* [Insights](/nearform/fast-jwt/pulse)

1. [Releases](/nearform/fast-jwt/releases)
2. [v3.3.2](/nearform/fast-jwt/releases/tag/v3.3.2)

# v3.3.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/nearform/fast-jwt/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.3.2)

 Loading

[View all tags](/nearform/fast-jwt/tags)

![@optic-release-automation](https://avatars.githubusercontent.com/u/1544687?s=40&v=4)
[optic-release-automation](/apps/optic-release-automation)
released this
20 Nov 14:33

[v3.3.2](/nearform/fast-jwt/tree/v3.3.2)

[`6604166`](/nearform/fast-jwt/commit/6604166db410371590af56ade555a97f77484995)

## What's Changed

* [OPTIC-RELEASE-AUTOMATION] release/v3.3.1 by @optic-release-automation in [#390](https://github.com/nearform/fast-jwt/pull/390)
* fix: add missingRequiredClaim to TokenValidationErrorCode by [@TimLehner](https://github.com/TimLehner) in [#403](https://github.com/nearform/fast-jwt/pull/403)
* fix(typescript): fix typescript type DecodedJwt by [@qoomon](https://github.com/qoomon) in [#407](https://github.com/nearform/fast-jwt/pull/407)

## New Contributors

* [@TimLehner](https://github.com/TimLehner) made their first contribution in [#403](https://github.com/nearform/fast-jwt/pull/403)
* [@qoomon](https://github.com/qoomon) made their first contribution in [#407](https://github.com/nearform/fast-jwt/pull/407)

**Full Changelog**: [v3.3.1...v3.3.2](https://github.com/nearform/fast-jwt/compare/v3.3.1...v3.3.2)

### Contributors

* [![@qoomon](https://avatars.githubusercontent.com/u/3963394?s=64&v=4)](https://github.com/qoomon)
* [![@TimLehner](https://avatars.githubusercontent.com/u/8646034?s=64&v=4)](https://github.com/TimLehner)

qoomon and TimLehner

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


