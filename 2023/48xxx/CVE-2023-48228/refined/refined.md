```
{
  "CVE-2023-48228": {
    "vulnerability_details": {
      "root_cause": "The vulnerability stems from an insufficient check of the `code_verifier` during the token exchange in an OAuth2 flow with PKCE. Specifically, the system was only verifying the `code_verifier` when it was provided. If the `code_verifier` was omitted in the token request, even though a `code_challenge` was present in the authorization request, the token request would be accepted.",
      "weaknesses": [
        "Improper enforcement of PKCE during token exchange.",
         "Lack of mandatory `code_verifier` check when `code_challenge` is present"
      ],
      "impact": "An attacker could bypass PKCE, gaining unauthorized access to the application via a compromised code. For public or hybrid clients, this allows malicious apps to receive and use the authorization code without needing the original `code_verifier`.",
       "attack_vectors": "The attack can be performed by an application that has the ability to receive the authorization code, typically through a custom URI scheme (e.g. a malicious mobile app registering the same URI scheme as the legitimate one). By omitting the `code_verifier` during the token request, the attacker can exchange the code for tokens and gain unauthorized access.",
      "required_capabilities": "The attacker needs the ability to receive the authorization code, which could be achieved by registering a matching URI scheme. They also need the capability to make token requests to the authentik server."
    },
    "remediation_details": {
        "patch_versions": [
          "2023.10.4",
          "2023.8.5"
        ],
        "fixes": [
            "The fix implemented in this patch makes the presence of a `code_verifier` mandatory when a `code_challenge` was present during the authorization request.",
           "The system will now reject the token request if the `code_verifier` is missing, even if the `code_challenge` was present during the authorization flow."
         ]
      }
  }
}
```