```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is due to a combination of an error in the authorization mechanism and improper input validation in the \"Network Diagnostic Commands\" feature of SmartNode SN200 devices.",
    "weaknesses": [
      "OS Command Injection (CWE-78)",
      "Improper Access Control (CWE-284)"
    ],
    "impact": "An unauthenticated attacker can execute arbitrary OS commands on the device.",
    "attack_vectors": "The attack vector is through the web interface of the device. Specifically, an HTTP POST request to the `/rest/.../...?executeAsync` endpoint with a crafted JSON payload in the request body.",
     "required_capabilities": "The attacker does not need any authentication or prior knowledge of credentials. They just need network access to the web interface of the device."
  },
  "additional_information": {
    "affected_products": "SmartNode SN200 Analog Telephone Adapter (ATA) & VoIP Gateway",
    "affected_versions": "Versions <= 3.21.2-23021",
    "poc": "The provided Proof of Concept (PoC) shows that an attacker can send an HTTP POST request with an empty AuthToken cookie and a JSON payload containing the command to execute. Example: `POST /rest/xxxxxxxxxxxxxxx/xxxxxxx?executeAsync HTTP/1.1\nCookie: AuthToken=; AuthGroup=superuser; UserName=admin\n[... shortened ...]\nConnection: close\n{\"cmd\":\"/usr/bin/id\",\"arguments\":[]}`",
    "solution": "The recommended solution is to disable the \"Network Diagnostic Commands\" feature if possible. Also, it is advised to block network access to the HTTP interface either directly on the device or through a firewall.",
    "disclosure_timeline": {
      "discovery": "2023-06-28",
      "report_to_manufacturer": "2023-07-05",
      "public_disclosure": "2023-08-28",
      "vulnerability_confirmation": "2023-10-13, on newly released update 3.22.0-23083"
    }
  }
}
```