=== Content from github.com_5625dc9a_20250115_183050.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan)

[strongswan](/strongswan)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Corg-login%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@strongswan](https://avatars.githubusercontent.com/u/457671?s=200&v=4)

# strongSwan

* Verified

  We've verified that the organization **strongswan** controls the domain:

  + **strongswan.org**
  [Learn more about verified organizations](https://docs.github.com/organizations/managing-organization-settings/verifying-or-approving-a-domain-for-your-organization)

* [179
  followers](/orgs/strongswan/followers)
* [https://strongswan.org](https://strongswan.org "https://strongswan.org")

* [Overview](/strongswan)
* [Repositories](/orgs/strongswan/repositories)
* [Projects](/orgs/strongswan/projects)
* [Packages](/orgs/strongswan/packages)
* [People](/orgs/strongswan/people)

More

* [Overview](/strongswan)
* [Repositories](/orgs/strongswan/repositories)
* [Projects](/orgs/strongswan/projects)
* [Packages](/orgs/strongswan/packages)
* [People](/orgs/strongswan/people)

## Pinned Loading

1. [strongswan](/strongswan/strongswan) strongswan Public

   strongSwan - IPsec-based VPN

   C

   [2.4k](/strongswan/strongswan/stargazers)
   [793](/strongswan/strongswan/forks)
2. [strongswan-docs](/strongswan/strongswan-docs) strongswan-docs Public

   AsciiDoc source files for the docs.strongswan.org website

   [13](/strongswan/strongswan-docs/stargazers)
   [33](/strongswan/strongswan-docs/forks)

### Repositories

 Loading

 Type

Select type

All

Public

Sources

Forks

Archived

Mirrors

Templates

 Language

Select language

All

C

Dockerfile

Go

Handlebars

Python

 Sort

Select order

Last updated

Name

Stars

Showing 10 of 12 repositories

* [strongswan](/strongswan/strongswan)
  Public

  strongSwan - IPsec-based VPN

   strongswan/strongswan’s past year of commit activity

  C

  [2,352](/strongswan/strongswan/stargazers)
  [793](/strongswan/strongswan/forks)
  [69](/strongswan/strongswan/issues)
  [43](/strongswan/strongswan/pulls)
  Updated Jan 15, 2025
* [strongswan-antora](/strongswan/strongswan-antora)
  Public

  Antora configuration files for the docs.strongswan.org website

   strongswan/strongswan-antora’s past year of commit activity

  Handlebars

  [2](/strongswan/strongswan-antora/stargazers)
  [2](/strongswan/strongswan-antora/forks)
  [0](/strongswan/strongswan-antora/issues)
  [0](/strongswan/strongswan-antora/pulls)
  Updated Jan 14, 2025
* [strongswan-docs](/strongswan/strongswan-docs)
  Public

  AsciiDoc source files for the docs.strongswan.org website

   strongswan/strongswan-docs’s past year of commit activity

  [13](/strongswan/strongswan-docs/stargazers)
  [33](/strongswan/strongswan-docs/forks)
  [0](/strongswan/strongswan-docs/issues)
  [3](/strongswan/strongswan-docs/pulls)
  Updated Jan 14, 2025
* [strongMan](/strongswan/strongMan)
  Public

  Management UI for strongSwan

   strongswan/strongMan’s past year of commit activity

  Python

  [121](/strongswan/strongMan/stargazers)
  [39](/strongswan/strongMan/forks)
  [7](/strongswan/strongMan/issues)
  [0](/strongswan/strongMan/pulls)
  Updated Dec 9, 2024
* [govici](/strongswan/govici)
  Public

  Go implementation of the VICI protocol

   strongswan/govici’s past year of commit activity

  Go

  [60](/strongswan/govici/stargazers)

  MIT

  [17](/strongswan/govici/forks)
  [1](/strongswan/govici/issues)
  [0](/strongswan/govici/pulls)
  Updated Dec 3, 2024
* [strongTNC](/strongswan/strongTNC)
  Public

  BYOD TNC Database Management Tool

   strongswan/strongTNC’s past year of commit activity

  Python

  [21](/strongswan/strongTNC/stargazers)

  AGPL-3.0

  [10](/strongswan/strongTNC/forks)
  [2](/strongswan/strongTNC/issues)
  [1](/strongswan/strongTNC/pulls)
  Updated Apr 17, 2024
* [fuzzing-corpora](/strongswan/fuzzing-corpora)
  Public

  Corpora for fuzzing parts of the strongSwan code base

   strongswan/fuzzing-corpora’s past year of commit activity

  [8](/strongswan/fuzzing-corpora/stargazers)
  [3](/strongswan/fuzzing-corpora/forks)
  [0](/strongswan/fuzzing-corpora/issues)
  [0](/strongswan/fuzzing-corpora/pulls)
  Updated Nov 24, 2023
* [linux](/strongswan/linux)
  Public

  Forked from
  [torvalds/linux](/torvalds/linux)

  Linux kernel source tree

   strongswan/linux’s past year of commit activity

  C

  [1](/strongswan/linux/stargazers)
  [56,758](/strongswan/linux/forks)
  [0](/strongswan/linux/issues)
  [0](/strongswan/linux/pulls)
  Updated Nov 20, 2023
* [boringssl](/strongswan/boringssl)
  Public

  Forked from
  [google/boringssl](/google/boringssl)

  Mirror of BoringSSL

   strongswan/boringssl’s past year of commit activity

  C

  [2](/strongswan/boringssl/stargazers)
  [795](/strongswan/boringssl/forks)
  [0](/strongswan/boringssl/issues)
  [0](/strongswan/boringssl/pulls)
  Updated Oct 3, 2022
* [davici](/strongswan/davici)
  Public

  Decoupled Asynchronous VICI

   strongswan/davici’s past year of commit activity

  C

  [21](/strongswan/davici/stargazers)

  LGPL-2.1

  [18](/strongswan/davici/forks)
  [5](/strongswan/davici/issues)
  [3](/strongswan/davici/pulls)
  Updated Jan 24, 2022

 [View all repositories](/orgs/strongswan/repositories?type=all)

[#### People](/orgs/strongswan/people)
[![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=70&v=4)](/tobiasbrunner)

#### Top languages

Loading…

#### Most used topics

[strongswan](/search?q=topic%3Astrongswan+org%3Astrongswan+fork%3Atrue&type=repositories "Topic: strongswan")
[documentation](/search?q=topic%3Adocumentation+org%3Astrongswan+fork%3Atrue&type=repositories "Topic: documentation")
[vici](/search?q=topic%3Avici+org%3Astrongswan+fork%3Atrue&type=repositories "Topic: vici")
[vici-protocol](/search?q=topic%3Avici-protocol+org%3Astrongswan+fork%3Atrue&type=repositories "Topic: vici-protocol")

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_371b6dbe_20250115_183050.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2254560)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2254560)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2254560)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2254560

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2254560**](show_bug.cgi?id=2254560)
(CVE-2023-41913)
- [CVE-2023-41913](https://access.redhat.com/security/cve/CVE-2023-41913) strongswan: buffer overflow

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2023-41913 strongswan: buffer overflow

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2023-41913 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2254562](show_bug.cgi?id=2254562 "NEW - CVE-2023-41913 strongswan: buffer overflow [epel-all]") [2254561](show_bug.cgi?id=2254561 "CLOSED EOL - CVE-2023-41913 strongswan: buffer overflow [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=2254560&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2254560&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2023-12-14 14:32 UTC by Patrick Del Bello | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-12-14 14:32 UTC ([History](show_activity.cgi?id=2254560)) | | [CC List:](page.cgi?id=fields.html#cclist) | 0 users | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2254560#c0)  Patrick Del Bello    2023-12-14 14:32:27 UTC  ``` strongSwan before 5.9.12 has a buffer overflow and possible unauthenticated remote code execution via a DH public value that exceeds the internal buffer in charon-tkm's DH proxy. The earliest affected version is 5.3.0. An attack can occur via a crafted IKE_SA_INIT message.  <https://github.com/strongswan/strongswan/releases> <https://www.strongswan.org/blog/2023/11/20/strongswan-vulnerability-%28cve-2023-41913%29.html>   ```  [Comment 1](show_bug.cgi?id=2254560#c1)  Patrick Del Bello    2023-12-14 14:32:44 UTC  ``` Created strongswan tracking bugs for this issue:  Affects: epel-all [[bug 2254562](show_bug.cgi?id=2254562 "NEW - CVE-2023-41913 strongswan: buffer overflow [epel-all]")] Affects: fedora-all [[bug 2254561](show_bug.cgi?id=2254561 "CLOSED EOL - CVE-2023-41913 strongswan: buffer overflow [fedora-all]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2254560&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.strongswan.org_f8409cd7_20250115_183051.html ===

[![strongSwan Logo](/images/logo.svg)](/)

[Documentation](/documentation.html)
[Support](/support.html)
[License](/license.html)
[About](/about.html)
[**Blog**](/blog/)
[**Download**](/download.html)
[**GitHub**](https://github.com/strongswan)

# Blog

## Release and vulnerability announcements for strongSwan

* [Blog](/blog/)
* [2023](/blog/2023)
* [strongSwan Vulnerability (CVE-2023-41913)](/blog/2023/11/20/strongswan-vulnerability-%28cve-2023-41913%29.html)

## strongSwan Vulnerability (CVE-2023-41913)

Nov 20, 2023

A vulnerability in charon-tkm related to processing DH public values was discovered in strongSwan that can result in a buffer overflow and potentially remote code execution. All versions since 5.3.0 are affected.

[security fix](/blog/tags/security%2Bfix)[5.9.x](/blog/tags/5.9.x)[5.8.x](/blog/tags/5.8.x)[5.7.x](/blog/tags/5.7.x)[5.6.x](/blog/tags/5.6.x)[5.5.x](/blog/tags/5.5.x)[5.4.x](/blog/tags/5.4.x)[5.3.x](/blog/tags/5.3.x)

Florian Picca reported a bug in `charon-tkm` (the [TKM-backed](https://www.codelabs.ch/tkm/) version of the charon IKE daemon) related to handling DH public values that can lead to remote code execution.

### Buffer Overflow When Handling DH Public Values

The [TKM-backed](https://www.codelabs.ch/tkm/) version of the charon IKE daemon (`charon-tkm`) doesn't check the length of received Diffie-Hellman public values before copying them to a fixed-size buffer on the stack, causing a buffer overflow ([CWE-121](https://cwe.mitre.org/data/definitions/121.html)) that could potentially be exploited for remote code execution by sending a specially crafted and unauthenticated IKE\_SA\_INIT message.  Affected are
all strongSwan versions since 5.3.0.

[CVE-2023-41913](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-41913) has been assigned for this vulnerability.

#### Missing Length Check for DH Public Values in charon-tkm

Before 5.3.0, the length of Diffie-Hellman public values of known DH groups was directly verified by the code that handles KE payloads.  This was changed with [0356089d0f94 ("diffie-hellman: Verify public DH values in backends")](https://github.com/strongswan/strongswan/commit/0356089d0f94ab86dd82fd686703560988833e3c) and [41fc94c92454 ("encoding: Remove DH public value verification from KE payload")](https://github.com/strongswan/strongswan/commit/41fc94c92454e965ca10cf8eabc8f9485a8c4576), both released with 5.3.0. They made DH implementations responsible for verifying the public values themselves in their implementation of `diffie_hellman_t::set_other_public_value()` (or `key_exchange_t::set_public_key()` in newer releases).  A helper function was added to simplify this for known DH groups.

Unfortunately, the implementation of that method in `charon-tkm`, which acts as proxy for DH operation between the IKE daemon and the [Trusted Key Manager (TKM)](https://www.codelabs.ch/tkm/), was forgotten and since then contained an unchecked `memcpy()` that copied whatever public DH value the peer sent in its unauthenticated IKE\_SA\_INIT message to a buffer of 512 bytes on the stack, potentially causing a buffer overflow.  The length is only limited by the maximum length for accepted IKE messages, which defaults to 10'000 bytes.

Remote code execution might be possible due to this issue.

As mentioned in the introduction, credit to Florian Picca at Stackered for finding this vulnerability and reporting it responsibly.

### Mitigation

Setups that don't use `charon-tkm` as IKE daemon are not vulnerable.  Note that the `charon-tkm` version that supports multiple key exchanges is not vulnerable either (*tkm-multi-ke* branch, which will be released with strongSwan 6 in the future).

The just released [strongSwan 5.9.12](/blog/2023/11/20/strongswan-5.9.12-released.html) fixes this vulnerability. For older releases, we [provide patches](https://download.strongswan.org/security/CVE-2023-41913) that fix the vulnerability and should apply with appropriate hunk offsets.

**strongSwan Project**

* [Downloads](/download.html)
* [License](/license.html)
* [About](/about.html)
* [Blog](/blog/) ([RSS](/blog/feed.rss))

**Help**

* [Documentation](/documentation.html)
* [Support](/support.html)

**Social**

* [GitHub](https://github.com/strongswan)
* [Bluesky](https://bsky.app/profile/strongswan.org)
* [X/Twitter](https://x.com/strongswan)
* [Facebook](https://www.facebook.com/pages/strongSwan/222380261260881)

**Main Sponsors**
[![secunet](/images/secunet_logo_neg.svg)](https://www.secunet.com/)
[![codelabs](/images/codelabs_logo_rgb_neg.png)](https://www.codelabs.ch/)

**© 2025** by The strongSwan Team

[Imprint](/imprint.html)



=== Content from lists.fedoraproject.org_5e171152_20250114_204228.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO.mbox.gz?message=YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/#YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO)

# [SECURITY] Fedora 40 Update: strongswan-5.9.14-1.fc40

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

10 Jun
2024

10 Jun
'24

8:51 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-6712c699fc
2024-06-11 01:48:54.482619
--------------------------------------------------------------------------------

Name : strongswan
Product : Fedora 40
Version : 5.9.14
Release : 1.fc40
URL : <https://www.strongswan.org/>
Summary : An OpenSource IPsec-based VPN and TNC solution
Description :
The strongSwan IPsec implementation supports both the IKEv1 and IKEv2 key
exchange protocols in conjunction with the native NETKEY IPsec stack of the
Linux kernel.

--------------------------------------------------------------------------------
Update Information:

Fixes CVE-2023-41913 buffer overflow and possible RCE, various IKEv2
improvements
--------------------------------------------------------------------------------
ChangeLog:

\* Fri May 31 2024 Paul Wouters paul.wouters@aiven.io - 5.9.14-1
- Resolves: rhbz#2254560 CVE-2023-41913 buffer overflow and possible RCE
- Resolved: rhbz#2250666 Update to 5.9.14 (IKEv2 OCSP extensions, seqno/regno overflow handling
- Update to 5.9.13 (OCSP nonce set regression configuration option charon.ocsp\_nonce\_len)
- Update to 5.9.12 (CVE-2023-41913 fix, various IKEv2 fixes)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2254560 - CVE-2023-41913 strongswan: buffer overflow
<https://bugzilla.redhat.com/show_bug.cgi?id=2254560>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-6712c699fc' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO/#YPJZPYHBCRXUQGGKQE6TYH4J4RIJH6HO)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from download.strongswan.org_478a137c_20250115_183050.html ===

[strongSwan Downloads](/)

[strongswan.org](//www.strongswan.org)
[Documentation](//docs.strongswan.org)
[GitHub](//github.com/strongswan/strongswan/)

# Index of /security/CVE-2023-41913

| [ICO] | [Name](?C=N;O=D) | [Last modified](?C=M;O=A) | [Size](?C=S;O=A) |
| --- | --- | --- | --- |
| [[PARENTDIR]](/security/) | [Parent Directory](/security/) |  | - |
| [[TXT]](strongswan-5.3.0-5.9.6_charon_tkm_dh_len.patch) | <strongswan-5.3.0-5.9.6_charon_tkm_dh_len.patch> | 2023-12-15 17:05 | 1.4K |
| [[TXT]](strongswan-5.3.0-5.9.6_charon_tkm_dh_len.patch.sig) | <strongswan-5.3.0-5.9.6_charon_tkm_dh_len.patch.sig> | 2023-12-16 10:29 | 659 |
| [[TXT]](strongswan-5.9.7-5.9.11_charon_tkm_dh_len.patch) | <strongswan-5.9.7-5.9.11_charon_tkm_dh_len.patch> | 2023-09-26 08:36 | 1.4K |
| [[TXT]](strongswan-5.9.7-5.9.11_charon_tkm_dh_len.patch.sig) | <strongswan-5.9.7-5.9.11_charon_tkm_dh_len.patch.sig> | 2023-11-20 11:46 | 659 |

/security/CVE-2023-41913
—
©
2025
The strongSwan Project



=== Content from github.com_b40f38ce_20250114_204226.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan%2Fstrongswan%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan%2Fstrongswan%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=strongswan%2Fstrongswan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[strongswan](/strongswan)
/
**[strongswan](/strongswan/strongswan)**
Public

* [Notifications](/login?return_to=%2Fstrongswan%2Fstrongswan) You must be signed in to change notification settings
* [Fork
  794](/login?return_to=%2Fstrongswan%2Fstrongswan)
* [Star
   2.3k](/login?return_to=%2Fstrongswan%2Fstrongswan)

* [Code](/strongswan/strongswan)
* [Issues
  69](/strongswan/strongswan/issues)
* [Pull requests
  44](/strongswan/strongswan/pulls)
* [Discussions](/strongswan/strongswan/discussions)
* [Actions](/strongswan/strongswan/actions)
* [Security](/strongswan/strongswan/security)
* [Insights](/strongswan/strongswan/pulse)

Additional navigation options

* [Code](/strongswan/strongswan)
* [Issues](/strongswan/strongswan/issues)
* [Pull requests](/strongswan/strongswan/pulls)
* [Discussions](/strongswan/strongswan/discussions)
* [Actions](/strongswan/strongswan/actions)
* [Security](/strongswan/strongswan/security)
* [Insights](/strongswan/strongswan/pulse)

# Releases: strongswan/strongswan

[Releases](/strongswan/strongswan/releases)
[Tags](/strongswan/strongswan/tags)

Releases · strongswan/strongswan
## strongSwan 6.0.0

03 Dec 13:23

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[6.0.0](/strongswan/strongswan/tree/6.0.0)

[`bea1f11`](/strongswan/strongswan/commit/bea1f1100ee14264808268bd5cdb6df7a8ea382c)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...6.0.0)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 6.0.0](/strongswan/strongswan/releases/tag/6.0.0)
[Latest](/strongswan/strongswan/releases/latest)

[Latest](/strongswan/strongswan/releases/latest)

### New Feature Additions

* Support for multiple IKEv2 key exchanges ([RFC 9370](https://datatracker.ietf.org/doc/html/rfc9370)) has been added ([3a850ae](https://github.com/strongswan/strongswan/commit/3a850ae1917201fba19fd60bb75f39128556ec43)). `IKE_INTERMEDIATE` exchanges ([RFC 9242](https://datatracker.ietf.org/doc/html/rfc9242)) are used to transport additional KE payloads between the `IKE_SA_INIT` and `IKE_AUTH` exchanges. To rekey IKE and Child SAs with multiple key exchanges, `IKE_FOLLOWUP_KE` exchanges are used, as defined in RFC 9370.

  In proposals, additional key exchange methods are configured via `keX_` prefix, where `X` is a number between 1 and 7. For example, `ke1_mlkem768` adds ML-KEM-768 as additional KE method (works with any key exchange method, whether post-quantum or classic). As with regular key exchanges, peers have to agree on a method for each round unless no algorithms are defined by both or `keX_none` is configured to make that round explicitly optional.
* Support for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM, [FIPS 203](https://csrc.nist.gov/pubs/fips/203/final)), a key exchange method that, at present, is believed to be secure even against adversaries who possess a quantum computer, has been added via Botan 3.6.0+ (`botan` plugin), wolfSSL 5.7.4+ (`wolfssl` plugin), AWS-LC 1.37.0+ (`openssl` plugin), and the new `ml` plugin. The keywords for ML-KEM-512 (128 bits security strength), ML-KEM-768 (192 bits), ML-KEM-1024 (256 bits) are `mlkem512`, `mlkem768` and `mlkem1024`, respectively.
* `AF_VSOCK` sockets can be used on Linux to communicate with a daemon that runs in a VM (e.g. via the `vici` plugin).
* The file logger can optionally log messages as JSON objects ([a2fba6d](https://github.com/strongswan/strongswan/commit/a2fba6db4a17d967d425e63212057e921581090c), [bea1f11](https://github.com/strongswan/strongswan/commit/bea1f1100ee14264808268bd5cdb6df7a8ea382c), see [the docs](https://docs.strongswan.org/docs/latest/config/logging.html#_file_loggers) for details), and can add timestamps in microseconds via the new `time_precision` setting ([#2475](https://github.com/strongswan/strongswan/pull/2475)).

### Enhancements and Optimizations

* Handling of CHILD\_SA rekey collisions has been improved ([d2b2e1b](https://github.com/strongswan/strongswan/commit/d2b2e1b3fae8b49b4c412ee1492d18638d17e497)). This makes CHILD\_SAs properly trackable via `child_rekey()` hook and some corner cases are also handled correctly e.g. if a responder's `DELETE` for the new CHILD\_SA arrives before its `CREATE_CHILD_SA` response that creates that SA in the first place. Also handled properly are responders of rekeyings that incorrectly send a `DELETE` for the old CHILD\_SA (previously, this caused both, the new and the old SA, to get deleted).
* The behavior when reloading or unloading connections that include `start` in their `start_action` has been improved ([#2324](https://github.com/strongswan/strongswan/issues/2324), [#2418](https://github.com/strongswan/strongswan/issues/2418)).
* If no identity is configured but a certificate is available, the subject DN is used instead of the IP address ([#2353](https://github.com/strongswan/strongswan/issues/2353)).
* The `cert-enroll` script now supports three generations of CA certificates ([f59ca96](https://github.com/strongswan/strongswan/commit/f59ca9698a39f617db6b6efbcbd7d9b18193a17c)).
* IKE ports are now considered when matching connections ([9228a51](https://github.com/strongswan/strongswan/commit/9228a5109b8d9a6e1469abefba2fdfc44aeabe7a), [6928709](https://github.com/strongswan/strongswan/commit/6928709886a1872fc91864e531aada1252c57c24)).
* The base address of in-memory IP address pools is now reported as configured ([#2264](https://github.com/strongswan/strongswan/issues/2264)).
* IKE fragment sizes can be configured for each address family explicitly ([84bd011](https://github.com/strongswan/strongswan/commit/84bd011752bf6d5fbaf4900dc4037445dd78a4dd)).
* The `openssl` plugin can use the `EVP_DigestSqueeze()` API for XOFs, which was introduced with OpenSSL 3.3 ([3d0f695](https://github.com/strongswan/strongswan/commit/3d0f6958a9f49e8aaae3113eaf0aab51821b1e56)).
* The `kernel-netlink` plugin explicitly configures the direction of IPsec SAs when running on 6.10+ kernels ([abdc787](https://github.com/strongswan/strongswan/commit/abdc7878a4cea0250eb3f46ab9acb906b82245d4)).
* The Android app was updated for compatibility with Android 14 ([740cbb2](https://github.com/strongswan/strongswan/commit/740cbb2c0ab8116753e352cac41dbf922f65e555)), a bug was fixed that affects importing already existing VPN profiles ([9b9cf20](https://github.com/strongswan/strongswan/commit/9b9cf2001f071eba3bb819cb85db4e5083ed3c83)).

### Fixes

* The NetworkManager plugin (`charon-nm`) now uses a different routing table than the regular IKE daemon to avoid conflicts if both are running ([#2230](https://github.com/strongswan/strongswan/issues/2230)).
* TUN devices can properly handle IPv6 addresses ([fccc764](https://github.com/strongswan/strongswan/commit/fccc76449dc5f135147c6167739916408753f66b)) and routes via them are now correctly installed on FreeBSD ([bf165af](https://github.com/strongswan/strongswan/commit/bf165afb780b7ba4edd2092b3348038c0a14b7ae)).
* Reassigning a matching online lease is now preferred over an offline lease by the in-memory IP address pool to avoid conflicts with make-before-break reauthentication and multiple IKE\_SAs per identity ([#2472](https://github.com/strongswan/strongswan/discussions/2472)).
* To avoid conflicts with other processes when using ephemeral UDP ports, the `socket-default` plugin now always opens IPv4 sockets before IPv6 sockets ([#2494](https://github.com/strongswan/strongswan/discussions/2494)).
* Challenge passwords in PKCS#10 containers are again encoded as `PrintableString` if possible to be compatible with older SCEP implementations ([8e88d56](https://github.com/strongswan/strongswan/commit/8e88d562064821bbb30e831906e1feed11016389)).
* The `vici` plugin now uses the same ESP proposals (AEAD before regular) when configuring `default` instead of not configuring `esp_proposals` at all ([8e020bc](https://github.com/strongswan/strongswan/commit/8e020bc9e31ecd7e08bdf6116e110d189ce26c90)).
* Fixed handling of adopted reqids during IKEv1 rekeying ([d02aea9](https://github.com/strongswan/strongswan/commit/d02aea9c2cef7c9509fe61f674d3b468e5c7a12f), bug was introduced in 5.9.12).
* A typo in the `cert-enroll` script prevented successful signalling of a change of the sub CA certificate ([957aae8](https://github.com/strongswan/strongswan/commit/957aae8f646d6e4e37d62efc505f2c6f7181c879)).

### Plugin and Configuration Changes

* The legacy `stroke` plugin is **no longer enabled** by default and must be enabled explicitly.
* The `openssl` plugin is now **enabled** by default, while the following crypto plugins are **no longer enabled** by default: `aes`, `curve25519`, `des`, `fips-prf`, `gmp`, `hmac`, `md5`, `pkcs12`, `rc2`, `sha1`, `sha2`.
* The following **deprecated plugins** have been **removed**: `bliss` (signature scheme), `newhope` (key exchange method), `ntru` (key exchange method).
* `charon.make_before_break` is now **enabled** by default, which initiates IKEv2 [reauthentication](https://docs.strongswan.org/docs/latest/config/rekeying.html) with a **make-before-break** instead of a **break-before-make** scheme. Make-before-break creates overlapping IKE and Child SA during reauthentication by first recreating all SAs before deleting the old ones. This behavior can be beneficial to avoid connectivity gaps during reauthentication (unlike rekeying still not completely without interruption), but requires support for overlapping SAs by the peer. strongSwan can handle such overlapping SAs since version 5.3.0.

### For Developers

* Using the `child_rekey()` hook now allows tracking CHILD\_SAs correctly in case of rekey collisions. The event is generally only triggered once after installing the outbound SA for the new/winning CHILD\_SA. However, in some cases the event is triggered twice, but it is now ensured that listeners can properly transition to the winning SA.
* Refer to the documentation of [`key_exchange_method_t` interface](https://github.com/strongswan/strongswan/blob/master/src/libstrongswan/crypto/key_exchange.h) to learn how KEMs can be implemented in plugins.
* The format of key exchange test vectors has been changed so they can be used for KEMs and classic DH methods ([4067678](https://github.com/strongswan/strongswan/commit/40676786aa403d0175b48f8f1d902a72755a9ab5)).
* The NetworkManager frontend's build files have been updated to not rely on `gnome-common`. It now also uses `gettext` directly instead of `intltool` ([5019e3e](https://github.com/strongswan/strongswan/commit/5019e3ece012d35132fe6fe17ef7d192968de098)).
* Performance of running tests in the [testing environment](https://docs.strongswan.org/docs/latest/devs/testingEnvironment.html) has been improved.

Refer to [the 6.0.0 milestone](https://github.com/strongswan/strongswan/milestone/13?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
11
 SilmorSenedlen, geedo0, alexted, tatac1, JETtech-Labs, thillux, muryliang, harridu, nxtreaming, maxdevaine, and palw3ey reacted with thumbs up emoji
 😄
1
 alexted reacted with laugh emoji
 🎉
3
 alexted, Lynx098, and fgremiaux reacted with hooray emoji
 ❤️
5
 alexted, Neustradamus, rodan, troglobit, and matteocarnelos reacted with heart emoji
 🚀
1
 alexted reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  11 reactions
* 😄
  1 reaction
* 🎉
  3 reactions
* ❤️
  5 reactions
* 🚀
  1 reaction
* 👀
  1 reaction

 17 people reacted

## strongSwan 5.9.14

19 Mar 13:34

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.14](/strongswan/strongswan/tree/5.9.14)

[`dea8493`](/strongswan/strongswan/commit/dea8493f3a6a5ef16ee97d0d446ca52f8f8afa3c)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.14)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.14](/strongswan/strongswan/releases/tag/5.9.14)

### New Feature Additions

* Support for the IKEv2 OCSP extensions ([RFC 4806](https://datatracker.ietf.org/doc/html/rfc4806)) has been added, which allows peers to request and send OCSP responses together with their certificate chain directly in IKEv2 ([#2016](https://github.com/strongswan/strongswan/pull/2016)). The OCSP responses for local certificates are currently retrieved via *revocation* plugin, either from the cache or fetched from an OCSP server (see the developer notes for details). The feature can be controlled via `<conn>.ocsp` setting in [swanctl.conf](https://docs.strongswan.org/docs/5.9/swanctl/swanctlConf.html). By default, OCSP responses are sent if the peer requests any and a response can be retrieved.

  If sending requests is enabled, the implementation generally sends an empty OCSP certificate request payload. Only if self-signed OCSP signer certificates are found locally will their public key's hash be added to the payload. Such certificates must either have the `OCSPSigning` extended key usage flag set, or be placed in the `x509ocsp` directory so that they are flagged when loaded.
* The Android app now supports managed configurations via enterprise mobility management (EMM) systems ([#2005](https://github.com/strongswan/strongswan/pull/2005)). Besides configuring global settings and VPN profiles (with settings similar to those supported in profile files, including certificates), this also provides management options for disabling certain features of the app (e.g. to prevent users from creating and/or importing custom profiles or to only display managed profiles).
* Added support for PSS padding for smartcard-based RSA signatures to the [*pkcs11* plugin](https://docs.strongswan.org/docs/5.9/plugins/pkcs11.html), using either on-chip or external data hashing.
* Added keyid and certid handles to the [`pki --ocsp`](https://docs.strongswan.org/docs/5.9/pki/pkiOcsp.html) command so that keys and/or certificates can be stored on a smartcard or in a TPM 2.0 device (note that this may add quite a delay to generating OCSP responses).

### Enhancements and Optimizations

* Validation of X.509 name constraints has been refactored to align with RFC 5280 ([#2114](https://github.com/strongswan/strongswan/issues/2114)). This fixes several limitations of the previous implementation. Name constraints are now correctly propagated from the root of the certificate chain so that intermediate CA certificates don't have to explicitly inherit the name constraints of their parents anymore. The latter previously prevented adding constraints in an intermediate CA certificate that's followed by another that doesn't contain any name constraints. This is perfectly fine as the set of constraints specified by the parent continue to apply to that intermediate CA certificate and the children it issues.

  Identities also don't have to match all name constraints of the same type anymore, which prevented actually encoding multiple constraints of the same type because e.g. for the permitted name constraints for `example.org` and `example.com` no acceptable certificates could be issued as any SAN with one domain would get rejected by the other constraint. In compliance with the RFC, matching a single constraint is now enough.

  Also resolved is an issue with name constraints for IP addresses (added with [5.9.12](https://github.com/strongswan/strongswan/releases/tag/5.9.12)), which were previously only supported for a single level.
* The [*dhcp* plugin](https://docs.strongswan.org/docs/5.9/plugins/dhcp.html) has been ported to FreeBSD/macOS ([#2047](https://github.com/strongswan/strongswan/pull/2047)). The code for BPF handling has been refactored and is now shared between *dhcp* and *farp* plugin.
* The *openssl* plugin is now compatible to [AWS-LC](https://github.com/aws/aws-lc), a crypto library based on code from BoringSSL and OpenSSL ([#1907](https://github.com/strongswan/strongswan/issues/1907)).
* The identity enforced by the configuration was added to the message logged when identities don't match ([#2088](https://github.com/strongswan/strongswan/pull/2088)).

### Fixes

* Overflows of unique identifiers (e.g. Netlink sequence numbers or reqids) are now handled gracefully when the daemon is running for a very long time without restart ([#2062](https://github.com/strongswan/strongswan/pull/2062)).
* Fail the installation of SAs on Linux if replay protection is disabled while extended sequence numbers (ESN) are enabled ([#2117](https://github.com/strongswan/strongswan/discussions/2117)). This combination is currently not supported by the Linux kernel and strongSwan previously just installed the SA without ESN, causing the other end to drop packets if it was an implementation that didn't do this.

### For Developers

* The optional [`ocsp()`](https://github.com/strongswan/strongswan/blob/91f209b8789135d8888452a391588afba421e1fb/src/libstrongswan/credentials/cert_validator.h#L94-L102) method of the `cert_validator_t` interface is used to retrieve an OCSP response for a local X.509 certificate when responding to an OCSP certificate request. It's currently only implemented by the *revocation* plugin, which uses the same code that's used when verifying remote certificates via OCSP.
* Our leak detective now implements and wraps `malloc_usable_size()`, which is used by systemd and the libraries it provides (e.g. nss-systemd) ([#2045](https://github.com/strongswan/strongswan/issues/2045)).
* The `build.gradle` file for the Android app now declares the NDK version and uses the default NDK invocation instead of the custom tasks that were used before ([1cab544](https://github.com/strongswan/strongswan/commit/1cab544c759749a899b439acb4fae1fb58279db8)).
* With the addition of support for managed configurations, several internals of the Android app have changed:
  + All VPN profiles now require a UUID as it's the only identifier used to access them.
  + When using Intents to start/stop profiles, the new name for the string extra that passes the ID is `org.strongswan.android.VPN_PROFILE_UUID` (the old one is still supported as fallback, though).
  + Profiles may be marked as read-only internally, which adds a label in the profile list and prevents users from deleting/editing/copying them (only the password may be changed in the GUI).
  + Profiles may come from different data sources (currently the database and managed configurations).
  + To access the app's database, a new class (DatabaseHelper) has been added, which is accessed via an instance on the Application sub-class.

Refer to [the 5.9.14 milestone](https://github.com/strongswan/strongswan/milestone/12?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
5
 alexted, SilmorSenedlen, ViPMaloi, naxoss, and ZoobiApplications reacted with thumbs up emoji
 😄
2
 alexted and ZoobiApplications reacted with laugh emoji
 🎉
2
 alexted and ZoobiApplications reacted with hooray emoji
 ❤️
2
 alexted and ZoobiApplications reacted with heart emoji
 🚀
4
 alexted, Ali-aqrabawi, naxoss, and ZoobiApplications reacted with rocket emoji
 👀
2
 alexted and ZoobiApplications reacted with eyes emoji

All reactions

* 👍
  5 reactions
* 😄
  2 reactions
* 🎉
  2 reactions
* ❤️
  2 reactions
* 🚀
  4 reactions
* 👀
  2 reactions

 6 people reacted

## strongSwan 5.9.13

01 Dec 08:05

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.13](/strongswan/strongswan/tree/5.9.13)

[`c8ef91c`](/strongswan/strongswan/commit/c8ef91c786863f58bb07433b3967a2c4b41cb64b)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.13)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.13](/strongswan/strongswan/releases/tag/5.9.13)

### Enhancements and Optimizations

* Added `charon.ocsp_nonce_len` setting that allows specifying the length of nonce values in OCSP requests. Since 5.9.12, the default length is set to 32 bytes, as required by [RFC 8954](https://datatracker.ietf.org/doc/html/rfc8954) for newer clients. However, there might be older OCSP servers that don't support that, in which case reducing the length to e.g. 16, which was the previous default, might be necessary ([f3af170](https://github.com/strongswan/strongswan/commit/f3af1704d94ed1db5277151d17e0d2661970d3a8)).
* OCSP error responses are now dropped immediately instead of trying to verify a non-existent signature ([b3e66ac](https://github.com/strongswan/strongswan/commit/b3e66aca5c4af3721489ff7d934d90bc5108e12b), [e7a58f4](https://github.com/strongswan/strongswan/commit/e7a58f46f97583a532b481bb1805aeb5208af565)).
* [`pki --ocsp --respond`](https://docs.strongswan.org/docs/5.9/pki/pkiOcsp.html) replies with an internal error OCSP response if no signer certificate is found (e.g. if the request is sent to the wrong server) instead of failing silently ([945be4e](https://github.com/strongswan/strongswan/commit/945be4ece57d92d9c3011efbdf9f27dd60279bc1)).

### Fixes

* Fixed a regression with handling OCSP error responses that was introduced with 5.9.12 ([#2011](https://github.com/strongswan/strongswan/issues/2011), [585c400](https://github.com/strongswan/strongswan/commit/585c40095a3a92e058c5d1d61137232f17f72195), [9c4846c](https://github.com/strongswan/strongswan/commit/9c4846cdbe61af324f44f7e59a9e209fef112157)).
* Added missing environment variables for `cert-install-ssl` [cert-enroll script](https://docs.strongswan.org/docs/5.9/tools/cert-enroll.html) script ([da45cf9](https://github.com/strongswan/strongswan/commit/da45cf9f38207af7dced1762747c2d79ef3a3d02)).

Refer to [the 5.9.13 milestone](https://github.com/strongswan/strongswan/milestone/11?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
3
 alexted, SilmorSenedlen, and Yoshi1981 reacted with thumbs up emoji
 😄
1
 alexted reacted with laugh emoji
 🎉
1
 alexted reacted with hooray emoji
 ❤️
1
 alexted reacted with heart emoji
 🚀
2
 alexted and exoticprgmr reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  3 reactions
* 😄
  1 reaction
* 🎉
  1 reaction
* ❤️
  1 reaction
* 🚀
  2 reactions
* 👀
  1 reaction

 4 people reacted

## strongSwan 5.9.12

20 Nov 13:31

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.12](/strongswan/strongswan/tree/5.9.12)

[`11dbc8e`](/strongswan/strongswan/commit/11dbc8e7f271579c2cbe8496ca6bf8b12241803b)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.12)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.12](/strongswan/strongswan/releases/tag/5.9.12)

### Vulnerabilities

* Fixed a vulnerability in `charon-tkm` (the [TKM-backed](https://www.codelabs.ch/tkm/) version of the charon IKE daemon) related to processing DH public values that can lead to a buffer overflow and potentially remote code execution. This vulnerability has been registered as [CVE-2023-41913](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41913). Please refer to [our blog](https://www.strongswan.org/blog/2023/11/20/strongswan-vulnerability-%28cve-2023-41913%29.html) for details.

### New Feature Additions

* The new [`pki --ocsp`](https://docs.strongswan.org/docs/5.9/pki/pkiOcsp.html) command produces OCSP responses based on certificate status information provided by implementations of the new `ocsp_responder_t` interface ([#1958](https://github.com/strongswan/strongswan/pull/1958)).

  Two sources are currently available, the [*openxpki*](https://docs.strongswan.org/docs/5.9/plugins/openxpki.html) plugin that directly accesses the OpenXPKI database and the command's `--index` argument, which reads certificate status information from OpenSSL-style `index.txt` files (multiple CAs are supported concurrently).
* The new [cert-enroll script](https://docs.strongswan.org/docs/5.9/tools/cert-enroll.html) handles the initial enrollment of an X.509 host certificate with a PKI server via the EST or SCEP protocols.

  Run as a systemd timer or via a crontab entry, the script checks the expiration date of the host certificate daily. When a given deadline is reached, the host certificate is automatically renewed via EST or SCEP re-enrollment based on the possession of the old private key and the matching certificate.
* Added a global option (`charon.reject_trusted_end_entity`) to prevent peers from authenticating with certificates that are locally trusted, in particular, our own local certificate, which safeguards against accidental reuse of certificates on multiple peers. As the name suggests, all trusted end-entity certificates are rejected if enabled, so peer certificates can't be configured explicitly anymore (e.g. via `remote.certs` in swanctl.conf).
* The `--priv` argument for `charon-cmd` allows the use of any type of private key (previously, only RSA keys were supported).
* The *openssl* plugin now supports the `nameConstraints` extension in X.509 certificates ([#1990](https://github.com/strongswan/strongswan/issues/1990)).
* Support for `nameConstraints` of type `iPAddress` are now supported by the *x509*, *openssl* and *constraints* plugins ([#1991](https://github.com/strongswan/strongswan/issues/1991)).
* Support for encoding `subjectAlternativeName` extensions of type `uniformResourceIdentifier` in X.509 certificates has been added via the `uri:` prefix (e.g. for URNs, [#1983](https://github.com/strongswan/strongswan/issues/1983)).
* Support for password-less PKCS#12 and PKCS#8 files has been added ([#1955](https://github.com/strongswan/strongswan/discussions/1955)).

### Enhancements and Optimizations

* Because of a relatively recent NIAP requirement ([TD0527](https://www.niap-ccevs.org/Documents_and_Guidance/view_td.cfm?TD=0527), Test 8b), loading of certificates with ECDSA keys that explicitly encode the curve parameters is rejected if possible. Explicit encoding is pretty rare to begin with and e.g. wolfSSL already rejects such keys, by default. All crypto plugins that support ECDSA enforce this by rejecting such public keys, except when using older versions of OpenSSL (< 1.1.1h) or Botan (< 3.2.0) ([#1949](https://github.com/strongswan/strongswan/issues/1949)).
* Make the NetworkManager plugin (`charon-nm`) actually use the XFRM interface it creates since 5.9.10. This involves setting interface IDs on SAs and policies, and installing routes via the interface. To avoid routing loops if the remote traffic selectors include the VPN server, IKE and ESP packets are marked to bypass the routing table that contains the routes via XFRM interface ([69e0c11](https://github.com/strongswan/strongswan/commit/69e0c1161d54f0ecb5d18b0e0c5e39dcc69fba93)).

  If available, the plugin now also adopts the interface name configured in `connection.interface-name` in a `*.nmconnection` file as name for the XFRM interface instead of generating one randomly ([e8f8d32](https://github.com/strongswan/strongswan/commit/e8f8d32494e2945f6f43b7ac46fa5d0491b417ec)).
* The *resolve* plugin tries to maintain the order of DNS servers it installs via `resolvconf` or `resolv.conf` ([6440975](https://github.com/strongswan/strongswan/commit/6440975bb40609e4894931ae3d679ecea73784c8), [8238ad4](https://github.com/strongswan/strongswan/commit/8238ad480aa7b404e345cee06bc49389141ca269)).
* The *kernel-libipsec* plugin now always installs routes to remote networks even if no address is found in the local traffic selectors, which allows forwarding traffic from networks the VPN host is not part of ([190d8cb](https://github.com/strongswan/strongswan/commit/190d8cbe1931ec57484d9bb451824a7fc57979bd)).
* Increased the default receive buffer size for Netlink sockets to 8 MiB (doubled by the kernel to account for overhead) and simplified the configuration (no need for a separate option to force overriding `rmem_max`). It's now also set for event sockets, which previously could cause issues on hosts with e.g. lots of route changes ([#1757](https://github.com/strongswan/strongswan/issues/1757)).
* When issuing certificates, the `subjectKeyIdentifier` of the issuing certificate, if available, is now copied as `authorityKeyIdentifier`, instead of always generating a SHA-1 hash of the issuer's subjectPublicKey ([#1992](https://github.com/strongswan/strongswan/issues/1992), [6941dcb](https://github.com/strongswan/strongswan/commit/6941dcb17aa5fb51b6fe7831794a4c3593480c3c)).
* Explicitly request permission to display notifications on Android 13+ ([ddf84c1](https://github.com/strongswan/strongswan/commit/ddf84c165d94811a025f128fb6016f5911d6b179)), also enabled hardware acceleration for the Android-specific OpenSSL build.

### Fixes

* Fixed issues while reestablishing multiple CHILD\_SAs (e.g. after a DPD timeout) that could cause a *reqid* to get assigned to multiple CHILD\_SAs with unrelated traffic selectors ([#1855](https://github.com/strongswan/strongswan/issues/1855)).
* Fixed an issue in `watcher_t` with handling errors on sockets (e.g. if the receive buffer is full), which caused an infinite loop if `poll()` only signaled `POLLERR` as event ([#1757](https://github.com/strongswan/strongswan/issues/1757)).
* Fixed an issue in the IKE\_SA\_INIT tracking code that was added with 5.9.6, which did not correctly untrack invalid messages with non-zero message IDs or SPIs ([0b47357](https://github.com/strongswan/strongswan/commit/0b4735709189f9f3b20f64bce4f38211527fff5b)).
* Fixed a regression introduced with 5.9.8 when handling IKE redirects during IKE\_AUTH ([595fa07](https://github.com/strongswan/strongswan/commit/595fa077b63c4cbea292fdb4a05606b65cf4f8c1)).
* Fixed adding the `XFRMA_REPLAY_ESN_VAL` attribute twice when updating SAs in the *kernel-netlink* plugin, which prevented MOBIKE updates if a large anti-replay window was used ([#1967](https://github.com/strongswan/strongswan/issues/1967)).
* Fixed a race condition in the *kernel-pfroute* plugin when adding virtual IPs if the TUN device is activated after the address was already added internally, which caused the installed route not to go via TUN device in order to force the virtual IP as source address ([#1807](https://github.com/strongswan/strongswan/issues/1807)).
* Fixed an issue in *libtls* that could cause the wrong ECDH group to get instantiated ([b5e4bf4](https://github.com/strongswan/strongswan/commit/b5e4bf4b6c2d5a3ac46cce78d69673c224256206)).
* Fixed the encoding of the `CHILD_SA_NOT_FOUND` notify if a CHILD\_SA is not found during rekeying. It was previously empty, now contains the SPI and sets the protocol to the values received in the `REKEY_SA` notify ([849c2c9](https://github.com/strongswan/strongswan/commit/849c2c9707e00fc5210bd389631a2fc1a97089e6)).
* Fixed a possible issue with MOBIKE in the Android client on certain devices ([#1691](https://github.com/strongswan/strongswan/issues/1691)).

### For Developers

* The new [`ocsp_responder_t`](https://github.com/strongswan/strongswan/blob/master/src/libstrongswan/credentials/ocsp_responder.h) interface can be implemented to provide certificate status information to the `pki --ocsp` command. Responders can be (un-)registered via the [`ocsp_responders_t`](https://github.com/strongswan/strongswan/blob/master/src/libstrongswan/credentials/ocsp_responders.h) instance at `lib->ocsp`.
* For the `watcher_t` component, `WATCHER_EXCEPT` has been removed as there is no way to explicitly listen for errors on sockets and `poll()` actually can return `POLLERR` for any FD and it might even be the only signaled event (which caused an infinite loop previously). Now we simply notify the registered callbacks. The error is then reported by e.g. `recvfrom()`, which was already the case before if `POLLERR` was returned together with e.g. `POLLIN`.
* The reqids allocated for CHILD\_SAs (including trap policies) via `kernel_interface_t::alloc_reqid()` are now refcounted. When recreating a CHILD\_SA, a reference to the reqid can be requested via `child_sa_t::get_reqid_ref()`. If another reference is required afterwards, one can be acquired directly via `kernel_interface_t::ref_reqid()`. Each reference has to be released via `kernel_interface_t::release_reqid()`, whose interface was simplified.
* The testing environment is now based on Debian 12 (bookworm), by default. Also, when copying files to guests, the guest-specific files are now copied after the default files, which allows overriding files per guest (fixes an issue with winnetou's `/etc/fstab` and mounting the test results).

Refer to [the 5.9.12 milestone](https://github.com/strongswan/strongswan/milestone/10?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
5
 alexted, fatihusta, MahdiAhmadnejad, SilmorSenedlen, and thillux reacted with thumbs up emoji
 😄
1
 alexted reacted with laugh emoji
 🎉
1
 alexted reacted with hooray emoji
 ❤️
1
 alexted reacted with heart emoji
 🚀
2
 alexted and Larryk62 reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  5 reactions
* 😄
  1 reaction
* 🎉
  1 reaction
* ❤️
  1 reaction
* 🚀
  2 reactions
* 👀
  1 reaction

 6 people reacted

## strongSwan 5.9.11

12 Jun 12:21

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.11](/strongswan/strongswan/tree/5.9.11)

[`4e1dc0a`](/strongswan/strongswan/commit/4e1dc0a22468880552589d48407a8ddbf0054b5d)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.11)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.11](/strongswan/strongswan/releases/tag/5.9.11)

* A long-standing deadlock in the *vici* plugin has been fixed that could get triggered when multiple connections were initiated/terminated concurrently and *control-log* events were raised by the `watcher_t` component ([#566](https://github.com/strongswan/strongswan/issues/566)).
* To potentially improve the performance and reduce the chances of a similar deadlock, the logging calls in the `watcher_t` component have been reduced and moved out of its internal mutex ([53208b0](https://github.com/strongswan/strongswan/commit/53208b0ba4c17f6efc9df3007ecf9626471fd78d)) and a change that caused the component to busy wait in some situations has also been reverted ([30803f9](https://github.com/strongswan/strongswan/commit/30803f90eb3721db178822bca203fb14696cfced)). Also related is a change that avoids verbose log calls during `initiate/terminate()` ([d96d15b](https://github.com/strongswan/strongswan/commit/d96d15b5882f5f67f6b22fdbbf956ec63cbc94ec), also see the developer notes below).
* In compliance with [RFC 5280](https://datatracker.ietf.org/doc/html/rfc5280#page-94), CRLs now have to be signed by a certificate that either encodes the `cRLSign` keyUsage bit (even if it is a CA certificate), or is a CA certificate without a keyUsage extension. strongSwan encodes a keyUsage extension with `cRLSign` bit set in all CA certificates since 13 years. And before that it didn't encode the extension, so these certificates would also be accepted as CRL issuer in case they are still valid ([7dc82de](https://github.com/strongswan/strongswan/commit/7dc82dea34167c1585a95f38b532e11a67a53ee8)).
* Support for optional CA labels in EST server URIs (e.g. `https://www.example.org/.well-known/est/arbitraryLabel1/<operation>`) was added to the `pki --est` and `pki --estca` commands ([#1614](https://github.com/strongswan/strongswan/pull/1614)).
* The *pkcs7* and *openssl* plugins now support CMS-style signatures in PKCS#7 containers, which allows verifying RSA-PSS and ECDSA signatures ([#1615](https://github.com/strongswan/strongswan/pull/1615)).
* Fixed a regression in the server implementation of EAP-TLS when using TLS 1.2 or earlier that was introduced with 5.9.10 ([#1613](https://github.com/strongswan/strongswan/discussions/1613), [3d0d3f5](https://github.com/strongswan/strongswan/commit/3d0d3f5d028a0c630f89cb4fec5b2cd5364f568b)).
* The EAP-TLS client does now enforce that the TLS handshake is complete when using TLS 1.2 or earlier. It was possible to shortcut it by sending an early EAP-Success message. Note that this isn't a security issue as the server is authenticated at that point ([db87087](https://github.com/strongswan/strongswan/commit/db87087fae6b4d1761dfba4eae3bd4880f5d23ab)).
* On Linux, the [*kernel-libipsec* plugin](https://docs.strongswan.org/docs/5.9/plugins/kernel-libipsec.html) can now optionally handle ESP packets without UDP encapsulation (uses RAW sockets, disabled by default, [e3cb756](https://github.com/strongswan/strongswan/commit/e3cb756dbf7bd2e7734103ecea599c1d9970baa4)). The plugin and *libipsec* also gained support trap policies ([23d20bb](https://github.com/strongswan/strongswan/commit/23d20bbb96dde1f63f2a53e2dd099b2fb3908bda)).
* The *dhcp* plugin uses an alternative method to determine the source address when sending unicast DHCP requests, which is not affected by interface filtering that might be employed for the IKE sockets ([#1573](https://github.com/strongswan/strongswan/issues/1573)).
* The selection of certificates and trust chains as initiator has been improved if the local trust chain is incomplete (i.e. the root CA certificate for the local certificate is not loaded) while a certificate request for a known but unrelated CA is received, which caused any local intermediate CA certificates not to get sent ([efdcbd1](https://github.com/strongswan/strongswan/commit/efdcbd13cb65528a91867118521595ac22623654)).
* ECDSA and EdDSA public keys are supported by the *ipseckey* plugin when parsing RFC 4025 `IPSECKEY` resource records ([7be55ad](https://github.com/strongswan/strongswan/commit/7be55adf051049aaf48d9f1d4fd69abe422bb7e9)).
* The *kernel-wfp* plugin installs bypass policies also on the `FWPM_SUBLAYER_IPSEC_TUNNEL` sublayer, which is necessary to bypass tunnel mode SAs/policies ([8c0a67f](https://github.com/strongswan/strongswan/commit/8c0a67f700c8feb9a00312b230a41352f9e1b124)).
* The *revocation* plugin suppresses some log messages for cached OCSP responses ([9e17a0e](https://github.com/strongswan/strongswan/commit/9e17a0ed88ee6c9c2c77fbb747e667a339819b49)).
* To further improve handling of cached OCSP responses, stale responses are now replaced in-place in the certificate cache ([47e8b21](https://github.com/strongswan/strongswan/commit/47e8b21c76366dcdfb1064fb4e1fdb619e684684)).
* Capabilities of a SCEP server are now correctly parsed by `pki --scep` and `pki --scepca` ([#1607](https://github.com/strongswan/strongswan/issues/1607)).
* When renewing a certificate via SCEP, the `--dn` argument is now optional and gets copied from the previous certificate. This is helpful in case the CA added RDNs the user might not be aware of to the issued certificate ([5f8eb09](https://github.com/strongswan/strongswan/commit/5f8eb09dd665a242fbebd55e47a0080c2f983704), [#1689](https://github.com/strongswan/strongswan/discussions/1689)).
* Fixed the fallback to the remote identity for mediated connections if no peer ID is configured ([#1569](https://github.com/strongswan/strongswan/discussions/1569), [dd79253](https://github.com/strongswan/strongswan/commit/dd79253e2d3a2d2f61689305cc02c506e2a5f746)).
* The log messages for the `terminate()` and `rekey()` commands have been improved to clarify what's happening if combined filters are used (e.g. with both `--ike` and `--child` passed, only matching CHILD\_SAs will be affected but previously a separate log message indicated that IKE\_SAs would get targeted as well, [5e46e10](https://github.com/strongswan/strongswan/commit/5e46e101a6f1f7ab24549679b15d0ff2c98c3081)).
* Fixed a crash when `charon-svc` is terminated ([8f5c0c9](https://github.com/strongswan/strongswan/commit/8f5c0c9ca926b9f936ada13f72f4b73756ecbc62)).
* If IKEv1 SAs are reset during a reauthentication because of a timeout, the initiator SPI changes. CHILD\_SAs are now correctly migrated to the new SPI ([#1663](https://github.com/strongswan/strongswan/pull/1663)).
* For developers:

  + Support for timeouts in the Python vici bindings has been improved so a default timeout that's configured on the socket won't be reset by `vici.Transport.receive()` and doesn't cause partial reads ([#1562](https://github.com/strongswan/strongswan/issues/1562)).
  + On Windows, the Python vici bindings now create a default TCP socket ([00a75e3](https://github.com/strongswan/strongswan/commit/00a75e332f293dc8d8e4750b2368e689a33fc10a)).
  + The `controller_t::initiate()` and `controller_t::terminate()` methods now take the maximum log level for messages that are passed to the callback (if any). If `controller_cb_empty()` is passed as callback, `LEVEL_SILENT` should be used to avoid any useless calls to the callback.
  + [Disabling logging at compile-time](https://docs.strongswan.org/docs/5.9/config/logging.html#_compile_time_configuration) via reduced `DEBUG_LEVEL` should again be possible ([7fa85ff](https://github.com/strongswan/strongswan/commit/7fa85ff379da8ffe5264c109723dd20f5f579821)).

Refer to [the 5.9.11 milestone](https://github.com/strongswan/strongswan/milestone/9?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
4
 alexted, SilmorSenedlen, Thermi, and mmdqeshmi reacted with thumbs up emoji
 😄
2
 alexted and mmdqeshmi reacted with laugh emoji
 🎉
2
 alexted and vchirikov reacted with hooray emoji
 ❤️
2
 alexted and mmdqeshmi reacted with heart emoji
 🚀
1
 alexted reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  4 reactions
* 😄
  2 reactions
* 🎉
  2 reactions
* ❤️
  2 reactions
* 🚀
  1 reaction
* 👀
  1 reaction

 5 people reacted

## strongSwan 5.9.10

02 Mar 13:00

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.10](/strongswan/strongswan/tree/5.9.10)

[`c0ae81f`](/strongswan/strongswan/commit/c0ae81fc834b96f1f0ae1e00a2b1d35b212c3668)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.10)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.10](/strongswan/strongswan/releases/tag/5.9.10)

* Fixed a vulnerability related to certificate verification in TLS-based EAP methods that leads to an authentication bypass followed by an expired pointer dereference that results in a denial of service but possibly even remote code execution. This vulnerability has been registered as [CVE-2023-26463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-26463). Please refer to [our blog](https://www.strongswan.org/blog/2023/03/02/strongswan-vulnerability-%28cve-2023-26463%29.html) for details.
* Added support for full packet hardware offload for IPsec SAs and policies, which has been introduced with the Linux 6.2 kernel, to the *kernel-netlink* plugin ([#1462](https://github.com/strongswan/strongswan/pull/1462)). Bypass policies for the IKE ports are automatically offloaded to devices that support this type of offloading.
* TLS-based EAP methods use the key derivation specified in [draft-ietf-emu-tls-eap-types](https://datatracker.ietf.org/doc/html/draft-ietf-emu-tls-eap-types) (currently in the RFC Editor's publication queue) when used with TLS 1.3 ([06abdf1](https://github.com/strongswan/strongswan/commit/06abdf1d31f5cee7ee90611e2ee7f390b2a3c9a4)).
* The *eap-tls* plugin properly supports TLS 1.3 according to [RFC 9190](https://datatracker.ietf.org/doc/html/rfc9190), by implementing the "protected success indication" ([5401a74](https://github.com/strongswan/strongswan/commit/5401a74d3608be19a4a883c10d4bd89e73c6ee60)). Similarly, the *eap-peap* plugin correctly initiates Phase 2 with TLS 1.3 also if `phase2_piggyback` is disabled (default) ([8aa13a1](https://github.com/strongswan/strongswan/commit/8aa13a1797eb7472b763a9b8e60d906261c6b243)).
* Routes via XFRM interfaces can now optionally be installed automatically by enabling the `charon.plugins.kernel-netlink.install_routes_xfrmi` option. Such routes are only installed if an interface with the ID referenced in `if_id_out` exists when the corresponding CHILD\_SA is installed. If the traffic selectors include the IKE traffic to the peer, special care is required (please [refer to the docs](https://docs.strongswan.org/docs/5.9/features/routeBasedVpn.html#_configuration_2) for details).
* The NetworkManager backend `charon-nm` now uses XFRM interfaces instead of dummy TUN devices to avoid issues with name resolution if they are supported by the kernel ([#1048](https://github.com/strongswan/strongswan/issues/1048)).
* With the new `prefer` value for the `childless` setting, initiators will create a childless IKE\_SA if the responder supports the extension (RFC 6023). As responder, it has the same effect as `allow`.
* The `pki --req` command can encode extendedKeyUsage (EKU) flags in the PKCS#10 certificate signing request (CSR).
* The `pki --issue` command adopts EKU flags that are either directly encoded in CSRs or derived from an encoded profile string (msCertificateTypeExtension). With the `--flag` option, these flags can either be overridden completely, or specific flags can be added and/or removed from the encoded set.
* When running on a Linux 6.2 kernel, the last use times of CHILD\_SAs are determined by querying the IPsec SAs and not the policies (older kernels don't report the last use time per SA).
* For `libcurl` with MultiSSL support, the *curl* plugin provides an option to select a specific SSL/TLS backend.
* The `swanctl --monitor-sa` command exits with `ECONNRESET` if the daemon closes the VICI connection.
* For developers:

  + The default build of the Android app now relies on OpenSSL instead of the old BoringSSL version we previously used. A script to statically build `libcrypto` is provided in the repository (see [the docs](https://docs.strongswan.org/docs/5.9/os/androidVpnClientBuild.html#_the_openssl_directory) for details).
  + Existing enum name lists (e.g. for algorithm or notify payload identifiers) can now be extended from plugins ([0de4204](https://github.com/strongswan/strongswan/commit/0de42047a98f831e8963cc352265db6a78bccc1b)).
  + Implementations of `kernel_ipsec_t` that support reporting the last use time of an SA via `query_sa()`, should announce this via the `KERNEL_SA_USE_TIME` kernel feature.
  + `libvici` provides a callback that's invoked if the connection is closed by the daemon, which may be useful when listening for events.

Refer to [the 5.9.10 milestone](https://github.com/strongswan/strongswan/milestone/8?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
3
 alexted, SilmorSenedlen, and xliuxu reacted with thumbs up emoji
 😄
1
 alexted reacted with laugh emoji
 🎉
1
 alexted reacted with hooray emoji
 ❤️
1
 alexted reacted with heart emoji
 🚀
1
 alexted reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  3 reactions
* 😄
  1 reaction
* 🎉
  1 reaction
* ❤️
  1 reaction
* 🚀
  1 reaction
* 👀
  1 reaction

 3 people reacted

## strongSwan 5.9.9

03 Jan 12:47

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.9](/strongswan/strongswan/tree/5.9.9)

[`0c7bfec`](/strongswan/strongswan/commit/0c7bfec7af5ac0ebbec03ece027c143156a5821e)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.9)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.9](/strongswan/strongswan/releases/tag/5.9.9)

* Fixed an issue that could cause OCSP requests to contain an incorrect serial number if the *openssl* plugin parsed the certificate ([#1415](https://github.com/strongswan/strongswan/issues/1415)). Also see below for changes regarding the unified handling of serial numbers in code.
* The path/command for `resolvconf(8)` used by the *resolve* plugin is now configurable ([dee1916](https://github.com/strongswan/strongswan/commit/dee1916e4cf3cb3baafc3b01118a56a38b4d936c)).
* The *resolve* plugin does not invoke `resolvconf(8)` with individual interface names for each name server anymore. Instead, it uses a single, configurable interface/protocol name and provides all available name servers to `resolvconf(8)` every time a name server is added or removed ([#1353](https://github.com/strongswan/strongswan/issues/1353)).
* The `listen()` operation in the VICI Python bindings may now optionally time out, which can be useful when listening for events in a separate thread as that can otherwise not be canceled easily ([#1416](https://github.com/strongswan/strongswan/pull/1416)). Support for Python 2 has been dropped.
* The first reqid that's automatically assigned to a CHILD\_SA is now configurable via `charon.reqid_base` in strongswan.conf. This allows reserving some low reqids for manual allocation.
* Default values for soft lifetimes of CHILD\_SAs configured via swanctl.conf/VICI are now based on hard lifetimes if any are configured. Previously, it only worked the other way around ([#1414](https://github.com/strongswan/strongswan/pull/1414)).
* The *kernel-netlink* plugin now logs extended ACK error and warning messages provided by the Linux kernel if e.g. the installation of an SA or policy fails. This should give users a clearer indication of what might be wrong than the generic error messages for error codes like `EINVAL` or `ENOSYS` did previously.
* Several build conflicts with wolfSSL's OpenSSL compatibility layer have been resolved ([#1332](https://github.com/strongswan/strongswan/pull/1332)).
* For developers:
  + The `get_serial()` method of the `x509_t`, `crl_t`, and `ac_t` interfaces is now expected to return serial numbers in canonical form (i.e. without leading zeros). The existing plugins that implement or use these interfaces have been adapted accordingly, make sure to do the same with custom plugins/patches.
  + If linked against `libbfd` (`--enable-bfd-backtraces`), our own leak detective can whitelist functions that are otherwise not visible.

Refer to [the 5.9.9 milestone](https://github.com/strongswan/strongswan/milestone/7?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
1
 alexted reacted with thumbs up emoji
 😄
1
 alexted reacted with laugh emoji
 🎉
2
 alexted and ivanbaldo reacted with hooray emoji
 ❤️
1
 alexted reacted with heart emoji
 🚀
1
 alexted reacted with rocket emoji
 👀
1
 alexted reacted with eyes emoji

All reactions

* 👍
  1 reaction
* 😄
  1 reaction
* 🎉
  2 reactions
* ❤️
  1 reaction
* 🚀
  1 reaction
* 👀
  1 reaction

 2 people reacted

## strongSwan 5.9.8

03 Oct 15:24

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.8](/strongswan/strongswan/tree/5.9.8)

[`e09bc70`](/strongswan/strongswan/commit/e09bc70d124554f8ee892f3ee4a988ce6d2e7c90)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.8)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.8](/strongswan/strongswan/releases/tag/5.9.8)

* Fixed a vulnerability related to online certificate revocation checking that was caused because the *revocation* plugin used potentially untrusted OCSP URIs and CRL distribution points in certificates. This allowed a remote attacker to initiate IKE\_SAs and send crafted certificates that contain URIs pointing to servers under their control, which could have lead to a denial-of-service attack. This vulnerability has been registered as [CVE-2022-40617](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-40617). Please refer to [our blog](https://www.strongswan.org/blog/2022/10/03/strongswan-vulnerability-%28cve-2022-40617%29.html) for details.
* The `pki --scep|--scepca` commands implement the HTTP-based "Simple Certificate Enrollment Protocol" ([RFC 8894](https://datatracker.ietf.org/doc/html/rfc8894) SCEP) replacing the old and long deprecated `scepclient` that has been removed.
* The `pki --est|estca` commands implement the HTTPS-based "Enrollment over Secure Transport" ([RFC 7070](https://datatracker.ietf.org/doc/html/rfc7030) EST) protocol.
* The `pki --req` command can create a certificate request based on an existing PKCS#10 template by replacing the public key and re-generating the signature with the new private key.
* The `ike_cfg_t` object is now always replaced together with the `peer_cfg_t` object that's set on an IKE\_SA during authentication. This is more consistent and allows to properly take into account some settings that are also relevant during IKE\_AUTH (e.g. `childless`) and it was actually already handled this way during rekeying/reestablishing of IKE\_SAs and e.g. for the DSCP setting.
* The *gcm* plugin has been enabled by default, so that the TLS 1.3 unit tests (now indirectly enabled if the `pki` tool is built due to the implementation of EST) can be completed successfully with just the default plugins.
* Our TLS client implementation now sends an empty certificate payload if a certificate request is received but no certificate is available. The encoding of TLS 1.3 certificate extensions for intermediate CA certificates has also been fixed.
* The socket plugins don't set the `SO_REUSEADDR` option anymore on the IKE UDP sockets, so an error is triggered if e.g. two daemons (e.g. `charon` and `charon-systemd`) are running concurrently using the same ports.
* The `charon.rsa_pss_trailerfield` setting generates an algorithmIdentifier for RSASSA-PSS signatures with explicit trailerField, which might be necessary for interoperability with implementations of [RFC 7427](https://www.rfc-editor.org/rfc/rfc7427.html) that haven't considered its [errata](https://www.rfc-editor.org/errata/rfc7427).
* A potential use-after-free issue has been fixed when caching credential encodings (e.g. fingerprints) if multiple threads operate on the same key concurrently ([#1231](https://github.com/strongswan/strongswan/issues/1231)).
* A potential crash has been fixed caused by a race condition during shutdown between the main thread flushing the IKE\_SA manager and worker threads still creating IKE\_SAs ([#1252](https://github.com/strongswan/strongswan/issues/1252)).
* A potential crash in the *vici* plugin has been fixed that was caused when events were triggered with messages that failed to get created successfully ([#1278](https://github.com/strongswan/strongswan/issues/1278)).
* A file descriptor leak has been fixed in the Android client ([#1160](https://github.com/strongswan/strongswan/issues/1160)), plus some other issues related to targeting Android 12 (e.g. [#1151](https://github.com/strongswan/strongswan/discussions/1151) and [86b69f2](https://github.com/strongswan/strongswan/commit/86b69f26e49f93f94f6ab84b48feac8716a719cc)).
* For developers:

  + For IKEv2, the `ike_updown()` "up" event and the state change to `IKE_ESTABLISHED` are now triggered after all IKE-related tasks are done. This ensures the IKE\_SA is actually fully established, which now includes any assigned virtual IPs, additional MOBIKE peer addresses or a reauthentication time updated via `AUTH_LIFETIME` notify. This was an issue for the *selinux* plugin if virtual IPs were used.
  + In the `cert_validator_t` interface, the `online` flag has been removed from the `validate()` method, which is called during basic certificate chain validation. Online validation is now instead triggered via the new `validate_online()` method, which is called after a trusted certificate chain has been built.
  + `pen_t` is now used for EAP vendor IDs instead of `uint32_t`.
  + The `--enable-asan` configure option enables building with AddressSanitizer (ASan).
  + The `TESTS_ITERATIONS` environment variable allows running only specific iterations of loop-based test functions.

Refer to [the 5.9.8 milestone](https://github.com/strongswan/strongswan/milestone/6?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 🚀
1
 ivanbaldo reacted with rocket emoji

All reactions

* 🚀
  1 reaction

 1 person reacted

## strongSwan 5.9.7

29 Jul 06:36

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.7](/strongswan/strongswan/tree/5.9.7)

[`49ddfe9`](/strongswan/strongswan/commit/49ddfe91f0958555a39b1234424967de85b59276)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.7)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.7](/strongswan/strongswan/releases/tag/5.9.7)

* The IKEv2 key derivation is now delayed until the keys are actually needed to process or send the next message. So instead of deriving the keys directly while processing an IKE\_SA\_INIT request (which could come from a spoofed address), it is delayed until the corresponding IKE\_AUTH request is received. See below for required changes for Diffie-Hellman implementations.
* Inbound IKEv2 messages, in particular requests, are now processed differently. Instead of parsing all inbound messages right away (which might trigger a key derivation or require keys we don't have anymore in the multi-KE use case), we now first check a request's message ID and compare its hash to that of the previous request to decide if it's a valid retransmit. For fragmented messages we only keep track of the first fragment so we can send the corresponding response immediately if a retransmit of it is received, instead of waiting for all fragments and reconstructing the message, which we did before.
* The retransmission logic in the *dhcp* plugin has been fixed ([#1154](https://github.com/strongswan/strongswan/issues/1154)). As originally intended, four retransmits are now sent over a total of 15 seconds for each DHCP request. Previously, it could happen that some or all of the five messages were sent at basically the same time, without any delay to wait for a response.
* The *connmark* plugin now considers configured masks in installed firewall rules ([#1087](https://github.com/strongswan/strongswan/issues/1087)). For instance, with `mark_in = mark_out = %unique/0x0000ffff`, mark values in the upper two bytes would not get reset by the rules installed by the plugin and could be used for other purposes. However, note that in this example the daemon would have to get restarted after 65'535 CHILD\_SAs (at the latest) to reset the global 32-bit counter for unique marks as that's unaware of any masks.
* Child config selection has been fixed as responder in cases where multiple children use transport mode traffic selectors ([#1143](https://github.com/strongswan/strongswan/issues/1143)).
* The outbound SA/policy is now also removed after IKEv1 CHILD\_SA rekeyings ([#1041](https://github.com/strongswan/strongswan/pull/1041)).
* The *openssl* plugin supports AES and Camellia in CTR mode ([112bb46](https://github.com/strongswan/strongswan/commit/112bb465fb531cb164c6c2dec3c49a7fe9c853fa)).
* The AES-XCBC/CMAC PRFs are demoted in the default proposal (after HMAC-based PRFs) since they were never widely adopted ([RFC 8247](https://datatracker.ietf.org/doc/html/rfc8247) only mentions AES-XCBC and recommends it exclusively for IoT deployments).
* The *kdf* plugin is now automatically enabled if any of the *aesni*, *cmac* or *xcbc* plugins are enabled, or if none of the plugins that directly provide HMAC-based KDFs are enabled (*botan*, *openssl* or *wolfssl*).
* The `CALLBACK` macros (and some other issues) have been fixed when compiling with GCC 12 ([#1053](https://github.com/strongswan/strongswan/issues/1053)).
* Support for GTK 4 was added to the NetworkManager plugin ([#961](https://github.com/strongswan/strongswan/issues/961)), the necessary changes were released separately with version 1.6.0 of the plugin.
* For developers:

  + When building from the repository, the new `--enable-warnings` configure option is now automatically enabled. It adds `-Wall -Wextra -Werror` (and a bunch of `-Wno-*` flags for warnings that are difficult to avoid in our codebase) to the `CFLAGS` prepared by the script (`CFLAGS` passed to the script are added after the internal flags, so overriding these options is possible without having to disable `--enable-warnings` completely). This was mainly added to avoid passing `-Werror` to the configure script in our automated CI builds as that also affects the tests run by it.
  + The `diffie_hellman_t` interface was renamed to `key_exchange_t` with the following additional changes to the interface:
    - `set_other_public_key()` was renamed to `set_public_key()`
      * this method **must not** do any costly public key validation or the actual key derivation anymore, which must instead be implemented in `get_shared_secret()`
    - `get_my_public_key()` was renamed to `get_public_key()`
    - `set_private_value()` was renamed to `set_private_key()`
    - `get_dh_group()` was renamed to `get_method()`
  + The `diffie_hellman_group_t` enum was renamed to `key_exchange_method_t`, the corresponding `enum_name_t` instances were renamed similarly. `MODP_NONE` was renamed to `KE_NONE`.
  + The `has_dh_group()` and `promote_dh_group()` methods on `proposal_t` were renamed and generalized to `has_transform()` and `promote_transform()`, respectively, which allow checking if any transform/algorithm (not only a DH group) is contained in a proposal or move it to the front. Similarly, the `get_dh_group()` method on `ike_cfg_t` and `child_cfg_t` was changed to `get_algorithm()`.
  + Two new callbacks for `task_t` enable tasks to do work after generating (`post_build()`) or processing (`post_process()`) a message.
    - The `post_build()` hook is used by the ike-auth task to collect a copy of the sent IKE\_SA\_INIT message after it was generated. This avoids having to pre-generate the message in the task, allowing later-running tasks and plugins (via `message()` listener hook) to modify it (e.g. add notifies) before it's eventually generated.
  + The `TESTS_VERBOSITY_<group>` environment variables allow configuring the log level for individual log groups when running the unit tests (they default to `TESTS_VERBOSITY`).

Refer to [the 5.9.7 milestone](https://github.com/strongswan/strongswan/milestone/5?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 🚀
2
 alexted and ivanbaldo reacted with rocket emoji

All reactions

* 🚀
  2 reactions

 2 people reacted

## strongSwan 5.9.6

29 Apr 05:56

![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=40&v=4)
[tobiasbrunner](/tobiasbrunner)

[5.9.6](/strongswan/strongswan/tree/5.9.6)

[`4cf8cd0`](/strongswan/strongswan/commit/4cf8cd0321fbc93098b588991b3a6ab5edf823bb)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/strongswan/strongswan/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...5.9.6)

 Loading

[View all tags](/strongswan/strongswan/tags)

[strongSwan 5.9.6](/strongswan/strongswan/releases/tag/5.9.6)

* The main two steps of the IKEv2 key derivation (PRF/prf+) have been modularized. In particular, prf+ is now provided by a plugin. This makes certification (e.g. FIPS-140) easier at it allows implementing them via an already certified third-party library.

  For the most commonly used HMAC-based PRFs, the *botan*, *openssl* and *wolfssl* plugins implement the two steps via their respective implementations of [RFC 5869](https://datatracker.ietf.org/doc/html/rfc5869)'s `HKDF-Extract` (`KDF_PRF`) and `HKDF-Expand` (`KDF_PRF_PLUS`). A default implementation, based on generic PRFs from other plugins, is provided by the new *kdf* plugin (may be disabled if one of the mentioned third-party plugins is loaded and none of the rarely used non-HMAC PRFs, AES-XCBC or AES-CMAC, are used).
* Support for labeled IPsec with IKEv2 ([draft-ietf-ipsecme-labeled-ipsec](https://datatracker.ietf.org/doc/html/draft-ietf-ipsecme-labeled-ipsec)) has been added. Two modes are currently supported:

  + SELinux: When building with `--enable-selinux`, support for SELinux labels is enabled and the *selinux* plugin is built. If SELinux is usable on the system, the negotiated labels are installed on IPsec SAs and policies. The configured label is expected to be a generic context (e.g. `system_u:object_r:ipsec_spd_t:s0`), which is installed on trap policies. Either from the outset via `start_action=trap`, or dynamically by the *selinux* plugin after an IKE\_SA has been established (e.g. in roadwarrior scenarios, in particular as responder). Once traffic hits such a policy and matches its context via `association:polmatch`, an acquire with the actual label is triggered by the kernel, for which a CHILD\_SA is negotiated with the peer. A childless IKE\_SA is created if the connection is not triggered by an acquire and no specific label is available. Labels received as responder are accepted if they match the configured label via `association:polmatch`.
  + Simple: This proprietary mode, which is the default if SELinux support is disabled or not available on the system, allows exchanging arbitrary labels to identify specific child configs on the peer. These labels are not configured on the IPsec SAs or policies but are simply used during CHILD\_SA creation to aid config selection (an example can be seen in the [ikev2/net2net-dscp scenario](https://www.strongswan.org/testing/testresults/ikev2/net2net-dscp/)).
* Denial of Service (DoS) protection has been improved:

  + The secrets used for generating COOKIE payloads are now switched based on a time limit (2 minutes) and not the previous usage limit (10'000 generated cookies). This avoids switching secrets multiple times a second under a heavy attack, preventing legitimate clients from successfully sending requests with valid cookies (they are valid for 10 seconds, by default).
  + So far, sending and requiring COOKIE payloads was triggered only by the total number of half-open IKE\_SAs. Because that global threshold is higher than the per-IP block threshold (5 half-open IKE\_SAs are allowed per IP, by default), it was possible for an attacker to block a legitimate user by sending spoofed IKE\_SA\_INIT packets from that user's IP. To prevent this, a new per-IP threshold has been added to trigger cookies (3 half-open IKE\_SAs, by default). The default value for the global threshold has also been increased slightly (from 10 to 30).
  + Unprocessed but queued initial messages (IKE\_SA\_INIT for IKEv2) are now already counted as half-open IKE\_SAs. This makes the thresholds more accurate so it isn't possible anymore for attackers to create thousands of jobs for packets from spoofed IP addresses before the daemon is able to process enough of them to create half-open IKE\_SAs that would trigger the thresholds.
* Actively initiating duplicate CHILD\_SAs within the same IKE\_SA is now largely prevented. This can happen if trap policies are installed and an IKE\_SA with its CHILD\_SAs is reestablished (e.g. with break-before-make reauthentication or `dpd_action=restart`). This does not prevent duplicates if they are initiated by the two peers concurrently.
* It's now possible to combine `trap` and `start` in `start_action` (i.e. `start_action=trap|start`) to immediately initiate an SA for which trap policies are also installed.
* Updates to reqids on policies are allowed again by the *kernel-netlink* plugin. The infamous error `unable to install policy ... for reqid ..., the same policy for reqid ... exists` is replaced by a simple warning should the reqid for a policy actually get updated.
* Compatibility with OpenSSL 3.0 has been improved ([9aa7e12](https://github.com/strongswan/strongswan/commit/9aa7e126b2e2ee23c06fc628d95012e2c87c094c)). Providers are not unloaded anymore to avoid issues with `atexit()` handlers ([#921](https://github.com/strongswan/strongswan/issues/921)).
* The client identity (e.g. the IKE or EAP identity for EAP-TLS) is again enforced by libtls ([#873](https://github.com/strongswan/strongswan/issues/873)).
* If the source address is unknown when initiating an IKEv2 SA, a NAT situation is now forced for IPv4 (for IPv6, NAT-T is disabled) to avoid causing asymmetric enabling of UDP-encapsulation ([#861](https://github.com/strongswan/strongswan/issues/861)).
* Installing unnecessary exclude routes for VPN servers on FreeBSD is now avoided ([#910](https://github.com/strongswan/strongswan/issues/910)).
* The default AEAD ESP proposal (sent since 5.9.0) now includes `noesn` to make it standards-compliant ([#868](https://github.com/strongswan/strongswan/pull/868)).
* Missing alerts were added to the *error-notify* plugin ([801bb85](https://github.com/strongswan/strongswan/commit/801bb8536a2b23736232ff26ee26b76f92ce2da8)).
* The new `map_level` option for syslog loggers allows mapping log levels (0..4) to syslog levels starting at the specified number (by default, all messages are logged with `LOG_INFO`).
* The *addrblock* plugin allows limiting the validation depth of issuer addrblock extensions ([e3d1766](https://github.com/strongswan/strongswan/commit/e3d1766aff96324a48612fa64e6fb36475c71afc)).
* Individual CHILD\_SAs can be queried via the `list-sas()` vici command (or `swanctl --list-sas`), either by unique ID or name.
* For developers:

  + Plugins can provide the two IKEv2 key derivation steps (`KDF_PRF/KDF_PRF_PLUS`), see [kdf.h](https://github.com/strongswan/strongswan/blob/master/src/libstrongswan/crypto/kdfs/kdf.h) for details.
  + `ike_sa_t::initiate()` now takes a struct with optional arguments (such as traffic selectors). The same is the case for similar data from acquires (changed the signatures for `acquire()` on the `kernel_listener_t` and `kernel_interface_t` interfaces).
  + The trap manager allows installing externally managed trap policies (see the *selinux* plugin for an example of how this could be used).
  + If dynamic traffic selectors are updated due to an address change, the reqid of a CHILD\_SA now changes, in which case `kernel_ipsec_t::update_sa()` is called with `new_reqid` set in the `kernel_ipsec_update_sa_t` struct. If a kernel interface doesn't support this, `NOT_SUPPORTED` should be returned to trigger a rekeying.
  + The fourth argument for `ENUM_FLAGS` now indicates the name used when no flags are set (previously, `(unset)` was used for all flag enums). Flags can now also be parsed via `enum_flags_from_string()` (expects the flags separated by `|`).

Refer to [the 5.9.6 milestone](https://github.com/strongswan/strongswan/milestone/4?closed=1) for a list of all closed issues and pull requests.

 Assets
6

 Loading

 👍
6
 ttc0419, thctlo, SongC1229, tornadow, acrolink, and ivanbaldo reacted with thumbs up emoji

All reactions

* 👍
  6 reactions

 6 people reacted

Previous *1* [2](/strongswan/strongswan/releases?page=2) [Next](/strongswan/strongswan/releases?page=2)

Previous [Next](/strongswan/strongswan/releases?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.codelabs.ch_c110e12b_20250115_121036.html ===

# TKM

The Trusted Key Manager (TKM) is a minimal Trusted Computing Base which
implements security-critical functions of the IKEv2 protocol. It is implemented
using the Ada programming language. The TKM works in conjunction with the
strongSwan IKEv2 daemon `charon-tkm` to provide key management services for
IPsec.

|  | IPsec can be used to protect data flows between hosts or security gateways. [[1](#_footnotedef_1 "View footnote.")] |
| --- | --- |

The underlying concept of IKE disaggregation and the design of TKM and all
related components is presented in detail in the project report, see
[documentation](#anchor-doc).

To support automatic setup and rekeying of IPsec connections the `xfrm-proxy`
component is used. It forwards XFRM Acquire and Expire events from the Linux
kernel to the IKE daemon. The following diagram illustrates the main components
of the system and how they communicate:

![System overview](system-overview.svg)

The trusted key manager uses the tkm-rpc library to communicate with the
augmented strongSwan charon daemon (`charon-tkm`) in the untrusted part. The
tkm-rpc library is also written in Ada.

For x509 certificate processing, the x509/Ada library is used and for
communication with the Linux kernel’s XFRM subsystem the XFRM/Ada library is
employed.

Diffie-Hellman key agreement and RSA signature generation and validation are
implemented using the big number arithmetic provided by the GMPAda binding.

|  | TKM is considered a prototype implementation and a technology demonstrator of the IKE disaggregation concept. We do not consider it to be fit for production use in its current form. |
| --- | --- |

## Features

The following features are implemented by TKM:

* *PKCS#1* (RSA) key and *X.509* certificate processing
* Public key authentication using *RSA-PKCS1-SHA1*
* Certificate trustchain validation using *RSA-PKCS1-SHA256*
* Diffie-Hellman key exchange using groups *DH-MODP-3072* and *DH-MODP-4096*
* IKE and ESP key derivation using *HMAC-SHA512*
* IKE en-/decryption using *AES-CBC-256* and *HMAC-SHA512*

The following table lists the supported transforms with their IANA identifiers:

Table 1. Supported IKEv2 transforms

| ID | Transform Type |
| --- | --- |
| 12 | Encryption algorithm |
| 7 | Pseudo-random Function |
| 14 | Integrity Algorithm |
| 15 | Diffie-Hellman Group |
| 16 | Diffie-Hellman Group |
| 1 | Authentication method |

A complete list of all IKEv2 IANA identifiers can be found here:
<https://www.iana.org/assignments/ikev2-parameters/>.

## Documentation

To give a brief overview of the project, its abstract is reproduced here:

> The IPsec protocol relies on the correct operation of the IKE key exchange to
> meet its security goals. The implementation of the IKE protocol is a non-trivial
> task and results in a large and complex code base. This makes it hard to gain
> a high degree of confidence in the correct operation of the code.
>
>
> We propose a component-based approach by disaggregating the IKE key management
> system into trusted and untrusted components to attain a higher level of
> security. By formulating desired security properties and identifying the
> critical components of the IKE protocol, a concept to split the key management
> system into an untrusted and trusted part is presented. The security-critical
> part represents a trusted computing base (TCB) and is termed Trusted Key Manager
> (TKM). Care was taken to only extract the functionality that is absolutely
> necessary to ensure the desired security properties. Thus, the presented
> interface between the untrusted IKE processing component and TKM allows for a
> small and robust implementation of the TCB. The splitting of the protocol
> guarantees that even if the untrusted side is completely subverted by an
> attacker, the trusted components uphold the proposed security goals.
>
>
> The viability of the design has been validated through a prototypical
> implementation of the presented system. The untrusted parts of the IKE daemon
> have been implemented by extending the existing strongSwan IKE implementation.
> The trusted components have been implemented from scratch using the Ada
> programming language, which is well suited for the development of robust
> software. The new Design-by-Contract feature of Ada 2012 has been used for the
> implementation of state machines, to augment the confidence of operation
> according to the specification.

The full report about IKEv2 Separation can be found here:
<https://www.codelabs.ch/tkm/ike-separation.pdf>.

Information about the strongSwan project can be found on the project’s website:
<https://www.strongswan.org>.

Unfortunately the Linux kernel’s XFRM subsystem is not well documented. A brief
overview is given on the following website:
<https://www.linuxfoundation.org/collaborate/workgroups/networking/ipsec-overview>.

## Download

The TKM sources are available through its git repository:

```
$ git clone https://git.codelabs.ch/git/tkm.git
```

A browsable version of the repository is also available here:
<https://git.codelabs.ch/?p=tkm.git>

## Installation

This section describes the steps needed to build, install and use the Trusted
Key Manager in conjunction with strongSwan to provide IKEv2 key management
services on a Linux host.

### Requirements

To compile the TKM components on your system, you need to have the following
software installed:

* Git version control tool:
  <https://git-scm.com/>
* GNAT compiler:
  <https://www.gnu.org/software/gnat/gnat.html>
* gprbuild (part of AdaCore’s GNAT GPL Edition):
  <https://libre.adacore.com/tools/>
* Anet (Version 0.2.2 or above):
  <https://www.codelabs.ch/anet/>
* Alog (Version 0.4 or above):
  <https://www.codelabs.ch/alog/>
* GMPAda (Ada GMP binding):
  <http://nicolas.boulenguez.free.fr/>
* XML/Ada (Version 4.1 or above):
  <https://libre.adacore.com/tools/xmlada/>

If you want to run the unit tests before installation of a TKM component (which
is recommended) you furthermore need to have the following installed:

* Ahven (Test-Framework):
  <https://ahven.stronglytyped.org/>

### Preparatory steps

It is expected that the GNAT project files of the installed Ada libraries are
accessible on the system by exporting the ADA\_PROJECT\_PATH environment
variable. If you have installed the libraries under `$HOME/libraries/` the
following command will allow their use:

```
$ export ADA_PROJECT_PATH=$HOME/libraries/lib/gnat
```

|  | If you expect to compile Ada code more frequently you can append the previous line to your `$HOME/.profile` file so it is set automatically. |
| --- | --- |

### XFRM/Ada library

The first step is to compile and install the needed libraries. Compile and
install XFRM/Ada:

```
$ git clone https://git.codelabs.ch/git/xfrm-ada.git
$ cd xfrm-ada
$ make install
```

### X509/Ada library

Compile and install X509/Ada:

```
$ git clone https://git.codelabs.ch/git/x509-ada.git
$ cd x509-ada
$ make tests
$ make install
```

### TKM-RPC library

After these dependencies have been met, the TKM-RPC library is next:

```
$ git clone https://git.codelabs.ch/git/tkm-rpc.git
$ cd tkm-rpc
$ make tests
$ make install
```

### libsparkcrypto

To encrypt IKE packets, the libsparkcrypto library is required:

```
$ git clone https://git.codelabs.ch/spark-crypto.git
$ cd spark-crypto
$ make NO_SPARK=1 NO_TESTS=1 NO_APIDOC=1
$ make NO_SPARK=1 NO_TESTS=1 NO_APIDOC=1 DESTDIR=$HOME/libraries/lib/gnat install
```

### strongSwan

Next up is the charon-tkm daemon, which is part of the strongSwan project:

```
$ git clone git://git.strongswan.org/strongswan.git
$ cd strongswan
```

After that the daemon can be compiled and installed. A different installation
location than the default `/usr/local/` can be specified using the --prefix
option:

```
$ ./autogen.sh
$ ./configure [--prefix=/path/to/install] \
    --disable-defaults      \
    --enable-ikev2          \
    --enable-kernel-netlink \
    --enable-pem            \
    --enable-pkcs1          \
    --enable-random         \
    --enable-sha1           \
    --enable-socket-default \
    --enable-swanctl        \
    --enable-tkm            \
    --enable-x509
$ make install
```

For additional build instructions for strongSwan, the reader is directed to the
project’s documentation.
[[2](#_footnotedef_2 "View footnote.")]

|  | strongSwan requires specific kernel modules to be enabled [[3](#_footnotedef_3 "View footnote.")] |
| --- | --- |

### TKM

Once the IKEv2 daemon is ready the TKM component can be compiled:

```
$ git clone https://git.codelabs.ch/git/tkm.git
$ cd tkm
$ make tests
$ make install
```

### xfrm-proxy

For XFRM Acquire and Expire processing, the xfrm-proxy component must be
compiled and installed:

```
$ git clone https://git.codelabs.ch/git/xfrm-proxy.git
$ cd xfrm-proxy
$ make install
```

### Certificates

X509 certificates are needed for mutual authentication. The strongSwan PKI tool
can be used to setup a simple CA with user certificates
[[4](#_footnotedef_4 "View footnote.")]. The
generated CA certificate must be placed in strongSwan’s certificate directory,
which is `/usr/local/etc/swanctl/x509ca/` by default. Likewise the user
certificate containing the public key of the local identity used for
authentication, must be copied to `/usr/local/etc/swanctl/x509/`.

### Configuration

Now a suitable configuration must be generated using the `tkm_cfgtool`. The tool
takes an XML file as input and creates an IKE and a TKM configuration file:

```
$ tkm_cfgtool -c config.xml -i swanctl.conf -t tkm.conf -s /path/to/schema
```

The XML config file format is quite simple and an example configuration file is
available in the TKM source code, see `data/refconfig.xml`.

The swanctl.conf file must be copied to strongSwan’s configuration directory. By
default this is located at `/usr/local/etc/swanctl`.

```
$ cp swanctl.conf /usr/local/etc/swanctl
```

### Putting it all together

Now that everything is in place the TKM can be started:

```
$ sudo tkm_keymanager -c tkm.conf -k privKey.der -r ca.der:1
```

The TKM binary `tkm_keymanager` opens a Netlink socket to the XFRM subsystem of
the Linux kernel to install XFRM policies and XFRM state (IPsec keys etc), which
requires root permissions.

The private key and CA certificate in ASN.1/DER format should have already been
generated. TKM uses the given private key to assert the local identity to the
peer(s) and the CA certificate to verify the trust chain of peer certificates.

Once the Trusted Key Manager has been started successfully the IKE daemon can be
started:

```
$ sudo /usr/local/libexec/ipsec/charon-tkm
```

The connections and certificates are loaded via `swanctl`:

```
$ sudo swanctl --load-all
```

This command could also be configured as start script in `strongswan.conf`.

The syslog log file can be checked to verify that the IKE daemon is up and
running. Additionally all configured connections are shown when displaying IKE’s
status information:

```
$ sudo swanctl --list-conns
```

For automated setup and rekeying of connections the xfrm-proxy must be started.
Since it opens a Netlink socket to the kernel’s XFRM subsystem it must run as
root:

```
$ sudo xfrm_proxy
```

If all components have been started successfully, an IPsec connection should be
setup automatically when trying to ping the peer. To inquire information about
active connections of the IKE daemon issue the following command:

```
$ sudo swanctl --list-sas
```

The status of the kernel’s XFRM subsystem can be inquired using the `ip` tool.
To display all installed XFRM policies issue the following command:

```
$ sudo ip xfrm policy show
```

To display all installed XFRM states including the keys used for encryption and
integrity protection of the IPsec connection, issue the following command:

```
$ sudo ip xfrm state show
```

## Limitations

Since the TKM was developed as a prototype, it is still missing some
functionality. Currently the following limitations exist:

* Only basic certificate validation is performed during trustchain validation.
  Additional checks, such as mandated by RFC 5280, are currently missing.
* Authentication of the local identity is restricted to a single private key.
* Cryptographic algorithms to protect IKE and IPsec SAs are restricted to
  *AES-CBC-256/HMAC-SHA512*.
* `/dev/urandom` is used as random source and is non-configurable.
* Not all memory containing security critical data, such as Diffie-Hellman
  shared secrets are scrubbed after use.
* The implementation of the cryptographic algorithms may be susceptible to
  timing side channel attacks.
* The IKE splitting and the designed protocol between IKE and TKM has not (yet)
  been formally proven.

More detailed information is available in the project report in chapter 6.2, see
[documentation](#anchor-doc).

## Licence

```
Copyright (C) 2020-2021 Tobias Brunner <tobias@codelabs.ch>
Copyright (C) 2012-2015 Reto Buerki <reet@codelabs.ch>
Copyright (C) 2012-2015 Adrian-Ken Rueegsegger <ken@codelabs.ch>

This program is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version.
```

---

[1](#_footnoteref_1). <https://en.wikipedia.org/wiki/IPsec>

[2](#_footnoteref_2). <https://docs.strongswan.org/docs/5.9/install/install.html>

[3](#_footnoteref_3). <https://docs.strongswan.org/docs/5.9/install/kernelModules.html>

[4](#_footnoteref_4). <https://docs.strongswan.org/docs/5.9/pki/pkiQuickstart.html>

Last updated 2019-05-03 08:07:10 UTC


