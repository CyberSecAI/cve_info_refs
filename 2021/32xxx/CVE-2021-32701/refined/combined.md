=== Content from github.com_b5a4a421_20250115_085303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fcommit%2F1f9f625c1a49e134ae2299ee95b8cf158feec932)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fcommit%2F1f9f625c1a49e134ae2299ee95b8cf158feec932)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ory%2Foathkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ory](/ory)
/
**[oathkeeper](/ory/oathkeeper)**
Public

* [Notifications](/login?return_to=%2Fory%2Foathkeeper) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fory%2Foathkeeper)
* [Star
   3.3k](/login?return_to=%2Fory%2Foathkeeper)

* [Code](/ory/oathkeeper)
* [Issues
  57](/ory/oathkeeper/issues)
* [Pull requests
  24](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

Additional navigation options

* [Code](/ory/oathkeeper)
* [Issues](/ory/oathkeeper/issues)
* [Pull requests](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

## Commit

[Permalink](/ory/oathkeeper/commit/1f9f625c1a49e134ae2299ee95b8cf158feec932)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-qvp4-rpmr-xwrr](https://github.com/advisories/GHSA-qvp4-rpmr-xwrr "GHSA-qvp4-rpmr-xwrr")

[Browse files](/ory/oathkeeper/tree/1f9f625c1a49e134ae2299ee95b8cf158feec932)
Browse the repository at this point in the history

```
This patch addresses a security vulnerability which would bypass token claim validation once a token is in the cache.

For more information please refer to [GHSA-qvp4-rpmr-xwrr](https://github.com/ory/oathkeeper/security/advisories/GHSA-qvp4-rpmr-xwrr "GHSA-qvp4-rpmr-xwrr")
```

* Loading branch information

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=40&v=4)](/aeneasr)

[aeneasr](/ory/oathkeeper/commits?author=aeneasr "View all commits by aeneasr")
authored
Jun 22, 2021

1 parent
[64ac756](/ory/oathkeeper/commit/64ac7562669287d391cd72dfd43c5d71ff9f89a1)

commit 1f9f625

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**402 additions**
and
**186 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .circleci

  + .circleci/config.yml
    [config.yml](#diff-78a8a19706dbd2a4425dd72bdab0502ed7a2cef16365ab7030a5a0588927bf47)
* Makefile
  [Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52)
* docs/docs

  + docs/docs/CHANGELOG.md
    [CHANGELOG.md](#diff-37d9e82f64b79f4e2cf320e4872ddb76080280b447541220fbed7c6ecd8aef26)
  + pipeline

    - docs/docs/pipeline/authn.md
      [authn.md](#diff-773ad8e1a13dacaf1954a142de4b40f029594095dd11d51b20e411142b089769)
* driver/configuration

  + driver/configuration/provider.go
    [provider.go](#diff-6d27005f7b6bab036dbd341bd75084437e9a78b4a204c9b29d8f216917e0d791)
* pipeline/authn

  + pipeline/authn/authenticator\_oauth2\_introspection.go
    [authenticator\_oauth2\_introspection.go](#diff-5c8061290da17d352a4b888e5270cdd071ea584cd4751011132d8cccd69594f0)
  + pipeline/authn/authenticator\_oauth2\_introspection\_test.go
    [authenticator\_oauth2\_introspection\_test.go](#diff-1ac01aebae51ff8515571a8b765ca16fbff2d34d02e2a609abca3b70e209330a)

## There are no files selected for viewing

5 changes: 3 additions & 2 deletions

5
[.circleci/config.yml](#diff-78a8a19706dbd2a4425dd72bdab0502ed7a2cef16365ab7030a5a0588927bf47 ".circleci/config.yml")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/.circleci/config.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,8 +30,9 @@ jobs: |
|  |  | - golangci/install |
|  |  | - golangci/lint |
|  |  | - run: go install github.com/ory/go-acc github.com/mattn/goveralls |
|  |  | - run: go-acc -o coverage.txt ./... -- -failfast -timeout=20m |
|  |  | - run: test -z "$CIRCLE\_PR\_NUMBER" && goveralls -service=circle-ci -coverprofile=coverage.txt -repotoken=$COVERALLS\_REPO\_TOKEN || echo "forks are not allowed to push to coveralls" |
|  |  | - run: go-acc -o coverage.out ./... -- -failfast -timeout=20m |
|  |  | - run: | |
|  |  | bash <(curl -s https://codecov.io/bash) |
|  |  | - run: ./test/e2e/run.sh |
|  |  | - run: ./test/reload/run.sh |
|  |  |  |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52 "Makefile")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/Makefile)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,9 @@ define make-go-dependency |
|  |  | endef |
|  |  | $(foreach dep, $(GO\_DEPENDENCIES), $(eval $(call make-go-dependency, $(dep)))) |
|  |  |  |
|  |  | node\_modules: package.json package-lock.json |
|  |  | npm i |
|  |  |  |
|  |  | .bin/clidoc: go.mod |
|  |  | go build -o .bin/clidoc ./cmd/clidoc/. |
|  |  |  |
| Expand Down | |  |

262 changes: 125 additions & 137 deletions

262
[docs/docs/CHANGELOG.md](#diff-37d9e82f64b79f4e2cf320e4872ddb76080280b447541220fbed7c6ecd8aef26 "docs/docs/CHANGELOG.md")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/docs/docs/CHANGELOG.md)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

4 changes: 4 additions & 0 deletions

4
[docs/docs/pipeline/authn.md](#diff-773ad8e1a13dacaf1954a142de4b40f029594095dd11d51b20e411142b089769 "docs/docs/pipeline/authn.md")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/docs/docs/pipeline/authn.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -622,6 +622,10 @@ was granted the requested scope. |
|  |  | - `ttl` (string) - Can override the default behaviour of using the token exp |
|  |  | time, and specify a set time to live for the token in the cache. |
|  |  |  |
|  |  | Please note that caching will not be used if the scope strategy is `none` and |
|  |  | `required\_scope` is not empty. In that case, the configured introspection URL |
|  |  | will always be called and is expected to check if the scope is valid or not. |
|  |  |  |
|  |  | ```yaml |
|  |  | # Global configuration file oathkeeper.yml |
|  |  | authenticators: |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[driver/configuration/provider.go](#diff-6d27005f7b6bab036dbd341bd75084437e9a78b4a204c9b29d8f216917e0d791 "driver/configuration/provider.go")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/driver/configuration/provider.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ import ( |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/gobuffalo/packr/v2" |
|  |  |  |
|  |  | "github.com/ory/fosite" |
|  |  | "github.com/ory/x/tracing" |
|  |  |  |
| Expand Down | |  |

114 changes: 68 additions & 46 deletions

114
[pipeline/authn/authenticator\_oauth2\_introspection.go](#diff-5c8061290da17d352a4b888e5270cdd071ea584cd4751011132d8cccd69594f0 "pipeline/authn/authenticator_oauth2_introspection.go")

Show comments

[View file](/ory/oathkeeper/blob/1f9f625c1a49e134ae2299ee95b8cf158feec932/pipeline/authn/authenticator_oauth2_introspection.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,6 +11,8 @@ import ( |
|  |  | "sync" |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/ory/fosite" |
|  |  |  |
|  |  | "github.com/dgraph-io/ristretto" |
|  |  |  |
|  |  | "github.com/opentracing/opentracing-go" |
| Expand Down  Expand Up | | @@ -94,31 +96,37 @@ type AuthenticatorOAuth2IntrospectionResult struct { |
|  |  | TokenUse string `json:"token\_use"` |
|  |  | } |
|  |  |  |
|  |  | func (a \*AuthenticatorOAuth2Introspection) tokenFromCache(config \*AuthenticatorOAuth2IntrospectionConfiguration, token string) (\*AuthenticatorOAuth2IntrospectionResult, bool) { |
|  |  | func (a \*AuthenticatorOAuth2Introspection) tokenFromCache(config \*AuthenticatorOAuth2IntrospectionConfiguration, token string, ss fosite.ScopeStrategy) \*AuthenticatorOAuth2IntrospectionResult { |
|  |  | if !config.Cache.Enabled { |
|  |  | return nil, false |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | if ss == nil && len(config.Scopes) > 0 { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | item, found := a.tokenCache.Get(token) |
|  |  | if !found { |
|  |  | return nil, false |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | i := item.(\*AuthenticatorOAuth2IntrospectionResult) |
|  |  | expires := time.Unix(i.Expires, 0) |
|  |  | if expires.Before(time.Now()) { |
|  |  | a.tokenCache.Del(token) |
|  |  | return nil, false |
|  |  | i, ok := item.(\*AuthenticatorOAuth2IntrospectionResult) |
|  |  | if !ok { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | return i, true |
|  |  | return i |
|  |  | } |
|  |  |  |
|  |  | func (a \*AuthenticatorOAuth2Introspection) tokenToCache(config \*AuthenticatorOAuth2IntrospectionConfiguration, i \*AuthenticatorOAuth2IntrospectionResult, token string) { |
|  |  | func (a \*AuthenticatorOAuth2Introspection) tokenToCache(config \*AuthenticatorOAuth2IntrospectionConfiguration, i \*AuthenticatorOAuth2IntrospectionResult, token string, ss fosite.ScopeStrategy) { |
|  |  | if !config.Cache.Enabled { |
|  |  | return |
|  |  | } |
|  |  |  |
|  |  | if ss == nil && len(config.Scopes) > 0 { |
|  |  | return |
|  |  | } |
|  |  |  |
|  |  | if a.cacheTTL != nil { |
|  |  | a.tokenCache.SetWithTTL(token, i, 1, \*a.cacheTTL) |
|  |  | } else { |
| Expand All | | @@ -145,7 +153,7 @@ func (a \*AuthenticatorOAuth2Introspection) traceRequest(ctx context.Context, req |
|  |  | ext.HTTPUrl.Set(clientSpan, urlStr) |
|  |  | ext.HTTPMethod.Set(clientSpan, req.Method) |
|  |  |  |
|  |  | tracer.Inject(clientSpan.Context(), opentracing.HTTPHeaders, opentracing.HTTPHeadersCarrier(req.Header)) |
|  |  | \_ = tracer.Inject(clientSpan.Context(), opentracing.HTTPHeaders, opentracing.HTTPHeadersCarrier(req.Header)) |
|  |  | return clientSpan.Finish |
|  |  | } |
|  |  |  |
| Expand All | | @@ -160,12 +168,14 @@ func (a \*AuthenticatorOAuth2Introspection) Authenticate(r \*http.Request, session |
|  |  | return errors.WithStack(ErrAuthenticatorNotResponsible) |
|  |  | } |
|  |  |  |
|  |  | ss := a.c.ToScopeStrategy(cf.ScopeStrategy, "authenticators.oauth2\_introspection.scope\_strategy") |
|  |  | ss := a.c.ToScopeStrategy(cf.ScopeStrategy, "authenticators.oauth2\_introspection.config.scope\_strategy") |
|  |  |  |
|  |  | i, ok := a.tokenFromCache(cf, token) |
|  |  | if !ok { |
|  |  | body := url.Values{"token": {token}} |
|  |  | i := a.tokenFromCache(cf, token, ss) |
|  |  |  |
|  |  | // If the token can not be found, and the scope strategy is nil, and the required scope list |
|  |  | // is not empty, then we can not use the cache. |
|  |  | if i == nil { |
|  |  | body := url.Values{"token": {token}} |
|  |  | if ss == nil { |
|  |  | body.Add("scope", strings.Join(cf.Scopes, " ")) |
|  |  | } |
| Expand All | | @@ -174,6 +184,7 @@ func (a \*AuthenticatorOAuth2Introspection) Authenticate(r \*http.Request, session |
|  |  | if err != nil { |
|  |  | return errors.WithStack(err) |
|  |  | } |
|  |  |  |
|  |  | for key, value := range cf.IntrospectionRequestHeaders { |
|  |  | introspectReq.Header.Set(key, value) |
|  |  | } |
| Expand All | | @@ -199,48 +210,52 @@ func (a \*AuthenticatorOAuth2Introspection) Authenticate(r \*http.Request, session |
|  |  | if err := json.NewDecoder(resp.Body).Decode(&i); err != nil { |
|  |  | return errors.WithStack(err) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if len(i.TokenUse) > 0 && i.TokenUse != "access\_token" { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Use of introspected token is not an access token but \"%s\"", i.TokenUse))) |
|  |  | } |
|  |  | if len(i.TokenUse) > 0 && i.TokenUse != "access\_token" { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Use of introspected token is not an access token but \"%s\"", i.TokenUse))) |
|  |  | } |
|  |  |  |
|  |  | if !i.Active { |
|  |  | return errors.WithStack(helper.ErrUnauthorized.WithReason("Access token i says token is not active")) |
|  |  | } |
|  |  | if !i.Active { |
|  |  | return errors.WithStack(helper.ErrUnauthorized.WithReason("Access token is not active")) |
|  |  | } |
|  |  |  |
|  |  | for \_, audience := range cf.Audience { |
|  |  | if !stringslice.Has(i.Audience, audience) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Token audience is not intended for target audience %s", audience))) |
|  |  | } |
|  |  | if i.Expires > 0 && time.Unix(i.Expires, 0).Before(time.Now()) { |
|  |  | return errors.WithStack(helper.ErrUnauthorized.WithReason("Access token expired")) |
|  |  | } |
|  |  |  |
|  |  | for \_, audience := range cf.Audience { |
|  |  | if !stringslice.Has(i.Audience, audience) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Token audience is not intended for target audience %s", audience))) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if len(cf.Issuers) > 0 { |
|  |  | if !stringslice.Has(cf.Issuers, i.Issuer) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Token issuer does not match any trusted issuer"))) |
|  |  | } |
|  |  | if len(cf.Issuers) > 0 { |
|  |  | if !stringslice.Has(cf.Issuers, i.Issuer) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Token issuer does not match any trusted issuer"))) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if ss != nil { |
|  |  | for \_, scope := range cf.Scopes { |
|  |  | if !ss(strings.Split(i.Scope, " "), scope) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Scope %s was not granted", scope))) |
|  |  | } |
|  |  | if ss != nil { |
|  |  | for \_, scope := range cf.Scopes { |
|  |  | if !ss(strings.Split(i.Scope, " "), scope) { |
|  |  | return errors.WithStack(helper.ErrForbidden.WithReason(fmt.Sprintf("Scope %s was not granted", scope))) |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if len(i.Extra) == 0 { |
|  |  | i.Extra = map[string]interface{}{} |
|  |  | } |
|  |  | a.tokenToCache(cf, i, token, ss) |
|  |  |  |
|  |  | i.Extra["username"] = i.Username |
|  |  | i.Extra["client\_id"] = i.ClientID |
|  |  | i.Extra["scope"] = i.Scope |
|  |  | if len(i.Extra) == 0 { |
|  |  | i.Extra = map[string]interface{}{} |
|  |  | } |
|  |  |  |
|  |  | if len(i.Audience) != 0 { |
|  |  | i.Extra["aud"] = i.Audience |
|  |  | } |
|  |  | i.Extra["username"] = i.Username |
|  |  | i.Extra["client\_id"] = i.ClientID |
|  |  | i.Extra["scope"] = i.Scope |
|  |  |  |
|  |  | a.tokenToCache(cf, i, token) |
|  |  | if len(i.Audience) != 0 { |
|  |  | i.Extra["aud"] = i.Audience |
|  |  | } |
|  |  |  |
|  |  | session.Subject = i.Subject |
| Expand Down  Expand Up | | @@ -324,15 +339,22 @@ func (a \*AuthenticatorOAuth2Introspection) Config(config json.RawMessage) (\*Auth |
|  |  | } |
|  |  |  |
|  |  | if a.tokenCache == nil { |
|  |  | cost := int64(c.Cache.MaxCost) |
|  |  | if cost == 0 { |
|  |  | cost = 100000000 |
|  |  | } |
|  |  | a.logger.Debugf("Creating cache with max cost: %d", c.Cache.MaxCost) |
|  |  | cache, \_ := ristretto.NewCache(&ristretto.Config{ |
|  |  | cache, err := ristretto.NewCache(&ristretto.Config{ |
|  |  | // This will hold about 1000 unique mutation responses. |
|  |  | NumCounters: 10000, |
|  |  | // Allocate a max |
|  |  | MaxCost: int64(c.Cache.MaxCost), |
|  |  | MaxCost: cost, |
|  |  | // This is a best-practice value. |
|  |  | BufferItems: 64, |
|  |  | }) |
|  |  | if err != nil { |
|  |  | return nil, nil, err |
|  |  | } |
|  |  |  |
|  |  | a.tokenCache = cache |
|  |  | } |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1f9f625`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fcommit%2F1f9f625c1a49e134ae2299ee95b8cf158feec932) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c8a782fa_20250115_085308.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fsecurity%2Fadvisories%2FGHSA-qvp4-rpmr-xwrr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fsecurity%2Fadvisories%2FGHSA-qvp4-rpmr-xwrr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ory%2Foathkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ory](/ory)
/
**[oathkeeper](/ory/oathkeeper)**
Public

* [Notifications](/login?return_to=%2Fory%2Foathkeeper) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fory%2Foathkeeper)
* [Star
   3.3k](/login?return_to=%2Fory%2Foathkeeper)

* [Code](/ory/oathkeeper)
* [Issues
  57](/ory/oathkeeper/issues)
* [Pull requests
  24](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

Additional navigation options

* [Code](/ory/oathkeeper)
* [Issues](/ory/oathkeeper/issues)
* [Pull requests](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

# Possible bypass of token claim validation when OAuth2 Introspection caching is enabled

High

[aeneasr](/aeneasr)
published
GHSA-qvp4-rpmr-xwrr
Jun 22, 2021

## Package

No package listed

## Affected versions

>=v0.38.0-beta.2 <=v0.38.11-beta.1

## Patched versions

v0.38.12-beta.1

## Description

### Impact

When you make a request to an endpoint that requires the scope `foo` using an access token granted with that `foo` scope, introspection will be valid and that token will be cached. The problem comes when a second requests to an endpoint that requires the scope `bar` is made before the cache has expired. Whether the token is granted or not to the `bar` scope, introspection will be valid.

### Patches

A patch will be released with `v0.38.12-beta.1`.

### Workarounds

Per default, caching is disabled for the `oauth2_introspection` authenticator. When caching is disabled, this vulnerability does not exist.

### Trace

The cache is checked in [`func (a *AuthenticatorOAuth2Introspection) Authenticate(...)`](https://github.com/ory/oathkeeper/blob/6a31df1c3779425e05db1c2a381166b087cb29a4/pipeline/authn/authenticator_oauth2_introspection.go#L152). From [`tokenFromCache()`](https://github.com/ory/oathkeeper/blob/6a31df1c3779425e05db1c2a381166b087cb29a4/pipeline/authn/authenticator_oauth2_introspection.go#L97) it seems that it only validates the token expiration date, but ignores whether the token has or not the proper scopes.

### Post-Mortem

The vulnerability was introduced in PR [#424](https://github.com/ory/oathkeeper/pull/424). During review, we failed to require appropriate test coverage by the submitter which is the primary reason that the vulnerability passed the review process.

To avoid this from happening again we enabled codecov with a strict policy on the Ory Oathkeeper repository: Without an increase in code coverage the PR can not be merged.

To address this issue and any regressions we have added a test suite ensuring that the cache behaviour is correct in the different scenarios:

* Scope strategy is `none`, cache is enabled, and `requested_scope` is not empty -> cache will not be used;
* Scope strategy is `none`, cache is enabled, and `requested_scope` is empty -> cache will be used;
* Scope strategy is not `none`, cache is enabled, and `requested_scope` is not empty -> cache will be used;

as well as validating if `iss`, `aud`, `exp`, `token_use`, and scope are validated.

Additionally, we added [CodeQL scanning](https://github.com/ory/oathkeeper/commit/64ac7562669287d391cd72dfd43c5d71ff9f89a1) to the CI.

### Severity

High

### CVE ID

CVE-2021-32701

### Weaknesses

[CWE-863](/advisories?query=cwe%3A863)

### Credits

* [![@flusflas](https://avatars.githubusercontent.com/u/3756394?s=40&v=4)](/flusflas)
  [flusflas](/flusflas)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e72bf4a9_20250115_085306.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fpull%2F424)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fpull%2F424)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ory%2Foathkeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ory](/ory)
/
**[oathkeeper](/ory/oathkeeper)**
Public

* [Notifications](/login?return_to=%2Fory%2Foathkeeper) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fory%2Foathkeeper)
* [Star
   3.3k](/login?return_to=%2Fory%2Foathkeeper)

* [Code](/ory/oathkeeper)
* [Issues
  57](/ory/oathkeeper/issues)
* [Pull requests
  24](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

Additional navigation options

* [Code](/ory/oathkeeper)
* [Issues](/ory/oathkeeper/issues)
* [Pull requests](/ory/oathkeeper/pulls)
* [Discussions](/ory/oathkeeper/discussions)
* [Actions](/ory/oathkeeper/actions)
* [Security](/ory/oathkeeper/security)
* [Insights](/ory/oathkeeper/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fory%2Foathkeeper%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fory%2Foathkeeper%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# feat: cache incoming oauth introspect tokens #424

 Merged

[aeneasr](/aeneasr)
merged 7 commits into
[ory:master](/ory/oathkeeper/tree/master "ory/oathkeeper:master")
from
[pike1212:feature/oauthIntrospectCache](/pike1212/oathkeeper/tree/feature/oauthIntrospectCache "pike1212/oathkeeper:feature/oauthIntrospectCache")

May 7, 2020

 Merged

# [feat: cache incoming oauth introspect tokens](#top) #424

[aeneasr](/aeneasr)
merged 7 commits into
[ory:master](/ory/oathkeeper/tree/master "ory/oathkeeper:master")
from
[pike1212:feature/oauthIntrospectCache](/pike1212/oathkeeper/tree/feature/oauthIntrospectCache "pike1212/oathkeeper:feature/oauthIntrospectCache")

May 7, 2020

+143

−54

[Conversation
4](/ory/oathkeeper/pull/424)
[Commits
7](/ory/oathkeeper/pull/424/commits)
[Checks
0](/ory/oathkeeper/pull/424/checks)
[Files changed
5](/ory/oathkeeper/pull/424/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![pike1212](https://avatars.githubusercontent.com/u/11857406?s=60&v=4)](/pike1212)

Copy link

Contributor

### @pike1212 **[pike1212](/pike1212)** commented [Apr 29, 2020](#issue-609063962)

## Related issue

[#293](https://github.com/ory/oathkeeper/issues/293)

## Proposed changes

Adds ability to cache incoming oauth tokens in the introspector. By default will use the expires time from the token introspect endpoint to determine when to evict, or can override with a set TTL.

## Checklist

* I have read the [contributing guidelines](../blob/master/CONTRIBUTING.md).
* I have read the [security policy](../security/policy).
* I confirm that this pull request does not address a security

  vulnerability. If this pull request addresses a security. vulnerability, I

  confirm that I got green light (please contact

  security@ory.sh) from the maintainers to push

  the changes.
* I have added tests that prove my fix is effective or that my feature

  works.
* I have added or changed [the documentation](docs/docs).

Sorry, something went wrong.

All reactions

 [pike1212](/pike1212)
and others
added 5 commits
[April 29, 2020 09:16](#commits-pushed-b04aea2)

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=40&v=4)](/pike1212)

`[adds caching of incoming tokens in oauth introspector](/ory/oathkeeper/pull/424/commits/b04aea2f8c5eeadf3f7644db084fed231640146d "adds caching of incoming tokens in oauth introspector")`

`[b04aea2](/ory/oathkeeper/pull/424/commits/b04aea2f8c5eeadf3f7644db084fed231640146d)`

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=40&v=4)](/pike1212)

`[document oauth intrspect cache settings](/ory/oathkeeper/pull/424/commits/6325ebdba7c56023e2dc0d0b752a0a129d909b9f "document oauth intrspect cache settings")`

`[6325ebd](/ory/oathkeeper/pull/424/commits/6325ebdba7c56023e2dc0d0b752a0a129d909b9f)`

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=40&v=4)](/pike1212)

`[fix introspect test](/ory/oathkeeper/pull/424/commits/ce3c6ab963c23e42631ef897f2d02dd8d6414d4b "fix introspect test")`

`[ce3c6ab](/ory/oathkeeper/pull/424/commits/ce3c6ab963c23e42631ef897f2d02dd8d6414d4b)`

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=40&v=4)](/pike1212)

`[Merge branch 'feature/oauthIntrospectCache' of](/ory/oathkeeper/pull/424/commits/14dc291ccf3af4b6f8ecfb5e128971f92cbd6b23 "Merge branch 'feature/oauthIntrospectCache' of https://github.com/pike1212/oathkeeper into feature/oauthIntrospectCache") [https://github.com/pik…](https://github.com/pike1212/oathkeeper)`
 …

`[14dc291](/ory/oathkeeper/pull/424/commits/14dc291ccf3af4b6f8ecfb5e128971f92cbd6b23)`

```
[…e1212/oathkeeper](https://github.com/pike1212/oathkeeper) into feature/oauthIntrospectCache
```

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=40&v=4)](/pike1212)

`[validate token before putting into cache](/ory/oathkeeper/pull/424/commits/b891df0d6da7911f3d2b914d759cf104f41f98e5 "validate token before putting into cache")`

`[b891df0](/ory/oathkeeper/pull/424/commits/b891df0d6da7911f3d2b914d759cf104f41f98e5)`

[![aeneasr](https://avatars.githubusercontent.com/u/3372410?s=60&v=4)](/aeneasr)

**[aeneasr](/aeneasr)**
reviewed
[May 7, 2020](#pullrequestreview-407281973)

 [View reviewed changes](/ory/oathkeeper/pull/424/files/b891df0d6da7911f3d2b914d759cf104f41f98e5)

[.schema/config.schema.json](/ory/oathkeeper/pull/424/files/b891df0d6da7911f3d2b914d759cf104f41f98e5#diff-35e2b3e83fa7b5829f843cfdb7fa6aca8606f2f47f905260610227d2c9f1f9f2)
Outdated

Show resolved

Hide resolved

[.schema/config.schema.json](/ory/oathkeeper/pull/424/files/b891df0d6da7911f3d2b914d759cf104f41f98e5#diff-35e2b3e83fa7b5829f843cfdb7fa6aca8606f2f47f905260610227d2c9f1f9f2)

Show resolved

Hide resolved

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=40&v=4)](/aeneasr)

`[Apply suggestions from code review](/ory/oathkeeper/pull/424/commits/70e1690787f0a63c85b84be859c34962a62cf190 "Apply suggestions from code review")`

`[70e1690](/ory/oathkeeper/pull/424/commits/70e1690787f0a63c85b84be859c34962a62cf190)`

[![aeneasr](https://avatars.githubusercontent.com/u/3372410?s=60&v=4)](/aeneasr)

**[aeneasr](/aeneasr)**
reviewed
[May 7, 2020](#pullrequestreview-407283569)

 [View reviewed changes](/ory/oathkeeper/pull/424/files/70e1690787f0a63c85b84be859c34962a62cf190)

[.schema/config.schema.json](/ory/oathkeeper/pull/424/files/70e1690787f0a63c85b84be859c34962a62cf190#diff-35e2b3e83fa7b5829f843cfdb7fa6aca8606f2f47f905260610227d2c9f1f9f2)
Outdated

Show resolved

Hide resolved

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=40&v=4)](/aeneasr)

`[Update .schema/config.schema.json](/ory/oathkeeper/pull/424/commits/c734d76e52df1e8aa4e81865486ca5ebbf45ed71 "Update .schema/config.schema.json")`

`[c734d76](/ory/oathkeeper/pull/424/commits/c734d76e52df1e8aa4e81865486ca5ebbf45ed71)`

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=40&u=b48e7114015223887f823fa1413f2b6b1e9b95ae&v=4)](/aeneasr)
[aeneasr](/aeneasr)
merged commit [`d4557ae`](/ory/oathkeeper/commit/d4557aeac69e84d36dfc2a1ab97c61188c93457f)
into
ory:master

[May 7, 2020](https://github.com/ory/oathkeeper/pull/424#event-3312009989)

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=80&u=b48e7114015223887f823fa1413f2b6b1e9b95ae&v=4)](/aeneasr)

Copy link

Member

### **[aeneasr](/aeneasr)** commented [May 7, 2020](#issuecomment-625137921)

| Awesome 🎉  Thank you for your contribution! |
| --- |

All reactions

Sorry, something went wrong.

[![@ptescher](https://avatars.githubusercontent.com/u/182580?s=40&v=4)](/ptescher)
[ptescher](/ptescher)
mentioned this pull request
[Jul 15, 2020](#ref-pullrequest-657456642)

[feat: Cache OAuth2 introspection client
#482](/ory/oathkeeper/pull/482)
 Closed

5 tasks

[![@mend-for-github-com](https://avatars.githubusercontent.com/in/30796?s=40&v=4)](/apps/mend-for-github-com)
[mend-for-github-com](/apps/mend-for-github-com)
bot
mentioned this pull request
[Jan 9, 2023](#ref-issue-1525031379)

[CVE-2021-32701 (High) detected in github.com/ory/oathkeeper/pipeline-eb53de71bfdc0bc10448220fda211321b054d811, github.com/ory/oathkeeper/pipeline/authn-eb53de71bfdc0bc10448220fda211321b054d811
MValle21/oathkeeper#113](/MValle21/oathkeeper/issues/113)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Foathkeeper%2Fpull%2F424)

Reviewers

[![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=40&v=4)](/aeneasr) [aeneasr](/aeneasr)

aeneasr left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@pike1212](https://avatars.githubusercontent.com/u/11857406?s=52&v=4)](/pike1212) [![@aeneasr](https://avatars.githubusercontent.com/u/3372410?s=52&v=4)](/aeneasr)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


