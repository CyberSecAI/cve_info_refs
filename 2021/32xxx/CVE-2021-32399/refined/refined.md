```
{
  "CVE-2021-32399": [
    {
      "Root cause of vulnerability": "Race condition between issuing a command to the Bluetooth controller and unregistering the Bluetooth controller, specifically within the hci_req_sync() and hci_dev_do_close() functions.",
      "Weaknesses/vulnerabilities present": "Use-after-free (UAF) due to a race condition.",
      "Impact of exploitation": "At worst, this bug can be exploited to get code execution for escalating local privilege. The vulnerability can also lead to a kernel crash, memory corruption, and potential arbitrary memory write or RIP hijacking through heap spraying.",
      "Attack vectors": "The race condition can be triggered by closing the Bluetooth device while commands are being issued to it. This can be achieved using:\n\n1.  Virtual HCI driver (vhci) requiring root privilege.\n2.  Fake HCI TTY device using ptmx (requires CAP_NET_ADMIN).\n3.  Real Bluetooth devices (no privilege required).",
      "Required attacker capabilities/position": "An attacker needs to be able to trigger the race condition, which can be done locally. For the second attack vector (ptmx) the attacker also needs `CAP_NET_ADMIN` privilege. The third attack vector does not require any special privileges."
    },
    {
      "Root cause of vulnerability": "A race condition exists in the Linux kernel's Bluetooth subsystem between the hci_req_sync() and hci_dev_do_close() functions.",
      "Weaknesses/vulnerabilities present": "A use-after-free (UAF) vulnerability due to the race condition.",
      "Impact of exploitation": "A local attacker can exploit this vulnerability to cause a denial of service (crash or memory corruption) or possibly for privilege escalation.",
        "Attack vectors": "Local user can cause a race condition by issuing a HCI command and removing the HCI controller.",
      "Required attacker capabilities/position": "Local user, with different ways to trigger."
    },
    {
      "Root cause of vulnerability": "Race condition between device closing and command issuing in the Linux kernel Bluetooth subsystem.",
        "Weaknesses/vulnerabilities present": "Use-after-free (UAF) or double-free in the Bluetooth subsystem.",
        "Impact of exploitation": "Local users could cause a denial of service (crash or memory corruption), and potentially privilege escalation.",
        "Attack vectors": "A local user can exploit the race condition when closing a device and issuing commands.",
        "Required attacker capabilities/position": "Local user."
    },
        {
      "Root cause of vulnerability": "The race condition vulnerability resides in the Linux kernel BlueTooth subsystem, which can lead to UAF of slab objects.",
      "Weaknesses/vulnerabilities present": "Race condition in the Bluetooth subsystem that can lead to use-after-free or double-free.",
      "Impact of exploitation": "Exploitation can result in a denial of service (crash or memory corruption) or potentially privilege escalation.",
      "Attack vectors": "A local user can exploit these to cause a denial of service (crash or memory corruption) or possibly for privilege escalation.",
      "Required attacker capabilities/position": "A local user with the ability to close and issue commands to the Bluetooth device."
    }
  ]
}
```