=== Content from talosintelligence.com_8fe1df92_20250114_222031.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

√ó

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2021-1231

## Trend Micro Inc. Home Network Security tdts.ko chrdev\_ioctl\_handle privilege escalation vulnerability

##### May 24, 2021

##### CVE Number

CVE-2021-32458

### Summary

A privilege escalation vulnerability exists in the tdts.ko chrdev\_ioctl\_handle functionality of Trend Micro, Inc. Home Network Security 6.1.567. A specially crafted ioctl can lead to code execution. An attacker can issue an ioctl to trigger this vulnerability.

### Tested Versions

Trend Micro, Inc. Home Network Security 6.1.567

### Product URLs

<https://www.trendmicro.com/en_us/forHome/products/homenetworksecurity.html>

### CVSSv3 Score

7.8 - CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CWE

CWE-121 - Stack-based Buffer Overflow

### Details

The Home Network Security Station is a device used to monitor and protect home networks from security threats as well as offer simple network management features. The Station provides vulnerability scanning, web threat protection, intrusion prevention, as well as device-based access control for all devices on a home network.

This vulnerability is caused by the lack of input validation on a user‚Äôs `ioctl` request from user land. The upper 16 bits from the ioctl request (AND with 0x3FFF, so 14 bits total) are blindly used as input to `__copy_from_user` to a stack-based buffer in kernel space. The stack-based buffer is smaller than the maximum ioctl request copy size of 0x3FFF and thus overflows. A user can carefully craft input such that they could get control over PC within due to this copy.

```
chrdev_ioctl_handle:
0000074c  10402de9   push    {r4, lr} {__saved_lr} {__saved_r4}
00000750  5034e7e7   ubfx    r3, r0, #0x8, #0x8
00000754  be0053e3   cmp     r3, #0xbe
00000758  1800e013   mvnne   r0, #0x18  {0xffffffe7}
0000075c  38d04de2   sub     sp, sp, #0x38
00000760  2900001a   bne     0x80c

// Check that the bits 8-15 are 0xbe in the IOCTL request
00000764  ff0010e3   tst     r0, #0xff
00000768  1500e003   mvneq   r0, #0x15  {0xffffffea}
0000076c  2600000a   beq     0x80c

00000770  0d20a0e1   mov     r2, sp {var_40}
00000774  000050e3   cmp     r0, #0
00000778  7f3dc2e3   bic     r3, r2, #0x1fc0 {var_40}
 // Extract the size of the buffer encoded in the IOCTL request
0000077c  5028ede7   ubfx    r2, r0, #0x10, #0xe
00000780  3f30c3e3   bic     r3, r3, #0x3f
00000784  380000ba   blt     0x86c

// Sanity checks to make sure that the encoded size is not negative
0000086c  084093e5   ldr     r4, [r3,  #0x8]
00000870  020091e0   add.s   r0, r1, r2
00000874  0400d030   sbc.slo r0, r0, r4
00000878  0040a033   movlo   r4, #0
0000087c  000054e3   cmp     r4, #0
00000880  c3ffff0a   beq     0x794

00000794  083093e5   ldr     r3, [r3,  #0x8]
00000798  020091e0   add.s   r0, r1, r2
0000079c  0300d030   sbc.slo r0, r0, r3
000007a0  0030a033   movlo   r3, #0
000007a4  000053e3   cmp     r3, #0
000007a8  2a00000a   beq     0x858

// Vulnerable __copy_from_user with user provided length and set size stack-buffer
00000858  0d00a0e1   mov     r0, sp {var_40}
0000085c  bb6901eb   bl      __copy_from_user

```
### Crash Information

```
vmalloc: allocation failure: 1094795585 bytes
poc: page allocation failure: order:0, mode:0xd2
CPU: 0 PID: 1878 Comm: poc Tainted: P           O 3.10.70 #2
[<80014774>] (unwindbacktrace+0x0/0xec) from [<80011a2c>] (showstack+0x10/0x14)
[<80011a2c>] (showstack+0x10/0x14) from [<80089ba0>] (warnallocfailed+0xe4/0x11c)
[<80089ba0>] (warnallocfailed+0xe4/0x11c) from [<800af704>] (vmallocnoderange+0x14c/0x220)
[<800af704>] (vmallocnoderange+0x14c/0x220) from [<800afa8c>] (vmalloc+0x58/0x60)
[<800afa8c>] (vmalloc+0x58/0x60) from [<7f000b68>] (tdtsshellioctlsig+0xa8/0xf54 [tdts])
[<7f000b68>] (tdtsshellioctlsig+0xa8/0xf54 [tdts]) from [<7f000854>] (chrdevrelease+0x110/0x164 [tdts])
[<7f000854>] (chrdevrelease+0x110/0x164 [tdts]) from [<41414141>] (0x41414141)
Mem-info:
Normal per-cpu:
CPU    0: hi:   90, btch:  15 usd:  63
activeanon:1483 inactiveanon:136 isolatedanon:0
 activefile:2696 inactivefile:10865 isolatedfile:0
 unevictable:0 dirty:14 writeback:0 unstable:0
 free:35763 slabreclaimable:335 slabunreclaimable:1622
 mapped:1445 shmem:145 pagetables:122 bounce:0
 freecma:0
Normal free:143052kB min:2016kB low:2520kB high:3024kB activeanon:5932kB inactiveanon:544kB activefile:10784kB inactivefile:43460kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:262144kB managed:254312kB mlocked:0kB dirty:56kB writeback:0kB mapped:5780kB shmem:580kB slabreclaimable:1340kB slabunreclaimable:6488kB kernelstack:512kB pagetables:488kB unstable:0kB bounce:0kB freecma:0kB writebacktmp:0kB pagesscanned:0 allunreclaimable? no
lowmemreserve[]: 0 0
Normal: 454kB (UM) 278kB (UEM) 816kB (UM) 432kB (U) 164kB (M) 2128kB (EM) 1256kB (M) 3512kB (UEM) 11024kB (U) 22048kB (UE) 334096kB (UMR) = 143052kB
13706 total pagecache pages
0 pages in swap cache
Swap cache stats: add 0, delete 0, find 0/0
Free swap  = 0kB
Total swap = 0kB
65536 pages of RAM
35996 free pages
1906 reserved pages
1785 slab pages
268512 pages shared
0 pages swap cached
  ERROR: [tdtsshellioctlsigopgetbndwthdb:854] Cannot malloc container 1094795585 bytes
Unable to handle kernel paging request at virtual address 41414140
pgd = 8ada0000
[41414140] pgd=00000000
Internal error: Oops: 80000005 [#1] SMP ARM
Modules linked in: kmdiamond(O) tdtsudb(PO) tdts(PO)
CPU: 0 PID: 1878 Comm: poc Tainted: P           O 3.10.70 #2
task: 8f99fa40 ti: 8f248000 task.ti: 8f248000
PC is at 0x41414140
LR is at 0x41414141
pc : [<41414140>]    lr : [<41414141>]    psr: 60000033
sp : 8f249f28  ip : 00000000  fp : 7efffc34
r10: 00000000  r9 : 8f248000  r8 : 8ada6300
r7 : 00000003  r6 : 8ada6300  r5 : 7effbc18  r4 : 41414141
r3 : 8052647c  r2 : 8052647c  r1 : 20000093  r0 : fffffff4
Flags: nZCv  IRQs on  FIQs on  Mode SVC32  ISA Thumb  Segment user
Control: 10c53c7d  Table: 6ada006a  DAC: 00000015
Process poc (pid: 1878, stack limit = 0x8f248238)
Stack: (0x8f249f28 to 0x8f24a000)
9f20:                   41414141 41414141 41414141 41414141 41414141 41414141
9f40: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
9f60: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
9f80: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
9fa0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
9fc0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
9fe0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Code: bad PC value
---[ end trace 1e20ae6e53da58f1 ]---
Dec  2 20:24:17 Diamond user.warn kernel: vmalloc: allocation failure: 1094795585 bytes
Dec  2 20:24:17 Diamond user.warn kernel: poc: page allocation failure: order:0, mode:0xd2
Dec  2 20:24:17 Diamond user.warn kernel: CPU: 0 PID: 1878 Comm: poc Tainted: P           O 3.10.70 #2
Dec  2 20:24:17 Diamond user.warn kernel: [<80014774>] (unwindbacktrace+0x0/0xec) from [<80011a2c>] (showstack+0x10/0x14)
Dec  2 20:24:17 Diamond user.warn kernel: [<80011a2c>] (showstack+0x10/0x14) from [<80089ba0>] (warnallocfailed+0xe4/0x11c)
Dec  2 20:24:17 Diamond user.warn kernel: [<80089ba0>] (warnallocfailed+0xe4/0x11c) from [<800af704>] (vmallocnoderange+0x14c/0x220)
Dec  2 20:24:17 Diamond user.warn kernel: [<800af704>] (vmallocnoderange+0x14c/0x220) from [<800afa8c>] (vmalloc+0x58/0x60)
Dec  2 20:24:17 Diamond user.warn kernel: [<800afa8c>] (vmalloc+0x58/0x60) from [<7f000b68>] (tdtsshellioctlsig+0xa8/0xf54 [tdts])
Dec  2 20:24:17 Diamond user.warn kernel: [<7f000b68>] (tdtsshellioctlsig+0xa8/0xf54 [tdts]) from [<7f000854>] (chrdevrelease+0x110/0x164 [tdts])
Dec  2 20:24:17 Diamond user.warn kernel: [<7f000854>] (chrdevrelease+0x110/0x164 [tdts]) from [<41414141>] (0x41414141)
Dec  2 20:24:17 Diamond user.warn kernel: Mem-info:
Dec  2 20:24:17 Diamond user.warn kernel: Normal per-cpu:
Dec  2 20:24:17 Diamond user.warn kernel: CPU    0: hi:   90, btch:  15 usd:  63
Dec  2 20:24:17 Diamond user.warn kernel: activeanon:1483 inactiveanon:136 isolatedanon:0
Dec  2 20:24:17 Diamond user.warn kernel:  activefile:2696 inactivefile:10865 isolatedfile:0
Dec  2 20:24:17 Diamond user.warn kernel:  unevictable:0 dirty:14 writeback:0 unstable:0
Dec  2 20:24:17 Diamond user.warn kernel:  free:35763 slabreclaimable:335 slabunreclaimable:1622
Dec  2 20:24:17 Diamond user.warn kernel:  mapped:1445 shmem:145 pagetables:122 bounce:0
Dec  2 20:24:17 Diamond user.warn kernel:  freecma:0
Dec  2 20:24:17 Diamond user.warn kernel: Normal free:143052kB min:2016kB low:2520kB high:3024kB activeanon:5932kB inactiveanon:544kB activefile:10784kB inactivefile:43460kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:262144kB managed:254312kB mlo
Dec  2 20:24:17 Diamond user.warn kernel: lowmemreserve[]: 0 0
Dec  2 20:24:17 Diamond user.warn kernel: Normal: 454kB (UM) 278kB (UEM) 816kB (UM) 432kB (U) 164kB (M) 2128kB (EM) 1256kB (M) 3512kB (UEM) 11024kB (U) 22048kB (UE) 334096kB (UMR) = 143052kB
Dec  2 20:24:17 Diamond user.warn kernel: 13706 total pagecache pages
Dec  2 20:24:17 Diamond user.warn kernel: 0 pages in swap cache
Dec  2 20:24:17 Diamond user.warn kernel: Swap cache stats: add 0, delete 0, find 0/0
Dec  2 20:24:17 Diamond user.warn kernel: Free swap  = 0kB
Dec  2 20:24:17 Diamond user.warn kernel: Total swap = 0kB
Dec  2 20:24:17 Diamond user.warn kernel: 65536 pages of RAM
Dec  2 20:24:17 Diamond user.warn kernel: 35996 free pages
Dec  2 20:24:17 Diamond user.warn kernel: 1906 reserved pages
Dec  2 20:24:17 Diamond user.warn kernel: 1785 slab pages
Dec  2 20:24:17 Diamond user.warn kernel: 268512 pages shared
Dec  2 20:24:17 Diamond user.warn kernel: 0 pages swap cached
Dec  2 20:24:17 Diamond user.err kernel:   ERROR: [tdtsshellioctlsigopgetbndwthdb:854] Cannot malloc container 1094795585 bytes
Dec  2 20:24:17 Diamond user.alert kernel: Unable to handle kernel paging request at virtual address 41414140
Dec  2 20:24:17 Diamond user.alert kernel: pgd = 8ada0000
Dec  2 20:24:17 Diamond user.alert kernel: [41414140] pgd=00000000
Dec  2 20:24:17 Diamond user.emerg kernel: Internal error: Oops: 80000005 [#1] SMP ARM
Dec  2 20:24:17 Diamond user.warn kernel: Modules linked in: kmdiamond(O) tdtsudb(PO) tdts(PO)
Dec  2 20:24:17 Diamond user.warn kernel: CPU: 0 PID: 1878 Comm: poc Tainted: P           O 3.10.70 #2
Dec  2 20:24:17 Diamond user.warn kernel: task: 8f99fa40 ti: 8f248000 task.ti: 8f248000
Dec  2 20:24:17 Diamond user.warn kernel: PC is at 0x41414140
Dec  2 20:24:17 Diamond user.warn kernel: LR is at 0x41414141
Dec  2 20:24:17 Diamond user.warn kernel: pc : [<41414140>]    lr : [<41414141>]    psr: 60000033
Dec  2 20:24:17 Diamond user.warn kernel: sp : 8f249f28  ip : 00000000  fp : 7efffc34
Dec  2 20:24:17 Diamond user.warn kernel: r10: 00000000  r9 : 8f248000  r8 : 8ada6300
Dec  2 20:24:17 Diamond user.warn kernel: r7 : 00000003  r6 : 8ada6300  r5 : 7effbc18  r4 : 41414141
Dec  2 20:24:17 Diamond user.warn kernel: r3 : 8052647c  r2 : 8052647c  r1 : 20000093  r0 : fffffff4
Dec  2 20:24:17 Diamond user.warn kernel: Flags: nZCv  IRQs on  FIQs on  Mode SVC32  ISA Thumb  Segment user
Dec  2 20:24:17 Diamond user.warn kernel: Control: 10c53c7d  Table: 6ada006a  DAC: 00000015
Dec  2 20:24:17 Diamond user.emerg kernel: Process poc (pid: 1878, stack limit = 0x8f248238)
Dec  2 20:24:17 Diamond user.emerg kernel: Stack: (0x8f249f28 to 0x8f24a000)
Dec  2 20:24:17 Diamond user.emerg kernel: 9f20:                   41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9f40: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9f60: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9f80: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9fa0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9fc0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: 9fe0: 41414141 41414141 41414141 41414141 41414141 41414141 41414141 41414141
Dec  2 20:24:17 Diamond user.emerg kernel: Code: bad PC value
Dec  2 20:24:17 Diamond user.warn kernel: ---[ end trace 1e20ae6e53da58f1 ]---*

```
### Timeline

2021-01-22 - Vendor Disclosure

2021-04-06 - 75+ day follow up

2021-04-20 - Talos granted timeline extension for disclosure

2021-05-20 - Vendor Patched

2021-05-24 - Public Release

##### Credit

Discovered by Carl Hurd and Kelly Leuschner of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2021-1241](/vulnerability_reports/TALOS-2021-1241) [Previous Report

TALOS-2021-1230](/vulnerability_reports/TALOS-2021-1230)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

¬©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from helpcenter.trendmicro.com_10f1ddcc_20250114_222028.html ===


![web](https://content.powerapps.com/resource/powerappsportal/img/web.png)
You‚Äôre offline. This is a read only version of the page.
![close](https://content.powerapps.com/resource/powerappsportal/img/close.png)

##### **‚ö†Ô∏è ADVISORY ‚ö†Ô∏è**

If you see an `Unsupported Software` error message, don't worry! Just download and install the latest version for your Mac [here](/en-us/article/tmka-14372).

There might be a wait to talk to a Trend Micro Representative by phone. If it's busy, try [Live Chat](https://helpcenter.trendmicro.com/en-us/chat/) for quicker help.

[Looking for business support?](https://success.trendmicro.com/en-us/?utm_source=referral&utm_medium=ivr)

[![Trend Micro Help Center](/tm-logo.svg)](/)

[Help Center](/)

* [SIGN IN](/signin?user=external)
* Product Help
* [Account Help](/en-us/trend-micro-account/)
* [Download and Install](/en-us/install/)
* [Contact Us](/en-us/contact-support/)

* [SIGN IN](/signin?user=external "Signing in with your Trend Micro Account lets you see your subscriptions, conveniently contact us through chat and email and manage your submitted cases to Support.")
* Search

All Products
Premium Security
Maximum Security
Internet Security
Antivirus+ Security
Mobile Security for Android

Antivirus for Mac
Mobile Security for iOS
Dr. Cleaner
Password Manager
ID Security
VPN Proxy One Pro
Home Network Security
Security for Microsoft Edge

Security for Google Chrome

Cleaner One Pro
Antivirus One

What brings you here today?

* [‚ùå I Got "This feature is not available" Error in Mobile Security.](https://helpcenter.trendmicro.com/en-us/article/tmka-12371?utm_source=homepage&utm_medium=searchtopics)
* [üíª I Want to Add a New Device.](https://helpcenter.trendmicro.com/en-us/article/tmka-18528?utm_source=homepage&utm_medium=searchtopics)
* [üí≥ I want to change my credit card.](https://helpcenter.trendmicro.com/en-us/article/tmka-10289?utm_source=homepage&utm_medium=searchtopics)
* [üõë I want to turn off auto renewal.](https://helpcenter.trendmicro.com/en-us/article/tmka-10287?utm_source=homepage&utm_medium=searchtopics)
* [‚ûï I want to renew my Trend Micro.](https://helpcenter.trendmicro.com/en-us/article/tmka-10288?utm_source=homepage&utm_medium=searchtopics)
* [üì• I need help installing my Trend Micro.](https://helpcenter.trendmicro.com/en-us/article/tmka-19829?utm_source=homepage&utm_medium=searchtopics)

 Windows

* [Maximum Security](/en-us/product-support/maximum-security/)
* [Internet Security](/en-us/product-support/internet-security/)
* [Antivirus+ Security](/en-us/product-support/antivirus-plus-security/)

 Android

* [Mobile Security for Android](/en-us/product-support/mobile-security-for-android/)

 Mac & iOS

* [Antivirus for Mac](/en-us/product-support/antivirus-for-mac/)
* [Mobile Security for iOS](/en-us/product-support/mobile-security-for-ios/)

Network Security

* [Home Network Security](/en-us/product-support/home-network-security/)
* [Trend Micro VPN](/en-us/product-support/trend-micro-vpn/)

 Data & Privacy

* [ID Protection](/en-us/learn/privacy-and-identity/)
* [Password Manager](/en-us/product-support/password-manager/)

 Anti Scam and Spam

* [Trend Micro ScamCheck](/en-us/product-support/trend-micro-check/)

 Browser Protection

* [Security for Microsoft Edge](/en-us/product-support/security-for-edge/)
* [Security for Google Chrome](/en-us/product-support/security-for-chrome/)

 Premium Services

* [Service Bundles](/en-us/premium-services/)
* [Ala Carte](/en-us/premium-services/)

 Free Tools

* [Cleaner One Pro](/en-us/product-support/cleaner-one-pro/)
* [Ad Blocker for Mac](/en-us/product-support/adblock-one/)
* [Password Generator](https://pwm.trendmicro.com/password-generator?utm_source=helpcenter&utm_medium=referral)

 More Support

* [Cybersecurity Learning Center](/en-us/learn/)
* [Troubleshooting](/en-us/troubleshooting/)
* [Vulnerability Disclosures](/en-us/vulnerability/)

* [Support](/)
* TMKA-10337

 Print

# Security Bulletin: Trend Micro Home Network Security Multiple Vulnerabilities

Views:

**Bulletin Date**: May 20, 2021

**CVE Vulnerability Identifiers**: CVE-2021-32457, CVE-2021-32458, CVE-2021-32459

**Platform**: Consumer Hardware Device

**CVSSv3 Scores**: 4.9 - 7.8

**Severity Rating**: Medium - High

### Summary

Trend Micro has released a firmware update for the Trend Micro Home Network Security consumer devices which multiple vulnerabilities related to iotcl stack-based buffer overflow privilege escalation and a hard-coded log server password.

### Affected versions

| PRODUCT | AFFECTED VERSION | PLATFORM | LANGUAGE(S) |
| --- | --- | --- | --- |
| Home Network Security | 6.6.604 and earlier | Consumer Device | English, Japanese, Traditional Chinese |

### Solution

| PRODUCT | UPDATED VERSION | PLATFORM | LANGUAGE(S) |
| --- | --- | --- | --- |
| Home Network Security | 6.7.609 | Consumer Device | English, Japanese, Traditional Chinese |

Trend Micro has released an update via the product‚Äôs automatic firmware update mechanism to resolve this issue. Your Trend Micro Home Network Security device should receive the update automatically as long as your computer is connected to the Internet.

### Vulnerability Details

**CVE-2021-32457 and CVE-2021-32458: iotcl Stack-Based Buffer Overflow Privilege Escalation Vulnerability**

*CVSSv3: 7.8 - AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H*

Trend Micro Home Network Security version 6.6.604 and earlier is vulnerable to iotcl stack-based buffer overflow vulnerabilities which could allow an attacker to issue a specially crafted iotcl to escalate privileges on affected devices.

An attacker must first obtain the ability to execute low-privileged code on the target device in order to exploit this vulnerability.

**CVE-2021-32459: Log Server Hard-coded Password Vulnerability**

*CVSSv3: 4.9 - AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N*

Trend Micro Home Network Security version 6.6.604 and earlier contains a hard-coded password vulnerability in the log collection server which could allow an attacker to use a specially crafted network request to lead to arbitrary authentication.

An attacker must first obtain the ability to execute high-privileged code on the target device in order to exploit this vulnerability.

Trend Micro has received no reports nor is aware of any actual attacks against the affected product related to this vulnerability at this time.

### Acknowledgement

Trend Micro would like to thank the following individuals for responsibly disclosing the issue and working with Trend Micro to help protect our customers:

* Carl Hurd and Kelly Leuschner of Cisco Talos

### Additional Assistance

Customers who have questions are encouraged to contact [Trend Micro Technical Support](https://helpcenter.trendmicro.com/en-us/contact-support/) for further assistance.

### Reference

* TALOS-2021-1230
* TALOS-2021-1231
* TALOS-2021-1241

Keywords: CVE-2021-32457
CVE-2021-32458
CVE-2021-32459

Comments (0)

Add a comment

Name

Email

Comment

---

![Trend Micro Help Center](/tm-logo.svg)
English

[English](/en-us/ "English")
[Êó•Êú¨Ë™û](/ja-jp/ "Êó•Êú¨Ë™û")
[ÁπÅÈ´î‰∏≠Êñá](/zh-tw/ "Taiwan")

* [*Community*](https://discussions.trendmicro.com/en-us/)
* [*Facebook*](http://www.facebook.com/AskTrendMicro/)

Product Support

[Maximum Security](/en-us/product-support/maximum-security/)

[Antivirus for Mac](/en-us/product-support/antivirus-for-mac/)

[Mobile Security (Android)](/en-us/product-support/mobile-security-for-android/)

[Mobile Security (iOS)](/en-us/product-support/mobile-security-for-ios/)

[ID Protection](/en-us/learn/privacy-and-identity/)

[Password Manager](/en-us/product-support/password-manager/)

[Trend Micro VPN](/en-us/product-support/trend-micro-vpn/)

[Trend Micro Check](/en-us/product-support/trend-micro-check/)

Other Support

[Account Help](/en-us/trend-micro-account/)

[Download and Install](/en-us/install/)

[Troubleshooting](/en-us/troubleshooting/)

[Vulnerability](/en-us/vulnerability/)

[Cybersecurity Learning Center](/en-us/learn/)

About Trend Micro Support

[Premium Services](/en-us/premium-services/)

[Contact Us](/en-us/contact-support/)

[Sitemap](/en-us/site-map/)

[Privacy Policy](https://www.trendmicro.com/privacy?utm_source=helpcenter&utm_medium=referral)

[Business Support](https://success.trendmicro.com/en-us/?utm_source=helpcenter&utm_medium=referral)

[Data Collection Disclosure](https://success.trendmicro.com/dcx/s/data-collection-disclosure?language=en_US)

Contact Support

* [*Twitter*](https://twitter.com/TMSupportJP)
* [*Facebook*](https://www.facebook.com/AskTrendMicro)
* [*Community*](https://en.community.trendmicro.com/)
* [*Contact Us*](/en-us/contact-support/)

Copyright ¬©

Trend Micro Incorporated. All rights reserved.

This website uses cookies for website functionality and traffic analytics. Our Cookie Notice provides more information and explains how to amend your cookie settings.

[Learn More](https://www.trendmicro.com/en_us/about/legal.html#t2)
Yes, I agree

√ó
### Modal header

One fine body‚Ä¶

Dismiss
Save

* [Home](/en-us/)

**LAST UPDATED: MAY 20, 2021**

**Bulletin Date**: May 20, 2021

**CVE Vulnerability Identifiers**: CVE-2021-32457, CVE-2021-32458, CVE-2021-32459

**Platform**: Consumer Hardware Device

**CVSSv3 Scores**: 4.9 - 7.8

**Severity Rating**: Medium - High

### Summary

Trend Micro has released a firmware update for the Trend Micro Home Network Security consumer devices which multiple vulnerabilities related to iotcl stack-based buffer overflow privilege escalation and a hard-coded log server password.

### Affected versions

| PRODUCT | AFFECTED VERSION | PLATFORM | LANGUAGE(S) |
| --- | --- | --- | --- |
| Home Network Security | 6.6.604 and earlier | Consumer Device | English, Japanese, Traditional Chinese |

### Solution

| PRODUCT | UPDATED VERSION | PLATFORM | LANGUAGE(S) |
| --- | --- | --- | --- |
| Home Network Security | 6.7.609 | Consumer Device | English, Japanese, Traditional Chinese |

Trend Micro has released an update via the product‚Äôs automatic firmware update mechanism to resolve this issue. Your Trend Micro Home Network Security device should receive the update automatically as long as your computer is connected to the Internet.

### Vulnerability Details

**CVE-2021-32457 and CVE-2021-32458: iotcl Stack-Based Buffer Overflow Privilege Escalation Vulnerability**

*CVSSv3: 7.8 - AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H*

Trend Micro Home Network Security version 6.6.604 and earlier is vulnerable to iotcl stack-based buffer overflow vulnerabilities which could allow an attacker to issue a specially crafted iotcl to escalate privileges on affected devices.

An attacker must first obtain the ability to execute low-privileged code on the target device in order to exploit this vulnerability.

**CVE-2021-32459: Log Server Hard-coded Password Vulnerability**

*CVSSv3: 4.9 - AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N*

Trend Micro Home Network Security version 6.6.604 and earlier contains a hard-coded password vulnerability in the log collection server which could allow an attacker to use a specially crafted network request to lead to arbitrary authentication.

An attacker must first obtain the ability to execute high-privileged code on the target device in order to exploit this vulnerability.

Trend Micro has received no reports nor is aware of any actual attacks against the affected product related to this vulnerability at this time.

### Acknowledgement

Trend Micro would like to thank the following individuals for responsibly disclosing the issue and working with Trend Micro to help protect our customers:

* Carl Hurd and Kelly Leuschner of Cisco Talos

### Additional Assistance

Customers who have questions are encouraged to contact [Trend Micro Technical Support](https://helpcenter.trendmicro.com/en-us/contact-support/) for further assistance.

### Reference

* TALOS-2021-1230
* TALOS-2021-1231
* TALOS-2021-1241

How helpful was this article?

* It was very unhelpful.

  It wasn't helpful at all.
* It was not helpful.

  Somewhat helpful.
* Just okay.

  Just okay.
* It was helpful.

  It was somewhat helpful.
* It was very helpful.

  It was helpful.

Thank you for your feedback!

Feedback entity isn't available at the moment. Try again later.

* \*Feedback submitted will only be used as reference for future product, service and article improvements.

[![Virus Removal in PSS - NABU](/vrs-nabu-pss.png)](https://store.trendmicro.com/store/tmamer/buy/productID.5433352300/quantity.1/pgm.5378768700)
[![Virus Removal in IT Helpdesk - NZ](/vrs-anz-ithd.png)](https://store.trendmicro.com/store/tmapac/en_NZ/buy/pgm.5378548700/productID.5067297700)
[![Virus Removal in IT Helpdesk - AU](/vrs-anz-ithd.png)](https://store.trendmicro.com/store/tmapac/en_AU/buy/pgm.5378548700/productID.5067297700)

[![Security Health Check in PSS - NABU](/trend-micro-check-upsell-banner.png)](https://api.link.trendmicro.com/events/landing-page?product_id=4cc29&source=tm_helpcenter)
[![Security Health Check in IT Helpdesk - NZ](/trend-micro-check-upsell-banner.png)](https://store.trendmicro.com/store/tmapac/en_NZ/buy/pgm.5378548700/productID.5934252600)
[![Security Health Check in IT Helpdesk - AU](/trend-micro-check-upsell-banner.png)](https://store.trendmicro.com/store/tmapac/en_AU/buy/pgm.5378548700/productID.5934252600)

iframe.removeAttribute("sandbox")


