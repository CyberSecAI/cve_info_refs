=== Content from www.npmjs.com_ac881770_20250114_215535.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## @auth0/nextjs-auth0TypeScript icon, indicating that this package has built-in type declarations

3.5.0Â â¢Â PublicÂ â¢Â Published a year ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [9 Dependencies](?activeTab=dependencies)
* [26 Dependents](?activeTab=dependents)
* [88 Versions](?activeTab=versions)

[![nextjs-auth0](https://camo.githubusercontent.com/b83e3f093e9f0775c973693ce45d4b7fd967628f5abdace713b85294d4322c64/68747470733a2f2f63646e2e61757468302e636f6d2f776562736974652f73646b732f62616e6e6572732f6e6578746a732d61757468302d62616e6e65722e706e67)](https://camo.githubusercontent.com/b83e3f093e9f0775c973693ce45d4b7fd967628f5abdace713b85294d4322c64/68747470733a2f2f63646e2e61757468302e636f6d2f776562736974652f73646b732f62616e6e6572732f6e6578746a732d61757468302d62616e6e65722e706e67)

The Auth0 Next.js SDK is a library for implementing user authentication in Next.js applications.

[![Release](https://camo.githubusercontent.com/fbb94dc91745c55bde5d65775ce1761a3908cb28d571a84aa6ef9f5036cd2f26/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f4061757468302f6e6578746a732d6175746830)](https://camo.githubusercontent.com/fbb94dc91745c55bde5d65775ce1761a3908cb28d571a84aa6ef9f5036cd2f26/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f4061757468302f6e6578746a732d6175746830)
[![Coverage](https://camo.githubusercontent.com/fda0d1560f4ce4cf34b42a9dd81aa2794a3148aa88b8c964e32a102c5f4cbc72/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f64796e616d69632f6a736f6e3f636f6c6f723d627269676874677265656e266c6162656c3d636f7665726167652671756572793d6a6573742e636f7665726167655468726573686f6c642e676c6f62616c2e6c696e6573267375666669783d2532352675726c3d68747470732533412532462532467261772e67697468756275736572636f6e74656e742e636f6d25324661757468302532466e6578746a732d61757468302532466d61696e2532467061636b6167652e6a736f6e)](https://github.com/auth0/nextjs-auth0/blob/main/package.json#L147)
[![Downloads](https://camo.githubusercontent.com/c6c41d5e1aaafcdf072be6db0fe2b74cbab74d34186c5753fd4e02a1681a0969/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f64772f4061757468302f6e6578746a732d6175746830)](https://camo.githubusercontent.com/c6c41d5e1aaafcdf072be6db0fe2b74cbab74d34186c5753fd4e02a1681a0969/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f64772f4061757468302f6e6578746a732d6175746830)
[![License](https://camo.githubusercontent.com/4a4c988f817e3bc4cdb12bbc7805730437e8e1b6595479ae5ea3334f5fa503ee/68747470733a2f2f696d672e736869656c64732e696f2f3a6c6963656e73652d6d69742d626c75652e7376673f7374796c653d666c6174)](https://opensource.org/licenses/MIT)
[![CircleCI](https://camo.githubusercontent.com/cf932d29de3190737cf8547392706ff71b93697f19b5608cfd8e4ca2e01c7847/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f6275696c642f6769746875622f61757468302f6e6578746a732d6175746830)](https://camo.githubusercontent.com/cf932d29de3190737cf8547392706ff71b93697f19b5608cfd8e4ca2e01c7847/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f6275696c642f6769746875622f61757468302f6e6578746a732d6175746830)

ð [Documentation](#documentation) - ð [Getting Started](#getting-started)- ð» [API Reference](#api-reference) - ð¬ [Feedback](#feedback)

## Documentation

* [QuickStart](https://auth0.com/docs/quickstart/webapp/nextjs)- our guide for adding Auth0 to your Next.js app.
* [FAQs](https://github.com/auth0/nextjs-auth0/blob/main/FAQ.md) - Frequently asked questions about nextjs-auth0.
* [Examples](https://github.com/auth0/nextjs-auth0/blob/main/EXAMPLES.md) - lots of examples for your different use cases.
* [Security](https://github.com/auth0/nextjs-auth0/blob/main/SECURITY.md) - Some important security notices that you should check.
* [Architecture](https://github.com/auth0/nextjs-auth0/blob/main/ARCHITECTURE.md) - Architectural overview of the SDK.
* [Testing](https://github.com/auth0/nextjs-auth0/blob/main/TESTING.md) - Some help with testing your nextjs-auth0 application.
* [Deploying](https://github.com/auth0/nextjs-auth0/blob/main/example-app/README.md) - How we deploy our example app to Vercel.
* [Docs Site](https://auth0.com/docs) - explore our docs site and learn more about Auth0.

## Getting Started

### Installation

Using [npm](https://npmjs.org):

```
npm install @auth0/nextjs-auth0
```

This library requires Node.js 16 LTS and newer LTS versions.

### Auth0 Configuration

Create a **Regular Web Application** in the [Auth0 Dashboard](https://manage.auth0.com/#/applications).

> **If you're using an existing application**, verify that you have configured the following settings in your Regular Web Application:
>
> * Click on the "Settings" tab of your application's page.
> * Scroll down and click on the "Show Advanced Settings" link.
> * Under "Advanced Settings", click on the "OAuth" tab.
> * Ensure that "JsonWebToken Signature Algorithm" is set to `RS256` and that "OIDC Conformant" is enabled.

Next, configure the following URLs for your application under the "Application URIs" section of the "Settings" page:

* **Allowed Callback URLs**: `http://localhost:3000/api/auth/callback`
* **Allowed Logout URLs**: `http://localhost:3000/`

Take note of the **Client ID**, **Client Secret**, and **Domain** values under the "Basic Information" section. You'll need these values in the next step.

### Basic Setup

#### Configure the Application

You need to allow your Next.js application to communicate properly with Auth0. You can do so by creating a `.env.local` file under your root project directory that defines the necessary Auth0 configuration values as follows:

```
# A long, secret value used to encrypt the session cookie
AUTH0_SECRET='LONG_RANDOM_VALUE'
# The base url of your application
AUTH0_BASE_URL='http://localhost:3000'
# The url of your Auth0 tenant domain
AUTH0_ISSUER_BASE_URL='https://YOUR_AUTH0_DOMAIN.auth0.com'
# Your Auth0 application's Client ID
AUTH0_CLIENT_ID='YOUR_AUTH0_CLIENT_ID'
# Your Auth0 application's Client Secret
AUTH0_CLIENT_SECRET='YOUR_AUTH0_CLIENT_SECRET'
```

You can execute the following command to generate a suitable string for the `AUTH0_SECRET` value:

```
node -e "console.log(crypto.randomBytes(32).toString('hex'))"
```

You can see a full list of Auth0 configuration options in the ["Configuration properties"](https://auth0.github.io/nextjs-auth0/modules/config.html#configuration-properties) section of the "Module config" document.

> For more details about loading environment variables in Next.js, visit the ["Environment Variables"](https://nextjs.org/docs/basic-features/environment-variables) document.

Add `handleAuth()` to your app, which creates the following route handlers under the hood that perform different parts of the authentication flow:

* `/api/auth/login`: Your Next.js application redirects users to your identity provider for them to log in (you can optionally pass a `returnTo` parameter to return to a custom relative URL after login, for example `/api/auth/login?returnTo=/profile`).
* `/api/auth/callback`: Your identity provider redirects users to this route after they successfully log in.
* `/api/auth/logout`: Your Next.js application logs out the user.
* `/api/auth/me`: You can fetch user profile information in JSON format.

**Continue setup depending on your router:**

* [Page Router](#page-router)
* [App Router](#app-router)

#### Page Router

##### Add the Dynamic API Route

Create a [dynamic API route handler](https://nextjs.org/docs/pages/building-your-application/routing/api-routes#dynamic-api-routes) under the `/pages/api` directory:

* Create an `auth` directory under the `/pages/api/` directory.
* Create a `[auth0].js` file under the newly created `auth` directory.

The path to your dynamic API route file would be `/pages/api/auth/[auth0].js`. Populate that file as follows:

```
import { handleAuth } from '@auth0/nextjs-auth0';

export default handleAuth();
```
##### Add the UserProvider to Custom App

Wrap your `pages/_app.js` component with the `UserProvider` component:

```
// pages/_app.js
import React from 'react';
import { UserProvider } from '@auth0/nextjs-auth0/client';

export default function App({ Component, pageProps }) {
  return (
    <UserProvider>
      <Component {...pageProps} />
    </UserProvider>
  );
}
```
##### Consume Authentication

You can now determine if a user is authenticated by checking that the `user` object returned by the `useUser()` hook is defined. You can also log in or log out your users from the frontend layer of your Next.js application by redirecting them to the appropriate automatically-generated route:

```
// pages/index.js
import { useUser } from '@auth0/nextjs-auth0/client';

export default function Index() {
  const { user, error, isLoading } = useUser();

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>{error.message}</div>;

  if (user) {
    return (
      <div>
        Welcome {user.name}! <a href="/api/auth/logout">Logout</a>
      </div>
    );
  }

  return <a href="/api/auth/login">Login</a>;
}
```
> Next linting rules might suggest using the `Link` component instead of an anchor tag. The `Link` component is meant to perform [client-side transitions between pages](https://nextjs.org/docs/api-reference/next/link). As the links point to an API route and not to a page, you should keep them as anchor tags.

#### App Router

> Check out [Using this SDK with React Server Components](#using-this-sdk-with-react-server-components) before proceeding.

##### Add the Dynamic API Route

Create a [catch-all, dynamic API route handler](https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes) under the `/app/api` directory (strictly speaking you do not need to put API routes under `/api` but we maintain the convention for simplicity):

* Create an `api` directory under the `/app/` directory.
* Create an `auth` directory under the newly created `/app/api/` directory.
* Create a `[auth0]` directory under the newly created `auth` directory.
* Create a `route.js` file under the newly created `[auth0]` directory.

The path to your dynamic API route file will be `/app/api/auth/[auth0]/route.js`. Populate that file as follows:

```
import { handleAuth } from '@auth0/nextjs-auth0';

export const GET = handleAuth();
```
##### Add the `UserProvider` to your layout

Wrap your `app/layout.js` component with the `UserProvider` component:

```
// app/layout.js
import React from 'react';
import { UserProvider } from '@auth0/nextjs-auth0/client';

export default function App({ children }) {
  return (
    <UserProvider>
      <body>{children}</body>
    </UserProvider>
  );
}
```
##### Consume Authentication

You can now determine if a user is authenticated by checking that the `user` object returned by the `useUser()` hook is defined. You can also log in or log out your users from the frontend layer of your Next.js application by redirecting them to the appropriate automatically-generated route:

```
// pages/index.js
'use client';
import { useUser } from '@auth0/nextjs-auth0/client';

export default function Index() {
  const { user, error, isLoading } = useUser();

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>{error.message}</div>;

  if (user) {
    return (
      <div>
        Welcome {user.name}! <a href="/api/auth/logout">Logout</a>
      </div>
    );
  }

  return <a href="/api/auth/login">Login</a>;
}
```
> Next linting rules might suggest using the `Link` component instead of an anchor tag. The `Link` component is meant to perform [client-side transitions between pages](https://nextjs.org/docs/api-reference/next/link). As the links point to an API route and not to a page, you should keep them as anchor tags.

##### Using this SDK with React Server Components

Server Components in the App Directory (including Pages and Layouts) *cannot* write to a cookie.

If you rely *solely* on Server Components to read and update your session you should be aware of the following:

* If you have a rolling session (the default for this SDK), the expiry will not be updated when the user visits your site. So the session may expire sooner than you would expect (you can use `withMiddlewareAuthRequired` to mitigate this).
* If you refresh the access token, the new access token will not be persisted in the session. So subsequent attempts to get an access token will always result in refreshing the expired access token in the session.
* If you make any other updates to the session, they will not be persisted between requests.

> The cookie *can* be written from [middleware](https://nextjs.org/docs/app/building-your-application/routing/middleware), [route handlers](https://nextjs.org/docs/app/building-your-application/routing/router-handlers) and [server actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions).

For other comprehensive examples, see the [EXAMPLES.md](https://github.com/auth0/nextjs-auth0/blob/main/EXAMPLES.md) document.

## API Reference

### Server

#### For Node

`import * from @auth0/nextjs-auth0`

#### For Edge runtime

`import * from @auth0/nextjs-auth0/edge`

* [Configuration Options and Environment variables](https://auth0.github.io/nextjs-auth0/types/config.ConfigParameters.html)
* [initAuth0](https://auth0.github.io/nextjs-auth0/types/init.InitAuth0.html)
* [handleAuth](https://auth0.github.io/nextjs-auth0/types/handlers_auth.HandleAuth.html)
* [handleLogin](https://auth0.github.io/nextjs-auth0/types/handlers_login.HandleLogin.html)
* [handleCallback](https://auth0.github.io/nextjs-auth0/types/handlers_callback.HandleCallback.html)
* [handleLogout](https://auth0.github.io/nextjs-auth0/types/handlers_logout.HandleLogout.html)
* [handleProfile](https://auth0.github.io/nextjs-auth0/types/handlers_profile.HandleProfile.html)
* [withApiAuthRequired](https://auth0.github.io/nextjs-auth0/types/helpers_with_api_auth_required.WithApiAuthRequired.html)
* [withPageAuthRequired](https://auth0.github.io/nextjs-auth0/types/helpers_with_page_auth_required.WithPageAuthRequired.html)
* [getSession](https://auth0.github.io/nextjs-auth0/types/session_get_session.GetSession.html)
* [updateSession](https://auth0.github.io/nextjs-auth0/types/session_update_session.UpdateSession.html)
* [getAccessToken](https://auth0.github.io/nextjs-auth0/types/session_get_access_token.GetAccessToken.html)
* [withMiddlewareAuthRequired](https://auth0.github.io/nextjs-auth0/types/helpers_with_middleware_auth_required.WithMiddlewareAuthRequired.html) (Edge only)

### Client (for the Browser)

`import * from @auth0/nextjs-auth0/client`

* [UserProvider](https://auth0.github.io/nextjs-auth0/types/client_use_user.UserProvider.html)
* [useUser](https://auth0.github.io/nextjs-auth0/functions/client_use_user.useUser.html)
* [withPageAuthRequired](https://auth0.github.io/nextjs-auth0/types/client_with_page_auth_required.WithPageAuthRequired.html)

### Testing helpers

`import * from @auth0/nextjs-auth0/testing`

* [generateSessionCookie](https://auth0.github.io/nextjs-auth0/types/helpers_testing.GenerateSessionCookieConfig.html)

Visit the auto-generated [API Docs](https://auth0.github.io/nextjs-auth0/) for more details

### Cookies and Security

All cookies will be set to `HttpOnly, SameSite=Lax` and will be set to `Secure` if the application's `AUTH0_BASE_URL` is `https`.

The `HttpOnly` setting will make sure that client-side JavaScript is unable to access the cookie to reduce the attack surface of [XSS attacks](https://auth0.com/blog/developers-guide-to-common-vulnerabilities-and-how-to-prevent-them/#Cross-Site-Scripting--XSS-).

The `SameSite=Lax` setting will help mitigate CSRF attacks. Learn more about SameSite by reading the ["Upcoming Browser Behavior Changes: What Developers Need to Know"](https://auth0.com/blog/browser-behavior-changes-what-developers-need-to-know/) blog post.

### Caching and Security

Many hosting providers will offer to cache your content at the edge in order to serve data to your users as fast as possible. For example Vercel will [cache your content on the Vercel Edge Network](https://vercel.com/docs/concepts/edge-network/caching) for all static content and Serverless Functions if you provide the necessary caching headers on your response.

It's generally a bad idea to cache any response that requires authentication, even if the response's content appears safe to cache there may be other data in the response that isn't.

This SDK offers a rolling session by default, which means that any response that reads the session will have a `Set-Cookie` header to update the cookie's expiry. Vercel and potentially other hosting providers include the `Set-Cookie` header in the cached response, so even if you think the response's content can be cached publicly, the responses `Set-Cookie` header cannot.

Check your hosting provider's caching rules, but in general you should **never** cache responses that either require authentication or even touch the session to check authentication (eg when using `withApiAuthRequired`, `withPageAuthRequired` or even just `getSession` or `getAccessToken`).

### Error Handling and Security

Errors that come from Auth0 in the `redirect_uri` callback may contain reflected user input via the OpenID Connect `error` and `error_description` query parameter. Because of this, we do some [basic escaping](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html#rule-1-html-encode-before-inserting-untrusted-data-into-html-element-content) on the `message`, `error` and `error_description` properties of the `IdentityProviderError`.

But, if you write your own error handler, you should **not** render the error `message`, or `error` and `error_description` properties without using a templating engine that will properly escape them for other HTML contexts first.

### Base Path and Internationalized Routing

With Next.js you can deploy a Next.js application under a sub-path of a domain using [Base Path](https://nextjs.org/docs/api-reference/next.config.js/basepath) and serve internationalized (i18n) routes using [Internationalized Routing](https://nextjs.org/docs/advanced-features/i18n-routing).

If you use these features the urls of your application will change and so the urls to the nextjs-auth0 routes will change. To accommodate this there are various places in the SDK that you can customise the url.

For example, if `basePath: '/foo'` you should prepend this to the `loginUrl` and `profileUrl` specified in your `Auth0Provider`:

```
// _app.jsx
function App({ Component, pageProps }) {
  return (
    <UserProvider loginUrl="/foo/api/auth/login" profileUrl="/foo/api/auth/me">
      <Component {...pageProps} />
    </UserProvider>
  );
}
```

Also, any links to login or logout should include the `basePath`:

```
<a href="/foo/api/auth/login">Login</a><br />
<a href="/foo/api/auth/logout">Logout</a>
```

You should configure the [baseUrl](https://auth0.github.io/nextjs-auth0/interfaces/config.baseconfig.html#baseurl) (or the `AUTH0_BASE_URL` environment variable). For example:

```
# .env.local
AUTH0_BASE_URL=http://localhost:3000/foo
```

For any pages that are protected with the Server Side [withPageAuthRequired](https://auth0.github.io/nextjs-auth0/modules/helpers_with_page_auth_required.html#withpageauthrequired) you should update the `returnTo` parameter depending on the `basePath` and `locale` if necessary.

```
// ./pages/my-ssr-page.jsx
export default MySsrPage = () => <></>;

const getFullReturnTo = (ctx) => {
  // TODO: implement getFullReturnTo based on the ctx.resolvedUrl, ctx.locale
  // and your next.config.js's basePath and i18n settings.
  return '/foo/en-US/my-ssr-page';
};

export const getServerSideProps = (ctx) => {
  const returnTo = getFullReturnTo(ctx.req);
  return withPageAuthRequired({ returnTo })(ctx);
};
```
### Comparison with the Auth0 React SDK

We also provide an Auth0 React SDK, [auth0-react](https://github.com/auth0/auth0-react), which may be suitable for your Next.js application.

The SPA security model used by `auth0-react` is different from the Web Application security model used by this SDK. In short, this SDK protects pages and API routes with a cookie session (see ["Cookies and Security"](#cookies-and-security)). A SPA library like `auth0-react` will store the user's ID token and access token directly in the browser and use them to access external APIs directly.

You should be aware of the security implications of both models. However, [auth0-react](https://github.com/auth0/auth0-react) may be more suitable for your needs if you meet any of the following scenarios:

* You are using [Static HTML Export](https://nextjs.org/docs/advanced-features/static-html-export) with Next.js.
* You do not need to access user data during server-side rendering.
* You want to get the access token and call external API's directly from the frontend layer rather than using Next.js API routes as a proxy to call external APIs.

### Testing

By default, the SDK creates and manages a singleton instance to run for the lifetime of the application. When testing your application, you may need to reset this instance, so its state does not leak between tests.

If you're using Jest, we recommend using `jest.resetModules()` after each test. Alternatively, you can look at [creating your own instance of the SDK](https://github.com/auth0/nextjs-auth0/blob/HEAD/EXAMPLES.md#create-your-own-instance-of-the-sdk), so it can be recreated between tests.

For end to end tests, have a look at how we use a [mock OIDC Provider](https://github.com/auth0/nextjs-auth0/blob/HEAD/scripts/oidc-provider.js).

# Deploying

For deploying, have a look at [how we deploy our example app to Vercel](https://github.com/auth0/nextjs-auth0/blob/HEAD/example-app/README.md).

## Contributing

We appreciate feedback and contribution to this repo! Before you get started, please read the following:

* [Auth0's general contribution guidelines](https://github.com/auth0/open-source-template/blob/master/GENERAL-CONTRIBUTING.md)
* [Auth0's code of conduct guidelines](https://github.com/auth0/express-openid-connect/blob/master/CODE-OF-CONDUCT.md)
* [This repo's contribution guide](https://github.com/auth0/nextjs-auth0/blob/HEAD/CONTRIBUTING.md)

## Vulnerability Reporting

Please do not report security vulnerabilities on the public GitHub issue tracker. The [Responsible Disclosure Program](https://auth0.com/responsible-disclosure-policy) details the procedure for disclosing security issues.

## What is Auth0?

[![Auth0 Logo](https://camo.githubusercontent.com/a86b9b97b11a1597e36b29213f67094de9b1c782294307700aa71efe8096277e/68747470733a2f2f63646e2e61757468302e636f6d2f776562736974652f73646b732f6c6f676f732f61757468305f6c696768745f6d6f64652e706e67)](https://camo.githubusercontent.com/a86b9b97b11a1597e36b29213f67094de9b1c782294307700aa71efe8096277e/68747470733a2f2f63646e2e61757468302e636f6d2f776562736974652f73646b732f6c6f676f732f61757468305f6c696768745f6d6f64652e706e67)

Auth0 is an easy to implement, adaptable authentication and authorization platform. To learn more checkout [Why Auth0?](https://auth0.com/why-auth0)

This project is licensed under the MIT license. See the  [LICENSE](https://github.com/auth0/express-openid-connect/blob/master/LICENSE) file for more info.

## Readme

### Keywords

* [auth0](/search?q=keywords:auth0)
* [next.js](/search?q=keywords:next.js)
* [react](/search?q=keywords:react)
* [oidc](/search?q=keywords:oidc)
* [authentication](/search?q=keywords:authentication)
* [vercel](/search?q=keywords:vercel)
# Provenance

[Share feedback](https://github.com/npm/feedback)
## Package Sidebar

### Install

`npm i @auth0/nextjs-auth0`

### Repository

[Gitgithub.com/auth0/nextjs-auth0](https://github.com/auth0/nextjs-auth0)

### Homepage

[github.com/auth0/nextjs-auth0#readme](https://github.com/auth0/nextjs-auth0#readme)

### DownloadsWeekly Downloads

212,838

### Version

3.5.0

### License

MIT

### Unpacked Size

744 kB

### Total Files

369

### Last publish

8 days ago

### Collaborators

* [![auth0-oss](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kMDU5N2U3MGQ0NGQxYmMxMmRjNGM4ODMyMzQ3MGI0Mj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.nLLy6Ndm3rR5_Bo-WI-KT42odWOL86L37ZE_6ttr3Vs "auth0-oss")](/~auth0-oss)
* [![codepete](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84NGJkZmVkMjkyZTEyOWIzYjg2NjA5MDhlNTY2Yjk1YT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.f6RQiSvCDiXeF_LCTj4lJab5SIe7rItsT9hLQBy8oNA "codepete")](/~codepete)
* [![ziluvatar](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9iOTdhMTU2MDQyNGUxYTQ2MDBkMjM2NWJjZDY2NWQ1OT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.qiGZ8ihaRWnO-W6CCK_7j91HEehL9x7pK9Y4ahDxU5s "ziluvatar")](/~ziluvatar)
* [![iaco](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9jMzU0MTZkNDU0ODEzMzIxMjdjODhlNGNkMzU1NTU1Zj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.fn1xI1L274TFLGy6XSOp6INf8-8Aqc1ZxRxaKFpwGds "iaco")](/~iaco)
* [![pubalokta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lZGRhNzJlZWQ1ZDVkYjE2ZDhjZWY2ZWMyZGY0YjlmND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Hzpj5TCKnGu_gpw1cW7xftBB1XtpXuShgOfOrMvrWj0 "pubalokta")](/~pubalokta)
* [![auth0npm](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85N2RiZWYwZTRjNzA0YThiMmZhZGI4YjQyMjliZDc2MD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.GnkCMpI9DXEPQTEEWGjdRksQ3STME4rIa3YBxKromOM "auth0npm")](/~auth0npm)
* [![auth0brokkr](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83ZGI2YjE2Yzk4NzE4NTRkZjZlNTIyMjA5ZTBhMDYzMT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.YBwJrlgviFzmxSmd6mbO8s-c3_27mCQm9-lnotvsVEU "auth0brokkr")](/~auth0brokkr)
* [![hzalaz](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9iOTNhZjYyNDk5ZWQwZjc2ZjI4MGFjYjM3OTEzZjE1ZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.R-y7KLvKlsYMhX_i2FU-XUuXmauFA94OdX-noncXZlA "hzalaz")](/~hzalaz)
* [![aaguiarz](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9jZGY2YjRlNjYyNGU5NzIwYWJlYThhNDg1ZmIzM2ZkZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.X626fSrx4hvU3vjBSnY-j5ECd-kdCH0d02_aMzlkpdA "aaguiarz")](/~aaguiarz)
* [![charlesrea](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9iNjNlZDk4MGE2OGI1ZWZhYWUwOWU5YTg0ZDBhYzNhMj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.BbsbrA_Jgsay4RsKp-klruStlbe-qd8Kp-axez9orbg "charlesrea")](/~charlesrea)
* [![ncluer](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83Mjc1ODBmN2JjNWMyZDA3NjgzZTJhYmY5MTc2ZGFhNz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.l4X0v0MM7VvAKyGBzQ9hTEdfL045Bru-X5vStfuKsr8 "ncluer")](/~ncluer)
* [![julien.wollscheid](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lY2FiNjQ1OGMyOWI2NjFmMTk3ODJmYWM1NWJhMTMyNz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.JrHkkf4IB_xGAn9KaDFrZpvRAU8oqGkhfaxMCJeAQiY "julien.wollscheid")](/~julien.wollscheid)
* [![cristiandouce](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85NzNkMmJmZjE3MzZhNjVlZGJiYmYyYjA5Mjk4Y2QzYz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.W6XxEjekDn01ZDZf48ErkBIKfgAdT__3M8BztUja-vc "cristiandouce")](/~cristiandouce)
* [![sambego](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci80ZGU5MDQzZjYwMTY4YzFlYjJiZTJiNzUxZWM3OTM3Mz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.MM8Rz26Y9pyLXPz-3IxyjWqTny33VOTtxXq9B5tFgjA "sambego")](/~sambego)
* [![sandrinodimattia](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xMTU4ZDkxN2RmMGYxZmEyZWQ5MzBkOTFhZjNiNzcyYz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.EC0ac7eIzsxEghtYpoUx9hKbsEe7qGf-kETDNdemNIc "sandrinodimattia")](/~sandrinodimattia)
* [![lzychowski](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hN2ZlYTJiMTdjNjM5MWRjOGYwY2ZlMzkzMTAyNGQwNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.kDRolICiAXf5TMKp1Jij8HphlOgk6O9fhoID48AbGqw "lzychowski")](/~lzychowski)
* [![davidpatrick0](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85NDE2NzQ2M2ExNzVmOWJiNTIyYTQzMmFjZWYwMTM1MT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.5CSkNTjK5rnRnXbcAnB1GsKsaeMXsyaqlwnKJhSItu0 "davidpatrick0")](/~davidpatrick0)
* [![sergii.biienko](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lZWRjMjFhODM2YWE1NjI1MDVhOTBlNWJlNTFlNWNmOT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Y9nZ-2jRyo5Yrth-OXY1_z15-OTDkgtko1N1ufg9PDs "sergii.biienko")](/~sergii.biienko)
* [![tomauth0](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82ZTEyMmQwM2U5NjRiODNiNjQzY2I3OGRlNTEwN2M4ZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.YZ3_jBEK2LWvkJ3N3g22dGoccI8fCzoBTsJ-jTdli6c "tomauth0")](/~tomauth0)
* [![jpadilla](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xYjIwODQ5MTM3OWUzNTE5MDVkOGM2MDViZDMxYjA3MD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Q8xlOaWbdEHgfAdWf-myi-Y_fjzmJAGwHcQBPof03_A "jpadilla")](/~jpadilla)
* [![jessele](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9iMjVlZGFmNTU2YTg3MDY0NTg5MTU0NTZmYjU1M2M1ZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.vEo9EJeukOSl_VTumC3nDr4WwABH2sb7aMYCYtVNAiA "jessele")](/~jessele)
* [![rhamzeh_auth0](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lNmZhYmJkMDAyYjJiMDg1MDRmN2M3NDA2OWMzNzkwOD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.BamlXZ5AyM5ovTzSJ2JGktb-X-iEwk54CGsSRJlK69c "rhamzeh_auth0")](/~rhamzeh_auth0)
* [![oktajeffoktajeff](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82ZjRlYjJiODEwM2QyNTU1MDg1ODYzNjZmZDgwMjRmNj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.bSZbsXBc1hk60Qgl_9CTi2oY_nJRj1-I5FpHVxQpZw8 "oktajeffoktajeff")](/~oktajeffoktajeff)
* [![david.renaud.okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82MzI1ZTlkM2UwYzA0OGU4NTNlODU1MzZlYjVmZmNkOT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Vy2Xpqe01i7glERGP_blsbw9msFimlhpoi-g6snjVuw "david.renaud.okta")](/~david.renaud.okta)
* [![madhuri.rm23](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci80NDE2ZjdhZTUxNmFkMzlkMDJiYTM3NGU3YmM3OGEwMD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.9pkvy_b4UedgWPHwXpgYov8nQn83LDFZZ08jcYyfGNo "madhuri.rm23")](/~madhuri.rm23)
* [![npirani_okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hNzZlOThjYzg1ZDlkZDA0ZTNhYzVmODQ3YzM5ODNkND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ZrYkP0543dM3zTmh3pwTylnl4g9-7WQvgVOvyaOkP-A "npirani_okta")](/~npirani_okta)
* [![soumya.bodavula](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83YmUwYTZiNjhkNDE3OGEzN2QwYzI1MDE2NmVjNDdjNj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.CjkX3aEUu08ueXlHxNtvXMGq28xGgfBEQKlsJ1hzjIU "soumya.bodavula")](/~soumya.bodavula)
* [![jamescgarrett-okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mZTM5ZTM2MTE2ODJiMzNlY2FmNzI5Y2FhMzRlYmZiOD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ePXht5E4dF3kGLp024gv9ic0kzydgp0EUH8-0cPcoSA "jamescgarrett-okta")](/~jamescgarrett-okta)
* [![stheller](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kMzg4ZGVhMTY3ZjkwNGQ0NmZmY2UxMzEyNzk0NTY4OD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.1y4-5ehTXJyu7MxBrdF26j9-QZN_CKWs5i8Fd5DCy8Y "stheller")](/~stheller)
* [![jfromaniello](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kMWE3ZTBmYmZiMmMxZDlhOGIxMGZkMDM2NDhkYTc4Zj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.FnaMUW9LuaOv_uhLEYcVWw762t3nDs_JeYXWIWiCmuk "jfromaniello")](/~jfromaniello)
* [![zak.nour](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lYTM0OWQ4ZWUyNjAzZTJhZTQ3ZTQzODcxMDNmOTljYT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Dd7Wky7MyeMKBBqH-M0Csk4MQxM2kIDJmH_J864nDfQ "zak.nour")](/~zak.nour)
* [![edgarchirivella-okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zNGUwMDI4NmJiZDc4MTBkY2E2NDRhYzc1ZjVkYmQwOT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.3CrQ_Efrnmjt9e9tii_crl6eE4XUfLDsj0y4D7eWf68 "edgarchirivella-okta")](/~edgarchirivella-okta)
* [![sanjay.manikandhan](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82Mjk5OWY1ZmYwMjhkNzg1OTcyNGI0OGJkYzE1NDYwNz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.kid_uDMrVXrK6pRinLXkEg4yzPsJEDK6u3XbzTNlkdQ "sanjay.manikandhan")](/~sanjay.manikandhan)
* [![rithuc23](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mYzVlYzRmN2FkN2IyNzMxZjdmZWZjNmJlMmEwNjU5OD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.flf-nHtpAaYc0Zu1psRbG17IKflNEiq1wCECkar4VbU "rithuc23")](/~rithuc23)
* [![ece-okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lOGZjMGQ3Y2QzNTAxNGEyZjM4ZWY5YzdmZGY5YzIzNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.TcLOo6XR8p_Jtr1ZcYXOKpkZn-P_GgwgDqHGk45y0kg "ece-okta")](/~ece-okta)
* [![enriquepina](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8wMmU5YWMyMTk4MTJjZTRlOWYwMGRiZTU5OTFhMDdlNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.cqIAcO1I_blT4YS94H7BfbLYFLLs4a-b70XEik8kals "enriquepina")](/~enriquepina)
* [![vic-dev](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hMDlkYzlkYTM0ZTRlZDg0ZDFkNTViZjc0Y2ZkMTVmYj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.BRvLqmvhf_y66jhZXGHV8_hCKlPU4mp6GFGazcu9IbI "vic-dev")](/~vic-dev)
* [![amandamdacruz0](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zN2ZkMDcwMTU3NDMyMGQ0OTEzYWY4ZWI4YzBiYTU3Mz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.0zppvwaqJx6qXRBPY4Eiz-2lXcLKXvySmUZ181ieyO8 "amandamdacruz0")](/~amandamdacruz0)
* [![dougmiller-okta](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xOTIyZWM2MjU0OGM2ZWYyYjZjZDViZjQ1MmFjZDJjOD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.3SSCx91ifFmBRgojEL2LShFfwryMB5In7pwWTD3YDPk "dougmiller-okta")](/~dougmiller-okta)
[**Try** on RunKit](https://runkit.com/npm/%40auth0/nextjs-auth0)[**Report** malware](/support?inquire=security&security-inquire=malware&package=%40auth0%2Fnextjs-auth0&version=3.5.0)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from github.com_9948ef72_20250114_215528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fauth0%2Fnextjs-auth0%2Fcommit%2F6996e2528ceed98627caa28abafbc09e90163ccf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fauth0%2Fnextjs-auth0%2Fcommit%2F6996e2528ceed98627caa28abafbc09e90163ccf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=auth0%2Fnextjs-auth0)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[auth0](/auth0)
/
**[nextjs-auth0](/auth0/nextjs-auth0)**
Public

* [Notifications](/login?return_to=%2Fauth0%2Fnextjs-auth0) You must be signed in to change notification settings
* [Fork
  398](/login?return_to=%2Fauth0%2Fnextjs-auth0)
* [Star
   2.1k](/login?return_to=%2Fauth0%2Fnextjs-auth0)

* [Code](/auth0/nextjs-auth0)
* [Issues
  50](/auth0/nextjs-auth0/issues)
* [Pull requests
  25](/auth0/nextjs-auth0/pulls)
* [Actions](/auth0/nextjs-auth0/actions)
* [Security](/auth0/nextjs-auth0/security)
* [Insights](/auth0/nextjs-auth0/pulse)

Additional navigation options

* [Code](/auth0/nextjs-auth0)
* [Issues](/auth0/nextjs-auth0/issues)
* [Pull requests](/auth0/nextjs-auth0/pulls)
* [Actions](/auth0/nextjs-auth0/actions)
* [Security](/auth0/nextjs-auth0/security)
* [Insights](/auth0/nextjs-auth0/pulse)

## Commit

[Permalink](/auth0/nextjs-auth0/commit/6996e2528ceed98627caa28abafbc09e90163ccf)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-954c-jjx6-cxv7](https://github.com/advisories/GHSA-954c-jjx6-cxv7 "GHSA-954c-jjx6-cxv7")

[Browse files](/auth0/nextjs-auth0/tree/6996e2528ceed98627caa28abafbc09e90163ccf)
Browse the repository at this point in the history

```
Fix reflected XSS from the callback handler's error query parameter
```

* Loading branch information

[![@lzychowski](https://avatars.githubusercontent.com/u/1878274?s=40&v=4)](/lzychowski)

[lzychowski](/auth0/nextjs-auth0/commits?author=lzychowski "View all commits by lzychowski")
authored
Jun 24, 2021

2 parents
[36655df](/auth0/nextjs-auth0/commit/36655df8af53c3d52108aa7059f13ef4e5a2685c)
+
[e051d6a](/auth0/nextjs-auth0/commit/e051d6abd1738d1ac614c7722bc2d1ad967c01a2)

commit 6996e25

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**200 additions**
and
**56 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* src

  + handlers

    - src/handlers/callback.ts
      [callback.ts](#diff-15fcbe91c0c7696df3ae46f37943fa3b4fc73ac7325fe192ff8cd34b67775ad3)
    - src/handlers/login.ts
      [login.ts](#diff-b3d79c670cbb8f76a65997a43a61877fce417f814366d280a68f8455bd40b39d)
    - src/handlers/logout.ts
      [logout.ts](#diff-91790d5e04b352a4eacb60d61c5bac0c212b2e3914570dccf3404a8bc68f0a10)
    - src/handlers/profile.ts
      [profile.ts](#diff-5bb646f096212429146206c1074fd3d01bc5fbee16513ce1782bd1c083e22ce2)
  + utils

    - src/utils/errors.ts
      [errors.ts](#diff-d3b5d70cc2b50e2667c6d9c24da50c9d14582360145b2ba8b171127e787f03d9)
* tests

  + auth0-session/handlers

    - tests/auth0-session/handlers/callback.test.ts
      [callback.test.ts](#diff-9023d903a53ea713a007449ef5aa0aaf2ad9d6c996bf61819c3fde54857fc203)
  + fixtures

    - tests/fixtures/oidc-nocks.ts
      [oidc-nocks.ts](#diff-3f02253d958d991a8465d068390a5364311ff315723bfefbd52e6624d7405cf9)
  + handlers

    - tests/handlers/callback.test.ts
      [callback.test.ts](#diff-6e89c251ba6765e2e39f30fa1643e196fa39fdbd3875c48d8a28b452109bd346)
    - tests/handlers/login.test.ts
      [login.test.ts](#diff-c944342fbf9ccb28a9920b0a4e4422c8e0bd152792e2304afa78432ca713c909)
    - tests/handlers/logout.test.ts
      [logout.test.ts](#diff-b6a5c69b9ab2d79003cdb54cfd874482d745755baab854b82f9d5c228bd95b13)
    - tests/handlers/profile.test.ts
      [profile.test.ts](#diff-43549841cd306e45cf537adad769f7fc683abaf46a9eab1146d958238493af2a)

## There are no files selected for viewing

17 changes: 17 additions & 0 deletions

17
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -17,6 +17,7 @@ The Auth0 Next.js SDK is a library for implementing user authentication in Next. |
|  |  | - [API Reference](#api-reference) |
|  |  | - [v1 Migration Guide](./V1\_MIGRATION\_GUIDE.md) |
|  |  | - [Cookies and Security](#cookies-and-security) |
|  |  | - [Error Handling and Security](#error-handling-and-security) |
|  |  | - [Base Path and Internationalized Routing](#base-path-and-internationalized-routing) |
|  |  | - [Architecture](./ARCHITECTURE.md) |
|  |  | - [Comparison with auth0-react](#comparison-with-auth0-react) |
| Expand Down  Expand Up | | @@ -188,6 +189,22 @@ The `HttpOnly` setting will make sure that client-side JavaScript is unable to a |
|  |  |  |
|  |  | The `SameSite=Lax` setting will help mitigate CSRF attacks. Learn more about SameSite by reading the ["Upcoming Browser Behavior Changes: What Developers Need to Know"](https://auth0.com/blog/browser-behavior-changes-what-developers-need-to-know/) blog post. |
|  |  |  |
|  |  | ### Error Handling and Security |
|  |  |  |
|  |  | The default server side error handler for the `/api/auth/\*` routes prints the error message to screen, eg |
|  |  |  |
|  |  | ```js |
|  |  | try { |
|  |  | await handler(req, res); |
|  |  | } catch (error) { |
|  |  | res.status(error.status || 400).end(error.message); |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | Because the error can come from the OpenID Connect `error` query parameter we do some [basic escaping](https://cheatsheetseries.owasp.org/cheatsheets/Cross\_Site\_Scripting\_Prevention\_Cheat\_Sheet.html#rule-1-html-encode-before-inserting-untrusted-data-into-html-element-content) which makes sure the default error handler is safe from XSS. |
|  |  |  |
|  |  | If you write your own error handler, you should \*\*not\*\* render the error message without using a templating engine that will properly escape it for other HTML contexts first. |
|  |  |  |
|  |  | ### Base Path and Internationalized Routing |
|  |  |  |
|  |  | With Next.js you can deploy a Next.js application under a sub-path of a domain using [Base Path](https://nextjs.org/docs/api-reference/next.config.js/basepath) and serve internationalized (i18n) routes using [Internationalized Routing](https://nextjs.org/docs/advanced-features/i18n-routing). |
| Expand Down | |  |

15 changes: 10 additions & 5 deletions

15
[src/handlers/callback.ts](#diff-15fcbe91c0c7696df3ae46f37943fa3b4fc73ac7325fe192ff8cd34b67775ad3 "src/handlers/callback.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/src/handlers/callback.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ import { HandleCallback as BaseHandleCallback } from '../auth0-session'; |
|  |  | import { Session } from '../session'; |
|  |  | import { assertReqRes } from '../utils/assert'; |
|  |  | import { NextConfig } from '../config'; |
|  |  | import { HandlerError } from '../utils/errors'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Use this function for validating additional claims on the user's ID Token or adding removing items from |
| Expand Down  Expand Up | | @@ -122,10 +123,14 @@ const idTokenValidator = (afterCallback?: AfterCallback, organization?: string): |
|  |  | \*/ |
|  |  | export default function handleCallbackFactory(handler: BaseHandleCallback, config: NextConfig): HandleCallback { |
|  |  | return async (req, res, options = {}): Promise<void> => { |
|  |  | assertReqRes(req, res); |
|  |  | return handler(req, res, { |
|  |  | ...options, |
|  |  | afterCallback: idTokenValidator(options.afterCallback, options.organization || config.organization) |
|  |  | }); |
|  |  | try { |
|  |  | assertReqRes(req, res); |
|  |  | return await handler(req, res, { |
|  |  | ...options, |
|  |  | afterCallback: idTokenValidator(options.afterCallback, options.organization || config.organization) |
|  |  | }); |
|  |  | } catch (e) { |
|  |  | throw new HandlerError(e); |
|  |  | } |
|  |  | }; |
|  |  | } |

33 changes: 19 additions & 14 deletions

33
[src/handlers/login.ts](#diff-b3d79c670cbb8f76a65997a43a61877fce417f814366d280a68f8455bd40b39d "src/handlers/login.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/src/handlers/login.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,7 @@ import { AuthorizationParameters, HandleLogin as BaseHandleLogin } from '../auth |
|  |  | import isSafeRedirect from '../utils/url-helpers'; |
|  |  | import { assertReqRes } from '../utils/assert'; |
|  |  | import { NextConfig } from '../config'; |
|  |  | import { HandlerError } from '../utils/errors'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Use this to store additional state for the user before they visit the Identity Provider to login. |
| Expand Down  Expand Up | | @@ -109,23 +110,27 @@ export type HandleLogin = (req: NextApiRequest, res: NextApiResponse, options?: |
|  |  | \*/ |
|  |  | export default function handleLoginFactory(handler: BaseHandleLogin, nextConfig: NextConfig): HandleLogin { |
|  |  | return async (req, res, options = {}): Promise<void> => { |
|  |  | assertReqRes(req, res); |
|  |  | if (req.query.returnTo) { |
|  |  | const returnTo = Array.isArray(req.query.returnTo) ? req.query.returnTo[0] : req.query.returnTo; |
|  |  | try { |
|  |  | assertReqRes(req, res); |
|  |  | if (req.query.returnTo) { |
|  |  | const returnTo = Array.isArray(req.query.returnTo) ? req.query.returnTo[0] : req.query.returnTo; |
|  |  |  |
|  |  | if (!isSafeRedirect(returnTo)) { |
|  |  | throw new Error('Invalid value provided for returnTo, must be a relative url'); |
|  |  | if (!isSafeRedirect(returnTo)) { |
|  |  | throw new Error('Invalid value provided for returnTo, must be a relative url'); |
|  |  | } |
|  |  |  |
|  |  | options = { ...options, returnTo }; |
|  |  | } |
|  |  | if (nextConfig.organization) { |
|  |  | options = { |
|  |  | ...options, |
|  |  | authorizationParams: { organization: nextConfig.organization, ...options.authorizationParams } |
|  |  | }; |
|  |  | } |
|  |  |  |
|  |  | options = { ...options, returnTo }; |
|  |  | return await handler(req, res, options); |
|  |  | } catch (e) { |
|  |  | throw new HandlerError(e); |
|  |  | } |
|  |  | if (nextConfig.organization) { |
|  |  | options = { |
|  |  | ...options, |
|  |  | authorizationParams: { organization: nextConfig.organization, ...options.authorizationParams } |
|  |  | }; |
|  |  | } |
|  |  |  |
|  |  | return handler(req, res, options); |
|  |  | }; |
|  |  | } |

9 changes: 7 additions & 2 deletions

9
[src/handlers/logout.ts](#diff-91790d5e04b352a4eacb60d61c5bac0c212b2e3914570dccf3404a8bc68f0a10 "src/handlers/logout.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/src/handlers/logout.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,7 @@ |
|  |  | import { NextApiResponse, NextApiRequest } from 'next'; |
|  |  | import { HandleLogout as BaseHandleLogout } from '../auth0-session'; |
|  |  | import { assertReqRes } from '../utils/assert'; |
|  |  | import { HandlerError } from '../utils/errors'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Custom options to pass to logout. |
| Expand All | | @@ -27,7 +28,11 @@ export type HandleLogout = (req: NextApiRequest, res: NextApiResponse, options?: |
|  |  | \*/ |
|  |  | export default function handleLogoutFactory(handler: BaseHandleLogout): HandleLogout { |
|  |  | return async (req, res, options): Promise<void> => { |
|  |  | assertReqRes(req, res); |
|  |  | return handler(req, res, options); |
|  |  | try { |
|  |  | assertReqRes(req, res); |
|  |  | return await handler(req, res, options); |
|  |  | } catch (e) { |
|  |  | throw new HandlerError(e); |
|  |  | } |
|  |  | }; |
|  |  | } |

67 changes: 36 additions & 31 deletions

67
[src/handlers/profile.ts](#diff-5bb646f096212429146206c1074fd3d01bc5fbee16513ce1782bd1c083e22ce2 "src/handlers/profile.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/src/handlers/profile.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ import { NextApiResponse, NextApiRequest } from 'next'; |
|  |  | import { ClientFactory } from '../auth0-session'; |
|  |  | import { SessionCache, Session, fromJson, GetAccessToken } from '../session'; |
|  |  | import { assertReqRes } from '../utils/assert'; |
|  |  | import { HandlerError } from '../utils/errors'; |
|  |  |  |
|  |  | export type AfterRefetch = (req: NextApiRequest, res: NextApiResponse, session: Session) => Promise<Session> | Session; |
|  |  |  |
| Expand Down  Expand Up | | @@ -39,46 +40,50 @@ export default function profileHandler( |
|  |  | sessionCache: SessionCache |
|  |  | ): HandleProfile { |
|  |  | return async (req, res, options): Promise<void> => { |
|  |  | assertReqRes(req, res); |
|  |  | try { |
|  |  | assertReqRes(req, res); |
|  |  |  |
|  |  | if (!sessionCache.isAuthenticated(req, res)) { |
|  |  | res.status(401).json({ |
|  |  | error: 'not\_authenticated', |
|  |  | description: 'The user does not have an active session or is not authenticated' |
|  |  | }); |
|  |  | return; |
|  |  | } |
|  |  | if (!sessionCache.isAuthenticated(req, res)) { |
|  |  | res.status(401).json({ |
|  |  | error: 'not\_authenticated', |
|  |  | description: 'The user does not have an active session or is not authenticated' |
|  |  | }); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | const session = sessionCache.get(req, res) as Session; |
|  |  | res.setHeader('Cache-Control', 'no-store'); |
|  |  | const session = sessionCache.get(req, res) as Session; |
|  |  | res.setHeader('Cache-Control', 'no-store'); |
|  |  |  |
|  |  | if (options?.refetch) { |
|  |  | const { accessToken } = await getAccessToken(req, res); |
|  |  | if (!accessToken) { |
|  |  | throw new Error('No access token available to refetch the profile'); |
|  |  | } |
|  |  | if (options?.refetch) { |
|  |  | const { accessToken } = await getAccessToken(req, res); |
|  |  | if (!accessToken) { |
|  |  | throw new Error('No access token available to refetch the profile'); |
|  |  | } |
|  |  |  |
|  |  | const client = await getClient(); |
|  |  | const userInfo = await client.userinfo(accessToken); |
|  |  | const client = await getClient(); |
|  |  | const userInfo = await client.userinfo(accessToken); |
|  |  |  |
|  |  | let newSession = fromJson({ |
|  |  | ...session, |
|  |  | user: { |
|  |  | ...session.user, |
|  |  | ...userInfo |
|  |  | let newSession = fromJson({ |
|  |  | ...session, |
|  |  | user: { |
|  |  | ...session.user, |
|  |  | ...userInfo |
|  |  | } |
|  |  | }) as Session; |
|  |  |  |
|  |  | if (options.afterRefetch) { |
|  |  | newSession = await options.afterRefetch(req, res, newSession); |
|  |  | } |
|  |  | }) as Session; |
|  |  |  |
|  |  | if (options.afterRefetch) { |
|  |  | newSession = await options.afterRefetch(req, res, newSession); |
|  |  | } |
|  |  | sessionCache.set(req, res, newSession); |
|  |  |  |
|  |  | sessionCache.set(req, res, newSession); |
|  |  | res.json(newSession.user); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | res.json(newSession.user); |
|  |  | return; |
|  |  | res.json(session.user); |
|  |  | } catch (e) { |
|  |  | throw new HandlerError(e); |
|  |  | } |
|  |  |  |
|  |  | res.json(session.user); |
|  |  | }; |
|  |  | } |

43 changes: 43 additions & 0 deletions

43
[src/utils/errors.ts](#diff-d3b5d70cc2b50e2667c6d9c24da50c9d14582360145b2ba8b171127e787f03d9 "src/utils/errors.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/src/utils/errors.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,5 @@ |
|  |  | import { HttpError } from 'http-errors'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The error thrown by {@link GetAccessToken} |
|  |  | \* |
| Expand All | | @@ -19,3 +21,44 @@ export class AccessTokenError extends Error { |
|  |  | this.code = code; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // eslint-disable-next-line max-len |
|  |  | // Basic escaping for putting untrusted data directly into the HTML body, per: https://cheatsheetseries.owasp.org/cheatsheets/Cross\_Site\_Scripting\_Prevention\_Cheat\_Sheet.html#rule-1-html-encode-before-inserting-untrusted-data-into-html-element-content |
|  |  | function htmlSafe(input: string): string { |
|  |  | return input |
|  |  | .replace(/&/g, '&amp;') |
|  |  | .replace(/</g, '&lt;') |
|  |  | .replace(/>/g, '&gt;') |
|  |  | .replace(/"/g, '&quot;') |
|  |  | .replace(/'/g, '&#39;'); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The error thrown by API route handlers. |
|  |  | \* |
|  |  | \* Because the error message can come from the OpenID Connect `error` query parameter we |
|  |  | \* do some basic escaping which makes sure the default error handler is safe from XSS. |
|  |  | \* |
|  |  | \* If you write your own error handler, you should \*\*not\*\* render the error message |
|  |  | \* without using a templating engine that will properly escape it for other HTML contexts first. |
|  |  | \* |
|  |  | \* @category Server |
|  |  | \*/ |
|  |  | export class HandlerError extends Error { |
|  |  | public status: number | undefined; |
|  |  | public code: string | undefined; |
|  |  |  |
|  |  | constructor(error: Error | AccessTokenError | HttpError) { |
|  |  | super(htmlSafe(error.message)); |
|  |  |  |
|  |  | this.name = error.name; |
|  |  |  |
|  |  | if ('code' in error) { |
|  |  | this.code = error.code; |
|  |  | } |
|  |  |  |
|  |  | if ('status' in error) { |
|  |  | this.status = error.status; |
|  |  | } |
|  |  | } |
|  |  | } |

2 changes: 1 addition & 1 deletion

2
[tests/auth0-session/handlers/callback.test.ts](#diff-9023d903a53ea713a007449ef5aa0aaf2ad9d6c996bf61819c3fde54857fc203 "tests/auth0-session/handlers/callback.test.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/tests/auth0-session/handlers/callback.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -377,7 +377,7 @@ describe('callback', () => { |
|  |  | const redirectUri = 'http://messi:3000/api/auth/callback/runtime'; |
|  |  | const baseURL = await setup(defaultConfig, { callbackOptions: { redirectUri } }); |
|  |  | const state = encodeState({ foo: 'bar' }); |
|  |  | const cookieJar = toSignedCookieJar( { state, nonce: '\_\_test\_nonce\_\_' }, baseURL); |
|  |  | const cookieJar = toSignedCookieJar({ state, nonce: '\_\_test\_nonce\_\_' }, baseURL); |
|  |  | const { res } = await post(baseURL, '/callback', { |
|  |  | body: { |
|  |  | state: state, |
| Expand Down | |  |

12 changes: 11 additions & 1 deletion

12
[tests/fixtures/oidc-nocks.ts](#diff-3f02253d958d991a8465d068390a5364311ff315723bfefbd52e6624d7405cf9 "tests/fixtures/oidc-nocks.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/tests/fixtures/oidc-nocks.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,16 @@ import { ConfigParameters } from '../../src'; |
|  |  | import { makeIdToken } from '../auth0-session/fixtures/cert'; |
|  |  |  |
|  |  | export function discovery(params: ConfigParameters, discoveryOptions?: any): nock.Scope { |
|  |  | const { error, ...metadata } = discoveryOptions || {}; |
|  |  |  |
|  |  | if (error) { |
|  |  | return nock(params.issuerBaseURL as string) |
|  |  | .get('/.well-known/openid-configuration') |
|  |  | .reply(500, { error }) |
|  |  | .get('/.well-known/oauth-authorization-server') |
|  |  | .reply(500, { error }); |
|  |  | } |
|  |  |  |
|  |  | return nock(params.issuerBaseURL as string) |
|  |  | .get('/.well-known/openid-configuration') |
|  |  | .reply(200, () => { |
| Expand Down  Expand Up | | @@ -50,7 +60,7 @@ export function discovery(params: ConfigParameters, discoveryOptions?: any): noc |
|  |  | 'picture', |
|  |  | 'sub' |
|  |  | ], |
|  |  | ...(discoveryOptions || {}) |
|  |  | ...metadata |
|  |  | }; |
|  |  | }); |
|  |  | } |
| Expand Down | |  |

11 changes: 10 additions & 1 deletion

11
[tests/handlers/callback.test.ts](#diff-6e89c251ba6765e2e39f30fa1643e196fa39fdbd3875c48d8a28b452109bd346 "tests/handlers/callback.test.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/tests/handlers/callback.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -89,6 +89,13 @@ describe('callback handler', () => { |
|  |  | ).rejects.toThrow('unexpected iss value, expected https://acme.auth0.local/, got: other-issuer'); |
|  |  | }); |
|  |  |  |
|  |  | it('should escape html in error qp', async () => { |
|  |  | const baseUrl = await setup(withoutApi); |
|  |  | await expect(get(baseUrl, `/api/auth/callback?error=%3Cscript%3Ealert(%27xss%27)%3C%2Fscript%3E`)).rejects.toThrow( |
|  |  | '&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;' |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | test('should create the session without OIDC claims', async () => { |
|  |  | const baseUrl = await setup(withoutApi); |
|  |  | const state = encodeState({ returnTo: baseUrl }); |
| Expand Down  Expand Up | | @@ -322,7 +329,9 @@ describe('callback handler', () => { |
|  |  | }, |
|  |  | cookieJar |
|  |  | ) |
|  |  | ).rejects.toThrow('Organization Id (org\_id) claim value mismatch in the ID token; expected "foo", found "bar"'); |
|  |  | ).rejects.toThrow( |
|  |  | 'Organization Id (org\_id) claim value mismatch in the ID token; expected &quot;foo&quot;, found &quot;bar&quot;' |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | test('accepts a valid organization', async () => { |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[tests/handlers/login.test.ts](#diff-c944342fbf9ccb28a9920b0a4e4422c8e0bd152792e2304afa78432ca713c909 "tests/handlers/login.test.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/tests/handlers/login.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -244,6 +244,14 @@ describe('login handler', () => { |
|  |  | ).rejects.toThrow('Invalid value provided for returnTo, must be a relative url'); |
|  |  | }); |
|  |  |  |
|  |  | test('should escape html in errors', async () => { |
|  |  | const baseUrl = await setup(withoutApi, { discoveryOptions: { error: '<script>alert("xss")</script>' } }); |
|  |  |  |
|  |  | await expect(get(baseUrl, '/api/auth/login', { fullResponse: true })).rejects.toThrow( |
|  |  | '&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;' |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | test('should allow the returnTo to be be overwritten by getState() when provided in the querystring', async () => { |
|  |  | const loginOptions = { |
|  |  | returnTo: '/profile', |
| Expand Down | |  |

20 changes: 19 additions & 1 deletion

20
[tests/handlers/logout.test.ts](#diff-b6a5c69b9ab2d79003cdb54cfd874482d745755baab854b82f9d5c228bd95b13 "tests/handlers/logout.test.ts")

Show comments

[View file](/auth0/nextjs-auth0/blob/6996e2528ceed98627caa28abafbc09e90163ccf/tests/handlers/logout.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,17 @@ |
|  |  | import { parse } from 'cookie'; |
|  |  | import { parse as parseUrl } from 'url'; |
|  |  | import { parse as parseUrl, URL } from 'url'; |
|  |  | import { withoutApi } from '../fixtures/default-settings'; |
|  |  | import { setup, teardown, login } from '../fixtures/setup'; |
|  |  | import { IncomingMessage } from 'http'; |
|  |  |  |
|  |  | jest.mock('../../src/utils/assert', () => ({ |
|  |  | assertReqRes(req: IncomingMessage) { |
|  |  | if (req.url?.includes('error=')) { |
|  |  | const url = new URL(req.url, 'http://example.com'); |
|  |  | throw new Error(url.searchParams.get('error') as string); |
|  |  | } |
|  |  | } |
|  |  | })); |
|  |  |  |
|  |  | describe('logout handler', () => { |
|  |  | afterEach(teardown); |
| Expand Down  Expand Up | | @@ -88,4 +98,12 @@ describe('logout handler', () => { |
|  |  | Path: '/' |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | test('should escape html in errors', async () => { |
|  |  | const baseUrl = await setup(withoutApi); |
|  |  |  |
|  |  | const res = await fetch(`${baseUrl}/api/auth/logout?error=%3Cscript%3Ealert(%27xss%27)%3C%2Fscript%3E`); |
|  |  |  |
|  |  | expect(await res.text()).toEqual('&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;'); |
|  |  | }); |
|  |  | }); |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6996e25`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fauth0%2Fnextjs-auth0%2Fcommit%2F6996e2528ceed98627caa28abafbc09e90163ccf) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_310bd409_20250114_215531.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fauth0%2Fnextjs-auth0%2Fsecurity%2Fadvisories%2FGHSA-954c-jjx6-cxv7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fauth0%2Fnextjs-auth0%2Fsecurity%2Fadvisories%2FGHSA-954c-jjx6-cxv7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=auth0%2Fnextjs-auth0)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[auth0](/auth0)
/
**[nextjs-auth0](/auth0/nextjs-auth0)**
Public

* [Notifications](/login?return_to=%2Fauth0%2Fnextjs-auth0) You must be signed in to change notification settings
* [Fork
  398](/login?return_to=%2Fauth0%2Fnextjs-auth0)
* [Star
   2.1k](/login?return_to=%2Fauth0%2Fnextjs-auth0)

* [Code](/auth0/nextjs-auth0)
* [Issues
  50](/auth0/nextjs-auth0/issues)
* [Pull requests
  25](/auth0/nextjs-auth0/pulls)
* [Actions](/auth0/nextjs-auth0/actions)
* [Security](/auth0/nextjs-auth0/security)
* [Insights](/auth0/nextjs-auth0/pulse)

Additional navigation options

* [Code](/auth0/nextjs-auth0)
* [Issues](/auth0/nextjs-auth0/issues)
* [Pull requests](/auth0/nextjs-auth0/pulls)
* [Actions](/auth0/nextjs-auth0/actions)
* [Security](/auth0/nextjs-auth0/security)
* [Insights](/auth0/nextjs-auth0/pulse)

# Reflected XSS from the callback handler's error query parameter

High

[lzychowski](/lzychowski)
published
GHSA-954c-jjx6-cxv7
Jun 25, 2021

## Package

npm

@auth0/nextjs-auth0
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 1.4.1

## Patched versions

1.4.2

## Description

### Overview

Versions before and including `1.4.1` are vulnerable to reflected XSS. An attacker can execute arbitrary code by providing an XSS payload in the `error` query parameter which is then processed by the callback handler as an error message.

### Am I affected?

You are affected by this vulnerability if you are using `@auth0/nextjs-auth0` version `1.4.1` or lower **unless** you are using custom error handling that does not return the error message in an HTML response.

### How to fix that?

Upgrade to version `1.4.2`.

### Will this update impact my users?

The fix adds basic HTML escaping to the error message and it should not impact your users.

### Credit

<https://github.com/inian>

<https://github.com/git-ishanpatel>

### Severity

High

### CVE ID

CVE-2021-32702

### Weaknesses

No CWEs

### Credits

* [![@inian](https://avatars.githubusercontent.com/u/2155545?s=40&v=4)](/inian)
  [inian](/inian)
  Analyst
* [![@git-ishanpatel](https://avatars.githubusercontent.com/u/52318184?s=40&v=4)](/git-ishanpatel)
  [git-ishanpatel](/git-ishanpatel)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


