- **Root cause of vulnerability:** A heap-buffer-overflow occurs in the `gnode_function_add_upvalue` function in `gravity_ast.c` at line 90, column 41. This is due to an out-of-bounds read operation when adding upvalues to a function node.
- **Weaknesses/vulnerabilities present:** Heap-buffer-overflow. The code reads beyond the allocated buffer.
- **Impact of exploitation:** This heap-buffer-overflow can cause a crash (abort) due to memory corruption. The provided backtrace shows the program aborting during a `free()` operation due to invalid memory.
- **Attack vectors:** The vulnerability is triggered during the parsing and semantic checking of the gravity language source code. The specific input provided in the attached zip file (`heap-overflow-gnode_function_add_upvalue-gravity_ast-90.zip`) is required to reproduce the vulnerability, which includes the sequence of tokens that leads to the overflow.
- **Required attacker capabilities/position:** The attacker needs the ability to provide malicious source code to be compiled by the vulnerable gravity compiler. This could be in the form of a malicious file or program passed as input to the compiler.

The provided content offers more detail than a typical CVE description. It includes the specific file and line number where the vulnerability occurs, a detailed backtrace, AddressSanitizer output, and a proof-of-concept input, as well as the commit that fixed the vulnerability.