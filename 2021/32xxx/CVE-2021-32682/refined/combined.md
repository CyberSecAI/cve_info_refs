=== Content from packetstormsecurity.com_ee52a94b_20250114_191007.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_ff54261d_20250114_191012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2Fa106c350b7dfe666a81d6b576816db9fe0899b17)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2Fa106c350b7dfe666a81d6b576816db9fe0899b17)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Studio-42%2FelFinder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Studio-42](/Studio-42)
/
**[elFinder](/Studio-42/elFinder)**
Public

* [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FStudio-42%2FelFinder)
* [Star
   4.7k](/login?return_to=%2FStudio-42%2FelFinder)

* [Code](/Studio-42/elFinder)
* [Issues
  4](/Studio-42/elFinder/issues)
* [Pull requests
  6](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

Additional navigation options

* [Code](/Studio-42/elFinder)
* [Issues](/Studio-42/elFinder/issues)
* [Pull requests](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

## Commit

[Permalink](/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-wph3-44rj-92pr](https://github.com/advisories/GHSA-wph3-44rj-92pr "GHSA-wph3-44rj-92pr")

[Browse files](/Studio-42/elFinder/tree/a106c350b7dfe666a81d6b576816db9fe0899b17)
Browse the repository at this point in the history

```
* [php] fix multiple vulnerabilities

* fix archiver args

* fix remote Code Execution of zip command

* re-fix remote Code Execution of zip command

* re-fix Improper hostname validation in upload and put

* re-fix Directory traversal in the actions mkfile and mkdir

* Add check targets in archive()
```

* Loading branch information

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=40&v=4)](/nao-pon)

[nao-pon](/Studio-42/elFinder/commits?author=nao-pon "View all commits by nao-pon")
authored
Jun 13, 2021

1 parent
[60d1d76](/Studio-42/elFinder/commit/60d1d767659b22481315bea4faf252b8dfdd027d)

commit a106c35

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**195 additions**
and
**77 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* php

  + php/elFinder.class.php
    [elFinder.class.php](#diff-04f98f21868afa1336257a8d6761fd6709e4530c8e53425386e393c035430db6)
  + php/elFinderVolumeDriver.class.php
    [elFinderVolumeDriver.class.php](#diff-85602823cf2cdaf2502dc4f1b97001ffc0f083652aef175d9f068a5bfe90ca71)
  + php/elFinderVolumeLocalFileSystem.class.php
    [elFinderVolumeLocalFileSystem.class.php](#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904)
  + php/elFinderVolumeSFTPphpseclib.class.php
    [elFinderVolumeSFTPphpseclib.class.php](#diff-0da80455e2b374072aebf9c02aa5c51ebe84f82635e07639f2904bfb32dfe806)

## There are no files selected for viewing

213 changes: 153 additions & 60 deletions

213
[php/elFinder.class.php](#diff-04f98f21868afa1336257a8d6761fd6709e4530c8e53425386e393c035430db6 "php/elFinder.class.php")

Show comments

[View file](/Studio-42/elFinder/blob/a106c350b7dfe666a81d6b576816db9fe0899b17/php/elFinder.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -419,6 +419,21 @@ class elFinder |
|  |  | \*/ |
|  |  | protected $removeContentSaveIds = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* LAN class allowed when uploading via URL |
|  |  | \* |
|  |  | \* Array keys are 'local', 'private\_a', 'private\_b', 'private\_c' and 'link' |
|  |  | \* |
|  |  | \* local: 127.0.0.0/8 |
|  |  | \* private\_a: 10.0.0.0/8 |
|  |  | \* private\_b: 172.16.0.0/12 |
|  |  | \* private\_c: 192.168.0.0/16 |
|  |  | \* link: 169.254.0.0/16 |
|  |  | \* |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $uploadAllowedLanIpClasses = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Flag of throw Error on exec() |
|  |  | \* |
| Expand Down  Expand Up | | @@ -713,6 +728,10 @@ public function \_\_construct($opts) |
|  |  | $this->itemLockExpire = intval($opts['itemLockExpire']); |
|  |  | } |
|  |  |  |
|  |  | if (!empty($opts['uploadAllowedLanIpClasses'])) { |
|  |  | $this->uploadAllowedLanIpClasses = array\_flip($opts['uploadAllowedLanIpClasses']); |
|  |  | } |
|  |  |  |
|  |  | // deprecated settings |
|  |  | $this->netVolumesSessionKey = !empty($opts['netVolumesSessionKey']) ? $opts['netVolumesSessionKey'] : 'elFinderNetVolumes'; |
|  |  | self::$sessionCacheKey = !empty($opts['sessionCacheKey']) ? $opts['sessionCacheKey'] : 'elFinderCaches'; |
| Expand Down  Expand Up | | @@ -2524,16 +2543,87 @@ protected function abort($args = array()) |
|  |  | } |
|  |  | $flagFile = elFinder::$connectionFlagsPath . DIRECTORY\_SEPARATOR . 'elfreq%s'; |
|  |  | if (!empty($args['makeFile'])) { |
|  |  | self::$abortCheckFile = sprintf($flagFile, $args['makeFile']); |
|  |  | self::$abortCheckFile = sprintf($flagFile, self::filenameDecontaminate($args['makeFile'])); |
|  |  | touch(self::$abortCheckFile); |
|  |  | $GLOBALS['elFinderTempFiles'][self::$abortCheckFile] = true; |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | $file = !empty($args['id']) ? sprintf($flagFile, $args['id']) : self::$abortCheckFile; |
|  |  | $file = !empty($args['id']) ? sprintf($flagFile, self::filenameDecontaminate($args['id'])) : self::$abortCheckFile; |
|  |  | $file && is\_file($file) && unlink($file); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Validate an URL to prevent SSRF attacks. |
|  |  | \* |
|  |  | \* To prevent any risk of DNS rebinding, always use the IP address resolved by |
|  |  | \* this method, as returned in the array entry `ip`. |
|  |  | \* |
|  |  | \* @param string $url |
|  |  | \* |
|  |  | \* @return false|array |
|  |  | \*/ |
|  |  | protected function validate\_address($url) |
|  |  | { |
|  |  | $info = parse\_url($url); |
|  |  | $host = trim(strtolower($info['host']), '.'); |
|  |  | // do not support IPv6 address |
|  |  | if (preg\_match('/^\[.\*\]$/', $host)) { |
|  |  | return false; |
|  |  | } |
|  |  | // do not support non dot host |
|  |  | if (strpos($host, '.') === false) { |
|  |  | return false; |
|  |  | } |
|  |  | // do not support URL-encoded host |
|  |  | if (strpos($host, '%') !== false) { |
|  |  | return false; |
|  |  | } |
|  |  | // disallow including "localhost" and "localdomain" |
|  |  | if (preg\_match('/\b(?:localhost|localdomain)\b/', $host)) { |
|  |  | return false; |
|  |  | } |
|  |  | // check IPv4 local loopback, private network and link local |
|  |  | $ip = gethostbyname($host); |
|  |  | if (preg\_match('/^0x[0-9a-f]+|[0-9]+(?:\.(?:0x[0-9a-f]+|[0-9]+)){1,3}$/', $ip, $m)) { |
|  |  | $long = (int)sprintf('%u', ip2long($ip)); |
|  |  | if (!$long) { |
|  |  | return false; |
|  |  | } |
|  |  | $local = (int)sprintf('%u', ip2long('127.255.255.255')) >> 24; |
|  |  | $prv1 = (int)sprintf('%u', ip2long('10.255.255.255')) >> 24; |
|  |  | $prv2 = (int)sprintf('%u', ip2long('172.31.255.255')) >> 20; |
|  |  | $prv3 = (int)sprintf('%u', ip2long('192.168.255.255')) >> 16; |
|  |  | $link = (int)sprintf('%u', ip2long('169.254.255.255')) >> 16; |
|  |  |  |
|  |  | if (!isset($this->uploadAllowedLanIpClasses['local']) && $long >> 24 === $local) { |
|  |  | return false; |
|  |  | } |
|  |  | if (!isset($this->uploadAllowedLanIpClasses['private\_a']) && $long >> 24 === $prv1) { |
|  |  | return false; |
|  |  | } |
|  |  | if (!isset($this->uploadAllowedLanIpClasses['private\_b']) && $long >> 20 === $prv2) { |
|  |  | return false; |
|  |  | } |
|  |  | if (!isset($this->uploadAllowedLanIpClasses['private\_c']) && $long >> 16 === $prv3) { |
|  |  | return false; |
|  |  | } |
|  |  | if (!isset($this->uploadAllowedLanIpClasses['link']) && $long >> 16 === $link) { |
|  |  | return false; |
|  |  | } |
|  |  | $info['ip'] = long2ip($long); |
|  |  | if (!isset($info['port'])) { |
|  |  | $info['port'] = $info['scheme'] === 'https' ? 443 : 80; |
|  |  | } |
|  |  | if (!isset($info['path'])) { |
|  |  | $info['path'] = '/'; |
|  |  | } |
|  |  | return $info; |
|  |  | } else { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get remote contents |
|  |  | \* |
| Expand All | | @@ -2552,54 +2642,20 @@ protected function abort($args = array()) |
|  |  | protected function get\_remote\_contents(&$url, $timeout = 30, $redirect\_max = 5, $ua = 'Mozilla/5.0', $fp = null) |
|  |  | { |
|  |  | if (preg\_match('~^(?:ht|f)tps?://[-\_.!\~\*\'()a-z0-9;/?:\@&=+\$,%#\\*\[\]]+~i', $url)) { |
|  |  | $info = parse\_url($url); |
|  |  | $host = trim(strtolower($info['host']), '.'); |
|  |  | // do not support IPv6 address |
|  |  | if (preg\_match('/^\[.\*\]$/', $host)) { |
|  |  | return false; |
|  |  | } |
|  |  | // do not support non dot host |
|  |  | if (strpos($host, '.') === false) { |
|  |  | return false; |
|  |  | } |
|  |  | // do not support URL-encoded host |
|  |  | if (strpos($host, '%') !== false) { |
|  |  | $info = $this->validate\_address($url); |
|  |  | if ($info === false) { |
|  |  | return false; |
|  |  | } |
|  |  | // disallow including "localhost" and "localdomain" |
|  |  | if (preg\_match('/\b(?:localhost|localdomain)\b/', $host)) { |
|  |  | return false; |
|  |  | } |
|  |  | // wildcard DNS (e.g xip.io) |
|  |  | if (preg\_match('/0x[0-9a-f]+|[0-9]+(?:\.(?:0x[0-9a-f]+|[0-9]+)){1,3}/', $host)) { |
|  |  | $host = gethostbyname($host); |
|  |  | } |
|  |  | // check IPv4 local loopback, private network and link local |
|  |  | if (preg\_match('/^0x[0-9a-f]+|[0-9]+(?:\.(?:0x[0-9a-f]+|[0-9]+)){1,3}$/', $host, $m)) { |
|  |  | $long = (int)sprintf('%u', ip2long($host)); |
|  |  | if (!$long) { |
|  |  | return false; |
|  |  | } |
|  |  | $local = (int)sprintf('%u', ip2long('127.255.255.255')) >> 24; |
|  |  | $prv1 = (int)sprintf('%u', ip2long('10.255.255.255')) >> 24; |
|  |  | $prv2 = (int)sprintf('%u', ip2long('172.31.255.255')) >> 20; |
|  |  | $prv3 = (int)sprintf('%u', ip2long('192.168.255.255')) >> 16; |
|  |  | $link = (int)sprintf('%u', ip2long('169.254.255.255')) >> 16; |
|  |  |  |
|  |  | if ($long >> 24 === $local || $long >> 24 === $prv1 || $long >> 20 === $prv2 || $long >> 16 === $prv3 || $long >> 16 === $link) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | // dose not support 'user' and 'pass' for security reasons |
|  |  | $url = $info['scheme'].'://'.$host.(!empty($info['port'])? (':'.$info['port']) : '').$info['path'].(!empty($info['query'])? ('?'.$info['query']) : '').(!empty($info['fragment'])? ('#'.$info['fragment']) : ''); |
|  |  | $url = $info['scheme'].'://'.$info['host'].(!empty($info['port'])? (':'.$info['port']) : '').$info['path'].(!empty($info['query'])? ('?'.$info['query']) : '').(!empty($info['fragment'])? ('#'.$info['fragment']) : ''); |
|  |  | // check by URL upload filter |
|  |  | if ($this->urlUploadFilter && is\_callable($this->urlUploadFilter)) { |
|  |  | if (!call\_user\_func\_array($this->urlUploadFilter, array($url, $this))) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | $method = (function\_exists('curl\_exec') && !ini\_get('safe\_mode') && !ini\_get('open\_basedir')) ? 'curl\_get\_contents' : 'fsock\_get\_contents'; |
|  |  | return $this->$method($url, $timeout, $redirect\_max, $ua, $fp); |
|  |  | $method = (function\_exists('curl\_exec')) ? 'curl\_get\_contents' : 'fsock\_get\_contents'; |
|  |  | return $this->$method($url, $timeout, $redirect\_max, $ua, $fp, $info); |
|  |  | } |
|  |  | return false; |
|  |  | } |
| Expand All | | @@ -2619,8 +2675,11 @@ protected function get\_remote\_contents(&$url, $timeout = 30, $redirect\_max = 5, |
|  |  | \* @retval false error |
|  |  | \* @author Naoki Sawada |
|  |  | \*\*/ |
|  |  | protected function curl\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp) |
|  |  | protected function curl\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp, $info) |
|  |  | { |
|  |  | if ($redirect\_max == 0) { |
|  |  | return false; |
|  |  | } |
|  |  | $ch = curl\_init(); |
|  |  | curl\_setopt($ch, CURLOPT\_URL, $url); |
|  |  | curl\_setopt($ch, CURLOPT\_HEADER, false); |
| Expand All | | @@ -2633,11 +2692,19 @@ protected function curl\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp |
|  |  | curl\_setopt($ch, CURLOPT\_LOW\_SPEED\_LIMIT, 1); |
|  |  | curl\_setopt($ch, CURLOPT\_LOW\_SPEED\_TIME, $timeout); |
|  |  | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, false); |
|  |  | curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, 1); |
|  |  | curl\_setopt($ch, CURLOPT\_MAXREDIRS, $redirect\_max); |
|  |  | curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, false); |
|  |  | curl\_setopt($ch, CURLOPT\_USERAGENT, $ua); |
|  |  | curl\_setopt($ch, CURLOPT\_RESOLVE, [$info['host'] . ':' . $info['port'] . ':' . $info['ip']]); |
|  |  | $result = curl\_exec($ch); |
|  |  | $url = curl\_getinfo($ch, CURLINFO\_EFFECTIVE\_URL); |
|  |  | $http\_code = curl\_getinfo($ch, CURLINFO\_HTTP\_CODE); |
|  |  | if ($http\_code == 301 || $http\_code == 302) { |
|  |  | $new\_url = curl\_getinfo($ch, CURLINFO\_REDIRECT\_URL); |
|  |  | $info = $this->validate\_address($new\_url); |
|  |  | if ($info === false) { |
|  |  | return false; |
|  |  | } |
|  |  | return $this->curl\_get\_contents($new\_url, $timeout, $redirect\_max - 1, $ua, $outfp, $info); |
|  |  | } |
|  |  | curl\_close($ch); |
|  |  | return $outfp ? $outfp : $result; |
|  |  | } |
| Expand All | | @@ -2658,7 +2725,7 @@ protected function curl\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp |
|  |  | \* @throws elFinderAbortException |
|  |  | \* @author Naoki Sawada |
|  |  | \*/ |
|  |  | protected function fsock\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp) |
|  |  | protected function fsock\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outfp, $info) |
|  |  | { |
|  |  | $connect\_timeout = 3; |
|  |  | $connect\_try = 3; |
| Expand All | | @@ -2669,22 +2736,15 @@ protected function fsock\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outf |
|  |  | $getSize = null; |
|  |  | $headers = ''; |
|  |  |  |
|  |  | $arr = parse\_url($url); |
|  |  | if (!$arr) { |
|  |  | // Bad request |
|  |  | return false; |
|  |  | } |
|  |  | $arr = $info; |
|  |  | if ($arr['scheme'] === 'https') { |
|  |  | $ssl = 'ssl://'; |
|  |  | } |
|  |  |  |
|  |  | // query |
|  |  | $arr['query'] = isset($arr['query']) ? '?' . $arr['query'] : ''; |
|  |  | // port |
|  |  | $port = isset($arr['port']) ? $arr['port'] : ''; |
|  |  | $arr['port'] = $port ? $port : ($ssl ? 443 : 80); |
|  |  |  |
|  |  | $url\_base = $arr['scheme'] . '://' . $arr['host'] . ($port ? (':' . $port) : ''); |
|  |  | $url\_base = $arr['scheme'] . '://' . $info['host'] . ':' . $info['port']; |
|  |  | $url\_path = isset($arr['path']) ? $arr['path'] : '/'; |
|  |  | $uri = $url\_path . $arr['query']; |
|  |  |  |
| Expand Down  Expand Up | | @@ -2765,7 +2825,11 @@ protected function fsock\_get\_contents(&$url, $timeout, $redirect\_max, $ua, $outf |
|  |  | sleep(1); |
|  |  | } |
|  |  | fclose($fp); |
|  |  | return $this->fsock\_get\_contents($url, $timeout, $redirect\_max, $ua, $outfp); |
|  |  | $info = $this->validate\_address($url); |
|  |  | if ($info === false) { |
|  |  | return false; |
|  |  | } |
|  |  | return $this->fsock\_get\_contents($url, $timeout, $redirect\_max, $ua, $outfp, $info); |
|  |  | } |
|  |  | break; |
|  |  | case 200: |
| Expand Down  Expand Up | | @@ -3831,7 +3895,8 @@ protected function archive($args) |
|  |  | $targets = isset($args['targets']) && is\_array($args['targets']) ? $args['targets'] : array(); |
|  |  | $name = isset($args['name']) ? $args['name'] : ''; |
|  |  |  |
|  |  | if (($volume = $this->volume($targets[0])) == false) { |
|  |  | $targets = array\_filter($targets, array($this, 'volume')); |
|  |  | if (!$targets || ($volume = $this->volume($targets[0])) === false) { |
|  |  | return $this->error(self::ERROR\_ARCHIVE, self::ERROR\_TRGDIR\_NOT\_FOUND); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -4339,7 +4404,7 @@ protected function itemLocked($hash) |
|  |  | if (!elFinder::$commonTempPath) { |
|  |  | return false; |
|  |  | } |
|  |  | $lock = elFinder::$commonTempPath . DIRECTORY\_SEPARATOR . $hash . '.lock'; |
|  |  | $lock = elFinder::$commonTempPath . DIRECTORY\_SEPARATOR . self::filenameDecontaminate($hash) . '.lock'; |
|  |  | if (file\_exists($lock)) { |
|  |  | if (filemtime($lock) + $this->itemLockExpire < time()) { |
|  |  | unlink($lock); |
| Expand Down  Expand Up | | @@ -4368,7 +4433,7 @@ protected function itemLock($hashes, $autoUnlock = true) |
|  |  | $hashes = array($hashes); |
|  |  | } |
|  |  | foreach ($hashes as $hash) { |
|  |  | $lock = elFinder::$commonTempPath . DIRECTORY\_SEPARATOR . $hash . '.lock'; |
|  |  | $lock = elFinder::$commonTempPath . DIRECTORY\_SEPARATOR . self::filenameDecontaminate($hash) . '.lock'; |
|  |  | if ($this->itemLocked($hash)) { |
|  |  | $cnt = file\_get\_contents($lock) + 1; |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -4519,6 +4584,16 @@ public static function getApiFullVersion() |
|  |  | return (string)self::$ApiVersion . '.' . (string)self::$ApiRevision; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return self::$commonTempPath |
|  |  | \* |
|  |  | \* @return string The common temporary path. |
|  |  | \*/ |
|  |  | public static function getCommonTempPath() |
|  |  | { |
|  |  | return self::$commonTempPath; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return Is Animation Gif |
|  |  | \* |
| Expand Down  Expand Up | | @@ -5104,6 +5179,24 @@ public static function expandMemoryForGD($imgInfos) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Decontaminate of filename |
|  |  | \* |
|  |  | \* @param String $name The name |
|  |  | \* |
|  |  | \* @return String Decontaminated filename |
|  |  | \*/ |
|  |  | public static function filenameDecontaminate($name) |
|  |  | { |
|  |  | // Directory traversal defense |
|  |  | if (DIRECTORY\_SEPARATOR === '\\') { |
|  |  | $name = str\_replace('\\', '/', $name); |
|  |  | } |
|  |  | $parts = explode('/', trim($name, '/')); |
|  |  | $name = array\_pop($parts); |
|  |  | return $name; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Execute shell command |
|  |  | \* |
| Expand Down  Expand Up | | @@ -5279,4 +5372,4 @@ class elFinderAbortException extends Exception |
|  |  |  |
|  |  | class elFinderTriggerException extends Exception |
|  |  | { |
|  |  | } |
|  |  | } |

20 changes: 13 additions & 7 deletions

20
[php/elFinderVolumeDriver.class.php](#diff-85602823cf2cdaf2502dc4f1b97001ffc0f083652aef175d9f068a5bfe90ca71 "php/elFinderVolumeDriver.class.php")

Show comments

[View file](/Studio-42/elFinder/blob/a106c350b7dfe666a81d6b576816db9fe0899b17/php/elFinderVolumeDriver.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5451,7 +5451,7 @@ protected function remove($path, $force = false) |
|  |  | $stat = $this->stat($path); |
|  |  |  |
|  |  | if (empty($stat)) { |
|  |  | return $this->setError(elFinder::ERROR\_RM, $path, elFinder::ERROR\_FILE\_NOT\_FOUND); |
|  |  | return $this->setError(elFinder::ERROR\_RM, $this->relpathCE($path), elFinder::ERROR\_FILE\_NOT\_FOUND); |
|  |  | } |
|  |  |  |
|  |  | $stat['realpath'] = $path; |
| Expand Down  Expand Up | | @@ -6727,7 +6727,7 @@ protected function getArchivers($use\_cache = true) |
|  |  | unset($o); |
|  |  | $this->procExec(ELFINDER\_RAR\_PATH, $o, $c); |
|  |  | if ($c == 0 || $c == 7) { |
|  |  | $arcs['create']['application/x-rar'] = array('cmd' => ELFINDER\_RAR\_PATH, 'argc' => 'a -inul' . (defined('ELFINDER\_RAR\_MA4') && ELFINDER\_RAR\_MA4? ' -ma4' : ''), 'ext' => 'rar'); |
|  |  | $arcs['create']['application/x-rar'] = array('cmd' => ELFINDER\_RAR\_PATH, 'argc' => 'a -inul' . (defined('ELFINDER\_RAR\_MA4') && ELFINDER\_RAR\_MA4? ' -ma4' : '') . ' --', 'ext' => 'rar'); |
|  |  | } |
|  |  | unset($o); |
|  |  | $this->procExec(ELFINDER\_UNRAR\_PATH, $o, $c); |
| Expand All | | @@ -6737,17 +6737,17 @@ protected function getArchivers($use\_cache = true) |
|  |  | unset($o); |
|  |  | $this->procExec(ELFINDER\_7Z\_PATH, $o, $c); |
|  |  | if ($c == 0) { |
|  |  | $arcs['create']['application/x-7z-compressed'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a', 'ext' => '7z'); |
|  |  | $arcs['create']['application/x-7z-compressed'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a --', 'ext' => '7z'); |
|  |  | $arcs['extract']['application/x-7z-compressed'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'x -y', 'ext' => '7z', 'toSpec' => '-o', 'getsize' => array('argc' => 'l', 'regex' => '/^.+(?:\r\n|\n|\r)[^\r\n0-9]+([0-9]+)[^\r\n]+$/s', 'replace' => '$1')); |
|  |  |  |
|  |  | if (empty($arcs['create']['application/zip'])) { |
|  |  | $arcs['create']['application/zip'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a -tzip', 'ext' => 'zip'); |
|  |  | $arcs['create']['application/zip'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a -tzip --', 'ext' => 'zip'); |
|  |  | } |
|  |  | if (empty($arcs['extract']['application/zip'])) { |
|  |  | $arcs['extract']['application/zip'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'x -tzip -y', 'ext' => 'zip', 'toSpec' => '-o', 'getsize' => array('argc' => 'l', 'regex' => '/^.+(?:\r\n|\n|\r)[^\r\n0-9]+([0-9]+)[^\r\n]+$/s', 'replace' => '$1')); |
|  |  | } |
|  |  | if (empty($arcs['create']['application/x-tar'])) { |
|  |  | $arcs['create']['application/x-tar'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a -ttar', 'ext' => 'tar'); |
|  |  | $arcs['create']['application/x-tar'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'a -ttar --', 'ext' => 'tar'); |
|  |  | } |
|  |  | if (empty($arcs['extract']['application/x-tar'])) { |
|  |  | $arcs['extract']['application/x-tar'] = array('cmd' => ELFINDER\_7Z\_PATH, 'argc' => 'x -ttar -y', 'ext' => 'tar', 'toSpec' => '-o', 'getsize' => array('argc' => 'l', 'regex' => '/^.+(?:\r\n|\n|\r)[^\r\n0-9]+([0-9]+)[^\r\n]+$/s', 'replace' => '$1')); |
| Expand Down  Expand Up | | @@ -6872,8 +6872,14 @@ protected function makeArchive($dir, $files, $name, $arc) |
|  |  | $files[$i] = '.' . DIRECTORY\_SEPARATOR . basename($file); |
|  |  | } |
|  |  | $files = array\_map('escapeshellarg', $files); |
|  |  |  |
|  |  | $cmd = $arc['cmd'] . ' ' . $arc['argc'] . ' ' . escapeshellarg($name) . ' ' . implode(' ', $files); |
|  |  | $prefix = $switch = ''; |
|  |  | // The zip command accepts the "-" at the beginning of the file name as a command switch, |
|  |  | // and can't use '--' before archive name, so add "./" to name for security reasons. |
|  |  | if ($arc['ext'] === 'zip' && strpos($arc['argc'], '-tzip') === false) { |
|  |  | $prefix = './'; |
|  |  | $switch = '-- '; |
|  |  | } |
|  |  | $cmd = $arc['cmd'] . ' ' . $arc['argc'] . ' ' . $prefix . escapeshellarg($name) . ' ' . $switch . implode(' ', $files); |
|  |  | $err\_out = ''; |
|  |  | $this->procExec($cmd, $o, $c, $err\_out, $dir); |
|  |  | chdir($cwd); |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a106c35`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2Fa106c350b7dfe666a81d6b576816db9fe0899b17) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f0f50a42_20250114_191013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fsecurity%2Fadvisories%2FGHSA-wph3-44rj-92pr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fsecurity%2Fadvisories%2FGHSA-wph3-44rj-92pr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Studio-42%2FelFinder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Studio-42](/Studio-42)
/
**[elFinder](/Studio-42/elFinder)**
Public

* [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FStudio-42%2FelFinder)
* [Star
   4.7k](/login?return_to=%2FStudio-42%2FelFinder)

* [Code](/Studio-42/elFinder)
* [Issues
  4](/Studio-42/elFinder/issues)
* [Pull requests
  6](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

Additional navigation options

* [Code](/Studio-42/elFinder)
* [Issues](/Studio-42/elFinder/issues)
* [Pull requests](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

# Multiple vulnerabilities leading to RCE

High

[nao-pon](/nao-pon)
published
GHSA-wph3-44rj-92pr
Jun 13, 2021

## Package

composer

studio-42/elfinder
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<= 2.1.58

## Patched versions

2.1.59

## Description

### Impact

We recently fixed several vulnerabilities affect elFinder 2.1.58. These vulnerabilities can allow an attacker to execute arbitrary code and commands on the server hosting the elFinder PHP connector, even with the minimal configuration.

### Patches

The issues were addressed in our last release, 2.1.59.

### Workarounds

If you can't update to 2.1.59, make sure your connector is not exposed without authentication.

### Reference

Further technical details will be disclosed on <https://blog.sonarsource.com/tag/security> after some time.

### For more information

If you have any questions or comments about this advisory, you can contact:

- The original reporters, by sending an email to vulnerability.research [at] sonarsource.com;

- The maintainers, by opening an issue on this repository.

### Severity

High

### CVE ID

CVE-2021-32682

### Weaknesses

No CWEs

### Credits

* [![@thomas-chauchefoin-sonarsource](https://avatars.githubusercontent.com/u/79814170?s=40&v=4)](/thomas-chauchefoin-sonarsource)
  [thomas-chauchefoin-sonarsource](/thomas-chauchefoin-sonarsource)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.sonarsource.com_4a6971b2_20250114_191008.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# elFinder - A Case Study of Web File Manager Vulnerabilities

![](data:image/svg+xml;charset=utf-8...)![Thomas Chauchefoin photo]()![Thomas Chauchefoin photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ddfcf9fd-16c2-4f57-8922-4198a01b5c2a/b0f43e1e-d67e-4bcf-a90c-0a1908c2b772_Thomas_Chauchefoin.jpg?w=800&h=800&auto=format&fit=crop)

Thomas Chauchefoin

Vulnerability Researcher

August 17, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![Our case study of elFinder 2.1.57 describes several critical code vulnerabilities commonly found in web file managers and how to patch them.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0b2f16b3-5e3a-4f36-b8f2-a303e0e4f74b/cover-287ee4a6-069f-4503-a54e-a156cf80dcfc_elFinder%2BBlogpost%2B%25402x.png?w=2400&h=1200&auto=format&fit=crop)![Our case study of elFinder 2.1.57 describes several critical code vulnerabilities commonly found in web file managers and how to patch them.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0b2f16b3-5e3a-4f36-b8f2-a303e0e4f74b/cover-287ee4a6-069f-4503-a54e-a156cf80dcfc_elFinder%2BBlogpost%2B%25402x.png?w=2400&h=1200&auto=format&fit=crop)

An application’s interaction with the file system is always highly security sensitive since minor functional bugs can easily be the source of exploitable vulnerabilities. This observation is especially true in the case of web file managers, whose role is to replicate the features of a complete file system and expose it to the client’s browser in a transparent way.

elFinder is a popular web file manager often used in CMS and frameworks, such as WordPress plugins (wp-file-manager) or Symfony bundles, to allow easy operations on both local and remote files. In the past, elFinder has been part of active in-the-wild attacks targeting unsafe configuration or actual code vulnerabilities. Thus, elFinder is published with a safe default configuration to prevent any malicious use by attackers.

As part of our regular assessment of widely deployed open-source projects, we discovered multiple new code vulnerabilities in elFinder. In the following case study of common code vulnerabilities in web file managers, we describe five different vulnerability chains and demonstrate how they could be exploited to gain control of the underlying server and its data. We will also discuss some of the patches that were later implemented by the vendor to show how to prevent them in your own code.

## Impact

We worked on the development branch, commit [f9c906d](https://github.com/Studio-42/elFinder/commit/f9c906d808d1721a62fc2a4fdb38d77c1c1ff229 "f9c906d"). Findings were also confirmed on release 2.1.57; all affect the default configuration (unless specified otherwise in this article) and do not require prior authentication. As we mentioned, the exploitation of these vulnerabilities can let an attacker execute arbitrary PHP code on the server where elFinder is installed, ultimately leading to its compromise.

The findings we discuss in this blog post (all assigned to CVE-2021-32682) and successfully exploited to gain code execution are:

* Deleting Arbitrary Files
* Moving Arbitrary Files
* Uploading PHP Files
* Argument Injection
* Race Condition

All these bug classes are very common in software that exposes filesystems to users, and are likely to impact a broad range of products, not only elFinder.

elFinder released version 2.1.59 to address all the bugs we responsibly disclosed. There is no doubt these vulnerabilities will also be exploited in the wild, because exploits [targeting old versions have been publicly released](https://www.exploit-db.com/search?text=connector.minimal.php "targeting old versions have been publicly released") and the connectors filenames are part of [compilations](https://github.com/koaj/ffw-content-discovery/blob/9bda1a1ebde71e84bcfde15c46524527bb24087f/cve-wordlist.txt "compilations") of paths to look for when trying to compromise websites. Hence, we highly recommend that all users immediately upgrade elFinder to the latest version.

## Technical Details

elFinder comes with a back end (also called *connector*) written in PHP and a front end written in HTML and JavaScript. The *connector* is the main script that dispatches the actions of the front end code to the right back end code to implement file system features. Connectors can be configured to disallow dangerous actions, restrict uploads to specific MIME types: two different ones are part of the default install. We detected vulnerabilities in the so-called “minimal” connector. It only allows image and plain text uploads and FTP is the only supported remote virtual filesystem: this is presumably the safest one and the most likely to be deployed.

To give a better understanding of the code snippets we will use to demonstrate our findings, we will first describe how elFinder’s routing works. Like in many modern PHP applications, the connector (e.g. `connector.minimal.php`) is the only entry point. It declares configuration directives and closures and then instantiates both `elFinder` (the core) and `elFinderConnector` (the interface between `elFinder` and the transport channel, here HTTP).

The attribute `elFinder::$commands` contains every valid action and the expected arguments:

**php/elFinder.class.php**

```
protected $commands = array(
  'abort' => array('id' => true),
  'archive' => array('targets' => true, 'type' => true, 'mimes' => false, 'name' => false),
  'callback' => array('node' => true, 'json' => false, 'bind' => false, 'done' => false),
  'chmod' => array('targets' => true, 'mode' => true),
  'dim' => array('target' => true, 'substitute' => false),
  'duplicate' => array('targets' => true, 'suffix' => false),
  // [...]
```

The user can call any of these commands by providing the `cmd` parameter with the required command parameter via `PATH_INFO`, `GET`, or `POST`. In each command handler, parameters are accessed using `$args`.

To allow remote filesystems (FTP, Dropbox, etc.) to be used with local ones, elFinder implements a filesystem abstraction layer (`elFinderVolumeDriver`) on top of which all drivers are built. Files are then referenced by their volume name (e.g. `t1_` is the trash, `l1_` the default local volume) and the URL-safe Base64 of their name.

Let’s first dig into an arbitrary file deletion bug chain, composed of two distinct issues.

### Deleting Arbitrary Files

The PHP core does not provide an effective way to run background threads, or perform synchronization and inter-process communication. elFinder tries to balance this by heavily using temporary files and post-request hooks. For instance, users can `abort` ongoing actions by calling the method of the same name:

**php/elFinder.class.php**

```
protected function abort($args = array())
{
  if (!elFinder::$connectionFlagsPath || $_SERVER['REQUEST_METHOD'] === 'HEAD') {
    return;
  }

  $flagFile = elFinder::$connectionFlagsPath . DIRECTORY_SEPARATOR . 'elfreq%s';
  if (!empty($args['makeFile'])) {
    self::$abortCheckFile = sprintf($flagFile, $args['makeFile']); // <-- [1]
    touch(self::$abortCheckFile);
    $GLOBALS['elFinderTempFiles'][self::$abortCheckFile] = true;
    return;
  }

  $file = !empty($args['id']) ? sprintf($flagFile, $args['id']) : self::$abortCheckFile; // <-- [2]
  $file && is_file($file) && unlink($file);
}
```

Here, a code vulnerability is present at `[1]` and `[2]`: a user-controlled parameter is concatenated into a full path without prior checks. For `[1]`, it can end up creating an empty file with a fully controllable name, and in `[2]` it can be used to remove an arbitrary file. SonarQube Cloud issues for both bugs are available: [[1]](https://sonarcloud.io/project/issues?id=SonarSourceResearch_elFinder2&open=AXhbTmQAMtwvSXpgjgi3&resolved=false&sonarsourceSecurity=path-traversal-injection&types=VULNERABILITY "[1]") and [[2]](https://sonarcloud.io/project/issues?id=SonarSourceResearch_elFinder2&open=AXhbTmQAMtwvSXpgjgi1&resolved=false&sonarsourceSecurity=path-traversal-injection&types=VULNERABILITY "[2]").

There is a catch: the filename resulting from `[1]` will be prefixed by `elfreq`. In a path traversal attack, POSIX systems will fail path resolution if any predecessor in the path does not exist or is not a directory. For instance, resolving `/tmp/i_do_not_exist/../` or `/tmp/i_am_a_file/../` will respectively fail with `ENOENT` and `ENOTDIR`. This prerequisite makes the exploitation of these two vulnerabilities impossible as-is, and will require another bug, such as the ability to create an arbitrary directory.

An attacker could then look into the command `mkdir` and discover a primitive that allows this exact behaviour. Here is its top-level handler, before it goes through the filesystem abstraction layer:

**php/elFinder.class.php**

```
function mkdir($args)
{
  $target = $args['target'];
  $name = $args['name'];
  $dirs = $args['dirs'];
            // [...]
  if (($volume = $this->volume($target)) == false) {
    return array('error' => $this->error(self::ERROR_MKDIR, $name, self::ERROR_TRGDIR_NOT_FOUND, '#' . $target));
  }
    // [...]
  return ($dir = $volume->mkdir($target, $name)) == false
            ? array('error' => $this->error(self::ERROR_MKDIR, $name, $volume->error()))
            : array('added' => array($dir));
    }
}
```

A generic implementation is present in `elFinderVolumeDriver` to handle both the volume and path that should be created. It will call the volume-specific implementation at `[1]` with the volume absolute path on the filesystem as the first parameter and the target name as the second parameter:

**php/elFinderVolumeDriver.class.php**

```
public function mkdir($dsthash, $name)
{
  // [...]
  $path = $this->decode($dsthash);
  // [...]
  $dst = $this->joinPathCE($path, $name);
  // v--- [1]
  $mkpath = $this->convEncOut($this->_mkdir($this->convEncIn($path),      $this->convEncIn($name)));
    if ($mkpath) {
        $this->clearstatcache();
        $this->updateSubdirsCache($path, true);
        $this->updateSubdirsCache($mkpath, false);
    }

    return $mkpath ? $this->stat($mkpath) : false;
}
```

It is defined as follows:

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _joinPath($dir, $name)
{
  return rtrim($dir, DIRECTORY_SEPARATOR) . DIRECTORY_SEPARATOR . $name;
}

protected function _mkdir($path, $name)
{
  $path = $this->_joinPath($path, $name);

  if (mkdir($path)) {
    chmod($path, $this->options['dirMode']);
    return $path;
  }

  return false;
}
```

`elFinderVolumeLocalFileSystem::_joinPath()` is doing a mere concatenation of the two values, leading to a path traversal vulnerability. This gives a primitive to create arbitrary, empty folders on the local filesystem. While not being a vulnerability in itself, it will allow the exploitation of the aforementioned behaviour.

It is also worth noting the presence of a full path disclosure in the `rm` command, disclosing the absolute path of a given file on the local filesystem:

**php/elFinderVolumeDriver.class.php**

```
protected function remove($path, $force = false)
{
  $stat = $this->stat($path);

  if (empty($stat)) {
    return $this->setError(elFinder::ERROR_RM, $path, elFinder::ERROR_FILE_NOT_FOUND);
  }
```

The impact of this vulnerability is quite dependent on the environment: it could be chained with other elFinder bugs, used to trigger interesting behaviors in other applications (e.g. [remove WordPress’ wp-config.php file to gain code execution](https://blog.sonarsource.com/wordpress-file-delete-to-code-execution "remove WordPress’ wp-config.php file to gain code execution")) or used to affect existing security measures (e.g. removing `.htaccess` files).

This vulnerability has been [fixed](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L347-R369 "fixed") by improving the implementation of `elFinderVolumeLocalFileSystem::_joinPath(`) to assert that the final path won’t be outside of the base one. Several calls to `basename()` across the codebase were also added as a hardening measure.

### Moving Arbitrary Files

This same `elFinderVolumeLocalFileSystem::_joinPath()` method is used in other actions, such as `rename`: it combines a volume base directory and a user-provided destination name. It is thus vulnerable to the bug we just described.

The following snippet is the actual implementation of `elFinderVolumeLocalFileSystem::rename()`, after executing all the code responsible for decoding the paths and ensuring that the destination extension is allowed:

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _move($source, $targetDir, $name)
{
  $mtime = filemtime($source);
  $target = $this->_joinPath($targetDir, $name);
  if ($ret = rename($source, $target) ? $target : false) {
    isset($this->options['keepTimestamp']['move']) && $mtime && touch($target, $mtime);
  }
  return $ret;
}
```

While the destination extension is still strictly limited by MIME checks, this primitive can be enough for an unauthenticated attacker to gain command execution on the server, depending on the environment, by overriding files like `authorized_keys`, `composer.json`, etc. This bug [has been fixed](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L347-R369 "has been fixed") with the same patch as the previous bug we discussed.

### Uploading PHP Files

As for most PHP applications, the biggest threat faced by elFinder is that an attacker could be able to upload PHP scripts to the server, since nothing (except quite a hardened web server configuration) would prevent them from accessing it directly to execute its contents. The maintainers initially tried to defend against that by crafting a block-list that associated dangerous MIME types to the relevant extensions:

**php/elFinderVolumeDriver.class.php**

```
'staticMineMap' => array(
  'php:*' => 'text/x-php',
  'pht:*' => 'text/x-php',
  'php3:*' => 'text/x-php',
  'php4:*' => 'text/x-php',
  'php5:*' => 'text/x-php',
  'php7:*' => 'text/x-php',
  'phtml:*' => 'text/x-php',
  // [...]
```

In our test environment (Apache HTTP 2.4.46-1ubuntu1 on Ubuntu 20.10), the default configuration declares that `.phar` files should be treated as `application/x-httpd-php ([1]`) and be interpreted:

```
$ cat /etc/apache2/mods-available/php7.4.conf
<FilesMatch ".+\.ph(ar|p|tml)$">
    SetHandler application/x-httpd-php  # <-- [1]
</FilesMatch>
<FilesMatch ".+\.phps$">
    SetHandler application/x-httpd-php-source
    # Deny access to raw php sources by default
    # To re-enable it's recommended to enable access to the files
    # only in specific virtual host or directory
    Require all denied
</FilesMatch>
# Deny access to files without filename (e.g. '.php')
<FilesMatch "^\.ph(ar|p|ps|tml)$">
    Require all denied
</FilesMatch>
// [...]
```

This configuration was also observed on Debian’s stable release. While another pass of MIME type detection is performed on the contents of the file, this can be easily circumvented as the PHP interpreter allows statements anywhere in the interpreted files (e.g. `<?php` can be placed after some dummy data).

The [fix](https://github.com/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1 "fix") is straightforward: it declares that `.phar` files are associated with the MIME `text/x-php`, which are disallowed by default.

### Argument Injection

Among the default features that make elFinder so powerful, users can select multiple files and archive them using external tools such as `zip`, `rar`, and `7z`. This functionality is exposed under the action named `archive`:

**php/elFinder.class.php**

```
public function archive($args)
{
  $targets = isset($args['targets']) && is_array($args['targets']) ? $args['targets'] : array();
  $name = isset($args['name']) ? $args['name'] : '';

  if (($volume = $this->volume($targets[0])) == false) {
    return $this->error(self::ERROR_ARCHIVE, self::ERROR_TRGDIR_NOT_FOUND);
  }

  foreach ($targets as $target) {
    $this->itemLock($target);
  }

  return ($file = $volume->archive($targets, $args['type'], $name))
        ? array('added' => array($file))
        : array('error' => $this->error(self::ERROR_ARCHIVE, $volume->error()));
}
```

Note that users can create archives even if their upload is forbidden, by calling the `archive` command on existing files. The implementation is specific to the virtual filesystem in use. We will focus solely on the default one, since it is inherited by `elFinderVolumeLocalFileSystem` which crafts the full command line (`[1]`) and executes it with the default shell (`[2]`):

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function makeArchive($dir, $files, $name, $arc)
{
// [...]
    $cwd = getcwd();
    if (chdir($dir)) {
      foreach ($files as $i => $file) {
        $files[$i] = '.' . DIRECTORY_SEPARATOR . basename($file);
      }
      $files = array_map('escapeshellarg', $files);

      $cmd = $arc['cmd'] . ' ' . $arc['argc'] . ' ' . escapeshellarg($name) . ' ' . implode(' ', $files); // <-- [1]
      $this->procExec($cmd, $o, $c);                // <-- [2]
// [...]
```

Here, the value of `$name` comes from the user-controlled parameter `$_GET['name']`. While properly escaped with `escapeshellarg()` to prevent the use of command substitution sequences, the program will try to parse this value as a flag (`--foo=bar`) and then as a positional argument. It is also worth noting that the user's value is suffixed with `.zip` in the case in which the ZIP archiver is selected.

The command `zip` implements an integrity test feature (`-T`) that can be used along with `-TT` to specify the test command to run. In the present case, it gives the attacker a way to execute arbitrary commands using this parameter injection.

To be able to exploit this vulnerability, the attacker needs to create a dummy file (e.g. `a.txt`), archive it to create `a.zip` and then invoke the `archive` action with both the original file and the archive as targets, using a name like `-TmTT="$(id>out.txt)foooo"`.

The resulting command line will be `zip -r9 -q '-TmTT="$(id>out.txt)foooo".zip' './a.zip' './a.txt'`, thus executing `id` and logging its standard output into `out.txt` — this file will be available with the other documents in elFinder’s interface.

When it came time to fix this bug, `zip` wasn't very friendly. The usual method based on POSIX’s `--` ([see our previous article about a parameter injection in Composer for an in-depth explanation](https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities/ "see our previous article about a parameter injection in Composer for an in-depth explanation")) can’t be applied here, since `zip` will exit with the following error:

```
zip error: Invalid command arguments (can't use -- before archive name)
```

The maintainers then [decided to prefix the archive name with ./ to prevent any risk of parameter injection](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-85602823cf2cdaf2502dc4f1b97001ffc0f083652aef175d9f068a5bfe90ca71L6875-R6882 "decided to prefix the archive name with ./ to prevent any risk of parameter injection"). They also decided to harden the calls to the other archivers (`7z`, `rar`, etc.) in the same patch.

### Quarantine and Race Condition

Let’s have a look at our last finding of this case study. While this vulnerability in the quarantine feature cannot be exploited in the default configuration since archives can’t be uploaded; the feature could have been responsible for future security issues because of its design.

The rationale behind the quarantine is that archives may contain unwanted files (mostly PHP scripts) that should not be extracted in the current folder without first running security checks (e.g. with MIME validation). So instead, elFinder chose to extract archives into a folder named `.quarantine`, placed under the `files/` folder, and  `elFinderVolumeLocalFileSystem::_extract()` generates a random directory name for each archive extraction (at `[1]`):

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _extract($path, $arc)
{
  if ($this->quarantine) {
    $dir = $this->quarantine . DIRECTORY_SEPARATOR . md5(basename($path) . mt_rand()); // <-- [1]
    $archive = (isset($arc['toSpec']) || $arc['cmd'] === 'phpfunction') ? '' : $dir . DIRECTORY_SEPARATOR . basename($path);
// [...]
```

This can be confirmed dynamically thanks to `strace` or the `inotify` suite, for instance here with an archive containing a PHP file:

```
$ inotifywait -m -r .
./ CREATE,ISDIR efbf975ccbac8727f434574610a0f1b6
./ OPEN,ISDIR efbf975ccbac8727f434574610a0f1b6
]...[
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB,ISDIR
./efbf975ccbac8727f434574610a0f1b6/ CREATE win.php
./efbf975ccbac8727f434574610a0f1b6/ OPEN win.php
./efbf975ccbac8727f434574610a0f1b6/ MODIFY win.php
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB win.php
./efbf975ccbac8727f434574610a0f1b6/ CLOSE_WRITE,CLOSE win.php
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB win.php
[...]
./efbf975ccbac8727f434574610a0f1b6/ DELETE win.php
[...]
./efbf975ccbac8727f434574610a0f1b6/ DELETE_SELF
```

This trace can be understood as:

* A folder named `efbf975ccbac8727f434574610a0f1b6` is created,
* A file named `win.php` is created within `efbf975ccbac8727f434574610a0f1b6`,
* Data is written into `win.php`,
* `win.php` is deleted,
* `efbf975ccbac8727f434574610a0f1b6` is deleted.

If the server is configured to list directories, this behavior can easily be exploited, since dangerous files (e.g. `.php`) can be accessed right before the MIME validation step and their removal. The race condition window is however too small to think of an attack involving brute force if the random directory name can’t be found that way.

An attacker could discover that the `duplicate` action can be used on the internal folders, like `.quarantine`, and copy any file regardless of its contents. While being a harmless functional bug on its own, it can be chained with the quarantine feature to duplicate the folder containing our extracted archive just before its deletion. The duplicated folder is then visible in the interface, and allows an attacker to get around the random name to access the malicious script, ultimately granting arbitrary code execution.

As a [fix](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L78-R232) "fix"), the maintainers decided to move the `.quarantine` folder outside of files/. The `elFinderVolumeLocalFileSystem` abstraction layer is not aware of anything outside of this folder, preventing any unintended action on `.quarantine`.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-03-22 | These 5 issues are reported to maintainers |
| 2021-06-10 | The maintainers acknowledge all our findings |
| 2021-06-13 | elFinder 2.1.59 is released, fixing the bugs we reported |
| 2021-06-13 | CVE-2021-32682 and CVE-2021-23394 are assigned |

## Summary

In this case study we looked at critical code vulnerabilities that are commonly found in web file managers. We presented several of our real-world findings in the latest version of elFinder available at the time, including their potential impact and how they were fixed by the vendor.  It allowed us to demonstrate that innocuous bugs can often be combined to gain arbitrary code execution. We believe it is important to document and report these vulnerabilities to break future bug chains and reduce the risk of similar issues.

We also learned that working with paths is not easy and that extra measures should be taken: performing additional checks in the “low-level” functions, using `basename()` and `dirname()` with confidence (and knowing their limits!) and always validating user-controlled data. Such bugs are very common in web file managers, and you should always have such bugs in mind when working with them.

While we don’t plan to release any exploits for these bugs, we would still like to bring your attention to the fact that arbitrary code execution was easily demonstrated and attackers won’t have much trouble replicating it. We urge you to immediately upgrade to elFinder 2.1.59. We also advise enforcing strong access control on the connector (e.g. basic access authentication).

Finally, we would like to thank the maintainers of elFinder for acknowledging our advisory and fixing these vulnerabilities in a timely and professional manner.

## Related Blog Posts

* [https://blog.sonarsource.com/php-supply-chain-attack-on-composer](https://blog.sonarsource.com/php-supply-chain-attack-on-composer "https://blog.sonarsource.com/php-supply-chain-attack-on-composer")
* [https://blog.sonarsource.com/bitbucket-path-traversal-to-rce](https://blog.sonarsource.com/bitbucket-path-traversal-to-rce "https://blog.sonarsource.com/bitbucket-path-traversal-to-rce")
* [https://blog.sonarsource.com/wordpress-file-delete-to-code-execution](https://blog.sonarsource.com/wordpress-file-delete-to-code-execution "https://blog.sonarsource.com/wordpress-file-delete-to-code-execution")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


