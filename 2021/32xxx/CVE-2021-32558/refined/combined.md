=== Content from seclists.org_bc30acee_20250115_102200.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

![](/shared/images/nst-icons.svg#search)

# AST-2021-008: Remote crash when using IAX2 channel driver

---

*From*: "Asterisk Security Team" <security () asterisk org>

*Date*: Thu, 22 Jul 2021 22:53:21 +0000

---

```
               Asterisk Project Security Advisory - AST-2021-008

          Product         Asterisk
          Summary         Remote crash when using IAX2 channel driver
     Nature of Advisory   Denial of service
       Susceptibility     Remote unauthenticated sessions
          Severity        Major
       Exploits Known     No
        Reported On       April 13, 2021
        Reported By       Michael Welk
         Posted On
      Last Updated On     July 6, 2021
      Advisory Contact    kharwell AT sangoma DOT com
          CVE Name        CVE-2021-32558

      Description     If the IAX2 channel driver receives a packet that
                      contains an unsupported  media format  it can cause a
                      crash to occur in Asterisk.
    Modules Affected  chan_iax2.c

    Resolution  Checks are now in place that make it so packets containing
                unsupported media formats are ignored/dropped in the IAX2
                channel driver. This ensures Asterisk no longer crashes.

                               Affected Versions
                Product              Release Series
         Asterisk Open Source             13.x       All versions
         Asterisk Open Source             16.x       All versions
         Asterisk Open Source             17.x       All versions
         Asterisk Open Source             18.x       All versions
          Certified Asterisk              16.8       All versions

                                  Corrected In
               Product                              Release
        Asterisk Open Source           13.38.3, 16.19.1, 17.9.4, 18.5.1
         Certified Asterisk                       16.8-cert10

                                    Patches
                              Patch URL                             Revision
   <http://downloads.digium.com/pub/security/AST-2021-008-13.diff>   Asterisk
                                                                   13
   <http://downloads.digium.com/pub/security/AST-2021-008-16.diff>   Asterisk
                                                                   16
   <http://downloads.digium.com/pub/security/AST-2021-008-17.diff>   Asterisk
                                                                   17
   <http://downloads.digium.com/pub/security/AST-2021-008-18.diff>   Asterisk
                                                                   18
   <http://downloads.digium.com/pub/security/AST-2021-008-16.8.diff> Certified
                                                                   Asterisk
                                                                   16.8

     Links   <https://issues.asterisk.org/jira/browse/ASTERISK-29392>

             <https://downloads.asterisk.org/pub/security/AST-2021-008.html>

    Asterisk Project Security Advisories are posted at
    <http://www.asterisk.org/security>

    This document may be superseded by later versions; if so, the latest
    version will be posted at
    <http://downloads.digium.com/pub/security/AST-2021-008.pdf> and
    <http://downloads.digium.com/pub/security/AST-2021-008.html>

                                Revision History
          Date                  Editor                 Revisions Made
    May 10, 2021       Kevin Harwell             Initial revision

               Asterisk Project Security Advisory - AST-2021-008
               Copyright Ã‚Â© 2021 Digium, Inc. All Rights Reserved.
  Permission is hereby granted to distribute and publish this advisory in its
                           original, unaltered form.

```
```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

### Current thread:

* **AST-2021-008: Remote crash when using IAX2 channel driver** *Asterisk Security Team (Jul 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from issues.asterisk.org_00190dde_20250115_102207.html ===

[[Home](/)]

| Summary: | ASTERISK-29392: chan\_iax2: Asterisk crashes when queueing video with format | | |
| --- | --- | --- | --- |
| Reporter: | Michael Welk (michael1234) | Labels: | patch |
| Date Opened: | 2021-04-13 14:43:41 | Date Closed: | 2021-07-22 15:06:55 |
| Priority: | Major | Regression? |  |
| Status: | Closed/Complete | Components: | Channels/chan\_iax2 |
| Versions: | 16.2.1 18.2.2 18.3.0 | Frequency ofOccurrence | Constant |
| RelatedIssues: |  | | |
| Environment: | FreePBX 15.0.17.24 - Intel Xeon plattform 64bit | Attachments: | ( 0) [Asterisk.dump](../attachments/29/ASTERISK-29392/00-Asterisk.dump)( 1) [ASTERISK-29392.diff](../attachments/29/ASTERISK-29392/01-ASTERISK-29392.diff)( 2) [Asterisk-Session\_2.zip](../attachments/29/ASTERISK-29392/02-Asterisk-Session_2.zip)( 3) [backtrace.txt](../attachments/29/ASTERISK-29392/03-backtrace.txt)( 4) [backtrace-old.txt](../attachments/29/ASTERISK-29392/04-backtrace-old.txt)( 5) [core.freepbx.sangoma.local-2021-04-15T08-45-01+0000-brief-old.txt](../attachments/29/ASTERISK-29392/05-core.freepbx.sangoma.local-2021-04-15T08-45-01%2B0000-brief-old.txt)( 6) [core.freepbx.sangoma.local-2021-04-15T08-45-01+0000-full-old.txt](../attachments/29/ASTERISK-29392/06-core.freepbx.sangoma.local-2021-04-15T08-45-01%2B0000-full-old.txt)( 7) [core.freepbx.sangoma.local-2021-04-15T08-45-01+0000-info-old.txt](../attachments/29/ASTERISK-29392/07-core.freepbx.sangoma.local-2021-04-15T08-45-01%2B0000-info-old.txt)( 8) [core.freepbx.sangoma.local-2021-04-15T08-45-01+0000-locks-old.txt](../attachments/29/ASTERISK-29392/08-core.freepbx.sangoma.local-2021-04-15T08-45-01%2B0000-locks-old.txt)( 9) [core.freepbx.sangoma.local-2021-04-15T08-45-01+0000-thread1-old.txt](../attachments/29/ASTERISK-29392/09-core.freepbx.sangoma.local-2021-04-15T08-45-01%2B0000-thread1-old.txt)(10) [core.freepbx.sangoma.local-2021-04-15T10-15-37+0000-brief.txt](../attachments/29/ASTERISK-29392/10-core.freepbx.sangoma.local-2021-04-15T10-15-37%2B0000-brief.txt)(11) [core.freepbx.sangoma.local-2021-04-15T10-15-37+0000-full.txt](../attachments/29/ASTERISK-29392/11-core.freepbx.sangoma.local-2021-04-15T10-15-37%2B0000-full.txt)(12) [core.freepbx.sangoma.local-2021-04-15T10-15-37+0000-info.txt](../attachments/29/ASTERISK-29392/12-core.freepbx.sangoma.local-2021-04-15T10-15-37%2B0000-info.txt)(13) [core.freepbx.sangoma.local-2021-04-15T10-15-37+0000-locks.txt](../attachments/29/ASTERISK-29392/13-core.freepbx.sangoma.local-2021-04-15T10-15-37%2B0000-locks.txt)(14) [core.freepbx.sangoma.local-2021-04-15T10-15-37+0000-thread1.txt](../attachments/29/ASTERISK-29392/14-core.freepbx.sangoma.local-2021-04-15T10-15-37%2B0000-thread1.txt) |
| Description: | Hello,   i have connected 2 FreePBX Systems via Dundi/IAX2 trunk. Normal calls are working fine, but when i activate Video on the phone A (Cisco, Yaelink...) and call another phone B (phone A >Server A >IAX2> Server B> phone B) Server B crashes. When i stay with phone A+B on the same Server or disable Video on the phone - everything works perfect. This only happens via IAX2 trunks, sometimes immediatly, sometimes after a while during the call.     The configuration of the trunk is very basic   dundi\_custom.conf:  {noformat}  ; DK0MAV  [22:e1:bc:08:83:5c]  host=44.149.94.136  include=priv  model=symmetric  order=primary  permit=priv  qualify=yes  secret=xxxxxxxxx  {noformat}  iax\_custom.conf:  {noformat}  [iaxuser]  type=friend  dbsecret=dundi/secret  context=incomingdundi  {noformat}   I already disabled videosupport on the IAX-Trunk but still the same issue.   Trace from the Asterisk-console of the crashing server:  {noformat}  Connected to Asterisk 16.2.1 currently running on freepbx (pid = 26623)  Ã¢Â€Â“ Accepting AUTHENTICATED call from 44.225.66.196:4569:  Ã¢Â€Â“ > requested format = g722,  Ã¢Â€Â“ > requested prefs = disabled,  Ã¢Â€Â“ > actual format = g722,  Ã¢Â€Â“ > host prefs = disabled,  Ã¢Â€Â“ > priority = disabled  Ã¢Â€Â“ Executing [315200612183@incomingdundi:1] Playback("IAX2/iaxuser-5566", "custom/voip-dk0mav") in new stack  Ã¢Â€Â“ <IAX2/iaxuser-5566> Playing 'custom/voip-dk0mav.g722' (language 'en')  [2021-04-12 21:49:48] WARNING[26669]: chan\_iax2.c:11782 socket\_process\_helper: Received mini frame before first full video frame  freepbx\*CLI> <<<<<<<<<<<<<<<<crash>>>>>>>>>>>>>>>  Disconnected from Asterisk server  Asterisk cleanly ending (0).  Executing last minute cleanups  {noformat}    I have tried to downgrade to an older Asterisk version but no success.   Just for clarification:   I do not want video working via IAX-Trunks, that seems not possible for what reason ever. I just want that Asterisk do not crash when it receives a call from a phone that has video enabled via the trunk.   The same configuration on earlier Asterisk versions (11, 13) is working without any problems.   It seems Asterisk have a problem when frames are lost on the trunk and they arrive in a kind of wrong order. This leads to a crash.   Maybe interesting but very old issue: https://www.coresecurity.com/core-labs/advisories/asterisk-pbx-truncated-video-frame-vulnerability   Please help me.   Best Regards   Michael | | |
| Comments: | By: Asterisk Team (asteriskteam) 2021-04-13 14:43:42.621-0500Thanks for creating a report! The issue has entered the triage process. That means the issue will wait in this status until a Bug Marshal has an opportunity to review the issue. Once the issue has been reviewed you will receive comments regarding the next steps towards resolution. Please note that log messages and other files should not be sent to the Sangoma Asterisk Team unless explicitly asked for. All files should be placed on this issue in a sanitized fashion as needed.   A good first step is for you to review the [Asterisk Issue Guidelines|https://wiki.asterisk.org/wiki/display/AST/Asterisk+Issue+Guidelines] if you haven't already. The guidelines detail what is expected from an Asterisk issue report.   Then, if you are submitting a patch, please review the [Patch Contribution Process|https://wiki.asterisk.org/wiki/display/AST/Patch+Contribution+Process].   Please note that once your issue enters an open state it has been accepted. As Asterisk is an open source project there is no guarantee or timeframe on when your issue will be looked into. If you need expedient resolution you will need to find and pay a suitable developer. Asking for an update on your issue will not yield any progress on it and will not result in a response. All updates are posted to the issue when they occur.   Please note that by submitting data, code, or documentation to Sangoma through JIRA, you accept the Terms of Use present at [https://www.asterisk.org/terms-of-use/|https://www.asterisk.org/terms-of-use/].  ---   By: Joshua C. Colp (jcolp) 2021-04-13 14:48:57.182-0500Thank you for the crash report. However, we need more information to investigate the crash. Please provide:   1. A backtrace generated from a core dump using the instructions provided on the Asterisk wiki [1].  2. Specific steps taken that lead to the crash.  3. All configuration information necesary to reproduce the crash.   Thanks!   [1]: https://wiki.asterisk.org/wiki/display/AST/Getting+a+Backtrace   ---   By: Joshua C. Colp (jcolp) 2021-04-13 14:49:31.627-0500Additionally Asterisk 16.2.1 is very old. Please update to the latest version and try again to ensure this is still an issue.  ---   By: Joshua C. Colp (jcolp) 2021-04-13 14:51:05.748-0500I would also suggest seeing if setting explicit allowed codecs (allow=!all,g722) prevents the issue from occurring.  ---   By: Michael Welk (michael1234) 2021-04-13 17:57:57.200-0500allow=!all,g722--------done  Upgraded to Asterisk 18-----done   Nothing helps..........same problem.  ---   By: Michael Welk (michael1234) 2021-04-13 18:26:44.503-0500The core-dump is 120MB...upload here is limited to 50MB...   How do i send this file?  ---   By: Joshua C. Colp (jcolp) 2021-04-13 18:29:17.021-0500The core dump file itself is not needed at this point. If you use the ast\_coredumper script that is mentioned in the linked wiki page, it will produce text files that contain the gdb output and they can be attached to this issue.   You will also need to state what version of Asterisk it is from.  ---   By: Michael Welk (michael1234) 2021-04-13 18:35:33.896-0500[root@freepbx ~]# sudo /var/lib/asterisk/scripts/ast\_coredumper core  which: no gdb in (/sbin:/bin:/usr/sbin:/usr/bin)  No suitable gdb was found in /sbin:/bin:/usr/sbin:/usr/bin  [root@freepbx ~]#   ...it does nor work.   Asterisk is version 18.2.2  ---   By: Joshua C. Colp (jcolp) 2021-04-13 18:38:12.714-0500The gdb package has to be installed, as that is what opens the core dump file and produces the text files.  ---   By: Michael Welk (michael1234) 2021-04-13 18:49:26.304-0500Coredump attached files  ---   By: Michael Welk (michael1234) 2021-04-14 05:03:21.401-0500Just for information: The IAX-Trunk between the 2 PBX is via a 25 Miles (yes 25!) WLAN link. So loss of packets sometimes occur.  ---   By: Kevin Harwell (kharwell) 2021-04-14 10:46:20.808-0500Unfortunately the attached backtrace is missing symbols, so we are unable to extrapolate exactly where it is crashing. Please ensure Asterisk is built to contain debug symbols. From [getting a backtrace|https://wiki.asterisk.org/wiki/display/AST/Getting+a+Backtrace#GettingaBacktrace-PreparingAsteriskToProduceCoreFilesOnCrash]:  {quote}  This can be done by selecting the 'DONT\_OPTIMIZE' option in the Compiler Flags submenu in the 'make menuselect' tree before building Asterisk.  {quote}  After Asterisk is rebuilt with symbols (and re-installed), and once another crash occurs rerun \_ast\_coredumper\_ again and attach the new output here.   Thanks!  ---   By: Kevin Harwell (kharwell) 2021-04-14 10:52:12.388-0500Actually noticed you are using FreePBX. Please see the [Providing Great Debug|https://wiki.freepbx.org/display/SUP/Providing+Great+Debug] wiki page. Specifically, the [Backtraces(Segfaults/CoreDumps/AsteriskCrashing)|https://wiki.freepbx.org/display/SUP/Providing+Great+Debug#ProvidingGreatDebug-Backtraces(Segfaults/CoreDumps/AsteriskCrashing)] section about how to install debug symbols for Asterisk with FreePBX.  ---   By: Michael Welk (michael1234) 2021-04-14 12:09:04.154-0500New files uploaded, i did everything possible described there:   /var/lib/asterisk/scripts/ast\_coredumper /tmp/core.freepbx.sangoma.local-2021-04-13T20:32:08+0000   gdb -se "asterisk" -ex "bt full" -ex "thread apply all bt" --batch -c core.freepbx.sangoma.local-2021-04-13T20:32:08+0000 > /tmp/backtrace.txt  ---   By: Michael Welk (michael1234) 2021-04-14 12:50:43.154-0500I hope this helps. If not, please send me a binary of Asterisk with all the things you want to have included, then i just swap the binary and i do everything again.  ---   By: Kevin Harwell (kharwell) 2021-04-14 16:11:59.742-0500Unfortunately the new files still don't have symbols available ...and you followed the \_yum\_ commands listed on the wiki? If so, and you can verify the Asterisk debug packages are installed then you might want to reach out and [report it to FreePBX|http://issues.freepbx.org/].  ---   By: Kevin Harwell (kharwell) 2021-04-14 16:13:18.048-0500Until we can get a better backtrace can you also attach, or post, the exact iax configuration for the endpoints in question, and relevant dialplan portion(s).   As well it appears it is failing during a playback. What file is it trying to playback? A custom one? Asterisk installed one? And what format is the file being played back in?   Also could you enable debug level 5, and for good measure iax debugging. See the [collecting debug information|https://wiki.asterisk.org/wiki/display/AST/Collecting+Debug+Information] wiki page for more information on how to do that. Then next time it fails attach the log here to the issue. Maybe it'll show something leading up to the crash.   Thanks!  ---   By: Kevin Harwell (kharwell) 2021-04-14 16:18:18.793-0500{quote}  If not, please send me a binary of Asterisk with all the things you want to have included, then i just swap the binary and i do everything again.  {quote}  Unfortunately, it's not as easy as that. Asterisk is comprised of many compiled modules and depending on your OS and other environment factors a simple binary swap especially of a FreePBX system (I am not familiar with what all they use and have configured) could lead to unexpected results. Thus at this time the asterisk team at Sangoma does not compile and distribute binaries.  ---   By: Michael Welk (michael1234) 2021-04-14 16:32:27.570-0500The yum commands are for Version 7 and older, i have Version 15 installed.  Nope, this bug not appear during playback, mostly during a placed call. The bug has nothing to do with playback bcause when i disable video on the phone everything works perfect.  Please refer to my bug description, this happens always after the error message:   [2021-04-12 21:49:48] WARNING[26669]: chan\_iax2.c:11782 socket\_process\_helper: Received mini frame before first full video frame   In these cases the call is placed and i can talk to phone B, after 10-60sec or so Asterisk crashes when this message arrives (asterisk -vvvr) at the console.   I will have a look at level 5 debugging and come back to you.  ---   By: Kevin Harwell (kharwell) 2021-04-14 17:32:14.465-0500I spoke with some folks who know and work with FreePBX, and they said you should be able to install the debug symbol packages for your version. It should just be:  {noformat}  $ yum install sangoma-devel  $ yum install pjproject-debuginfo asterisk16-debuginfo  {noformat}  And if you are using Asterisk 18 then replace the 16 with 18 in the above.   Also the reason I believe it's crashing during playback is because that's what the stack trace shows from the currently attached backtrace(s) (from [^core.freepbx.sangoma.local-2021-04-13T20-32-08+0000-brief.txt]):  {noformat}  Thread 1 (Thread 0x7f04cfe26700 (LWP 2006)):  #0 Â 0x00000000004f6055 in ast\_format\_get\_type ()  #1 Â 0x00000000004a1115 in \_\_ast\_read ()  #2 Â 0x00000000004a3224 in ast\_read ()  #3 Â 0x00000000004f3ba6 in waitstream\_core ()  #4 Â 0x00000000004f411f in ast\_waitstream ()  #5 Â 0x00007f04797dbde0 in playback\_exec () from /usr/lib64/asterisk/modules/app\_playback.so  #6 Â 0x00000000005418f3 in pbx\_exec ()  #7 Â 0x000000000052d2d3 in pbx\_extension\_helper ()  #8 Â 0x00000000005310df in ast\_spawn\_extension ()  #9 Â 0x0000000000531d99 in \_\_ast\_pbx\_run ()  #10 0x0000000000533570 in pbx\_thread ()  #11 0x00000000005c6f79 in dummy\_start ()  #12 0x00007f04d295fea5 in start\_thread () from /lib64/libpthread.so.0  #13 0x00007f04d19fe8dd in clone () from /lib64/libc.so.6  {noformat}  Here we see at #5 playback is called (\_app\_playback\_). and then further down (or up depending on how you want to read it) the stack at #0 the actual crash happens in the call to \_ast\_format\_get\_type\_. So somehow playback is involved.  ---   By: Michael Welk (michael1234) 2021-04-15 04:04:07.522-0500Hi,  i installed the packages as described and did a real phone call. This call lasts for about 2min, then Asterisk crashed. The other dump was from an recorded voice, maybe this was misleading Â (i do not want to call users at 1am, hihi). Now playback is not involved anymore.  ---   By: Michael Welk (michael1234) 2021-04-15 05:27:08.150-0500I have upgraded the system and did a full restart (yum update).  Did all the things again, now the dump-files look much better.  New files just uploaded, it seems the debugging symbols are now in.  New files uploaded, deleted all the old ones.  ---   By: Michael Welk (michael1234) 2021-04-15 06:14:21.594-0500I inspected an older coredump with the new version (maybe it is not good because the coredump and the tools to inspect it are from different versions) but i found it is maybe usefull because i saw something like "can not access memory blabla). These files are marked with -old.txt  ---   By: Michael Welk (michael1234) 2021-04-15 06:25:00.042-0500Forgot to tell:  Asterisk 18.3.0 is now running  ---   By: Joshua C. Colp (jcolp) 2021-04-15 06:43:35.035-0500You can't examine old core dumps with a different version of Asterisk and packages, the result is incorrect.  ---   By: Michael Welk (michael1234) 2021-04-15 06:49:32.484-0500Thanks, that is what i thought. So please ignore the -old.txt  ---   By: Michael Welk (michael1234) 2021-04-15 07:26:33.108-0500I bet my ass that this has something to do with packetloss on the IAX2-Trunk and the order of the processed frames, arriving at the crashing PBX......  ---   By: Michael Welk (michael1234) 2021-04-15 07:51:51.832-050018.3.0 seems to be a debugging version of Asterisk, uploaded by Sangoma...cool.   !@!@!@! info.txt !@!@!@!   Asterisk 18.3.0 built by mockbuild @ jenkins7 on a x86\_64 running Linux on 2021-04-09 17:41:27 UTC   System started: 2021-04-15 10:05:29.643245  Last reload: 2021-04-15 10:05:29.643245   Build options = DONT\_OPTIMIZE, COMPILE\_DOUBLE, OPTIONAL\_API  ---   By: Joshua C. Colp (jcolp) 2021-04-15 08:14:35.347-0500The chan\_iax2 module appears to be providing a media frame without stating what format it is in. In the time before streams we wouldn't have examined the format in this flow, and wouldn't care.  ---   By: Joshua C. Colp (jcolp) 2021-04-15 08:21:50.007-0500Is it possible for you to get a packet capture of a call that causes this so we can see the specific IAX2 protocol flow?  ---   By: Michael Welk (michael1234) 2021-04-15 09:12:32.321-0500Uuuuuh, yes, that is possible. I have to organize a switch with a mirror-port...maybe the router (MikroTik) is also able to do that, i have to check.  On which side do you need the stream-capture, on the side of the crashing PBX (far end for me, but i think that would make sense when frames are lost) or on the other side?  ---   By: Joshua C. Colp (jcolp) 2021-04-15 09:15:16.917-0500On the side of the crashing PBX.  ---   By: Michael Welk (michael1234) 2021-04-15 09:27:58.070-0500OK, i have to organize things, that can`t be done on the fly. This takes some time..i come back to you guys asap.  Many thanks so far!  ---   By: Michael Welk (michael1234) 2021-04-15 10:57:46.760-0500It went faster than expected, the router is able to do packet sniffing, yeah! Attached is the communication on port 4569 during the fault of 2 seperat calls, both of them failed after a while. You can open it with Wireshark.  ---   By: Michael Welk (michael1234) 2021-04-15 11:36:25.839-050044.149.94.136 is the server that is crashing.  ---   By: Michael Welk (michael1234) 2021-04-15 14:15:28.470-0500" In the time before streams we wouldn't have examined the format in this flow, and wouldn't care."   Is that the reason why i can`t get video working via IAX2?  ---   By: Joshua C. Colp (jcolp) 2021-04-15 14:37:22.817-0500I have no idea. The chan\_iax2 module hasn't been touched for any of that, 'nor tested for video. I doubt it was used for video much in the first place even when support for it was added.  ---   By: Michael Welk (michael1234) 2021-04-15 14:50:46.989-0500Understood. So maybe it is a good idea for me to switch to a SIP-Trunk in the near future. Is it possible to get Dundi working via a SIP-Trunk? Because there is no dialplan existing in our network, no chance to say 1xxxx is location 1, 2xxxx is location 2 and so on.  Edit: I just see it is possible. I will give it a try in the future.  ---   By: Michael Welk (michael1234) 2021-04-17 04:52:57.126-0500Just for information:  I switched the trunk of the affected PBX from IAX to SIP.  Now everything is fine, but nevertheless, this should be solved. At least nothing crashes anymore.  ---   By: Kevin Harwell (kharwell) 2021-05-10 18:17:49.108-0500[~michael1234] It seems you might have converted your configuration to use chan\_pjsip, but I've attached a patch ([^ASTERISK-29392.diff]) that should hopefully fix the problem with chan\_iax2. If you are able to apply, test, and verify it fixes your original chan\_iax2 crash it would be much appreciated. Thanks!  ---   By: Michael Welk (michael1234) 2021-05-11 11:58:34.730-0500Hi Kevin,   i use the FreePBX software package directly from Sangoma, no chance to apply a .diff to the source :-( ......  Unfortunatly there are a tot of packages missing to build and compile.  ---   By: Friendly Automation (friendly-automation) 2021-07-22 15:06:56.664-0500Change 16204 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16204|https://gerrit.asterisk.org/c/asterisk/+/16204]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 15:13:40.163-0500Change 16206 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16206|https://gerrit.asterisk.org/c/asterisk/+/16206]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 15:17:44.132-0500Change 16203 merged by George Joseph:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16203|https://gerrit.asterisk.org/c/asterisk/+/16203]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 15:17:56.726-0500Change 16205 merged by George Joseph:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16205|https://gerrit.asterisk.org/c/asterisk/+/16205]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:16:41.884-0500Change 16195 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16195|https://gerrit.asterisk.org/c/asterisk/+/16195]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:16:47.925-0500Change 16196 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16196|https://gerrit.asterisk.org/c/asterisk/+/16196]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:16:52.175-0500Change 16191 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16191|https://gerrit.asterisk.org/c/asterisk/+/16191]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:16:58.902-0500Change 16192 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16192|https://gerrit.asterisk.org/c/asterisk/+/16192]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:17:04.616-0500Change 16193 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16193|https://gerrit.asterisk.org/c/asterisk/+/16193]  ---   By: Friendly Automation (friendly-automation) 2021-07-22 16:17:16.468-0500Change 16194 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16194|https://gerrit.asterisk.org/c/asterisk/+/16194]  ---   By: Friendly Automation (friendly-automation) 2021-07-23 08:23:16.787-0500Change 16212 merged by Friendly Automation:  AST-2021-008 - chan\_iax2: remote crash on unsupported media format   [https://gerrit.asterisk.org/c/asterisk/+/16212|https://gerrit.asterisk.org/c/asterisk/+/16212]  --- | | |



=== Content from www.debian.org_aa00ac1f_20250115_102208.html ===


---

[[Date Prev](msg00183.html)][[Date Next](msg00185.html)]
[[Thread Prev](msg00183.html)][[Thread Next](msg00185.html)]
[[Date Index](maillist.html#00184)]
[[Thread Index](threads.html#00184)]

# [SECURITY] [DSA 4999-1] asterisk security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4999-1] asterisk security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 1 Nov 2021 19:36:09 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211101193609.GA28544%40seger.debian.org)Â [20211101193609.GA28544@seger.debian.org](msg00184.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4999-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
November 01, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : asterisk
CVE ID         : CVE-2021-32558 CVE-2021-32686
Debian Bug     : 991710 991931

Multiple vulnerabilities have been discovered in Asterisk, an open
source PBX and telephony toolkit, which may result in denial of service.

For the stable distribution (bullseye), these problems have been fixed in
version 1:16.16.1~dfsg-1+deb11u1.

We recommend that you upgrade your asterisk packages.

For the detailed security status of asterisk please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/asterisk>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmGAQWsACgkQEMKTtsN8
TjbHuBAAnOiNlgddEytRB5FXXukpNR+IsEb20LuwDbzPzyLST6ykpR93fsg0YSRF
N4rk6wP9/tONGojuvhnsZGMubJuugzds6VD/tAybbApVPmaA99lijDVk2SsULmFx
Nrum+ufrxUkI6h/ijjNxi3lm+26LbCfcSGi8DvQ2b8v7CSxEqjV/KaD4BEkL0PNJ
A20l0cxrvhSyGok/Q8ON+w6DUlUjF03leLkLkRVmIGogiFz7uLr+3pDInENONq88
zi1asJuUWwaDlJaarpbG/0MQfd24DVQ+hfrRofhmH2VPAH0E+kTzwsA0fMoEvSN8
orjhc59cHmlgyjGoBD9yzR8fYal/C3eGbIswb17GIY8vBxlytumMbP0XT9dIIcXd
WQIi5iX+TSj4Z0zRb99YOx8GpOOGdPbi9oz7nNztExlUIjpsiooD4PZdb0fkrFC+
1doIrUnCwPj26XWmj8+5sw+moXOA3mzpc1aasfT5Vm4kjtX6DjEGRBb5CWDF2wVT
TB1AdzDjnQb0YEheFuINfui3xAl4TmIA3cCsCiE80O4nV6f3GSjKcdznuR+NFlfV
pyoPiwJB+4tlFA7lVD+HIesSjx8Kq3SPerJ/SGotPIanNYFKeA5Xv6eYkOXnI4fU
htktH419EtYhBbsQTQsTCduHJtB4bJ5DYpFuBZTkZcJpzq0wPGE=
=n+Nz
-----END PGP SIGNATURE-----

```

---



=== Content from downloads.asterisk.org_2d6dffc0_20250115_102201.html ===


Asterisk
Project Security Advisory - AST-2021-008

| **Product** | Asterisk |
| **Summary** | Remote crash when using IAX2 channel driver |
| **Nature of Advisory** | Denial of service |
| **Susceptibility** | Remote unauthenticated sessions |
| **Severity** | Major |
| **Exploits Known** | No |
| **Reported On** | April 13, 2021 |
| **Reported By** | Michael Welk |
| **Posted On** |  |
| **Last Updated On** | July 6, 2021 |
| **Advisory Contact** | kharwell AT sangoma DOT com |
| **CVE Name** | CVE-2021-32558 |

| **Description** | If the IAX2 channel driver receives a packet that contains an unsupported media format it can cause a crash to occur in Asterisk. |
| **Modules Affected** | chan\_iax2.c |

| **Resolution** | Checks are now in place that make it so packets containing unsupported media formats are ignored/dropped in the IAX2 channel driver. This ensures Asterisk no longer crashes. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 13.x | All versions |
| Asterisk Open Source | 16.x | All versions |
| Asterisk Open Source | 17.x | All versions |
| Asterisk Open Source | 18.x | All versions |
| Certified Asterisk | 16.8 | All versions |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 13.38.3, 16.19.1, 17.9.4, 18.5.1 |
| Certified Asterisk | 16.8-cert10 |
|  |  |

| **Patches** | |
| **Patch URL** | **Revision** |
| http://downloads.digium.com/pub/security/AST-2021-008-13.diff | Asterisk 13 |
| http://downloads.digium.com/pub/security/AST-2021-008-16.diff | Asterisk 16 |
| http://downloads.digium.com/pub/security/AST-2021-008-17.diff | Asterisk 17 |
| http://downloads.digium.com/pub/security/AST-2021-008-18.diff | Asterisk 18 |
| http://downloads.digium.com/pub/security/AST-2021-008-16.8.diff | Certified Asterisk 16.8 |
|  |  |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-29392  https://downloads.asterisk.org/pub/security/AST-2021-008.html |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2021-008.pdf and http://downloads.digium.com/pub/security/AST-2021-008.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| May 10, 2021 | Kevin Harwell | Initial revision |

Asterisk Project Security
Advisory - AST-2021-008

Copyright
Ã‚Â© 2021
Digium, Inc. All Rights Reserved.

Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from packetstormsecurity.com_81da431d_20250115_102159.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

Â [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from lists.debian.org_bfa49f63_20250115_102208.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DLA 2729-1] asterisk security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2729-1] asterisk security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Wed, 4 Aug 2021 06:06:59 -0400 (EDT)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/162807157381.91798.13393955170364610726%40copycat)Â [162807157381.91798.13393955170364610726@copycat](msg00005.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2729-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
August 04, 2021                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : asterisk
Version        : 1:13.14.1~dfsg-2+deb9u5
CVE ID         : CVE-2021-32558
Debian Bug     : #991710

It was discovered that there was an issue in the Asterisk telephony
system. If the IAX2 channel driver received a packet that contained
an unsupported media format, a crash could have occured.

For Debian 9 "Stretch", this problem has been fixed in version
1:13.14.1~dfsg-2+deb9u5.

We recommend that you upgrade your asterisk packages.

For the detailed security status of asterisk please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/asterisk>

In addition, Asterisk are tracking this issue as "AST-2021-008".

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmEKZpAACgkQHpU+J9Qx
HlhhEhAAlcjpCSQLxxyLjE6KNGAutZtPmrYi/Rq8vLQBGlgwZObddZhPfZwJsUaz
lDwn+8EHyB8bfEbO7NlLcfYDBBeNAW4/hppXYFrh6CMvXiPRfWbZmaGeuFfatNcs
Bggrfyp1gGjjZiFZHA2na7BgYMAoLF5z0OJ0Bp2WXvyUN6trKAhUXEc07WTSplDt
c/gEWvw7rPvrDr7EKSaVJov1nVLMIWO3S9jfWrd3nllUyIPCwEQYhZo17akttaox
e+yxOPHesC0gojbl8zeOwkH9x7gVDrHGc2ZLcB2Q2+o3s4n96+HwDFSeS+FhYEyo
ZwGbEwKGJiVKzZ8zm5WiDmyaQ/5gQoCsbewr6icH8Fs9liPDBovawy2r/fWfjb07
dHCU3iKMXem1l3U8qexyESh0H4skGNF6yTqX9BLMavHMUslPz/hYKC+y94s464GL
CKLuPGJETzphNE4gQyF2+t0KxLy1FzW1oSCC0RaST9xPjvth99wc6ZYIbHfdhvS5
5paFZOQkXZgOFCKcZH1xgX/V9Ah6OUn21F4HD4s7ADkRZTBfVKDAzLNV8JMB9Dy6
ohU+U9K0qV53z+TWz2Ktsm1HMk2mcx4pXQokHIsKM3hsF5zXs/p7i6Tl5KDUzOQ8
aXlPVYxTeRI5Cb9H17q5SQKmNSrSExTXh0IFDi2Qcg5n8UaqtLg=
=bcqj
-----END PGP SIGNATURE-----

```

---


