The provided content relates to CVE-2021-32793.

**Root cause of vulnerability:**
The vulnerability is caused by insufficient input sanitization of the "comment" parameter in several pages of the Pi-hole web interface (Whitelist, Blacklist, Client group management, Domain management, Adlist group management). User input added as a wildcard domain to a blocklist or allowlist is unfiltered in the web interface.

**Weaknesses/vulnerabilities present:**
Stored Cross-Site Scripting (XSS) vulnerability. The comment parameter is vulnerable. User input is not properly sanitized, allowing an attacker to inject malicious JavaScript code.

**Impact of exploitation:**
A remote attacker can inject malicious code through the comment parameter, and when a user accesses affected pages, the injected script executes in the user's browser within the context of the web application. An attacker can therefore attack administrative user accounts through client-side attacks.

**Attack vectors:**
The attack vector is network-based. An attacker can send a crafted POST request to the `/admin/scripts/pi-hole/php/groups.php` endpoint, injecting a malicious payload into the `domain` field.

**Required attacker capabilities/position:**
The attacker requires high privileges to add domains to blocklists or allowlists. The attacker also requires the victim to visit specific pages in the web interface to trigger the stored XSS.