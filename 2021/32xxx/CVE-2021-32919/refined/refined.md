```
Message-ID: <CAJt9-x5wmruq=9sraBHjRQwZYnVaO=QG5wn5LLw=vfAF=nynrg@mail.gmail.com>
Date: Thu, 13 May 2021 15:20:23 +0100
From: Matthew Wild <mwild1@...il.com>
To: oss-security@...ts.openwall.com
Subject: Prosody XMPP server advisory 2021-05-12 (multiple vulnerabilities)

Prosody security advisory 2021-05-12
====================================

Project
:   Prosody XMPP server

URL
:   <https://prosody.im/>

Date
:   2021-05-12

This advisory details 5 new security vulnerabilities discovered in the
Prosody.im XMPP server software. All issues are fixed in the 0.11.9 release
default configuration.


5/5: Undocumented dialback-without-dialback option insecure
--------------------------------------------------------------

CVE
: CVE-2021-32919

Affected versions
: Prosody 0.10.x, Prosody 0.11.x prior to 0.11.9

Fixed versions
: 0.11.9, 0.11 nightly build 130, trunk nightly build 1434

**Description**

The undocumented option 'dialback_without_dialback' enabled an experimental
feature for server-to-server authentication. A flaw in this feature meant it
did not correctly authenticate remote servers, allowing a remote server to
impersonate another server when this option is enabled.

**Affected configurations**

The default configuration is not affected.

Configurations with the setting 'dialback_without_dialback' set to true are
affected.

**Temporary mitigation**

Remove or disable the 'dialback_without_dialback' option.

**Advice**

All deployments should upgrade to 0.11.9 or disable this feature.

Deployments using nightly builds should upgrade to the latest available
builds.

The affected feature has been removed in 0.11.9.

**Credits**

This flaw was discovered by the Prosody team.

**Commits**

- <https://hg.prosody.im/trunk/rev/6be890ca492e>
- <https://hg.prosody.im/trunk/rev/d0e9ffccdef9>
```

- **Root cause of vulnerability**: The undocumented 'dialback_without_dialback' option, intended for server-to-server authentication, had a flaw that bypassed proper authentication of remote servers.
- **Weaknesses/vulnerabilities present**: Improper authentication of remote servers.
- **Impact of exploitation**: A remote server could impersonate another server.
- **Attack vectors**: By enabling the `dialback_without_dialback` option, a malicious server could impersonate another server during server-to-server communication.
- **Required attacker capabilities/position**: The attacker needs to control a server that is attempting to communicate with the vulnerable Prosody server and for the option 'dialback_without_dialback' to be enabled.