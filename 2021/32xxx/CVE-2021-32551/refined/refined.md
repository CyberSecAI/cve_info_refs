The content is related to CVE-2021-32551.

**Root cause of vulnerability:**
The `add_info()` function in `package-hooks/source_openjdk-*.py` constructs a file path using user-controlled data (`report['ProcCwd']` and `pid`) without proper sanitization, leading to a directory traversal vulnerability.

**Weaknesses/vulnerabilities present:**
- **Arbitrary File Read:** The vulnerability allows an attacker to read arbitrary files on the system by injecting a crafted `ProcCwd` and `Pid` into a crash report. The code uses `os.path.exists()` to check for the existence of the file before reading but does not check if it's a symlink.
- **Directory Traversal:** The lack of sanitization of the constructed file path allows an attacker to traverse directories.
- **Symlink Following:** The code does not check if a path is a symlink before reading, allowing an attacker to redirect the file access to another location.

**Impact of exploitation:**
An attacker can read sensitive files on the system that the user running apport has access to, such as `/etc/shadow` or any other file, leading to information disclosure.

**Attack vectors:**
- An attacker crafts a malicious crash report with a controlled `ProcCwd` and `Pid`, and makes a symbolic link to the target file.
- The attacker can then trigger the Apport service to process the crash report, which will cause the vulnerable code to execute and read the attacker's target file.

**Required attacker capabilities/position:**
- The attacker needs to be able to create crash reports.
- The attacker needs to control the content of the crash report, specifically the `ProcCwd` and `Pid` fields.
- The attacker needs to place a symlink at a specific location.
- The attacker needs the Apport service to process the crafted crash report.

**Additional Details:**
The vulnerability is triggered in the `add_info()` function of the `package-hooks/source_openjdk-*.py` script.  The fix involves modifying the `read_file()` function within `apport/hookutils.py` to ensure it does not follow symlinks and that the file isn't a FIFO.  Also, tests were added to test this fix.