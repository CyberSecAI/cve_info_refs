=== Content from github.com_a2cde9c2_20250115_084841.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ficsharpcode%2FSharpZipLib%2Freleases%2Ftag%2Fv1.3.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ficsharpcode%2FSharpZipLib%2Freleases%2Ftag%2Fv1.3.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=icsharpcode%2FSharpZipLib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[icsharpcode](/icsharpcode)
/
**[SharpZipLib](/icsharpcode/SharpZipLib)**
Public

* [Notifications](/login?return_to=%2Ficsharpcode%2FSharpZipLib) You must be signed in to change notification settings
* [Fork
  978](/login?return_to=%2Ficsharpcode%2FSharpZipLib)
* [Star
   3.8k](/login?return_to=%2Ficsharpcode%2FSharpZipLib)

* [Code](/icsharpcode/SharpZipLib/tree/v1.3.3)
* [Issues
  83](/icsharpcode/SharpZipLib/issues)
* [Pull requests
  28](/icsharpcode/SharpZipLib/pulls)
* [Discussions](/icsharpcode/SharpZipLib/discussions)
* [Actions](/icsharpcode/SharpZipLib/actions)
* [Projects
  0](/icsharpcode/SharpZipLib/projects)
* [Wiki](/icsharpcode/SharpZipLib/wiki)
* [Security](/icsharpcode/SharpZipLib/security)
* [Insights](/icsharpcode/SharpZipLib/pulse)

Additional navigation options

* [Code](/icsharpcode/SharpZipLib/tree/v1.3.3)
* [Issues](/icsharpcode/SharpZipLib/issues)
* [Pull requests](/icsharpcode/SharpZipLib/pulls)
* [Discussions](/icsharpcode/SharpZipLib/discussions)
* [Actions](/icsharpcode/SharpZipLib/actions)
* [Projects](/icsharpcode/SharpZipLib/projects)
* [Wiki](/icsharpcode/SharpZipLib/wiki)
* [Security](/icsharpcode/SharpZipLib/security)
* [Insights](/icsharpcode/SharpZipLib/pulse)

1. [Releases](/icsharpcode/SharpZipLib/releases)
2. [v1.3.3](/icsharpcode/SharpZipLib/releases/tag/v1.3.3)

# v1.3.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/icsharpcode/SharpZipLib/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.3.3)

 Loading

[View all tags](/icsharpcode/SharpZipLib/tags)

![@piksel](https://avatars.githubusercontent.com/u/807383?s=40&v=4)
[piksel](/piksel)
released this
19 Sep 09:14

¬∑
[53 commits](/icsharpcode/SharpZipLib/compare/v1.3.3...master)
to master
since this release

[v1.3.3](/icsharpcode/SharpZipLib/tree/v1.3.3)

[`1b1ab01`](/icsharpcode/SharpZipLib/commit/1b1ab013ce1df02d8f27cf582197759c614d9126)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Another minor release, containing security fixes and smaller bugfixes.

## Fixes:

* **üêõ specialized tar extract traversal** by [*nils m√•s√©n*](https://github.com/piksel)
* **üêõ [[#635](https://github.com/icsharpcode/SharpZipLib/pull/635)] `bzip2` use explicit feature defs for vectorized memory move** by [*Jackson Wood*](https://github.com/modio-jackson)
* **üêõ [[#645](https://github.com/icsharpcode/SharpZipLib/pull/645)] `tar` create translated files in temp** by [*nils m√•s√©n*](https://github.com/piksel)

## Smaller changes:

* **üî® [[#604](https://github.com/icsharpcode/SharpZipLib/pull/604)] Move the Password property from DeflaterOutputStream into ZipOutputStream** by [*Richard Webb*](https://github.com/Numpsy)
* **üî® [[#625](https://github.com/icsharpcode/SharpZipLib/pull/625)] Make BZip2Constants static instead of sealed** by [*Richard Webb*](https://github.com/Numpsy)
* **üî® [[#626](https://github.com/icsharpcode/SharpZipLib/pull/626)] make a couple of private functions static** by [*Richard Webb*](https://github.com/Numpsy)

## Other changes (not related to library code):

* **üìö [[#648](https://github.com/icsharpcode/SharpZipLib/pull/648)] `zip` fix ZipStrings typo** by [*Friedrich von Never*](https://github.com/ForNeVeR)
* **üö® add tests for tar path traversal** by [*nils m√•s√©n*](https://github.com/piksel)
* **‚öôÔ∏è add codeql analysis** by [*nils m√•s√©n*](https://github.com/piksel)
* **üö® [[#636](https://github.com/icsharpcode/SharpZipLib/pull/636)] Fix unstable tests and switch to dotcover** by [*nils m√•s√©n*](https://github.com/piksel)
* **üö® [[#634](https://github.com/icsharpcode/SharpZipLib/pull/634)] add an async version of the WriteZipOutputStream benchmark** by [*Richard Webb*](https://github.com/Numpsy)
* **‚öôÔ∏è [[#628](https://github.com/icsharpcode/SharpZipLib/pull/628)] Limit code coverage to windows CI** by [*nils m√•s√©n*](https://github.com/piksel)
* **üö® [[#627](https://github.com/icsharpcode/SharpZipLib/pull/627)] fix the expected/actual value ordering in unit tests** by [*Richard Webb*](https://github.com/Numpsy)

 Assets
3

 Loading

 üëç
2
 Molkree and nfynt-zap reacted with thumbs up emoji
 ‚ù§Ô∏è
1
 andrenevesgomes reacted with heart emoji

All reactions

* üëç
  2 reactions
* ‚ù§Ô∏è
  1 reaction

 3 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from securitylab.github.com_b513fa41_20250115_084845.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 8, 2021
# GHSL-2021-125: Path traversal in SharpZipLib - CVE-2021-32840, CVE-2021-32841, CVE-2021-32842

[![Author avatar](https://avatars.githubusercontent.com/u/26652396)
Jaroslav Lobaƒçevski](https://github.com/jarlob)

## Coordinated Disclosure Timeline

* 2021-09-03: Report sent to sharpziplib@containrrr.dev according to [security policy](https://github.com/icsharpcode/SharpZipLib/blob/cd5310f5b7eed595110b76a2f7ae5ee013cc50f1/SECURITY.md).
* 2021-09-08: No response. The email repeated.
* 2021-09-17: No response. Public [issue](https://github.com/icsharpcode/SharpZipLib/issues/663) created asking for the contact.
* 2021-09-17: Contact established.
* 2021-09-19: [v1.3.3](https://github.com/icsharpcode/SharpZipLib/releases/tag/v1.3.3) with a fix was released.

## Summary

SharpZipLib allows full or partial (depending on the version) traversal of the extraction path.

## Product

[SharpZipLib](https://github.com/icsharpcode/SharpZipLib)

## Tested Version

0.86.0-1.3.2, however according to the SharpZipLib [security policy](https://github.com/icsharpcode/SharpZipLib/blob/69ce65cd672505a1ae5ffd4e15aa1f009ba3819a/SECURITY.md) version 0.86.0 is no longer supported.

## Details

### Issue 1: 0.86.0 <= SharpZipLib <= 1.2.0 TAR extraction doesn‚Äôt validate if the destination path is under the expected extraction directory

The following [code example from SharpZipLib wiki](https://github.com/icsharpcode/SharpZipLib/wiki/GZip-and-Tar-Samples#anchorTar):

```
using System;
using System.IO;
using ICSharpCode.SharpZipLib.Tar;

public void ExtractTar(String tarFileName, String destFolder)
{
    Stream inStream = File.OpenRead(tarFileName);

    TarArchive tarArchive = TarArchive.CreateInputTarArchive(inStream);
    tarArchive.ExtractContents(destFolder);
    tarArchive.Close();

    inStream.Close();
}

```

A TAR file entry `../evil.txt` will be extracted in the parent directory of `destFolder`.

#### Impact

It leads to arbitrary file write that may lead to code execution.

#### CVE

* CVE-2021-32840

### Issue 2: 1.3.0 <= SharpZipLib <= 1.3.2 TAR extraction directory path is not enforced to be slash terminated

Starting versioin 1.3.0 a check was added if the [destination file is under destination directory](https://github.com/icsharpcode/SharpZipLib/blob/cd5310f5b7eed595110b76a2f7ae5ee013cc50f1/src/ICSharpCode.SharpZipLib/Tar/TarArchive.cs#L660-L665):

```
if (!allowParentTraversal && !Path.GetFullPath(destFile).StartsWith(destDir, StringComparison.InvariantCultureIgnoreCase))
{
	throw new InvalidNameException("Parent traversal in paths is not allowed");
}

```

However it is not enforced that `destDir` ends with slash. If the `destDir` is not slash terminated like `/home/user/dir` it is possible to create a file with a name thats begins with the destination directory, i.e. `/home/user/dir.sh`.

#### Impact

Because of the file name and destination directory constraints the arbitrary file creation impact is limited and depends on the use case.

#### CVE

* CVE-2021-32841

### Issue 3: 0.86.0 <= SharpZipLib <= 1.3.1 ZIP extraction directory path is not enforced to be slash terminated

The following [code example from SharpZipLib wiki](https://github.com/icsharpcode/SharpZipLib/wiki/FastZip#-how-to-extract-a-zip-file-using-fastzip):

```
using System;
using ICSharpCode.SharpZipLib.Zip;

public void TestFastZipUnpack(string zipFileName, string targetDir) {

    FastZip fastZip = new FastZip();
    string fileFilter = null;

    // Will always overwrite if target filenames already exist
    fastZip.ExtractZip(zipFileName, targetDir, fileFilter);
}

```

Starting version 1.0.0 a check was added if the [destination file is under destination directory](https://github.com/icsharpcode/SharpZipLib/blob/dad484ea8e441d31b91a5fb7ed8f3f4507a75f1e/src/ICSharpCode.SharpZipLib/Zip/WindowsNameTransform.cs#L132-L140):

```
if (_baseDirectory != null) {
	name = Path.Combine(_baseDirectory, name);

	if(!_allowParentTraversal && !Path.GetFullPath(name).StartsWith(_baseDirectory, StringComparison.InvariantCultureIgnoreCase))
	{
		throw new InvalidNameException("Parent traversal in paths is not allowed");
	}

```

However it is not enforced that `_baseDirectory` ends with slash. If the `_baseDirectory` is not slash terminated like `/home/user/dir` it is possible to create a file with a name thats begins as the destination directory one level up from the directory, i.e. `/home/user/dir.sh`.

#### Impact

Because of the file name and destination directory constraints the arbitrary file creation impact is limited and depends on the use case.

#### CVE

* CVE-2021-32842

## Credit

This issue was discovered and reported by GHSL team member [@JarLob (Jaroslav Lobaƒçevski)](https://github.com/JarLob).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2021-125` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ¬©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information


