=== Content from mattermost.com_377f9533_20250115_091328.html ===


[Skip to content](#skip-nav-target)
[![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/mattermost-logo-horizontal.svg)](https://mattermost.com/)

* Platform

  Platform

  + [Overview](https://mattermost.com/platform-overview/)
  + [Channels](https://mattermost.com/channels/)
  + [Playbooks](https://mattermost.com/playbooks/)
  + [Integrations](https://mattermost.com/integrations-overview/)
  + [Mobile](https://mattermost.com/mobile/)
  + [AI](https://mattermost.com/copilot/)
  + [Security](https://mattermost.com/security/)
  + [Trust Center](https://trust.mattermost.com/)

  Interoperability

  + [MS Teams](https://mattermost.com/solutions/mattermost-for-microsoft-teams/)
  + [Atlassian](https://mattermost.com/atlassian/)
  + [GitLab](https://mattermost.com/solutions/mattermost-gitlab/)

  Flexible Deployment

  + [On-Premise](https://mattermost.com/enterprise/on-prem/)
  + [Cloud](https://mattermost.com/enterprise/cloud/)
* Solutions

  Use Cases

  + [Integrated Security Operations](https://mattermost.com/solutions/use-cases/integrated-security-operations/)
  + [Out-of-Band Incident Response](https://mattermost.com/solutions/use-cases/out-of-band-incident-response/)
  + [Self-Sovereign Collaboration](https://mattermost.com/solutions/use-cases/self-sovereign-collaboration/)
  + [Mission-Critical ChatOps](https://mattermost.com/solutions/use-cases/mission-critical-chatops/)
  + [Real-Time DevSecOps Collaboration](https://mattermost.com/solutions/use-cases/devsecops-collaboration/)
  + [Purpose-Built Collaboration Hub](https://mattermost.com/solutions/use-cases/purpose-built-collaboration/)

  Industries

  + [Critical Infrastructure](https://mattermost.com/solutions/industries/critical-infrastructure/)
  + [Defense](https://mattermost.com/solutions/industries/defense/)
  + [Technology](https://mattermost.com/solutions/industries/technology/)
  + [Global Public Sector](https://mattermost.com/solutions/industries/government/)
  + [Financial Services](https://mattermost.com/solutions/industries/financial-services/)
  + [Energy and Utilities](https://mattermost.com/solutions/industries/energy-and-utilities/)
  + [Manufacturing](https://mattermost.com/solutions/industries/manufacturing/)
* Customers

  Customers

  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-usaf.png)
    USAF](https://mattermost.com/customers/us-department-of-defense/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-fujitsu.png)
    Fujitsu](https://mattermost.com/customers/fujitsu/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-rte.png)
    RTE](https://mattermost.com/customers/rte/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-cern.png)
    CERN](https://mattermost.com/customers/cern/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-nri.png)
    NRI](https://mattermost.com/customers/nri/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-pramacom.png)
    Pramacom](https://mattermost.com/customers/pramacom/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-crossover.png)
    Crossover Health](https://mattermost.com/customers/crossover-health/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-netfoundry.png)
    Netfoundry](https://mattermost.com/customers/netfoundry/)

  [See more customer stories »](https://mattermost.com/customers/)
* [Pricing](https://mattermost.com/pricing/)
* Partners

  Partners

  + [Become a Partner](https://support.mattermost.com/hc/en-us/requests/new?ticket_form_id=24278352368532)
  + [Partner Program](https://mattermost.com/partners/)
  + [Deal Registration](https://mattermost.com/reseller-deal-registration/)
* Resources

  Resources

  + [Resource Library](https://mattermost.com/resources/)
  + [Blog](https://mattermost.com/blog/)
  + [Demos](https://mattermost.com/resources/?filter=demos)
  + [Events](https://mattermost.com/events/)

  Documentation

  + [Academy](https://academy.mattermost.com/)
  + [Channels Guide](https://docs.mattermost.com/guides/channels.html)
  + [Playbooks Guide](https://docs.mattermost.com/guides/repeatable-processes.html)
  + [Admin](https://docs.mattermost.com/guides/administration.html)
  + [Docs](https://docs.mattermost.com/)
  + [API Reference](https://api.mattermost.com/)
  + [Release Notes](https://docs.mattermost.com/administration/changelog.html)

  Community

  + [Join Community](https://mattermost.com/community/)
  + [Contribute](https://mattermost.com/contribute/)
  + [Deploy](https://mattermost.com/download/)
  + [Integrate](https://developers.mattermost.com/integrate/getting-started/)
  + [Download](https://mattermost.com/download/)
* Login

  Login

  + [My Workspace](https://customers.mattermost.com/cloud/connect-workspace)
  + [Admin Portal](https://customers.mattermost.com/login/)
  + [Apps](https://mattermost.com/download/)
  + [Support](https://support.mattermost.com/hc/en-us/)
* [Talk to an Expert](https://mattermost.com/contact-sales/)

![Engineering](https://mattermost.com/wp-content/uploads/2021/09/Mattermost_Blog_Engineering@2x.webp)
# Coordinated disclosure of XML round-trip vulnerabilities in Go’s standard library

[Juho Forsén](https://mattermost.com/blog/author/juho-forsen/ "Posts by Juho Forsén")

December 14, 2020

[Engineering](https://mattermost.com/blog/category/engineering/)

This blog post is a part of Mattermost’s public disclosure of three serious vulnerabilities in Go’s `encoding/xml` related to tokenization round-trips. The public disclosure comes as a result of several months of work, including collaborating with the Go security team since August 2020 and with affected downstream project maintainers since earlier this month. There are several potential security problems created by these vulnerabilities, one of which is a complete bypass of SAML authentication.

**These issues do not impact Mattermost customers.** See [“No impact to Mattermost customers”](#no-impact-to-mattermost-customers) below for more info.

Despite significant efforts by the Go security team, it has not been possible to patch the vulnerabilities discussed in this blog post. Only one of the three is on the roadmap to be patched in the foreseeable future (see [“Update 12/13/2020” below](#update)). The mitigation for the remaining issues will be adding a new mode in Go to make explicit that these vulnerabilities exist. Downstream projects that assume certain integrity guarantees from Go’s standard library are vulnerable when those guarantees do not hold. The implications of these vulnerabilities in key use cases we have identified present a material security concern. If you maintain a Go-based project that relies on XML integrity, we urge you to read this post carefully.

We don’t take this type of public disclosure lightly, and it has not been an easy decision to make. There are three reasons why we are doing this now:

* The Go security team has determined that the root causes of the vulnerabilities cannot be reliably addressed.
* Go is introducing publicly-visible API changes related to these issues in an upcoming major release, which risks making the vulnerabilities public without explicit public disclosure.
  + The Go security team has agreed to Mattermost coordinating disclosure prior to making their changes public in order to minimize impact to parts of the ecosystem that can’t benefit from the new API. Refer to the [“Upcoming changes in Go”](#upcoming-changes-in-go) section for details.
* Careful steps have been taken to privately disclose the issues to as many affected parties as possible prior to proceeding with public disclosure. All parties involved in the disclosure have collaborated to ensure mitigations are in place and sufficient.

## The vulnerabilities

As part of our security work, we have identified three independently exploitable vulnerabilities in Go’s `encoding/xml`. The advisories are linked below:

* [CVE-2020-29509: XML attribute instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-attributes.md)
* [CVE-2020-29510: XML directive instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-directives.md)
* [CVE-2020-29511: XML element instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-elements.md)

As evident from the titles, the vulnerabilities are closely related. The core issue is the same in all three: maliciously crafted XML markup mutates during round-trips through Go’s decoder and encoder implementations.

What does that mean in practice? If your application processes XML and, while processing it, parses markup that’s the output of at least one preceding round of parsing and serialization, you can no longer assume the output of that parsing matches the output from the preceding round. In other words, passing XML through Go’s decoder and encoder doesn’t preserve its semantics.

This may sound like a non-issue or a source of functional bugs at worst, but the reality of it is much more serious. There are applications that absolutely require semantic integrity in XML in order to be secure — a major example being SAML.

SAML, or the Security Assertion Markup Language, is an XML-based standard approach to single sign-on on the web. It conveys user identity in XML documents whose integrity and authenticity are guaranteed using cryptographic signatures, a scheme called XML-DSig. Because of these vulnerabilities, Go-based SAML implementations are in many cases open to tampering by an attacker: by injecting malicious markup to a correctly signed SAML message, it’s possible to make it still appear correctly signed, but change its semantics to convey a different identity than the original document.

The actual impact of these XML round-trip vulnerabilities of course varies by use case, but in SAML SSO it’s easy to understand: if your SAML messages can be altered to say you’re someone you’re not, the result is arbitrary privilege escalation within the scope of the SAML Service Provider, or in some cases even complete authentication bypass.

As mentioned before, despite significant efforts by the Go security team, there is no Go patch that would reasonably address these vulnerabilities. That doesn’t mean all hope is lost: Along with the public disclosure of these vulnerabilities, we’re open-sourcing an XML validation library that can be used as a workaround. The library as well as basic instructions for its use can be found at [github.com/mattermost/xml-roundtrip-validator](https://github.com/mattermost/xml-roundtrip-validator).

## No impact to Mattermost customers

At the time this public disclosure is taking place, no supported versions of Mattermost products are affected by any of the vulnerabilities. Any impact to Mattermost software has been addressed independently prior to this disclosure and communicated to customers according to Mattermost’s standard disclosure policy. **No action is required from Mattermost customers at this time.**

Mattermost staff originally detected the first one of these vulnerabilities during an internal security review on the 28th of August, 2020. As an immediate response the only affected feature of Mattermost server, a new SAML implementation still in beta at the time, was forcefully disabled. The update was rolled out to customers [in a dot release on the 3rd of September](https://docs.mattermost.com/administration/changelog.html#release-v5-26-feature-release). Mattermost Cloud was not generally available at that time, and so was never affected.

The affected SAML implementation was available as a non-default configuration in Mattermost server versions from 5.20.0 up to and including 5.26.1. Mattermost deployments were only vulnerable if all of the following were simultaneously true:

* The server was running a version between 5.20.0 and 5.26.1, released before September 2020. This excludes Extended Support Releases 5.25.5 and above.
* The server was configured to use SAML SSO authentication.
* The setting “Use Improved SAML Library (Beta)” had been explicitly enabled by an administrator.

Details of the security release addressing these vulnerabilities can be found on the [Mattermost Security Updates page](https://mattermost.com/security-updates/) under the identifier MMSA-2020-0030.

Since the September dot release, Mattermost products have not been vulnerable. We have no evidence of this issue being ever exploited.

## Impact to the Go ecosystem

We have identified three major open source SAML implementations affected by the Go XML round-trip vulnerabilities: [Dex SAML Connector](https://dexidp.io/docs/connectors/saml/), [github.com/crewjam/saml](https://github.com/crewjam/saml), and [github.com/russellhaering/gosaml2](https://github.com/russellhaering/gosaml2). The maintainers of all three projects were included in private embargoed disclosure prior to publishing any details. Maintainers were also given advance access to the github.com/mattermost/xml-roundtrip-validator repository.

Patches are available in the following releases:

* [Dex IDP version 2.27.0](https://github.com/dexidp/dex/releases)
* [github.com/crewjam/saml version 0.4.3](https://github.com/crewjam/saml/releases)
* [github.com/russellhaering/gosaml2 version 0.6.0](https://github.com/russellhaering/gosaml2/tags)

We have also privately reached out to maintainers of significant applications and products that depend on these SAML implementations and given them an advance warning of today’s disclosure without revealing technical details.

Having an idea of the scale and range of affected products may help in understanding why we’ve gone to such lengths in coordinating this. We reached out to a total of 20 companies and projects in addition to the maintainers of the SAML implementations named above. The affected products include:

* A variety of cloud orchestration tools
* Security products from DFIR to secure access and endpoint management
* A commercial IAM solution from a major cloud hosting company
* Multiple web software frameworks
* Hardware root of trust APIs
* Well-known SaaS products

If you find yourself among the organizations we contacted, we urge you to start patching immediately.

It’s unlikely that we found all affected use cases, libraries, and products, and we may have missed even major ones. Even if you didn’t hear from us but suspect your particular use case of encoding/xml may be affected, please consider reviewing your codebase for vulnerable patterns.

## Upcoming changes in Go

The Go security team is planning changes to `encoding/xml` that address round-trip vulnerabilities by deprecating existing behaviors from a security perspective. A new API is expected to land in Go 1.16 that will allow disabling namespace prefix parsing entirely. The current functionality will remain available, but it will no longer be considered secure for use cases that require round-trip stability; Go will stop accepting vulnerability submissions related to its behavior.

The Go security team has chosen this path after determining that the `encoding/xml` package and its data structures were not designed to make safe round-trips possible. The new API allows them to lower developers’ expectations to a more manageable level, as the support for round-trips in the most problematic cases can be explicitly dropped.

By Mattermost’s estimates this new API will not be a reasonable solution for most use cases currently affected by the vulnerabilities. Parsing and resolving namespaces is an essential requirement for correctly implementing SAML, and even considering only a limited set of real-world SAML messages without strict namespacing requirements would be unlikely to allow for a secure implementation.

Because of this reason, we recommend that affected developers continue using the github.com/mattermost/xml-roundtrip-validator module even after Go 1.16 becomes available. As a long-term solution, it may make sense to refactor code in a way that avoids encoding round-trips altogether, but it’s unclear if such refactoring is possible in all cases.

### Update 12/13/2020

We just heard from the Go team that there are possibly additional changes coming in a future version.  It’s not clear to us whether these changes fully fix the XML validation issues in Go, but we’re hopeful that these issues will get fully patched in Go in the near future. We have been informed that a public discussion with the Go team will be opened in this issue at <https://golang.org/issue/43168>.

## Disclosure timeline

The first of the XML round-trip vulnerabilities was originally discovered on the 28th of August, 2020, and by the 31st of August Mattermost had traced the root cause to encoding/xml and reached out to the Go security team. The graphic below shows the full timeline from initial discovery to public disclosure. Blue circles represent actions taken by Mattermost, red circles are responses from the Go security team.

![](data:image/svg+xml...)

Mattermost would like to thank the Go security team and downstream library maintainers for their many efforts and their collaboration in responding to these important issues.

## Security contacts at Mattermost

If you suspect you’ve found a vulnerability in a Mattermost product or open source project such as the [github.com/mattermost/xml-roundtrip-validator](https://github.com/mattermost/xml-roundtrip-validator) module, please report your findings to [[email protected]](/cdn-cgi/l/email-protection#22504751524d4c514b404e47464b51414e4d51575047624f43565647504f4d51560c414d4f). We ask you not to use public GitHub issues for reporting security issues.

If you have general questions about application security at Mattermost or the vulnerabilities included in this disclosure, don’t hesitate to reach out to us at [[email protected]](/cdn-cgi/l/email-protection#1261777167607b666b527f73666677607f7d61663c717d7f).

Read more about:

[Go](https://mattermost.com/blog/tag/go/)
[security](https://mattermost.com/blog/tag/security/)
![](data:image/svg+xml...)
`[Juho Forsén](https://mattermost.com/blog/author/juho-forsen/ "Posts by Juho Forsén")`

Juho Forsén is a Staff Security Researcher at Mattermost. In the past he has held roles in security engineering, security consulting, and software development, and has more than a decade of experience building and securing open source software.

[Return to Blog](https://mattermost.com/blog/)

### Read Next

[![](data:image/svg+xml...)](https://mattermost.com/blog/mattermost-apps-framework-generally-available/)

### Share

## Read More Engineering Articles

[![](data:image/svg+xml...)](https://mattermost.com/blog/year-of-security-fixes-in-go/)

[![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2024/12/01_Redis_at_Scale@2x.webp)

Lessons learned from running Redis at scale](https://mattermost.com/blog/lessons-learned-running-redis-at-scale/)

[![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2024/11/06_DoS_Bug@2x.webp)

A DoS bug that's worse than it seems](https://mattermost.com/blog/a-dos-bug-thats-worse-than-it-seems/)

![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2021/08/mattermost-newsletter-sign-up.webp)
## Open source news, right in your inbox

## Thanks for subscribing!

![An illustration of a human beside an envelope with a green checkmark.](data:image/svg+xml...)![An illustration of a human beside an envelope with a green checkmark.](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/redesign/newsletter/newsletter-success.png)

* Company
  + [About Us](https://mattermost.com/about-us/)
  + [Newsroom](https://mattermost.com/newsroom/)
  + [Partners](https://mattermost.com/partners/)
  + [Events](https://mattermost.com/events/)
  + [Careers](https://mattermost.com/careers/)
  + [Contact Us](https://mattermost.com/contact-us/)
  + [Responsible Disclosure](https://mattermost.com/security-vulnerability-report/)

* Platform
  + [Platform Overview](https://mattermost.com/platform-overview/)
  + [Channels](https://mattermost.com/channels/)
  + [Playbooks](https://mattermost.com/playbooks/)
  + [Integrations](https://mattermost.com/integrations-overview/)
  + [Security](https://mattermost.com/security/)
  + [Customers](https://mattermost.com/customers/)
  + [Comparison Guide](https://mattermost.com/compare/)

* Documentation
  + [Deployment](https://docs.mattermost.com/guides/deployment.html)
  + [Channels Guide](https://docs.mattermost.com/guides/channels.html)
  + [Playbooks Guide](https://docs.mattermost.com/guides/playbooks.html)
  + [Admin](https://docs.mattermost.com/guides/administration.html)
  + [API Reference](https://api.mattermost.com/)
  + [All Docs](https://docs.mattermost.com/)

* Download
  + [Mobile & Desktop Apps](/apps/)
  + [Mattermost Server](/download/)

* Support
  + [General Support](https://mattermost.com/support/)
  + [Community Chat Server](https://community.mattermost.com/login)
  + [Forums](https://forum.mattermost.org/)
  + [Report an Issue](https://handbook.mattermost.com/contributors/contributors/ways-to-contribute#report-a-bug)
  + [Nominate a Feature](/suggestions/)
  + [Help Center](https://support.mattermost.com/hc/en-us)
  + [Terms](/terms-of-use/)

© Mattermost, Inc. 2025. [Terms
of Use](https://mattermost.com/terms-of-use/ "Terms of Service") | [Privacy Policy](https://mattermost.com/privacy-policy/ "Privacy Policy") | [Cookie Policy](https://mattermost.com/privacy-policy/cookies/ "Cookie Policy") | Manage Cookies

* [GitHub icon](https://github.com/mattermost/)
* [LinkedIn icon](https://www.linkedin.com/company/mattermost/)
* [Facebook icon](https://www.facebook.com/Mattermost-2300985916642531/)
* [X icon](https://twitter.com/mattermost)
* [Bluesky icon](https://bsky.app/profile/mattermost.bsky.social)



=== Content from github.com_f5662557_20250115_091325.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fcommit%2F7b4b743917a892d407356e055b296dcd6d107e8b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fcommit%2F7b4b743917a892d407356e055b296dcd6d107e8b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xmldom%2Fxmldom)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmldom](/xmldom)
/
**[xmldom](/xmldom/xmldom)**
Public

* [Notifications](/login?return_to=%2Fxmldom%2Fxmldom) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fxmldom%2Fxmldom)
* [Star
   370](/login?return_to=%2Fxmldom%2Fxmldom)

* [Code](/xmldom/xmldom)
* [Issues
  24](/xmldom/xmldom/issues)
* [Pull requests
  2](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects
  1](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

Additional navigation options

* [Code](/xmldom/xmldom)
* [Issues](/xmldom/xmldom/issues)
* [Pull requests](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

## Commit

[Permalink](/xmldom/xmldom/commit/7b4b743917a892d407356e055b296dcd6d107e8b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-5fg8-2547-mr8q](https://github.com/advisories/GHSA-5fg8-2547-mr8q "GHSA-5fg8-2547-mr8q")

[Browse files](/xmldom/xmldom/tree/7b4b743917a892d407356e055b296dcd6d107e8b)
Browse the repository at this point in the history

```
resolves [GHSA-5fg8-2547-mr8q](https://github.com/xmldom/xmldom/security/advisories/GHSA-5fg8-2547-mr8q "GHSA-5fg8-2547-mr8q")
```

* Loading branch information

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

[karfau](/xmldom/xmldom/commits?author=karfau "View all commits by karfau")
authored
Jul 27, 2021

1 parent
[9b92ff4](/xmldom/xmldom/commit/9b92ff439e9b480f24018ef2ff36121eb85b6328)

commit 7b4b743

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**31 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + lib/dom.js
    [dom.js](#diff-79db8c65cf49002eb2d5d7e81a17f3b73d94db6bb50c0c12f0c9f427aff4b11e)
* test/dom

  + test/dom/serializer.test.js
    [serializer.test.js](#diff-e83625823da188361d88557699cc3c79f6657dc2dff572168d005691e2563e77)

## There are no files selected for viewing

23 changes: 12 additions & 11 deletions

23
[lib/dom.js](#diff-79db8c65cf49002eb2d5d7e81a17f3b73d94db6bb50c0c12f0c9f427aff4b11e "lib/dom.js")

Show comments

[View file](/xmldom/xmldom/blob/7b4b743917a892d407356e055b296dcd6d107e8b/lib/dom.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1129,6 +1129,15 @@ function needNamespaceDefine(node, isHTML, visibleNamespaces) { |
|  |  | } |
|  |  | return true; |
|  |  | } |
|  |  | /\*\* |
|  |  | \* Well-formed constraint: No < in Attribute Values |
|  |  | \* The replacement text of any entity referred to directly or indirectly in an attribute value must not contain a <. |
|  |  | \* @see https://www.w3.org/TR/xml/#CleanAttrVals |
|  |  | \* @see https://www.w3.org/TR/xml/#NT-AttValue |
|  |  | \*/ |
|  |  | function addSerializedAttribute(buf, qualifiedName, value) { |
|  |  | buf.push(' ', qualifiedName, '="', value.replace(/[<&"]/g,\_xmlEncoder), '"') |
|  |  | } |
|  |  |  |
|  |  | function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){ |
|  |  | if (!visibleNamespaces) { |
| Expand Down  Expand Up | | @@ -1196,8 +1205,7 @@ function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){ |
|  |  | if (needNamespaceDefine(attr,isHTML, visibleNamespaces)) { |
|  |  | var prefix = attr.prefix||''; |
|  |  | var uri = attr.namespaceURI; |
|  |  | var ns = prefix ? ' xmlns:' + prefix : " xmlns"; |
|  |  | buf.push(ns, '="' , uri , '"'); |
|  |  | addSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : "xmlns", uri); |
|  |  | visibleNamespaces.push({ prefix: prefix, namespace:uri }); |
|  |  | } |
|  |  | serializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces); |
| Expand All | | @@ -1207,8 +1215,7 @@ function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){ |
|  |  | if (nodeName === prefixedNodeName && needNamespaceDefine(node, isHTML, visibleNamespaces)) { |
|  |  | var prefix = node.prefix||''; |
|  |  | var uri = node.namespaceURI; |
|  |  | var ns = prefix ? ' xmlns:' + prefix : " xmlns"; |
|  |  | buf.push(ns, '="' , uri , '"'); |
|  |  | addSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : "xmlns", uri); |
|  |  | visibleNamespaces.push({ prefix: prefix, namespace:uri }); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1247,13 +1254,7 @@ function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){ |
|  |  | } |
|  |  | return; |
|  |  | case ATTRIBUTE\_NODE: |
|  |  | /\*\* |
|  |  | \* Well-formedness constraint: No < in Attribute Values |
|  |  | \* The replacement text of any entity referred to directly or indirectly in an attribute value must not contain a <. |
|  |  | \* @see https://www.w3.org/TR/xml/#CleanAttrVals |
|  |  | \* @see https://www.w3.org/TR/xml/#NT-AttValue |
|  |  | \*/ |
|  |  | return buf.push(' ', node.name, '="', node.value.replace(/[<&"]/g,\_xmlEncoder), '"'); |
|  |  | return addSerializedAttribute(buf, node.name, node.value); |
|  |  | case TEXT\_NODE: |
|  |  | /\*\* |
|  |  | \* The ampersand character (&) and the left angle bracket (<) must not appear in their literal form, |
| Expand Down | |  |

19 changes: 19 additions & 0 deletions

19
[test/dom/serializer.test.js](#diff-e83625823da188361d88557699cc3c79f6657dc2dff572168d005691e2563e77 "test/dom/serializer.test.js")

Show comments

[View file](/xmldom/xmldom/blob/7b4b743917a892d407356e055b296dcd6d107e8b/test/dom/serializer.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -120,4 +120,23 @@ describe('XML Serializer', () => { |
|  |  | ) |
|  |  | }) |
|  |  | }) |
|  |  | describe('properly escapes attribute values', () => { |
|  |  | it('should escape special characters in namespace attributes', () => { |
|  |  | const input = `<xml xmlns='<&"' xmlns:attr='"&<'><test attr:test=""/></xml>` |
|  |  | const doc = new DOMParser().parseFromString(input, MIME\_TYPE.XML\_TEXT) |
|  |  |  |
|  |  | // in this case the explicit attribute nodes are serialized |
|  |  | expect(new XMLSerializer().serializeToString(doc)).toBe( |
|  |  | '<xml xmlns="&lt;&amp;&quot;" xmlns:attr="&quot;&amp;&lt;"><test attr:test=""/></xml>' |
|  |  | ) |
|  |  |  |
|  |  | // in this case the namespace attributes are "inherited" from the parent, |
|  |  | // which is not serialized |
|  |  | expect( |
|  |  | new XMLSerializer().serializeToString(doc.documentElement.firstChild) |
|  |  | ).toBe( |
|  |  | '<test xmlns:attr="&quot;&amp;&lt;" attr:test="" xmlns="&lt;&amp;&quot;"/>' |
|  |  | ) |
|  |  | }) |
|  |  | }) |
|  |  | }) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7b4b743`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fcommit%2F7b4b743917a892d407356e055b296dcd6d107e8b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c338b499_20250115_091326.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fsecurity%2Fadvisories%2FGHSA-5fg8-2547-mr8q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fsecurity%2Fadvisories%2FGHSA-5fg8-2547-mr8q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xmldom%2Fxmldom)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmldom](/xmldom)
/
**[xmldom](/xmldom/xmldom)**
Public

* [Notifications](/login?return_to=%2Fxmldom%2Fxmldom) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fxmldom%2Fxmldom)
* [Star
   370](/login?return_to=%2Fxmldom%2Fxmldom)

* [Code](/xmldom/xmldom)
* [Issues
  24](/xmldom/xmldom/issues)
* [Pull requests
  2](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects
  1](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

Additional navigation options

* [Code](/xmldom/xmldom)
* [Issues](/xmldom/xmldom/issues)
* [Pull requests](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

# Misinterpretation of malicious XML input

Moderate

[karfau](/karfau)
published
GHSA-5fg8-2547-mr8q
Jul 27, 2021

## Package

npm

xmldom
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 0.6.0

## Patched versions

@xmldom/xmldom@>=0.7.0

## Description

### Impact

xmldom versions 0.6.0 and older do not correctly escape special characters when serializing elements removed from their ancestor. This may lead to unexpected syntactic changes during XML processing in some downstream applications.

### Patches

Update to one of the fixed versions of `@xmldom/xmldom` (`>=0.7.0`)

See issue [#271](https://github.com/xmldom/xmldom/issues/271) for the status of publishing `xmldom` to npm or join [#270](https://github.com/xmldom/xmldom/discussions/270) for Q&A/discussion until it's resolved.

### Workarounds

Downstream applications can validate the input and reject the maliciously crafted documents.

### References

Similar to this one reported on the Go standard library:

* <https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/>
* <https://mattermost.com/blog/securing-xml-implementations-across-the-web/>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [`xmldom/xmldom`](https://github.com/xmldom/xmldom)
* Email us: send an email to **all** addresses that are shown by `npm owner ls @xmldom/xmldom`

### Severity

Moderate

### CVE ID

CVE-2021-32796

### Weaknesses

[CWE-115](/advisories?query=cwe%3A115)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


