=== Content from github.com_9b433f89_20250114_231137.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frabbitmq%2Frabbitmq-server%2Fpull%2F3122)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frabbitmq%2Frabbitmq-server%2Fpull%2F3122)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rabbitmq%2Frabbitmq-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rabbitmq](/rabbitmq)
/
**[rabbitmq-server](/rabbitmq/rabbitmq-server)**
Public

* [Notifications](/login?return_to=%2Frabbitmq%2Frabbitmq-server) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Frabbitmq%2Frabbitmq-server)
* [Star
   12.4k](/login?return_to=%2Frabbitmq%2Frabbitmq-server)

* [Code](/rabbitmq/rabbitmq-server)
* [Issues
  224](/rabbitmq/rabbitmq-server/issues)
* [Pull requests
  47](/rabbitmq/rabbitmq-server/pulls)
* [Discussions](/rabbitmq/rabbitmq-server/discussions)
* [Actions](/rabbitmq/rabbitmq-server/actions)
* [Security](/rabbitmq/rabbitmq-server/security)
* [Insights](/rabbitmq/rabbitmq-server/pulse)

Additional navigation options

* [Code](/rabbitmq/rabbitmq-server)
* [Issues](/rabbitmq/rabbitmq-server/issues)
* [Pull requests](/rabbitmq/rabbitmq-server/pulls)
* [Discussions](/rabbitmq/rabbitmq-server/discussions)
* [Actions](/rabbitmq/rabbitmq-server/actions)
* [Security](/rabbitmq/rabbitmq-server/security)
* [Insights](/rabbitmq/rabbitmq-server/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frabbitmq%2Frabbitmq-server%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frabbitmq%2Frabbitmq-server%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Escape the consumer-tag value in federation mgmt #3122

 Merged

[michaelklishin](/michaelklishin)
merged 1 commit into
[rabbitmq:master](/rabbitmq/rabbitmq-server/tree/master "rabbitmq/rabbitmq-server:master")
from
[dentarg:federation-upstreams/escape\_consumer-tag](/dentarg/rabbitmq-server/tree/federation-upstreams/escape_consumer-tag "dentarg/rabbitmq-server:federation-upstreams/escape_consumer-tag")

Jun 19, 2021

 Merged

# [Escape the consumer-tag value in federation mgmt](#top) #3122

[michaelklishin](/michaelklishin)
merged 1 commit into
[rabbitmq:master](/rabbitmq/rabbitmq-server/tree/master "rabbitmq/rabbitmq-server:master")
from
[dentarg:federation-upstreams/escape\_consumer-tag](/dentarg/rabbitmq-server/tree/federation-upstreams/escape_consumer-tag "dentarg/rabbitmq-server:federation-upstreams/escape_consumer-tag")

Jun 19, 2021

[Conversation
2](/rabbitmq/rabbitmq-server/pull/3122)
[Commits
1](/rabbitmq/rabbitmq-server/pull/3122/commits)
[Checks
0](/rabbitmq/rabbitmq-server/pull/3122/checks)
[Files changed](/rabbitmq/rabbitmq-server/pull/3122/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dentarg](https://avatars.githubusercontent.com/u/42626?s=60&v=4)](/dentarg)

Copy link

Contributor

### @dentarg **[dentarg](/dentarg)** commented [Jun 19, 2021](#issue-925337100) • edited by michaelklishin Loading

## Proposed Changes

The same way we do with other fields.

## Types of Changes

What types of changes does your code introduce to this project?

*Put an `x` in the boxes that apply*

* Bug fix (non-breaking change which fixes issue #NNNN)
* New feature (non-breaking change which adds functionality)
* Breaking change (fix or feature that would cause an observable behavior change in existing systems)
* Documentation improvements (corrections, new content, etc)
* Cosmetic change (whitespace, formatting, etc)

## Checklist

*Put an `x` in the boxes that apply. You can also fill these out after creating

the PR. If you're unsure about any of them, don't hesitate to ask on the

mailing list. We're here to help! This is simply a reminder of what we are

going to look for before merging your code.*

* I have read the `CONTRIBUTING.md` document
* I have signed the CA (see <https://cla.pivotal.io/sign/rabbitmq>)
* All tests pass locally with my changes
* I have added tests that prove my fix is effective or that my feature works
* I have added necessary documentation (if appropriate)
* Any dependent changes have been merged and published in related repositories

## Further Comments

If this is a relatively large or complex change, kick off the discussion by

explaining why you chose the solution you did and what alternatives you

considered, etc.

Sorry, something went wrong.

All reactions

[![@dentarg](https://avatars.githubusercontent.com/u/42626?s=40&v=4)](/dentarg)

`[Escape the consumer-tag value in federation mgmt](/rabbitmq/rabbitmq-server/pull/3122/commits/f191414dbc2ca738f313bb31e432d57870922892 "Escape the consumer-tag value in federation mgmt

Patches persistent XSS.")`
 …

`[f191414](/rabbitmq/rabbitmq-server/pull/3122/commits/f191414dbc2ca738f313bb31e432d57870922892)`

```
Patches persistent XSS.
```

[![michaelklishin](https://avatars.githubusercontent.com/u/1090?s=60&v=4)](/michaelklishin)

**[michaelklishin](/michaelklishin)**
approved these changes
[Jun 19, 2021](#pullrequestreview-687816485)

 [View reviewed changes](/rabbitmq/rabbitmq-server/pull/3122/files/f191414dbc2ca738f313bb31e432d57870922892)

[![michaelklishin](https://avatars.githubusercontent.com/u/1090?s=60&v=4)](/michaelklishin)

**[michaelklishin](/michaelklishin)**
approved these changes
[Jun 19, 2021](#pullrequestreview-687817194)

 [View reviewed changes](/rabbitmq/rabbitmq-server/pull/3122/files/f191414dbc2ca738f313bb31e432d57870922892)

[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=40&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)
[michaelklishin](/michaelklishin)
merged commit [`f01f0f2`](/rabbitmq/rabbitmq-server/commit/f01f0f2d840b98128cdb7ff966d8234b06ef7c75)
into
rabbitmq:master

[Jun 19, 2021](https://github.com/rabbitmq/rabbitmq-server/pull/3122#event-4912393816)

[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=40&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)
[michaelklishin](/michaelklishin)
added this to the [3.8.18](/rabbitmq/rabbitmq-server/milestone/74) milestone
[Jun 19, 2021](#event-4912393961)

[michaelklishin](/michaelklishin)
added a commit
that referenced
this pull request
[Jun 19, 2021](#ref-commit-51df93b)
[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=40&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)

`[Merge pull request](/rabbitmq/rabbitmq-server/commit/51df93b45fb05f935456f09b88e7554e0b36317f "Merge pull request #3122 from dentarg/federation-upstreams/escape_consumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit f01f0f2d840b98128cdb7ff966d8234b06ef7c75)") [#3122](https://github.com/rabbitmq/rabbitmq-server/pull/3122) [from dentarg/federation-upstreams/escape_con…](/rabbitmq/rabbitmq-server/commit/51df93b45fb05f935456f09b88e7554e0b36317f "Merge pull request #3122 from dentarg/federation-upstreams/escape_consumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit f01f0f2d840b98128cdb7ff966d8234b06ef7c75)")`
…

`[51df93b](/rabbitmq/rabbitmq-server/commit/51df93b45fb05f935456f09b88e7554e0b36317f)`

```
…sumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit [f01f0f2](https://github.com/rabbitmq/rabbitmq-server/commit/f01f0f2d840b98128cdb7ff966d8234b06ef7c75))
```

[michaelklishin](/michaelklishin)
added a commit
that referenced
this pull request
[Jun 19, 2021](#ref-commit-08beb82)
[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=40&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)

`[Merge pull request](/rabbitmq/rabbitmq-server/commit/08beb82e9ab8923ded88ece2800cd80971e2bd05 "Merge pull request #3122 from dentarg/federation-upstreams/escape_consumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit f01f0f2d840b98128cdb7ff966d8234b06ef7c75)") [#3122](https://github.com/rabbitmq/rabbitmq-server/pull/3122) [from dentarg/federation-upstreams/escape_con…](/rabbitmq/rabbitmq-server/commit/08beb82e9ab8923ded88ece2800cd80971e2bd05 "Merge pull request #3122 from dentarg/federation-upstreams/escape_consumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit f01f0f2d840b98128cdb7ff966d8234b06ef7c75)")`
…

`[08beb82](/rabbitmq/rabbitmq-server/commit/08beb82e9ab8923ded88ece2800cd80971e2bd05)`

```
…sumer-tag

Escape the consumer-tag value in federation mgmt

(cherry picked from commit [f01f0f2](https://github.com/rabbitmq/rabbitmq-server/commit/f01f0f2d840b98128cdb7ff966d8234b06ef7c75))
```

[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=80&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)

Copy link

Member

### **[michaelklishin](/michaelklishin)** commented [Jun 19, 2021](#issuecomment-864394375)

| Backported to `v3.9.x`. |
| --- |

All reactions

Sorry, something went wrong.

[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=80&u=5a39ce34a2163cf39d7524da94554db91cbcda50&v=4)](/michaelklishin)

Copy link

Member

### **[michaelklishin](/michaelklishin)** commented [Jun 19, 2021](#issuecomment-864394398)

| Backported to `v3.8.x`. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frabbitmq%2Frabbitmq-server%2Fpull%2F3122)

Reviewers

[![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=40&v=4)](/michaelklishin) [michaelklishin](/michaelklishin)

michaelklishin approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**3.8.18**](/rabbitmq/rabbitmq-server/milestone/74 "3.8.18")

Development

Successfully merging this pull request may close these issues.

2 participants

[![@dentarg](https://avatars.githubusercontent.com/u/42626?s=52&v=4)](/dentarg) [![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=52&v=4)](/michaelklishin)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4ec0f6b6_20250114_231139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frabbitmq%2Frabbitmq-server%2Fsecurity%2Fadvisories%2FGHSA-5452-hxj4-773x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frabbitmq%2Frabbitmq-server%2Fsecurity%2Fadvisories%2FGHSA-5452-hxj4-773x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=rabbitmq%2Frabbitmq-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rabbitmq](/rabbitmq)
/
**[rabbitmq-server](/rabbitmq/rabbitmq-server)**
Public

* [Notifications](/login?return_to=%2Frabbitmq%2Frabbitmq-server) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Frabbitmq%2Frabbitmq-server)
* [Star
   12.4k](/login?return_to=%2Frabbitmq%2Frabbitmq-server)

* [Code](/rabbitmq/rabbitmq-server)
* [Issues
  224](/rabbitmq/rabbitmq-server/issues)
* [Pull requests
  47](/rabbitmq/rabbitmq-server/pulls)
* [Discussions](/rabbitmq/rabbitmq-server/discussions)
* [Actions](/rabbitmq/rabbitmq-server/actions)
* [Security](/rabbitmq/rabbitmq-server/security)
* [Insights](/rabbitmq/rabbitmq-server/pulse)

Additional navigation options

* [Code](/rabbitmq/rabbitmq-server)
* [Issues](/rabbitmq/rabbitmq-server/issues)
* [Pull requests](/rabbitmq/rabbitmq-server/pulls)
* [Discussions](/rabbitmq/rabbitmq-server/discussions)
* [Actions](/rabbitmq/rabbitmq-server/actions)
* [Security](/rabbitmq/rabbitmq-server/security)
* [Insights](/rabbitmq/rabbitmq-server/pulse)

# Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) in RabbitMQ federation management plugin

Low

[michaelklishin](/michaelklishin)
published
GHSA-5452-hxj4-773x
Jun 27, 2021

## Package

rabbitmq-server

## Affected versions

< 3.8.18

## Patched versions

3.8.18

## Description

Our team would like to thank Fahimhusain Raydurg for [responsibly disclosing](https://www.rabbitmq.com/contact.html#security)

this vulnerability and Patrik Ragnarsson from CloudAMQP for contributing a fix.

### Impact

When a federation link was displayed in the RabbitMQ management UI via the `rabbitmq_federation_management` plugin,

its consumer tag was rendered without proper <script> tag sanitization, potentially allowing for JavaScript code

execution in the context of the page.

The user must be signed in and have elevated permissions (manage federation upstreams and policies).

### Patches

* The vulnerability is patched in RabbitMQ 3.8.18 or a later version.
* [#3122](https://github.com/rabbitmq/rabbitmq-server/pull/3122)

### Workarounds

Disable the `rabbitmq_federation_management` plugin and use [CLI tools](https://www.rabbitmq.com/cli.html) instead.

### References

None.

### For more information

If you have any questions or comments about this advisory, please contact `security@rabbitmq.com`.

### Severity

Low

3.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N

### CVE ID

CVE-2021-32719

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from herolab.usd.de_5e2bea0c_20250114_231141.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2021-0011/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2021-0011/ "English")

# usd-2021-0011 | RabbitMQ

**Advisory ID**: usd-2021-0011
**CVE Number**: [CVE-2021-32718](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32718)
**Affected Product**: RabbitMQ management plugin
**Affected Version**: RabbitMQ 3.8.12
**Vulnerability Type**: CWE-79: Improper Neutralization of Input During Web Page Generation („Cross-site Scripting“)
**Security Risk**: Low (CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C)
**Vendor URL**: https://www.rabbitmq.com
**Vendor Status**: Fixed

### Description

The vulnerability exists in RabbitMQ’s „Add a user“ functionality and is only exploitable in the following situation: A user account containing the XSS payload in the user name must already exist within the application.

### Proof of Concept (PoC)

Step 1: Create a user account named as follows:

'‹script›alert(1)‹/script›

Step 2: Update the user account using the „Add a user“ functionality of the web interface. After submitting the data, the application displays a confirmation message in which the XSS payload will be included and thus executed.

Note, that this vulnerability does not affect the „Edit User“ feature, but the „Add a user“ feature which can also be used to modify existing users. The HTTP request for updating the user looks as follows:

PUT /api/users/'%3Cscript%3Ealert(1)%3C%2Fscript%3E HTTP/1.1

Host: 127.0.0.1:15672

Accept: \*/\*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

content-type: application/json

authorization: Basic Z3Vlc3Q6Z3Vlc3Q=

Content-Length: 91

Origin: http://127.0.0.1:15672

Connection: close

Referer: http://127.0.0.1:15672/

Cookie: m=2258:Z3Vlc3Q6Z3Vlc3Q%253D

{"username":"'‹script›alert(1)‹/script›","password":"abcdefg","tags":""}

The following screenshots show how the vulnerability can be triggered in the web interface and where the payload is executed:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/xss.png "xss")
![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/xss2.png "xss2")
### Fix

It is recommended to treat all input on the website as potentially dangerous. Hence, all output that is dynamically generated based on user-controlled data should be encoded according to its context. The majority of programming languages supports standard procedures for encoding meta characters.

###

### Timeline

* 2021-03-25: This vulnerability was identified by Christian Rellmann.
* 2021-04-15: Initial contact with vendor.
* 2021-04-16: Vulnerability details transmitted to vendor.
* 2021-05-06: Vendor starts working on a patch.
* 2021-06-08: Vendor released a [patch](https://github.com/rabbitmq/rabbitmq-server/releases/tag/v3.8.17).
* 2021-06-27: Vulnerability details [published by vendor](https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-c3hj-rg5h-2772).
* 2021-06-30: Security advisory released by usd AG.

###

### Credits

This security vulnerability was found by Christian Rellmann of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)


