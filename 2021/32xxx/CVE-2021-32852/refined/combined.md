=== Content from securitylab.github.com_a5b6b0e6_20250114_193444.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

February 1, 2022
# GHSL-2021-104: Cross-Site Scripting in countly-server - CVE-2021-32852

[![Author avatar](https://avatars.githubusercontent.com/u/61799930)
GitHub Security Lab](https://github.com/ghsecuritylab)

## Coordinated Disclosure Timeline

* 2021-08-31: Report sent to maintainers.
* 2021-09-04: Maintainers respond that a fix was made, but they are reviewing the code for similar vulnerabilities.
* 2021-11-10: v21.11 with the fix was released.

## Summary

Cross-site scripting in <https://github.com/Countly/countly-server>

## Product

<https://github.com/Countly/countly-server>

## Tested Version

The latest version to the date.

## Details

Code injection is possible in the template snippet in [reset.html](https://github.com/Countly/countly-server/blob/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express/views/reset.html#L95):

```
showMessage("<%= message %>", "<%= password_min %>");

```

Both `message` and `password_min` come from query parameters passed in [here](https://github.com/Countly/countly-server/blob/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express/app.js#L1112) (reformatted below for convenience):

```
res.render('reset', {
    ...
    "message": req.query.message || "",
    password_min: req.query.password_min || "",
    ...
});

```

The `<%= message %>` tag performs HTML-escaping which ordinarily prevents breaking out of the string literal, but the backslash is not escaped, so injection is possible by setting:

* `message` to a single backslash character
* `password_min` to the string `, alert(1)); //`

Resulting in the following code generated by the template:

```
showMessage("\", ", alert(1)); //");

```
## CVE

* CVE-2021-32852

## Impact

Code Execution **(on client side)**.

The victim must follow a malicious link or be redirected there from malicious web site. The attacker must have an account or be able to create one.

It’s unclear how the open-source code relates to the enterprise version of the software. It’s *possible* only the community edition is affected.

## Credit

This issue was discovered by [@asgerf (Asger F)](https://github.com/asgerf) from the GitHub CodeQL team.

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include `GHSL-2021-104` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_e4d02c05_20250114_193440.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Fblob%2F6b90bb775e747cabe46fe197c6a6989acc6c3417%2Ffrontend%2Fexpress%2Fapp.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Fblob%2F6b90bb775e747cabe46fe197c6a6989acc6c3417%2Ffrontend%2Fexpress%2Fapp.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Countly%2Fcountly-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Countly](/Countly)
/
**[countly-server](/Countly/countly-server)**
Public

* [Notifications](/login?return_to=%2FCountly%2Fcountly-server) You must be signed in to change notification settings
* [Fork
  976](/login?return_to=%2FCountly%2Fcountly-server)
* [Star
   5.6k](/login?return_to=%2FCountly%2Fcountly-server)

* [Code](/Countly/countly-server)
* [Issues
  27](/Countly/countly-server/issues)
* [Pull requests
  15](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects
  0](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

Additional navigation options

* [Code](/Countly/countly-server)
* [Issues](/Countly/countly-server/issues)
* [Pull requests](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

## Files

 6b90bb7
## Breadcrumbs

1. [countly-server](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417)
2. /[frontend](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend)
3. /[express](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express)
/
# app.js

Copy path Blame  Blame
## Latest commit

## History

[History](/Countly/countly-server/commits/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express/app.js)1563 lines (1425 loc) · 63.1 KB 6b90bb7
## Breadcrumbs

1. [countly-server](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417)
2. /[frontend](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend)
3. /[express](/Countly/countly-server/tree/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express)
/
# app.js

Top
## File metadata and controls

* Code
* Blame

1563 lines (1425 loc) · 63.1 KB[Raw](https://github.com/Countly/countly-server/raw/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express/app.js)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\*\* \* Main dashboard process app.js \* @module frontend/express/app \*/
// Set process nameprocess.title = "countly: dashboard node " + process.argv[1];
var versionInfo = require('./version.info'), pack = require('../../package.json'), COUNTLY\_VERSION = versionInfo.version, COUNTLY\_COMPANY = versionInfo.company || '', COUNTLY\_TYPE = versionInfo.type, COUNTLY\_PAGE = versionInfo.page = (!versionInfo.title) ? "http://count.ly" : null, COUNTLY\_NAME = versionInfo.title = versionInfo.title || "Countly", COUNTLY\_DOCUMENTATION\_LINK = (typeof versionInfo.documentationLink === "undefined") ? true : (typeof versionInfo.documentationLink === "string") ? versionInfo.documentationLink : (typeof versionInfo.documentationLink === "boolean") ? versionInfo.documentationLink : true, COUNTLY\_FEEDBACK\_LINK = (typeof versionInfo.feedbackLink === "undefined") ? true : (typeof versionInfo.feedbackLink === "string") ? versionInfo.feedbackLink : (typeof versionInfo.feedbackLink === "boolean") ? versionInfo.feedbackLink : true, COUNTLY\_HELPCENTER\_LINK = (typeof versionInfo.helpCenterLink === "undefined") ? true : (typeof versionInfo.helpCenterLink === "string") ? versionInfo.helpCenterLink : (typeof versionInfo.helpCenterLink === "boolean") ? versionInfo.helpCenterLink : true, COUNTLY\_FEATUREREQUEST\_LINK = (typeof versionInfo.featureRequestLink === "undefined") ? true : (typeof versionInfo.featureRequestLink === "string") ? versionInfo.featureRequestLink : (typeof versionInfo.featureRequestLink === "boolean") ? versionInfo.featureRequestLink : true, express = require('express'), SkinStore = require('./libs/connect-mongo.js'), expose = require('./libs/express-expose.js'), dollarDefender = require('./libs/dollar-defender.js')({ message: "Dollar sign is not allowed in keys", hook: function(req) { console.log("Possible Dollar sign injection", req.originalUrl, req.query, req.params, req.body); } }), crypto = require('crypto'), fs = require('fs'), path = require('path'), jimp = require('jimp'), request = require('request'), flash = require('connect-flash'), cookieParser = require('cookie-parser'), formidable = require('formidable'), session = require('express-session'), methodOverride = require('method-override'), csrf = require('csurf')(), errorhandler = require('errorhandler'), basicAuth = require('basic-auth'), bodyParser = require('body-parser'), \_ = require('underscore'), countlyMail = require('../../api/parts/mgmt/mail.js'), // countlyStats = require('../../api/parts/data/stats.js'), countlyFs = require('../../api/utils/countlyFs.js'), common = require('../../api/utils/common.js'), preventBruteforce = require('./libs/preventBruteforce.js'), plugins = require('../../plugins/pluginManager.js'), countlyConfig = require('./config', 'dont-enclose'), log = require('../../api/utils/log.js')('core:app'), // url = require('url'), authorize = require('../../api/utils/authorizer.js'), //for token validations languages = require('../../frontend/express/locale.conf'), render = require('../../api/utils/render.js'), rateLimit = require("express-rate-limit"), membersUtility = require("./libs/members.js"), argon2 = require('argon2'), countlyCommon = require('../../api/lib/countly.common.js'), timezones = require('../../api/utils/timezones.js').getTimeZones;
console.log("Starting Countly", "version", pack.version);
var COUNTLY\_NAMED\_TYPE = "Countly Community Edition v" + COUNTLY\_VERSION;var COUNTLY\_TYPE\_CE = true;var COUNTLY\_TRIAL = (versionInfo.trial) ? true : false;var COUNTLY\_TRACK\_TYPE = "OSS";if (versionInfo.footer) { COUNTLY\_NAMED\_TYPE = versionInfo.footer; COUNTLY\_TYPE\_CE = false; if (COUNTLY\_NAMED\_TYPE === "Countly Cloud") { COUNTLY\_TRACK\_TYPE = "Cloud"; } else if (COUNTLY\_TYPE !== "777a2bf527a18e0fffe22fb5b3e322e68d9c07a6") { COUNTLY\_TRACK\_TYPE = "Enterprise"; }}else if (COUNTLY\_TYPE !== "777a2bf527a18e0fffe22fb5b3e322e68d9c07a6") { COUNTLY\_NAMED\_TYPE = "Countly Enterprise Edition v" + COUNTLY\_VERSION; COUNTLY\_TYPE\_CE = false; COUNTLY\_TRACK\_TYPE = "Enterprise";}
if (!countlyConfig.cookie) { countlyConfig.cookie = { httpOnly: true, maxAge: 1000 \* 60 \* 60 \* 24, secure: countlyConfig.web.secure\_cookies || false, maxAgeLogin: 1000 \* 60 \* 60 \* 24 \* 365 };}
plugins.setConfigs("frontend", { production: true, theme: countlyConfig.web.theme || "", session\_timeout: 30, use\_google: true, code: true, google\_maps\_api\_key: "", offline\_mode: false});
plugins.setUserConfigs("frontend", { production: false, theme: false, session\_timeout: false, use\_google: false, code: false, google\_maps\_api\_key: ""});
plugins.setConfigs("security", { login\_tries: 3, login\_wait: 5 \* 60, password\_min: 8, password\_char: true, password\_number: true, password\_symbol: true, password\_expiration: 0, password\_rotation: 3, password\_autocomplete: true, dashboard\_additional\_headers: "X-Frame-Options:deny\nX-XSS-Protection:1; mode=block\nStrict-Transport-Security:max-age=31536000 ; includeSubDomains\nX-Content-Type-Options: nosniff", api\_additional\_headers: "X-Frame-Options:deny\nX-XSS-Protection:1; mode=block\nAccess-Control-Allow-Origin:\*", dashboard\_rate\_limit\_window: 60, dashboard\_rate\_limit\_requests: 500});
process.on('uncaughtException', (err) => { console.log('Caught exception: %j', err, err.stack); if (log && log.e) { log.e('Logging caught exception'); } process.exit(1);});
process.on('unhandledRejection', (reason, p) => { console.log("Unhandled rejection at: Promise ", p, " reason: ", reason); if (log && log.e) { log.e("Logging unhandled rejection"); }});
if (countlyConfig.web && countlyConfig.web.track === "all") { countlyConfig.web.track = null;}
var countlyConfigOrig = JSON.parse(JSON.stringify(countlyConfig));
Promise.all([plugins.dbConnection(countlyConfig), plugins.dbConnection("countly\_fs")]).then(function(dbs) { var countlyDb = dbs[0]; //reference for consistency between app and api processes membersUtility.db = common.db = countlyDb; countlyFs.setHandler(dbs[1]);
 //checking remote configuration membersUtility.recheckConfigs(countlyConfigOrig, countlyConfig); /\*\* \* Create sha1 hash string \* @param {string} str - string to hash \* @param {boolean} addSalt - should salt be added \* @returns {string} hashed string \*\*/ function sha1Hash(str, addSalt) { var salt = (addSalt) ? new Date().getTime() : ""; return crypto.createHmac('sha1', salt + "").update(str + "").digest('hex'); }
 /\*\* \* Create sha512 hash string \* @param {string} str - string to hash \* @param {boolean} addSalt - should salt be added \* @returns {string} hashed string \*\*/ function sha512Hash(str, addSalt) { var salt = (addSalt) ? new Date().getTime() : ""; return crypto.createHmac('sha512', salt + "").update(str + "").digest('hex'); }
 /\*\* \* Create argon2 hash string \* @param {string} str - string to hash \* @returns {promise} hash promise \*\*/ function argon2Hash(str) { return argon2.hash(str); }
 /\*\* \* Verify argon2 hash string \* @param {string} hashedStr - argon2 hashed string \* @param {string} str - string for verify \* @returns {promise} verify promise \*\*/ function verifyArgon2Hash(hashedStr, str) { return argon2.verify(hashedStr, str); }
 /\*\* \* Is hashed string argon2? \* @param {string} hashedStr | argon2 hashed string \* @returns {boolean} return true if string hashed by argon2 \*/ function isArgon2Hash(hashedStr) { return hashedStr.includes("$argon2"); }
 /\*\* \* Verify member for Argon2 Hash \* @param {string} username | User name \* @param {password} password | Password string \* @param {Function} callback | Callback function \*/ function verifyMemberArgon2Hash(username, password, callback) { var secret = countlyConfig.passwordSecret || ""; password = password + secret; countlyDb.collection('members').findOne({$and: [{ $or: [ {"username": username}, {"email": username}]}]}, (err, member) => { if (member) { if (isArgon2Hash(member.password)) { verifyArgon2Hash(member.password, password).then(match => { if (match) { callback(undefined, member); } else { callback("Password is wrong!"); } }).catch(function() { callback("Password is wrong!"); }); } else { var password\_SHA1 = sha1Hash(password); var password\_SHA5 = sha512Hash(password);
 if (member.password === password\_SHA1 || member.password === password\_SHA5) { argon2Hash(password).then(password\_ARGON2 => { updateUserPasswordToArgon2(member.\_id, password\_ARGON2); callback(undefined, member); }).catch(function() { callback("Password is wrong!"); }); } else { callback("Password is wrong!"); } } } else { callback("Username is wrong!"); } }); }
 /\*\* \* Update user password to new sha512 hash \* @param {string} id - id of the user document \* @param {string} password - password to hash \*\*/ function updateUserPasswordToArgon2(id, password) { countlyDb.collection('members').update({ \_id: id}, { $set: { password: password}}); }
 /\*\* \* Check if user is global admin \* @param {object} req - request object \* @returns {boolean} true if global admin \*\*/ function isGlobalAdmin(req) { return (req.session.gadm); }
 /\*\* \* Sort array by list of \* @param {array} arrayToSort - array to sort \* @param {array} sortList - list of values by which to sort \* @returns {array} sorted array \*\*/ function sortBy(arrayToSort, sortList) { if (!sortList.length) { return arrayToSort; }
 var tmpArr = [], retArr = [];
 for (let i = 0; i < arrayToSort.length; i++) { var objId = arrayToSort[i].\_id + ""; if (sortList.indexOf(objId) !== -1) { tmpArr[sortList.indexOf(objId)] = arrayToSort[i]; } }
 for (let i = 0; i < tmpArr.length; i++) { if (tmpArr[i]) { retArr[retArr.length] = tmpArr[i]; } }
 for (let i = 0; i < arrayToSort.length; i++) { if (retArr.indexOf(arrayToSort[i]) === -1) { retArr[retArr.length] = arrayToSort[i]; } }
 return retArr; }
 var app = express(); app = expose(app); app.enable('trust proxy'); app.set('x-powered-by', false); const limiter = rateLimit({ windowMs: parseInt(plugins.getConfig("security").dashboard\_rate\_limit\_window) \* 1000, max: parseInt(plugins.getConfig("security").dashboard\_rate\_limit\_requests), headers: false, //limit only in production mode skip: function() { return !plugins.getConfig("frontend").production || plugins.getConfig("security").dashboard\_rate\_limit\_requests <= 0; } });
 // apply to all requests app.use(limiter);
 var loadedThemes = {}; var curTheme = countlyConfig.web.theme || "";
 /\*\* \* Load theme files \* @param {string} theme - theme name \* @param {function} callback - when loading files done \*\*/ app.loadThemeFiles = function(theme, callback) { if (!loadedThemes[theme]) { var tempThemeFiles = {css: [], js: []}; if (theme && theme.length) { var themeDir = path.resolve(\_\_dirname, "public/themes/" + theme + "/"); fs.readdir(themeDir, function(err, list) { if (err) { if (callback) { callback(tempThemeFiles); } return ; } var ext; for (var i = 0; i < list.length; i++) { ext = list[i].split(".").pop(); if (!tempThemeFiles[ext]) { tempThemeFiles[ext] = []; } tempThemeFiles[ext].push(countlyConfig.path + '/themes/' + theme + "/" + list[i]); } if (callback) { callback(tempThemeFiles); } loadedThemes[theme] = tempThemeFiles; }); } else if (callback) { callback(tempThemeFiles); } } else if (callback) { callback(loadedThemes[theme]); } };
 plugins.loadConfigs(countlyDb, function() { curTheme = plugins.getConfig("frontend").theme; app.loadThemeFiles(curTheme); app.dashboard\_headers = plugins.getConfig("security").dashboard\_additional\_headers; });
 app.engine('html', require('ejs').renderFile); app.set('views', \_\_dirname + '/views'); app.set('view engine', 'html'); app.set('view options', {layout: false});
 app.use('/stylesheets/ionicons/fonts/', function(req, res, next) { res.header("Access-Control-Allow-Origin", "\*"); res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept"); next(); });
 app.use('/fonts/', function(req, res, next) { res.header("Access-Control-Allow-Origin", "\*"); res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept"); next(); });
 app.use('\*.svg', function(req, res, next) { res.setHeader('Content-Type', 'image/svg+xml; charset=UTF-8'); next(); });
 /\*\* \* Add headers to request \* @param {object} req - request object \* @param {object} res - response object \*\*/ function add\_headers(req, res) { if (countlyConfig.web.secure\_cookies) { //we can't detect if it uses https behind nginx, without specific nginx configuration, so we assume it does req.headers["x-forwarded-proto"] = "https"; } //set provided in configuration headers if (app.dashboard\_headers) { var headers = app.dashboard\_headers.replace(/\r\n|\r|\n/g, "\n").split("\n"); var parts; for (let i = 0; i < headers.length; i++) { if (headers[i] && headers[i].length) { parts = headers[i].split(/:(.+)?/); if (parts.length === 3) { res.header(parts[0], parts[1]); } } } } }
 app.use(function(req, res, next) { add\_headers(req, res); next(); });
 plugins.loadAppStatic(app, countlyDb, express); app.use(cookieParser()); //server theme images app.use(function(req, res, next) { if (req.url.indexOf(countlyConfig.path + '/images/') === 0) { var urlPath = req.url.replace(countlyConfig.path, ""); var theme = req.cookies.theme || curTheme; if (theme && theme.length) { fs.exists(\_\_dirname + '/public/themes/' + theme + urlPath, function(exists) { if (exists) { res.sendFile(\_\_dirname + '/public/themes/' + theme + urlPath); } else { next(); } }); } else { //serve default location next(); } } else { next(); } }); //serve app images app.get(countlyConfig.path + '/appimages/\*', function(req, res) {
 if (!req.params || !req.params[0] || req.params[0] === '') { res.sendFile(\_\_dirname + '/public/images/default\_app\_icon.png'); } else { countlyFs.getStats("appimages", \_\_dirname + '/public/' + req.path, {id: req.params[0]}, function(err, stats) { if (err || !stats || !stats.size) { res.sendFile(\_\_dirname + '/public/images/default\_app\_icon.png'); } else { countlyFs.getStream("appimages", \_\_dirname + '/public/' + req.path, {id: req.params[0]}, function(err2, stream) { if (err2 || !stream) { res.sendFile(\_\_dirname + '/public/images/default\_app\_icon.png'); } else { res.writeHead(200, { 'Accept-Ranges': 'bytes', 'Cache-Control': 'public, max-age=31536000', 'Connection': 'keep-alive', 'Date': new Date().toUTCString(), 'Last-Modified': stats.mtime.toUTCString(), 'Content-Type': 'image/png', 'Content-Length': stats.size }); stream.pipe(res); } }); } }); } });
 //serve member images app.get(countlyConfig.path + '/memberimages/\*', function(req, res) {
 if (!req.params || !req.params[0] || req.params[0] === '') { res.sendFile(\_\_dirname + '/public/images/default\_member\_icon.png'); } else { countlyFs.getStats("memberimages", \_\_dirname + '/public/' + req.path, {id: req.params[0]}, function(err, stats) { if (err || !stats || !stats.size) { res.sendFile(\_\_dirname + '/public/images/default\_member\_icon.png'); } else { countlyFs.getStream("memberimages", \_\_dirname + '/public/' + req.path, {id: req.params[0]}, function(err2, stream) { if (err2 || !stream) { res.sendFile(\_\_dirname + '/public/images/default\_member\_icon.png'); } else { res.writeHead(200, { 'Accept-Ranges': 'bytes', 'Cache-Control': 'public, max-age=31536000', 'Connection': 'keep-alive', 'Date': new Date().toUTCString(), 'Last-Modified': stats.mtime.toUTCString(), 'Content-Type': 'image/png', 'Content-Length': stats.size }); stream.pipe(res); } }); } }); } });
 app.get(countlyConfig.path + "\*/screenshots/\*", function(req, res) { countlyFs.getStats("screenshots", \_\_dirname + '/public/' + req.path, {id: "core"}, function(err, stats) { if (err || !stats || !stats.size) { return res.send(false); }
 countlyFs.getStream("screenshots", \_\_dirname + '/public/' + req.path, {id: "core"}, function(err2, stream) { if (err2 || !stream) { return res.send(false); }
 res.writeHead(200, { 'Accept-Ranges': 'bytes', 'Cache-Control': 'public, max-age=31536000', 'Connection': 'keep-alive', 'Date': new Date().toUTCString(), 'Last-Modified': stats.mtime.toUTCString(), 'Content-Type': 'image/png', 'Content-Length': stats.size }); stream.pipe(res); }); }); });
 var oneYear = 31557600000; app.use(countlyConfig.path, express.static(\_\_dirname + '/public', { maxAge: oneYear }));
 app.use(session({ secret: countlyConfig.web.session\_secret || 'countlyss', name: countlyConfig.web.session\_name || 'connect.sid', cookie: countlyConfig.cookie, store: new SkinStore(countlyDb), saveUninitialized: false, resave: true, rolling: true, proxy: true, unset: "destroy" })); app.use(bodyParser.json()); // to support JSON-encoded bodies app.use(bodyParser.urlencoded({ // to support URL-encoded bodies extended: true })); app.use(function(req, res, next) { var contentType = req.headers['content-type']; if (req.method.toLowerCase() === 'post' && contentType && contentType.indexOf('multipart/form-data') >= 0) { var form = new formidable.IncomingForm(); form.uploadDir = \_\_dirname + '/uploads'; form.parse(req, function(err, fields, files) { req.files = files; if (!req.body) { req.body = {}; } for (let i in fields) { if (typeof req.body[i] === "undefined") { req.body[i] = fields[i]; } } next(); }); } else { next(); } });
 app.use(flash()); app.use(function(req, res, next) { req.template = {}; req.template.html = ""; req.template.js = ""; req.template.css = ""; req.template.form = ""; req.countly = { company: COUNTLY\_COMPANY, version: COUNTLY\_VERSION, type: COUNTLY\_TYPE, page: COUNTLY\_PAGE, title: COUNTLY\_NAME, favicon: "images/favicon.png" }; plugins.loadConfigs(countlyDb, function() { var securityConf = plugins.getConfig("security"); app.dashboard\_headers = securityConf.dashboard\_additional\_headers; add\_headers(req, res); preventBruteforce.fails = Number.isInteger(securityConf.login\_tries) ? securityConf.login\_tries : 3; preventBruteforce.wait = securityConf.login\_wait || 5 \* 60;
 curTheme = plugins.getConfig("frontend", req.session && req.session.settings).theme; app.loadThemeFiles(req.cookies.theme || curTheme, function(themeFiles) { res.locals.flash = req.flash.bind(req); req.config = plugins.getConfig("frontend", req.session && req.session.settings); req.themeFiles = themeFiles; var \_render = res.render; res.render = function(view, opts, fn, parent, sub) { if (!opts) { opts = {}; } if (!opts.path) { opts.path = countlyConfig.path || ""; } if (!opts.cdn) { opts.cdn = countlyConfig.cdn || ""; } if (!opts.themeFiles) { opts.themeFiles = themeFiles; } \_render.call(res, view, opts, fn, parent, sub); }; next(); }); }); }); app.use(methodOverride()); app.use(function(req, res, next) { if (!plugins.callMethod("skipCSRF", {req: req, res: res, next: next})) { //none of the plugins requested to skip csrf for this request csrf(req, res, next); } else { //skipping csrf step, some plugin needs it without csrf next(); } });
 app.use(function(req, res, next) { if (!plugins.callMethod("skipDollarCheck", {req: req, res: res, next: next})) { //none of the plugins requested to skip dollar sign check dollarDefender(req, res, next); } else { //skipping dollar sign check, some plugin needs mongo object as parameters next(); } });
 //for csrf error handling. redirect to login if getting bad token while logging in(not show forbidden page) app.use(function(err, req, res, next) { // eslint-disable-line no-unused-vars var mylink = req.url.split('?'); mylink = mylink[0]; if (err.code === 'EBADCSRFTOKEN' && mylink === countlyConfig.path + "/login") { res.status(403); res.redirect(countlyConfig.path + '/login?message=login.token-expired'); } else { res.status(403).send("Forbidden Token"); } });
 //prevent bruteforce attacks preventBruteforce.db = countlyDb; preventBruteforce.mail = countlyMail;
 for (let pathPart of ["/login", "/mobile/login"]) { const absPath = countlyConfig.path + pathPart; preventBruteforce.pathIdentifiers[absPath] = "login"; preventBruteforce.userIdentifiers[absPath] = (req) => req.body.username; }
 preventBruteforce.blockHooks.login = function(uid, req, res) { // eslint-disable-line no-unused-vars preventBruteforce.db.collection("members").findOne({username: uid}, function(err, member) { if (member) { preventBruteforce.mail.sendTimeBanWarning(member, preventBruteforce.db); } }); };
 preventBruteforce.pathIdentifiers[countlyConfig.path + "/forgot"] = "forgot";
 app.use(preventBruteforce.middleware);
 plugins.loadAppPlugins(app, countlyDb, express);
 var env = process.env.NODE\_ENV || 'development'; if ('development' === env) { app.use(errorhandler(true)); }
 app.get(countlyConfig.path + '/', function(req, res) { res.redirect(countlyConfig.path + '/login'); });
 var extendSession = function(req) { membersUtility.extendSession(req); }; var checkRequestForSession = function(req, res, next) { if (parseInt(plugins.getConfig("frontend", req.session && req.session.settings).session\_timeout)) { if (req.session.uid) { if (Date.now() > req.session.expires) { membersUtility.logout(req, res); res.redirect(countlyConfig.path + '/login?message=logout.inactivity'); } else { //extend session extendSession(req, res, next); next(); } } else { next(); } } else { next(); } };
 app.get(countlyConfig.path + '/ping', function(req, res) { countlyDb.collection("plugins").findOne({\_id: "plugins"}, function(err) { if (err) { res.status(404).send("DB Error"); } else { res.send("Success"); } }); });
 app.get(countlyConfig.path + '/configs', function(req, res) { membersUtility.recheckConfigs(countlyConfigOrig, countlyConfig); res.send("Success"); });
 app.get(countlyConfig.path + '/session', function(req, res, next) { if (req.session.auth\_token) { authorize.verify\_return({ db: countlyDb, token: req.session.auth\_token, req\_path: "", callback: function(valid) { if (!valid) { //logout user res.send("logout"); } else { if (req.session.uid) { if (Date.now() > req.session.expires) { //logout user res.send("logout"); } else { //extend session if (req.query.check\_session) { res.send("success"); } else { extendSession(req, res, next); res.send("success"); } } } else { res.send("login"); } } } }); } else { res.send("login"); } }); app.get(countlyConfig.path + '/dashboard', checkRequestForSession); app.post('\*', checkRequestForSession);
 app.get(countlyConfig.path + '/logout', function(req, res) { if (req.query.message) { res.redirect(countlyConfig.path + '/login?message=' + req.query.message); } else { res.redirect(countlyConfig.path + '/login'); } });
 app.post(countlyConfig.path + '/logout', function(req, res/\*, next\*/) { membersUtility.logout(req, res); if (req.query.message) { res.redirect(countlyConfig.path + '/login?message=' + req.query.message); } else { res.redirect(countlyConfig.path + '/login'); } });
 /\*\* \* Render dashboard \* @param {object} req - request object \* @param {object} res - response object \* @param {function} next - callback for next middleware \* @param {object} member - dashboard member document \* @param {array} adminOfApps - list of apps member is admin of \* @param {array} userOfApps - list of apps member is user of \* @param {object} countlyGlobalApps - all apps user has any access to, where key is app id and value is app document \* @param {object} countlyGlobalAdminApps - all apps user has write access to, where key is app id and value is app document \*\*/ function renderDashboard(req, res, next, member, adminOfApps, userOfApps, countlyGlobalApps, countlyGlobalAdminApps) { var configs = plugins.getConfig("frontend", member.settings); configs.export\_limit = plugins.getConfig("api").export\_limit; app.loadThemeFiles(configs.theme, function(theme) { if (configs.\_user.theme) { res.cookie("theme", configs.theme); } req.session.uid = member.\_id; req.session.gadm = (member.global\_admin === true); req.session.email = member.email; req.session.settings = member.settings; res.header('Cache-Control', 'no-cache, private, no-store, must-revalidate, max-stale=0, post-check=0, pre-check=0'); res.header('Expires', '0'); res.header('Pragma', 'no-cache'); if (member.upgrade) { countlyDb.collection('members').update({"\_id": member.\_id}, {$unset: {upgrade: ""}}, function() {}); }
 member.\_id += ""; delete member.password;
 adminOfApps = sortBy(adminOfApps, member.appSortList || []); userOfApps = sortBy(userOfApps, member.appSortList || []);
 var defaultApp = userOfApps[0]; var serverSideRendering = req.query.ssr; \_.extend(req.config, configs); var countlyGlobal = { COUNTLY\_CONTAINER: process.env.COUNTLY\_CONTAINER, countlyTitle: req.countly.title, company: req.countly.company, languages: languages, countlyVersion: req.countly.version, countlyFavicon: req.countly.favicon, pluginsSHA: sha1Hash(plugins.getPlugins()), apps: countlyGlobalApps, defaultApp: defaultApp, admin\_apps: countlyGlobalAdminApps, csrf\_token: req.csrfToken(), auth\_token: req.session.auth\_token, member: member, config: req.config, security: plugins.getConfig("security"), plugins: plugins.getPlugins(), path: countlyConfig.path || "", cdn: countlyConfig.cdn || "", message: req.flash("message"), ssr: serverSideRendering, timezones: timezones };
 var toDashboard = { countlyTitle: req.countly.title, languages: languages, countlyFavicon: req.countly.favicon, adminOfApps: adminOfApps, userOfApps: userOfApps, defaultApp: defaultApp, member: member, intercom: countlyConfig.web.use\_intercom, track: countlyConfig.web.track || false, installed: req.session.install || false, cpus: require('os').cpus().length, countlyVersion: req.countly.version, countlyType: COUNTLY\_TYPE\_CE, countlyTrial: COUNTLY\_TRIAL, countlyTypeName: COUNTLY\_NAMED\_TYPE, feedbackLink: COUNTLY\_FEEDBACK\_LINK, documentationLink: COUNTLY\_DOCUMENTATION\_LINK, helpCenterLink: COUNTLY\_HELPCENTER\_LINK, featureRequestLink: COUNTLY\_FEATUREREQUEST\_LINK, countlyTypeTrack: COUNTLY\_TRACK\_TYPE, frontend\_app: versionInfo.frontend\_app, frontend\_server: versionInfo.frontend\_server, production: configs.production || false, pluginsSHA: sha1Hash(plugins.getPlugins()), plugins: plugins.getPlugins(), config: req.config, path: countlyConfig.path || "", cdn: countlyConfig.cdn || "", use\_google: configs.use\_google || false, themeFiles: theme, inject\_template: req.template, javascripts: [], stylesheets: [], offline\_mode: configs.offline\_mode || false };
 // google services cannot work when offline mode enable if (toDashboard.offline\_mode) { toDashboard.use\_google = false; } if (countlyGlobal.config.offline\_mode) { countlyGlobal.config.use\_google = false; }
 var plgns = [].concat(plugins.getPlugins()); if (plgns.indexOf('push') !== -1) { plgns.splice(plgns.indexOf('push'), 1); plgns.unshift('push'); } plgns.forEach(plugin => { try { let contents = fs.readdirSync(\_\_dirname + `/../../plugins/${plugin}/frontend/public/javascripts`) || []; toDashboard.javascripts.push.apply(toDashboard.javascripts, contents.filter(n => n.indexOf('.js') === n.length - 3).map(n => `${plugin}/javascripts/${n}`)); } catch (e) { console.log('Error while reading folder of plugin %s: %j', plugin, e.stack); } try { let contents = fs.readdirSync(\_\_dirname + `/../../plugins/${plugin}/frontend/public/stylesheets`) || []; toDashboard.stylesheets.push.apply(toDashboard.stylesheets, contents.filter(n => n.indexOf('.css') === n.length - 4).map(n => `${plugin}/stylesheets/${n}`)); } catch (e) { console.log('Error while reading folder of plugin %s: %j', plugin, e.stack); } });
 if (req.session.install) { req.session.install = null; res.clearCookie('install'); } plugins.callMethod("renderDashboard", {req: req, res: res, next: next, data: {member: member, adminApps: countlyGlobalAdminApps, userApps: countlyGlobalApps, countlyGlobal: countlyGlobal, toDashboard: toDashboard}});
 res.expose(countlyGlobal, 'countlyGlobal');
 res.render('dashboard', toDashboard); }); }
 app.get(countlyConfig.path + '/dashboard', function(req, res, next) { if (!req.session.uid) { res.redirect(countlyConfig.path + '/login'); } else { countlyDb.collection('members').findOne({"\_id": countlyDb.ObjectID(req.session.uid + "")}, function(err, member) { if (member) { req.session.cookie.maxAge = countlyConfig.cookie.maxAgeLogin; var adminOfApps = [], userOfApps = [], countlyGlobalApps = {}, countlyGlobalAdminApps = {};
 if (member.global\_admin) { countlyDb.collection('apps').find({}).toArray(function(err2, apps) { adminOfApps = apps; userOfApps = apps;
 for (let i = 0; i < apps.length; i++) { apps[i].type = apps[i].type || "mobile"; countlyGlobalApps[apps[i].\_id] = apps[i]; countlyGlobalApps[apps[i].\_id].\_id = "" + apps[i].\_id; } countlyGlobalAdminApps = countlyGlobalApps; renderDashboard(req, res, next, member, adminOfApps, userOfApps, countlyGlobalApps, countlyGlobalAdminApps); }); } else { var adminOfAppIds = [], userOfAppIds = [];
 if (member.admin\_of.length === 1 && member.admin\_of[0] === "") { member.admin\_of = []; }
 for (let i = 0; i < member.admin\_of.length; i++) { if (member.admin\_of[i] === "") { continue; }
 adminOfAppIds[adminOfAppIds.length] = countlyDb.ObjectID(member.admin\_of[i]); }
 for (let i = 0; i < member.user\_of.length; i++) { if (member.user\_of[i] === "") { continue; }
 userOfAppIds[userOfAppIds.length] = countlyDb.ObjectID(member.user\_of[i]); }
 countlyDb.collection('apps').find({ \_id: { '$in': adminOfAppIds } }).toArray(function(err2, admin\_of) {
 for (let i = 0; i < admin\_of.length; i++) { countlyGlobalAdminApps[admin\_of[i].\_id] = admin\_of[i]; countlyGlobalAdminApps[admin\_of[i].\_id].\_id = "" + admin\_of[i].\_id; }[View remainder of file in raw view](https://github.com/Countly/countly-server/raw/6b90bb775e747cabe46fe197c6a6989acc6c3417/frontend/express/app.js)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5fb38ea6_20250114_193442.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Fblob%2F6b90bb775e747cabe46fe197c6a6989acc6c3417%2Ffrontend%2Fexpress%2Fviews%2Freset.html)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Fblob%2F6b90bb775e747cabe46fe197c6a6989acc6c3417%2Ffrontend%2Fexpress%2Fviews%2Freset.html)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Countly%2Fcountly-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Countly](/Countly)
/
**[countly-server](/Countly/countly-server)**
Public

* [Notifications](/login?return_to=%2FCountly%2Fcountly-server) You must be signed in to change notification settings
* [Fork
  976](/login?return_to=%2FCountly%2Fcountly-server)
* [Star
   5.6k](/login?return_to=%2FCountly%2Fcountly-server)

* [Code](/Countly/countly-server)
* [Issues
  27](/Countly/countly-server/issues)
* [Pull requests
  15](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects
  0](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

Additional navigation options

* [Code](/Countly/countly-server)
* [Issues](/Countly/countly-server/issues)
* [Pull requests](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_05643ac3_20250114_193443.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Freleases%2Ftag%2Fv21.11)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCountly%2Fcountly-server%2Freleases%2Ftag%2Fv21.11)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Countly%2Fcountly-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Countly](/Countly)
/
**[countly-server](/Countly/countly-server)**
Public

* [Notifications](/login?return_to=%2FCountly%2Fcountly-server) You must be signed in to change notification settings
* [Fork
  976](/login?return_to=%2FCountly%2Fcountly-server)
* [Star
   5.6k](/login?return_to=%2FCountly%2Fcountly-server)

* [Code](/Countly/countly-server/tree/v21.11)
* [Issues
  27](/Countly/countly-server/issues)
* [Pull requests
  15](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects
  0](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

Additional navigation options

* [Code](/Countly/countly-server/tree/v21.11)
* [Issues](/Countly/countly-server/issues)
* [Pull requests](/Countly/countly-server/pulls)
* [Discussions](/Countly/countly-server/discussions)
* [Actions](/Countly/countly-server/actions)
* [Projects](/Countly/countly-server/projects)
* [Security](/Countly/countly-server/security)
* [Insights](/Countly/countly-server/pulse)

1. [Releases](/Countly/countly-server/releases)
2. [v21.11](/Countly/countly-server/releases/tag/v21.11)

# v21.11

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Countly/countly-server/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v21.11)

 Loading

[View all tags](/Countly/countly-server/tags)

![@ar2rsawseen](https://avatars.githubusercontent.com/u/399992?s=40&v=4)
[ar2rsawseen](/ar2rsawseen)
released this
10 Nov 16:18

·
[12475 commits](/Countly/countly-server/compare/v21.11...master)
to master
since this release

[v21.11](/Countly/countly-server/tree/v21.11)

[`91bd1e9`](/Countly/countly-server/commit/91bd1e96833279ee1029f456322a93c53b7cb64e)

### We are thrilled to announce the release of the latest Countly Community Edition - Version 21.11! 🙌

And with it, **we are expanding the Community Edition with four new features: Dashboards, Remote Config, Hooks, and reCAPTCHA.**

With this new version, you get even more innovative, secure, and super-powerful analytics that are as free and open-source as they should always be.

Read all about Countly Community Edition 21.11 👉 [here.](https://blog.count.ly/with-countly-community-edition-21-11-product-analytics-just-got-better-for-all-a1c181fc09f3)

### **Here’s a brief summary:**

### 1️⃣ Dashboards

Create fully customizable dashboards fed with the data from your other Countly features that best fit your KPIs. Deploy the charts, graphs, tables, and widgets you or your teams need to have in one easy-to-find and easy-to-understand place to never lose track of the metrics that are the most important to you.

[Learn more about Dashboards](https://count.ly/plugins/dashboards)

[Dashboards User Guide](https://support.count.ly/hc/en-us/articles/360037638551-Dashboards)

### 2️⃣ Remote Config

Change the behavior or features of your app remotely without the need of publishing an app update or having to edit its code. Define default parameters in your app, and then use Remote Config to push editions that your users will see in your app based on conditions that you configure. Fast and simple.

[Learn more about Remote Config](https://count.ly/plugins/remote-config)

[Remote Config User Guide](https://support.count.ly/hc/en-us/articles/360037270492-Remote-Config)

### 3️⃣ Hooks

Think of Hooks as a bridge that can capture data inside/outside Countly, pipeline actions via Countly, and then send the data inside/outside Countly. With this fantastic feature, convert event-related data as triggers that will then send this data by HTTP requests and/or as emails. With Hooks, use Countly as the bridge with which you can keep external CRM tools, your inboxes, and more always informed of the events you must never lose track of.

[Learn more about Hooks](https://count.ly/plugins/hooks)

[Hooks User Guide](https://support.count.ly/hc/en-us/articles/900003414606-Hooks)

### 4️⃣ reCAPTCHA

And to top it off, Countly Community Edition 21.11 comes with reCAPTCHA as a brand new free feature to enhance user login security, and keep your data more secure than ever.

[Learn more about reCAPTCHA](https://count.ly/plugins/recaptcha)

### ✅ Upgrading to Countly Community Edition 21.11

Check out our [installation](https://support.count.ly/hc/en-us/articles/360036862332-Installing-Countly-server) or [upgrade](https://support.count.ly/hc/en-us/articles/360037443652-Upgrading-Countly-server) instructions.

If you need help, we’re here for you, so drop us a line or review the user forum in our [Community Area](https://support.count.ly/hc/en-us/community/topics).

**With Data love 💚,

Countly Team**

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


