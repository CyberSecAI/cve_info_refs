=== Content from github.com_f4f01ad4_20250114_202821.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fsecurity-advisories%2Fsecurity%2Fadvisories%2FGHSA-m682-v4g9-wrq7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fsecurity-advisories%2Fsecurity%2Fadvisories%2FGHSA-m682-v4g9-wrq7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nextcloud%2Fsecurity-advisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextcloud](/nextcloud)
/
**[security-advisories](/nextcloud/security-advisories)**
Public

* [Notifications](/login?return_to=%2Fnextcloud%2Fsecurity-advisories) You must be signed in to change notification settings
* [Fork
  14](/login?return_to=%2Fnextcloud%2Fsecurity-advisories)
* [Star
   61](/login?return_to=%2Fnextcloud%2Fsecurity-advisories)

* [Code](/nextcloud/security-advisories)
* [Pull requests
  0](/nextcloud/security-advisories/pulls)
* [Discussions](/nextcloud/security-advisories/discussions)
* [Actions](/nextcloud/security-advisories/actions)
* [Security](/nextcloud/security-advisories/security)
* [Insights](/nextcloud/security-advisories/pulse)

Additional navigation options

* [Code](/nextcloud/security-advisories)
* [Pull requests](/nextcloud/security-advisories/pulls)
* [Discussions](/nextcloud/security-advisories/discussions)
* [Actions](/nextcloud/security-advisories/actions)
* [Security](/nextcloud/security-advisories/security)
* [Insights](/nextcloud/security-advisories/pulse)

# Preview generation used third-party library not suited for user-generated content

Critical

[LukasReschke](/LukasReschke)
published
GHSA-m682-v4g9-wrq7
Sep 6, 2021

## Package

Nextcloud Server

## Affected versions

< 20.0.12, < 21.0.4, < 22.1.0

## Patched versions

20.0.12, 21.0.4, 22.1.0

## Description

### Impact

Nextcloud supports rendering image previews for user provided file content. For some image types, the Nextcloud server was invoking a third-party library that wasn't suited for untrusted user-supplied content.

There are several security concerns with passing user-generated content to this library, such as Server-Side-Request-Forgery, file disclosure or potentially executing code on the system. The risk depends on your system configuration and the installed library version.

### Patches

It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. These versions do not use this library anymore.

### Workarounds

Disable previews by setting `enable_previews` to `false` in `config.php`. ([documentation](https://docs.nextcloud.com/server/21/admin_manual/configuration_files/previews_configuration.html#disabling-previews))

### References

* [HackerOne](https://hackerone.com/reports/1261413)

### For more information

If you have any questions or comments about this advisory:

* Create a post in [nextcloud/security-advisories](https://github.com/nextcloud/security-advisories/discussions)
* Customers: Open a support ticket at [support.nextcloud.com](https://support.nextcloud.com)

### Severity

Critical

### CVE ID

CVE-2021-32802

### Weaknesses

[CWE-829](/advisories?query=cwe%3A829)

### Credits

* [![@LukasReschke](https://avatars.githubusercontent.com/u/878997?s=40&v=4)](/LukasReschke)
  [LukasReschke](/LukasReschke)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.nextcloud.com_afc14a46_20250114_202820.html ===

[![Logo](../_static/logo-white.png)](../contents.html)

* [Introduction](../index.html)
* [Release notes](../release_notes.html)
* [Maintenance and release schedule](../release_schedule.html)
* [Installation and server configuration](../installation/index.html)
* [Nextcloud configuration](../configuration_server/index.html)
* [Apps management](../apps_management.html)
* [User management](../configuration_user/index.html)
* [File sharing and management](index.html)
  + [File Sharing](file_sharing_configuration.html)
  + [Configuring Federation Sharing](federated_cloud_sharing_configuration.html)
  + [Uploading big files > 512MB](big_file_upload_configuration.html)
  + [Providing default files](default_files_configuration.html)
  + [Configuring Object Storage as Primary Storage](primary_storage.html)
  + [Configuring External Storage (GUI)](external_storage_configuration_gui.html)
  + [External Storage authentication mechanisms](external_storage/auth_mechanisms.html)
  + [Encryption configuration](encryption_configuration.html)
  + [Encryption details](encryption_details.html)
  + [Encryption migration](encryption_migration.html)
  + [Transactional file locking](files_locking_transactional.html)
  + Previews configuration
    - [Parameters](#parameters)
      * [Disabling previews:](#disabling-previews)
      * [Maximum preview size:](#maximum-preview-size)
      * [Maximum scale factor:](#maximum-scale-factor)
      * [JPEG quality setting:](#jpeg-quality-setting)
  + [Controlling file versions and aging](file_versioning.html)
* [File workflows](../file_workflows/index.html)
* [Groupware](../groupware/index.html)
* [Database configuration](../configuration_database/index.html)
* [Mimetypes management](../configuration_mimetypes/index.html)
* [Maintenance](../maintenance/index.html)
* [Issues and troubleshooting](../issues/index.html)
* [GDPR](../gdpr/index.html)

[Nextcloud latest Administration Manual](../contents.html)

* »
* [File sharing and management](index.html) »
* Previews configuration
* [Edit on GitHub](https://github.com/nextcloud/documentation/edit/master/admin_manual/configuration_files/previews_configuration.rst)

---

# Previews configuration[ï](#previews-configuration "Permalink to this headline")

The Nextcloud thumbnail system generates previews of files for all
Nextcloud apps that display files, such as Files and Gallery.

The following image shows some examples of previews of various file types.

![Thumbnails of various image and audio/video files.](../_images/preview_images.png)

By default, Nextcloud can generate previews for the following filetypes:

* Images files
* Cover of MP3 files
* Text documents

Note

Technically Nextcloud can also generate the previews
of other file types such as PDF, SVG or various office documents.
Due to security concerns those providers have been disabled by
default and are considered unsupported.
While those providers are still available, we discourage enabling
them, and they are not documented.

## Parameters[ï](#parameters "Permalink to this headline")

Please notice that the Nextcloud preview system comes already with sensible
defaults, and therefore it is usually unnecessary to adjust those configuration
values.

### Disabling previews:[ï](#disabling-previews "Permalink to this headline")

Under certain circumstances, for example if the server has limited
resources, you might want to consider disabling the generation of previews.
Note that if you do this all previews in all apps are disabled, including
the Gallery app, and will display generic icons instead of
thumbnails.

Set the configuration option `enable_previews` in config.php to `false`:

```
<?php
  'enable_previews' => false,

```

### Maximum preview size:[ï](#maximum-preview-size "Permalink to this headline")

There are two configuration options to set the maximum size of a preview.

```
<?php
  'preview_max_x' => null,
  'preview_max_y' => null,

```

By default, both options are set to null. âNullâ is equal to no limit.
Numeric values represent the size in pixels. The following code limits previews
to a maximum size of 100Ã100px:

```
<?php
  'preview_max_x' => 100,
  'preview_max_y' => 100,

```

âpreview\_max\_xâ represents the x-axis and âpreview\_max\_yâ represents the y-axis.

### Maximum scale factor:[ï](#maximum-scale-factor "Permalink to this headline")

If a lot of small pictures are stored on the Nextcloud instance and the preview
system generates blurry previews, you might want to consider setting a maximum
scale factor. By default, pictures are upscaled to 10 times the original size:

```
<?php
  'preview_max_scale_factor' => 10,

```

If you want to disable scaling at all, you can set the config value to â1â:

```
<?php
  'preview_max_scale_factor' => 1,

```

If you want to disable the maximum scaling factor, you can set the config value
to ânullâ:

```
<?php
  'preview_max_scale_factor' => null,

```

### JPEG quality setting:[ï](#jpeg-quality-setting "Permalink to this headline")

Default JPEG quality setting for preview images is â90â. Change this with:

```
occ config:app:set preview jpeg_quality --value="60"

```

 [Previous](files_locking_transactional.html "Transactional file locking")
[Next](file_versioning.html "Controlling file versions and aging")

---

© Copyright 2022 Nextcloud GmbH.

 Read the Docs
v: latest

Versions
[17](https://docs.nextcloud.com/server/17/admin_manual)
[18](https://docs.nextcloud.com/server/18/admin_manual)
[19](https://docs.nextcloud.com/server/19/admin_manual)
[20](https://docs.nextcloud.com/server/20/admin_manual)
[stable](https://docs.nextcloud.com/server/stable/admin_manual)
[latest](https://docs.nextcloud.com/server/latest/admin_manual)

Downloads

On Read the Docs
[Project Home](/projects//?fromdocs=)

[Builds](/builds//?fromdocs=)



=== Content from security.gentoo.org_29a3f89c_20250114_202821.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Nextcloud: Multiple Vulnerabilities — GLSA **202208-17**

Multiple vulnerabilities have been found in Nextcloud, the worst of which could result in denial of service.

### Affected packages

| Package | **www-apps/nextcloud** on all architectures |
| --- | --- |
| Affected versions | < **23.0.4** |
| Unaffected versions | >= **23.0.4** |

### Background

Nextcloud is a personal cloud that runs on your own server.

### Description

Multiple vulnerabilities have been discovered in Nextcloud. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Nextcloud users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/nextcloud-23.0.4"

```
### References

* [CVE-2021-32653](https://nvd.nist.gov/vuln/detail/CVE-2021-32653)
* [CVE-2021-32654](https://nvd.nist.gov/vuln/detail/CVE-2021-32654)
* [CVE-2021-32655](https://nvd.nist.gov/vuln/detail/CVE-2021-32655)
* [CVE-2021-32656](https://nvd.nist.gov/vuln/detail/CVE-2021-32656)
* [CVE-2021-32657](https://nvd.nist.gov/vuln/detail/CVE-2021-32657)
* [CVE-2021-32678](https://nvd.nist.gov/vuln/detail/CVE-2021-32678)
* [CVE-2021-32679](https://nvd.nist.gov/vuln/detail/CVE-2021-32679)
* [CVE-2021-32680](https://nvd.nist.gov/vuln/detail/CVE-2021-32680)
* [CVE-2021-32688](https://nvd.nist.gov/vuln/detail/CVE-2021-32688)
* [CVE-2021-32703](https://nvd.nist.gov/vuln/detail/CVE-2021-32703)
* [CVE-2021-32705](https://nvd.nist.gov/vuln/detail/CVE-2021-32705)
* [CVE-2021-32725](https://nvd.nist.gov/vuln/detail/CVE-2021-32725)
* [CVE-2021-32726](https://nvd.nist.gov/vuln/detail/CVE-2021-32726)
* [CVE-2021-32734](https://nvd.nist.gov/vuln/detail/CVE-2021-32734)
* [CVE-2021-32800](https://nvd.nist.gov/vuln/detail/CVE-2021-32800)
* [CVE-2021-32801](https://nvd.nist.gov/vuln/detail/CVE-2021-32801)
* [CVE-2021-32802](https://nvd.nist.gov/vuln/detail/CVE-2021-32802)
* [CVE-2021-41177](https://nvd.nist.gov/vuln/detail/CVE-2021-41177)
* [CVE-2021-41178](https://nvd.nist.gov/vuln/detail/CVE-2021-41178)
* [CVE-2021-41239](https://nvd.nist.gov/vuln/detail/CVE-2021-41239)
* [CVE-2021-41241](https://nvd.nist.gov/vuln/detail/CVE-2021-41241)
* [CVE-2022-24741](https://nvd.nist.gov/vuln/detail/CVE-2022-24741)
* [CVE-2022-24888](https://nvd.nist.gov/vuln/detail/CVE-2022-24888)
* [CVE-2022-24889](https://nvd.nist.gov/vuln/detail/CVE-2022-24889)
* [CVE-2022-29243](https://nvd.nist.gov/vuln/detail/CVE-2022-29243)

**Release date**

August 10, 2022

**Latest revision**

August 10, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [848873](https://bugs.gentoo.org/show_bug.cgi?id=848873)
* [835073](https://bugs.gentoo.org/show_bug.cgi?id=835073)
* [834803](https://bugs.gentoo.org/show_bug.cgi?id=834803)
* [820368](https://bugs.gentoo.org/show_bug.cgi?id=820368)
* [812443](https://bugs.gentoo.org/show_bug.cgi?id=812443)
* [802096](https://bugs.gentoo.org/show_bug.cgi?id=802096)
* [797253](https://bugs.gentoo.org/show_bug.cgi?id=797253)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


