```
{
  "vulnerability_details": {
    "root_cause": "The `process_report` function in `whoopsie-upload-all` does not check if the crash file was replaced by a symbolic link before writing the extended report back into the file.",
    "weaknesses": [
      "The crash file path is not validated before writing, leading to a symlink following vulnerability.",
       "The function uses `os.O_APPEND` when opening the file which can be abused to write arbitrary content at the end of the linked file."
    ],
    "impact": "An attacker can write to arbitrary files on the system with the elevated privileges of `whoopsie-upload-all` by replacing the crash report file with a symbolic link. This could lead to code execution by exploiting vulnerable configurations of programs that parse these files.",
    "attack_vectors": "An attacker needs to replace the crash file with a symlink pointing to a target file before whoopsie-upload-all processes it.",
    "required_attacker_capabilities": "The attacker requires the ability to write a crash file (or potentially modify an existing crash file) and create a symbolic link in the crash directory. This can likely be achieved with local user access. `fs.protected_symlinks` needs to be disabled (`fs.protected_symlinks=0`)."
  }
}
```