=== Content from dl.acm.org_38ef5e66_20250114_182230.html ===
Amazon Echo Dot or the Reverberating Secrets of IoT Devices

Dennis Giese
dgiese@ccs.neu.edu
Northeastern University

Guevara Noubir
g.noubir@northeastern.edu
Northeastern University

ABSTRACT
Smart speakers, such as the Amazon Echo Dot, are very popular
and routinely trusted with private and sensitive information. Yet,
little is known about their security and potential attack vectors.
We develop and synthesize a set of IoT forensics techniques, apply
them to reverse engineer the hardware and software of the Ama-
zon Echo Dot, and demonstrate its lacking protections of private
user data. An adversary with physical access to such devices (e.g.,
purchasing a used one) can retrieve sensitive information such as
Wi-Fi credentials, the physical location of (previous) owners, and
cyber-physical devices (e.g., cameras, door locks). We show that
such information, including all previous passwords and tokens,
remains on the flash memory, even after a factory reset. This is due
to the wear-leveling algorithms of the flash memory and lack of
encryption. We identify and discuss the design flaws in the storage
of sensitive information and the process of de-provisioning used
devices. We demonstrate the practical feasibility of such attacks on
86 used devices purchased on eBay and flea markets. Finally, we
propose secure design alternatives and mitigation techniques.

CCS CONCEPTS
• Security and privacy → Usability in security and privacy;
Systems security; Embedded systems security;

KEYWORDS
Internet of Things, privacy, forensics, reverse engineering

ACM Reference Format:
Dennis Giese and Guevara Noubir. 2021. Amazon Echo Dot or the Rever-
berating Secrets of IoT Devices. In Proceedings of Conference on Security and
Privacy in Wireless and Mobile Networks, Abu Dhabi, United Arab Emirates,
June 28–July 2, 2021 (WiSec ’21), 12 pages.
https://doi.org/10.1145/3448300.3467820

1 INTRODUCTION
Virtual assistant-based systems like Amazon Echo and Google
Home gained increasing popularity over the last few years, and
are expected to become more important in the future [2]. These
systems are used in daily life to control smart home environments,
order products, issue queries or organize someone’s life. Recent

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
WiSec ’21, June 28–July 2, 2021, Abu Dhabi, United Arab Emirates
© 2021 Copyright held by the owner/author(s). Publication rights licensed to Associa-
tion for Computing Machinery.
ACM ISBN 978-1-4503-8349-3/21/06. . . $15.00
https://doi.org/10.1145/3448300.3467820

research analyzed the communications channel of such devices
revealing the potential for manipulation and privacy leaks [20, 35].
However, little is knows about their internal hardware/software
design, operation and privacy mechanisms due to the security pro-
tections put in place by the manufacturers. Furthermore, the first
Amazon Echo was released in 2014. Since then, several genera-
tions of products are integrating Amazons Alexa functionality. New
generations might encourage the users to retire older devices, sell
them, or give them away. Additionally, devices break over time
are discarded. Due to their nature, such IoT devices may contain
private information about the user, sensitive log files, and may even
give access to the user’s Amazon account. Before giving away or
discarding devices, it seems obvious that the owner needs to factory
reset their devices in order to delete all critical data. However, there
are users who are lacking technical knowledge to reset their devices
properly. For broken devices, this is not possible at all. Also, the
reliability of the factory reset is unknown. The user’s expects that
the vendor of such devices will try to protect private data.

In this paper, we develop and synthesize a set of hardware/software

techniques for mobile and embedded devices into a systematic
method for analyzing smart-speakers, and IoT devices in general.
We apply these techniques to reverse engineer and analyze the pri-
vacy risk of used Amazon Echo devices and the security measures
the vendor implemented. We purchased 86 used Amazon Echo Dot
devices over 16 months, from sources like eBay and flea markets.
Additionally, we analyzed new and “certified refurbished” devices.
While there are several Amazon Echo models, we focus on Echo
Dot’s as they are the most affordable and common devices. Our fo-
cus is on the third generation, released end of 2018. We analyse the
effectiveness of factory resets and investigate the implemented pro-
tections on user data. We show that private information, including
all previous passwords and tokens, remains on the flash memory,
even after a factory reset. This is due to wear-leveling algorithms of
the flash memory and lack of encryption. We identify and discuss
the design flaws in the storage of sensitive information and the
process of de-provisioning used devices. Additionally, we apply our
forensics techniques to other manufacturers and discover similar
vulnerabilities. These results can be found in 8. Therefore, demon-
strating that our method for reverse engineering will help other
researchers for reverse engineering a variety of IoT devices. Finally,
we propose secure design alternatives, and short-term mitigation
techniques effective against adversaries with hardware attack capa-
bilities. Our contributions are summarized as follows:

• Systematic and comprehensive reverse engineering of Ama-

zon Echo Dot hardware and software platforms.

• Data extraction techniques of user data even after factory re-
sets exploiting the hardware architecture, lack of encryption,
and side effects of wear-leveling.

• Demonstrating the feasibility of breaching the users privacy

by reconnecting used devices to the cloud.

13

eMCP IC

eMMC flash

DDR3 RAM

CMD

CLK

Data

Addr

Data

SoC
MediaTek
MT8516B

SDIO

WiFi/BT
MT7658CSN

I2C

I2S

I2S

LED driver
IS31FL3236

Stereo ADC
TLV320ADC3101

Stereo ADC
TLV320ADC3101

Figure 1: Echo Dot 3rd Gen logical schematic

Figure 2: Echo Dot 3rd Gen PCB: SOC (red) & eMCP (yellow)

• Providing an advanced method to instrument access to eMCP

flash without repeated soldering.

• A privacy-preserving study of 86 used devices revealing most

users do not adequately reset their devices.

• Responsible disclosure to Amazon
• Generalization to findings to other smart speakers.
• Mitigation and discussion of trade-offs between usability,

security, and hardware requirements.

2 THE AMAZON ECHO PLATFORM
While Amazon sells several models of Echo devices, the underly-
ing hardware and software platform remains unchanged to a large
extent. We decided to focus on Amazon Echo Dots due to their
popularity and ubiquity in homes. Their main distinguishing char-
acteristic is the lack of display or advanced user interface. Instead,
the user interaction is through buttons, LEDs, and voice input and
output. Our hardware teardown and software architecture analysis,
of over 98 used and new, Echo Dot devices reveals the following.
SoC/CPU: The central component of Amazon’s Echo Dots is the
System on a Chip (SoC). Third (3rd Gen) generation devices rely
on Mediatek MT8516B SoC, which is a 64-bit quad-core ARM de-
vice. The MT8516B is designed specifically for voice assistant de-
vices [28]. The SoCs integrate ARM TrustZone support, a key hard-
ware component to secure ARM-based platforms, e.g., to provide
Secure Boot or store keys securely. There is little technical infor-
mation publicly available for these SoCs.
RAM and Flash Storage: In most of the analyzed devices, the
RAM and eMMC-flash are integrated in a single IC, the embedded
Multi-Chip Package (eMCP) (See Figure 2). The eMCPs come in
different models and are sourced from multiple manufacturers,
depending on the generation, availability and cost of chips. Known
vendors of eMCPs are Micron, Samsung and SKhynix. For Gen
3 (FCC ID: 2AOAG-3668), we found the size of the flash memory
varying between 4 and 8 GBytes. We also found that there is a
new PCB revision of generation 3 devices (FCC ID: 2ARIW-2778,
2ASD2-7483) with separate RAM ICs and raw NAND flash.
Connectivity and interfaces: Echo Dots have several communi-
cations and connectivity peripherals. They support Bluetooth and
dual-band Wi-Fi. Generation 3 devices use MediaTek MT7658CSN
ICs, combining Bluetooth and Wi-Fi. For interfacing, they integrate
LEDs, Buttons, ADCs, a microphone array, and speakers. The PCB
has USB and UART debug interfaces as test-points (See Figure 3).
Operating System: Echo Dots run Fire OS, which is a customized
Android operating system [10]. Generation 3 uses Android 7.1.2
(Nougat). The flash memory contains two copies of the Android

Figure 3: Back side of Echo Dot 3rd Gen PCB with position of USB Debug
pins (Yellow) and UART (Green)

root partition (active and passive copy), the kernel image and the
Trusted Execution Environment (TEE) firmware. The operating
system has SELinux enabled and in “enforcing” mode.
File systems: The Android operating system root partitions are
stored on an Ext4 file system, which is not encrypted, but integrity
protected by dm-verity. For the 3rd Gen devices, the operating
system uses around 800 MByte. The user data is stored on a separate
user partition which is formatted with Ext4. This partition is neither
encrypted nor integrity protected.
Manufacturer configuration: This is written onto the device at
manufacturing and is device-specific. We identified the special
“Boot2” boot partition that has the partition signature “beefdeed2.1”
and used as NVRAM. It contains the model number, product ID,
serial number, Wi-Fi MAC address, Bluetooth MAC address, and
region. This storage is also used for bootloader configuration and
control. It also contains Device Hardware Authentication (DHA)
credentials, which consist of a private key and a certificate. The
private key is stored in an encrypted form in the KeyBox (KB)
partition and is decrypted by a TrustZone application. The certificate,
which is signed by Amazon’s Device Certificate Authority (CA), is
stored in the “persist” partition in plaintext.
Secure Boot: Echo devices use the Android Verified Boot con-
cept [33]. On Power-ON, the Boot ROM (stored on the SoC) is the
first code to execute. It verifies and loads the Pre-loader from the
flash storage. The verification of Boot ROM integrity is done using
the manufacturer’s RSA public key. The hash of the public key
is burned in the eFuses of the SoC. This Pre-loader sets up the
basic hardware and does the first security checks. Then, it loads
the signed ARM Trusted Firmware (ATF), verifies and executes
it in TrustZone Exception Level (EL3). ARM’s 64-bits architecture
defines four exception levels (EL0-EL3) with increasing privileges
to access registers, memory, and hardware features. EL3 being the

14

highest and only level that can change security state. In this step,
the Little Kernel (LK) is verified and loaded into memory. The anti-
rollback protection is also performed in this step. It checks (e.g.,
Replay-protected-memory-block (RPMB)) the currently installed
version against the minimum expected version to prevent malicious
rollback to potentially insecure earlier versions. However, not all
analyzed devices utilize RPMB, as we noticed that RPMB can be
empty and not provisioned. In the next step, the LK verifies the
signed Linux kernel image and loads it. The Linux kernel then
mounts the root partition and ensures its integrity using dm_verity.
After boot, the serial connections are disabled. The access over
USB is limited as the bootloader is locked and no open services in
Android are listening on USB. We were able to observe and verify
the boot process by analysis of the boot log via UART.
Apps: The Fire OS core is similar to a standard Android OS. The
system contains standard tools as busybox, iptables, ip6tables, logcat,
dnsmasq, hostapd and wpa-supplicant. Dnsmasq is used as a DNS
resolver. A list of DNS names and the respective IP addresses of
Amazon services is stored on the user data partition. Hostapd is used
to configure and deploy an unprovisioned device’s Wi-Fi access
point. WPA-supplicant is responsible for connecting to configured
access points after provisioning. We found that it creates its con-
figuration files on the user data partition in the folder “misc/wifi/ ”.
Here the file “wpa_supplicant.conf ” contains the Wi-Fi credentials,
such as the SSID and PSK. If multiple wireless networks are con-
figured, we discovered that this file stores all of them. In the same
folder, there is the file “networkHistory.txt” which contains a logfile
of all connections to wireless networks, including the BSSID (MAC
address of the Wi-Fi AP). This file can also contain a list of surround-
ing Wi-Fi APs including their BSSID, frequency and signal strength.
Copies of the “wpa_supplicant.conf ” and “networkHistory.txt” can
be also found in the free space of the EXT4 file system.

The logical functionality of the device is implemented using An-
droid apps. Their purpose ranging from connectivity apps to device
management, telemetry, cloud interaction and voice recognition.
The system partition contains basic voice models for the wake-up
word detection, but user-specific voice models are stored on the user
data partition in the folder “data/securedStorageLocation/models”.
We noticed that these models may differ for different owners of
devices. We found the usage of “Pryon” framework in the wake-
up word detection [6]. Here the speech is converted to text and
matched against a list of regular expressions.

The device often uses SQLite on the user partition for storing
user data. Fire OS uses the Android Account Storage and some
user information, e.g., the owner name is stored in “accounts.db”
and “0.xml” located in “system/users/0/ ”. The device identity and
token for Amazon Device Messaging [11] are stored in the folder
“com.amazon.device.messaging”. The central storage for log files is
“data/system/dropbox”, including kernel, event and debug logs.
Provisioning process: An unprovisioned device will enter the
setup mode after booting up. This is indicated through a rotating
yellow light ring on the device and by the announcement to use
the Alexa app to set up the device. At this point, the device has
created an open Wi-Fi access point with a unique SSID in the form
of “Amazon-XXXX”. The user is asked to open the Alexa app to
log into the Amazon Account and enter the credentials of user’s
home Wi-Fi. The devices only support WPA/WPA2 PSK for private

customers. The app then connects to the open configuration Wi-Fi
access point of the device and transmits the credentials. The device
then connects itself to the assigned Wi-Fi network and to the cloud.
If the connection succeeds, the device appears in the owner’s Alexa
app and can be configured from there. Upon provisioning firmware
updates are installed automatically. By default, the Wi-Fi creden-
tials are also uploaded to the Amazon Cloud. To prevent this, the
user needs to actively opt-out in the setup process. Echo devices
also support Amazon Zero-Touch Setup, which is also called Wi-Fi
simple setup [9]. Here, the device is linked in the cloud backend to
the owner’s Amazon account at the time of the purchase. The re-
quirement for this is an already existing and active Amazon device,
the provisioner devices, in proximity. This device does not need
to belong to the same owner. When the device is powered on for
the first time, it will try to connect to a hidden Wi-Fi SSID of the
provisioner device and connect through it to the Amazon backend.
Using this channel, it will configure its Wi-Fi access and connect
to Amazon cloud. The configuration is done over a secure channel
which is protected by usage of the DHA credentials [12]. As the
DHA credentials are protected by TrustZone and are used for the au-
thentication, an impersonation of the device or Man-in-the-Middle
(MitM) attack is not trivial.
Unprovisioning process: Amazon Echo devices can be reset via
the Alexa app, Amazon website, or device. In the app or website,
the user selects the device and issues a factory reset command. This
de-registers the cloud binding and issues a factory reset command
to the device. If the device is connected to the Internet, it reboots
and performs a reset. After this, the device will be in setup mode
ready for provisioning.

A user also has the possibility to reset the device locally by press-
ing buttons in a certain sequence. The exact buttons and sequence
differs between generations. 3rd Gen devices require the press
of the “Action” button for 25 seconds. The devices will signal the
process by turning the light ring orange. In our tests, we noticed
that the device enters the “setup mode” after 10-15 seconds and
turns the light ring orange. However, it did not trigger a factory
reset, but instead a Wi-Fi reconfiguration. While the device was in
Wi-Fi reconfiguration mode, a power off and power on would re-
connect the device to the network again without actually resetting
it. This behavior misleads users to believing that the factory reset
is successful and release the buttons too early.

Depending on whether the device is connected to the Internet,
a local factory reset will de-register the cloud binding. A device
reset without an Internet connection, e.g., outside of the configured
Wi-Fi, will remain associated to the user account and the cloud
binding won’t be de-registered. A user need to manually delete the
association of a device over the Alexa app or Amazon website. This
can be problematic as detailed in section 5.3.
Vulnerabilities: To this day there were no vulnerabilities or root-
ing methods reported for Amazon Echo Dots (2nd and 3rd Gen) [4].
However, there are public root methods for other Amazon devices,
like the Fire tablets [3][5][8]. These methods abuse a vulnerability
which enables to replace the LK with a modified version and still
pass the verification process. We found the same exploits and meth-
ods can be likely adopted using eMMC access for Amazon Echo
Dot devices as they use the same SoC and similar firmware.

15

In future research this can be analyzed as a way to potentially
bypass the Secure OS boot process and execute modified software.

3 NAND/EMMC FLASH FORENSIC
We first provide an overview of various flash-based storage sys-
tems and their key characteristics, then present the techniques we
developed for data extraction from Echo Dot. We assume access
over the device software itself is not possible.

3.1 Overview of Flash-Based Storage
Flash memory is widely used in embedded devices as non-volatile
memory because it provides an easy way to store data on a small
area and due to its power efficiency. Flash generally comes as NAND
or NOR flash [36]. For IoT, and more general, embedded devices
usually NAND flash is used due to its cost and high density. NAND
flash can come in different packages and types.
NAND characteristics: NAND flash is typically organized in planes,
blocks and pages. A page is the smallest unit and typically has a
data size of 512 Bytes for 1 Gbit to 4 Gbit NAND flashes, and 2048
Bytes and more for bigger sized flashes. In addition to the data size,
the page contains also a “out-of-band” (OOB) area which is used
for management and error correction codes (ECC). Primary usage
of the management is wear-leveling and bad block management.
Multiple pages are organized in blocks, for example, a block can
contain 64 to 256 pages. The exact number of pages per block and
size of the OOB area are vendor- and flash- specific. NAND flash
has a typical endurance rating of 100,000 writes per block. NAND
flash by nature is a fast and cheap storage solution but is also un-
stable [19]. Reads and writes produce bit errors which need to be
corrected by ECC. NAND flash is written to at page level. To be
able to write to a page, it needs to be empty. A page is empty, if
all physical bits are set to “1”. In order to erase data, NAND flash
requires the whole block to be erased. The process of erasing NAND
flash has implications for wear-leveling. Instead of deleting a block
every time information on a page being changed, the information
is written to a new block and the old page is marked as invalid.
This spreads the wear over the whole flash over time. However,
the actual information still remains in the page. This data might
get deleted at some point by the garbage collection of the flash
controller. This behavior prolongs the life of the flash memory but
creates the issue of the secure deletion of sensitive data. The general
problem of data remanence has been known for a long time [24].
Unmanaged NAND: The simplest type of NAND flash is unman-
aged NAND, which can also be called raw NAND flash. Standards
describe features, interfaces and packages [23]. The management is
done by using a Flash Translation Layer (FTL) in the OS as part of
the SoC itself. The FTL takes care of the wear-leveling, ECC, and
bad-block management. The exact implementation depends on the
used controller and can be delegated to the OS. The controller is
connected to the flash by 8 or 16 data lanes, and typically 7 control
lanes. Unmanaged NAND flash is usually cheaper. Due to its con-
nection, the SoC or OS can access the raw pages of the flash. The
connection between SoC and NAND IC is illustrated in Figure 4a.
Managed NAND: Another kind of NAND flash is managed NAND.
In the context of embedded devices typically Embedded Multime-
dia Card(eMMC) and Embedded Multi-Chip Package(eMCP) ICs are

NAND IC

NAND flash

eMMC IC

NAND flash

I
/

O

A
L
E

C
L
E

C
E W
E

R
E

R
/
B

MediaTek SoC

Flash Translation Layer
- Wear leveling
- Bad-block management
- ECC

I
/

O

A
L
E

C
L
E

E W
C

E

R
E

R
/
B

Integrated controller
- Wear leveling
- Bad-block management
- ECC

D
a
t
a

C
L
K

C
M
D

MediaTek SoC

(a) Unmanaged flash (NAND)

(b) Managed flash (eMMC)

Figure 4: Comparing the connection between raw NAND and eMMC flash

used. eMMC ICs typically use FBGA-153 packages, while eMCP use
FBGA-221. eMCP ICs are a combination of eMMC flash with DRAM
on one chip, reducing the number of parts on the PCB. By eMMC,
we will denote both eMMC and eMCP ICs. In contrast to unmanaged
NAND, eMMC ICs contain a flash controller embedded on the chip,
which acts as an interface between the SoC and the NAND flash.
This controller takes care of the wear leveling, ECC, and bad-block
management internally. The supported features of eMMC memory
itself are defined in the JEDEC standards. For eMMC ICs which
support the eMMC standard 4.4 and newer [13], the wear leveling
mechanism offers features as TRIM, Discard and Background. These
features improve the performance of the flash and effectiveness
of the garbage collector [16]. Additionally, the standard defines
security features like Secure Trim, Secure Erase and Replay Protected
Memory Block (RPMB). Version 4.5 of the eMMC standard intro-
duced the Sanitize command for secure data removal [14]. All of
eMMC flashes we encountered supported at least eMMC version 4.5.
Interestingly, none of the devices used the Secure Trim or Sanitize
functions. The electrical interface between SoC and eMMC is also
defined in the JEDEC standards and consists typically of 2 control
lanes and 1 or more data lanes [14, p. 189]. A connection between
SoC and eMMC ICs is illustrated in Figure 4b. In our analysis, we
observed the actual implementation of the controller features and
flash management being highly depending on the manufacturer
and model of the IC. However, no managed NAND exposes the raw
NAND flash to the SoC or host directly.
NAND Forensics: Direct access to unmanaged NAND flash is stan-
dardized and tools are available. However, the interpretation of the
data requires knowledge about the used wear-leveling mechanism,
ECC and XOR method [30].

The mechanism might be different even for the same NAND IC
as it is dependent on the type of the used FTL. There are methods
to identify the used ECC [39] and XOR method [37].
For eMMC flash the controller prevents direct access to the (physi-
cal) raw flash. In contrast to unmanaged NAND the access to the
logical information does not require any additional knowledge
about the flash management, as the eMMC controller manages it
transparently. Most eMMC ICs have test pads, which bypass the

16

Figure 5: Pin layout of Hynix BGA221 eMCP ICs, with DDR RAM (red),
eMMC (yellow) and NAND test pads (blue)

controller [34]. This access method is used by commercial compa-
nies and tools to recover data from eMMC flash. Examples for the
layout of pads of an eMCP IC can be found in figure 5.

For extraction and analysis, we use different methods, depending
on the reset state of the device. For devices that have not been
factory reset, we can use the In-System-Programming (ISP) method.
Otherwise, we use the Chip-Off method, which is more invasive.
Additionally, we developed an advanced Chip-Off method.

3.2 Data Extraction using ISP
It is not necessary to remove the eMCP IC when the device is still
provisioned. Instead, it is possible to access the flash using test-
points and traces, a method widely used for In-system programming
(ISP). To be able to use the method, it is required that we reverse
engineer the PCB to find points where to attach to the flash signals.
The schematics of the PCBs are not public. By removing the eMCP
IC and the SoC, we identified the traces for CMD, CLK and DAT0.
While they are easily accessible and known for Gen2 devices [25],
the DAT lines for 3rd Gen are using buried vias and were not
published yet. Buried vias are more difficult to trace and to access.
We developed a method to access that line using a conductive needle.
For access to the flash it is not required to find all DAT lines. Instead,
DAT0 is sufficient [14, p.8] [21]. In order to use the ISP method, it
is required that the SoC is kept in a reset state to not interfere with
the eMMC access. This can be achieved with various methods, we
chose to connect the crystal to the ground. This disables the clock
for the SoC and stops the SoC. The Vias for DAT lines are shown
on Figure 6. Figure 7 shows the position for the test points of CMD
and CLK. We can access the flash memory without removing any
chip by only using conductive needles.

CMD
(TP18)

CLK
(TP19)

Figure 7: ISP points for Echo Dot 3rd Gen on PCB back side

when the chip is soldered to the PCB. It is required to detach the
chip from the PCB to use an external adapter to dump its contents.
This process is similar to traditional flash forensics [15].

This process takes around 20-30 minutes per device, in addition
to the time needed for data retrieval. Every time when an event
occurs, e.g., when the device performs a factory reset, this needs to
be monitored and the process needs to be repeated. The reballing,
placement and soldering of the IC requires precision, as the correct
connection of the RAM is required for the operation of the device.

3.4 Hybrid Chip-Off for eMCP
One disadvantage of the Chip-Off method is that the removal of
remaining solder potentially causes damages to the solder-mask of
the PCB or eMCP IC. Additionally, both components are exposed
to thermal stress in the process. With every iteration the risk of
breaking PCB pads or creating shorts under the IC increases. It
is difficult to keep the eMCP chip externally, as DRAM has strict
requirements for the electrical interface and signaling quality. An
external eMMC chip is possible, however, the RPMB used by some
devices, prevents the use of a replacement chip in such cases.
We developed a method that allows us to repeatedly access the
contents of the flash without soldering every time. For this, we use
a donor eMCP chip for the RAM and we use the eMMC portion of
the original eMCP chip externally. As a preparation, the original
eMCP chip is removed and the eMMC portion of the pads on the
PCB are masked. Then the donor eMCP chip is soldered onto the
PCB. The masking prevents that the eMMC portion of the donor
chip is electrically connected to the SoC. We use an adapter for
the original eMCP chip and connect the eMMC pads via the previ-
ously described ISP points. The connection is illustrated in Figure
8. This method enables us the easy observation of data which have
been written through the eMMC interface and its representation in
raw NAND. The risk of damaging components in each iteration is
minimized. This method is faster in comparison to the traditional
chip removal. Additionally, this method is very powerful as the
communication between the SoC and eMMC can be intercepted
and even modified. This can be beneficial for future research with
IoT devices which use eMCP ICs.

Figure 6: ISP points for Echo Dot 3rd Gen on PCB front side
3.3 Chip Removal and Re-soldering (Chip-Off)
The NAND interface pads of an eMCP IC are not used and not
connected for normal operation. Therefore, they are not accessible

3.5 Reading raw NAND from eMMC/eMCP ICs
Reading data from raw NAND of eMMC/eMCP ICs can be very
challenging as the implementation of the controller defines how
the data is stored on the flash memory. The manufacturers of ICs

17

Donor eMCP IC
(internal)

eMMC flash
(disconnected)

Original eMCP IC
(external)

eMMC flash
(with RPMB)

NAND

eMMC

SoC

CMD

CLK

Data

DDR3 RAM

RAM

DDR3 RAM
(disconnected)

Figure 8: Hybrid Chip-Off method

do not publish any information about the internal functionality or
the layout of the chips. No universal standard seems to exist for
controllers to manage the data. For instance, we encountered data
that has been scrambled using an XOR operation with an unknown
pattern by the controller. Furthermore, the exact method of logical
to physical addressing is unspecified.

The first challenge is to connect to the raw NAND by bypassing
the controller. We used a logic analyzer to find the pin-out and
applied observations about the behavior of generic NAND from [30].
At power on the controller runs several operations on the NAND
flash. The first operation is “ID Read”, which is a standard operation
and returns the 5 Bytes long NAND ID code. By observing this
operation, it is possible to distinguish the control pins (CLE, CE,
WE, ALE, RE ) and most of the IO pins. The pads we found for
Hynix eMCP ICs can be found in Figure 9.

The second challenge is to determine the geometry of the NAND,
such as the page and block size. Some of this information is available
online, like in the Linux MTD subsystem documentation [1]. For a
unknown geometry, we determine the page size by first assuming
a big page (e.g., 20 KBytes) and then read a few pages. Each of
these pages likely contains multiple pages. By aligning distinct
structures, like the OOB area, it is possible to determine the page
size. The entropy of the OOB area is noticeably lower in comparison
to random data. The same approach can be used to determine the
block size and the number of blocks. For this paper, we only want
to detect the presence of information, therefore we ignore the error
correction and the exact addressing of the data.

The last challenge is the unknown XOR pattern. The exact XOR
mechanism depends on the manufacturer. For the analyzed ICs
it was not publicly available. Our approach was to fill the flash
with zeros multiple times over the eMMC interface. Additionally,
we changed a single bit in a block of zeros which had the size
of a page and filled the flash with it. The goal is to ensure that
as many pages as possible are filled with zeros. Later we would
revert the changed single bit. In case of Hynix eMMC the resulting
flash dump could be used as the XOR key in order to unscramble
data contents of other dumps. While this method worked for the
Hynix eMMC, it may not work for other vendors and models. A
more efficient, but more complex approach consists of extracting
the eMMC controller firmware and the scrambling keys [15, 39].
However, such an approach is out of scope of this paper, as it is not
necessary to reach our objective.

4 EFFECTS OF WEAR-LEVELING
In order to analyse the effectiveness of factory resets, we needed
to estimate the likelihood that a particular information is deleted.

R
B
0

R
E

C
L
E

A
L
E

W
E

I
/

O
0

I
/

O
1

I
/

O
2

I
/

O
3

I
/

O
4

I
/

O
5

I
/

O
6

I
/

O
7

C
E
0

0

4

8

12
Figure 9: Hynix eMCP NAND test pads

16

20

24

We developed a method to estimate the probability that a piece of
information is still present after deletion or factory resets. The goal
was to replicate the behavior of the analyzed devices.
Selection of IC: We chose the eMCP which we found most fre-
quently in 3rd Gen devices. We are aware that different models
and versions of flash might behave differently. The eMCP “Hynix
H9TQ32A4GTMCUR-KUM” is an IC which combines 4 GBytes
DDR3-RAM and 4 GBytes eMMC flash in a BGA-221 package. The
page size of the flash is 9040 Bytes. One block consists of 256 pages
and the flash has 2112 blocks in total. The boot areas, the RPMB
and the user area contain 3825672 KBytes in total. The raw NAND
equals 4773120 KBytes in size, which includes the OOB area. For
our experiment, we used new ICs, which were initially empty.
Creation of a test image: We assumed that the typical Wi-Fi cre-
dentials are smaller than 512 Bytes. For our experiment, we have
chosen a size of 310 Bytes for an example wpa_supplicant config-
uration with valid Wi-Fi settings. As the base image we used a
copy of an Amazon Echo Dot 3rd Gen’s flash memory, where the
data partition (1.5 GBytes) was zeroed. We assume further, that a
device cannot delete the non-user data partitions, e.g., system or
bootloader. All non-user data partitions combined have a size of 2.2
GBytes in total, 0.6 GBytes being empty (filled with “00”).
Process of writing and erasing: In order to keep track of infor-
mation, we created flash dumps after every step. These dumps
consisted of the data in the raw NAND and data which was ac-
cessed via the eMMC interface.
Using blank eMCP ICs, the base image was written to the chip.
An initial dump was created. Then the data partition was initially
formatted with “mkfs.ext4”, followed by another dump. The drive
and file system caches have been disabled. To detect data, we used a
similar approach as in [26, p.49 ff] and [38]. A unique pattern of 310
Bytes was written in 100 new files. These files are defined as “static”.
After each file 1 MByte of random data was written in another file
to ensure that the unique pattern is spread over multiple blocks.
This should also simulate the other files which are usually stored
on the data partition.
In a second step 100 additional files were created . This time these
files were modified and an additional line with a pattern was added.
This simulates the wear-leveling in case of modification of files, like
changes of configuration files. These files are defined as “dynamic”.
After the creation of the test files, a dump was created, which acted
as the baseline for the following experiments.
To simulate a factory reset, the data partition was formatted under
Linux with “mkfs.ext4”. The raw NAND and eMMC dump was
compared to the baseline. Then, in every iteration 200 files with 1
MByte size were written to the data partition, while the existing
files were deleted. After each iteration a dump is created. Between
iterations, the chip remained powered on for 15 minutes in order
to give time for the garbage collection algorithm of the controller
and to replicate a life-cycle of a device.
After completion of the experiment, we counted the remaining

18

100

80

60

40

20

]
t
n
e
c
r
e
p
n
i
[

s
n
r
e
t
t
a
p
g
n
i
n
i
a
m
e
R

0

0

S (NAND)
D (NAND)

1

2
Written random data [in GByte]

3

4

Figure 10: Remaining patterns after appending random data, with reading
via direct NAND interface (averaged)

unique patterns in each dump by using fuzzy matching. Due the
nature of NAND flash individual bit errors are likely and by ignor-
ing ECC, the tool needed to be tolerant to bit errors. Additionally,
we repeated each NAND flash dump multiple times to further in-
crease our accuracy. We verified the non-changed partitions in each
iteration over the eMMC interface and made sure they were not
changed. The results of our experiment are shown in Figure 10.
Interpretation: Erased data continues to exist in the raw NAND
flash for a long duration. Multiple copies of patterns could be found,
especially for the “dynamic” files. This can be explained by the
wear-leveling mechanism which tries to avoid erasure of blocks.
TRIM and Discard being enabled seem not to ensure that data gets
deleted. We noticed that the garbage collector does not immediately
delete blocks with erased data. The amount of deleted blocks in-
creases over hours when the device is idle, but it is not deterministic.
This behavior is especially problematic for factory reset devices,
as the previous owner would power off the device shortly after
the reset, meaning garbage collection likely has not yet erased all
the private data. Our experiments match the observations for SSDs
in [38] and [29]. We conclude that formatting the file system and
overwriting it with random data does not reliably delete the data
from the physical flash.

5 ATTACKING USED ECHO DOT DEVICES
Our attacks on Echo devices require physical access. In our attacker
model the attacker can get physical access to a device by obtaining
a used device, e.g., by purchasing them on eBay or flea markets,
or by finding broken devices in the trash. The attacker does not
need sophisticated tools or knowledge. The required tools can be
obtained for less than 100 USD, which however only allows the
extraction of still provisioned devices. As devices can be resold after
the extraction, the attack will be financially neutral. The data can
be used by the attacker for various crimes (e.g fraud) or used for
pranks. Also, such data can be collected and sold, e.g. to malicious
persons in a particular region or proximity of a victim.

19

5.1 Availability of used devices
There are many different sources for used devices. An attacker can
obtain used/broken devices locally, e.g. by e-waste or flea markets.
Another source are eBay or Facebook market place. We observed
the availability of used devices on eBay over multiple months in
2020 and 2021. Each week 300-400 used devices were offered on the
platform in North America. The amount of “broken” or “for parts’
devices varied between 10-30 per week. Due to the implementation
of Facebook’s market place, it is difficult to determine the exact
number of offerings. However, the number was in the thousands.
Obtaining devices by mail has the advantage, that the senders name
and address might be known to the attacker.

5.2 States of used devices
Used or broken devices can come in different states, which have an
implication of at risk information.
(State 1) Device not reset and still connected to the cloud: In
this state the device was not reset by the previous owner and still
has existing cloud binding. The Wi-Fi credentials are still present
on the device and the data partition contains pieces of the previ-
ous owner’s information. The account owner can see the device
in the Alexa app. If this device can be connected to the Internet, it
will have access to the previous owner’s Amazon account. For an
attacker this is the best scenario, as it offers them the broadest and
easiest access to a victim’s data.
(State 2) Device not reset, but cloud binding deleted: This state
is similar to the previous one, however here the previous owner
deleted the device in the Alexa app. While the device still contains
the Wi-Fi credentials and other private information, the cloud bind-
ing is invalid. If such a device gets connected to the Internet, it will
not have access to the previous owner’s Amazon account.
(State 3) Device reset, but cloud binding still exists: This sce-
nario is rare, as it requires that the device reset happened while the
device did not have an active Internet connection. The data parti-
tion was wiped, but the Amazon cloud is not aware that the device
has been reset. When restoring this information, the device can be
reconnected to the cloud and to the previous owner’s account.
(State 4) Device reset and cloud binding deleted: When a de-
vice is reset and has an active Internet connection, the cloud binding
will be invalidated. If an attacker can restore the information on
the device, it is not possible to access the Amazon account. Other
information can be still extracted but that requires more effort.
(State 5) Device was never used: If a device has never been used,
it does not contain any private information. Devices that are still
sealed or have never been powered on can be sold as “used”. This is
the worst scenario for an attacker, as there is no data to gain. How-
ever, if the device was linked to a victims Amazon account when
purchased and it can be provisioned using Amazon Zero-Touch
Setup, the attacker could have a fully provisioned device.

5.3 Extraction of data of Echo devices
In preparation for the case study, we provisioned ourselves 6 new
Amazon Echo Dot devices with test accounts at different locations
and different Wi-Fi APs. Over a period of multiple weeks, we used
these. We paired different smart home and Bluetooth devices with
the provisioned devices. Directly after this period, we disassembled

the devices and extracted the flash content. For these provisioned
devices we confirmed that the data was accessible, and we could
retain the Wi-Fi credentials. To test our assumption regarding the
cloud connection, we moved the reassembled device to a different
location and created a Wi-Fi access point with the extracted cre-
dentials. Our assumption was, that the device would not require an
additional setup when connected at a different location and Wi-Fi
access point with a different MAC address. We confirmed that the
device connected successfully, and we were able to issue voice com-
mands to the device. When asked “Alexa, Who am I?”, the device
would return the previous owner’s name. The re-connection to the
spoofed access point did not produce a notice in the Alexa app nor
a notification by email. The requests are logged under “Activity”
in the Alexa app, but they can be deleted via voice commands. We
were able to control smart home devices, query package delivery
dates, create orders, get music lists and use the “drop-in” feature.
If a calendar or contact list was linked to the Amazon account, it
was also possible to access it. The exact amount of functionality
depends on the features and skills the previous owner had used.
Before and after a factory reset the raw NAND flash was extracted
from our provisioned devices using the Chip-Off method. Addi-
tionally, we created a dump using the eMMC interface. To find
information in the resulting dumps, we had to develop a method to
identify interesting information.

5.4 Identification of information
As we provisioned the devices ourselves, we knew what kind of
information the device could potentially store. We created a list of
keywords which would be used to look for this specific information.
We divided the keywords in four different categories: information
about the owner, Wi-Fi related information, information about
paired devices and geographical information. The individual key-
words per category can be found in Table 1.

The dumps of the flash were searched for the keywords. On the
pre-reset and post-reset eMMC image we used the forensic tool
Autopsy, which supports keyword search on images [7]. The NAND
dumps were analyzed manually. The name of the Amazon account
owner was found multiple times. In all analyzed devices multiple
complete copies with contents of the “wpa_supplicant.conf ” file
were found. The number of found artifacts varied between 22 and
37 copies. Additionally, we found artifacts of log-files in raw NAND
and the eMMC dump. We confirmed that the EXT4 data partition
has been deleted. All artifacts were spread over the NAND flash
and were not stored at the same location.
By obtaining the positions of the keywords, we identified the files
and places where privacy related information is stored. For example,
we observed that we would find Wi-Fi credentials close to strings
like “ssid=”. Having this information enables us to detect the pres-
ence of information in unknown memory dumps in an automated
way. This is important to automatically analyze real users’ devices
in a privacy-preserving way as discussed later.

5.5 Retrieval of address via voice commands
While we found out that it is not directly possible to ask Alexa
for the previous owner’s address, we were able to find the approx-
imate location by asking indirect questions. When asked about

restaurants, Alexa will return restaurant names, addresses and dis-
tances in proximity of the address. The same applies to grocery
stores, post offices, public libraries, public transport stops and other
locations. Using this information, it is possible to narrow down
the approximate position. In experiments in city locations (100.000
residents) we were able to get an accuracy of approximately 150
meters. The best estimation was possible if Alexa has been asked
about nearby grocery stores. We expect that the accuracy might
differ for different types of areas.

5.6 Retrieval of owners address via log files
The Wi-Fi credentials enable the attacker to connect to the previous
owner’s Wi-Fi. With the SSID and the stored Wi-Fi access point
MAC addresses, it is possible to search for the previous position
using search engines like WiGLE 1. The more precise Google Geolo-
cation API [22] requires at least two MAC addresses for the position
retrieval. Due to the network connection log-files and Wi-Fi survey
log-files, it is possible to find two or more MAC addresses of the
surroundings of the previous owner. In some cases, a device owner
used two or more Wi-Fi access points with the same SSID (e.g.,
for a larger home). Some Wi-Fi credentials might contain personal
or location information. Interestingly, we found that kernel logs
censor the SSID, while event logs censor the BSSID (but not SSID).

6 CASE STUDY OF USED DEVICES
For our case study, we bought over 86 used Amazon Echo Dot
devices from private sellers on eBay and flea markets. To have a
comparison to different countries, we purchased devices from the
US, Germany and the Netherlands. Devices that one can find on
platforms like eBay can have different states. Some of the devices
are sold as used devices even though they never have been used and
are still in their original package. These devices never contained
any user information and are therefore irrelevant for our analysis.
For the purchase, we focus on devices which are described as “used”.
As an additional test group, we purchased 6 “certified refurbished”
devices from Amazon directly, which are in stock periodically. All
our purchases were made between July 2019 and November 2020.

6.1 Privacy-preserving analysis process
As we are aware that some devices might contain private informa-
tion, we developed a process to maintain the user’s privacy and not
use, manipulate, or reveal private information.
Upon arrival, the devices were labeled and inspected. No personal
information of the sender/seller is associated with the device.
For devices which have been purchased at a flea market, we did not
have any information about the sellers.
The devices are powered-on in order to check if they are still provi-
sioned. This can be determined if the “yellow ring” comes on after
approximately 30 seconds after the device boots. If the ring does
not turn orange, the wake-up word “Alexa” is said and if the device
responds that it has trouble connecting to the network, the device
is marked as “no reset”. At this point the assumption is that the
device still contains data, but it is unknown if the cloud binding
is still active. Due to ethical and legal considerations, there is no
simple way to verify if a device is still connected to a user account.

1https://wigle.net/

20

As we did not associate a device to a seller, we cannot ask specific
questions. For this reason, we did not verify this.
If the “orange ring” comes up, the device has been reset to factory
settings or has never been provisioned. Therefore, it is not known
if there are traces of information on the device or if there is still a
cloud binding remaining (e.g., reset outside the range of the Wi-Fi).
In the next step, the device is disassembled, as we did not find a
trivial method of dumping the flash memory from outside the de-
vice. For that the bottom rubber plate is heated up to loosen up the
adhesive and to remove it. This plate hides the screws. The device
can be disassembled, and the PCB removed. The ICs inside are of
metal shielding cans which can be easily opened. For provisioned
and non-provisioned eMMC based devices the next step differs:
If the device is still provisioned, we can use ISP to create a dump of
the flash memory. A script confirms the presence of Wi-Fi creden-
tials and other information. Private information, like owner name
or Wi-Fi passwords, are not extracted. As the devices were not
associated to a particular seller, we have no association between
SSIDs / MAC addresses and a particular person.
For devices which are not provisioned, or which are using a NAND
flash IC, we use the Chip-Off approach as the deleted data is not
accessible through the eMMC interface. Here we use the methods
described in Section 3. Depending on the flash type, we can use
the test pins of the eMMC or directly read the NAND flash using a
flash reader. After creating the dump, a script automatically checks
for traces of Wi-Fi credentials and owner information.
In case of no traces, we assumed that the device was never pro-
visioned. This assumption also was based on the condition of the
device (e.g., sealed package, unused power supply, etc.). When traces
of Wi-Fi credentials are found, the number of findings was counted
and saved. Additionally, the SSID and MAC addresses are extracted
and saved. No further information is extracted.
For devices which were sold as broken we tried the ISP approach
first and if that approach failed (e.g., the device was too damaged),
we used the Chip-Off approach.
The correctness of the proposed methods was tested and confirmed
with our own Amazon Echo Dot 3rd Gen, which was in use for over
1 year and was moved multiple times.

6.2 Results
The results of the case study are summarized in Table 2. We used the
described analysis method to process all the devices we purchased.
Our main goal was to preserve the user’s privacy.
Not reset devices: A surprising number of devices (61% ) were not
reset by the previous owners. Due to the setup of our experiment,
we had no possibility of asking the previous owners any questions.
It is unclear how many of the identified Wi-Fi credentials are still
valid. Also, we were not able to check if the devices are still bound
to the Amazon account. After interpretation of the data, we see
three potential explanations for the high number of devices which
have not been reset: missing user knowledge, missing awareness
and unclear reset instructions. From our own experience, the reset
procedure of Echo Dot devices can be misleading. When tried by
ourselves, we were deluded by the Wi-Fi setup mode, which is
triggered after 10 seconds. After power-cycling the device had not
been reset and we needed to press the button for a longer period.

Table 1: Keywords for detection of privacy related information

Category
Owner
Wi-Fi networks
Paired devices
Geographical

Keywords
Owner name, username, email address ✓
✓
SSID, PSK, BSSID, SSIDs in proximity
✓
MAC addresses and names
✘
Address, GPS coordinates

found?

Table 2: Device states of purchased devices in case study

Source

Total

Provisioned
(S1),(S2)

Reset
(S3),(S4)

New
(S5)

US
eBay - working
eBay - broken
US
local flea markets US
DE
eBay - working
NL
eBay - working

38
13
9
16
10

24 63%
13 100%
6 66%
9 56%
5 50%

13
0
2
5
4

1
0
1
2
1

Broken devices: All the devices sold as broken still contained all
the data. However, this can be explained by the inability of the user
to reset the device when it is not powering on. The majority of the
devices had a broken power supply or bad power connector. Only
in two cases the actual PCB was broken, of which both indicated
water damage. We were not able to purchase a broken device with
a partial defect. It might be possible that users would reset a device
which has a broken speaker or some other minor defect. It is unclear
if the previous owners were aware of the data which is stored on
the device. However, in a situation with a broken device the choices
are limited: The device can be destroyed, thrown away or sold.
Recovered traces in reset devices: Even for devices which have
been reset by previous owners, we were still able to recover traces.
This means that a customer cannot rely on the private data being
deleted even if the customer follows the reset procedures. This is
especially concerning, as the user has no way of confirming that
all data has been erased.
Refurbished devices: We purchased six certified refurbished de-
vices in total directly from Amazon. These devices were not always
available and we assume that they are sold in batches. We noticed
that newer refurbished devices have the new revision of the PCB,
which uses NAND flash instead of eMMC. All of the devices ap-
peared to be unused, however were missing the serial number
sticker on the bottom side of the device. We did not find any traces
on the flash memory of the devices, neither on the eMMC nor the
NAND based revisions. Our assumption is that all of them are open
box returns, which have been refurbished. Another explanation
could be that all devices were opened and the PCB was replaced.
This also explains the missing serial number sticker as the rubber
base cover would have been replaced.
Ratio of reset devices over time: Over a period of 16 months
we did not observe a significant change in the ratio between pro-
visioned and reset devices. However, this observation is limited
by the amount of devices which have been purchased on average
per month and due to the fact that the previous owner might have
stopped to use the device for a period of time before selling it.

7 MITIGATIONS
Our analysis has revealed the weaknesses of protections of pri-
vacy related data in smart speakers. The implementation of secu-
rity features in devices like smart speakers or other IoT devices

21

is challenging, as this kind of devices has to meet particular user
expectations. Features like the requirement for user passwords or
PINs at power-up are likely unacceptable. While it might be more
difficult to establish the same level of security as for smart phones,
there are mitigations which increase the security and can likely be
implemented easily. In our opinion the devices should keep the user
data safe in all circumstances, independent of whether the device
has been reset properly or not.

7.1 Usage of eMMC security features
As discussed in part 3.1, the eMMC standard supports secure dele-
tion of information. However, none of the analyzed devices were
using these features. While this only applies to eMMC based de-
vices, the Sanitize or SecureTRIM commands can be used when the
user issues a reset to the user data partition. If the eMMC flash
adhered to the standard, the data would be erased from the physical
memory. While this would meet the users expectation for a factory
reset, it would not protect the data if the device was not reset. This
mitigation can be implemented easily by the vendors and would
not have negative impact for the users. A limitation is however, that
this operation is time intensive and will be interrupted if the user
disconnects the device from the power supply. Also the Sanitize is
blocking, so the flash cannot be used while the data is being erased.

7.2 Wear-leveling aware erasing of data
A device that uses raw NAND flash has potentially more low level
control over the physical data stored on the NAND. If the OS is
aware of the physical position of the data, it can erase the data
securely and make sure that no other copies exist. This feature needs
to be implemented in the FTL, e.g., in case of Linux this would be
the MTD subsystem. This mitigation is not applicable everywhere
as in some cases the integrated controller in the SoC has the control
over the NAND flash. This is mainly done for performance reasons,
especially as ECC computation is complex. We encountered this
issue with MediaTek based SoCs. In this case the OS would not
have full access to the raw NAND flash. Also, this mitigation would
not protect the user data if the device is not reset properly.

7.3 User data encryption
Our proposed mitigation is the encryption of the user data partition,
which would solve multiple problems: First, a physical attack on a
provisioned device cannot extract user data and credentials in a sim-
ple fashion anymore as a data dump would only contain encrypted
information to which an attacker needs to retrieve the respective
key first. This would protect the user credentials even if a reset
was not possible nor performed. Second, most of the issues with
wear-leveling are mitigated as all blocks are stored encrypted. The
identification and reassembly of such blocks becomes very difficult.
Also, the correct identification and reconstruction of traces of a
deleted key is in our opinion not possible or very unlikely. We be-
lieve that this mitigation can be implemented in firmware updates
and be enabled even for already provisioned devices. However, im-
plementations might have different challenges and implications.
Performance impact: All analyzed devices had multiple cores. We
believe that such devices have enough computation resources to

perform file system encryption without performance issues. How-
ever, this might does not apply universally to all IoT devices and
smart speakers. In cases of computation limits, the most critical
user data could be stored encrypted, decrypted in the boot phase
and then stored in memory.
Implementation: All of the analyzed devices use an Android based
operating system. Android supports encryption of the user data
partition [32]. The partition could be automatically unlocked at
boot-up. In case of a factory reset, the encryption keys should be
deleted and regenerated.
Key storage: In order to be able to unlock the partition, the keys
need to be stored on the device. Depending on the storage, the key
might be subject to wear-leveling. In case of a factory reset, the
device needs to ensure that the keys gets deleted. A way to ensure
this could be to use the previously mentioned ways to erase data.
Due to the rather small size of the key such an operation would
be very fast. Another problem is that the user data must remain
safe even if the device has not been reset and the key has not been
deleted. One way to achieve this would be to store the key where
it cannot be accessed, e.g. the efuses in the SoC. While this would
prevent a simple dump of the key from the flash memory, it would
also mean that the key is static. If the key can be extracted in the
future, it might be used to decrypt old data. The devices we en-
countered had SoCs which used ARM TrustZone for key storage
and integrity protection. Since the previously mentioned approach
suffers from major drawbacks, we propose to use ARM TrustZone
to store the encryption key for the user data partition and to bind
it to the SoC instead. This would ensure that the SoC needs to be
present in order to unlock the user data partition. Additionally, we
recommend that the RPMB is used.
Limitations: We encountered vendors which encrypted the user
data partition with LUKS and used ARM TrustZone to store the key.
However, we were still able to access the user data by abusing
vulnerabilities in the firmware. While the data is protected at rest,
it can be accessed by the OS when the device is powered on. We
noticed that some devices were also subject to downgrading attacks,
in particular as the RPMB was not used.

8 COMPARISON TO OTHER DEVICES AND

VENDORS

In order to gain an understanding of whether the found issues
were exclusively related to Amazon Echo Dots, we analyzed other
Amazon products and comparable devices. For this analysis we
selected devices depending on availability and based on a similar
price range. We purchased a small number of used devices, therefore
the results are not representative. We used the same method as for
the Amazon Echo Dots. In our analysis we found very similar issues.
Amazon Echo Show 5: The Echo Show 5 (H23K37) was released in
Q2 2019 by Amazon. In comparison to the Echo Dot it has a 5.5 inch
touch-screen display, which can be used for user interaction. Such
interactions can be using the integrated browser, retrieving recipes
or watching videos in Amazon Prime Video. A front facing camera
allows video calls. All the other features of the Echo Dot, like the
Alexa virtual assistant, are supported. The devices we analyzed had
the FCC ID 2ARIV-2425. The device uses the MediaTek MT8163V,
the same SoC as the Echo Dot 2nd Gen. It supports Wi-Fi and

22

Bluetooth. The system has a separate 1 GByte DDR3 RAM and an
8 GByte eMMC flash memory.

Amazon uses again FireOS 6 (based on Android 7.1.2 Nougat) for
this device. However, the user can not install apps from the Amazon
Appstore or Google Play. Instead, only Alexa skills can be installed.
The integrity of the OS is protected by dm-verity but the partition
containing user data is not encrypted. The user can configure the
Wi-Fi or trigger a factory-reset using the touch screen. We noticed
that a change of the Wi-Fi configuration requires an additional
confirmation by the user by requiring to login with the Amazon
account credentials. In our experiment we were able to extract the
same amount of data as for the Amazon Echo Dot.

Due to the possibility of user interaction, we were also able to
extract user data from the browser. We purchased two used and
two broken devices. Both used devices were reset, but we were able
to find traces of the previous owner’s data. The broken devices still
contained all user data.
Google Home Mini: The Google Home Mini (H0A) is a direct
competitor to the Amazon Echo Dots and is a smart speaker that
uses the Google assistant. We analyzed the model with the FCC
ID A4RH0A, which was released in late 2017. It is based on the
Marvell 88DE3006 SoC, which is an ARM Cortex-A7 Dual-Core.
The device contains 512 MByte of DDR3 RAM and 256 MB of NAND
flash. Compared to the Amazon Echo Dots the device offers similar
connectivity, such as Wi-Fi and Bluetooth, which is provided by
the Marvell Avastar 88W8887 IC.

The Google Home Mini is based on Android. Similar to the
Amazon Echo Dot it also uses integrity protection of the OS by
employing dm-verity. We found that the configuration data, like
Wi-Fi credentials and tokens, are stored unencrypted on the de-
vice. The device has a reset button on the bottom side of the case.
However, the button is hidden under the rubber floor plate and is
not directly obvious for users. We purchased five used devices and
found that all of the devices were not reset by the previous owners.
Amazon FireTV 3rd Gen: Amazon FireTV (AFTN) is a line of
digital media players which offer access to Amazon services, such
as Amazon Prime Video, on a TV. Alexa is integrated as a virtual
assistant and can be controlled by voice using the FireTV remote.
The device which we analyzed was the FireTV 3rd Gen, which has
the FCC ID 2ALBL-1731. It was released in 2017 and is based on the
Amlogic S905Z (Octa-core ARM Cortex-A53-based SoC). It contains
2 GByte dedicated DDR3 RAM and 8 GByte eMMC flash memory.
The operating system in use is FireOS 6 which is based on An-
droid 7.1.2 Nougat. The user can install apps from the Amazon
Appstore. For example, apps like Netflix or Firefox can be installed
and used. Similar to the previously discussed Amazon Echo devices,
the OS is protected using using dm-verity, and the user data parti-
tion is not encrypted. This enabled us to extract private data from
a device which was not reset once again. Due to the possibility of
installing apps, we were also able to extract browser histories, saved
credentials or access tokens to third-party apps, like Netflix. We
purchased two used, working devices and one broken device. One
of the working devices was reset, but we were able to detect traces
of private data. The other two devices still contained all private
information.
Xiaomi Smart AI speaker with display: The Xiaomi Smart AI
speaker (LX04) is very similar to the Amazon Echo Show 5 and was

released in 2019. It has a 4 inch touch-screen display. The device
is geared towards the Mainland China market and not officially
marketed to different regions. It supports Xiaomi’s own virtual
assistant, “XiaoAI” and can also be used to control any Mijia smart
home devices. The SoC is a MediaTek MT8163. The device has 1
GByte of DDR3 RAM and 8 GByte of eMMC flash.

The operating system is based on Android 8.1.0 Oreo. The user
cannot install custom applications. However, the system contains
a browser and E-Mail client. The integrity of the OS is protected
by dm-verity. In contrast to the previously described devices, the
device contains encrypted partitions. While it is not possible to
access the user data via the Chip-Off approach, we were still able
to use a vulnerability in the firmware to downgrade the firmware,
and then extract the keys and information. We did not purchase
used devices of this model.

9 RELATED WORK
Reverse engineering Amazon Echo devices has been a topic of
interest since their first generations. In 2016 Clinton et al. [18] did
a hardware analysis of the Linux-based Amazon Echo (1st Gen).
It had few security features. Hyde and Moran [25] forensically
examined in 2017 the Amazon Echo Dot (1st and 2nd Gen), Amazon
Echo (1st Gen) and the Amazon app. They used UART and ISP
to access the devices. They retrieved Wi-Fi information from the
Amazon Echo via ISP and other information from Amazon apps. Li
et al. [27] proposed a forensic analysis model and used extracted
artifacts from the Amazon Echo and the Alexa app as a use case to
demonstrate their model.

Chung et al. [17] explored in 2017 the communication of the
Amazon app and the cloud. Their focus was on the artifacts and
databases of the Amazon app. Early devices had limited protec-
tions providing easy access for reverse engineering and data. Since
then Amazon increased the security of the Echo Dot devices. More
recently, Pawlaszczyk et al. [31] examined the Amazon Echo Dot
Gen3 and the Alexa app. The authors used a destructive Chip-off
method to remove the eMCP IC and specialized forensics equip-
ment to access the eMMC flash.
All previously mentioned work only uses provisioned devices. To
our knowledge our work is the first on several dimensions, (1)
demonstrates the retrieval of private users data from even factory
reset devices (exploiting wear-leveling), (2) demonstrates the ability
to hijack a previous user Amazon account, (3) is non-destructive
and systematic, and (4) applied to a relatively large set of user de-
vices revealing, poor users security practices, and usable security
limitations. We responsibly disclosed our results to Amazon. The
company reproduced and confirmed our findings. This applies also
for newer models. Currently Amazon is still working on integrating
a mitigation into the devices.

ACKNOWLEDGMENTS
This work was partially supported by grants NCAE-Cyber Re-
search Program, and NSF/DGE-1661532. We would also like to
thank Cameron Kennedy and Erik Uhlmann for their valuable in-
put, advice and for the interesting discussions.

23

[28] MediaTek. 2020. MediaTek 8516 Datasheet. (2020). https://www.mediatek.com/

products/tablets/mt8516 [Online; accessed 02. May. 2020].

[29] Alastair Nisbet, Scott Lawrence, and Matthew Ruff. 2013. A forensic analysis
and comparison of solid state drive data retention with trim enabled file systems.
(2013).

[30] Jeong Wook Oh. 2014. Reverse engineering flash memory for fun and benefit.

Blackhat US (2014).

[31] D Pawlaszczyk, J Friese, and C Hummert. 2019. “Alexa, tell me...”-A forensic

examination of the Amazon Echo Dot 3 rd Generation. (2019).

[32] Android Open Source Project. 2020. Full-Disk Encryption | Android Open Source
Project. (2020). https://source.android.com/security/encryption/full-disk [Online;
accessed 02. May. 2020].

[33] Android Open Source Project. 2020. Verified Boot | Android Open Source Project.
(2020). https://source.android.com/security/verifiedboot [Online; accessed 02.
May. 2020].

[34] Rusolut. 2018. eMMC CHIPS. DATA RECOVERY BEYOND CONTROLLER. (2018).
https://rusolut.com/wp-content/uploads/2018/10/eMMCvsNAND.pdf BelkaDay
- Belkasoft Digital Forensic Conference 2018, Prague, Czech Republic.

[35] Lea Schönherr, Maximilian Golla, Thorsten Eisenhofer, Jan Wiele, Dorothea
Kolossa, and Thorsten Holz. 2020. Unacceptable, where is my privacy? Exploring
Accidental Triggers of Smart Speakers. (2020). arXiv:cs.CR/2008.00508

[36] Arie Tal. 2002. Two flash technologies compared: NOR vs NAND. White Paper of

M-Systems (2002).

[37] Jan Peter van Zandwijk. 2015. A mathematical approach to NAND flash-memory
descrambling and decoding. Digital Investigation 12 (2015), 41 – 52. https:
//doi.org/10.1016/j.diin.2015.01.003

[38] Michael Wei, Laura M. Grupp, Frederick E. Spada, and Steven Swanson. 2011.
Reliably Erasing Data from Flash-Based Solid State Drives. In Proceedings of
the 9th USENIX Conference on File and Stroage Technologies (FAST’11). USENIX
Association, USA, 8.

[39] Li Zhang, Yu an Tan, and Qi kun Zhang. 2012. Identification of NAND flash
ECC algorithms in mobile devices. Digital Investigation 9, 1 (2012), 34 – 48.
https://doi.org/10.1016/j.diin.2012.04.001

REFERENCES
[1] 2011. NAND Flash Table.

(Jul 2011). http://www.linux-mtd.infradead.org/

nand-data/nanddata.html [Online; accessed 7. July. 2020].

[2] 2019. Juniper Estimates 3.25 Billion Voice Assistants Are in Use Today, Google
Has About 30% of Them - Voicebot.ai. (Feb 2019). shorturl.at/uHNOP [Online;
accessed 4. Aug. 2020].

2017 Fire HD 10: Unbricking from anti-rollback.

[3] 2020.
2020).
2017-fire-hd-10-unbricking-anti-rollback-t3896616
Aug. 2020].

(Aug
https://forum.xda-developers.com/hd8-hd10/development/
[Online; accessed 31.

[4] 2020. Amazon Echo Dot : CVE security vulnerabilities, versions and de-
https://www.cvedetails.com/product/46475/

tailed reports.
Amazon-Echo-Dot.html?vendor_id=12126 [Online; accessed 4. Aug. 2020].

(Aug 2020).

[5] 2020.

Fire HD 8 (2018 ONLY) unbrick, downgrade, unlock & root.
(Aug 2020). https://forum.xda-developers.com/hd8-hd10/orig-development/
fire-hd-8-2018-downgrade-unlock-root-t3894256 [Online; accessed 31. Aug.
2020].

[6] 2020. Pryon. https://www.pryon.com/. (Oct 2020).

[Online; accessed 1. Oct.

2020].

[7] 2020. Sleuthkit Autopsy features. (Aug 2020). http://www.sleuthkit.org/autopsy/

features.php [Online; accessed 1. Aug. 2020].

[8] 2020.

[UNLOCK][ROOT][TWRP][UNBRICK] Fire HD 8 2017 (douglas).
(Aug 2020). https://forum.xda-developers.com/hd8-hd10/orig-development/
unlock-fire-hd-8-2017-douglas-t3962846 [Online; accessed 31. Aug. 2020].
[9] Amazon. 2020. Amazon.com Help: Amazon Frustration-Free Setup Frequently
Asked Questions. (2020). https://www.amazon.com/gp/help/customer/display.
html?nodeId=GMPKVYDBR223TRPY [Online; accessed 15. Mar 2020].

[10] Amazon. 2020. Fire OS 6 for Fire Tablets | Fire Tablets. (2020). https://developer.

amazon.com/docs/fire-tablets/fire-os-6.html [Online; accessed 02. May. 2020].

[11] Amazon. 2020. Overview of Amazon Device Messaging | Amazon Device Mes-
saging. (2020). https://developer.amazon.com/docs/adm/overview.html [Online;
accessed 02. May. 2020].

[12] Amazon. 2020.
(2020).

Understanding Frustration-Free Setup | Frustration-Free
https://developer.amazon.com/docs/frustration-free-setup/

Setup.
understanding-ffs.html [Online; accessed 15. Mar 2020].

[13] JEDEC Solid State Technology Association. 2010. Embedded MultiMediaCard
(eMMC) eMMC/Card Product Standard, High Capacity, including Reliable Write,
Boot, Sleep Modes, Dual Data Rate, Multiple Partitions Supports, Security En-
hancement, Background Operation and High Priority Interrupt (MMCA, 4.41).
JESD84-A441 (2010).

[14] JEDEC Solid State Technology Association. 2012. Embedded Multimedia Card

(eMMC), Electrical Standard 4.51. JESD84-B451 (2012).

[15] Marcel Breeuwsma, Martien De Jongh, Coert Klaver, Ronald Van Der Knijff, and
Mark Roeloffs. 2007. Forensic data recovery from flash memory. Small Scale
Digital Device Forensics Journal 1, 1 (2007), 1–17.

[16] Byungjo Kim, Dong Hyun Kang, Changwoo Min, and Young Ik Eom. 2014. Un-
derstanding implications of trim, discard, and background command for eMMC
storage device. In 2014 IEEE 3rd Global Conference on Consumer Electronics (GCCE).
709–710.

[17] Hyunji Chung, Jungheum Park, and Sangjin Lee. 2017. Digital forensic approaches
for Amazon Alexa ecosystem. Digital Investigation 22 (2017), S15 – S25. https:
//doi.org/10.1016/j.diin.2017.06.010

[18] Ike Clinton, Lance Cook, and Shankar Banik. 2016. A survey of various methods
for analyzing the amazon echo. The Citadel, The Military College of South Carolina
(2016).

[19] Jim Cooke. 2007. The inconvenient truths of NAND flash memory. Flash Memory

Summit 3, 3 (2007), 3–1.

[20] Daniel J. Dubois, Roman Kolcun, Anna Maria Mandalari, Muhammad Talha
Paracha, David Choffnes, and Hamed Haddadi. 01 Oct. 2020. When Speakers Are
All Ears: Characterizing Misactivations of IoT Smart Speakers. Proceedings on
Privacy Enhancing Technologies 2020, 4 (01 Oct. 2020), 255 – 276.

[21] Amir Etemadieh, CJ Heres, and Khoa Hoan. 2017. Hacking Hardware With A

$10 SD Card Reader. Blackhat US (2017).

[22] Google. 2020. Overview | Geolocation API | Google Developers. (2020). https:
//developers.google.com/maps/documentation/geolocation/overview [Online;
accessed 02. May. 2020].

[23] Open NAND Flash Interface Working Group. 2020. Open NAND Flash Interface

Specification. ONFI 4.2 (2020).

[24] Peter Gutmann. 2001. Data Remanence in Semiconductor Devices.. In USENIX

Security Symposium. 39–54.

[25] Jessica Hyde and Brian Moran. 2017. Alexa, are you Skynet. SANS Digital

Forensics and Incident Response Summit (2017).

[26] Magnus Larsson. 2015. Sanitization of embedded network devices: Investigation

of vendor’s factory reset procedure. (2015).

[27] S. Li, K. R. Choo, Q. Sun, W. J. Buchanan, and J. Cao. 2019. IoT Forensics: Amazon
Echo as a Use Case. IEEE Internet of Things Journal 6, 4 (Aug 2019), 6487–6497.
https://doi.org/10.1109/JIOT.2019.2906946

24



=== Content from news.ycombinator.com_8c5b4371_20250114_182231.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D27943730) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Amazon Echo Dot does not wipe personal content after factory reset](https://www.cpomagazine.com/data-privacy/is-it-possible-to-make-iot-devices-private-amazon-echo-dot-does-not-wipe-personal-content-after-factory-reset/) ([cpomagazine.com](from?site=cpomagazine.com)) | | --- | --- | --- | |  | | 323 points by [walterbell](user?id=walterbell) [on July 24, 2021](item?id=27943730)  | [hide](hide?id=27943730&goto=item%3Fid%3D27943730) | [past](https://hn.algolia.com/?query=Amazon%20Echo%20Dot%20does%20not%20wipe%20personal%20content%20after%20factory%20reset&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=27943730&auth=0e35491e8fb4ef5a831109b15f4c3f9f31e19310) | [99 comments](item?id=27943730) |  | |  |  | [haunter](user?id=haunter) [on July 24, 2021](item?id=27944910)   | [next](#27945686) [–]  >Since the storage media in these IoT devices would not last long if true deletions were being performed constantly, “deleted” data is often simply invalidated and moved to an unused page in the block (in a process called “wear leveling”). These invalidated pages, which still contain the data, remain present until a block fills up with them and a true deletion is initiated. >Accessing flash memory that has been factory reset in this way does require some amount of technical skill and specialized equipment, but nothing that is a real barrier to the average enthusiast working at home. By that logic my iPhone 11, my Android phone, my Mac or my Windows PC doesn't wipe personal content either after factory reset Feels like a bit clickbait-ish But at least Macs have a built-in 7-pass erase option to comply with DOD standards [https://techpatio.com/wp-content/uploads/2012/09/disk-utilit...](https://techpatio.com/wp-content/uploads/2012/09/disk-utility-mac-osx.jpg) | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [gojomo](user?id=gojomo) [on July 24, 2021](item?id=27945063)   | [parent](#27944910) | [next](#27944972) [–]  I believe iOS handles this by ensuring all flash-written data is encrypted with an on-device key. A 'wipe' then definitively erases that key - making further overwrites of the freed data unnecessary. If the crypto is strong, and the key never exfiltrated, then this may be even *better* than an explicit overwrite, which on some media (like magnetic drives) may still leave trace hints of the old data that advanced techniques could recover. | | --- | --- | --- | | | |  |  | [fpgaminer](user?id=fpgaminer) [on July 25, 2021](item?id=27945445)   | [root](#27944910) | [parent](#27945063) | [next](#27945539) [–]  > If the crypto is strong, and the key never exfiltrated, then this may be even better than an explicit overwrite, which on some media (like magnetic drives) may still leave trace hints of the old data that advanced techniques could recover. The idea that magnetic drives left readable traces behind after an overwrite is a myth (especially of modern drives; if I recall the article I'm thinking of correctly the myth may have had a \_slim\_ chance of being true with old drives [like 100MB days]). | | --- | --- | --- | | | |  |  | [rootw0rm](user?id=rootw0rm) [on July 25, 2021](item?id=27946549)   | [root](#27944910) | [parent](#27945445) | [next](#27945539) [–]  I'm fairly certain you're correct, but the fact that various secure delete tools overwrite data multiple times probably helps propagate this myth. | | --- | --- | --- | | | |  |  | [quaintdev](user?id=quaintdev) [on July 25, 2021](item?id=27947124)   | [root](#27944910) | [parent](#27946549) | [next](#27945539) [–]  I wonder how it is even possible in those 100MB disks. | | --- | --- | --- | | | |  |  | [rebuilder](user?id=rebuilder) [on July 25, 2021](item?id=27947886)   | [root](#27944910) | [parent](#27947124) | [next](#27948251) [–]  The idea was that, since the drive head doesn’t pass over precisely the same area on the track every time it writes to the disk, the track has to be wide enough to account for this lack of precision. Thus, a single overwrite pass could leave a portion of the track’s edge unchanged and readable with an electron microscope or something. | | --- | --- | --- | | | |  |  | [Doxin](user?id=Doxin) [on July 26, 2021](item?id=27957338)   | [root](#27944910) | [parent](#27947886) | [next](#27948251) [–]  I always figured that a write wouldn't change the magnetic field 100%. Say it's 90% effective at changing the magnetic field. There's now four options: 1 overwritten by 0: 10% field strength 0 overwritten by 0: 0% field strength 1 overwritten by 1: 100% field strength 0 overwritten by 1: 90% field strength But I guess that's not quite true. | | --- | --- | --- | | | |  |  | [pbhjpbhj](user?id=pbhjpbhj) [on July 25, 2021](item?id=27948251)   | [root](#27944910) | [parent](#27947124) | [prev](#27947886) | [next](#27947485) [–]  I looked into back in the day (but not quite as far back as that), <https://alicious.com/secure-drive-data-wiping/>, couple of references there. | | --- | --- | --- | | | |  |  | [thefurrysquid](user?id=thefurrysquid) [on July 25, 2021](item?id=27947485)   | [root](#27944910) | [parent](#27947124) | [prev](#27948251) | [next](#27945539) [–]  Low density data, paired with not very accurate head tracking. | | --- | --- | --- | | | |  |  | [infogulch](user?id=infogulch) [on July 25, 2021](item?id=27945539)   | [root](#27944910) | [parent](#27945063) | [prev](#27945445) | [next](#27949534) [–]  I agree, there is only one reasonable method to consider a drive "wiped": encrypt all data written to it with a key; wipe == destroy the key. Drives are basically little computers now, they have full-featured CPUs, OSes, memory, write caches and persistent buffers, they compress data before writing it, lie to you about where the data is (ok fine, it's a legitimate abstraction), and who knows what else. My point is that drives have become way too complex for wiping by "overwriting" "every" "block" to ever be an option again (and yes all three of those words deserve scare-quotes). The answer to this problem has become: always encrypt, lose the key to wipe. Period. | | --- | --- | --- | | | |  |  | [dan000892](user?id=dan000892) [on July 25, 2021](item?id=27946265)   | [root](#27944910) | [parent](#27945539) | [next](#27945956) [–]  From your comment I'm not sure if you're aware but there are two established standards that do just that: ATA Secure Erase is an optional security feature implemented by many flash-based disk devices specifically because write degradation and overprovisioning preclude them from being wiped via overwrite as you would magnetic media. More SSD disk controllers than you may realize have an AES encryption engine and persistent storage for the key. The controller is encrypting/decrypting on the fly transparent to the user/system. A secure erase simply rolls that key (and flags all the cells as empty). As noted in the sibling comment, there must be trust in the device itself that the old key is unrecoverable (or the data recoverable if the prior key had been compromised). hdparm on any linux liveusb (e.g. Clonezilla) and an eSATA dock and you can nuke a few disks a minute with two commands: ```   hdparm --user-master u --security-set-pass p /dev/sdX   hdparm --user-master u --security-erase-enhanced p /dev/sdX  ``` hdparm has other arguments that can tell you if this is supported and how long the drive says it'll take to do it. The other standard is TCG's OPAL. An AES media encryption key (MEK) is generated to encrypt/decrypt all data on the fly. The MEK is encrypted with a user-defined key encrypting key (KEK) and that encrypted MEK is stored on the drive. At boot the user (or some external process) needs to supply the drive with the KEK to decrypt the MEK and begin transparently decrypting/encrypting data on the fly. Splitting the disk into multiple "locking ranges" with independent MEKs and KEKs is also described in the spec enabling secure wipe of just a portion of the disk. Lose the KEK or destroy the MEK and the data is unrecoverable. I'd say this option still requires trust in the disk itself but since TCG dictates not just the interface but also the implementation and has a corresponding certification process (as well as reliance on an off-device key), I reckon TCG OPAL devices should be more trusted than those that simply claim to implement the ATA Secure Erase command, but I haven't had an opportunity to test any. | | --- | --- | --- | | | |  |  | [infogulch](user?id=infogulch) [on July 25, 2021](item?id=27946348)   | [root](#27944910) | [parent](#27946265) | [next](#27945956) [–]  Cool, thanks for sharing. It's interesting that even the drives themselves use this strategy to "erase" data; it doesn't actually overwrite the cells, it just always encrypts all data that goes to cells and rotates the key when it's asked to erase. This strategy is clearly superior, it doesn't cost any wear on the cells to perform, and it's instant. The multiple locking ranges is pretty neat, I'd never heard of that. | | --- | --- | --- | | | |  |  | [glitchc](user?id=glitchc) [on July 25, 2021](item?id=27945956)   | [root](#27944910) | [parent](#27945539) | [prev](#27946265) | [next](#27946201) [–]  How can one trust it though? Presumably the key has to make its way into the drive to actually decrypt the data. How can one be sure the key was actually deleted and not archived somewhere in the controller’s storage? | | --- | --- | --- | | | |  |  | [infogulch](user?id=infogulch) [on July 25, 2021](item?id=27946165)   | [root](#27944910) | [parent](#27945956) | [next](#27946201) [–]  Ideally, data is encrypted at the CPU (or coprocessor or TPU chip) and sent to the drive encrypted. The drive never gets the key, its only job is to store encrypted blocks correctly. In the TPU case, the TPU chip controls decryption and the key never leaves the specialized, tamper-resistant chip; wiping means sending a command to the TPU to rotate keys, thus instantly destroying any access to the data. | | --- | --- | --- | | | |  |  | [neoncontrails](user?id=neoncontrails) [on July 25, 2021](item?id=27946201)   | [root](#27944910) | [parent](#27945539) | [prev](#27945956) | [next](#27945922) [–]  A coworker once insisted on fondling discarded drives with extremely strong magnets, then taking a power sander to the magnetized part. I wasn't sure if this was overkill or not. Is there any wisdom in this? | | --- | --- | --- | | | |  |  | [dylan604](user?id=dylan604) [on July 25, 2021](item?id=27946428)   | [root](#27944910) | [parent](#27946201) | [next](#27946962) [–]  Sounds like someone needing a reason to use a power sander | | --- | --- | --- | | | |  |  | [sizzle](user?id=sizzle) [on July 25, 2021](item?id=27949581)   | [root](#27944910) | [parent](#27946428) | [next](#27946962) [–]  Yup exactly why I needed to buy my Milwaukee right angle die grinder… ask my wife ;) | | --- | --- | --- | | | |  |  | [WaxProlix](user?id=WaxProlix) [on July 25, 2021](item?id=27946962)   | [root](#27944910) | [parent](#27946201) | [prev](#27946428) | [next](#27946443) [–]  When I worked for the UC Observatories we physically destroyed most retired drives, just in case of sensitive information. Some personal machines' drives were excepted but there was a good deal of hammering. | | --- | --- | --- | | | |  |  | [sundvor](user?id=sundvor) [on July 25, 2021](item?id=27946443)   | [root](#27944910) | [parent](#27946201) | [prev](#27946962) | [next](#27945922) [–]  Well if they wanted to be 100% certain nothing could be recovered, then that is a very good way to make sure. | | --- | --- | --- | | | |  |  | [flavius29663](user?id=flavius29663) [on July 25, 2021](item?id=27945922)   | [root](#27944910) | [parent](#27945539) | [prev](#27946201) | [next](#27949534) [–]  what if you just fill the whole disk with random bytes? Wouldn't that take care of it ? | | --- | --- | --- | | | |  |  | [infogulch](user?id=infogulch) [on July 25, 2021](item?id=27946307)   | [root](#27944910) | [parent](#27945922) | [next](#27945964) [–]  You don't have access to "the whole disk". What the drive presents to the OS as an array of blocks is just an abstraction now. There are at least 3 commonly known ways that "filling" the disk with random bytes could fail to destroy the original data: \* If any part of a block is found to be corrupted for any reason, the block is transparently set aside and never used again, but its contents may still be present to read for someone that is willing to bypass the drive's firmware. \* To prevent uneven wear, ssd capacity is over provisioned which means it has more cells than what it tells the OS. In general, when you "overwrite" a block on your drive, that data likely does not actually overwrite the cell where the data used to be. The drive picks some other unused cell, writes the data there, and does some bookkeeping so it knows that this new cell is what the OS means when it asks for that block again. When the OS "fills the disk" it may not end up overwriting some of those cells due to the firmware's arbitrary wear leveling algorithm. \* Many drives have a local write buffer that uses different, faster persistent storage to temporarily save writes to the drive as it takes its time to write out cells. This is to prevent data loss in the case of a power outage. In case the drive hadn't fully written all the blocks to the main storage when it boots back up again, it finds the data in the write buffer and finishes the job. The write buffer has both of the previous issues except its even more arbitrary and depends on load profile which your random filling routine is not guaranteed to hit. There is no such thing as securely overwriting blocks anymore, because "blocks" are a fiction presented to your OS by the drive's firmware. There is only one way to be sure the data on the drive is filled with random data: *make it random to begin with*, and ensure that it stays random by destroying the decryption key. | | --- | --- | --- | | | |  |  | [dylan604](user?id=dylan604) [on July 25, 2021](item?id=27946433)   | [root](#27944910) | [parent](#27946307) | [next](#27945964) [–]  >\* If any part of a block is found to be corrupted for any reason, the block is transparently set aside and never used again, but its contents may still be present to read for someone that is willing to bypass the drive's firmware. How useful is one block of recovered data? | | --- | --- | --- | | | |  |  | [KMnO4](user?id=KMnO4) [on July 25, 2021](item?id=27946477)   | [root](#27944910) | [parent](#27946433) | [next](#27945964) [–]  Blocks can be up to 4mb. You could store all your passwords, private keys, contact/identity info, etc | | --- | --- | --- | | | |  |  | [dylan604](user?id=dylan604) [on July 25, 2021](item?id=27947131)   | [root](#27944910) | [parent](#27946477) | [next](#27945964) [–]  Really now. Last time I cared to look at any of this, it was all 4K blocks. | | --- | --- | --- | | | |  |  | [aaronmdjones](user?id=aaronmdjones) [on July 25, 2021](item?id=27947230)   | [root](#27944910) | [parent](#27947131) | [next](#27945964) [–]  You are confusing physical blocks (i.e. flash memory) with logical blocks (i.e. filesystems). Edit: HDDs typically have 4K blocks though ("advanced-format drives"), but we're not talking about HDDs. | | --- | --- | --- | | | |  |  | [dylan604](user?id=dylan604) [on July 25, 2021](item?id=27947303)   | [root](#27944910) | [parent](#27947230) | [next](#27945964) [–]  Yeah, I honestly have not cared about how hard drives work in about 10 years since I built my last array. I have better things to do with my life than worry about this stuff. I just want to connect a drive, reformat/partition if necessary, and then go back to work. A single SSD now read/writes faster than a 16 drive array (got close in RAID0, but that's just dumb). Now, if SSDs could just get a decent volume size. | | --- | --- | --- | | | |  |  | [BenjiWiebe](user?id=BenjiWiebe) [on July 25, 2021](item?id=27949517)   | [root](#27944910) | [parent](#27947303) | [next](#27945964) [–]  They've got what I consider decent size, it's just that the price can be a bit steep compared to an HDD, at least at quantities of 1. $700 will get you an 8TB SSD. | | --- | --- | --- | | | |  |  | [dylan604](user?id=dylan604) [on July 25, 2021](item?id=27949626)   | [root](#27944910) | [parent](#27949517) | [next](#27945964) [–]  8TB at blazing speeds to boot in a single device. To get decent speeds from HDD would require at least 8 drives striped together. So not only do you need 8+ HDD drives, you also need the enclosure. That would easily double the $700 for the single SSD. Luckily, with USBC/TB4, these enclosures come with the controllers built-in instead of requiring PCIe board | | --- | --- | --- | | | |  |  | [thelopa](user?id=thelopa) [on July 25, 2021](item?id=27945964)   | [root](#27944910) | [parent](#27945922) | [prev](#27946307) | [next](#27949534) [–]  There could be bits of plain text data left over in over-provisioned storage set up in case a block goes bad (e.g. a flash cell that can no longer erase). | | --- | --- | --- | | | |  |  | [flavius29663](user?id=flavius29663) [on July 25, 2021](item?id=27946229)   | [root](#27944910) | [parent](#27945964) | [next](#27949534) [–]  Would that extra cell be used unless there is a need for it? If there is a need for it, then I assume it will be a need for it when you fill the drive too. But yeah, it depends on the manufacturer of the drive, so you don't want to take the chance, Full encryption is unbeatable. | | --- | --- | --- | | | |  |  | [dan000892](user?id=dan000892) [on July 25, 2021](item?id=27946408)   | [root](#27944910) | [parent](#27946229) | [next](#27949534) [–]  Flash devices maximize the longevity of the cells by wear leveling. The on-board controller maintains a map between the physical cell layout and the logical layout that's changing with every single write operation. Extra cells are used both reactively and proactively. Reactively: Error when erasing or write/verifying a cell? Copy contents to spare cell, flag old cell as bad, update the map, maybe complain if running low on spare cells but otherwise call it a day. Proactively: Cells are only rated for so many erase operations which directly informs the longevity (total bytes written) of a drive. MLC cells can be written to 3,000 times and SLC 20,000 but the latter is much more expensive. For use cases where greater longevity is required (without spending SLC money), why not put a disk together that has twice as many cells as it needs and wear level across all of them? If you `dd if=/dev/zero of=/dev/sdX bs=64k status=progress` your 32GB drive and it'll complete after 32GB but you have no way of knowing how many more cells that drive has that you didn't touch. (Also as one of the parents pointed out, disk controllers are getting smart. You don't know if it was transparently compressing data too causing you to touch even fewer cells. ATA Secure Erase is the way to go.) | | --- | --- | --- | | | |  |  | [sizzle](user?id=sizzle) [on July 25, 2021](item?id=27949534)   | [root](#27944910) | [parent](#27945063) | [prev](#27945539) | [next](#27945940) [–]  I’ve always wondered this, instead of writing many passes of gibberish data that takes many hours, could I simply format the drive in seconds, encrypt the whole blank drive with a long generated password, then format and encrypt a second time in seconds and be done? Or if I’m feeling spicy, do all this then hit it with a hammer until it’s shattered in a million pieces like my dreams of working in tech. | | --- | --- | --- | | | |  |  | [Kwpolska](user?id=Kwpolska) [on July 25, 2021](item?id=27951875)   | [root](#27944910) | [parent](#27949534) | [next](#27945940) [–]  If the first encrption would encrypt the entire drive, then you’ve effectively done a 1-pass erase. It might work, but I would still prefer specialized software — perhaps the encryption method of choice would still leave some data unencrypted or untouched. The hammer method also sounds fine to me. | | --- | --- | --- | | | |  |  | [emodendroket](user?id=emodendroket) [on July 25, 2021](item?id=27945940)   | [root](#27944910) | [parent](#27945063) | [prev](#27949534) | [next](#27946876) [–]  Not true of older Android phones, however. | | --- | --- | --- | | | |  |  | [8note](user?id=8note) [on July 25, 2021](item?id=27946876)   | [root](#27944910) | [parent](#27945063) | [prev](#27945940) | [next](#27945277) [–]  If the crypto is strong, wouldnt the leftovers be equivalent to not overwriting? The only better is less wear on the disk | | --- | --- | --- | | | |  |  | [lolthishuman](user?id=lolthishuman) [on July 24, 2021](item?id=27945277)   | [root](#27944910) | [parent](#27945063) | [prev](#27946876) | [next](#27944972) [–]  I’ve read opsec material that no matter how many passes you do it can still be read. Hard to know for sure unless you know the stack in and out like the back of your hand. | | --- | --- | --- | | | |  |  | [jcrawfordor](user?id=jcrawfordor) [on July 25, 2021](item?id=27945501)   | [root](#27944910) | [parent](#27945277) | [next](#27945692) [–]  1) Modern research suggests that recovering data which has been overwritten once on magnetic media is probably not feasible due to the high density of modern magnetic storage devices and the use of dynamically aligning heads (e.g. that follow track geometry as they read) instead of absolutely positioned heads (stepper motors) that allow for more error in alignment. 2) Nonetheless, there is an appreciable risk of data remaining on the device due to non-volatile caches, remapped disk areas, and other factors that are not always well understood or disclosed by the manufacturer. Manufacturers have also been found to be unreliable in their implementation of ATA security features (e.g. embedded secure erase). As a result, with few exceptions it is U. S. government policy to permanently destroy all storage devices rather than trusting *any* kind of secure erasure. The typical NSA-approved method is either to degauss (surprisingly tricky to do right) and then crush, or reduce to 2mm particles with a device resembling a large, terrifying blender. | | --- | --- | --- | | | |  |  | [jfrunyon](user?id=jfrunyon) [on July 25, 2021](item?id=27945605)   | [root](#27944910) | [parent](#27945501) | [next](#27945692) [–]  > As a result, with few exceptions it is U. S. government policy to permanently destroy And as a result, (probably) Iron Mountain makes bucketloads because we don't just encrypt the drives (let's face it, that would be perfectly acceptable for 99% of US government computers - *maybe* Top Secret stuff deserves proper destruction). | | --- | --- | --- | | | |  |  | [kps](user?id=kps) [on July 25, 2021](item?id=27945692)   | [root](#27944910) | [parent](#27945277) | [prev](#27945501) | [next](#27945869) [–]  > I’ve read opsec material that no matter how many passes you do it can still be read. If that were true, we'd have infinite storage capacity. | | --- | --- | --- | | | |  |  | [taeric](user?id=taeric) [on July 25, 2021](item?id=27945709)   | [root](#27944910) | [parent](#27945692) | [next](#27945869) [–]  Giving some charity to the claim, I'm assuming it meant on devices you plan to dispose of. | | --- | --- | --- | | | |  |  | [neolog](user?id=neolog) [on July 25, 2021](item?id=27945735)   | [root](#27944910) | [parent](#27945709) | [next](#27945869) [–]  I don't see how throwing it away improves storage capacity in a way that would invalidate GP's comment | | --- | --- | --- | | | |  |  | [taeric](user?id=taeric) [on July 25, 2021](item?id=27946223)   | [root](#27944910) | [parent](#27945735) | [next](#27945869) [–]  The assumption isn't infinite capacity. It is recovery of the last data. | | --- | --- | --- | | | |  |  | [DSMan195276](user?id=DSMan195276) [on July 25, 2021](item?id=27946929)   | [root](#27944910) | [parent](#27946223) | [next](#27945869) [–]  Is that fundamentally different from the question of whether overwriting data can make it unreadable? If yes then you can eventually make the "last data" unrecoverable by overwriting it. And if no then presumably you can recover anything previously written to the disk, ergo infinite capacity. | | --- | --- | --- | | | |  |  | [tempestn](user?id=tempestn) [on July 25, 2021](item?id=27947134)   | [root](#27944910) | [parent](#27946929) | [next](#27945869) [–]  Presumably the original comment meant that you can't *guarantee* the original data is unreadable with any finite number of overwrites, not that you can always read the original data after overwriting. I'm not saying that's true, but it's a logical interpretation that doesn't imply infinite storage. | | --- | --- | --- | | | |  |  | [Gigachad](user?id=Gigachad) [on July 25, 2021](item?id=27945869)   | [root](#27944910) | [parent](#27945277) | [prev](#27945692) | [next](#27945423) [–]  Even if you could find the original crypto header, You still need to know the password to unlock it. On iphones, the secure enclave will hold the decrypted key while its running but you need to enter the password after a reboot. | | --- | --- | --- | | | |  |  | [Gigachad](user?id=Gigachad) [on July 25, 2021](item?id=27946701)   | [root](#27944910) | [parent](#27945869) | [next](#27945423) [–]  Also if someone had the technical capability to do this. I would be infinitely more concerned about them having an exploit which allows them to hack my next phone and grab all the data while its running. | | --- | --- | --- | | | |  |  | [vlovich123](user?id=vlovich123) [on July 24, 2021](item?id=27945423)   | [root](#27944910) | [parent](#27945277) | [prev](#27945869) | [next](#27945336) [–]  A lot of that opsec material is very dated back from when density was lower and you had a spinning disk. Do you have any that’s evidence-based that such techniques are needed for flash storage? If anything the opsec concerns are different. There’s very little that would force the controller to actually perform erase of specific blocks (eg the flash could blacklist blocks due to errors). To my knowledge that’s the primary concern, not that the data is still somehow recoverable once erased (which used to be true but I’m not sure holds for modern storage). | | --- | --- | --- | | | |  |  | [tailspin2019](user?id=tailspin2019) [on July 24, 2021](item?id=27945336)   | [root](#27944910) | [parent](#27945277) | [prev](#27945423) | [next](#27945451) [–]  That’s probably true but the GP is likely drawing the distinction that iOS tries to do an “unrecoverable” delete as best it can whereas presumably the Echo is not doing this (encrypting the data and then deleting the key as part of the reset). | | --- | --- | --- | | | |  |  | [nyolfen](user?id=nyolfen) [on July 25, 2021](item?id=27945451)   | [root](#27944910) | [parent](#27945277) | [prev](#27945336) | [next](#27944972) [–]  this does not apply to cryptoshredding or any modern storage media. even a single pass on magnetic media renders data unrecoverable. | | --- | --- | --- | | | |  |  | [wongarsu](user?id=wongarsu) [on July 24, 2021](item?id=27944972)   | [parent](#27944910) | [prev](#27945063) | [next](#27944980) [–]  Concerning Windows, the help page about the factory reset states "You'll be asked to choose whether you want to erase data quickly or thoroughly. If you choose to erase data quickly, some data might be recoverable using special software. If you choose to erase data thoroughly, this will take longer but it makes recovering data less likely." [1] Of course deleting data on an SSD is tricky due to wear-leveling, anything short of telling the drive to erase the entire disk with the secure erase command isn't guaranteed to work. 1: [https://support.microsoft.com/en-us/windows/how-to-refresh-r...](https://support.microsoft.com/en-us/windows/how-to-refresh-reset-or-restore-your-pc-51391d9a-eb0a-84a7-69e4-c2c1fbceb8dd) | | --- | --- | --- | | | |  |  | [orev](user?id=orev) [on July 24, 2021](item?id=27944980)   | [parent](#27944910) | [prev](#27944972) | [next](#27945432) [–]  This is why FDE is mostly the default on all of the devices you mention. The secret keys are stored in the TPM or equivalent. Most SSDs for Mac/PC also have an OEM software option to trigger a secure wipe using special software from the vendor. The problem here is that the Echo is closed so those options aren’t available to you. However, this is also a problem on other custom devices like printers. | | --- | --- | --- | | | |  |  | [ThePowerOfFuet](user?id=ThePowerOfFuet) [on July 24, 2021](item?id=27945432)   | [parent](#27944910) | [prev](#27944980) | [next](#27944921) [–]  >By that logic my iPhone 11, my Android phone, my Mac or my Windows PC doesn't wipe personal content either after factory reset Your iPhone 11 zeroizes the cryptographic key used for the user data partition. It doesn't have to wipe it per se, but rather it renders it eternally inaccessible; then it creates a new key and sets up a new filesystem right over top of the old one (which now just has random data in the unallocated space). | | --- | --- | --- | | | |  |  | [jfrunyon](user?id=jfrunyon) [on July 25, 2021](item?id=27945656)   | [root](#27944910) | [parent](#27945432) | [next](#27944921) [–]  If you really think the encryption will never ("eternally") be broken, I have sad news for you: it will. | | --- | --- | --- | | | |  |  | [barsonme](user?id=barsonme) [on July 25, 2021](item?id=27945754)   | [root](#27944910) | [parent](#27945656) | [next](#27944921) [–]  If AES is broken before your iPhone is destroyed then you have bigger problems than somebody reading your data. | | --- | --- | --- | | | |  |  | [ashtonkem](user?id=ashtonkem) [on July 24, 2021](item?id=27944921)   | [parent](#27944910) | [prev](#27945432) | [next](#27945623) [–]  Do you have any sources for the assertion that resetting an iOS device doesn’t remove data? | | --- | --- | --- | | | |  |  | [wrboyce](user?id=wrboyce) [on July 24, 2021](item?id=27944948)   | [root](#27944910) | [parent](#27944921) | [next](#27944969) [–]  Do iOS devices not leverage full disk encryption? In which case I’d assume simply wiping the encryption keys/fde headers would be sufficient? (Which it almost certainly does.) | | --- | --- | --- | | | |  |  | [croon](user?id=croon) [on July 24, 2021](item?id=27944969)   | [root](#27944910) | [parent](#27944921) | [prev](#27944948) | [next](#27945452) [–]  [https://www.apple.com/ca/business-docs/iOS\_Security\_Guide.pd...](https://www.apple.com/ca/business-docs/iOS_Security_Guide.pdf) > The “Erase all content and settings” option in Settings obliterates all the keys in Effaceable Storage, rendering all user data on the device cryptographically inaccessible. Semantics debate around whether leaving data practically inaccessible is the same as removing it, but considering where we are, I'd say it isn't. Granted, this is from 2018, but I doubt the defaults and concept have changed. | | --- | --- | --- | | | |  |  | [Retric](user?id=Retric) [on July 24, 2021](item?id=27945218)   | [root](#27944910) | [parent](#27944969) | [next](#27945452) [–]  Securely deleting the keys is safer than simply practically inaccessible. That suggests their is some impractical way to access the data, care to suggest what that might be? | | --- | --- | --- | | | |  |  | [emsy](user?id=emsy) [on July 25, 2021](item?id=27945634)   | [root](#27944910) | [parent](#27945218) | [next](#27945635) [–]  Overwriting flash with 0s. To be fair I think the iPhone should grant you that option (MacOs does). But to suggesting that leaving an encrypted block of data on the device is on the same level as leaving unencrypted blocks of data lying around is foolish. | | --- | --- | --- | | | |  |  | [Retric](user?id=Retric) [on July 25, 2021](item?id=27946010)   | [root](#27944910) | [parent](#27945634) | [next](#27945635) [–]  Overwriting flash data isn’t going to give you access to the data. It might in theory be more secure, but I would favor encryption at rest rather than simply overwriting plain text. | | --- | --- | --- | | | |  |  | [jfrunyon](user?id=jfrunyon) [on July 25, 2021](item?id=27945635)   | [root](#27944910) | [parent](#27945218) | [prev](#27945634) | [next](#27945452) [–]  Encryption can be (and in fact certainly will be, given enough time) broken. | | --- | --- | --- | | | |  |  | [Retric](user?id=Retric) [on July 25, 2021](item?id=27945995)   | [root](#27944910) | [parent](#27945635) | [next](#27945452) [–]  It is possible in theory to recover some information from overwriting flash data with zeros, it’s also possible in theory for well designed modern encryption to be broken but neither of those are guaranteed at this point. | | --- | --- | --- | | | |  |  | [jfrunyon](user?id=jfrunyon) [on July 27, 2021](item?id=27974343)   | [root](#27944910) | [parent](#27945995) | [next](#27945452) [–]  Essentially every encryption scheme in history has been broken. It's a bit silly to think that "well designed modern" makes it safe. The others were all well designed and modern at one time, too. The only scheme that's truly unbreakable is a one-time pad and that's... well... not really practically useable. Personally, that's not a risk that I would care about (especially in the context of an Echo Dot or even an iPhone), but deleting the keys will not be better than inaccessible forever. | | --- | --- | --- | | | |  |  | [vlovich123](user?id=vlovich123) [on July 25, 2021](item?id=27945452)   | [root](#27944910) | [parent](#27944921) | [prev](#27944969) | [next](#27945623) [–]  Even if you didn’t have the public docs explaining this, you could make an educated guess because resetting the iOS device takes the same amount of time regardless of how much data you put on it and that time is on the order of 10s of seconds. iPhones don’t have erase speeds of 12gigabit/s - I don’t think there’s any storage technology that could do that. Also remember that Apple takes seriously the concern about the data leaking because the OS decided\* to blacklist a bad block. Once a block has gone bad you probably shouldn’t rely on attempts to erase it working out. \* if I recall correctly iOS devices don’t use a traditional flash controller and Apple does that mapping themselves (it’s also largely why Apple devices have better flash performance than competitors) | | --- | --- | --- | | | |  |  | [ashtonkem](user?id=ashtonkem) [on July 26, 2021](item?id=27959493)   | [root](#27944910) | [parent](#27945452) | [next](#27945623) [–]  > you could make an educated guess because resetting the iOS device takes the same amount of time regardless of how much data you put on it This is incorrect. Secure deletion should cover the entire disk no matter how much data was used before, in order to deny an attacker any information or to guide their recovery efforts. I would absolutely expect a secure deletion process to take the exact same amount of time regardless of how much data is used. A better tell is the difference between the same model of phone with different storage sizes. A 512GB iPhone should take 2x as long to securely wipe compared to a 256GB one, assuming they’re actually overwriting the encrypted data with random noise. > iPhones don’t have erase speeds of 12gigabit/s It’s worth pointing out that a true secure delete is actually a *write* not a delete. But it’s true that your typical iPhone could not possibly overwrite its entire disk in 10s or so, although last time I did a reset it took much longer than that. | | --- | --- | --- | | | |  |  | [vlovich123](user?id=vlovich123) [on July 28, 2021](item?id=27979784)   | [root](#27944910) | [parent](#27959493) | [next](#27945623) [–]  > This is incorrect. Secure deletion should cover the entire disk no matter how much data was used before, in order to deny an attacker any information or to guide their recovery efforts. I would absolutely expect a secure deletion process to take the exact same amount of time regardless of how much data is used. That's a fair point. Still, mobile devices typically employ FDE to avoid the need for scribbling over the entire flash (also improves the lifetime of the flash in that way). > It’s worth pointing out that a true secure delete is actually a write not a delete Flash storage doesn't work that way unless you're referring to something else. To write a block you have to erase it first (makes the block all 1s or all 0s depending on the chip). An update of a block is technically then a read/erase/modify/write (although flash translation layers will elide the first 3 steps by writing to a free block & marking the old one as GC'able). Writing random patterns into flash to my knowledge generally isn't needed anyway as it was with magnetic storage. The only purpose of writing in a secure erase scenario is to try to overwhelm the flash translation layer to force every block to be touched. > although last time I did a reset it took much longer than that. I haven't profiled it, but any slowness erasing an iOS device is probably because the flash storage backing the secure element is optimized for reads rather than writes. Additionally, it may be erasing various metadata/caches in the OS storage that aren't covered by the encryption key. | | --- | --- | --- | | | |  |  | [barsonme](user?id=barsonme) [on July 25, 2021](item?id=27945623)   | [parent](#27944910) | [prev](#27944921) | [next](#27945510) [–]  Macs with SSDs don’t have the 7-pass option because (from the horse’s mouth) it’s only effective for HDDs. | | --- | --- | --- | | | |  |  | [thebruce87m](user?id=thebruce87m) [on July 25, 2021](item?id=27949120)   | [root](#27944910) | [parent](#27945623) | [next](#27945510) [–]  If you could reliably read data after 6 passes then HDDs would be 6 times larger with the same hardware. There is the further belief that state sponsored actors would be able to read them, but this relies that state sponsored actors 1) have hardware capable and 2) would *only* go to those lengths to get the data. | | --- | --- | --- | | | |  |  | [re](user?id=re) [on July 25, 2021](item?id=27945510)   | [parent](#27944910) | [prev](#27945623) | [next](#27945572) [–]  > But at least Macs have a built-in 7-pass erase option to comply with DOD standards I recently learned that the "zero out data" options are not available in Disk Utility for SSDs. This probably fine if you were using full disk encryption, especially on modern T2-chip Macs that always encrypt the built-in storage even if you haven't enabled FileVault, but it was a little concerning when I was getting rid of an old failing Mac that had an aftermarket SSD installed without encryption enabled. | | --- | --- | --- | | | |  |  | [jeffbee](user?id=jeffbee) [on July 25, 2021](item?id=27946048)   | [root](#27944910) | [parent](#27945510) | [next](#27945572) [–]  Yes it's really annoying because they also aren't available in the UI for fusion drives. You have to go into the command line tools in recovery mode, break the fusion drive volume down into its constituent pieces, and wipe the HDD separately, then rebuilt the fusion drive manually. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [on July 25, 2021](item?id=27945572)   | [parent](#27944910) | [prev](#27945510) | [next](#27945533) [–]  Interesting note: modern high-density NAND flash ("TLC", "QLC") is so sensitive to the data patterns being written (writing zero bits causes more wear than writing 1 bits - the latter being the default non-written state of the medium) that controllers need to use a scrambling algorithm to statistically balance the number of 0 and 1 bits that are written. Earlier schemes were based on LFSRs or similar, but then I guess someone noticed that an encryption algorithm would also do a similar job, with the advantage of it being much harder to create pathological cases (look up "CD-ROM weak sector protection" for an interesting rabbithole related to that) and "self-encrypting drive" also be a good marketing point. On the other hand, it's a nightmare for data recovery, especially the "I didn't ever mean to encrypt this drive, what do you mean you can't recover it?" situation. There's some discussion of the older version of that scheme (not encryption-based) here: <https://joshuawise.com/projects/ndfrecovery> | | --- | --- | --- | | | |  |  | [aeturnum](user?id=aeturnum) [on July 25, 2021](item?id=27945533)   | [parent](#27944910) | [prev](#27945572) | [next](#27945562) [–]  The clickbait-y part is that it is possible to retrieve a token from the previous user. Pretty normal as you say. The non-clickbait is that the previous token is still valid as far as Amazon is concerned. They absolutely should have a process for invalidating tokens. | | --- | --- | --- | | | |  |  | [SV\_BubbleTime](user?id=SV_BubbleTime) [on July 25, 2021](item?id=27945562)   | [parent](#27944910) | [prev](#27945533) | [next](#27945594) [–]  The flash on your iPhone is nicer than cheaper embedded devices / microcontrollers. I have no idea what Echos use, but I’ve seen modern ARM micros have a 50k flash life expectancy or less. It’s not impossible to have a flash memory without a user data eeprom that you could “burn out” (in reality make less reliable). I have no idea if it’s true in this case, but the straight comparison / jump to iPhone 11 might also be speculative. | | --- | --- | --- | | | |  |  | [PhasmaFelis](user?id=PhasmaFelis) [on July 25, 2021](item?id=27945594)   | [parent](#27944910) | [prev](#27945562) | [next](#27945060) [–]  > By that logic my iPhone 11, my Android phone, my Mac or my Windows PC doesn't wipe personal content either after factory reset If those work the same way, then no, they don't. If lots of other devices have the same problem, that doesn't make it *better!* | | --- | --- | --- | | | |  |  | [sp332](user?id=sp332) [on July 24, 2021](item?id=27945060)   | [parent](#27944910) | [prev](#27945594) | [next](#27945934) [–]  There is a command you can send to the drive that will erase all data including from those extra bookkeeping areas. "ATA Secure Erase". The drive has to support it of course. | | --- | --- | --- | | | |  |  | [ekianjo](user?id=ekianjo) [on July 25, 2021](item?id=27945934)   | [parent](#27944910) | [prev](#27945060) | [next](#27945686) [–]  > By that logic my iPhone 11 Don't worry about your physical iPhone, all of your data is mostly already saved for you remotely where it can never be wiped ever. | | --- | --- | --- | | | |  |  | [404mm](user?id=404mm) [on July 25, 2021](item?id=27945686)   | [prev](#27944910) | [next](#27944931) [–]  This explanation infuriates me so much. They use technical terms and true technologies to lie about their security issues and measures. Flash memory should easily withstand north of 10k write/erase cycles, base on type. Even if there was somehow some very low limit, users’ request to delete personal & sensitive data should be honored and any cost. But then again, we’re talking about people paying actual money to have these devices in their homes. | | --- | --- | --- | | | |  |  | [adrian\_b](user?id=adrian_b) [on July 25, 2021](item?id=27946773)   | [parent](#27945686) | [next](#27944931) [–]  High-density flash memory with more than 1 bit per cell, like in SSD's, withstands usually just a few hundred, some times only one hundred, write-erase cycles. You can easily compute this value by dividing the guaranteed endurance by the SSD capacity. For example, an 1 TB Samsung 980 guarantees only 600 TBW / 1 TB = 600 write-erase cycles. This computation works because the wear-leveling algorithm used by the SSD controller distributes the writes uniformly over the entire SSD, ensuring approximately the same number of write-erase cycles for every cell. | | --- | --- | --- | | | |  |  | [walterbell](user?id=walterbell) [on July 24, 2021](item?id=27944931)   | [prev](#27945686) | [next](#27944785) [–]  User/config partitions can be encrypted and factory reset can delete the user/config encryption key. Minimizes writes to physical blocks, user data becomes unrecoverable. This is standard practice for repurposing of multi-TB hard drives. Hopefully the new U.S. FTC focus on "right to repair" will improve transparency on consumer electronics internals for both hardware and software, [https://www.ftc.gov/news-events/press-releases/2021/07/ftc-r...](https://www.ftc.gov/news-events/press-releases/2021/07/ftc-ramp-law-enforcement-against-illegal-repair-restrictions) *> Commission unanimously adopts policy statement aimed at restoring Right to Repair for small businesses, workers, consumers, and government entities* | | --- | --- | --- | | | |  |  | [Causality1](user?id=Causality1) [on July 24, 2021](item?id=27944785)   | [prev](#27944931) | [next](#27945358) [–]  Yet another consumer protection law we sorely need. That a factory reset should leave passwords on a device should open Amazon to enormous liability. | | --- | --- | --- | | | |  |  | [foxpurple](user?id=foxpurple) [on July 24, 2021](item?id=27944862)   | [parent](#27944785) | [next](#27945358) [–]  Ideally, the OS should be an immutable image and the user partition completely seperate. Than a factory reset simply has to nuke the user partition and place a fresh template over the top. I can understand how something not designed could have difficulty factory resetting when data can be scattered all over the place. | | --- | --- | --- | | | |  |  | [RicoElectrico](user?id=RicoElectrico) [on July 24, 2021](item?id=27944903)   | [root](#27944785) | [parent](#27944862) | [next](#27945358) [–]  I don't know about what is it like now (with all this A/B stuff), but /system/ on Android is supposed to be read only. As was ROFS on Symbian. That said, root could modify /system/ anyway. | | --- | --- | --- | | | |  |  | [jeroenhd](user?id=jeroenhd) [on July 24, 2021](item?id=27945064)   | [root](#27944785) | [parent](#27944903) | [next](#27945358) [–]  It's still read-only on Android these days (there are multiple partitions for A/B stuff). Root can modify it, true, but I don't think anyone is storing any secrets on there. With file-based encryption on the data partitions, Android hard resets should make all files inaccessible even if they're left on the drive. | | --- | --- | --- | | | |  |  | [xyzzy\_plugh](user?id=xyzzy_plugh) [on July 24, 2021](item?id=27945358)   | [prev](#27944785) | [next](#27946441) [–]  From what I gather from folks who worked in the first Echo Dot, it was a tire fire of a project rushed out the door. Apparently the remnants of the failed Fire Phone team decided to Android-ify the Echo software, which was Kindle-based originally. I've always found the quality of the Dots to be subpar compared to the original Pringles can. Not surprised to discover this fuck up. | | --- | --- | --- | | | |  |  | [beckman466](user?id=beckman466) [on July 25, 2021](item?id=27946441)   | [prev](#27945358) | [next](#27945022) [–]  A device that is a black box does a black box thing. The dynamics in the current system that have, and continue to, reward the privatization of knowledge, will end soon. Come join us in growing the first Open Value Networks using DWeb tools like Valueflows/hREA, Holochain, SSB, DAT, ActivityPub and more. | | --- | --- | --- | | | |  |  | [thelucky41](user?id=thelucky41) [on July 24, 2021](item?id=27945022)   | [prev](#27946441) | [next](#27945160) [–]  Consumer electronics are becoming more durable. Where once I might have replaced a cell phone every year and my home router every two, I now have had the same phone for four years and my router for six. Second hand sellers and repair shops need the factory reset feature, but we all benefited when our firmware allowed the devices to become safely transferable and repairable. From the cited paper, most of the acquired devices were not even reset: > Not reset devices: A surprising number of devices (61% ) were not reset by the previous owners. Due to the setup of our experiment, we had no possibility of asking the previous owners any questions. I'm doubtful this exists, but I'd like it if it were possible to perform a factory reset or account transfer completely online, and other features around improving the security in the resale market. For those curious like me how the wifi password was actually leaked: > WPA-supplicant is responsible for connecting to configured access points after provisioning. We found that it creates its con- figuration files on the user data partition in the folder “misc/wifi/”. Here the file “wpa\_supplicant.conf ” contains the Wi-Fi credentials, such as the SSID and PSK. | | --- | --- | --- | | | |  |  | [PhasmaFelis](user?id=PhasmaFelis) [on July 25, 2021](item?id=27945607)   | [parent](#27945022) | [next](#27945160) [–]  > *Consumer electronics are becoming more durable. Where once I might have replaced a cell phone every year and my home router every two* That's kind of extreme. I'm not sure that means they're becoming more durable, or you're getting less obsessed with owning latest-and-greatest. | | --- | --- | --- | | | |  |  | [rantwasp](user?id=rantwasp) [on July 24, 2021](item?id=27945160)   | [prev](#27945022) | [next](#27945272) [–]  so your problem is not the potential of the damm thing listening on you 24/7? it’s the wipe after factory reset? i guess I could see some people mind one but not the other, but I guess people that strongly care about their privacy would not buy an echo to start with. | | --- | --- | --- | | | |  |  | [kadoban](user?id=kadoban) [on July 25, 2021](item?id=27945472)   | [parent](#27945160) | [next](#27946023) [–]  Security isn't binary. Even if you trust Amazon enough, you probably don't trust some random stranger you're selling used electronics to. | | --- | --- | --- | | | |  |  | [rantwasp](user?id=rantwasp) [on July 25, 2021](item?id=27945625)   | [root](#27945160) | [parent](#27945472) | [next](#27946023) [–]  yeah. that’s true. I guess, I was going with: don’t trust amazon | | --- | --- | --- | | | |  |  | [kadoban](user?id=kadoban) [on July 25, 2021](item?id=27945674)   | [root](#27945160) | [parent](#27945625) | [next](#27946023) [–]  Also a good idea, IMO, yes. | | --- | --- | --- | | | |  |  | [amelius](user?id=amelius) [on July 25, 2021](item?id=27946023)   | [parent](#27945160) | [prev](#27945472) | [next](#27945272) [–]  > so your problem is not the potential of the damm thing listening on you 24/7? How do you know your smartphone isn't doing the exact same thing? | | --- | --- | --- | | | |  |  | [fsflover](user?id=fsflover) [on July 25, 2021](item?id=27948118)   | [root](#27945160) | [parent](#27946023) | [next](#27945272) [–]  Because I have kill switches on my Pinephone. | | --- | --- | --- | | | |  |  | [amelius](user?id=amelius) [on July 25, 2021](item?id=27948855)   | [root](#27945160) | [parent](#27948118) | [next](#27945272) [–]  Then perhaps we should have an activation system developed by a company that you trust, which interfaces with the underlying Amazon Echo/Siri/Google assistant. | | --- | --- | --- | | | |  |  | [jjice](user?id=jjice) [on July 24, 2021](item?id=27945272)   | [prev](#27945160) | [next](#27945793) [–]  I have one I got ad a gift years ago that I'd like to get rid of. Is there a good way to get rid of this thing without tossing it or giving my info away? | | --- | --- | --- | | | |  |  | [HellsMaddy](user?id=HellsMaddy) [on July 24, 2021](item?id=27945337)   | [parent](#27945272) | [next](#27945793) [–]  I received one as a gift too. Used it for about a week, got tired of it and creeped. So I pried it open, used a flathead screwdriver + hammer to chisel/smash any chips that looked interesting, and recycled it with some other e-waste. I felt bad destroying a “perfectly good” device, but my reasoning was that the world is better off with one less of these spyware devices, and I resolved to never buy a smart assistant device again. I wouldn’t have destroyed it had I been more trusting of Amazon, but now I’m glad I did. | | --- | --- | --- | | | |  |  | [HellsMaddy](user?id=HellsMaddy) [on July 25, 2021](item?id=27946309)   | [root](#27945272) | [parent](#27945337) | [next](#27945793) [–]  To clarify: it was not a personal gift, I received it when I signed up for internet service in a new apartment. | | --- | --- | --- | | | |  |  | [egberts](user?id=egberts) [on July 25, 2021](item?id=27945793)   | [prev](#27945272) | [next](#27945372) [–]  Burn it. | | --- | --- | --- | | | |  |  | [swiley](user?id=swiley) [on July 24, 2021](item?id=27945372)   | [prev](#27945793) [–]  You should not own one of these, certainly not without it paying rent. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from arstechnica.com_7d9f264a_20250114_182228.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

THE S IS FOR SECURITY

# Thinking about selling your Echo Dot—or any IoT device? Read this first

Deleting data from Echo Dots—and other IoT devices from Amazon and elsewhere—is hard.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Jul 2, 2021 8:55 am

| [84](https://arstechnica.com/gadgets/2021/07/passwords-in-amazon-echo-dots-live-on-even-after-you-factory-reset-them/#comments "84 comments")

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/amazon-echo-dot.jpeg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/amazon-echo-dot.jpeg)

Credit:
Getty Images

Credit:
Getty Images

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

Like most Internet-of-things (IoT) devices these days, Amazon’s Echo Dot gives users a way to perform a factory reset so, as the corporate behemoth [says](https://www.amazon.com/gp/help/customer/display.html?nodeId=200197550), users can “remove any... personal content from the applicable device(s)” before selling or discarding them. But researchers have recently found that the digital bits that remain on these reset devices can be reassembled to retrieve a wealth of sensitive data, including passwords, locations, authentication tokens, and other sensitive data.

Most IoT devices, the Echo Dot included, use NAND-based flash memory to store data. Like traditional hard drives, NAND—which is short for the boolean operator "[NOT AND](https://www.sciencedirect.com/topics/computer-science/boolean-operator)"—stores bits of data so they can be recalled later, but whereas hard drives write data to magnetic platters, NAND uses silicon chips. NAND is also less stable than hard drives because reading and writing to it produces bit errors that must be corrected using error-correcting code.

## Reset but not wiped

NAND is usually organized in planes, blocks, and pages. This design allows for a limited number of erase cycles, usually in the neighborhood of between 10,000 to 100,000 times per block. To extend the life of the chip, blocks storing deleted data are often invalidated rather than wiped. True deletions usually happen only when most of the pages in a block are invalidated. This process is known as [wear-leveling](https://en.wikipedia.org/wiki/Wear_leveling).

Researchers from Northeastern University bought 86 used devices on eBay and at flea markets over a span of 16 months. They first examined the purchased devices to see which ones had been factory reset and which hadn’t. Their first surprise: 61 percent of them had not been reset. Without a reset, recovering the previous owners' Wi-Fi passwords, router MAC addresses, Amazon account credentials, and information about connected devices was a relatively easy process.

The next surprise came when the researchers disassembled the devices and forensically examined the contents stored in their memory.

“An adversary with physical access to such devices (e.g., purchasing a used one) can retrieve sensitive information such as Wi-Fi credentials, the physical location of (previous) owners, and cyber-physical devices (e.g., cameras, door locks),” the researchers wrote in a [research paper](https://dl.acm.org/doi/pdf/10.1145/3448300.3467820). “We show that such information, including all previous passwords and tokens, remains on the flash memory, even after a factory reset.”

Used Echo Dots and other Amazon devices can come in a variety of states. One state is the device remains provisioned, as the 61 percent of purchased Echo Dots were. The devices can be reset while they are connected to the previous owner’s Wi-Fi network, reset while disconnected from Wi-Fi, either with or without deleting the device from the owner’s Alexa app.

Depending on the type of NAND flash and the state of the previously owned device, the researchers used several different techniques to extract the stored data. For reset devices, there’s a process known as chip-off, which involves disassembling the device and desoldering the flash memory. The researchers then use an external device to access and extract the flash contents. This method requires a fair amount of equipment, skill, and time.

A different process called in-system programming allows the researchers to access the flash without desoldering it. It works by scratching some of the solder mask coating off of the printed circuit board and attaching a conductive needle to an exposed piece of copper to tap into the [signal trace](link), which connects the flash to the CPU.

The researchers also created a hybrid chip-off method that causes less damage and thermal stress to the PCB and the [embedded multi chip package](https://www.linkedin.com/pulse/mcp-emmc-emcp-difference-connection-aken-cheung/). These defects can cause short-circuiting and breakage of PCB pads. The hybrid technique uses a donor multi-chip package for the RAM and the [embedded multi media card](https://www.martview-forum.com/threads/learning-time-emmc-basic-knowledge-part-1.39735/) portion of the original multi-chip package externally. This method is mostly interesting to researchers who want to analyze IoT devices.

## Alexa, who am I?

In addition to the 86 used devices, the researchers bought six new Echo Dot devices and over a span of several weeks provisioned them with test accounts at different geographic locations and different Wi-Fi access points. The researchers paired the provisioned devices to different smart home and Bluetooth devices. The researchers then extracted the flash contents from these still-provisioned devices using the techniques described earlier.

After extracting the flash contents from their six new devices, the researchers used the [Autospy](https://www.autopsy.com/) forensic tool to search embedded multimedia card images. The researchers analyzed NAND dumps manually. They found the name of the Amazon account owner multiple times, along with the complete contents of the [wpa\_supplicant.conf file](https://www.systutorials.com/docs/linux/man/5-wpa_supplicant.conf/), which stores a list of networks the devices have previously connected to, along with the encryption key they used. Recovered log files also provided lots of personal information.

Because the researchers provisioned the devices themselves, they knew what kinds of information the devices stored. They used this knowledge to create a list of keywords to locate specific types of data in four categories: information about the owner, Wi-Fi-related data, information about paired devices, and geographic information. Knowing what kinds of data are on the device can be helpful, but it’s not necessary for carrying out the attack.

After dumping and analyzing the recovered data, the researchers reassembled the devices. The researchers wrote:

> Our assumption was, that the device would not require an additional setup when connected at a different location and Wi-Fi access point with a different MAC address. We confirmed that the device connected successfully, and we were able to issue voice commands to the device. When asked “Alexa, Who am I?”, the device would return the previous owner’s name. The re-connection to the spoofed access point did not produce a notice in the Alexa app nor a notification by email. The requests are logged under “Activity” in the Alexa app, but they can be deleted via voice commands. We were able to control smart home devices, query package delivery dates, create orders, get music lists and use the “drop-in” feature. If a calendar or contact list was linked to the Amazon account, it was also possible to access it. The exact amount of functionality depends on the features and skills the previous owner had used. Before and after a factory reset the raw NAND flash was extracted from our provisioned devices using the Chip-Off method. Additionally, we created a dump using the eMMC interface. To find information in the resulting dumps, we had to develop a method to identify interesting information.

Dennis Giese, one of the Northeastern University researchers who wrote the paper, expanded on the attack scenario in an email, writing:

> One of the queries is “Alexa, Who am I,” and the device will tell the owner's name. All services that the previous owner used are accessible. For example, you can manage your calendar through the Echo. Also, the Echo will get notifications when packages are about to arrive or you can use the Drop-In feature (as in, talking to another Echo of yours). If someone does not use any smart home devices, then you obviously cannot control them. One special thing is door locks, where, by default, Alexa only allows you to lock them. A user needs to manually allow Alexa to enable the unlock feature… which, to our knowledge, only works through the App. So if a user did not enable that feature, you cannot open doors.

## Reading the tea leaves

While the Echo Dot wouldn’t provide the previous owner’s address through voice commands, the researchers were able to find the rough location by asking questions about nearby restaurants, grocery stores, and public libraries. In a few of the experiments, locations were accurate up to 150 meters. In some cases—such as when the device user had multiple Wi-Fi routers or neighbors’ SSID names were stored—the researchers could use the [Google localization API](https://developers.google.com/maps/documentation/geolocation/get-api-key), which is more precise still.

When Echo Dots were reset, the data extraction required more sophistication. In the event that the reset was done when the device was disconnected from the owner’s Wi-Fi network and the user didn’t delete the device from their Alexa app, the recovered data included the authentication token needed to connect to the associated Amazon account. From there, the researchers could do the same things possible with non-reset devices, as described earlier.

When devices were reset while connected to the Wi-Fi network or had been deleted from the Alexa app, the researchers could no longer access the associated Amazon account, but in most cases they could still obtain Wi-Fi SSID names and passwords and MAC addresses of the connected router. With those two pieces of information, it’s usually possible to learn the rough location of the device using search sites such as [Wigle](https://www.wigle.net/).

Giese summarized the results this way:

> If a device has not been reset (as in 61% of the cases), then it's pretty simple: you remove the rubber on the bottom, remove 4 screws, remove the body, unscrew the PCB, remove a shielding and attach your needles. You can dump the device then in less than 5 minutes with a standard eMMC/SD Card reader. After you got everything, you reassemble the device (technically, you don't need to reassemble it as it will work as is) and you create your own fake Wi-Fi access point. And you can chat with Alexa directly after that.
>
> If the device has been reset, it gets more tricky and will involve some soldering. You will at least get the Wi-Fi credentials and potentially the position of the Wi-Fi using the MAC address. In some rare cases, you might be able to connect it to the Amazon cloud and the previous owner's account. But that depends on the circumstances of the reset.

Ethical considerations prevented the researchers from performing experiments if they revealed personal information about the owner. The results of experiments the researchers were able to do were consistent with the results from their six devices, and there’s no reason to believe they wouldn’t behave the same way. That means the 61 percent of used devices they bought held a wealth of personal information about the previous owner that was fairly easy for someone with modest means to extract.

The researchers also developed a privacy-preserving scheme to indicate when devices still stored this information. The researchers didn’t save or use any of it to demonstrate additional attacks, and they didn’t find any personal data on six additional Amazon-certified refurbished devices they obtained.

## Mitigating the privacy disaster

The researchers proposed several ways to better protect data from extraction on used devices. The most effective, they said, was to encrypt the user data partition. This mitigation would solve multiple problems.

> First, a physical attack on a provisioned device cannot extract user data and credentials in a simple fashion anymore as a data dump would only contain encrypted information to which an attacker needs to retrieve the respective key first. This would protect the user credentials even if a reset was not possible nor performed. Second, most of the issues with wear-leveling are mitigated as all blocks are stored encrypted. The identification and reassembly of such blocks becomes very difficult. Also, the correct identification and reconstruction of traces of a deleted key is in our opinion not possible or very unlikely.

The researchers believe that the solution can be implemented in a firmware update and wouldn’t degrade performance for most devices. Devices that don’t have enough computing power can still encrypt Wi-Fi passwords, authentication tokens, and other data. That alternative isn’t as effective as encrypting the entire user partition, but it would still make data extraction much harder and more costly.

Encrypting the user data partition or sensitive data on it requires some accommodations for protecting the encryption key without hindering usability, Guevara Noubir, co-author of the research paper, said in an email. For smartphones, encryption keys are protected with a PIN or password. But IoT devices like the Echo Dot are expected to work after a reboot without user interaction. Technical solutions exist, but they require some level of design and implementation effort.

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/no-soldering-01.jpeg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/no-soldering-01.jpeg)
For devices that aren't reset, a simple process called in-system-programming will dump NAND contents. The researchers reverse-engineered the signal traces and testpads. That allowed them to access the eMMC flash. The needles allow memory to be dumped in less than 5 minutes.

For devices that aren't reset, a simple process called in-system-programming will dump NAND contents. The researchers reverse-engineered the signal traces and testpads. That allowed them to access the eMMC flash. The needles allow memory to be dumped in less than 5 minutes.

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/no-solder-02.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/no-solder-02.jpg)
Another image of the solderless ISP method.

Another image of the solderless ISP method.

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/chip-off1-640x480.jpeg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/chip-off1.jpeg)
The chip-off method here involves desoldering the eMCP chip. After extracting the contents, the researchers reball the chip and resolder it. The process allowed the researchers to access the raw NAND test pads. It takes about 30 minutes.

The chip-off method here involves desoldering the eMCP chip. After extracting the contents, the researchers reball the chip and resolder it. The process allowed the researchers to access the raw NAND test pads. It takes about 30 minutes.

Another image of the solderless ISP method.

The chip-off method here involves desoldering the eMCP chip. After extracting the contents, the researchers reball the chip and resolder it. The process allowed the researchers to access the raw NAND test pads. It takes about 30 minutes.

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/adversary-model-1-300x169.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/adversary-model-1.jpg)

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/wear-leveling-properties-1-300x169.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/wear-leveling-properties-1.jpg)

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/07/case-study-300x169.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2021/07/case-study.jpg)

## Amazon responds (sort of)

Asked if Amazon was aware of the findings or disagreed with them, a company spokeswoman wrote, “The security of our devices is a top priority. We recommend customers deregister and factory reset their devices before reselling, recycling, or disposing of them. It is not possible to access Amazon account passwords or payment card information because that data is not stored on the device.”

On background, she also noted points the researchers already made, specifically that:

* The company is working on mitigations
* The attacks require the attacker to have physical possession of a device and specialized training
* For devices that are successfully reset while connected to the Internet, the information remaining in memory doesn’t give an adversary access to a user’s Amazon account
* Amazon wipes any data remaining on devices available through Amazon trade-ins or returns

The threats demonstrated in the research most likely apply to Fire TV, Fire Tablets, and other Amazon devices, though the researchers didn’t test them. The results are also likely to apply to many other NAND-based devices that don’t encrypt user data, including the Google Home Mini.

Giese said that he believes Amazon is working on ways to better secure the data on the devices it manufactures. Until then, truly paranoid users who have no further use for their devices have little option than to physically destroy the NAND chip inside. For the rest, it’s important to perform a factory reset while the device is connected to the Wi-Fi access point where it was provisioned.

Giese said that resets don’t always work as expected, in part because it’s hard to differentiate between a Wi-Fi password reset (pressing reset for 15 seconds) and a factory reset (pressing reset for at least 25 seconds). He suggested that owners verify that the device was reset. For Echos, users can do this by power-cycling the device and seeing if it connects to the Internet or enters setup mode. Owners should also double-check that the device no longer appears in the Alexa app.

“While a reset still leaves data, you make it harder to extract the information (chip-off method) and invalidate the access of the device to your Amazon account,” he said. “Generally, and for all IoT devices, it might be a good idea to rethink if reselling it is really worth it. But obviously that might not be the best thing for the environment.”

Listing image:
Getty Images

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[84 Comments](https://arstechnica.com/gadgets/2021/07/passwords-in-amazon-echo-dots-live-on-even-after-you-factory-reset-them/#comments "84 comments")

Comments

[Forum view](https://arstechnica.com/civis/threads/passwords-in-amazon-echo-dots-live-on-even-after-you-factory-reset-them.1477736/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)

[Prev story](https://arstechnica.com/cars/2021/07/general-motors-looks-to-california-for-its-next-lithium-supply/ "Go to: General Motors looks to California for its next lithium supply")

[Next story](https://arstechnica.com/cars/2021/07/tesla-has-great-quarter-delivers-more-than-200000-evs/ "Go to: Tesla has great quarter, delivers more than 200,000 EVs")

Most Read

1. [![Listing image for first story in Most Read: New York starts enforcing $15 broadband law that ISPs tried to kill](https://cdn.arstechnica.net/wp-content/uploads/2024/04/getty-network-768x432.jpg)](https://arstechnica.com/tech-policy/2025/01/new-york-starts-enforcing-15-broadband-law-that-isps-tried-to-kill/)

   1.
   [New York starts enforcing $15 broadband law that ISPs tried to kill](https://arstechnica.com/tech-policy/2025/01/new-york-starts-enforcing-15-broadband-law-that-isps-tried-to-kill/)
2. 2.
   [Mastodon’s founder cedes control, refuses to become next Musk or Zuckerberg](https://arstechnica.com/tech-policy/2025/01/mastodon-becomes-nonprofit-to-make-sure-its-never-ruined-by-billionaire-ceo/)
3. 3.
   [New Glenn to make another launch attempt early Thursday](https://arstechnica.com/space/2025/01/blue-origin-plans-second-launch-attempt-of-new-glenn-early-on-tuesday/)
4. 4.
   [Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)
5. 5.
   [Report: After many leaks, Switch 2 announcement could come “this week”](https://arstechnica.com/gaming/2025/01/report-after-many-leaks-switch-2-announcement-could-come-this-week/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)


