```
CVE-2021-37748: Grandstream HT801 ATA remote stack overflow.
```

**Root cause of vulnerability**:
- A stack-based buffer overflow vulnerability exists in the `gs_config` binary due to the use of `strcpy` without bounds checking when handling the `manage_if` configuration parameter. The `manage_if` value is retrieved from nvram using `nvram_get` and copied into a local buffer on the stack using `strcpy` without validating its length. When a user enters the config submenu, and sets a large string to `manage_if`, then exits the config submenu and calls status, the stack buffer overflows.

**Weaknesses/vulnerabilities present**:
- Stack-based buffer overflow: A fixed-size buffer on the stack is overflowed when a long string is provided through the `manage_if` parameter.
- Lack of bounds checking: The use of `strcpy` without any length check allows writing beyond the boundaries of the stack buffer.

**Impact of exploitation**:
- Remote Code Execution (RCE) as root: By overflowing the stack buffer, an attacker can overwrite the saved return address and redirect program execution to their shellcode, gaining control of the device with root privileges.
- Ability to bypass ASLR:  Because the heap is at a static address, attackers can place their shellcode on the heap and bypass ASLR

**Attack vectors**:
- Network: The vulnerability can be exploited remotely over Telnet or SSH, after authentication with default credentials ("admin:admin").
- Configuration shell: The attack is performed by sending a long string as the value of `manage_if` through the configuration shell's interface, then exiting that interface and executing a command like status which causes the overflow.

**Required attacker capabilities/position**:
- Network access to the device's Telnet or SSH service, also using default credentials or compromised credentials
- Ability to send commands to the device's configuration shell.
- The attacker must have authenticated access to the device using valid user credentials.

**Additional notes:**
- The provided exploit utilizes a two-stage shellcode approach to bypass ASLR:
    - Stage 1: Leaks the address of `puts()` from memory, calculating the addresses of `system()` and "/bin/sh\0".
    - Stage 2: Uses the leaked address to execute `system('/bin/sh')`.
- The exploit mitigates bad characters (null bytes and 0xff telnet IAC byte) to ensure proper execution.
- Exploit is tested and validated for firmware versions `1.0.27.2` and `1.0.25.5`.
```