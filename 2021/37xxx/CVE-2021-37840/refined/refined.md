The content is related to CVE-2021-37840.

**Root cause of vulnerability:**
The vulnerability is due to a lack of origin validation in aaPanel's WebSocket implementation when establishing SSH connections. This allows a cross-site WebSocket hijacking (CSWH) attack.

**Weaknesses/vulnerabilities present:**
- Cross-Site WebSocket Hijacking (CSWH)
- Lack of origin validation for WebSocket connections

**Impact of exploitation:**
- Remote code execution on managed instances of aaPanel servers.
- An attacker can execute arbitrary commands on the victim's aaPanel server.

**Attack vectors:**
- The attacker needs to lure a logged-in aaPanel user to a malicious website.
- The malicious website initiates a WebSocket connection to the aaPanel server.

**Required attacker capabilities/position:**
- Knowledge of the target aaPanel's IP address or FQDN.
- Ability to host a malicious website.
- The victim must be logged into aaPanel and have configured at least one host in the "Terminal" section.
- The attack is successful when using Firefox browser; Chrome is not vulnerable.