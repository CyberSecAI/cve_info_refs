The provided content is related to CVE-2021-37791.

**Root cause of vulnerability:**
The vulnerability stems from an insecure implementation where the `userCode` parameter, which should be extracted from the authentication token, is instead accepted as a parameter in the API request `/api/user/userData`. This allows an attacker to directly manipulate the `userCode` value in the request, leading to unauthorized access to user data.

**Weaknesses/vulnerabilities present:**
- **Ultra vires vulnerability:** The system fails to validate if the user has the right to access the information associated with the provided userCode.
- **Insecure direct object reference:** The `userCode` is directly exposed in the URL, enabling an attacker to modify it.
- **Improper authorization:** The system relies on the passed `userCode` parameter rather than the one in the authentication token for authorization.

**Impact of exploitation:**
An attacker can exploit this vulnerability to view and possibly manipulate the data of other users by changing the `userCode` parameter in the API request. This leads to unauthorized access to sensitive user information. In the example provided, a user logged in as 'user1' can access the data for the 'admin' user.

**Attack vectors:**
- Manipulating the `userCode` parameter in a GET request to the `/api/user/userData` endpoint.

**Required attacker capabilities/position:**
- The attacker must be logged in to the application.
- The attacker needs to know the vulnerable API endpoint and parameter (`/api/user/userData?userCode=`).
- The attacker needs to be able to craft an HTTP request and manipulate parameters.