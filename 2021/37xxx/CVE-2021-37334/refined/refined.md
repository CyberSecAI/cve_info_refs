The provided content relates to CVE-2021-37334.

**Root Cause:** A vulnerability exists in the file upload functionality of Umbraco Forms. This vulnerability is present in all versions of Umbraco Forms from v4.0.0 and up, and partially exists in Contour 3 (predecessor to Umbraco Forms). The vulnerability stems from how the application handles file paths, specifically when a file upload field is used in a form.

**Weaknesses/Vulnerabilities:**
*   **Remote Code Execution (RCE):** The vulnerability can lead to remote code execution.
*   **Arbitrary File Deletion:** The vulnerability can also lead to arbitrary file deletion.
*   **Insecure File Path Handling:** The application does not properly handle file paths, allowing for manipulation.

**Impact of Exploitation:**
*   Attackers could execute arbitrary code on the server.
*   Attackers could delete files on the server.
*   These actions could lead to a compromise of the web server and sensitive data, as well as disruption of service.

**Attack Vectors:**
*   The vulnerability is triggered through the file upload field in Umbraco Forms.
*   Specifically, this is related to the file path handling within Umbraco Forms and Contour.
*   Exploitation is possible if a form contains an upload field.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be able to submit data to a form that contains a file upload field.
*   The attacker needs to be able to manipulate the file upload process to exploit the vulnerability.
*   No specific user privileges are mentioned. It can be assumed that the attacker needs to be able to interact with the web application as a regular user.

**Additional Information:**
*   The vulnerability was discovered and reported by Gary Oâ€™Leary-Steele from AppCheck.
*   Patches have been released for Umbraco Forms (versions 4, 6, 7, and 8) and Contour (version 3.0.32).
*   Umbraco Cloud sites are automatically patched.
*   The issue was found in how Umbraco Forms handles the separator when splitting the encrypted file path. Specifically, the separator used was `/` which can be manipulated by a user.
*   The fix involves changing the file name split in the file upload view to use a custom separator instead of just `/`.