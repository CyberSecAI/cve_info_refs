Based on the provided content, here's an analysis of CVE-2021-37156:

**CVE Description:** User sessions not reset after activation of two-factor authentication.

**Root Cause of Vulnerability:** The vulnerability stems from a failure to properly reset user sessions after a user enables two-factor authentication (2FA).

**Weaknesses/Vulnerabilities Present:**
- The core weakness is that existing user sessions remain valid even after 2FA is enabled for the account.

**Impact of Exploitation:**
- If an attacker has a valid session token for a user, and that user later enables 2FA, the attacker's existing session remains valid. This bypasses the additional security of 2FA, allowing the attacker to potentially maintain unauthorized access to the user's account.

**Attack Vectors:**
- An attacker needs to have an active session (obtained prior to the victim enabling 2FA)

**Required Attacker Capabilities/Position:**
- The attacker must have a valid session (e.g., via session hijacking, cookie theft or other means) before the user enables 2FA.

**Affected Versions:** Redmine versions 4.2.0 and 4.2.1 are vulnerable.

**Fixed Versions:** This issue is resolved in Redmine version 4.2.2.