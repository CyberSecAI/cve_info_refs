=== Content from discuss.elastic.co_2002592b_20250114_220928.html ===


[Discuss the Elastic Stack](/)

# [APM Java Agent Security Update](/t/apm-java-agent-security-update/289627)

[Announcements](/c/announcements/security-announcements/31)

[Security Announcements](/c/announcements/security-announcements/31)

[douglasday](https://discuss.elastic.co/u/douglasday)
(Douglas Day)

November 18, 2021, 5:41pm

1

**APM Java Agent Local Privilege Escalation issue (ESA-2021-29)**

A local privilege escalation issue was found with the APM Java agent, where a user on the system could attach a malicious file to an application running with the APM Java agent. Using this vector, a malicious or compromised user account could use the agent to run commands at a higher level of permissions than they possess.

This vulnerability affects users that have set up the agent via the [attacher cli](https://www.elastic.co/guide/en/apm/agent/java/current/setup-attach-cli.html), the [attach API](https://www.elastic.co/guide/en/apm/agent/java/current/setup-attach-api.html), as well as users that have enabled the [profiling\_inferred\_spans\_enabled](https://www.elastic.co/guide/en/apm/agent/java/current/config-profiling.html#config-profiling-inferred-spans-enabled) option.

**Affected Versions:**

Versions 1.10.0 through 1.26.0

**Solutions and Mitigations:**

Update to 1.27.0 or newer or use the unaffected [-javaagent-based installation method](https://www.elastic.co/guide/en/apm/agent/java/current/setup-javaagent.html) and disable the [profiling\_inferred\_spans\_enabled](https://www.elastic.co/guide/en/apm/agent/java/current/config-profiling.html#config-profiling-inferred-spans-enabled) option.

**CVSSv3:** 7.0 - AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H

**CVE ID:** CVE-2021-37941

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [APM Java Agent Security Update](https://discuss.elastic.co/t/apm-java-agent-security-update/291355)  [Security Announcements](/c/announcements/security-announcements/31) | 1 | 8780 | November 4, 2022 |
| [Elastic-apm-agent-1.33.0.jar flagged by security scan](https://discuss.elastic.co/t/elastic-apm-agent-1-33-0-jar-flagged-by-security-scan/326369)  [APM](/c/observability/apm/58) [java](https://discuss.elastic.co/tag/java) | 5 | 454 | March 24, 2023 |
| [CVE-2021-45105 and CVE-2020-9488 vulnerabilities with java apm agent 1.28.4](https://discuss.elastic.co/t/cve-2021-45105-and-cve-2020-9488-vulnerabilities-with-java-apm-agent-1-28-4/294766)  [APM](/c/observability/apm/58) [java](https://discuss.elastic.co/tag/java) | 4 | 1633 | February 9, 2022 |
| [Remedy for CVE-2018-8088 in elastic-apm-agent-1.21.0.jar?](https://discuss.elastic.co/t/remedy-for-cve-2018-8088-in-elastic-apm-agent-1-21-0-jar/264775)  [APM](/c/observability/apm/58) [java](https://discuss.elastic.co/tag/java) | 3 | 525 | March 12, 2021 |
| [JVM crash with JRE 7 and profiling\_inferred\_spans\_enabled](https://discuss.elastic.co/t/jvm-crash-with-jre-7-and-profiling-inferred-spans-enabled/264871)  [APM](/c/observability/apm/58) [java](https://discuss.elastic.co/tag/java) | 6 | 491 | March 16, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.elastic.co/legal/terms-of-use)
* [Privacy Policy](https://www.elastic.co/legal/privacy-policy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


