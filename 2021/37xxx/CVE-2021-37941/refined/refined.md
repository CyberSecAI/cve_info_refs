- **Root cause of vulnerability:** A local privilege escalation issue exists in the APM Java agent. A user with local access can attach a malicious file to an application running with the APM Java agent. This allows the attacker to run commands with higher privileges than their own.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the way the APM Java agent handles attached files when using the attach CLI, attach API, or with the `profiling_inferred_spans_enabled` option. This allows for the execution of arbitrary commands with the privileges of the application using the agent.
- **Impact of exploitation:** Successful exploitation leads to local privilege escalation, allowing a malicious user to execute commands with higher permissions than they possess on the system where the APM Java agent is running.
- **Attack vectors:** A local user can exploit the vulnerability by attaching a malicious file to the application using the attach CLI, attach API, or when `profiling_inferred_spans_enabled` is enabled.
- **Required attacker capabilities/position:** The attacker needs local access to the system where the vulnerable APM Java agent is running and the ability to attach a malicious file to the application using the vulnerable agent configurations.