=== Content from medium.com_5cdbc723_20250114_224502.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd41b5c58e99e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40nowczj%2Fsql-injection-exists-in-the-background-of-opencart-d41b5c58e99e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40nowczj%2Fsql-injection-exists-in-the-background-of-opencart-d41b5c58e99e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# SQL injection exists in the background of OpenCart

[![Extrader](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*TJP-TgdUfZ8v1Va6)](/%40nowczj?source=post_page---byline--d41b5c58e99e--------------------------------)

[Extrader](/%40nowczj?source=post_page---byline--d41b5c58e99e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc15f4a40e53&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40nowczj%2Fsql-injection-exists-in-the-background-of-opencart-d41b5c58e99e&user=Extrader&userId=c15f4a40e53&source=post_page-c15f4a40e53--byline--d41b5c58e99e---------------------post_header-----------)

Jul 30, 2021

--

Listen

Share

Affected version：3.0.3.7 (or < 3.0.3.7 ?)

Suppose I have obtained the admin rights of the website backend

Backstage->system->maintenance->backup/restore->restore

![]()

import file，Capture，Modify file content

![]()

Payload：INSERT INTO `opencart`.`oc\_api\_ip` (`api\_ip\_id`, `api\_id`, `ip`) VALUES (5, 5, ‘123’ or updatexml(1,concat(0x7e,(version())),0) or’’);\n

If there is no error information，We may use sql time injection to achieve the effect.

Through this loophole，We can get information in the database or read the file on the computer through LOAD\_FILE().

The vulnerability code is as follows

![]()

--

--

[![Extrader](https://miro.medium.com/v2/resize:fill:96:96/0*TJP-TgdUfZ8v1Va6)](/%40nowczj?source=post_page---post_author_info--d41b5c58e99e--------------------------------)[![Extrader](https://miro.medium.com/v2/resize:fill:128:128/0*TJP-TgdUfZ8v1Va6)](/%40nowczj?source=post_page---post_author_info--d41b5c58e99e--------------------------------)Follow[## Written by Extrader](/%40nowczj?source=post_page---post_author_info--d41b5c58e99e--------------------------------)[1 Follower](/%40nowczj/followers?source=post_page---post_author_info--d41b5c58e99e--------------------------------)·[1 Following](/%40nowczj/following?source=post_page---post_author_info--d41b5c58e99e--------------------------------)

A rookie

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----d41b5c58e99e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d41b5c58e99e--------------------------------)[About](/about?autoplay=1&source=post_page-----d41b5c58e99e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d41b5c58e99e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d41b5c58e99e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d41b5c58e99e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d41b5c58e99e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d41b5c58e99e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d41b5c58e99e--------------------------------)[Teams](/business?source=post_page-----d41b5c58e99e--------------------------------)


