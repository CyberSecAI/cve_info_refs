The provided content relates to CVE-2021-37478.

**Root cause of vulnerability:**
The root cause of all the reported SQL injection vulnerabilities is the lack of proper sanitization and validation of user-supplied input before using it in SQL queries. Specifically, several parameters like `block-order`, `id`, `products-order`, `template-properties-order`, and `children_order` are directly embedded into SQL queries without being sanitized or parameterized.

**Weaknesses/vulnerabilities present:**
The primary weakness is SQL injection due to the following:
1.  **Direct inclusion of user input in SQL queries**: The application uses string concatenation to build SQL queries, embedding user-controlled parameters directly into the query string without proper encoding or sanitization.
2.  **Lack of parameterized queries**: The application fails to use parameterized queries or prepared statements, which would prevent SQL injection by separating SQL code from user-supplied data.
3.  **Integer casting bypass:** Integer casting is used in some cases (e.g., `intval($_REQUEST['id'])`), but this can be bypassed by injecting a string like `"1 or 1=1"` which evaluates to true after the `intval` function returns `1` and the rest of the string is appended into the query.
4.  **Missing input validation**: The application does not validate the structure or contents of the `order` parameters before using them in SQL queries.

**Impact of exploitation:**
Successful exploitation of these vulnerabilities could allow an attacker to:
1.  **Data Breaches:** Access sensitive information stored in the database, such as user credentials, financial data, or other confidential content.
2.  **Data Modification:** Modify or delete data in the database, potentially causing data corruption, loss of functionality, or defacement of the website.
3.  **Privilege Escalation:** Potentially escalate privileges by manipulating database records to grant themselves access to administrative functions.
4.  **Arbitrary code execution**: In some database setups, SQL injection can lead to stored procedures or other database features that allow arbitrary code execution on the server, leading to complete server compromise.

**Attack vectors:**
The attack vectors for all the vulnerabilities are through HTTP requests to the `navigate.php` endpoint using the following parameters:
1.  `blocks-order`: Sending a crafted `block-order` parameter with SQL injection payload in POST request to the `blocks.php` file.
2.  `id`: Sending a crafted `id` parameter with SQL injection payload in a GET request to `items.php`, `products.php`.
3.  `products-order`: Sending a crafted `products-order` parameter in a POST request to `products.php`.
4.  `template-properties-order`: Sending a crafted `template-properties-order` parameter in a POST request to `templates.php`.
5.  `children_order`: Sending a crafted `children_order` parameter in a GET request to `structure.php`.

**Required attacker capabilities/position:**
An attacker would need the following capabilities and position:
1.  **Network Access:** The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application.
2.  **Understanding of application URLs and parameters**: The attacker needs to know the URLs and parameters that are vulnerable to SQL injection.
3.  **Basic Knowledge of SQL:** The attacker should possess basic SQL knowledge to construct valid and effective injection payloads.
4.  **No authentication required**: Some of the vulnerabilities seem to be accessible without authentication.

The detailed write-up provides more detailed information than the original CVE description, including specific vulnerable code snippets, example HTTP requests, and backend database results demonstrating successful SQL injection.