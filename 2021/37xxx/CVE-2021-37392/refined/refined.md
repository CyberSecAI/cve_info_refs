Based on the provided content, here's an analysis of the vulnerabilities in RPCMS v1.8:

**Vulnerability 1: Admin User Registration**

*   **Root Cause:** The `register` function in `system/api/Member.class.php` allows a user to set their role to 'admin' during registration by directly passing the 'role' parameter via a POST request. This bypasses the intended default of 'member' role.
*   **Weakness:** Lack of proper input validation and sanitization on the 'role' parameter during user registration.
*   **Impact:** An attacker can register a new user with administrative privileges, gaining full control of the application.
*   **Attack Vector:** Malicious user crafts a registration request with the 'role' parameter set to 'admin'.
*   **Required Capabilities:** The attacker must be able to send a POST request to the registration endpoint with the modified role.

**Vulnerability 2: Stored XSS (1)**

*   **Root Cause:** The `index` function in `system/index/Author.class.php` directly uses the user's nickname `$title` in the page's description and title without proper sanitization.
*   **Weakness:** Insufficient output encoding/escaping of user-controlled data. Specifically, the `nickname` is directly used in HTML context.
*   **Impact:** An attacker can inject malicious JavaScript into the user's nickname field, which will then execute when other users view author pages.
*   **Attack Vector:** An attacker sets their nickname to include malicious JavaScript. When the author page is rendered, the injected script will execute in the victim's browser.
*   **Required Capabilities:** The attacker needs to be a registered user and needs to update their nickname with malicious code through update profile functionality.

**Vulnerability 3: Stored XSS (2)**

*   **Root Cause:** The `post` function in `system/api/Member.class.php` allows users to update their profile, including their nickname, via API without sanitizing the input. This mirrors the issue found in `updatePsw` function.
*   **Weakness:**  Lack of sanitization of user input when updating nickname via API.
*   **Impact:** Similar to vulnerability 2, an attacker can inject malicious JavaScript in their nickname, leading to stored XSS when other users access the author page.
*   **Attack Vector:** Attacker updates their profile via API call, including malicious javascript in the nickname field.
*   **Required Capabilities:** The attacker needs to be a registered user with API access.

In summary, the vulnerabilities include insecure user registration allowing admin role assignment, and two stored XSS vulnerabilities due to improper sanitization of the user's nickname in different contexts. The XSS vulnerabilities allow execution of arbitrary javascript when author pages are visited. The admin user registration vulnerability allows privilege escalation and full access to the application.