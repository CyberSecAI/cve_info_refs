=== Content from kb.juniper.net_4c3c2588_20250114_183049.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from www.juniper.net_7baba997_20250114_183051.html ===


X

![](https://junipernetworks.allegiancetech.com/surveys/images/MRVCXM/juniper_logo.jpg)

Help us improve your experience.

Let us know what you think.

Do you have time for a two-minute survey?

Yes

Maybe Later

Back

* [Products & Services](/us/en/products-services/)
  + [Products & Services](/us/en/products-services/)
  + - [Products](/us/en/products-services/)

      + - [Application Management & Orchestration](/us/en/products-services/application-management-orchestration/)
        - [Identity and Policy Control](/us/en/products-services/ipc/)
        - [Network Edge Services](/us/en/products-services/network-edge-services/)
        - [Network Management](/us/en/products-services/network-management/)
        - [Network Operating System](/us/en/products-services/nos/)
        - [Packet Optical](/us/en/products-services/packet-optical/)
      + - [Routers](/us/en/products-services/routing/)
        - [Security](/us/en/products-services/security/)
        - [Software Defined Networking](/us/en/products-services/sdn/)
        - [Switches](/us/en/products-services/switching/)
        - [Wireless](/us/en/products-services/wireless/)* + [All Products A-Z](/us/en/products-services/a-z/)
        + [End of Life](https://www.juniper.net/support/eol/)
  + - [Solutions](/us/en/solutions/)
    - [Services](/us/en/products-services/services/technical-services/)
    - [TechLibrary](http://www.juniper.net/documentation/)
* [Support](https://www.juniper.net/customers/support/)
  + [Support](https://www.juniper.net/customers/support/)
  + [MyJuniper](https://my.juniper.net/saml/login?idp=https://iam-fed.juniper.net/fed/idp)
    Case Management
    - Cases/RMAs
      * [Your Open Cases](https://www.juniper.net/casemanager/)
      * [Your Open RMAs](https://www.juniper.net/casemanager/#/rmas)
      * [Create a Case/RMA](https://www.juniper.net/casemanager/#/create)
    - Managing
      * [Contact Support](http://www.juniper.net/support/requesting-support.html)
      * [Product Warranty](http://www.juniper.net/support/warranty/)
  + Downloads & Docs
    - Platforms
      * [Junos](http://www.juniper.net/support/downloads/group/?f=junos)
      * [ScreenOS](http://www.juniper.net/support/downloads/screenos.html)
      * [Junos Space](https://www.juniper.net/support/downloads/space.html)
      * [All Downloads](http://www.juniper.net/support/downloads/)
    - Documentation
      * [TechLibrary](http://www.juniper.net/documentation/)
      * [Pathfinder](http://pathfinder.juniper.net/home/)
    - Troubleshooting
      * [Knowledge Base](//kb.juniper.net/)
      * [Service Now](http://www.juniper.net/support/downloads/serviceautomation/)
      * [Service Insight](/us/en/products-services/network-management/junos-space-applications/service-insight/)
      * [Problem Report Search](https://prsearch.juniper.net/)
  + Contracts & Licenses
    - Contracts/Products
      * [Register New Product](https://www.juniper.net/svcreg/SRegSerialNum.jsp)
      * [Serial Number Entitlement](https://entitlementsearch.juniper.net/entitlementsearch/)
      * [Search Contracts/Products](https://my.juniper.net/)
      * [Order Status](https://www.juniper.net/ost/)
    - Licenses
      * [Generate Product Licenses](https://www.juniper.net/lcrs/license.do)
      * [Find License Keys](https://www.juniper.net/lcrs/license.do?tab2)
    - Security
      * [Security Intelligence](/us/en/security/)
      * [Report a Vulnerability](http://www.juniper.net/support/security/report_vulnerability.html)
* [Training](/us/en/training/)
  + [Training](/us/en/training/)
  + [Training](/us/en/training/)
    - [Courses](https://learningportal.juniper.net/juniper/user_courses.aspx)
    - [Schedule of Classes](https://learningportal.juniper.net/juniper/user_activity_info.aspx?id=10735)
    - [On-Demand Courses](https://learningportal.juniper.net/juniper/user_activity_info.aspx?id=10072)
    - [Learning Paths](https://learningportal.juniper.net/juniper/user_activity_info.aspx?id=5357)
    - [Getting Started](https://learningportal.juniper.net/juniper/user_activity_info.aspx?id=5798)
    - [Learning Bytes](https://learningportal.juniper.net/juniper/user_activity_info.aspx?id=5853)
  + [Certification](/us/en/training/certification/)
    - [Getting Started](/us/en/training/certification/getting-started/)
    - [Exam Registration](/us/en/training/certification/exam_registration.page)
    - [Juniper Open Learning](/us/en/training/open-learning/)
  + [Academic Alliance](/us/en/training/academicalliance/)
* [How to Buy](/us/en/how-to-buy/)
  + [How to Buy](/us/en/how-to-buy/)
  + - [Contact Sales](/us/en/how-to-buy/form/)
    - [Request a Quote](/us/en/how-to-buy/request-a-quote.page)
    - [Buy from a Local Partner](/us/en/partners/locator/)
    - [Find a Sales Office](/us/en/how-to-buy/contacts/)
    - [All Buying Options](/us/en/how-to-buy/)
* [About Juniper](/us/en/company/)
* [Partners](/us/en/partners/)
* [Community](/us/en/community/social/)

[# TechLibrary](/documentation/index.html)

[Navigation](#/)

* [CLI Explorer](https://apps.juniper.net/cli-explorer/)
* [Compliance Advisor](https://apps.juniper.net/compliance/)
* [Documentation Archives](https://www.juniper.net/documentation/hardware/eol.html)
* [Documentation Help](/documentation/en_US/internal/information-products/pathway-pages/using-the-technical-documentation.html)
* [Enterprise MIBs](https://apps.juniper.net/mib-explorer/)
* [Feature Explorer](https://apps.juniper.net/feature-explorer/)
* [Glossary](https://www.juniper.net/documentation/en_US/release-independent/glossary/index.html)
* [Hardware Compatibility Tool](https://apps.juniper.net/hct/category/)
* [Junos XML API Explorer](https://apps.juniper.net/xmlapi/)
* [Pathfinder](https://apps.juniper.net/home)
* [Portable Libraries](https://www.juniper.net/documentation/resources/index.html)
* [SNMP MIB Explorer](https://apps.juniper.net/mib-explorer/)
* [System Log Explorer](https://apps.juniper.net/syslog-explorer/)

Table of Contents
Guide That Contains This Content

[+] Expand All [-] Collapse All

[Home](http://www.juniper.net/) > [Support](http://www.juniper.net/support/) > [Technical Documentation](/documentation/) > [Junos OS](/documentation/en_US/release-independent/junos/information-products/pathway-pages/junos/product/index.html)
>
Monitoring Network Traffic Flow on PTX Series Routers Using
Inline Flow Monitoring
**Rate and give feedback:**
**Feedback Received. Thank You!**

**Rate and give feedback:**

X

This document helped resolve my issue

Yes

No

Additional Comments

800 characters remaining

May we contact you if necessary?

Name:
E-mail:
Enter a valid Email ID

Need product
assistance? Contact [Juniper Support](http://www.juniper.net/support/requesting-support.html)
Submit

This site is protected by hCaptcha and its
[Privacy Policy](https://hcaptcha.com/privacy) and
[Terms of Service](https://hcaptcha.com/terms) apply.

![Submitting...](/shared/img/global/ajax-loader.gif)

Â
## Related Documentation

* EX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* M Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* MX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* PTX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* [Configuring Flow Aggregation to Use IPFIX Flow Templates on PTX Series Routers](services-ipfix-flow-template-flow-aggregation-configuring-ptx.html)
* [Configuring Flow Aggregation on PTX Series Routers to Use Version 9 Flow Templates](services-version9-flow-template-flow-aggregation-configuring-ptx.html)
* QFX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* SRX Series
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* T Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
Â
# Monitoring Network Traffic Flow on PTX Series Routers Using Inline Flow Monitoring

This topic describe how to configure inline flow monitoring
so that you can use it to monitor your network traffic flow. This
procedure applies to PTX3000 and PTX5000 routers that have third-generation
FPCs installed, PTX10008 and the PTX1000 routers.

|  | **Note:**PTX1000 does not support version 9 flow templates. |
| --- | --- |

Inline flow monitoring is implemented on the Logical CPU (LCPU).
All the functions like flow creation, flow update, and flow records
export are done by the LCPU. The flow records are sent out in either
the IPFIX format or the version 9 format.

The inline flow monitoring configuration can be broadly
classified into the following categories:

* Configurations at the [edit services flow-monitoring
  version-ipfix template] or [edit services flow-monitoring
  version9 template] hierarchy levelâAt this level, you
  configure the template properties for inline flow monitoring.
* Configurations at the [edit forwarding-options sampling
  instance] hierarchy levelâAt this level, you configure
  a sampling instance and associate the template to the sampling instance.
  At this level, you also configure the flow-server IP address and port
  number as well as the autonomous system type.
* Configurations at the [edit chassis fpc] hierarchy
  levelâAt this level, you associate the sampling instance with
  the FPC on which the media interface is present.
* Configurations at the [edit firewall] hierarchy
  levelâAt this level you configure a firewall filter for the
  family of traffic to be sampled. You must attach this filter to the
  interface on which you want to sample the traffic.

To configure inline flow monitoring on PTX Series routers:

1. Enable inline flow monitoring and specify the source address.[edit forwarding-options sampling instance *instance-name* family inet output flow-server]user@host# **set inline-jflow source address *source Ip address***
2. Specify an output format:
   * To specify the IPFIX output format:[edit forwarding-options sampling instance *instance-name* family inet output flow-server *Ip address*]user@host# **set version-ipfix template ipv4-template**
   * To specify the version 9 output format:[edit forwarding-options sampling instance *instance-name* family inet output flow-server *Ip address*]user@host# **set version9 template ipv4-template**
3. Specify the output properties:
   * To specify the properties for IPFIX:[edit services flow-monitoring]user@host# **set version-ipfix**

     The output format properties are common to other output formats
     and are described in â[Configuring Flow Aggregation to Use IPFIX Flow Templates on PTX Series Routers](services-ipfix-flow-template-flow-aggregation-configuring-ptx.html)â.
   * To specify the properties for version 9:[edit services flow-monitoring]user@host# **set version9**

     The output format properties are common to other output formats
     and are described in â[Configuring Flow Aggregation on PTX Series Routers to Use Version 9 Flow Templates](services-version9-flow-template-flow-aggregation-configuring-ptx.html)â.

The following is an example of the sampling configuration for
an instance that supports inline flow monitoring on family inet and on family inet6:

[edit forwarding-options]sampling {instance {sample-ins1 {input {rate 1;}family inet {output {flow-server 2.2.2.2 {port 2055;version-ipfix {template {ipv4;}}}inline-jflow {source-address 10.11.12.13;}}}family inet6 {output {flow-server 2.2.2.2 {port 2055;version-ipfix {template {ipv6;}}}interface sp-0/1/0 {source-address 10.11.12.13;}}}}}}

The following example shows the output format configuration:

services {flow-monitoring {version-ipfix {template ipv4 {flow-active-timeout 60;flow-inactive-timeout 60;ipv4-template;template-refresh-rate {packets 1000;seconds 10;}option-refresh-rate {packets 1000;seconds 10;}}}}}

The following limitations and restrictions apply to the
inline active flow monitoring feature in Junos OS:

* Flow records and templates cannot be exported if the flow
  collector is reachable through any management interface.
* The flow collector should be reachable through the default
  routing table (inet.0 or inet6.0). If the flow collector is reachable
  through a non-default VPN routing and forwarding table (VRF), flow
  records and templates cannot be exported.

Â
## Related Documentation

* EX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* M Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* MX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* PTX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* [Configuring Flow Aggregation to Use IPFIX Flow Templates on PTX Series Routers](services-ipfix-flow-template-flow-aggregation-configuring-ptx.html)
* [Configuring Flow Aggregation on PTX Series Routers to Use Version 9 Flow Templates](services-version9-flow-template-flow-aggregation-configuring-ptx.html)
* QFX Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* SRX Series
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
* T Series
* [version-ipfix (Services)](../../reference/configuration-statement/version-ipfix-edit-services.html)
* [version-ipfix (Forwarding Options)](../../reference/configuration-statement/version-ipfix-edit-forwarding-options.html)
* [version9 (Flow Monitoring)](../../reference/configuration-statement/version9-edit-services.html)
* [version9 (Forwarding Options)](../../reference/configuration-statement/version9-edit-forwarding-options.html)
Â
#### Modified: 2018-01-31

* [Solutions](/us/en/solutions/)
* [About Juniper](/us/en/company/)
* [Partners](/us/en/partners/)
* [Community](/us/en/community/social/)

* + [Request a Quote](/us/en/how-to-buy/request-a-quote.page "Request a Quote")
  + [How to Buy](/us/en/how-to-buy/ "How to Buy")
  + [Feedback](https://www.juniper.net/us/en/feedback/ "Feedback")
  + [Contact Us](/us/en/contact-us/ "Contact Us")
* + [Careers](/us/en/company/careers/ "Careers")
  + [Image Library](/us/en/company/press-center/images/ "Image Library")
  + [RSS Feeds](http://rss.juniper.net/ "RSS Feeds")
  + [Corporate Responsibility](/us/en/company/corporate-responsibility/ "Corporate Responsibility")
* + [Privacy Policy](/us/en/privacy-policy/ "Privacy Policy")
  + [Legal Notices](/us/en/legal-notices/ "Legal Notices")
  + [Insights](/us/en/insights/ "Insights")
  + [Site Map](/us/en/site-map/ "Site Map")
* + [jnpr-social-icon](https://www.facebook.com/JuniperNetworks/)
  + [jnpr-social-icon](https://twitter.com/JuniperNetworks/)
  + [jnpr-social-icon](https://www.youtube.com/junipernetworks)
  + [jnpr-social-icon](https://www.linkedin.com/company/juniper-networks)
  + [jnpr-social-icon](http://forums.juniper.net/)
* + United States
    Deutschland - Germany
    France
    United Kingdom
    ä¸­å½ - China
    æ¥æ¬ - Japan
    ëíë¯¼êµ­ - Korea

  © 1999 - 2018 Juniper Networks, Inc. All rights reserved

![](/documentation/en_US/design-and-architecture/assets/img/content-types/png/round-arrow.png)
Previous Page
Next Page


