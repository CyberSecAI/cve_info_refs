=== Content from www.wordfence.com_149b0681_20250114_204933.html ===


![Post title on background showing flames](https://www.wordfence.com/wp-content/uploads/2021/10/vulnerability-in-hashthemes-plugin-allows-site-deletion.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

October 26, 2021

# Site Deletion Vulnerability in Hashthemes Plugin

*Update: a previous version of this article incorrectly indicated that this vulnerability could be used for site takeover, we have updated this for accuracy, as the impact is instead complete loss of site content.*

*Note: To receive disclosures like this in your inbox the moment they’re published, you can subscribe to our* [*WordPress Security Mailing List*](https://www.wordfence.com/subscribe-to-the-wordfence-email-list/)*.*

On August 25, 2021, the Wordfence Threat Intelligence team initiated the disclosure process for a vulnerability in [Hashthemes Demo Importer](http://wordpress.org/plugins/hashthemes-demo-importer/), a WordPress plugin with over 7,000 installations.

This vulnerability allowed any authenticated user to completely reset a site, permanently deleting nearly all database content as well as all uploaded media.

As we did not receive a response from the developer for nearly a month, we contacted the WordPress plugins team with our disclosure on September 20, 2021. The plugin was temporarily removed from the repository the same day, and a patched version, 1.1.2, was made available on September 24, 2021, though it was not mentioned in the developer changelog.

Wordfence Premium customers received a firewall rule protecting against this vulnerability on August 25, 2021. Sites running the free version of Wordfence received the same rule 30 days later, on September 24, 2021.

---

**Description:** Improper Access Control allowing content deletion

**Affected Plugin:** Hashthemes Demo Importer

**Plugin Slug:** hashthemes-demo-importer

**Plugin Vendor:** Hashthemes

**Affected Versions:** <= 1.1.1

**CVE ID:** CVE-2021-39333

**CVSS Score:** 8.1(High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H)

**Researcher/s:** Ramuel Gall

The Hashthemes demo importer plugin failed to perform capability checks for many of its AJAX actions. While it did perform a nonce check, the AJAX nonce was visible in the admin dashboard for all users, including low-privileged users such as subscribers. The most severe consequence of this was that a subscriber-level user could reset all of the content on a given site.

Any logged-in user could trigger the `hdi_install_demo` AJAX function and provide a `reset` parameter set to `true`, resulting in the plugin running it’s `database_reset` function. This function wiped the database by truncating every database table on the site except for `wp_options`, `wp_users`, and `wp_usermeta`. Once the database was wiped, the plugin would then run its clear\_uploads function, which deleted every file and folder in `wp-content/uploads`.

## Timeline

**August 25, 2021** – Wordfence Threat Intelligence finishes our investigation and attempts to initiate disclosure for a vulnerability in HashThemes Demo Importer. We release a firewall rule to Wordfence Premium customers.

**September 20, 2021** – We contact the WordPress plugins team as we have not received a response from the plugin developer. The plugin is temporarily removed from the WordPress.org repository.

**September 24, 2021** – A patched version of the plugin, 1.1.2, becomes available. The firewall rule becomes available to free Wordfence users.

## Conclusion

In today’s post, we discussed a vulnerability in HashThemes Demo Importer that allowed any logged-in user to completely and permanently destroy all of the content on a website.

We’ve discussed [the importance of backups](https://www.wordfence.com/blog/2017/06/wordpress-backups/) in the past, and this vulnerability serves as an important reminder of how critical backups are to your site’s security. While most vulnerabilities can have destructive effects, it would be impossible to recover a site where this vulnerability was exploited unless it had been backed up.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20211025&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users have been protected against this vulnerability since August 25, 2021, while those still running the free version of Wordfence have been protected since September 24, 2021. If you are running a vulnerable version of this plugin, we urge you to update to the latest version available, 1.1.4, as soon as possible.

If you know a friend or colleague who is using this plugin on their site, please forward this advisory to them to help keep their sites protected as this vulnerability can lead to complete loss of site content.

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fsite-deletion-vulnerability-in-hashthemes-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fsite-deletion-vulnerability-in-hashthemes-plugin%2F&text=Site%20Deletion%20Vulnerability%20in%20Hashthemes%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fsite-deletion-vulnerability-in-hashthemes-plugin%2F)

## Comments

6 Comments

* ![](https://secure.gravatar.com/avatar/d9a09c92b16e6fe8a9da7dee8644ab70?s=96&d=mm&r=g)
  Marek
  October 26, 2021
   7:45 am

  This is only to say how grateful I feel for you for making the net safer. Many thanks
* ![](https://secure.gravatar.com/avatar/b17975a56811c26c5c5d81fcd113674a?s=96&d=mm&r=g)
  Jhorman Duban Rodriguez Pulgarin
  October 26, 2021
   8:08 am

  It is not clear to me if the plugin allows any unauthenticated or any logged-in user to wipe date. This article reads: "This vulnerability allowed any authenticated user to completely reset a site, permanently deleting nearly all database content as well as all uploaded media." and then in the conclusion, it reads: "In today’s post, we discussed a vulnerability in HashThemes Demo Importer that allowed any logged-in user to completely and permanently destroy all of the content on a website.

  "

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  October 26, 2021
   8:47 am

  Hi,
+ ![](https://secure.gravatar.com/avatar/44ee38993e06a42928482fc9fa4341a7?s=96&d=mm&r=g)
  Sachin Palewar
  October 26, 2021
   11:22 pm

  Hi @Jhorman, Just to go into more details. It means any user so for example on a simple Wordpress sites, you have have users with just subscriber access. Those are just your readers of blogs, even they will be able to do it so basically it doesn't mean authenticated users limit anyone. As most websites have certain roles which are really available to anyone who signs-up. With Woocommerce websites, it can be even serious as all the buyers, when they sign-up, get the customer role assigned to them. You can even register as a customer without even buying anything. So basically anyone who knows about it, just have to create an account with no special access and destroy your site.

  Thanks to Wordfence team for responsibly disclosing this and then ensuring that it's patched for everyone. I am not associated with Wordfence in anyway :-)

* ![](https://secure.gravatar.com/avatar/ac3b4e1a9d37764fba351087301f102b?s=96&d=mm&r=g)
  Serghyo
  October 27, 2021
   6:44 am

  Hi, why is the severity of this authenticated vulnerability so high?

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  October 27, 2021
   7:07 am

  Hi Serghyo,

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


