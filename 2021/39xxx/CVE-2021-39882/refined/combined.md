=== Content from gitlab.com_10883ac2_20250114_220535.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39882.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39882.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39882.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39882.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Oct 01, 2021

  [c67fb856](/gitlab-org/cves/-/commit/c67fb856fd83ba885a80fcf3fff2f0bb175de83b)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c67fb856fd83ba885a80fcf3fff2f0bb175de83b)
  繚
  c67fb856

  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

  c67fb856

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c67fb856fd83ba885a80fcf3fff2f0bb175de83b)
  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

Loading



=== Content from gitlab.com_6ee727b1_20250114_220535.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Anonymous user can enumerate all users through `/api/v4/users/:id`

## Background

An anonymous user can currently use the API to retrieve information about any GitLab user by either ID or username:

* Anonymous users CANNOT use the [API endpoint to list all users](https://docs.gitlab.com/ee/api/users.html#list-users). An anonymous request returns 403 Forbidden unless there is a `username` parameter. That is deliberate. From [20f679d6](https://gitlab.com/gitlab-org/gitlab/-/commit/20f679d620380b5b5e662b790c76caf256867b01 "Allow unauthenticated access to the `/api/v4/users` API."): "The issue filtering frontend code needs access to this [username] API for non-logged-in users + public projects.")
* Anonymous users CAN use the [API endpoint to get a single user by numeric ID](https://docs.gitlab.com/ee/api/users.html#single-user). An anonymous request returns 200 OK with the user's information. This may not be deliberate.

## Problem to solve

Anonymous users can enumerate GitLab users through the [API endpoint to get a single user](https://docs.gitlab.com/ee/api/users.html#single-user) (`/api/v4/users/:id`), because the `:id` values are numeric and sequential. It seems this shouldn't be allowed in general, and also seems different from our treatment of the [API endpoint to list all users](https://docs.gitlab.com/ee/api/users.html#list-users) specifically.

## Proposal

Anonymous users should not be able to get user information by ID.

Note: This proposal is only feasible if there is no frontend dependency (like there is with `username` lookup).

Since same attack is applicable for `/api/v4/users/:id/followers` and `/api/v4/users/:id/following` we should require authentication for those endpoints too.

## Out of scope

The [API endpoint to "lookup users by username"](https://docs.gitlab.com/ee/api/users.html#for-normal-users) should not be changed, because the frontend relies on this endpoint for anonymous users, and this endpoint is not as vulnerable to enumeration.

## Related links

* This problem was noticed in <https://gitlab.com/gitlab-org/gitlab/-/issues/288853>.

Edited Sep 02, 2021 by [Pavel Shutsin](/pshutsin)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


