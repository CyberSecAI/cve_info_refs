=== Content from github.com_73d2def3_20250115_094528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fdiscussions%2F507)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fdiscussions%2F507)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fdiscussions_fragments%2Fdiscussion_layout&source=header-repo&source_repo=BetterErrors%2Fbetter_errors)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BetterErrors](/BetterErrors)
/
**[better\_errors](/BetterErrors/better_errors)**
Public

* [Notifications](/login?return_to=%2FBetterErrors%2Fbetter_errors) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2FBetterErrors%2Fbetter_errors)
* [Star
   6.9k](/login?return_to=%2FBetterErrors%2Fbetter_errors)

* [Code](/BetterErrors/better_errors)
* [Issues
  48](/BetterErrors/better_errors/issues)
* [Pull requests
  21](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects
  0](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

Additional navigation options

* [Code](/BetterErrors/better_errors)
* [Issues](/BetterErrors/better_errors/issues)
* [Pull requests](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

# Cross-Site Request Forgery vulnerability #507

[RobinDaugherty](/RobinDaugherty)
started this conversation in
[General](/BetterErrors/better_errors/discussions/categories/general)

[Cross-Site Request Forgery vulnerability](#top)
#507

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)
RobinDaugherty](/RobinDaugherty)

Sep 6, 2021
¬∑
0 comments

[Return to top](#top)

Discussion options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

## [RobinDaugherty](/RobinDaugherty) [Sep 6, 2021](#discussion-3557930) Maintainer

 -

| Prior to release 2.8.0, better\_errors did not enforce CSRF protection and did not enforce a Content-Type header for internal requests. This left developer machines open to a cross-origin attack.  If you have any questions about this vulnerability or how we mitigated it, please ask them here or open an Issue in this repository. |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

All reactions

## Replies: 0 comments

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fdiscussions%2F507)

Category

[üí¨

General](/BetterErrors/better_errors/discussions/categories/general)

Labels

None yet

1 participant

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=48&v=4)](/RobinDaugherty)

Heading

Bold

Italic

Quote

Code

Link

---

Numbered list

Unordered list

Task list

---

Attach files

Mention

Reference

Menu

* Heading
* Bold
* Italic
* Quote
* Code
* Link
* Numbered list
* Unordered list
* Task list
* Attach files
* Mention
* Reference

# Select a reply

 Loading

  [Create a new saved reply](/settings/replies?return_to=1)

 üëç
1
  reacted with thumbs up emoji

 üëé
1
  reacted with thumbs down emoji

 üòÑ
1
  reacted with laugh emoji

 üéâ
1
  reacted with hooray emoji

 üòï
1
  reacted with confused emoji

 ‚ù§Ô∏è
1
  reacted with heart emoji

 üöÄ
1
  reacted with rocket emoji

 üëÄ
1
  reacted with eyes emoji

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_56492feb_20250115_094529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fsecurity%2Fadvisories%2FGHSA-w3j4-76qw-wwjm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fsecurity%2Fadvisories%2FGHSA-w3j4-76qw-wwjm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=BetterErrors%2Fbetter_errors)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BetterErrors](/BetterErrors)
/
**[better\_errors](/BetterErrors/better_errors)**
Public

* [Notifications](/login?return_to=%2FBetterErrors%2Fbetter_errors) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2FBetterErrors%2Fbetter_errors)
* [Star
   6.9k](/login?return_to=%2FBetterErrors%2Fbetter_errors)

* [Code](/BetterErrors/better_errors)
* [Issues
  48](/BetterErrors/better_errors/issues)
* [Pull requests
  21](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects
  0](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

Additional navigation options

* [Code](/BetterErrors/better_errors)
* [Issues](/BetterErrors/better_errors/issues)
* [Pull requests](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

# Vulnerable to Cross-Site Request Forgery in development

Moderate

[RobinDaugherty](/RobinDaugherty)
published
GHSA-w3j4-76qw-wwjm
Sep 6, 2021

## Package

bundler

better\_errors
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

< 2.8.0

## Patched versions

2.8.0

## Description

### Impact

better\_errors prior to 2.8.0 did not implement CSRF protection for its internal requests. It also did not enforce the correct "Content-Type" header for these requests, which allowed a cross-origin "simple request" to be made without CORS protection. These together left an application with better\_errors enabled open to cross-origin attacks.

*As a developer tool, better\_errors documentation strongly recommends addition only to the `development` bundle group, so this vulnerability should only affect development environments. Please ensure that your project limits better\_errors to the `development` group (or the non-Rails equivalent).*

### Patches

Starting with release 2.8.x, CSRF protection is enforced. It is recommended that you upgrade to the latest release, or minimally to "~> 2.8.3".

### Workarounds

There are no known workarounds to mitigate the risk of using older releases of better\_errors.

### References

* Chris Moberly provided [an example attack that uses a now-patched vulnerability of webpack-dev-server in conjunction with Better Errors](https://about.gitlab.com/blog/2021/09/07/why-are-developers-vulnerable-to-driveby-attacks/)

### For more information

If you have any questions or comments about this advisory, please

* Add to the [discussion in better\_errors](https://github.com/BetterErrors/better_errors/discussions/507)
* Open an issue in [better\_errors](https://github.com/BetterErrors/better_errors)

### Severity

Moderate

### CVE ID

CVE-2021-39197

### Weaknesses

[CWE-352](/advisories?query=cwe%3A352)

### Credits

* [![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
  [RobinDaugherty](/RobinDaugherty)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_b60a0274_20250115_094529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fpull%2F474)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fpull%2F474)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=BetterErrors%2Fbetter_errors)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BetterErrors](/BetterErrors)
/
**[better\_errors](/BetterErrors/better_errors)**
Public

* [Notifications](/login?return_to=%2FBetterErrors%2Fbetter_errors) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2FBetterErrors%2Fbetter_errors)
* [Star
   6.9k](/login?return_to=%2FBetterErrors%2Fbetter_errors)

* [Code](/BetterErrors/better_errors)
* [Issues
  48](/BetterErrors/better_errors/issues)
* [Pull requests
  21](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects
  0](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

Additional navigation options

* [Code](/BetterErrors/better_errors)
* [Issues](/BetterErrors/better_errors/issues)
* [Pull requests](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FBetterErrors%2Fbetter_errors%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FBetterErrors%2Fbetter_errors%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add CSRF protection to internal requests #474

 Merged

[RobinDaugherty](/RobinDaugherty)
merged 4 commits into
[master](/BetterErrors/better_errors/tree/master "BetterErrors/better_errors:master")
from
[feature/add-csrf-to-requests](/BetterErrors/better_errors/tree/feature/add-csrf-to-requests "BetterErrors/better_errors:feature/add-csrf-to-requests")

Sep 15, 2020

 Merged

# [Add CSRF protection to internal requests](#top) #474

[RobinDaugherty](/RobinDaugherty)
merged 4 commits into
[master](/BetterErrors/better_errors/tree/master "BetterErrors/better_errors:master")
from
[feature/add-csrf-to-requests](/BetterErrors/better_errors/tree/feature/add-csrf-to-requests "BetterErrors/better_errors:feature/add-csrf-to-requests")

Sep 15, 2020

[Conversation
0](/BetterErrors/better_errors/pull/474)
[Commits
4](/BetterErrors/better_errors/pull/474/commits)
[Checks
0](/BetterErrors/better_errors/pull/474/checks)
[Files changed](/BetterErrors/better_errors/pull/474/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=60&v=4)](/RobinDaugherty)

Copy link

Member

### @RobinDaugherty **[RobinDaugherty](/RobinDaugherty)** commented [Sep 13, 2020](#issue-700580362)

Better Errors accepts requests from its own Javascript components in order to provide variables and evaluate console commands. These are now protected by a CSRF token that's set as a cookie when the error page is rendered.

Sorry, something went wrong.

 üëç
2
 kuahyeow and splitt3r reacted with thumbs up emoji
 ‚ù§Ô∏è
1
 dnsmichi reacted with heart emoji

All reactions

* üëç
  2 reactions
* ‚ù§Ô∏è
  1 reaction

 [![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
[RobinDaugherty](/RobinDaugherty)
[force-pushed](/BetterErrors/better_errors/compare/901f72458cfbd3fc2f160722fb306a6c09cf75d0..5fcee47d59fbd613f9515519d37100345a31e4aa)
the
feature/add-csrf-to-requests

branch
from
[`901f724`](/BetterErrors/better_errors/commit/901f72458cfbd3fc2f160722fb306a6c09cf75d0) to
[`5fcee47`](/BetterErrors/better_errors/commit/5fcee47d59fbd613f9515519d37100345a31e4aa)  [Compare](/BetterErrors/better_errors/compare/901f72458cfbd3fc2f160722fb306a6c09cf75d0..5fcee47d59fbd613f9515519d37100345a31e4aa)
[September 13, 2020 14:58](#event-3760519983)

 [RobinDaugherty](/RobinDaugherty)
added 3 commits
[September 13, 2020 11:35](#commits-pushed-617e65e)

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)

`[Add CSRF to error page and internal calls](/BetterErrors/better_errors/pull/474/commits/617e65eab750d266295e66d0c355a8ebaf6ce605 "Add CSRF to error page and internal calls")`

`[617e65e](/BetterErrors/better_errors/pull/474/commits/617e65eab750d266295e66d0c355a8ebaf6ce605)`

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)

`[Fix incorrect mime type in JSON error responses](/BetterErrors/better_errors/pull/474/commits/764bf3b20bea70006575aa6fbd94bb18cf8080ec "Fix incorrect mime type in JSON error responses")`

`[764bf3b](/BetterErrors/better_errors/pull/474/commits/764bf3b20bea70006575aa6fbd94bb18cf8080ec)`

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)

`[Work around weirdness in older Rack::Response](/BetterErrors/better_errors/pull/474/commits/ef064610db574506c6285a6daf2ab62ef406c5a8 "Work around weirdness in older Rack::Response")`

`[ef06461](/BetterErrors/better_errors/pull/474/commits/ef064610db574506c6285a6daf2ab62ef406c5a8)`

 [![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
[RobinDaugherty](/RobinDaugherty)
[force-pushed](/BetterErrors/better_errors/compare/5fcee47d59fbd613f9515519d37100345a31e4aa..ef064610db574506c6285a6daf2ab62ef406c5a8)
the
feature/add-csrf-to-requests

branch
from
[`5fcee47`](/BetterErrors/better_errors/commit/5fcee47d59fbd613f9515519d37100345a31e4aa) to
[`ef06461`](/BetterErrors/better_errors/commit/ef064610db574506c6285a6daf2ab62ef406c5a8)  [Compare](/BetterErrors/better_errors/compare/5fcee47d59fbd613f9515519d37100345a31e4aa..ef064610db574506c6285a6daf2ab62ef406c5a8)
[September 13, 2020 15:35](#event-3760549268)

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)

`[Middleware specs to cover more CSRF edge cases](/BetterErrors/better_errors/pull/474/commits/4f05b45f23277872438689d14c22fab7f03ad0b7 "Middleware specs to cover more CSRF edge cases

and refactor the specs to be more clear.")`
 ‚Ä¶

`[4f05b45](/BetterErrors/better_errors/pull/474/commits/4f05b45f23277872438689d14c22fab7f03ad0b7)`

```
and refactor the specs to be more clear.
```

 [![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
[RobinDaugherty](/RobinDaugherty)
[force-pushed](/BetterErrors/better_errors/compare/47abbd0d65fa07bbcc810effc38c27a3c1608a7e..4f05b45f23277872438689d14c22fab7f03ad0b7)
the
feature/add-csrf-to-requests

branch
from
[`47abbd0`](/BetterErrors/better_errors/commit/47abbd0d65fa07bbcc810effc38c27a3c1608a7e) to
[`4f05b45`](/BetterErrors/better_errors/commit/4f05b45f23277872438689d14c22fab7f03ad0b7)  [Compare](/BetterErrors/better_errors/compare/47abbd0d65fa07bbcc810effc38c27a3c1608a7e..4f05b45f23277872438689d14c22fab7f03ad0b7)
[September 13, 2020 17:31](#event-3760640611)

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
[RobinDaugherty](/RobinDaugherty)
merged commit [`8e8e796`](/BetterErrors/better_errors/commit/8e8e796bfbde4aa088741823c8a3fc6df2089bb0)
into
master

[Sep 15, 2020](https://github.com/BetterErrors/better_errors/pull/474#event-3769480349)

 [![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)
[RobinDaugherty](/RobinDaugherty)
deleted the
feature/add-csrf-to-requests

branch
[September 15, 2020 17:18](#event-3769480621)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fpull%2F474)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=52&v=4)](/RobinDaugherty)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_3829eedc_20250115_094527.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fcommit%2F8e8e796bfbde4aa088741823c8a3fc6df2089bb0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fcommit%2F8e8e796bfbde4aa088741823c8a3fc6df2089bb0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=BetterErrors%2Fbetter_errors)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BetterErrors](/BetterErrors)
/
**[better\_errors](/BetterErrors/better_errors)**
Public

* [Notifications](/login?return_to=%2FBetterErrors%2Fbetter_errors) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2FBetterErrors%2Fbetter_errors)
* [Star
   6.9k](/login?return_to=%2FBetterErrors%2Fbetter_errors)

* [Code](/BetterErrors/better_errors)
* [Issues
  48](/BetterErrors/better_errors/issues)
* [Pull requests
  21](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects
  0](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

Additional navigation options

* [Code](/BetterErrors/better_errors)
* [Issues](/BetterErrors/better_errors/issues)
* [Pull requests](/BetterErrors/better_errors/pulls)
* [Discussions](/BetterErrors/better_errors/discussions)
* [Actions](/BetterErrors/better_errors/actions)
* [Projects](/BetterErrors/better_errors/projects)
* [Wiki](/BetterErrors/better_errors/wiki)
* [Security](/BetterErrors/better_errors/security)
* [Insights](/BetterErrors/better_errors/pulse)

## Commit

[Permalink](/BetterErrors/better_errors/commit/8e8e796bfbde4aa088741823c8a3fc6df2089bb0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#474](https://github.com/BetterErrors/better_errors/pull/474) from BetterErrors/feature/add-csrf-to-requests

[Browse files](/BetterErrors/better_errors/tree/8e8e796bfbde4aa088741823c8a3fc6df2089bb0)
Browse the repository at this point in the history

```
Add CSRF protection to internal requests
```

* Loading branch information

[![@RobinDaugherty](https://avatars.githubusercontent.com/u/1005280?s=40&v=4)](/RobinDaugherty)

[RobinDaugherty](/BetterErrors/better_errors/commits?author=RobinDaugherty "View all commits by RobinDaugherty")
authored
Sep 15, 2020

2 parents
[86c19fc](/BetterErrors/better_errors/commit/86c19fcb607336fec78c18816ae663f8d8d492e8)
+
[4f05b45](/BetterErrors/better_errors/commit/4f05b45f23277872438689d14c22fab7f03ad0b7)

commit 8e8e796

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**192 additions**
and
**74 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/better\_errors

  + lib/better\_errors/error\_page.rb
    [error\_page.rb](#diff-d917a6da7a7ba229c1d54580455b236f1987d7ba887436a840553e3b544ab1de)
  + lib/better\_errors/middleware.rb
    [middleware.rb](#diff-e625f1b7ebeb175b0ba38f23f449d346566348c2ac8e03ab816ca817510af9c6)
  + templates

    - lib/better\_errors/templates/main.erb
      [main.erb](#diff-485425e9dc1e64a385c78fd2cff7d3ecb8b81db275706321c3dde18c0b6f2a64)
* spec/better\_errors

  + spec/better\_errors/middleware\_spec.rb
    [middleware\_spec.rb](#diff-972b5281c4fac30f2b54d2cf078545cf4b16ad47984ac0f51a636557097c6810)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[lib/better\_errors/error\_page.rb](#diff-d917a6da7a7ba229c1d54580455b236f1987d7ba887436a840553e3b544ab1de "lib/better_errors/error_page.rb")

Show comments

[View file](/BetterErrors/better_errors/blob/8e8e796bfbde4aa088741823c8a3fc6df2089bb0/lib/better_errors/error_page.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,7 +26,7 @@ def id |
|  |  | @id ||= SecureRandom.hex(8) |
|  |  | end |
|  |  |  |
|  |  | def render(template\_name = "main") |
|  |  | def render(template\_name = "main", csrf\_token = nil) |
|  |  | binding.eval(self.class.template(template\_name).src) |
|  |  | rescue => e |
|  |  | # Fix the backtrace, which doesn't identify the template that failed (within Better Errors). |
| Expand Down | |  |

46 changes: 38 additions & 8 deletions

46
[lib/better\_errors/middleware.rb](#diff-e625f1b7ebeb175b0ba38f23f449d346566348c2ac8e03ab816ca817510af9c6 "lib/better_errors/middleware.rb")

Show comments

[View file](/BetterErrors/better_errors/blob/8e8e796bfbde4aa088741823c8a3fc6df2089bb0/lib/better_errors/middleware.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | require "json" |
|  |  | require "ipaddr" |
|  |  | require "securerandom" |
|  |  | require "set" |
|  |  | require "rack" |
|  |  |  |
| Expand Down  Expand Up | | @@ -39,6 +40,8 @@ def self.allow\_ip!(addr) |
|  |  | allow\_ip! "127.0.0.0/8" |
|  |  | allow\_ip! "::1/128" rescue nil # windows ruby doesn't have ipv6 support |
|  |  |  |
|  |  | CSRF\_TOKEN\_COOKIE\_NAME = 'BetterErrors-CSRF-Token' |
|  |  |  |
|  |  | # A new instance of BetterErrors::Middleware |
|  |  | # |
|  |  | # @param app The Rack app/middleware to wrap with Better Errors |
| Expand Down  Expand Up | | @@ -89,11 +92,14 @@ def protected\_app\_call(env) |
|  |  | end |
|  |  |  |
|  |  | def show\_error\_page(env, exception=nil) |
|  |  | request = Rack::Request.new(env) |
|  |  | csrf\_token = request.cookies[CSRF\_TOKEN\_COOKIE\_NAME] || SecureRandom.uuid |
|  |  |  |
|  |  | type, content = if @error\_page |
|  |  | if text?(env) |
|  |  | [ 'plain', @error\_page.render('text') ] |
|  |  | else |
|  |  | [ 'html', @error\_page.render ] |
|  |  | [ 'html', @error\_page.render('main', csrf\_token) ] |
|  |  | end |
|  |  | else |
|  |  | [ 'html', no\_errors\_page ] |
| Expand All | | @@ -104,12 +110,22 @@ def show\_error\_page(env, exception=nil) |
|  |  | status\_code = ActionDispatch::ExceptionWrapper.new(env, exception).status\_code |
|  |  | end |
|  |  |  |
|  |  | [status\_code, { "Content-Type" => "text/#{type}; charset=utf-8" }, [content]] |
|  |  | response = Rack::Response.new(content, status\_code, { "Content-Type" => "text/#{type}; charset=utf-8" }) |
|  |  |  |
|  |  | unless request.cookies[CSRF\_TOKEN\_COOKIE\_NAME] |
|  |  | response.set\_cookie(CSRF\_TOKEN\_COOKIE\_NAME, value: csrf\_token, httponly: true, same\_site: :strict) |
|  |  | end |
|  |  |  |
|  |  | # In older versions of Rack, the body returned here is actually a Rack::BodyProxy which seems to be a bug. |
|  |  | # (It contains status, headers and body and does not act like an array of strings.) |
|  |  | # Since we already have status code and body here, there's no need to use the ones in the Rack::Response. |
|  |  | (\_status\_code, headers, \_body) = response.finish |
|  |  | [status\_code, headers, [content]] |
|  |  | end |
|  |  |  |
|  |  | def text?(env) |
|  |  | env["HTTP\_X\_REQUESTED\_WITH"] == "XMLHttpRequest" || |
|  |  | !env["HTTP\_ACCEPT"].to\_s.include?('html') |
|  |  | !env["HTTP\_ACCEPT"].to\_s.include?('html') |
|  |  | end |
|  |  |  |
|  |  | def log\_exception |
| Expand All | | @@ -133,9 +149,15 @@ def internal\_call(env, opts) |
|  |  | return no\_errors\_json\_response unless @error\_page |
|  |  | return invalid\_error\_json\_response if opts[:id] != @error\_page.id |
|  |  |  |
|  |  | env["rack.input"].rewind |
|  |  | response = @error\_page.send("do\_#{opts[:method]}", JSON.parse(env["rack.input"].read)) |
|  |  | [200, { "Content-Type" => "text/plain; charset=utf-8" }, [JSON.dump(response)]] |
|  |  | request = Rack::Request.new(env) |
|  |  | return invalid\_csrf\_token\_json\_response unless request.cookies[CSRF\_TOKEN\_COOKIE\_NAME] |
|  |  |  |
|  |  | request.body.rewind |
|  |  | body = JSON.parse(request.body.read) |
|  |  | return invalid\_csrf\_token\_json\_response unless request.cookies[CSRF\_TOKEN\_COOKIE\_NAME] == body['csrfToken'] |
|  |  |  |
|  |  | response = @error\_page.send("do\_#{opts[:method]}", body) |
|  |  | [200, { "Content-Type" => "application/json; charset=utf-8" }, [JSON.dump(response)]] |
|  |  | end |
|  |  |  |
|  |  | def no\_errors\_page |
| Expand All | | @@ -157,18 +179,26 @@ def no\_errors\_json\_response |
|  |  | "The application has been restarted since this page loaded, " + |
|  |  | "or the framework is reloading all gems before each request " |
|  |  | end |
|  |  | [200, { "Content-Type" => "text/plain; charset=utf-8" }, [JSON.dump( |
|  |  | [200, { "Content-Type" => "application/json; charset=utf-8" }, [JSON.dump( |
|  |  | error: 'No exception information available', |
|  |  | explanation: explanation, |
|  |  | )]] |
|  |  | end |
|  |  |  |
|  |  | def invalid\_error\_json\_response |
|  |  | [200, { "Content-Type" => "text/plain; charset=utf-8" }, [JSON.dump( |
|  |  | [200, { "Content-Type" => "application/json; charset=utf-8" }, [JSON.dump( |
|  |  | error: "Session expired", |
|  |  | explanation: "This page was likely opened from a previous exception, " + |
|  |  | "and the exception is no longer available in memory.", |
|  |  | )]] |
|  |  | end |
|  |  |  |
|  |  | def invalid\_csrf\_token\_json\_response |
|  |  | [200, { "Content-Type" => "application/json; charset=utf-8" }, [JSON.dump( |
|  |  | error: "Invalid CSRF Token", |
|  |  | explanation: "The browser session might have been cleared, " + |
|  |  | "or something went wrong.", |
|  |  | )]] |
|  |  | end |
|  |  | end |
|  |  | end |

2 changes: 2 additions & 0 deletions

2
[lib/better\_errors/templates/main.erb](#diff-485425e9dc1e64a385c78fd2cff7d3ecb8b81db275706321c3dde18c0b6f2a64 "lib/better_errors/templates/main.erb")

Show comments

[View file](/BetterErrors/better_errors/blob/8e8e796bfbde4aa088741823c8a3fc6df2089bb0/lib/better_errors/templates/main.erb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -800,6 +800,7 @@ |
|  |  | (function() { |
|  |  |  |
|  |  | var OID = "<%= id %>"; |
|  |  | var csrfToken = "<%= csrf\_token %>"; |
|  |  |  |
|  |  | var previousFrame = null; |
|  |  | var previousFrameInfo = null; |
| Expand All | | @@ -810,6 +811,7 @@ |
|  |  | var req = new XMLHttpRequest(); |
|  |  | req.open("POST", "//" + window.location.host + <%== uri\_prefix.gsub("<", "&lt;").inspect %> + "/\_\_better\_errors/" + OID + "/" + method, true); |
|  |  | req.setRequestHeader("Content-Type", "application/json"); |
|  |  | opts.csrfToken = csrfToken; |
|  |  | req.send(JSON.stringify(opts)); |
|  |  | req.onreadystatechange = function() { |
|  |  | if(req.readyState == 4) { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8e8e796`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBetterErrors%2Fbetter_errors%2Fcommit%2F8e8e796bfbde4aa088741823c8a3fc6df2089bb0) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


