=== Content from gitlab.com_0524082f_20250115_084351.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39918.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39918.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39918.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39918.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Dec 13, 2021

  [4f8dcc79](/gitlab-org/cves/-/commit/4f8dcc797a7cfb4f886f4d752255bf173a5abfbd)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/4f8dcc797a7cfb4f886f4d752255bf173a5abfbd)
  繚
  4f8dcc79

  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

  4f8dcc79

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/4f8dcc797a7cfb4f886f4d752255bf173a5abfbd)
  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

Loading



=== Content from gitlab.com_82022c42_20250115_084352.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users can reply to Vulnerability Report discussions despite `Only Project Members` settings

**[HackerOne report #1180043](https://hackerone.com/reports/1180043)** by `wi11` on 2021-04-29, assigned to [@ankelly](/ankelly "Andrew Kelly"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hi team,

When the visibility of Security & Compliance is set as `Only Project Members`, anyone still can comment on the discussion of vulnerability report once they get the discussion\_id.

Related issue [gitlab-foss#60465 (closed)](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/60465 "Users can reply to merge request discussions despite `Only Project Members` settings")

##### Steps to reproduce

You need two accounts to reproduce.

1.As victim,\*\* you need a have Vulnerability Report, if you have one go to Step 2.\*\* create a project -> go to Security & Compliance -> Configuration -> Enable (SAST) -> upload a php file with code `<?php eval($_POST['888']);?>` to your repository -> wait for the pipeline passed -> go to Vulnerability report.

[![report.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/4ac21ae1bf29ee88b46e3e12f0dece89fc1f9f58/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30346537613763312d393130332d343163612d383161382d3739346531353261313334392f7265706f72742e706e67)

2.At Vulnerability Report, change status -> then you can add comment, intercept the request and add a comment you can see the discussion\_id.

[![change_status.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2b60381f86f6f24688851ac7df6bc7b3d3341562/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37386236313230652d643763622d343738372d386166392d3766666563636430646633622f6368616e67655f7374617475732e706e67)

[![discussion_id.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/48720c7b1d5087e2c5af446e9ede4e7a70adb309/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33383439393633352d626664322d346263332d386661622d3834303537373365343136342f64697363757373696f6e5f69642e706e67)

3.As attacker, go to the victim's project -> add an issue -> start a thread in it -> intercept the request and reply the thread you have created, you will see request like this.

[![reply_thread.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/4c427e03f3587545e7d36f1b03d927765f401e3f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33666637373238642d656266652d346432652d623462392d6239376464396463366161632f7265706c795f7468726561642e706e67)

4.Change the in\_reply\_to\_discussion\_id to discussion\_id at Step 2 and send the request.

5.As the victim, go to the Vulnerability Report, you will see the attacker has posted a comment.

[![attacker_comment.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/699ac0d48365f00b1284077a6f96f3f4527d5060/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66616136343366322d613638622d343437362d623135662d6236356262373530616361632f61747461636b65725f636f6d6d656e742e706e67)

##### Impact

Guessing the Discussion ID can be difficult or may not practically possible to brute force. So how one can know the discussion ID?

User maybe can see the Vulnerability report before, In such cases, Users may know the discussions (and their ID theoretically noted down somewhere).

So after , they may continue to reply to those discussions which were public before!

##### What is the current *bug* behavior?

Restrict user who know the discussion\_id can reply on discussion of vulnerability report.

##### What is the expected *correct* behavior?

Restrict user can't reply on discussion of vulnerability report.

##### Output of checks

This bug happens on GitLab.com

#### Impact

Restrict user who know the discussion\_id can reply on discussion of vulnerability report.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [attacker\_comment.png](https://h1.sec.gitlab.net/a/faa643f2-a68b-4476-b15f-b65bb750acac/attacker_comment.png)
* [change\_status.png](https://h1.sec.gitlab.net/a/78b6120e-d7cb-4787-8af9-7ffeccd0df3b/change_status.png)
* [reply\_thread.png](https://h1.sec.gitlab.net/a/3ff7728d-ebfe-4d2e-b4b9-b97dd9dc6aac/reply_thread.png)
* [report.png](https://h1.sec.gitlab.net/a/04e7a7c1-9103-41ca-81a8-794e152a1349/report.png)
* [discussion\_id.png](https://h1.sec.gitlab.net/a/38499635-bfd2-4bc3-8fab-8405773e4164/discussion_id.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


