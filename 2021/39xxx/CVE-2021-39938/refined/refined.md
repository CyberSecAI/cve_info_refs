```json
{
  "vulnerability": {
    "root_cause": "The regular expression used in the deploy slash command is vulnerable to a regular expression denial of service (ReDoS) attack.",
    "weaknesses": [
      "The regex `\\Adeploy\\s+(?<from>\\S+.*)\\s+to+\\s+(?<to>\\S+.*)\\z` is vulnerable to ReDoS."
    ],
    "impact": "Very high CPU consumption and availability issues, potentially leading to denial of service.",
    "attack_vectors": [
      "Sending a crafted request with a long string of characters to the vulnerable regex endpoint via the API."
    ],
    "required_capabilities": "The attacker needs to be able to send a request to the GitLab API endpoint, including the `text` parameter which contains the crafted string. The attacker also needs a `Private-Token` for authentication to use the GitLab API. It was speculated that the bug could be triggered via a GitLab Slack Application but this was not tested.",
    "details": "The regular expression `\\Adeploy\\s+(?<from>\\S+.*)\\s+to+\\s+(?<to>\\S+.*)\\z` is used to parse deploy commands. The `\\S+.*` pattern is vulnerable to ReDoS because when it is given a long string without any spaces after the initial non-space characters, the regex engine will backtrack excessively. Specifically the example uses  `deploy a to bbbbb...`, where the 'b's cause the excessive backtracking. The vulnerability is triggered when a newline character is included in the command.  The fix replaces `\\S+.*` with `\\S.*`."
  }
}
```