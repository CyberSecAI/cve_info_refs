=== Content from gitlab.com_3cd87158_20250114_181433.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39868.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39868.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39868.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39868.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Oct 01, 2021

  [d9d34e0d](/gitlab-org/cves/-/commit/d9d34e0d73d15fda30993561e448eda7a7f3cd3c)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/d9d34e0d73d15fda30993561e448eda7a7f3cd3c)
  ·
  d9d34e0d

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 01, 2021

  d9d34e0d

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/d9d34e0d73d15fda30993561e448eda7a7f3cd3c)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 01, 2021

Loading



=== Content from gitlab.com_5ce0cf2c_20250114_181434.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Able to create project with unlimited repository size by Project Import

**[HackerOne report #420258](https://hackerone.com/reports/420258)** by ngalog on 2018-10-07:

## Impact

Attacker could create a project with unlimited repository size as low level privilege user

## Description

This is achieved by using the project import function, by changing the value of `"repository_size_limit":null` to `"repository_size_limit":0` in project.json in gitlab export file, then tar with modified project.json, and import the tar file, it will allow user to create project with unlimted repository size

## Steps to reproduce

* create project, export the project, download the export
* untar the profile with this cmd `tar -vxzf export.tar.gz`
* use your favourite text editor to change the project.json, from `"repository_size_limit":null` to `"repository_size_limit":0`
* tar all files back with this cmd `tar -cvzf import.tar.gz`
* upload the tar import to gitlab.com

You will notice that repostiory now has unlimtied repo size.

PoC:
Look at <https://gitlab.com/golduserngalog/importinifinete/>

You will see the repo size is unlimited

## Impact

Attacker could create a project with unlimited repository size as low level privilege user

## Proposed solution

Ignore `repository_size_limit` during Import and rely on a default/inherited value/whichever way it's configured.

## Implementation plan

* [backend](/gitlab-org/gitlab/-/issues?label_name=backend "Issues that require backend work") Add `:repository_size_limit` to `excluded_attributes.project` in <https://gitlab.com/gitlab-org/gitlab/blob/master/lib/gitlab/import_export/project/import_export.yml#L162>,
* [backend](/gitlab-org/gitlab/-/issues?label_name=backend "Issues that require backend work") remove `:repository_size_limit` from `:Project` in <https://gitlab.com/gitlab-org/gitlab/blob/master/spec/lib/gitlab/import_export/safe_model_attributes.yml#L559>,

Edited Sep 15, 2021 by [Alan (Maciej) Paruszewski](/alan)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


