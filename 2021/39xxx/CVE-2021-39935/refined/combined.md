=== Content from gitlab.com_fb0a4b71_20250114_205229.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SSRF patch for CI Lint API is incomplete

**[HackerOne report #1236965](https://hackerone.com/reports/1236965)** by `minhli` on 2021-06-17, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

Prior reports:

* <https://hackerone.com/reports/1110131>
* <https://hackerone.com/reports/1110131>

Tested on version: 13.12.4-ee

There is at least one more case which I think is not covered in this patch in case of `External users`.

Considering following scenarios:

(note from [@dcouture](/dcouture "Dominic Couture"), I removed the first scenario it was not valid)

**Second Scenario**

1. Sign ups are enabled
2. Under  `Account and limit`, set

> New users set to external
>
> Newly registered users will by default be external

3. As I noticed this in one of the organization and as the docs say:

> In cases where it is desired that a user has access only to some internal or private projects, there is the option of creating External Users. This feature > may be useful when for example a contractor is working on a given project and should only have access to that project.
>
> External users:
>
> Can only create projects (including forks), subgroups, and snippets within the top-level group to which they belong.

Right after signup, now no user can really do any action unless they are explicitly added to a group or project by the admins. So no SSRF should be possible, but by abusing the CI Lint API, in such a case any unauthenticated user can still abuse CI Lint API for SSRF. This option is really valuable with contractors and for open source projects where collaborators can use any email address to sign-up but usually manual account reviews, group/project assignments are done by maintainers.

I am not sure if these cases have been overlooked, so filing this report to ensure this is known. In both these cases I think unauthenticated SSRF should not be possible by just anyone.

Please review.

Thanks!

#### Impact

Information disclosure

protection bypass

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Nov 19, 2021 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_d9fadb60_20250114_205228.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39935.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39935.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39935.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39935.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Dec 13, 2021

  [a3e4cd40](/gitlab-org/cves/-/commit/a3e4cd40b2ea25522c67a93a9974f8e245e46d88)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/a3e4cd40b2ea25522c67a93a9974f8e245e46d88)
  ·
  a3e4cd40

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

  a3e4cd40

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/a3e4cd40b2ea25522c67a93a9974f8e245e46d88)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

Loading


