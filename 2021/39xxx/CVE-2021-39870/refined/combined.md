=== Content from gitlab.com_602805f0_20250114_191244.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ESCALATED: Bypass Disabled Repo by URL Project Creation

**[HackerOne report #630263](https://hackerone.com/reports/630263)** by `ngalog` on 2019-06-26, assigned to `estrike`:

### Summary

As an admin, you can disable Repo by URL project creation in admin page `https://:gitlab_instance/admin/application_settings`

However the user can still import project using repo by url regardless of the setting

### Steps to reproduce

* As an admin, disable `Repo by URL` import source in `/admin/application_settings/general` under  `Visibility and access controls`

[![image](data:image/gif;base64...)](/-/project/278964/uploads/eaac6a0b2f0b550ff16b6b0b3d6f94de/image.png)

* As a regular user, run the following curl command:

```
curl 'http://gitlab.local/-/projects' \
    -H 'Content-Type: application/x-www-form-urlencoded' \
    -H "Cookie: $COOKIE" \
    --data-raw "utf8=%E2%9C%93&authenticity_token=$VALID_AUTHENTICITY_TOKEN&project%5Bimport_url%5D=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Frelease-cli.git&project%5Bimport_url_user%5D=&project%5Bimport_url_password%5D=&project%5Bci_cd_only%5D=false&project%5Bname%5D=Importing+Even+If+Disabled&project%5Bnamespace_id%5D=7&project%5Bpath%5D=importing-even-if-disabled&project%5Bdescription%5D=&project%5Bvisibility_level%5D=0"
```

This command sends a request equivalent to what happens when using the `Repo by URL` import methods in the UI. It will import the `gitlab-org/release-cli` project by URL. In my case I got the response

```
<html><body>You are being <a href="http://gitlab.local/attacker/importing-even-if-disabled">redirected</a>.</body></html>
```

and the project was imported anyway.

### Impact

Bypass project creation despite the admin setting explcitily disallow it

### What is the current *bug* behavior?

Bypass project creation despite the admin setting explcitily disallow it

reproduced on gitlab CE 11.11.3 (gitlab-ce@e3eeb779d72006b9fbbaecf9f1d8fbd52a7d6383)

## Impact

bypass project creation by repo by url

Edited Aug 04, 2021 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_a47380c9_20250114_191241.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39870.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39870.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39870.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39870.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Oct 01, 2021

  [53e004b3](/gitlab-org/cves/-/commit/53e004b392362bc25603541f760d9abb0ed6bef1)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/53e004b392362bc25603541f760d9abb0ed6bef1)
  ·
  53e004b3

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 01, 2021

  53e004b3

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/53e004b392362bc25603541f760d9abb0ed6bef1)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 01, 2021

Loading


