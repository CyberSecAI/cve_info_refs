=== Content from gitlab.com_b08a8d7c_20250115_093725.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Group members with developer role can escalate their privilege to maintainer on projects that they import

**[HackerOne report #1256017](https://hackerone.com/reports/1256017)** by `justas_b` on 2021-07-09, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

> NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!

##### Summary

By modifying the **access\_level** field in **project\_members.ndjson** file, developers can import new projects where they have a maintainer role.

##### Steps to reproduce

(Step-by-step guide to reproduce the issue, including:)

1. Create 2 accounts
2. Create a group with account A
3. Invite account B to the group as with a max role of developer

[![bandicam_2021-07-09_17-35-44-867.jpg](data:image/gif;base64...)](https://user-content.gitlab-static.net/aa0b00a02d699163bc46786bb4022780157a9e2f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31616239326663352d373937642d343234312d383938642d3664613166353835656235302f62616e646963616d5f323032312d30372d30395f31372d33352d34342d3836372e6a7067)

4. With account B, export any project you own
5. Modify the **access\_level** field in **project\_members.ndjson** file in that project. Change it to 40 (maintainer)

[![bandicam_2021-07-09_16-22-55-049.jpg](data:image/gif;base64...)](https://user-content.gitlab-static.net/bd48281277f5b1f732a913506f93326ad5d80ce3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f38626139326137332d643932642d343762642d613637362d3761313130636432306262642f62616e646963616d5f323032312d30372d30395f31362d32322d35352d3034392e6a7067)

6. Import that project to the group where you have only developer access
7. You should have maintainer access in that imported project

[![bandicam_2021-07-09_17-35-11-737.jpg](data:image/gif;base64...)](https://user-content.gitlab-static.net/39f89c90458b11331b4ca206416984f21b9ede48/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f30343733333337642d343832342d343833632d383731322d3261363463633162376138322f62616e646963616d5f323032312d30372d30395f31372d33352d31312d3733372e6a7067)

[![bandicam_2021-07-09_17-35-32-850.jpg](data:image/gif;base64...)](https://user-content.gitlab-static.net/b82cf92c9570eeb1ce4656a413d11a859acacf12/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39393163316166392d303337302d346337312d383735352d6466633830303435346638392f62616e646963616d5f323032312d30372d30395f31372d33352d33322d3835302e6a7067)

One of the attack scenarios would be to import a project as a maintainer, add a deploy token or key and then demote yourself to a developer role or leave the project entirely. Combined with #686359, a user doesn't even have to be a member of that group to be able to download the project.

##### Examples

(If the bug is project related, please create an example project and export it using the project export feature)

(If you are using an older version of GitLab, this will also help determine whether the bug has been fixed in a more recent version)

(If the bug can be reproduced on GitLab.com without violating the `Rules of Engagement` as outlined in the program policy, please provide the full path to the project.)

##### What is the current *bug* behavior?

Developers can have a maintainer role in the projects that they import.

##### What is the expected *correct* behavior?

Developers should have a max role of a developer in the projects that they import.

##### Relevant logs and/or screenshots

(Paste any relevant logs - please use code blocks (```) to format console output,

logs, and code as it's very hard to read otherwise.)

##### Output of checks

This bug happens on GitLab.com

###### Results of GitLab environment info

(For installations with omnibus-gitlab package run and paste the output of:

`sudo gitlab-rake gitlab:env:info`)

(For installations from source run and paste the output of:

`sudo -u git -H bundle exec rake gitlab:env:info RAILS_ENV=production`)

#### Impact

Developers can have a maintainer role in the projects that they import.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bandicam\_2021-07-09\_17-35-44-867.jpg](https://h1.sec.gitlab.net/a/1ab92fc5-797d-4241-898d-6da1f585eb50/bandicam_2021-07-09_17-35-44-867.jpg)
* [bandicam\_2021-07-09\_17-35-11-737.jpg](https://h1.sec.gitlab.net/a/0473337d-4824-483c-8712-2a64cc1b7a82/bandicam_2021-07-09_17-35-11-737.jpg)
* [bandicam\_2021-07-09\_16-22-55-049.jpg](https://h1.sec.gitlab.net/a/8ba92a73-d92d-47bd-a676-7a110cd20bbd/bandicam_2021-07-09_16-22-55-049.jpg)
* [bandicam\_2021-07-09\_17-35-32-850.jpg](https://h1.sec.gitlab.net/a/991c1af9-0370-4c71-8755-dfc800454f89/bandicam_2021-07-09_17-35-32-850.jpg)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Jul 20, 2021 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_4757473e_20250115_093725.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39944.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39944.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39944.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39944.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Dec 13, 2021

  [8a3e393f](/gitlab-org/cves/-/commit/8a3e393fa7d4050afa53d99bba9f1325840a0438)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/8a3e393fa7d4050afa53d99bba9f1325840a0438)
  ·
  8a3e393f

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

  8a3e393f

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/8a3e393fa7d4050afa53d99bba9f1325840a0438)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

Loading


