=== Content from gitlab.com_21a46e98_20250114_195122.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Exposure of trigger tokens on project exports

**[HackerOne report #497144](https://hackerone.com/reports/497144)** by `mishre` on 2019-02-16, assigned to `asaba`:

**Summary:**

Any user can configure a trigger token for himself so that pipelines will be used to create CI/CD jobs on his own user context. When using the trigger token, Jobs created on the user's behalf will have access to all the resources(repositories) the user have (as explained here: <https://docs.gitlab.com/ee/ci/triggers/#taking-ownership-of-a-trigger>). Maintainers of the repository cannot usually see the trigger tokens for other users (only for themselves) as it will give them complete access (via ci-cd jobs) to perform actions on their behalf.

**Description:**

All maintainers can perform an export of the repository, which in turn will leak all the trigger tokens created for all the other maintainers of the repository through a file called project.json which contains different information for later restoring the project.

## Steps To Reproduce:

1. Create a new repository.
2. Go to the Members section of the repository and add another maintainer (the attacker).
3. Go to the CI/CD settings of the project and create a trigger token.
4. Login as the attacker and go to the CI/CD settings of the project - you should not be able to see the trigger token.
5. Now create an export of the project.
6. Download the exported .tar.gz file and open a file called project.json
7. Look for the word "trigger" in the json file -> you now should be able to see the token at plaintext and use it to impersonate the victim.

## Supporting Material/References:

* List any additional material (e.g. screenshots, logs, etc.)

## Impact

An attacker can impersonate the victim and have access to all the repositories the victims has access to.

## Documentation

* Update the user docs to explicitly call out the fact that trigger tokens are not exported for security reasons.

## Implementation plan

* [backend](/gitlab-org/gitlab/-/issues?label_name=backend "Issues that require backend work") Remove `:triggers` from <https://gitlab.com/gitlab-org/gitlab/blob/master/lib/gitlab/import_export/project/import_export.yml#L91>,
* [documentation](/gitlab-org/gitlab/-/issues?label_name=documentation "Epics, issues, and merge requests related to product documentation.") Mark `Pipeline Triggers` as unsupported for GitLab in <https://gitlab.com/gitlab-com/customer-success/professional-services-group/global-practice-development/migration/congregate/-/blob/master/customer/gitlab-migration-features-matrix.md#L42>, Congregate tool should be able to still migrate triggers as it is using GitLab API and not File Export
* [documentation](/gitlab-org/gitlab/-/issues?label_name=documentation "Epics, issues, and merge requests related to product documentation.") Add **Pipeline triggers** to list in docs <https://gitlab.com/gitlab-org/gitlab/blob/master/doc/user/project/settings/import_export.md#L133>
* [test](/gitlab-org/gitlab/-/issues?label_name=test "Issues related to our test suite") Verify if exported project does not contain that token,

Edited Sep 14, 2021 by [Alan (Maciej) Paruszewski](/alan)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_1d1c42a4_20250114_195121.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39869.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39869.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39869.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39869.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Oct 01, 2021

  [d4ef70c1](/gitlab-org/cves/-/commit/d4ef70c117458b5fc48724b5274b20e4a1b1acc5)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/d4ef70c117458b5fc48724b5274b20e4a1b1acc5)
  繚
  d4ef70c1

  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

  d4ef70c1

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/d4ef70c117458b5fc48724b5274b20e4a1b1acc5)
  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

Loading


