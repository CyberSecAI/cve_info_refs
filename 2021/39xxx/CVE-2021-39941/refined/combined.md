=== Content from gitlab.com_ceeefe57_20250114_215611.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39941.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39941.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39941.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39941.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Dec 13, 2021

  [08942496](/gitlab-org/cves/-/commit/08942496cefc60752435a818a9267d594688c7bf)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/08942496cefc60752435a818a9267d594688c7bf)
  繚
  08942496

  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

  08942496

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/08942496cefc60752435a818a9267d594688c7bf)
  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

Loading



=== Content from gitlab.com_d3f14589_20250114_215613.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Default branch visible despite no permissions to repository

*Update:* per Michelle's comment [here](https://gitlab.com/gitlab-org/gitlab/-/issues/33864#note_346248279 "Default branch visible despite no permissions to repository")

> The issue outlined in the description has been resolved, however, additional findings occurred during the security review: gitlab-org/security/gitlab#103 (comment 333022117)

 `curl -s https://staging.gitlab.com/dcouture/norepoaccess | grep this_is_the_default_branch`

```
<input type="hidden" name="repository_ref" id="repository_ref" value="this_is_the_default_branch" />
<div class="search-autocomplete-opts hide" data-autocomplete-path="/search/autocomplete" data-autocomplete-project-id="4588281" data-autocomplete-project-ref="this_is_the_default_branch"></div>
</a></li><li class=""><a class="shortcuts-repository-charts" title="Repository" href="/dcouture/norepoaccess/-/graphs/this_is_the_default_branch/charts"><span>Repository</span>
```

---

**[HackerOne report #706361](https://hackerone.com/reports/706361)** by `ashish_r_padelkar` on 2019-10-02, assigned to [@cmaxim](/cmaxim "Costel Maxim"):

### Summary

Hello,

The default branch should not be visible to guest/non-member users when they do not have any access to repository. However, default branch is still visible to such users.

I am reporting this issue as similar report was resolved before #531694 which exposes default branch when there was no access to repository.

### Steps to reproduce

1. Create a public project with non access to repository for non members. This can be done by setting repository as `Only Project Members`.
2. This should ensure that no information related to repository is visible to non members
3. Now , as a non member, just visit to project details pages `https://gitlab.com/<UserName>/<ProjectName>` and do the inspect element of browser.
4. In `Body` html tag, you should see `data-find-file` attribute which exposes default branch. Note that default branch can be set to anything by admins.

[![Screenshot_2019-10-02_at_17.17.31.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0d4d09e4fbaa68f3ebc86732c67e64163a42f750/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62623931613637362d346664342d346530392d396666322d6432626332653938643163322f53637265656e73686f745f323031392d31302d30325f61745f31372e31372e33312e706e67)

### Examples

You can see my project here at `https://gitlab.com/gitlabadminuser/thisispublicproject` and follow the above steps to know default branch from this project.

### What is the current *bug* behavior?

Default branch is visible to non members when they do not have any access to repository

### What is the expected *correct* behavior?

None of the repository related information should be visible to non members when they do not have access

### Output of checks

This bug happens on GitLab.com and might be on omnibus installations too.

Regards,

Ashish

## Impact

This bug exposes default branch to

1. Non members in public project when repository is `only project members`
2. Guest in private project can see when they do not have any access to repository
3. No badges setup in projects/groups
4. Public pipelines are disabled

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2019-10-02\_at\_17.17.31.png](https://h1.sec.gitlab.net/a/bb91a676-4fd4-4e09-9ff2-d2bc2e98d1c2/Screenshot_2019-10-02_at_17.17.31.png)

Edited Oct 25, 2021 by [Gary Holtz](/garyh)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


