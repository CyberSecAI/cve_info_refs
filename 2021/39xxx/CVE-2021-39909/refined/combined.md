=== Content from gitlab.com_90c008a0_20250114_231851.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39909.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39909.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39909.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39909.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ü§ñ GitLab Bot ü§ñ's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ü§ñ GitLab Bot ü§ñ")](/gitlab-bot)

  May 11, 2022

  [e6cd7eaf](/gitlab-org/cves/-/commit/e6cd7eaffa663bbd67d4304492bd78d79162613f)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/e6cd7eaffa663bbd67d4304492bd78d79162613f)
  ¬∑
  e6cd7eaf

  [ü§ñ GitLab Bot ü§ñ](/gitlab-bot) authored May 11, 2022

  e6cd7eaf

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/e6cd7eaffa663bbd67d4304492bd78d79162613f)
  [ü§ñ GitLab Bot ü§ñ](/gitlab-bot) authored May 11, 2022

Loading



=== Content from gitlab.com_543bdbae_20250114_231852.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# "Require Code Owner approval" bypass using unverified email addresses

**[HackerOne report #1237750](https://hackerone.com/reports/1237750)** by `vaib25vicky` on 2021-06-18, assigned to H1 Triage:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

### Summary:

CODEOWNERS files allows unverified email addresses when mapping addresses to Gitlab usernames.

If a CODEOWNERS file contains email addresses that do not have an associated Gitlab account then

an attacker can add that email address to their account and become a codeowner.

This allows malicious members to bypass the ‚ÄúRequire Code Owner approval‚Äù check on protected branches.

### Details:

Protected branch rules allow owner of the project to restrict who can push and merge to the branch

One of that rule is "Require Code Owner approval"

Code Owner file is a file which tells who can approve the merge request and

after approval the code can be push to the protected branches

This approval applies to everyone including maintainers of the project

Code owner file syntax allows defining members with usernames and emails

(<https://docs.gitlab.com/ee/user/project/code_owners.html#the-syntax-of-code-owners-files>)

```
* [@]default-codeowner

###  We can also specify "multiple tab or space" separated codeowners:
* [@]multiple [@]code [@]owners  email_address@owners

###  Rules defined later in the file take precedence over the rules
*.rb [@]ruby-owner
```

After creating code owner file, Gitlab will map the username and email addresses

to Gitlab account. However, email verification is not checked which allows a malicious

user to impersonate as a valid different code owner user and bypass code owner rule

### Steps to reproduce:

Code owner is premium feature so you probably have to opt for free trial

Go to your Group > Settings > Billing and start your free trial

#### Project

* lets say project named is `h1-project`
* Add 3 members - A-main(Maintainer), B-dev, C-dev (developers)
* Add a readme file `README.md`

#### Codeowners approval rule on protected branch

* Add a CODEOWNERS file named `CODEOWNERS`

```
*.md [@]A-main  h1-test@dontexist127.com

```

* Go to project settings `https://gitlab.com/<namespace>/<h1-project>/-/settings/repository`

  and edit your main protected branch setting like shown in image

[![yo_gitlab.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d176c1fc5036c6f3df01cadee6c2dc1f9522c2d0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36646261333561612d333432332d343138622d393236352d3937363530666265336234342f796f5f6769746c61622e706e67)

#### Bypass Require Code Owner approval

Codeowner file clearly state that any changes to `*.md` file require approval from

`[@]A-main` and `h1-test@dontexist127.com` before merge and push

* `C-dev` add the email `h1-test@dontexist127.com` to his account which is an **unverified email**
* `B-dev` edit the file `README.md` and created a new merge request
* `C-dev` goes to the merge request page, and he can now easily approve and merge

  the code to the protected branch as `C-dev` who is NOT a codeowner of the file

#### Impact

"Require Code Owner approval" bypass using unverified email addresses on protected branches which allow malicious user to merge and push code to the protected branches where he was restricted

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [yo\_gitlab.png](https://h1.sec.gitlab.net/a/6dba35aa-3423-418b-9265-97650fbe3b44/yo_gitlab.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


