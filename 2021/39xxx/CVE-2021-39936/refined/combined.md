=== Content from gitlab.com_97f2a5bd_20250115_085105.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Able to access wiki with scopeless deploy token even if wikis are disabled

**[HackerOne report #964057](https://hackerone.com/reports/964057)** by `vaib25vicky` on 2020-08-21, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Deploy token scopes are

[![wiki_dep.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/72654e331adbd9df2e574508b8c2442c034e111a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65336533623033612d313930642d346230322d386232392d6630623236383936653261332f77696b695f6465702e706e67)

There is no scopes for `read_wiki`. But currently user can read project or group wikis using deploy token even if wikis are disabled

##### PoC

This is my private test project `https://gitlab.com/thevicc/vicctest3` with wiki disabled, the deploy token `<REDACTED>`  don't have `read_wiki` scope but you'll be able to read wiki anyway

 `git clone https://<REDACTED>@gitlab.com/thevicc/vicctest3.wiki.git`

##### Steps to reproduce

* Create test private project
* Create deploy token with read\_repo scope
* Now you can clone the project wiki using deploy token
* Disabled wiki and you still can access it using deploy token

#### Impact

Deploy token dont have `wiki` scope but one still abel to use it to access project or group wikis. Even if wikis are disabled one is able to access it using deploy tokens

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [wiki\_dep.png](https://h1.sec.gitlab.net/a/e3e3b03a-190d-4b02-8b29-f0b26896e2a3/wiki_dep.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

[See the steps above](#steps-to-reproduce)

Edited Jan 12, 2022 by [Vitor Meireles De Sousa](/vdesousa)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_43b1ef3d_20250115_085104.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39936.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39936.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39936.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39936.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Dec 13, 2021

  [e2da51f1](/gitlab-org/cves/-/commit/e2da51f1f5f86952c11be356662216ca4678596c)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e2da51f1f5f86952c11be356662216ca4678596c)
  繚
  e2da51f1

  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

  e2da51f1

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e2da51f1f5f86952c11be356662216ca4678596c)
  [ GitLab Bot ](/gitlab-bot) authored Dec 13, 2021

Loading


