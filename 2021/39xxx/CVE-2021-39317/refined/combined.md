=== Content from plugins.trac.wordpress.org_540a91f7_20250115_081341.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2592642%2Faccess-demo-importer%2Ftrunk%2Finc%2Fdemo-functions.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2137598/access-demo-importer/trunk/inc/demo-functions.php "Changeset 2137598 for access-demo-importer/trunk/inc/demo-functions.php")
* [Next Change](/changeset/2593256/access-demo-importer/trunk/inc/demo-functions.php "Changeset 2593256 for access-demo-importer/trunk/inc/demo-functions.php") →

---

# Changeset [2592642](/changeset/2592642 "Show full changeset") for [access-demo-importer/trunk/inc/demo-functions.php](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2592642 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/02/2021 11:41:17 AM
([3 years](/timeline?from=2021-09-02T11%3A41%3A17Z&precision=second "See timeline at 09/02/2021 11:41:17 AM") ago)

Author:
Access Keys
Message:

Checked compatibility with WP version 5.8

Fixed off-line installer issue

File:

1 edited

* [access-demo-importer/trunk/inc/demo-functions.php](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2592642 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [access-demo-importer/trunk/inc/demo-functions.php](/changeset/2592642/access-demo-importer/trunk/inc/demo-functions.php "Show the changeset 2592642 restricted to access-demo-importer/trunk/inc/demo-functions.php")

  | [r2137598](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2137598#L443 "Show revision 2137598 of this file in browser") | [r2592642](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2592642#L443 "Show revision 2592642 of this file in browser") |  |
  | --- | --- | --- |
  | 443 | 443 | \*/ |
  | 444 | 444 | public function plugin\_offline\_installer\_callback() { |
  |  | 445 | if ( !is\_admin() || !wp\_verify\_nonce( $\_POST['adi\_install\_pro\_plugin\_nonce'], 'adi\_install\_pro\_plugin\_nonce' ) ) { |
  |  | 446 | die( 'This action was stopped for security purposes.' ); |
  |  | 447 | } |
  | 445 | 448 | $plugin = array(); |
  | 446 |  |  |
  | 447 | 449 | $file\_location = $plugin['location'] = isset( $\_POST['file\_location'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['file\_location'] ) ) : ''; |
  | 448 | 450 | $file           = isset( $\_POST['file'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['file'] ) ) : ''; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2592642)
* [Zip Archive](?format=zip&new=2592642)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from patchstack.com_3dfc57d3_20250115_081340.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Authenticated Vulnerability in Unpatched WordPress Themes

[Security advisories](https://patchstack.com/category/security-advisories/)
[Featured](https://patchstack.com/category/featured/)
[unpatched WordPress themes](https://patchstack.com/tag/unpatched-wordpress-themes/)
Published 11 January 2022Updated 23 November 2023![](https://secure.gravatar.com/avatar/071c80de41a0ebc4f5763353519eb905?s=200&d=mm&r=g)[Robert Rowley](https://patchstack.com/author/robert/)Author at PatchstackTable of Contents

The decision to publicly report a vulnerability that has no patch does not come easily, however, in certain circumstances it is the only option available to protect users from running insecure code.

You may have guessed where I am going with this if you have been reading or listening to the Patchstack Security Weekly updates over the last few weeks.

This post will be discussing the first batch of vulnerabilities in the Patchstack Alliance’s backlog of vulnerabilities with no patch available.

## Why full disclosure?

It is not uncommon for open source developers to either abandon or have insufficient time to continue committing code towards a free project. However, if a developer is not providing security patches, then their software is dangerous to run. Users need to be aware of the risks of running this software with security flaws, so they can take steps to mitigate the issue themselves (if possible.)

In this case, the same insecure code was found in dozens of themes by the same design firm. We reached out to the developer/design firm, who unfortunately was non-communicative with our staff.

It has been over 30 days and we have exhausted all means available to discuss the issue privately with the developer. Since we have no timeline for when, or if, these themes will receive a patch and with the safety of sites who are be running these themes in mind, we are disclosing the list of affected themes at this time and will do our best to help secure these sites.

We are making mitigation strategies available privately for now, because disclosing them publicly will also assist with writing vulnerabilities. Please see the Defense Options listed below if you would like to know how to protect websites against these vulnerabilities.

## Vulnerability details

It may sound surprising that themes have security vulnerabilities in them, but if a theme includes PHP code, then that code can have vulnerabilities in it. There are 4 vulnerabilities we found in these themes.

* Authenticated arbitrary file upload
* Authenticated arbitrary plugin enable/disablement
* Authenticated data deletion
* Lack of CSRF checks in authenticated actions

The authenticated arbitrary file upload vulnerability is the most critical of the four.

The initial report was made by [Lenon Leite](https://twitter.com/lenonleite), who identified the authenticated arbitrary file upload vulnerability. The three additional vulnerabilities we uncovered by [Vlad Visse](https://twitter.com/ex_mi).

### Potential impact

The total number of sites with these themes installed is approximately 50,000. Not all of these sites are at risk though, because the attack ***requires authentication*** to perform.

Sites that restrict user accounts to only trusted users are at a lower or no risk, however, any website running one of these themes and enabled user registration needs to take action immediately as users with ***subscriber-level accounts can exploit* *this vulnerability*** and take over the site.

### What went wrong?

The developer appears to have missed adding a quick authorization check in their code. The fix here is checking if the user is authorized to upload PHP files before performing the action.

We have talked about the importance of Authorization checks before, in [Patchstack Weekly 45](https://patchstack.com/articles/patchstack-weekly-update-november-11th-2021/). If you are interested in learning more about secure coding topics, the Patchstack Security Weekly is a great place to learn and stay up to date on security topics.

### Defense options

If you are using the paid Patchstack app to protect your websites, we have already provided a vPatch for you.

In fact, WordPress sites with a web application firewall that is up to date on WordPress-specific vulnerability may already be protected. We will get into more details on this in the next post, but, in short: This is not the first time this developer/designer has included insecure code.

Patchstack hosting partners have been informed and provided guidance on web application firewall rules to help protect their customers.

If you are a hosting provider and would like to join our secure hosting partners and receive regular intelligence updates about vulnerabilities in open source components, please reach out.

If you are a site owner and would like instructions on how to patch the theme manually to make it safe, please reach out. We will be glad to provide instructions and a patch for these themes.

## Affected themes (first batch)

* [AccessPress Parallax](https://patchstack.com/database/vulnerability/accesspress-parallax/wordpress-accesspress-parallax-theme-4-5-arbitrary-file-upload-vulnerability)
* [Accesspress Lite](https://patchstack.com/database/vulnerability/accesspress-lite/wordpress-accesspress-lite-theme-2-92-arbitrary-file-upload-vulnerability)
* [AccessPress Store](https://patchstack.com/database/vulnerability/accesspress-store/wordpress-accesspress-store-theme-2-4-9-arbitrary-file-upload-vulnerability)
* [Zigcy Lite](https://patchstack.com/database/vulnerability/zigcy-lite/wordpress-zigcy-lite-theme-2-0-9-arbitrary-file-upload-vulnerability)
* [Enlighten](https://patchstack.com/database/vulnerability/enlighten/wordpress-enlighten-theme-1-3-5-arbitrary-file-upload-vulnerability)
* [Accesspress Mag](https://patchstack.com/database/vulnerability/accesspress-mag/wordpress-accesspress-mag-theme-2-6-5-arbitrary-file-upload-vulnerability)
* [StoreVilla](https://patchstack.com/database/vulnerability/storevilla/wordpress-storevilla-theme-1-4-1-arbitrary-file-upload-vulnerability)
* [Punte](https://patchstack.com/database/vulnerability/punte/wordpress-punte-theme-1-1-2-arbitrary-file-upload-vulnerability)
* [Accesspress Basic](https://patchstack.com/database/vulnerability/accesspress-basic/wordpress-accesspress-basic-theme-3-2-1-arbitrary-file-upload-vulnerability)
* [AccessPress Root](https://patchstack.com/database/vulnerability/accesspress-root/wordpress-accesspress-root-theme-2-5-arbitrary-file-upload-vulnerability)
* [Construction Lite](https://patchstack.com/database/vulnerability/construction-lite/wordpress-construction-lite-theme-1-2-5-arbitrary-file-upload-vulnerability)
* [VMagazine Lite](https://patchstack.com/database/vulnerability/vmagazine-lite/wordpress-vmagazine-lite-theme-1-3-5-arbitrary-file-upload-vulnerability)
* [ParallaxSome](https://patchstack.com/database/vulnerability/parallaxsome/wordpress-parallaxsome-theme-1-3-6-arbitrary-file-upload-vulnerability)
* [FotoGraphy](https://patchstack.com/database/vulnerability/fotography/wordpress-fotography-theme-2-4-0-arbitrary-file-upload-vulnerability)
* [VMmag](https://patchstack.com/database/vulnerability/vmag/wordpress-vmag-theme-1-2-7-arbitrary-file-upload-vulnerability)

* [Uncode Lite](https://patchstack.com/database/vulnerability/uncode-lite/wordpress-uncode-lite-theme-1-3-3-arbitrary-file-upload-vulnerability)
* [Bingle](https://patchstack.com/database/vulnerability/bingle/wordpress-bingle-theme-1-0-4-arbitrary-file-upload-vulnerability)
* [The Launcher](https://patchstack.com/database/vulnerability/the-launcher/wordpress-the-launcher-theme-1-3-2-arbitrary-file-upload-vulnerability)
* [ScrollMe](https://patchstack.com/database/vulnerability/scrollme/wordpress-scrollme-theme-2-1-0-arbitrary-file-upload-vulnerability)
* [Agency Lite](https://patchstack.com/database/vulnerability/agency-lite/wordpress-agency-lite-theme-1-1-6-arbitrary-file-upload-vulnerability)
* [Swing Lite](https://patchstack.com/database/vulnerability/swing-lite/wordpress-swing-lite-theme-1-1-9-arbitrary-file-upload-vulnerability)
* [Vmagazine News](https://patchstack.com/database/vulnerability/vmagazine-news/wordpress-vmagazine-news-theme-1-0-5-arbitrary-file-upload-vulnerability)
* [Bloger](https://patchstack.com/database/vulnerability/bloger/wordpress-bloger-theme-1-2-6-arbitrary-file-upload-vulnerability)
* [Revolve](https://patchstack.com/database/vulnerability/revolve/wordpress-revolve-theme-1-3-1-arbitrary-file-upload-vulnerability)
* [Ripple](https://patchstack.com/database/vulnerability/ripple/wordpress-ripple-theme-1-2-0-arbitrary-file-upload-vulnerability)
* [Zigcy Cosmetics](https://patchstack.com/database/vulnerability/zigcy-cosmetics/wordpress-zigcy-cosmetics-theme-1-0-5-arbitrary-file-upload-vulnerability)
* [The Monday](https://patchstack.com/database/vulnerability/the-monday/wordpress-the-monday-theme-1-4-1-arbitrary-file-upload-vulnerability)
* [Zigcy Baby](https://patchstack.com/database/vulnerability/zigcy-baby/wordpress-zigcy-baby-theme-1-0-6-arbitrary-file-upload-vulnerability)
* [Doko](https://patchstack.com/database/vulnerability/doko/wordpress-doko-theme-1-0-27-arbitrary-file-upload-vulnerability)
* [Sakala](https://patchstack.com/database/vulnerability/sakala/wordpress-sakala-theme-1-0-4-arbitrary-file-upload-vulnerability)

## Disclosure timeline

**2021-11-28** Lenon Leite reports the vulnerabilities.
****2021-12-02****We verified Lenon’s report and reached out to the Developer. vPatches released to [Patchstack Developer users](https://patchstack.com/pricing/).
**2021-12-09** No response, we reached out again.
**2021-12-22** Developer acknowledges the issue.
**2021-12-22** We reply, requesting a timeline.
**2022-01-04** No response. We ask for a timeline again.
**2022-01-06** Patchstack [vPatch](https://patchstack.com/articles/virtual-patching/) updated (to apply to additional components).
**2022-01-10** We escalate the issue to the WordPress.org Themes Repository.
**2022-01-11** Vulnerabilities are added to the [Patchstack Database](https://patchstack.com/database/).

## Next time …

The above list is not a complete list of affected components, and the timeline also has additional details we have not yet reported. This is still an ongoing issue, and we hope the developer takes action soon and releases patches to address this insecure code. If not, then we will continue to release more details so site owners are able to take action to protect their websites.

Please check back in here at the Patchstack blog for more details as they become available.

Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**: Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerability-Patched-in-GiveWP-Plugin-main.png)10 January, 2025
#### Critical Vulnerability Patched in GiveWP Plugin

Critical Vulnerability
php object injection
Zeroday bounties
zeroday
givewp](https://patchstack.com/articles/critical-vulnerability-patched-in-givewp-plugin/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

Critical Vulnerability
arbitrary file upload
SQL Injection
ENVATO](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

Critical Vulnerability
privilege escalation
arbitrary file upload
theme
SQL Injection
ENVATO](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu



=== Content from plugins.trac.wordpress.org_a8657b4b_20250115_081344.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2602132%2Faccess-demo-importer%2Ftrunk%2Finc%2Fdemo-functions.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2596766/access-demo-importer/trunk/inc/demo-functions.php "Changeset 2596766 for access-demo-importer/trunk/inc/demo-functions.php")
* [Next Change](/changeset/2667972/access-demo-importer/trunk/inc/demo-functions.php "Changeset 2667972 for access-demo-importer/trunk/inc/demo-functions.php") →

---

# Changeset [2602132](/changeset/2602132 "Show full changeset") for [access-demo-importer/trunk/inc/demo-functions.php](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/21/2021 06:50:33 AM
([3 years](/timeline?from=2021-09-21T06%3A50%3A33Z&precision=second "See timeline at 09/21/2021 06:50:33 AM") ago)

Author:
Access Keys
Message:

Added appropriate capability checks in plug-in functions where required

File:

1 edited

* [access-demo-importer/trunk/inc/demo-functions.php](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132 "Show entry in browser")
  (modified)
  ([9 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [access-demo-importer/trunk/inc/demo-functions.php](/changeset/2602132/access-demo-importer/trunk/inc/demo-functions.php "Show the changeset 2602132 restricted to access-demo-importer/trunk/inc/demo-functions.php")

  | [r2596766](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L205 "Show revision 2596766 of this file in browser") | [r2602132](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L205 "Show revision 2602132 of this file in browser") |  |
  | --- | --- | --- |
  | 205 | 205 | public static function ajax\_demo\_data() { |
  | 206 | 206 |  |
  | 207 |  | if ( ! wp\_verify\_nonce( $\_GET['demo\_data\_nonce'], 'get-demo-data' ) ) { |
  |  | 207 | if ( !current\_user\_can('import') || !current\_user\_can('install\_plugins') || ! wp\_verify\_nonce( $\_GET['demo\_data\_nonce'], 'get-demo-data' ) ) { |
  | 208 | 208 | die( 'This action was stopped for security purposes.' ); |
  | 209 | 209 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L457) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L457) |  |
  | 457 | 457 | \*/ |
  | 458 | 458 | public function plugin\_offline\_installer\_callback() { |
  | 459 |  | if ( !is\_admin() || !wp\_verify\_nonce( $\_POST['adi\_install\_pro\_plugin\_nonce'], 'adi\_install\_pro\_plugin\_nonce' ) ) { |
  |  | 459 | if ( !is\_admin() || !current\_user\_can('install\_plugins') || !wp\_verify\_nonce( $\_POST['adi\_install\_pro\_plugin\_nonce'], 'adi\_install\_pro\_plugin\_nonce' ) ) { |
  | 460 | 460 | die( 'This action was stopped for security purposes.' ); |
  | 461 | 461 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L628) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L628) |  |
  | 628 | 628 | \*/ |
  | 629 | 629 | public function ajax\_import\_xml() { |
  | 630 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 630 | if ( !current\_user\_can('import') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 631 | 631 | die( 'This action was stopped for security purposes.' ); |
  | 632 | 632 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L671) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L671) |  |
  | 671 | 671 | \*/ |
  | 672 | 672 | public function ajax\_import\_theme\_settings() { |
  | 673 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 673 | if ( !current\_user\_can('edit\_theme\_options') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 674 | 674 | die( 'This action was stopped for security purposes.' ); |
  | 675 | 675 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L708) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L708) |  |
  | 708 | 708 | \*/ |
  | 709 | 709 | public function ajax\_import\_widgets() { |
  | 710 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 710 | if ( !current\_user\_can('edit\_theme\_options') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 711 | 711 | die( 'This action was stopped for security purposes.' ); |
  | 712 | 712 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L743) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L743) |  |
  | 743 | 743 | \*/ |
  | 744 | 744 | public function ajax\_importSliderRev() { |
  | 745 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 745 | if ( !current\_user\_can('import') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 746 | 746 | die( 'This action was stopped for security purposes.' ); |
  | 747 | 747 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L789) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L789) |  |
  | 789 | 789 |  |
  | 790 | 790 | public function ajax\_importSliderSmart() { |
  | 791 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 791 | if ( !current\_user\_can('import') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 792 | 792 | die( 'This action was stopped for security purposes.' ); |
  | 793 | 793 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L829) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L829) |  |
  | 829 | 829 | \*/ |
  | 830 | 830 | public function ajax\_importThemeOptions() { |
  | 831 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 831 | if ( !current\_user\_can('edit\_theme\_options') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 832 | 832 | die( 'This action was stopped for security purposes.' ); |
  | 833 | 833 | } |
  | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2596766#L861) | […](/browser/access-demo-importer/trunk/inc/demo-functions.php?rev=2602132#L861) |  |
  | 861 | 861 | \*/ |
  | 862 | 862 | public function ajax\_after\_import() { |
  | 863 |  | if ( ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  |  | 863 | if ( !current\_user\_can('install\_plugins') || ! wp\_verify\_nonce( $\_POST['adi\_import\_demo\_data\_nonce'], 'adi\_import\_demo\_data\_nonce' ) ) { |
  | 864 | 864 | die( 'This action was stopped for security purposes.' ); |
  | 865 | 865 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2602132)
* [Zip Archive](?format=zip&new=2602132)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_8aa438f1_20250115_081345.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/10/High-Severity-Vulnerability-Patched-in-Access-Demo-Importer-Plugin.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

October 6, 2021

# High Severity Vulnerability Patched in Access Demo Importer Plugin

*Note: To receive disclosures like this in your inbox the moment they’re published, you can subscribe to our [WordPress Security Mailing List](https://www.wordfence.com/subscribe-to-the-wordfence-email-list/).*

On August 9, 2021, the Wordfence Threat Intelligence team attempted to initiate the responsible disclosure process for a vulnerability that we discovered in [Access Demo Importer](https://wordpress.org/plugins/access-demo-importer), a WordPress plugin installed on over 20,000 sites. This flaw made it possible for authenticated attackers with just subscriber level access to upload arbitrary files that could be used to achieve remote code execution. On sites with open registration, an anonymous user could easily register and exploit this vulnerability.

We initially attempted to reach out to the plugin vendor on August 9, 2021 and made a few additional attempts to get in contact with the vendor over the next few weeks. As the vendor failed to respond after 2 weeks despite multiple contact attempts, we escalated the issue to the WordPress.org plugins team. The plugins team responded immediately and closed the plugin for downloads on August 27, 2021, pending a full review. A partially patched version of the plugin was reopened for downloads around September 7, 2021. After following up with the developer and the WordPress plugins team, a fully patched version of the plugin was released on September 21, 2021.

Wordfence Premium users received a firewall rule to protect against any exploits targeting this vulnerability on August 9, 2021. Sites still using the free version of Wordfence received the same protection on September 8, 2021. As per our responsible disclosure policy, we are now fully disclosing the vulnerability details because enough time has elapsed since the fix was released.

If you have not already done so, we strongly recommend updating the latest version of the plugin available, 1.0.7, as soon as possible to ensure your site is not vulnerable to this security issue.

---

**Description:** Authenticated Arbitrary File Upload

**Affected Plugin:** Access Demo Importer

**Plugin Slug:** access-demo-importer

**Affected Versions:** <= 1.0.6

**CVE ID:** [CVE-2021-39317](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39317)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 1.0.7

Access Demo Importer is a plugin designed to import demo content for themes developed by AccessPress Themes. The importer functionality will import everything from content and photos, to plugins required to optimize a site’s functionality. One feature the plugin integrated was the ability to install plugins that are hosted outside of the WordPress.org repository during an import. Unfortunately, this functionality was insecurely implemented, making it possible for authenticated users to upload arbitrary files.

The plugin registers the `wp_ajax_plugin_offline_installer` AJAX action, which is tied to the `plugin_offline_installer_callback` function. This function takes the supplied `file_location`, which could be any external URL to a ZIP file, along with the other specifying parameters like `slug`, `class_name`, and `file`, and then retrieves the file’s contents and extracts the ZIP file to the plugins directory.

```
		public function plugin_offline_installer_callback() {
			$plugin = array();

			$file_location = $plugin['location'] = isset( $_POST['file_location'] ) ? sanitize_text_field( wp_unslash( $_POST['file_location'] ) ) : '';
			$file 			= isset( $_POST['file'] ) ? sanitize_text_field( wp_unslash( $_POST['file'] ) ) : '';
			$host_type 		= isset( $_POST['host_type'] ) ? sanitize_text_field( wp_unslash( $_POST['host_type'] ) ) : '';
			$plugin_class 	= $plugin['class'] = isset( $_POST['class_name'] ) ? sanitize_text_field( wp_unslash( $_POST['class_name'] ) ) : '';
			$plugin_slug 	= $plugin['slug'] = isset( $_POST['slug'] ) ? sanitize_text_field( wp_unslash( $_POST['slug'] ) ) : '';
			$plugin_directory = WP_PLUGIN_DIR;

			$plugin_file = $plugin_slug . '/' . $file;

			if( $host_type == 'remote' ) {
				$file_location = $this->get_local_dir_path($plugin);
			}

			$zip = new ZipArchive();
			if ($zip->open($file_location) === TRUE) {
			    $zip->extractTo($plugin_directory);
			    $zip->close();

			    activate_plugin($plugin_file);

			    if( $host_type == 'remote' ) {
		    		unlink($file_location);
		    	}

			    echo 'success';

				die();
			} else {
			    echo 'failed';
			}

			die();
		}
```

Unfortunately, this function had no capability check, nor any nonce checks, which made it possible for authenticated users with minimal permissions, like subscribers, to install a zip file as a “plugin” from an external source. This “plugin” zip file could contain malicious PHP files, including webshells, that could be used to achieve remote code execution once extracted and ultimately be used to completely take over a site.

## Disclosure Timeline

**August 9, 2021** – Conclusion of the plugin analysis that led to the discovery of an arbitrary file upload vulnerability in the Access Demo Importer WordPress plugin. We develop a firewall rule to protect Wordfence customers and release it to Wordfence Premium users. We make an initial contact attempt with the plugin’s vendor.

**August 10, 2021** – We discover an additional method to contact the plugin’s vendor and send another initial contact message.

**August 18, 2021** – After no response, we attempt to reach out to the vendor again via a different contact.

**August 27, 2021** – Due to no response, we reach out to the WordPress plugins teams and send over full disclosure details. The plugin is temporarily closed for downloads on the same day.

**September 7, 2021** – The plugin is reopened for downloads containing a partial patch for the vulnerability. We attempt to reach out to the vendor, who responded to us after the WordPress.org team got in contact with them, to inform them that the plugin is still missing capability checks.

**September 8, 2021** – Wordfence free users receive the firewall rule.

**September 20, 2021** – We follow-up with the WordPress plugins team after no response from the developer again. They respond and let us know that they have informed the developer about the missing capability checks.

**September 21, 2021** – A fully patched version of the plugin is released as version 1.0.7.

## Conclusion

In today’s post, we detailed a flaw in Access Demo Importer that granted authenticated attackers the ability to upload arbitrary files, allowing them to perform remote code execution. This flaw was fully patched in version 1.0.7. We recommend that WordPress users immediately update to the latest version available, which is version 1.0.7 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20211006&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule to protect against any exploits targeting this vulnerability on August 9, 2021. Sites still using the free version of Wordfence received the same protection on September 8, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as this is a critical vulnerability that can lead to complete site takeover.

If your site has been compromised by an attack on this or any other plugin, our [Professional Site Cleaning services](https://www.wordfence.com/wordfence-site-cleanings/?promo_id=blog20211006&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) can help you get back in business.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fhigh-severity-vulnerability-patched-in-access-demo-importer-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fhigh-severity-vulnerability-patched-in-access-demo-importer-plugin%2F&text=High%20Severity%20Vulnerability%20Patched%20in%20Access%20Demo%20Importer%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fhigh-severity-vulnerability-patched-in-access-demo-importer-plugin%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


