```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2021-39242",
      "root_cause": "Mismatch between the `:authority` and `Host` headers in HTTP/2 requests.",
      "weaknesses": [
        "The HTTP/2 specification implicitly allows the `Host` header and the `:authority` header field to differ. HAProxy uses the Host header for routing decisions and drops it when forwarding to HTTP/2 backend server, relying on :authority to be used as the Host header at the backend server.",
        "HAProxy doesn't ensure that the `Host` header matches the value of the `:authority` field before forwarding requests to the backend HTTP/2 server. "
      ],
      "impact": "An attacker can control the `Host` header seen by the backend HTTP/2 server. This can lead to routing to a different server if HAProxy makes routing decisions based on the `Host` header.",
       "attack_vectors": [
        "The attacker sends a crafted HTTP/2 request with a different value in the `:authority` field and the `Host` header."
      ],
      "required_attacker_capabilities": "The attacker needs to be able to send HTTP/2 requests to HAProxy."
    }
  ],
  "additional_notes": [
    "The vulnerability is present in HAProxy versions 2.2, 2.3, 2.4, and 2.5-dev prior to the patched versions.",
      "A workaround is to use the `http-request set-uri %[url]` rule in the frontend to rewrite the URI and synchronize the `Host` header with the `:authority` field before processing routing rules based on the `Host` header. ",
      "The fix is implemented by ignoring the `Host` header and using the `:authority` field to generate the backend server's Host header, which is more consistent with the expected behavior.",
       "This issue only affects HTTP/2 backend servers."
  ]
}
```