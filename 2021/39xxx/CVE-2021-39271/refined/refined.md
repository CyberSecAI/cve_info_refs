```
{
  "CVE-2021-39271": {
    "Description": "Authenticated RCE in BSCW Server",
    "Root cause": "The application allows a user with low privileges to upload archives (ZIP, tar, RFC822) and extract them on the server. During extraction, a special file (`.bscw`) is processed to attach metadata. This metadata file contains an attribute (`class`) used to instantiate a class/call a function. Lack of an allow-list for the class/function allows calling an arbitrary Python function.",
    "Weaknesses": [
      "Unrestricted file upload and extraction.",
      "Lack of input validation for the `class` attribute in the `.bscw` metadata file.",
      "Ability to call arbitrary Python functions using the `class` attribute.",
       "Use of a deprecated Python function `os.popen2` which leads to command injection."
    ],
    "Impact": "Remote Code Execution (RCE). An attacker can execute arbitrary commands on the server.",
    "Attack vectors": [
      "Upload a malicious archive containing a crafted `.bscw` file.",
       "Trigger the extraction process on the uploaded archive."
    ],
     "Required attacker capabilities/position": [
      "Low privilege user with write access to a folder within the BSCW system."
      "Ability to authenticate to the BSCW server."
    ],
    "Additional Details": [
        "The vulnerability is in the `bs_extract.py` script that handles archive extraction.",
        "The `class` attribute of the metadata is directly used to call an arbitrary python function",
        "The `bscw:name` attribute is used as a parameter of the called function",
        "The vulnerable versions of BSCW use Python 2.x and `os.popen2` can be exploited",
         "The vulnerability can be used to overwrite the `config.py` file and create a persistent shell",
          "The `bscw.cgi` script has the SGID flag set, allowing write access to `config.py` even when the process is run as the webserver user `www-data`",
          "A simple HTTP request can be used to trigger the installed shell to execute system commands."
     ]
  }
}
```