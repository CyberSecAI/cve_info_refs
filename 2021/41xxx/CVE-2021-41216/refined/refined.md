The content is related to CVE-2021-41216.

**Root cause of vulnerability:**
The shape inference function for the `Transpose` operation in TensorFlow does not properly validate negative indices in the `perm` argument.

**Weaknesses/vulnerabilities present:**
- Heap buffer overflow in the `Transpose` shape inference function.
- Missing validation of negative indices in the `perm` argument.

**Impact of exploitation:**
A heap buffer overflow can occur, potentially leading to denial of service, arbitrary code execution, or other undefined behavior.

**Attack vectors:**
- By providing a `perm` argument with negative indices to the `tf.raw_ops.Transpose` operation.
- Specifically, negative indices that are out of the valid range (less than `-rank`, where `rank` is the tensor rank) cause the overflow.

**Required attacker capabilities/position:**
- An attacker needs to be able to control the `perm` argument of the `tf.raw_ops.Transpose` function within a TensorFlow graph.
- The attacker doesn't need to be local, as this is a problem within the function itself, so it's exploitable wherever TensorFlow is running.

**Additional details:**
- The vulnerability exists in TensorFlow versions before 2.7.0.
- Patches are included in versions 2.4.4, 2.5.2, and 2.6.1.
- The provided code example demonstrates how to trigger the vulnerability by passing a `perm` argument with a negative value (-10) that is out of range.
- The fix implemented in commit `c79ba87153ee343401dbe9d1954d7f79e521eb14` validates that negative perm values are within the tensor's rank.
- The vulnerability was reported by members of the Aivul Team from Qihoo 360.