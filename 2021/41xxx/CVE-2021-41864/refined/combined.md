=== Content from lists.fedoraproject.org_db3c01a7_20250114_180531.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7.mbox.gz?message=LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/#LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7)

# [SECURITY] Fedora 33 Update: kernel-5.14.10-100.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

11 Oct
2021

11 Oct
'21

11:36 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-9dd76a1ed0
2021-10-11 21:35:46.575779
--------------------------------------------------------------------------------

Name : kernel
Product : Fedora 33
Version : 5.14.10
Release : 100.fc33
URL : <https://www.kernel.org/>
Summary : The Linux kernel
Description :
The kernel meta package

--------------------------------------------------------------------------------
Update Information:

The 5.14.10 stable kernel update contains a number of important fixes across the
tree
--------------------------------------------------------------------------------
ChangeLog:

\* Thu Oct 7 2021 Justin M. Forbes jforbes@fedoraproject.org [5.14.10-0]
- Revert "net: stmmac: dwmac-rk: fix unbalanced pm\_runtime\_enable warnings" (Peter Robinson)
- e100e: Fix packet loss issues seen on Intel network controller (Mark Pearson)
- bpf: Fix integer overflow in prealloc\_elems\_and\_freelist() (Tatsuhiko Yasumatsu)
- Revert "acpi: prefer booting with ACPI over DTS" (Justin M. Forbes)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2000627 - CVE-2021-3744 kernel: crypto: ccp - fix resource leaks in ccp\_run\_aes\_gcm\_cmd()
<https://bugzilla.redhat.com/show_bug.cgi?id=2000627>
[ 2 ] Bug #2010463 - CVE-2021-41864 kernel: eBPF multiplication integer overflow in prealloc\_elems\_and\_freelist() in kernel/bpf/stackmap.c leads to out-of-bounds write
<https://bugzilla.redhat.com/show_bug.cgi?id=2010463>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-9dd76a1ed0' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7/#LAT3RERO6QBKSPJBNNRWY3D4NCGTFOS7)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.debian.org_1447e1a3_20250114_180530.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 2941-1] linux-4.19 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2941-1] linux-4.19 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Wed, 9 Mar 2022 13:40:55 +0100
* *Message-id*: <[[🔎]](/msgid-search/YiigV99QQ%2BwYNpB3%40decadent.org.uk) [YiigV99QQ+wYNpB3@decadent.org.uk](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2941-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
March 09, 2022                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-4.19
Version        : 4.19.232-1~deb9u1
CVE ID         : CVE-2020-29374 CVE-2020-36322 CVE-2021-3640 CVE-2021-3744
                 CVE-2021-3752 CVE-2021-3760 CVE-2021-3764 CVE-2021-3772
                 CVE-2021-4002 CVE-2021-4083 CVE-2021-4135 CVE-2021-4155
                 CVE-2021-4203 CVE-2021-20317 CVE-2021-20321 CVE-2021-20322
                 CVE-2021-22600 CVE-2021-28711 CVE-2021-28712 CVE-2021-28713
                 CVE-2021-28714 CVE-2021-28715 CVE-2021-28950 CVE-2021-38300
                 CVE-2021-39685 CVE-2021-39686 CVE-2021-39698 CVE-2021-39713
                 CVE-2021-41864 CVE-2021-42739 CVE-2021-43389 CVE-2021-43975
                 CVE-2021-43976 CVE-2021-44733 CVE-2021-45095 CVE-2021-45469
                 CVE-2021-45480 CVE-2022-0001 CVE-2022-0002 CVE-2022-0322
                 CVE-2022-0330 CVE-2022-0435 CVE-2022-0487 CVE-2022-0492
                 CVE-2022-0617 CVE-2022-0644 CVE-2022-22942 CVE-2022-24448
                 CVE-2022-24959 CVE-2022-25258 CVE-2022-25375
Debian Bug     : 988044 989285 990411 994050

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2020-29374

    Jann Horn of Google reported a flaw in Linux's virtual memory
    management.  A parent and child process initially share all their
    memory, but when either writes to a shared page, the page is
    duplicated and unshared (copy-on-write).  However, in case an
    operation such as vmsplice() required the kernel to take an
    additional reference to a shared page, and a copy-on-write occurs
    during this operation, the kernel might have accessed the wrong
    process's memory.  For some programs, this could lead to an
    information leak or data corruption.

    This issue was already fixed for most architectures, but not on
    MIPS and System z.  This update corrects that.

CVE-2020-36322, CVE-2021-28950

    The syzbot tool found that the FUSE (filesystem-in-user-space)
    implementation did not correctly handle a FUSE server returning
    invalid attributes for a file.  A local user permitted to run a
    FUSE server could use this to cause a denial of service (crash).

    The original fix for this introduced a different potential denial
    of service (infinite loop in kernel space), which has also been
    fixed.

CVE-2021-3640

    Lin Ma discovered a race condiiton in the Bluetooth protocol
    implementation that can lead to a use-after-free.  A local
    user could exploit this to cause a denial of service (memory
    corruption or crash) or possibly for privilege escalation.

CVE-2021-3744, CVE-2021-3764

    minihanshen reported bugs in the ccp driver for AMD
    Cryptographic Coprocessors that could lead to a resource leak.
    On systems using this driver, a local user could exploit this to
    cause a denial of service.

CVE-2021-3752

    Likang Luo of NSFOCUS Security Team discovered a flaw in the
    Bluetooth L2CAP implementation that can lead to a user-after-free.
    A local user could exploit this to cause a denial of service
    (memory corruption or crash) or possibly for privilege escalation.

CVE-2021-3760, CVE-2021-4202

    Lin Ma discovered race conditions in the NCI (NFC Controller
    Interface) driver, which could lead to a use-after-free.  A local
    user could exploit this to cause a denial of service (memory
    corruption or crash) or possibly for privilege escalation.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2021-3772

    A flaw was found in the SCTP protocol implementation, which would
    allow a networked attacker to break an SCTP association.  The
    attacker would only need to know or guess the IP addresses and
    ports for the association.

CVE-2021-4002

    It was discovered that hugetlbfs, the virtual filesystem used by
    applications to allocate huge pages in RAM, did not flush the
    CPU's TLB in one case where it was necessary.  In some
    circumstances a local user would be able to read and write huge
    pages after they are freed and reallocated to a different process.
    This could lead to privilege escalation, denial of service or
    information leaks.

CVE-2021-4083

    Jann Horn reported a race condition in the local (Unix) sockets
    garbage collector, that can lead to use-after-free.  A local user
    could exploit this to cause a denial of service (memory corruption
    or crash) or possibly for privilege escalation.

CVE-2021-4135

    A flaw was found in the netdevsim driver which would lead to an
    information leak.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2021-4155

    Kirill Tkhai discovered a data leak in the way the XFS_IOC_ALLOCSP
    IOCTL in the XFS filesystem allowed for a size increase of files
    with unaligned size. A local attacker can take advantage of this
    flaw to leak data on the XFS filesystem.

CVE-2021-4203

    Jann Horn reported a race condition in the local (Unix) sockets
    implementation that can lead to a use-after-free.  A local user
    could exploit this to leak sensitive information from the kernel.

CVE-2021-20317

    It was discovered that the timer queue structure could become
    corrupt, leading to waiting tasks never being woken up.  A local
    user with certain privileges could exploit this to cause a denial
    of service (system hang).

CVE-2021-20321

    A race condition was discovered in the overlayfs filesystem
    driver.  A local user with access to an overlayfs mount and to its
    underlying upper directory could exploit this for privilege
    escalation.

CVE-2021-20322

    An information leak was discovered in the IPv4 implementation.  A
    remote attacker could exploit this to quickly discover which UDP
    ports a system is using, making it easier for them to carry out a
    DNS poisoning attack against that system.

CVE-2021-22600

    The syzbot tool found a flaw in the packet socket (AF_PACKET)
    implementation which could lead to incorrectly freeing memory.  A
    local user with CAP_NET_RAW capability (in any user namespace)
    could exploit this for denial of service (memory corruption or
    crash) or possibly for privilege escalation.

CVE-2021-28711, CVE-2021-28712, CVE-2021-28713 (XSA-391)

    Juergen Gross reported that malicious PV backends can cause a denial
    of service to guests being serviced by those backends via high
    frequency events, even if those backends are running in a less
    privileged environment.

CVE-2021-28714, CVE-2021-28715 (XSA-392)

    Juergen Gross discovered that Xen guests can force the Linux
    netback driver to hog large amounts of kernel memory, resulting in
    denial of service.

CVE-2021-38300

    Piotr Krysiuk discovered a flaw in the classic BPF (cBPF) JIT
    compiler for MIPS architectures.  A local user could exploit
    this to excute arbitrary code in the kernel.

    This issue is mitigated by setting sysctl
    net.core.bpf_jit_enable=0, which is the default.  It is *not*
    mitigated by disabling unprivileged use of eBPF.

CVE-2021-39685

    Szymon Heidrich discovered a buffer overflow vulnerability in the
    USB gadget subsystem, resulting in information disclosure, denial of
    service or privilege escalation.

CVE-2021-39686

    A race condition was discovered in the Android binder driver, that
    could lead to incorrect security checks.  On systems where the
    binder driver is loaded, a local user could exploit this for
    privilege escalation.

CVE-2021-39698

    Linus Torvalds reported a flaw in the file polling implementation,
    which could lead to a use-after-free.  A local user could exploit
    this for denial of service (memory corruption or crash) or
    possibly for privilege escalation.

CVE-2021-39713

    The syzbot tool found a race condition in the network scheduling
    subsystem which could lead to a use-after-free.  A local user
    could exploit this for denial of service (memory corruption or
    crash) or possibly for privilege escalation.

CVE-2021-41864

    An integer overflow was discovered in the Extended BPF (eBPF)
    subsystem.  A local user could exploit this for denial of service
    (memory corruption or crash), or possibly for privilege
    escalation.

    This can be mitigated by setting sysctl
    kernel.unprivileged_bpf_disabled=1, which disables eBPF use by
    unprivileged users.

CVE-2021-42739

    A heap buffer overflow was discovered in the firedtv driver for
    FireWire-connected DVB receivers.  A local user with access to a
    firedtv device could exploit this for denial of service (memory
    corruption or crash), or possibly for privilege escalation.

CVE-2021-43389

    The Active Defense Lab of Venustech discovered a flaw in the CMTP
    subsystem as used by Bluetooth, which could lead to an
    out-of-bounds read and object type confusion.  A local user with
    CAP_NET_ADMIN capability in the initial user namespace could
    exploit this for denial of service (memory corruption or crash),
    or possibly for privilege escalation.

CVE-2021-43975

    Brendan Dolan-Gavitt reported a flaw in the
    hw_atl_utils_fw_rpc_wait() function in the aQuantia AQtion ethernet
    device driver which can result in denial of service or the execution
    of arbitrary code.

CVE-2021-43976

    Zekun Shen and Brendan Dolan-Gavitt discovered a flaw in the
    mwifiex_usb_recv() function of the Marvell WiFi-Ex USB Driver. An
    attacker able to connect a crafted USB device can take advantage of
    this flaw to cause a denial of service.

CVE-2021-44733

    A race condition was discovered in the Trusted Execution
    Environment (TEE) subsystem for Arm processors, which could lead
    to a use-after-free.  A local user permitted to access a TEE
    device could exploit this for denial of service (memory corruption
    or crash) or possibly for privilege escalation.

CVE-2021-45095

    It was discovered that the Phone Network protocol (PhoNet) driver
    has a reference count leak in the pep_sock_accept() function.

CVE-2021-45469

    Wenqing Liu reported an out-of-bounds memory access in the f2fs
    implementation if an inode has an invalid last xattr entry. An
    attacker able to mount a specially crafted image can take advantage
    of this flaw for denial of service.

CVE-2021-45480

    A memory leak flaw was discovered in the __rds_conn_create()
    function in the RDS (Reliable Datagram Sockets) protocol subsystem.

CVE-2022-0001 (INTEL-SA-00598)

    Researchers at VUSec discovered that the Branch History Buffer in
    Intel processors can be exploited to create information side-
    channels with speculative execution.  This issue is similar to
    Spectre variant 2, but requires additional mitigations on some
    processors.

    This can be exploited to obtain sensitive information from a
    different security context, such as from user-space to the kernel,
    or from a KVM guest to the kernel.

CVE-2022-0002 (INTEL-SA-00598)

    This is a similar issue to CVE-2022-0001, but covers exploitation
    within a security context, such as from JIT-compiled code in a
    sandbox to hosting code in the same process.

    This can be partly mitigated by disabling eBPF for unprivileged
    users with the sysctl: kernel.unprivileged_bpf_disabled=2.  This
    update does that by default.

CVE-2022-0322

    Eiichi Tsukata discovered a flaw in the sctp_make_strreset_req()
    function in the SCTP network protocol implementation which can
    result in denial of service.

CVE-2022-0330

    Sushma Venkatesh Reddy discovered a missing GPU TLB flush in the
    i915 driver, resulting in denial of service or privilege escalation.

CVE-2022-0435

    Samuel Page and Eric Dumazet reported a stack overflow in the
    networking module for the Transparent Inter-Process Communication
    (TIPC) protocol, resulting in denial of service or potentially the
    execution of arbitrary code.

CVE-2022-0487

    A use-after-free was discovered in the MOXART SD/MMC Host Controller
    support driver. This flaw does not impact the Debian binary packages
    as CONFIG_MMC_MOXART is not set.

CVE-2022-0492

    Yiqi Sun and Kevin Wang reported that the cgroup-v1 subsystem does
    not properly restrict access to the release-agent feature. A local
    user can take advantage of this flaw for privilege escalation and
    bypass of namespace isolation.

CVE-2022-0617

    butt3rflyh4ck discovered a NULL pointer dereference in the UDF
    filesystem. A local user that can mount a specially crafted UDF
    image can use this flaw to crash the system.

CVE-2022-0644

    Hao Sun reported a missing check for file read permission in the
    finit_module() and kexec_file_load() system calls.  The security
    impact of this is unclear, since these system calls are usually
    only available to the root user.

CVE-2022-22942

    It was discovered that wrong file file descriptor handling in the
    VMware Virtual GPU driver (vmwgfx) could result in information leak
    or privilege escalation.

CVE-2022-24448

    Lyu Tao reported a flaw in the NFS implementation in the Linux
    kernel when handling requests to open a directory on a regular file,
    which could result in a information leak.

CVE-2022-24959

    A memory leak was discovered in the yam_siocdevprivate() function of
    the YAM driver for AX.25, which could result in denial of service.

CVE-2022-25258

    Szymon Heidrich reported the USB Gadget subsystem lacks certain
    validation of interface OS descriptor requests, resulting in memory
    corruption.

CVE-2022-25375

    Szymon Heidrich reported that the RNDIS USB gadget lacks validation
    of the size of the RNDIS_MSG_SET command, resulting in information
    leak from kernel memory.

For Debian 9 stretch, these problems have been fixed in version
4.19.232-1~deb9u1.  This update additionally includes many more bug
fixes from stable updates 4.19.209-4.19.232 inclusive.

We recommend that you upgrade your linux-4.19 packages.

For the detailed security status of linux-4.19 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-4.19>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpTZkVodrlDJ.pgp)**

*Description:* PGP signature

---



=== Content from www.debian.org_9dfdb833_20250114_180532.html ===


---

[[Date Prev](msg00062.html)][[Date Next](msg00064.html)]
[[Thread Prev](msg00062.html)][[Thread Next](msg00064.html)]
[[Date Index](maillist.html#00063)]
[[Thread Index](threads.html#00063)]

# [SECURITY] [DSA 5096-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5096-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Wed, 09 Mar 2022 15:30:58 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1nRyHC-0004Le-Lx%40seger.debian.org) [E1nRyHC-0004Le-Lx@seger.debian.org](msg00063.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5096-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
March 09, 2022                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2020-29374 CVE-2020-36322 CVE-2021-3640 CVE-2021-3744
                 CVE-2021-3752 CVE-2021-3760 CVE-2021-3764 CVE-2021-3772
                 CVE-2021-4002 CVE-2021-4083 CVE-2021-4135 CVE-2021-4155
                 CVE-2021-4203 CVE-2021-20317 CVE-2021-20321 CVE-2021-20322
                 CVE-2021-22600 CVE-2021-28711 CVE-2021-28712 CVE-2021-28713
                 CVE-2021-28714 CVE-2021-28715 CVE-2021-28950 CVE-2021-38300
                 CVE-2021-39685 CVE-2021-39686 CVE-2021-39698 CVE-2021-39713
                 CVE-2021-41864 CVE-2021-42739 CVE-2021-43389 CVE-2021-43975
                 CVE-2021-43976 CVE-2021-44733 CVE-2021-45095 CVE-2021-45469
                 CVE-2021-45480 CVE-2022-0001 CVE-2022-0002 CVE-2022-0322
                 CVE-2022-0330 CVE-2022-0435 CVE-2022-0487 CVE-2022-0492
                 CVE-2022-0617 CVE-2022-0644 CVE-2022-22942 CVE-2022-24448
                 CVE-2022-24959 CVE-2022-25258 CVE-2022-25375
Debian Bug     : 988044 989285 990411 994050

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2020-29374

    Jann Horn of Google reported a flaw in Linux's virtual memory
    management.  A parent and child process initially share all their
    memory, but when either writes to a shared page, the page is
    duplicated and unshared (copy-on-write).  However, in case an
    operation such as vmsplice() required the kernel to take an
    additional reference to a shared page, and a copy-on-write occurs
    during this operation, the kernel might have accessed the wrong
    process's memory.  For some programs, this could lead to an
    information leak or data corruption.

    This issue was already fixed for most architectures, but not on
    MIPS and System z.  This update corrects that.

CVE-2020-36322, CVE-2021-28950

    The syzbot tool found that the FUSE (filesystem-in-user-space)
    implementation did not correctly handle a FUSE server returning
    invalid attributes for a file.  A local user permitted to run a
    FUSE server could use this to cause a denial of service (crash).

    The original fix for this introduced a different potential denial
    of service (infinite loop in kernel space), which has also been
    fixed.

CVE-2021-3640

    Lin Ma discovered a race condiiton in the Bluetooth protocol
    implementation that can lead to a use-after-free.  A local
    user could exploit this to cause a denial of service (memory
    corruption or crash) or possibly for privilege escalation.

CVE-2021-3744, CVE-2021-3764

    minihanshen reported bugs in the ccp driver for AMD
    Cryptographic Coprocessors that could lead to a resource leak.
    On systems using this driver, a local user could exploit this to
    cause a denial of service.

CVE-2021-3752

    Likang Luo of NSFOCUS Security Team discovered a flaw in the
    Bluetooth L2CAP implementation that can lead to a user-after-free.
    A local user could exploit this to cause a denial of service
    (memory corruption or crash) or possibly for privilege escalation.

CVE-2021-3760, CVE-2021-4202

    Lin Ma discovered race conditions in the NCI (NFC Controller
    Interface) driver, which could lead to a use-after-free.  A local
    user could exploit this to cause a denial of service (memory
    corruption or crash) or possibly for privilege escalation.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2021-3772

    A flaw was found in the SCTP protocol implementation, which would
    allow a networked attacker to break an SCTP association.  The
    attacker would only need to know or guess the IP addresses and
    ports for the association.

CVE-2021-4002

    It was discovered that hugetlbfs, the virtual filesystem used by
    applications to allocate huge pages in RAM, did not flush the
    CPU's TLB in one case where it was necessary.  In some
    circumstances a local user would be able to read and write huge
    pages after they are freed and reallocated to a different process.
    This could lead to privilege escalation, denial of service or
    information leaks.

CVE-2021-4083

    Jann Horn reported a race condition in the local (Unix) sockets
    garbage collector, that can lead to use-after-free.  A local user
    could exploit this to cause a denial of service (memory corruption
    or crash) or possibly for privilege escalation.

CVE-2021-4135

    A flaw was found in the netdevsim driver which would lead to an
    information leak.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2021-4155

    Kirill Tkhai discovered a data leak in the way the XFS_IOC_ALLOCSP
    IOCTL in the XFS filesystem allowed for a size increase of files
    with unaligned size. A local attacker can take advantage of this
    flaw to leak data on the XFS filesystem.

CVE-2021-4203

    Jann Horn reported a race condition in the local (Unix) sockets
    implementation that can lead to a use-after-free.  A local user
    could exploit this to leak sensitive information from the kernel.

CVE-2021-20317

    It was discovered that the timer queue structure could become
    corrupt, leading to waiting tasks never being woken up.  A local
    user with certain privileges could exploit this to cause a denial
    of service (system hang).

CVE-2021-20321

    A race condition was discovered in the overlayfs filesystem
    driver.  A local user with access to an overlayfs mount and to its
    underlying upper directory could exploit this for privilege
    escalation.

CVE-2021-20322

    An information leak was discovered in the IPv4 implementation.  A
    remote attacker could exploit this to quickly discover which UDP
    ports a system is using, making it easier for them to carry out a
    DNS poisoning attack against that system.

CVE-2021-22600

    The syzbot tool found a flaw in the packet socket (AF_PACKET)
    implementation which could lead to incorrectly freeing memory.  A
    local user with CAP_NET_RAW capability (in any user namespace)
    could exploit this for denial of service (memory corruption or
    crash) or possibly for privilege escalation.

CVE-2021-28711, CVE-2021-28712, CVE-2021-28713 (XSA-391)

    Juergen Gross reported that malicious PV backends can cause a denial
    of service to guests being serviced by those backends via high
    frequency events, even if those backends are running in a less
    privileged environment.

CVE-2021-28714, CVE-2021-28715 (XSA-392)

    Juergen Gross discovered that Xen guests can force the Linux
    netback driver to hog large amounts of kernel memory, resulting in
    denial of service.

CVE-2021-38300

    Piotr Krysiuk discovered a flaw in the classic BPF (cBPF) JIT
    compiler for MIPS architectures.  A local user could exploit
    this to excute arbitrary code in the kernel.

    This issue is mitigated by setting sysctl
    net.core.bpf_jit_enable=0, which is the default.  It is *not*
    mitigated by disabling unprivileged use of eBPF.

CVE-2021-39685

    Szymon Heidrich discovered a buffer overflow vulnerability in the
    USB gadget subsystem, resulting in information disclosure, denial of
    service or privilege escalation.

CVE-2021-39686

    A race condition was discovered in the Android binder driver, that
    could lead to incorrect security checks.  On systems where the
    binder driver is loaded, a local user could exploit this for
    privilege escalation.

CVE-2021-39698

    Linus Torvalds reported a flaw in the file polling implementation,
    which could lead to a use-after-free.  A local user could exploit
    this for denial of service (memory corruption or crash) or
    possibly for privilege escalation.

CVE-2021-39713

    The syzbot tool found a race condition in the network scheduling
    subsystem which could lead to a use-after-free.  A local user
    could exploit this for denial of service (memory corruption or
    crash) or possibly for privilege escalation.

CVE-2021-41864

    An integer overflow was discovered in the Extended BPF (eBPF)
    subsystem.  A local user could exploit this for denial of service
    (memory corruption or crash), or possibly for privilege
    escalation.

    This can be mitigated by setting sysctl
    kernel.unprivileged_bpf_disabled=1, which disables eBPF use by
    unprivileged users.

CVE-2021-42739

    A heap buffer overflow was discovered in the firedtv driver for
    FireWire-connected DVB receivers.  A local user with access to a
    firedtv device could exploit this for denial of service (memory
    corruption or crash), or possibly for privilege escalation.

CVE-2021-43389

    The Active Defense Lab of Venustech discovered a flaw in the CMTP
    subsystem as used by Bluetooth, which could lead to an
    out-of-bounds read and object type confusion.  A local user with
    CAP_NET_ADMIN capability in the initial user namespace could
    exploit this for denial of service (memory corruption or crash),
    or possibly for privilege escalation.

CVE-2021-43975

    Brendan Dolan-Gavitt reported a flaw in the
    hw_atl_utils_fw_rpc_wait() function in the aQuantia AQtion ethernet
    device driver which can result in denial of service or the execution
    of arbitrary code.

CVE-2021-43976

    Zekun Shen and Brendan Dolan-Gavitt discovered a flaw in the
    mwifiex_usb_recv() function of the Marvell WiFi-Ex USB Driver. An
    attacker able to connect a crafted USB device can take advantage of
    this flaw to cause a denial of service.

CVE-2021-44733

    A race condition was discovered in the Trusted Execution
    Environment (TEE) subsystem for Arm processors, which could lead
    to a use-after-free.  A local user permitted to access a TEE
    device could exploit this for denial of service (memory corruption
    or crash) or possibly for privilege escalation.

CVE-2021-45095

    It was discovered that the Phone Network protocol (PhoNet) driver
    has a reference count leak in the pep_sock_accept() function.

CVE-2021-45469

    Wenqing Liu reported an out-of-bounds memory access in the f2fs
    implementation if an inode has an invalid last xattr entry. An
    attacker able to mount a specially crafted image can take advantage
    of this flaw for denial of service.

CVE-2021-45480

    A memory leak flaw was discovered in the __rds_conn_create()
    function in the RDS (Reliable Datagram Sockets) protocol subsystem.

CVE-2022-0001 (INTEL-SA-00598)

    Researchers at VUSec discovered that the Branch History Buffer in
    Intel processors can be exploited to create information side-
    channels with speculative execution.  This issue is similar to
    Spectre variant 2, but requires additional mitigations on some
    processors.

    This can be exploited to obtain sensitive information from a
    different security context, such as from user-space to the kernel,
    or from a KVM guest to the kernel.

CVE-2022-0002 (INTEL-SA-00598)

    This is a similar issue to CVE-2022-0001, but covers exploitation
    within a security context, such as from JIT-compiled code in a
    sandbox to hosting code in the same process.

    This can be partly mitigated by disabling eBPF for unprivileged
    users with the sysctl: kernel.unprivileged_bpf_disabled=2.  This
    update does that by default.

CVE-2022-0322

    Eiichi Tsukata discovered a flaw in the sctp_make_strreset_req()
    function in the SCTP network protocol implementation which can
    result in denial of service.

CVE-2022-0330

    Sushma Venkatesh Reddy discovered a missing GPU TLB flush in the
    i915 driver, resulting in denial of service or privilege escalation.

CVE-2022-0435

    Samuel Page and Eric Dumazet reported a stack overflow in the
    networking module for the Transparent Inter-Process Communication
    (TIPC) protocol, resulting in denial of service or potentially the
    execution of arbitrary code.

CVE-2022-0487

    A use-after-free was discovered in the MOXART SD/MMC Host Controller
    support driver. This flaw does not impact the Debian binary packages
    as CONFIG_MMC_MOXART is not set.

CVE-2022-0492

    Yiqi Sun and Kevin Wang reported that the cgroup-v1 subsystem does
    not properly restrict access to the release-agent feature. A local
    user can take advantage of this flaw for privilege escalation and
    bypass of namespace isolation.

CVE-2022-0617

    butt3rflyh4ck discovered a NULL pointer dereference in the UDF
    filesystem. A local user that can mount a specially crafted UDF
    image can use this flaw to crash the system.

CVE-2022-0644

    Hao Sun reported a missing check for file read permission in the
    finit_module() and kexec_file_load() system calls.  The security
    impact of this is unclear, since these system calls are usually
    only available to the root user.

CVE-2022-22942

    It was discovered that wrong file file descriptor handling in the
    VMware Virtual GPU driver (vmwgfx) could result in information leak
    or privilege escalation.

CVE-2022-24448

    Lyu Tao reported a flaw in the NFS implementation in the Linux
    kernel when handling requests to open a directory on a regular file,
    which could result in a information leak.

CVE-2022-24959

    A memory leak was discovered in the yam_siocdevprivate() function of
    the YAM driver for AX.25, which could result in denial of service.

CVE-2022-25258

    Szymon Heidrich reported the USB Gadget subsystem lacks certain
    validation of interface OS descriptor requests, resulting in memory
    corruption.

CVE-2022-25375

    Szymon Heidrich reported that the RNDIS USB gadget lacks validation
    of the size of the RNDIS_MSG_SET command, resulting in information
    leak from kernel memory.

For the oldstable distribution (buster), these problems have been
fixed in version 4.19.232-1.  This update additionally includes many
more bug fixes from stable updates 4.19.209-4.19.232 inclusive.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmIotm1fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0RcGg//QBgf4RfElxd+11a+BZ9HWJFBjA5Wp2VStf1+inoZ7X/En7W9QBpVvmks
Jum5QFpvA1waEP0zk0/O5MKXHtMbRMFdj0UUYQM7Vi3/vfeP73C10YmXv2yfG2Fw
dTGnVHpvvdJSbNzxMG4jruNY5b0Bf/WEQSqtuOM6V2aBiI7Y2pSI6Ak/dvexiu+0
ycz6PTDkX66e/p7NONw+B33L8yTMj9yu1cCdoYdrDihVlrESgbMLHUWO9JKRQykk
tsI2a79OIEkaj+yQwfkJu9njoPUTn6OZYUYxD8XaN8XtkDpwx1oVsiyqpslJEmgR
vaS1DOEnIZXsq2pscSPeKfFM30uFgqAxkQm/zUpjGGSXib58xaaf/c61LCQoMU2g
cSc+8+N1S2Lbcscdxd9TumvrOGJVuP/q/FqcOl4npcz1WLZRmc9f9IprdqUEy2iJ
+YLSrFFOfhgMMP0El6KJvG/8Jz60UEAiWuYutT508w1jIRrvMRLW4i6V3NXHrNkx
GDofOfPF8jNdt2Www+2sqEY51f+w2kffOSAnHGGPCASvWpuXFOw9ZyxnuyRRKKBE
no9PH0X71a636sZGh8bIU25PSKQlhtlAfCP+0Fef7PeEKTz1MJf8Nvo+vgCIsani
eGWa9jzdkVxHDEjxplX0stsByglCYyud7JSI1ZE9oLtJU1/xDBc=
=5fQT
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_75ba9c65_20250114_180530.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 2843-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2843-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Thu, 16 Dec 2021 22:27:40 +0100
* *Message-id*: <[[🔎]](/msgid-search/YbuvTLjOg3K0RE4J%40decadent.org.uk) [YbuvTLjOg3K0RE4J@decadent.org.uk](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2843-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
December 16, 2021                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.9.290-1
CVE ID         : CVE-2020-3702 CVE-2020-16119 CVE-2021-0920 CVE-2021-3612
                 CVE-2021-3653 CVE-2021-3655 CVE-2021-3679 CVE-2021-3732
                 CVE-2021-3753 CVE-2021-3760 CVE-2021-20317 CVE-2021-20321
                 CVE-2021-20322 CVE-2021-22543 CVE-2021-37159 CVE-2021-38160
                 CVE-2021-38198 CVE-2021-38199 CVE-2021-38204 CVE-2021-38205
                 CVE-2021-40490 CVE-2021-41864 CVE-2021-42008 CVE-2021-42739
                 CVE-2021-43389

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service, or information
leaks.

CVE-2020-3702

    A flaw was found in the driver for Atheros IEEE 802.11n family of
    chipsets (ath9k) allowing information disclosure.

CVE-2020-16119

    Hadar Manor reported a use-after-free in the DCCP protocol
    implementation in the Linux kernel. A local attacker can take
    advantage of this flaw to cause a denial of service or potentially
    to execute arbitrary code.

CVE-2021-0920

    A race condition was discovered in the local sockets (AF_UNIX)
    subsystem, which could lead to a use-after-free.  A local user
    could exploit this for denial of service (memory corruption or
    crash), or possibly for privilege escalation.

CVE-2021-3612

    Murray McAllister reported a flaw in the joystick input subsystem.
    A local user permitted to access a joystick device could exploit
    this to read and write out-of-bounds in the kernel, which could
    be used for privilege escalation.

CVE-2021-3653

   Maxim Levitsky discovered a vulnerability in the KVM hypervisor
   implementation for AMD processors in the Linux kernel: Missing
   validation of the `int_ctl` VMCB field could allow a malicious L1
   guest to enable AVIC support (Advanced Virtual Interrupt
   Controller) for the L2 guest. The L2 guest can take advantage of
   this flaw to write to a limited but still relatively large subset
   of the host physical memory.

CVE-2021-3655

    Ilja Van Sprundel and Marcelo Ricardo Leitner found multiple flaws
    in the SCTP implementation, where missing validation could lead to
    an out-of-bounds read.  On a system using SCTP, a networked
    attacker could exploit these to cause a denial of service (crash).

CVE-2021-3679

    A flaw in the Linux kernel tracing module functionality could
    allow a privileged local user (with CAP_SYS_ADMIN capability) to
    cause a denial of service (resource starvation).

CVE-2021-3732

    Alois Wohlschlager reported a flaw in the implementation of the
    overlayfs subsystem, allowing a local attacker with privileges to
    mount a filesystem to reveal files hidden in the original mount.

CVE-2021-3753

    Minh Yuan reported a race condition in the vt_k_ioctl in
    drivers/tty/vt/vt_ioctl.c, which may cause an out of bounds read
    in vt.

CVE-2021-3760

    Lin Horse reported a flaw in the NCI (NFC Controller Interface)
    driver, which could lead to a use-after-free.

    However, this driver is not included in the binary packages
    provided by Debian.

CVE-2021-20317

    It was discovered that the timer queue structure could become
    corrupt, leading to waiting tasks never being woken up.  A local
    user with certain privileges could exploit this to cause a denial
    of service (system hang).

CVE-2021-20321

    A race condition was discovered in the overlayfs filesystem
    driver.  A local user with access to an overlayfs mount and to its
    underlying upper directory could exploit this for privilege
    escalation.

CVE-2021-20322

    An information leak was discovered in the IPv4 implementation.  A
    remote attacker could exploit this to quickly discover which UDP
    ports a system is using, making it easier for them to carry out a
    DNS poisoning attack against that system.

CVE-2021-22543

    David Stevens discovered a flaw in how the KVM hypervisor maps
    host memory into a guest.  A local user permitted to access
    /dev/kvm could use this to cause certain pages to be freed when
    they should not, leading to a use-after-free.  This could be used
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2021-37159

    A flaw was discovered in the hso driver for Option mobile
    broadband modems.  An error during initialisation could lead to a
    double-free or use-after-free.  An attacker able to plug in USB
    devices could use this to cause a denial of service (crash or
    memory corruption) or possibly to run arbitrary code.

CVE-2021-38160

    A flaw in the virtio_console was discovered allowing data
    corruption or data loss by an untrusted device.

CVE-2021-38198

    A flaw was discovered in the KVM implementation for x86
    processors, that could result in virtual memory protection within
    a guest not being applied correctly.  When shadow page tables are
    used - i.e. for nested virtualisation, or on CPUs lacking the EPT
    or NPT feature - a user of the guest OS might be able to exploit
    this for denial of service or privilege escalation within the
    guest.

CVE-2021-38199

    Michael Wakabayashi reported a flaw in the NFSv4 client
    implementation, where incorrect connection setup ordering allows
    operations of a remote NFSv4 server to cause a denial of service.

CVE-2021-38204

    A flaw was discovered in the max4321-hcd USB host controller
    driver, which could lead to a use-after-free.

    However, this driver is not included in the binary packages
    provided by Debian.

CVE-2021-38205

    An information leak was discovered in the xilinx_emaclite network
    driver.  On a custom kernel where this driver is enabled and used,
    this might make it easier to exploit other kernel bugs.

CVE-2021-40490

    A race condition was discovered in the ext4 subsystem when writing
    to an inline_data file while its xattrs are changing. This could
    result in denial of service.

CVE-2021-41864

    An integer overflow was discovered in the Extended BPF (eBPF)
    subsystem.  A local user could exploit this for denial of service
    (memory corruption or crash), or possibly for privilege
    escalation.

    This can be mitigated by setting sysctl
    kernel.unprivileged_bpf_disabled=1, which disables eBPF use by
    unprivileged users.

CVE-2021-42008

    A heap buffer overflow was discovered in the 6pack serial port
    network driver.  A local user with CAP_NET_ADMIN capability could
    exploit this for denial of service (memory corruption or crash), or
    possibly for privilege escalation.

CVE-2021-42739

    A heap buffer overflow was discovered in the firedtv driver for
    FireWire-connected DVB receivers.  A local user with access to a
    firedtv device could exploit this for denial of service (memory
    corruption or crash), or possibly for privilege escalation.

CVE-2021-43389

    The Active Defense Lab of Venustech discovered a flaw in the CMTP
    subsystem as used by Bluetooth, which could lead to an
    out-of-bounds read and object type confusion.  A local user with
    CAP_NET_ADMIN capability in the initial user namespace could
    exploit this for denial of service (memory corruption or crash),
    or possibly for privilege escalation.

For Debian 9 stretch, these problems have been fixed in version
4.9.290-1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings
Humans are not rational beings; they are rationalising beings.

```

**Attachment:
[signature.asc](pgpYxpTbjLb4O.pgp)**

*Description:* PGP signature

---



=== Content from lists.fedoraproject.org_b9c10a9a_20250114_180531.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ.mbox.gz?message=SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/#SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ)

# [SECURITY] Fedora 35 Update: kernel-5.14.10-300.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

9 Oct
2021

9 Oct
'21

2:36 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-79cbbefebe
2021-10-09 01:36:00.907898
--------------------------------------------------------------------------------

Name : kernel
Product : Fedora 35
Version : 5.14.10
Release : 300.fc35
URL : <https://www.kernel.org/>
Summary : The Linux kernel
Description :
The kernel meta package

--------------------------------------------------------------------------------
Update Information:

The 5.14.10 stable kernel update contains a number of important fixes across the
tree.
--------------------------------------------------------------------------------
ChangeLog:

\* Thu Oct 7 2021 Justin M. Forbes jforbes@fedoraproject.org [5.14.10-0]
- Revert "net: stmmac: dwmac-rk: fix unbalanced pm\_runtime\_enable warnings" (Peter Robinson)
- e100e: Fix packet loss issues seen on Intel network controller (Mark Pearson)
- bpf: Fix integer overflow in prealloc\_elems\_and\_freelist() (Tatsuhiko Yasumatsu)
- Revert "acpi: prefer booting with ACPI over DTS" (Justin M. Forbes)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2000627 - CVE-2021-3744 kernel: crypto: ccp - fix resource leaks in ccp\_run\_aes\_gcm\_cmd()
<https://bugzilla.redhat.com/show_bug.cgi?id=2000627>
[ 2 ] Bug #2010463 - CVE-2021-41864 kernel: eBPF multiplication integer overflow in prealloc\_elems\_and\_freelist() in kernel/bpf/stackmap.c leads to out-of-bounds write
<https://bugzilla.redhat.com/show_bug.cgi?id=2010463>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-79cbbefebe' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ/#SYKURLXBB2555ASWMPDNMBUPD6AG2JKQ)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from git.kernel.org_91d278d1_20250114_180529.html ===


| [cgit logo](/) | [index](/) : [kernel/git/bpf/bpf.git](/pub/scm/linux/kernel/git/bpf/bpf.git/) | master |
| --- | --- | --- |
| BPF kernel tree | BPF Group |

| [about](/pub/scm/linux/kernel/git/bpf/bpf.git/about/)[summary](/pub/scm/linux/kernel/git/bpf/bpf.git/)[refs](/pub/scm/linux/kernel/git/bpf/bpf.git/refs/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)[log](/pub/scm/linux/kernel/git/bpf/bpf.git/log/)[tree](/pub/scm/linux/kernel/git/bpf/bpf.git/tree/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)[commit](/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)[diff](/pub/scm/linux/kernel/git/bpf/bpf.git/diff/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)[stats](/pub/scm/linux/kernel/git/bpf/bpf.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Tatsuhiko Yasumatsu <th.yasumatsu@gmail.com> | 2021-09-30 22:55:45 +0900 |
| --- | --- | --- |
| committer | Daniel Borkmann <daniel@iogearbox.net> | 2021-09-30 16:17:23 +0200 |
| commit | [30e29a9a2bc6a4888335a6ede968b75cd329657a](/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a) ([patch](/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)) | |
| tree | [3273df208a61c0d3117213d400086858e530ec2e](/pub/scm/linux/kernel/git/bpf/bpf.git/tree/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a) | |
| parent | [79e3445b38e0cab94264a3894c0c3d57c930b97e](/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=79e3445b38e0cab94264a3894c0c3d57c930b97e) ([diff](/pub/scm/linux/kernel/git/bpf/bpf.git/diff/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a&id2=79e3445b38e0cab94264a3894c0c3d57c930b97e)) | |
| download | [bpf-30e29a9a2bc6a4888335a6ede968b75cd329657a.tar.gz](/pub/scm/linux/kernel/git/bpf/bpf.git/snapshot/bpf-30e29a9a2bc6a4888335a6ede968b75cd329657a.tar.gz) | |

bpf: Fix integer overflow in prealloc\_elems\_and\_freelist()In prealloc\_elems\_and\_freelist(), the multiplication to calculate the
size passed to bpf\_map\_area\_alloc() could lead to an integer overflow.
As a result, out-of-bounds write could occur in pcpu\_freelist\_populate()
as reported by KASAN:
[...]
[ 16.968613] BUG: KASAN: slab-out-of-bounds in pcpu\_freelist\_populate+0xd9/0x100
[ 16.969408] Write of size 8 at addr ffff888104fc6ea0 by task crash/78
[ 16.970038]
[ 16.970195] CPU: 0 PID: 78 Comm: crash Not tainted 5.15.0-rc2+ #1
[ 16.970878] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
[ 16.972026] Call Trace:
[ 16.972306] dump\_stack\_lvl+0x34/0x44
[ 16.972687] print\_address\_description.constprop.0+0x21/0x140
[ 16.973297] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.973777] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.974257] kasan\_report.cold+0x7f/0x11b
[ 16.974681] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.975190] pcpu\_freelist\_populate+0xd9/0x100
[ 16.975669] stack\_map\_alloc+0x209/0x2a0
[ 16.976106] \_\_sys\_bpf+0xd83/0x2ce0
[...]
The possibility of this overflow was originally discussed in [0], but
was overlooked.
Fix the integer overflow by changing elem\_size to u64 from u32.
[0] https://lore.kernel.org/bpf/728b238e-a481-eb50-98e9-b0f430ab01e7@gmail.com/
Fixes: 557c0c6e7df8 ("bpf: convert stackmap to pre-allocation")
Signed-off-by: Tatsuhiko Yasumatsu <th.yasumatsu@gmail.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Link: [https://lore.kernel.org/bpf/20210930135545.173698-1-th.yasumatsu@gmail.com](https://lore.kernel.org/bpf/20210930135545.173698-1-th.yasumatsu%40gmail.com)
[Diffstat](/pub/scm/linux/kernel/git/bpf/bpf.git/diff/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)

| -rw-r--r-- | [kernel/bpf/stackmap.c](/pub/scm/linux/kernel/git/bpf/bpf.git/diff/kernel/bpf/stackmap.c?id=30e29a9a2bc6a4888335a6ede968b75cd329657a) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/kernel/bpf/stackmap.c b/kernel/bpf/stackmap.cindex 09a3fd97d329ea..6e75bbee39f0b5 100644--- a/[kernel/bpf/stackmap.c](/pub/scm/linux/kernel/git/bpf/bpf.git/tree/kernel/bpf/stackmap.c?id=79e3445b38e0cab94264a3894c0c3d57c930b97e)+++ b/[kernel/bpf/stackmap.c](/pub/scm/linux/kernel/git/bpf/bpf.git/tree/kernel/bpf/stackmap.c?id=30e29a9a2bc6a4888335a6ede968b75cd329657a)@@ -63,7 +63,8 @@ static inline int stack\_map\_data\_size(struct bpf\_map \*map)  static int prealloc\_elems\_and\_freelist(struct bpf\_stack\_map \*smap) {- u32 elem\_size = sizeof(struct stack\_map\_bucket) + smap->map.value\_size;+ u64 elem\_size = sizeof(struct stack\_map\_bucket) ++ (u64)smap->map.value\_size; int err;  smap->elems = bpf\_map\_area\_alloc(elem\_size \* smap->map.max\_entries, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:04:07 +0000



=== Content from github.com_fb6672bc_20250114_180530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F30e29a9a2bc6a4888335a6ede968b75cd329657a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F30e29a9a2bc6a4888335a6ede968b75cd329657a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.7k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  434](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/30e29a9a2bc6a4888335a6ede968b75cd329657a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

bpf: Fix integer overflow in prealloc\_elems\_and\_freelist()

[Browse files](/torvalds/linux/tree/30e29a9a2bc6a4888335a6ede968b75cd329657a)
Browse the repository at this point in the history

```
In prealloc_elems_and_freelist(), the multiplication to calculate the
size passed to bpf_map_area_alloc() could lead to an integer overflow.
As a result, out-of-bounds write could occur in pcpu_freelist_populate()
as reported by KASAN:

[...]
[   16.968613] BUG: KASAN: slab-out-of-bounds in pcpu_freelist_populate+0xd9/0x100
[   16.969408] Write of size 8 at addr ffff888104fc6ea0 by task crash/78
[   16.970038]
[   16.970195] CPU: 0 PID: 78 Comm: crash Not tainted 5.15.0-rc2+ #1
[   16.970878] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
[   16.972026] Call Trace:
[   16.972306]  dump_stack_lvl+0x34/0x44
[   16.972687]  print_address_description.constprop.0+0x21/0x140
[   16.973297]  ? pcpu_freelist_populate+0xd9/0x100
[   16.973777]  ? pcpu_freelist_populate+0xd9/0x100
[   16.974257]  kasan_report.cold+0x7f/0x11b
[   16.974681]  ? pcpu_freelist_populate+0xd9/0x100
[   16.975190]  pcpu_freelist_populate+0xd9/0x100
[   16.975669]  stack_map_alloc+0x209/0x2a0
[   16.976106]  __sys_bpf+0xd83/0x2ce0
[...]

The possibility of this overflow was originally discussed in [0], but
was overlooked.

Fix the integer overflow by changing elem_size to u64 from u32.

  [0] [https://lore.kernel.org/bpf/728b238e-a481-eb50-98e9-b0f430ab01e7@gmail.com/](https://lore.kernel.org/bpf/728b238e-a481-eb50-98e9-b0f430ab01e7%40gmail.com/)

Fixes: [557c0c6](https://github.com/torvalds/linux/commit/557c0c6e7df8e14a46bd7560d193fa5bbc00a858) ("bpf: convert stackmap to pre-allocation")
Signed-off-by: Tatsuhiko Yasumatsu <th.yasumatsu@gmail.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Link: [https://lore.kernel.org/bpf/20210930135545.173698-1-th.yasumatsu@gmail.com](https://lore.kernel.org/bpf/20210930135545.173698-1-th.yasumatsu%40gmail.com)
```

* Loading branch information

[![@ty60](https://avatars.githubusercontent.com/u/28558944?s=40&v=4)](/ty60) [![@borkmann](https://avatars.githubusercontent.com/u/677393?s=40&v=4)](/borkmann)

[ty60](/torvalds/linux/commits?author=ty60 "View all commits by ty60")
authored and
[borkmann](/torvalds/linux/commits?author=borkmann "View all commits by borkmann")
committed
Sep 30, 2021

1 parent
[79e3445](/torvalds/linux/commit/79e3445b38e0cab94264a3894c0c3d57c930b97e)

commit 30e29a9

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[kernel/bpf/stackmap.c](#diff-0486cadd28c1d1b35dd24db437ba3ce1b85b67ec8f0fb4901b28704098ad1d1b "kernel/bpf/stackmap.c")

Show comments

[View file](/torvalds/linux/blob/30e29a9a2bc6a4888335a6ede968b75cd329657a/kernel/bpf/stackmap.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,7 +63,8 @@ static inline int stack\_map\_data\_size(struct bpf\_map \*map) |
|  |  |  |
|  |  | static int prealloc\_elems\_and\_freelist(struct bpf\_stack\_map \*smap) |
|  |  | { |
|  |  | u32 elem\_size = sizeof(struct stack\_map\_bucket) + smap->map.value\_size; |
|  |  | u64 elem\_size = sizeof(struct stack\_map\_bucket) + |
|  |  | (u64)smap->map.value\_size; |
|  |  | int err; |
|  |  |  |
|  |  | smap->elems = bpf\_map\_area\_alloc(elem\_size \* smap->map.max\_entries, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `30e29a9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F30e29a9a2bc6a4888335a6ede968b75cd329657a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_e2c7255a_20250115_111853.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-41864 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20211029-0004)

## CVE-2021-41864 Linux Kernel Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20211029-0004 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20211029-0004 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20211029-0004 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20211029-0004 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20211029-0004
**Version:**
5.0

**Last updated:**
01/06/2022

**Status:**
Interim.

**CVEs:** CVE-2021-41864

Overview
#### Summary

Multiple NetApp products incorporate Linux Kernel. Linux Kernel versions through 5.14.9 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-41864](https://nvd.nist.gov/vuln/detail/CVE-2021-41864) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a>

Affected Products
#### Affected Products

* NetApp Cloud Backup (formerly AltaVault)
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire Baseboard Management Controller (BMC)

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Data Sense
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire BIOS
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* NextGen API
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SANtricity Storage Plugin for vCenter
* SANtricity Unified Manager
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for Oracle Windows
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Trident
* Virtual Storage Console for VMware vSphere 9.7 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S has no plans to address this vulnerability. |
| **NetApp SolidFire Baseboard Management Controller (BMC)** | NetApp SolidFire Baseboard Management Controller (BMC) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2847476.html%20) for more information. |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20211029-0004>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20211029 | Initial Public Release |
| 2.0 | 20211101 | NetApp SolidFire Baseboard Management Controller (BMC) moved to Won't Fix status |
| 3.0 | 20211210 | Brocade Fabric Operating System Firmware moved to Products Not Affected |
| 4.0 | 20220105 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Products Not Affected |
| 5.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.fedoraproject.org_096c4afe_20250114_180531.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM.mbox.gz?message=7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/#7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM)

# [SECURITY] Fedora 34 Update: kernel-5.14.10-200.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

11 Oct
2021

11 Oct
'21

2:33 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-ffda3d6fa1
2021-10-11 21:32:18.681305
--------------------------------------------------------------------------------

Name : kernel
Product : Fedora 34
Version : 5.14.10
Release : 200.fc34
URL : <https://www.kernel.org/>
Summary : The Linux kernel
Description :
The kernel meta package

--------------------------------------------------------------------------------
Update Information:

The 5.14.10 stable kernel update contains a number of important fixes across the
tree
--------------------------------------------------------------------------------
ChangeLog:

\* Thu Oct 7 2021 Justin M. Forbes jforbes@fedoraproject.org [5.14.10-0]
- Revert "net: stmmac: dwmac-rk: fix unbalanced pm\_runtime\_enable warnings" (Peter Robinson)
- e100e: Fix packet loss issues seen on Intel network controller (Mark Pearson)
- bpf: Fix integer overflow in prealloc\_elems\_and\_freelist() (Tatsuhiko Yasumatsu)
- Revert "acpi: prefer booting with ACPI over DTS" (Justin M. Forbes)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2000627 - CVE-2021-3744 kernel: crypto: ccp - fix resource leaks in ccp\_run\_aes\_gcm\_cmd()
<https://bugzilla.redhat.com/show_bug.cgi?id=2000627>
[ 2 ] Bug #2010463 - CVE-2021-41864 kernel: eBPF multiplication integer overflow in prealloc\_elems\_and\_freelist() in kernel/bpf/stackmap.c leads to out-of-bounds write
<https://bugzilla.redhat.com/show_bug.cgi?id=2010463>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-ffda3d6fa1' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM/#7BLLVKYAIETEORUPTFO3TR3C33ZPFXQM)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from security.netapp.com_1f93e2c0_20250114_180532.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-41864 Linux Kernel Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20211029-0004)

## CVE-2021-41864 Linux Kernel Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20211029-0004 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20211029-0004 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20211029-0004 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20211029-0004 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20211029-0004
**Version:**
5.0

**Last updated:**
01/06/2022

**Status:**
Interim.

**CVEs:** CVE-2021-41864

Overview
#### Summary

Multiple NetApp products incorporate Linux Kernel. Linux Kernel versions through 5.14.9 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-41864](https://nvd.nist.gov/vuln/detail/CVE-2021-41864) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a>

Affected Products
#### Affected Products

* NetApp Cloud Backup (formerly AltaVault)
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire Baseboard Management Controller (BMC)

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Data Sense
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire BIOS
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* NextGen API
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SANtricity Storage Plugin for vCenter
* SANtricity Unified Manager
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for Oracle Windows
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Trident
* Virtual Storage Console for VMware vSphere 9.7 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S has no plans to address this vulnerability. |
| **NetApp SolidFire Baseboard Management Controller (BMC)** | NetApp SolidFire Baseboard Management Controller (BMC) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2847476.html%20) for more information. |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20211029-0004>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20211029 | Initial Public Release |
| 2.0 | 20211101 | NetApp SolidFire Baseboard Management Controller (BMC) moved to Won't Fix status |
| 3.0 | 20211210 | Brocade Fabric Operating System Firmware moved to Products Not Affected |
| 4.0 | 20220105 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Products Not Affected |
| 5.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from cdn.kernel.org_b3347e18_20250114_180529.html ===
commit 325225e2f9fa0a4edf0b7da30c256df2433db6bb
Author: Greg Kroah-Hartman
Date: Wed Oct 13 09:42:04 2021 +0200
Linux 5.14.12
Link: https://lore.kernel.org/r/20211011134517.833565002@linuxfoundation.org
Tested-by: Salvatore Bonaccorso
Tested-by: Florian Fainelli
Tested-by: Fox Chen
Tested-by: Shuah Khan
Tested-by: Guenter Roeck
Tested-by: Jon Hunter
Signed-off-by: Greg Kroah-Hartman
commit 58f0e59efa34ceea0253e58e4b27e44423767728
Author: Andrew Lunn
Date: Sun Oct 3 17:50:53 2021 +0200
dsa: tag\_dsa: Fix mask for trunked packets
commit b44d52a50bc6f191f0ae03f65de8401f3ef039b3 upstream.
A packet received on a trunk will have bit 2 set in Forward DSA tagged
frame. Bit 1 can be either 0 or 1 and is otherwise undefined and bit 0
indicates the frame CFI. Masking with 7 thus results in frames as
being identified as being from a trunk when in fact they are not. Fix
the mask to just look at bit 2.
Fixes: 5b60dadb71db ("net: dsa: tag\_dsa: Support reception of packets from LAG devices")
Signed-off-by: Andrew Lunn
Reviewed-by: Vladimir Oltean
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5dc24f3e08419d01ce0dcd08e9472472ede9988f
Author: Thomas Gleixner
Date: Thu Sep 30 19:21:39 2021 +0200
x86/hpet: Use another crystalball to evaluate HPET usability
commit 6e3cd95234dc1eda488f4f487c281bac8fef4d9b upstream.
On recent Intel systems the HPET stops working when the system reaches PC10
idle state.
The approach of adding PCI ids to the early quirks to disable HPET on
these systems is a whack a mole game which makes no sense.
Check for PC10 instead and force disable HPET if supported. The check is
overbroad as it does not take ACPI, intel\_idle enablement and command
line parameters into account. That's fine as long as there is at least
PMTIMER available to calibrate the TSC frequency. The decision can be
overruled by adding "hpet=force" on the kernel command line.
Remove the related early PCI quirks for affected Ice Cake and Coffin Lake
systems as they are not longer required. That should also cover all
other systems, i.e. Tiger Rag and newer generations, which are most
likely affected by this as well.
Fixes: Yet another hardware trainwreck
Reported-by: Jakub Kicinski
Signed-off-by: Thomas Gleixner
Tested-by: Jakub Kicinski
Reviewed-by: Rafael J. Wysocki
Cc: stable@vger.kernel.org
Cc: Kai-Heng Feng
Cc: Bjorn Helgaas
Signed-off-by: Greg Kroah-Hartman
commit 4e9ec1c65da98c293f75d83755dfa5e03075a6d0
Author: Vegard Nossum
Date: Mon Oct 4 00:34:23 2021 +0200
x86/entry: Clear X86\_FEATURE\_SMAP when CONFIG\_X86\_SMAP=n
commit 3958b9c34c2729597e182cc606cc43942fd19f7c upstream.
Commit
3c73b81a9164 ("x86/entry, selftests: Further improve user entry sanity checks")
added a warning if AC is set when in the kernel.
Commit
662a0221893a3d ("x86/entry: Fix AC assertion")
changed the warning to only fire if the CPU supports SMAP.
However, the warning can still trigger on a machine that supports SMAP
but where it's disabled in the kernel config and when running the
syscall\_nt selftest, for example:
------------[ cut here ]------------
WARNING: CPU: 0 PID: 49 at irqentry\_enter\_from\_user\_mode
CPU: 0 PID: 49 Comm: init Tainted: G T 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014
RIP: 0010:irqentry\_enter\_from\_user\_mode
...
Call Trace:
? irqentry\_enter
? exc\_general\_protection
? asm\_exc\_general\_protection
? asm\_exc\_general\_protectio
IS\_ENABLED(CONFIG\_X86\_SMAP) could be added to the warning condition, but
even this would not be enough in case SMAP is disabled at boot time with
the "nosmap" parameter.
To be consistent with "nosmap" behaviour, clear X86\_FEATURE\_SMAP when
!CONFIG\_X86\_SMAP.
Found using entry-fuzz + satrandconfig.
[ bp: Massage commit message. ]
Fixes: 3c73b81a9164 ("x86/entry, selftests: Further improve user entry sanity checks")
Fixes: 662a0221893a ("x86/entry: Fix AC assertion")
Signed-off-by: Vegard Nossum
Signed-off-by: Borislav Petkov
Cc: stable@vger.kernel.org
Link: https://lkml.kernel.org/r/20211003223423.8666-1-vegard.nossum@oracle.com
Signed-off-by: Greg Kroah-Hartman
commit 2ba3e3026f4fb0d8c4e673a26e7f1e185e2c8d1f
Author: Lukas Bulwahn
Date: Tue Aug 3 13:35:23 2021 +0200
x86/entry: Correct reference to intended CONFIG\_64\_BIT
commit 2c861f2b859385e9eaa6e464a8a7435b5a6bf564 upstream.
Commit in Fixes adds a condition with IS\_ENABLED(CONFIG\_64\_BIT),
but the intended config item is called CONFIG\_64BIT, as defined in
arch/x86/Kconfig.
Fortunately, scripts/checkkconfigsymbols.py warns:
64\_BIT
Referencing files: arch/x86/include/asm/entry-common.h
Correct the reference to the intended config symbol.
Fixes: 662a0221893a ("x86/entry: Fix AC assertion")
Suggested-by: Randy Dunlap
Signed-off-by: Lukas Bulwahn
Signed-off-by: Borislav Petkov
Cc:
Link: https://lkml.kernel.org/r/20210803113531.30720-2-lukas.bulwahn@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit 0723d4f8b179de7c4a45b11ef8a885b353fc31d7
Author: Borislav Petkov
Date: Wed Oct 6 18:33:52 2021 +0200
x86/fpu: Restore the masking out of reserved MXCSR bits
commit d298b03506d3e161f7492c440babb0bfae35e650 upstream.
Ser Olmy reported a boot failure:
init[1] bad frame in sigreturn frame:(ptrval) ip:b7c9fbe6 sp:bf933310 orax:ffffffff \
in libc-2.33.so[b7bed000+156000]
Kernel panic - not syncing: Attempted to kill init! exitcode=0x0000000b
CPU: 0 PID: 1 Comm: init Tainted: G W 5.14.9 #1
Hardware name: Hewlett-Packard HP PC/HP Board, BIOS JD.00.06 12/06/2001
Call Trace:
dump\_stack\_lvl
dump\_stack
panic
do\_exit.cold
do\_group\_exit
get\_signal
arch\_do\_signal\_or\_restart
? force\_sig\_info\_to\_task
? force\_sig
exit\_to\_user\_mode\_prepare
syscall\_exit\_to\_user\_mode
do\_int80\_syscall\_32
entry\_INT80\_32
on an old 32-bit Intel CPU:
vendor\_id : GenuineIntel
cpu family : 6
model : 6
model name : Celeron (Mendocino)
stepping : 5
microcode : 0x3
Ser bisected the problem to the commit in Fixes.
tglx suggested reverting the rejection of invalid MXCSR values which
this commit introduced and replacing it with what the old code did -
simply masking them out to zero.
Further debugging confirmed his suggestion:
fpu->state.fxsave.mxcsr: 0xb7be13b4, mxcsr\_feature\_mask: 0xffbf
WARNING: CPU: 0 PID: 1 at arch/x86/kernel/fpu/signal.c:384 \_\_fpu\_restore\_sig+0x51f/0x540
so restore the original behavior only for 32-bit kernels where you have
ancient machines with buggy hardware. For 32-bit programs on 64-bit
kernels, user space which supplies wrong MXCSR values is considered
malicious so fail the sigframe restoration there.
Fixes: 6f9866a166cd ("x86/fpu/signal: Let xrstor handle the features to init")
Reported-by: Ser Olmy
Signed-off-by: Borislav Petkov
Tested-by: Ser Olmy
Cc:
Link: https://lkml.kernel.org/r/YVtA67jImg3KlBTw@zn.tnic
Signed-off-by: Greg Kroah-Hartman
commit 44976b5cb6af93c4ecb37e95665b3b16255ea8c8
Author: Tom Lendacky
Date: Thu Sep 30 23:42:01 2021 -0500
x86/sev: Return an error on a returned non-zero SW\_EXITINFO1[31:0]
commit 06f2ac3d4219bbbfd93d79e01966a42053084f11 upstream.
After returning from a VMGEXIT NAE event, SW\_EXITINFO1[31:0] is checked
for a value of 1, which indicates an error and that SW\_EXITINFO2
contains exception information. However, future versions of the GHCB
specification may define new values for SW\_EXITINFO1[31:0], so really
any non-zero value should be treated as an error.
Fixes: 597cfe48212a ("x86/boot/compressed/64: Setup a GHCB-based VC Exception handler")
Signed-off-by: Tom Lendacky
Signed-off-by: Borislav Petkov
Cc:  # 5.10+
Link: https://lkml.kernel.org/r/efc772af831e9e7f517f0439b13b41f56bad8784.1633063321.git.thomas.lendacky@amd.com
Signed-off-by: Greg Kroah-Hartman
commit 6665c1c5770fd351382c94bf206486c1d2cd160a
Author: Lukas Bulwahn
Date: Tue Aug 3 13:35:25 2021 +0200
x86/Kconfig: Correct reference to MWINCHIP3D
commit 225bac2dc5d192e55f2c50123ee539b1edf8a411 upstream.
Commit in Fixes intended to exclude the Winchip series and referred to
CONFIG\_WINCHIP3D, but the config symbol is called CONFIG\_MWINCHIP3D.
Hence, scripts/checkkconfigsymbols.py warns:
WINCHIP3D
Referencing files: arch/x86/Kconfig
Correct the reference to the intended config symbol.
Fixes: 69b8d3fcabdc ("x86/Kconfig: Exclude i586-class CPUs lacking PAE support from the HIGHMEM64G Kconfig group")
Suggested-by: Randy Dunlap
Signed-off-by: Lukas Bulwahn
Signed-off-by: Borislav Petkov
Cc:
Link: https://lkml.kernel.org/r/20210803113531.30720-4-lukas.bulwahn@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit 1d4092c101255b40a60c653eb309a28b235114a7
Author: Lukas Bulwahn
Date: Tue Aug 3 13:35:24 2021 +0200
x86/platform/olpc: Correct ifdef symbol to intended CONFIG\_OLPC\_XO15\_SCI
commit 4758fd801f919b8b9acad78d2e49a195ec2be46b upstream.
The refactoring in the commit in Fixes introduced an ifdef
CONFIG\_OLPC\_XO1\_5\_SCI, however the config symbol is actually called
"CONFIG\_OLPC\_XO15\_SCI".
Fortunately, ./scripts/checkkconfigsymbols.py warns:
OLPC\_XO1\_5\_SCI
Referencing files: arch/x86/platform/olpc/olpc.c
Correct this ifdef condition to the intended config symbol.
Fixes: ec9964b48033 ("Platform: OLPC: Move EC-specific functionality out from x86")
Suggested-by: Randy Dunlap
Signed-off-by: Lukas Bulwahn
Signed-off-by: Borislav Petkov
Cc:
Link: https://lkml.kernel.org/r/20210803113531.30720-3-lukas.bulwahn@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit 8ba6e4551011675872dc61911e1f29caf77fa073
Author: Mahesh Salgaonkar
Date: Mon Sep 20 22:03:26 2021 +0530
pseries/eeh: Fix the kdump kernel crash during eeh\_pseries\_init
[ Upstream commit eb8257a12192f43ffd41bd90932c39dade958042 ]
On pseries LPAR when an empty slot is assigned to partition OR in single
LPAR mode, kdump kernel crashes during issuing PHB reset.
In the kdump scenario, we traverse all PHBs and issue reset using the
pe\_config\_addr of the first child device present under each PHB. However
the code assumes that none of the PHB slots can be empty and uses
list\_first\_entry() to get the first child device under the PHB. Since
list\_first\_entry() expects the list to be non-empty, it returns an
invalid pci\_dn entry and ends up accessing NULL phb pointer under
pci\_dn->phb causing kdump kernel crash.
This patch fixes the below kdump kernel crash by skipping empty slots:
audit: initializing netlink subsys (disabled)
thermal\_sys: Registered thermal governor 'fair\_share'
thermal\_sys: Registered thermal governor 'step\_wise'
cpuidle: using governor menu
pstore: Registered nvram as persistent store backend
Issue PHB reset ...
audit: type=2000 audit(1631267818.000:1): state=initialized audit\_enabled=0 res=1
BUG: Kernel NULL pointer dereference on read at 0x00000268
Faulting instruction address: 0xc000000008101fb0
Oops: Kernel access of bad area, sig: 7 [#1]
LE PAGE\_SIZE=64K MMU=Radix SMP NR\_CPUS=2048 NUMA pSeries
Modules linked in:
CPU: 7 PID: 1 Comm: swapper/7 Not tainted 5.14.0 #1
NIP: c000000008101fb0 LR: c000000009284ccc CTR: c000000008029d70
REGS: c00000001161b840 TRAP: 0300 Not tainted (5.14.0)
MSR: 8000000002009033  CR: 28000224 XER: 20040002
CFAR: c000000008101f0c DAR: 0000000000000268 DSISR: 00080000 IRQMASK: 0
...
NIP pseries\_eeh\_get\_pe\_config\_addr+0x100/0x1b0
LR \_\_machine\_initcall\_pseries\_eeh\_pseries\_init+0x2cc/0x350
Call Trace:
0xc00000001161bb80 (unreliable)
\_\_machine\_initcall\_pseries\_eeh\_pseries\_init+0x2cc/0x350
do\_one\_initcall+0x60/0x2d0
kernel\_init\_freeable+0x350/0x3f8
kernel\_init+0x3c/0x17c
ret\_from\_kernel\_thread+0x5c/0x64
Fixes: 5a090f7c363fd ("powerpc/pseries: PCIE PHB reset")
Signed-off-by: Mahesh Salgaonkar
[mpe: Tweak wording and trim oops]
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/163215558252.413351.8600189949820258982.stgit@jupiter
Signed-off-by: Sasha Levin
commit da0cb12f19838eec245d135b6d59f3fcfe1fa7d0
Author: Christophe Leroy
Date: Wed Sep 15 16:12:24 2021 +0200
powerpc/32s: Fix kuap\_kernel\_restore()
[ Upstream commit d93f9e23744b7bf11a98b2ddb091d129482ae179 ]
At interrupt exit, kuap\_kernel\_restore() calls kuap\_unlock() with the
value contained in regs->kuap. However, when regs->kuap contains
0xffffffff it means that KUAP was not unlocked so calling kuap\_unlock()
is unrelevant and results in jeopardising the contents of kernel space
segment registers.
So check that regs->kuap doesn't contain KUAP\_NONE before calling
kuap\_unlock(). In the meantime it also means that if KUAP has not
been correcly locked back at interrupt exit, it must be locked
before continuing. This is done by checking the content of
current->thread.kuap which was returned by kuap\_get\_and\_assert\_locked()
Fixes: 16132529cee5 ("powerpc/32s: Rework Kernel Userspace Access Protection")
Reported-by: Stan Johnson
Signed-off-by: Christophe Leroy
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/0d0c4d0f050a637052287c09ba521bad960a2790.1631715131.git.christophe.leroy@csgroup.eu
Signed-off-by: Sasha Levin
commit d7a8e38999fbd6910516e44cb43f9f4317e54f73
Author: Nicholas Piggin
Date: Tue Oct 5 00:56:42 2021 +1000
powerpc/64s: Fix unrecoverable MCE calling async handler from NMI
[ Upstream commit f08fb25bc66986b0952724530a640d9970fa52c1 ]
The machine check handler is not considered NMI on 64s. The early
handler is the true NMI handler, and then it schedules the
machine\_check\_exception handler to run when interrupts are enabled.
This works fine except the case of an unrecoverable MCE, where the true
NMI is taken when MSR[RI] is clear, it can not recover, so it calls
machine\_check\_exception directly so something might be done about it.
Calling an async handler from NMI context can result in irq state and
other things getting corrupted. This can also trigger the BUG at
arch/powerpc/include/asm/interrupt.h:168
BUG\_ON(!arch\_irq\_disabled\_regs(regs) && !(regs->msr & MSR\_EE));
Fix this by making an \_async version of the handler which is called
in the normal case, and a NMI version that is called for unrecoverable
interrupts.
Fixes: 2b43dd7653cc ("powerpc/64: enable MSR[EE] in irq replay pt\_regs")
Signed-off-by: Nicholas Piggin
Tested-by: Cédric Le Goater
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/20211004145642.1331214-6-npiggin@gmail.com
Signed-off-by: Sasha Levin
commit 22ee1f15a72e50fae65ea3df9461e8c2d4e3cc1b
Author: Nicholas Piggin
Date: Tue Oct 5 00:56:39 2021 +1000
powerpc/traps: do not enable irqs in \_exception
[ Upstream commit d0afd44c05f8f4e4c91487c02d43c87a31552462 ]
\_exception can be called by machine check handlers when the MCE hits
user code (e.g., pseries and powernv). This will enable local irqs
because, which is a dicey thing to do in NMI or hard irq context.
This seemed to worked out okay because a userspace MCE can basically be
treated like a synchronous interrupt (after async / imprecise MCEs are
filtered out). Since NMI and hard irq handlers have started growing
nmi\_enter / irq\_enter, and more irq state sanity checks, this has
started to cause problems (or at least trigger warnings).
The Fixes tag to the commit which introduced this rather than try to
work out exactly which commit was the first that could possibly cause a
problem because that may be difficult to prove.
Fixes: 9f2f79e3a3c1 ("powerpc: Disable interrupts in 64-bit kernel FP and vector faults")
Signed-off-by: Nicholas Piggin
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/20211004145642.1331214-3-npiggin@gmail.com
Signed-off-by: Sasha Levin
commit c835b3d1d6362b4a4ebb192da7e7fd27a0a45d01
Author: Nicholas Piggin
Date: Tue Oct 5 00:56:38 2021 +1000
powerpc/64s: fix program check interrupt emergency stack path
[ Upstream commit 3e607dc4df180b72a38e75030cb0f94d12808712 ]
Emergency stack path was jumping into a 3: label inside the
\_\_GEN\_COMMON\_BODY macro for the normal path after it had finished,
rather than jumping over it. By a small miracle this is the correct
place to build up a new interrupt frame with the existing stack
pointer, so things basically worked okay with an added weird looking
700 trap frame on top (which had the wrong ->nip so it didn't decode
bug messages either).
Fix this by avoiding using numeric labels when jumping over non-trivial
macros.
Before:
LE PAGE\_SIZE=64K MMU=Radix SMP NR\_CPUS=2048 NUMA PowerNV
Modules linked in:
CPU: 0 PID: 88 Comm: sh Not tainted 5.15.0-rc2-00034-ge057cdade6e5 #2637
NIP: 7265677368657265 LR: c00000000006c0c8 CTR: c0000000000097f0
REGS: c0000000fffb3a50 TRAP: 0700 Not tainted
MSR: 9000000000021031  CR: 00000700 XER: 20040000
CFAR: c0000000000098b0 IRQMASK: 0
GPR00: c00000000006c964 c0000000fffb3cf0 c000000001513800 0000000000000000
GPR04: 0000000048ab0778 0000000042000000 0000000000000000 0000000000001299
GPR08: 000001e447c718ec 0000000022424282 0000000000002710 c00000000006bee8
GPR12: 9000000000009033 c0000000016b0000 00000000000000b0 0000000000000001
GPR16: 0000000000000000 0000000000000002 0000000000000000 0000000000000ff8
GPR20: 0000000000001fff 0000000000000007 0000000000000080 00007fff89d90158
GPR24: 0000000002000000 0000000002000000 0000000000000255 0000000000000300
GPR28: c000000001270000 0000000042000000 0000000048ab0778 c000000080647e80
NIP [7265677368657265] 0x7265677368657265
LR [c00000000006c0c8] \_\_\_do\_page\_fault+0x3f8/0xb10
Call Trace:
[c0000000fffb3cf0] [c00000000000bdac] soft\_nmi\_common+0x13c/0x1d0 (unreliable)
--- interrupt: 700 at decrementer\_common\_virt+0xb8/0x230
NIP: c0000000000098b8 LR: c00000000006c0c8 CTR: c0000000000097f0
REGS: c0000000fffb3d60 TRAP: 0700 Not tainted
MSR: 9000000000021031  CR: 22424282 XER: 20040000
CFAR: c0000000000098b0 IRQMASK: 0
GPR00: c00000000006c964 0000000000002400 c000000001513800 0000000000000000
GPR04: 0000000048ab0778 0000000042000000 0000000000000000 0000000000001299
GPR08: 000001e447c718ec 0000000022424282 0000000000002710 c00000000006bee8
GPR12: 9000000000009033 c0000000016b0000 00000000000000b0 0000000000000001
GPR16: 0000000000000000 0000000000000002 0000000000000000 0000000000000ff8
GPR20: 0000000000001fff 0000000000000007 0000000000000080 00007fff89d90158
GPR24: 0000000002000000 0000000002000000 0000000000000255 0000000000000300
GPR28: c000000001270000 0000000042000000 0000000048ab0778 c000000080647e80
NIP [c0000000000098b8] decrementer\_common\_virt+0xb8/0x230
LR [c00000000006c0c8] \_\_\_do\_page\_fault+0x3f8/0xb10
--- interrupt: 700
Instruction dump:
XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX
XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX
---[ end trace 6d28218e0cc3c949 ]---
After:
------------[ cut here ]------------
kernel BUG at arch/powerpc/kernel/exceptions-64s.S:491!
Oops: Exception in kernel mode, sig: 5 [#1]
LE PAGE\_SIZE=64K MMU=Radix SMP NR\_CPUS=2048 NUMA PowerNV
Modules linked in:
CPU: 0 PID: 88 Comm: login Not tainted 5.15.0-rc2-00034-ge057cdade6e5-dirty #2638
NIP: c0000000000098b8 LR: c00000000006bf04 CTR: c0000000000097f0
REGS: c0000000fffb3d60 TRAP: 0700 Not tainted
MSR: 9000000000021031  CR: 24482227 XER: 00040000
CFAR: c0000000000098b0 IRQMASK: 0
GPR00: c00000000006bf04 0000000000002400 c000000001513800 c000000001271868
GPR04: 00000000100f0d29 0000000042000000 0000000000000007 0000000000000009
GPR08: 00000000100f0d29 0000000024482227 0000000000002710 c000000000181b3c
GPR12: 9000000000009033 c0000000016b0000 00000000100f0d29 c000000005b22f00
GPR16: 00000000ffff0000 0000000000000001 0000000000000009 00000000100eed90
GPR20: 00000000100eed90 0000000010000000 000000001000a49c 00000000100f1430
GPR24: c000000001271868 0000000002000000 0000000000000215 0000000000000300
GPR28: c000000001271800 0000000042000000 00000000100f0d29 c000000080647860
NIP [c0000000000098b8] decrementer\_common\_virt+0xb8/0x230
LR [c00000000006bf04] \_\_\_do\_page\_fault+0x234/0xb10
Call Trace:
Instruction dump:
4182000c 39400001 48000008 894d0932 714a0001 39400008 408225fc 718a4000
7c2a0b78 3821fcf0 41c20008 e82d0910 <0981fcf0> f92101a0 f9610170 f9810178
---[ end trace a5dbd1f5ea4ccc51 ]---
Fixes: 0a882e28468f4 ("powerpc/64s/exception: remove bad stack branch")
Signed-off-by: Nicholas Piggin
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/20211004145642.1331214-2-npiggin@gmail.com
Signed-off-by: Sasha Levin
commit 6b77166ffee77ef955a13cee26dc37a651e7ab5e
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:29 2021 +0530
powerpc/bpf ppc32: Fix BPF\_SUB when imm == 0x80000000
[ Upstream commit 548b762763b885b81850db676258df47c55dd5f9 ]
Special case handling of the smallest 32-bit negative number for BPF\_SUB.
Fixes: 51c66ad849a703 ("powerpc/bpf: Implement extended BPF on PPC32")
Signed-off-by: Naveen N. Rao
Reviewed-by: Christophe Leroy
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/7135360a0cdf70adedbccf9863128b8daef18764.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit b8601d47e87a0f254e3544255af448d6d5a91f77
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:28 2021 +0530
powerpc/bpf ppc32: Do not emit zero extend instruction for 64-bit BPF\_END
[ Upstream commit 48164fccdff6d5cc11308126c050bd25a329df25 ]
Suppress emitting zero extend instruction for 64-bit BPF\_END\_FROM\_[L|B]E
operation.
Fixes: 51c66ad849a703 ("powerpc/bpf: Implement extended BPF on PPC32")
Signed-off-by: Naveen N. Rao
Reviewed-by: Christophe Leroy
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/b4e3c3546121315a8e2059b19a1bda84971816e4.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit 491976e521c190b5ecb6d7f14c972167395f02a4
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:27 2021 +0530
powerpc/bpf ppc32: Fix JMP32\_JSET\_K
[ Upstream commit e8278d44443207bb6609c7b064073f353e6f4978 ]
'andi' only takes an unsigned 16-bit value. Correct the imm range used
when emitting andi.
Fixes: 51c66ad849a703 ("powerpc/bpf: Implement extended BPF on PPC32")
Signed-off-by: Naveen N. Rao
Reviewed-by: Christophe Leroy
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/b94489f52831305ec15aca4dd04a3527236be7e8.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit 9a3e91f94473b2ef9799eb009e6bfc5c2bee0739
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:26 2021 +0530
powerpc/bpf ppc32: Fix ALU32 BPF\_ARSH operation
[ Upstream commit c9b8da77f22d28348d1f89a6c4d3fec102e9b1c4 ]
Correct the destination register used for ALU32 BPF\_ARSH operation.
Fixes: 51c66ad849a703 ("powerpc/bpf: Implement extended BPF on PPC32")
Signed-off-by: Naveen N. Rao
Reviewed-by: Christophe Leroy
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/6d24c1f9e79b6f61f5135eaf2ea1e8bcd4dac87b.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit 096d4c941f0e236ae35ecae9ca75cb3248cb4df8
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:23 2021 +0530
powerpc/bpf: Fix BPF\_SUB when imm == 0x80000000
[ Upstream commit 5855c4c1f415ca3ba1046e77c0b3d3dfc96c9025 ]
We aren't handling subtraction involving an immediate value of
0x80000000 properly. Fix the same.
Fixes: 156d0e290e969c ("powerpc/ebpf/jit: Implement JIT compiler for extended BPF")
Signed-off-by: Naveen N. Rao
Reviewed-by: Christophe Leroy
[mpe: Fold in fix from Naveen to use imm <= 32768]
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/fc4b1276eb10761fd7ce0814c8dd089da2815251.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit 2d7781883b3eef87fe749fa13b23ac2bf3f19e7f
Author: Naveen N. Rao
Date: Wed Oct 6 01:55:22 2021 +0530
powerpc/bpf: Fix BPF\_MOD when imm == 1
[ Upstream commit 8bbc9d822421d9ac8ff9ed26a3713c9afc69d6c8 ]
Only ignore the operation if dividing by 1.
Fixes: 156d0e290e969c ("powerpc/ebpf/jit: Implement JIT compiler for extended BPF")
Signed-off-by: Naveen N. Rao
Tested-by: Johan Almbladh
Reviewed-by: Christophe Leroy
Acked-by: Song Liu
Acked-by: Johan Almbladh
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/c674ca18c3046885602caebb326213731c675d06.1633464148.git.naveen.n.rao@linux.vnet.ibm.com
Signed-off-by: Sasha Levin
commit a7ce57ca9407dd257915b56acf970e80b6f04515
Author: Joe Lawrence
Date: Sun Aug 22 18:50:36 2021 -0400
objtool: Make .altinstructions section entry size consistent
[ Upstream commit dc02368164bd0ec603e3f5b3dd8252744a667b8a ]
Commit e31694e0a7a7 ("objtool: Don't make .altinstructions writable")
aligned objtool-created and kernel-created .altinstructions section
flags, but there remains a minor discrepency in their use of a section
entry size: objtool sets one while the kernel build does not.
While sh\_entsize of sizeof(struct alt\_instr) seems intuitive, this small
deviation can cause failures with external tooling (kpatch-build).
Fix this by creating new .altinstructions sections with sh\_entsize of 0
and then later updating sec->sh\_size as alternatives are added to the
section. An added benefit is avoiding the data descriptor and buffer
created by elf\_create\_section(), but previously unused by
elf\_add\_alternative().
Fixes: 9bc0bb50727c ("objtool/x86: Rewrite retpoline thunk calls")
Signed-off-by: Joe Lawrence
Reviewed-by: Miroslav Benes
Signed-off-by: Josh Poimboeuf
Link: https://lore.kernel.org/r/20210822225037.54620-2-joe.lawrence@redhat.com
Cc: Andy Lavr
Cc: Peter Zijlstra
Cc: x86@kernel.org
Cc: linux-kernel@vger.kernel.org
Signed-off-by: Sasha Levin
commit 039a68957f818c30575729d09da837a2593d0fb6
Author: Josh Poimboeuf
Date: Mon Oct 4 10:07:50 2021 -0700
objtool: Remove reloc symbol type checks in get\_alt\_entry()
[ Upstream commit 4d8b35968bbf9e42b6b202eedb510e2c82ad8b38 ]
Converting a special section's relocation reference to a symbol is
straightforward. No need for objtool to complain that it doesn't know
how to handle it. Just handle it.
This fixes the following warning:
arch/x86/kvm/emulate.o: warning: objtool: \_\_ex\_table+0x4: don't know how to handle reloc symbol type: kvm\_fastop\_exception
Fixes: 24ff65257375 ("objtool: Teach get\_alt\_entry() about more relocation types")
Reported-by: Linus Torvalds
Signed-off-by: Josh Poimboeuf
Link: https://lore.kernel.org/r/feadbc3dfb3440d973580fad8d3db873cbfe1694.1633367242.git.jpoimboe@redhat.com
Cc: Peter Zijlstra
Cc: x86@kernel.org
Cc: Miroslav Benes
Cc: linux-kernel@vger.kernel.org
Signed-off-by: Sasha Levin
commit 1642f51ac0d4f2b55d5748094c49ff8f7191b93c
Author: Mike Christie
Date: Mon Oct 4 16:06:08 2021 -0500
scsi: iscsi: Fix iscsi\_task use after free
[ Upstream commit 258aad75c62146453d03028a44f2f1590d58e1f6 ]
Commit d39df158518c ("scsi: iscsi: Have abort handler get ref to conn")
added iscsi\_get\_conn()/iscsi\_put\_conn() calls during abort handling but
then also changed the handling of the case where we detect an already
completed task where we now end up doing a goto to the common put/cleanup
code. This results in a iscsi\_task use after free, because the common
cleanup code will do a put on the iscsi\_task.
This reverts the goto and moves the iscsi\_get\_conn() to after we've checked
if the iscsi\_task is valid.
Link: https://lore.kernel.org/r/20211004210608.9962-1-michael.christie@oracle.com
Fixes: d39df158518c ("scsi: iscsi: Have abort handler get ref to conn")
Signed-off-by: Mike Christie
Signed-off-by: Martin K. Petersen
Signed-off-by: Sasha Levin
commit 412754da783d0279f8b9adcf9934a1d76b977a0a
Author: Palmer Dabbelt
Date: Sat Oct 2 17:21:20 2021 -0700
RISC-V: Include clone3() on rv32
[ Upstream commit 59a4e0d5511ba61353ea9a4efdb1b86c23ecf134 ]
As far as I can tell this should be enabled on rv32 as well, I'm not
sure why it's rv64-only. checksyscalls is complaining about our lack of
clone3() on rv32.
Fixes: 56ac5e213933 ("riscv: enable sys\_clone3 syscall for rv64")
Signed-off-by: Palmer Dabbelt
Reviewed-by: Arnd Bergmann
Acked-by: Christian Brauner
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit cf63b49349cc308429cbeba08c416801145e853d
Author: Vadim Pasternak
Date: Mon Aug 23 17:45:02 2021 +0300
i2c: mlxcpld: Modify register setting for 400KHz frequency
[ Upstream commit fa1049135c15b4930ce7ea757a81b1b78908f304 ]
Change setting for 400KHz frequency support by more accurate value.
Fixes: 66b0c2846ba8 ("i2c: mlxcpld: Add support for I2C bus frequency setting")
Signed-off-by: Vadim Pasternak
Signed-off-by: Wolfram Sang
Signed-off-by: Sasha Levin
commit 3655a19345192ec8e8c55c1eb29f738f029854f5
Author: Vadim Pasternak
Date: Mon Aug 23 17:45:01 2021 +0300
i2c: mlxcpld: Fix criteria for frequency setting
[ Upstream commit 52f57396c75acd77ebcdf3d20aed24ed248e9f79 ]
Value for getting frequency capability wrongly has been taken from
register offset instead of register value.
Fixes: 66b0c2846ba8 ("i2c: mlxcpld: Add support for I2C bus frequency setting")
Signed-off-by: Vadim Pasternak
Signed-off-by: Wolfram Sang
Signed-off-by: Sasha Levin
commit d590a410e472417a22336c7c37685bfb38e801f2
Author: Tiezhu Yang
Date: Mon Sep 27 15:06:14 2021 +0800
bpf, s390: Fix potential memory leak about jit\_data
[ Upstream commit 686cb8b9f6b46787f035afe8fbd132a74e6b1bdd ]
Make sure to free jit\_data through kfree() in the error path.
Fixes: 1c8f9b91c456 ("bpf: s390: add JIT support for multi-function programs")
Signed-off-by: Tiezhu Yang
Acked-by: Ilya Leoshkevich
Reviewed-by: Christian Borntraeger
Signed-off-by: Christian Borntraeger
Signed-off-by: Vasily Gorbik
Signed-off-by: Sasha Levin
commit f344ad3060c4cb9cb2b26e671405e04f28966d7a
Author: Tong Tiangen
Date: Wed Sep 1 02:46:21 2021 +0000
riscv/vdso: make arch\_setup\_additional\_pages wait for mmap\_sem for write killable
[ Upstream commit 8bb0ab3ae7a4dbe6cf32deb830cf2bdbf5736867 ]
riscv architectures relying on mmap\_sem for write in their
arch\_setup\_additional\_pages. If the waiting task gets killed by the oom
killer it would block oom\_reaper from asynchronous address space reclaim
and reduce the chances of timely OOM resolving. Wait for the lock in
the killable mode and return with EINTR if the task got killed while
waiting.
Signed-off-by: Tong Tiangen
Reviewed-by: Kefeng Wang
Fixes: 76d2a0493a17 ("RISC-V: Init and Halt Code")
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit b8b60c1139c7912cf68a20638e9a480971c1b3d0
Author: Tong Tiangen
Date: Wed Sep 1 02:46:20 2021 +0000
riscv/vdso: Move vdso data page up front
[ Upstream commit 78a743cd82a35ca0724179fc22834f06a2151fc2 ]
As commit 601255ae3c98 ("arm64: vdso: move data page before code pages"), the
same issue exists on riscv, testcase is shown below, make sure that vdso.so is
bigger than page size,
struct timespec tp;
clock\_gettime(5, &tp);
printf("tv\_sec: %ld, tv\_nsec: %ld\n", tp.tv\_sec, tp.tv\_nsec);
without this patch, test result : tv\_sec: 0, tv\_nsec: 0
with this patch, test result : tv\_sec: 1629271537, tv\_nsec: 748000000
Move the vdso data page in front of the VDSO area to fix the issue.
Fixes: ad5d1122b82fb ("riscv: use vDSO common flow to reduce the latency of the time-related functions")
Signed-off-by: Tong Tiangen
Reviewed-by: Kefeng Wang
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit 309fd6f1e7cfab072bfee0dafabb74649890aacc
Author: Tong Tiangen
Date: Wed Sep 1 02:46:19 2021 +0000
riscv/vdso: Refactor asm/vdso.h
[ Upstream commit bb4a23c994aebcd96c567a0be8e964d516bd4a61 ]
The asm/vdso.h will be included in vdso.lds.S in the next patch, the
following cleanup is needed to avoid syntax error:
1.the declaration of sys\_riscv\_flush\_icache() is moved into asm/syscall.h.
2.the definition of struct vdso\_data is moved into kernel/vdso.c.
2.the definition of VDSO\_SYMBOL is placed under "#ifndef \_\_ASSEMBLY\_\_".
Also remove the redundant linux/types.h include.
Signed-off-by: Tong Tiangen
Reviewed-by: Kefeng Wang
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit ff26f96fe0a26c9dca942b667699a1f56f2888a1
Author: Palmer Dabbelt
Date: Wed Aug 25 22:52:45 2021 -0700
RISC-V: Fix VDSO build for !MMU
[ Upstream commit a290f510a178830a01bfc06e66a54bbe4ece5d2a ]
We don't have a VDSO for the !MMU configurations, so don't try to build
one.
Fixes: fde9c59aebaf ("riscv: explicitly use symbol offsets for VDSO")
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit 3631280713464ab9078bde9e6467f244f897c204
Author: Saleem Abdulrasool
Date: Wed Aug 4 17:32:14 2021 +0000
riscv: explicitly use symbol offsets for VDSO
[ Upstream commit fde9c59aebafb91caeed816cc510b56f14aa63ae ]
The current implementation of the `\_\_rt\_sigaction` reference computed an
absolute offset relative to the mapped base of the VDSO. While this can
be handled in the medlow model, the medany model cannot handle this as
it is meant to be position independent. The current implementation
relied on the BFD linker relaxing the PC-relative relocation into an
absolute relocation as it was a near-zero address allowing it to be
referenced relative to `zero`.
We now extract the offsets and create a generated header allowing the
build with LLVM and lld to succeed as we no longer depend on the linker
rewriting address references near zero. This change was largely
modelled after the ARM64 target which does something similar.
Signed-off-by: Saleem Abdulrasool
Tested-by: Nathan Chancellor
Signed-off-by: Palmer Dabbelt
Signed-off-by: Sasha Levin
commit 26e7025ef25a6419cbaea647e3f47d48a2219137
Author: Kewei Xu
Date: Fri Sep 17 18:14:14 2021 +0800
i2c: mediatek: Add OFFSET\_EXT\_CONF setting back
[ Upstream commit 3bce7703c7ba648bd9e174dc1413f422b7998833 ]
In the commit be5ce0e97cc7 ("i2c: mediatek: Add i2c ac-timing adjust
support"), we miss setting OFFSET\_EXT\_CONF register if
i2c->dev\_comp->timing\_adjust is false, now add it back.
Fixes: be5ce0e97cc7 ("i2c: mediatek: Add i2c ac-timing adjust support")
Signed-off-by: Kewei Xu
Reviewed-by: Qii Wang
Signed-off-by: Wolfram Sang
Signed-off-by: Sasha Levin
commit 90f1077c9184ec2ae9989e4642f211263f301694
Author: Jamie Iles
Date: Wed Sep 22 17:57:18 2021 +0100
i2c: acpi: fix resource leak in reconfiguration device addition
[ Upstream commit 6558b646ce1c2a872fe1c2c7cb116f05a2c1950f ]
acpi\_i2c\_find\_adapter\_by\_handle() calls bus\_find\_device() which takes a
reference on the adapter which is never released which will result in a
reference count leak and render the adapter unremovable. Make sure to
put the adapter after creating the client in the same manner that we do
for OF.
Fixes: 525e6fabeae2 ("i2c / ACPI: add support for ACPI reconfigure notifications")
Signed-off-by: Jamie Iles
Acked-by: Mika Westerberg
[wsa: fixed title]
Signed-off-by: Wolfram Sang
Signed-off-by: Sasha Levin
commit d40c4da7318f73583b7b4b7892ddd83c919bf3e3
Author: Alexey Kardashevskiy
Date: Thu Sep 30 13:44:54 2021 +1000
powerpc/iommu: Report the correct most efficient DMA mask for PCI devices
[ Upstream commit 23c216b335d1fbd716076e8263b54a714ea3cf0e ]
According to dma-api.rst, the dma\_get\_required\_mask() helper should return
"the mask that the platform requires to operate efficiently". Which in
the case of PPC64 means the bypass mask and not a mask from an IOMMU table
which is shorter and slower to use due to map/unmap operations (especially
expensive on "pseries").
However the existing implementation ignores the possibility of bypassing
and returns the IOMMU table mask on the pseries platform which makes some
drivers (mpt3sas is one example) choose 32bit DMA even though bypass is
supported. The powernv platform sort of handles it by having a bigger
default window with a mask >=40 but it only works as drivers choose
63/64bit if the required mask is >32 which is rather pointless.
This reintroduces the bypass capability check to let drivers make
a better choice of the DMA mask.
Fixes: f1565c24b596 ("powerpc: use the generic dma\_ops\_bypass mode")
Signed-off-by: Alexey Kardashevskiy
Reviewed-by: Christoph Hellwig
Signed-off-by: Michael Ellerman
Link: https://lore.kernel.org/r/20210930034454.95794-1-aik@ozlabs.ru
Signed-off-by: Sasha Levin
commit 272b85c2fdb2a65cf1670856578189396ce0f154
Author: Mike Manning
Date: Tue Oct 5 14:03:42 2021 +0100
net: prefer socket bound to interface when not in VRF
[ Upstream commit 8d6c414cd2fb74aa6812e9bfec6178f8246c4f3a ]
The commit 6da5b0f027a8 ("net: ensure unbound datagram socket to be
chosen when not in a VRF") modified compute\_score() so that a device
match is always made, not just in the case of an l3mdev skb, then
increments the score also for unbound sockets. This ensures that
sockets bound to an l3mdev are never selected when not in a VRF.
But as unbound and bound sockets are now scored equally, this results
in the last opened socket being selected if there are matches in the
default VRF for an unbound socket and a socket bound to a dev that is
not an l3mdev. However, handling prior to this commit was to always
select the bound socket in this case. Reinstate this handling by
incrementing the score only for bound sockets. The required isolation
due to choosing between an unbound socket and a socket bound to an
l3mdev remains in place due to the device match always being made.
The same approach is taken for compute\_score() for stream sockets.
Fixes: 6da5b0f027a8 ("net: ensure unbound datagram socket to be chosen when not in a VRF")
Fixes: e78190581aff ("net: ensure unbound stream socket to be chosen when not in a VRF")
Signed-off-by: Mike Manning
Reviewed-by: David Ahern
Link: https://lore.kernel.org/r/cf0a8523-b362-1edf-ee78-eef63cbbb428@gmail.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Sasha Levin
commit 8d2a1e7fb90c912714b6c5900f883c3f95e89471
Author: Stefan Assmann
Date: Tue Aug 24 12:06:39 2021 +0200
iavf: fix double unlock of crit\_lock
[ Upstream commit 54ee39439acd9f8b161703c6ad4f4e1835585277 ]
The crit\_lock mutex could be unlocked twice as reported here
https://lists.osuosl.org/pipermail/intel-wired-lan/Week-of-Mon-20210823/025525.html
Remove the superfluous unlock. Technically the problem was already
present before 5ac49f3c2702 as that commit only replaced the locking
primitive, but no functional change.
Reported-by: Dan Carpenter
Fixes: 5ac49f3c2702 ("iavf: use mutexes for locking of critical sections")
Fixes: bac8486116b0 ("iavf: Refactor the watchdog state machine")
Signed-off-by: Stefan Assmann
Signed-off-by: Tony Nguyen
Signed-off-by: Sasha Levin
commit 75099439209d3cda439a1d9b00d19a50f0066fef
Author: Sylwester Dziedziuch
Date: Fri Sep 24 11:40:41 2021 +0200
i40e: Fix freeing of uninitialized misc IRQ vector
[ Upstream commit 2e5a20573a926302b233b0c2e1077f5debc7ab2e ]
When VSI set up failed in i40e\_probe() as part of PF switch set up
driver was trying to free misc IRQ vectors in
i40e\_clear\_interrupt\_scheme and produced a kernel Oops:
Trying to free already-free IRQ 266
WARNING: CPU: 0 PID: 5 at kernel/irq/manage.c:1731 \_\_free\_irq+0x9a/0x300
Workqueue: events work\_for\_cpu\_fn
RIP: 0010:\_\_free\_irq+0x9a/0x300
Call Trace:
? synchronize\_irq+0x3a/0xa0
free\_irq+0x2e/0x60
i40e\_clear\_interrupt\_scheme+0x53/0x190 [i40e]
i40e\_probe.part.108+0x134b/0x1a40 [i40e]
? kmem\_cache\_alloc+0x158/0x1c0
? acpi\_ut\_update\_ref\_count.part.1+0x8e/0x345
? acpi\_ut\_update\_object\_reference+0x15e/0x1e2
? strstr+0x21/0x70
? irq\_get\_irq\_data+0xa/0x20
? mp\_check\_pin\_attr+0x13/0xc0
? irq\_get\_irq\_data+0xa/0x20
? mp\_map\_pin\_to\_irq+0xd3/0x2f0
? acpi\_register\_gsi\_ioapic+0x93/0x170
? pci\_conf1\_read+0xa4/0x100
? pci\_bus\_read\_config\_word+0x49/0x70
? do\_pci\_enable\_device+0xcc/0x100
local\_pci\_probe+0x41/0x90
work\_for\_cpu\_fn+0x16/0x20
process\_one\_work+0x1a7/0x360
worker\_thread+0x1cf/0x390
? create\_worker+0x1a0/0x1a0
kthread+0x112/0x130
? kthread\_flush\_work\_fn+0x10/0x10
ret\_from\_fork+0x1f/0x40
The problem is that at that point misc IRQ vectors
were not allocated yet and we get a call trace
that driver is trying to free already free IRQ vectors.
Add a check in i40e\_clear\_interrupt\_scheme for \_\_I40E\_MISC\_IRQ\_REQUESTED
PF state before calling i40e\_free\_misc\_vector. This state is set only if
misc IRQ vectors were properly initialized.
Fixes: c17401a1dd21 ("i40e: use separate state bit for miscellaneous IRQ setup")
Reported-by: PJ Waskiewicz
Signed-off-by: Sylwester Dziedziuch
Signed-off-by: Mateusz Palczewski
Tested-by: Dave Switzer
Signed-off-by: Tony Nguyen
Signed-off-by: Sasha Levin
commit d6db5bcd1817b0dad6519a995459a85988e58ea4
Author: Jiri Benc
Date: Tue Sep 14 10:54:42 2021 +0200
i40e: fix endless loop under rtnl
[ Upstream commit 857b6c6f665cca9828396d9743faf37fd09e9ac3 ]
The loop in i40e\_get\_capabilities can never end. The problem is that
although i40e\_aq\_discover\_capabilities returns with an error if there's
a firmware problem, the returned error is not checked. There is a check for
pf->hw.aq.asq\_last\_status but that value is set to I40E\_AQ\_RC\_OK on most
firmware problems.
When i40e\_aq\_discover\_capabilities encounters a firmware problem, it will
encounter the same problem on its next invocation. As the result, the loop
becomes endless. We hit this with I40E\_ERR\_ADMIN\_QUEUE\_TIMEOUT but looking
at the code, it can happen with a range of other firmware errors.
I don't know what the correct behavior should be: whether the firmware
should be retried a few times, or whether pf->hw.aq.asq\_last\_status should
be always set to the encountered firmware error (but then it would be
pointless and can be just replaced by the i40e\_aq\_discover\_capabilities
return value). However, the current behavior with an endless loop under the
rtnl mutex(!) is unacceptable and Intel has not submitted a fix, although we
explained the bug to them 7 months ago.
This may not be the best possible fix but it's better than hanging the whole
system on a firmware bug.
Fixes: 56a62fc86895 ("i40e: init code and hardware support")
Tested-by: Stefan Assmann
Signed-off-by: Jiri Benc
Reviewed-by: Jesse Brandeburg
Tested-by: Dave Switzer
Signed-off-by: Tony Nguyen
Signed-off-by: Sasha Levin
commit 1fad5d7f75f7f49d9b4f821228abcfe6a80abfbd
Author: Eric Dumazet
Date: Tue Oct 5 18:01:38 2021 -0700
gve: report 64bit tx\_bytes counter from gve\_handle\_report\_stats()
[ Upstream commit 17c37d748f2b122a95b6d0524d410302ff89a2b1 ]
Each tx queue maintains a 64bit counter for bytes, there is
no reason to truncate this to 32bit (or this has not been
documented)
Fixes: 24aeb56f2d38 ("gve: Add Gvnic stats AQ command and ethtool show/set-priv-flags.")
Signed-off-by: Eric Dumazet
Cc: Yangchun Fu
Cc: Kuo Zhao
Cc: David Awogbemila
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bcf4f5e4d33db4ccece3b9835d4bbbf0a8b53f69
Author: Eric Dumazet
Date: Tue Oct 5 17:30:30 2021 -0700
gve: fix gve\_get\_stats()
[ Upstream commit 2f57d4975fa027eabd35fdf23a49f8222ef3abf2 ]
gve\_get\_stats() can report wrong numbers if/when u64\_stats\_fetch\_retry()
returns true.
What is needed here is to sample values in temporary variables,
and only use them after each loop is ended.
Fixes: f5cedc84a30d ("gve: Add transmit and receive support")
Signed-off-by: Eric Dumazet
Cc: Catherine Sullivan
Cc: Sagi Shahar
Cc: Jon Olson
Cc: Willem de Bruijn
Cc: Luigi Rizzo
Cc: Jeroen de Borst
Cc: Tao Liu
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit f4479f3bc861a5f3865a537066080c1ec4949c39
Author: Eric Dumazet
Date: Tue Oct 5 14:04:17 2021 -0700
rtnetlink: fix if\_nlmsg\_stats\_size() under estimation
[ Upstream commit d34367991933d28bd7331f67a759be9a8c474014 ]
rtnl\_fill\_statsinfo() is filling skb with one mandatory if\_stats\_msg structure.
nlmsg\_put(skb, pid, seq, type, sizeof(struct if\_stats\_msg), flags);
But if\_nlmsg\_stats\_size() never considered the needed storage.
This bug did not show up because alloc\_skb(X) allocates skb with
extra tailroom, because of added alignments. This could very well
be changed in the future to have deterministic behavior.
Fixes: 10c9ead9f3c6 ("rtnetlink: add new RTM\_GETSTATS message to dump link stats")
Signed-off-by: Eric Dumazet
Cc: Roopa Prabhu
Acked-by: Roopa Prabhu
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit f5cfed82e0f38cf0e6101f4193c154aab9a709ef
Author: Catherine Sullivan
Date: Tue Oct 5 19:42:21 2021 -0700
gve: Properly handle errors in gve\_assign\_qpl
[ Upstream commit d4b111fda69a01e0a7439d05993f5dad567c93aa ]
Ignored errors would result in crash.
Fixes: ede3fcf5ec67f ("gve: Add support for raw addressing to the rx path")
Signed-off-by: Catherine Sullivan
Signed-off-by: Jeroen de Borst
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 2044137a268a50c479027703f1c516aa155196d9
Author: Tao Liu
Date: Tue Oct 5 19:42:20 2021 -0700
gve: Avoid freeing NULL pointer
[ Upstream commit 922aa9bcac92b3ab6a423526a8e785b35a60b441 ]
Prevent possible crashes when cleaning up after unsuccessful
initializations.
Fixes: 893ce44df5658 ("gve: Add basic driver framework for Compute Engine Virtual NIC")
Signed-off-by: Tao Liu
Signed-off-by: Catherine Sully
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 3e8df2cada215ccdceaaad382d766de0eacecb58
Author: Catherine Sullivan
Date: Tue Oct 5 19:42:19 2021 -0700
gve: Correct available tx qpl check
[ Upstream commit d03477ee10f4bc35d3573cf1823814378ef2dca2 ]
The qpl\_map\_size is rounded up to a multiple of sizeof(long), but the
number of qpls doesn't have to be.
Fixes: f5cedc84a30d2 ("gve: Add transmit and receive support")
Signed-off-by: Catherine Sullivan
Signed-off-by: Jeroen de Borst
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit bb23ade18ad7b9e8fc42fa1a91d35f67543ec9ec
Author: Wong Vee Khee
Date: Tue Oct 5 19:51:00 2021 +0800
net: stmmac: trigger PCS EEE to turn off on link down
[ Upstream commit d4aeaed80b0ebb020fadf2073b23462928dbdc17 ]
The current implementation enable PCS EEE feature in the event of link
up, but PCS EEE feature is not disabled on link down.
This patch makes sure PCE EEE feature is disabled on link down.
Fixes: 656ed8b015f1 ("net: stmmac: fix EEE init issue when paired with EEE capable PHYs")
Signed-off-by: Wong Vee Khee
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 940ee87907f080876d4e9e6a3b8cdf92421a5f1b
Author: Wong Vee Khee
Date: Tue Oct 5 19:50:59 2021 +0800
net: pcs: xpcs: fix incorrect steps on disable EEE
[ Upstream commit 590df78bc7d1d0425196a8e11ce6676d7023fb26 ]
When Energy-Efficient Ethernet(EEE) is disable from the MAC side,
we need to clear the DW\_VR\_MII\_EEE\_TRN\_LPI bit of DW\_VR\_MII\_EEE\_MCTRL1
register.
Fixes: 7617af3d1a5e ("net: pcs: Introducing support for DWC xpcs Energy Efficient Ethernet")
Cc: Michael Sit Wei Hong
Signed-off-by: Wong Vee Khee
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 88c3610045ca6e699331b6bb5c095c5565f30721
Author: Yang Yingliang
Date: Sat Sep 11 15:50:23 2021 +0800
drm/nouveau/debugfs: fix file release memory leak
[ Upstream commit f5a8703a9c418c6fc54eb772712dfe7641e3991c ]
When using single\_open() for opening, single\_release() should be
called, otherwise the 'op' allocated in single\_open() will be leaked.
Fixes: 6e9fc177399f ("drm/nouveau/debugfs: add copy of sysfs pstate interface ported to debugfs")
Reported-by: Hulk Robot
Signed-off-by: Yang Yingliang
Reviewed-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20210911075023.3969054-2-yangyingliang@huawei.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit 0b4e9fc14973a94ac0520f19b3633493ae13c912
Author: Yang Yingliang
Date: Sat Sep 11 15:50:22 2021 +0800
drm/nouveau/kms/nv50-: fix file release memory leak
[ Upstream commit 0b3d4945cc7e7ea1acd52cb06dfa83bfe265b6d5 ]
When using single\_open() for opening, single\_release() should be
called, otherwise the 'op' allocated in single\_open() will be leaked.
Fixes: 12885ecbfe62 ("drm/nouveau/kms/nvd9-: Add CRC support")
Reported-by: Hulk Robot
Signed-off-by: Yang Yingliang
Reviewed-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20210911075023.3969054-1-yangyingliang@huawei.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit 548f2ff8ea5e0ce767ae3418d1ec5308990be87d
Author: Jeremy Cline
Date: Wed Dec 2 19:02:20 2020 -0500
drm/nouveau: avoid a use-after-free when BO init fails
[ Upstream commit bcf34aa5082ee2343574bc3f4d1c126030913e54 ]
nouveau\_bo\_init() is backed by ttm\_bo\_init() and ferries its return code
back to the caller. On failures, ttm\_bo\_init() invokes the provided
destructor which should de-initialize and free the memory.
Thus, when nouveau\_bo\_init() returns an error the gem object has already
been released and the memory freed by nouveau\_bo\_del\_ttm().
Fixes: 019cbd4a4feb ("drm/nouveau: Initialize GEM object before TTM object")
Cc: Thierry Reding
Signed-off-by: Jeremy Cline
Reviewed-by: Lyude Paul
Reviewed-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20201203000220.18238-1-jcline@redhat.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit 23514c752f9bc53f02ea34a0ad1e3a636cc02865
Author: Mark Brown
Date: Tue Sep 21 22:21:02 2021 +0100
video: fbdev: gbefb: Only instantiate device when built for IP32
[ Upstream commit 11b8e2bb986d23157e82e267fb8cc6b281dfdee9 ]
The gbefb driver not only registers a driver but also the device for that
driver. This is all well and good when run on the IP32 machines that are
supported by the driver but since the driver supports building with
COMPILE\_TEST we might also be building on other platforms which do not have
this hardware and will crash instantiating the driver. Add an IS\_ENABLED()
check so we compile out the device registration if we don't have the Kconfig
option for the machine enabled.
Fixes: 552ccf6b259d290c0c ("video: fbdev: gbefb: add COMPILE\_TEST support")
Signed-off-by: Mark Brown
Cc: Bartlomiej Zolnierkiewicz
Signed-off-by: Daniel Vetter
Link: https://patchwork.freedesktop.org/patch/msgid/20210921212102.30803-1-broonie@kernel.org
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit ae7a72cd325cbd4ea999c539a806ff635d436ce6
Author: Christophe Branchereau
Date: Tue Sep 14 11:27:16 2021 +0200
drm/panel: abt-y030xx067a: yellow tint fix
[ Upstream commit 413e8d06ad896dae9bbc6f97b0abea5eae5495f1 ]
The previous parameters caused an unbalanced yellow tint.
Fixes: 7467389bdafb ("drm/panel: Add ABT Y030XX067A 3.0" 320x480 panel")
Signed-off-by: Christophe Branchereau
Acked-by: Sam Ravnborg
[Paul: Add Fixes: tag, and fix case and punctuation in commit message]
Signed-off-by: Paul Cercueil
Link: https://patchwork.freedesktop.org/patch/msgid/20210914092716.2370039-1-cbranchereau@gmail.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit e6b90dcda29b632212b973556704470d58b93588
Author: Ben Skeggs
Date: Tue Sep 21 19:07:35 2021 +1000
drm/nouveau/fifo/ga102: initialise chid on return from channel creation
[ Upstream commit 0689ea432a85ad1a108f47c3d90b6feae322c7f9 ]
Turns out caller isn't zero-initialised after-all.
Fixes: 49b2dfc08182 ("drm/nouveau/ga102-: support ttm buffer moves via copy engine")
Reported-by: Karol Herbst
Signed-off-by: Ben Skeggs
Reviewed-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20210921090735.247236-1-skeggsb@gmail.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit 8228b3b3b5a221f65a1d0a73292d9e91da451b6d
Author: Jernej Skrabec
Date: Wed Sep 15 19:58:36 2021 +0200
drm/sun4i: dw-hdmi: Fix HDMI PHY clock setup
[ Upstream commit c64c8e04a12ed3e2238761e26cda78e72550dc98 ]
Recent rework, which made HDMI PHY driver a platform device, inadvertely
reversed clock setup order. HW is very touchy about it. Proper way is to
handle controllers resets and clocks first and HDMI PHYs second.
Currently, without this fix, first mode set completely fails (nothing on
HDMI monitor) on H3 era PHYs. On H6, it still somehow work.
Move HDMI PHY reset & clocks handling to sun8i\_hdmi\_phy\_init() which
will assure that code is executed after controllers reset & clocks are
handled. Additionally, add sun8i\_hdmi\_phy\_deinit() which will deinit
them at controllers driver unload.
Tested on A64, H3, H6 and R40.
Fixes: 9bf3797796f5 ("drm/sun4i: dw-hdmi: Make HDMI PHY into a platform device")
Signed-off-by: Jernej Skrabec
Signed-off-by: Maxime Ripard
Link: https://patchwork.freedesktop.org/patch/msgid/20210915175836.3158839-1-jernej.skrabec@gmail.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Sasha Levin
commit ad0fca5a28b3441e60702f33a5f0640741e917ec
Author: Tony Lindgren
Date: Wed Sep 8 08:49:36 2021 +0300
bus: ti-sysc: Use CLKDM\_NOAUTO for dra7 dcan1 for errata i893
[ Upstream commit b13a270ace2e4c70653aa1d1d0394c553905802f ]
Commit 94f6345712b3 ("bus: ti-sysc: Implement quirk handling for
CLKDM\_NOAUTO") should have also added the quirk for dra7 dcan1 in
addition to dcan2 for errata i893 handling.
Let's also pass the quirk flag for legacy mode booting for if "ti,hwmods"
dts property is used with related dcan hwmod data. This should be only
needed if anybody needs to git bisect earlier stable trees though.
Fixes: 94f6345712b3 ("bus: ti-sysc: Implement quirk handling for CLKDM\_NOAUTO")
Signed-off-by: Tony Lindgren
Signed-off-by: Sasha Levin
commit 37e2d7fe11ae61fd78396066efe9ca88a5ecb5c1
Author: Like Xu
Date: Tue Sep 28 18:29:38 2021 +0800
perf jevents: Free the sys\_event\_tables list after processing entries
[ Upstream commit b94729919db2c6737501c36ea6526a36d5d63fa2 ]
The compiler reports that free\_sys\_event\_tables() is dead code.
But according to the semantics, the "LIST\_HEAD(sys\_event\_tables)" should
also be released, just like we do with 'arch\_std\_events' in main().
Fixes: e9d32c1bf0cd7a98 ("perf vendor events: Add support for arch standard events")
Signed-off-by: Like Xu
Reviewed-by: John Garry
Cc: Alexander Shishkin
Cc: Jiri Olsa
Cc: Mark Rutland
Cc: Namhyung Kim
Cc: Peter Zijlstra
Link: http://lore.kernel.org/lkml/20210928102938.69681-1-likexu@tencent.com
Signed-off-by: Arnaldo Carvalho de Melo
Signed-off-by: Sasha Levin
commit 72e9a1bf9b722628c28092e0c2cd8717edd201dc
Author: Guchun Chen
Date: Fri Oct 1 09:48:50 2021 +0800
drm/amdgpu: handle the case of pci\_channel\_io\_frozen only in amdgpu\_pci\_resume
[ Upstream commit 248b061689a40f4fed05252ee2c89f87cf26d7d8 ]
In current code, when a PCI error state pci\_channel\_io\_normal is detectd,
it will report PCI\_ERS\_RESULT\_CAN\_RECOVER status to PCI driver, and PCI
driver will continue the execution of PCI resume callback report\_resume by
pci\_walk\_bridge, and the callback will go into amdgpu\_pci\_resume
finally, where write lock is releasd unconditionally without acquiring
such lock first. In this case, a deadlock will happen when other threads
start to acquire the read lock.
To fix this, add a member in amdgpu\_device strucutre to cache
pci\_channel\_state, and only continue the execution in amdgpu\_pci\_resume
when it's pci\_channel\_io\_frozen.
Fixes: c9a6b82f45e2 ("drm/amdgpu: Implement DPC recovery")
Suggested-by: Andrey Grodzovsky
Signed-off-by: Guchun Chen
Reviewed-by: Andrey Grodzovsky
Signed-off-by: Alex Deucher
Signed-off-by: Sasha Levin
commit 7e5ce6029b627efb4a004746cfdc1eeff850e6eb
Author: Lang Yu
Date: Wed Sep 29 14:54:39 2021 +0800
drm/amdkfd: fix a potential ttm->sg memory leak
[ Upstream commit b072ef1215aca33186e3a10109e872e528a9e516 ]
Memory is allocated for ttm->sg by kmalloc in kfd\_mem\_dmamap\_userptr,
but isn't freed by kfree in kfd\_mem\_dmaunmap\_userptr. Free it!
Fixes: 264fb4d332f5 ("drm/amdgpu: Add multi-GPU DMA mapping helpers")
Signed-off-by: Lang Yu
Reviewed-by: Felix Kuehling
Signed-off-by: Alex Deucher
Signed-off-by: Sasha Levin
commit 50002489a20c9029e6603f950908e1879b82efff
Author: Linus Walleij
Date: Wed Sep 22 22:09:33 2021 +0200
ARM: defconfig: gemini: Restore framebuffer
[ Upstream commit a6949059318a064880050c76a9d8fb070156385f ]
The framebuffer is gone on the D-Link DIR-685, restore it.
Fixes: f611b1e7624c ("drm: Avoid circular dependencies for CONFIG\_FB")
Signed-off-by: Linus Walleij
Cc: Kees Cook
Link: https://lore.kernel.org/r/20210922200933.1825752-1-linus.walleij@linaro.org'
Signed-off-by: Arnd Bergmann
Signed-off-by: Sasha Levin
commit 942bde2caec2af3bb27a45f9b0edc461c6f82999
Author: Eric Dumazet
Date: Mon Oct 4 14:24:15 2021 -0700
netlink: annotate data races around nlk->bound
[ Upstream commit 7707a4d01a648e4c655101a469c956cb11273655 ]
While existing code is correct, KCSAN is reporting
a data-race in netlink\_insert / netlink\_sendmsg [1]
It is correct to read nlk->bound without a lock, as netlink\_autobind()
will acquire all needed locks.
[1]
BUG: KCSAN: data-race in netlink\_insert / netlink\_sendmsg
write to 0xffff8881031c8b30 of 1 bytes by task 18752 on cpu 0:
netlink\_insert+0x5cc/0x7f0 net/netlink/af\_netlink.c:597
netlink\_autobind+0xa9/0x150 net/netlink/af\_netlink.c:842
netlink\_sendmsg+0x479/0x7c0 net/netlink/af\_netlink.c:1892
sock\_sendmsg\_nosec net/socket.c:703 [inline]
sock\_sendmsg net/socket.c:723 [inline]
\_\_\_\_sys\_sendmsg+0x360/0x4d0 net/socket.c:2392
\_\_\_sys\_sendmsg net/socket.c:2446 [inline]
\_\_sys\_sendmsg+0x1ed/0x270 net/socket.c:2475
\_\_do\_sys\_sendmsg net/socket.c:2484 [inline]
\_\_se\_sys\_sendmsg net/socket.c:2482 [inline]
\_\_x64\_sys\_sendmsg+0x42/0x50 net/socket.c:2482
do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]
do\_syscall\_64+0x3d/0x90 arch/x86/entry/common.c:80
entry\_SYSCALL\_64\_after\_hwframe+0x44/0xae
read to 0xffff8881031c8b30 of 1 bytes by task 18751 on cpu 1:
netlink\_sendmsg+0x270/0x7c0 net/netlink/af\_netlink.c:1891
sock\_sendmsg\_nosec net/socket.c:703 [inline]
sock\_sendmsg net/socket.c:723 [inline]
\_\_sys\_sendto+0x2a8/0x370 net/socket.c:2019
\_\_do\_sys\_sendto net/socket.c:2031 [inline]
\_\_se\_sys\_sendto net/socket.c:2027 [inline]
\_\_x64\_sys\_sendto+0x74/0x90 net/socket.c:2027
do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]
do\_syscall\_64+0x3d/0x90 arch/x86/entry/common.c:80
entry\_SYSCALL\_64\_after\_hwframe+0x44/0xae
value changed: 0x00 -> 0x01
Reported by Kernel Concurrency Sanitizer on:
CPU: 1 PID: 18751 Comm: syz-executor.0 Not tainted 5.14.0-rc1-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Fixes: da314c9923fe ("netlink: Replace rhash\_portid with bound")
Signed-off-by: Eric Dumazet
Reported-by: syzbot
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 464be37f127bd9421ad5c6fce8aa0699619a68c0
Author: Wong Vee Khee
Date: Tue Oct 5 11:45:21 2021 +0800
net: pcs: xpcs: fix incorrect CL37 AN sequence
[ Upstream commit e3cf002d5a4452f8adc5543df341cf96fd702fcf ]
According to Synopsys DesignWare Cores Ethernet PCS databook, it is
required to disable Clause 37 auto-negotiation by programming bit-12
(AN\_ENABLE) to 0 if it is already enabled, before programming various
fields of VR\_MII\_AN\_CTRL registers.
After all these programming are done, it is then required to enable
Clause 37 auto-negotiation by programming bit-12 (AN\_ENABLE) to 1.
Fixes: b97b5331b8ab ("net: pcs: add C37 SGMII AN support for intel mGbE controller")
Cc: Vladimir Oltean
Signed-off-by: Wong Vee Khee
Reviewed-by: Vladimir Oltean
Tested-by: Vladimir Oltean
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 6594158f24e1479af348f6d47ead535c0c579497
Author: Sean Anderson
Date: Mon Oct 4 17:50:02 2021 -0400
net: sfp: Fix typo in state machine debug string
[ Upstream commit 25a9da6641f1f66006e93ddbefee13a437efa8c0 ]
The string should be "tx\_disable" to match the state enum.
Fixes: 4005a7cb4f55 ("net: phy: sftp: print debug message with text, not numbers")
Signed-off-by: Sean Anderson
Reviewed-by: Andrew Lunn
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 7a1c1af341041221b3acb9d7036cc2b43e0efa75
Author: Eric Dumazet
Date: Mon Oct 4 12:55:22 2021 -0700
net/sched: sch\_taprio: properly cancel timer from taprio\_destroy()
[ Upstream commit a56d447f196fa9973c568f54c0d76d5391c3b0c0 ]
There is a comment in qdisc\_create() about us not calling ops->reset()
in some cases.
err\_out4:
/\*
\* Any broken qdiscs that would require a ops->reset() here?
\* The qdisc was never in action so it shouldn't be necessary.
\*/
As taprio sets a timer before actually receiving a packet, we need
to cancel it from ops->destroy, just in case ops->reset has not
been called.
syzbot reported:
ODEBUG: free active (active state 0) object type: hrtimer hint: advance\_sched+0x0/0x9a0 arch/x86/include/asm/atomic64\_64.h:22
WARNING: CPU: 0 PID: 8441 at lib/debugobjects.c:505 debug\_print\_object+0x16e/0x250 lib/debugobjects.c:505
Modules linked in:
CPU: 0 PID: 8441 Comm: syz-executor813 Not tainted 5.14.0-rc6-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
RIP: 0010:debug\_print\_object+0x16e/0x250 lib/debugobjects.c:505
Code: ff df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 af 00 00 00 48 8b 14 dd e0 d3 e3 89 4c 89 ee 48 c7 c7 e0 c7 e3 89 e8 5b 86 11 05 <0f> 0b 83 05 85 03 92 09 01 48 83 c4 18 5b 5d 41 5c 41 5d 41 5e c3
RSP: 0018:ffffc9000130f330 EFLAGS: 00010282
RAX: 0000000000000000 RBX: 0000000000000003 RCX: 0000000000000000
RDX: ffff88802baeb880 RSI: ffffffff815d87b5 RDI: fffff52000261e58
RBP: 0000000000000001 R08: 0000000000000000 R09: 0000000000000000
R10: ffffffff815d25ee R11: 0000000000000000 R12: ffffffff898dd020
R13: ffffffff89e3ce20 R14: ffffffff81653630 R15: dffffc0000000000
FS: 0000000000f0d300(0000) GS:ffff8880b9d00000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007ffb64b3e000 CR3: 0000000036557000 CR4: 00000000001506e0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
\_\_debug\_check\_no\_obj\_freed lib/debugobjects.c:987 [inline]
debug\_check\_no\_obj\_freed+0x301/0x420 lib/debugobjects.c:1018
slab\_free\_hook mm/slub.c:1603 [inline]
slab\_free\_freelist\_hook+0x171/0x240 mm/slub.c:1653
slab\_free mm/slub.c:3213 [inline]
kfree+0xe4/0x540 mm/slub.c:4267
qdisc\_create+0xbcf/0x1320 net/sched/sch\_api.c:1299
tc\_modify\_qdisc+0x4c8/0x1a60 net/sched/sch\_api.c:1663
rtnetlink\_rcv\_msg+0x413/0xb80 net/core/rtnetlink.c:5571
netlink\_rcv\_skb+0x153/0x420 net/netlink/af\_netlink.c:2504
netlink\_unicast\_kernel net/netlink/af\_netlink.c:1314 [inline]
netlink\_unicast+0x533/0x7d0 net/netlink/af\_netlink.c:1340
netlink\_sendmsg+0x86d/0xdb0 net/netlink/af\_netlink.c:1929
sock\_sendmsg\_nosec net/socket.c:704 [inline]
sock\_sendmsg+0xcf/0x120 net/socket.c:724
\_\_\_\_sys\_sendmsg+0x6e8/0x810 net/socket.c:2403
\_\_\_sys\_sendmsg+0xf3/0x170 net/socket.c:2457
\_\_sys\_sendmsg+0xe5/0x1b0 net/socket.c:2486
do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]
do\_syscall\_64+0x35/0xb0 arch/x86/entry/common.c:80
Fixes: 44d4775ca518 ("net/sched: sch\_taprio: reset child qdiscs before freeing them")
Signed-off-by: Eric Dumazet
Cc: Davide Caratti
Reported-by: syzbot
Acked-by: Vinicius Costa Gomes
Acked-by: Davide Caratti
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit ba07883c780f36d93918c82c2aaf56ca5637da9f
Author: Eric Dumazet
Date: Mon Oct 4 18:05:08 2021 -0700
net: bridge: fix under estimation in br\_get\_linkxstats\_size()
[ Upstream commit 0854a0513321cf70bea5fa483ebcaa983cc7c62e ]
Commit de1799667b00 ("net: bridge: add STP xstats")
added an additional nla\_reserve\_64bit() in br\_fill\_linkxstats(),
but forgot to update br\_get\_linkxstats\_size() accordingly.
This can trigger the following in rtnl\_stats\_get()
WARN\_ON(err == -EMSGSIZE);
Fixes: de1799667b00 ("net: bridge: add STP xstats")
Signed-off-by: Eric Dumazet
Cc: Vivien Didelot
Cc: Nikolay Aleksandrov
Acked-by: Nikolay Aleksandrov
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit df7983fdbc835c3b30c257d553fbda4f336c7d6f
Author: Eric Dumazet
Date: Mon Oct 4 18:05:07 2021 -0700
net: bridge: use nla\_total\_size\_64bit() in br\_get\_linkxstats\_size()
[ Upstream commit dbe0b88064494b7bb6a9b2aa7e085b14a3112d44 ]
bridge\_fill\_linkxstats() is using nla\_reserve\_64bit().
We must use nla\_total\_size\_64bit() instead of nla\_total\_size()
for corresponding data structure.
Fixes: 1080ab95e3c7 ("net: bridge: add support for IGMP/MLD stats and export them via netlink")
Signed-off-by: Eric Dumazet
Cc: Nikolay Aleksandrov
Cc: Vivien Didelot
Acked-by: Nikolay Aleksandrov
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 47afb35c4f8783d07c60c426402185782c990bf1
Author: David Howells
Date: Thu Aug 12 23:08:54 2021 +0100
afs: Fix afs\_launder\_page() to set correct start file position
[ Upstream commit 5c0522484eb54b90f2e46a5db8d7a4ff3ff86e5d ]
Fix afs\_launder\_page() to set the starting position of the StoreData RPC at
the offset into the page at which the modified data starts instead of at
the beginning of the page (the iov\_iter is correctly offset).
The offset got lost during the conversion to passing an iov\_iter into
afs\_store\_data().
Changes:
ver #2:
- Use page\_offset() rather than manually calculating it[1].
Fixes: bd80d8a80e12 ("afs: Use ITER\_XARRAY for writing")
Signed-off-by: David Howells
Reviewed-by: Jeffrey Altman
cc: Marc Dionne
cc: linux-afs@lists.infradead.org
Link: https://lore.kernel.org/r/YST/0e92OdSH0zjg@casper.infradead.org/ [1]
Link: https://lore.kernel.org/r/162880783179.3421678.7795105718190440134.stgit@warthog.procyon.org.uk/ # v1
Link: https://lore.kernel.org/r/162937512409.1449272.18441473411207824084.stgit@warthog.procyon.org.uk/ # v1
Link: https://lore.kernel.org/r/162981148752.1901565.3663780601682206026.stgit@warthog.procyon.org.uk/ # v1
Link: https://lore.kernel.org/r/163005741670.2472992.2073548908229887941.stgit@warthog.procyon.org.uk/ # v2
Link: https://lore.kernel.org/r/163221839087.3143591.14278359695763025231.stgit@warthog.procyon.org.uk/ # v2
Link: https://lore.kernel.org/r/163292980654.4004896.7134735179887998551.stgit@warthog.procyon.org.uk/ # v2
Signed-off-by: Sasha Levin
commit 2eb0a54400689ad04775c049c2b7a5de34c87342
Author: David Howells
Date: Mon Jul 26 10:37:57 2021 +0100
netfs: Fix READ/WRITE confusion when calling iov\_iter\_xarray()
[ Upstream commit 330de47d14af0c3995db81cc03cf5ca683d94d81 ]
Fix netfs\_clear\_unread() to pass READ to iov\_iter\_xarray() instead of WRITE
(the flag is about the operation accessing the buffer, not what sort of
access it is doing to the buffer).
Fixes: 3d3c95046742 ("netfs: Provide readahead and readpage netfs helpers")
Signed-off-by: David Howells
Reviewed-by: Jeff Layton
cc: linux-cachefs@redhat.com
cc: linux-afs@lists.infradead.org
cc: ceph-devel@vger.kernel.org
cc: linux-cifs@vger.kernel.org
cc: linux-nfs@vger.kernel.org
cc: v9fs-developer@lists.sourceforge.net
cc: linux-fsdevel@vger.kernel.org
cc: linux-mm@kvack.org
Link: https://lore.kernel.org/r/162729351325.813557.9242842205308443901.stgit@warthog.procyon.org.uk/
Link: https://lore.kernel.org/r/162886603464.3940407.3790841170414793899.stgit@warthog.procyon.org.uk
Link: https://lore.kernel.org/r/163239074602.1243337.14154704004485867017.stgit@warthog.procyon.org.uk
Signed-off-by: Sasha Levin
commit cd4dcab5d20c9b9136d202913d531039b25eb9f5
Author: Lukasz Majczak
Date: Thu Sep 30 15:46:06 2021 +0200
drm/i915/bdb: Fix version check
[ Upstream commit fdddf8c3a477f77b3a623f220e78d45e89fc50d5 ]
With patch "drm/i915/vbt: Fix backlight parsing for VBT 234+"
the size of bdb\_lfp\_backlight\_data structure has been increased,
causing if-statement in the parse\_lfp\_backlight function
that comapres this structure size to the one retrieved from BDB,
always to fail for older revisions.
This patch calculates expected size of the structure for a given
BDB version and compares it with the value gathered from BDB.
Tested on Chromebook Pixelbook (Nocturne) (reports bdb->version = 221)
Fixes: d381baad29b4 ("drm/i915/vbt: Fix backlight parsing for VBT 234+")
Tested-by: Lukasz Majczak
Signed-off-by: Lukasz Majczak
Reviewed-by: José Roberto de Souza
Signed-off-by: José Roberto de Souza
Link: https://patchwork.freedesktop.org/patch/msgid/20210930134606.227234-1-lma@semihalf.com
(cherry picked from commit 4378daf5d04eed59724e6d0e74755e17dce2e105)
Signed-off-by: Jani Nikula
Signed-off-by: Sasha Levin
commit 4e7c20e5166e3e4debb87bb12b5df89eec0daafe
Author: Imre Deak
Date: Wed Sep 29 16:28:27 2021 +0300
drm/i915/tc: Fix TypeC port init/resume time sanitization
[ Upstream commit a532cde31de3cae6ed60e60d6f9379771f652809 ]
Atm during driver loading and system resume TypeC ports are accessed
before their HW/SW state is synced. Move the TypeC port sanitization to
the encoder's sync\_state hook to fix this.
v2: Handle the encoder disabled case in gen11\_dsi\_sync\_state() as well
(Jose, Jani)
Fixes: f9e76a6e68d3 ("drm/i915: Add an encoder hook to sanitize its state during init/resume")
Cc: José Roberto de Souza
Cc: Ville Syrjälä
Signed-off-by: Imre Deak
Reviewed-by: José Roberto de Souza
Link: https://patchwork.freedesktop.org/patch/msgid/20210929132833.2253961-1-imre.deak@intel.com
(cherry picked from commit 7194dc998dfffca096c30b3cd39625158608992d)
Signed-off-by: Jani Nikula
Signed-off-by: Sasha Levin
commit 185e4eeac58e1612a162a317c706bff6fdfdcf88
Author: Tejas Upadhyay
Date: Tue Jun 15 16:26:13 2021 +0530
drm/i915/jsl: Add W/A 1409054076 for JSL
[ Upstream commit 544021e3f2aa3c4c6c5aabc58907e8bab69b3762 ]
When pipe A is disabled and MIPI DSI is enabled on pipe B,
the AMT KVMR feature will incorrectly see pipe A as enabled.
Set 0x42080 bit 23=1 before enabling DSI on pipe B and leave
it set while DSI is enabled on pipe B. No impact to setting
it all the time.
Changes since V5:
- Added reviewed-by
- Removed redundant braces and debug message format - Imre
Changes since V4:
- Modified function comment Wa\_:icl,jsl,ehl - Lucas
- Modified debug message in sync state - Imre
Changes since V3:
- More meaningful name to workaround - Imre
- Remove boolean check clear flag
- Add WA\_verify hook in dsi sync\_state
Changes since V2:
- Used REG\_BIT, ignored pipe A and used sw state check - Jani
- Made function wrapper - Jani
Changes since V1:
- ./dim checkpatch errors addressed
Signed-off-by: Tejas Upadhyay
Reviewed-by: Imre Deak
Signed-off-by: Maarten Lankhorst
Link: https://patchwork.freedesktop.org/patch/msgid/20210615105613.851491-1-tejaskumarx.surendrakumar.upadhyay@intel.com
Signed-off-by: Sasha Levin
commit 8eb67e815d5efa1f0a25b013cab5f698584b1e3e
Author: Kai-Heng Feng
Date: Mon Sep 6 12:12:59 2021 +0800
drm/i915/audio: Use BIOS provided value for RKL HDA link
[ Upstream commit ffac30be2a06b2516b2ce2afa2dcb2cf8af65a52 ]
Commit 989634fb49ad ("drm/i915/audio: set HDA link parameters in
driver") makes HDMI audio on Lenovo P350 disappear.
So in addition to TGL, extend the logic to RKL to use BIOS provided
value to fix the regression.
Fixes: 989634fb49ad ("drm/i915/audio: set HDA link parameters in driver")
Reviewed-by: Kai Vehmanen
Signed-off-by: Kai-Heng Feng
Link: https://patchwork.freedesktop.org/patch/msgid/20210906041300.508458-1-kai.heng.feng@canonical.com
(cherry picked from commit c6b40ee330fe09b332715bb7ec1467e4fcbe2e65)
Signed-off-by: Jani Nikula
Signed-off-by: Sasha Levin
commit a23d12eeb1adb3b639e6c647292e9d8dcff08220
Author: Oleksij Rempel
Date: Tue Sep 28 15:49:40 2021 +0200
ARM: imx6: disable the GIC CPU interface before calling stby-poweroff sequence
[ Upstream commit 783f3db030563f7bcdfe2d26428af98ea1699a8e ]
Any pending interrupt can prevent entering standby based power off state.
To avoid it, disable the GIC CPU interface.
Fixes: 8148d2136002 ("ARM: imx6: register pm\_power\_off handler if "fsl,pmic-stby-poweroff" is set")
Signed-off-by: Oleksij Rempel
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 94d64d44e41ad5423f6928f29ada631cd31acc4e
Author: Geert Uytterhoeven
Date: Fri Sep 24 14:35:12 2021 +0200
dt-bindings: drm/bridge: ti-sn65dsi86: Fix reg value
[ Upstream commit b2d70c0dbf2731a37d1c7bcc86ab2387954d5f56 ]
make dtbs\_check:
arch/arm64/boot/dts/qcom/sdm850-lenovo-yoga-c630.dt.yaml: bridge@2c: reg:0:0: 45 was expected
According to the datasheet, the I2C address can be either 0x2c or 0x2d,
depending on the ADDR control input.
Fixes: e3896e6dddf0b821 ("dt-bindings: drm/bridge: Document sn65dsi86 bridge bindings")
Signed-off-by: Geert Uytterhoeven
Reviewed-by: Kieran Bingham
Link: https://lore.kernel.org/r/08f73c2aa0d4e580303357dfae107d084d962835.1632486753.git.geert+renesas@glider.be
Signed-off-by: Rob Herring
Signed-off-by: Sasha Levin
commit b07494f81da2dc2c8f5f2f5075585c3146fd1a75
Author: Michael Walle
Date: Wed Sep 15 22:22:59 2021 +0200
arm64: dts: ls1028a: fix eSDHC2 node
[ Upstream commit 8b94aa318aa746fbbc668d6b9b3ad812c835230c ]
On the LS1028A this instance of the eSDHC controller is intended for
either an eMMC or eSDIO card. It doesn't provide a card detect pin and
its IO voltage is fixed at 1.8V.
Remove the bogus broken-cd property, instead add the non-removable
property. Fix the voltage-ranges property and set it to 1.8V only.
Fixes: 491d3a3fc113 ("arm64: dts: ls1028a: Add esdhc node in dts")
Signed-off-by: Michael Walle
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 26a949f2335b271145fa979dfdb7b8217b10efac
Author: Heiko Thiery
Date: Wed Sep 15 14:03:26 2021 +0200
arm64: dts: imx8mm-kontron-n801x-som: do not allow to switch off buck2
[ Upstream commit 9786cca4b477f2b2f9d573d474c929d87579b501 ]
The buck2 output of the PMIC is the VDD core voltage of the cpu.
Switching off this will poweroff the CPU. Add the 'regulator-always-on'
property to avoid this.
Fixes: 8668d8b2e67f ("arm64: dts: Add the Kontron i.MX8M Mini SoMs and baseboards")
Signed-off-by: Heiko Thiery
Reviewed-by: Frieder Schrempf
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 4350e1f61930aacd64ee0689afab8467f9f51d3e
Author: Haibo Chen
Date: Fri Aug 20 17:29:50 2021 +0800
arm64: dts: imx8: change the spi-nor tx
[ Upstream commit 04aa946d57b20c40e541fb4ba2bcb390a22f404c ]
Before commit 0e30f47232ab5 ("mtd: spi-nor: add support for DTR protocol"),
for all PP command, it only support 1-1-1 mode, no matter the tx setting
in dts. But after the upper commit, the logic change. It will choose
the best mode(fastest mode) which flash device and spi-nor host controller
both support.
qspi and fspi host controller do not support read 1-4-4 mode. so need to
set the tx to 1, let the common code finally select read 1-1-4 mode.
Signed-off-by: Haibo Chen
Fixes: 0e30f47232ab ("mtd: spi-nor: add support for DTR protocol")
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 672285df5e0af051989624b0184fa6b1dd703704
Author: Haibo Chen
Date: Fri Aug 20 17:29:49 2021 +0800
ARM: dts: imx: change the spi-nor tx
[ Upstream commit b2a4f4a302b83976ad0d2930abe0f38e6119a144 ]
Before commit 0e30f47232ab5 ("mtd: spi-nor: add support for DTR protocol"),
for all PP command, it only support 1-1-1 mode, no matter the tx setting
in dts. But after the upper commit, the logic change. It will choose
the best mode(fastest mode) which flash device and spi-nor host controller
both support.
Though the spi-nor device on imx6sx-sdb/imx6ul(l/z)-14x14-evk board
do not support PP-1-4-4/PP-1-1-4, but if tx is 4 in dts file, it will also
impact the read mode selection. For the spi-nor device on the upper mentioned
boards, they support read 1-4-4 mode and read 1-1-4 mode according to the
device internal sfdp register. But qspi host controller do not support
read 1-4-4 mode. so need to set the tx to 1, let the common code finally
select read 1-1-4 mode, PP-1-1-1 mode.
Signed-off-by: Haibo Chen
Fixes: 0e30f47232ab ("mtd: spi-nor: add support for DTR protocol")
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit baa59a36ff1b02d7bf55e6a8e1418de13d8d5963
Author: Andy Shevchenko
Date: Fri Oct 1 19:20:33 2021 +0300
ptp\_pch: Load module automatically if ID matches
[ Upstream commit 7cd8b1542a7ba0720c5a0a85ed414a122015228b ]
The driver can't be loaded automatically because it misses
module alias to be provided. Add corresponding MODULE\_DEVICE\_TABLE()
call to the driver.
Fixes: 863d08ece9bf ("supports eg20t ptp clock")
Signed-off-by: Andy Shevchenko
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 9b5198c1e04164a3c177c1b00f39fc37d6a590e5
Author: Pali Rohár
Date: Sat Oct 2 11:04:09 2021 +0200
powerpc/fsl/dts: Fix phy-connection-type for fm1mac3
[ Upstream commit eed183abc0d3b8adb64fd1363b7cea7986cd58d6 ]
Property phy-connection-type contains invalid value "sgmii-2500" per scheme
defined in file ethernet-controller.yaml.
Correct phy-connection-type value should be "2500base-x".
Signed-off-by: Pali Rohár
Fixes: 84e0f1c13806 ("powerpc/mpc85xx: Add MDIO bus muxing support to the board device tree(s)")
Acked-by: Scott Wood
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
commit 6d1e04d8f044e9e4d40338d2fb69662a8a9782f2
Author: Pablo Neira Ayuso
Date: Sun Sep 26 09:59:35 2021 +0200
netfilter: nf\_tables: honor NLM\_F\_CREATE and NLM\_F\_EXCL in event notification
[ Upstream commit 6fb721cf781808ee2ca5e737fb0592cc68de3381 ]
Include the NLM\_F\_CREATE and NLM\_F\_EXCL flags in netlink event
notifications, otherwise userspace cannot distiguish between create and
add commands.
Fixes: 96518518cc41 ("netfilter: add nftables")
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Sasha Levin
commit 96117e85b83b48ddd873c2cb9f3c3709987e8543
Author: Ilya Lipnitskiy
Date: Thu Sep 30 09:57:41 2021 -0700
MIPS: Revert "add support for buggy MT7621S core detection"
[ Upstream commit 740da9d7ca4e25f5d87db9f80d75432681b61305 ]
This reverts commit 6decd1aad15f56b169217789630a0098b496de0e. CPULAUNCH
register is not set properly by some bootloaders, causing a regression
until a bootloader change is made, which is hard if not impossible on
some embedded devices. Revert the change until a more robust core
detection mechanism that works on MT7621S routers such as Netgear R6220
as well as platforms like Digi EX15 can be made.
Link: https://lore.kernel.org/lkml/4d9e3b39-7caa-d372-5d7b-42dcec36fec7@kernel.org
Fixes: 6decd1aad15f ("MIPS: add support for buggy MT7621S core detection")
Signed-off-by: Ilya Lipnitskiy
Acked-by: Sergio Paracuellos
Acked-by: Greg Ungerer
Signed-off-by: Thomas Bogendoerfer
Signed-off-by: Sasha Levin
commit 8efe947ea1eace444d78398a31469b30e47ae585
Author: Punit Agrawal
Date: Wed Sep 29 22:50:49 2021 +0900
net: stmmac: dwmac-rk: Fix ethernet on rk3399 based devices
[ Upstream commit aec3f415f7244b7747a7952596971adb0df2f568 ]
Commit 2d26f6e39afb ("net: stmmac: dwmac-rk: fix unbalanced pm\_runtime\_enable warnings")
while getting rid of a runtime PM warning ended up breaking ethernet
on rk3399 based devices. By dropping an extra reference to the device,
the commit ends up enabling suspend / resume of the ethernet device -
which appears to be broken.
While the issue with runtime pm is being investigated, partially
revert commit 2d26f6e39afb to restore the network on rk3399.
Fixes: 2d26f6e39afb ("net: stmmac: dwmac-rk: fix unbalanced pm\_runtime\_enable warnings")
Suggested-by: Heiko Stuebner
Signed-off-by: Punit Agrawal
Cc: Michael Riesch
Tested-by: Heiko Stuebner
Link: https://lore.kernel.org/r/20210929135049.3426058-1-punitagrawal@gmail.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Sasha Levin
commit f1325381177cf5eb6d4498e6b49c3e6cff4f349c
Author: Vladimir Oltean
Date: Thu Sep 30 15:53:30 2021 +0300
net: mscc: ocelot: fix VCAP filters remaining active after being deleted
[ Upstream commit 019d9329e7481cfaccbd8ed17b1e04ca76970f13 ]
When ocelot\_flower.c calls ocelot\_vcap\_filter\_add(), the filter has a
given filter->id.cookie. This filter is added to the block->rules list.
However, when ocelot\_flower.c calls ocelot\_vcap\_block\_find\_filter\_by\_id()
which passes the cookie as argument, the filter is never found by
filter->id.cookie when searching through the block->rules list.
This is unsurprising, since the filter->id.cookie is an unsigned long,
but the cookie argument provided to ocelot\_vcap\_block\_find\_filter\_by\_id()
is a signed int, and the comparison fails.
Fixes: 50c6cc5b9283 ("net: mscc: ocelot: store a namespaced VCAP filter ID")
Signed-off-by: Vladimir Oltean
Link: https://lore.kernel.org/r/20210930125330.2078625-1-vladimir.oltean@nxp.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Sasha Levin
commit fb58cd7991747b5e0b110c98c922d7b0e47a1f14
Author: Eric Dumazet
Date: Thu Sep 30 14:22:39 2021 -0700
net\_sched: fix NULL deref in fifo\_set\_limit()
[ Upstream commit 560ee196fe9e5037e5015e2cdb14b3aecb1cd7dc ]
syzbot reported another NULL deref in fifo\_set\_limit() [1]
I could repro the issue with :
unshare -n
tc qd add dev lo root handle 1:0 tbf limit 200000 burst 70000 rate 100Mbit
tc qd replace dev lo parent 1:0 pfifo\_fast
tc qd change dev lo root handle 1:0 tbf limit 300000 burst 70000 rate 100Mbit
pfifo\_fast does not have a change() operation.
Make fifo\_set\_limit() more robust about this.
[1]
BUG: kernel NULL pointer dereference, address: 0000000000000000
PGD 1cf99067 P4D 1cf99067 PUD 7ca49067 PMD 0
Oops: 0010 [#1] PREEMPT SMP KASAN
CPU: 1 PID: 14443 Comm: syz-executor959 Not tainted 5.15.0-rc3-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
RIP: 0010:0x0
Code: Unable to access opcode bytes at RIP 0xffffffffffffffd6.
RSP: 0018:ffffc9000e2f7310 EFLAGS: 00010246
RAX: dffffc0000000000 RBX: ffffffff8d6ecc00 RCX: 0000000000000000
RDX: 0000000000000000 RSI: ffff888024c27910 RDI: ffff888071e34000
RBP: ffff888071e34000 R08: 0000000000000001 R09: ffffffff8fcfb947
R10: 0000000000000001 R11: 0000000000000000 R12: ffff888024c27910
R13: ffff888071e34018 R14: 0000000000000000 R15: ffff88801ef74800
FS: 00007f321d897700(0000) GS:ffff8880b9d00000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: ffffffffffffffd6 CR3: 00000000722c3000 CR4: 00000000003506e0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
fifo\_set\_limit net/sched/sch\_fifo.c:242 [inline]
fifo\_set\_limit+0x198/0x210 net/sched/sch\_fifo.c:227
tbf\_change+0x6ec/0x16d0 net/sched/sch\_tbf.c:418
qdisc\_change net/sched/sch\_api.c:1332 [inline]
tc\_modify\_qdisc+0xd9a/0x1a60 net/sched/sch\_api.c:1634
rtnetlink\_rcv\_msg+0x413/0xb80 net/core/rtnetlink.c:5572
netlink\_rcv\_skb+0x153/0x420 net/netlink/af\_netlink.c:2504
netlink\_unicast\_kernel net/netlink/af\_netlink.c:1314 [inline]
netlink\_unicast+0x533/0x7d0 net/netlink/af\_netlink.c:1340
netlink\_sendmsg+0x86d/0xdb0 net/netlink/af\_netlink.c:1929
sock\_sendmsg\_nosec net/socket.c:704 [inline]
sock\_sendmsg+0xcf/0x120 net/socket.c:724
\_\_\_\_sys\_sendmsg+0x6e8/0x810 net/socket.c:2409
\_\_\_sys\_sendmsg+0xf3/0x170 net/socket.c:2463
\_\_sys\_sendmsg+0xe5/0x1b0 net/socket.c:2492
do\_syscall\_x64 arch/x86/entry/common.c:50 [inline]
do\_syscall\_64+0x35/0xb0 arch/x86/entry/common.c:80
entry\_SYSCALL\_64\_after\_hwframe+0x44/0xae
Fixes: fb0305ce1b03 ("net-sched: consolidate default fifo qdisc setup")
Signed-off-by: Eric Dumazet
Reported-by: syzbot
Link: https://lore.kernel.org/r/20210930212239.3430364-1-eric.dumazet@gmail.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Sasha Levin
commit 9e8e7504e09831c469b67d6dc11d9a72654bdb8c
Author: Andrii Nakryiko
Date: Fri Oct 1 11:59:10 2021 -0700
libbpf: Fix memory leak in strset
[ Upstream commit b0e875bac0fab3e7a7431c2eee36a8ccc0c712ac ]
Free struct strset itself, not just its internal parts.
Fixes: 90d76d3ececc ("libbpf: Extract internal set-of-strings datastructure APIs")
Signed-off-by: Andrii Nakryiko
Signed-off-by: Daniel Borkmann
Acked-by: Martin KaFai Lau
Link: https://lore.kernel.org/bpf/20211001185910.86492-1-andrii@kernel.org
Signed-off-by: Sasha Levin
commit 064c2616234a7394867c924b5c1303974f3a4f4d
Author: Pavel Skripkin
Date: Thu Sep 30 20:50:28 2021 +0300
phy: mdio: fix memory leak
[ Upstream commit ca6e11c337daf7925ff8a2aac8e84490a8691905 ]
Syzbot reported memory leak in MDIO bus interface, the problem was in
wrong state logic.
MDIOBUS\_ALLOCATED indicates 2 states:
1. Bus is only allocated
2. Bus allocated and \_\_mdiobus\_register() fails, but
device\_register() was called
In case of device\_register() has been called we should call put\_device()
to correctly free the memory allocated for this device, but mdiobus\_free()
calls just kfree(dev) in case of MDIOBUS\_ALLOCATED state
To avoid this behaviour we need to set bus->state to MDIOBUS\_UNREGISTERED
\_before\_ calling device\_register(), because put\_device() should be
called even in case of device\_register() failure.
Link: https://lore.kernel.org/netdev/YVMRWNDZDUOvQjHL@shell.armlinux.org.uk/
Fixes: 46abc02175b3 ("phylib: give mdio buses a device tree presence")
Reported-and-tested-by: syzbot+398e7dc692ddbbb4cfec@syzkaller.appspotmail.com
Reviewed-by: Dan Carpenter
Signed-off-by: Pavel Skripkin
Link: https://lore.kernel.org/r/eceae1429fbf8fa5c73dd2a0d39d525aa905074d.1633024062.git.paskripkin@gmail.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Sasha Levin
commit 8b6cd17219c311525ceb4d6e6e2ab4b3c7c92c1c
Author: Kumar Kartikeya Dwivedi
Date: Thu Sep 30 11:46:34 2021 +0530
libbpf: Fix segfault in light skeleton for objects without BTF
[ Upstream commit 4729445b47efebf089da4ccbcd1b116ffa2ad4af ]
When fed an empty BPF object, bpftool gen skeleton -L crashes at
btf\_\_set\_fd() since it assumes presence of obj->btf, however for
the sequence below clang adds no .BTF section (hence no BTF).
Reproducer:
$ touch a.bpf.c
$ clang -O2 -g -target bpf -c a.bpf.c
$ bpftool gen skeleton -L a.bpf.o
/\* SPDX-License-Identifier: (LGPL-2.1 OR BSD-2-Clause) \*/
/\* THIS FILE IS AUTOGENERATED! \*/
struct a\_bpf {
struct bpf\_loader\_ctx ctx;
Segmentation fault (core dumped)
The same occurs for files compiled without BTF info, i.e. without
clang's -g flag.
Fixes: 67234743736a (libbpf: Generate loader program out of BPF ELF file.)
Signed-off-by: Kumar Kartikeya Dwivedi
Signed-off-by: Daniel Borkmann
Link: https://lore.kernel.org/bpf/20210930061634.1840768-1-memxor@gmail.com
Signed-off-by: Sasha Levin
commit 2ca78aa65bc1d259c758719b5d37f1f90e3cbe2c
Author: Lama Kayal
Date: Sun Aug 29 11:26:03 2021 +0300
net/mlx5e: Fix the presented RQ index in PTP stats
[ Upstream commit dd1979cf3c710398a9eeba4853b908fe16426814 ]
PTP-RQ counters title format contains PTP-RQ identifier, which is
mistakenly not passed to sprinft().
This leads to unexpected garbage values instead.
This patch fixes it.
Before applying the patch:
ethtool -S eth3 | grep ptp\_rq
ptp\_rq15\_packets: 0
ptp\_rq8\_bytes: 0
ptp\_rq6\_csum\_complete: 0
ptp\_rq14\_csum\_complete\_tail: 0
ptp\_rq3\_csum\_complete\_tail\_slow : 0
ptp\_rq9\_csum\_unnecessary: 0
ptp\_rq1\_csum\_unnecessary\_inner: 0
ptp\_rq7\_csum\_none: 0
ptp\_rq10\_xdp\_drop: 0
ptp\_rq9\_xdp\_redirect: 0
ptp\_rq13\_lro\_packets: 0
ptp\_rq12\_lro\_bytes: 0
ptp\_rq10\_ecn\_mark: 0
ptp\_rq9\_removed\_vlan\_packets: 0
ptp\_rq5\_wqe\_err: 0
ptp\_rq8\_mpwqe\_filler\_cqes: 0
ptp\_rq2\_mpwqe\_filler\_strides: 0
ptp\_rq5\_oversize\_pkts\_sw\_drop: 0
ptp\_rq6\_buff\_alloc\_err: 0
ptp\_rq15\_cqe\_compress\_blks: 0
ptp\_rq2\_cqe\_compress\_pkts: 0
ptp\_rq2\_cache\_reuse: 0
ptp\_rq12\_cache\_full: 0
ptp\_rq11\_cache\_empty: 256
ptp\_rq12\_cache\_busy: 0
ptp\_rq11\_cache\_waive: 0
ptp\_rq12\_congst\_umr: 0
ptp\_rq11\_arfs\_err: 0
ptp\_rq9\_recover: 0
After applying the patch:
ethtool -S eth3 | grep ptp\_rq
ptp\_rq0\_packets: 0
ptp\_rq0\_bytes: 0
ptp\_rq0\_csum\_complete: 0
ptp\_rq0\_csum\_complete\_tail: 0
ptp\_rq0\_csum\_complete\_tail\_slow : 0
ptp\_rq0\_csum\_unnecessary: 0
ptp\_rq0\_csum\_unnecessary\_inner: 0
ptp\_rq0\_csum\_none: 0
ptp\_rq0\_xdp\_drop: 0
ptp\_rq0\_xdp\_redirect: 0
ptp\_rq0\_lro\_packets: 0
ptp\_rq0\_lro\_bytes: 0
ptp\_rq0\_ecn\_mark: 0
ptp\_rq0\_removed\_vlan\_packets: 0
ptp\_rq0\_wqe\_err: 0
ptp\_rq0\_mpwqe\_filler\_cqes: 0
ptp\_rq0\_mpwqe\_filler\_strides: 0
ptp\_rq0\_oversize\_pkts\_sw\_drop: 0
ptp\_rq0\_buff\_alloc\_err: 0
ptp\_rq0\_cqe\_compress\_blks: 0
ptp\_rq0\_cqe\_compress\_pkts: 0
ptp\_rq0\_cache\_reuse: 0
ptp\_rq0\_cache\_full: 0
ptp\_rq0\_cache\_empty: 256
ptp\_rq0\_cache\_busy: 0
ptp\_rq0\_cache\_waive: 0
ptp\_rq0\_congst\_umr: 0
ptp\_rq0\_arfs\_err: 0
ptp\_rq0\_recover: 0
Fixes: a28359e922c6 ("net/mlx5e: Add PTP-RX statistics")
Signed-off-by: Lama Kayal
Reviewed-by: Tariq Toukan
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit c0b1de56a40edbd162a45f28bb4187f0e7d1325d
Author: Shay Drory
Date: Tue Sep 14 10:13:02 2021 +0300
net/mlx5: Fix setting number of EQs of SFs
[ Upstream commit f88c4876347400a577598e06f1b230a7b19ee0e9 ]
When setting number of completion EQs of the SF, consider number of
online CPUs.
Without this consideration, when number of online cpus are less than 8,
unnecessary 8 completion EQs are allocated.
Fixes: c36326d38d93 ("net/mlx5: Round-Robin EQs over IRQs")
Signed-off-by: Shay Drory
Reviewed-by: Parav Pandit
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit 5ef55400217fa8c86d1f4434b05551ce9c959df9
Author: Shay Drory
Date: Thu Aug 19 16:01:28 2021 +0300
net/mlx5: Fix length of irq\_index in chars
[ Upstream commit ac8b7d50ae4c3f5325c599f3d6e939ecef6a585a ]
The maximum irq\_index can be 2047, This means irq\_name should have 4
characters reserve for the irq\_index. Hence, increase it to 4.
Fixes: 3af26495a247 ("net/mlx5: Enlarge interrupt field in CREATE\_EQ")
Signed-off-by: Shay Drory
Reviewed-by: Parav Pandit
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit f1c4eaf49d5d98463a4dbb3a54bfe9311af3a2ac
Author: Aya Levin
Date: Thu Sep 23 15:30:01 2021 +0300
net/mlx5: Avoid generating event after PPS out in Real time mode
[ Upstream commit 99b9a678b2e474756770900595cb09c94498bfca ]
When in Real-time mode, HW clock is synced with the PTP daemon. Hence
driver should not re-calibrate the next pulse (via MTPPSE repetitive
events mechanism).
This patch arms repetitive events only in free-running mode.
Fixes: 432119de33d9 ("net/mlx5: Add cyc2time HW translation mode support")
Signed-off-by: Aya Levin
Reviewed-by: Eran Ben Elisha
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit 4f3369d3e5e80700154a8578b0fa80ee4d821214
Author: Aya Levin
Date: Thu Sep 23 16:56:09 2021 +0300
net/mlx5: Force round second at 1PPS out start time
[ Upstream commit 64728294703e77827cc31a1b164ca867400067f5 ]
Allow configuration of 1PPS start time only with time-stamp representing
a round second. Prior to this patch driver allowed setting of a
non-round-second which is not supported by the device. Avoid unexpected
behavior by restricting start-time configuration to a round-second.
Fixes: 4272f9b88db9 ("net/mlx5e: Change 1PPS out scheme")
Signed-off-by: Aya Levin
Reviewed-by: Eran Ben Elisha
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit ea0b8ffff565af4ab888528012b4846cd70b0fef
Author: Moshe Shemesh
Date: Thu Sep 23 17:57:47 2021 +0300
net/mlx5: E-Switch, Fix double allocation of acl flow counter
[ Upstream commit a586775f83bd729ad60b56352dbe067f4bb0beee ]
Flow counter is allocated in eswitch legacy acl setting functions
without checking if already allocated by previous setting. Add a check
to avoid such double allocation.
Fixes: 07bab9502641 ("net/mlx5: E-Switch, Refactor eswitch ingress acl codes")
Fixes: ea651a86d468 ("net/mlx5: E-Switch, Refactor eswitch egress acl codes")
Signed-off-by: Moshe Shemesh
Reviewed-by: Tariq Toukan
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit d7954cedb9e6d69f0c739e48e67b13be94d4ecb5
Author: Tariq Toukan
Date: Thu Sep 2 10:33:32 2021 +0300
net/mlx5e: Keep the value for maximum number of channels in-sync
[ Upstream commit 9d758d4a3a039b9d7086d4759ed255b748713eee ]
The value for maximum number of channels is first calculated based
on the netdev's profile and current function resources (specifically,
number of MSIX vectors, which depends among other things on the number
of online cores in the system).
This value is then used to calculate the netdev's number of rxqs/txqs.
Once created (by alloc\_etherdev\_mqs), the number of netdev's rxqs/txqs
is constant and we must not exceed it.
To achieve this, keep the maximum number of channels in sync upon any
netdevice re-attach.
Use mlx5e\_get\_max\_num\_channels() for calculating the number of netdev's
rxqs/txqs. After netdev is created, use mlx5e\_calc\_max\_nch() (which
coinsiders core device resources, profile, and netdev) to init or
update priv->max\_nch.
Before this patch, the value of priv->max\_nch might get out of sync,
mistakenly allowing accesses to out-of-bounds objects, which would
crash the system.
Track the number of channels stats structures used in a separate
field, as they are persistent to suspend/resume operations. All the
collected stats of every channel index that ever existed should be
preserved. They are reset only when struct mlx5e\_priv is,
in mlx5e\_priv\_cleanup(), which is part of the profile changing flow.
There is no point anymore in blocking a profile change due to max\_nch
mismatch in mlx5e\_netdev\_change\_profile(). Remove the limitation.
Fixes: a1f240f18017 ("net/mlx5e: Adjust to max number of channles when re-attaching")
Signed-off-by: Tariq Toukan
Reviewed-by: Aya Levin
Reviewed-by: Maxim Mikityanskiy
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit 35460565138f1c214a1d5c6ac7fcff4ce6ed46e1
Author: Raed Salem
Date: Thu Aug 26 17:07:17 2021 +0300
net/mlx5e: IPSEC RX, enable checksum complete
[ Upstream commit f9a10440f0b1f33faa792af26f4e9823a9b8b6a4 ]
Currently in Rx data path IPsec crypto offloaded packets uses
csum\_none flag, so checksum is handled by the stack, this naturally
have some performance/cpu utilization impact on such flows. As Nvidia
NIC starting from ConnectX6DX provides checksum complete value out of
the box also for such flows there is no sense in taking csum\_none path,
furthermore the stack (xfrm) have the method to handle checksum complete
corrections for such flows i.e. IPsec trailer removal and consequently
checksum value adjustment.
Because of the above and in addition the ConnectX6DX is the first HW
which supports IPsec crypto offload then it is safe to report csum
complete for IPsec offloaded traffic.
Fixes: b2ac7541e377 ("net/mlx5e: IPsec: Add Connect-X IPsec Rx data path offload")
Signed-off-by: Raed Salem
Signed-off-by: Saeed Mahameed
Signed-off-by: Sasha Levin
commit 3a1ac1e368bedae2777d9a7cfdc65df4859f7e71
Author: Tatsuhiko Yasumatsu
Date: Thu Sep 30 22:55:45 2021 +0900
bpf: Fix integer overflow in prealloc\_elems\_and\_freelist()
[ Upstream commit 30e29a9a2bc6a4888335a6ede968b75cd329657a ]
In prealloc\_elems\_and\_freelist(), the multiplication to calculate the
size passed to bpf\_map\_area\_alloc() could lead to an integer overflow.
As a result, out-of-bounds write could occur in pcpu\_freelist\_populate()
as reported by KASAN:
[...]
[ 16.968613] BUG: KASAN: slab-out-of-bounds in pcpu\_freelist\_populate+0xd9/0x100
[ 16.969408] Write of size 8 at addr ffff888104fc6ea0 by task crash/78
[ 16.970038]
[ 16.970195] CPU: 0 PID: 78 Comm: crash Not tainted 5.15.0-rc2+ #1
[ 16.970878] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
[ 16.972026] Call Trace:
[ 16.972306] dump\_stack\_lvl+0x34/0x44
[ 16.972687] print\_address\_description.constprop.0+0x21/0x140
[ 16.973297] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.973777] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.974257] kasan\_report.cold+0x7f/0x11b
[ 16.974681] ? pcpu\_freelist\_populate+0xd9/0x100
[ 16.975190] pcpu\_freelist\_populate+0xd9/0x100
[ 16.975669] stack\_map\_alloc+0x209/0x2a0
[ 16.976106] \_\_sys\_bpf+0xd83/0x2ce0
[...]
The possibility of this overflow was originally discussed in [0], but
was overlooked.
Fix the integer overflow by changing elem\_size to u64 from u32.
[0] https://lore.kernel.org/bpf/728b238e-a481-eb50-98e9-b0f430ab01e7@gmail.com/
Fixes: 557c0c6e7df8 ("bpf: convert stackmap to pre-allocation")
Signed-off-by: Tatsuhiko Yasumatsu
Signed-off-by: Daniel Borkmann
Link: https://lore.kernel.org/bpf/20210930135545.173698-1-th.yasumatsu@gmail.com
Signed-off-by: Sasha Levin
commit 0385744b240a3c1874ff1d11d32e69ba7e21b631
Author: Tony Lindgren
Date: Thu Sep 30 11:30:03 2021 +0300
soc: ti: omap-prm: Fix external abort for am335x pruss
[ Upstream commit b232537074fcaf0c2837abbb217429c097bb7598 ]
Starting with v5.15-rc1, we may now see some am335x beaglebone black
device produce the following error on pruss probe:
Unhandled fault: external abort on non-linefetch (0x1008) at 0xe0326000
This has started with the enabling of pruss for am335x in the dts files.
Turns out the is caused by the PRM reset handling not waiting for the
reset bit to clear. To fix the issue, let's always wait for the reset
bit to clear, even if there is a separate reset status register.
We attempted to fix a similar issue for dra7 iva with a udelay() in
commit effe89e40037 ("soc: ti: omap-prm: Fix occasional abort on reset
deassert for dra7 iva"). There is no longer a need for the udelay()
for dra7 iva reset either with the check added for reset bit clearing.
Cc: Drew Fustini
Cc: Grygorii Strashko
Cc: "H. Nikolaus Schaller"
Cc: Robert Nelson
Cc: Yongqin Liu
Fixes: effe89e40037 ("soc: ti: omap-prm: Fix occasional abort on reset deassert for dra7 iva")
Reported-by: Matti Vaittinen
Tested-by: Matti Vaittinen
Signed-off-by: Tony Lindgren
Signed-off-by: Sasha Levin
commit f419febd396e34d9d5f8c84c691b33072f4bc0c8
Author: Johan Almbladh
Date: Tue Sep 28 11:13:10 2021 +0200
bpf, arm: Fix register clobbering in div/mod implementation
[ Upstream commit 79e3445b38e0cab94264a3894c0c3d57c930b97e ]
On ARM CPUs that lack div/mod instructions, ALU32 BPF\_DIV and BPF\_MOD are
implemented using a call to a helper function. Before, the emitted code
for those function calls failed to preserve caller-saved ARM registers.
Since some of those registers happen to be mapped to BPF registers, it
resulted in eBPF register values being overwritten.
This patch emits code to push and pop the remaining caller-saved ARM
registers r2-r3 into the stack during the div/mod function call. ARM
registers r0-r1 are used as arguments and return value, and those were
already saved and restored correctly.
Fixes: 39c13c204bb1 ("arm: eBPF JIT compiler")
Signed-off-by: Johan Almbladh
Signed-off-by: Daniel Borkmann
Signed-off-by: Sasha Levin
commit 34362a65c248302eab20ea0f8fa4afe9ca18fa8c
Author: Pablo Neira Ayuso
Date: Sat Sep 25 00:27:38 2021 +0200
netfilter: nf\_tables: reverse order in rule replacement expansion
[ Upstream commit 2c964c558641a3bddaee5719c9e6d8805f777812 ]
Deactivate old rule first, then append the new rule, so rule replacement
notification via netlink first reports the deletion of the old rule with
handle X in first place, then it adds the new rule (reusing the handle X
of the replaced old rule).
Note that the abort path releases the transaction that has been created
by nft\_delrule() on error.
Fixes: ca08987885a1 ("netfilter: nf\_tables: deactivate expressions in rule replecement routine")
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Sasha Levin
commit 0b1891aa588ae2aa5c7729317ccfc611389ffe06
Author: Pablo Neira Ayuso
Date: Tue Sep 21 00:37:03 2021 +0200
netfilter: nf\_tables: add position handle in event notification
[ Upstream commit e189ae161dd784aa5d454b0832f818cacc0e131b ]
Add position handle to allow to identify the rule location from netlink
events. Otherwise, userspace cannot incrementally update a userspace
cache through monitoring events.
Skip handle dump if the rule has been either inserted (at the beginning
of the ruleset) or appended (at the end of the ruleset), the
NLM\_F\_APPEND netlink flag is sufficient in these two cases.
Handle NLM\_F\_REPLACE as NLM\_F\_APPEND since the rule replacement
expansion appends it after the specified rule handle.
Fixes: 96518518cc41 ("netfilter: add nftables")
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Sasha Levin
commit 3ece5c4bf601ca751d5524a9c5c8917723e9e5f2
Author: Florian Westphal
Date: Thu Sep 23 16:44:34 2021 +0200
netfilter: conntrack: fix boot failure with nf\_conntrack.enable\_hooks=1
[ Upstream commit 339031bafe6b281cf2dcb8364217288b9fdab555 ]
This is a revert of
7b1957b049 ("netfilter: nf\_defrag\_ipv4: use net\_generic infra")
and a partial revert of
8b0adbe3e3 ("netfilter: nf\_defrag\_ipv6: use net\_generic infra").
If conntrack is builtin and kernel is booted with:
nf\_conntrack.enable\_hooks=1
.... kernel will fail to boot due to a NULL deref in
nf\_defrag\_ipv4\_enable(): Its called before the ipv4 defrag initcall is
made, so net\_generic() returns NULL.
To resolve this, move the user refcount back to struct net so calls
to those functions are possible even before their initcalls have run.
Fixes: 7b1957b04956 ("netfilter: nf\_defrag\_ipv4: use net\_generic infra")
Fixes: 8b0adbe3e38d ("netfilter: nf\_defrag\_ipv6: use net\_generic infra").
Signed-off-by: Florian Westphal
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Sasha Levin
commit 9039a859637031a12bf5bd38f9390db35fb7f91c
Author: Vladimir Zapolskiy
Date: Fri Sep 24 15:21:54 2021 +0300
iwlwifi: pcie: add configuration of a Wi-Fi adapter on Dell XPS 15
[ Upstream commit fe5c735d0d47b495be6753d6aea4f8f78c909a0a ]
There is a Killer AX1650 2x2 Wi-Fi 6 and Bluetooth 5.1 wireless adapter
found on Dell XPS 15 (9510) laptop, its configuration was present on
Linux v5.7, however accidentally it has been removed from the list of
supported devices, let's add it back.
The problem is manifested on driver initialization:
Intel(R) Wireless WiFi driver for Linux
iwlwifi 0000:00:14.3: enabling device (0000 -> 0002)
iwlwifi: No config found for PCI dev 43f0/1651, rev=0x354, rfid=0x10a100
iwlwifi: probe of 0000:00:14.3 failed with error -22
Bug: https://bugzilla.kernel.org/show\_bug.cgi?id=213939
Fixes: 3f910a25839b ("iwlwifi: pcie: convert all AX101 devices to the device tables")
Cc: Julien Wajsberg
Signed-off-by: Vladimir Zapolskiy
Acked-by: Luca Coelho
Signed-off-by: Kalle Valo
Link: https://lore.kernel.org/r/20210924122154.2376577-1-vladimir.zapolskiy@linaro.org
Signed-off-by: Sasha Levin
commit 8979fa2c43b07e26ed9764e31fbdeb2b08037361
Author: Max Filippov
Date: Mon Sep 27 09:46:33 2021 -0700
xtensa: call irqchip\_init only when CONFIG\_USE\_OF is selected
[ Upstream commit 6489f8d0e1d93a3603d8dad8125797559e4cf2a2 ]
During boot time kernel configured with OF=y but USE\_OF=n displays the
following warnings and hangs shortly after starting userspace:
------------[ cut here ]------------
WARNING: CPU: 0 PID: 0 at kernel/irq/irqdomain.c:695 irq\_create\_mapping\_affinity+0x29/0xc0
irq\_create\_mapping\_affinity(, 6) called with NULL domain
CPU: 0 PID: 0 Comm: swapper Not tainted 5.15.0-rc3-00001-gd67ed2510d28 #30
Call Trace:
\_\_warn+0x69/0xc4
warn\_slowpath\_fmt+0x6c/0x94
irq\_create\_mapping\_affinity+0x29/0xc0
local\_timer\_setup+0x40/0x88
time\_init+0xb1/0xe8
start\_kernel+0x31d/0x3f4
\_startup+0x13b/0x13b
---[ end trace 1e6630e1c5eda35b ]---
------------[ cut here ]------------
WARNING: CPU: 0 PID: 0 at arch/xtensa/kernel/time.c:141 local\_timer\_setup+0x58/0x88
error: can't map timer irq
CPU: 0 PID: 0 Comm: swapper Tainted: G W 5.15.0-rc3-00001-gd67ed2510d28 #30
Call Trace:
\_\_warn+0x69/0xc4
warn\_slowpath\_fmt+0x6c/0x94
local\_timer\_setup+0x58/0x88
time\_init+0xb1/0xe8
start\_kernel+0x31d/0x3f4
\_startup+0x13b/0x13b
---[ end trace 1e6630e1c5eda35c ]---
Failed to request irq 0 (timer)
Fix that by calling irqchip\_init only when CONFIG\_USE\_OF is selected and
calling legacy interrupt controller init otherwise.
Fixes: da844a81779e ("xtensa: add device trees support")
Signed-off-by: Max Filippov
Signed-off-by: Sasha Levin
commit c4a9836c9dd6e9a7afed4ea7b537a766f95fbaac
Author: Randy Dunlap
Date: Fri Sep 24 20:29:51 2021 -0700
xtensa: use CONFIG\_USE\_OF instead of CONFIG\_OF
[ Upstream commit d67ed2510d28a1eb33171010d35cf52178cfcbdd ]
CONFIG\_OF can be set by a randconfig or by a user -- without setting the
early flattree option (OF\_EARLY\_FLATTREE). This causes build errors.
However, if randconfig or a user sets USE\_OF in the Xtensa config,
the right kconfig symbols are set to fix the build.
Fixes these build errors:
../arch/xtensa/kernel/setup.c:67:19: error: ‘\_\_dtb\_start’ undeclared here (not in a function); did you mean ‘dtb\_start’?
67 | void \*dtb\_start = \_\_dtb\_start;
| ^~~~~~~~~~~
../arch/xtensa/kernel/setup.c: In function 'xtensa\_dt\_io\_area':
../arch/xtensa/kernel/setup.c:201:14: error: implicit declaration of function 'of\_flat\_dt\_is\_compatible'; did you mean 'of\_machine\_is\_compatible'? [-Werror=implicit-function-declaration]
201 | if (!of\_flat\_dt\_is\_compatible(node, "simple-bus"))
../arch/xtensa/kernel/setup.c:204:18: error: implicit declaration of function 'of\_get\_flat\_dt\_prop' [-Werror=implicit-function-declaration]
204 | ranges = of\_get\_flat\_dt\_prop(node, "ranges", &len);
../arch/xtensa/kernel/setup.c:204:16: error: assignment to 'const \_\_be32 \*' {aka 'const unsigned int \*'} from 'int' makes pointer from integer without a cast [-Werror=int-conversion]
204 | ranges = of\_get\_flat\_dt\_prop(node, "ranges", &len);
| ^
../arch/xtensa/kernel/setup.c: In function 'early\_init\_devtree':
../arch/xtensa/kernel/setup.c:228:9: error: implicit declaration of function 'early\_init\_dt\_scan'; did you mean 'early\_init\_devtree'? [-Werror=implicit-function-declaration]
228 | early\_init\_dt\_scan(params);
../arch/xtensa/kernel/setup.c:229:9: error: implicit declaration of function 'of\_scan\_flat\_dt' [-Werror=implicit-function-declaration]
229 | of\_scan\_flat\_dt(xtensa\_dt\_io\_area, NULL);
xtensa-elf-ld: arch/xtensa/mm/mmu.o:(.text+0x0): undefined reference to `xtensa\_kio\_paddr'
Fixes: da844a81779e ("xtensa: add device trees support")
Fixes: 6cb971114f63 ("xtensa: remap io area defined in device tree")
Signed-off-by: Randy Dunlap
Signed-off-by: Max Filippov
Signed-off-by: Sasha Levin
commit 5be9d1335749be873ff8e69c57e844949ac71387
Author: Dmitry Baryshkov
Date: Thu Sep 16 18:13:39 2021 +0300
arm64: dts: qcom: pm8150: use qcom,pm8998-pon binding
[ Upstream commit a153d317168aa3d61a204fadc85bac3995381d33 ]
Change pm8150 to use the qcom,pm8998-pon compatible string for the pon
in order to pass reboot mode properly.
Fixes: 5101f22a5c37 ("arm64: dts: qcom: pm8150: Add base dts file")
Signed-off-by: Dmitry Baryshkov
Tested-by: Amit Pundir
Signed-off-by: Bjorn Andersson
Link: https://lore.kernel.org/r/20210916151341.1797512-1-dmitry.baryshkov@linaro.org
Signed-off-by: Sasha Levin
commit 1c186680c89f65d8f49f74c76cc0124cdd602ea2
Author: Arnd Bergmann
Date: Mon Sep 20 14:23:44 2021 +0200
ath5k: fix building with LEDS=m
[ Upstream commit fb8c3a3c52400512fc8b3b61150057b888c30b0d ]
Randconfig builds still show a failure for the ath5k driver,
similar to the one that was fixed for ath9k earlier:
WARNING: unmet direct dependencies detected for MAC80211\_LEDS
Depends on [n]: NET [=y] && WIRELESS [=y] && MAC80211 [=y] && (LEDS\_CLASS [=m]=y || LEDS\_CLASS [=m]=MAC80211 [=y])
Selected by [m]:
- ATH5K [=m] && NETDEVICES [=y] && WLAN [=y] && WLAN\_VENDOR\_ATH [=y] && (PCI [=y] || ATH25) && MAC80211 [=y]
net/mac80211/led.c: In function 'ieee80211\_alloc\_led\_names':
net/mac80211/led.c:34:22: error: 'struct led\_trigger' has no member named 'name'
34 | local->rx\_led.name = kasprintf(GFP\_KERNEL, "%srx",
| ^
Copying the same logic from my ath9k patch makes this one work
as well, stubbing out the calls to the LED subsystem.
Fixes: b64acb28da83 ("ath9k: fix build error with LEDS\_CLASS=m")
Fixes: 72cdab808714 ("ath9k: Do not select MAC80211\_LEDS by default")
Fixes: 3a078876caee ("ath5k: convert LED code to use mac80211 triggers")
Link: https://lore.kernel.org/all/20210722105501.1000781-1-arnd@kernel.org/
Signed-off-by: Arnd Bergmann
Signed-off-by: Kalle Valo
Link: https://lore.kernel.org/r/20210920122359.353810-1-arnd@kernel.org
Signed-off-by: Sasha Levin
commit 436f61a89655f728d7d29b84d6bd2558bef681b7
Author: Long Li
Date: Mon Aug 30 16:13:27 2021 -0700
PCI: hv: Fix sleep while in non-sleep context when removing child devices from the bus
[ Upstream commit 41608b64b10b80fe00dd253cd8326ec8ad85930f ]
In hv\_pci\_bus\_exit, the code is holding a spinlock while calling
pci\_destroy\_slot(), which takes a mutex.
This is not safe for spinlock. Fix this by moving the children to be
deleted to a list on the stack, and removing them after spinlock is
released.
Fixes: 94d22763207a ("PCI: hv: Fix a race condition when removing the device")
Cc: "K. Y. Srinivasan"
Cc: Haiyang Zhang
Cc: Stephen Hemminger
Cc: Wei Liu
Cc: Dexuan Cui
Cc: Lorenzo Pieralisi
Cc: Rob Herring
Cc: "Krzysztof Wilczyński"
Cc: Bjorn Helgaas
Cc: Michael Kelley
Reported-by: Dan Carpenter
Link: https://lore.kernel.org/linux-hyperv/20210823152130.GA21501@kili/
Signed-off-by: Long Li
Reviewed-by: Wei Liu
Link: https://lore.kernel.org/r/1630365207-20616-1-git-send-email-longli@linuxonhyperv.com
Signed-off-by: Wei Liu
Signed-off-by: Sasha Levin
commit 11fc74ddd63a38e8374638284ad41c0c1de84aa7
Author: Fabio Estevam
Date: Tue Sep 14 14:17:15 2021 -0300
ARM: dts: imx6qdl-pico: Fix Ethernet support
[ Upstream commit 450e7fe9b1b3c90eeed74a2fe0eeb13a7b57f3da ]
Currently, it is no longer possible to retrieve a DHCP address
on the imx6qdl-pico board.
This issue has been exposed by commit f5d9aa79dfdf ("ARM: imx6q:
remove clk-out fixup for the Atheros AR8031 and AR8035 PHYs").
Fix it by describing the qca,clk-out-frequency property as suggested
by the commit above.
Fixes: 98670a0bb0ef14bbb3 ("ARM: dts: imx6qdl: Add imx6qdl-pico support")
Signed-off-by: Fabio Estevam
Reviewed-by: Andrew Lunn
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 871b9129ca6dc25fee76cd7dcb20bc0a7bc8cb35
Author: Marek Vasut
Date: Sun Sep 5 02:01:37 2021 +0200
ARM: dts: imx: Fix USB host power regulator polarity on M53Menlo
[ Upstream commit 5c187e2eb3f92daa38cb3d4ab45e1107ea34108e ]
The MIC2025 switch input signal nEN is active low, describe it as such
in the DT. The previous change to this regulator polarity was incorrectly
influenced by broken quirks in gpiolib-of.c, which is now long fixed. So
fix this regulator polarity setting here once and for all.
Fixes: 3c3601cd6a6d3 ("ARM: dts: imx53: Update USB configuration on M53Menlo")
Signed-off-by: Marek Vasut
Cc: Shawn Guo
Cc: Fabio Estevam
Cc: NXP Linux Team
Reviewed-by: Fabio Estevam
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit d5cbf524d90cfca40f3569ae6d4e0d7d539c4db7
Author: Marek Vasut
Date: Sun Sep 5 02:00:48 2021 +0200
ARM: dts: imx: Add missing pinctrl-names for panel on M53Menlo
[ Upstream commit c8c1efe14a4aadcfe93a158b1272e48298d2de15 ]
The panel already contains pinctrl-0 phandle, but it is missing
the default pinctrl-names property, so the pin configuration is
ignored. Fill in the missing pinctrl-names property, so the pin
configuration is applied.
Fixes: d81765d693db6 ("ARM: dts: imx53: Update LCD panel node on M53Menlo")
Signed-off-by: Marek Vasut
Cc: Shawn Guo
Cc: Fabio Estevam
Cc: NXP Linux Team
Reviewed-by: Fabio Estevam
Signed-off-by: Shawn Guo
Signed-off-by: Sasha Levin
commit 64a64a031fc1b19b2ab72a171099e608899f47b4
Author: Shawn Guo
Date: Sat Aug 28 15:02:02 2021 +0800
soc: qcom: mdt\_loader: Drop PT\_LOAD check on hash segment
[ Upstream commit 833d51d7c66d6708abbc02398892b96b950167b9 ]
PT\_LOAD type denotes that the segment should be loaded into the final
firmware memory region. Hash segment is not one such, because it's only
needed for PAS init and shouldn't be in the final firmware memory region.
That's why mdt\_phdr\_valid() explicitly reject non PT\_LOAD segment and
hash segment. This actually makes the hash segment type check in
qcom\_mdt\_read\_metadata() unnecessary and redundant. For a hash segment,
it won't be loaded into firmware memory region anyway, due to the
QCOM\_MDT\_TYPE\_HASH check in mdt\_phdr\_valid(), even if it has a PT\_LOAD
type for some reason (misusing or abusing?).
Some firmware files on Sony phones are such examples, e.g WCNSS firmware
of Sony Xperia M4 Aqua phone. The type of hash segment is just PT\_LOAD.
Drop the unnecessary hash segment type check in qcom\_mdt\_read\_metadata()
to fix firmware loading failure on these phones, while hash segment is
still kept away from the final firmware memory region.
Fixes: 498b98e93900 ("soc: qcom: mdt\_loader: Support loading non-split images")
Signed-off-by: Shawn Guo
Reviewed-by: Marijn Suijten
Signed-off-by: Bjorn Andersson
Link: https://lore.kernel.org/r/20210828070202.7033-1-shawn.guo@linaro.org
Signed-off-by: Sasha Levin
commit 432d8185e9ffce97e3866ca71c39b0807a456920
Author: Ilan Peer
Date: Tue Sep 7 14:32:14 2021 +0300
iwlwifi: mvm: Fix possible NULL dereference
[ Upstream commit 24d5f16e407b75bc59d5419b957a9cab423b2681 ]
In \_\_iwl\_mvm\_remove\_time\_event() check that 'te\_data->vif' is NULL
before dereferencing it.
Fixes: 7b3954a1d69a ("iwlwifi: mvm: Explicitly stop session protection before unbinding")
Reported-by: Dan Carpenter
Signed-off-by: Ilan Peer
Signed-off-by: Luca Coelho
Signed-off-by: Kalle Valo
Link: https://lore.kernel.org/r/iwlwifi.20210907143156.e80e52167d93.Ie2247f43f8acb2cee6dff5b07a3947c79a772835@changeid
Signed-off-by: Sasha Levin
commit 306b7fe278acf130152cc1a88150e795dce390fb
Author: Claudiu Beznea
Date: Mon Aug 23 16:19:12 2021 +0300
ARM: at91: pm: do not panic if ram controllers are not enabled
[ Upstream commit 1605de1b3ca66e3eddbca4b3c353c13c26476fe2 ]
In case PM is enabled but there is no RAM controller information
in DT the code will panic. Avoid such scenarios by not initializing
platform specific PM code in case RAM controller is not provided
via DT.
Reported-by: Eugen Hristev
Fixes: 827de1f123ba0 ("ARM: at91: remove at91\_dt\_initialize and machine init\_early()")
Fixes: 892e1f4a3ae58 ("ARM: at91: pm: add sama7g5 ddr phy controller")
Signed-off-by: Claudiu Beznea
Signed-off-by: Nicolas Ferre
Link: https://lore.kernel.org/r/20210823131915.23857-2-claudiu.beznea@microchip.com
Signed-off-by: Sasha Levin
commit 55f37cc6ee0555498d848b373edb7c258a870007
Author: Douglas Anderson
Date: Tue Sep 7 12:12:25 2021 -0700
Revert "arm64: dts: qcom: sc7280: Fixup the cpufreq node"
[ Upstream commit a48c730a4e0bf480bcde12d795a9cd6f9ef14d1e ]
This reverts commit 11e03d692101e484df9322f892a8b6e111a82bfd.
As per discussion [1] the patch shouldn't have landed. Let's revert.
[1] https://lore.kernel.org/r/fde7bac239f796b039b9be58b391fb77@codeaurora.org/
Fixes: 11e03d692101 ("arm64: dts: qcom: sc7280: Fixup the cpufreq node")
Reported-by: Matthias Kaehlcke
Cc: Sibi Sankar
Cc: Matthias Kaehlcke
Cc: Stephen Boyd
Signed-off-by: Douglas Anderson
Reviewed-by: Matthias Kaehlcke
Signed-off-by: Bjorn Andersson
Link: https://lore.kernel.org/r/20210907121220.1.I08460f490473b70de0d768db45f030a4d5c17828@changeid
Signed-off-by: Sasha Levin
commit 5ceb465692d6468b2b9359d797c47615fc29ab35
Author: Marijn Suijten
Date: Sun Aug 29 22:30:25 2021 +0200
ARM: dts: qcom: apq8064: Use 27MHz PXO clock as DSI PLL reference
[ Upstream commit f1db21c315f4b4f8c3fbea56aac500673132d317 ]
The 28NM DSI PLL driver for msm8960 calculates with a 27MHz reference
clock and should hence use PXO, not CXO which runs at 19.2MHz.
Note that none of the DSI PHY/PLL drivers currently use this "ref"
clock; they all rely on (sometimes inexistant) global clock names and
usually function normally without a parent clock. This discrepancy will
be corrected in a future patch, for which this change needs to be in
place first.
Fixes: 6969d1d9c615 ("ARM: dts: qcom-apq8064: Set 'cxo\_board' as ref clock of the DSI PHY")
Reviewed-by: Dmitry Baryshkov
Signed-off-by: Marijn Suijten
Link: https://lore.kernel.org/r/20210829203027.276143-2-marijn.suijten@somainline.org
Signed-off-by: Bjorn Andersson
Signed-off-by: Sasha Levin
commit 457673bfee0b5d8b3d03dced06c19e4d8de03620
Author: Antonio Martorana
Date: Mon Aug 16 17:24:39 2021 -0700
soc: qcom: socinfo: Fixed argument passed to platform\_set\_data()
[ Upstream commit 9c5a4ec69bbf5951f84ada9e0db9c6c50de61808 ]
Set qcom\_socinfo pointer as data being stored instead of pointer
to soc\_device structure. Aligns with future calls to platform\_get\_data()
which expects qcom\_socinfo pointer.
Fixes: efb448d0a3fc ("soc: qcom: Add socinfo driver")
Signed-off-by: Antonio Martorana
Reviewed-by: Bjorn Andersson
Link: https://lore.kernel.org/r/1629159879-95777-1-git-send-email-amartora@codeaurora.org
Signed-off-by: Bjorn Andersson
Signed-off-by: Sasha Levin
commit 54607728e944867a757d162debb17d20d725c595
Author: Nathan Chancellor
Date: Sun Aug 15 12:18:52 2021 -0700
bus: ti-sysc: Add break in switch statement in sysc\_init\_soc()
[ Upstream commit e879f855e590b40fe3c79f2fbd8f65ca3c724120 ]
After commit a6d90e9f2232 ("bus: ti-sysc: AM3: RNG is GP only"), clang
with -Wimplicit-fallthrough enabled warns:
drivers/bus/ti-sysc.c:2958:3: warning: unannotated fall-through between
switch labels [-Wimplicit-fallthrough]
default:
^
drivers/bus/ti-sysc.c:2958:3: note: insert 'break;' to avoid
fall-through
default:
^
break;
1 warning generated.
Clang's version of this warning is a little bit more pedantic than
GCC's. Add the missing break to satisfy it to match what has been done
all over the kernel tree.
Fixes: a6d90e9f2232 ("bus: ti-sysc: AM3: RNG is GP only")
Signed-off-by: Nathan Chancellor
Reviewed-by: Nick Desaulniers
Signed-off-by: Tony Lindgren
Signed-off-by: Sasha Levin
commit f1c7aa87c423e765e3862349c2f095fdfccdd9b3
Author: Alexandre Ghiti
Date: Sat Sep 18 18:02:21 2021 +0200
riscv: Flush current cpu icache before other cpus
commit bb8958d5dc79acbd071397abb57b8756375fe1ce upstream.
On SiFive Unmatched, I recently fell onto the following BUG when booting:
[ 0.000000] ftrace: allocating 36610 entries in 144 pages
[ 0.000000] Oops - illegal instruction [#1]
[ 0.000000] Modules linked in:
[ 0.000000] CPU: 0 PID: 0 Comm: swapper Not tainted 5.13.1+ #5
[ 0.000000] Hardware name: SiFive HiFive Unmatched A00 (DT)
[ 0.000000] epc : riscv\_cpuid\_to\_hartid\_mask+0x6/0xae
[ 0.000000] ra : \_\_sbi\_rfence\_v02+0xc8/0x10a
[ 0.000000] epc : ffffffff80007240 ra : ffffffff80009964 sp : ffffffff81803e10
[ 0.000000] gp : ffffffff81a1ea70 tp : ffffffff8180f500 t0 : ffffffe07fe30000
[ 0.000000] t1 : 0000000000000004 t2 : 0000000000000000 s0 : ffffffff81803e60
[ 0.000000] s1 : 0000000000000000 a0 : ffffffff81a22238 a1 : ffffffff81803e10
[ 0.000000] a2 : 0000000000000000 a3 : 0000000000000000 a4 : 0000000000000000
[ 0.000000] a5 : 0000000000000000 a6 : ffffffff8000989c a7 : 0000000052464e43
[ 0.000000] s2 : ffffffff81a220c8 s3 : 0000000000000000 s4 : 0000000000000000
[ 0.000000] s5 : 0000000000000000 s6 : 0000000200000100 s7 : 0000000000000001
[ 0.000000] s8 : ffffffe07fe04040 s9 : ffffffff81a22c80 s10: 0000000000001000
[ 0.000000] s11: 0000000000000004 t3 : 0000000000000001 t4 : 0000000000000008
[ 0.000000] t5 : ffffffcf04000808 t6 : ffffffe3ffddf188
[ 0.000000] status: 0000000200000100 badaddr: 0000000000000000 cause: 0000000000000002
[ 0.000000] [] riscv\_cpuid\_to\_hartid\_mask+0x6/0xae
[ 0.000000] [] sbi\_remote\_fence\_i+0x1e/0x26
[ 0.000000] [] flush\_icache\_all+0x12/0x1a
[ 0.000000] [] patch\_text\_nosync+0x26/0x32
[ 0.000000] [] ftrace\_init\_nop+0x52/0x8c
[ 0.000000] [] ftrace\_process\_locs.isra.0+0x29c/0x360
[ 0.000000] [] ftrace\_init+0x80/0x130
[ 0.000000] [] start\_kernel+0x5c4/0x8f6
[ 0.000000] ---[ end trace f67eb9af4d8d492b ]---
[ 0.000000] Kernel panic - not syncing: Attempted to kill the idle task!
[ 0.000000] ---[ end Kernel panic - not syncing: Attempted to kill the idle task! ]---
While ftrace is looping over a list of addresses to patch, it always failed
when patching the same function: riscv\_cpuid\_to\_hartid\_mask. Looking at the
backtrace, the illegal instruction is encountered in this same function.
However, patch\_text\_nosync, after patching the instructions, calls
flush\_icache\_range. But looking at what happens in this function:
flush\_icache\_range -> flush\_icache\_all
-> sbi\_remote\_fence\_i
-> \_\_sbi\_rfence\_v02
-> riscv\_cpuid\_to\_hartid\_mask
The icache and dcache of the current cpu are never synchronized between the
patching of riscv\_cpuid\_to\_hartid\_mask and calling this same function.
So fix this by flushing the current cpu's icache before asking for the other
cpus to do the same.
Signed-off-by: Alexandre Ghiti
Fixes: fab957c11efe ("RISC-V: Atomic and Locking Code")
Cc: stable@vger.kernel.org
Signed-off-by: Palmer Dabbelt
Signed-off-by: Greg Kroah-Hartman
commit b514b752b62659a5658e78cba22f0288953b0b38
Author: Adrian Hunter
Date: Wed Sep 22 12:10:59 2021 +0300
scsi: ufs: core: Fix task management completion
commit f5ef336fd2e4c36dedae4e7ca66cf5349d6fda62 upstream.
The UFS driver uses blk\_mq\_tagset\_busy\_iter() when identifying task
management requests to complete, however blk\_mq\_tagset\_busy\_iter() doesn't
work.
blk\_mq\_tagset\_busy\_iter() only iterates requests dispatched by the block
layer. That appears as if it might have started since commit 37f4a24c2469
("blk-mq: centralise related handling into blk\_mq\_get\_driver\_tag") which
removed 'data->hctx->tags->rqs[rq->tag] = rq' from blk\_mq\_rq\_ctx\_init()
which gets called:
blk\_get\_request
blk\_mq\_alloc\_request
\_\_blk\_mq\_alloc\_request
blk\_mq\_rq\_ctx\_init
Since UFS task management requests are not dispatched by the block layer,
hctx->tags->rqs[rq->tag] remains NULL, and since blk\_mq\_tagset\_busy\_iter()
relies on finding requests using hctx->tags->rqs[rq->tag], UFS task
management requests are never found by blk\_mq\_tagset\_busy\_iter().
By using blk\_mq\_tagset\_busy\_iter(), the UFS driver was relying on internal
details of the block layer, which was fragile and subsequently got
broken. Fix by removing the use of blk\_mq\_tagset\_busy\_iter() and having the
driver keep track of task management requests.
Link: https://lore.kernel.org/r/20210922091059.4040-1-adrian.hunter@intel.com
Fixes: 1235fc569e0b ("scsi: ufs: core: Fix task management request completion timeout")
Fixes: 69a6c269c097 ("scsi: ufs: Use blk\_{get,put}\_request() to allocate and free TMFs")
Cc: stable@vger.kernel.org
Tested-by: Bart Van Assche
Reviewed-by: Bart Van Assche
Signed-off-by: Adrian Hunter
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit 4a0775d0c0306e8ffd6ba3e0f8f28992b7cfdeb0
Author: David Heidelberg
Date: Wed Aug 18 08:53:17 2021 +0200
ARM: dts: qcom: apq8064: use compatible which contains chipid
commit f5c03f131dae3f06d08464e6157dd461200f78d9 upstream.
Also resolves these kernel warnings for APQ8064:
adreno 4300000.adreno-3xx: Using legacy qcom,chipid binding!
adreno 4300000.adreno-3xx: Use compatible qcom,adreno-320.2 instead.
Tested on Nexus 7 2013, no functional changes.
Cc:
Signed-off-by: David Heidelberg
Link: https://lore.kernel.org/r/20210818065317.19822-1-david@ixit.cz
Signed-off-by: Bjorn Andersson
Signed-off-by: Greg Kroah-Hartman
commit d62956ddb915e4f94650abd57ca137cf9144de72
Author: Michal Vokáč
Date: Wed Aug 18 09:02:08 2021 +0200
ARM: dts: imx6dl-yapp4: Fix lp5562 LED driver probe
commit 9b663b34c94a78f39fa2c7a8271b1f828b546e16 upstream.
Since the LED multicolor framework support was added in commit
92a81562e695 ("leds: lp55xx: Add multicolor framework support to lp55xx")
LEDs on this platform stopped working.
Author of the framework attempted to accommodate this DT to the
framework in commit b86d3d21cd4c ("ARM: dts: imx6dl-yapp4: Add reg property
to the lp5562 channel node") but that is not sufficient. A color property
is now required even if the multicolor framework is not used, otherwise
the driver probe fails:
lp5562: probe of 1-0030 failed with error -22
Add the color property to fix this.
Fixes: 92a81562e695 ("leds: lp55xx: Add multicolor framework support to lp55xx")
Cc:
Cc: linux-leds@vger.kernel.org
Signed-off-by: Michal Vokáč
Acked-by: Pavel Machek
Reviewed-by: Fabio Estevam
Signed-off-by: Shawn Guo
Signed-off-by: Greg Kroah-Hartman
commit 05d9d419220bb43bed4b8f457666e9de921a0780
Author: Roger Quadros
Date: Thu Sep 2 12:58:28 2021 +0300
ARM: dts: omap3430-sdp: Fix NAND device node
commit 80d680fdccba214e8106dc1aa33de5207ad75394 upstream.
Nand is on CS1 so reg properties first field should be 1 not 0.
Fixes: 44e4716499b8 ("ARM: dts: omap3: Fix NAND device nodes")
Cc: stable@vger.kernel.org # v4.6+
Signed-off-by: Roger Quadros
Signed-off-by: Tony Lindgren
Signed-off-by: Greg Kroah-Hartman
commit 35c6691812b7c292cd6d1d1180cf8ccb6505eb13
Author: Juergen Gross
Date: Tue Oct 5 15:34:33 2021 +0200
xen/balloon: fix cancelled balloon action
commit 319933a80fd4f07122466a77f93e5019d71be74c upstream.
In case a ballooning action is cancelled the new kernel thread handling
the ballooning might end up in a busy loop.
Fix that by handling the cancelled action gracefully.
While at it introduce a short wait for the BP\_WAIT case.
Cc: stable@vger.kernel.org
Fixes: 8480ed9c2bbd56 ("xen/balloon: use a kernel thread instead a workqueue")
Reported-by: Marek Marczykowski-Górecki
Signed-off-by: Juergen Gross
Tested-by: Jason Andryuk
Reviewed-by: Boris Ostrovsky
Link: https://lore.kernel.org/r/20211005133433.32008-1-jgross@suse.com
Signed-off-by: Juergen Gross
Signed-off-by: Greg Kroah-Hartman
commit f574ab3192eb9d0f86df05619d794d52ba109778
Author: J. Bruce Fields
Date: Fri Oct 1 09:59:21 2021 -0400
SUNRPC: fix sign error causing rpcsec\_gss drops
commit 2ba5acfb34957e8a7fe47cd78c77ca88e9cc2b03 upstream.
If sd\_max is unsigned, then sd\_max - GSS\_SEQ\_WIN is a very large number
whenever sd\_max is less than GSS\_SEQ\_WIN, and the comparison:
seq\_num <= sd->sd\_max - GSS\_SEQ\_WIN
in gss\_check\_seq\_num is pretty much always true, even when that's
clearly not what was intended.
This was causing pynfs to hang when using krb5, because pynfs uses zero
as the initial gss sequence number. That's perfectly legal, but this
logic error causes knfsd to drop the rpc in that case. Out-of-order
sequence IDs in the first GSS\_SEQ\_WIN (128) calls will also cause this.
Fixes: 10b9d99a3dbb ("SUNRPC: Augment server-side rpcgss tracepoints")
Cc: stable@vger.kernel.org
Signed-off-by: J. Bruce Fields
Signed-off-by: Chuck Lever
Signed-off-by: Greg Kroah-Hartman
commit ace054d4e5230f36a14300838f758582c6d18470
Author: Trond Myklebust
Date: Thu Sep 30 15:44:41 2021 -0400
nfsd4: Handle the NFSv4 READDIR 'dircount' hint being zero
commit f2e717d655040d632c9015f19aa4275f8b16e7f2 upstream.
RFC3530 notes that the 'dircount' field may be zero, in which case the
recommendation is to ignore it, and only enforce the 'maxcount' field.
In RFC5661, this recommendation to ignore a zero valued field becomes a
requirement.
Fixes: aee377644146 ("nfsd4: fix rd\_dircount enforcement")
Cc:
Signed-off-by: Trond Myklebust
Signed-off-by: Chuck Lever
Signed-off-by: Greg Kroah-Hartman
commit 9228f2a0d1bc10f68953f7872e8fe26efab10d1a
Author: Patrick Ho
Date: Sat Aug 21 02:56:26 2021 -0400
nfsd: fix error handling of register\_pernet\_subsys() in init\_nfsd()
commit 1d625050c7c2dd877e108e382b8aaf1ae3cfe1f4 upstream.
init\_nfsd() should not unregister pernet subsys if the register fails
but should instead unwind from the last successful operation which is
register\_filesystem().
Unregistering a failed register\_pernet\_subsys() call can result in
a kernel GPF as revealed by programmatically injecting an error in
register\_pernet\_subsys().
Verified the fix handled failure gracefully with no lingering nfsd
entry in /proc/filesystems. This change was introduced by the commit
bd5ae9288d64 ("nfsd: register pernet ops last, unregister first"),
the original error handling logic was correct.
Fixes: bd5ae9288d64 ("nfsd: register pernet ops last, unregister first")
Cc: stable@vger.kernel.org
Signed-off-by: Patrick Ho
Acked-by: J. Bruce Fields
Signed-off-by: Chuck Lever
Signed-off-by: Greg Kroah-Hartman
commit d9f9dfb9040c97391fa4bc2a17f76fbd5544e7a8
Author: Miklos Szeredi
Date: Mon Sep 27 11:23:57 2021 +0200
ovl: fix IOCB\_DIRECT if underlying fs doesn't support direct IO
commit 1dc1eed46f9fa4cb8a07baa24fb44c96d6dd35c9 upstream.
Normally the check at open time suffices, but e.g loop device does set
IOCB\_DIRECT after doing its own checks (which are not sufficent for
overlayfs).
Make sure we don't call the underlying filesystem read/write method with
the IOCB\_DIRECT if it's not supported.
Reported-by: Huang Jianan
Fixes: 16914e6fc7e1 ("ovl: add ovl\_read\_iter()")
Cc:  # v4.19
Tested-by: Huang Jianan
Signed-off-by: Miklos Szeredi
Signed-off-by: Greg Kroah-Hartman
commit 71b8b36187af58f9e67b25021f5debbc04a18a5d
Author: Zheng Liang
Date: Fri Sep 24 09:16:27 2021 +0800
ovl: fix missing negative dentry check in ovl\_rename()
commit a295aef603e109a47af355477326bd41151765b6 upstream.
The following reproducer
mkdir lower upper work merge
touch lower/old
touch lower/new
mount -t overlay overlay -olowerdir=lower,upperdir=upper,workdir=work merge
rm merge/new
mv merge/old merge/new & unlink upper/new
may result in this race:
PROCESS A:
rename("merge/old", "merge/new");
overwrite=true,ovl\_lower\_positive(old)=true,
ovl\_dentry\_is\_whiteout(new)=true -> flags |= RENAME\_EXCHANGE
PROCESS B:
unlink("upper/new");
PROCESS A:
lookup newdentry in new\_upperdir
call vfs\_rename() with negative newdentry and RENAME\_EXCHANGE
Fix by adding the missing check for negative newdentry.
Signed-off-by: Zheng Liang
Fixes: e9be9d5e76e3 ("overlay filesystem")
Cc:  # v3.18
Signed-off-by: Miklos Szeredi
Signed-off-by: Greg Kroah-Hartman
commit b0ee6190e85604cfa7848f002b300c95628f1ee4
Author: Arnd Bergmann
Date: Tue Sep 28 16:52:10 2021 +0200
fbdev: simplefb: fix Kconfig dependencies
commit ec7cc3f74b4236860ce612656aa5be7936d1c594 upstream.
Configurations with both CONFIG\_FB\_SIMPLE=y and CONFIG\_DRM\_SIMPLEDRM=m
are allowed by Kconfig because the 'depends on !DRM\_SIMPLEDRM' dependency
does not disallow FB\_SIMPLE as long as SIMPLEDRM is not built-in. This
can however result in a build failure when cfb\_fillrect() etc are then
also in loadable modules:
x86\_64-linux-ld: drivers/video/fbdev/simplefb.o:(.rodata+0x1f8): undefined reference to `cfb\_fillrect'
x86\_64-linux-ld: drivers/video/fbdev/simplefb.o:(.rodata+0x200): undefined reference to `cfb\_copyarea'
x86\_64-linux-ld: drivers/video/fbdev/simplefb.o:(.rodata+0x208): undefined reference to `cfb\_imageblit'
To work around this, change FB\_SIMPLE to be a 'tristate' symbol,
which still allows both to be =m together, but not one of them to
be =y if the other one is =m. If a distro kernel picks this
configuration, it can be determined by local policy which of
the two modules gets loaded. The 'of\_chosen' export is needed
as this is the first loadable module referencing it.
Alternatively, the Kconfig dependency could be changed to
'depends on DRM\_SIMPLEDRM=n', which would forbid the configuration
with both drivers.
Fixes: 11e8f5fd223b ("drm: Add simpledrm driver")
Acked-by: Rob Herring  # for drivers/of/
Link: https://lore.kernel.org/all/20210721151839.2484245-1-arnd@kernel.org/
Signed-off-by: Arnd Bergmann
Cc: Thomas Zimmermann
Cc: Daniel Vetter  # fbdev support
Cc: Maxime Ripard
Cc: Liam Girdwood
Cc: Mark Brown
Cc: Daniel Vetter
Cc: Borislav Petkov
Cc: Javier Martinez Canillas
Cc: Randy Dunlap
Cc: Geert Uytterhoeven
Cc: Peter Collingbourne
Cc: Andy Shevchenko
Cc: dri-devel@lists.freedesktop.org
Cc: linux-kernel@vger.kernel.org
Cc:  # v5.14+
Signed-off-by: Thomas Zimmermann
Link: https://patchwork.freedesktop.org/patch/msgid/20210928145243.1098064-1-arnd@kernel.org
Signed-off-by: Maarten Lankhorst
Signed-off-by: Greg Kroah-Hartman
commit 897e427ef37cb8710f4f962248159045e00ef0ea
Author: Claudiu Beznea
Date: Fri Sep 24 11:28:51 2021 +0300
mmc: sdhci-of-at91: replace while loop with read\_poll\_timeout
commit 30d4b990ec644e8bd49ef0a2f074fabc0d189e53 upstream.
Replace while loop with read\_poll\_timeout().
Signed-off-by: Claudiu Beznea
Acked-by: Adrian Hunter
Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/20210924082851.2132068-3-claudiu.beznea@microchip.com
Signed-off-by: Ulf Hansson
Signed-off-by: Greg Kroah-Hartman
commit aa7c4ce94835f846a4fd05a53aa85304b565ff06
Author: Claudiu Beznea
Date: Fri Sep 24 11:28:50 2021 +0300
mmc: sdhci-of-at91: wait for calibration done before proceed
commit af467fad78f03a42de8b72190f6a595366b870db upstream.
Datasheet specifies that at the end of calibration the SDMMC\_CALCR\_EN
bit will be cleared. No commands should be send before calibration is
done.
Fixes: dbdea70f71d67 ("mmc: sdhci-of-at91: fix CALCR register being rewritten")
Fixes: 727d836a375ad ("mmc: sdhci-of-at91: add DT property to enable calibration on full reset")
Signed-off-by: Claudiu Beznea
Acked-by: Adrian Hunter
Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/20210924082851.2132068-2-claudiu.beznea@microchip.com
Signed-off-by: Ulf Hansson
Signed-off-by: Greg Kroah-Hartman
commit 266fd4b85ce3174499f58a582cbd8efa4964c8c6
Author: Neil Armstrong
Date: Tue Sep 28 09:36:52 2021 +0200
mmc: meson-gx: do not use memcpy\_to/fromio for dram-access-quirk
commit 8a38a4d51c5055d0201542e5ea3c0cb287f6e223 upstream.
The memory at the end of the controller only accepts 32bit read/write
accesses, but the arm64 memcpy\_to/fromio implementation only uses 64bit
(which will be split into two 32bit access) and 8bit leading to incomplete
copies to/from this memory when the buffer is not multiple of 8bytes.
Add a local copy using writel/readl accesses to make sure we use the right
memory access width.
The switch to memcpy\_to/fromio was done because of 285133040e6c
("arm64: Import latest memcpy()/memmove() implementation"), but using memcpy
worked before since it mainly used 32bit memory acceses.
Fixes: 103a5348c22c ("mmc: meson-gx: use memcpy\_to/fromio for dram-access-quirk")
Reported-by: Christian Hewitt
Suggested-by: Martin Blumenstingl
Signed-off-by: Neil Armstrong
Tested-by: Martin Blumenstingl
Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/20210928073652.434690-1-narmstrong@baylibre.com
Signed-off-by: Ulf Hansson
Signed-off-by: Greg Kroah-Hartman
commit 527d377da38feed158b2df19f8d11a539252e33b
Author: Jan Beulich
Date: Wed Sep 22 12:17:48 2021 +0200
xen/privcmd: fix error handling in mmap-resource processing
commit e11423d6721dd63b23fb41ade5e8d0b448b17780 upstream.
xen\_pfn\_t is the same size as int only on 32-bit builds (and not even
on Arm32). Hence pfns[] can't be used directly to read individual error
values returned from xen\_remap\_domain\_mfn\_array(); every other error
indicator would be skipped/ignored on 64-bit.
Fixes: 3ad0876554ca ("xen/privcmd: add IOCTL\_PRIVCMD\_MMAP\_RESOURCE")
Cc: stable@vger.kernel.org
Signed-off-by: Jan Beulich
Reviewed-by: Boris Ostrovsky
Signed-off-by: Greg Kroah-Hartman
Link: https://lore.kernel.org/r/aa6d6a67-6889-338a-a910-51e889f792d5@suse.com
Signed-off-by: Juergen Gross
commit c2a35a4080706230437fe925f34c29118410f366
Author: Ville Syrjälä
Date: Thu Sep 30 22:09:42 2021 +0300
drm/i915: Extend the async flip VT-d w/a to skl/bxt
commit b2d73debfdc16b742e64948dc4461876af3f8c10 upstream.
Looks like skl/bxt/derivatives also need the plane stride
stretch w/a when using async flips and VT-d is enabled, or
else we get corruption on screen. To my surprise this was
even documented in bspec, but only as a note on the
CHICHKEN\_PIPESL register description rather than on the
w/a list.
So very much the same thing as on HSW/BDW, except the bits
moved yet again.
Cc: stable@vger.kernel.org
Cc: Karthik B S
Fixes: 55ea1cb178ef ("drm/i915: Enable async flips in i915")
Signed-off-by: Ville Syrjälä
Link: https://patchwork.freedesktop.org/patch/msgid/20210930190943.17547-1-ville.syrjala@linux.intel.com
Reviewed-by: Matt Roper
(cherry picked from commit d08df3b0bdb25546e86dc9a6c4e3ec0c43832299)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 6dafefe60cb2ba56b28fc056a52cbde0f2374682
Author: Maarten Lankhorst
Date: Wed Jul 28 14:41:31 2021 +0200
drm/i915: Fix runtime pm handling in i915\_gem\_shrink
commit 0c94777386495d6e0a9735d48ffd2abb8d680d7f upstream.
We forgot to call intel\_runtime\_pm\_put on error, fix it!
Signed-off-by: Maarten Lankhorst
Fixes: cf41a8f1dc1e ("drm/i915: Finally remove obj->mm.lock.")
Cc: Thomas Hellström
Cc: Daniel Vetter
Cc:  # v5.13+
Reviewed-by: Thomas Hellström
Reviewed-by: Niranjana Vishwanathapura
Link: https://patchwork.freedesktop.org/patch/msgid/20210830121006.2978297-9-maarten.lankhorst@linux.intel.com
(cherry picked from commit 239f3c2ee18376587026efecaea5250fa5926d20)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 92c92e554553ce03f9c89c38cdbf3bb5c43d8f7d
Author: Liu, Zhan
Date: Thu Sep 2 15:08:29 2021 -0400
drm/amd/display: Fix DCN3 B0 DP Alt Mapping
commit 2fe9a0e1173f4805669e7af34ea25af835274426 upstream.
[Why]
DCN3 B0 has a mux, which redirects PHYC and PHYD to PHYF and PHYG.
[How]
Fix DIG mapping.
Reviewed-by: Charlene Liu
Acked-by: Rodrigo Siqueira
Signed-off-by: Zhan Liu
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
(cherry picked from commit 4b7786d87fb3adf3e534c4f1e4f824d8700b786b)
Signed-off-by: Greg Kroah-Hartman
commit 1a9c5c13268606d49efef9a94cebcdc00dfc23b8
Author: Hansen
Date: Fri Oct 1 22:36:15 2021 +0800
drm/amd/display: Fix detection of 4 lane for DPALT
commit 5a1fef027846e7635b9d320b2cc0b416fd11a3be upstream.
[Why]
DPALT detection for B0 PHY has its own set of RDPCSPIPE registers
[How]
Use RDPCSPIPE registers to detect if DPALT lane is 4 lane
Reviewed-by: Charlene Liu
Acked-by: Solomon Chiu
Signed-off-by: Hansen
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
Signed-off-by: Greg Kroah-Hartman
commit 4fd24bff9fac2bef4319631e48519f845ac82ad8
Author: Nikola Cornij
Date: Fri Oct 1 22:36:14 2021 +0800
drm/amd/display: Limit display scaling to up to 4k for DCN 3.1
commit a7e397b7c45377e20542146be10231b8afa948d1 upstream.
[why]
The existing limit was mistakenly bigger than 4k for DCN 3.1
Reviewed-by: Zhan Liu
Acked-by: Solomon Chiu
Signed-off-by: Nikola Cornij
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
Signed-off-by: Greg Kroah-Hartman
commit c43e26907d91109606b52462bf4434dc37eb3d27
Author: Ben Skeggs
Date: Fri Sep 17 08:04:06 2021 +1000
drm/nouveau/ga102-: support ttm buffer moves via copy engine
commit 49b2dfc081826874705b27f7970631319628ee7f upstream.
We don't currently have any kind of real acceleration on Ampere GPUs,
but the TTM memcpy() fallback paths aren't really designed to handle
copies between different devices, such as on Optimus systems, and
result in a kernel OOPS.
A few options were investigated to try and fix this, but didn't work
out, and likely would have resulted in a very unpleasant experience
for users anyway.
This commit adds just enough support for setting up a single channel
connected to a copy engine, which the kernel can use to accelerate
the buffer copies between devices. Userspace has no access to this
incomplete channel support, but it's suitable for TTM's needs.
A more complete implementation of host(fifo) for Ampere GPUs is in
the works, but the required changes are far too invasive that they
would be unsuitable to backport to fix this issue on current kernels.
v2: fix GPFIFO length in RAMFC (reported by Karol)
Signed-off-by: Ben Skeggs
Cc: Lyude Paul
Cc: Karol Herbst
Cc:  # v5.12+
Reviewed-by: Karol Herbst
Tested-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20210916220406.666454-1-skeggsb@gmail.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Greg Kroah-Hartman
commit e4c1d18cb951af0f7a143f0b8803002d7375ea05
Author: Ben Skeggs
Date: Mon Sep 6 10:56:28 2021 +1000
drm/nouveau/kms/tu102-: delay enabling cursor until after assign\_windows
commit f732e2e34aa08493fdd762f3daa4e5f16bbf1e45 upstream.
Prevent NVD core channel error code 67 occuring and hanging display,
managed to reproduce on GA102 while testing suspend/resume scenarios.
Required extension of earlier commit to fix interactions with EFI.
Fixes: e78b1b545c6c ("drm/nouveau/kms/nv50: workaround EFI GOP window channel format differences")
Signed-off-by: Ben Skeggs
Cc: Lyude Paul
Cc: Karol Herbst
Cc:  # v5.12+
Reviewed-by: Karol Herbst
Signed-off-by: Karol Herbst
Link: https://patchwork.freedesktop.org/patch/msgid/20210906005628.11499-2-skeggsb@gmail.com
Signed-off-by: Maarten Lankhorst
Signed-off-by: Greg Kroah-Hartman
commit 4df3adab896f843afe5bca5960fbca6ff2cc407e
Author: Lijo Lazar
Date: Fri Oct 1 16:49:07 2021 +0800
drm/amdgpu: During s0ix don't wait to signal GFXOFF
commit 1d617c029fd9c960f8ba7a8d1a10699d820bd6b9 upstream.
In the rare event when GFX IP suspend coincides with a s0ix entry, don't
schedule a delayed work, instead signal PMFW immediately to allow GFXOFF
entry. GFXOFF is a prerequisite for s0ix entry. PMFW needs to be
signaled about GFXOFF status before amd-pmc module passes OS HINT
to PMFW telling that everything is ready for a safe s0ix entry.
Bug: https://gitlab.freedesktop.org/drm/amd/-/issues/1712
Signed-off-by: Lijo Lazar
Reviewed-by: Alex Deucher
Reviewed-by: Mario Limonciello
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
Signed-off-by: Greg Kroah-Hartman
commit ec36503dffdd3e9c0bbcd2d87f1b9158d6bfb5a6
Author: Jude Shih
Date: Mon Oct 4 22:40:50 2021 +0800
drm/amd/display: USB4 bring up set correct address
commit 7ab0965079bbc0e39fe0e1df4dcdf931c9d25372 upstream.
[Why]
YELLOW\_CARP\_B0 address was not correct
[How]
Set YELLOW\_CARP\_B0 to 0x1A.
Reviewed-by: Nicholas Kazlauskas
Acked-by: Wayne Lin
Signed-off-by: Jude Shih
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
Signed-off-by: Greg Kroah-Hartman
commit 4b55ade094de14359abce57d7438b79c59e0f852
Author: Liu, Zhan
Date: Thu Sep 9 13:26:37 2021 -0400
drm/amd/display: Fix B0 USB-C DP Alt mode
commit 45d65c0f09aaa6cdd21fe0743f317d4bbdfd1466 upstream.
[Why]
Starting from B0, along with RDPCSTX, RDPCSPIPE registers are also used.
[How]
Make sure RDPCSPIPE registers are programmed correctly.
Reviewed-by: Charlene Liu
Acked-by: Rodrigo Siqueira
Signed-off-by: Zhan Liu
Signed-off-by: Alex Deucher
Cc: stable@vger.kernel.org
(cherry picked from commit bdd1a21b52557ea8f61d0a5dc2f77151b576eb70)
Signed-off-by: Greg Kroah-Hartman
commit 3048656f5abf4fe49185ff8fe9e7eeed5a58ece4
Author: Heikki Krogerus
Date: Thu Sep 30 15:47:58 2021 +0300
usb: typec: tipd: Remove dependency on "connector" child fwnode
commit b87d8d0d4c43c29ccdc57d15b2ebc1df886a34b4 upstream.
There is no "connector" child node available on every
platform, so the driver can't fail to probe when it's
missing.
Fixes: 57560ee95cb7 ("usb: typec: tipd: Don't block probing of consumer of "connector" nodes")
Cc: stable@vger.kernel.org # 5.14+
Reported-by: "Regupathy, Rajaram"
Signed-off-by: Heikki Krogerus
Link: https://lore.kernel.org/r/20210930124758.23233-1-heikki.krogerus@linux.intel.com
Signed-off-by: Greg Kroah-Hartman
commit f5155225108fce14726806055506df994e2200be
Author: Xu Yang
Date: Tue Sep 28 19:16:39 2021 +0800
usb: typec: tcpm: handle SRC\_STARTUP state if cc changes
commit 6d91017a295e9790eec02c4e43f020cdb55f5d98 upstream.
TCPM for DRP should do the same action as SRC\_ATTACHED when cc changes in
SRC\_STARTUP state. Otherwise, TCPM will transition to SRC\_UNATTACHED state
which is not satisfied with the Type-C spec.
Per Type-C spec:
DRP port should move to Unattached.SNK instead of Unattached.SRC if sink
removed.
Fixes: 4b4e02c83167 ("typec: tcpm: Move out of staging")
cc:
Reviewed-by: Guenter Roeck
Acked-by: Heikki Krogerus
Signed-off-by: Xu Yang
Link: https://lore.kernel.org/r/20210928111639.3854174-1-xu.yang\_2@nxp.com
Signed-off-by: Greg Kroah-Hartman
commit 108d39a6b5a727b15989a583730fd75ff3ba0d52
Author: Xu Yang
Date: Sun Sep 26 18:14:15 2021 +0800
usb: typec: tcpci: don't handle vSafe0V event if it's not enabled
commit 05300871c0e21c288bd5c30ac6f9b1da6ddeed22 upstream.
USB TCPCI Spec, 4.4.3 Mask Registers:
"A masked register will still indicate in the ALERT register, but shall
not set the Alert# pin low."
Thus, the Extended Status will still indicate in ALERT register if vSafe0V
is detected by TCPC even though being masked. In current code, howerer,
this event will not be handled in detection time. Rather it will be
handled when next ALERT event coming(CC evnet, PD event, etc).
Tcpm might transition to a wrong state in this situation. Thus, the vSafe0V
event should not be handled when it's masked.
Fixes: 766c485b86ef ("usb: typec: tcpci: Add support to report vSafe0V")
cc:
Reviewed-by: Guenter Roeck
Acked-by: Heikki Krogerus
Signed-off-by: Xu Yang
Link: https://lore.kernel.org/r/20210926101415.3775058-1-xu.yang\_2@nxp.com
Signed-off-by: Greg Kroah-Hartman
commit 267d19e300c128b87a18b6e5fb9180b27726d690
Author: Johan Hovold
Date: Wed Sep 29 11:09:37 2021 +0200
USB: cdc-acm: fix break reporting
commit 58fc1daa4d2e9789b9ffc880907c961ea7c062cc upstream.
A recent change that started reporting break events forgot to push the
event to the line discipline, which meant that a detected break would
not be reported until further characters had been receive (the port
could even have been closed and reopened in between).
Fixes: 08dff274edda ("cdc-acm: fix BREAK rx code path adding necessary calls")
Cc: stable@vger.kernel.org
Acked-by: Oliver Neukum
Signed-off-by: Johan Hovold
Link: https://lore.kernel.org/r/20210929090937.7410-3-johan@kernel.org
Signed-off-by: Greg Kroah-Hartman
commit aff426d4b887d33fa02e006a0216e61792a26c4a
Author: Johan Hovold
Date: Wed Sep 29 11:09:36 2021 +0200
USB: cdc-acm: fix racy tty buffer accesses
commit 65a205e6113506e69a503b61d97efec43fc10fd7 upstream.
A recent change that started reporting break events to the line
discipline caused the tty-buffer insertions to no longer be serialised
by inserting events also from the completion handler for the interrupt
endpoint.
Completion calls for distinct endpoints are not guaranteed to be
serialised. For example, in case a host-controller driver uses
bottom-half completion, the interrupt and bulk-in completion handlers
can end up running in parallel on two CPUs (high-and low-prio tasklets,
respectively) thereby breaking the tty layer's single producer
assumption.
Fix this by holding the read lock also when inserting characters from
the bulk endpoint.
Fixes: 08dff274edda ("cdc-acm: fix BREAK rx code path adding necessary calls")
Cc: stable@vger.kernel.org
Acked-by: Oliver Neukum
Signed-off-by: Johan Hovold
Link: https://lore.kernel.org/r/20210929090937.7410-2-johan@kernel.org
Signed-off-by: Greg Kroah-Hartman
commit 09c4c413bc561ace3c06698936f74aab01c0030e
Author: Pavel Hofman
Date: Fri Sep 24 10:00:27 2021 +0200
usb: gadget: f\_uac2: fixed EP-IN wMaxPacketSize
commit 0560c9c552c1815e7b480bc11fd785fefc82bb27 upstream.
Async feedback patches broke enumeration on Windows 10 previously fixed
by commit 789ea77310f0 ("usb: gadget: f\_uac2: always increase endpoint
max\_packet\_size by one audio slot").
While the existing calculation for EP OUT capture for async mode yields
size+1 frame due to uac2\_opts->fb\_max > 0, playback side lost the +1
feature. Therefore the +1 frame addition must be re-introduced for
playback. Win10 enumerates the device only when both EP IN and EP OUT
max packet sizes are (at least) +1 frame.
Fixes: e89bb4288378 ("usb: gadget: u\_audio: add real feedback implementation")
Cc: stable
Tested-by: Henrik Enquist
Tested-by: Jack Pham
Signed-off-by: Pavel Hofman
Link: https://lore.kernel.org/r/20210924080027.5362-1-pavel.hofman@ivitera.com
Signed-off-by: Greg Kroah-Hartman
commit 66dd03b10e1c0b2fae006c6e34c18ea8ee033e7b
Author: Fabio Estevam
Date: Tue Sep 21 08:37:54 2021 -0300
usb: chipidea: ci\_hdrc\_imx: Also search for 'phys' phandle
commit 8253a34bfae3278baca52fc1209b7c29270486ca upstream.
When passing 'phys' in the devicetree to describe the USB PHY phandle
(which is the recommended way according to
Documentation/devicetree/bindings/usb/ci-hdrc-usb2.txt) the
following NULL pointer dereference is observed on i.MX7 and i.MX8MM:
[ 1.489344] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000098
[ 1.498170] Mem abort info:
[ 1.500966] ESR = 0x96000044
[ 1.504030] EC = 0x25: DABT (current EL), IL = 32 bits
[ 1.509356] SET = 0, FnV = 0
[ 1.512416] EA = 0, S1PTW = 0
[ 1.515569] FSC = 0x04: level 0 translation fault
[ 1.520458] Data abort info:
[ 1.523349] ISV = 0, ISS = 0x00000044
[ 1.527196] CM = 0, WnR = 1
[ 1.530176] [0000000000000098] user address but active\_mm is swapper
[ 1.536544] Internal error: Oops: 96000044 [#1] PREEMPT SMP
[ 1.542125] Modules linked in:
[ 1.545190] CPU: 3 PID: 7 Comm: kworker/u8:0 Not tainted 5.14.0-dirty #3
[ 1.551901] Hardware name: Kontron i.MX8MM N801X S (DT)
[ 1.557133] Workqueue: events\_unbound deferred\_probe\_work\_func
[ 1.562984] pstate: 80000005 (Nzcv daif -PAN -UAO -TCO BTYPE=--)
[ 1.568998] pc : imx7d\_charger\_detection+0x3f0/0x510
[ 1.573973] lr : imx7d\_charger\_detection+0x22c/0x510
This happens because the charger functions check for the phy presence
inside the imx\_usbmisc\_data structure (data->usb\_phy), but the chipidea
core populates the usb\_phy passed via 'phys' inside 'struct ci\_hdrc'
(ci->usb\_phy) instead.
This causes the NULL pointer dereference inside imx7d\_charger\_detection().
Fix it by also searching for 'phys' in case 'fsl,usbphy' is not found.
Tested on a imx7s-warp board.
Fixes: 746f316b753a ("usb: chipidea: introduce imx7d USB charger detection")
Cc: stable@vger.kernel.org
Reported-by: Heiko Thiery
Tested-by: Frieder Schrempf
Reviewed-by: Frieder Schrempf
Acked-by: Peter Chen
Signed-off-by: Fabio Estevam
Link: https://lore.kernel.org/r/20210921113754.767631-1-festevam@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit 9b70e9acfceb451e722f9bc3685383028506448f
Author: Rikard Falkeborn
Date: Wed Sep 29 21:45:46 2021 +0200
usb: cdc-wdm: Fix check for WWAN
commit 04d2b75537085cb0c85d73a2e0e50317bffa883f upstream.
CONFIG\_WWAN\_CORE was with CONFIG\_WWAN in commit 89212e160b81 ("net: wwan:
Fix WWAN config symbols"), but did not update all users of it. Change it
back to use CONFIG\_WWAN instead.
Fixes: 89212e160b81 ("net: wwan: Fix WWAN config symbols")
Cc:
Signed-off-by: Rikard Falkeborn
Acked-by: Oliver Neukum
Link: https://lore.kernel.org/r/20210929194547.46954-2-rikard.falkeborn@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit d92e0c42cfee85884e5f545a72e6a4aca8c523e6
Author: Ben Hutchings
Date: Tue Sep 21 16:34:42 2021 +0200
Partially revert "usb: Kconfig: using select for USB\_COMMON dependency"
commit 4d1aa9112c8e6995ef2c8a76972c9671332ccfea upstream.
This reverts commit cb9c1cfc86926d0e86d19c8e34f6c23458cd3478 for
USB\_LED\_TRIG. This config symbol has bool type and enables extra code
in usb\_common itself, not a separate driver. Enabling it should not
force usb\_common to be built-in!
Fixes: cb9c1cfc8692 ("usb: Kconfig: using select for USB\_COMMON dependency")
Cc: stable
Signed-off-by: Ben Hutchings
Signed-off-by: Salvatore Bonaccorso
Link: https://lore.kernel.org/r/20210921143442.340087-1-carnil@debian.org
Signed-off-by: Greg Kroah-Hartman

