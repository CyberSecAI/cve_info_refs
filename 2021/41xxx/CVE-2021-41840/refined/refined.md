```json
{
  "CVE-2021-41840": {
    "Metadata": {
      "Curation Notes": "This entry contains information from multiple sources. The Siemens advisory provides context for affected products and identifies related CVEs. The Insyde advisory provides details about the vulnerability and impacted firmware versions. Netapp provides additional affected products and also specifies the attack vector.",
      "Source": [
        "cert-portal.siemens.com_e6a1992b_20250115_081333.html",
        "www.insyde.com_e68c0a4a_20250115_081335.html",
        "security.netapp.com_4ec7319a_20250115_211943.html",
        "security.netapp.com_3cf4a1eb_20250115_211934.html",
         "security.netapp.com_eaf46361_20250115_211940.html",
        "security.netapp.com_e9556de0_20250115_081334.html",
           "www.insyde.com_5f3cf67a_20250115_081335.html"
      ]
    },
    "Vulnerability Details": {
      "Root cause": "The vulnerability exists in the System Management Mode (SMM) branch of the NvmExpressDxe driver within InsydeH2O firmware. It is triggered by an SMM callout that does not adequately validate the allocated buffer pointer (specifically, the CommBuffer+8 location). This allows an attacker who is capable of executing code in the DXE phase to exploit this vulnerability to escalate privileges to SMM.",
      "Weaknesses": [
        "CWE-770: Allocation of Resources Without Limits or Throttling",
        "CWE-829: Inclusion of Functionality from Untrusted Control Sphere"
      ],
      "Impact": "Successful exploitation can lead to arbitrary code execution in SMM, escalating privileges from ring 0 to ring -2, as well as memory corruption.",
         "Attack vectors": "An attacker who is capable of executing code in DXE phase to exploit this vulnerability to escalate privileges to SMM. They could overwrite the LocateProtocol or Freepool memory address location to execute unwanted code.",
      "Required attacker capabilities": "The attacker needs to be able to execute code within the DXE (Driver Execution Environment) phase of the UEFI boot process. This often implies a high degree of access or control over the system.",
       "Affected Products": [
            "RUGGEDCOM APE1808 ADM (6GK6015-0AL20-0GL0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 ADM CC (6GK6015-0AL20-0GL1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 CKP (6GK6015-0AL20-0GK0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 CKP CC (6GK6015-0AL20-0GK1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 CLOUDCONNECT (6GK6015-0AL20-0GM0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 CLOUDCONNECT CC (6GK6015-0AL20-0GM1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 ELAN (6GK6015-0AL20-0GP0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 ELAN CC (6GK6015-0AL20-0GP1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 SAM-L (6GK6015-0AL20-0GN0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808 SAM-L CC (6GK6015-0AL20-0GN1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-P (6GK6015-0AL20-1AA0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-P CC (6GK6015-0AL20-1AA1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S1 (6GK6015-0AL20-1AB0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S1 CC (6GK6015-0AL20-1AB1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S3 (6GK6015-0AL20-1AD0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S3 CC (6GK6015-0AL20-1AD1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S5 (6GK6015-0AL20-1AF0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808CLA-S5 CC (6GK6015-0AL20-1AF1) all versions < V01.00.20_2N",
             "RUGGEDCOM APE1808LNX (6GK6015-0AL20-0GH0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808LNX CC (6GK6015-0AL20-0GH1) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808W10 (6GK6015-0AL20-0GJ0) all versions < V01.00.20_2N",
            "RUGGEDCOM APE1808W10 CC (6GK6015-0AL20-0GJ1) all versions < V01.00.20_2N",
            "SIMATIC Field PG M5 all versions < V22.01.10",
            "SIMATIC IPC127E all versions < V27.01.09",
            "SIMATIC IPC227G all versions < V28.01.04",
             "SIMATIC IPC277G all versions < V28.01.04",
            "SIMATIC IPC327G all versions < V28.01.04",
            "SIMATIC IPC377G all versions < V28.01.04",
            "SIMATIC IPC427E all versions < V21.01.17",
            "SIMATIC IPC477E all versions < V21.01.17",
            "SIMATIC IPC477E Pro all versions < V21.01.17",
            "SIMATIC IPC627E all versions < V25.02.12",
             "SIMATIC IPC647E all versions < V25.02.12",
            "SIMATIC IPC677E all versions < V25.02.12",
            "SIMATIC IPC847E all versions < V25.02.12",
           "SIMATIC ITP1000 all versions < V23.01.10"
        ],
        "Affected Firmware": {
           "Kernel 5.0": "Not present.",
           "Kernel 5.1": "Not present.",
          "Kernel 5.2": "05.23.35",
           "Kernel 5.3": "05.32.35",
          "Kernel 5.4": "05.40.35",
            "Kernel 5.5": "Not present."
        }
    },
    "Mitigations": {
         "Workarounds": "As a prerequisite for an attack, an attacker must be able to run untrusted code on affected systems. Siemens recommends limiting the possibilities to run untrusted code.",
          "Remediations": [
              "Update RUGGEDCOM APE1808 to version V01.00.20_2N or later",
              "Update SIMATIC Field PG M5 to V22.01.10 or later",
              "Update SIMATIC IPC127E BIOS to V27.01.09 or later",
              "Update SIMATIC IPC227G BIOS to V28.01.04 or later",
              "Update SIMATIC IPC277G BIOS to V28.01.04 or later",
              "Update SIMATIC IPC327G BIOS to V28.01.04 or later",
              "Update SIMATIC IPC377G BIOS to V28.01.04 or later",
              "Update SIMATIC IPC427E to V21.01.17 or later",
              "Update SIMATIC IPC477E to V21.01.17 or later",
              "Update SIMATIC IPC477E Pro to V21.01.17 or later",
                "Update SIMATIC IPC627E to V25.02.12 or later",
                 "Update SIMATIC IPC647E to V25.02.12 or later",
                 "Update SIMATIC IPC677E to V25.02.12 or later",
                 "Update SIMATIC IPC847E to V25.02.12 or later",
                "Update SIMATIC ITP1000 BIOS to V23.01.10 or later"

            ]

        }
    }
}
```