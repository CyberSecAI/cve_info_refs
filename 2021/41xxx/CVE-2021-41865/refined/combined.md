=== Content from discuss.hashicorp.com_cd5b0294_20250114_221827.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-26 - Nomad Denial Of Service Via Submission Of Incomplete Job Specification Using Consul Mesh Gateway & Host Network](/t/hcsec-2021-26-nomad-denial-of-service-via-submission-of-incomplete-job-specification-using-consul-mesh-gateway-host-network/30311)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 5, 2021, 11:03pm

1

**Bulletin ID:** HCSEC-2021-26

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.1.1 through 1.1.5; fixed in 1.1.6.

**Publication Date:** October 5, 2021

**Summary**

Nomad and Nomad Enterprise (“Nomad”) allowed authenticated users with job submission capabilities to cause denial of service by submitting incomplete job specifications with a Consul mesh gateway and host networking mode. This vulnerability, CVE-2021-41865, was fixed in Nomad 1.1.6.

**Background**

Nomad provides first-class support for Nomad jobs running Consul Connect mesh gateways via the [connect](https://www.nomadproject.io/docs/job-specification/connect) stanza. [Mesh gateways](https://www.consul.io/docs/connect/gateways/mesh-gateway) enable services in the Connect mesh to make cross-DC connections via gateways, where each datacenter may not have full node interconnectivity.

Nomad also allows jobs to be configured with a range of [network modes](https://www.nomadproject.io/docs/job-specification/network#mode), including host mode.

**Details**

During internal testing, it was observed that a Nomad job configured to use a Consul mesh gateway and host networking mode will cause Nomad client agents to crash. Since crashed clients may become lost, their allocations would be rescheduled and could eventually cause all clients to crash as the problematic job specification is rescheduled around the cluster.

On investigation, it was observed that a missing optional stanza within that job specification was not being correctly handled. Nomad’s configuration logic has been modified to correctly handle this case without crashing.

**Remediation**

Note that the Nomad 1.0 branch and earlier releases were not affected by this issue.

Customers on the Nomad 1.1 branch should evaluate the risk associated with this issue and consider upgrading to Nomad or Nomad Enterprise 1.1.6, or newer. Please refer to [Upgrading Nomad](https://www.nomadproject.io/docs/upgrade) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2022-22 - Nomad Panics On Job Submission With Bad Artifact Stanza Source URL](https://discuss.hashicorp.com/t/hcsec-2022-22-nomad-panics-on-job-submission-with-bad-artifact-stanza-source-url/45420)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5733 | October 10, 2022 |
| [Nomad 1.0.12 and 1.1.6 Released](https://discuss.hashicorp.com/t/nomad-1-0-12-and-1-1-6-released/30310)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) | 0 | 415 | October 5, 2021 |
| [HCSEC-2022-14 - Nomad Impacted by go-getter Vulnerabilities](https://discuss.hashicorp.com/t/hcsec-2022-14-nomad-impacted-by-go-getter-vulnerabilities/39932)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6839 | May 24, 2022 |
| [HCSEC-2022-01 - Nomad Artifact Download Race Condition](https://discuss.hashicorp.com/t/hcsec-2022-01-nomad-artifact-download-race-condition/35559)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7462 | February 11, 2022 |
| [Nomad 1.1.1 and 1.0.7 released](https://discuss.hashicorp.com/t/nomad-1-1-1-and-1-0-7-released/25269)  [Nomad](/c/nomad/28) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) | 0 | 602 | June 9, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


