=== Content from github.com_ec86530e_20250115_092638.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphql-playground%2Fcommit%2Fb8a956006835992f12c46b90384a79ab82bcadad)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphql-playground%2Fcommit%2Fb8a956006835992f12c46b90384a79ab82bcadad)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=graphql%2Fgraphql-playground)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[graphql](/graphql)
/
**[graphql-playground](/graphql/graphql-playground)**
Public

* [Notifications](/login?return_to=%2Fgraphql%2Fgraphql-playground) You must be signed in to change notification settings
* [Fork
  735](/login?return_to=%2Fgraphql%2Fgraphql-playground)
* [Star
   8.8k](/login?return_to=%2Fgraphql%2Fgraphql-playground)

* [Code](/graphql/graphql-playground)
* [Issues
  341](/graphql/graphql-playground/issues)
* [Pull requests
  66](/graphql/graphql-playground/pulls)
* [Discussions](/graphql/graphql-playground/discussions)
* [Actions](/graphql/graphql-playground/actions)
* [Projects
  0](/graphql/graphql-playground/projects)
* [Security](/graphql/graphql-playground/security)
* [Insights](/graphql/graphql-playground/pulse)

Additional navigation options

* [Code](/graphql/graphql-playground)
* [Issues](/graphql/graphql-playground/issues)
* [Pull requests](/graphql/graphql-playground/pulls)
* [Discussions](/graphql/graphql-playground/discussions)
* [Actions](/graphql/graphql-playground/actions)
* [Projects](/graphql/graphql-playground/projects)
* [Security](/graphql/graphql-playground/security)
* [Insights](/graphql/graphql-playground/pulse)

## Commit

[Permalink](/graphql/graphql-playground/commit/b8a956006835992f12c46b90384a79ab82bcadad)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-59r9-6jp6-jcm7](https://github.com/advisories/GHSA-59r9-6jp6-jcm7 "GHSA-59r9-6jp6-jcm7")

[Browse files](/graphql/graphql-playground/tree/b8a956006835992f12c46b90384a79ab82bcadad)
Browse the repository at this point in the history

```
This change fixes an XSS vulnerability that has been present since the first
commit of GraphQL Playground when used with an untrusted GraphQL server. It applies three
strategies to fix via defense-in-depth: HTML escaping a string in a context
that uses innerHTML; validating incoming schemas with graphql-js validateSchema;
and using a single up-to-date Markdown library.

See docs/security/2021-introspection-schema-xss.md for more details.
```

* Loading branch information

[![@acao](https://avatars.githubusercontent.com/u/1368727?s=40&v=4)](/acao)

[acao](/graphql/graphql-playground/commits?author=acao "View all commits by acao")
authored
Nov 4, 2021

1 parent
[5073062](/graphql/graphql-playground/commit/5073062f3834bb8652c0c0e3297ad83ddc8ad867)

commit b8a9560

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**354 additions**
and
**212 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* SECURITY.md
  [SECURITY.md](#diff-f6ed156e4bf5c791680662464b94ea5d753f219ee816b385f67870e2c0d7d4c7)
* docs/security

  + docs/security/2020-xss-template-injection.md
    [2020-xss-template-injection.md](#diff-4abbde7173c009a24a8739ea3ecdb49700fec01ce4be0604aba1c03e5ac887f5)
  + docs/security/2021-schema-xss-phishing-attack.md
    [2021-schema-xss-phishing-attack.md](#diff-22feb1cef4ecb083f20d643259c90f6476f2e420a220d39f3cf29106038b40e6)
* packages/graphql-playground-react

  + packages/graphql-playground-react/package.json
    [package.json](#diff-2a476f0a2c3c7a6996b999969ea118e05d749641601d67baeccddb8d41d8360e)
  + src

    - \_\_snapshots\_\_

      * packages/graphql-playground-react/src/\_\_snapshots\_\_/index.test.tsx.snap
        [index.test.tsx.snap](#diff-46ab924b06ba90d477e7861f0998bf72c65ce36da8bcb21ba43454fce526f041)
    - components

      * packages/graphql-playground-react/src/components/Playground.tsx
        [Playground.tsx](#diff-e1b4f3027f40f268400430bd45c35b8d44f0ae066bc78a1bf5f53577475c9ab3)
      * Playground

        + packages/graphql-playground-react/src/components/Playground/SchemaFetcher.ts
          [SchemaFetcher.ts](#diff-b12c42113320adde49297e163f24e051c4af1ceb45bf5db4fa49ac8a303a79d9)
        + packages/graphql-playground-react/src/components/Playground/onHasCompletion.tsx
          [onHasCompletion.tsx](#diff-3a7824aa6d08d505edd3ac1dbfb1bf27182b9c795390ba0b4cdff21551f7b832)
        + util

          - packages/graphql-playground-react/src/components/Playground/util/InvalidSchemaError.ts
            [InvalidSchemaError.ts](#diff-232bc36afaed712980d3b09b2710dabef7cad40ff7ab80612270f92874e14416)
* yarn.lock
  [yarn.lock](#diff-51e4f558fae534656963876761c95b83b6ef5da5103c4adef6768219ed76c2de)

## There are no files selected for viewing

138 changes: 2 additions & 136 deletions

138
[SECURITY.md](#diff-f6ed156e4bf5c791680662464b94ea5d753f219ee816b385f67870e2c0d7d4c7 "SECURITY.md")

Show comments

[View file](/graphql/graphql-playground/blob/b8a956006835992f12c46b90384a79ab82bcadad/SECURITY.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,138 +1,4 @@ |
|  |  | # Known Vulnerabilities |
|  |  |  |
|  |  | ## XSS Reflection Vulnerability |
|  |  |  |
|  |  | the origin of the vulnerability is in `renderPlaygroundPage`, found in `graphql-playground-html` |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | When using |
|  |  |  |
|  |  | - `renderPlaygroundPage()`, |
|  |  | - `koaPlayground()` |
|  |  | - `expressPlayground()` |
|  |  | - `koaPlayground()` |
|  |  | - `lambdaPlayground()` |
|  |  | - any downstream dependent packages that use these functions |
|  |  |  |
|  |  | without sanitization of user input, your application is vulnerable to an XSS Reflecton Attack. This is a serious vulnerability that could allow for exfiltration of data or user credentials, or to disrupt systems. |
|  |  |  |
|  |  | We've provided ['an example of the xss using the express middleware]('https://github.com/prisma-labs/graphql-playground/tree/main/packages/graphql-playground-middleware-express/examples/xss-attack') |
|  |  |  |
|  |  | ### Impacted Packages |
|  |  |  |
|  |  | \*\*All versions of these packages are impacted until those specified below\*\*, which are now safe for user defined input: |
|  |  |  |
|  |  | - `graphql-playground-html`: \*\*☔ safe\*\* @ `1.6.22` |
|  |  | - `graphql-playground-express` \*\*☔ safe\*\* @ `1.7.16` |
|  |  | - `graphql-playground-koa` \*\*☔ safe\*\* @ `1.6.15` |
|  |  | - `graphql-playground-hapi` \*\*☔ safe\*\* @ `1.6.13` |
|  |  | - `graphql-playground-lambda` \*\*☔ safe\*\* @ `1.7.17` |
|  |  |  |
|  |  | ### Static input was always safe |
|  |  |  |
|  |  | These examples are safe for \_all versions\_ \*\*because input is static\*\* |
|  |  |  |
|  |  | with `express` and `renderPlaygroundPage`: |
|  |  |  |
|  |  | ```js |
|  |  | app.get('/playground', (req) => { |
|  |  | res.html( |
|  |  | renderPlaygroundPage({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | }), |
|  |  | ) |
|  |  | next() |
|  |  | }) |
|  |  | ``` |
|  |  |  |
|  |  | with `expressPlayground`: |
|  |  |  |
|  |  | ```js |
|  |  | // params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | settings: { 'editor.theme': req.query.darkMode ? 'dark' : 'light' }, |
|  |  | }), |
|  |  | ) |
|  |  | ``` |
|  |  |  |
|  |  | with `koaPlayground`: |
|  |  |  |
|  |  | ```js |
|  |  | const koa = require('koa') |
|  |  | const koaRouter = require('koa-router') |
|  |  | const koaPlayground = require('graphql-playground-middleware-koa') |
|  |  |  |
|  |  | const app = new koa() |
|  |  | const router = new koaRouter() |
|  |  |  |
|  |  | router.all('/playground', koaPlayground({ endpoint: '/graphql' })) |
|  |  | ``` |
|  |  |  |
|  |  | ### Vulnerable Examples |
|  |  |  |
|  |  | Here are some examples where the vulnerability would be present before the patch, because of unfiltered user input |
|  |  |  |
|  |  | ```js |
|  |  | const express = require('express') |
|  |  | const expressPlayground = require('graphql-playground-middleware-express') |
|  |  | .default |
|  |  |  |
|  |  | const app = express() |
|  |  |  |
|  |  | app.use(express.json()) |
|  |  |  |
|  |  | // params |
|  |  | app.get('/playground/:id', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql/${req.params.id}`, |
|  |  | }), |
|  |  | ) |
|  |  |  |
|  |  | // params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | // any settings that are unsanitized user input, not just `endpoint` |
|  |  | settings: { 'editor.fontFamily': req.query.font }, |
|  |  | }), |
|  |  | ) |
|  |  | ``` |
|  |  |  |
|  |  | [See a proof of concept](packages/graphql-playground-html/examples/xss-attack) to understand the vulnerability better |
|  |  |  |
|  |  | ### Workaround |
|  |  |  |
|  |  | To fix this issue without the update, you can sanitize however you want. |
|  |  |  |
|  |  | We suggest using [`xss`](https://www.npmjs.com/package/xss) (what we use for our own fix) |
|  |  |  |
|  |  | For example, with `graphql-playground-middleware-express`: |
|  |  |  |
|  |  | ```js |
|  |  | const express = require('express') |
|  |  | const { filterXSS } = require('xss') |
|  |  | const expressPlayground = require('graphql-playground-middleware-express') |
|  |  | .default |
|  |  |  |
|  |  |  |
|  |  | const app = express() |
|  |  |  |
|  |  | const filter = (val) => filterXSS(val, { |
|  |  | whitelist: [], |
|  |  | stripIgnoreTag: true, |
|  |  | stripIgnoreTagBody: ['script'] |
|  |  | }) |
|  |  |  |
|  |  | // simple example |
|  |  | app.get('/playground/:id', (req) => |
|  |  | expressPlayground({ endpoint: `/graphql/${filter(req.params.id)}` }) |
|  |  |  |
|  |  | // advanced params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground(JSON.parse(filter(JSON.stringify(req.query)))) |
|  |  | ``` |
|  |  |  |
|  |  | [See a proof of concept workaround](packages/graphql-playground-html/examples/xss-attack), example #3 |
|  |  | - [2021: Introspection Schema Phishing Attack XSS Vulnerability](docs/security/2021-schema-xss-phishing-attack.md) |
|  |  | - [2020: XSS Reflection Vulnerability](docs/security/2020-xss-template-injection.md) |

136 changes: 136 additions & 0 deletions

136
[docs/security/2020-xss-template-injection.md](#diff-4abbde7173c009a24a8739ea3ecdb49700fec01ce4be0604aba1c03e5ac887f5 "docs/security/2020-xss-template-injection.md")

Show comments

[View file](/graphql/graphql-playground/blob/b8a956006835992f12c46b90384a79ab82bcadad/docs/security/2020-xss-template-injection.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,136 @@ |
|  |  | ## XSS Reflection Vulnerability |
|  |  |  |
|  |  | the origin of the vulnerability is in `renderPlaygroundPage`, found in `graphql-playground-html` |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | When using |
|  |  |  |
|  |  | - `renderPlaygroundPage()`, |
|  |  | - `koaPlayground()` |
|  |  | - `expressPlayground()` |
|  |  | - `koaPlayground()` |
|  |  | - `lambdaPlayground()` |
|  |  | - any downstream dependent packages that use these functions |
|  |  |  |
|  |  | without sanitization of user input, your application is vulnerable to an XSS Reflection Attack. This is a serious vulnerability that could allow for exfiltration of data or user credentials, or to disrupt systems. |
|  |  |  |
|  |  | We've provided ['an example of the xss using the express middleware]('https://github.com/prisma-labs/graphql-playground/tree/main/packages/graphql-playground-middleware-express/examples/xss-attack') |
|  |  |  |
|  |  | ### Impacted Packages |
|  |  |  |
|  |  | \*\*All versions of these packages are impacted until those specified below\*\*, which are now safe for user defined input: |
|  |  |  |
|  |  | - `graphql-playground-html`: \*\*☔ safe\*\* @ `1.6.22` |
|  |  | - `graphql-playground-express` \*\*☔ safe\*\* @ `1.7.16` |
|  |  | - `graphql-playground-koa` \*\*☔ safe\*\* @ `1.6.15` |
|  |  | - `graphql-playground-hapi` \*\*☔ safe\*\* @ `1.6.13` |
|  |  | - `graphql-playground-lambda` \*\*☔ safe\*\* @ `1.7.17` |
|  |  |  |
|  |  | ### Static input was always safe |
|  |  |  |
|  |  | These examples are safe for \_all versions\_ \*\*because input is static\*\* |
|  |  |  |
|  |  | with `express` and `renderPlaygroundPage`: |
|  |  |  |
|  |  | ```js |
|  |  | app.get('/playground', (req) => { |
|  |  | res.html( |
|  |  | renderPlaygroundPage({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | }), |
|  |  | ) |
|  |  | next() |
|  |  | }) |
|  |  | ``` |
|  |  |  |
|  |  | with `expressPlayground`: |
|  |  |  |
|  |  | ```js |
|  |  | // params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | settings: { 'editor.theme': req.query.darkMode ? 'dark' : 'light' }, |
|  |  | }), |
|  |  | ) |
|  |  | ``` |
|  |  |  |
|  |  | with `koaPlayground`: |
|  |  |  |
|  |  | ```js |
|  |  | const koa = require('koa') |
|  |  | const koaRouter = require('koa-router') |
|  |  | const koaPlayground = require('graphql-playground-middleware-koa') |
|  |  |  |
|  |  | const app = new koa() |
|  |  | const router = new koaRouter() |
|  |  |  |
|  |  | router.all('/playground', koaPlayground({ endpoint: '/graphql' })) |
|  |  | ``` |
|  |  |  |
|  |  | ### Vulnerable Examples |
|  |  |  |
|  |  | Here are some examples where the vulnerability would be present before the patch, because of unfiltered user input |
|  |  |  |
|  |  | ```js |
|  |  | const express = require('express') |
|  |  | const expressPlayground = require('graphql-playground-middleware-express') |
|  |  | .default |
|  |  |  |
|  |  | const app = express() |
|  |  |  |
|  |  | app.use(express.json()) |
|  |  |  |
|  |  | // params |
|  |  | app.get('/playground/:id', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql/${req.params.id}`, |
|  |  | }), |
|  |  | ) |
|  |  |  |
|  |  | // params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground({ |
|  |  | endpoint: `/our/graphql`, |
|  |  | // any settings that are unsanitized user input, not just `endpoint` |
|  |  | settings: { 'editor.fontFamily': req.query.font }, |
|  |  | }), |
|  |  | ) |
|  |  | ``` |
|  |  |  |
|  |  | [See a proof of concept](packages/graphql-playground-html/examples/xss-attack) to understand the vulnerability better |
|  |  |  |
|  |  | ### Workaround |
|  |  |  |
|  |  | To fix this issue without the update, you can sanitize however you want. |
|  |  |  |
|  |  | We suggest using [`xss`](https://www.npmjs.com/package/xss) (what we use for our own fix) |
|  |  |  |
|  |  | For example, with `graphql-playground-middleware-express`: |
|  |  |  |
|  |  | ```js |
|  |  | const express = require('express') |
|  |  | const { filterXSS } = require('xss') |
|  |  | const expressPlayground = require('graphql-playground-middleware-express') |
|  |  | .default |
|  |  |  |
|  |  |  |
|  |  | const app = express() |
|  |  |  |
|  |  | const filter = (val) => filterXSS(val, { |
|  |  | whitelist: [], |
|  |  | stripIgnoreTag: true, |
|  |  | stripIgnoreTagBody: ['script'] |
|  |  | }) |
|  |  |  |
|  |  | // simple example |
|  |  | app.get('/playground/:id', (req) => |
|  |  | expressPlayground({ endpoint: `/graphql/${filter(req.params.id)}` }) |
|  |  |  |
|  |  | // advanced params |
|  |  | app.get('/playground', (req) => |
|  |  | expressPlayground(JSON.parse(filter(JSON.stringify(req.query)))) |
|  |  | ``` |
|  |  |  |
|  |  | [See a proof of concept workaround](packages/graphql-playground-html/examples/xss-attack), example #3 |

74 changes: 74 additions & 0 deletions

74
[docs/security/2021-schema-xss-phishing-attack.md](#diff-22feb1cef4ecb083f20d643259c90f6476f2e420a220d39f3cf29106038b40e6 "docs/security/2021-schema-xss-phishing-attack.md")

Show comments

[View file](/graphql/graphql-playground/blob/b8a956006835992f12c46b90384a79ab82bcadad/docs/security/2021-schema-xss-phishing-attack.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,74 @@ |
|  |  | ## GraphQL Playground introspection schema template injection attack: Advisory Statement |
|  |  |  |
|  |  | This is a security advisory for an XSS vulnerability in `graphql-playground`. |
|  |  |  |
|  |  | A similar vulnerability affects `graphiql`, the package from which `graphql-playground` was forked. There is a corresponding `graphiql` [advisory](https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8). |
|  |  |  |
|  |  | - [1. Impact](#1-impact) |
|  |  | - [2. Scope](#2-scope) |
|  |  | - [3. Patches](#3-patches) |
|  |  | - [4. Reproducing the exploit](#4-reproducing-the-exploit) |
|  |  | - [5. Credit](#5-credit) |
|  |  | - [6. For more information](#6-for-more-information) |
|  |  |  |
|  |  | ### 1. Impact |
|  |  |  |
|  |  | All versions of `graphql-playground-react` older than `graphql-playground-react@1.7.28` are vulnerable to compromised HTTP schema introspection responses or `schema` prop values with malicious GraphQL type names, exposing a dynamic XSS attack surface that can allow code injection on operation autocomplete. |
|  |  |  |
|  |  | In order for the attack to take place, the user must load a malicious schema in `graphql-playground`. There are several ways this can occur, including by specifying the URL to a malicious schema in the `endpoint` query parameter. If a user clicks on a link to a GraphQL Playground installation that specifies a malicious server, arbitrary JavaScript can run in the user's browser, which can be used to exfiltrate user credentials or other harmful goals. |
|  |  |  |
|  |  | ### 2. Scope |
|  |  |  |
|  |  | This advisory describes the impact on the `graphql-playground-react` package. The vulnerability also affects `graphiql`, the package from which `graphql-playground` was forked, with a less severe impact; see the [`graphiql` advisory](https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8) for details. It affects all versions of `graphql-playground-react` older than `v1.7.28`. |
|  |  |  |
|  |  | This vulnerability was introduced with the first public release of `graphql-playground`, so it impacts both the original legacy `graphql-playground` and the contemporary `graphql-playground-react` npm package. It is most easily exploited on `graphql-playground-react@1.7.0` and newer, as that release added functionality which made it possible to override the endpoint URL via query parameter even if it is explicitly specified in the code. |
|  |  |  |
|  |  | `graphql-playground-react` is commonly loaded via the `graphql-playground-html` package or a middleware package that wraps it (`graphql-playground-express`, `graphql-playground-middleware-koa`, `graphql-playground-middleware-hapi`, or `graphql-playground-middleware-lambda`). By default, these packages render an HTML page which loads the \*latest\* version of `graphql-playground-react` through a CDN. If you are using one of these packages to install GraphQL Playground on your domain \*and you do not explicitly pass the `version` option to `renderPlaygroundPage` or the middleware function\*, then you do not need to take any action to resolve this vulnerability, as the latest version of the React app will automatically be loaded. |
|  |  |  |
|  |  | `graphql-playground-react` is also commonly loaded via HTML served by Apollo Server. Apollo Server always pins a specific version of `graphql-playground-react`, so if you are using Apollo Server you do need to take action to resolve this vulnerability. See the [Apollo Server advisory](https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw) for details. |
|  |  |  |
|  |  |  |
|  |  | ### 3. Patches |
|  |  |  |
|  |  | `graphql-playground-react@1.7.28` addresses this issue via defense in depth: |
|  |  |  |
|  |  | - \*\*HTML-escaping text\*\* that should be treated as text rather than HTML. In most of the app, this happens automatically because React escapes all interpolated text by default. However, one vulnerable component uses the unsafe `innerHTML` API and interpolated type names directly into HTML. We now properly escape that type name, which fixes the known vulnerability. |
|  |  |  |
|  |  | - \*\*Validates the schema\*\* upon receiving the introspection response or schema changes. Schemas with names that violate the GraphQL spec will no longer be loaded. (This includes preventing the Doc Explorer from loading.) This change is also sufficient to fix the known vulnerability. |
|  |  |  |
|  |  | - \*\*Ensuring that user-generated HTML is safe\*\*. Schemas can contain Markdown in `description` and `deprecationReason` fields, and the web app renders them to HTML using the `markdown-it` library. Prior to `graphql-playground-react@1.7.28`, GraphQL Playground used two separate libraries to render Markdown: `markdown-it` and `marked`. As part of the development of `graphql-playground-react@1.7.28`, we verified that our use of `markdown-it` prevents the inclusion of arbitrary HTML. We use `markdown-it` without setting `html: true`, so we are comfortable relying on [`markdown-it`'s HTML escaping](https://github.com/markdown-it/markdown-it/blob/master/docs/security.md) here. We considered running a second level of sanitization over all rendered Markdown using a library such as `dompurify` but believe that is unnecessary as `markdown-it`'s sanitization appears to be adequate. `graphiql@1.4.3` does update to the latest version of `markdown-it` (v12, from v10) so that any security fixes in v11 and v12 will take effect. On the other hand, [`marked`](https://github.com/markedjs/marked) recommends the use of a separate HTML sanitizer if its input is untrusted. In this release, we switch the one component which uses `marked` to use `markdown-it` like the rest of the app. |
|  |  |  |
|  |  | \*\*If you are using `graphql-playground-react` directly in your client app\*\*, upgrade to version 1.7.28 or later. |
|  |  |  |
|  |  | \*\*If you are using `graphql-playground-html` or a package which starts with `graphql-playground-middleware-` in your server\*\* and you are passing the `version` option to a function imported from that package, change that `version` option to be at least `"1.7.28"`. |
|  |  |  |
|  |  | \*\*If you are using `graphql-playground-html` or a package which starts with `graphql-playground-middleware-` in your server\*\* and you are \*\*NOT\*\* passing the `version` option to a function imported from that package, no action is necessary; your app automatically loads the latest version of `graphql-playground-react` from CDN. |
|  |  |  |
|  |  |  |
|  |  | ### 4. Reproducing the exploit |
|  |  |  |
|  |  | We are hosting a "malicious" server at https://graphql-xss-schema.netlify.app/graphql . This server has a hard-coded introspection result that includes unsafe HTML in type names. |
|  |  |  |
|  |  | If you manually change a GraphQL Playground installation to use that endpoint, clear the operation pane, and type `{x` into the operation pane, an alert will pop up; this demonstrates execution of code provided by the malicious server. |
|  |  |  |
|  |  | An URL like https://YOUR-PLAYGROUND-SERVER/?endpoint=https%3A%2F%2Fgraphql-xss-schema.netlify.app%2Fgraphql&query=%7B will load already configured with the endpoint in question. (This URL-based exploit works on `graphql-playground-react@1.7.0` and newer; older versions may be protected from this particular URL-based exploit depending on their configuration.) |
|  |  | ### 5. Credit |
|  |  |  |
|  |  | This vulnerability was discovered by [@Ry0taK](https://github.com/Ry0taK), thank you! :1st\_place\_medal: |
|  |  |  |
|  |  | Others who contributed: |
|  |  |  |
|  |  | - extensive help from [@glasser](https://github.com/glasser) at [Apollo](https://github.com/apollographql) |
|  |  | - [@acao](https://github.com/acao) |
|  |  | - [@imolorhe](https://github.com/imolorhe) |
|  |  | - [@divyenduz](https://github.com/divyenduz) |
|  |  | - [@dotansimha](https://github.com/dotansimha) |
|  |  | - [@timsuchanek](http://github.com/timsuchanek) |
|  |  | - [@benjie](https://github.com/Ry0taK) and many others who provided morale support |
|  |  |  |
|  |  | ### 6. For more information |
|  |  |  |
|  |  | If you have any questions or comments about this advisory: |
|  |  |  |
|  |  | - The `graphiql` advisory document contains [more information](https://github.com/graphql/graphiql/blob/main/docs/security/2021-introspection-schema-xss.md#2-more-details-on-the-vulnerability) about how both the client-side and server-side vulnerabilities work |
|  |  | - Open an issue in the [graphql-playground repo](https://github.com/graphql/graphql-playground/new/issues) |

7 changes: 5 additions & 2 deletions

7
[packages/graphql-playground-react/package.json](#diff-2a476f0a2c3c7a6996b999969ea118e05d749641601d67baeccddb8d41d8360e "packages/graphql-playground-react/package.json")

Show comments

[View file](/graphql/graphql-playground/blob/b8a956006835992f12c46b90384a79ab82bcadad/packages/graphql-playground-react/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,7 +52,9 @@ |
|  |  | "@babel/preset-env": "^7.0.0", |
|  |  | "@babel/preset-react": "^7.0.0", |
|  |  | "@types/deasync": "0.1.0", |
|  |  | "@types/escape-html": "^1.0.1", |
|  |  | "@types/jest": "22.2.3", |
|  |  | "@types/markdown-it": "^12.2.3", |
|  |  | "@types/node": "12.12.34", |
|  |  | "@types/react": "16.9.32", |
|  |  | "@types/zen-observable": "^0.5.3", |
| Expand Down  Expand Up | | @@ -119,6 +121,7 @@ |
|  |  | "copy-to-clipboard": "^3.0.8", |
|  |  | "cryptiles": "4.1.2", |
|  |  | "cuid": "^1.3.8", |
|  |  | "escape-html": "^1.0.3", |
|  |  | "graphiql": "^0.17.5", |
|  |  | "graphql": "^15.3.0", |
|  |  | "immutable": "^4.0.0-rc.9", |
| Expand All | | @@ -128,8 +131,8 @@ |
|  |  | "keycode": "^2.1.9", |
|  |  | "lodash": "^4.17.11", |
|  |  | "lodash.debounce": "^4.0.8", |
|  |  | "markdown-it": "^8.4.1", |
|  |  | "marked": "^0.8.2", |
|  |  | "lru-cache": "^6.0.0", |
|  |  | "markdown-it": "^12.2.0", |
|  |  | "prettier": "2.0.2", |
|  |  | "prop-types": "^15.7.2", |
|  |  | "query-string": "5", |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b8a9560`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphql-playground%2Fcommit%2Fb8a956006835992f12c46b90384a79ab82bcadad) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e1c5993e_20250115_092640.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphql-playground%2Fsecurity%2Fadvisories%2FGHSA-59r9-6jp6-jcm7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphql-playground%2Fsecurity%2Fadvisories%2FGHSA-59r9-6jp6-jcm7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=graphql%2Fgraphql-playground)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[graphql](/graphql)
/
**[graphql-playground](/graphql/graphql-playground)**
Public

* [Notifications](/login?return_to=%2Fgraphql%2Fgraphql-playground) You must be signed in to change notification settings
* [Fork
  735](/login?return_to=%2Fgraphql%2Fgraphql-playground)
* [Star
   8.8k](/login?return_to=%2Fgraphql%2Fgraphql-playground)

* [Code](/graphql/graphql-playground)
* [Issues
  341](/graphql/graphql-playground/issues)
* [Pull requests
  66](/graphql/graphql-playground/pulls)
* [Discussions](/graphql/graphql-playground/discussions)
* [Actions](/graphql/graphql-playground/actions)
* [Projects
  0](/graphql/graphql-playground/projects)
* [Security](/graphql/graphql-playground/security)
* [Insights](/graphql/graphql-playground/pulse)

Additional navigation options

* [Code](/graphql/graphql-playground)
* [Issues](/graphql/graphql-playground/issues)
* [Pull requests](/graphql/graphql-playground/pulls)
* [Discussions](/graphql/graphql-playground/discussions)
* [Actions](/graphql/graphql-playground/actions)
* [Projects](/graphql/graphql-playground/projects)
* [Security](/graphql/graphql-playground/security)
* [Insights](/graphql/graphql-playground/pulse)

# XSS vulnerability in GraphQL Playground from untrusted schemas

High

[acao](/acao)
published
GHSA-59r9-6jp6-jcm7
Nov 4, 2021

## Package

npm

graphql-playground-react
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 1.7.28

## Patched versions

1.7.28

## Description

## GraphQL Playground introspection schema template injection attack: Advisory Statement

This is a security advisory for an XSS vulnerability in `graphql-playground`.

A similar vulnerability affects `graphiql`, the package from which `graphql-playground` was forked. There is a corresponding `graphiql` [advisory](https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8).

* [1. Impact](#1-impact)
* [2. Scope](#2-scope)
* [3. Patches](#3-patches)
* [4. Reproducing the exploit](#4-reproducing-the-exploit)
* [5. Credit](#5-credit)
* [6. For more information](#6-for-more-information)

### 1. Impact

All versions of `graphql-playground-react` older than `graphql-playground-react@1.7.28` are vulnerable to compromised HTTP schema introspection responses or `schema` prop values with malicious GraphQL type names, exposing a dynamic XSS attack surface that can allow code injection on operation autocomplete.

In order for the attack to take place, the user must load a malicious schema in `graphql-playground`. There are several ways this can occur, including by specifying the URL to a malicious schema in the `endpoint` query parameter. If a user clicks on a link to a GraphQL Playground installation that specifies a malicious server, arbitrary JavaScript can run in the user's browser, which can be used to exfiltrate user credentials or other harmful goals.

### 2. Scope

This advisory describes the impact on the `graphql-playground-react` package. The vulnerability also affects `graphiql`, the package from which `graphql-playground` was forked, with a less severe impact; see the [`graphiql` advisory](https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8) for details. It affects all versions of `graphql-playground-react` older than `v1.7.28`.

This vulnerability was introduced with the first public release of `graphql-playground`, so it impacts both the original legacy `graphql-playground` and the contemporary `graphql-playground-react` npm package. It is most easily exploited on `graphql-playground-react@1.7.0` and newer, as that release added functionality which made it possible to override the endpoint URL via query parameter even if it is explicitly specified in the code.

`graphql-playground-react` is commonly loaded via the `graphql-playground-html` package or a middleware package that wraps it (`graphql-playground-express`, `graphql-playground-middleware-koa`, `graphql-playground-middleware-hapi`, or `graphql-playground-middleware-lambda`). By default, these packages render an HTML page which loads the *latest* version of `graphql-playground-react` through a CDN. If you are using one of these packages to install GraphQL Playground on your domain *and you do not explicitly pass the `version` option to `renderPlaygroundPage` or the middleware function*, then you do not need to take any action to resolve this vulnerability, as the latest version of the React app will automatically be loaded.

`graphql-playground-react` is also commonly loaded via HTML served by Apollo Server. Apollo Server always pins a specific version of `graphql-playground-react`, so if you are using Apollo Server you do need to take action to resolve this vulnerability. See the [Apollo Server advisory](https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw) for details.

### 3. Patches

`graphql-playground-react@1.7.28` addresses this issue via defense in depth:

* **HTML-escaping text** that should be treated as text rather than HTML. In most of the app, this happens automatically because React escapes all interpolated text by default. However, one vulnerable component uses the unsafe `innerHTML` API and interpolated type names directly into HTML. We now properly escape that type name, which fixes the known vulnerability.
* **Validates the schema** upon receiving the introspection response or schema changes. Schemas with names that violate the GraphQL spec will no longer be loaded. (This includes preventing the Doc Explorer from loading.) This change is also sufficient to fix the known vulnerability.
* **Ensuring that user-generated HTML is safe**. Schemas can contain Markdown in `description` and `deprecationReason` fields, and the web app renders them to HTML using the `markdown-it` library. Prior to `graphql-playground-react@1.7.28`, GraphQL Playground used two separate libraries to render Markdown: `markdown-it` and `marked`. As part of the development of `graphql-playground-react@1.7.28`, we verified that our use of `markdown-it` prevents the inclusion of arbitrary HTML. We use `markdown-it` without setting `html: true`, so we are comfortable relying on [`markdown-it`'s HTML escaping](https://github.com/markdown-it/markdown-it/blob/master/docs/security.md) here. We considered running a second level of sanitization over all rendered Markdown using a library such as `dompurify` but believe that is unnecessary as `markdown-it`'s sanitization appears to be adequate. `graphiql@1.4.3` does update to the latest version of `markdown-it` (v12, from v10) so that any security fixes in v11 and v12 will take effect. On the other hand, [`marked`](https://github.com/markedjs/marked) recommends the use of a separate HTML sanitizer if its input is untrusted. In this release, we switch the one component which uses `marked` to use `markdown-it` like the rest of the app.

**If you are using `graphql-playground-react` directly in your client app**, upgrade to version 1.7.28 or later.

**If you are using `graphql-playground-html` or a package which starts with `graphql-playground-middleware-` in your server** and you are passing the `version` option to a function imported from that package, change that `version` option to be at least `"1.7.28"`.

**If you are using `graphql-playground-html` or a package which starts with `graphql-playground-middleware-` in your server** and you are **NOT** passing the `version` option to a function imported from that package, no action is necessary; your app automatically loads the latest version of `graphql-playground-react` from CDN.

### 4. Reproducing the exploit

We are hosting a "malicious" server at <https://graphql-xss-schema.netlify.app/graphql> . This server has a hard-coded introspection result that includes unsafe HTML in type names.

If you manually change a GraphQL Playground installation to use that endpoint, clear the operation pane, and type `{x` into the operation pane, an alert will pop up; this demonstrates execution of code provided by the malicious server.

An URL like <https://YOUR-PLAYGROUND-SERVER/?endpoint=https%3A%2F%2Fgraphql-xss-schema.netlify.app%2Fgraphql&query=%7B> will load already configured with the endpoint in question. (This URL-based exploit works on `graphql-playground-react@1.7.0` and newer; older versions may be protected from this particular URL-based exploit depending on their configuration.)

### 5. Credit

This vulnerability was discovered by [@Ry0taK](https://github.com/Ry0taK), thank you! 🥇

Others who contributed:

* extensive help from [@glasser](https://github.com/glasser) at [Apollo](https://github.com/apollographql)
* [@acao](https://github.com/acao)
* [@imolorhe](https://github.com/imolorhe)
* [@divyenduz](https://github.com/divyenduz)
* [@dotansimha](https://github.com/dotansimha)
* [@timsuchanek](https://github.com/timsuchanek)
* [@benjie](https://github.com/Ry0taK) and many others who provided morale support

### 6. For more information

If you have any questions or comments about this advisory:

* The `graphiql` advisory document contains [more information](https://github.com/graphql/graphiql/blob/main/docs/security/2021-introspection-schema-xss.md#2-more-details-on-the-vulnerability) about how both the client-side and server-side vulnerabilities work
* Open an issue in the [graphql-playground repo](https://github.com/graphql/graphql-playground/new/issues)

### Severity

High

7.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L

### CVE ID

CVE-2021-41249

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@Ry0taK](https://avatars.githubusercontent.com/u/49341894?s=40&v=4)](/Ry0taK)
  [Ry0taK](/Ry0taK)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_536ad7a4_20250115_092636.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphiql%2Fsecurity%2Fadvisories%2FGHSA-x4r7-m2q9-69c8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgraphql%2Fgraphiql%2Fsecurity%2Fadvisories%2FGHSA-x4r7-m2q9-69c8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=graphql%2Fgraphiql)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[graphql](/graphql)
/
**[graphiql](/graphql/graphiql)**
Public

* [Notifications](/login?return_to=%2Fgraphql%2Fgraphiql) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fgraphql%2Fgraphiql)
* [Star
   16.2k](/login?return_to=%2Fgraphql%2Fgraphiql)

* [Code](/graphql/graphiql)
* [Issues
  341](/graphql/graphiql/issues)
* [Pull requests
  57](/graphql/graphiql/pulls)
* [Discussions](/graphql/graphiql/discussions)
* [Actions](/graphql/graphiql/actions)
* [Projects
  2](/graphql/graphiql/projects)
* [Security](/graphql/graphiql/security)
* [Insights](/graphql/graphiql/pulse)

Additional navigation options

* [Code](/graphql/graphiql)
* [Issues](/graphql/graphiql/issues)
* [Pull requests](/graphql/graphiql/pulls)
* [Discussions](/graphql/graphiql/discussions)
* [Actions](/graphql/graphiql/actions)
* [Projects](/graphql/graphiql/projects)
* [Security](/graphql/graphiql/security)
* [Insights](/graphql/graphiql/pulse)

# GraphiQL introspection schema template injection attack

High

[acao](/acao)
published
GHSA-x4r7-m2q9-69c8
Nov 4, 2021

## Package

npm

graphiql
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

0.5.0 - 1.4.6

## Patched versions

1.4.7

## Description

* [1. Impact](#11-impact)
* [2. Scope](#12-scope)
* [3. Patches](#13-patches)
  + [3.1 CDN bundle implementations may be automatically patched](#131-cdn-bundle-implementations-may-be-automatically-patched)
* [4. Workarounds for Older Versions](#14-workarounds-for-older-versions)
* [5. How to Re-create the Exploit](#15-how-to-re-create-the-exploit)
* [6. Credit](#16-credit)
* [7. References](#17-references)
* [8. For more information](#18-for-more-information)

This is a security advisory for an XSS vulnerability in `graphiql`.

A similar vulnerability affects `graphql-playground`, a fork of `graphiql`. There is a corresponding `graphql-playground` [advisory](https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7) and [Apollo Server advisory](https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw).

## 1. Impact

All versions of `graphiql` older than [`graphiql@1.4.7`](https://github.com/graphql/graphiql/releases/tag/v1.4.7) are vulnerable to compromised HTTP schema introspection responses or `schema` prop values with malicious GraphQL type names, exposing a dynamic XSS attack surface that can allow code injection on operation autocomplete.

In order for the attack to take place, the user must load a vulnerable schema in `graphiql`. There are a number of ways that can occur.

By default, the schema URL is *not* attacker-controllable in `graphiql` or in its suggested implementations or examples, leaving only very complex attack vectors.

If a custom implementation of `graphiql`'s `fetcher` allows the schema URL to be set dynamically, such as a URL query parameter like `?endpoint=` in `graphql-playground`, or a database provided value, then this custom `graphiql` implementation is *vulnerable to phishing attacks*, and thus much more readily available, low or no privelege level xss attacks. The URLs could look like any generic looking graphql schema URL.

Because this exposes an XSS attack surface, it would be possible for a threat actor to exfiltrate user credentials, data, etc. using arbitrary malicious scripts, without it being known to the user.

## 2. Scope

This advisory describes the impact on the `graphiql` package. The vulnerability also affects other projects forked from `graphiql` such as [`graphql-playground`](https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7) and the `graphql-playground` fork distributed by Apollo Server. The impact is more severe in the `graphql-playground` implementations; see the [`graphql-playground` advisory](https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7) and [Apollo Server advisory](https://github.com/apollographql/apollo-server/security/advisories/GHSA-qm7x-rc44-rrqw) for details.

This vulnerability does not impact `codemirror-graphql`, `monaco-graphql` or other dependents, as it exists in `onHasCompletion.ts` in `graphiql`. It does impact all forks of `graphiql`, and every released version of `graphiql`.

It should be noted that desktop clients such as Altair, Insomnia, Postwoman, do not appear to be impacted by this.

## 3. Patches

`graphiql@1.4.7` addresses this issue via defense in depth.

* **HTML-escaping text** that should be treated as text rather than HTML. In most of the app, this happens automatically because React escapes all interpolated text by default. However, one vulnerable component uses the unsafe `innerHTML` API and interpolated type names directly into HTML. We now properly escape that type name, which fixes the known vulnerability.
* **Validates the schema** upon receiving the introspection response or schema changes. Schemas with names that violate the GraphQL spec will no longer be loaded. (This includes preventing the Doc Explorer from loading.) This change is also sufficient to fix the known vulnerability. You can disable this validation by setting `dangerouslyAssumeSchemaIsValid={true}`, which means you are relying only on escaping values to protect you from this attack.
* **Ensuring that user-generated HTML is safe**. Schemas can contain Markdown in `description` and `deprecationReason` fields, and the web app renders them to HTML using the `markdown-it` library. As part of the development of `graphiql@1.4.7`, we verified that our use of `markdown-it` prevents the inclusion of arbitrary HTML. We use `markdown-it` without setting `html: true`, so we are comfortable relying on [`markdown-it`'s HTML escaping](https://github.com/markdown-it/markdown-it/blob/master/docs/security.md) here. We considered running a second level of sanitization over all rendered Markdown using a library such as `dompurify` but believe that is unnecessary as `markdown-it`'s sanitization appears to be adequate. `graphiql@1.4.7` does update to the latest version of `markdown-it` (v12, from v10) so that any security fixes in v11 and v12 will take effect.

### 3.1 CDN bundle implementations may be automatically patched

Note that if your implementation is depending on a CDN version of `graphiql`, and is pointed to the `latest` tag (usually the default for most cdns if no version is specified) then this issue is already mitigated, in case you were vulnerable to it before.

## 4. Workarounds for Older Versions

If you cannot use `graphiql@1.4.7` or later

* Always use a static URL to a trusted server that is serving a trusted GraphQL schema.
* If you have a custom implementation that allows using user-provided schema URLs via a query parameter, database value, etc, you must either disable this customization, or only allow trusted URLs.

## 5. How to Re-create the Exploit

You can see an example on [codesandbox](https://codesandbox.io/s/graphiql-xss-exploit-gr22f?file=/src/App.js). These are both fixed to the last `graphiql` release `1.4.6` which is the last vulnerable release; however it would work with any previous release of `graphiql`.

Both of these examples are meant to demonstrate the phishing attack surface, so they are customized to accept a `url` parameter. To demonstrate the phishing attack, add `?url=https://graphql-xss-schema.netlify.app/graphql` to the in-codesandbox browser.

Erase the contents of the given query and type `{u`. You will see an alert window open, showing that attacker-controlled code was executed.

Note that when React is in development mode, a validation exception is thrown visibly; however that exception is usually buried in the browser console in a production build of `graphiql`. This validation exception comes from `getDiagnostics`, which invokes `graphql` `validate()` which in turn will `assertValidSchema()`, as `apollo-server-core` does on executing each operation. This validation does not prevent the exploit from being successful.

Note that something like the `url` parameter is not required for the attack to happen if `graphiql`'s `fetcher` is configured in a different way to communicate with a compromised GraphQL server.

## 6. Credit

This vulnerability was discovered by [@Ry0taK](https://github.com/Ry0taK), thank you! 🥇

Others who contributed:

* [@imolorhe](https://github.com/imolorhe)
* [@glasser](https://github.com/glasser)
* [@divyenduz](https://github.com/divyenduz)
* [@dotansimha](https://github.com/dotansimha)
* [@acao](https://github.com/acao)
* [@benjie](https://github.com/benjie) and many others who provided morale support

## 7. References

**The vulnerability has always been present**

[In the first commit](https://github.com/graphql/graphiql/commit/b9dec272d89d9c590727fd10d62e4a47e0317fc7#diff-855b77f6310b7e4fb1bcac779cd945092ed49fd759f4684ea391b45101166437R87)

[And later moved to onHasCompletion.js in 2016](https://github.com/graphql/graphiql/commit/6701b0b626e43800e32413590a295e5c1e3d5419#diff-d45eb76aebcffd27d3a123214487116fa95e0b5a11d70a94a0ce3033ce09f879R110) (now `.ts` after the typescript migration)

## 8. For more information

If you have any questions or comments about this advisory:

* Open an issue in [graphiql repo](https://github.com/graphql/graphiql/new/issues)
* Read [more details](https://github.com/graphql/graphiql/blob/main/docs/security/2021-introspection-schema-xss.md#2-more-details-on-the-vulnerability) on the vulnerability

### Severity

High

7.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L

### CVE ID

CVE-2021-41248

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@Ry0taK](https://avatars.githubusercontent.com/u/49341894?s=40&v=4)](/Ry0taK)
  [Ry0taK](/Ry0taK)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


