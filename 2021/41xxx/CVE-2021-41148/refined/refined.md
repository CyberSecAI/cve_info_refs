Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-41148

**Root Cause of Vulnerability:**
The Tuleap application did not properly sanitize user inputs when constructing the SQL query used to update the continuous integration (CI) job targeted by a widget. Specifically, the `job_id` parameter was not sanitized before being used in an SQL UPDATE query.

**Weaknesses/Vulnerabilities Present:**
- **Blind SQL Injection:** The lack of input sanitization allows for blind SQL injection attacks. The attacker can inject arbitrary SQL code into the `job_id` parameter, which gets executed by the database.
- **CWE-89:** This vulnerability is classified under CWE-89, which is "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')."

**Impact of Exploitation:**
- **Arbitrary SQL query execution:** An attacker could execute arbitrary SQL queries. This could potentially lead to data exfiltration, data modification, or even complete compromise of the database.
- **Confidentiality, Integrity, Availability:** The impact is high on all three categories (Confidentiality, Integrity, and Availability).

**Attack Vectors:**
- **Network-based:** The attack can be performed over the network.
- **CI Widget:** The attacker needs to be able to add a CI widget to their personal dashboard.
- **Manipulated `job_id`:** The attacker manipulates the `job_id` parameter when updating the widget's preferences.

**Required Attacker Capabilities/Position:**
- **Low Privileges:** The attacker needs only low privileges, specifically, the ability to add a CI widget to their personal dashboard.
- **No User Interaction:** No user interaction is required to trigger the vulnerability.
- **Network Access:** Attacker needs network access to the Tuleap instance.

**Technical Details:**
- The vulnerability exists in the `HudsonJobWidget.class.php` file.
- The vulnerable code is in the `updatePreferences` function, where the `job_id` is directly inserted into the SQL query without sanitization.
- The fix involves using parameterized queries instead of concatenating the unsanitized `job_id` directly into the SQL query.
- The commit `91535add59f4b3a04b6b8eab123c002cd5af180d` contains the fix.

**Example of exploitation:**
An attacker could set the value of the `job_id` to something like `(SELECT BENCHMARK(50000000,ENCODE('MSG','Slow')))` when updating the CI widget's preferences, causing a noticeable delay, which demonstrates the ability to execute arbitrary SQL.

**Patched Versions:**
- Tuleap Community Edition 11.16.99.23
- Tuleap Enterprise Edition 11.16-2
- Tuleap Enterprise Edition 11.15-6