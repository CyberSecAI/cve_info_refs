=== Content from github.com_3b56fb47_20250114_183613.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

## Commit

[Permalink](/DSpace/DSpace/commit/277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix for [GHSA-cf2j-vf36-c6w8](https://github.com/advisories/GHSA-cf2j-vf36-c6w8 "GHSA-cf2j-vf36-c6w8")

[Browse files](/DSpace/DSpace/tree/277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041)
Browse the repository at this point in the history

* Loading branch information

[![@abollini](https://avatars.githubusercontent.com/u/1537527?s=40&v=4)](/abollini)

[abollini](/DSpace/DSpace/commits?author=abollini "View all commits by abollini")
committed
Oct 25, 2021

1 parent
[0de9680](/DSpace/DSpace/commit/0de9680781ea52a26f99be0656618bc073ca8dab)

commit 277b499

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**33 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dspace-api/src/main/java/org/dspace

  + content

    - dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java
      [CollectionServiceImpl.java](#diff-f630778b0ca30f49ab0ed647cd958630a5989ec56d16899111b7ffb1495572af)
    - service

      * dspace-api/src/main/java/org/dspace/content/service/CollectionService.java
        [CollectionService.java](#diff-af56e89567bb6193b3562a215f0a45349186ac05ff288d5428f5b21c6bf96026)
  + eperson

    - dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java
      [GroupServiceImpl.java](#diff-eef4fb8c95308471668de0001f7c0ad37110e467dabb496958327240736e0db3)

## There are no files selected for viewing

9 changes: 7 additions & 2 deletions

9
[dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java](#diff-f630778b0ca30f49ab0ed647cd958630a5989ec56d16899111b7ffb1495572af "dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java")

Show comments

[View file](/DSpace/DSpace/blob/277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041/dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -920,8 +920,7 @@ public Group createDefaultReadGroup(Context context, Collection collection, Stri |
|  |  | int defaultRead) |
|  |  | throws SQLException, AuthorizeException { |
|  |  | Group role = groupService.create(context); |
|  |  | groupService.setName(role, "COLLECTION\_" + collection.getID().toString() + "\_" + typeOfGroupString + |
|  |  | "\_DEFAULT\_READ"); |
|  |  | groupService.setName(role, getDefaultReadGroupName(collection, typeOfGroupString)); |
|  |  |  |
|  |  | // Remove existing privileges from the anonymous group. |
|  |  | authorizeService.removePoliciesActionFilter(context, collection, defaultRead); |
| Expand All | | @@ -932,6 +931,12 @@ public Group createDefaultReadGroup(Context context, Collection collection, Stri |
|  |  | return role; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String getDefaultReadGroupName(Collection collection, String typeOfGroupString) { |
|  |  | return "COLLECTION\_" + collection.getID().toString() + "\_" + typeOfGroupString + |
|  |  | "\_DEFAULT\_READ"; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public List<Collection> findCollectionsWithSubmit(String q, Context context, Community community, |
|  |  | int offset, int limit) throws SQLException, SearchServiceException { |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[dspace-api/src/main/java/org/dspace/content/service/CollectionService.java](#diff-af56e89567bb6193b3562a215f0a45349186ac05ff288d5428f5b21c6bf96026 "dspace-api/src/main/java/org/dspace/content/service/CollectionService.java")

Show comments

[View file](/DSpace/DSpace/blob/277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041/dspace-api/src/main/java/org/dspace/content/service/CollectionService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -360,6 +360,16 @@ public List<Collection> findAuthorized(Context context, Community community, int |
|  |  | Group createDefaultReadGroup(Context context, Collection collection, String typeOfGroupString, int defaultRead) |
|  |  | throws SQLException, AuthorizeException; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* This method will return the name to give to the group created by the |
|  |  | \* {@link #createDefaultReadGroup(Context, Collection, String, int)} method |
|  |  | \* |
|  |  | \* @param collection The DSpace collection to use in the name generation |
|  |  | \* @param typeOfGroupString The type of group to use in the name generation |
|  |  | \* @return the name to give to the group that hold default read for the collection |
|  |  | \*/ |
|  |  | String getDefaultReadGroupName(Collection collection, String typeOfGroupString); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns Collections for which the current user has 'submit' privileges. |
|  |  | \* NOTE: for better performance, this method retrieves its results from an |
| Expand Down | |  |

20 changes: 16 additions & 4 deletions

20
[dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java](#diff-eef4fb8c95308471668de0001f7c0ad37110e467dabb496958327240736e0db3 "dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java")

Show comments

[View file](/DSpace/DSpace/blob/277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041/dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,7 @@ |
|  |  | import java.util.List; |
|  |  | import java.util.Map; |
|  |  | import java.util.Objects; |
|  |  | import java.util.Optional; |
|  |  | import java.util.Set; |
|  |  | import java.util.UUID; |
|  |  |  |
| Expand Down  Expand Up | | @@ -735,13 +736,24 @@ public DSpaceObject getParentObject(Context context, Group group) throws SQLExce |
|  |  | groups.add(group); |
|  |  | List<ResourcePolicy> policies = resourcePolicyService.find(context, null, groups, |
|  |  | Constants.DEFAULT\_ITEM\_READ, Constants.COLLECTION); |
|  |  | if (policies.size() > 0) { |
|  |  | return policies.get(0).getdSpaceObject(); |
|  |  |  |
|  |  | Optional<ResourcePolicy> defaultPolicy = policies.stream().filter(p -> StringUtils.equals( |
|  |  | collectionService.getDefaultReadGroupName((Collection) p.getdSpaceObject(), "ITEM"), |
|  |  | group.getName())).findFirst(); |
|  |  |  |
|  |  | if (defaultPolicy.isPresent()) { |
|  |  | return defaultPolicy.get().getdSpaceObject(); |
|  |  | } |
|  |  | policies = resourcePolicyService.find(context, null, groups, |
|  |  | Constants.DEFAULT\_BITSTREAM\_READ, Constants.COLLECTION); |
|  |  | if (policies.size() > 0) { |
|  |  | return policies.get(0).getdSpaceObject(); |
|  |  |  |
|  |  | defaultPolicy = policies.stream() |
|  |  | .filter(p -> StringUtils.equals(collectionService.getDefaultReadGroupName( |
|  |  | (Collection) p.getdSpaceObject(), "BITSTREAM"), group.getName())) |
|  |  | .findFirst(); |
|  |  |  |
|  |  | if (defaultPolicy.isPresent()) { |
|  |  | return defaultPolicy.get().getdSpaceObject(); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `277b499`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F277b499a5cd3a4f5eb2370513a1b7e4ec2a6e041) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6ef30476_20250114_183621.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-cf2j-vf36-c6w8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-cf2j-vf36-c6w8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

# Communities and collections administrators can escalate their privilege up to system administrator

High

[tdonohue](/tdonohue)
published
GHSA-cf2j-vf36-c6w8
Oct 29, 2021

## Package

maven

dspace-api
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

7.0

## Patched versions

7.1

## Description

### Impact

Any community or collection administrator can escalate their permission up to become system administrator.

This vulnerability only existed in 7.0 and does not impact 6.x or below.

### Patches

Fix is included in [7.1](https://github.com/DSpace/DSpace/releases/tag/dspace-7.1). Please upgrade to 7.1 at your earliest convenience.

### Workarounds

In 7.0, temporarily disable the ability for community or collection administrators to manage permissions or workflows settings, i.e. set the following properties in your local.cfg / dspace.cfg file

```
core.authorization.collection-admin.policies = false
core.authorization.community-admin.policies = false
core.authorization.community-admin.collection.workflows = false

```

Once upgraded to 7.1, these settings can be safely reverted to the default values of `true`.

### References

Discovered during investigation of [#7928](https://github.com/DSpace/DSpace/issues/7928)

### For more information

If you have any questions or comments about this advisory:

* Email us at security@dspace.org

### Severity

High

### CVE ID

CVE-2021-41189

### Weaknesses

[CWE-863](/advisories?query=cwe%3A863)

### Credits

* [![@abollini](https://avatars.githubusercontent.com/u/1537527?s=40&v=4)](/abollini)
  [abollini](/abollini)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_28b7f425_20250114_183619.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fissues%2F7928)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fissues%2F7928)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FDSpace%2FDSpace%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FDSpace%2FDSpace%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# REST service returns wrong object for the "Anonymous" group #7928

Closed

[davide-negretti](/davide-negretti) opened this issue
Sep 2, 2021
· 2 comments

Closed

# [REST service returns wrong object for the "Anonymous" group](#top) #7928

[davide-negretti](/davide-negretti) opened this issue
Sep 2, 2021
· 2 comments

Assignees
[![@abollini](https://avatars.githubusercontent.com/u/1537527?s=40&v=4)](/abollini)

Labels
[bug](/DSpace/DSpace/labels/bug)
[Estimate TBD](/DSpace/DSpace/labels/Estimate%20TBD)
Needs to have an estimate added
[high priority](/DSpace/DSpace/labels/high%20priority)
[interface: REST API v7+](/DSpace/DSpace/labels/interface%3A%20REST%20API%20v7%2B)
REST API for v7 and later (dspace-server-webapp module)

Milestone
[7.1](/DSpace/DSpace/milestone/36 "7.1")

## Comments

[![@davide-negretti](https://avatars.githubusercontent.com/u/87638927?s=80&u=9740f39c1cf93ce88c96645ba080fa66ac27bd21&v=4)](/davide-negretti)

Copy link

### **[davide-negretti](/davide-negretti)** commented [Sep 2, 2021](#issue-986773109)

| **Describe the bug** The "Anonymous" group has the "Articles" collection as linked object: <https://api7.dspace.org/server/api/eperson/groups/f2c7eb75-aec0-4604-ab7f-6676723818ad/object> This is not true, as it's not a `COLLECTION_[uuid]_*` group.  [bug](https://user-images.githubusercontent.com/87638927/131855577-2efe384a-e159-4d0e-a457-18ed872adbdb.png)  **Related work** [DSpace/dspace-angular#1298](https://github.com/DSpace/dspace-angular/pull/1298) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@davide-negretti](https://avatars.githubusercontent.com/u/87638927?s=40&u=9740f39c1cf93ce88c96645ba080fa66ac27bd21&v=4)](/davide-negretti)
[davide-negretti](/davide-negretti)
added
[bug](/DSpace/DSpace/labels/bug)
[needs triage](/DSpace/DSpace/labels/needs%20triage)
New issue needs triage and/or scheduling
labels
[Sep 2, 2021](#event-5247726581)

[![@davide-negretti](https://avatars.githubusercontent.com/u/87638927?s=40&u=9740f39c1cf93ce88c96645ba080fa66ac27bd21&v=4)](/davide-negretti)
[davide-negretti](/davide-negretti)
mentioned this issue
[Sep 2, 2021](#ref-pullrequest-978000912)

[Cannot easily tell similar named EPeople or Groups apart (usability issue)
DSpace/dspace-angular#1298](/DSpace/dspace-angular/pull/1298)
 Merged

6 tasks

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=80&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)

Copy link

Member

### **[tdonohue](/tdonohue)** commented [Sep 2, 2021](#issuecomment-911801966)

| [@abollini](https://github.com/abollini) : I'm going to need your help (or someone at 4Science) in debugging this issue. It's very odd, as obviously "Anonymous" shouldn't be associated with a Collection. I'm not yet sure whether it is a bug in the code though, or whether it's *bad data* in the database.  Moving this over to 7.1 with `high priority` though as, if it's a bug, it's something that needs fixing quickly. |
| --- |

All reactions

Sorry, something went wrong.

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
assigned [tdonohue](/tdonohue) and [abollini](/abollini)
[Sep 2, 2021](#event-5248303546)

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
added
[high priority](/DSpace/DSpace/labels/high%20priority)
[interface: REST API v7+](/DSpace/DSpace/labels/interface%3A%20REST%20API%20v7%2B)
REST API for v7 and later (dspace-server-webapp module)
and removed
[needs triage](/DSpace/DSpace/labels/needs%20triage)
New issue needs triage and/or scheduling
labels
[Sep 2, 2021](#event-5248304632)

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
added
the
[Estimate TBD](/DSpace/DSpace/labels/Estimate%20TBD)
Needs to have an estimate added
label
[Sep 2, 2021](#event-5248305769)

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
removed their assignment
[Oct 26, 2021](#event-5521976927)

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
added this to the [7.1](/DSpace/DSpace/milestone/36) milestone
[Oct 26, 2021](#event-5521977356)

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=80&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)

Copy link

Member

### **[tdonohue](/tdonohue)** commented [Oct 26, 2021](#issuecomment-952117935)

| Closing, as this was fixed in 7.1 |
| --- |

All reactions

Sorry, something went wrong.

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&u=f8023be771db9ad6334ef6787ef4e379119b5039&v=4)](/tdonohue)
[tdonohue](/tdonohue)
closed this as [completed](/DSpace/DSpace/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Oct 26, 2021](#event-5521979853)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fissues%2F7928)

Assignees

[![@abollini](https://avatars.githubusercontent.com/u/1537527?s=40&v=4)](/abollini) [abollini](/abollini)

Labels

[bug](/DSpace/DSpace/labels/bug)
[Estimate TBD](/DSpace/DSpace/labels/Estimate%20TBD)
Needs to have an estimate added
[high priority](/DSpace/DSpace/labels/high%20priority)
[interface: REST API v7+](/DSpace/DSpace/labels/interface%3A%20REST%20API%20v7%2B)
REST API for v7 and later (dspace-server-webapp module)

Projects

None yet

Milestone

 [**7.1**](/DSpace/DSpace/milestone/36 "7.1")

Development

No branches or pull requests

3 participants

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=52&v=4)](/tdonohue) [![@abollini](https://avatars.githubusercontent.com/u/1537527?s=52&v=4)](/abollini) [![@davide-negretti](https://avatars.githubusercontent.com/u/87638927?s=52&v=4)](/davide-negretti)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a1c88407_20250114_183617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fc3bea16ab911606e15ae96c97a1575e1ffb14f8a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fc3bea16ab911606e15ae96c97a1575e1ffb14f8a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

## Commit

[Permalink](/DSpace/DSpace/commit/c3bea16ab911606e15ae96c97a1575e1ffb14f8a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-cf2j-vf36-c6w8](https://github.com/advisories/GHSA-cf2j-vf36-c6w8 "GHSA-cf2j-vf36-c6w8")

[Browse files](/DSpace/DSpace/tree/c3bea16ab911606e15ae96c97a1575e1ffb14f8a)
Browse the repository at this point in the history

```
Default groups issue
```

* Loading branch information

[![@tdonohue](https://avatars.githubusercontent.com/u/483997?s=40&v=4)](/tdonohue)

[tdonohue](/DSpace/DSpace/commits?author=tdonohue "View all commits by tdonohue")
authored
Oct 26, 2021

2 parents
[f21b16c](/DSpace/DSpace/commit/f21b16c25534b31b7b77a7eb950f9283537afb42)
+
[16cf19b](/DSpace/DSpace/commit/16cf19bed05617af3f92d7ed7b809f4b6196e094)

commit c3bea16

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**194 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dspace-api/src/main/java/org/dspace

  + content

    - dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java
      [CollectionServiceImpl.java](#diff-f630778b0ca30f49ab0ed647cd958630a5989ec56d16899111b7ffb1495572af)
    - service

      * dspace-api/src/main/java/org/dspace/content/service/CollectionService.java
        [CollectionService.java](#diff-af56e89567bb6193b3562a215f0a45349186ac05ff288d5428f5b21c6bf96026)
  + eperson

    - dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java
      [GroupServiceImpl.java](#diff-eef4fb8c95308471668de0001f7c0ad37110e467dabb496958327240736e0db3)
* dspace-server-webapp/src/test/java/org/dspace/app/rest

  + dspace-server-webapp/src/test/java/org/dspace/app/rest/GroupRestRepositoryIT.java
    [GroupRestRepositoryIT.java](#diff-a8e0930f8eb62d4c23d4412abf8a11b6a925e3913046bb928b7708b726b21346)

## There are no files selected for viewing

9 changes: 7 additions & 2 deletions

9
[dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java](#diff-f630778b0ca30f49ab0ed647cd958630a5989ec56d16899111b7ffb1495572af "dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java")

Show comments

[View file](/DSpace/DSpace/blob/c3bea16ab911606e15ae96c97a1575e1ffb14f8a/dspace-api/src/main/java/org/dspace/content/CollectionServiceImpl.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -920,8 +920,7 @@ public Group createDefaultReadGroup(Context context, Collection collection, Stri |
|  |  | int defaultRead) |
|  |  | throws SQLException, AuthorizeException { |
|  |  | Group role = groupService.create(context); |
|  |  | groupService.setName(role, "COLLECTION\_" + collection.getID().toString() + "\_" + typeOfGroupString + |
|  |  | "\_DEFAULT\_READ"); |
|  |  | groupService.setName(role, getDefaultReadGroupName(collection, typeOfGroupString)); |
|  |  |  |
|  |  | // Remove existing privileges from the anonymous group. |
|  |  | authorizeService.removePoliciesActionFilter(context, collection, defaultRead); |
| Expand All | | @@ -932,6 +931,12 @@ public Group createDefaultReadGroup(Context context, Collection collection, Stri |
|  |  | return role; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String getDefaultReadGroupName(Collection collection, String typeOfGroupString) { |
|  |  | return "COLLECTION\_" + collection.getID().toString() + "\_" + typeOfGroupString + |
|  |  | "\_DEFAULT\_READ"; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public List<Collection> findCollectionsWithSubmit(String q, Context context, Community community, |
|  |  | int offset, int limit) throws SQLException, SearchServiceException { |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[dspace-api/src/main/java/org/dspace/content/service/CollectionService.java](#diff-af56e89567bb6193b3562a215f0a45349186ac05ff288d5428f5b21c6bf96026 "dspace-api/src/main/java/org/dspace/content/service/CollectionService.java")

Show comments

[View file](/DSpace/DSpace/blob/c3bea16ab911606e15ae96c97a1575e1ffb14f8a/dspace-api/src/main/java/org/dspace/content/service/CollectionService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -360,6 +360,16 @@ public List<Collection> findAuthorized(Context context, Community community, int |
|  |  | Group createDefaultReadGroup(Context context, Collection collection, String typeOfGroupString, int defaultRead) |
|  |  | throws SQLException, AuthorizeException; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* This method will return the name to give to the group created by the |
|  |  | \* {@link #createDefaultReadGroup(Context, Collection, String, int)} method |
|  |  | \* |
|  |  | \* @param collection The DSpace collection to use in the name generation |
|  |  | \* @param typeOfGroupString The type of group to use in the name generation |
|  |  | \* @return the name to give to the group that hold default read for the collection |
|  |  | \*/ |
|  |  | String getDefaultReadGroupName(Collection collection, String typeOfGroupString); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns Collections for which the current user has 'submit' privileges. |
|  |  | \* NOTE: for better performance, this method retrieves its results from an |
| Expand Down | |  |

20 changes: 16 additions & 4 deletions

20
[dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java](#diff-eef4fb8c95308471668de0001f7c0ad37110e467dabb496958327240736e0db3 "dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java")

Show comments

[View file](/DSpace/DSpace/blob/c3bea16ab911606e15ae96c97a1575e1ffb14f8a/dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,7 @@ |
|  |  | import java.util.List; |
|  |  | import java.util.Map; |
|  |  | import java.util.Objects; |
|  |  | import java.util.Optional; |
|  |  | import java.util.Set; |
|  |  | import java.util.UUID; |
|  |  |  |
| Expand Down  Expand Up | | @@ -735,13 +736,24 @@ public DSpaceObject getParentObject(Context context, Group group) throws SQLExce |
|  |  | groups.add(group); |
|  |  | List<ResourcePolicy> policies = resourcePolicyService.find(context, null, groups, |
|  |  | Constants.DEFAULT\_ITEM\_READ, Constants.COLLECTION); |
|  |  | if (policies.size() > 0) { |
|  |  | return policies.get(0).getdSpaceObject(); |
|  |  |  |
|  |  | Optional<ResourcePolicy> defaultPolicy = policies.stream().filter(p -> StringUtils.equals( |
|  |  | collectionService.getDefaultReadGroupName((Collection) p.getdSpaceObject(), "ITEM"), |
|  |  | group.getName())).findFirst(); |
|  |  |  |
|  |  | if (defaultPolicy.isPresent()) { |
|  |  | return defaultPolicy.get().getdSpaceObject(); |
|  |  | } |
|  |  | policies = resourcePolicyService.find(context, null, groups, |
|  |  | Constants.DEFAULT\_BITSTREAM\_READ, Constants.COLLECTION); |
|  |  | if (policies.size() > 0) { |
|  |  | return policies.get(0).getdSpaceObject(); |
|  |  |  |
|  |  | defaultPolicy = policies.stream() |
|  |  | .filter(p -> StringUtils.equals(collectionService.getDefaultReadGroupName( |
|  |  | (Collection) p.getdSpaceObject(), "BITSTREAM"), group.getName())) |
|  |  | .findFirst(); |
|  |  |  |
|  |  | if (defaultPolicy.isPresent()) { |
|  |  | return defaultPolicy.get().getdSpaceObject(); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

161 changes: 161 additions & 0 deletions

161
[dspace-server-webapp/src/test/java/org/dspace/app/rest/GroupRestRepositoryIT.java](#diff-a8e0930f8eb62d4c23d4412abf8a11b6a925e3913046bb928b7708b726b21346 "dspace-server-webapp/src/test/java/org/dspace/app/rest/GroupRestRepositoryIT.java")

Show comments

[View file](/DSpace/DSpace/blob/c3bea16ab911606e15ae96c97a1575e1ffb14f8a/dspace-server-webapp/src/test/java/org/dspace/app/rest/GroupRestRepositoryIT.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -53,6 +53,7 @@ |
|  |  | import org.dspace.builder.CommunityBuilder; |
|  |  | import org.dspace.builder.EPersonBuilder; |
|  |  | import org.dspace.builder.GroupBuilder; |
|  |  | import org.dspace.builder.ResourcePolicyBuilder; |
|  |  | import org.dspace.content.Collection; |
|  |  | import org.dspace.content.Community; |
|  |  | import org.dspace.content.factory.ContentServiceFactory; |
| Expand Down  Expand Up | | @@ -3025,4 +3026,164 @@ public void findByMetadataPaginationTest() throws Exception { |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void commAdminAndColAdminCannotExploitItemReadGroupTest() throws Exception { |
|  |  |  |
|  |  | GroupService groupService = EPersonServiceFactory.getInstance().getGroupService(); |
|  |  |  |
|  |  | context.turnOffAuthorisationSystem(); |
|  |  |  |
|  |  | EPerson adminChild1 = EPersonBuilder.createEPerson(context) |
|  |  | .withNameInMetadata("Oliver", "Rossi") |
|  |  | .withEmail("adminChild1@example.com") |
|  |  | .withPassword(password) |
|  |  | .build(); |
|  |  | EPerson adminCol1 = EPersonBuilder.createEPerson(context) |
|  |  | .withNameInMetadata("James", "Rossi") |
|  |  | .withEmail("adminCol1@example.com") |
|  |  | .withPassword(password) |
|  |  | .build(); |
|  |  |  |
|  |  | parentCommunity = CommunityBuilder.createCommunity(context) |
|  |  | .withName("Parent Community") |
|  |  | .build(); |
|  |  | Community child1 = CommunityBuilder.createSubCommunity(context, parentCommunity) |
|  |  | .withName("Sub Community") |
|  |  | .withAdminGroup(adminChild1) |
|  |  | .build(); |
|  |  |  |
|  |  | Collection col1 = CollectionBuilder.createCollection(context, child1) |
|  |  | .withName("Collection 1") |
|  |  | .withAdminGroup(adminCol1) |
|  |  | .withSubmitterGroup(eperson) |
|  |  | .build(); |
|  |  |  |
|  |  | Group adminGroup = groupService.findByName(context, Group.ADMIN); |
|  |  | ResourcePolicyBuilder.createResourcePolicy(context).withAction(Constants.DEFAULT\_ITEM\_READ) |
|  |  | .withGroup(adminGroup).withDspaceObject(child1).build(); |
|  |  | ResourcePolicyBuilder.createResourcePolicy(context).withAction(Constants.DEFAULT\_ITEM\_READ) |
|  |  | .withGroup(adminGroup).withDspaceObject(col1).build(); |
|  |  | context.restoreAuthSystemState(); |
|  |  |  |
|  |  | String tokenAdminComm = getAuthToken(adminChild1.getEmail(), password); |
|  |  | String tokenAdminCol = getAuthToken(adminChild1.getEmail(), password); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminChild1, adminGroup)); |
|  |  | assertFalse(groupService.isMember(context, adminCol1, adminGroup)); |
|  |  |  |
|  |  | getClient(tokenAdminCol) |
|  |  | .perform(post("/api/eperson/groups/" + adminGroup.getID() + "/epersons") |
|  |  | .contentType(parseMediaType(TEXT\_URI\_LIST\_VALUE)) |
|  |  | .content(REST\_SERVER\_URL + "eperson/groups/" + adminCol1.getID())) |
|  |  | .andExpect(status().isForbidden()); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminCol1, adminGroup)); |
|  |  |  |
|  |  | getClient(tokenAdminComm) |
|  |  | .perform(post("/api/eperson/groups/" + adminGroup.getID() + "/epersons") |
|  |  | .contentType(parseMediaType(TEXT\_URI\_LIST\_VALUE)) |
|  |  | .content(REST\_SERVER\_URL + "eperson/groups/" + adminChild1.getID())) |
|  |  | .andExpect(status().isForbidden()); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminChild1, adminGroup)); |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void commAdminAndColAdminCannotExpoloitBitstreamReadGroupTest() throws Exception { |
|  |  |  |
|  |  | GroupService groupService = EPersonServiceFactory.getInstance().getGroupService(); |
|  |  |  |
|  |  | context.turnOffAuthorisationSystem(); |
|  |  |  |
|  |  | EPerson adminChild1 = EPersonBuilder.createEPerson(context) |
|  |  | .withNameInMetadata("Oliver", "Rossi") |
|  |  | .withEmail("adminChild1@example.com") |
|  |  | .withPassword(password) |
|  |  | .build(); |
|  |  | EPerson adminCol1 = EPersonBuilder.createEPerson(context) |
|  |  | .withNameInMetadata("James", "Rossi") |
|  |  | .withEmail("adminCol1@example.com") |
|  |  | .withPassword(password) |
|  |  | .build(); |
|  |  |  |
|  |  | parentCommunity = CommunityBuilder.createCommunity(context) |
|  |  | .withName("Parent Community") |
|  |  | .build(); |
|  |  | Community child1 = CommunityBuilder.createSubCommunity(context, parentCommunity) |
|  |  | .withName("Sub Community") |
|  |  | .withAdminGroup(adminChild1) |
|  |  | .build(); |
|  |  |  |
|  |  | Collection col1 = CollectionBuilder.createCollection(context, child1) |
|  |  | .withName("Collection 1") |
|  |  | .withAdminGroup(adminCol1) |
|  |  | .withSubmitterGroup(eperson) |
|  |  | .build(); |
|  |  |  |
|  |  | Group adminGroup = groupService.findByName(context, Group.ADMIN); |
|  |  | ResourcePolicyBuilder.createResourcePolicy(context).withAction(Constants.DEFAULT\_BITSTREAM\_READ) |
|  |  | .withGroup(adminGroup).withDspaceObject(child1).build(); |
|  |  | ResourcePolicyBuilder.createResourcePolicy(context).withAction(Constants.DEFAULT\_BITSTREAM\_READ) |
|  |  | .withGroup(adminGroup).withDspaceObject(col1).build(); |
|  |  | context.restoreAuthSystemState(); |
|  |  |  |
|  |  | String tokenAdminComm = getAuthToken(adminChild1.getEmail(), password); |
|  |  | String tokenAdminCol = getAuthToken(adminChild1.getEmail(), password); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminChild1, adminGroup)); |
|  |  | assertFalse(groupService.isMember(context, adminCol1, adminGroup)); |
|  |  |  |
|  |  | getClient(tokenAdminCol) |
|  |  | .perform(post("/api/eperson/groups/" + adminGroup.getID() + "/epersons") |
|  |  | .contentType(parseMediaType(TEXT\_URI\_LIST\_VALUE)) |
|  |  | .content(REST\_SERVER\_URL + "eperson/groups/" + adminCol1.getID())) |
|  |  | .andExpect(status().isForbidden()); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminCol1, adminGroup)); |
|  |  |  |
|  |  | getClient(tokenAdminComm) |
|  |  | .perform(post("/api/eperson/groups/" + adminGroup.getID() + "/epersons") |
|  |  | .contentType(parseMediaType(TEXT\_URI\_LIST\_VALUE)) |
|  |  | .content(REST\_SERVER\_URL + "eperson/groups/" + adminChild1.getID())) |
|  |  | .andExpect(status().isForbidden()); |
|  |  |  |
|  |  | assertFalse(groupService.isMember(context, adminChild1, adminGroup)); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | /\*\* |
|  |  | \* Test for bug https://github.com/DSpace/DSpace/issues/7928 |
|  |  | \* @throws Exception |
|  |  | \*/ |
|  |  | public void anonymousGroupParentObjectTest() throws Exception { |
|  |  |  |
|  |  | GroupService groupService = EPersonServiceFactory.getInstance().getGroupService(); |
|  |  | Group anonGroup = groupService.findByName(context, Group.ANONYMOUS); |
|  |  | context.turnOffAuthorisationSystem(); |
|  |  |  |
|  |  | parentCommunity = CommunityBuilder.createCommunity(context) |
|  |  | .withName("Parent Community") |
|  |  | .build(); |
|  |  |  |
|  |  | Collection col1 = CollectionBuilder.createCollection(context, parentCommunity) |
|  |  | .withName("Collection 1") |
|  |  | .build(); |
|  |  | context.restoreAuthSystemState(); |
|  |  |  |
|  |  | String tokenAdmin = getAuthToken(admin.getEmail(), password); |
|  |  |  |
|  |  | getClient(tokenAdmin).perform(get("/api/eperson/groups/" + anonGroup.getID().toString()) |
|  |  | .param("projection", "full")) |
|  |  | .andExpect(status().isOk()) |
|  |  | .andExpect(content().contentType(contentType)) |
|  |  | .andExpect(jsonPath("$", GroupMatcher.matchFullEmbeds())) |
|  |  | .andExpect(jsonPath("$", GroupMatcher.matchLinks(anonGroup.getID()))) |
|  |  | .andExpect(jsonPath("$", Matchers.is( |
|  |  | GroupMatcher.matchGroupEntry(anonGroup.getID(), anonGroup.getName()) |
|  |  | ))) |
|  |  | .andExpect(jsonPath("$.\_embedded.object").doesNotExist()) |
|  |  | ; |
|  |  | } |
|  |  |  |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c3bea16`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fc3bea16ab911606e15ae96c97a1575e1ffb14f8a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


