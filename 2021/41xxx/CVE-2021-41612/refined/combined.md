=== Content from seth.engr.tamu.edu_af2cc6d4_20250114_220337.html ===


* [Skip to primary navigation](#genesis-nav-primary)
* [Skip to main content](#genesis-content)

* [About Us](https://seth.engr.tamu.edu/)
* [Research](https://seth.engr.tamu.edu/research-2/)
* [Publications](https://seth.engr.tamu.edu/publications/)
* [People](https://seth.engr.tamu.edu/people/)
* [Artifacts](https://seth.engr.tamu.edu/software-releases/)
* [News](https://seth.engr.tamu.edu/news-2/)
* [Sponsors](https://seth.engr.tamu.edu/sponsors/)
* [Contact Us](https://seth.engr.tamu.edu/contact-us/)

[Secure and Trustworthy Hardware (SETH) Lab](https://seth.engr.tamu.edu/)

[![Texas A&M University College of Engineering](https://seth.engr.tamu.edu/wp-content/themes/coe-theme/images/logos/coe/logos-horizontal/ENGINEERING_logo_HWHT.png)](https://seth.engr.tamu.edu)Menu
# New vulnerabilities detected by our hardware fuzzer, TheHuzz

Please email jv.rajendran@tamu.edu and ahmad.sadeghi@trust.informatik.tu-darmstadt.de if you need TheHuzz. Our hardware fuzzer [TheHuzz](https://www.usenix.org/conference/usenixsecurity22/presentation/kande) detected eight new vulnerabilities of which five of them are assigned with CVEs: CVE-2021-40506, CVE-2021-40507, CVE-2021-41612, CVE-2021-41614, and CVE-2021-41613. These bugs are listed in Table 1 on page 10 of the [TheHuzz](https://www.usenix.org/conference/usenixsecurity22/presentation/kande) paper. For your convenience,, here is the mapping between the bugs in the paper and the CVEs assigned to the bugs:

* CVE-2021-41612 –> B5: Incorrect implementation of the logic to generate the carry flag
* CVE-2021-41614 –> B6: Read/write access checking not implemented for privileged register
* CVE-2021-41613 –> B7: Incomplete implementation of EEAR register write logic
* CVE-2021-40506 –> B9: Incomplete update logic of overflow bit for MSB & MAC instructions
* CVE-2021-40507 –> B10: Incorrect implementation of the logic to generate the overflow flag

Here is a detailed description of these five vulnerabilities:

| **Fields** | **B5 (CVE-2021-41612)** | **B6 (CVE-2021-41614)** | **B7 (CVE-2021-41613)** |
| --- | --- | --- | --- |
| **CNA-covered product?** | No | No | No |
| **Is this an existing CVE?** | No | No | No |
| **Vulnerability type** | CWE-1201: [Core and Compute Issues – (1201)](https://cwe.mitre.org/data/definitions/1201.html) | CWE-1198: [Privilege Separation and Access Control Issues – (1198)](https://cwe.mitre.org/data/definitions/1198.html) | CWE-1201: [Core and Compute Issues – (1201)](https://cwe.mitre.org/data/definitions/1201.html) |
| **Vendor of the product** | openRISC | openRISC | openRISC |
| **Affected product(s)/ code base** | mor1kx processor (<https://github.com/openrisc/mor1kx>).  From commit ID 95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e to commit ID 76ea4e8c3fd64e8c6d346ea391b8fd5c95b4f351 on master branch are affected. | mor1kx processor (<https://github.com/openrisc/mor1kx>).  From commit ID 95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e to commit ID e51654a40c49d0bc0ff30f1a8d8586c7dd443a08 on master branch are affected. | mor1kx processor (<https://github.com/openrisc/mor1kx>).  From commit ID 95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e to commit ID e51654a40c49d0bc0ff30f1a8d8586c7dd443a08  on master branch are affected. |
| **Has vendor confirmed or acknowledged the vulnerability?** | Yes | Yes | Yes |
| **Attack type** | Context-dependent | Local | Context-dependent |
| **Impact** | Data or control flow corruption | Escalation of Privileges | Data or control flow corruption |
| **Affected component(s)** | ALU of the processor | Privilege registers of the processor | Privilege registers of the processor |
| **Attack vector(s)** | Any software code using the carry flag value in its control or data path following the *subtract* instructions can be used as a source of corruption in execution. | The return from exception (rfe) instruction causes the processor to jump to the location stored in EPCR register and restores the privilege state of the processor with the value stored in Exception Status Register (ESR).  The attacker can set EPCR with the exploit code location while the processor privilege stored in ESR is machine mode and execute the rfe instruction.  This can cause privilege escalation and execution of attacker exploit code in the machine mode. | EEAR stores the effective address (EA) of the instruction that caused an exception. Any exception handling routine that writes to EEAR will be ineffective as the data cannot be written to EEAR. |
| **Suggested description of the vulnerability for use in the CVE** | An issue was discovered in the ALU unit of the mor1kx processor. The carry flag is not being updated correctly for the subtract instruction, which results in an incorrect value of the carry flag. Any software that relies on this flag may experience corruption in execution. | An issue was discovered in the controller unit of the mor1kx processor. The read/write access permissions to the Exception Program Counter Register (EPCR) are not implemented correctly. User programs from unauthorized privilege level can make read/write accesses to EPCR. | An issue was discovered in the controller unit of the mor1kx processor. The write logic of Exception Effective Address Register (EEAR) is not implemented correctly. User programs with authorized privilege level will be unable to write to EEAR. |
| **Github issue** | [**https://github.com/openrisc/mor1kx/issues/139**](https://github.com/openrisc/mor1kx/issues/139) | [**https://github.com/openrisc/mor1kx/issues/140**](https://github.com/openrisc/mor1kx/issues/140) | [**https://github.com/openrisc/mor1kx/issues/141**](https://github.com/openrisc/mor1kx/issues/141) |
| **Additional information** | **Location:**  mor1kx\_execute\_alu.v (<https://github.com/openrisc/mor1kx/blob/master/rtl/verilog/mor1kx_execute_alu.v>). **Triggering input:**  //set r1=00020000 and r3=00002000  l.sub    r4,r1,r3  **Expected output:**  Carry flag = 0  **mor1kx output:**  Carry flag = 1 | **Location:**  mor1kx\_ctrl\_cappuccino.v (<https://github.com/openrisc/mor1kx/blob/master/rtl/verilog/mor1kx_ctrl_cappuccino.v>). **Details:** The OpenRISC specification requires that the EPCR register be accessible only from supervisor mode.  **Triggering input:**  #include <stdio.h>  int main() {  // enter user mode :  asm volatile ( “l.ori r17,r0,0x0000  “);  asm volatile ( “l.mtspr r0,r17,0x3806”);  asm volatile ( “l.mfspr r17,r0,0x11  “);  asm volatile ( “l.andi r17,r17,-2    “);  asm volatile ( “l.mtspr r0,r17,0x11  “);  // padding the seed code  asm volatile( “l.nop 0x0 “);  asm volatile( “l.nop 0x0 “);  asm volatile( “l.nop 0x0 “);  asm volatile( “l.nop 0x0 “);  asm volatile (“l.addi r1,r0,1”);  asm volatile (“l.mfspr r2,r0,32”);  asm volatile (“l.mtspr r0, r1, 32”);  return 0;  }  The or1ksim fails to execute the *mfspr* while the mor1kx implementation can successfully write into EPCR using the *mtspr* instruction. | **Location:**  mor1kx\_ctrl\_cappuccino.v (<https://github.com/openrisc/mor1kx/blob/master/rtl/verilog/mor1kx_ctrl_cappuccino.v>), line 830 to 840. **Details:** The OpenRISC specification requires that the EEAR register be accessible from the supervisor mode but the mor1kx implementation does not have the option to write to EEAR with the *mtspr* instruction even from the supervisor mode. |

| **Fields** | **B9 (CVE-2021-40506)** | **B10 (CVE-2021-40507)** |
| --- | --- | --- |
| **CNA-covered product?** | No | No |
| **Is this an existing CVE?** | No | No |
| **Vulnerability type** | CWE-1201: [Core and Compute Issues – (1201)](https://cwe.mitre.org/data/definitions/1201.html) | CWE-1201: [Core and Compute Issues – (1201)](https://cwe.mitre.org/data/definitions/1201.html) |
| **Vendor of the product** | openRISC | openRISC |
| **Affected product(s)/ code base** | OR1200 processor | OR1200 processor |
| **Has vendor confirmed or acknowledged the vulnerability?** | Yes | Yes |
| **Attack type (Context-dependent/local/physical/remote/other)** | Context-dependent | Context-dependent |
| **Impact (Code execution/Information disclosure/Denial of Service/other/escalation of privileges)** | Other (Data or control flow corruption) | Other (Data or control flow corruption) |
| **Affected component(s)** | ALU of the processor | ALU of the processor |
| **Attack vector(s)** | Any software code using the overflow flag value in its control or data path following the *msb* or *mac* instructions can be used as a source of corruption in execution. | Any software code using the overflow flag value in its control or data path following the *subtract* instruction can be used as a source of corruption in execution. |
| **Suggested description of the vulnerability for use in the CVE** | An issue was discovered in the ALU unit of the OR1200 processor. The overflow flag is not being updated for the *msb* and *mac* instructions which results in an incorrect value in the overflow flag. | An issue was discovered in the ALU unit of the OR1200 processor. The overflow flag is not being updated correctly for the *subtract* instruction which results in an incorrect value in the overflow flag. |
| **Additional information** | **Location:**  or1200\_alu.v (<https://github.com/openrisc/or1200/blob/master/rtl/verilog/or1200_alu.v>), line 357 to 376**Details:** It can be seen in the *always* block that the overflow bit is only updated for the *add* and *sub* instructions. **Triggering input:**l.add r1, r0, r0l.add r2, r0, r0l.macrc r3l.div r4, r1, r2l.msb   r1, r2**Expected output:** MACHI = 0  MACLO = 0  r1 = 0  r2 = 0  Overflow = 0  **or1200 output:**  MACHI = 0  MACLO = 0  r1 = 0  r2 = 0  Overflow = 1 | **Location:**  or1200\_alu.v (<https://github.com/openrisc/or1200/blob/master/rtl/verilog/or1200_alu.v>), line 171 to 178 **Details:** The logic used to compute the overflow flag is incorrect for certain values of operands of the *subtract* instructions.  **Triggering input:**  l.add r1, r0, r0  l.addi r2, r0, 0x47d4  l.sub r3, r1, r2  **Expected output:**  r1 = 0  r2 = 0x47d4  r3 = 0xffffb82c  Overflow = 0  **or1200 output:**  r1 = 0  r2 = 0x47d4  r3 = 0xffffb82c  Overflow = 1 |

© 2016–2025 Secure and Trustworthy Hardware (SETH) Lab [Log in](https://seth.engr.tamu.edu/wp-login.php)

[![Texas A&M Engineering Experiment Station Logo](https://seth.engr.tamu.edu/wp-content/plugins/coe-content-model/inc/../images/logos/tees/tees_logo_primary_wht.png)](http://tees.tamu.edu)

* [TAMU ECE](https://engineering.tamu.edu/electrical/index.html)

* [State of Texas](https://www.texas.gov/)
* [Open Records](https://orec.tamu.edu/open-records/)
* [Risk, Fraud & Misconduct Hotline](https://secure.ethicspoint.com/domain/en/report_custom.asp?clientid=19681)
* [Statewide Search](https://www.tsl.state.tx.us/trail/)
* [Site Links & Policies](https://engineering.tamu.edu/policies.html)
* [Accommodations](https://tees.tamu.edu/engr-hr/workplace-notices/americans-with-disabilities-act-ada-as-amended.html)
* [Environmental Health, Safety & Security](https://ehs.tamu.edu)
* [Employment](https://engineering.tamu.edu/career/index.html)



=== Content from github.com_3f3a81db_20250114_220335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenrisc%2Fmor1kx%2Fissues%2F139)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenrisc%2Fmor1kx%2Fissues%2F139)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=openrisc%2Fmor1kx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openrisc](/openrisc)
/
**[mor1kx](/openrisc/mor1kx)**
Public

* [Notifications](/login?return_to=%2Fopenrisc%2Fmor1kx) You must be signed in to change notification settings
* [Fork
  146](/login?return_to=%2Fopenrisc%2Fmor1kx)
* [Star
   510](/login?return_to=%2Fopenrisc%2Fmor1kx)

* [Code](/openrisc/mor1kx)
* [Issues
  30](/openrisc/mor1kx/issues)
* [Pull requests
  5](/openrisc/mor1kx/pulls)
* [Actions](/openrisc/mor1kx/actions)
* [Projects
  0](/openrisc/mor1kx/projects)
* [Wiki](/openrisc/mor1kx/wiki)
* [Security](/openrisc/mor1kx/security)
* [Insights](/openrisc/mor1kx/pulse)

Additional navigation options

* [Code](/openrisc/mor1kx)
* [Issues](/openrisc/mor1kx/issues)
* [Pull requests](/openrisc/mor1kx/pulls)
* [Actions](/openrisc/mor1kx/actions)
* [Projects](/openrisc/mor1kx/projects)
* [Wiki](/openrisc/mor1kx/wiki)
* [Security](/openrisc/mor1kx/security)
* [Insights](/openrisc/mor1kx/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenrisc%2Fmor1kx%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenrisc%2Fmor1kx%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# The carry flag implementation is not correct for subtract instructions #139

Open

[Rahul-Kande](/Rahul-Kande) opened this issue
Sep 3, 2021
· 2 comments

Open

# [The carry flag implementation is not correct for subtract instructions](#top) #139

[Rahul-Kande](/Rahul-Kande) opened this issue
Sep 3, 2021
· 2 comments

## Comments

[![@Rahul-Kande](https://avatars.githubusercontent.com/u/43255770?s=80&v=4)](/Rahul-Kande)

Copy link

### **[Rahul-Kande](/Rahul-Kande)** commented [Sep 3, 2021](#issue-987686363) • edited Loading

| The carry flag value is not as expected for some cases. For instance, with the following trigger input, since r1 > r3, carry flag should be reset, but it is actually being set.  Issue location: rtl/verilog/mor1kx\_execute\_alu.v  Triggering input: //set r1=00020000 and r3=00002000 l.sub r4,r1,r3 Expected output: Carry flag = 0  mor1kx output: Carry flag = 1  Please check this bug. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@rkrajnc](https://avatars.githubusercontent.com/u/941597?s=80&v=4)](/rkrajnc)

Copy link

### **[rkrajnc](/rkrajnc)** commented [Sep 6, 2021](#issuecomment-913504083)

| I can't test this right now, so I'm just guessing, but it seems the problem might be operator precedence in this line:   [mor1kx/rtl/verilog/mor1kx\_execute\_alu.v](https://github.com/openrisc/mor1kx/blob/95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e/rtl/verilog/mor1kx_execute_alu.v#L205)  Line 205 in [95eee05](/openrisc/mor1kx/commit/95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e)   |  | assign carry\_in = adder\_do\_sub\_i | adder\_do\_carry\_i & carry\_i; | | --- | --- |      Besides, shouldn't the statement be using logical operators instead of bitwise? |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@skristiansson](https://avatars.githubusercontent.com/u/1028784?s=80&v=4)](/skristiansson)

Copy link

Member

### **[skristiansson](/skristiansson)** commented [Sep 6, 2021](#issuecomment-913581564) via email

| I can't test this right now, so I'm just guessing, but it seems the problem might be operator precedence in this line:  <https://github.com/openrisc/mor1kx/blob/95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e/rtl/verilog/mor1kx_execute_alu.v#L205> No, the precedence is correct, for subtraction you want to do the (2 complement) calculation: a - b => a + ~b + 1 carry\_in is used as the '1', thus it always need to be set for subtraction.  Besides, shouldn't the statement be using logical operators instead of bitwise? They are all 1-bit signals, so bitwise and logical obtain the same result. … On Mon, Sep 6, 2021 at 12:40 PM Rok Krajnc \*\*\*@\*\*\*.\*\*\*> wrote: I can't test this right now, so I'm just guessing, but it seems the problem might be operator precedence in this line: <https://github.com/openrisc/mor1kx/blob/95eee0596a160ffdfd8ee6bc8b88268b2e49ec5e/rtl/verilog/mor1kx_execute_alu.v#L205> Besides, shouldn't the statement be using logical operators instead of bitwise? — You are receiving this because you are subscribed to this thread. Reply to this email directly, view it on GitHub <[#139 (comment)](https://github.com/openrisc/mor1kx/issues/139#issuecomment-913504083)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AAH3FMB7MWLJZCPURMQXVTLUASEABANCNFSM5DLSM7CA>> . Triage notifications on the go with GitHub Mobile for iOS <<https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>> or Android <<https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>>. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenrisc%2Fmor1kx%2Fissues%2F139)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@rkrajnc](https://avatars.githubusercontent.com/u/941597?s=52&v=4)](/rkrajnc) [![@skristiansson](https://avatars.githubusercontent.com/u/1028784?s=52&v=4)](/skristiansson) [![@Rahul-Kande](https://avatars.githubusercontent.com/u/43255770?s=52&v=4)](/Rahul-Kande)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.usenix.org_1fe6c4c0_20250115_193235.html ===


 [usenix\_logo\_notag\_white](/)

* [Sign In](/user?destination=conference/usenixsecurity22/presentation/kande)
* [Conferences](/conferences)

 [![](https://www.usenix.org/sites/default/files/styles/neat_conference_menu_logo/public/sec22_wordmark_stacked_white_400x164_rev.png?itok=RqiBGb4U)](/conference/usenixsecurity22)

* [Attend](/conference/usenixsecurity22#registration)
  + [Registration Information](/conference/usenixsecurity22/registration-information)
  + [Registration Discounts](/conference/usenixsecurity22/registration-discounts)
  + [Terms and Conditions](/conference/usenixsecurity22/terms)
  + [Grant Opportunities](/conference/usenixsecurity22/grants)

  + [Venue, Hotel, and Travel](/conference/usenixsecurity22/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity22/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity22/technical-sessions)

  + [Summer Accepted Papers](/conference/usenixsecurity22/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity22/fall-accepted-papers)
  + [Winter Accepted Papers](/conference/usenixsecurity22/winter-accepted-papers)

  + [Activities](/conference/usenixsecurity22/activities)
  + [Poster Session and Happy Hour](/conference/usenixsecurity22/poster-session)
* [Participate](/conference/usenixsecurity22/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity22/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity22/submission-policies-and-instructions)

  + [Call for Artifacts](/conference/usenixsecurity22/call-for-artifacts)
  + [Artifact Appendix Guidelines](/conference/usenixsecurity22/artifact-appendix-guidelines)

  + [Instructions for Presenters](/conference/usenixsecurity22/instructions-presenters)
* [Sponsors](/conference/usenixsecurity22#sponsorship)
  + [Exhibitor Services](/conference/usenixsecurity22/exhibitor-services)
* [About](/conference/usenixsecurity22#marquee)
  + [Symposium Organizers](/conference/usenixsecurity22#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)

  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity22#questions)

# TheHuzz: Instruction Fuzzing of Processors Using Golden-Reference Models for Finding Software-Exploitable Vulnerabilities

Authors:

Rahul Kande, Addison Crump, and Garrett Persyn, *Texas A&M University;* Patrick Jauernig and Ahmad-Reza Sadeghi, *Technische Universität Darmstadt;* Aakash Tyagi and Jeyavijayan Rajendran, *Texas A&M University*

Abstract:

The increasing complexity of modern processors poses many challenges to existing hardware verification tools and methodologies for detecting security-critical bugs. Recent attacks on processors have shown the fatal consequences of uncovering and exploiting hardware vulnerabilities.

Fuzzing has emerged as a promising technique for detecting software vulnerabilities. Recently, a few hardware fuzzing techniques have been proposed. However, they suffer from several limitations, including non-applicability to commonly used hardware description languages (HDLs) like Verilog and VHDL, the need for significant human intervention, and inability to capture many intrinsic hardware behaviors, such as signal transitions and floating wires.

In this paper, we present the design and implementation of a novel hardware fuzzer, TheHuzz, that overcomes the aforementioned limitations and significantly improves the state of the art. We analyze the intrinsic behaviors of hardware designs in HDLs and then measure the coverage metrics that model such behaviors. TheHuzz generates assembly-level instructions to increase the desired coverage values, thereby finding many hardware bugs that are exploitable from software. We evaluate TheHuzz on four popular open-source processors and achieve 1.98× and 3.33× the speed compared to the industry-standard random regression approach and the state-of-the-art hardware fuzzer, DifuzzRTL, respectively. Using TheHuzz, we detected 11 bugs in these processors, including 8 new bugs, and we demonstrate exploits using the detected bugs. We also show that TheHuzz overcomes the limitations of formal verification tools from the semiconductor industry by comparing its findings to those discovered by the Cadence JasperGold tool.

## [Rahul Kande, Texas A&M University](/conference/usenixsecurity22/speaker-or-organizer/rahul-kande-texas-am-university)

## [Addison Crump, Texas A&M University](/conference/usenixsecurity22/speaker-or-organizer/addison-crump-texas-am-university)

## [Garrett Persyn, Texas A&M University](/conference/usenixsecurity22/speaker-or-organizer/garrett-persyn-texas-am-university)

## [Patrick Jauernig, Technische Universität Darmstadt](/conference/usenixsecurity22/speaker-or-organizer/patrick-jauernig-technische-universit%C3%A4t-darmstadt)

## [Ahmad-Reza Sadeghi, Technical University of Darmstadt](/conference/usenixsecurity22/speaker-or-organizer/ahmad-reza-sadeghi-technical-university-darmstadt)

## [Aakash Tyagi, Texas A&M University](/conference/usenixsecurity22/speaker-or-organizer/aakash-tyagi-texas-am-university)

## [Jeyavijayan Rajendran, Texas A&M University](/conference/usenixsecurity22/speaker-or-organizer/jeyavijayan-rajendran-texas-am-university-0)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

BibTeX@inproceedings {280028,

author = {Rahul Kande and Addison Crump and Garrett Persyn and Patrick Jauernig and Ahmad-Reza Sadeghi and Aakash Tyagi and Jeyavijayan Rajendran},

title = {{TheHuzz}: Instruction Fuzzing of Processors Using {Golden-Reference} Models for Finding {Software-Exploitable} Vulnerabilities},

booktitle = {31st USENIX Security Symposium (USENIX Security 22)},

year = {2022},

isbn = {978-1-939133-31-1},

address = {Boston, MA},

pages = {3219--3236},

url = {https://www.usenix.org/conference/usenixsecurity22/presentation/kande},

publisher = {USENIX Association},

month = aug

}

[Download](/biblio/export/bibtex/280028)![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Kande PDF](https://www.usenix.org/system/files/sec22-kande.pdf "sec22-kande.pdf")![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Kande Paper (Prepublication) PDF](https://www.usenix.org/system/files/sec22fall_kande.pdf "sec22fall_kande.pdf")![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-unlocked.png)[View the slides](https://www.usenix.org/system/files/sec22_slides-kande.pdf)
## Presentation Video

* [Attend](/conference/usenixsecurity22#registration)
  + [Registration Information](/conference/usenixsecurity22/registration-information)
  + [Registration Discounts](/conference/usenixsecurity22/registration-discounts)
  + [Terms and Conditions](/conference/usenixsecurity22/terms)
  + [Grant Opportunities](/conference/usenixsecurity22/grants)
  + [Venue, Hotel, and Travel](/conference/usenixsecurity22/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity22/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity22/technical-sessions)
  + [Summer Accepted Papers](/conference/usenixsecurity22/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity22/fall-accepted-papers)
  + [Winter Accepted Papers](/conference/usenixsecurity22/winter-accepted-papers)
  + [Activities](/conference/usenixsecurity22/activities)
  + [Poster Session and Happy Hour](/conference/usenixsecurity22/poster-session)
* [Participate](/conference/usenixsecurity22/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity22/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity22/submission-policies-and-instructions)
  + [Call for Artifacts](/conference/usenixsecurity22/call-for-artifacts)
  + [Artifact Appendix Guidelines](/conference/usenixsecurity22/artifact-appendix-guidelines)
  + [Instructions for Presenters](/conference/usenixsecurity22/instructions-presenters)
* [Sponsors](/conference/usenixsecurity22#sponsorship)
  + [Exhibitor Services](/conference/usenixsecurity22/exhibitor-services)
* [About](/conference/usenixsecurity22#marquee)
  + [Symposium Organizers](/conference/usenixsecurity22#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)
  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity22#questions)

[Twitter](http://twitter.com/usenixsecurity)[Facebook](https://www.facebook.com/USENIX-Security-Symposium-13544602263)[Youtube](http://www.youtube.com/user/USENIXAssociation)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)

© USENIX


