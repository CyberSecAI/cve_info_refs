=== Content from discuss.hashicorp.com_c849f189_20250115_083853.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-27 - Vault Merging Multiple Entity Aliases for the Same Mount May Allow Privilege Escalation](/t/hcsec-2021-27-vault-merging-multiple-entity-aliases-for-the-same-mount-may-allow-privilege-escalation/30420)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 7, 2021, 8:50pm

1

**Bulletin ID:** HCSEC-2021-27

**Affected Products / Versions:** Vault and Vault Enterprise through 1.7.4 and 1.8.3; fixed in 1.7.5 and 1.8.4.

**Publication Date:** October 7, 2021

**Summary**

A Vault or Vault Enterprise (“Vault”) user with write permission to an entity alias ID sharing a mount accessor with another user may acquire this other user’s policies by merging their identities. This vulnerability, CVE-2021-41802, was fixed in Vault and Vault Enterprise 1.7.5 and 1.8.4.

**Background**

Vault’s Identity secrets engine is the identity management solution for Vault. It has the concept of entities which may have aliases for each mount accessor they use. There is additional information regarding these entity and alias concepts in Vault’s [Identity Secrets Engine documentation](https://www.vaultproject.io/docs/secrets/identity), and the [Identity: Entities and Groups tutorial](https://learn.hashicorp.com/tutorials/vault/identity).

**Details**

An external party reported that it was possible for a single entity to end up with multiple entity aliases of the same name and mount. On internal investigation, it was observed that this behavior may be exploited by an authenticated user with specific write permissions to achieve escalation of privileges.

Renaming an alias requires write permission to the alias ID. In most configurations, this permission is reserved to privileged users who may otherwise be able to obtain these permissions.

Prior to versions 1.7.5 and 1.8.4, Vault would already provide a warning to users on merge (`identity: alias is already tied to a different entity; these entities are being merged`). As of 1.7.5 and 1.8.4, the alias rename operation will now fail if the resulting entity alias name and mount accessor combination exists.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault or Vault Enterprise 1.7.5 or 1.8.5. Please refer to [Upgrading Vault](https://www.vaultproject.io/docs/upgrading) for general guidance and version-specific upgrade notes.

As noted in Vault’s [Identity documentation](https://www.vaultproject.io/docs/secrets/identity#entity-policies), care should be taken when granting permissions to identity endpoints.

**Acknowledgement**

This issue was identified by [mdgreenfield](https://github.com/mdgreenfield) who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2022-18 - Vault Entity Alias Metadata May Leak Between Aliases With The Same Name Assigned To The Same Entity](https://discuss.hashicorp.com/t/hcsec-2022-18-vault-entity-alias-metadata-may-leak-between-aliases-with-the-same-name-assigned-to-the-same-entity/44550)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7720 | September 20, 2022 |
| [HCSEC-2021-30 - Vault's Templated ACL Policies Matched First-Created Alias Per Entity and Auth Backend](https://discuss.hashicorp.com/t/hcsec-2021-30-vaults-templated-acl-policies-matched-first-created-alias-per-entity-and-auth-backend/32132)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 1 | 8131 | January 6, 2022 |
| [HCSEC-2024-21 - Vault Operators in Root Namespace May Elevate Their Privileges](https://discuss.hashicorp.com/t/hcsec-2024-21-vault-operators-in-root-namespace-may-elevate-their-privileges/70565)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 2389 | October 10, 2024 |
| [HCSEC-2020-07 - Vault Enterprise Prefixed Mount Policies May Result In Unauthorized Namespace Access](https://discuss.hashicorp.com/t/hcsec-2020-07-vault-enterprise-prefixed-mount-policies-may-result-in-unauthorized-namespace-access/18090)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4117 | November 25, 2020 |
| [Vault write identity/entity-alias not actually adding the alias](https://discuss.hashicorp.com/t/vault-write-identity-entity-alias-not-actually-adding-the-alias/7998)  [Vault](/c/vault/30) | 6 | 1497 | September 18, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from security.gentoo.org_58090d82_20250115_083854.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# HashiCorp Vault: Multiple Vulnerabilities — GLSA **202207-01**

Multiple vulnerabilities have been discovered in HashiCorp Vault, the worst of which could result in denial of service.

### Affected packages

| Package | **app-admin/vault** on all architectures |
| --- | --- |
| Affected versions | < **1.10.3** |
| Unaffected versions | >= **1.10.3** |

### Background

HashiCorp Vault is a tool for managing secrets.

### Description

Multiple vulnerabilities have been discovered in HashiCorp Vault. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All HashiCorp Vault users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/vault-1.10.3"

```
### References

* [CVE-2020-25594](https://nvd.nist.gov/vuln/detail/CVE-2020-25594)
* [CVE-2021-27668](https://nvd.nist.gov/vuln/detail/CVE-2021-27668)
* [CVE-2021-3024](https://nvd.nist.gov/vuln/detail/CVE-2021-3024)
* [CVE-2021-3282](https://nvd.nist.gov/vuln/detail/CVE-2021-3282)
* [CVE-2021-32923](https://nvd.nist.gov/vuln/detail/CVE-2021-32923)
* [CVE-2021-37219](https://nvd.nist.gov/vuln/detail/CVE-2021-37219)
* [CVE-2021-38553](https://nvd.nist.gov/vuln/detail/CVE-2021-38553)
* [CVE-2021-38554](https://nvd.nist.gov/vuln/detail/CVE-2021-38554)
* [CVE-2021-41802](https://nvd.nist.gov/vuln/detail/CVE-2021-41802)
* [CVE-2021-43998](https://nvd.nist.gov/vuln/detail/CVE-2021-43998)
* [CVE-2021-45042](https://nvd.nist.gov/vuln/detail/CVE-2021-45042)
* [CVE-2022-25243](https://nvd.nist.gov/vuln/detail/CVE-2022-25243)
* [CVE-2022-30689](https://nvd.nist.gov/vuln/detail/CVE-2022-30689)

**Release date**

July 29, 2022

**Latest revision**

July 29, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [768312](https://bugs.gentoo.org/show_bug.cgi?id=768312)
* [797244](https://bugs.gentoo.org/show_bug.cgi?id=797244)
* [808093](https://bugs.gentoo.org/show_bug.cgi?id=808093)
* [817269](https://bugs.gentoo.org/show_bug.cgi?id=817269)
* [827945](https://bugs.gentoo.org/show_bug.cgi?id=827945)
* [829493](https://bugs.gentoo.org/show_bug.cgi?id=829493)
* [835070](https://bugs.gentoo.org/show_bug.cgi?id=835070)
* [845405](https://bugs.gentoo.org/show_bug.cgi?id=845405)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


