Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2021-41511:

**1. Root Cause of Vulnerability:**

*   The primary vulnerability lies in the Lodging Reservation Management System's login functionality, specifically within the `classes/Login.php` file.
*   The application fails to properly sanitize user inputs in the username and password fields before using them in SQL queries. This lack of input sanitization allows for SQL injection attacks.

**2. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The most prominent vulnerability is SQL injection. By injecting SQL code into the username and password fields, an attacker can manipulate the SQL query to bypass authentication.

**3. Impact of Exploitation:**

*   **Authentication Bypass:** The SQL injection vulnerability allows an attacker to bypass the login authentication and gain unauthorized access to the admin panel.
*   **Session Hijacking:**  A malicious user can store a malicious payload into the accommodations app and hijack the PHPSESSID, then use that to hijack a login session.

**4. Attack Vectors:**

*   **HTTP POST Request:** The vulnerability is exploited by sending a crafted HTTP POST request to the `classes/Login.php` endpoint.
*   **Manipulated Username/Password Fields:** The attack involves injecting SQL payload into the username and password parameters within the POST request body.

**5. Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the vulnerable application server.
*   **HTTP Request Manipulation:** Ability to craft and send HTTP POST requests with malicious SQL payloads.
*   **Basic Understanding of SQL:**  The attacker needs basic knowledge of SQL to craft the injection payloads.

**Technical Details:**
* The vulnerable code uses unsanitized user input within a SQL query.
* The injection payload `' OR 1 -- -` in both username and password fields results in a SQL query that always evaluates to true, bypassing authentication.
*  A malicious user can also store a malicious payload into the accommodations app and hijack the `PHPSESSID`, then he can use to hijack a login session.

**Additional Notes:**
* The vulnerability exists in version 1.0 of the Lodging Reservation Management System.
* The application was developed using PHP, MySQL, HTML, CSS, JavaScript and Bootstrap
* The exploit has been successfully tested on a Windows 10 environment using XAMPP server.
* The provided proof-of-concept (PoC) demonstrates how an attacker can gain administrative access.