- **Root cause of vulnerability**: The application does not properly sanitize the filename of uploaded images when editing a blog post. Specifically, it does not prevent the inclusion of HTML attributes like `onerror`.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: Arbitrary JavaScript code execution in the context of a user's browser when they visit the blog page. This could lead to session hijacking, defacement, or other malicious actions.
- **Attack vectors**: An attacker uploads an image, publishes a blog post including the image. Later they edit the blog post, intercept the request with a tool like Burp Suite, modify the image filename in the request to include a malicious `onerror` attribute like `onerror="alert(/xss/)"`, and then save the changes.
- **Required attacker capabilities/position**: The attacker must have the ability to upload images and create/edit blog posts. The attacker needs the ability to intercept and modify the requests before they reach the server (e.g. using Burp Suite).