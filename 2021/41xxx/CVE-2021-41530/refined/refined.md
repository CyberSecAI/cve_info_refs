- **Root cause of vulnerability:** The vulnerability stems from the NGFW Engine's behavior when configured to block URLs with a user response. It sends an HTML response even without completing a full TCP handshake if a URL request payload is included in the initial TCP SYN packet, or via a SYN followed by a PSH+ACK packet containing the HTTP request.
- **Weaknesses/vulnerabilities present:** The primary weakness is the firewall's premature response to a TCP SYN packet (or a SYN followed by PSH+ACK) containing an HTTP request, before a full TCP handshake is completed. This allows the firewall to be used as a reflector. Additionally, the size difference between the request and response allows for amplification.
- **Impact of exploitation:** An attacker can send spoofed TCP SYN packets (or SYN+PSH+ACK) containing a URL request payload to the vulnerable NGFW Engine. The engine will then respond with a larger HTML response to the spoofed IP address, resulting in a reflected amplification attack. This could lead to a denial-of-service attack.
- **Attack vectors:** The attack vector is sending a crafted TCP SYN packet (or SYN followed by PSH+ACK) containing an HTTP request to a vulnerable NGFW engine that is configured with HTTP User Response.
- **Required attacker capabilities/position:** The attacker needs to be able to send spoofed packets to a vulnerable NGFW Engine that has user response configured for blocked URLs. To be effective against targets on the internet, the firewall itself must be configured to send HTTP user responses for requests coming from the internet.