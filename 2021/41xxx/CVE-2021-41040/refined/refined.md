```
{
  "CVE-2021-41040": {
    "RELATED": true,
    "extracted_data": {
      "root_cause": "The `coap_parse_message()` function in `er-coap-13.c` lacks proper bounds checking on the input `data_len`. When `data_len` is less than `COAP_HEADER_LEN`, the function attempts to read fields outside of the provided data buffer.",
      "weaknesses": [
        "Out-of-bounds read",
         "Null pointer dereference"
      ],
      "impact": "A malformed, short CoAP packet with a specific code (COAP_413_ENTITY_TOO_LARGE) and type (COAP_TYPE_ACK) can cause a denial-of-service (DoS) through a segmentation fault. This occurs when the `lwm2m_handle_packet` function attempts to access memory using a null pointer returned by `prv_get_transaction` due to an out-of-bounds read of the `mid` field.",
      "attack_vectors": "Sending a specially crafted CoAP packet with a length less than `COAP_HEADER_LEN` to a vulnerable `lwm2mserver` instance.",
      "required_attacker_capabilities": "The attacker needs the ability to send UDP packets to a machine running a vulnerable wakaama server. No authentication is needed."
    },
    "additional_information": {
      "fuzzing_discovered": "The vulnerability was initially discovered through fuzzing and the fix included a test case derived from the fuzzing input.",
      "additional_oob_write": "An additional out-of-bounds write vulnerability was found in the `SET_OPTION` macro due to a classic off-by-one error, which was also fixed.",
      "fix_details": "The fix involves checking the `data_len` against `COAP_HEADER_LEN` before attempting to parse the CoAP header. The fix also addresses other memory safety issues within the `coap_parse_message()` function and the off-by-one error.",
       "cve_assignment": "The CVE-2021-41040 was assigned after it was determined that the project was vulnerable and a fix was available.",
        "affected_versions": "Version 1.0 of Eclipse Wakaama is affected by the vulnerability. There was no explicit maintenance release for 1.0. Users were requested to update to the latest version in master"
    }
  }
}
```