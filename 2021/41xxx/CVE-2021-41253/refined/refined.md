```
{
  "vulnerability": {
    "root_cause": "Older versions of Zydis failed to properly initialize the string object within the formatter buffer, specifically some fields within the string's vector were not initialized, leading to incorrect calculations by `ZyanStringAppend` for new target size.",
    "weaknesses": [
      "CWE-122",
      "CWE-457"
    ],
    "impact": "Heap buffer overflows could occur if untrusted user data is appended to the formatter buffer using zycore string functions within custom formatter hooks, potentially leading to memory corruption.",
    "attack_vectors": "Exploitation occurs through the use of custom formatter hooks by Zydis users. Specifically, when appending untrusted data to the formatter buffer using the string functions within zycore, this can cause a heap buffer overflow.",
    "required_capabilities": "An attacker would need to be a user of the Zydis library that implements custom formatter hooks which use the vulnerable zycore string functions to append data to the formatter buffer. The attacker would also need to control the untrusted user data being appended."
  },
  "fixes": [
    "The issue was addressed by initializing the missing fields of the string object within the formatter buffer.",
    "The fix was backported to the v3 branch and the first tagged version containing this fix is v3.2.1."
  ],
    "details": "The vulnerability is triggered in custom formatter hooks that use string functions provided in `zycore`, not in the standard Zydis formatter. The incorrect initialization led to `ZyanStringAppend` making incorrect size calculations, leading to the heap buffer overflow. The commit `55dd08c210722aed81b38132f5fd4a04ec1943b5` fixes the initialization."
}
```