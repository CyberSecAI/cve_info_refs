```
{
  "vulnerability_details": {
    "root_cause": "The OCI Distribution Specification prior to version 1.0.1 used only the Content-Type header to determine the document type during push and pull operations. This could lead to type confusion when a JSON document could be interpreted as either an image-index or a manifest based solely on the Content-Type header, potentially resulting in inconsistent handling of the same digest.",
    "weaknesses": [
      "The reliance on the `Content-Type` header alone for determining the type of document and the absence of mandatory `mediaType` validation within the manifest."
    ],
    "impact": "A client could interpret the same content differently based on changes to the `Content-Type` header between pulls. This can result in unexpected behavior or vulnerabilities due to mishandling of container image manifests and indices.",
    "attack_vectors": [
      "A malicious registry could manipulate the Content-Type header of a stored manifest, causing clients to interpret it incorrectly.",
      "Man-in-the-middle attacks could alter the Content-Type header between a registry and a client."
   ],
    "attacker_capabilities": "An attacker capable of manipulating the registry's responses or performing a man-in-the-middle attack between the registry and the client is required."
  },
    "additional_notes": "The vulnerability is mitigated by the introduction of mandatory `mediaType` validation. Clients are recommended to distrust the `Content-Type` header, and software attempting to deserialize ambiguous documents containing both `manifests` and `layers` or `manifests` and `config` fields should reject them. The fix requires updates to the OCI distribution specification and client software. The advisory also notes that the `mediaType` field in the manifest or index should match the Content-Type header used during push and pull."
}
```