Based on the provided content, here's the breakdown of CVE-2021-41791:

**Root Cause of Vulnerability:**
The root cause of the vulnerability was an evasion in the XSS prevention filter used to validate HTML input coming from the client's browser in Alfresco Share.

**Weaknesses/Vulnerabilities Present:**
The primary weakness was the insufficient sanitization of user-supplied HTML input, which allowed for an evasion of the existing XSS prevention filter. This means the filter failed to properly neutralize malicious HTML code.

**Impact of Exploitation:**
Successful exploitation of this vulnerability could lead to Cross-Site Scripting (XSS) attacks. An attacker could inject malicious scripts into web pages viewed by other users. This could lead to various malicious actions such as:
    * Stealing user session cookies
    * Redirecting users to malicious websites
    * Displaying misleading or harmful content
    * Performing actions on behalf of the victim user

**Attack Vectors:**
The attack vector is through the manipulation of HTML input fields within the Alfresco Share application. An attacker crafts a malicious HTML payload that bypasses the existing XSS filter. When the crafted HTML is rendered in the browser, the malicious scripts are executed within the user's session.

**Required Attacker Capabilities/Position:**
An attacker needs to be able to submit HTML content through the Alfresco application. This likely means the attacker needs:
    * An account with privileges to input HTML data
    * Ability to craft malicious HTML payloads capable of evading the filter
    * Knowledge of application input points

**Additional Information:**
*   The vulnerability was addressed by replacing the vulnerable filter with the OWASP Java HTML Sanitizer library.
*   The vulnerability was discovered during security testing by Jack Misiura and Stefano Lanaro from The Missing Link Australia.
*   There is no evidence that the vulnerability was exploited in a production environment prior to the fix.

**Affected Versions:**
The following Alfresco Share versions were affected:
*   org.alfresco:share - versions from (including) 5.0.x.x up to (including) 5.2.7.11
*   org.alfresco:share - versions from (including) 6.0.x.x up to (including) 6.2.2.4
*   org.alfresco:community-share - prior to (including) 7.0
*   org.alfresco:share - versions from (including) 6.1.x.x up to (including) 6.1.1.2
*   org.alfresco:share -versions from (including) 6.0.x.x up to (including) 6.0.1.2
*   org.alfresco:share - versions 7.0.1 , 7.0.0.2 , 7.0.0.1 , 7.0