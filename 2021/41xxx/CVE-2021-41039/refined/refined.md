```
{
  "vulnerability": {
    "CVE": "CVE-2021-41039",
    "description": "An MQTT v5 client connecting with a large number of user-property properties could cause excessive CPU usage, leading to a loss of performance and possible denial of service.",
    "root_cause": "The vulnerability stems from inefficient handling of user properties within MQTT v5 CONNECT packets. The mosquitto broker parses and stores these properties in a linked list. When checking for the uniqueness of properties, the broker iterates through this linked list with O(n^2) complexity.",
    "weaknesses": [
      "Inefficient algorithm for checking duplicate user properties leading to quadratic time complexity.",
      "Lack of input validation or limits on the number of user properties allowed in a CONNECT packet."
    ],
    "impact": "A malicious client can send a crafted MQTT v5 CONNECT packet containing a large number of user properties, leading to excessive CPU usage on the broker. This can result in performance degradation and potentially a denial-of-service (DoS) attack, making the broker unresponsive.",
    "attack_vectors": "The attack vector is through the MQTT protocol using a crafted CONNECT packet.",
    "attacker_capabilities": "An attacker needs to be able to establish a connection with the MQTT broker and send MQTT packets. No special privileges are needed beyond the ability to connect to the broker."
  }
}
```