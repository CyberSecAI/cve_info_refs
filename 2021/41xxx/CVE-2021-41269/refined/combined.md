=== Content from github.com_a3071edc_20250114_191152.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fd6707503ec2f20947f79e38f861dba93b39df9da)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fd6707503ec2f20947f79e38f861dba93b39df9da)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jmrozanec%2Fcron-utils)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jmrozanec](/jmrozanec)
/
**[cron-utils](/jmrozanec/cron-utils)**
Public

* [Notifications](/login?return_to=%2Fjmrozanec%2Fcron-utils) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Fjmrozanec%2Fcron-utils)
* [Star
   1.2k](/login?return_to=%2Fjmrozanec%2Fcron-utils)

* [Code](/jmrozanec/cron-utils)
* [Issues
  30](/jmrozanec/cron-utils/issues)
* [Pull requests
  19](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects
  0](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

Additional navigation options

* [Code](/jmrozanec/cron-utils)
* [Issues](/jmrozanec/cron-utils/issues)
* [Pull requests](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

## Commit

[Permalink](/jmrozanec/cron-utils/commit/d6707503ec2f20947f79e38f861dba93b39df9da)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#493](https://github.com/jmrozanec/cron-utils/pull/493) from pwntester/patch-1

[Browse files](/jmrozanec/cron-utils/tree/d6707503ec2f20947f79e38f861dba93b39df9da)
Browse the repository at this point in the history

```
Prevent arbitrary EL expression evaluation
```

* Loading branch information

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)

[jmrozanec](/jmrozanec/cron-utils/commits?author=jmrozanec "View all commits by jmrozanec")
authored
Oct 30, 2021

2 parents
[6f91560](/jmrozanec/cron-utils/commit/6f91560a98406c8459a4c7903e10e805fa7c00e4)
+
[d7c6e3c](/jmrozanec/cron-utils/commit/d7c6e3cd8c8c7732330b00c01fc881845b4a6fbe)

commit d670750

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/main/java/com/cronutils/validation/CronValidator.java](#diff-ae10449d7b5de0a7d17ee48cfd1be5e1a444f0e85be939d61de1be1589c4f065 "src/main/java/com/cronutils/validation/CronValidator.java")

Show comments

[View file](/jmrozanec/cron-utils/blob/d6707503ec2f20947f79e38f861dba93b39df9da/src/main/java/com/cronutils/validation/CronValidator.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,7 +30,7 @@ public boolean isValid(String value, ConstraintValidatorContext context) { |
|  |  | return true; |
|  |  | } catch (IllegalArgumentException e) { |
|  |  | context.disableDefaultConstraintViolation(); |
|  |  | context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation(); |
|  |  | context.buildConstraintViolationWithTemplate("Error parsing the Cron expression").addConstraintViolation(); |
|  |  | return false; |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d670750`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fd6707503ec2f20947f79e38f861dba93b39df9da) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b2a3e489_20250114_191155.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fsecurity%2Fadvisories%2FGHSA-p9m8-27x8-rg87)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fsecurity%2Fadvisories%2FGHSA-p9m8-27x8-rg87)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=jmrozanec%2Fcron-utils)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jmrozanec](/jmrozanec)
/
**[cron-utils](/jmrozanec/cron-utils)**
Public

* [Notifications](/login?return_to=%2Fjmrozanec%2Fcron-utils) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Fjmrozanec%2Fcron-utils)
* [Star
   1.2k](/login?return_to=%2Fjmrozanec%2Fcron-utils)

* [Code](/jmrozanec/cron-utils)
* [Issues
  30](/jmrozanec/cron-utils/issues)
* [Pull requests
  19](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects
  0](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

Additional navigation options

* [Code](/jmrozanec/cron-utils)
* [Issues](/jmrozanec/cron-utils/issues)
* [Pull requests](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

# Critical vulnerability found in cron-utils

Critical

[jmrozanec](/jmrozanec)
published
GHSA-p9m8-27x8-rg87
Nov 15, 2021

## Package

maven

com.cronutils.cron-utils
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<9.1.6

## Patched versions

9.1.6

## Description

### Impact

A Template Injection was identified in cron-utils enabling attackers to inject arbitrary Java EL expressions, leading to unauthenticated Remote Code Execution (RCE) vulnerability. Versions up to 9.1.2 are susceptible to this vulnerability. Please note, that only projects using the [@Cron](https://github.com/Cron) annotation to validate untrusted Cron expressions are affected.

### Patches

The issue was patched and a new version was released. Please upgrade to version 9.1.6.

### Workarounds

There are no known workarounds up to this moment.

### References

A description of the issue is provided in [issue 461](https://github.com/jmrozanec/cron-utils/issues/461)

### For more information

If you have any questions or comments about this advisory:

Open an issue in the [cron-utils Github repository](https://github.com/jmrozanec/cron-utils)

### Severity

Critical

### CVE ID

CVE-2021-41269

### Weaknesses

No CWEs

### Credits

* [![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=40&v=4)](/NielsDoucet)
  [NielsDoucet](/NielsDoucet)
  Analyst
* [![@pwntester](https://avatars.githubusercontent.com/u/125701?s=40&v=4)](/pwntester)
  [pwntester](/pwntester)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a703b52e_20250114_191151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fcfd2880f80e62ea74b92fa83474c2aabdb9899da)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fcfd2880f80e62ea74b92fa83474c2aabdb9899da)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jmrozanec%2Fcron-utils)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jmrozanec](/jmrozanec)
/
**[cron-utils](/jmrozanec/cron-utils)**
Public

* [Notifications](/login?return_to=%2Fjmrozanec%2Fcron-utils) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Fjmrozanec%2Fcron-utils)
* [Star
   1.2k](/login?return_to=%2Fjmrozanec%2Fcron-utils)

* [Code](/jmrozanec/cron-utils)
* [Issues
  30](/jmrozanec/cron-utils/issues)
* [Pull requests
  19](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects
  0](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

Additional navigation options

* [Code](/jmrozanec/cron-utils)
* [Issues](/jmrozanec/cron-utils/issues)
* [Pull requests](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

## Commit

[Permalink](/jmrozanec/cron-utils/commit/cfd2880f80e62ea74b92fa83474c2aabdb9899da)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#494](https://github.com/jmrozanec/cron-utils/pull/494) from NielsDoucet/RCE-fix

[Browse files](/jmrozanec/cron-utils/tree/cfd2880f80e62ea74b92fa83474c2aabdb9899da)
Browse the repository at this point in the history

```
Resolve RCE vulnerability.
```

* Loading branch information

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)

[jmrozanec](/jmrozanec/cron-utils/commits?author=jmrozanec "View all commits by jmrozanec")
authored
Oct 30, 2021

2 parents
[d670750](/jmrozanec/cron-utils/commit/d6707503ec2f20947f79e38f861dba93b39df9da)
+
[9c93c17](/jmrozanec/cron-utils/commit/9c93c17b8107e58073443a045e22274467b88aae)

commit cfd2880

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**18 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/com/cronutils/parser

    - src/main/java/com/cronutils/parser/CronParser.java
      [CronParser.java](#diff-76d3e2e0c6f7e1c648130a178cab35d7d4ef6dd6b15863ce11e87b10f4c0428f)
  + test/java/com/cronutils

    - src/test/java/com/cronutils/Issue418Test.java
      [Issue418Test.java](#diff-cea0a8944a82b21627bf6a14fb7342a84b762124748dd5f98b9ee785b576f8be)
    - parser

      * src/test/java/com/cronutils/parser/CronParserQuartzIntegrationTest.java
        [CronParserQuartzIntegrationTest.java](#diff-e31694aadebd28e5e2a2ae6d596adb3caf638d9685a25153fcd4c5a479e9e4d9)
    - validation

      * src/test/java/com/cronutils/validation/CronValidatorTest.java
        [CronValidatorTest.java](#diff-8eadd06e5d363ee4f2e3b78f8960285826906458e6d22c9ab7bf3b38fc123f05)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/main/java/com/cronutils/parser/CronParser.java](#diff-76d3e2e0c6f7e1c648130a178cab35d7d4ef6dd6b15863ce11e87b10f4c0428f "src/main/java/com/cronutils/parser/CronParser.java")

Show comments

[View file](/jmrozanec/cron-utils/blob/cfd2880f80e62ea74b92fa83474c2aabdb9899da/src/main/java/com/cronutils/parser/CronParser.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -128,7 +128,7 @@ public Cron parse(final String expression) { |
|  |  | } |
|  |  | return new SingleCron(cronDefinition, results).validate(); |
|  |  | } catch (final IllegalArgumentException e) { |
|  |  | throw new IllegalArgumentException(String.format("Failed to parse '%s'. %s", expression, e.getMessage()), e); |
|  |  | throw new IllegalArgumentException(String.format("Failed to parse cron expression. %s", e.getMessage()), e); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

9 changes: 5 additions & 4 deletions

9
[src/test/java/com/cronutils/Issue418Test.java](#diff-cea0a8944a82b21627bf6a14fb7342a84b762124748dd5f98b9ee785b576f8be "src/test/java/com/cronutils/Issue418Test.java")

Show comments

[View file](/jmrozanec/cron-utils/blob/cfd2880f80e62ea74b92fa83474c2aabdb9899da/src/test/java/com/cronutils/Issue418Test.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | import com.cronutils.model.definition.CronDefinitionBuilder; |
|  |  | import com.cronutils.model.time.ExecutionTime; |
|  |  | import com.cronutils.parser.CronParser; |
|  |  | import org.hamcrest.core.StringEndsWith; |
|  |  | import org.junit.Test; |
|  |  |  |
|  |  | import java.time.LocalDate; |
| Expand All | | @@ -13,8 +14,8 @@ |
|  |  | import java.time.ZonedDateTime; |
|  |  | import java.util.Optional; |
|  |  |  |
|  |  | import static org.junit.Assert.assertEquals; |
|  |  | import static org.junit.Assert.fail; |
|  |  | import static org.hamcrest.core.StringEndsWith.endsWith; |
|  |  | import static org.junit.Assert.\*; |
|  |  |  |
|  |  | public class Issue418Test { |
|  |  |  |
| Expand Down  Expand Up | | @@ -59,7 +60,7 @@ public void testInvalidWeekDayStart() { |
|  |  | parser.parse("0 0 2 ? \* 0/7 \*"); |
|  |  | fail("Expected exception for invalid expression"); |
|  |  | } catch (IllegalArgumentException expected) { |
|  |  | assertEquals("Failed to parse '0 0 2 ? \* 0/7 \*'. Value 0 not in range [1, 7]", expected.getMessage()); |
|  |  | assertThat(expected.getMessage(), endsWith("Value 0 not in range [1, 7]")); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -71,7 +72,7 @@ public void testInvalidWeekDayEnd() { |
|  |  | parser.parse("0 0 2 ? \* 1/8 \*"); |
|  |  | fail("Expected exception for invalid expression"); |
|  |  | } catch (IllegalArgumentException expected) { |
|  |  | assertEquals("Failed to parse '0 0 2 ? \* 1/8 \*'. Period 8 not in range [1, 7]", expected.getMessage()); |
|  |  | assertThat(expected.getMessage(), endsWith("Period 8 not in range [1, 7]")); |
|  |  | } |
|  |  | } |
|  |  | } |

7 changes: 4 additions & 3 deletions

7
[src/test/java/com/cronutils/parser/CronParserQuartzIntegrationTest.java](#diff-e31694aadebd28e5e2a2ae6d596adb3caf638d9685a25153fcd4c5a479e9e4d9 "src/test/java/com/cronutils/parser/CronParserQuartzIntegrationTest.java")

Show comments

[View file](/jmrozanec/cron-utils/blob/cfd2880f80e62ea74b92fa83474c2aabdb9899da/src/test/java/com/cronutils/parser/CronParserQuartzIntegrationTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,16 +20,19 @@ |
|  |  | import com.cronutils.model.definition.CronDefinitionBuilder; |
|  |  | import com.cronutils.model.field.expression.FieldExpressionFactory; |
|  |  | import com.cronutils.model.time.ExecutionTime; |
|  |  | import org.hamcrest.core.StringEndsWith; |
|  |  | import org.junit.Before; |
|  |  | import org.junit.Rule; |
|  |  | import org.junit.Test; |
|  |  | import org.junit.internal.matchers.ThrowableMessageMatcher; |
|  |  | import org.junit.rules.ExpectedException; |
|  |  |  |
|  |  | import java.time.ZonedDateTime; |
|  |  | import java.util.Locale; |
|  |  | import java.util.Optional; |
|  |  |  |
|  |  | import static org.junit.Assert.\*; |
|  |  | import static org.junit.internal.matchers.ThrowableMessageMatcher.hasMessage; |
|  |  |  |
|  |  | public class CronParserQuartzIntegrationTest { |
|  |  |  |
| Expand Down  Expand Up | | @@ -248,9 +251,7 @@ public void testReportedErrorContainsSameExpressionAsProvided() { |
|  |  | public void testMissingExpressionAndInvalidCharsInErrorMessage() { |
|  |  | thrown.expect(IllegalArgumentException.class); |
|  |  | final String cronexpression = "\* \* -1 \* \* ?"; |
|  |  | thrown.expectMessage( |
|  |  | String.format("Failed to parse '%s'. Invalid expression! Expression: -1 does not describe a range. Negative numbers are not allowed.", |
|  |  | cronexpression)); |
|  |  | thrown.expect(hasMessage(StringEndsWith.endsWith("Invalid expression! Expression: -1 does not describe a range. Negative numbers are not allowed."))); |
|  |  | assertNotNull(ExecutionTime.forCron(parser.parse(cronexpression))); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

9 changes: 8 additions & 1 deletion

9
[src/test/java/com/cronutils/validation/CronValidatorTest.java](#diff-8eadd06e5d363ee4f2e3b78f8960285826906458e6d22c9ab7bf3b38fc123f05 "src/test/java/com/cronutils/validation/CronValidatorTest.java")

Show comments

[View file](/jmrozanec/cron-utils/blob/cfd2880f80e62ea74b92fa83474c2aabdb9899da/src/test/java/com/cronutils/validation/CronValidatorTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,8 @@ |
|  |  | import org.junit.Test; |
|  |  | import org.junit.runner.RunWith; |
|  |  | import org.junit.runners.Parameterized; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  |  |
|  |  | import javax.validation.ConstraintViolation; |
|  |  | import javax.validation.Validation; |
| Expand All | | @@ -16,6 +18,8 @@ |
|  |  | @RunWith(Parameterized.class) |
|  |  | public class CronValidatorTest { |
|  |  |  |
|  |  | private static final Logger LOGGER = LoggerFactory.getLogger(CronValidatorTest.class); |
|  |  |  |
|  |  | private final Validator validator = Validation.buildDefaultValidatorFactory().getValidator(); |
|  |  |  |
|  |  | private final String expression; |
| Expand All | | @@ -38,14 +42,17 @@ public static Object[] expressions() { |
|  |  | {"0 0 0 25 12 ?", true}, |
|  |  | {"0 0 0 L 12 ?", false}, |
|  |  | {"1,2, \* \* \* \* \*", false}, |
|  |  | {"1- \* \* \* \* \*", false} |
|  |  | {"1- \* \* \* \* \*", false}, |
|  |  | // Verification for RCE security vulnerability fix: https://github.com/jmrozanec/cron-utils/issues/461 |
|  |  | {"java.lang.Runtime.getRuntime().exec('touch /tmp/pwned'); // 4 5 [${''.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('js').eval(validatedValue)}]", false} |
|  |  | }; |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void validateExamples() { |
|  |  | TestPojo testPojo = new TestPojo(expression); |
|  |  | Set<ConstraintViolation<TestPojo>> violations = validator.validate(testPojo); |
|  |  | violations.stream().map(ConstraintViolation::getMessage).forEach(LOGGER::info); |
|  |  |  |
|  |  | if (valid) { |
|  |  | assertTrue(violations.isEmpty()); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cfd2880`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fcommit%2Fcfd2880f80e62ea74b92fa83474c2aabdb9899da) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9fa83095_20250114_191154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fissues%2F461)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fissues%2F461)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=jmrozanec%2Fcron-utils)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jmrozanec](/jmrozanec)
/
**[cron-utils](/jmrozanec/cron-utils)**
Public

* [Notifications](/login?return_to=%2Fjmrozanec%2Fcron-utils) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Fjmrozanec%2Fcron-utils)
* [Star
   1.2k](/login?return_to=%2Fjmrozanec%2Fcron-utils)

* [Code](/jmrozanec/cron-utils)
* [Issues
  30](/jmrozanec/cron-utils/issues)
* [Pull requests
  19](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects
  0](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

Additional navigation options

* [Code](/jmrozanec/cron-utils)
* [Issues](/jmrozanec/cron-utils/issues)
* [Pull requests](/jmrozanec/cron-utils/pulls)
* [Actions](/jmrozanec/cron-utils/actions)
* [Projects](/jmrozanec/cron-utils/projects)
* [Wiki](/jmrozanec/cron-utils/wiki)
* [Security](/jmrozanec/cron-utils/security)
* [Insights](/jmrozanec/cron-utils/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjmrozanec%2Fcron-utils%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjmrozanec%2Fcron-utils%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix security vulnerability regarding the Hibernate dependency. #461

Closed

[jmrozanec](/jmrozanec) opened this issue
Nov 21, 2020
· 23 comments
 · Fixed by [#494](https://github.com/jmrozanec/cron-utils/pull/494)

Closed

# [Fix security vulnerability regarding the Hibernate dependency.](#top) #461

[jmrozanec](/jmrozanec) opened this issue
Nov 21, 2020
· 23 comments
 · Fixed by [#494](https://github.com/jmrozanec/cron-utils/pull/494)

Assignees
[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)

Labels
[done](/jmrozanec/cron-utils/labels/done)
[enhancement](/jmrozanec/cron-utils/labels/enhancement)

Milestone
[9.1.3](/jmrozanec/cron-utils/milestone/21 "9.1.3")

## Comments

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

### **[jmrozanec](/jmrozanec)** commented [Nov 21, 2020](#issue-747995031)

| *No description provided.* |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)
[jmrozanec](/jmrozanec)
added
[enhancement](/jmrozanec/cron-utils/labels/enhancement)
[done](/jmrozanec/cron-utils/labels/done)
labels
[Nov 21, 2020](#event-4023729489)

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)
[jmrozanec](/jmrozanec)
self-assigned this
[Nov 21, 2020](#event-4023729633)

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)
[jmrozanec](/jmrozanec)
added this to the [next](/jmrozanec/cron-utils/milestone/20) milestone
[Nov 21, 2020](#event-4023729672)

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)
[jmrozanec](/jmrozanec)
closed this as [completed](/jmrozanec/cron-utils/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 21, 2020](#event-4023729755)

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec)
[jmrozanec](/jmrozanec)
modified the milestones:
[next](/jmrozanec/cron-utils/milestone/20),
[9.1.3](/jmrozanec/cron-utils/milestone/21)
[Nov 21, 2020](#event-4023791708)

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Nov 22, 2020](#issuecomment-731848819) • edited Loading

| A Template Injection was identified in cron-utils enabling attackers to inject arbitrary Java EL expressions, leading to unauthenticated Remote Code Execution (RCE) vulnerability.  Remote Code Execution - JavaEL Injection If developers use the [@Cron](https://github.com/Cron) annotation to validate a user-controlled Cron expression, attackers will be able to inject and run arbitrary Java Expression Language (EL) expressions.  Cron-Utils uses Java Bean Validation (JSR 380) custom constraint validators such as CronValidator. When building custom constraint violation error messages, it is important to understand that they support different types of interpolation, including Java EL expressions. Therefore if an attacker can inject arbitrary data in the error message template passed to ConstraintValidatorContext.buildConstraintViolationWithTemplate(), they will be able to run arbitrary Java code. Unfortunately, it is common that validated (and therefore, normally untrusted) bean properties flow into the custom error message. In this case CronValidator includes the Cron expression being validated in the custom constraint error validation message if an exception is thrown while parsing the expression:  ``` public boolean isValid(String value, ConstraintValidatorContext context) {     if (value == null) {         return true;     }      CronDefinition cronDefinition = CronDefinitionBuilder.instanceDefinitionFor(type);     CronParser cronParser = new CronParser(cronDefinition);     try {         cronParser.parse(value).validate();         return true;     } catch (IllegalArgumentException e) {         context.disableDefaultConstraintViolation();         context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation();         return false;     } }  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gsmet](https://avatars.githubusercontent.com/u/1279749?s=80&u=e462a6165ea17647aed446ca31fae604338ae18c&v=4)](/gsmet)

Copy link

Contributor

### **[gsmet](/gsmet)** commented [Nov 24, 2020](#issuecomment-732619409)

| Hi,  Hibernate Validator lead here.  So I have no idea if Hibernate Validator is the right thing for your usage, my personal opinion is that it might be too much infrastructure for a focused util library like yours.  But as far as security is concerned, I thought that [@pwntester](https://github.com/pwntester) had added the important information I gave to him to the message he is sending. [@pwntester](https://github.com/pwntester), I already asked once, could you make sure to provide all relevant information to the people you contact? Thanks!  What you're doing is effectively unsafe but there are multiple ways to make it perfectly safe and still using HV:   * see an example here on how to include a properly escaped variable in your constraint violation message: <https://in.relation.to/2020/05/07/hibernate-validator-615-6020-released/> . Basically, you have to consider user input as unsafe, exactly the same as for SQL injection and properly escape it. * also you can get entirely rid of the javax.el/jakarta.el dependency by initializing your ValidatorFactory with:  ``` ValidatorFactory validatorFactory = Validation.byDefaultProvider() 				.configure() 				.messageInterpolator( new ParameterMessageInterpolator() ) 				.buildValidatorFactory();  ```  Note that the default messages of a couple of built-in constraints will be broken if you choose this option over the first one (typically the \*Min, \*Max constraints that are using EL for their default message). My advice would be to also properly escape things as recommended in the first option anyway.  I'm still thinking about a way to have a more secure default while keeping the \*Min/\*Max contraints working properly (and the Jakarta Bean Validation spec requires Jakarta EL support). It's not an easy one.  I hope this clarifies things for you. |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Nov 24, 2020](#issuecomment-732750817)

| Thanks for the feedback [@gsmet](https://github.com/gsmet) We are sending your recommendations as part of the initial report we send to affected projects and also as part of the [blog post reference](https://securitylab.github.com/research/bean-validation-RCE) that we share with maintainers. |
| --- |

All reactions

Sorry, something went wrong.

[![@gsmet](https://avatars.githubusercontent.com/u/1279749?s=80&u=e462a6165ea17647aed446ca31fae604338ae18c&v=4)](/gsmet)

Copy link

Contributor

### **[gsmet](/gsmet)** commented [Nov 24, 2020](#issuecomment-732860987)

| Also, I'm far from being sure that Apache BVal is safer if you have javax.el around, which you still have in your pom.  I had a quick look at the code and I think they automatically enable EL if it's in the classpath. |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Nov 25, 2020](#issuecomment-733600214)

| as far as i know, their code to decide if EL expressions should be evaluated is [this](https://github.com/apache/bval/blob/master/bval-jsr/src/main/java/org/apache/bval/jsr/DefaultMessageInterpolator.java#L183-L201) which seems to check only for the configuration property being enabled or the message being the default one |
| --- |

All reactions

Sorry, something went wrong.

[![@gsmet](https://avatars.githubusercontent.com/u/1279749?s=80&u=e462a6165ea17647aed446ca31fae604338ae18c&v=4)](/gsmet)

Copy link

Contributor

### **[gsmet](/gsmet)** commented [Nov 25, 2020](#issuecomment-733913660) • edited Loading

| I fail to see how changing the test impl makes `CronValidator` safer.  Because first, HV is the most widely used implementation and second, even in Apache BVal, you can enable EL for custom constraint violation message, which can be done for very good reasons and a user might think all your constraints are safe because carefully audited.  And in this case, having your `CronValidator` around will make the application vulnerable.  What you need to do is escape `e.getMessage()` with an approach similar to what is done here: <https://github.com/hibernate/hibernate-validator/blob/master/engine/src/main/java/org/hibernate/validator/internal/engine/messageinterpolation/util/InterpolationHelper.java> .  There are better Hibernate Validator-specific way to do this but if you want to be compatible with all the implementations and be entirely safe, that's the only way to do it right now. |
| --- |

All reactions

Sorry, something went wrong.

[![@dsuresh-ap](https://avatars.githubusercontent.com/u/21132682?s=80&u=83af1e657098ee8f9f0cffd2962bfc40af6c37dd&v=4)](/dsuresh-ap)

Copy link

### **[dsuresh-ap](/dsuresh-ap)** commented [Dec 10, 2020](#issuecomment-742848524)

| [@jmrozanec](https://github.com/jmrozanec) Do you know if this vulnerability is an issue in 6.0.6? Fossa filed this vulnerability but I don't see any related code in v6.0.6 so we are assuming that this is not an issue in that version. Would be great if you can confirm. |
| --- |

All reactions

Sorry, something went wrong.

[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=80&v=4)](/NielsDoucet)

Copy link

Contributor

### **[NielsDoucet](/NielsDoucet)** commented [Oct 21, 2021](#issuecomment-948406076)

| As the original contributor of the validator, I'm confused about what was done to mitigate the problem, as well as how the code was deemed vulnerable in the first place.  As far as I can tell, the change to swap out the test dependency does nothing for the runtime behaviour of this library. So I fail to see how this mitigates the risk.  On the validity of the report: there is no user input for this constraint violation message. It's simply taking the message from the thrown exception and using it as the violation message. So the `CronParser` implementation class has to be swapped out completely and then a maliciously crafted exception message can be thrown. This is technically possible, but at that point this validator is the least of your worries, imho.  [@pwntester](https://github.com/pwntester) [@jmrozanec](https://github.com/jmrozanec) [@gsmet](https://github.com/gsmet) am I wrong in my assessment here? |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 21, 2021](#issuecomment-948412754)

| On the validity of the report: there is no user input for this constraint violation message. It's simply taking the message from the thrown exception and using it as the violation message.  `CronParser` reflects the cron job string in the exception message, so controlling the cron string, an attacker can control the exception message and trigger an EL evaluation. You can find a PoC in the [advisory](https://securitylab.github.com/advisories/GHSL-2020-212-cron-utils-ssti/) |
| --- |

 👀
1
 NielsDoucet reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=80&v=4)](/NielsDoucet)

Copy link

Contributor

### **[NielsDoucet](/NielsDoucet)** commented [Oct 21, 2021](#issuecomment-948415075)

| I see, I completely missed that part (obviously). In that case, shouldn't this library still be considered vulnerable to the problem? Was the fix validated? |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 21, 2021](#issuecomment-948433446)

| I think the change to bval was considered a secure fix back then and we missed that it was a test dependency. I think its worth verifying it with the latest version. In the meantime, Hibernate has disabled EL evaluation by default on custom constraint error messages |
| --- |

All reactions

Sorry, something went wrong.

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Oct 21, 2021](#issuecomment-948506000)

| [@pwntester](https://github.com/pwntester) is the current version considered safe, or there are any actions required on our side? |
| --- |

All reactions

Sorry, something went wrong.

[![@gsmet](https://avatars.githubusercontent.com/u/1279749?s=80&u=e462a6165ea17647aed446ca31fae604338ae18c&v=4)](/gsmet)

Copy link

Contributor

### **[gsmet](/gsmet)** commented [Oct 21, 2021](#issuecomment-948519992)

| Hibernate Validator lead here, 6.2 (`javax.` packages) and 7.0 (`jakarta.` packages) are safe. |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 21, 2021](#issuecomment-948534594)

| I just verified that if I upgrade my testcase to use 9.1.5 and keep the rest of the dependencies the same (hibernate-validator 6.1.6.Final), the application is still vulnerable:  ``` <project>   <modelVersion>4.0.0</modelVersion>   <groupId>mygroupid</groupId>   <artifactId>myartifactid</artifactId>   <version>0.0-SNAPSHOT</version>    <properties>       <maven.compiler.target>1.8</maven.compiler.target>       <maven.compiler.source>1.8</maven.compiler.source>   </properties>   <dependencies>     <dependency>       <groupId>com.cronutils</groupId>       <artifactId>cron-utils</artifactId>       <version>9.1.5</version>     </dependency>     <dependency>       <groupId>javax.validation</groupId>       <artifactId>validation-api</artifactId>       <version>2.0.1.Final</version>     </dependency>     <dependency>       <groupId>org.hibernate</groupId>       <artifactId>hibernate-validator</artifactId>       <version>6.1.6.Final</version>     </dependency>     <dependency>       <groupId>org.glassfish</groupId>       <artifactId>javax.el</artifactId>       <version>3.0.0</version>     </dependency>   </dependencies> </project>  ```  So the vulnerability is now dependent on what validator version is used at runtime which is not ideal.  [@jmrozanec](https://github.com/jmrozanec) see the remediation section in this [blog post](https://securitylab.github.com/research/bean-validation-RCE/) |
| --- |

All reactions

Sorry, something went wrong.

[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=80&v=4)](/NielsDoucet)

Copy link

Contributor

### **[NielsDoucet](/NielsDoucet)** commented [Oct 21, 2021](#issuecomment-948554966)

| From my perspective, there are 2 possible routes:   * do not reflect the cron expression back through the exception message at all (this makes the usage of the message safe in all possible contexts) * escape the exception message before passing it to the violation as described here:   What you need to do is escape `e.getMessage()` with an approach similar to what is done here: <https://github.com/hibernate/hibernate-validator/blob/master/engine/src/main/java/org/hibernate/validator/internal/engine/messageinterpolation/util/InterpolationHelper.java> .  This library has no direct influence on the validator framework used, so we can only make sure the message is safe. |
| --- |

All reactions

Sorry, something went wrong.

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Oct 21, 2021](#issuecomment-948896446)

| [@NielsDoucet](https://github.com/NielsDoucet) perhaps the first option (not reflecting the expression back in the exception message) is a good choice? We would be grateful for a PR providing that fix. Is that possible? |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 22, 2021](#issuecomment-949479301) • edited Loading

| [@jmrozanec](https://github.com/jmrozanec) [This](https://github.com/jmrozanec/cron-utils/pull/493) should fix it |
| --- |

All reactions

Sorry, something went wrong.

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Oct 22, 2021](#issuecomment-949489871)

| [@pwntester](https://github.com/pwntester) thanks! 😄 That was fast! 🚀 |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 22, 2021](#issuecomment-949495843)

| that was easy too 😄 I guess we should issue a new advisory and CVE to let user know about the security issue in <9.1.5 |
| --- |

All reactions

Sorry, something went wrong.

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Oct 22, 2021](#issuecomment-949593420)

| [@pwntester](https://github.com/pwntester) yes, please issue an advisory. We will release a new version over the weekend, so we ensure the fix can be incorporated ASAP by anyone. Thanks! 😄 |
| --- |

All reactions

Sorry, something went wrong.

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=80&u=3a01e6929aa1ae0c1dc796928df3c91e22e1ca0f&v=4)](/pwntester)

Copy link

### **[pwntester](/pwntester)** commented [Oct 22, 2021](#issuecomment-949668533)

| I dont have permissions on this repo to create a security advisory. Please create one and invite me in and I will fill in the details |
| --- |

All reactions

Sorry, something went wrong.

[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=80&v=4)](/NielsDoucet)

Copy link

Contributor

### **[NielsDoucet](/NielsDoucet)** commented [Oct 23, 2021](#issuecomment-950154199)

| [@jmrozanec](https://github.com/jmrozanec) [This](https://github.com/jmrozanec/cron-utils/pull/493) should fix it  I was thinking more about fixing it in the actual parser: <https://github.com/jmrozanec/cron-utils/blob/master/src/main/java/com/cronutils/parser/CronParser.java#L131> Technically reflecting the input back in the exception could lead to other vulnerabilities by anyone using this exception message in a context where it's evaluated. We would avoid this problem altogether by removing the reflection at the source.  ``` throw new IllegalArgumentException(String.format("Failed to parse '%s'. %s", expression, e.getMessage()), e);  ```  could become  ``` throw new IllegalArgumentException(String.format("Failed to parse the cron expression. %s", e.getMessage()), e);  ```  It would at least provide more feedback from the validator than a generic "something went wrong". [@jmrozanec](https://github.com/jmrozanec) does that sound good? |
| --- |

 👍
1
 pwntester reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[NielsDoucet](/NielsDoucet)
added a commit
to NielsDoucet/cron-utils
that referenced
this issue
[Oct 23, 2021](#ref-commit-9c93c17)
[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=40&v=4)](/NielsDoucet)

`[Resolve RCE vulnerability.](/NielsDoucet/cron-utils/commit/9c93c17b8107e58073443a045e22274467b88aae "Resolve RCE vulnerability.

Make tests a bit more resilient to exception message changes.

fixes #461")`
…

`[9c93c17](/NielsDoucet/cron-utils/commit/9c93c17b8107e58073443a045e22274467b88aae)`

```
Make tests a bit more resilient to exception message changes.

fixes [jmrozanec#461](https://github.com/jmrozanec/cron-utils/issues/461)
```

[![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=40&v=4)](/NielsDoucet)
[NielsDoucet](/NielsDoucet)
mentioned this issue
[Oct 23, 2021](#ref-pullrequest-1034197577)

[Resolve RCE vulnerability.
#494](/jmrozanec/cron-utils/pull/494)
 Merged

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=80&v=4)](/jmrozanec)

Copy link

Owner

Author

### **[jmrozanec](/jmrozanec)** commented [Nov 14, 2021](#issuecomment-968370215)

| [@pwntester](https://github.com/pwntester) just created the security advisory and added you as a collaborator. I used the same description as for the previous one, only updating the library version for the mitigation. Can you check what else is required to finalize this? [@NielsDoucet](https://github.com/NielsDoucet) I updated the code and released a new version of the library. The update removed the change introduced by [@pwntester](https://github.com/pwntester) and no other change was made. Should be this ok?  Thank you both for the help, and my apologies for the delay 😄 Thanks! |
| --- |

 👍
1
 NielsDoucet reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@igalbk](https://avatars.githubusercontent.com/u/2900000?s=40&v=4)](/igalbk)
[igalbk](/igalbk)
mentioned this issue
[Nov 30, 2021](#ref-issue-1067076665)

[Critical CVSS 9.8 CVE-2021-41269 Vulnerability in cron-utils dependency
kagkarlsson/db-scheduler#250](/kagkarlsson/db-scheduler/issues/250)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjmrozanec%2Fcron-utils%2Fissues%2F461)

Assignees

[![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=40&v=4)](/jmrozanec) [jmrozanec](/jmrozanec)

Labels

[done](/jmrozanec/cron-utils/labels/done)
[enhancement](/jmrozanec/cron-utils/labels/enhancement)

Projects

None yet

Milestone

 [**9.1.3**](/jmrozanec/cron-utils/milestone/21 "9.1.3")

Development

Successfully merging a pull request may close this issue.

 [Resolve RCE vulnerability.](/jmrozanec/cron-utils/pull/494)
 [NielsDoucet/cron-utils](/NielsDoucet/cron-utils)

5 participants

[![@pwntester](https://avatars.githubusercontent.com/u/125701?s=52&v=4)](/pwntester) [![@jmrozanec](https://avatars.githubusercontent.com/u/1128080?s=52&v=4)](/jmrozanec) [![@gsmet](https://avatars.githubusercontent.com/u/1279749?s=52&v=4)](/gsmet) [![@NielsDoucet](https://avatars.githubusercontent.com/u/2117424?s=52&v=4)](/NielsDoucet) [![@dsuresh-ap](https://avatars.githubusercontent.com/u/21132682?s=52&v=4)](/dsuresh-ap)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


