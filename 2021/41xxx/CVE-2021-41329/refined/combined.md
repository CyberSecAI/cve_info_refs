=== Content from github.com_3e6450df_20250114_183145.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatalust%2Fseq-tickets%2Fissues%2F1322)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatalust%2Fseq-tickets%2Fissues%2F1322)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=datalust%2Fseq-tickets)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[datalust](/datalust)
/
**[seq-tickets](/datalust/seq-tickets)**
Public

* [Notifications](/login?return_to=%2Fdatalust%2Fseq-tickets) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fdatalust%2Fseq-tickets)
* [Star
   100](/login?return_to=%2Fdatalust%2Fseq-tickets)

* [Code](/datalust/seq-tickets)
* [Issues
  37](/datalust/seq-tickets/issues)
* [Pull requests
  0](/datalust/seq-tickets/pulls)
* [Discussions](/datalust/seq-tickets/discussions)
* [Security](/datalust/seq-tickets/security)
* [Insights](/datalust/seq-tickets/pulse)

Additional navigation options

* [Code](/datalust/seq-tickets)
* [Issues](/datalust/seq-tickets/issues)
* [Pull requests](/datalust/seq-tickets/pulls)
* [Discussions](/datalust/seq-tickets/discussions)
* [Security](/datalust/seq-tickets/security)
* [Insights](/datalust/seq-tickets/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdatalust%2Fseq-tickets%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdatalust%2Fseq-tickets%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2021-41329: Query cache collisions when queries differ only by `in` clause contents #1322

Closed

[nblumhardt](/nblumhardt) opened this issue
Sep 15, 2021
¬∑ 3 comments

Closed

# [CVE-2021-41329: Query cache collisions when queries differ only by `in` clause contents](#top) #1322

[nblumhardt](/nblumhardt) opened this issue
Sep 15, 2021
¬∑ 3 comments

Labels
[bug](/datalust/seq-tickets/labels/bug)
[security](/datalust/seq-tickets/labels/security)

Milestone
[2021.2.6459](/datalust/seq-tickets/milestone/121 "2021.2.6459")

## Comments

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=80&v=4)](/nblumhardt)

Copy link

Member

### **[nblumhardt](/nblumhardt)** commented [Sep 15, 2021](#issue-997607235)

| Seq uses time-slice caching to speed up `group by time()` queries and a few others, in particular, those that drive [Dashboards](https://docs.datalust.co/docs/dashboards).  Behind the scenes, cache entries are keyed based on the clauses of the query, active signals, and so-on.  A bug in recent Seq versions up to 2021.2 causes the keys generated for `in` clauses to collide, when all elements of the detected set are constants.  For example:   * `select count(*) from stream where @Level in ['warn'] group by time(1m)` and * `select count(*) from stream where @Level in ['error', 'critical'] group by time(1m)`   will generate the same cache key, and thus produce incorrect results when two cacheable queries differ only in this respect.  The bug is caused by inlining of arrays of constants: instead of `['warn']` generating an expression that constructs an array with a constant element, the array is precomputed and inlined as a constant itself.  The code that subsequently generates query cache keys does not properly account for this case.  Query cache entries will not collide if:   * The queries do not group by `time` and are not executed from a dashboard, * The queries run over different signals, * Any other aspect of the query, including the `select`, `where`, `group by`, `having`, and `order by` clauses, differ in any way. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=40&v=4)](/nblumhardt)
[nblumhardt](/nblumhardt)
added
the
[bug](/datalust/seq-tickets/labels/bug)
label
[Sep 15, 2021](#event-5309166713)

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=40&v=4)](/nblumhardt)
[nblumhardt](/nblumhardt)
added this to the [2021.2-patch4](/datalust/seq-tickets/milestone/121) milestone
[Sep 15, 2021](#event-5309168232)

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=80&v=4)](/nblumhardt)

Copy link

Member

Author

### **[nblumhardt](/nblumhardt)** commented [Sep 15, 2021](#issuecomment-920463679)

| We'll release a 2021.2 patch with this fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=40&v=4)](/nblumhardt)
[nblumhardt](/nblumhardt)
closed this as [completed](/datalust/seq-tickets/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 16, 2021](#event-5309848698)

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=80&v=4)](/nblumhardt)

Copy link

Member

Author

### **[nblumhardt](/nblumhardt)** commented [Sep 16, 2021](#issuecomment-920556324)

| 2021.2.6459 includes the fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=40&v=4)](/nblumhardt)
[nblumhardt](/nblumhardt)
changed the title
~~Query cache collisions when queries differ only by `in` clause contents~~
CVE-2021-41329: Query cache collisions when queries differ only by `in` clause contents
[Sep 20, 2021](#event-5325861873)

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=40&v=4)](/nblumhardt)
[nblumhardt](/nblumhardt)
added
the
[security](/datalust/seq-tickets/labels/security)
label
[Sep 20, 2021](#event-5325862148)

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=80&v=4)](/nblumhardt)

Copy link

Member

Author

### **[nblumhardt](/nblumhardt)** commented [Sep 20, 2021](#issuecomment-922625479)

| Datalust requested a CVE number for this bug because of the possibility of query collisions exposing the query results of one user to another, when the data visible to the second user should be limited by their [view filter](https://docs.datalust.co/docs/managing-users#view-filters).  The information exposure may occur when a query executed by a user with restricted access differs from an earlier query, executed by a user with different restrictions, *only* by the contents of an array or `in` clause that appears in the restricted user's view filter.  For example, if user 1 has view filter `Project in ['project-1', 'project-2']` and user 2 has a view filter `Project in ['project-3']`, then each user may see cached results of a query `select distinct(CustomerName) group by time(1h)` belonging to the other user, if they execute these queries in turn.  We expect the real-world impact of this bug to be low because:   * Only installations that restrict lower-permission users via view filters are affected, * Only view filters based on `in` clauses or arrays are affected, * Only `group by time()` and dashboard-based queries are affected, * Cache collisions require recent execution of an identical query with the same time bucketing, over an overlapping interval, with no further restrictions or operators applied.   If you need any assistance determining whether this issue is likely to have occurred on the Seq instances you manage, please reach out via our support address. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatalust%2Fseq-tickets%2Fissues%2F1322)

Assignees

No one assigned

Labels

[bug](/datalust/seq-tickets/labels/bug)
[security](/datalust/seq-tickets/labels/security)

Projects

None yet

Milestone

 [**2021.2.6459**](/datalust/seq-tickets/milestone/121 "2021.2.6459")

Development

No branches or pull requests

1 participant

[![@nblumhardt](https://avatars.githubusercontent.com/u/342712?s=52&v=4)](/nblumhardt)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from blog.datalust.co_aa0d7568_20250114_183144.html ===

### Menu

Close

* [Index](https://blog.datalust.co)
* [Seq Home](https://datalust.co/seq)
* [Twitter](https://twitter.com/datalust_seq)

[Subscribe](https://blog.datalust.co/rss/)

[![Seq Homepage](https://blog.getseq.net/content/images/2018/09/Seq-Main-Light-400px.png)](https://datalust.co/seq)
Menu

# Structured Blog

## Seq ‚Äî Machine data, for humans.

[Scroll Down](#content)

Page 1 of 15
[Older Posts ‚Üí](/page/2/)

## [Persistent logs and traces for .NET Aspire](/persistent-logs-and-traces-for-the-net-aspire-dashboard/)

This post continues on from a previous post, Enhancing .NET Aspire Observability with Seq. Since that post was published, a Seq component has been included in [¬ª](/persistent-logs-and-traces-for-the-net-aspire-dashboard/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
22 May 2024

## [Space-efficient indexing for immutable log data](/space-efficient-indexing-for-immutable-log-data/)

This post describes our approach to implementing a disk-backed hashmap in Rust for indexing high-cardinality predicates in our diagnostics product, Seq. If you've ever [¬ª](/space-efficient-indexing-for-immutable-log-data/)

![Ashley Mannix](https://blog.datalust.co/content/images/2018/09/6721458.png)
[Ashley Mannix](/author/ashley/)
08 May 2024

## [Announcing Seq 2024.3](/announcing-seq-2024-3/)

TL;DR: With Seq 2024.3, Seq gains user-defined high-cardinality indexes, its first new index type since the introduction of signal indexes back in 2018! If [¬ª](/announcing-seq-2024-3/)

![Nicholas Blumhardt](//www.gravatar.com/avatar/b36c0848ba0edb962dd202a7651ad4bc?s=250&d=mm&r=x)
[Nicholas Blumhardt](/author/nblumhardt/)
03 May 2024

## [Faster searches with property indexes](/faster-search/)

Now in preview, Seq 2024.3 introduces a new index type on event properties, known as expression indexes. Under the right circumstances, expression indexes reduce search [¬ª](/faster-search/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
30 April 2024

## [Seq 2024.2 released üéâ](/seq-2024-2-released/)

TL;DR: for the latest UX and performance improvements, pull datalust/seq:latest from Docker Hub, or grab the MSI from datalust.co/download.
Seq 2024. [¬ª](/seq-2024-2-released/)

![Nicholas Blumhardt](//www.gravatar.com/avatar/b36c0848ba0edb962dd202a7651ad4bc?s=250&d=mm&r=x)
[Nicholas Blumhardt](/author/nblumhardt/)
27 March 2024

## [Improved and updated email notifications](/new-seq-mail-apps/)

Introducing the new Seq.App.Mail.\* packages for SMTP and Microsoft365 email.
A lot has changed since the first email notification plugin was written for Seq! [¬ª](/new-seq-mail-apps/)

![Nicholas Blumhardt](//www.gravatar.com/avatar/b36c0848ba0edb962dd202a7651ad4bc?s=250&d=mm&r=x)
[Nicholas Blumhardt](/author/nblumhardt/)
29 February 2024

## [Working with Nested Event Properties](/nested-event-properties/)

Seq 2024.1 introduced a change to the default display of nested event properties. Previous versions of Seq rendered collapsed nested structures that could be expanded [¬ª](/nested-event-properties/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
22 February 2024

## [C# Tracing with Serilog and SerilogTracing](/dotnet-tracing-with-serilog/)

Distributed tracing makes Seq even better for monitoring and troubleshooting the behavior and performance of complex distributed systems. The emerging standard for logging and tracing is [¬ª](/dotnet-tracing-with-serilog/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
15 February 2024

## [Enhancing .NET Aspire Observability with Seq](/enhancing-net-aspire-with-seq/)

.NET Aspire is a toolkit for development and deployment of microservice applications. It is a local orchestrator with support for deployment to production-grade orchestrators like Azure [¬ª](/enhancing-net-aspire-with-seq/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
07 February 2024

## [C# Tracing with the OpenTelemetry .NET SDK and Seq](/tracing-to-seq-with-the-opentelemetry-net-sdk/)

OpenTelemetry has emerged as an important standard for generating observability data. It provides a consistent model across all environments and reduces vendor lock-in. As such, we [¬ª](/tracing-to-seq-with-the-opentelemetry-net-sdk/)

![Liam McLennan](https://blog.datalust.co/content/images/2022/03/headshot2-trans.png)
[Liam McLennan](/author/liam/)
05 February 2024

Page 1 of 15
[Older Posts ‚Üí](/page/2/)

[Structured Blog](https://blog.datalust.co) ¬© 2025
Proudly published with [Ghost](https://ghost.org)


