=== Content from github.com_b4bcdf11_20250114_212730.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Fsecurity%2Fadvisories%2FGHSA-43wx-8qmj-9r9q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Fsecurity%2Fadvisories%2FGHSA-43wx-8qmj-9r9q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cloudendpoints%2Fesp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cloudendpoints](/cloudendpoints)
/
**[esp](/cloudendpoints/esp)**
Public

* [Notifications](/login?return_to=%2Fcloudendpoints%2Fesp) You must be signed in to change notification settings
* [Fork
  74](/login?return_to=%2Fcloudendpoints%2Fesp)
* [Star
   281](/login?return_to=%2Fcloudendpoints%2Fesp)

* [Code](/cloudendpoints/esp)
* [Issues
  22](/cloudendpoints/esp/issues)
* [Pull requests
  3](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects
  0](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

Additional navigation options

* [Code](/cloudendpoints/esp)
* [Issues](/cloudendpoints/esp/issues)
* [Pull requests](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

# X-Endpoint-API-UserInfo can be spoofed.

Moderate

[qiwzhang](/qiwzhang)
published
GHSA-43wx-8qmj-9r9q
Oct 7, 2021

## Package

No package listed

## Affected versions

< v1.58.0

## Patched versions

v1.58.0

## Description

### Summary

ESPv1 can be configured to authenticate a JWT token. Its verified JWT claim is passed to the application by HTTP header "X-Endpoint-API-UserInfo", the application can use it to do authorization. But if there are two "X-Endpoint-API-UserInfo" headers from the client, ESPv1 only replaces the first one, the 2nd one will be passed to the backend application.

An attacker can send two "X-Endpoint-API-UserInfo" headers and make the second one as a malicious JWT claim. The backend application will receive two "X-Endpoint-API-UserInfo" headers, the first one is the correct one added by ESPv1 for the verified JWT token, the second one will be the malicious one from the client, the spoofed one.

Above only happens when the JWT authentication is required for the API method and the JWT token in the request has been successfully verified. This requires the attacker to be able to generate a valid JWT token that can be verified by ESPv1. For some tokens, such as Okta, auth0, it is not easy to generate a valid JWT token since the JWKS public keys are specific to certain accounts. It will be very difficult for the attacker to figure out the account number and to generate a good token for that account. For some tokens, such as Google ID token, and Firebase, it could be easy to generate a valid token since JWKS public keys are the same for all accounts.

### Impact

This impacts following ESPv1 usages:

* Users have configured ESPv1 to do JWT authentication with Google ID Token or Firebase as described in this [doc](https://cloud.google.com/endpoints/docs/openapi/authenticating-users-google-id).
* Users backend application is using the info in the "X-Endpoint-API-UserInfo" header to do the authorization. The backend application should receive two "X-Endpoint-API-UserInfo" headers, and it is not deterministically using the first "X-Endpoint-API-UserInfo" header, may use the second one which could be malicious one spoofed from the client.

### Patches

It has been fixed by the new release [v1.58.0](https://github.com/cloudendpoints/esp/releases/tag/v1.58.0). You need to patch it in the following ways:

* If your docker image is using tag ":1", needs to re-start the container to pick up the new version. The tag ":1" will automatically point to the latest version. For example,

```
- name: esp
  image: gcr.io/endpoints-release/endpoints-runtime:1
  args: [
    "--http_port=8081",
    "--backend=127.0.0.1:8080",
    "--service=SERVICE_NAME",
    "--rollout_strategy=managed",
  ]

```

* If your docker image tag pings to a specific minor version, e.g. ":1.57". You need to update it to ":1.58" and re-start the container.

```
- name: esp
  image: gcr.io/endpoints-release/endpoints-runtime:1.57
  args: [
    "--http_port=8081",
    "--backend=127.0.0.1:8080",
    "--service=SERVICE_NAME",
    "--rollout_strategy=managed",
  ]

```
### Workarounds

No

### Severity

Moderate

### CVE ID

CVE-2021-41130

### Weaknesses

[CWE-290](/advisories?query=cwe%3A290)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cloud.google.com_5bbacf8b_20250114_212726.html ===


[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vec94db9b1329e6c4d1d9b6b24ba16ad6c02043dcd66ba9c6a8f3d8fa0af3eec7/cloud/images/cloud-logo.svg)](/)

[Documentation](https://cloud.google.com/docs)

[Technology areas](https://cloud.google.com/docs/tech-area-overviews)

close

* [AI and ML](https://cloud.google.com/docs/ai-ml)
* [Application development](https://cloud.google.com/docs/application-development)
* [Application hosting](https://cloud.google.com/docs/application-hosting)
* [Compute](https://cloud.google.com/docs/compute-area)
* [Data analytics and pipelines](https://cloud.google.com/docs/data)
* [Databases](https://cloud.google.com/docs/databases)
* [Distributed, hybrid, and multicloud](https://cloud.google.com/docs/dhm-cloud)
* [Generative AI](https://cloud.google.com/docs/generative-ai)
* [Industry solutions](https://cloud.google.com/docs/industry)
* [Networking](https://cloud.google.com/docs/networking)
* [Observability and monitoring](https://cloud.google.com/docs/observability)
* [Security](https://cloud.google.com/docs/security)
* [Storage](https://cloud.google.com/docs/storage)

[Cross-product tools](https://cloud.google.com/docs/cross-product-overviews)

close

* [Access and resources management](https://cloud.google.com/docs/access-resources)
* [Costs and usage management](https://cloud.google.com/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](https://cloud.google.com/docs/devtools)
* [Infrastructure as code](https://cloud.google.com/docs/iac)
* [Migration](https://cloud.google.com/docs/migration)

[Related sites](https://cloud.google.com/)

close

* [Google Cloud Home](https://cloud.google.com/)
* [Free Trial and Free Tier](https://cloud.google.com/free)
* [Architecture Center](https://cloud.google.com/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](https://cloud.google.com/contact)
* [Google Cloud Developer Center](https://cloud.google.com/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](https://cloud.google.com/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](https://cloud.google.com/solutions)
* [Google Cloud Support](https://cloud.google.com/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

`/`

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어

Sign in

* [Cloud Endpoints](https://cloud.google.com/endpoints)

[Guides](https://cloud.google.com/endpoints/docs/openapi)

[Reference](https://cloud.google.com/endpoints/docs/openapi/specify-proxy-startup-options)

[Support](https://cloud.google.com/endpoints/docs/openapi/getting-support)

[Contact Us](https://cloud.google.com/contact)
[Start free](//console.cloud.google.com/freetrial)

[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vec94db9b1329e6c4d1d9b6b24ba16ad6c02043dcd66ba9c6a8f3d8fa0af3eec7/cloud/images/cloud-logo.svg)](/)

* [Documentation](/docs)
  + [Guides](/endpoints/docs/openapi)
  + [Reference](/endpoints/docs/openapi/specify-proxy-startup-options)
  + [Support](/endpoints/docs/openapi/getting-support)
* [Technology areas](/docs/tech-area-overviews)
  + More
* [Cross-product tools](/docs/cross-product-overviews)
  + More
* [Related sites](/)
  + More
* [Console](//console.cloud.google.com/)
* [Contact Us](/contact)
* [Start free](//console.cloud.google.com/freetrial)

* Cloud Endpoints with OpenAPI
* [Cloud Endpoints OpenAPI Docs](/endpoints/docs/openapi)
* [Product Overview](/endpoints)
* [All Cloud Endpoints Docs](/endpoints/docs)
* Tutorials
* [All Tutorials](/endpoints/docs/openapi/tutorials)
* Endpoints with ESP
  + Endpoints on App Engine Flexible with ESP
    - [Java, Python, Go, PHP, Ruby, NodeJS](/endpoints/docs/openapi/get-started-app-engine)
    - [.NET Core](/endpoints/docs/openapi/get-started-app-engine-dotnet)
  + [Endpoints on Compute Engine with ESP](/endpoints/docs/openapi/get-started-compute-engine-docker)
  + [Endpoints on GKE with ESP](/endpoints/docs/openapi/get-started-kubernetes-engine)
  + [Endpoints on Kubernetes with ESP](/endpoints/docs/openapi/get-started-kubernetes)
* Endpoints with ESPv2
  + [Endpoints on App Engine with ESPv2](/endpoints/docs/openapi/set-up-app-engine-standard-environment-espv2)
  + [Endpoints on Cloud Functions with ESPv2](/endpoints/docs/openapi/set-up-cloud-functions-espv2)
  + [Endpoints on Cloud Run with ESPv2](/endpoints/docs/openapi/set-up-cloud-run-espv2)
  + [Endpoints on Cloud Run for Anthos with ESPv2](/endpoints/docs/openapi/set-up-cloud-run-anthos-espv2)
  + [Endpoints on Compute Engine with ESPv2](/endpoints/docs/openapi/get-started-compute-engine-docker-espv2)
  + [Endpoints on Managed Instance Group with ESPv2](/endpoints/docs/openapi/get-started-mig-lb-espv2)
  + [Endpoints on GKE with ESPv2](/endpoints/docs/openapi/get-started-kubernetes-engine-espv2)
  + [Endpoints on Kubernetes with ESPv2](/endpoints/docs/openapi/get-started-kubernetes-espv2)
* How-to Guides
* [All How-to Guides](/endpoints/docs/openapi/how-to)
* Configuring and Deploying an API
  + [Configuring Endpoints](/endpoints/docs/openapi/configure-endpoints)
  + [Deploying the Endpoints Configuration](/endpoints/docs/openapi/deploy-endpoints-config)
  + [Deploying the API Backend & ESP to Google Cloud](/endpoints/docs/openapi/deploy-api-backend)
  + [Running ESP Locally or on Another Platform](/endpoints/docs/openapi/running-esp-localdev)
  + [Support CORS](/endpoints/docs/openapi/support-cors)
  + [Comparing Configuration Files](/endpoints/docs/openapi/config-file-compare)
  + [Getting the Service Name & Config ID](/endpoints/docs/openapi/get-service-name-config-id)
* Troubleshooting & Monitoring
  + [Troubleshooting Overview](/endpoints/docs/openapi/troubleshoot)
  + [Troubleshooting Endpoints Configuration Deployment](/endpoints/docs/openapi/troubleshoot-config-deployment)
  + [Troubleshooting Response Errors](/endpoints/docs/openapi/troubleshoot-response-errors)
  + [Troubleshooting App Engine Flexible Deployment](/endpoints/docs/openapi/troubleshoot-aeflex-deployment)
  + [Troubleshooting Compute Engine Deployment](/endpoints/docs/openapi/troubleshoot-gce-deployment)
  + [Troubleshooting GKE Deployment](/endpoints/docs/openapi/troubleshoot-gke-deployment)
  + [Troubleshooting JWT Validation](/endpoints/docs/openapi/troubleshoot-jwt)
  + [Monitoring Your API](/endpoints/docs/openapi/monitoring-your-api)
  + [Tracing Your API](/endpoints/docs/openapi/tracing)
* DNS & SSL
  + [Verifying a Domain Name](/endpoints/docs/openapi/verify-domain-name)
  + [Serving an API from Your Domain Name](/endpoints/docs/openapi/serving-apis-from-domains)
  + [Configuring DNS on cloud.goog](/endpoints/docs/openapi/cloud-goog-dns-configure)
  + [Serving Multiple APIs from a Domain](/endpoints/docs/openapi/deploying-apis-subdomains)
  + [Enabling SSL with ESP](/endpoints/docs/openapi/enabling-ssl)
  + [Enabling SSL with ESPv2](/endpoints/docs/openapi/enabling-ssl-espv2)
* Authentication & API Keys
  + [Choosing an Authentication Method](/endpoints/docs/openapi/authentication-method)
  + Authenticating Users
    - [Using Firebase to Authenticate Users](/endpoints/docs/openapi/authenticating-users-firebase)
    - [Using Auth0 to Authenticate Users](/endpoints/docs/openapi/authenticating-users-auth0)
    - [Using Okta to Authenticate Users](/endpoints/docs/openapi/authenticating-users-okta)
    - [Using Google ID tokens to Authenticate Users](/endpoints/docs/openapi/authenticating-users-google-id)
    - [Using a Custom Method to Authenticate Users](/endpoints/docs/openapi/authenticating-users-custom)
  + [Authentication Between Services](/endpoints/docs/openapi/service-account-authentication)
  + [Why and When to Use API Keys](/endpoints/docs/openapi/when-why-api-key)
  + [Restricting Access with API Keys](/endpoints/docs/openapi/restricting-api-access-with-api-keys)
* Managing API Access
  + [Overview of API Access](/endpoints/docs/openapi/api-access-overview)
  + [Controlling Who Can Enable Your API](/endpoints/docs/openapi/control-api-callers)
  + [Enabling an API in Your Cloud Project](/endpoints/docs/openapi/enable-api)
  + [Granting and Revoking Access to the API](/endpoints/docs/openapi/control-api-access)
* API Lifecycle Management
  + [Overview](/endpoints/docs/openapi/lifecycle-management)
  + [Versioning an API](/endpoints/docs/openapi/versioning-an-api)
  + [Planning Your Cloud Projects](/endpoints/docs/openapi/planning-cloud-projects)
  + [Deleting an API and Instances](/endpoints/docs/openapi/deleting-an-api-and-instances)
  + [Restoring a Managed Service](/endpoints/docs/openapi/restore-managed-service)
* Limiting API Requests
  + [About Quotas](/endpoints/docs/openapi/quotas-overview)
  + [Configuring Quotas](/endpoints/docs/openapi/quotas-configure)
  + [Overriding the Default Limit](/endpoints/docs/openapi/quotas-override)
* Customizing ESP
  + [Using a Custom nginx.conf on GKE](/endpoints/docs/openapi/custom-nginx)
  + [Creating a Custom nginx.conf to Support CORS](/endpoints/docs/openapi/custom-cors-nginx)
* [Migrate to ESPv2](/endpoints/docs/openapi/migrate-to-esp-v2)
* Concepts
* [About Cloud Endpoints](/endpoints/docs/openapi/about-cloud-endpoints)
* [Cloud Endpoints Architecture](/endpoints/docs/openapi/architecture-overview)
* [OpenAPI Overview](/endpoints/docs/openapi/openapi-overview)

* [AI and ML](/docs/ai-ml)
* [Application development](/docs/application-development)
* [Application hosting](/docs/application-hosting)
* [Compute](/docs/compute-area)
* [Data analytics and pipelines](/docs/data)
* [Databases](/docs/databases)
* [Distributed, hybrid, and multicloud](/docs/dhm-cloud)
* [Generative AI](/docs/generative-ai)
* [Industry solutions](/docs/industry)
* [Networking](/docs/networking)
* [Observability and monitoring](/docs/observability)
* [Security](/docs/security)
* [Storage](/docs/storage)

* [Access and resources management](/docs/access-resources)
* [Costs and usage management](/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](/docs/devtools)
* [Infrastructure as code](/docs/iac)
* [Migration](/docs/migration)

* [Google Cloud Home](/)
* [Free Trial and Free Tier](/free)
* [Architecture Center](/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](/contact)
* [Google Cloud Developer Center](/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](/solutions)
* [Google Cloud Support](/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

* [Home](https://cloud.google.com/)
* [Cloud Endpoints](https://cloud.google.com/endpoints)
* [Documentation](https://cloud.google.com/endpoints/docs)
* [OpenAPI](https://cloud.google.com/endpoints/docs/openapi)

Send feedback

# Using Google ID tokens to authenticate users

Stay organized with collections

Save and categorize content based on your preferences.

OpenAPI
  |  gRPC

This page describes how to support user authentication in Cloud Endpoints.

To authenticate a user, a client application must send a
[JSON Web Token (JWT)](https://jwt.io/) in the authorization header of the
HTTP request to your backend API. The
[Extensible Service Proxy (ESP)](/endpoints/docs/glossary#extensible_service_proxy)
validates the token on behalf of your API, so you don't have to add any code in
your API to process the authentication. However, you do need to configure your
OpenAPI document to support your chosen authentication methods.

ESP validates a JWT in a performant way by using the JWT's
issuer's public keys. ESP caches the public keys for five
minutes. In addition, ESP caches validated JWTs for five minutes
or until JWT expiry, whichever happens first.

## Before you begin

* Add authentication code to your client application that allows users to
  authenticate by signing in with Google account.

* When your client application sends an HTTP request, the authorization header in
  the request must contain the following JWT claims:
  + `iss` (issuer)
  + `sub` (subject)
  + `aud` (audience)
  + `iat` (issued at)
  + `exp` (expiration time)

## Configuring ESP to support client authentication

You must have a [security
requirement object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#securityRequirementObject) and a [security
definitions object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#securityDefinitionsObject) in your OpenAPI document for ESP to
validate the claims in the signed JWT.

To support authentication using a Google ID token:

1. Add the following to the security definition in your OpenAPI
   document:

   ```
     securityDefinitions:
       google_id_token:
         authorizationUrl: ""
         flow: "implicit"
         type: "oauth2"
         x-google-issuer: "https://accounts.google.com"
         x-google-jwks_uri: "https://www.googleapis.com/oauth2/v3/certs"
         # Optional. Replace YOUR-CLIENT-ID with your client ID
         x-google-audiences: "YOUR-CLIENT-ID"

   ```
2. Add a security section at either the API level to apply to the entire
   API, or at the method level to apply to a specific method.

   ```
     security:
       - google_id_token: []

   ```

You can define multiple security definitions in the OpenAPI document, but each
definition must have a different issuer. If you use security sections at both
the API level and at the method level, the method-level settings override the
API-level settings.

The `x-google-audiences` field isn't required. ESP
accepts all JWTs with the backend service name in the form of
`https://SERVICE_NAME` in the `aud` claim. To
allow additional client IDs to access the backend service, you can specify the
allowed client IDs in the `x-google-audiences` field by using
comma-separated values. ESP then accepts the JWTs with any of the
specified client IDs in the `aud` claim.

You may also customize JWT locations by adding `x-google-extensions`. For details, see [openAPI extensions](/endpoints/docs/openapi/openapi-extensions#x-google-jwt-locations).

## Making an authenticated call to an Endpoints API

When you send a request using an authentication token, for security reasons, we
recommend that you put the token in the `Authorization:Bearer` header. For
example:

```
curl -H "Authorization: Bearer ${TOKEN}" "${ENDPOINTS_HOST}/echo"

```

Here, `ENDPOINTS_HOST` and `TOKEN` are environment variables containing your
API host name and authentication token, respectively. See
[Making an authenticated request to an Endpoints API](/endpoints/docs/openapi/service-account-authentication#making_an_authenticated_request).
for sample code that sends a request using the `Authorization:Bearer` header.

If you cannot use the header when sending the request, you can put the
authentication token in a query parameter called `access_token`. For example:

```
curl "${ENDPOINTS_HOST}/echo?access_token=${TOKEN}"

```
## Receiving auth results in your API

ESP usually forwards all headers it receives. However, it overrides the
original `Authorization` header when the backend address is specified by
`x-google-backend` in OpenAPI specification or `BackendRule`
in gRPC service configuration.

ESP will send the authentication result in the `X-Endpoint-API-UserInfo`
to the backend API. We recommend using this header instead of the original
`Authorization` header. This header is a string that `base64url` encodes
a JSON object. The JSON object format differs between ESPv2 and ESP.
For ESPv2, the JSON object is exactly the original JWT payload. For ESP,
the JSON object uses different field names and put original JWT payload under `claims` field.
See [Handle JWTs in the backend service](/endpoints/docs/openapi/migrate-to-esp-v2#handle-jwt)
for more information on the format.

## What's next

* [Troubleshooting JWT validation](/endpoints/docs/openapi/troubleshoot-jwt)
* [Authentication between services](/endpoints/docs/openapi/service-account-authentication)

Send feedback

Except as otherwise noted, the content of this page is licensed under the [Creative Commons Attribution 4.0 License](https://creativecommons.org/licenses/by/4.0/), and code samples are licensed under the [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0). For details, see the [Google Developers Site Policies](https://developers.google.com/site-policies). Java is a registered trademark of Oracle and/or its affiliates.

Last updated 2025-01-08 UTC.

Need to tell us more?

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Hard to understand","hardToUnderstand","thumb-down"],["Incorrect information or sample code","incorrectInformationOrSampleCode","thumb-down"],["Missing the information/samples I need","missingTheInformationSamplesINeed","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2025-01-08 UTC."],[],[]]

* ### Why Google

  + [Choosing Google Cloud](/why-google-cloud/)
  + [Trust and security](/trust-center/)
  + [Modern Infrastructure Cloud](/solutions/modern-infrastructure/)
  + [Multicloud](/multicloud/)
  + [Global infrastructure](/infrastructure/)
  + [Customers and case studies](/customers/)
  + [Analyst reports](/analyst-reports/)
  + [Whitepapers](/whitepapers/)
  + [Blog](//cloud.google.com/blog/)
* ### Products and pricing

  + [Google Cloud pricing](/pricing/)
  + [Google Workspace pricing](//workspace.google.com/pricing.html)
  + [See all products](/products/)
* ### Solutions

  + [Infrastructure modernization](/solutions/infrastructure-modernization/)
  + [Databases](/solutions/databases/)
  + [Application modernization](/solutions/application-modernization/)
  + [Smart analytics](/solutions/smart-analytics/)
  + [Artificial Intelligence](/solutions/ai/)
  + [Security](/solutions/security/)
  + [Productivity & work transformation](https://workspace.google.com/enterprise/)
  + [Industry solutions](/solutions/#industry-solutions)
  + [DevOps solutions](/solutions/devops/)
  + [Small business solutions](/solutions/#section-14)
  + [See all solutions](/solutions/)
* ### Resources

  + [Google Cloud Affiliate Program](/affiliate-program/)
  + [Google Cloud documentation](/docs/)
  + [Google Cloud quickstarts](/docs/get-started/)
  + [Google Cloud Marketplace](/marketplace/)
  + [Learn about cloud computing](/discover/)
  + [Support](/support-hub/)
  + [Code samples](/docs/samples)
  + [Cloud Architecture Center](/architecture/)
  + [Training](/learn/training/)
  + [Certifications](/learn/certification/)
  + [Google for Developers](//developers.google.com)
  + [Google Cloud for Startups](/startup/)
  + [System status](//status.cloud.google.com)
  + [Release Notes](/release-notes)
* ### Engage

  + [Contact sales](/contact/)
  + [Find a Partner](//cloud.google.com/find-a-partner)
  + [Become a Partner](/partners/become-a-partner/)
  + [Events](/events/)
  + [Podcasts](/podcasts/)
  + [Developer Center](/developers/)
  + [Press Corner](https://www.googlecloudpresscorner.com/)
  + [Google Cloud on YouTube](//www.youtube.com/googlecloud)
  + [Google Cloud Tech on YouTube](//www.youtube.com/googlecloudplatform)
  + [Follow on X](//x.com/googlecloud)
  + [Join User Research](//userresearch.google.com/?reserved=1&utm_source=website&Q_Language=en&utm_medium=own_srch&utm_campaign=CloudWebFooter&utm_term=0&utm_content=0&productTag=clou&campaignDate=jul19&pType=devel&referral_code=jk212693)
  + [We're hiring. Join Google Cloud!](//careers.google.com/cloud)
  + [Google Cloud Community](https://www.googlecloudcommunity.com/)

* [About Google](//about.google/)
* [Privacy](//policies.google.com/privacy)
* [Site terms](//www.google.com/intl/en/policies/terms/regional.html)
* [Google Cloud terms](/product-terms/)
* Manage cookies
* [Our third decade of climate action: join us](/sustainability)
* Sign up for the Google Cloud newsletter
  [Subscribe](/newsletter/)

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어



=== Content from github.com_129a669c_20250114_212728.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Fcommit%2Fe310c4f91d229a072507f80c73811489b4cdff27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Fcommit%2Fe310c4f91d229a072507f80c73811489b4cdff27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cloudendpoints%2Fesp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cloudendpoints](/cloudendpoints)
/
**[esp](/cloudendpoints/esp)**
Public

* [Notifications](/login?return_to=%2Fcloudendpoints%2Fesp) You must be signed in to change notification settings
* [Fork
  74](/login?return_to=%2Fcloudendpoints%2Fesp)
* [Star
   281](/login?return_to=%2Fcloudendpoints%2Fesp)

* [Code](/cloudendpoints/esp)
* [Issues
  22](/cloudendpoints/esp/issues)
* [Pull requests
  3](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects
  0](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

Additional navigation options

* [Code](/cloudendpoints/esp)
* [Issues](/cloudendpoints/esp/issues)
* [Pull requests](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

## Commit

[Permalink](/cloudendpoints/esp/commit/e310c4f91d229a072507f80c73811489b4cdff27)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Remove X-Endpoint-API-UserInfo for all header occurrences. ([#845](https://github.com/cloudendpoints/esp/pull/845))

[Browse files](/cloudendpoints/esp/tree/e310c4f91d229a072507f80c73811489b4cdff27)
Browse the repository at this point in the history

* Loading branch information

[![@shuoyang2016](https://avatars.githubusercontent.com/u/6464547?s=40&v=4)](/shuoyang2016)

[shuoyang2016](/cloudendpoints/esp/commits?author=shuoyang2016 "View all commits by shuoyang2016")
authored
Aug 31, 2021

1 parent
[4692ea4](/cloudendpoints/esp/commit/4692ea439118d1283262c9ebb6bfddbca3c5ce52)

commit e310c4f

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**62 additions**
and
**37 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include/api\_manager

  + include/api\_manager/request.h
    [request.h](#diff-29acbac767298536e9d951dd3417604993b098799dcf06aa2c070625b56db0d5)
* src

  + api\_manager

    - src/api\_manager/check\_auth.cc
      [check\_auth.cc](#diff-9bc875e346d5f50ab0050d842ec53e2fe8eaccc4b80a243eb12fa994773d19e9)
    - src/api\_manager/check\_auth\_test.cc
      [check\_auth\_test.cc](#diff-8d205d1c65a3723ea98987361f74d722d6cc85d0bafc5951a16713892451848b)
    - src/api\_manager/check\_service\_control.cc
      [check\_service\_control.cc](#diff-b2b6823d05f07db41ac747627ff4c3a5bfa4309a2ccd7a4345b70ae820ef89c4)
    - context

      * src/api\_manager/context/client\_ip\_extraction\_test.cc
        [client\_ip\_extraction\_test.cc](#diff-9ceaef99686add5d1b5e0359c42946d8c66403e88a79976ffe3a89bc49cc2184)
      * src/api\_manager/context/request\_context.cc
        [request\_context.cc](#diff-12e7573a63880d13a15d36de4fd007063763757d7b1aa262bb3baa972c8b0843)
    - src/api\_manager/mock\_request.h
      [mock\_request.h](#diff-bea1915ab94e7b4bf577aef6b91912d516e9af85ffe4acb92ee34988961a0ecf)
    - src/api\_manager/request\_handler.cc
      [request\_handler.cc](#diff-4ee4bb15ddefde1cc3c4e2810a7b63126d65d4871ba1e8c292b80edca374f720)
  + nginx

    - src/nginx/request.cc
      [request.cc](#diff-bab3c43c27d804d219ee8d611b996f4738650e15429ea420aa1eedadcc20cb2f)
    - src/nginx/request.h
      [request.h](#diff-dca04c8db74111b8062c9eb242737aaf493b030e36aa50fd3e08c7370f190710)
    - t

      * src/nginx/t/ApiManager.pm
        [ApiManager.pm](#diff-a94d467880a40cd5c42eb17318b7afc03f619f5bcd0e75d7ea0e762a5dd9cb7b)
      * src/nginx/t/auth\_remove\_user\_info.t
        [auth\_remove\_user\_info.t](#diff-0e8b87109178200f8484d226f18717329f4817549960f4c748905e5e8a3fb2db)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[include/api\_manager/request.h](#diff-29acbac767298536e9d951dd3417604993b098799dcf06aa2c070625b56db0d5 "include/api_manager/request.h")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/include/api_manager/request.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -74,7 +74,8 @@ class Request { |
|  |  |  |
|  |  | // Adds a header to backend. If the header exists, overwrite its value |
|  |  | virtual utils::Status AddHeaderToBackend(const std::string &key, |
|  |  | const std::string &value) = 0; |
|  |  | const std::string &value, |
|  |  | bool changeAllOccurrence) = 0; |
|  |  | }; |
|  |  |  |
|  |  | } // namespace api\_manager |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/api\_manager/check\_auth.cc](#diff-9bc875e346d5f50ab0050d842ec53e2fe8eaccc4b80a243eb12fa994773d19e9 "src/api_manager/check_auth.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/check_auth.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -393,7 +393,7 @@ void AuthChecker::PassUserInfoOnSuccess() { |
|  |  | char \*base64\_json\_buf = auth::esp\_base64\_encode( |
|  |  | json\_buf, strlen(json\_buf), true, false, true /\*padding\*/); |
|  |  | context\_->request()->AddHeaderToBackend(auth::kEndpointApiUserInfo, |
|  |  | base64\_json\_buf); |
|  |  | base64\_json\_buf, false); |
|  |  | auth::esp\_grpc\_free(json\_buf); |
|  |  | auth::esp\_grpc\_free(base64\_json\_buf); |
|  |  |  |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[src/api\_manager/check\_auth\_test.cc](#diff-8d205d1c65a3723ea98987361f74d722d6cc85d0bafc5951a16713892451848b "src/api_manager/check_auth_test.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/check_auth_test.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -458,7 +458,7 @@ void CheckAuthTest::TestValidToken(const std::string &auth\_token, |
|  |  | })); |
|  |  | std::cout << "need be replaced: " << user\_info << std::endl; |
|  |  | EXPECT\_CALL(\*raw\_request\_, |
|  |  | AddHeaderToBackend(kEndpointApiUserInfo, user\_info)) |
|  |  | AddHeaderToBackend(kEndpointApiUserInfo, user\_info, false)) |
|  |  | .WillOnce(Return(utils::Status::OK)); |
|  |  |  |
|  |  | CheckAuth(context\_, [](Status status) { ASSERT\_TRUE(status.ok()); }); |
| Expand Down  Expand Up | | @@ -490,8 +490,8 @@ TEST\_F(CheckAuthTest, TestOKAuth) { |
|  |  | })); |
|  |  | EXPECT\_CALL(\*raw\_request\_, SetAuthToken(kToken)).Times(1); |
|  |  | EXPECT\_CALL(\*raw\_env\_, DoRunHTTPRequest(\_)).Times(0); |
|  |  | EXPECT\_CALL(\*raw\_request\_, |
|  |  | AddHeaderToBackend(kEndpointApiUserInfo, kUserInfo\_kSub\_kIss)) |
|  |  | EXPECT\_CALL(\*raw\_request\_, AddHeaderToBackend(kEndpointApiUserInfo, |
|  |  | kUserInfo\_kSub\_kIss, false)) |
|  |  | .WillOnce(Return(utils::Status::OK)); |
|  |  |  |
|  |  | CheckAuth(context\_, [](Status status) { ASSERT\_TRUE(status.ok()); }); |
| Expand All | | @@ -513,8 +513,8 @@ TEST\_F(CheckAuthTest, TestOKAuth) { |
|  |  | })); |
|  |  | EXPECT\_CALL(\*raw\_request\_, SetAuthToken(kToken2)).Times(1); |
|  |  | EXPECT\_CALL(\*raw\_env\_, DoRunHTTPRequest(\_)).Times(0); |
|  |  | EXPECT\_CALL(\*raw\_request\_, |
|  |  | AddHeaderToBackend(kEndpointApiUserInfo, kUserInfo\_kSub2\_kIss2)) |
|  |  | EXPECT\_CALL(\*raw\_request\_, AddHeaderToBackend(kEndpointApiUserInfo, |
|  |  | kUserInfo\_kSub2\_kIss2, false)) |
|  |  | .WillOnce(Return(utils::Status::OK)); |
|  |  |  |
|  |  | CheckAuth(context\_, [](Status status) { ASSERT\_TRUE(status.ok()); }); |
| Expand Down  Expand Up | | @@ -605,8 +605,8 @@ TEST\_F(CheckAuthTest, TestNoOpenId) { |
|  |  | std::map<std::string, std::string> empty; |
|  |  | req->OnComplete(Status::OK, std::move(empty), std::move(body)); |
|  |  | })); |
|  |  | EXPECT\_CALL(\*raw\_request\_, |
|  |  | AddHeaderToBackend(kEndpointApiUserInfo, kUserInfo\_kSub\_kIss2)) |
|  |  | EXPECT\_CALL(\*raw\_request\_, AddHeaderToBackend(kEndpointApiUserInfo, |
|  |  | kUserInfo\_kSub\_kIss2, false)) |
|  |  | .WillOnce(Return(utils::Status::OK)); |
|  |  |  |
|  |  | CheckAuth(context\_, [](Status status) { ASSERT\_TRUE(status.ok()); }); |
| Expand Down | |  |

5 changes: 3 additions & 2 deletions

5
[src/api\_manager/check\_service\_control.cc](#diff-b2b6823d05f07db41ac747627ff4c3a5bfa4309a2ccd7a4345b70ae820ef89c4 "src/api_manager/check_service_control.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/check_service_control.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,7 @@ |
|  |  | //////////////////////////////////////////////////////////////////////////////// |
|  |  | // includes should be ordered. This seems like a bug in clang-format? |
|  |  | #include "src/api\_manager/check\_service\_control.h" |
|  |  |  |
|  |  | #include "google/protobuf/stubs/status.h" |
|  |  | #include "src/api\_manager/cloud\_trace/cloud\_trace.h" |
|  |  |  |
| Expand Down  Expand Up | | @@ -85,8 +86,8 @@ void CheckServiceControl(std::shared\_ptr<context::RequestContext> context, |
|  |  |  |
|  |  | // update consumer\_project\_id to service context |
|  |  | if (!info.consumer\_project\_id.empty()) { |
|  |  | context->request()->AddHeaderToBackend(kConsumerProjecId, |
|  |  | info.consumer\_project\_id); |
|  |  | context->request()->AddHeaderToBackend( |
|  |  | kConsumerProjecId, info.consumer\_project\_id, false); |
|  |  | } |
|  |  |  |
|  |  | continuation(status); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/api\_manager/context/client\_ip\_extraction\_test.cc](#diff-9ceaef99686add5d1b5e0359c42946d8c66403e88a79976ffe3a89bc49cc2184 "src/api_manager/context/client_ip_extraction_test.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/context/client_ip_extraction_test.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -117,8 +117,8 @@ class MockRequest : public Request { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | MOCK\_METHOD2(AddHeaderToBackend, |
|  |  | utils::Status(const std::string &, const std::string &)); |
|  |  | MOCK\_METHOD3(AddHeaderToBackend, |
|  |  | utils::Status(const std::string &, const std::string &, bool)); |
|  |  | MOCK\_METHOD1(SetAuthToken, void(const std::string &)); |
|  |  | MOCK\_METHOD0(GetFrontendProtocol, |
|  |  | ::google::api\_manager::protocol::Protocol()); |
| Expand Down | |  |

18 changes: 10 additions & 8 deletions

18
[src/api\_manager/context/request\_context.cc](#diff-12e7573a63880d13a15d36de4fd007063763757d7b1aa262bb3baa972c8b0843 "src/api_manager/context/request_context.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/context/request_context.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,15 +16,17 @@ |
|  |  | // |
|  |  |  |
|  |  | #include "src/api\_manager/context/request\_context.h" |
|  |  | #include "google/api/backend.pb.h" |
|  |  | #include "src/api\_manager/auth/lib/json\_util.h" |
|  |  | #include "src/api\_manager/utils/str\_util.h" |
|  |  |  |
|  |  | #include <uuid/uuid.h> |
|  |  |  |
|  |  | #include <numeric> |
|  |  | #include <sstream> |
|  |  | #include <vector> |
|  |  |  |
|  |  | #include "google/api/backend.pb.h" |
|  |  | #include "src/api\_manager/auth/lib/json\_util.h" |
|  |  | #include "src/api\_manager/utils/str\_util.h" |
|  |  |  |
|  |  | using ::google::api\_manager::auth::GetPrimitiveFieldValue; |
|  |  | using ::google::api\_manager::cloud\_trace::HeaderType; |
|  |  | using ::google::api\_manager::utils::Status; |
| Expand Down  Expand Up | | @@ -208,7 +210,7 @@ void RequestContext::ExtractApiKey() { |
|  |  | } |
|  |  |  |
|  |  | void RequestContext::SetApiKeyHeader() { |
|  |  | request\_->AddHeaderToBackend(kDefaultApiKeyHeaderName, api\_key\_); |
|  |  | request\_->AddHeaderToBackend(kDefaultApiKeyHeaderName, api\_key\_, false); |
|  |  | } |
|  |  |  |
|  |  | void RequestContext::CompleteCheck(Status status) { |
| Expand Down  Expand Up | | @@ -434,7 +436,7 @@ void RequestContext::StartBackendSpanAndSetTraceContext() { |
|  |  | cloud\_trace()->header\_type() == HeaderType::CLOUD\_TRACE\_CONTEXT |
|  |  | ? kCloudTraceContextHeader |
|  |  | : kGRpcTraceContextHeader, |
|  |  | trace\_context\_header); |
|  |  | trace\_context\_header, false); |
|  |  | if (!status.ok()) { |
|  |  | service\_context()->env()->LogError( |
|  |  | "Failed to set trace context header to backend."); |
| Expand Down  Expand Up | | @@ -535,14 +537,14 @@ void RequestContext::AddInstanceIdentityToken() { |
|  |  | std::string origin\_auth\_header; |
|  |  | if (request()->FindHeader(kAuthorizationHeader, &origin\_auth\_header)) { |
|  |  | Status status = request()->AddHeaderToBackend( |
|  |  | kXForwardedAuthorizationHeader, origin\_auth\_header); |
|  |  | kXForwardedAuthorizationHeader, origin\_auth\_header, false); |
|  |  | if (!status.ok()) { |
|  |  | service\_context()->env()->LogError( |
|  |  | "Failed to set X-Forwarded-Authorization header to backend."); |
|  |  | } |
|  |  | } |
|  |  | Status status = request()->AddHeaderToBackend(kAuthorizationHeader, |
|  |  | kBearerPrefix + token); |
|  |  | Status status = request()->AddHeaderToBackend( |
|  |  | kAuthorizationHeader, kBearerPrefix + token, false); |
|  |  | if (!status.ok()) { |
|  |  | service\_context()->env()->LogError( |
|  |  | "Failed to set authorization header to backend."); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/api\_manager/mock\_request.h](#diff-bea1915ab94e7b4bf577aef6b91912d516e9af85ffe4acb92ee34988961a0ecf "src/api_manager/mock_request.h")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/mock_request.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,8 +25,8 @@ class MockRequest : public Request { |
|  |  | public: |
|  |  | MOCK\_METHOD2(FindQuery, bool(const std::string &, std::string \*)); |
|  |  | MOCK\_METHOD2(FindHeader, bool(const std::string &, std::string \*)); |
|  |  | MOCK\_METHOD2(AddHeaderToBackend, |
|  |  | utils::Status(const std::string &, const std::string &)); |
|  |  | MOCK\_METHOD3(AddHeaderToBackend, |
|  |  | utils::Status(const std::string &, const std::string &, bool)); |
|  |  | MOCK\_METHOD1(SetAuthToken, void(const std::string &)); |
|  |  | MOCK\_METHOD0(GetRequestHTTPMethod, std::string()); |
|  |  | MOCK\_METHOD0(GetQueryParameters, std::string()); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/api\_manager/request\_handler.cc](#diff-4ee4bb15ddefde1cc3c4e2810a7b63126d65d4871ba1e8c292b80edca374f720 "src/api_manager/request_handler.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/api_manager/request_handler.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,7 +43,7 @@ RequestHandler::RequestHandler( |
|  |  | if (context\_->request()->FindHeader( |
|  |  | google::api\_manager::auth::kEndpointApiUserInfo, &buffer)) { |
|  |  | context\_->request()->AddHeaderToBackend( |
|  |  | google::api\_manager::auth::kEndpointApiUserInfo, ""); |
|  |  | google::api\_manager::auth::kEndpointApiUserInfo, "", true); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

32 changes: 21 additions & 11 deletions

32
[src/nginx/request.cc](#diff-bab3c43c27d804d219ee8d611b996f4738650e15429ea420aa1eedadcc20cb2f "src/nginx/request.cc")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/nginx/request.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -146,18 +146,21 @@ void NgxEspRequest::SetAuthToken(const std::string &auth\_token) { |
|  |  | } |
|  |  |  |
|  |  | utils::Status NgxEspRequest::AddHeaderToBackend(const std::string &key, |
|  |  | const std::string &value) { |
|  |  | ngx\_table\_elt\_t \*h = nullptr; |
|  |  | const std::string &value, |
|  |  | bool changeAllOccurrence) { |
|  |  | std::vector<ngx\_table\_elt\_t \*> headers; |
|  |  | for (auto &h\_in : r\_->headers\_in) { |
|  |  | if (key.size() == h\_in.key.len && |
|  |  | strncasecmp(key.c\_str(), reinterpret\_cast<const char \*>(h\_in.key.data), |
|  |  | h\_in.key.len) == 0) { |
|  |  | h = &h\_in; |
|  |  | break; |
|  |  | headers.push\_back(&h\_in); |
|  |  | if (!changeAllOccurrence) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | if (h == nullptr) { |
|  |  | h = reinterpret\_cast<ngx\_table\_elt\_t \*>( |
|  |  | if (headers.empty()) { |
|  |  | ngx\_table\_elt\_t \*h = reinterpret\_cast<ngx\_table\_elt\_t \*>( |
|  |  | ngx\_list\_push(&r\_->headers\_in.headers)); |
|  |  | if (h == nullptr) { |
|  |  | return utils::Status(Code::INTERNAL, "Out of memory"); |
| Expand All | | @@ -172,14 +175,21 @@ utils::Status NgxEspRequest::AddHeaderToBackend(const std::string &key, |
|  |  | h->lowcase\_key, |
|  |  | reinterpret\_cast<u\_char \*>(const\_cast<char \*>(key.c\_str())), |
|  |  | key.size()); |
|  |  | headers.push\_back(h); |
|  |  | } |
|  |  |  |
|  |  | if (ngx\_str\_copy\_from\_std(r\_->pool, key, &h->key) != NGX\_OK || |
|  |  | ngx\_str\_copy\_from\_std(r\_->pool, value, &h->value) != NGX\_OK) { |
|  |  | return utils::Status(Code::INTERNAL, "Out of memory"); |
|  |  | for (size\_t i = 0; i < headers.size(); ++i) { |
|  |  | ngx\_table\_elt\_t \*it = headers[i]; |
|  |  | if (ngx\_str\_copy\_from\_std(r\_->pool, key, &it->key) != NGX\_OK || |
|  |  | ngx\_str\_copy\_from\_std(r\_->pool, value, &it->value) != NGX\_OK) { |
|  |  | return utils::Status(Code::INTERNAL, "Out of memory"); |
|  |  | } |
|  |  | } |
|  |  | ngx\_log\_debug2(NGX\_LOG\_DEBUG\_HTTP, r\_->connection->log, 0, |
|  |  | "updates header to backend: \"%V: %V\"", &h->key, &h->value); |
|  |  |  |
|  |  | ngx\_log\_debug3( |
|  |  | NGX\_LOG\_DEBUG\_HTTP, r\_->connection->log, 0, |
|  |  | "updates header to backend, changeAllOccurrence: '%t', \"%V: %V\"", |
|  |  | changeAllOccurrence, &h->key, &h->value); |
|  |  | return utils::Status::OK; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/nginx/request.h](#diff-dca04c8db74111b8062c9eb242737aaf493b030e36aa50fd3e08c7370f190710 "src/nginx/request.h")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/nginx/request.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,7 +57,8 @@ class NgxEspRequest : public Request { |
|  |  |  |
|  |  | virtual void SetAuthToken(const std::string &auth\_token); |
|  |  | virtual utils::Status AddHeaderToBackend(const std::string &key, |
|  |  | const std::string &value); |
|  |  | const std::string &value, |
|  |  | bool changeAllOccurrence); |
|  |  | virtual bool FindQuery(const std::string &name, std::string \*query); |
|  |  | virtual bool FindHeader(const std::string &name, std::string \*header); |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[src/nginx/t/ApiManager.pm](#diff-a94d467880a40cd5c42eb17318b7afc03f619f5bcd0e75d7ea0e762a5dd9cb7b "src/nginx/t/ApiManager.pm")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/nginx/t/ApiManager.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -456,6 +456,7 @@ sub read\_http\_stream { |
|  |  | 'path' => $path, |
|  |  | 'uri' => $uri, |
|  |  | 'headers' => \%headers, |
|  |  | 'header\_lines' => \@header\_lines, |
|  |  | 'body' => $body |
|  |  | }; |
|  |  |  |
| Expand Down | |  |

11 changes: 10 additions & 1 deletion

11
[src/nginx/t/auth\_remove\_user\_info.t](#diff-0e8b87109178200f8484d226f18717329f4817549960f4c748905e5e8a3fb2db "src/nginx/t/auth_remove_user_info.t")

Show comments

[View file](/cloudendpoints/esp/blob/e310c4f91d229a072507f80c73811489b4cdff27/src/nginx/t/auth_remove_user_info.t)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,7 +42,7 @@ my $NginxPort = ApiManager::pick\_port(); |
|  |  | my $BackendPort = ApiManager::pick\_port(); |
|  |  | my $ServiceControlPort = ApiManager::pick\_port(); |
|  |  |  |
|  |  | my $t = Test::Nginx->new()->has(qw/http proxy/)->plan(14); |
|  |  | my $t = Test::Nginx->new()->has(qw/http proxy/)->plan(15); |
|  |  |  |
|  |  | # Save service name in the service configuration protocol buffer file. |
|  |  |  |
| Expand Down  Expand Up | | @@ -88,6 +88,7 @@ my $response = ApiManager::http($NginxPort,<<'EOF'); |
|  |  | GET /shelves?key=this-is-an-api-key HTTP/1.0 |
|  |  | Host: localhost |
|  |  | x-endpoint-api-userinfo: Should be removed |
|  |  | x-endpoint-api-userinfo: Multiple userinfo should all be removed |
|  |  |  |
|  |  | EOF |
|  |  |  |
| Expand All | | @@ -114,6 +115,14 @@ is($r->{uri}, '/shelves?key=this-is-an-api-key', 'Backend uri was /shelves'); |
|  |  | is($r->{headers}->{host}, "127.0.0.1:${BackendPort}", 'Host header was set'); |
|  |  | is($r->{headers}->{'x-endpoint-api-userinfo'}, '', |
|  |  | 'X-Endpoint-API-UserInfo should be removed from the request headers'); |
|  |  | my $arr = $r->{header\_lines}; |
|  |  | my @userinfo\_list = (); |
|  |  |  |
|  |  | foreach (@$arr) { |
|  |  | push(@userinfo\_list, $\_) if index($\_, 'X-Endpoint-API-UserInfo') != -1; |
|  |  | } |
|  |  | is(join(",", @userinfo\_list), 'X-Endpoint-API-UserInfo: ,X-Endpoint-API-UserInfo: ', |
|  |  | "Multiple userinfo should all be removed"); |
|  |  |  |
|  |  | @requests = ApiManager::read\_http\_stream($t, 'servicecontrol.log'); |
|  |  | is(scalar @requests, 1, 'Service control received one request'); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e310c4f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Fcommit%2Fe310c4f91d229a072507f80c73811489b4cdff27) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_459369c9_20250114_212729.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Freleases%2Ftag%2Fv1.58.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcloudendpoints%2Fesp%2Freleases%2Ftag%2Fv1.58.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=cloudendpoints%2Fesp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cloudendpoints](/cloudendpoints)
/
**[esp](/cloudendpoints/esp)**
Public

* [Notifications](/login?return_to=%2Fcloudendpoints%2Fesp) You must be signed in to change notification settings
* [Fork
  74](/login?return_to=%2Fcloudendpoints%2Fesp)
* [Star
   281](/login?return_to=%2Fcloudendpoints%2Fesp)

* [Code](/cloudendpoints/esp/tree/v1.58.0)
* [Issues
  22](/cloudendpoints/esp/issues)
* [Pull requests
  3](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects
  0](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

Additional navigation options

* [Code](/cloudendpoints/esp/tree/v1.58.0)
* [Issues](/cloudendpoints/esp/issues)
* [Pull requests](/cloudendpoints/esp/pulls)
* [Actions](/cloudendpoints/esp/actions)
* [Projects](/cloudendpoints/esp/projects)
* [Security](/cloudendpoints/esp/security)
* [Insights](/cloudendpoints/esp/pulse)

1. [Releases](/cloudendpoints/esp/releases)
2. [v1.58.0](/cloudendpoints/esp/releases/tag/v1.58.0)

# Endpoints Runtime Release 1.58.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/cloudendpoints/esp/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.58.0)

 Loading

[View all tags](/cloudendpoints/esp/tags)

![@shuoyang2016](https://avatars.githubusercontent.com/u/6464547?s=40&v=4)
[shuoyang2016](/shuoyang2016)
released this
02 Sep 17:36

·
[16 commits](/cloudendpoints/esp/compare/v1.58.0...master)
to master
since this release

[v1.58.0](/cloudendpoints/esp/tree/v1.58.0)

[`55c5c60`](/cloudendpoints/esp/commit/55c5c60cebd41550b7479973ad7a024f8ca031b2)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

The release build was produced at [55c5c60](https://github.com/cloudendpoints/esp/commit/55c5c60cebd41550b7479973ad7a024f8ca031b2).

Docker image: gcr.io/endpoints-release/endpoints-runtime:1.58.0

Secure docker image: gcr.io/endpoints-release/endpoints-runtime-secure:1.58.0

Changes from release 1.57.0

* Remove X-Endpoint-API-UserInfo for all header occurrences. ([#845](https://github.com/cloudendpoints/esp/pull/845))

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


