=== Content from istio.io_be4f8e71_20250114_203422.html ===


* About
  + [Service mesh](/latest/about/service-mesh)
  + [Solutions](/latest/about/solutions)
  + [Case studies](/latest/about/case-studies)
  + [Ecosystem](/latest/about/ecosystem)
  + [Deployment](/latest/about/deployment)
  + [Training](/latest/about/training)
  + [FAQ](/latest/about/faq)
* [Blog](/latest/blog/)
* [News](/latest/news/)
* [Get involved](/latest/get-involved/)
* [Documentation](/latest/docs/)

[Try Istio](/latest/docs/setup/getting-started)

# ISTIO-SECURITY-2021-005

HTTP request paths with multiple slashes or escaped slash characters may bypass path based authorization rules.

May 11, 2021

| Disclosure Details | |
| --- | --- |
| CVE(s) | [CVE-2021-31920](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31920) |
| CVSS Impact Score | 8.1 [AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3aN%2fAC%3aL%2fPR%3aL%2fUI%3aN%2fS%3aU%2fC%3aH%2fI%3aH%2fA%3aN&version=3.1) |
| Affected Releases | All releases prior to 1.8.61.9.0 to 1.9.4 |

## Issue

Istio contains a remotely exploitable vulnerability where an HTTP request path with multiple slashes or escaped slash characters (`%2F` or `%5C`)
could potentially bypass an Istio authorization policy when path based authorization rules are used. Related Envoy CVE:
[`CVE-2021-29492`](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29492).

For example, assume an Istio cluster administrator defines an authorization DENY policy to reject the request at path `/admin`.
A request sent to the URL path `//admin` will NOT be rejected by the authorization policy.

According to the [RFC 3986](https://tools.ietf.org/html/rfc3986#section-6),
the path `//admin` with multiple slashes should technically be treated as a different path from the `/admin`.
However, some backend services choose to normalize the URL paths by merging multiple slashes to a single slash.
This can result in a bypass of the authorization policy (`//admin` does not match `/admin`) and a user can access the resource at path `/admin`
in the backend; this would represent a security incident.

## Am I impacted?

Your cluster is **impacted** by this vulnerability if you have authorization policies using `ALLOW action + notPaths field`
or `DENY action + paths field` patterns.
These patterns are vulnerable to unexpected policy bypasses and you should upgrade to fix the security issue as soon as possible.

The following is an example of vulnerable policy that uses `DENY action + paths field` pattern:

```

```
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
name: deny-path-admin
spec:
action: DENY
rules:
- to:
    - operation:
        paths: ["/admin"]
```

```

The following is another example of vulnerable policy that uses `ALLOW action + notPaths field` pattern:

```

```
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
name: allow-path-not-admin
spec:
action: ALLOW
rules:
- to:
    - operation:
        notPaths: ["/admin"]
```

```

Your cluster is **NOT impacted** by this vulnerability if:

* You don’t have authorization policies
* Your authorization policies don’t define `paths` or `notPaths` fields.
* Your authorization policies use `ALLOW action + paths field` or `DENY action + notPaths field` patterns.
  These patterns could only cause unexpected rejection instead of policy bypasses. The upgrade is optional for these cases.

## Mitigation

1. Update your cluster to the latest supported version.
   These versions support configuring the Envoy proxies in the system with more normalization options:

* Istio 1.8.6, if using 1.8.x
* Istio 1.9.5 or up
* The patch version specified by your cloud provider

1. Follow the [security best practices](/latest/docs/ops/best-practices/security/#authorization-policies)
   to configure your authorization policies.

## Credit

We would like to thank [`Ruilin`](https://github.com/Ruil1n) and `Test123` for discovering this issue.

[ISTIO-SECURITY-2021-007](/latest/news/security/istio-security-2021-007/ "Istio contains a remotely exploitable vulnerability where credentials specified in the Gateway and DestinationRule credentialName field can be accessed from different namespaces.")[ISTIO-SECURITY-2021-006](/latest/news/security/istio-security-2021-006/ "An external client can access unexpected services in the cluster, bypassing authorization checks, when a gateway is configured with AUTO_PASSTHROUGH routing configuration.")

---

English中文Українська

* [Terms and Conditions](https://www.linuxfoundation.org/legal/terms)|
  [Privacy policy](https://www.linuxfoundation.org/legal/privacy-policy)|
  [Trademarks](https://www.linuxfoundation.org/legal/trademark-usage)|
  [Edit this Page on GitHub](https://github.com/istio/istio.io/edit/release-1.24/content/en/news/security/istio-security-2021-005/index.md)

© 2024 the Istio Authors.
Version
Istio
1.24.2

* next release
* [older releases](https://istio.io/archive)

