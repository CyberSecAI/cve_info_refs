Based on the provided information, here's an analysis of CVE-2021-31864:

**Root Cause of Vulnerability:**
The mail handler in Redmine was not properly enforcing the `add_issue_notes` permission. This allowed users to add notes to issues via email even if they didn't have the necessary explicit permission, provided they had the `issue_edit` permission.

**Weaknesses/Vulnerabilities Present:**
- **Insufficient permission checks:** The mail handler bypassed the intended access control mechanisms related to adding notes to issues.

**Impact of Exploitation:**
- **Unauthorized addition of issue notes:** Users without the explicit `add_issue_notes` permission could add notes to issues by sending emails to the Redmine instance's mail handler. This could lead to:
    - **Tampering with issue information:** Malicious users could add misleading, incorrect, or unwanted notes to issues, potentially disrupting workflows.
    - **Disclosure of sensitive information:** Users could add sensitive information to issues via email, which would then be visible to other users.

**Attack Vectors:**
- **Email:** Exploitation is done via sending crafted emails to the mail handler.

**Required Attacker Capabilities/Position:**
- **Access to the Redmine mail handler:** Attackers need to be able to send emails to the Redmine instance's configured mail handler.
- **Issue edit permission:** Attackers would need the `issue_edit` permission on a project.
- **No need for explicit `add_issue_notes` permission:** The vulnerability bypasses the need for this specific permission.

**Additional Notes:**
- The vulnerability was present in all versions since Redmine 3.3.0 and fixed in versions 4.2.1, 4.1.3, and 4.0.9
- The vulnerability was related to the change in behavior when tracker role-based permissions were added. Before version 3.3.0, users only needed `issue_edit` permission to add notes to issues, this was changed when `add_issue_notes` was explicitly required in the UI, however, not in the mail handler initially. This was fixed in version 4.0.9.