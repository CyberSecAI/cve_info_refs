=== Content from github.com_37ca25dc_20250115_230348.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Freleases%2Ftag%2Fv7.1.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Freleases%2Ftag%2Fv7.1.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=keepkey%2Fkeepkey-firmware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[keepkey](/keepkey)
/
**[keepkey-firmware](/keepkey/keepkey-firmware)**
Public

* [Notifications](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)
* [Star
   157](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)

* [Code](/keepkey/keepkey-firmware/tree/v7.1.0)
* [Issues
  14](/keepkey/keepkey-firmware/issues)
* [Pull requests
  0](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

Additional navigation options

* [Code](/keepkey/keepkey-firmware/tree/v7.1.0)
* [Issues](/keepkey/keepkey-firmware/issues)
* [Pull requests](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

1. [Releases](/keepkey/keepkey-firmware/releases)
2. [v7.1.0](/keepkey/keepkey-firmware/releases/tag/v7.1.0)

# Release v7.1.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/keepkey/keepkey-firmware/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v7.1.0)

 Loading

[View all tags](/keepkey/keepkey-firmware/tags)

![@markrypto](https://avatars.githubusercontent.com/u/59710988?s=40&v=4)
[markrypto](/markrypto)
released this
14 Apr 18:24

·
[333 commits](/keepkey/keepkey-firmware/compare/v7.1.0...master)
to master
since this release

[v7.1.0](/keepkey/keepkey-firmware/tree/v7.1.0)

[`930d6ad`](/keepkey/keepkey-firmware/commit/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Thorchain ADD liquidity parsing and confirm

Uniswap liquidity tx parsing and confirm

[Security improvements](https://shapeshift.com/library/keepkey-important-update-issued-april-4-required)

Bug fixes

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bd611560_20250115_102746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2Fe49d45594002d4d3fbc1f03488e6dfc0a0a65836)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2Fe49d45594002d4d3fbc1f03488e6dfc0a0a65836)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=keepkey%2Fkeepkey-firmware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[keepkey](/keepkey)
/
**[keepkey-firmware](/keepkey/keepkey-firmware)**
Public

* [Notifications](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)
* [Star
   157](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)

* [Code](/keepkey/keepkey-firmware)
* [Issues
  14](/keepkey/keepkey-firmware/issues)
* [Pull requests
  0](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

Additional navigation options

* [Code](/keepkey/keepkey-firmware)
* [Issues](/keepkey/keepkey-firmware/issues)
* [Pull requests](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

## Commit

[Permalink](/keepkey/keepkey-firmware/commit/e49d45594002d4d3fbc1f03488e6dfc0a0a65836)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

710 merge

[Browse files](/keepkey/keepkey-firmware/tree/e49d45594002d4d3fbc1f03488e6dfc0a0a65836)
Browse the repository at this point in the history

* Loading branch information

[![@markrypto](https://avatars.githubusercontent.com/u/59710988?s=40&v=4)](/markrypto)

[markrypto](/keepkey/keepkey-firmware/commits?author=markrypto "View all commits by markrypto")
committed
Apr 14, 2021

1 parent
[3ddcc5d](/keepkey/keepkey-firmware/commit/3ddcc5de9f4e97567332235b40896c28565faa90)

commit e49d455

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**3 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* deps

  + deps/python-keepkey
    [python-keepkey](#diff-1423d441da208f493d6c0b660ad114b236c2a53151f0b90311431365ca80029b)
* lib/firmware

  + lib/firmware/ethereum.c
    [ethereum.c](#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bc)
  + ethereum\_contracts

    - lib/firmware/ethereum\_contracts/zxliquidtx.c
      [zxliquidtx.c](#diff-ad4525c6491089135e973fd9d9ad1d5fcb6ea8a926e3b3c113efc96fda544b33)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[deps/python-keepkey](#diff-1423d441da208f493d6c0b660ad114b236c2a53151f0b90311431365ca80029b "deps/python-keepkey")

Show comments

Submodule [python-keepkey](https://github.com/keepkey/python-keepkey)
updated
[2 files](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9)

| +4  −33 |  | [tests/test\_msg\_ethereum\_erc20\_0x\_signtx.py](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9#diff-0ae83f6eab24ceca9cf4385e370eea305c89e3a487f29f977ba98009af0b04d3) |
| --- | --- | --- |
| +119  −0 |  | [tests/test\_msg\_ethereum\_erc20\_uniswap\_liquidity.py](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9#diff-4bbc21fcedf41dcf9999ccced7d9138dc72fff0d77d92c0960b923340c0393ee) |

4 changes: 2 additions & 2 deletions

4
[lib/firmware/ethereum.c](#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bc "lib/firmware/ethereum.c")

Show comments

[View file](/keepkey/keepkey-firmware/blob/e49d45594002d4d3fbc1f03488e6dfc0a0a65836/lib/firmware/ethereum.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,10 +93,10 @@ uint8\_t ethereum\_extractThorchainData(const EthereumSignTx \*msg, |
|  |  | // offset = deposit function hash + address + address + uint256 |
|  |  | uint16\_t offset = 4 + (5 \* 32); |
|  |  | int16\_t len = msg->data\_length - offset; |
|  |  | if (msg->has\_data\_length && len > 0) { |
|  |  | if (msg->has\_data\_length && len > 0 && len < 256) { |
|  |  | memcpy(buffer, msg->data\_initial\_chunk.bytes + offset, len); |
|  |  | // String length must be < 255 characters |
|  |  | return len < 256 ? (uint8\_t)len : 0; |
|  |  | return (uint8\_t)len; |
|  |  | } |
|  |  | return 0; |
|  |  | } |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[lib/firmware/ethereum\_contracts/zxliquidtx.c](#diff-ad4525c6491089135e973fd9d9ad1d5fcb6ea8a926e3b3c113efc96fda544b33 "lib/firmware/ethereum_contracts/zxliquidtx.c")

Show comments

[View file](/keepkey/keepkey-firmware/blob/e49d45594002d4d3fbc1f03488e6dfc0a0a65836/lib/firmware/ethereum_contracts/zxliquidtx.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -168,7 +168,6 @@ bool zx\_confirmZxLiquidTx(uint32\_t data\_total, const EthereumSignTx \*msg) { |
|  |  | confirm(ButtonRequestType\_ButtonRequest\_ConfirmOutput, arStr, |
|  |  | "Minimum %s", constr1); |
|  |  |  |
|  |  | snprintf(constr1, 32, "%lld", deadline); |
|  |  | confirm(ButtonRequestType\_ButtonRequest\_ConfirmOutput, arStr, |
|  |  | "Deadline %s", ctime((const time\_t \*)&deadline)); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e49d455`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2Fe49d45594002d4d3fbc1f03488e6dfc0a0a65836) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0ba5d939_20250115_140646.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2F930d6ada7a15b3fd00bfef78ec855ae6fa7cc870)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2F930d6ada7a15b3fd00bfef78ec855ae6fa7cc870)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=keepkey%2Fkeepkey-firmware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[keepkey](/keepkey)
/
**[keepkey-firmware](/keepkey/keepkey-firmware)**
Public

* [Notifications](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)
* [Star
   157](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)

* [Code](/keepkey/keepkey-firmware)
* [Issues
  14](/keepkey/keepkey-firmware/issues)
* [Pull requests
  0](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

Additional navigation options

* [Code](/keepkey/keepkey-firmware)
* [Issues](/keepkey/keepkey-firmware/issues)
* [Pull requests](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

## Commit

[Permalink](/keepkey/keepkey-firmware/commit/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#266](https://github.com/keepkey/keepkey-firmware/pull/266) from keepkey/pub-710

[Browse files](/keepkey/keepkey-firmware/tree/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870)
Browse the repository at this point in the history

```
710 merge
```

* Loading branch information

[![@markrypto](https://avatars.githubusercontent.com/u/59710988?s=40&v=4)](/markrypto)

[markrypto](/keepkey/keepkey-firmware/commits?author=markrypto "View all commits by markrypto")
authored
Apr 14, 2021

2 parents
[3ddcc5d](/keepkey/keepkey-firmware/commit/3ddcc5de9f4e97567332235b40896c28565faa90)
+
[e49d455](/keepkey/keepkey-firmware/commit/e49d45594002d4d3fbc1f03488e6dfc0a0a65836)

commit 930d6ad

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**3 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* deps

  + deps/python-keepkey
    [python-keepkey](#diff-1423d441da208f493d6c0b660ad114b236c2a53151f0b90311431365ca80029b)
* lib/firmware

  + lib/firmware/ethereum.c
    [ethereum.c](#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bc)
  + ethereum\_contracts

    - lib/firmware/ethereum\_contracts/zxliquidtx.c
      [zxliquidtx.c](#diff-ad4525c6491089135e973fd9d9ad1d5fcb6ea8a926e3b3c113efc96fda544b33)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[deps/python-keepkey](#diff-1423d441da208f493d6c0b660ad114b236c2a53151f0b90311431365ca80029b "deps/python-keepkey")

Show comments

Submodule [python-keepkey](https://github.com/keepkey/python-keepkey)
updated
[2 files](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9)

| +4  −33 |  | [tests/test\_msg\_ethereum\_erc20\_0x\_signtx.py](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9#diff-0ae83f6eab24ceca9cf4385e370eea305c89e3a487f29f977ba98009af0b04d3) |
| --- | --- | --- |
| +119  −0 |  | [tests/test\_msg\_ethereum\_erc20\_uniswap\_liquidity.py](/keepkey/python-keepkey/compare/89639c4f313da8f209f8ecca830dbc4758e033ce...f1a7acf54f4e31572d7361c25e6a0b6d006d54d9#diff-4bbc21fcedf41dcf9999ccced7d9138dc72fff0d77d92c0960b923340c0393ee) |

4 changes: 2 additions & 2 deletions

4
[lib/firmware/ethereum.c](#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bc "lib/firmware/ethereum.c")

Show comments

[View file](/keepkey/keepkey-firmware/blob/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870/lib/firmware/ethereum.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,10 +93,10 @@ uint8\_t ethereum\_extractThorchainData(const EthereumSignTx \*msg, |
|  |  | // offset = deposit function hash + address + address + uint256 |
|  |  | uint16\_t offset = 4 + (5 \* 32); |
|  |  | int16\_t len = msg->data\_length - offset; |
|  |  | if (msg->has\_data\_length && len > 0) { |
|  |  | if (msg->has\_data\_length && len > 0 && len < 256) { |
|  |  | memcpy(buffer, msg->data\_initial\_chunk.bytes + offset, len); |
|  |  | // String length must be < 255 characters |
|  |  | return len < 256 ? (uint8\_t)len : 0; |
|  |  | return (uint8\_t)len; |
|  |  | } |
|  |  | return 0; |
|  |  | } |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[lib/firmware/ethereum\_contracts/zxliquidtx.c](#diff-ad4525c6491089135e973fd9d9ad1d5fcb6ea8a926e3b3c113efc96fda544b33 "lib/firmware/ethereum_contracts/zxliquidtx.c")

Show comments

[View file](/keepkey/keepkey-firmware/blob/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870/lib/firmware/ethereum_contracts/zxliquidtx.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -168,7 +168,6 @@ bool zx\_confirmZxLiquidTx(uint32\_t data\_total, const EthereumSignTx \*msg) { |
|  |  | confirm(ButtonRequestType\_ButtonRequest\_ConfirmOutput, arStr, |
|  |  | "Minimum %s", constr1); |
|  |  |  |
|  |  | snprintf(constr1, 32, "%lld", deadline); |
|  |  | confirm(ButtonRequestType\_ButtonRequest\_ConfirmOutput, arStr, |
|  |  | "Deadline %s", ctime((const time\_t \*)&deadline)); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `930d6ad`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2Fcommit%2F930d6ada7a15b3fd00bfef78ec855ae6fa7cc870) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from shapeshift.com_63a7d486_20250115_230349.html ===
[**ShapeShift's Multichain Snap is LIVE! Connect your MetaMask wallet now and swap ETH for BTC ð¦****ShapeShift's Multichain Snap is LIVE! Connect your MetaMask wallet now and swap ETH for BTC ð¦**](https://app.shapeshift.com/)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/66fc0fc1b5448f2b2250a32e_fox_logo_mark.svg)](/)[Wallet](/defi-wallet)[Trade](/trade-crypto)[THORChain](/thorchain)[Earn](/earn-crypto)[Buy and Sell Crypto](https://app.shapeshift.com/#/demo/buy-crypto)[Supported Chains and Wallets](/supported-chains)Roadmap[Current Roadmap](/roadmap)[Gensis DAO Roadmap](/genesis-dao-roadmap)[Share Your Ideas](https://shapeshift.canny.io/)[Join Us](http://forum.shapeshift.com)[Launch dApp](https://app.shapeshift.com?utm_source=mainpage&utm_medium=launchdapp&utm_campaign=top)[Home](/)[Library](/library)KeepKey: Important Update (Issued April 12) Required
# KeepKey: Important Update (Issued April 12) Required

Important reminder to KeepKey users to update their firmware.

April 30, 2021TAGS: [KEEPKEY](/tag/keepkey)Article by:ShapeShift

On April 12, 2021, ShapeShift released v7.1.0 of the KeepKey firmware to resolve a critical security vulnerability [(CVE-2021-31616)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31616) responsibly disclosed to us by security researcher [Christian Reitter](https://blog.inhq.net/posts/keepkey-CVE-2021-31616/). Any user whose device is running firmware v7.0.3 should update as soon as possible.

While we have no evidence that this vulnerability has been exploited in the wild, itâs important that all KeepKey usersâwhether their device is registered with ShapeShift or notâapply the update at their earliest opportunity. Regular security patching and updates are a necessary and important part of security hygiene.

Action steps are simple:

* Even if you already applied the update, we recommend you go ahead and make sure you're running the latest versionâv7.1.2, at the time of this writing.
* If you are unable to access your KeepKey right now, donât worryâit is secure while disconnected. Just update as soon as you can, though we recommend updating the next time you connect.
* When you are ready and able, [use the KeepKey app to update](https://beta.shapeshift.com/updater-download).
* As a security best practice, consider enabling PIN protection on your device.
* Before making any updates to your device, *always* make sure you have your 12-word seed phrase safely stored offline.
* If you have issues connecting your device following your update, please reach out to our support team.

Feel free to contact our [**Customer Support team**](http://shapeshift.zendesk.com/hc/en-us)with any questions.Â

## Recommended Reading

[August 1, 2019
### Itâs Hardware or the Highway

Try hardware security with the ShapeShift Platform.](/library/hardware-or-the-highway)[September 19, 2019
### KeepKey Release Notes â v6.2.2

Download the latest KeepKey Client and Firmware Updates.](/library/keepkey-release-notes-v6-2-2)[December 4, 2019
### ShapeShift Security Update

Our update on the KeepKey Vulnerability Disclosure.](/library/shapeshift-security-update)
## Letâs stay in touch

We value your privacy. We never share customer data with third parties for marketing.

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/66fc1f4ad88cb1635cb08900_whitelogo.svg)](/)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5cf5407bee1b5263d29faec4_icon-facebook.svg)](https://www.facebook.com/ShapeShiftPlatform/)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/653003010442aa9a0985b39a_x-social-media-logo-icon.svg)](https://twitter.com/ShapeShift)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5cf5407b6e00f535f03e274e_icon-instagram.svg)](https://www.instagram.com/shapeshift_io/)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5cf5407bee1b5204229faec5_icon-youtube.svg)](https://youtube.com/channel/UCrZ2Ml63kLwZJ6amqoGaZeQ)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5d0aadc77ffb575064234d86_icon-medium.svg)](https://medium.com/%40ShapeShift.com)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5d0aac4951ff3f603ede0213_icon-discord.svg)](https://discord.gg/shapeshift)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/5dd4f818b1461d5ff1e92ae2_telegram.svg)](https://t.me/shapeshiftofficial)[![](https://cdn.prod.website-files.com/5cec55545d0f47cfe2a39a8e/672e30083442b9f4b2fb91b9_Icon2.svg)](https://warpcast.com/shapeshift/)[Donate to ShapeShift](https://giveth.io/project/shapeshift-dao)
###### Products

[ShapeShift dApp](https://app.shapeshift.com/)[Mobile App](/download)[KeepKey](https://shapeshift.com/keepkey/)[FOX Token](https://app.shapeshift.com/#/demo/fox)
###### Help

[HelpDesk](https://docs.shapeshift.com/)Cookie Preferences[Terms of Service](/terms-of-service)[FAQ](/faqs)[Privacy Policy](/privacy)[Responsible Disclosure Policy](/responsible-disclosure-program)
###### resources

[FOX Token](https://app.shapeshift.com/#/demo/fox)[Supported Wallets](/wallets)[Chain & Wallet Chart](/supported-chains)[Governance](/fox/governance)[Brand Assets](/brand-assets)[Github](https://github.com/shapeshift)[Press](/company/press)[Roadmap](/genesis-dao-roadmap)
###### DAO

[Contribute](/contribute)[Join](/join)[Governance](/fox/governance)

**Â© 2022 ShapeShift. All Rights Reserved Â | Â**[**Sitemap**](/sitemap.xml)



=== Content from mato.inhq.net_399b90bd_20250115_230350.html ===
GIF89a  �        !�    ,       D ;

=== Content from blog.inhq.net_fd4cda1d_20250115_230346.html ===
![](https://mato.inhq.net/m?rec=1&bots=1&idsite=1)[invd blog](/)

[Archive](/archive/)[CVEs](/cve/)[Consulting](/consulting/)[About](/about/)

# KeepKey Stack Buffer Overflow Vulnerability (CVE-2021-31616)

Apr 30, 2021
â¢
Christian Reitter
ID:
CVE-2021-31616

Related articles:
[KeepKey Memory Exfiltration Vulnerability (CVE-2023-27892)](/posts/keepkey-CVE-2023-27892/)
â¢ [KeepKey Supervisor Vulnerabilities (CVE-2022-30330)](/posts/keepkey-CVE-2022-30330/)
â¢ [KeepKey Message State Handling Vulnerability (VULN-22003)](/posts/keepkey-VULN-22003/)

I have recently discovered a serious vulnerability in the KeepKey hardware wallet.

Through a stack buffer overflow, remote or local attackers can execute code on the device and perform actions such as stealing the wallet keys from within a malicious website.
The vulnerability was introduced with firmware ***v7.0.3*** and patched with ***v7.1.0*** after my disclosure.

## Contents

* [Introduction](#introduction)
* [The Vulnerability](#the-vulnerability)
  + [Exploiting the Stack Buffer Overflow](#exploiting-the-stack-buffer-overflow)
  + [The Fix](#the-fix)
  + [Attack Scenario and Security Implications](#attack-scenario-and-security-implications)
  + [Proof of Concept (PoC)](#proof-of-concept-poc)
  + [Version Overview](#version-overview)
* [General Summary of the Issue](#general-summary-of-the-issue)
* [Coordinated disclosure](#coordinated-disclosure)
  + [Relevant product](#relevant-product)
  + [Detailed timeline](#detailed-timeline)
  + [Credits](#credits)
  + [A Note About Research Affiliation](#a-note-about-research-affiliation)
  + [Bug bounty](#bug-bounty)
## Consulting

*Iâm a freelance Security Consultant and currently available for new projects.
If you are looking for assistance to secure your projects or organization, [contact me](/consulting).*

## Introduction

*As with many of my previous blog articles, this is going to be a technical deep-dive into a complex security bug.
Correspondingly, the article is written for technical readers with a background in the area of IT security.
Go to [the general summary of the issue](#general-summary-of-the-issue) if you are interested in the less technical version.*

The ShapeShift KeepKey is a cryptocurrency hardware wallet with an open source firmware.
I have done a lot of independent security research on over the last years,
mainly through extensive automated testing with a custom fuzzing setup in combination with manual auditing.
See my other blog articles for more context on this topic and discovered issues.

ShapeShift has recently integrated logic for the *THORChain* network into their exchange,
which included new code changes and logic for their KeepKey wallet firmware.
More specifically, the new logic is located in the Ethereum handling.
As it turns out, it contains a major flaw:

![<i>See the following sections for details on this attack.</i>](/assets/images/resized/600/keepkey_cve-2021-31616_poc.jpg)

*See the following sections for details on this attack.*

## The Vulnerability

For the purposes of this bug, it is sufficient to know that the *THORChain* usage is related to a special subset of Ethereum transactions.
The issue is in the new Ethereum signing code that was introduced to handle this new logic.

As with regular Ethereum transactions on the KeepKey, a `MessageType_EthereumSignTx` protobuf message from the host computer triggers some
finite state machine behavior, which includes the `ethereum_signing_init()` function:

```
void ethereum_signing_init(EthereumSignTx *msg, const HDNode *node,
                           bool needs_confirm) {
```

[ethereum.c](https://github.com/keepkey/keepkey-firmware/blob/902cd3a286f18b774b5422610dd7969b5c21073e/lib/firmware/ethereum.c#L590-L591)

Initially, the code checks a few basic properties of the received request message, for example via `ethereum_signing_check()`.
It rejects the most problematic messages that satisfy error conditions such as `if (msg->data_length > 16000000) {`.

However, these functions do not perform any in-depth validity checks on the message properties,
and many of the message fields cannot be checked during the initial message processing due to how the protocol is designed.
This is relevant for later.

Ethereum transmission requests that satisfy the `ethereum_isThorchainSwap(msg)` check will be processed with
the newly introduced `ethereum_extractThorchainSwapData()` function early in the message handling:

```
  // Detect THORChain swap
  if (ethereum_isThorchainSwap(msg)) {
    if (token == NULL && data_total > 0 && data_needs_confirm) {
      char swap_data[256] = {'\0'};
      uint8_t swap_data_len = ethereum_extractThorchainSwapData(msg, swap_data);
```

[ethereum.c](https://github.com/keepkey/keepkey-firmware/blob/902cd3a286f18b774b5422610dd7969b5c21073e/lib/firmware/ethereum.c#L677-L681)

This is the problematic path that can be attacked.

As it can be seen in the code excerpt below, the first parameter for the `ethereum_extractThorchainSwapData(const EthereumSignTx *msg, char *buffer)` function call is the received message `msg`
and the second parameter is the local stack buffer `swap_data[256]` from the `ethereum_signing_init()` function context.

Quick challenge for the more experienced security people among the readers: consider the following code snippet for a minute or two.

Can you spot the bug and what it does?

```
uint8_t ethereum_extractThorchainSwapData(const EthereumSignTx *msg,
                                          char *buffer) {
  // Swap data begins 164 chars into data buffer:
  // offset = deposit function hash + address + address + uint256
  uint16_t offset = 4 + (5 * 32);
  int16_t len = msg->data_length - offset;
  if (msg->has_data_length && len > 0) {
    memcpy(buffer, msg->data_initial_chunk.bytes + offset, len);
    // String length must be < 255 characters
    return len < 256 ? (uint8_t)len : 0;
  }
  return 0;
}
```

[ethereum.c](https://github.com/keepkey/keepkey-firmware/blob/902cd3a286f18b774b5422610dd7969b5c21073e/lib/firmware/ethereum.c#L90-L102)

To answer this, the essential weakness here is related to the length field, more specifically, the attacker-controlled `msg->data_length` field.
It is incorrectly treated as a **trusted input** and allowed to influence low-level memory operations,
similar to multiple previous security issues that Iâve discovered in other products through fuzzing.

Fuzzers have a good nose for reaching branches in the code while at the same time having basically no understanding of how the branch is *supposed* to be reached.
Theyâre ideal to trigger this type of edge case with an unusual length value. Sanitizers like AddressSanitizer can then detect the memory corruption that follows,
revealing the issue out of millions of other unproblematic fuzzer runs.

In this specific case, the `msg->data_length` field is basically an arbitrary `uint32_t` integer that can be set by the attacker.
It is only slightly constrained to a value of `< 16M` through the previously mentioned check in the parent function, which is of no practical relevance.
More essentially, this length field is not limited to the maximum size of the `swap_data` (256 byte) or even `msg->data_initial_chunk` (1024 byte) buffers.

The `msg->data_length` represents the data size that is announced to the wallet as the *total length* of the transaction data that is supposed to follow in
future messages. `msg->data_initial_chunk` is just the initial data section if the total expected length is bigger than the first chunk field can hold.
For practical attacks, the `<= 1024` of this initial chunk is sufficient, as weâll see in later descriptions, so there is no need to actually send followup messages with additional data.

In the code snippet above, the `int16_t len` value is directly computed from the foreign `msg->data_length` value minus the fixed `offset` of `164`.
There is a `len > 0` check to make sure the result is not used when it is zero or negative,
which is meaningful, but fails to catch the even more important case for `len` values that are bigger than expected.

For some reason, the developers were anticipating that `len >= 256` values end up in this code branch since they included a special check to set the returned length to `0` in this case.
However, there is no check to prevent the problematic memory corruption behavior that *also* happens with `len > 256`!

At those lengths, the `memcpy()` call results in an out of bounds write on the stack behind `swap_data`, which is located in the stack frame of the *caller* function.

In practical terms, this means that an attacker can manipulate the length parameter of the `memcpy()` arbitrarily through `msg->data_length` to values between 1 and 32767.
The target buffer is always of fixed size 256 via `char swap_data[256]`.
Since the destination buffer is nulled before usage, there is no information disclosure when performing a partial overwrite through `memcpy()` with for smaller lengths than usual.
Therefore lengths `>256` are interesting for an attack.

To make matters worse, the main source of the copied data is the large byte field `msg->data_initial_chunk.bytes`,
which is a fully attacker controllable byte array in the same message that triggers the attack.
Up to `1024 - offset` = 860 bytes of data can be copied directly from there.
For even bigger `memcpy()` operations, the source values are fetched as out of bounds reads from other fields of the same `msg` message,
and so they are also controllable by the attacker to a large degree.

To summarize, one large Ethereum-related message is sufficient to trigger a large and very controllable out of bounds write on the stack.

### Exploiting the Stack Buffer Overflow

The technical aspects will be presented in multiple additional blog articles,
since the analysis is complex and involves a second coordinated disclosure.

* [Part I of the analysis can be found here](/posts/exploiting-CVE-2021-31616-part1/).
* [Disclosure article on the faulty stack smashing protection](/posts/faulty-stack-canary-arm-systems/).

### The Fix

For obvious reasons, I recommended stronger limits for the length parameter of `memcpy()` as a first step to the vendor when reporting the issue.

This was done through a patch in firmware `v7.1.0`, which is fairly compact:

```
@@ -93,10 +93,10 @@ uint8_t ethereum_extractThorchainData(const EthereumSignTx *msg,
   // offset = deposit function hash + address + address + uint256
   uint16_t offset = 4 + (5 * 32);
   int16_t len = msg->data_length - offset;
-  if (msg->has_data_length && len > 0) {
+  if (msg->has_data_length && len > 0 && len < 256) {
    memcpy(buffer, msg->data_initial_chunk.bytes + offset, len);
    // String length must be < 255 characters
-    return len < 256 ? (uint8_t)len : 0;
+    return (uint8_t)len;
   }
   return 0;
 }
```

[ethereum.c](https://github.com/keepkey/keepkey-firmware/commit/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bc)

Going forward, I recommend to make the magic `256` limit value more explicit in that data handling, either by taking it as a length parameter in the function or by adding documentation to the function body.
Additionally, the fixed `offset` could be an explicit constant and the integer overflow handling from the larger `msg->data_length` could be better,
but neither of them is a security problem as of now.

### Attack Scenario and Security Implications

The target device needs to be in an unlocked state to be vulnerable:

* on devices without a PIN, this is automatically the case
* otherwise the PIN has to be entered once (and is then cached)
* the correct passphrase is not necessary to trigger the attack even if enabled (but is also affected if cached)

Details of the unlock state of the KeepKey can be checked repeatedly by an attacker through a `GetFeatures` protobuf message.
Once the reported conditions on the device are good, an attacker can then send the problematic USB packets to the device to trigger the exploit.

The attack has been confirmed to work

1. through malicious JavaScript and WebUSB in Chrome/Chromium
   * the user needs to accept the generic WebUSB browser dialog to connect the device
2. through programs with local user privileges
   * no user interaction required
   * depends on the necessary drivers and configuration

#### Observed Impact

I have shown that it is possible to get code execution on the device by smashing the stack and then manipulating the instruction flow.

Through Return Oriented Programming (ROP), an attacker can very deliberately trigger a number of code snippets
from existing functions and combine them with unusual parameters to basically do anything they want.
For example, one particularly problematic action is making the device send USB protobuf messages filled with *secret stack memory* from the `CONFIDENTIAL` memory area.
Based on this attack approach, the decrypted BIP39 mnemonic and cached passphrase (if available) can be copied from the device to the attacker.

Fundamentally, the main security guarantees of a hardware wallet and U2F 2nd factor device are compromised once the secret keys are known.
This attack breaks most aspects of the KeepKey security model.

Other impacts that Iâve been able to trigger include setting of new passphrases, PINs or BIP39 seed erasure.
This could be problematic for users who do not have a paper wallet backup at hand.
However, in most cases it would be quicker for an attacker to steal the funds instead,
unless they have a reason to intentionally trigger device problems, e.g., as a coverup for the theft or some other specific scenario.

Interestingly, it is also possible to artificially trigger my previously discovered [CVE-2019-18672](/posts/keepkey-CVE-2019-18672/) issue through this bug,
but then again - thatâs less interesting to the attacker than simply getting the valid U2F device private key itself.

One of the technically interesting questions here is whether this attack can result in persistent firmware modifications.
In other words, can you start trusting the device again after youâve wiped it and installed a new firmware, or could it still contain malicious code or settings?

Although it is possible for attackers to change some regions of the device flash,
my current understanding is that this does not allow persistent modifications to the firmware code without also alerting the user on the next device boot.
The existing security configurations such as the internally dropped microcontroller permission levels,
memory protection unit settings and limitations on flash writes through the supervisor abstraction *should* prevent an
overwrite of the bootloader.
If this is satisfied, the still-genuine bootloader will detect that the modified firmware is no longer correctly signed
as part of the typical boot check, leading to a âUnofficial Firmwareâ security warning and mandatory user interaction.
Which isnât perfect, but better than silently running with a modified bootloader/firmware combination
(which could falsely report that it is correctly updated to a newer version to evade detection, for example).
Note that the error also depends on the bootloader version, of which multiple are in use (at least `bl1.1.0` and `bl2.0.0` are relevant).

So, after upgrading to a new and signed firmware version and wiping the previous settings, the device and firmware *should* be trustable again.
I have not looked at this scenario long enough to vouch for it, though.

#### Formal Scoring

| Description | CVSS 3.1 | Score |
| --- | --- | --- |
| WebUSB-based attack with connect dialog interaction, full impact | [AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H) | 8.0 (High) |

Notes:

* Having both `PR:L` and `UI:R` is probably over-accounting for the WebUSB connection dialog.

### Proof of Concept (PoC)

Iâve sent four different PoCs to the vendor:

1. Denial of service via crash (the bug is reachable)
2. Custom display content (reliable code execution)
3. Copying BIP39 seed off the device (breaking confidentiality)
4. Copying cached passphrase off the device (breaking confidentiality)

They are not published at the moment. Iâm planning to release more technical information on the attack soon.

Here is how the modified No.2 PoC works on the device:

Video not supported

*Details: device without PIN for demonstration purposes, USB attack at 0:10 triggers an "impossible" layout\_warning\_static() call*

### Version Overview

| Version | Status | Description |
| --- | --- | --- |
| ***v6.x.x*** and earlier | not vulnerable â | Firmware versions do not contain the problematic code |
| ***v7.0.3*** | ð¥ **firmware vulnerable** ð¥ | Update **as soon as possible** and consider switching to a different BIP39 mnemonic. |
| **v7.1.x** | firmware not vulnerable | ðâ ï¸ Remaining security concern if the device was used with firmware *v7.0.3* previously. |

## General Summary of the Issue

This publication is about a serious bug in the specific KeepKey firmware ***v7.0.3*** that was released in March 2021.

Devices with this version can be attacked. All other versions are OK.

Basically, an attacker can command the device to reveal or manipulate any wallet secrets that are known to the device at the time of the attack.
They can change the PIN, erase the device or do other weird things.
Depending on how the device is used and when the attack happens,
the entered secret passphrase can be stolen as well.
This means that all cryptocurrency funds for all coin variants âonâ the wallet can be transferred out to the attacker right away (or months later!)
since they can create an identical copy of the wallet.

The attack is possible as soon as the device is connected to a computer and unlocked.
Unlocking is usually done by entering the PIN and special passphrase through a normal dialog on the computer, if either of those are used.
Otherwise, the device is unlocked and vulnerable by default.

Attack scenarios:

1. If the attack is triggered by malicious software on the computer that the KeepKey is attached to, it is silent and without any user interaction.
2. If the attack happens through a malicious webpage, it requires a click on the normal browser confirmation dialog (for the device connection).

There is not a lot one can do to prevent the attack, and one cannot find out if any of the sneakier attack variants already happened.

As vulnerabilities go, this is pretty bad.

Some good news:

* I found the bug quickly after it got introduced.
* I went directly to the vendor with it while keeping it a secret (coordinated disclosure).
* The vendor realized that the issue was serious and quickly released a fix.

I obviously recommend upgrading from the problematic firmware to a patched version right away.
Unfortunately, this might not be sufficient.
If other people on the Internet have found the bug in the past weeks independently and realized its potential,
they could have systematically attacked vulnerable KeepKey users.
This is not that unlikely, since the v7.1.0 release changes showed where the bug was, for example.
It is generally plausible that wallet keys have been copied by an attack âin the wildâ somewhere,
since it is proven that this is possible from the technical side.

If you 1. had the dangerous firmware version on a device with significant funds and 2. used it on any computer or website that you donât *really, really* trust,
now would be a good time to check your funds and move them to another BIP39 seed and another passphrase.

## Coordinated disclosure

Iâve now reported security issues for the KeepKey for four consecutive years, and this has been generally positive, but there were some ups and downs along the way.
For example, there have been a few minor security reports to ShapeShift that dragged on through most of 2020 with months of delayed feedback and a lack of code changes.
As someone with professional software developer experience,
I understand that backlogs can be full and lower rated issues get passed over again and again as a consequence.
However, from the researcher side, having to keep the ball rolling on unresolved topics is draining energy from other things.
Running into a situation like that will naturally lower my interest in researching and reporting future security bugs for a given software, particularly in case of minor bugs.

Given this background, it was refreshing that the ShapeShift vulnerability handling processes have changed in 2021 and that the situation has significantly improved.
It is not ideal yet, but it is definitely getting better.

I want to positively mention:

* their initial reaction time of **less than 24 hours** for human feedback on the issue
* the quick patch rollout of **less than 6 days** from disclosure to release
* from what I understand, ShapeShift has enabled urgent upgrade warnings for affected users on their platform
* the opportunity to do a call and discuss the issue in person (although late in the disclosure)

However, there are also several areas that can still be improved:

* publishing **timely security advisories** within a few days of public security patches
* informing the reporting researcher of relevant patches, releases and planned time frames of related topics
* reducing miscommunications within the team

Since Iâve noted missing security advisories [during previous KeepKey disclosures](/posts/keepkey-CVE-2019-18672/#coordinated-disclosure), I
recommend that they look into how to improve their advisory processes for future issues,
so that customers can make better informed decisions when tasked with upgrades and warnings.
Particularly with a complex and dangerous issue such as this one, having âSecurity fixesâ in a changelog as the only public information is simply insufficient,
even more so if some risk for users remains after the update, which is the case here in my opinion.

This has been a big and complex disclosure, but Iâm definitely quite satisfied with the research results.

Stay tuned for more technical details on this topic.

### Relevant product

| Product | Source | Fixed Version | Patch | Publications | IDs |
| --- | --- | --- | --- | --- | --- |
| ShapeShift KeepKey | [GitHub](https://github.com/keepkey/keepkey-firmware/) | fix: **v7.1.0**recommended: **v7.1.2** | [patch](https://github.com/keepkey/keepkey-firmware/commit/930d6ada7a15b3fd00bfef78ec855ae6fa7cc870#diff-a29702be230c2b876e019a5e1c332362d39b775607e1ef9200b46b06dd4a72bcR96) | [v7.1.0 changelog](https://github.com/keepkey/keepkey-firmware/releases/tag/v7.1.0), [ShapeShift advisory](https://shapeshift.com/library/keepkey-important-update-issued-april-4-required) | [CVE-2021-31616](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31616), VULN-21011 |

Iâm not aware of other affected hardware wallets.

### Detailed timeline

| Date | Information |
| --- | --- |
| 2021-03-24 | Affected firmware version v7.0.3 is released |
| 2021-04-08 | I discover the vulnerability |
| 2021-04-08 | Confidential disclosure to ShapeShift |
| 2021-04-08 | ShapeShift acknowledges the issue and assigns VULN identifier |
| 2021-04-12 | ShapeShift releases patched firmware version 7.1.0 for download |
| 2021-04-14 | ShapeShift publishes the code for firmware version 7.1.0 on GitHub |
| 2021-04-21 | CVE request sent to MITRE |
| 2021-04-23 | MITRE assigns CVE-2021-31616 |
| 2021-04-26 | Technical call with ShapeShift |
| 2021-04-27 | ShapeShift releases firmware version 7.1.2 on GitHub |
| 2021-04-30 | Publication of this blog article |
| 2021-05-03 | Corrections to the ShapeShift security advisory (see notes) |

Notes:

* The ShapeShift security advisory originally referenced April 4th as the patch release date, which was a numerical error that has been corrected.
* My timeline uses the source code tags to determine the time of publication, but Iâm told that the actual firmware availability was a bit earlier. This was added to the timeline, where known.

### Credits

I want to give special thanks to Dr. Jochen Hoenicke, who has helped in later stages of the research.

### A Note About Research Affiliation

I want to emphasize that this research was done on my own time and initiative.
In particular, it was not sponsored by SatoshiLabs, for whom I do some paid freelance security research on the related Trezor project.

### Bug bounty

ShapeShift has paid a bug bounty for this issue.

* **Christian Reitter**

Information security and other interests.



=== Content from github.com_ee07d36e_20250115_140643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=keepkey%2Fkeepkey-firmware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[keepkey](/keepkey)
/
**[keepkey-firmware](/keepkey/keepkey-firmware)**
Public

* [Notifications](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware) You must be signed in to change notification settings
* [Fork
  103](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)
* [Star
   157](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)

KeepKey Device Firmware

### License

[LGPL-3.0 license](/keepkey/keepkey-firmware/blob/master/COPYING)

[157
stars](/keepkey/keepkey-firmware/stargazers) [103
forks](/keepkey/keepkey-firmware/forks) [Branches](/keepkey/keepkey-firmware/branches) [Tags](/keepkey/keepkey-firmware/tags) [Activity](/keepkey/keepkey-firmware/activity)
 [Star](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware)

 [Notifications](/login?return_to=%2Fkeepkey%2Fkeepkey-firmware) You must be signed in to change notification settings

* [Code](/keepkey/keepkey-firmware)
* [Issues
  14](/keepkey/keepkey-firmware/issues)
* [Pull requests
  0](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

Additional navigation options

* [Code](/keepkey/keepkey-firmware)
* [Issues](/keepkey/keepkey-firmware/issues)
* [Pull requests](/keepkey/keepkey-firmware/pulls)
* [Actions](/keepkey/keepkey-firmware/actions)
* [Security](/keepkey/keepkey-firmware/security)
* [Insights](/keepkey/keepkey-firmware/pulse)

# keepkey/keepkey-firmware

    master[Branches](/keepkey/keepkey-firmware/branches)[Tags](/keepkey/keepkey-firmware/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4,444 Commits](/keepkey/keepkey-firmware/commits/master/) | | |
| [.circleci](/keepkey/keepkey-firmware/tree/master/.circleci ".circleci") | | [.circleci](/keepkey/keepkey-firmware/tree/master/.circleci ".circleci") |  |  |
| [.github](/keepkey/keepkey-firmware/tree/master/.github ".github") | | [.github](/keepkey/keepkey-firmware/tree/master/.github ".github") |  |  |
| [cmake](/keepkey/keepkey-firmware/tree/master/cmake "cmake") | | [cmake](/keepkey/keepkey-firmware/tree/master/cmake "cmake") |  |  |
| [code-signing-keys @ a6470bd](/keepkey/code-signing-keys/tree/a6470bd8598e5e9a7bfc38bf139a5e5a616f05ec "code-signing-keys") | | [code-signing-keys @ a6470bd](/keepkey/code-signing-keys/tree/a6470bd8598e5e9a7bfc38bf139a5e5a616f05ec "code-signing-keys") |  |  |
| [deps](/keepkey/keepkey-firmware/tree/master/deps "deps") | | [deps](/keepkey/keepkey-firmware/tree/master/deps "deps") |  |  |
| [docs](/keepkey/keepkey-firmware/tree/master/docs "docs") | | [docs](/keepkey/keepkey-firmware/tree/master/docs "docs") |  |  |
| [fuzzer](/keepkey/keepkey-firmware/tree/master/fuzzer "fuzzer") | | [fuzzer](/keepkey/keepkey-firmware/tree/master/fuzzer "fuzzer") |  |  |
| [include](/keepkey/keepkey-firmware/tree/master/include "include") | | [include](/keepkey/keepkey-firmware/tree/master/include "include") |  |  |
| [lib](/keepkey/keepkey-firmware/tree/master/lib "lib") | | [lib](/keepkey/keepkey-firmware/tree/master/lib "lib") |  |  |
| [scripts](/keepkey/keepkey-firmware/tree/master/scripts "scripts") | | [scripts](/keepkey/keepkey-firmware/tree/master/scripts "scripts") |  |  |
| [tools](/keepkey/keepkey-firmware/tree/master/tools "tools") | | [tools](/keepkey/keepkey-firmware/tree/master/tools "tools") |  |  |
| [unittests](/keepkey/keepkey-firmware/tree/master/unittests "unittests") | | [unittests](/keepkey/keepkey-firmware/tree/master/unittests "unittests") |  |  |
| [.clang-format](/keepkey/keepkey-firmware/blob/master/.clang-format ".clang-format") | | [.clang-format](/keepkey/keepkey-firmware/blob/master/.clang-format ".clang-format") |  |  |
| [.dockerignore](/keepkey/keepkey-firmware/blob/master/.dockerignore ".dockerignore") | | [.dockerignore](/keepkey/keepkey-firmware/blob/master/.dockerignore ".dockerignore") |  |  |
| [.gdbinit](/keepkey/keepkey-firmware/blob/master/.gdbinit ".gdbinit") | | [.gdbinit](/keepkey/keepkey-firmware/blob/master/.gdbinit ".gdbinit") |  |  |
| [.gitattributes](/keepkey/keepkey-firmware/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/keepkey/keepkey-firmware/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/keepkey/keepkey-firmware/blob/master/.gitignore ".gitignore") | | [.gitignore](/keepkey/keepkey-firmware/blob/master/.gitignore ".gitignore") |  |  |
| [.gitmodules](/keepkey/keepkey-firmware/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/keepkey/keepkey-firmware/blob/master/.gitmodules ".gitmodules") |  |  |
| [.gittrees](/keepkey/keepkey-firmware/blob/master/.gittrees ".gittrees") | | [.gittrees](/keepkey/keepkey-firmware/blob/master/.gittrees ".gittrees") |  |  |
| [CMakeLists.txt](/keepkey/keepkey-firmware/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/keepkey/keepkey-firmware/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [COPYING](/keepkey/keepkey-firmware/blob/master/COPYING "COPYING") | | [COPYING](/keepkey/keepkey-firmware/blob/master/COPYING "COPYING") |  |  |
| [Dockerfile](/keepkey/keepkey-firmware/blob/master/Dockerfile "Dockerfile") | | [Dockerfile](/keepkey/keepkey-firmware/blob/master/Dockerfile "Dockerfile") |  |  |
| [README.md](/keepkey/keepkey-firmware/blob/master/README.md "README.md") | | [README.md](/keepkey/keepkey-firmware/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/keepkey/keepkey-firmware/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/keepkey/keepkey-firmware/blob/master/SECURITY.md "SECURITY.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* LGPL-3.0 license
* Security

[![CircleCI](https://camo.githubusercontent.com/5cdb5a31732423685fa2e37ea9a1c1c63e2dbf658c247b428a5e86efccb3081c/68747470733a2f2f636972636c6563692e636f6d2f67682f6b6565706b65792f6b6565706b65792d6669726d776172652e7376673f7374796c653d737667)](https://circleci.com/gh/keepkey/keepkey-firmware)

## KeepKey Build Procedure

### Toolchain Installation

Install Docker Community Edition from: `https://www.docker.com/get-docker`

```
$ docker pull kktech/firmware:v5-beta

```

### Clone the Source

The sources can be obtained from github:

```
$ git clone git@github.com:keepkey/keepkey-firmware.git
$ git submodule update --init --recursive

```

### Build

To build the firmware using the docker container, use the provided script:

```
$ ./scripts/build/docker/device/release.sh

```

## Verifying Published Binaries

Compare the hash of a given tagged build:

```
$ git checkout v6.2.0
$ git submodule update --init --recursive
$ ./scripts/build/docker/device/release.sh
$ tail -c +257 ./bin/firmware.keepkey.bin | shasum -a 256

```

With that of the [signed v6.2.0 binary on github](https://github.com/keepkey/keepkey-firmware/releases/download/v6.2.0/firmware.keepkey.bin), ignoring signatures and firmware metadata:

```
$ tail -c +257 firmware.keepkey.bin | shasum -a 256

```

Then inspect the metadata itself by comparing against the structure described [here](https://github.com/keepkey/keepkey-firmware/blob/f20484804285decfacceb71519ae83bc18f2266f/include/keepkey/board/memory.h#L55):

```
$ head -c +256 signed_firmware.bin | xxd -

```

Caveats:

1. v6.2.2 and v6.3.0 had an issue with build reproducibility. See [#212](https://github.com/keepkey/keepkey-firmware/issues/212).
2. As of v6.1.0 and later, we started prepending empty slots for signatures as part of the build, and prior firmwares were emitted without that metadata section. See [87b9ebb84](https://github.com/keepkey/keepkey-firmware/commit/87b9ebb846b241e6357f296e37fd29808ddfa51a)

### Docs

Documentation can be found [here](/keepkey/keepkey-firmware/blob/master/docs/README.md).

## License

If license is not specified in the header of a file, it can be assumed that it is licensed under LGPLv3.

## About

KeepKey Device Firmware

### Resources

[Readme](#readme-ov-file)
### License

[LGPL-3.0 license](#LGPL-3.0-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/keepkey/keepkey-firmware/activity)
[Custom properties](/keepkey/keepkey-firmware/custom-properties)
### Stars

[**157**
stars](/keepkey/keepkey-firmware/stargazers)
### Watchers

[**40**
watching](/keepkey/keepkey-firmware/watchers)
### Forks

[**103**
forks](/keepkey/keepkey-firmware/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fkeepkey%2Fkeepkey-firmware&report=keepkey+%28user%29)

## [Releases 64](/keepkey/keepkey-firmware/releases)

[Release v7.9.3
Latest

Mar 6, 2024](/keepkey/keepkey-firmware/releases/tag/v7.9.3)
[+ 63 releases](/keepkey/keepkey-firmware/releases)

## [Packages 0](/orgs/keepkey/packages?repo_name=keepkey-firmware)

No packages published

## [Contributors 90](/keepkey/keepkey-firmware/graphs/contributors)

[+ 76 contributors](/keepkey/keepkey-firmware/graphs/contributors)

## Languages

* [C
  91.7%](/keepkey/keepkey-firmware/search?l=c)
* [C++
  4.5%](/keepkey/keepkey-firmware/search?l=c%2B%2B)
* [CMake
  1.8%](/keepkey/keepkey-firmware/search?l=cmake)
* [Assembly
  1.4%](/keepkey/keepkey-firmware/search?l=assembly)
* [Shell
  0.4%](/keepkey/keepkey-firmware/search?l=shell)
* [Dockerfile
  0.1%](/keepkey/keepkey-firmware/search?l=dockerfile)
* Other
  0.1%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


