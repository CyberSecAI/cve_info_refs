=== Content from github.com_23e744c8_20250114_181915.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fissues%2F15927)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fissues%2F15927)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  388](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# uri\_parser: out-of-bounds read #15927

Closed

[nmeum](/nmeum) opened this issue
Feb 4, 2021
· 2 comments
 · Fixed by [#15929](https://github.com/RIOT-OS/RIOT/pull/15929)

Closed

# [uri\_parser: out-of-bounds read](#top) #15927

[nmeum](/nmeum) opened this issue
Feb 4, 2021
· 2 comments
 · Fixed by [#15929](https://github.com/RIOT-OS/RIOT/pull/15929)

Assignees
[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

Labels
[Area: sys](/RIOT-OS/RIOT/labels/Area%3A%20sys)
Area: System
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)

## Comments

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=80&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)

Copy link

Member

### **[nmeum](/nmeum)** commented [Feb 4, 2021](#issue-801303854)

| Description I did some testing of the `uri_parser` module as provided in `sys/uri_parser`. I believe I discovered an edge-case where the parser performs an out-of-bounds read of the provided buffer. The code causing this is:     [RIOT/sys/uri\_parser/uri\_parser.c](https://github.com/RIOT-OS/RIOT/blob/9eb6a38a5adf55335f14e582834dad63610889d7/sys/uri_parser/uri_parser.c#L76-L80)  Lines 76 to 80 in [9eb6a38](/RIOT-OS/RIOT/commit/9eb6a38a5adf55335f14e582834dad63610889d7)   |  | result->userinfo = uri; | | --- | --- | |  | result->userinfo\_len = userinfo\_end - uri; | |  | /\* shift host part beyond userinfo and '@' \*/ | |  | result->host += result->userinfo\_len + 1; | |  | result->host\_len -= result->userinfo\_len + 1; |      which advances `result->host` without a bounds check and even if `userinfo_len` is zero `result->host` is still advanced by one byte. Steps to reproduce the issue Application code:  ``` #include <stdio.h> #include <stdlib.h> #include <stdint.h> #include <uri_parser.h>  #define BUFFER_SIZE 5  static char buf[] = { 65, 58, 47, 47, 64 };  int main(void) {     size_t len = sizeof(buf);     uri_parser_result_t result;      uri_parser_process(&result, buf, len);     return 0; } ```  Minimal `Makefile`:  ``` APPLICATION = uri DEVELHELP = 1  BOARD = native  USEMODULE += uri_parser  RIOTBASE ?= $(CURDIR)/../.. include $(RIOTBASE)/Makefile.include ```  Afterwards, compile as:  ``` $ make -C examples/uri all-asan  ```  And run the application using:  ``` $ make -C examples/uri term  ``` Expected results The application shouldn't crash. Actual results ``` main(): This is RIOT! (Version: 2021.04-devel-440-g4cc04) ================================================================= ==24259==ERROR: AddressSanitizer: global-buffer-overflow on address 0x565e6105 at pc 0x565dce2b bp 0x565eb6f8 sp 0x565eb6ec READ of size 1 at 0x565e6105 thread T0     #0 0x565dce2a in _consume_authority /root/RIOT/sys/uri_parser/uri_parser.c:130     #1 0x565dd5ed in _parse_absolute /root/RIOT/sys/uri_parser/uri_parser.c:222     #2 0x565ddabc in uri_parser_process /root/RIOT/sys/uri_parser/uri_parser.c:280     #3 0x565d3bcb in main /root/RIOT/examples/uri/main.c:15     #4 0x565d40ed in main_trampoline /root/RIOT/core/init.c:58     #5 0xf766353a in makecontext (/lib/i386-linux-gnu/libc.so.6+0x4153a)  0x565e6105 is located 0 bytes to the right of global variable 'buf' defined in '/root/RIOT/examples/uri/main.c:8:13' (0x565e6100) of size 5 SUMMARY: AddressSanitizer: global-buffer-overflow /root/RIOT/sys/uri_parser/uri_parser.c:130 in _consume_authority Shadow bytes around the buggy address:   0x2acbcbd0: f9 f9 f9 f9 00 00 00 00 00 00 00 00 00 00 00 00   0x2acbcbe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x2acbcbf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x2acbcc00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x2acbcc10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x2acbcc20:[05]f9 f9 f9 f9 f9 f9 f9 00 00 00 00 f9 f9 f9 f9   0x2acbcc30: f9 f9 f9 f9 f9 f9 f9 f9 00 00 00 00 f9 f9 f9 f9   0x2acbcc40: 00 00 00 00 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9   0x2acbcc50: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9   0x2acbcc60: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 00 00 00 00   0x2acbcc70: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==24259==ABORTING make: *** [/root/RIOT/examples/uri/../../Makefile.include:725: term] Error 1 make: Leaving directory '/root/RIOT/examples/uri'  ``` Versions I don't think this is needed, if you need more information let me know. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
assigned [cgundogan](/cgundogan)
[Feb 4, 2021](#event-4291010569)

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
added
[Area: sys](/RIOT-OS/RIOT/labels/Area%3A%20sys)
Area: System
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)
labels
[Feb 4, 2021](#event-4291011653)

[nmeum](/nmeum)
added a commit
to nmeum/RIOT
that referenced
this issue
[Feb 4, 2021](#ref-commit-360c610)
[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)

`[uri_parser: check result->host_len before incrementing result->host](/nmeum/RIOT/commit/360c610cfade8d6ed52eb56751515e37e0c7b92c "uri_parser: check result->host_len before incrementing result->host

Fixes #15927.")`
…

`[360c610](/nmeum/RIOT/commit/360c610cfade8d6ed52eb56751515e37e0c7b92c)`

```
Fixes [RIOT-OS#15927](https://github.com/RIOT-OS/RIOT/issues/15927).
```

[nmeum](/nmeum)
added a commit
to nmeum/RIOT
that referenced
this issue
[Feb 4, 2021](#ref-commit-5739a91)
[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)

`[uri_parser: check result->host_len before incrementing result->host](/nmeum/RIOT/commit/5739a915258ae98d8561f4c83011a92df2646a2f "uri_parser: check result->host_len before incrementing result->host

This is intended as a hotfix for #15927. Not sure if I would be
preferable to return an error in this case instead.

Fixes #15927.")`
…

`[5739a91](/nmeum/RIOT/commit/5739a915258ae98d8561f4c83011a92df2646a2f)`

```
This is intended as a hotfix for [RIOT-OS#15927](https://github.com/RIOT-OS/RIOT/issues/15927). Not sure if I would be
preferable to return an error in this case instead.

Fixes [RIOT-OS#15927](https://github.com/RIOT-OS/RIOT/issues/15927).
```

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)
[nmeum](/nmeum)
mentioned this issue
[Feb 4, 2021](#ref-pullrequest-801370654)

[uri\_parser: check result->host\_len before incrementing result->host
#15928](/RIOT-OS/RIOT/pull/15928)
 Closed

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
mentioned this issue
[Feb 4, 2021](#ref-pullrequest-801384977)

[uri\_parser: fix out-of-bounds and additional enhancements
#15929](/RIOT-OS/RIOT/pull/15929)
 Merged

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=80&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)

Copy link

Member

### **[cgundogan](/cgundogan)** commented [Feb 4, 2021](#issuecomment-773393389)

| thanks for this detailed report (: I was able to reproduce on native and while going through the code I also adjusted the unit tests for the case you presented "A://@". That's correct, right? |
| --- |

All reactions

Sorry, something went wrong.

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)
[nmeum](/nmeum)
mentioned this issue
[Feb 4, 2021](#ref-pullrequest-801390822)

[uri\_parser: check if uri is long enough to even contain a ://
#15930](/RIOT-OS/RIOT/pull/15930)
 Merged

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=80&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)

Copy link

Member

Author

### **[nmeum](/nmeum)** commented [Feb 4, 2021](#issuecomment-773395649) • edited Loading

| That's correct, right?  Yes, that's correct. I also found a separate issue while testing my fix for this issue. I documented this separately in [#15930](https://github.com/RIOT-OS/RIOT/pull/15930). Hope that's the correct way to do this. Thanks for your quick fix! |
| --- |

All reactions

Sorry, something went wrong.

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
closed this as [completed](/RIOT-OS/RIOT/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#15929](/RIOT-OS/RIOT/pull/15929)
[Feb 5, 2021](#event-4296844778)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fissues%2F15927)

Assignees

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan) [cgundogan](/cgundogan)

Labels

[Area: sys](/RIOT-OS/RIOT/labels/Area%3A%20sys)
Area: System
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [uri\_parser: fix out-of-bounds and additional enhancements](/RIOT-OS/RIOT/pull/15929)
 [cgundogan/RIOT](/cgundogan/RIOT)

 [uri\_parser: check result->host\_len before incrementing result->host](/RIOT-OS/RIOT/pull/15928)
 [nmeum/RIOT](/nmeum/RIOT)

3 participants

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=52&v=4)](/miri64) [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=52&v=4)](/cgundogan) [![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=52&v=4)](/nmeum)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2408f8b8_20250114_181918.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F15929)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F15929)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  388](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRIOT-OS%2FRIOT%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# uri\_parser: fix out-of-bounds and additional enhancements #15929

 Merged

[miri64](/miri64)
merged 5 commits into
[RIOT-OS:master](/RIOT-OS/RIOT/tree/master "RIOT-OS/RIOT:master")
from
[cgundogan:pr/uriparser](/cgundogan/RIOT/tree/pr/uriparser "cgundogan/RIOT:pr/uriparser")

Feb 5, 2021

 Merged

# [uri\_parser: fix out-of-bounds and additional enhancements](#top) #15929

[miri64](/miri64)
merged 5 commits into
[RIOT-OS:master](/RIOT-OS/RIOT/tree/master "RIOT-OS/RIOT:master")
from
[cgundogan:pr/uriparser](/cgundogan/RIOT/tree/pr/uriparser "cgundogan/RIOT:pr/uriparser")

Feb 5, 2021

[Conversation
2](/RIOT-OS/RIOT/pull/15929)
[Commits
5](/RIOT-OS/RIOT/pull/15929/commits)
[Checks
0](/RIOT-OS/RIOT/pull/15929/checks)
[Files changed](/RIOT-OS/RIOT/pull/15929/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cgundogan](https://avatars.githubusercontent.com/u/739129?s=60&v=4)](/cgundogan)

Copy link

Member

### @cgundogan **[cgundogan](/cgundogan)** commented [Feb 4, 2021](#issue-801384977) • edited Loading

### Contribution description

* Fixes the out of bounds for the case where the host part is empty, but a userinfo exists.
* Additionally allow empty host parts, even if userinfo and port exist (look at the ABNF in <https://tools.ietf.org/html/rfc3986#appendix-A>)
* Further, do not attempt to parse path if end-of-uri is reached.

### Testing procedure

run the unittests and the example in [#15927](https://github.com/RIOT-OS/RIOT/issues/15927)

### Issues/PRs references

fixes [#15927](https://github.com/RIOT-OS/RIOT/issues/15927)

Sorry, something went wrong.

All reactions

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
added
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)
[Area: sys](/RIOT-OS/RIOT/labels/Area%3A%20sys)
Area: System
labels
[Feb 4, 2021](#event-4291477663)

 [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
requested review from
[chrysn](/chrysn) and
[benpicco](/benpicco)
[February 4, 2021 15:23](#event-4291477679)

 [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
requested a review
from [miri64](/miri64)
as a [code owner](/RIOT-OS/RIOT/blob/d6e43fd07a0e1efc37a1cc0e257b21b92782964a/CODEOWNERS#L140)
[February 4, 2021 15:23](#event-4291477729)

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
mentioned this pull request
[Feb 4, 2021](#ref-pullrequest-801370654)

[uri\_parser: check result->host\_len before incrementing result->host
#15928](/RIOT-OS/RIOT/pull/15928)
 Closed

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)
[nmeum](/nmeum)
mentioned this pull request
[Feb 4, 2021](#ref-pullrequest-801390822)

[uri\_parser: check if uri is long enough to even contain a ://
#15930](/RIOT-OS/RIOT/pull/15930)
 Merged

 [cgundogan](/cgundogan)
added 3 commits
[February 5, 2021 13:24](#commits-pushed-f9b8fad)

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

`[uri_parser: check boundaries if host is empty, but userinfo exists](/RIOT-OS/RIOT/pull/15929/commits/f9b8fadd85308ded4639335683c21c97dcfffe1a "uri_parser: check boundaries if host is empty, but userinfo exists")`

`[f9b8fad](/RIOT-OS/RIOT/pull/15929/commits/f9b8fadd85308ded4639335683c21c97dcfffe1a)`

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

`[uri_parser: allow empty host part even if userinfo and port exist](/RIOT-OS/RIOT/pull/15929/commits/1040cf98623701501d3cab54718c8e85463ba643 "uri_parser: allow empty host part even if userinfo and port exist")`

`[1040cf9](/RIOT-OS/RIOT/pull/15929/commits/1040cf98623701501d3cab54718c8e85463ba643)`

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

`[uri_parser: do not parse path if end-of-uri](/RIOT-OS/RIOT/pull/15929/commits/6f13325a52b6eef4e991d84b2462a7f97113c09b "uri_parser: do not parse path if end-of-uri")`

`[6f13325](/RIOT-OS/RIOT/pull/15929/commits/6f13325a52b6eef4e991d84b2462a7f97113c09b)`

 [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
[force-pushed](/RIOT-OS/RIOT/compare/1cbd5bc285f7a4753bc9c29d0d0383ce204c1f4e..9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7)
the
pr/uriparser

branch
from
[`1cbd5bc`](/RIOT-OS/RIOT/commit/1cbd5bc285f7a4753bc9c29d0d0383ce204c1f4e) to
[`9b919ba`](/RIOT-OS/RIOT/commit/9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7)  [Compare](/RIOT-OS/RIOT/compare/1cbd5bc285f7a4753bc9c29d0d0383ce204c1f4e..9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7)
[February 5, 2021 12:26](#event-4295854809)

 [cgundogan](/cgundogan)
added 2 commits
[February 5, 2021 13:32](#commits-pushed-e399ef5)

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

`[uri_parser: terminate, if nothing to consume after scheme](/RIOT-OS/RIOT/pull/15929/commits/e399ef5d761aa02fa3505f03ca604e9b06056b2f "uri_parser: terminate, if nothing to consume after scheme")`

`[e399ef5](/RIOT-OS/RIOT/pull/15929/commits/e399ef5d761aa02fa3505f03ca604e9b06056b2f)`

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&v=4)](/cgundogan)

`[tests: uri_parser: new test to check empty host](/RIOT-OS/RIOT/pull/15929/commits/6ef29d9b532dbb6666072ad52684123d5087a14b "tests: uri_parser: new test to check empty host")`

`[6ef29d9](/RIOT-OS/RIOT/pull/15929/commits/6ef29d9b532dbb6666072ad52684123d5087a14b)`

 [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
[force-pushed](/RIOT-OS/RIOT/compare/9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7..6ef29d9b532dbb6666072ad52684123d5087a14b)
the
pr/uriparser

branch
from
[`9b919ba`](/RIOT-OS/RIOT/commit/9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7) to
[`6ef29d9`](/RIOT-OS/RIOT/commit/6ef29d9b532dbb6666072ad52684123d5087a14b)  [Compare](/RIOT-OS/RIOT/compare/9b919ba3e7b4d71e022ad8c9e2d09f1c8d6b59b7..6ef29d9b532dbb6666072ad52684123d5087a14b)
[February 5, 2021 12:33](#event-4295880783)

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=80&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)

Copy link

Member

Author

### **[cgundogan](/cgundogan)** commented [Feb 5, 2021](#issuecomment-774006909)

| [@nmeum](https://github.com/nmeum) I rebased this branch onto current master. Do you mind having another check? AFAIC, I am not getting troubles anymore with `make all-asan` and the initial application that you provided. |
| --- |

All reactions

Sorry, something went wrong.

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
added
the
[CI: ready for build](/RIOT-OS/RIOT/labels/CI%3A%20ready%20for%20build)
If set, CI server will compile all applications for all available boards for the labeled PR
label
[Feb 5, 2021](#event-4295888783)

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=80&u=ae33fc546193fdf0b7a25ae12df675e067e9882f&v=4)](/nmeum)

Copy link

Member

### **[nmeum](/nmeum)** commented [Feb 5, 2021](#issuecomment-774059316) • edited Loading

| [@nmeum](https://github.com/nmeum) I rebased this branch onto current master. Do you mind having another check? AFAIC, I am not getting troubles anymore with `make all-asan` and the initial application that you provided.  Yes, at the present time I am no longer able to discover any additional spatial violations in `uri_parser` with your patch applied. I cannot provide any guarantees whether there are none though but the code definitely looks more reasonable now ;)  Thanks for fixing this so quickly! |
| --- |

All reactions

Sorry, something went wrong.

[![nmeum](https://avatars.githubusercontent.com/u/2326560?s=60&v=4)](/nmeum)

**[nmeum](/nmeum)**
approved these changes
[Feb 5, 2021](#pullrequestreview-584377437)

 [View reviewed changes](/RIOT-OS/RIOT/pull/15929/files/6ef29d9b532dbb6666072ad52684123d5087a14b)

[![benpicco](https://avatars.githubusercontent.com/u/1301112?s=60&v=4)](/benpicco)

**[benpicco](/benpicco)**
approved these changes
[Feb 5, 2021](#pullrequestreview-584381677)

 [View reviewed changes](/RIOT-OS/RIOT/pull/15929/files/6ef29d9b532dbb6666072ad52684123d5087a14b)

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&u=ddc0fa64e6b79aeadc94b7061bef6e052be4d8c7&v=4)](/miri64)
[miri64](/miri64)
merged commit [`bc59d60`](/RIOT-OS/RIOT/commit/bc59d60be60dfc0a05def57d74985371e4f22d79)
into
RIOT-OS:master

[Feb 5, 2021](https://github.com/RIOT-OS/RIOT/pull/15929#event-4296844761)

 [![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=40&u=2d02085955106d194ca1f423b0284aa7cd4dad8c&v=4)](/cgundogan)
[cgundogan](/cgundogan)
deleted the
pr/uriparser

branch
[February 5, 2021 17:07](#event-4297121746)

[![@kaspar030](https://avatars.githubusercontent.com/u/4679640?s=40&v=4)](/kaspar030)
[kaspar030](/kaspar030)
added this to the [Release 2021.04](/RIOT-OS/RIOT/milestone/34) milestone
[Apr 23, 2021](#event-4636210017)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fpull%2F15929)

Reviewers

[![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=40&v=4)](/nmeum) [nmeum](/nmeum)

nmeum approved these changes

[![@benpicco](https://avatars.githubusercontent.com/u/1301112?s=40&v=4)](/benpicco) [benpicco](/benpicco)

benpicco approved these changes

[![@chrysn](https://avatars.githubusercontent.com/u/442326?s=40&v=4)](/chrysn) [chrysn](/chrysn)

 Awaiting requested review from chrysn

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&v=4)](/miri64) [miri64](/miri64)

 Awaiting requested review from miri64

 miri64 is a code owner

Assignees

No one assigned

Labels

[Area: sys](/RIOT-OS/RIOT/labels/Area%3A%20sys)
Area: System
[CI: ready for build](/RIOT-OS/RIOT/labels/CI%3A%20ready%20for%20build)
If set, CI server will compile all applications for all available boards for the labeled PR
[Type: bug](/RIOT-OS/RIOT/labels/Type%3A%20bug)
The issue reports a bug / The PR fixes a bug (including spelling errors)

Projects

None yet

Milestone

 [**Release 2021.04**](/RIOT-OS/RIOT/milestone/34 "Release 2021.04")

Development

Successfully merging this pull request may close these issues.

 [uri\_parser: out-of-bounds read](https://github.com/RIOT-OS/RIOT/issues/15927)

5 participants

[![@cgundogan](https://avatars.githubusercontent.com/u/739129?s=52&v=4)](/cgundogan) [![@nmeum](https://avatars.githubusercontent.com/u/2326560?s=52&v=4)](/nmeum) [![@benpicco](https://avatars.githubusercontent.com/u/1301112?s=52&v=4)](/benpicco) [![@miri64](https://avatars.githubusercontent.com/u/675644?s=52&v=4)](/miri64) [![@kaspar030](https://avatars.githubusercontent.com/u/4679640?s=52&v=4)](/kaspar030)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dfc674ab_20250114_181912.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fcommit%2Fbc59d60be60dfc0a05def57d74985371e4f22d79)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fcommit%2Fbc59d60be60dfc0a05def57d74985371e4f22d79)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  388](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

## Commit

[Permalink](/RIOT-OS/RIOT/commit/bc59d60be60dfc0a05def57d74985371e4f22d79)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#15929](https://github.com/RIOT-OS/RIOT/pull/15929) from cgundogan/pr/uriparser

[Browse files](/RIOT-OS/RIOT/tree/bc59d60be60dfc0a05def57d74985371e4f22d79)
Browse the repository at this point in the history

```
uri_parser: fix out-of-bounds and additional enhancements
```

* Loading branch information

[![@miri64](https://avatars.githubusercontent.com/u/675644?s=40&v=4)](/miri64)

[miri64](/RIOT-OS/RIOT/commits?author=miri64 "View all commits by miri64")
authored
Feb 5, 2021

2 parents
[07f1254](/RIOT-OS/RIOT/commit/07f1254d8537497552e7dce80364aaead9266bbe)
+
[6ef29d9](/RIOT-OS/RIOT/commit/6ef29d9b532dbb6666072ad52684123d5087a14b)

commit bc59d60

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**41 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sys/uri\_parser

  + sys/uri\_parser/uri\_parser.c
    [uri\_parser.c](#diff-05fd96efad40b0211dd1f6c15d061bc4c810f3b9f0c18eb5d33b054413aa6d75)
* tests/unittests/tests-uri\_parser

  + tests/unittests/tests-uri\_parser/tests-uri\_parser.c
    [tests-uri\_parser.c](#diff-10c92785eb9572f526f95411c0fd4cf37fc6e39a62c8edda6261917db8253d3d)

## There are no files selected for viewing

37 changes: 26 additions & 11 deletions

37
[sys/uri\_parser/uri\_parser.c](#diff-05fd96efad40b0211dd1f6c15d061bc4c810f3b9f0c18eb5d33b054413aa6d75 "sys/uri_parser/uri_parser.c")

Show comments

[View file](/RIOT-OS/RIOT/blob/bc59d60be60dfc0a05def57d74985371e4f22d79/sys/uri_parser/uri_parser.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -75,9 +75,16 @@ void \_consume\_userinfo(uri\_parser\_result\_t \*result, char \*uri, |
|  |  | if (userinfo\_end) { |
|  |  | result->userinfo = uri; |
|  |  | result->userinfo\_len = userinfo\_end - uri; |
|  |  | /\* shift host part beyond userinfo and '@' \*/ |
|  |  | result->host += result->userinfo\_len + 1; |
|  |  | result->host\_len -= result->userinfo\_len + 1; |
|  |  |  |
|  |  | /\* shift host part beyond userinfo and '@', but only if possible \*/ |
|  |  | unsigned offset = result->userinfo\_len + 1; |
|  |  | if ((result->host + offset) > authority\_end) { |
|  |  | result->host\_len = 0; |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | result->host\_len -= offset; |
|  |  | result->host += offset; |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -125,6 +132,11 @@ static char \*\_consume\_authority(uri\_parser\_result\_t \*result, char \*uri, |
|  |  | /\* consume userinfo, if available \*/ |
|  |  | \_consume\_userinfo(result, uri, authority\_end); |
|  |  |  |
|  |  | /\* host is empty \*/ |
|  |  | if (result->host\_len == 0) { |
|  |  | return authority\_end; |
|  |  | } |
|  |  |  |
|  |  | char \*ipv6\_end = NULL; |
|  |  | /\* validate IPv6 form \*/ |
|  |  | if (result->host[0] == '[') { |
| Expand Down  Expand Up | | @@ -159,12 +171,6 @@ static char \*\_consume\_authority(uri\_parser\_result\_t \*result, char \*uri, |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | /\* do not allow empty host if userinfo or port are set \*/ |
|  |  | if ((result->host\_len == 0) && |
|  |  | (result->userinfo || result->port)) { |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | /\* this includes the '/' \*/ |
|  |  | return authority\_end; |
|  |  | } |
| Expand Down  Expand Up | | @@ -218,15 +224,24 @@ static int \_parse\_absolute(uri\_parser\_result\_t \*result, char \*uri, |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | if (uri >= uri\_end) { |
|  |  | /\* nothing more to consume \*/ |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (has\_authority) { |
|  |  | uri = \_consume\_authority(result, uri, uri\_end); |
|  |  | if (uri == NULL) { |
|  |  | return -1; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* parsing the path, starting with '/' \*/ |
|  |  | return \_parse\_relative(result, uri, uri\_end); |
|  |  | /\* is there more to parse after authority? \*/ |
|  |  | if (uri < uri\_end) { |
|  |  | /\* parsing the path, starting with '/' \*/ |
|  |  | return \_parse\_relative(result, uri, uri\_end); |
|  |  | } |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | bool uri\_parser\_is\_absolute(const char \*uri, size\_t uri\_len) |
| Expand Down | |  |

19 changes: 15 additions & 4 deletions

19
[tests/unittests/tests-uri\_parser/tests-uri\_parser.c](#diff-10c92785eb9572f526f95411c0fd4cf37fc6e39a62c8edda6261917db8253d3d "tests/unittests/tests-uri_parser/tests-uri_parser.c")

Show comments

[View file](/RIOT-OS/RIOT/blob/bc59d60be60dfc0a05def57d74985371e4f22d79/tests/unittests/tests-uri_parser/tests-uri_parser.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -216,15 +216,15 @@ static const validate\_t validate\_uris[] = { |
|  |  | 0), |
|  |  | VEC("coap://R@////////////////7///v=1", |
|  |  | true, |
|  |  | "coap", |
|  |  | "R", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "////////////////7///v=1", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | -1), |
|  |  | 0), |
|  |  | VEC("coa[:////[2001:db5ow:5own/Ov=1", |
|  |  | false, |
|  |  | "", |
| Expand Down  Expand Up | | @@ -412,6 +412,17 @@ static const validate\_t validate\_uris[] = { |
|  |  | "", |
|  |  | "", |
|  |  | 0), |
|  |  | VEC("A://@", |
|  |  | true, |
|  |  | "A", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | "", |
|  |  | 0), |
|  |  | }; |
|  |  |  |
|  |  | static char \_failure\_msg[VEC\_MSG\_LEN]; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bc59d60`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fcommit%2Fbc59d60be60dfc0a05def57d74985371e4f22d79) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


