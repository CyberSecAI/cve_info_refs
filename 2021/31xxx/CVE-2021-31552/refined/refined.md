```
{
  "CVE-2021-31552": {
    "related": true,
    "summary": "The provided content describes a vulnerability in the AbuseFilter extension of MediaWiki, specifically when handling account creation attempts. The vulnerability stems from the AbuseFilter's behavior of blocking account creation by blocking the underlying IP address, which inadvertently exposes the IP address of the account creator in the abuse log.",
    "details": {
      "root_cause": "AbuseFilter blocks account creation by blocking the IP address of the user attempting to create the account, rather than blocking the account itself after creation. This process logs the IP address of the user, leading to a privacy vulnerability.",
      "weaknesses": [
        "Information Leakage: The IP address of the account creator is exposed in the abuse log, violating user privacy.",
        "Lack of Proper Handling: AbuseFilter doesn't properly handle blocking of account creation, exposing user IPs and potentially creating SUL fragmentation.",
        "Inconsistent Blocking Behavior: AbuseFilter was blocking the IP address instead of the account, which is inconsistent with how it should block the action."
      ],
      "impact": "The primary impact of this vulnerability is the exposure of the IP addresses of users attempting to create accounts that trigger AbuseFilter rules. This could lead to privacy violations, especially if bad-faith or misconfigured filters are used to collect these IPs.",
      "attack_vectors": [
        "Malicious or misconfigured AbuseFilter rules: Attackers can craft specific account names or use other filter-triggering criteria to make AbuseFilter block the creation attempts and log their IP addresses.",
         "Passive Information Gathering: Attackers can use existing, legitimate filters that block account creation to passively collect IP addresses."
      ],
      "required_attacker_capabilities": "The attacker would need to be able to trigger an AbuseFilter rule that blocks account creation, either by intentionally creating an account that matches the filter or exploiting an existing filter. They also require access to the AbuseFilter logs to view the leaked IP addresses.",
       "additional_info": "The fix involved modifying AbuseFilter to hide the user's IP address from the log when blocking account creations and utilizing the existing block functionality instead of creating a new custom system. It also involves some changes to how blocks are handled in MediaWiki core. This fix was deployed as a security patch."
    }
  }
}
```