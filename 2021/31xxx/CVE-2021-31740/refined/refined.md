Based on the provided content, here's an analysis of CVE-2021-31740:

**Vulnerability:** Cross-Site Scripting (XSS)

**Root Cause:** The SEPPmail web frontend does not properly encode user-supplied input in the recipient field, leading to a stored XSS vulnerability.

**Weaknesses/Vulnerabilities Present:**
- Lack of proper input sanitization or output encoding for the recipient field.
- Insecure handling of user-provided data within HTML context.

**Impact of Exploitation:**
- An attacker can execute arbitrary JavaScript code within the context of the SEPPmail domain in the target's browser.
- This allows for actions such as:
   - Stealing session cookies.
   - Displaying fake login forms to capture credentials.
   - Redirecting the user to malicious websites.
   - Performing other malicious activities within the user's session.

**Attack Vectors:**
- The attacker crafts a malicious recipient address containing JavaScript code (e.g., `foo@bar<svg/onload='alert(1))'`).
- This malicious recipient address is submitted via the SEPPmail web interface.
- The vulnerability is not a "self-XSS" because session tokens are passed via the URL, allowing an attacker to craft a malicious URL with their own session token, trick a target into clicking it, thus executing the XSS in the context of the attacker's session.

**Required Attacker Capabilities/Position:**
- The attacker must have a valid SEPPmail account to obtain a session token.
- The attacker must craft a malicious URL containing a malicious recipient address.
- The attacker must trick the target user into clicking the crafted URL.
- The target user must be logged out or willing to login with the attackers session token.
- The attacker must have the session token available to include in the crafted URL and it is time limited to the validity of the token.

**Additional Notes:**
- The provided content gives a specific example of the vulnerable code, example URL and attack scenario.
- This vulnerability is combined with a session token hijacking component, as the attacker can inject the XSS into the victims browser by passing the session token in the URL.
- The article also mentions a weak Content Security Policy (CSP) that can be bypassed, which is related to XSS, but a separate issue.
- This vulnerability has been fixed in SEPPmail version 12.0.6 and later.