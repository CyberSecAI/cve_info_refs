Based on the provided content, here's an analysis of CVE-2021-31547:

**CVE-2021-31547: AbuseFilterCheckMatch API reveals suppressed edits and usernames**

*   **Root Cause of Vulnerability**: The `ApiAbuseFilterCheckMatch` API in the MediaWiki AbuseFilter extension did not properly check the visibility of suppressed revisions and abuse log entries. This allowed users with `abusefilter-view-private` or `abusefilter-modify` rights to potentially recover information from suppressed content.

*   **Weaknesses/Vulnerabilities Present**:
    *   **Information Leakage:** The API allowed unauthorized access to data that should have been hidden due to suppression, including usernames, summaries, and potentially wikitext through a bit-by-bit recovery technique.
    *   **Insufficient Access Control:** The API module lacked proper checks for `rc_deleted` (revision deleted) and `afl_deleted` (abuse filter log deleted) flags.
    *   **Abuse of Test Functionality:** The `/test` functionality of the abuse filter could be misused to identify suppressed usernames and summaries, although this was considered "intended" behavior, and a separate patch was implemented to address it.

*   **Impact of Exploitation:**
    *   **Privacy Violation:** Attackers with specific, but not elevated, permissions could recover information that was intentionally hidden for privacy or security reasons.
    *   **Circumvention of Suppression:** The suppression mechanism, designed to hide specific content, could be bypassed, reducing its effectiveness.
    *   **Potential for Further Abuse:** Recovered information could potentially be used to target specific users or communities, or for malicious purposes, such as doxing.

*  **Attack Vectors:**
    *   **API Manipulation:** Attackers could directly query the vulnerable `api.php?action=abusefiltercheckmatch` endpoint, using the `filter` parameter and providing either a `rcid` for a suppressed revision or a `logid` for a suppressed abuse log entry.
    *   **AbuseFilter test interface:** The `/test` functionality allowed for bit-by-bit recovery of username and summary information from suppressed recent changes.

*   **Required Attacker Capabilities/Position:**
    *   **Account with specific rights:** An attacker needed an account with either `abusefilter-view-private` or `abusefilter-modify` rights. This access is not public and requires some level of trust in the system to be granted.
    *   **Familiarity with AbuseFilter**: Attacker needed to understand how abuse filters and the API function, to properly craft the requests.

**Additional Notes:**

*   The vulnerability was addressed by implementing checks for the `rc_deleted` flag for recent change entries and the `afl_deleted` flag for abuse log entries, within the `ApiAbuseFilterCheckMatch` API.
*   A separate patch was also applied to the `/test` functionality to address the username and summary leakage, by skipping deleted recent changes if the user was only showing matches.
*   The initial report mentions a separate issue about `page_recent_contributors` leaking usernames, however, this was addressed in a different task ([T71367](https://phabricator.wikimedia.org/T71367)) and is out of scope for this CVE.
*   Patches were applied to multiple branches of the MediaWiki AbuseFilter extension including master, REL1_31, and REL1_35.
*   This vulnerability was classified as a Medium priority security issue, however, escalated to Unbreak Now! during the patching process.
*  The fix was deployed and the issue was resolved, then assigned the CVE.

This detailed description goes beyond the placeholder CVE description, providing a more in-depth view of the vulnerability.