```json
{
  "CVE-2021-31566": {
    "Description": "The vulnerability lies in how libarchive handles symbolic links during the extraction process. When an archive contains a directory entry followed by a symbolic link entry with the same path, the post-processing fixup code may incorrectly modify the target of the symbolic link instead of the link itself.",
    "Root cause": "The vulnerability is caused by the libarchive library not properly handling symbolic links during the post-processing of archive entries. Specifically, when an archive contains a directory entry with a path followed by a symlink with the same path, the fixup code used to set modes, times, access control lists, and flags is not properly checking the file type and ends up modifying the symlink target instead of the symlink itself.",
    "Weaknesses": [
      "Improper handling of symbolic links",
      "Inadequate checks before modifying file attributes",
      "Use of chmod() instead of lchmod()"
    ],
    "Impact": "An attacker could create a malicious archive that, when extracted, would modify the modes, times, ACLs, and flags of a file outside the archive, leading to privilege escalation or other unauthorized modifications of the system. A local attacker may use this flaw to gain more privileges in a system.",
    "Attack vectors": "The attack vector involves an attacker providing a specially crafted archive to a victim user, who would then extract the archive using libarchive. This could be done by tricking the user into opening a malicious archive or by delivering the malicious archive in some other way. This can be exploited by local users too.",
    "Required attacker capabilities/position": "An attacker needs to be able to create a malicious archive and have a victim user extract it using a vulnerable version of libarchive. The attacker may need local access to the system for exploitation."
  }
}
```