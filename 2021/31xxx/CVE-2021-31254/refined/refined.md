The provided content relates to CVE-2021-31254.

**Root cause of vulnerability:**
The vulnerability is a heap buffer overflow in the `tenc_box_read` function of the GPAC library, specifically in `src/isomedia/box_code_drm.c`. The code reads an Initialization Vector (IV) size and then reads the IV data itself. The issue arises when the IV size is invalid and the code incorrectly handles it, leading to out-of-bounds reads and writes.

**Weaknesses/vulnerabilities present:**
- **Heap Buffer Overflow:** The code fails to properly validate the IV size read from the bitstream. When the size is not 0, 8, or 16 the code will allocate the wrong size for the IV data read, leading to a heap buffer overflow
- **Incorrect size handling:** The ISOM_DECREASE_SIZE macro is used which can further lead to issues with memory management and overflows.

**Impact of exploitation:**
- **Heap corruption:** An attacker can cause a heap buffer overflow, leading to potential heap corruption.
- **Potential code execution:** Heap corruption can be exploited to potentially achieve arbitrary code execution.
- **Denial of Service:** The vulnerability can lead to a crash of the application.

**Attack vectors:**
- **Malicious MP4 file:** An attacker can craft a malicious MP4 file containing an invalid IV size in the encryption box, triggering the vulnerability during parsing with GPAC.

**Required attacker capabilities/position:**
- The attacker must be able to provide a malicious MP4 file with a crafted encryption box to the vulnerable application.