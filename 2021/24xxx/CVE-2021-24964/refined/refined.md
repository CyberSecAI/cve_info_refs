- **Root cause of vulnerability**: The LiteSpeed Cache plugin fails to properly verify that requests are coming from QUIC.cloud servers. This allows attackers to bypass IP checks by using a specific `X-Forwarded-For` header. Additionally, an endpoint allows setting CSS code that is not sanitized or escaped, leading to XSS.
- **Weaknesses/vulnerabilities present**:
    - IP Check Bypass: The plugin does not properly validate the origin of requests, allowing unauthorized access.
    - Unauthenticated Stored XSS: The lack of sanitization and escaping of CSS input allows an attacker to inject malicious scripts.
- **Impact of exploitation**: An unauthenticated attacker can inject malicious JavaScript code into pages visited by users, potentially leading to account compromise, data theft, or other malicious activities.
- **Attack vectors**:
    - The attacker sends a POST request to `/wp-json/litespeed/v1/notify_ccss` with a manipulated `X-Forwarded-For` header to bypass IP restrictions.
    - The request includes malicious CSS code within the `data` field, targeting a specific key.
    - The injected CSS code is stored by the plugin and is output on pages, causing the injected script to execute in the user's browser.
- **Required attacker capabilities/position**:
    - The attacker does not need to be authenticated.
    - The attacker needs to be able to send HTTP requests to the target website.
    - The "Load CSS Asynchronously" setting must be enabled in the plugin's settings for the exploit to work.