- **Root cause of vulnerability:** The plugin lacks nonce checks when saving settings.
- **Weaknesses/vulnerabilities present:** Cross-Site Request Forgery (CSRF) vulnerability. The plugin does not validate the origin of the settings update request, allowing an attacker to make a logged-in administrator unknowingly submit a crafted settings update.
- **Impact of exploitation:** An attacker can modify plugin settings, such as the HMAC verification secret, enable user registration, and set the default user role, potentially leading to site takeover. Specifically, the provided exploit allows an attacker to enable user registration with the "administrator" role, which they can then exploit to create a new admin account.
- **Attack vectors:** The attack vector is a crafted HTML form sent to a logged-in administrator, which upon submission, sends the altered settings to the vulnerable endpoint without any validation.
- **Required attacker capabilities/position:** The attacker needs to trick a logged-in administrator into submitting the crafted HTML form, typically by social engineering or by including it in a site the administrator might visit. The attacker does not need any authentication to the target website.