- **Root cause of vulnerability**: The `image_class` parameter of the `browser-shot` shortcode was not properly escaped, allowing the injection of malicious JavaScript.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of the victim's browser. This can lead to various malicious actions, including session hijacking, defacement, or redirection to malicious websites.
- **Attack vectors**: An authenticated user with Contributor role can inject the malicious shortcode into a page or post. When another user views the page (either published or as preview), the XSS payload is executed.
- **Required attacker capabilities/position**: The attacker needs to have an account with at least Contributor role on the vulnerable WordPress site. They also need the ability to create or edit posts or pages where they can embed the vulnerable shortcode.