- **Root cause of vulnerability:** The plugin lacks authorization and CSRF checks on certain AJAX actions, making them accessible to any authenticated user, including subscribers. Additionally, the plugin fails to sanitize and escape some parameters before storing them, resulting in stored XSS.
- **Weaknesses/vulnerabilities present:**
    - Broken Access Control: Unrestricted access to AJAX actions allows lower-privileged users to manipulate settings.
    - Stored Cross-Site Scripting (XSS):  Unsanitized and unescaped user-supplied input is stored and later displayed, allowing for the injection of malicious scripts.
    - Lack of CSRF protection: AJAX actions lack CSRF protection making it possible for an attacker to forge requests via a malicious site that is interacted with by a logged in user
- **Impact of exploitation:**
    - Stored XSS: An attacker can inject malicious JavaScript into the plugin settings, which is triggered when an admin creates/edits a calculator or when any user views a calculator embedded in a page. This can allow an attacker to perform actions on behalf of an admin user, redirect to malicious sites, steal cookies, etc.
- **Attack vectors:**
    - The vulnerability is exploited via AJAX requests to the `admin-ajax.php` endpoint.
    - The attacker must be an authenticated user (subscriber role is sufficient).
- **Required attacker capabilities/position:**
    - The attacker needs to be a registered user of the WordPress site.
    - The attacker needs to craft a specific POST request with a malicious XSS payload using AJAX.