=== Content from www.wordfence.com_062da314_20250114_233044.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/03/Cross-Site-Scripting-Elementor-Impacts-7-Million-Sites.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

March 17, 2021

# Cross-Site Scripting Vulnerabilities in Elementor Impact Over 7 Million Sites

On February 23, 2021, the Wordfence Threat Intelligence team responsibly disclosed a set of stored Cross-Site Scripting vulnerabilities in Elementor, a WordPress plugin which “is now actively installed and used on more than 7M websites” [according to a recent announcement](https://elementor.com/blog/announcing-new-pro-plans/) on the Elementor blog. These vulnerabilities allowed any user able to access the Elementor editor, including contributors, to add JavaScript to posts. This JavaScript would be executed if the post was viewed, edited, or previewed by any other site user, and could be used to take over a site if the victim was an administrator.

As Elementor has a contact method specifically for security reports, we were able to provide the full disclosure immediately. Elementor acknowledged the vulnerability the next day, on February 24, 2021. An initial patch was made available in version 3.1.2 on March 2, 2021. However, we recommend updating to at least Elementor version 3.1.4, the latest available at the time of this writing, as it contains additional fixes for the issue.

Wordfence Premium users received a firewall rule protecting against these vulnerabilities on February 23, 2021. Sites still running the free version of Wordfence will receive the same protection after 30 days, on March 25, 2021.

---

**Description:** Multiple Authenticated Stored Cross-Site Scripting (XSS)

**Affected Plugin:** Elementor

**Plugin Slug:** elementor

**Affected Versions:** < 3.1.2

**CVE IDs:** Pending

**CVSS Score:** 6.4 Medium

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Fully Patched Version:** 3.1.4

Elementor is a wildly popular editor plugin that allows content creators, including contributors, the ability to visually design websites using “elements” that can be added to any location on the page being built.

Many of these elements offer the option to set an HTML tag for the content within. For example, the “Heading” element can be set to use H1, H2, H3, etc. tags in order to apply different heading sizes via the `header_size` parameter. Unfortunately, for six of these elements, the HTML tags were not validated on the server side, so it was possible for any user able to access the Elementor editor, including contributors, to use this option to add executable JavaScript to a post or page via a crafted request.

![An image showing the elementor heading tag drop down menu](https://www.wordfence.com/wp-content/uploads/2021/03/editheading.png)

Since posts created by contributors are typically reviewed by editors or administrators before publishing, any JavaScript added to one of these posts would be executed in the reviewer’s browser. If an administrator reviewed a post containing malicious JavaScript, their authenticated session with high-level privileges could be used to create a new malicious administrator, or to add a backdoor to the site. An attack on this vulnerability could lead to site takeover.

Depending on the element, the executable JavaScript could be added in multiple ways.

For instance, the “Column” element, one of the most basic Elementor components, accepts an `html_tag` parameter. This parameter was output without escaping, and could be set to an inline script, a script with a remote source, or could even be attacked using attribute-based XSS.

The Accordion, Icon Box, and Image Box elements were all vulnerable to this type of attack as well, though the vulnerable parameter names varied depending on the component.

## Escaping output isn’t always enough

Escaping the output of the chosen HTML tag might have been sufficient to prevent some of these components from being exploitable, and indeed, the “Section” element and the “Toggle” element suffered from similar flaws but could not be exploited because they escaped their chosen HTML tags, and because any additional content was wrapped inside several other levels of tags.

Unfortunately, however, escaping output is not always sufficient to prevent exploits from occurring. For instance, for the “Heading” element, escaping the output of the `header_size` parameter would not have been sufficient to prevent Cross-Site Scripting because the heading text was nested immediately inside the `header_size` tags. As such it was possible to set the `header_size` parameter to `script` and add the actual JavaScript to be executed to the heading text. The “Divider” element was also vulnerable to this type of attack via the `html_tag` parameter because the inner text was nested immediately inside the chosen `html_tag`.

This is an excellent example of why it is important to validate input in addition to escaping output. Enforcing a list of allowed HTML tags on the server side rather than only on the client side would prevent  exploitation of this type of vulnerability. Indeed, this is the approach the patched version uses to correct the issue.

## Timeline

**February 23, 2021** – Wordfence Threat Intelligence releases a firewall rule to Premium users and provides full disclosure to the Elementor security contact.

**February 24, 2021** – Elementor acknowledges the disclosure and begins to work on a fix.

**March 2, 2021** – An initial patch becomes available in version 3.1.2.

**March 8, 2021** – Additional fixes are put in place in version 3.1.4.

**March 25, 2021** – The firewall rule becomes available to free users.

## Conclusion

In today’s article, we detailed stored Cross-Site Scripting(XSS) vulnerabilities present in Elementor, which could be exploited via the Column element as well as the Accordion, Icon Box, Image Box, Heading, and Divider components. These vulnerabilities have been patched in version 3.1.4, and we strongly recommend that all users of Elementor update to the latest version available, which is 3.1.4 at the time of publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210317&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users have been protected against these vulnerabilities since February 23, 2021. Sites still running the free version of Wordfence will receive the same protection 30 days later, on March 25, 2021.

If you know a friend or colleague who is using Elementor, we recommend forwarding this advisory to them, as these vulnerabilities can be used for site takeover. While these vulnerabilities require contributor-level permissions to exploit, the immense popularity of Elementor means that there are likely to be many vulnerable configurations in the wild. As such, we recommend treating these vulnerabilities with greater than normal urgency.

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fcross-site-scripting-vulnerabilities-in-elementor-impact-over-7-million-sites%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fcross-site-scripting-vulnerabilities-in-elementor-impact-over-7-million-sites%2F&text=Cross-Site%20Scripting%20Vulnerabilities%20in%20Elementor%20Impact%20Over%207%20Million%20Sites&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fcross-site-scripting-vulnerabilities-in-elementor-impact-over-7-million-sites%2F)

## Comments

12 Comments

* ![](https://secure.gravatar.com/avatar/1239c15f0314d25c7052da95ec47ebea?s=96&d=mm&r=g)
  cedial
  March 17, 2021
   11:39 am

  Something else to consider is the Elementor interactions with the OceanWP theme, which is used by huge numbers of Elementor users. I switched to Elementor from the WP block editor almost 2 years ago because at that time the block editor had some intolerable bugs. My site is text rather than graphics-based, which means that building blog pages with these inappropriate tools was a nightmare.

  I can't prove there is a problem here, but the bugs and erratic behavior of both Elementor and OceanWP make me very nervous. I have programmed all my life, and more stinks here than you have found.
* ![](https://secure.gravatar.com/avatar/dfc3b2964efc6f152b4fcef98c94a4a9?s=96&d=mm&r=g)
  Felix
  March 17, 2021
   12:34 pm

  Hello,

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  March 17, 2021
   2:33 pm

  Hi Felix,

  The vulnerabilities we found were present in the Free version of Elementor, which needs to be installed in order for Elementor Pro to function. That is, if you have Elementor Pro installed, you should still make sure to keep the underlying Elementor installation up to date.

* ![](https://secure.gravatar.com/avatar/85257063d3bf7ed7a171105c0f9c7e2a?s=96&d=mm&r=g)
  Rubb
  March 17, 2021
   11:49 pm

  What I need to do if I have the pro version but the it is expired ?

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  March 18, 2021
   11:29 am

  Hi Rubb,

  If you can't keep the Pro version of Elementor up to date I'd recommend purchasing a new license or uninstalling it, as you'll want to be protected from any future vulnerabilities discovered in the pro version.

* ![](https://secure.gravatar.com/avatar/3e3fa3f13cec8235c8d89062ce2383f9?s=96&d=mm&r=g)
  Mushlih Almubarak
  March 18, 2021
   1:22 am

  Hi

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  March 18, 2021
   11:27 am

  Hi Mushlih,

* ![](https://secure.gravatar.com/avatar/542e14ec1925605cf6f6d36ab06d8063?s=96&d=mm&r=g)
  Juice
  March 18, 2021
   3:58 pm

  Should this be detected as a critical issue in the Wordfence scan? None of my Elementor sites have shown this as an issue in the WF scan despite having the vulnerable Elementor versions.

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  March 19, 2021
   8:07 am

  Hi,

  I recommend creating a [support ticket](https://support.wordfence.com/) (if you're a Premium user) or a post on our [support forums](https://wordpress.org/support/plugin/wordfence) (if you're using the free version of Wordfence). Our support team would be happy to help you out with this!

* ![](https://secure.gravatar.com/avatar/70c5352cdbb56a542cd5204372facd44?s=96&d=mm&r=g)
  Max
  March 19, 2021
   4:34 am

  so, as far as I understand, this exploit can only take place in administration, right? with someone with editing capabilities injecting malicious code etc.

  provided it's always better to keep plugins updated, i suppose this means that older versions can still be safely used in scenarios where site owner coincides with administrator or editor (i.e. someone not really that interested in injecting malicious code)?

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  March 19, 2021
   6:53 am

  Hi Max,

  You're correct that this can only be exploited by users that can access the Elementor editor. If the only users on the site are those that are already allowed to add unfiltered HTML or JavaScript, such as administrators or editors, then yes, this doesn't add any additional risk. The primary risk is for sites that have users with fewer privileges, such as contributors and authors, as this creates a larger attack surface.

- ![](https://secure.gravatar.com/avatar/70c5352cdbb56a542cd5204372facd44?s=96&d=mm&r=g)
  Max
  March 19, 2021
   11:01 am

  thanks for confirming (phew!)

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from wpscan.com_a02ca494_20250114_233042.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Elementor < 3.1.4 - Authenticated Stored Cross-Site Scripting (XSS) in Icon Box Widget

### Description

In the plugin, the icon box widget (includes/widgets/icon-box.php) accepts a ‘title\_size’ parameter. Although the element control lists a fixed set of possible html tags, it is possible for a user with Contributor or above permissions to send a modified ‘save\_builder’ request containing JavaScript in the ‘title\_size’ parameter, which is not filtered and is output without escaping. This JavaScript will then be executed when the saved page is viewed or previewed.

### Proof of Concept

{"save\_builder":{"action":"save\_builder","data":{"status":"pending","elements":[{"id":"4710070","elType":"section","isInner":false,"settings":{},"elements":[{"id":"bd4890a","elType":"column","isInner":false,"settings":{"\_column\_size":100,"\_inline\_size":null},"elements":[{"id":"fa2d1ed","elType":"widget","isInner":false,"settings":{"tabs":[{"tab\_title":"title1","tab\_content":"thatsall","\_id":"ce05b67"},{"tab\_title":"title2","tab\_content":"orisit","\_id":"48bd168"}],"title\_html\_tag":"img src=\"\" onerror=\"alert(1);\""},"elements":[],"widgetType":"accordion"}]}]}],"settings":{"post\_title":"accordionpoc attr","post\_status":"pending"}}}}

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

elementor](https://a8cteam5105.wordpress.com/plugin/elementor/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.1.4

### References

CVE
[CVE-2021-24205](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24205)

URL
<https://www.wordfence.com/blog/2021/03/cross-site-scripting-vulnerabilities-in-elementor-impact-over-7-million-sites/>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[6.4 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Ramuel Gall

Submitter
Ramuel Gall

Submitter twitter
[ramuelgall](//twitter.com/ramuelgall)

Verified
Yes

WPVDB ID
[ef23df6d-e265-44f6-bb94-1005b16d34d9](https://a8cteam5105.wordpress.com/vulnerability/ef23df6d-e265-44f6-bb94-1005b16d34d9/)

### Timeline

Publicly Published
2021-03-17 (about 3 years ago)

Added
2021-03-17 (about 3 years ago)

Last Updated
2021-03-20 (about 3 years ago)

### Other

Published
Title

Published
2022-11-17
Title
[Flat PM < 3.0.13 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/ab68381f-c4b8-4945-a6a5-1d4d6473b73a/)

Published
2023-06-12
Title
[Ninja Forms Google Sheet Connector < 1.2.7 - Reflected XSS](https://a8cteam5105.wordpress.com/vulnerability/13c4e065-fde6-41a4-a22b-bca1b10e0d30/)

Published
2023-12-01
Title
[Spiffy Calendar < 4.9.6 - Authenticated (Contributor+) Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/4955999a-58a9-4a96-8ad8-e129029ad532/)

Published
2024-11-01
Title
[ReCaptcha Integration for WordPress < 1.2.6 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/ae7860ef-1f00-42e4-a86e-3f6ec04f24d2/)

Published
2025-01-06
Title
[Financial Stocks & Crypto Market Data Plugin <= 1.10.3 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/8b1713bc-ec76-4542-bcf2-666a02c782b2/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

