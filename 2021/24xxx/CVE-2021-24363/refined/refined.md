- **Root cause of vulnerability**: The plugin did not properly validate the upload path for files, allowing a path traversal attack.
- **Weaknesses/vulnerabilities present**: Path traversal vulnerability due to insufficient validation of file upload paths.
- **Impact of exploitation**: High privilege users, such as admins, can upload files to arbitrary locations in the server's filesystem, potentially leading to arbitrary code execution by uploading malicious files (e.g., a PHP file).
- **Attack vectors**: By sending a crafted POST request to `/wp-admin/admin-ajax.php` with the `dir=/../` parameter, an attacker can bypass the intended upload directory (`/wp-content/uploads/photo-gallery/`) and write files to locations such as `/wp-content/uploads/`.
- **Required attacker capabilities/position**: The attacker needs to be a high-privilege user, such as an administrator, to exploit the vulnerability.