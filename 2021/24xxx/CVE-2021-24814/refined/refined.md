- **Root cause of vulnerability:** The `check_privacy_settings` AJAX action in the WordPress GDPR & CCPA plugin responds with JSON data without setting the "application/json" content-type. The plugin also fails to properly escape HTML payloads, leading to reflected XSS.
- **Weaknesses/vulnerabilities present:** Reflected Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the victim's browser. If the victim is an administrator, the attacker can gain full control of the WordPress instance due to the lack of same-origin restrictions for AJAX calls and iframe manipulation.
- **Attack vectors:** The vulnerability is triggered via a crafted POST request to the `wp-admin/admin-ajax.php` endpoint with the `action` parameter set to `check_privacy_settings` and a malicious payload within the `settings` array.
- **Required attacker capabilities/position:** The attacker can be unauthenticated and needs to induce a user (ideally an administrator) to visit a malicious URL or submit the crafted form.