The provided content is related to CVE-2021-24559.

**Root Cause:**
The root cause is the improper sanitization and escaping of the 'data-uri' parameter, which is used to generate QR codes within the Qyrr WordPress plugin. Specifically, the plugin fails to escape the data URI when outputting it in the `src` attribute of an image tag. Additionally, the `data_uri_to_meta` AJAX action, meant to update QR code metadata, lacks sufficient access controls, relying only on a CSRF nonce check, which can be easily obtained by low-privileged users, like contributors.

**Weaknesses/Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):**  The primary vulnerability is a Stored XSS due to the lack of proper escaping of the `data-uri` when rendering QR codes.
- **Insufficient Access Control:** The `data_uri_to_meta` AJAX action lacks proper authorization checks, allowing users with the 'edit_posts' capability (e.g., Contributors and above) to modify QR code data, including injecting malicious JavaScript via a crafted `data-uri`.
- **CSRF Vulnerability**: While a CSRF nonce is implemented, it's easily obtainable by low-privileged users, making it ineffective as a security measure for the AJAX action.

**Impact of Exploitation:**
Successful exploitation allows an attacker to inject arbitrary JavaScript code into pages where the QR code is displayed. This could lead to:
- **Session Hijacking:** Stealing user cookies and session data.
- **Malware Distribution:** Redirecting users to malicious websites.
- **Defacement:** Modifying the website's content or appearance.
- **Privilege Escalation:** Potentially gaining higher privileges by exploiting browser vulnerabilities or other client-side attacks.

**Attack Vectors:**
1.  **Crafted data-uri:** An attacker crafts a malicious data URI containing JavaScript code.
2.  **AJAX Request:** An attacker crafts a POST request to the `admin-ajax.php` endpoint, utilizing the `data_uri_to_meta` action and the easily accessible nonce. The attacker injects the malicious data URI by specifying the post id of any existing QR code.
3.  **Stored XSS Trigger:** The malicious data URI is stored in the WordPress database. When a user views a page or post with the affected QR code, the JavaScript within the malicious data URI executes in their browser.

**Required Attacker Capabilities/Position:**
- The attacker needs to have a WordPress account with at least the "edit_posts" capability (e.g., a Contributor role or higher).
- The attacker must be able to make POST requests to the `admin-ajax.php` endpoint.
- The attacker must be able to access the affected pages containing the QR codes to trigger the XSS.