=== Content from plugins.trac.wordpress.org_c4450995_20250114_231822.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2632369%2Fpaid-memberships-pro%2Ftags%2F2.6.6%2Fadminpages%2Fdiscountcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2600585/paid-memberships-pro/trunk/adminpages/discountcodes.php "Changeset 2600585 for paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php")
* [Next Change](/changeset/3060039 "Changeset 3060039 for paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php") →

---

# Changeset [2632369](/changeset/2632369 "Show full changeset") for [paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/18/2021 10:40:25 PM
([3 years](/timeline?from=2021-11-18T22%3A40%3A25Z&precision=second "See timeline at 11/18/2021 10:40:25 PM") ago)

Author:
strangerstudios
Message:

2.6.6 - XSS fix, other bug fixes and enhancements.

Location:
[paid-memberships-pro/tags/2.6.6](/browser/paid-memberships-pro/tags/2.6.6?rev=2632369)
Files:

1 edited
1 copied

* [.](/browser/paid-memberships-pro/tags/2.6.6?rev=2632369 "Show entry in browser")
  (copied)
  *(copied from [paid-memberships-pro/trunk](/browser/paid-memberships-pro/trunk?rev=2628764 "Show original file (revision 2632367)"))*
* [adminpages/discountcodes.php](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369 "Show entry in browser")
  (modified)
  ([15 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php](/changeset/2632369/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php "Show the changeset 2632369 restricted to paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php")

  | [r2600585](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L439 "Show revision 2600585 of this file in browser") | [r2632369](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L439 "Show revision 2632369 of this file in browser") |  |
  | --- | --- | --- |
  | 439 | 439 | ?> |
  | 440 | 440 | <form action="" method="post"> |
  | 441 |  | <input name="saveid" type="hidden" value="<?php echo ~~$edit~~?>" /> |
  |  | 441 | <input name="saveid" type="hidden" value="<?php echo esc\_attr( $edit ); ?>" /> |
  | 442 | 442 | <?php wp\_nonce\_field('save', 'pmpro\_discountcodes\_nonce');?> |
  | 443 | 443 | <table class="form-table"> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L445) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L445) |  |
  | 445 | 445 | <tr> |
  | 446 | 446 | <th scope="row" valign="top"><label><?php \_e('ID', 'paid-memberships-pro' );?>:</label></th> |
  | 447 |  | <td><p class="description"><?php if(!empty($code->id)) echo ~~$code->id~~; else echo \_\_("This will be generated when you save.", 'paid-memberships-pro' );?></p></td> |
  |  | 447 | <td><p class="description"><?php if(!empty($code->id)) echo esc\_html( $code->id ); else echo \_\_("This will be generated when you save.", 'paid-memberships-pro' );?></p></td> |
  | 448 | 448 | </tr> |
  | 449 | 449 |  |
  | 450 | 450 | <tr> |
  | 451 | 451 | <th scope="row" valign="top"><label for="code"><?php \_e('Code', 'paid-memberships-pro' );?>:</label></th> |
  | 452 |  | <td><input name="code" type="text" size="20" value="<?php echo ~~str\_replace("\"", "&quot;", stripslashes($code->code))~~?>" /></td> |
  |  | 452 | <td><input name="code" type="text" size="20" value="<?php echo esc\_attr( $code->code ); ?>" /></td> |
  | 453 | 453 | </tr> |
  | 454 | 454 |  |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L499) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L499) |  |
  | 499 | 499 | ?> |
  | 500 | 500 | </select> |
  | 501 |  | <input name="starts\_day" type="text" size="2" value="<?php echo ~~$selected\_starts\_day~~?>" /> |
  | 502 |  | <input name="starts\_year" type="text" size="4" value="<?php echo ~~$selected\_starts\_year~~?>" /> |
  |  | 501 | <input name="starts\_day" type="text" size="2" value="<?php echo esc\_attr( $selected\_starts\_day ); ?>" /> |
  |  | 502 | <input name="starts\_year" type="text" size="4" value="<?php echo esc\_attr( $selected\_starts\_year ); ?>" /> |
  | 503 | 503 | </td> |
  | 504 | 504 | </tr> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L517) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L517) |  |
  | 517 | 517 | ?> |
  | 518 | 518 | </select> |
  | 519 |  | <input name="expires\_day" type="text" size="2" value="<?php echo ~~$selected\_expires\_day~~?>" /> |
  | 520 |  | <input name="expires\_year" type="text" size="4" value="<?php echo ~~$selected\_expires\_year~~?>" /> |
  |  | 519 | <input name="expires\_day" type="text" size="2" value="<?php echo esc\_attr( $selected\_expires\_day ); ?>" /> |
  |  | 520 | <input name="expires\_year" type="text" size="4" value="<?php echo esc\_attr( $selected\_expires\_year ); ?>" /> |
  | 521 | 521 | </td> |
  | 522 | 522 | </tr> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L525) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L525) |  |
  | 525 | 525 | <th scope="row" valign="top"><label for="uses"><?php \_e('Uses', 'paid-memberships-pro' );?>:</label></th> |
  | 526 | 526 | <td> |
  | 527 |  | <input name="uses" type="text" size="10" value="<?php if~~(!empty($code->uses)) echo str\_replace("\"", "&quot;", stripslashes($code->uses));~~?>" /> |
  |  | 527 | <input name="uses" type="text" size="10" value="<?php if ( ! empty( $code->uses ) ) echo esc\_attr( $code->uses ); ?>" /> |
  | 528 | 528 | <p class="description"><?php \_e('Leave blank for unlimited uses.', 'paid-memberships-pro' );?></p> |
  | 529 | 529 | </td> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L567) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L567) |  |
  | 567 | 567 | ?> |
  | 568 | 568 | <div class="pmpro\_discount\_level <?php if ( ! pmpro\_check\_discount\_code\_level\_for\_gateway\_compatibility( $level ) ) { ?>pmpro\_error<?php } ?>"> |
  | 569 |  | <input type="hidden" name="all\_levels[]" value="<?php echo ~~$level->id~~?>" /> |
  | 570 |  | <input type="checkbox" id="levels\_<?php echo ~~$level->id;?>" name="levels[]" value="<?php echo $level->id~~?>" <?php if(!empty($level->checked)) { ?>checked="checked"<?php } ?> onclick="if(jQuery(this).is(':checked')) jQuery(this).next().next().show();   else jQuery(this).next().next().hide();" /> |
  | 571 |  | <label for="levels\_<?php echo ~~$level->id;~~?>"><?php echo $level->name?></label> |
  | 572 |  | <div class="pmpro\_discount\_levels\_pricing level\_<?php echo ~~$level->id~~?>" <?php if(empty($level->checked)) { ?>style="display: none;"<?php } ?>> |
  |  | 569 | <input type="hidden" name="all\_levels[]" value="<?php echo esc\_attr( $level->id ); ?>" /> |
  |  | 570 | <input type="checkbox" id="levels\_<?php echo esc\_attr( $level->id ); ?>" name="levels[]" value="<?php echo esc\_attr( $level->id ); ?>" <?php if(!empty($level->checked)) { ?>checked="checked"<?php } ?> onclick="if(jQuery(this).is(':checked')) jQuery(this).next().next().show();    else jQuery(this).next().next().hide();" /> |
  |  | 571 | <label for="levels\_<?php echo esc\_attr( $level->id ); ?>"><?php echo $level->name?></label> |
  |  | 572 | <div class="pmpro\_discount\_levels\_pricing level\_<?php echo esc\_attr( $level->id ); ?>" <?php if(empty($level->checked)) { ?>style="display: none;"<?php } ?>> |
  | 573 | 573 | <table class="form-table"> |
  | 574 | 574 | <tbody> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L591) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L591) |  |
  | 591 | 591 | <tr> |
  | 592 | 592 | <th scope="row" valign="top"><label><?php \_e('Recurring Subscription', 'paid-memberships-pro' );?>:</label></th> |
  | 593 |  | <td><input class="recurring\_checkbox" id="recurring\_<?php echo ~~$level->id;?>" name="recurring[]" type="checkbox" value="<?php echo $level->id?>" <?php if(pmpro\_isLevelRecurring($level)) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).prop('checked')) {                  jQuery(this).parent().parent().siblings('.recurring\_info').show(); if(!jQuery('#custom\_trial\_<?php echo $level->id?>').is(':checked')) jQuery(this).parent().parent().siblings('.trial\_info').hide();} else                 jQuery(this).parent().parent().siblings('.recurring\_info').hide();" /> <label for="recurring\_<?php echo $level->id;~~?>"><?php \_e('Check if this level has a recurring subscription payment.', 'paid-memberships-pro' );?></label></td> |
  |  | 593 | <td><input class="recurring\_checkbox" id="recurring\_<?php echo esc\_attr( $level->id );?>" name="recurring[]" type="checkbox" value="<?php echo esc\_attr( $level->id ); ?>" <?php if(pmpro\_isLevelRecurring($level)) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).prop('checked')) {                    jQuery(this).parent().parent().siblings('.recurring\_info').show(); if(!jQuery('#custom\_trial\_<?php echo esc\_attr( $level->id ); ?>').is(':checked')) jQuery(this).parent().parent().siblings('.trial\_info').hide();} else                   jQuery(this).parent().parent().siblings('.recurring\_info').hide();" /> <label for="recurring\_<?php echo esc\_attr( $level->id ); ?>"><?php \_e('Check if this level has a recurring subscription payment.', 'paid-memberships-pro' );?></label></td> |
  | 594 | 594 | </tr> |
  | 595 | 595 |  |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L607) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L607) |  |
  | 607 | 607 | ?> |
  | 608 | 608 | <?php \_e('per', 'paid-memberships-pro' ); ?> |
  | 609 |  | <input name="cycle\_number[]" type="text" size="10" value="<?php echo ~~str\_replace("\"", "&quot;", stripslashes($level->cycle\_number))~~?>" /> |
  |  | 609 | <input name="cycle\_number[]" type="text" size="10" value="<?php echo esc\_attr( $level->cycle\_number ); ?>" /> |
  | 610 | 610 | <select name="cycle\_period[]"> |
  | 611 | 611 | <?php |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L630) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L630) |  |
  | 630 | 630 | <th scope="row" valign="top"><label for="billing\_limit"><?php \_e('Billing Cycle Limit', 'paid-memberships-pro' );?>:</label></th> |
  | 631 | 631 | <td> |
  | 632 |  | <input name="billing\_limit[]" type="text" size="20" value="<?php echo ~~$level->billing\_limit~~?>" /> |
  |  | 632 | <input name="billing\_limit[]" type="text" size="20" value="<?php echo esc\_attr( $level->billing\_limit ); ?>" /> |
  | 633 | 633 | <p class="description"> |
  | 634 | 634 | <?php \_e('The <strong>total</strong> number of recurring billing cycles for this level, including the trial period (if applicable) but not including the initial payment. Set to zero if membership is indefinite.', 'paid-memberships-pro' );?> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L653) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L653) |  |
  | 653 | 653 | <th scope="row" valign="top"><label><?php \_e('Custom Trial', 'paid-memberships-pro' );?>:</label></th> |
  | 654 | 654 | <td> |
  | 655 |  | <input id="custom\_trial\_<?php echo ~~$level->id?>" id="custom\_trial\_<?php echo $level->id;?>" name="custom\_trial[]" type="checkbox" value="<?php echo $level->id?>" <?php if ( pmpro\_isLevelTrial($level) ) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).prop('checked')) jQuery(this).parent().parent().siblings('.trial\_info').show(); else jQuery(this).parent().parent().siblings('.trial\_info').hide();" /> <label for="custom\_trial\_<?php echo $level->id~~;?>"><?php \_e('Check to add a custom trial period.', 'paid-memberships-pro' );?></label> |
  |  | 655 | <input id="custom\_trial\_<?php echo esc\_attr( $level->id ); ?>" id="custom\_trial\_<?php echo esc\_attr( $level->id ); ?>" name="custom\_trial[]" type="checkbox" value="<?php echo esc\_attr( $level->id ); ?>" <?php if ( pmpro\_isLevelTrial($level) ) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).prop('checked')) jQuery(this).parent().parent().siblings('.trial\_info').show();    else jQuery(this).parent().parent().siblings('.trial\_info').hide();" /> <label for="custom\_trial\_<?php echo esc\_attr( $level->id );?>"><?php \_e('Check to add a custom trial period.', 'paid-memberships-pro' );?></label> |
  | 656 | 656 | <?php if($gateway == "twocheckout") { ?> |
  | 657 | 657 | <p class="description"><strong <?php if(!empty($pmpro\_twocheckout\_error)) { ?>class="pmpro\_red"<?php } ?>><?php \_e('2Checkout integration does not support custom trials. You can do one period trials by setting an initial payment different from the billing amount.', 'paid-memberships-pro' );?></strong></p> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L673) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L673) |  |
  | 673 | 673 | ?> |
  | 674 | 674 | <?php \_e('for the first', 'paid-memberships-pro' );?> |
  | 675 |  | <input name="trial\_limit[]" type="text" size="10" value="<?php echo ~~str\_replace("\"", "&quot;", stripslashes($level->trial\_limit))~~?>" /> |
  |  | 675 | <input name="trial\_limit[]" type="text" size="10" value="<?php echo esc\_attr( $level->trial\_limit ); ?>" /> |
  | 676 | 676 | <?php \_e('subscription payments', 'paid-memberships-pro' );?>. |
  | 677 | 677 | <?php if($gateway == "stripe") { ?> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L687) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L687) |  |
  | 687 | 687 | <tr> |
  | 688 | 688 | <th scope="row" valign="top"><label><?php \_e('Membership Expiration', 'paid-memberships-pro' );?>:</label></th> |
  | 689 |  | <td><input id="expiration\_<?php echo ~~$level->id;?>" name="expiration[]" type="checkbox" value="<?php echo $level->id?>" <?php if(pmpro\_isLevelExpiring($level)) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).is(':checked')) { jQuery(this).parent().parent().siblings('.expiration\_info').show(); } else { jQuery(this).parent().parent().siblings('.expiration\_info').hide();}" /> <label for="expiration\_<?php echo $level->id;~~?>"><?php \_e('Check this to set when membership access expires.', 'paid-memberships-pro' );?></label></td> |
  |  | 689 | <td><input id="expiration\_<?php echo esc\_attr( $level->id ); ?>" name="expiration[]" type="checkbox" value="<?php echo esc\_attr( $level->id ); ?>" <?php if(pmpro\_isLevelExpiring($level)) { echo "checked='checked'"; } ?> onclick="if(jQuery(this).is(':checked')) { jQuery(this).parent().parent().siblings('.expiration\_info').show(); } else { jQuery(this).parent().parent().siblings('.expiration\_info').hide();}" /> <label for="expiration\_<?php echo esc\_attr( $level->id ); ?>"><?php \_e('Check this to set when membership access expires.', 'paid-memberships-pro' );?></label></td> |
  | 690 | 690 | </tr> |
  | 691 | 691 |  |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L693) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L693) |  |
  | 693 | 693 | <th scope="row" valign="top"><label for="billing\_amount"><?php \_e('Expires In', 'paid-memberships-pro' );?>:</label></th> |
  | 694 | 694 | <td> |
  | 695 |  | <input id="expiration\_number" name="expiration\_number[]" type="text" size="10" value="<?php echo ~~str\_replace("\"", "&quot;", stripslashes($level->expiration\_number))~~?>" /> |
  |  | 695 | <input id="expiration\_number" name="expiration\_number[]" type="text" size="10" value="<?php echo esc\_attr( $level->expiration\_number ); ?>" /> |
  | 696 | 696 | <select id="expiration\_period" name="expiration\_period[]"> |
  | 697 | 697 | <?php |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L773) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L773) |  |
  | 773 | 773 | <label class="screen-reader-text" for="post-search-input"><?php \_e('Search Discount Codes', 'paid-memberships-pro' );?>:</label> |
  | 774 | 774 | <input type="hidden" name="page" value="pmpro-discountcodes" /> |
  | 775 |  | <input id="post-search-input" type="text" value="<?php ~~if(!empty($s)) echo $s;~~?>" name="s" size="30" /> |
  | 776 |  | <input class="button" type="submit" value="<?php \_e('Search', 'paid-memberships-pro' );?>" id="search-submit "/> |
  |  | 775 | <input id="post-search-input" type="text" value="<?php echo esc\_attr( wp\_unslash( $s ) ); ?>" name="s" size="30" /> |
  |  | 776 | <input class="button" type="submit" value="<?php esc\_attr\_e('Search', 'paid-memberships-pro' );?>" id="search-submit "/> |
  | 777 | 777 | </p> |
  | 778 | 778 | </form> |
  | […](/browser/paid-memberships-pro/trunk/adminpages/discountcodes.php?rev=2600585#L807) | […](/browser/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php?rev=2632369#L807) |  |
  | 807 | 807 | <td><?php echo $code->id?></td> |
  | 808 | 808 | <td class="has-row-actions"> |
  | 809 |  | <a title="<?php echo ~~sprintf( \_\_( 'Edit Code: %s', 'paid-memberships-pro' ), $code->code ); ?>" href="<?php echo add\_query\_arg( array( 'page' => 'pmpro-discountcodes', 'edit' => $code->id ), admin\_url('admin.php'~~ ) ); ?>"><?php echo $code->code?></a> |
  |  | 809 | <a title="<?php echo esc\_attr( sprintf( \_\_( 'Edit Code: %s', 'paid-memberships-pro' ), $code->code ) ); ?>" href="<?php echo esc\_url( add\_query\_arg( array( 'page' => 'pmpro-discountcodes', 'edit' => $code->id ), admin\_url('admin.php' ) ) ); ?>"><?php echo $code->code?></a> |
  | 810 | 810 | <div class="row-actions"> |
  | 811 | 811 | <?php |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2632369)
* [Zip Archive](?format=zip&new=2632369)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wpscan.com_9e48e72d_20250114_231824.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Paid Memberships Pro < 2.6.6 - Reflected Cross-Site Scripting

### Description

The plugin does not escape the s parameter before outputting it back in an attribute in an admin page, leading to a Reflected Cross-Site Scripting

### Proof of Concept

https://example.com/wp-admin/admin.php?page=pmpro-discountcodes&s=s"+style=animation-name:rotation+onanimationstart=alert(/XSS/)//

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

paid-memberships-pro](https://a8cteam5105.wordpress.com/plugin/paid-memberships-pro/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.6.6

### References

CVE
[CVE-2021-24979](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24979)

URL
<https://plugins.trac.wordpress.org/changeset/2632369/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[8.8 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
ZhongFu Su(JrXnm) of Wuhan University

Submitter
ZhongFu Su(JrXnm) of Wuhan University

Submitter website
<https://blog.szfszf.top>

Submitter twitter
[JrXnm](//twitter.com/JrXnm)

Verified
Yes

WPVDB ID
[fc011990-4ec1-4553-901d-4ff1f482cb79](https://a8cteam5105.wordpress.com/vulnerability/fc011990-4ec1-4553-901d-4ff1f482cb79/)

### Timeline

Publicly Published
2021-11-23 (about 3 years ago)

Added
2021-11-23 (about 3 years ago)

Last Updated
2022-09-26 (about 2 years ago)

### Other

Published
Title

Published
2023-01-03
Title
[Bold Timeline Lite < 1.1.5 - Contributor+ Stored XSS via Shortcode](https://a8cteam5105.wordpress.com/vulnerability/06e1d63e-576b-4e16-beb7-4f0bfb85e948/)

Published
2023-10-13
Title
[LeadSquared Suite <= 0.7.4 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/e7d28f5f-5fc6-4240-8aac-341fb3aa2770/)

Published
2025-01-14
Title
[Image Gallery – Responsive Photo Gallery < 2.1 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/b056f006-e66f-4ad4-9d03-d8ec91588516/)

Published
2024-02-29
Title
[Exclusive Addons for Elementor < 2.6.9.1 - Authenticated (Contributor+) Stored Cross-Site Scripting via Covid-19 Stats Widget](https://a8cteam5105.wordpress.com/vulnerability/5e7387de-7590-4605-bbec-ed7e1ed74845/)

Published
2024-11-22
Title
[Checkout with Cash App on WooCommerce < 6.0.3 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/0f1b4d94-f23b-485a-9f67-9e91e8c71743/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

