- **Root cause of vulnerability:** The vulnerability lies in the eCommerce module of the NextGEN Gallery Pro plugin. Specifically, the `get_cart_items` action called via `photocrati_ajax` allows injection of malicious JavaScript through the `settings[shipping_address][name]` parameter.
- **Weaknesses/vulnerabilities present:** The primary vulnerability is a Reflected Cross-Site Scripting (XSS) vulnerability. The plugin fails to properly sanitize or encode user-supplied input in the `settings[shipping_address][name]` parameter when processing the `get_cart_items` action. This allows an attacker to inject malicious JavaScript code.
- **Impact of exploitation:** Successful exploitation of this vulnerability would allow an attacker to execute arbitrary JavaScript code in the context of a victim's browser session when they visit a page with the vulnerable NextGEN Gallery Pro plugin. This could lead to various malicious actions, such as session hijacking, cookie theft, defacement of the website, redirection to malicious sites, or phishing attacks.
- **Attack vectors:** The attack vector is through a crafted HTTP GET request to a page containing a NextGEN Gallery (Pro) gallery. The request includes the `photocrati_ajax`, `action=get_cart_items`, and a malicious payload in the `settings[shipping_address][name]` parameter.
- **Required attacker capabilities/position:** An attacker does not need any authentication and can trigger the vulnerability by sending a crafted GET request to a page that includes a NextGEN Gallery (Pro) gallery. The user must also have Javascript enabled and interact with the malicious code for it to execute.

The provided content offers more detail than the official CVE description, specifically providing the vulnerable parameter (`settings[shipping_address][name]`) and a proof-of-concept payload.