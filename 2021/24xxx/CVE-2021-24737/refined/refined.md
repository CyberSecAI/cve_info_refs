- **Root cause of vulnerability:** The plugin does not properly sanitize or escape the Follow and Unfollow messages before outputting them on the page.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The vulnerability exists because user-provided input (the follow/unfollow messages) is not properly sanitized before being displayed to other users.
- **Impact of exploitation:** An attacker can inject malicious scripts that will be executed in the victim's browser when they view a post with a comment. This could lead to various malicious activities like session hijacking, redirecting users to malicious websites, or performing actions on behalf of the victim. The attacker needs to be an administrator or higher to inject the XSS payload.
- **Attack vectors:** The attack vector is through the `wpDiscuz > Phrases > Follow > "You started following this comment author" or "You stopped following this comment author"` settings page in the WordPress admin dashboard. An attacker with admin privileges can insert a malicious payload into these fields.
- **Required attacker capabilities/position:** The attacker needs to have administrative privileges on the WordPress website to modify the wpDiscuz plugin settings. The attacker also needs a user to then click on the follow/unfollow button of a post to trigger the XSS.