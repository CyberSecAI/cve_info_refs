```
- Root cause of vulnerability:
    - Unauthenticated arbitrary file upload via a REST API endpoint used for image compression.
    - The endpoint uses the Kraken image optimization engine and by crafting a specific request, combined with data inserted using an option update vulnerability, attackers can retrieve and upload malicious code from a remote URL, overwriting or creating new files including executable PHP files.

- Weaknesses/vulnerabilities present:
    - Unauthenticated access to a REST API endpoint for image compression.
    - Insecure implementation of the image compression feature.
    - Lack of proper input validation on the file retrieval process.
    - Chained exploit with an unauthenticated option update vulnerability (CVE-2021-24219) that allows attackers to modify settings which are then used to execute the arbitrary file upload vulnerability.

- Impact of exploitation:
    - Arbitrary file upload leading to potential remote code execution.
    - Complete compromise of the WordPress website
    - Potential data theft and further malicious activity.
    - Injection of spam, as observed in some infected sites.
    - Creation of backdoors to further compromise the site
- Attack vectors:
    - Sending crafted POST requests to the vulnerable `/wp-json/thrive/kraken` REST API endpoint.
    - The attack is unauthenticated, allowing any attacker to exploit it if they can reach the vulnerable endpoint.
    - Chaining of the arbitrary file upload with CVE-2021-24219 which allows attackers to modify options and use this data to execute the arbitrary file upload.

- Required attacker capabilities/position:
    - Network access to the vulnerable WordPress site.
    - Ability to send HTTP POST requests.
    - No authentication is required for exploiting the vulnerability.
```