=== Content from wpscan.com_5ff67e79_20250114_194803.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Stream < 3.8.2 - Admin+ SQL Injection

### Description

The plugin does not sanitise and validate the order GET parameter from the Stream Records admin dashboard before using it in a SQL statement, leading to an SQL injection issue.

### Proof of Concept

https://example.com/wp-admin/admin.php?page=wp\_stream&order=+AND+(SELECT+9940+FROM+(SELECT(SLEEP(5)))vqNl)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

stream](https://a8cteam5105.wordpress.com/plugin/stream/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.8.2

### References

CVE
[CVE-2021-24772](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24772)

URL
<https://plugins.trac.wordpress.org/changeset/2615811/stream>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[6.8 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
bl4derunner

Submitter
Anton Sarsadskikh

Verified
Yes

WPVDB ID
[b9d4f2ad-2f12-4822-817d-982a016af85d](https://a8cteam5105.wordpress.com/vulnerability/b9d4f2ad-2f12-4822-817d-982a016af85d/)

### Timeline

Publicly Published
2021-10-18 (about 3 years ago)

Added
2021-10-18 (about 3 years ago)

Last Updated
2022-04-14 (about 2 years ago)

### Other

Published
Title

Published
2024-12-20
Title
[Frontend Admin by DynamiApps < 3.25.2 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/92e78a8a-14ee-4f59-8731-488fb8e35f59/)

Published
2023-07-12
Title
[User Activity Log < 1.6.3 - Admin+ SQLi](https://a8cteam5105.wordpress.com/vulnerability/69dabf3f-7124-4672-bb85-5d802bdd2b49/)

Published
2025-01-03
Title
[Multiple Shipping And Billing Address For Woocommerce < 1.3 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/1d75d0b5-5c83-4952-857d-e80b7fc81177/)

Published
2024-11-08
Title
[WordPress Poll Maker Plugin < 5.4.7 - Authenticated (Administrator+) Time-Based SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/22652763-1474-4ed2-809b-684ad7311894/)

Published
2014-08-01
Title
[NOSpamPTI 2.1 - wp-comments-post.php comment\_post\_ID Parameter SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/36a3a0fa-b911-4f00-aa93-c5c1b16d0887/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from plugins.trac.wordpress.org_4345e6bf_20250114_194801.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2615811%2Fstream)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2600733/stream "Changeset 2600733 for stream")
* [Next Change](/changeset/2615812/stream "Changeset 2615812 for stream") →

---

# Changeset [2615811](/changeset/2615811 "Show full changeset") for [stream](/browser/stream?rev=2615811 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/18/2021 12:24:55 PM
([3 years](/timeline?from=2021-10-18T12%3A24%3A55Z&precision=second "See timeline at 10/18/2021 12:24:55 PM") ago)

Author:
kasparsd
Message:

Committing 3.8.2 to trunk

Location:
[stream/trunk](/browser/stream/trunk?rev=2615811)
Files:

4 edited

* [classes/class-plugin.php](/browser/stream/trunk/classes/class-plugin.php?rev=2615811 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [classes/class-query.php](/browser/stream/trunk/classes/class-query.php?rev=2615811 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.txt](/browser/stream/trunk/readme.txt?rev=2615811 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [stream.php](/browser/stream/trunk/stream.php?rev=2615811 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [stream/trunk/classes/class-plugin.php](/changeset/2615811/stream/trunk/classes/class-plugin.php "Show the changeset 2615811 restricted to stream/trunk/classes/class-plugin.php")

  | [r2600732](/browser/stream/trunk/classes/class-plugin.php?rev=2600732#L19 "Show revision 2600732 of this file in browser") | [r2615811](/browser/stream/trunk/classes/class-plugin.php?rev=2615811#L19 "Show revision 2615811 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | \* @const string |
  | 20 | 20 | \*/ |
  | 21 |  | const VERSION = '3.8.~~1~~'; |
  |  | 21 | const VERSION = '3.8.2'; |
  | 22 | 22 |  |
  | 23 | 23 | /\*\* |
* ## [stream/trunk/classes/class-query.php](/changeset/2615811/stream/trunk/classes/class-query.php "Show the changeset 2615811 restricted to stream/trunk/classes/class-query.php")

  | [r2473170](/browser/stream/trunk/classes/class-query.php?rev=2473170#L180 "Show revision 2473170 of this file in browser") | [r2615811](/browser/stream/trunk/classes/class-query.php?rev=2615811#L180 "Show revision 2615811 of this file in browser") |  |
  | --- | --- | --- |
  | 180 | 180 | \* PARSE ORDER PARAMS |
  | 181 | 181 | \*/ |
  | 182 |  | ~~$order     = esc\_sql( $args['order'] );~~ |
  | 183 |  | ~~$orderby   = esc\_sql( $args['orderby'] );~~ |
  | 184 | 182 | $orderable = array( 'ID', 'site\_id', 'blog\_id', 'object\_id', 'user\_id', 'user\_role', 'summary', 'created', 'connector', 'context', 'action' ); |
  | 185 | 183 |  |
  | 186 |  | if ( in\_array( $orderby, $orderable, true ) ) { |
  | 187 |  | $orderby = sprintf( '%s.%s', $wpdb->stream, $orderby ); |
  | 188 |  | } elseif ( 'meta\_value\_num' === $orderby && ! empty( $args['meta\_key'] ) ) { |
  |  | 184 | // Default to sorting by record ID. |
  |  | 185 | $orderby = "$wpdb->stream.ID"; |
  |  | 186 |  |
  |  | 187 | if ( in\_array( $args['orderby'], $orderable, true ) ) { |
  |  | 188 | $orderby = sprintf( '%s.%s', $wpdb->stream, $args['orderby'] ); |
  |  | 189 | } elseif ( 'meta\_value\_num' === $args['orderby'] && ! empty( $args['meta\_key'] ) ) { |
  | 189 | 190 | $orderby = "CAST($wpdb->streammeta.meta\_value AS SIGNED)"; |
  | 190 |  | } elseif ( 'meta\_value' === $~~orderby~~ && ! empty( $args['meta\_key'] ) ) { |
  |  | 191 | } elseif ( 'meta\_value' === $args['orderby'] && ! empty( $args['meta\_key'] ) ) { |
  | 191 | 192 | $orderby = "$wpdb->streammeta.meta\_value"; |
  | 192 |  | } else { |
  | 193 |  | $orderby = "$wpdb->stream.ID"; |
  | 194 |  | } |
  | 195 |  |  |
  | 196 |  | $orderby = "ORDER BY {$orderby} {$order}"; |
  |  | 193 | } |
  |  | 194 |  |
  |  | 195 | // Show the recent records first by default. |
  |  | 196 | $order = 'DESC'; |
  |  | 197 | if ( 'ASC' === strtoupper( $args['order'] ) ) { |
  |  | 198 | $order = 'ASC'; |
  |  | 199 | } |
  |  | 200 |  |
  |  | 201 | $orderby = sprintf( 'ORDER BY %s %s', $orderby, $order ); |
  | 197 | 202 |  |
  | 198 | 203 | /\*\* |
* ## [stream/trunk/readme.txt](/changeset/2615811/stream/trunk/readme.txt "Show the changeset 2615811 restricted to stream/trunk/readme.txt")

  | [r2600732](/browser/stream/trunk/readme.txt?rev=2600732#L4 "Show revision 2600732 of this file in browser") | [r2615811](/browser/stream/trunk/readme.txt?rev=2615811#L4 "Show revision 2615811 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 4.5 |
  | 5 | 5 | Tested up to: 5.8 |
  | 6 |  | Stable tag: 3.8.~~1~~ |
  |  | 6 | Stable tag: 3.8.2 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 | 8 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/stream/trunk/readme.txt?rev=2600732#L90) | […](/browser/stream/trunk/readme.txt?rev=2615811#L90) |  |
  | 90 | 90 |  |
  | 91 | 91 |  |
  |  | 92 | == Upgrade Notice == |
  |  | 93 |  |
  |  | 94 | = 3.8.2 = |
  |  | 95 |  |
  |  | 96 | Fixes a security vulnerability in the way the `order` query parameter was passed to the database query for authenticated users when viewing the Stream records page in the WordPress admin. |
  |  | 97 |  |
  |  | 98 |  |
  | 92 | 99 | == Changelog == |
  |  | 100 |  |
  |  | 101 | = 3.8.2 - October 12, 2021 = |
  |  | 102 |  |
  |  | 103 | - Security fix: Ensure the value of `order` query parameter forwarded to the database query when viewing the Stream records in the WordPress admin (for authenticated users) is only `ASC` or `DESC`. Previously it passed the whole value of the `order` parameter filtered through `esc\_sql()`. |
  | 93 | 104 |  |
  | 94 | 105 | = 3.8.1 - September 17, 2021 = |
* ## [stream/trunk/stream.php](/changeset/2615811/stream/trunk/stream.php "Show the changeset 2615811 restricted to stream/trunk/stream.php")

  | [r2600732](/browser/stream/trunk/stream.php?rev=2600732#L4 "Show revision 2600732 of this file in browser") | [r2615811](/browser/stream/trunk/stream.php?rev=2615811#L4 "Show revision 2615811 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://xwp.co/work/stream/ |
  | 5 | 5 | \* Description: Stream tracks logged-in user activity so you can monitor every change made on your WordPress site in beautifully organized detail. All activity is organized by context, action and IP address for easy filtering. Developers can extend Stream with custom connectors to log any kind of action. |
  | 6 |  | \* Version: 3.8.~~1~~ |
  |  | 6 | \* Version: 3.8.2 |
  | 7 | 7 | \* Author: XWP |
  | 8 | 8 | \* Author URI: https://xwp.co |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2615811)
* [Zip Archive](?format=zip&new=2615811)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


