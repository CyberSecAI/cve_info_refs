The provided content relates to CVE-2021-24291.

**Root cause of vulnerability:**
The vulnerability is due to the lack of proper sanitization of user-supplied input in the `bwg_frontend_data` AJAX action of the Photo Gallery WordPress plugin.

**Weaknesses/vulnerabilities present:**
The plugin is vulnerable to Reflected Cross-Site Scripting (XSS). Specifically, the `gallery_id`, `tag`, `album_id` and `theme_id` GET parameters passed to the `bwg_frontend_data` AJAX action are not sanitized, allowing attackers to inject malicious scripts.

**Impact of exploitation:**
Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a victim's browser. This can lead to various malicious activities, such as:
- Stealing session cookies
- Defacing the website
- Redirecting users to malicious sites
- Performing actions on behalf of the user

**Attack vectors:**
The attack vector is through specially crafted URLs containing malicious JavaScript code in the vulnerable GET parameters: `gallery_id`, `tag`, `album_id` and `theme_id`.
Specifically, the `bwg_frontend_data` AJAX action is vulnerable.

**Required attacker capabilities/position:**
The attacker does not need to be authenticated. They only need the ability to induce a user to visit a crafted URL. The vulnerability is present in the AJAX endpoint, which is accessible to both unauthenticated and authenticated users.