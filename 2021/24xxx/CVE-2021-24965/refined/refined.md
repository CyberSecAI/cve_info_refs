- **Root cause of vulnerability**: The `rtb_welcome_set_schedule` AJAX action in the Five Star Restaurant Reservations plugin lacks capability and CSRF checks, allowing any authenticated user to call it. Additionally, the plugin does not sanitize and escape user-provided input within the `schedule_open` parameter.
- **Weaknesses/vulnerabilities present**:
  - Lack of capability checks: Any authenticated user, including subscribers, can trigger the vulnerable function.
  - Lack of CSRF checks: The function is vulnerable to Cross-Site Request Forgery.
  - Stored Cross-Site Scripting (XSS): User-supplied data is not properly sanitized or escaped before being stored and rendered in the plugin settings.
- **Impact of exploitation**: An attacker can inject malicious JavaScript code that will be executed in the context of the victim's browser when an administrator views the plugin settings, potentially allowing the attacker to steal session cookies, redirect the victim to a malicious website, or perform other actions on behalf of the administrator.
- **Attack vectors**: The vulnerability is exploited via an AJAX request to `/wp-admin/admin-ajax.php` with the `action` parameter set to `rtb_welcome_set_schedule` and the malicious JavaScript payload injected into the `schedule_open` parameter.
- **Required attacker capabilities/position**: The attacker needs to be an authenticated user of the WordPress site, with subscriber privileges or higher.