- **Root cause of vulnerability**: The plugin does not properly escape some attributes of the `glossary_tooltip` shortcode.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability. The plugin fails to sanitize user-supplied input in the `dashicon`, `style`, and `link` attributes of the `glossary_tooltip` shortcode, allowing injection of malicious JavaScript.
- **Impact of exploitation**: An attacker can inject malicious JavaScript that executes in the context of the victim's browser when they view a page or post containing the crafted shortcode. This can lead to various malicious activities, such as session hijacking, phishing, or redirecting users to malicious sites.
- **Attack vectors**: By using the shortcode `[glossary_tooltip dashicon='" style="animation-name:twentytwentyone-close-button-transition" onanimationend="alert(/XSS-enhanced-tooltipglossary_dashicon/)//' link="javascript:alert(/XSS-enhanced-tooltipglossary_link/)"]Click me[/glossary_tooltip]`, an attacker can embed malicious javascript into the `dashicon`, `style`, and `link` attributes that is executed when the tooltip is rendered.
- **Required attacker capabilities/position**: An attacker needs to have a WordPress user account with the Contributor role or higher, which allows them to create or modify posts/pages and embed shortcodes.