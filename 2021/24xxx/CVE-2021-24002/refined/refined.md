- **Root cause of vulnerability**: The vulnerability stems from the lack of proper sanitization of newline characters (%0A and %0D) in FTP URLs. When a user clicks on such a URL, these encoded characters are interpreted as actual newlines, allowing for the injection of arbitrary FTP commands.
- **Weaknesses/vulnerabilities present**: Improper input validation and lack of sanitization of special characters in FTP URLs.
- **Impact of exploitation**: An attacker can inject arbitrary FTP commands into an FTP server by crafting a malicious link containing encoded newline characters. This could lead to:
    - Deletion of files on the FTP server.
    - Downloading files from the FTP server to a server controlled by the attacker, impersonating the victim user who clicked the malicious link.
    - Potential NAT slipstreaming attacks, depending on the victim's router's configuration and FTP ALG implementation.
- **Attack vectors**: The attack vector is a malicious FTP URL embedded within a webpage.
- **Required attacker capabilities/position**: The attacker needs to craft a malicious webpage containing an FTP URL with encoded newline characters. The victim must then click on this link while using a vulnerable version of Firefox.