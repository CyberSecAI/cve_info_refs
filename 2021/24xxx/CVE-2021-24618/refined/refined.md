- **Root cause of vulnerability:** The plugin does not sanitize or escape the QRCode Image setting.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability due to lack of sanitization/escaping. Additionally, missing CSRF and capability checks when saving settings.
- **Impact of exploitation:** An attacker can inject malicious scripts that will execute in the context of users who view affected pages (all frontend posts).
- **Attack vectors:** By sending a crafted POST request to `/wp-admin/admin-ajax.php` with the `action=wb_dwqr_setting` parameter, an attacker can inject arbitrary JavaScript code into the `opt[items][weixin][img]` setting. This can be done either by an authenticated user (even with low privileges) or by an unauthenticated user via a CSRF attack.
- **Required attacker capabilities/position:**
  - For versions `< 1.4.2`: An authenticated user with any privilege level.
  - For versions `< 1.4.5`:  An admin user can trigger it via CSRF, or any authenticated user can trigger it directly.
  - The attacker can trigger the XSS by visiting any frontend post where the vulnerable setting is used.