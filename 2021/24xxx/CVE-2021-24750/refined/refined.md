Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**

*   The `refUrl` parameter within the `refDetails` AJAX action is not properly sanitized or escaped before being used in an SQL query.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:** The lack of sanitization allows an attacker to inject arbitrary SQL code into the query.

**Impact of Exploitation:**

*   An attacker can potentially read sensitive information from the database, such as user emails and passwords.

**Attack Vectors:**

*   The vulnerability is located in the `refDetails` AJAX action.
*   The attacker can exploit this vulnerability by sending a crafted request to the `admin-ajax.php` endpoint.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be an authenticated user on the WordPress site. A user with a role as low as "subscriber" can exploit this vulnerability.

**Additional Details:**

*   The vulnerable code exists in the `wp-stats-manager` plugin, specifically before version 4.8.
*   The vulnerability was fixed in version 4.8 of the plugin.
*   The `refUrl` parameter is passed via a GET request.
*   The `LIKE` operator in the SQL query makes it easier to perform the SQL injection.
*   The `wsm_db.php` file contains the vulnerable code.
*   The exploit can be triggered by crafting a JSON object with a malicious SQL statement in the `refUrl` field, such as: `{"refUrl":"' union select 1,1,user_email,user_pass from wp_users -- g"}`

This information provides a comprehensive overview of the SQL injection vulnerability in the `wp-stats-manager` plugin.