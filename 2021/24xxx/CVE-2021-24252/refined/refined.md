- **Root cause of vulnerability**: The plugin does not verify uploaded image file types, allowing admin accounts to upload arbitrary files. Additionally, there is a lack of CSRF protection, and authorization checks are missing which can lead to Local File Inclusion (LFI).
- **Weaknesses/vulnerabilities present**:
    - Arbitrary File Upload: The plugin fails to validate the type of uploaded files, enabling the upload of executable files like .exe, .php etc.
    - Lack of CSRF protection: The absence of CSRF checks allows for exploitation via cross-site request forgery.
    - Missing authorization checks: Lack of proper authorization checks could be exploited via LFI to achieve the same result if the WP environment is loaded.
- **Impact of exploitation**: Successful exploitation of these vulnerabilities can lead to Remote Code Execution (RCE) on the server.
- **Attack vectors**:
    - Direct file upload by an authenticated admin user.
    - Cross-Site Request Forgery (CSRF) to trigger the file upload.
    - Potentially via Local File Inclusion (LFI) if WP is loaded due to the lack of authorization checks.
- **Required attacker capabilities/position**:
    - For direct file upload, attacker requires admin-level access to the WordPress instance.
    - For CSRF attacks, attacker needs to trick an authenticated admin user into making a malicious request.
    - For LFI, attacker needs to find a way to load the WP environment.