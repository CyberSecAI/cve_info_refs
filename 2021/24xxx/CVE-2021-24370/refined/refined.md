### Relevant Content:
The provided content describes CVE-2021-24370, a critical vulnerability in the Fancy Product Designer WordPress plugin.

**Root cause of vulnerability:**
The vulnerability is due to insufficient checks on uploaded files, allowing bypass of file upload restrictions, specifically within the `custom-image-handler.php` file. The plugin attempts to sanitize filenames but fails due to a flaw in the sanitization logic where malicious extensions can be disguised and later converted to executable ones (e.g., ".p h p" becomes ".php").

**Weaknesses/vulnerabilities present:**
- Unauthenticated arbitrary file upload
- Time of Check, Time of Use (TOCTOU) weakness in `custom-image-handler.php`
- Insufficient sanitization of filenames before upload
- Bypass of the plugin's file upload restrictions

**Impact of exploitation:**
- Remote code execution (RCE)
- Full site takeover
- Potential extraction of sensitive information, such as customer order data
- PCI-DSS compliance violation for e-commerce sites

**Attack vectors:**
- Sending a POST request to `/wp-content/plugins/fancy-product-designer/inc/custom-image-handler.php`
- Providing specific POST parameters, including a malicious file disguised with a manipulated extension in the 'url' parameter.

**Required attacker capabilities/position:**
- Unauthenticated access to the affected website
- Ability to send HTTP POST requests with specific parameters

**Additional details:**
- The vulnerability was actively exploited.
- Even deactivated plugins are vulnerable in some configurations.
- The initial attack vector used a dropper (`ass.php`) that retrieves additional malware.
- Indicators of Compromise include specific filenames and their MD5 hashes (ass.php, op.php, prosettings.php, 4fa00001c720b30102987d980e62d5e4.php, 4fa00001c720b30002987d983e62d5e1.jpg), and file uploads to `wp-admin` or `wp-content/plugins/fancy-product-designer/inc` subfolders
- The vulnerability was exploited since at least January 30, 2021.
- The vulnerability exists in versions prior to 4.6.9 of the Fancy Product Designer plugin.
- Some reports mention that this vulnerability is more easily exploited on NGINX servers due to how `.htaccess` rules are processed