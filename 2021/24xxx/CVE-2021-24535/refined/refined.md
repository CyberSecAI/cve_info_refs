- **Root cause of vulnerability:** The Light Messages plugin lacks CSRF protection when updating settings and does not sanitize the Message Content input, even with unfiltered_html disallowed.
- **Weaknesses/vulnerabilities present:**
  - Cross-Site Request Forgery (CSRF)
  - Stored Cross-Site Scripting (XSS)
- **Impact of exploitation:** An attacker can trick a logged-in administrator into updating the plugin settings with arbitrary values, including a malicious XSS payload in the message content. This payload can be triggered in the backend only or in both the frontend and backend, depending on the plugin settings.
- **Attack vectors:**
  - CSRF attack: An attacker crafts a malicious HTML form that, when submitted by a logged-in admin, updates the plugin settings.
  - XSS: The injected malicious script is stored in the plugin settings and executed when the settings page or the message content is rendered.
- **Required attacker capabilities/position:**
  - The attacker needs to trick a logged-in administrator to submit the crafted CSRF form.
  - The attacker needs to be able to craft and inject the malicious HTML to be stored in the plugin's settings.