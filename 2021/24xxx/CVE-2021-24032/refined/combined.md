=== Content from www.facebook.com_db574c7a_20250114_210204.html ===

# [*Facebook*](https://www.facebook.com/ "Go to Facebook home")

[Join or Log Into Facebook](/) Email or phonePassword[Forgot account?](https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar)Log InDo you want to join Facebook?[Sign Up](/reg/?privacy_mutation_token=eyJ0eXBlIjowLCJjcmVhdGlvbl90aW1lIjoxNzM2ODg4NTIzLCJjYWxsc2l0ZV9pZCI6MzYzOTY5MDQ0ODc4OTI4fQ%3D%3D)[Sign Up](/r.php?locale=en_US)
# CVE-2021-24032

**Description:**  Due to an incomplete fix for CVE-2021-24031, the Zstandard command-line utility created output files with default permissions and restricted those permissions immediately afterwards. Output files could therefore momentarily be readable or writable to unintended parties. **Affected Versions:** This issue affects Zstandard after v1.4.1 and prior to v1.4.9. **Last Updated:** 2021-03-01

* English (US)
* [Gaeilge](https://www.facebook.com/security/advisories/cve-2021-24032 "Irish")
* [Polski](https://ga-ie.facebook.com/security/advisories/cve-2021-24032 "Polish")
* [Lietuvių](https://pl-pl.facebook.com/security/advisories/cve-2021-24032 "Lithuanian")
* [Português (Brasil)](https://lt-lt.facebook.com/security/advisories/cve-2021-24032 "Portuguese (Brazil)")
* [Русский](https://pt-br.facebook.com/security/advisories/cve-2021-24032 "Russian")
* [Română](https://ru-ru.facebook.com/security/advisories/cve-2021-24032 "Romanian")
* [Español](https://ro-ro.facebook.com/security/advisories/cve-2021-24032 "Spanish")
* [Français (France)](https://es-la.facebook.com/security/advisories/cve-2021-24032 "French (France)")
* [Deutsch](https://fr-fr.facebook.com/security/advisories/cve-2021-24032 "German")
* [Italiano](https://de-de.facebook.com/security/advisories/cve-2021-24032 "Italian")

* [Sign Up](/reg/ "Sign Up for Facebook")
* [Log In](/login/ "Log into Facebook")
* [Messenger](https://messenger.com/ "Check out Messenger.")
* [Facebook Lite](/lite/ "Facebook Lite for Android.")
* [Video](https://www.facebook.com/watch/ "Browse in Video")
* [Places](/places/ "Check out popular places on Facebook.")
* [Games](/games/ "Check out Facebook games.")
* [Marketplace](/marketplace/ "Buy and sell on Facebook Marketplace.")
* [Meta Pay](https://about.meta.com/technologies/meta-pay "Learn more about Meta Pay")
* [Meta Store](https://www.meta.com/ "Check out Meta")
* [Meta Quest](https://www.meta.com/quest/ "Learn more about Meta Quest")
* [Ray-Ban Meta](https://www.meta.com/smart-glasses/ "Learn more about Ray-Ban Meta")
* [Meta AI](https://www.meta.ai/ "Meta AI")
* [Instagram](https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.instagram.com%2F&h=AT2QHsVMN3m9XexfG48HVYMraQyTfliQnAHfUmdOP1LRumM5FANKSVgqn73ZZzWvmTlixs4UtVYe0krQhPAZ_M_jOGpB_GSbX8ZQflZ_aXRZ7GbuwOwc0tAn02kDCNZg7K3HzAdvlX93DeSiR_YaXQ "Check out Instagram")
* [Threads](https://www.threads.net/ "Check out Threads")
* [Fundraisers](/fundraisers/ "Donate to worthy causes.")
* [Services](/biz/directory/ "Browse our Facebook Services directory.")
* [Voting Information Center](/votinginformationcenter/?entry_point=c2l0ZQ%3D%3D "See the Voting Information Center.")
* [Privacy Policy](/privacy/policy/?entry_point=facebook_page_footer "Learn how we collect, use and share information to support Facebook.")
* [Privacy Center](/privacy/center/?entry_point=facebook_page_footer "Learn how to manage and control your privacy on Facebook.")
* [Groups](/groups/discover/ "Explore our Groups.")
* [About](https://about.meta.com/ "Read our blog, discover the resource center, and find job opportunities.")
* [Create ad](/ad_campaign/landing.php?placement=pflo&campaign_id=402047449186&nav_source=unknown&extra_1=auto "Advertise on Facebook.")
* [Create Page](/pages/create/?ref_type=site_footer "Create a page")
* [Developers](https://developers.facebook.com/?ref=pf "Develop on our platform.")
* [Careers](/careers/?ref=pf "Make your next career move to our awesome company.")
* [Cookies](/policies/cookies/ "Learn about cookies and Facebook.")
* [Ad choices](https://www.facebook.com/help/568137493302217 "Learn about Ad Choices.")
* [Terms](/policies?ref=pf "Review our terms and policies.")
* [Help](/help/?ref=pf "Visit our Help Center.")
* [Contact Uploading & Non-Users](https://www.facebook.com/help/637205020878504 "Visit our Contact Uploading & Non-Users Notice.")
* [Settings](/settings "View and edit your Facebook settings.")
* [Activity log](/allactivity?privacy_source=activity_log_top_menu "View your activity log")
 Meta © 2025![](https://facebook.com/security/hsts-pixel.gif)



=== Content from github.com_53b602a9_20250114_210203.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fzstd%2Fissues%2F2491)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fzstd%2Fissues%2F2491)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=facebook%2Fzstd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[facebook](/facebook)
/
**[zstd](/facebook/zstd)**
Public

* [Notifications](/login?return_to=%2Ffacebook%2Fzstd) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Ffacebook%2Fzstd)
* [Star
   24.1k](/login?return_to=%2Ffacebook%2Fzstd)

* [Code](/facebook/zstd)
* [Issues
  166](/facebook/zstd/issues)
* [Pull requests
  19](/facebook/zstd/pulls)
* [Actions](/facebook/zstd/actions)
* [Projects
  0](/facebook/zstd/projects)
* [Wiki](/facebook/zstd/wiki)
* [Security](/facebook/zstd/security)
* [Insights](/facebook/zstd/pulse)

Additional navigation options

* [Code](/facebook/zstd)
* [Issues](/facebook/zstd/issues)
* [Pull requests](/facebook/zstd/pulls)
* [Actions](/facebook/zstd/actions)
* [Projects](/facebook/zstd/projects)
* [Wiki](/facebook/zstd/wiki)
* [Security](/facebook/zstd/security)
* [Insights](/facebook/zstd/pulse)

# Race condition allows attacker to access world-readable destination file #2491

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Race condition allows attacker to access world-readable destination file](#top)#2491Copy linkAssignees [![felixhandte](https://avatars.githubusercontent.com/u/1154694?s=64&v=4)](/felixhandte)Labels[bug](https://github.com/facebook/zstd/issues?q=state%3Aopen%20label%3A%22bug%22)![@sdelafond](https://avatars.githubusercontent.com/u/201134?v=4&size=80)
## Description

![@sdelafond](https://avatars.githubusercontent.com/u/201134?v=4&size=48)[sdelafond](https://github.com/sdelafond)opened [on Feb 11, 2021](https://github.com/facebook/zstd/issues/2491#issue-806153115)

The patches for [#1630](https://github.com/facebook/zstd/issues/1630) still create the file with the default umask, before chmod'ing down to 0600, so an attacker could still open it in the meantime. inotify can for instance help automating such an attack.

zstd should either set the mode directly through open(2), or use umask(2) before creating the file.

This is Debian bug <https://bugs.debian.org/982519>.

## Metadata

### Assignees

* [![@felixhandte](https://avatars.githubusercontent.com/u/1154694?s=64&v=4)felixhandte](/felixhandte)
### Labels

[bug](https://github.com/facebook/zstd/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.debian.org_09927a05_20250114_210202.html ===

# Debian Bug report logs - #982519 zstd: Race condition allows attacker to access world-readable destination file

[![version graph](version.cgi?collapse=1;width=2;fixed=libzstd%2F1.4.8%2Bdfsg-2;fixed=libzstd%2F1.3.8%2Bdfsg-3%2Bdeb10u2;found=libzstd%2F1.3.8%2Bdfsg-3%2Bdeb10u1;found=libzstd%2F1.1.2-1;found=libzstd%2F1.4.8%2Bdfsg-1;height=2;absolute=0;package=zstd)](version.cgi?package=zstd;absolute=0;found=libzstd%2F1.3.8%2Bdfsg-3%2Bdeb10u1;found=libzstd%2F1.1.2-1;found=libzstd%2F1.4.8%2Bdfsg-1;fixed=libzstd%2F1.4.8%2Bdfsg-2;fixed=libzstd%2F1.3.8%2Bdfsg-3%2Bdeb10u2;info=1;collapse=1)

Package:
[zstd](pkgreport.cgi?package=zstd);
Maintainer for [zstd](pkgreport.cgi?package=zstd) is [RPM packaging team <team+pkg-rpm@tracker.debian.org>](pkgreport.cgi?maint=team%2Bpkg-rpm%40tracker.debian.org); Source for [zstd](pkgreport.cgi?package=zstd) is [src:libzstd](pkgreport.cgi?src=libzstd) ([PTS](https://tracker.debian.org/pkg/libzstd), [buildd](https://buildd.debian.org/libzstd), [popcon](https://qa.debian.org/popcon.php?package=libzstd)).

Reported by: [Sebastien Delafond <seb@debian.org>](pkgreport.cgi?submitter=seb%40debian.org)

Date: Thu, 11 Feb 2021 07:36:02 UTC

Severity: *grave*

Tags: security, upstream

Found in versions libzstd/1.3.8+dfsg-3+deb10u1, libzstd/1.1.2-1, libzstd/1.4.8+dfsg-1

Fixed in versions libzstd/1.4.8+dfsg-2, libzstd/1.3.8+dfsg-3+deb10u2

**Done:** Étienne Mollier <etienne.mollier@mailoo.org>

Bug is archived. No further changes may be made.

Forwarded to <https://github.com/facebook/zstd/issues/2491>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=982519;mbox=yes), [status mbox](bugreport.cgi?bug=982519;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=982519;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#982519`; Package `zstd`.
(Thu, 11 Feb 2021 07:36:04 GMT) ([full text](bugreport.cgi?bug=982519;msg=2), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Sebastien Delafond <seb@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
(Thu, 11 Feb 2021 07:36:04 GMT) ([full text](bugreport.cgi?bug=982519;msg=4), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=5), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=seb%40debian.org)
From: Sebastien Delafond <seb@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: zstd: Race condition allows attacker to access world-readable destination file
Date: Thu, 11 Feb 2021 08:33:58 +0100
```
Package: zstd
Version: 1.4.8+dfsg-1
Severity: grave
Tags: security
X-Debbugs-Cc: team@security.debian.org

The recently applied patch still creates the file with the default
umask[0], before chmod'ing down to 0600, so an attacker could still open
it in the meantime.

Cheers,

--
Seb

[0] <https://github.com/facebook/zstd/blob/dev/programs/fileio.c#L682>

```

---

**Added tag(s) upstream.**
Request was from `Sebastien Delafond <seb@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Feb 2021 07:45:04 GMT) ([full text](bugreport.cgi?bug=982519;msg=7), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=7), [link](#6)).

---

**Set Bug forwarded-to-address to '<https://github.com/facebook/zstd/issues/2491>'.**
Request was from `Sebastien Delafond <seb@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Feb 2021 07:45:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=9), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#982519`; Package `zstd`.
(Thu, 11 Feb 2021 15:57:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=11), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
(Thu, 11 Feb 2021 15:57:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=13), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 982519@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=14), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: wferi@niif.hu, 981404@bugs.debian.org
Cc: 982519@bugs.debian.org
Subject: Re: Bug#981404: Fix seems incomplete
Date: Thu, 11 Feb 2021 16:54:53 +0100
```
Hi Feri,,

On Thu, Feb 11, 2021 at 11:26:47AM +0100, wferi@niif.hu wrote:
> Hi,
>
> The patch in this bug report very much shrinks the window of the
> vulnerability, but doesn't close it completely: the file is still
> created with default permissions, then chmodded as a separate step.
> It's hard, but not impossible to still win the race and open the file
> before the chmod, enabling the same attack.  I recommend something like
>
> fd = open(dstFileName, O_WRONLY|O_CREAT|O_EXCL, 0600);
> if (fd != -1)
>     f = fdopen( fd, "wb" );
> if (fd == -1 || f == NULL)
>     DISPLAYLEVEL(1, "zstd: %s: %s\n", dstFileName, strerror(errno));
> return f;
>
> for example.

See #982519 respectively <https://github.com/facebook/zstd/issues/2491>
upstream.

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#982519`; Package `zstd`.
(Thu, 18 Feb 2021 05:21:03 GMT) ([full text](bugreport.cgi?bug=982519;msg=16), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
(Thu, 18 Feb 2021 05:21:03 GMT) ([full text](bugreport.cgi?bug=982519;msg=18), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 982519@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=19), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Sebastien Delafond <seb@debian.org>, 982519@bugs.debian.org
Subject: Re: Bug#982519: zstd: Race condition allows attacker to access
world-readable destination file
Date: Thu, 18 Feb 2021 06:19:29 +0100
```
On Thu, Feb 11, 2021 at 08:33:58AM +0100, Sebastien Delafond wrote:
> Package: zstd
> Version: 1.4.8+dfsg-1
> Severity: grave
> Tags: security
> X-Debbugs-Cc: team@security.debian.org
>
> The recently applied patch still creates the file with the default
> umask[0], before chmod'ing down to 0600, so an attacker could still open
> it in the meantime.

FTR, this has been fixed upstream.

<https://github.com/facebook/zstd/commit/a774c5797399040af62db21d8a9b9769e005430e>

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#982519`; Package `zstd`.
(Thu, 18 Feb 2021 10:39:02 GMT) ([full text](bugreport.cgi?bug=982519;msg=21), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Étienne Mollier <etienne.mollier@mailoo.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
(Thu, 18 Feb 2021 10:39:02 GMT) ([full text](bugreport.cgi?bug=982519;msg=23), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 982519@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=24), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=etienne.mollier%40mailoo.org)
From: Étienne Mollier <etienne.mollier@mailoo.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 982519@bugs.debian.org,
seb@debian.org
Subject: [sprint] [RFS] libzstd 1.4.8+dfsg-2
Date: Thu, 18 Feb 2021 11:34:37 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=982519;msg=24) (text/plain, inline)]
```
```
Control: tag -1 pending

Hi Sébastien, Hi Salvatore,

Salvatore Bonaccorso, on 2021-02-18 06:19:29 +0100:
> FTR, this has been fixed upstream.

Thanks the ping, I inlined upstream patch in the next iteration
of libzstd: 1.4.8+dfsg-2.  Upload will occur with urgency=high.
Changes are available on Salsa:

	<https://salsa.debian.org/med-team/libzstd>

This package will need sponsored upload (unless Nilesh did grant
me upload permissions.  :)

Have a nice day,
--
Étienne Mollier <etienne.mollier@mailoo.org>
Fingerprint:  8f91 b227 c7d6 f2b1 948c  8236 793c f67e 8f0d 11da
Sent from /dev/pts/1, please excuse my verbosity.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=982519;filename=signature.asc;msg=24) (application/pgp-signature, inline)]
```

---

**Added tag(s) pending.**
Request was from `Étienne Mollier <etienne.mollier@mailoo.org>`
to `982519-submit@bugs.debian.org`.
(Thu, 18 Feb 2021 10:39:02 GMT) ([full text](bugreport.cgi?bug=982519;msg=26), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=26), [link](#25)).

---

**Marked as found in versions libzstd/1.3.8+dfsg-3+deb10u1.**
Request was from `Étienne Mollier <etienne.mollier@mailoo.org>`
to `control@bugs.debian.org`.
(Thu, 18 Feb 2021 10:51:05 GMT) ([full text](bugreport.cgi?bug=982519;msg=28), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=28), [link](#27)).

---

**Marked as found in versions libzstd/1.1.2-1.**
Request was from `Étienne Mollier <etienne.mollier@mailoo.org>`
to `control@bugs.debian.org`.
(Thu, 18 Feb 2021 10:51:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=30), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=30), [link](#29)).

---

**Reply sent**
to `Étienne Mollier <etienne.mollier@mailoo.org>`:

You have taken responsibility.
(Thu, 18 Feb 2021 11:21:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=32), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=32), [link](#31)).

---

**Notification sent**
to `Sebastien Delafond <seb@debian.org>`:

Bug acknowledged by developer.
(Thu, 18 Feb 2021 11:21:06 GMT) ([full text](bugreport.cgi?bug=982519;msg=34), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 982519-close@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=35), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 982519-close@bugs.debian.org
Subject: Bug#982519: fixed in libzstd 1.4.8+dfsg-2
Date: Thu, 18 Feb 2021 11:19:24 +0000
```
Source: libzstd
Source-Version: 1.4.8+dfsg-2
Done: Étienne Mollier <etienne.mollier@mailoo.org>

We believe that the bug you reported is fixed in the latest version of
libzstd, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 982519@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Étienne Mollier <etienne.mollier@mailoo.org> (supplier of updated libzstd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 18 Feb 2021 09:52:53 +0100
Source: libzstd
Architecture: source
Version: 1.4.8+dfsg-2
Distribution: unstable
Urgency: high
Maintainer: Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>
Changed-By: Étienne Mollier <etienne.mollier@mailoo.org>
Closes: [982519](bugreport.cgi?bug=982519)
Changes:
 libzstd (1.4.8+dfsg-2) unstable; urgency=high
 .
   * Team upload.
   * When a file with restricted permissions is compressed, the resulting file
     inherits the umask of the user for the time of the compression.  This was
     partially mitigated previously by running a change of permissions after a
     `chmod`, but left a small but exploitable window just after the `fopen`.
     This update adds 0018-fix-file-permissions-on-compression.patch to make
     sure the compressed file is not group nor world readable for the _entire_
     duration of the compression.
     Closes: #[982519](bugreport.cgi?bug=982519)
Checksums-Sha1:
 c03852712749e44d07c52073b0862c74fc536326 2266 libzstd_1.4.8+dfsg-2.dsc
 7ddd022f263593fd1420a20b726988fc4177e566 14644 libzstd_1.4.8+dfsg-2.debian.tar.xz
 3446d20b07dc6f52cfcb4a3abf9b4d7c84c1d104 7398 libzstd_1.4.8+dfsg-2_amd64.buildinfo
Checksums-Sha256:
 956bf60dc6f33a2a1deac7b0323d31e409fa8833f0fad423cede60a96ce73317 2266 libzstd_1.4.8+dfsg-2.dsc
 67cb0e652e9b6f543640b82ff5a5e94460d8e107521af7518e06477aa4df0822 14644 libzstd_1.4.8+dfsg-2.debian.tar.xz
 2bc235602530e434b8811d4732197c1e6878bdfee58e4872f39e1b3936b5595c 7398 libzstd_1.4.8+dfsg-2_amd64.buildinfo
Files:
 c4b5c38975d04467ae5b9b564770a6bf 2266 libs optional libzstd_1.4.8+dfsg-2.dsc
 908f01d234189534d8661d8a2c2f77c1 14644 libs optional libzstd_1.4.8+dfsg-2.debian.tar.xz
 afbf6a443b713102575837d428704b1e 7398 libs optional libzstd_1.4.8+dfsg-2_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEj5GyJ8fW8rGUjII2eTz2fo8NEdoFAmAuPdQACgkQeTz2fo8N
Edq5kw//bMU9RNODi4Vn/LQwx38j13P+uirwvPM7+BKbq1v3Gr4FBdogbCZarChM
aMnQ5BDMFGThZaW69GXrGEEZB/EuhIbwNWH3tBpbAEYLlz7vfg5JlmVNW/WxhifR
/l05ZAUzix0wx6fFfM11tVXDX0Tjr/pa60aNnbw3Bu2tJrjuLR0foh8iSyLHSDsf
jjRBrf7OtRV2X8d7r5xOUuHkmVXyGV3Bp5g8yhrSBGIW/9kjXRrcOUbUXTb7lca6
tmAgRnXAfAK1+GCPYMelJANRTjSVKEXcEArlIKKkXWLqdclRLcpHDEA5flXceoGx
bNtooNwEPZCuYak7BDq4US8C0Wsn3sP3Fmolzuwo4+Vw7DCXcDRSoQuupHj2qRJC
otlCJcTP1cr2rHGlSzzfHCK8cIuH8TgkOqsRu7zmKA1i4B5l1NRdYvI4T2Lcm1og
/SITL57mlqnwqtpSrXOT48nuH7k9Gi1he6r6B98e/YSuW5YEeJ6+ULyDYGrtC0EL
QL3avVLUQi0PMCwHupI6+zaGqPu3pdSO//A3YsE6cmNobeb3Ywax3/Za6SfDKdQh
K+GYAK0tj4JTd4lvR4y2gZkZNHCYUKm8NSK68+ttQwB/3mxTdPan5AJ2RrH7Sz7M
0M+dSq/FxNQM60WnSaVFXcVDkOVNAbA/XGJg3isDgM+WBODAgIU=
=urmZ
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#982519`; Package `zstd`.
(Thu, 18 Feb 2021 18:27:03 GMT) ([full text](bugreport.cgi?bug=982519;msg=37), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Thorsten Glaser <t.glaser@tarent.de>`:

Extra info received and forwarded to list. Copy sent to `Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
(Thu, 18 Feb 2021 18:27:03 GMT) ([full text](bugreport.cgi?bug=982519;msg=39), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 982519@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=40), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=t.glaser%40tarent.de)
From: Thorsten Glaser <t.glaser@tarent.de>
To: "W. Felix Handte" <w@felixhandte.com>
Cc: Salvatore Bonaccorso <carnil@debian.org>,
Sebastien Delafond <seb@debian.org>, 982519@bugs.debian.org
Subject: Re: Bug#982519: zstd: Race condition allows attacker to access
world-readable destination file
Date: Thu, 18 Feb 2021 19:23:59 +0100 (CET)
```
On Thu, 18 Feb 2021, Salvatore Bonaccorso wrote:
> On Thu, Feb 11, 2021 at 08:33:58AM +0100, Sebastien Delafond wrote:

> > The recently applied patch still creates the file with the default
> > umask[0], before chmod'ing down to 0600, so an attacker could still open
> > it in the meantime.
>
> FTR, this has been fixed upstream.
>
> <https://github.com/facebook/zstd/commit/a774c5797399040af62db21d8a9b9769e005430e>

| Note that a downside of this solution is that it is global: `umask()` affects
| all file creation calls in the process. I believe this is safe since
| […] thread […]

Why don’t you use a nōn-global solution then?

Instead of fopen(…) do an open(…, 0600) followed by fdopen().

bye,
//mirabilos
--
Sometimes they [people] care too much: pretty printers [and syntax highligh-
ting, d.A.] mechanically produce pretty output that accentuates irrelevant
detail in the program, which is as sensible as putting all the prepositions
in English text in bold font.	-- Rob Pike in "Notes on Programming in C"

```

---

**Reply sent**
to `Étienne Mollier <etienne.mollier@mailoo.org>`:

You have taken responsibility.
(Wed, 24 Feb 2021 17:36:12 GMT) ([full text](bugreport.cgi?bug=982519;msg=42), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=42), [link](#41)).

---

**Notification sent**
to `Sebastien Delafond <seb@debian.org>`:

Bug acknowledged by developer.
(Wed, 24 Feb 2021 17:36:12 GMT) ([full text](bugreport.cgi?bug=982519;msg=44), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 982519-close@bugs.debian.org ([full text](bugreport.cgi?bug=982519;msg=45), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 982519-close@bugs.debian.org
Subject: Bug#982519: fixed in libzstd 1.3.8+dfsg-3+deb10u2
Date: Wed, 24 Feb 2021 17:32:41 +0000
```
Source: libzstd
Source-Version: 1.3.8+dfsg-3+deb10u2
Done: Étienne Mollier <etienne.mollier@mailoo.org>

We believe that the bug you reported is fixed in the latest version of
libzstd, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 982519@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Étienne Mollier <etienne.mollier@mailoo.org> (supplier of updated libzstd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 18 Feb 2021 12:59:48 +0100
Source: libzstd
Architecture: source
Version: 1.3.8+dfsg-3+deb10u2
Distribution: buster-security
Urgency: high
Maintainer: Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>
Changed-By: Étienne Mollier <etienne.mollier@mailoo.org>
Closes: [982519](bugreport.cgi?bug=982519)
Changes:
 libzstd (1.3.8+dfsg-3+deb10u2) buster-security; urgency=high
 .
   * Team upload.
   * The previous fix-file-permissions-on-compression.patch almost closed the
     window of the race condition, but not completely.  This patch, adapted from
     upstream, 0017-fix-file-permissions-on-compression.patch, replaces the
     previous attempt by erasing the umask before opening the destination file.
     Closes: #[982519](bugreport.cgi?bug=982519)
Checksums-Sha1:
 03d81ebef581456fe05ed1b29c04b7a246397e31 1947 libzstd_1.3.8+dfsg-3+deb10u2.dsc
 15d166c14fb22f550ae877780e7df4181db3db99 11648 libzstd_1.3.8+dfsg-3+deb10u2.debian.tar.xz
 59e9ea6e541e66619ccd623c803bff02a73fa9d2 7283 libzstd_1.3.8+dfsg-3+deb10u2_amd64.buildinfo
Checksums-Sha256:
 572fae1c7dc9bace3b9f7fcdeabf30dd1d00d0462e319ccec7b58b0adbf7dc85 1947 libzstd_1.3.8+dfsg-3+deb10u2.dsc
 1f107f6cdc3bf46fb2aebf9c5c997ed2a125ac2fb1d28e939da857d5b061079e 11648 libzstd_1.3.8+dfsg-3+deb10u2.debian.tar.xz
 4a9e21b3a79b55dc746cc49e73a071dcecc0dc72d337c1b7d7ea1e5d2cd5eeb5 7283 libzstd_1.3.8+dfsg-3+deb10u2_amd64.buildinfo
Files:
 0b2a0be995c017b99e7127727983a08f 1947 libs optional libzstd_1.3.8+dfsg-3+deb10u2.dsc
 e89a2db50691a011ba72efe6b207f8fc 11648 libs optional libzstd_1.3.8+dfsg-3+deb10u2.debian.tar.xz
 dedf0ea07aeba086357e2f1cc5529d47 7283 libs optional libzstd_1.3.8+dfsg-3+deb10u2_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEAqSkbVtrXP4xJMh3EL6Jg/PVnWQFAmAvkY4ACgkQEL6Jg/PV
nWSsCwf/RC+pOALg8V4rP3nRB9z8mkQ9UB+5jdge8iOgI8AYJquWPtgj9OElh+eF
Sf/hFRA8dbaE/vK0ytoTvPUHQftI+tSgkwsRFrvSA33jUrU+LziRsYy8ruBHSQ1j
c/E2oskPswzDN3OCwWMjNYMzmmRg0w1z9BsiFDSMpTN1C1BCncL8qXiTBbL3OT8n
msJpxQC8jyomZvtymB9rgqRgJqJcyg2WZTmtZhBUXOQb/GsVeDSUhTI8SDYG6KrW
NCpqC4N3Q1ECaFWA9TJJJyqOlK2TWf6IUi8MC2Pko0xqE75GOZj92fl9vBUCsVgR
W3q6cPwPXRAXrHXXZpotKBwPseY4Vw==
=aPXH
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 28 Mar 2021 07:26:04 GMT) ([full text](bugreport.cgi?bug=982519;msg=47), [mbox](bugreport.cgi?bug=982519;mbox=yes;msg=47), [link](#46)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=982519).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 14 21:02:01 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


