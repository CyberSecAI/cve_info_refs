- **Root cause of vulnerability:** The Shortcodes Ultimate plugin does not properly sanitize user-provided input in shortcode attributes. This allows for the injection of arbitrary HTML and JavaScript code.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) due to insufficient sanitization of shortcode attributes. Specifically, the plugin is inconsistent in how it handles shortcode attributes, with some escaping and others not, and some attributes being insecure by design (e.g. the onclick attribute of `[su_button]`).
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the browsers of users who view content containing the malicious shortcodes. This could lead to session hijacking, defacement, or other malicious activities.
- **Attack vectors:** By crafting malicious shortcodes and embedding them in content, an attacker can execute arbitrary JavaScript when the content is viewed.
- **Required attacker capabilities/position:** The attacker needs to have at least a Contributor role in WordPress, allowing them to create and publish posts containing the malicious shortcodes. The vulnerability is present in versions of the Shortcodes Ultimate plugin prior to 5.10.2.