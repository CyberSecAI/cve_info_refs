=== Content from www.jbelamor.com_7794ab94_20250114_205404.html ===


* [Home](index.html)

# Catching a XSS at Elementor

#### Hunting and exploiting an XSS in Elementor <3.1.4

###### Joel Beleña - March 23th 2021

### Introduction

Elementor is a plugin for building websites for wordpress present in more than 5 million sites.

**Title:** Reflected Cross-Site-Scripting (XSS)

**Affected component:** lightbox

**CVE:** [CVE-2021-24891](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24891)

**Vulnerable Versions:** 1.5.0 > x < 3.1.4

**CVSSv3 Value:** 4.3

**CVSSv3 Vector:** [AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N&version=3.1)

Wordpress link: [elementor](https://wordpress.org/plugins/elementor/)

Site: [elementor.com](https://elementor.com/)

### TL;DR

An unauthenticated user can inject arbitrary JavaScript code in the URL of a web which is using Elementor.

To exploit this vulnerability, it is needed a web page using Elementor or Elementor Pro running the JavaScript file "fronten.min.js" with a version higher than 1.5 and lower than 3.1.4.

The affected resource is **#elementor-action:action=lightbox&settings=** and the payload will be encoded in base64 as a value for the settings variable. An example of this could be:

https://vulnerablesite.com/#elementor-action:action=lightbox&settings=eyJ0eXBlIjoibnVsbCIsImh0bWwiOiI8c2NyaXB0PmFsZXJ0KCd4c3MnKTwvc2NyaXB0PiJ9

The base64 string is an encoded JSON with the following structure:
```

			  {
			  "type":"null",
			  "html":"<script>alert('xss')</script>"
			  }

```

Inside the value "HTML" is where the payload would be stored. After injecting the desired payload, the JSON should be encoded back to base64 and attach it to the aforementioned URL.

### Hunting the vuln - Technical details

Everything started with a suspicious URL during the audit of a client's web page. This URL was looking something like:

https://vulnerablesite.com/avulnerableresource/#elementor-action:action=lightbox&settings=eyJ0eXBlIjoidmlkZW8iLCJ1cmwiOiJodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PWRRdzR3OVdnWGNRIn0=

The base64 in the variable settings updated me and after decoding it I could see the following JSON:
```

				{
				"type":"video",
				"url":"https://www.youtube.com/watch?v=dQw4w9WgXcQ"
				}

```

After some tests, I could see that it was possible to change the URL of the video and force the web page to render whichever video I wanted, so I figured out that the content of the variables was not being checked in the server, but n the client-side. With this information I started wondering if it was possible to inject something else apart from videos. So I opened the "Developer Tools", and went to the section "Debugger", where it is possible to search for a string in all the available source files.

![](img/posts/xss-elementor/developer_tools.png)

Knowing that somewhere in the code the base64 encoded JSON needs to be decoded, I searched for the function used in JavaScript for this purpose: atob (the encoding function is called btoa).

![](img/posts/xss-elementor/atob.png)

This led me to the following section of code:

![](img/posts/xss-elementor/atob_code.png)

At this point, I decided to set a breakpoint in this line and refresh the web page so I could trace the execution of the code and how the JSON was being used. After some time diving into the code and re-refreshings of the site, I finally got to the section of the code which was interesting for me.

![](img/posts/xss-elementor/switch_1.png)

What this switch is doing is filtering the received arguments set in the JSON and executing a different code depending on the value of "type". In pseudocode it would looks something like this:
```

				json_decoded = decodeBase64(settings);
				type = json_decoded['type'];
				switch(type){
				    case type == 'video':
				        modal.showVideo();
				        stop;
				    case type == 'image':
				        modal.setImage();
				        continuetothefollowingcase;
				    case type == 'slideshow':
				        modal.showImages();
				        stop;
				    case type != 'video' & type != 'image' & type != 'slideshow':
				        modal.setHTMLContent(json_decoded['html'])
				}

```

From this section, we can see that if the "type" value defined in the JSON is not: video, image or slideshow; then, the HTML of the modal to be shown will be set with the value of the element defined in the JSON with the key "html". Thus, to exploit this vulnerability, the steps are the following:

1. Set a value for "type" different than image, video or slideshow
2. Create a key called "html" containing the payload to be injected
3. Encode the JSON in base64
4. Add it to the link
5. Ready to exploit

### Remediation

This vulnerability has been fixed in the version 3.1.4. If you are using elementor to build your site, I would recommend you to upgrade to the last version, more vulnerabilities have been identified for the version 3.1.3 ([auth stored xss](https://www.wordfence.com/blog/2021/03/cross-site-scripting-vulnerabilities-in-elementor-impact-over-7-million-sites/))

To fix the vulnerability, the developer team have removed the "default case" in the switch ([line 165](https://github.com/elementor/elementor/blob/v3.1.3/assets/dev/js/frontend/utils/lightbox/lightbox.js#L165)).

### Timeline

**February 25th, 2021:** Discovery of the vulnerability and report to Elementor Security Team

**March 4th, 2021:** Report to Wordpress Security Team

**March 5th, 2021:** Response from Wordpress and Elementor Security Team

**March 10th, 2021:** Vulnerability fixed in version 3.1.4

### External references

**CVE Mitre:**  <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24891>

**WPScan:**  <https://wpscan.com/vulnerability/fbed0daa-007d-4f91-8d87-4bca7781de2d>

**Rotem Bar:**  <https://rotem-bar.com/hacking-65-million-websites-greater-cve-2022-29455-elementor>

### Follow Me

Let us be social

Copyright © All rights reserved | This template is made with  by [Colorlib](https://colorlib.com)



=== Content from wpscan.com_021af002_20250114_205404.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Elementor < 3.4.8 - DOM Cross-Site-Scripting

### Description

The plugin does not sanitise or escape user input appended to the DOM via a malicious hash, resulting in a DOM Cross-Site Scripting issue.

The issue was initially fixed in 3.1.4, however re-introduced in 3.2.0.

### Proof of Concept

https://example.com/#elementor-action:action=lightbox&settings=eyJ0eXBlIjoibnVsbCIsImh0bWwiOiI8c2NyaXB0PmFsZXJ0KCd4c3MnKTwvc2NyaXB0PiJ9

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

elementor](https://a8cteam5105.wordpress.com/plugin/elementor/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.4.8

### References

CVE
[CVE-2021-24891](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24891)

URL
<https://www.jbelamor.com/xss-elementor-lightox.html>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[6.1 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Joel

Submitter
Joel

Submitter website
<https://www.jbelamor.com/>

Verified
Yes

WPVDB ID
[fbed0daa-007d-4f91-8d87-4bca7781de2d](https://a8cteam5105.wordpress.com/vulnerability/fbed0daa-007d-4f91-8d87-4bca7781de2d/)

### Timeline

Publicly Published
2021-03-24 (about 3 years ago)

Added
2021-10-20 (about 3 years ago)

Last Updated
2022-04-14 (about 2 years ago)

### Other

Published
Title

Published
2023-04-24
Title
[tagDiv Composer < 4.0 - Reflected Cross-site Scripting](https://a8cteam5105.wordpress.com/vulnerability/cada9be9-522a-4ce8-847d-c8fff2ddcc07/)

Published
2024-03-25
Title
[VK All in One Expansion Unit < 9.97.0.0 - Contributor+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/914dc94f-e17c-40e8-a87e-c87cb5ac916a/)

Published
2014-08-01
Title
[ShrimpTest 1.0b2 - admin/experiment-new.php Multiple Unspecified XSS](https://a8cteam5105.wordpress.com/vulnerability/2761f18f-213b-47b7-82d5-764c16ca3949/)

Published
2021-09-27
Title
[WordPress Contact Forms by Cimatti < 1.4.12 - Admin+ Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/702a4283-1fd6-4186-9db7-6ad387d714ea/)

Published
2024-04-05
Title
[WPvivid Backup for MainWP < 0.9.34 - Authenticated (Admin+) Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/f8a8d9f5-2bea-438f-b71a-11fff88608cd/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

