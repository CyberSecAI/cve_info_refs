=== Content from jetpack.com_6fbe9e7e_20250115_092036.html ===


[Skip to main content](#content)

[Menu](#mobile-menu)

* Products
   Back
  + [Security](https://jetpack.com/features/security/)
    - [VaultPress Backup](https://jetpack.com/upgrade/backup/)
    - [Scan](https://jetpack.com/upgrade/scan/)
    - [Akismet Anti-spam](https://jetpack.com/upgrade/anti-spam/)
  + [Performance](https://jetpack.com/features/performance/)
    - [Site Search](https://jetpack.com/upgrade/search/)
    - [Boost](https://jetpack.com/boost/)
    - [VideoPress](https://jetpack.com/videopress/)
  + [Growth](https://jetpack.com/features/growth/)
    - [Stats](https://jetpack.com/stats/)
    - [Social](https://jetpack.com/social/)
    - [Blaze](https://jetpack.com/blaze/)
  + [Management](https://jetpack.com/pro-dashboard/)
    - [For Agencies](https://jetpack.com/for-agencies/)
    - [CRM](https://jetpackcrm.com/?utm_medium=automattic_referred&utm_source=jpcom_header)
    - [Mobile app](https://jetpack.com/mobile/)
  + [Create](https://jetpack.com/ai/)
    - [AI Assistant](https://jetpack.com/ai/)

  Product Bundles

  + [Complete

    VaultPress Backup

    Akismet Anti-Spam

    Scan

    Search

    Social

    VideoPress

    Boost

    CRM](https://jetpack.com/complete/)
  + [Security

    VaultPress Backup

    Akismet Anti-Spam

    Scan](https://jetpack.com/features/security/)
  + [Growth

    Stats

    Social

    Newsletter](https://jetpack.com/features/growth/)
* [Pricing](https://jetpack.com/pricing/)
* [Partners](https://jetpack.com/jetpack-partners/)
* [Support](https://jetpack.com/support/)
* [Blog](https://jetpack.com/blog/)
* More

* [Search](/?s=)
* [Log in](https://jetpack.com/login/)
* [Get started](https://jetpack.com/pricing/)

![](https://jetpack.com/wp-content/uploads/2021/10/jetpack-blog-malware-header-6.jpeg?w=850)
# Security Issues Patched in Smash Balloon Social Post Feed Plugin

Updated on October 29, 2021 - Marc Montpas

During an internal audit of [the Smash Balloon Social Post Feed plugin](https://en-ca.wordpress.org/plugins/custom-facebook-feed/) (also known as Custom Facebook Feed), we discovered several sensitive AJAX endpoints were accessible to any users with an account on the vulnerable site, like subscribers. Some of these endpoints could enable Stored Cross-Site Scripting (XSS) attacks to occur.

A successful Stored XSS attack could enable bad actors to store malicious scripts on every post and page of the affected site. If a logged-in administrator visits one of the affected URLs, the script may run on their browser and execute administrative actions on their behalf, like creating new administrators and installing rogue plugins.

We reported the vulnerabilities to this plugin’s author via email, and they recently released version 4.0.1 to address them. We strongly recommend that you update to the latest version of the Smash Balloon Social Post Feed plugin and have an established security solution on your site, such as [Jetpack Security](https://jetpack.com/features/security/).

## Details

**Plugin Name:** Smash Balloon Social Post Feed
**Plugin URI:** <https://wordpress.org/plugins/custom-facebook-feed/>
**Author:** Smash Balloon
**Author URI:** <https://smashballoon.com/>

## The Vulnerabilities

### Stored Cross-Site Scripting via Arbitrary Setting Update

**Affected versions:** < 4.0.1
**CVE-ID:** CVE-2021-24918
**CVSSv3.1:** [7.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N)
**CWSS:** [80.6](https://www.cwss-score.info/#TI:H,0.9/AP:A,1/AL:NA,1/IC:NA,1.0/FC:T,1/RP:L,0.9/RL:NA,1/AV:I,1/AS:NA,1/IN:T,0.9/SC:A,1/BI:H,0.9/DI:NA,1/EX:M,0.6/EC:N,1/P:NA,1/)

```

        public function cff_save_settings() {
                $data = $_POST;
                $model = isset( $data[ 'model' ] ) ? $data['model'] : null;
                // return if the model is null
                if ( null === $model ) {
                        return;
                }

                // (...)

                $model = (array) \json_decode( \stripslashes( $model ) );
                $general = (array) $model['general'];
                $feeds = (array) $model['feeds'];
                $translation = (array) $model['translation'];
                $advanced = (array) $model['advanced'];
                // Get the values and sanitize
                $cff_locale                                                     = sanitize_text_field( $feeds['selectedLocale'] );
                $cff_style_settings                                     = get_option( 'cff_style_settings' );
                $cff_style_settings[ 'cff_timezone' ]   = sanitize_text_field( $feeds['selectedTimezone'] );
                $cff_style_settings[ 'cff_custom_css' ] = $feeds['customCSS'];
                $cff_style_settings[ 'cff_custom_js' ]  = $feeds['customJS'];
                $cff_style_settings[ 'gdpr' ]                   = sanitize_text_field( $feeds['gdpr'] );
                $cachingType                                                    = sanitize_text_field( $feeds['cachingType'] );
                $cronInterval                                                   = sanitize_text_field( $feeds['cronInterval'] );
                $cronTime                                                               = sanitize_text_field( $feeds['cronTime'] );
                $cronAmPm                                                               = sanitize_text_field( $feeds['cronAmPm'] );
                $cacheTime                                                              = sanitize_text_field( $feeds['cacheTime'] );
                $cacheTimeUnit                                                  = sanitize_text_field( $feeds['cacheTimeUnit'] );
                // Save general settings data
                update_option( 'cff_preserve_settings', $general['preserveSettings'] );
                // Save feeds settings data
                update_option( 'cff_locale', $cff_locale );

                // (...)

                // Save translation settings data
                foreach( $translation as $key => $val ) {
                        $cff_style_settings[ $key ] = $val;
                }
                // Save advanced settings data
                $cff_ajax = sanitize_text_field( $advanced['cff_ajax'] );
                foreach( $advanced as $key => $val ) {
                        if ( $key == 'cff_disable_resize' || $key == 'disable_admin_notice' ) {
                                $cff_style_settings[ $key ] = !$val;
                        } else {
                                $cff_style_settings[ $key ] = $val;
                        }
                }

                // (...)

                update_option( 'cff_ajax', $cff_ajax );
                // Update the cff_style_settings option that contains data for translation and advanced tabs
                update_option( 'cff_style_settings', $cff_style_settings );
                // clear cron caches
                $this->cff_clear_cache();
                new CFF_Response( true, array(
                        'cronNextCheck' => $this->get_cron_next_check()
                ) );
        }

```

The `wp_ajax_cff_save_settings` AJAX action, which is responsible for updating the plugin’s inner settings, did not perform any privilege or nonce checks before doing so. This made it possible for any logged-in users to call this action and update any of the plugin’s settings.

Unfortunately, one of these settings, `customJS`, enables administrators to store custom JavaScript on their site’s posts and pages. Updating this setting is all it would’ve taken for a bad actor to store malicious scripts on the site.

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

Have a question?

Comments are closed for this article, but we're still here to help! Visit the support forum and we'll be happy to answer any questions.

[View support forum](https://wordpress.org/support/plugin/jetpack/)

- Search
- Enter your email address to receive news and updates from Jetpack
- Type your email…

  Subscribe

  Join 113.1K other subscribers
- ### Browse by Topic

  * [AI](https://jetpack.com/blog/category/ai/) (2)
  * [Analytics](https://jetpack.com/blog/category/analytics/) (21)
  * [Code snippets](https://jetpack.com/blog/category/developers/code-snippets/) (32)
  * [Contribute](https://jetpack.com/blog/category/contribute-2/) (6)
  * [Customer stories](https://jetpack.com/blog/category/customer-stories/) (6)
  * [Developers](https://jetpack.com/blog/category/developers/) (3)
  * [Ecommerce](https://jetpack.com/blog/category/ecommerce/) (18)
  * [Events](https://jetpack.com/blog/category/events/) (6)
  * [Features](https://jetpack.com/blog/category/features/) (69)
  * [Grow](https://jetpack.com/blog/category/grow/) (36)
  * [Hosting](https://jetpack.com/blog/category/hosting/) (7)
  * [Innovate](https://jetpack.com/blog/category/innovate/) (7)
  * [Jetpack News](https://jetpack.com/blog/category/jetpack-news/) (78)
  * [Learn](https://jetpack.com/blog/category/learn/) (117)
  * [Meet Jetpack](https://jetpack.com/blog/category/meet-jetpack/) (15)
  * [Mobile](https://jetpack.com/blog/category/mobile/) (1)
  * [Performance](https://jetpack.com/blog/category/performance/) (50)
  * [Photos & Videos](https://jetpack.com/blog/category/photos-videos/) (14)
  * [Promotions](https://jetpack.com/blog/category/promotions/) (2)
  * [Releases](https://jetpack.com/blog/category/releases/) (189)
  * [Scan](https://jetpack.com/blog/category/scan/) (2)
  * [Search Engine Optimization](https://jetpack.com/blog/category/search-engine-optimization/) (12)
  * [Security](https://jetpack.com/blog/category/security/) (146)
  * [Small Business](https://jetpack.com/blog/category/small-business/) (17)
  * [Social Media](https://jetpack.com/blog/category/social-media/) (48)
  * [Stats](https://jetpack.com/blog/category/stats/) (2)
  * [Support Stories](https://jetpack.com/blog/category/support-stories/) (3)
  * [Tips & Tricks](https://jetpack.com/blog/category/tips-tricks/) (90)
  * [Utilities & Maintenance](https://jetpack.com/blog/category/utilities-maintenance/) (13)
  * [Vulnerabilities](https://jetpack.com/blog/category/vulnerabilities/) (29)
  * [Webinars](https://jetpack.com/blog/category/webinars/) (2)
  * [Website Design](https://jetpack.com/blog/category/website-design/) (17)
  * [WordAds](https://jetpack.com/blog/category/wordads/) (1)
  * [WordCamp](https://jetpack.com/blog/category/events/wordcamp/) (5)

Jetpack

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

en

* WordPress Plugins
  + [Akismet Anti-spam](https://wordpress.org/plugins/akismet/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack](https://wordpress.org/plugins/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Boost](https://wordpress.org/plugins/jetpack-boost/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack CRM](https://wordpress.org/plugins/zero-bs-crm/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Protect](https://wordpress.org/plugins/jetpack-protect/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Search](https://wordpress.org/plugins/jetpack-search/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Social](https://wordpress.org/plugins/jetpack-social/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack VideoPress](https://wordpress.org/plugins/jetpack-videopress/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [VaultPress Backup](https://wordpress.org/plugins/jetpack-backup/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [WP Super Cache](https://wordpress.org/plugins/wp-super-cache/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Download](https://jetpack.com/download/)
* Partners
  + [Recommended Hosts](https://jetpack.com/hosting/)
  + [For Hosts](https://jetpack.com/for/hosts/)
  + [For Agencies](https://jetpack.com/for-agencies/)
  + [For Affiliates](https://jetpack.com/affiliates/)
* Developers
  + [Documentation](https://developer.jetpack.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Beta Program](https://jetpack.com/beta/)
  + [Contribute to Jetpack](https://jetpack.com/contribute/)
  + [Jetpack on GitHub](https://github.com/Automattic/jetpack)
* Legal
  + [Terms of Service](https://wordpress.com/tos/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Privacy Policy](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [GDPR](https://jetpack.com/gdpr/)
  + Do Not Sell or Share My Personal Information
  + [Privacy Notice for California Users](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer#california-consumer-privacy-act-ccpa)
* Help
  + [Knowledge Base](https://jetpack.com/support/)
  + [Forums](https://wordpress.org/support/plugin/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Webinars](https://jetpack.com/webinars/)
  + [Reviews and Testimonials](https://jetpack.com/testimonials/)
  + [Security Library](https://jetpack.com/features/security/library)
  + [Contact Us](https://jetpack.com/contact-support/)
  + [Press](https://jetpack.com/newsroom/)
* Social
  + [![X (formerly known as Twitter)](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-x.svg)](https://twitter.com/jetpack)
  + [![Facebook](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-facebook.svg)](https://www.facebook.com/jetpackme/)
  + [![LinkedIn](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-linkedin.svg)](https://www.linkedin.com/company/jetpack-for-wordpress/)
  + [![Youtube](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-youtube.svg)](https://www.youtube.com/JetpackOfficial)
* Mobile Apps
  + [![Get Jetpack on Google Play](https://s1.wp.com/wp-content/lib/app-badge-buttons/android/en.png?version=20220321)](https://play.google.com/store/apps/details?id=com.jetpack.android&referrer=utm_source%3Djetpack.com%26utm_campaign%3Djp_site_shortcode%26utm_medium%3Dwebsite)
  + [![Download Jetpack on the App Store](https://s1.wp.com/wp-content/lib/app-badge-buttons/ios/en.png?version=20220321)](https://apps.apple.com/app/apple-store/id1565481562?ct=jetpack.com--jp_site_shortcode&mt=8&pt=299112)

* [An ![Automattic](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/logos/logo-a8c-white.svg)](https://automattic.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
* [Work With Us](https://automattic.com/work-with-us/?utm_medium=automattic_referred&utm_source=jpcom_footer)

* Reblog
* Subscribe
  Subscribed

  + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)

  Join 60,959 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsecurity-issues-patched-in-smash-balloon-social-post-feed-plugin%252F)
* Privacy
* + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsecurity-issues-patched-in-smash-balloon-social-post-feed-plugin%252F)
  + [Copy shortlink](https://wp.me/p1moTy-zaU)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://jetpack.com/blog/security-issues-patched-in-smash-balloon-social-post-feed-plugin/)
  + [View post in Reader](https://wordpress.com/read/blogs/20115252/posts/135216)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wpscan.com_14f52dbf_20250115_092037.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Smash Balloon Social Post Feed < 4.0.1 - Subscriber+ Arbitrary Plugin Settings Update to Stored XSS

### Description

The plugin did not have any privilege or nonce validation before saving the plugin's setting. As a result, any logged-in user on a vulnerable site could update the settings and store rogue JavaScript on each of its posts and pages.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

custom-facebook-feed](https://a8cteam5105.wordpress.com/plugin/custom-facebook-feed/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.0.1

### References

CVE
[CVE-2021-24918](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24918)

URL
<https://jetpack.com/2021/10/29/security-issues-patched-in-smash-balloon-social-post-feed-plugin/>

### Classification

Type
ACCESS CONTROLS

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-284](https://cwe.mitre.org/data/definitions/284.html)

CVSS
[7.3 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N)

### Miscellaneous

Original Researcher
Marc Montpas

Submitter
Marc Montpas (Jetpack Scan)

Submitter website
<https://jetpack.com/>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[5d252ad7-bf28-44f3-8cd0-c4fe05c48f35](https://a8cteam5105.wordpress.com/vulnerability/5d252ad7-bf28-44f3-8cd0-c4fe05c48f35/)

### Timeline

Publicly Published
2021-10-29 (about 3 years ago)

Added
2021-10-29 (about 3 years ago)

Last Updated
2022-04-08 (about 2 years ago)

### Other

Published
Title

Published
2022-01-06
Title
[IP2Location Country Blocker < 2.26.5 - Subscriber+ Arbitrary Country Ban](https://a8cteam5105.wordpress.com/vulnerability/cbfa7211-ac1f-4cf2-bd79-ebce2fc4baa1/)

Published
2024-03-19
Title
[Combo Blocks < 2.2.76 - Unauthenticated Password Protected Posts Access](https://a8cteam5105.wordpress.com/vulnerability/e460e926-6e9b-4e9f-b908-ba5c9c7fb290/)

Published
2021-09-22
Title
[WooCommerce < 5.7.0 & WooCommerce Admin < 2.6.4 - Analytics Report Leaks](https://a8cteam5105.wordpress.com/vulnerability/6f1ecd1e-5363-44df-b9c7-a67dc9398261/)

Published
2021-01-28
Title
[uListing < 1.7 - Unauthenticated Arbitrary Account Change](https://a8cteam5105.wordpress.com/vulnerability/eb9fdc26-e382-46cc-966e-407ad93dc360/)

Published
2024-09-23
Title
[BA Book Everything < 1.6.21 - Unauthenticated Arbitrary User Password Reset](https://a8cteam5105.wordpress.com/vulnerability/446518aa-8c07-43b6-938d-8e1c2511d917/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

