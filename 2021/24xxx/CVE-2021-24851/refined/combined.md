=== Content from wpscan.com_37912fe5_20250115_091818.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Insert Pages < 3.7.0 - Contributor+ Arbitrary Posts/Pages Access

### Description

The plugin allows users with a role as low as Contributor to access content and metadata from arbitrary posts/pages regardless of their author and status (ie private), using a shortcode. Password protected posts/pages are not affected by such issue.

### Proof of Concept

[insert page='page\_slug' display='all']
Where page\_slug is the slug of a private post/page created by (eg.) an admin.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

insert-pages](https://a8cteam5105.wordpress.com/plugin/insert-pages/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.7.0

### References

CVE
[CVE-2021-24851](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24851)

URL
<https://plugins.trac.wordpress.org/changeset/2614442/insert-pages>

### Classification

Type
ACCESS CONTROLS

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-284](https://cwe.mitre.org/data/definitions/284.html)

CVSS
[5.4 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Francesco Carlucci

Submitter
Francesco Carlucci

Submitter website
<https://carluc.ci>

Submitter twitter
[francecarlucci](//twitter.com/francecarlucci)

Verified
Yes

WPVDB ID
[919e67a1-3a50-4940-bb4f-5c5cc2017a83](https://a8cteam5105.wordpress.com/vulnerability/919e67a1-3a50-4940-bb4f-5c5cc2017a83/)

### Timeline

Publicly Published
2021-10-18 (about 3 years ago)

Added
2021-10-18 (about 3 years ago)

Last Updated
2022-04-16 (about 2 years ago)

### Other

Published
Title

Published
2024-03-20
Title
[WooCommerce Cloak Affiliate Links < 1.0.34 - Missing Authorization to Unauthenticated Permalink Modification](https://a8cteam5105.wordpress.com/vulnerability/fc3a99c5-0713-46d0-9f42-be69a7a04beb/)

Published
2024-03-19
Title
[Combo Blocks < 2.2.76 - Unauthenticated Password Protected Posts Access](https://a8cteam5105.wordpress.com/vulnerability/e460e926-6e9b-4e9f-b908-ba5c9c7fb290/)

Published
2021-03-16
Title
[Flo Forms < 1.0.36 - Authenticated Options Change to Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/b4a83501-c727-4c9b-a9a1-46b399ab0caa/)

Published
2023-09-03
Title
[FileOrganizer < 1.0.3 - Admin+ Arbitrary File Access](https://a8cteam5105.wordpress.com/vulnerability/d59e6eac-3ebf-40e0-800c-8cbef345423f/)

Published
2021-05-26
Title
[Multivendor Marketplace Solution for WooCommerce < 3.7.4 - Unauthenticated Arbitrary Product Comment](https://a8cteam5105.wordpress.com/vulnerability/3d06075a-c106-48bb-849e-39b71f4c6818/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from plugins.trac.wordpress.org_13e1cc59_20250115_091817.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2614442%2Finsert-pages)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2539195/insert-pages "Changeset 2539195 for insert-pages")
* [Next Change](/changeset/2614443/insert-pages "Changeset 2614443 for insert-pages") →

---

# Changeset [2614442](/changeset/2614442 "Show full changeset") for [insert-pages](/browser/insert-pages?rev=2614442 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/14/2021 09:24:57 PM
([3 years](/timeline?from=2021-10-14T21%3A24%3A57Z&precision=second "See timeline at 10/14/2021 09:24:57 PM") ago)

Author:
figureone
Message:

Preparing for 3.7.0 release

Location:
[insert-pages/trunk](/browser/insert-pages/trunk?rev=2614442)
Files:

3 edited

* [insert-pages.php](/browser/insert-pages/trunk/insert-pages.php?rev=2614442 "Show entry in browser")
  (modified)
  ([10 diffs](#file0 "Show differences"))
* [options.php](/browser/insert-pages/trunk/options.php?rev=2614442 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))
* [readme.txt](/browser/insert-pages/trunk/readme.txt?rev=2614442 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [insert-pages/trunk/insert-pages.php](/changeset/2614442/insert-pages/trunk/insert-pages.php "Show the changeset 2614442 restricted to insert-pages/trunk/insert-pages.php")

  | [r2539194](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L8 "Show revision 2539194 of this file in browser") | [r2614442](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L8 "Show revision 2614442 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* Domain Path: /languages |
  | 9 | 9 | \* License: GPL2 |
  | 10 |  | \* Version: 3.6.1 |
  |  | 10 | \* Requires at least: 3.0.1 |
  |  | 11 | \* Version: 3.7.0 |
  | 11 | 12 | \* |
  | 12 | 13 | \* @package insert-pages |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L423) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L424) |  |
  | 423 | 424 | } |
  | 424 | 425 |  |
  |  | 426 | // Prevent unprivileged users from inserting private posts from others. |
  |  | 427 | if ( is\_object( $inserted\_page ) && 'publish' !== $inserted\_page->post\_status ) { |
  |  | 428 | $post\_type = get\_post\_type\_object( $inserted\_page->post\_type ); |
  |  | 429 | $parent\_post\_author\_id = intval( get\_the\_author\_meta( 'ID' ) ); |
  |  | 430 | if ( ! user\_can( $parent\_post\_author\_id, $post\_type->cap->read\_post, $inserted\_page->ID ) ) { |
  |  | 431 | $inserted\_page = null; |
  |  | 432 | } |
  |  | 433 | } |
  |  | 434 |  |
  | 425 | 435 | // If inserted page's status is private, don't show to anonymous users |
  | 426 | 436 | // unless 'public' option is set. |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L649) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L659) |  |
  | 649 | 659 | } |
  | 650 | 660 | echo $content; |
  | 651 |  | /\*\* |
  | 652 |  | \* Meta. |
  | 653 |  | \* |
  | 654 |  | \* @see https://core.trac.wordpress.org/browser/tags/4.4/src/wp-includes/post-template.php#L968 |
  | 655 |  | \*/ |
  | 656 |  | $keys = get\_post\_custom\_keys( $inserted\_page->ID ); |
  | 657 |  | if ( $keys ) { |
  | 658 |  | echo "<ul class='post-meta'>\n"; |
  | 659 |  | foreach ( (array) $keys as $key ) { |
  | 660 |  | $keyt = trim( $key ); |
  | 661 |  | if ( is\_protected\_meta( $keyt, 'post' ) ) { |
  | 662 |  | continue; |
  | 663 |  | } |
  | 664 |  | $value = get\_post\_custom\_values( $key, $inserted\_page->ID ); |
  | 665 |  | if ( is\_array( $value ) ) { |
  | 666 |  | $values = array\_map( 'trim', $value ); |
  | 667 |  | $value = implode( $values, ', ' ); |
  | 668 |  | } |
  | 669 |  |  |
  | 670 |  | /\*\* |
  | 671 |  | \* Filter the HTML output of the li element in the post custom fields list. |
  | 672 |  | \* |
  | 673 |  | \* @since 2.2.0 |
  | 674 |  | \* |
  | 675 |  | \* @param string $html  The HTML output for the li element. |
  | 676 |  | \* @param string $key   Meta key. |
  | 677 |  | \* @param string $value Meta value. |
  | 678 |  | \*/ |
  | 679 |  | echo apply\_filters( 'the\_meta\_key', "<li><span class='post-meta-key'>$key:</span> $value</li>\n", $key, $value ); |
  | 680 |  | } |
  | 681 |  | echo "</ul>\n"; |
  | 682 |  | } |
  |  | 661 | $this->the\_meta( $inserted\_page->ID ); |
  | 683 | 662 | break; |
  | 684 | 663 |  |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L756) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L735) |  |
  | 756 | 735 | ); |
  | 757 | 736 | } |
  |  | 737 |  |
  | 758 | 738 | // We save the previous query state here instead of using |
  | 759 | 739 | // wp\_reset\_query() because wp\_reset\_query() only has a single stack |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L762) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L742) |  |
  | 762 | 742 | $old\_query = $GLOBALS['wp\_query']; |
  | 763 | 743 | $posts = query\_posts( $args ); |
  |  | 744 |  |
  |  | 745 | // Prevent unprivileged users from inserting private posts from others. |
  |  | 746 | if ( have\_posts() ) { |
  |  | 747 | $can\_read = true; |
  |  | 748 | $parent\_post\_author\_id = intval( get\_the\_author\_meta( 'ID' ) ); |
  |  | 749 | foreach ( $posts as $post ) { |
  |  | 750 | $post\_type = get\_post\_type\_object( $post->post\_type ); |
  |  | 751 | if ( ! user\_can( $parent\_post\_author\_id, $post\_type->cap->read\_post, $post->ID ) ) { |
  |  | 752 | $can\_read = false; |
  |  | 753 | } |
  |  | 754 | } |
  |  | 755 | if ( ! $can\_read ) { |
  |  | 756 | // Force an empty query so we don't show any posts. |
  |  | 757 | $posts = query\_posts( array( 'post\_\_in' => array( 0 ) ) ); |
  |  | 758 | } |
  |  | 759 | } |
  |  | 760 |  |
  | 764 | 761 | if ( have\_posts() ) { |
  | 765 | 762 | // Start output buffering so we can save the output to string. |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L948) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L945) |  |
  | 948 | 945 | echo get\_the\_content(); |
  | 949 | 946 | } |
  | 950 |  | the\_meta(); |
  |  | 947 | $this->the\_meta(); |
  | 951 | 948 | // Render any <!--nextpage--> pagination links. |
  | 952 | 949 | wp\_link\_pages( array( |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L1035) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L1032) |  |
  | 1035 | 1032 | } |
  | 1036 | 1033 | } |
  | 1037 |  |  |
  | 1038 | 1034 |  |
  | 1039 | 1035 | return $content; |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L1427) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L1423) |  |
  | 1427 | 1423 | ); |
  | 1428 | 1424 |  |
  |  | 1425 | // Show non-admins only their own posts if the option is enabled. |
  |  | 1426 | $options = get\_option( 'wpip\_settings' ); |
  |  | 1427 | if ( |
  |  | 1428 | ! empty( $options['wpip\_classic\_editor\_hide\_others\_posts'] ) && |
  |  | 1429 | 'enabled' === $options['wpip\_classic\_editor\_hide\_others\_posts'] && |
  |  | 1430 | ! current\_user\_can( 'edit\_others\_posts' ) |
  |  | 1431 | ) { |
  |  | 1432 | $query['author'] = get\_current\_user\_id(); |
  |  | 1433 | } |
  |  | 1434 |  |
  | 1429 | 1435 | $args['pagenum'] = isset( $args['pagenum'] ) ? absint( $args['pagenum'] ) : 1; |
  | 1430 | 1436 | $query['offset'] = $args['pagenum'] > 1 ? $query['posts\_per\_page'] \* ( $args['pagenum'] - 1 ) : 0; |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L1456) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L1462) |  |
  | 1456 | 1462 | $results = array(); |
  | 1457 | 1463 | foreach ( $posts as $post ) { |
  |  | 1464 | // Prevent unprivileged users (e.g., Contributors) from seeing and |
  |  | 1465 | // inserting other user's private posts. |
  |  | 1466 | $post\_type = get\_post\_type\_object( $post->post\_type ); |
  |  | 1467 | if ( 'publish' !== $post->post\_status && ! current\_user\_can( $post\_type->cap->read\_post, $post->ID ) ) { |
  |  | 1468 | continue; |
  |  | 1469 | } |
  |  | 1470 |  |
  | 1458 | 1471 | if ( 'post' === $post->post\_type ) { |
  | 1459 | 1472 | $info = mysql2date( 'Y/m/d', $post->post\_date ); |
  | […](/browser/insert-pages/trunk/insert-pages.php?rev=2539194#L1566) | […](/browser/insert-pages/trunk/insert-pages.php?rev=2614442#L1579) |  |
  | 1566 | 1579 | } |
  | 1567 | 1580 |  |
  |  | 1581 | /\*\* |
  |  | 1582 | \* Render post meta as an unordered list. |
  |  | 1583 | \* |
  |  | 1584 | \* Note: This function sanitizes postmeta value via wp\_kses\_post(); the |
  |  | 1585 | \* core WordPress function the\_meta() does not. |
  |  | 1586 | \* |
  |  | 1587 | \* @see https://developer.wordpress.org/reference/functions/the\_meta/ |
  |  | 1588 | \* |
  |  | 1589 | \* @param  int $post\_id Post ID. |
  |  | 1590 | \*/ |
  |  | 1591 | public function the\_meta( $post\_id = 0 ) { |
  |  | 1592 | if ( empty( $post\_id ) ) { |
  |  | 1593 | $post\_id = get\_the\_ID(); |
  |  | 1594 | } |
  |  | 1595 |  |
  |  | 1596 | $keys = get\_post\_custom\_keys( $post\_id ); |
  |  | 1597 | if ( $keys ) { |
  |  | 1598 | $li\_html = ''; |
  |  | 1599 | foreach ( (array) $keys as $key ) { |
  |  | 1600 | $keyt = trim( $key ); |
  |  | 1601 | if ( is\_protected\_meta( $keyt, 'post' ) ) { |
  |  | 1602 | continue; |
  |  | 1603 | } |
  |  | 1604 |  |
  |  | 1605 | $values = array\_map( 'trim', get\_post\_custom\_values( $key, $post\_id ) ); |
  |  | 1606 | $value  = implode( ', ', $values ); |
  |  | 1607 |  |
  |  | 1608 | // Sanitize post meta values. |
  |  | 1609 | $value = wp\_kses\_post( $value ); |
  |  | 1610 |  |
  |  | 1611 | $html = sprintf( |
  |  | 1612 | "<li><span class='post-meta-key'>%s</span> %s</li>\n", |
  |  | 1613 | /\* translators: %s: Post custom field name. \*/ |
  |  | 1614 | sprintf( \_x( '%s:', 'Post custom field name' ), $key ), |
  |  | 1615 | $value |
  |  | 1616 | ); |
  |  | 1617 |  |
  |  | 1618 | /\*\* |
  |  | 1619 | \* Filters the HTML output of the li element in the post custom fields list. |
  |  | 1620 | \* |
  |  | 1621 | \* @since 2.2.0 |
  |  | 1622 | \* |
  |  | 1623 | \* @param string $html  The HTML output for the li element. |
  |  | 1624 | \* @param string $key   Meta key. |
  |  | 1625 | \* @param string $value Meta value. |
  |  | 1626 | \*/ |
  |  | 1627 | $li\_html .= apply\_filters( 'the\_meta\_key', $html, $key, $value ); |
  |  | 1628 | } |
  |  | 1629 |  |
  |  | 1630 | if ( $li\_html ) { |
  |  | 1631 | echo "<ul class='post-meta'>\n{$li\_html}</ul>\n"; |
  |  | 1632 | } |
  |  | 1633 | } |
  |  | 1634 | } |
  |  | 1635 |  |
  | 1568 | 1636 | } |
  | 1569 | 1637 | } |
* ## [insert-pages/trunk/options.php](/changeset/2614442/insert-pages/trunk/options.php "Show the changeset 2614442 restricted to insert-pages/trunk/options.php")

  | [r2187208](/browser/insert-pages/trunk/options.php?rev=2187208#L64 "Show revision 2187208 of this file in browser") | [r2614442](/browser/insert-pages/trunk/options.php?rev=2614442#L64 "Show revision 2614442 of this file in browser") |  |
  | --- | --- | --- |
  | 64 | 64 | 'wpip\_section' |
  | 65 | 65 | ); |
  |  | 66 | add\_settings\_field( |
  |  | 67 | 'wpip\_classic\_editor\_hide\_others\_posts', |
  |  | 68 | \_\_( 'TinyMCE capabilities', 'insert-pages' ), |
  |  | 69 | 'wpip\_classic\_editor\_hide\_others\_posts\_render', |
  |  | 70 | 'wpipSettings', |
  |  | 71 | 'wpip\_section' |
  |  | 72 | ); |
  | 66 | 73 | } |
  | 67 | 74 | add\_action( 'admin\_init', 'wpip\_settings\_init' ); |
  | […](/browser/insert-pages/trunk/options.php?rev=2187208#L103) | […](/browser/insert-pages/trunk/options.php?rev=2614442#L110) |  |
  | 103 | 110 | if ( ! array\_key\_exists( 'wpip\_gutenberg\_block', $options ) ) { |
  | 104 | 111 | $options['wpip\_gutenberg\_block'] = 'enabled'; |
  |  | 112 | } |
  |  | 113 |  |
  |  | 114 | if ( empty( $options['wpip\_classic\_editor\_hide\_others\_posts'] ) ) { |
  |  | 115 | $options['wpip\_classic\_editor\_hide\_others\_posts'] = 'disabled'; |
  | 105 | 116 | } |
  | 106 | 117 |  |
  | […](/browser/insert-pages/trunk/options.php?rev=2187208#L220) | […](/browser/insert-pages/trunk/options.php?rev=2614442#L231) |  |
  | 220 | 231 | <?php |
  | 221 | 232 | } |
  |  | 233 |  |
  |  | 234 | /\*\* |
  |  | 235 | \* Print 'TinyMCE capabilities' setting. |
  |  | 236 | \* |
  |  | 237 | \* @return void |
  |  | 238 | \*/ |
  |  | 239 | function wpip\_classic\_editor\_hide\_others\_posts\_render() { |
  |  | 240 | $options = get\_option( 'wpip\_settings' ); |
  |  | 241 | if ( false === $options || ! is\_array( $options ) || empty( $options['wpip\_classic\_editor\_hide\_others\_posts'] ) ) { |
  |  | 242 | $options = wpip\_set\_defaults(); |
  |  | 243 | } |
  |  | 244 | ?> |
  |  | 245 | <input type='radio' name='wpip\_settings[wpip\_classic\_editor\_hide\_others\_posts]' <?php checked( $options['wpip\_classic\_editor\_hide\_others\_posts'], 'enabled' ); ?> id="wpip\_classic\_editor\_hide\_others\_posts\_enabled" value='enabled'><label for="wpip\_classic\_editor\_hide\_others\_posts\_enabled">Authors and Contributors only see their own content to insert.</label><br /> |
  |  | 246 | <input type='radio' name='wpip\_settings[wpip\_classic\_editor\_hide\_others\_posts]' <?php checked( $options['wpip\_classic\_editor\_hide\_others\_posts'], 'disabled' ); ?> id="wpip\_classic\_editor\_hide\_others\_posts\_disabled" value='disabled'><label for="wpip\_classic\_editor\_hide\_others\_posts\_disabled">Authors and Contributors see all published content to insert.</label><br /> |
  |  | 247 | <small><em>Note: this option only restricts Contributors and Authors (i.e., the roles without the <code>edit\_others\_posts</code> capability) from seeing other's content in the TinyMCE Insert Page popup; they can still insert any published content if they know the page slug.</em></small> |
  |  | 248 | <?php |
  |  | 249 | } |
* ## [insert-pages/trunk/readme.txt](/changeset/2614442/insert-pages/trunk/readme.txt "Show the changeset 2614442 restricted to insert-pages/trunk/readme.txt")

  | [r2539194](/browser/insert-pages/trunk/readme.txt?rev=2539194#L2 "Show revision 2539194 of this file in browser") | [r2614442](/browser/insert-pages/trunk/readme.txt?rev=2614442#L2 "Show revision 2614442 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Contributors: figureone, the\_magician |
  | 3 | 3 | Tags: insert, pages, shortcode, embed |
  | 4 |  | Requires at least: 3.0.1 |
  | 5 |  | Tested up to: 5.7 |
  |  | 4 | Tested up to: 5.8.1 |
  | 6 | 5 | Stable tag: trunk |
  | 7 | 6 | License: GPLv2 or later |
  | […](/browser/insert-pages/trunk/readme.txt?rev=2539194#L111) | […](/browser/insert-pages/trunk/readme.txt?rev=2614442#L110) |  |
  | 111 | 110 |  |
  | 112 | 111 | == Changelog == |
  |  | 112 |  |
  |  | 113 | = 3.7.0 = |
  |  | 114 | \* Security: Prevent unprivileged users from inserting private posts by others. |
  |  | 115 | \* Security: Filter out possible XSS in post meta using wp\_kses\_post() when using display=all. |
  |  | 116 | \* New Setting: Only show Authors and Contributors their own content in the TinyMCE Insert Pages popup. |
  | 113 | 117 |  |
  | 114 | 118 | = 3.6.1 = |
  | […](/browser/insert-pages/trunk/readme.txt?rev=2539194#L461) | […](/browser/insert-pages/trunk/readme.txt?rev=2614442#L465) |  |
  | 461 | 465 | = 1.0 = |
  | 462 | 466 | Upgrade to v1.0 to get the first stable version. |
  |  | 467 |  |
  |  | 468 | == Upgrade Notice == |
  |  | 469 |  |
  |  | 470 | = 3.7.0 = |
  |  | 471 | Note: if you insert private pages/posts, please review the post authors of the pages containing the inserted page and confirm they have the capability to read the private content. This upgrade enforces private page visibility based on the role of the author of the page that inserts any private content. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2614442)
* [Zip Archive](?format=zip&new=2614442)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


