=== Content from wpscan.com_53c68473_20250115_085916.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# WooCommerce Help Scout < 2.9.1 - Unauthenticated Arbitrary File Upload leading to RCE

### Description

We noticed 0-day in the plugin (https://woocommerce.com/products/woocommerce-help-scout/) being actively exploited. This vulnerability affects at least versions 2.6-2.8 (current latest published version) and allows unauthenticated users to upload any files to the site which by default will end up in wp-content/uploads/hstmp.

Until a patch is available, the plugin should be disabled.

Timeline (WPScanTeam):

March 20th, 2021:

- Tried to reach the vendor via https://opmc.com.au, got blocked when sending contact message "Access from your Country was disabled by the administrator."

- Tried to open a ticket on woocommerce.com, couldn't even though email address was verified

- 2:49pm GMT+1, Reached WooCommerce via DM on Twitter, asking for a direct contact/email address. Reply received at 6:52pm GMT+1

- 8:42pm GMT+1 Details sent to that email address

March 23rd, 2021 - v2.9 released, which does not fix the issue. Vendor is working on another fix and we are in touch with them

March 25th, 2021 - v2.9.1 released, fixing the arbitrary PHP upload. However, an image with PHP code inside could still be uploaded and used in combination with a LFI. Hardening recommendation sent to vendor.

### Proof of Concept

In file /woocommerce-help-scout/includes/class-wc-help-scout-ajax.php there is class WC\_Help\_Scout\_Ajax
with constructor initializing action
add\_action( 'wp\_ajax\_nopriv\_wc\_help\_scout\_upload\_attachments', array( $this, 'wc\_help\_scout\_upload\_attachments' ) );
which reads uploaded $\_FILES and then executes
$target\_path\_sia = $\_FILES["file"]["name"];
move\_uploaded\_file($\_FILES["file"]["tmp\_name"],$dir. "/hstmp/" . $target\_path\_sia);
Ie. attacker can run
echo '<?php echo "Hello World!";' > helloworld.php
curl -X POST -F file=@helloworld.php https://<site>/wp-admin/admin-ajax.php?action=wc\_help\_scout\_upload\_attachments
to exploit this vuln.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

woocommerce-help-scout](https://a8cteam5105.wordpress.com/plugin/woocommerce-help-scout/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.9.1

### References

CVE
[CVE-2021-24212](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24212)

URL
<http://dzv365zjfbd8v.cloudfront.net/changelogs/woocommerce-help-scout/changelog.txt>

### Miscellaneous

Original Researcher
Ville Korhonen / Seravo

Submitter
Ville Korhonen / Seravo

Submitter website
<https://seravo.com/>

Submitter twitter
[Seravo](//twitter.com/Seravo)

Verified
Yes

WPVDB ID
[cf9305e8-f5bc-45c3-82db-0ef00fd46129](https://a8cteam5105.wordpress.com/vulnerability/cf9305e8-f5bc-45c3-82db-0ef00fd46129/)

### Timeline

Publicly Published
2021-03-21 (about 3 years ago)

Added
2021-03-21 (about 3 years ago)

Last Updated
2021-03-30 (about 3 years ago)

### Other

Published
Title

Published
2017-02-28
Title
[Mobile App Native <= 3.0 - Remote File Upload](https://a8cteam5105.wordpress.com/vulnerability/6ef8703e-dfb8-48e2-91bb-b8d8b766e093/)

Published
2014-08-01
Title
[Category List Portfolio Page 0.9 - Shell Upload](https://a8cteam5105.wordpress.com/vulnerability/7282c263-58f5-4afd-93d2-775763305615/)

Published
2022-05-30
Title
[Allow SVG Files < 1.1 - Admin+ Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/4d7b62e1-558b-4504-a6e2-78246a8b554f/)

Published
2014-08-01
Title
[1 Flash Gallery - Arbitrary File Upload Exploit (MSF)](https://a8cteam5105.wordpress.com/vulnerability/0c980e1c-d4dc-4b96-b0ce-282289674f55/)

Published
2021-04-08
Title
[Imagements <= 1.2.5 - Unauthenticated Arbitrary File Upload to RCE](https://a8cteam5105.wordpress.com/vulnerability/8f24e74f-60e3-4100-9ab2-ec31b9c9cdea/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from dzv365zjfbd8v.cloudfront.net_81d9772f_20250115_085914.html ===
\*\*\* WooCommerce Help Scout Changelog \*\*\*
2024-12-12 - version 3.9.7
\* Fix: PLUGINS-2831 - Resolve Customer is Null issue.
2024-12-03 - version 3.9.6
\* Update: PLUGINS-2794 - Update hardcoded Accounts Page URL to be dynamic.
\* Fix: PLUGINS-2814 - REST API endpoint bug reported by HelpScout.
2024-10-16 - version 3.9.5
\* Fix: PLUGINS-2762 - HelpScout Custom Sidebar App not working in PHP 8.
2024-09-03 - version 3.9.4
\* Update: PLUGINS-2560 - updates inc. initial activation message and sign up link.
2024-03-14 - version 3.9.3
\* Update: PLUGINS-2429 - Update for WooCommerce Legacy API deprecation.
\* Update: PLUGINS-2515 - Add HelpScout link on settings page.
\* Fix: PLUGINS-2514 - Correct wording of Notes info on settings page.
2023-07-20 - version 3.9.2
\* Fix: PLUGINS-2190 - The "Ticket/Conversation" leads to 404 page error page on plugin's version 3.9.1
2023-04-28 - version 3.9.1
\* Fix: PLUGINS-2142 - Order data variable bug.
2023-04-17 - version 3.9.0
\* Update: PLUGINS-1910 - Woo HPOS Compatibility Audit/Upgrade.
2023-04-11 - version 3.8.1
\* Fix: PLUGINS-2015 - Fix wrong comparison operator.
\* Fix: PLUGINS-2055 - Fix customers needs to revalidate every 2 days.
2023-02-06 - version 3.8.0
\* Fix: PLUGINS-1990 - Woo Review Issues.
2022-08-22 - version 3.7.0
\* Fix: PLUGINS-1727 - Resolve Authorisation validation issue.
2022-08-02 - version 3.6.0
\* Fix: PLUGINS-1660 - Check and fix any compatibility issue with PHP Version 8+
\* Fix: PLUGINS-1382 - Ensure token is refreshed and clean up comments.
2022-06-28 - version 3.5.0
\* Fix: PLUGINS-1572 - Fix Subscriptions intermittent cron error.
\* Add: PLUGINS-1337 - Create a new endpoint to allow for Custom Widget.
2022-04-21 - version 3.4.1
\* Fix: PLUGINS-1533 - Fix Notice errors in the plugin in 3.4 version.
2022-04-07 - version 3.4.0
\* PLUGINS-1453 - Fix fatal error which is causing subscriptions fail
\* PLUGINS-1396 - Fix Notice errors
\* PLUGINS-645 - Support other languages
\* PLUGINS-1518 - Language fixes
2022-03-02 - version 3.3.0
\* PLUGINS-997 - Fix various notice errors.
\* PLUGINS-207 - Validation errors.
\* PLUGINS-1241 - Add tab for ticket.
\* PLUGINS-1192 - Add a filter to hide helpscout in customer order page.
\* PLUGINS-381 - Cancel WooCommerce Subscriptions
\* PLUGINS-379 - Refund WooCommerce Charges Inside Help Scout
\* PLUGINS-1242 - Show conversation history on reply.
\* PLUGINS-1293 - Code improvement.
2022-02-04 - version 3.2.0
\* PLUGINS-1002 - Fix customer data not syncing on HelpScout mailbox.
2021-11-04 - version 3.1.0
\* PLUGINS-1240 - Incorrect API credentials should display useful message.
2021-10-25 - version 3.0.0
\* PLUGINS-869 - Removed duplicate âCreate Conversationâ button.
\* PLUGINS-1118 - Fix saved credentials being deleted on plugin deactivation.
\* PLUGINS-1161 - Speed improvement.
\* PLUGINS-1201 - Fix validation error in sending email from order page.
\* PLUGINS-461 - Fix not displaying correct error on order page.
\* PLUGINS-1072 - File upload minor adjustments.
2021-05-11 - version 2.9.2
\* PLUGINS-1017 - Fix file upload security issues
2021-03-25 - version 2.9.1
\* PLUGINS-990 - Further Ajax adjustments.
2021-03-23 - version 2.9.0
\* PLUGINS-990 - Ajax adjustment.
2021-03-18 - version 2.8.0
\* PLUGINS-974 - jQuery update.
2021-02-01 - version 2.7.1
\* PLUGINS-842 - Replace library (PCI Compliance check)
2021-01-21 - version 2.7.0
\* PLUGINS-826 - Fix debug notices.
2020-10-30 - version 2.6.0
\* PLUGINS-754 - Fix "Allow Access" button position
\* PLUGINS-769 - Customers not getting created in Helpscout
2020-09-17 - version 2.5.0
\* PLUGINS-500 Fixed error when submitting form on specific customers
\* PLUGINS-505 Fixed Code Error
\* PLUGINS-539 Fixed Support for Multiple Attachments
\* PLUGINS-498 Fixed Subject isn't being displayed on support conversation tab
\* PLUGINS-378 Syncing customers from woocommerce to helpscout
2020-05-26 - version 2.4.0
\* PLUGINS-350 overriding conversations.php templates in theme file
2020-02-10 - version 2.3.0
\* Refresh token api auth error fix.
2019-11-20 - version 2.2.0
\* Fixed issue 'WP\_Privacy\_Data\_Export\_Requests\_List\_Table' with wordpress 5.3.
2019-09-25 - version 2.1.0
\* check\_authorization\_still\_valid api 404 error fix
2019-06-04 - version 2.0.0
\* Update Help Scout API v2.0
\* Add Auth 2.0 authetication.
\* Update - WC tested up to 3.6
2018-09-26 - version 1.3.11
\* Update - WC tested up to 3.5
2018-09-11 - version 1.3.10
\* Fix - Ensure the form scripts load when using the [woocommerce\_order\_tracking] shortcode.
\* Update - Help text on settings page.
2018-05-23 - version 1.3.9
\* Update - WC tested up to 3.4
\* Add - GDPR privacy
2018-03-29 - version 1.3.8
\* Tweak - Introduce `woocommerce\_help\_scout\_customer\_data` filter to allow customers to change customer data.
\* Fix - Issue with different Email Address on Orders, rely on account email if available.
2018-02-09 - version 1.3.7
\* Fix - Use billing phone correctly.
2017-12-14 - version 1.3.6
\* Update - Bump tested to version to 3.3
2017-11-27 - version 1.3.5
\* Fix - Remove non existing shipping email.
2017-07-05 - version 1.3.4
\* Fix - Ensures the formatting is sent through correctly when adding a new ticket to Help Scout.
2017-04-18 - version 1.3.3
\* Fix - Additional updates for WC 3.0 compatibility.
2017-04-03 - version 1.3.2
\* Tweak - Remove deprecated WooCommerce functions.
\* Fix - Update for WC 3.0 compatibility.
2016-08-20 - version 1.3.1
\* Fix - Notice when creating support conversation.
2016-08-13 - version 1.3.0
\* Tweak - Moved "My Support Conversations" into its own endpoint and added tabbed menu item for it in My Account page.
\* Tweak - Make templates for front end (conversations, create conversation, and shortcodes) overridable like WooCommerce core templates.
\* Tweak - Add auto reply request by default. Filter is added to opt out.
\* Tweak - Error when site's timezone is set to UTC offset.
2016-02-28 - version 1.2.2
\* Fixed some strings were not translatable.
\* Fixed date in 'My Support Conversations' list that were not in site timezone.
\* Fixed error message, which is now displayed more useful, when creating conversation from 'Get Help'.
2016-01-14 - version 1.2.1
\* Update for WooCommerce 2.5. Removed calls to deprecated functions woocommerce\_get\_page\_id and woocommerce\_date\_format
\* Some code cleanup
2015-09-21 - version 1.2.0
\* Created `[wc\_help\_scout\_form]` shortcode.
\* Improved the conversation table when using the Storefront theme.
2015-07-25 - version 1.1.4
\* Fixed issue displaying private messages in Help Scout
2015-06-30 - version 1.1.3
\* Added SSL verification to remote requests.
\* Escaped templates.
2015-03-16 - version 1.1.2
\* Fixed typos in actions names.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_form\_description` in favor to `woocommerce\_help\_scout\_conversation\_form\_description`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_form\_start` in favor to `woocommerce\_help\_scout\_conversation\_form\_start`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_form` in favor to `woocommerce\_help\_scout\_conversation\_form`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_form\_end` in favor to `woocommerce\_help\_scout\_conversation\_form\_end`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_admin\_form\_start` in favor to `woocommerce\_help\_scout\_conversation\_admin\_form\_start`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_admin\_form` in favor to `woocommerce\_help\_scout\_conversation\_admin\_form`.
\* Deprecated the `woocommerce\_help\_scount\_conversation\_admin\_form\_end` in favor to `woocommerce\_help\_scout\_conversation\_admin\_form\_end`.
2015-01-13 - version 1.1.1
\* Remove slashes when create or query conversations.
2014-11-09 - version 1.1.0
\* Added support for get data from non registered customers on Help Scout App.
2014-08-26 - version 1.0.4
\* Excluded drafts from customer conversations list.
2014-07-11 - version 1.0.3
\* Added support for WooCommerce 2.2
\* Improved the plugin options descriptions
2014-07-31 - version 1.0.2
\* Added method to get the first name and last name from non users before creating a conversation in Help Scout.
2014-06-17 - version 1.0.1
\* Improvements in integration with WooCommerce App in Help Scout
\* Removed extra slashes when create a conversation
\* Created a default .pot file
2014-05-27 - version 1.0.0
\* First Release.

