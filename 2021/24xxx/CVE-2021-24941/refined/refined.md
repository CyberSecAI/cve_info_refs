- **Root cause of vulnerability:** The Icegram plugin fails to sanitize and escape the `message_id` parameter within the `get_message_action_row` AJAX action before outputting it into an HTML attribute.
- **Weaknesses/vulnerabilities present:** Reflected Cross-Site Scripting (XSS)
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that executes in the victim's browser when they interact with the crafted request or response. This could lead to session hijacking, data theft, or further malicious actions on the victim's behalf within the compromised web application.
- **Attack vectors:** The vulnerability is triggered by sending a crafted POST request to the `wp-admin/admin-ajax.php` endpoint, specifically targeting the `get_message_action_row` AJAX action. The malicious payload is embedded in the `message_id` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to craft and send HTTP requests to the vulnerable WordPress site. No prior authentication is required. The user needs to move their mouse over the injected text to trigger the XSS.