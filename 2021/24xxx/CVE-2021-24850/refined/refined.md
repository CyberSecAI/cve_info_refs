- **Root cause of vulnerability:** The Insert Pages plugin's shortcode functionality allows users with Contributor role or higher to include content from other pages, including custom fields. The plugin does not sanitize the output of these custom fields, leading to a stored XSS vulnerability.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The plugin lacks proper sanitization of custom field content when rendering the page using the shortcode.
- **Impact of exploitation:** An attacker with Contributor or higher role can inject malicious JavaScript code into a page's custom field. When a page with the vulnerable shortcode is accessed, the injected script will be executed in the user's browser. This could result in session hijacking, redirecting the victim to a malicious site, or other malicious actions.
- **Attack vectors:** A user with Contributor role can create a page, add a custom field containing a malicious payload, and then use the `[insert]` shortcode to display that page in another page, triggering the XSS.
- **Required attacker capabilities/position:** An attacker needs to have at least a Contributor role in WordPress to create a page and add custom fields.