Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The External Media WordPress plugin's `wp_ajax_upload-remote-file` AJAX action lacked proper access control, nonce verification, and file extension validation. Specifically, the `upload_remote_file` function did not check if a user had the required capabilities to upload files, nor did it validate the uploaded filename, allowing any authenticated user to upload arbitrary files, including PHP files.

**Weaknesses/Vulnerabilities Present:**
1.  **Authenticated Arbitrary File Upload:** Any authenticated user, including low-level users like subscribers, could upload files to the server.
2.  **Missing Capability Checks:** The plugin failed to verify if a user had the appropriate permissions to perform file uploads.
3.  **Missing Nonce Checks:** The absence of nonce verification made the plugin vulnerable to Cross-Site Request Forgery (CSRF) attacks.
4.  **Lack of File Extension Validation:**  The plugin did not validate the uploaded filename, allowing attackers to upload PHP files.

**Impact of Exploitation:**
*   **Remote Code Execution (RCE):** By uploading malicious PHP files, attackers could execute arbitrary code on the server.
*   **Full Site Takeover:** Successful RCE could lead to complete compromise and control of the affected WordPress site.

**Attack Vectors:**
*   **Network:** The attack could be performed remotely via HTTP requests to the WordPress site's AJAX endpoint `wp-admin/admin-ajax.php`.
*   **User Interaction:** The attacker only needed to be logged in as an authenticated user.

**Required Attacker Capabilities/Position:**
*   **Authenticated User:** The attacker only needed to have a valid user account (e.g., subscriber) on the vulnerable WordPress site.
*   **Network Access:** The attacker needed to be able to send HTTP requests to the vulnerable site.

**Additional Information:**
*   The vulnerability was discovered by Chloe Chamberland from Wordfence.
*   A proof of concept (PoC) is provided demonstrating the exploit.
*   The vulnerability was fixed in version 1.0.34 of the External Media plugin.
*   The vulnerability has a CVSS score of 9.9, categorized as critical.
*   Wordfence Premium users received firewall protection against this vulnerability on February 2, 2021, and free Wordfence users received protection on March 4, 2021.