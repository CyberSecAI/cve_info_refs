The provided content is related to CVE-2021-24944.

**Root cause of vulnerability:**
The plugin does not sanitize some of its settings, specifically the "Change version text" and "Change footer text" settings, allowing for the injection of malicious scripts. Although a later version of the plugin restricted access to settings to administrators with `unfiltered_html` capability, existing payloads remained unsanitized.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability due to insufficient sanitization of user-controlled settings.
- Lack of sanitization of existing payloads, even after access to settings was restricted.

**Impact of exploitation:**
Successful exploitation allows an attacker to execute arbitrary JavaScript code within the context of the victim's browser when accessing any admin page. This could lead to various malicious actions such as:
- Account compromise by stealing cookies or session tokens
- Defacement of the website
- Redirection to malicious websites
- Further attacks on the server
- Data manipulation

**Attack vectors:**
- An attacker with admin privileges can insert a malicious payload into the "Change version text" or "Change footer text" setting via the plugin's settings page `/wp-admin/tools.php?page=ag-custom-admin%2Fplugin.php#admin-footer-settings`.

**Required attacker capabilities/position:**
- The attacker needs administrative access to the WordPress website.