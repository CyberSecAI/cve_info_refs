- **Root cause of vulnerability:** The Autoptimize plugin does not properly validate uploaded files via the "Import Settings" feature. It fails to check for malicious file types like .html within uploaded ZIP archives.
- **Weaknesses/vulnerabilities present:** Authenticated Stored Cross-Site Scripting (XSS) vulnerability. The plugin allows a high-privilege user to upload a ZIP archive containing a malicious HTML file with JavaScript code. This code is then executed when a victim visits the index.html file within the plugin's directory.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of the victim's browser by tricking a user into visiting a crafted URL. This allows the attacker to perform actions such as stealing cookies, session tokens, or redirecting the user to a malicious website.
- **Attack vectors:** The vulnerability can be exploited via the "Import Settings" feature in the plugin's settings page. A malicious ZIP file can be uploaded using this functionality. The attack is initiated when a user visits the uploaded file in the plugin's directory.
- **Required attacker capabilities/position:** The attacker must have high-privilege user access (e.g., administrator) to upload the malicious ZIP file. The victim must also visit the malicious file in the plugin directory.