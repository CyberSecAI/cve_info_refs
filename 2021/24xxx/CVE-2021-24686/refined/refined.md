Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-24686

**Root Cause:** The "CSS Class to target" setting within the SVG Support WordPress plugin was not properly sanitized before being output as an HTML attribute. This lack of sanitization allowed for the injection of malicious code.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. Malicious JavaScript code could be inserted into the "CSS Class to target" setting and would then be executed within the context of the user's browser when the settings page is rendered.
*   **Lack of Output Sanitization:** The core issue is the failure to properly sanitize user-supplied input before outputting it within an HTML attribute, specifically the `class` attribute.

**Impact of Exploitation:**
*   **Arbitrary JavaScript Execution:** An attacker could inject arbitrary JavaScript code, potentially leading to:
    *   **Session Hijacking:** Stealing user session cookies.
    *   **Redirection:** Redirecting users to malicious websites.
    *   **Content Manipulation:** Modifying the content of the website.
    *   **Privilege Escalation:** Performing actions on behalf of an administrator.

**Attack Vectors:**
*   **Admin Interface:** The vulnerability is located within the plugin's settings page, specifically the "CSS Class to target" field in the admin settings page.
*   **Direct Input:** An attacker would need to have administrator-level access to modify the plugin settings and insert the malicious payload into the vulnerable field.

**Required Attacker Capabilities/Position:**
*   **Administrator Access:** The attacker must have at least administrator-level access to the WordPress site to access and modify the plugin settings.
*   **Plugin Enabled:** The SVG Support plugin must be installed and enabled on the target WordPress site.
*   **Advanced Mode Enabled:** The "Advanced Mode" option for SVG Support must be enabled.

**Technical Details:**
* The vulnerable code was in `svgs-settings-page.php`, where the `css_target` setting was not escaped using `esc_attr()` before outputting it in the HTML `input` tag.
*  The fix in `admin-init.php` includes a sanitization callback function `bodhi_sanitize_fields` that uses `esc_attr(sanitize_text_field())` to sanitize the `css_target` input value. Also, the `attribute-control.php` was fixed, using `esc_attr($class)` to prevent the injection. The same happens in `enqueue.php` where the css target is escaped via `esc_attr()`.

**Additional Notes:**

*   The vulnerability was fixed in version 2.3.20 of the plugin.
*   The provided content includes code diffs showing the specific changes made to address the vulnerability.
*   The exploit was demonstrated by using the payload `"><script>alert(/XSS/)</script>` in the "CSS Class to target" setting.

This information is more detailed than the original CVE description, as it provides the specific location of the vulnerability and the fix applied, along with a proof of concept.