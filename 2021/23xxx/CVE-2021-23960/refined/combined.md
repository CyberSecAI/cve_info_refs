=== Content from www.mozilla.org_7358fcf7_20250114_193515.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-03

## Security Vulnerabilities fixed in Firefox 85

Announced
January 26, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 85

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2021-23955: Clickjacking across tabs through misusing requestPointerLock](#CVE-2021-23955)

Reporter
Irvan Kurniawan
Impact
high
##### Description

The browser could have been confused into transferring a pointer lock state into another tab, which could have lead to clickjacking attacks.

##### References

* [Bug 1684837](https://bugzilla.mozilla.org/show_bug.cgi?id=1684837)

#### [#CVE-2021-23956: File picker dialog could have been used to disclose a complete directory](#CVE-2021-23956)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An ambiguous file picker design could have confused users who intended to select and upload a single file into uploading a whole directory. This was addressed by adding a new prompt.

##### References

* [Bug 1338637](https://bugzilla.mozilla.org/show_bug.cgi?id=1338637)

#### [#CVE-2021-23957: Iframe sandbox could have been bypassed on Android via the intent URL scheme](#CVE-2021-23957)

Reporter
Eliya Stein
Impact
moderate
##### Description

Navigations through the Android-specific `intent` URL scheme could have been misused to escape iframe sandbox.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1584582](https://bugzilla.mozilla.org/show_bug.cgi?id=1584582)

#### [#CVE-2021-23958: Screen sharing permission leaked across tabs](#CVE-2021-23958)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

The browser could have been confused into transferring a screen sharing state into another tab, which would leak unintended information.

##### References

* [Bug 1642747](https://bugzilla.mozilla.org/show_bug.cgi?id=1642747)

#### [#CVE-2021-23959: Cross-Site Scripting in error pages on Firefox for Android](#CVE-2021-23959)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An XSS bug in internal error pages could have led to various spoofing attacks, including other error pages and the address bar.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1659035](https://bugzilla.mozilla.org/show_bug.cgi?id=1659035)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23962: Use-after-poison in "nsTreeBodyFrame::RowCountChanged"](#CVE-2021-23962)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

Incorrect use of the `RowCountChanged` method could have led to a user-after-poison and a potentially exploitable crash.

##### References

* [Bug 1677194](https://bugzilla.mozilla.org/show_bug.cgi?id=1677194)

#### [#CVE-2021-23963: Permission prompt inaccessible after asking for additional permissions](#CVE-2021-23963)

Reporter
Paul Zühlcke
Impact
low
##### Description

When sharing geolocation during an active WebRTC share, Firefox could have reset the webRTC sharing state in the user interface, leading to loss of control over the currently granted permission

##### References

* [Bug 1680793](https://bugzilla.mozilla.org/show_bug.cgi?id=1680793)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Tyson Smith, Jesse Schwartzentruber, Jon Coppeard, Byron Campen, André Bargull, Steve Fink, Jason Kratzer, Christian Holler, Alexis Beingessner reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

#### [#CVE-2021-23965: Memory safety bugs fixed in Firefox 85](#CVE-2021-23965)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Sebastian Hengst, Christian Holler, Tyson Smith reported memory safety bugs present in Firefox 84. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1670378%2C1673555%2C1676812%2C1678582%2C1684497)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_28d77cda_20250114_193518.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-05

## Security Vulnerabilities fixed in Thunderbird 78.7

Announced
January 26, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2020-15685: IMAP Response Injection when using STARTTLS](#CVE-2020-15685)

Reporter
Damian Poddebniak
Impact
moderate
##### Description

During the plaintext phase of the STARTTLS connection setup, protocol commands could have been injected and evaluated within the encrypted session.

##### References

* [Bug 1622640](https://bugzilla.mozilla.org/show_bug.cgi?id=1622640)

#### [#CVE-2020-26976: HTTPS pages could have been intercepted by a registered service worker when they should not have been](#CVE-2020-26976)

Reporter
Andrew Sutherland
Impact
moderate
##### Description

When a HTTPS page was embedded in a HTTP page, and there was a service worker registered for the former, the service worker could have intercepted the request for the secure page despite the iframe not being a secure context due to the (insecure) framing.

##### References

* [Bug 1674343](https://bugzilla.mozilla.org/show_bug.cgi?id=1674343)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23964: Memory safety bugs fixed in Thunderbird 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Christian Holler, Andrew McCreight, Tyson Smith, Jon Coppeard, André Bargull, Jason Kratzer, Jesse Schwartzentruber, Steve Fink, Byron Campen reported memory safety bugs present in Thunderbird 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a1fe0c3c_20250114_193517.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-04

## Security Vulnerabilities fixed in Firefox ESR 78.7

Announced
January 26, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.7

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2020-26976: HTTPS pages could have been intercepted by a registered service worker when they should not have been](#CVE-2020-26976)

Reporter
Andrew Sutherland
Impact
moderate
##### Description

When a HTTPS page was embedded in a HTTP page, and there was a service worker registered for the former, the service worker could have intercepted the request for the secure page despite the iframe not being a secure context due to the (insecure) framing.

##### References

* [Bug 1674343](https://bugzilla.mozilla.org/show_bug.cgi?id=1674343)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Christian Holler, Andrew McCreight, Tyson Smith, Jon Coppeard, André Bargull, Jason Kratzer, Jesse Schwartzentruber, Steve Fink, Byron Campen reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_15421ca4_20250114_193514.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1675755)
* [XML](/show_bug.cgi?ctype=xml&id=1675755)

Closed
[Bug 1675755](/show_bug.cgi?id=1675755)
(CVE-2021-23960)

Opened 4 years ago
Closed 4 years ago

# Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]

## Categories

### (Core :: JavaScript Engine, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

85 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox83 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix) |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 85+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox83 |  | wontfix |
| firefox84 |  | wontfix |
| firefox85 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: sfink)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d269c0228684029dedb75d73b81a64c3?d=mm&size=40)  [sfink](/user_profile?user_id=359004)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1683736](/show_bug.cgi?id=1683736 "RESOLVED FIXED - DebuggerFrame::getThis does not always enter correct Realm")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1675755&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1675755)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-wildptr, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main85+][adv-esr78.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23960

[Keywords:](/describekeywords.cgi)

[csectype-wildptr](/buglist.cgi?keywords=csectype-wildptr&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main85+][adv-esr78.7+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3397470_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c29 "4 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | [qe-verify](#a3975739_458186 "4 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (11 files)

| [array-split-reload.html](/attachment.cgi?id=9186217)  [4 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   334 bytes, text/html |  | [Details](/attachment.cgi?id=9186217&action=edit) |
| --- | --- | --- |
| [array-split.html](/attachment.cgi?id=9186218)  [4 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   11.02 KB, text/html |  | [Details](/attachment.cgi?id=9186218&action=edit) |
| [gdb.log](/attachment.cgi?id=9186220)  [4 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   34.80 KB, text/plain |  | [Details](/attachment.cgi?id=9186220&action=edit) |
| [valgrind.log](/attachment.cgi?id=9186221)  [4 years ago](#c3)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   61.12 KB, text/plain |  | [Details](/attachment.cgi?id=9186221&action=edit) |
| [asan.rare.log](/attachment.cgi?id=9186222)  [4 years ago](#c4)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   5.03 KB, text/plain |  | [Details](/attachment.cgi?id=9186222&action=edit) |
| [asan.somecase.log](/attachment.cgi?id=9186223)  [4 years ago](#c5)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   11.10 KB, text/plain |  | [Details](/attachment.cgi?id=9186223&action=edit) |
| [Mozilla Firefox Crash - GC redeclare const then reload.mp4](/attachment.cgi?id=9186225)  [4 years ago](#c6)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.25 MB, video/mp4 |  | [Details](/attachment.cgi?id=9186225&action=edit) |
| [Mozilla Firefox Crash - GC after redeclare const then instant evaluation - use-after-poison.mp4](/attachment.cgi?id=9186230)  [4 years ago](#c7)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   9.39 MB, video/mp4 |  | [Details](/attachment.cgi?id=9186230&action=edit) |
| [Bug 1675755 - Enter correct compartment before we might allocate BaseShape](/attachment.cgi?id=9188474)  [4 years ago](#c19)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c28 "4 years ago")  dveditz : [sec-approval+](#c25 "4 years ago") | [Details](/attachment.cgi?id=9188474&action=edit) | [Review](/attachment.cgi?id=9188474) |
| [Bug 1675755 - test](/attachment.cgi?id=9191201)  [4 years ago](#c21)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#a3661436_75935 "4 years ago")  dveditz : [sec-approval+](#a2800389_1689 "4 years ago") | [Details](/attachment.cgi?id=9191201&action=edit) | [Review](/attachment.cgi?id=9191201) |
| [advisory.txt](/attachment.cgi?id=9198099)  [4 years ago](#c32)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   240 bytes, text/plain |  | [Details](/attachment.cgi?id=9198099&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1675755#c0)• 4 years ago |
|  | |

Attached file
[array-split-reload.html](attachment.cgi?id=9186217)
— [Details](attachment.cgi?id=9186217&action=edit)

When mistakenly re-declaration of `let` or `const` on the browser console, then reload the page repeatedly or typing string.split("") or string.split(" ") while waiting browser console instant evaluation result, suddenly the tab is crashed. To trigger the crash, on the HTML file it need to initialize one constant variable i.e `const x = "A"`

Mostly when Firefox Nightly ASAN crash, it shows `AddressSanitizer: SEGV on unknown address (pc 0x7fa6e7dbe0b9 bp 0x7ffe338b3620 sp 0x7ffe338b3610 T0)` but the unknown address is not showed.

Sometimes Nightly ASAN shows `AddressSanitizer: use-after-poison on address 0x27f915ded218 at pc 0x7f4221357bb8 bp 0x7fffb52d8850 sp 0x7fffb52d8848 READ of size 8 at 0x27f915ded218 thread T0 (Web Content)`

Rare moment, Nightly ASAN show the unknown address: `AddressSanitizer: SEGV on unknown address 0x363339343840 (pc 0x7fdf867b7257 bp 0x7ffe9e3f92b0 sp 0x7ffe9e3f8e20 T0)` (reproduced on Firefox Nightly ASAN 2020-10-26) (64-bit)

It seems Nightly ASAN tried to access address 0x363339343840 which is potentially exploitable and worth to investigate further.

I've attached Firefox Nightly ASAN log, full GDB log (launch with command line `./mach run --debugger="gdb-9" --debugger-args="-q --args" --disable-e10s`), full valgrind log, and PoC video when reproduce the issue.

## Browser tested:

* Firefox 82.0.2 (64-bit) on Arch Linux
* Firefox 78.4.0esr (64-bit) on Arch Linux
* Firefox Nightly 84.0a1 (2020-11-05) (64-bit) on Windows 10
* Firefox Nightly ASAN 84.0a1 (2020-11-05) (64-bit) on Arch Linux

## Steps to Reproduce:

### Reload the page

1. Visit attached file: array-split-reload.html
2. Enter below text to the console:

> > const array = string.split("") ↵ (press enter)
> >
> > const array = string.split("\n") ↵ (press enter)

3. Reload the page repeatedly
4. Tab is crashed.

### Console instant evaluation

1. Visit attached file: array-split.html
2. Open Web Developer -> Web Console (Ctrl+Shift+K)
3. Enter below text to the console:

> > const array = string.split("\n") ↵ (press enter)
> >
> > const array = string.split("") ↵ (press enter)

4. Type to the console (without press enter):

> > string.split("")
> >
> > string.split(" ")
> >
> > string.split("")
> >
> > string.split(" ")
> >
> > string.split("")
> >
> > string.split("\n")
> >
> > string.split("")

If above doesn't crash the tab, reload the page, then re-type to the console (without press enter):

> > string.split("")
> >
> > string.split(" ")
> >
> > string.split("")
> >
> > string.split(" ")
> >
> > string.split("")

## What happened? (actual results)

Gah. Your tab just crashed.

```
AddressSanitizer:DEADLYSIGNAL
=================================================================
==236847==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x7fa6e7dbe0b9 bp 0x7ffe338b3620 sp 0x7ffe338b3610 T0)
==236847==The signal is caused by a READ memory access.
==236847==Hint: this fault was caused by a dereference of a high value address (see register values below).  Dissassemble the provided pc to learn which register was used.
error: address range table at offset 0x5c90 has an invalid tuple (length = 0) at offset 0x5ca0
    #0 0x7fa6e7dbe0b9 in runtimeFromAnyThread /builds/worker/checkouts/gecko/js/src/gc/Cell.h:335:27
    #1 0x7fa6e7dbe0b9 in IsOwnedByOtherRuntime<js::BaseShape *> /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:170:23
    #2 0x7fa6e7dbe0b9 in ShouldMark<js::BaseShape *> /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:885:7
    #3 0x7fa6e7dbe0b9 in void DoMarking<js::BaseShape>(js::GCMarker*, js::BaseShape*) /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:941:8
    #4 0x7fa6e7dbe04d in bool js::gc::TraceEdgeInternal<js::BaseShape*>(JSTracer*, js::BaseShape**, char const*) /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:675:5
    #5 0x7fa6e7dc5250 in js::GCMarker::eagerlyMarkChildren(js::Shape*) /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:1249:13
    #6 0x7fa6e7d94223 in markAndScan<js::Shape> /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:1032:5
    #7 0x7fa6e7d94223 in traverse<js::Shape *> /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:1042:3
    #8 0x7fa6e7d94223 in traverseEdge<JSObject *, js::Shape> /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:1132:3
    #9 0x7fa6e7d94223 in js::GCMarker::processMarkStackTop(js::SliceBudget&) /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:2102:3
    #10 0x7fa6e7d93422 in js::GCMarker::markUntilBudgetExhausted(js::SliceBudget&, js::GCMarker::ShouldReportMarkTime) /builds/worker/checkouts/gecko/js/src/gc/Marking.cpp:1835:7
    #11 0x7fa6e7d4331a in js::gc::GCRuntime::markUntilBudgetExhausted(js::SliceBudget&, js::GCMarker::ShouldReportMarkTime) /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:5662:17
    #12 0x7fa6e7d523de in js::gc::GCRuntime::incrementalSlice(js::SliceBudget&, mozilla::Maybe<JSGCInvocationKind> const&, JS::GCReason, js::gc::AutoGCSession&) /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:6795:13
    #13 0x7fa6e7d55ed5 in js::gc::GCRuntime::gcCycle(bool, js::SliceBudget, mozilla::Maybe<JSGCInvocationKind> const&, JS::GCReason) /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:7249:3
    #14 0x7fa6e7d58213 in js::gc::GCRuntime::collect(bool, js::SliceBudget, mozilla::Maybe<JSGCInvocationKind> const&, JS::GCReason) /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:7484:9
    #15 0x7fa6e7d32de3 in gcSlice /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:7575:3
    #16 0x7fa6e7d32de3 in js::gc::GCRuntime::gcIfRequested() /builds/worker/checkouts/gecko/js/src/gc/GC.cpp:7769:7
    #17 0x7fa6e7d0345b in gcIfNeededAtAllocation /builds/worker/checkouts/gecko/js/src/gc/Allocator.cpp:451:5
    #18 0x7fa6e7d0345b in bool js::gc::GCRuntime::checkAllocatorState<(js::AllowGC)1>(JSContext*, js::gc::AllocKind) /builds/worker/checkouts/gecko/js/src/gc/Allocator.cpp:406:10
    #19 0x7fa6e7d05674 in JSString* js::AllocateStringImpl<JSString, (js::AllowGC)1>(JSContext*, js::gc::InitialHeap) /builds/worker/checkouts/gecko/js/src/gc/Allocator.cpp:209:15
    #20 0x7fa6e717665d in AllocateString<JSThinInlineString, js::CanGC> /builds/worker/checkouts/gecko/js/src/gc/Allocator.h:61:32
    #21 0x7fa6e717665d in new_<js::CanGC> /builds/worker/checkouts/gecko/js/src/vm/StringType-inl.h:322:10
    #22 0x7fa6e717665d in AllocateInlineString<js::CanGC, unsigned char> /builds/worker/checkouts/gecko/js/src/vm/StringType-inl.h:35:31
    #23 0x7fa6e717665d in NewInlineString<js::CanGC, unsigned char> /builds/worker/checkouts/gecko/js/src/vm/StringType-inl.h:63:25
    #24 0x7fa6e717665d in JSLinearString* js::Int32ToString<(js::AllowGC)1>(JSContext*, int) /builds/worker/checkouts/gecko/js/src/jsnum.cpp:816:7
    #25 0x7fa6e79fd6ee in js::IdVectorToArray(JSContext*, JS::Handle<JS::GCVector<JS::PropertyKey, 0ul, js::TempAllocPolicy> >) /builds/worker/checkouts/gecko/js/src/debugger/Frame.cpp:1926:23
    #26 0x7fa6e7a8c431 in js::DebuggerObject::CallData::getOwnPropertyNamesMethod() /builds/worker/checkouts/gecko/js/src/debugger/Object.cpp:778:24
    #27 0x7fa6e7aad28e in bool js::DebuggerObject::CallData::ToNative<&(js::DebuggerObject::CallData::getOwnPropertyNamesMethod())>(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/js/src/debugger/Object.cpp:243:10
    #28 0x7fa652f6344f  (<unknown module>)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /builds/worker/checkouts/gecko/js/src/gc/Cell.h:335:27 in runtimeFromAnyThread
==236847==ABORTING
JavaScript error: resource:///modules/ContentCrashHandlers.jsm, line 50: TypeError: can't access property "permanentKey", browser is undefined

```
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1675755#c1)• 4 years ago |
|  | |

Attached file
[array-split.html](attachment.cgi?id=9186218)
— [Details](attachment.cgi?id=9186218&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1675755#c2)• 4 years ago |
|  | |

Attached file
[gdb.log](attachment.cgi?id=9186220)
— [Details](attachment.cgi?id=9186220&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1675755#c3)• 4 years ago |
|  | |

Attached file
[valgrind.log](attachment.cgi?id=9186221)
— [Details](attachment.cgi?id=9186221&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1675755#c4)• 4 years ago |
|  | |

Attached file
[asan.rare.log](attachment.cgi?id=9186222)
— [Details](attachment.cgi?id=9186222&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1675755#c5)• 4 years ago |
|  | |

Attached file
[asan.somecase.log](attachment.cgi?id=9186223)
— [Details](attachment.cgi?id=9186223&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1675755#c6)• 4 years ago |
|  | |

Attached video
[Mozilla Firefox Crash - GC redeclare const then reload.mp4](attachment.cgi?id=9186225)
— [Details](attachment.cgi?id=9186225&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1675755#c7)• 4 years ago |
|  | |

Attached video
[Mozilla Firefox Crash - GC after redeclare const then instant evaluation - use-after-poison.mp4](attachment.cgi?id=9186230)
— [Details](attachment.cgi?id=9186230&action=edit)

PoC video when Firefox ASAN shows use-after-poison.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a13972_159069)• 4 years ago |

Group: firefox-core-security → javascript-core-securityComponent: Security → JavaScript EngineProduct: Firefox → Core

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1675755#c8)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1675755&comment_id=15119271 "1 revision") |
|  | |

Steve, needinfo'ing you since this looks GC-related and it's end of day here...

Flags: needinfo?(sphink)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1675755#c9)• 4 years ago |
|  | |

Great report, thank you!

I'm still trying to reproduce. I tried with Firefox Nightly ASAN 84.0a1, both 2020-10-23 and build ID 20201106041434. I'll try with one of the nightlies from 2020-11-05 next.

The stack in [comment 0](/show_bug.cgi?id=1675755#c0 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]"), as well as the gdb log, show the GC traversing an edge from a JSObject to a Shape, and the Shape pointer points to a previously swept portion of the heap. That object *should* have marked through that edge and kept it alive. (Or if that edge was written to it, then it should have marked the Shape\* with a pre-barrier before moving it.)

I was thinking that maybe hitting a redeclaration error would leave a half-initialized object with a Shape pointer that gets conditionally traversed during marking, or something like that, but I couldn't spot anything obvious when looking at the callers of code that emits JSMSG\_REDECLARED\_VAR. This would presumably be done with a Debugger eval.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1675755#c10)• 4 years ago |
|  | |

(In reply to Steve Fink [:sfink] [:s:] from [comment #9](/show_bug.cgi?id=1675755#c9 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]"))

> Great report, thank you!
>
> I'm still trying to reproduce. I tried with Firefox Nightly ASAN 84.0a1, both 2020-10-23 and build ID 20201106041434. I'll try with one of the nightlies from 2020-11-05 next.
>
> The stack in [comment 0](/show_bug.cgi?id=1675755#c0 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]"), as well as the gdb log, show the GC traversing an edge from a JSObject to a Shape, and the Shape pointer points to a previously swept portion of the heap. That object *should* have marked through that edge and kept it alive. (Or if that edge was written to it, then it should have marked the Shape\* with a pre-barrier before moving it.)
>
> I was thinking that maybe hitting a redeclaration error would leave a half-initialized object with a Shape pointer that gets conditionally traversed during marking, or something like that, but I couldn't spot anything obvious when looking at the callers of code that emits JSMSG\_REDECLARED\_VAR. This would presumably be done with a Debugger eval.

Thanks Steve for the detailed explanation, it helps me understand better.

To help reproduce the issue, you can watch the attached video: [Mozilla Firefox Crash - GC redeclare const then reload.mp4](https://bugzilla.mozilla.org/attachment.cgi?id=9186225), on that video I take steps:

1. I'm visiting [array-split-reload.html](https://bugzilla.mozilla.org/attachment.cgi?id=9186217)
2. Open Web Developer -> Web Console (Ctrl+Shift+K)
3. On the Web Console
4. Type `const array = string.split("")` press enter
5. Type `const array = string.split("\n")` press enter
6. Reload the page several times
7. Tab crashed

In the [array-split-reload.html](https://bugzilla.mozilla.org/attachment.cgi?id=9186217) file, it allocate large memory to help trigger the GC. After we redeclare const in the web console, then reload the page several times (memory also increased), when GC is triggered, the tab is crashed.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a102154_537720)• 4 years ago |

Summary: Crash on GC after redeclare let or const on the browser console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)] → Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1675755#c11)• 4 years ago |
|  | |

Yes, I watched both videos, and followed your instructions. Both the videos and your instructions were very clear. It didn't crash for me using either approach. On Monday, I'll try using the Nightly from the same day. (I'm on Fedora.)

This is asking a lot, but one way to track this down would be if you packed up an rr recording ( <https://rr-project.org/> ). I could either replay it locally or upload it to Pernosco. But I will continue trying to reproduce locally.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1675755#c12)• 4 years ago |
|  | |

(In reply to Steve Fink [:sfink] [:s:] from [comment #11](/show_bug.cgi?id=1675755#c11 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]"))

> Yes, I watched both videos, and followed your instructions. Both the videos and your instructions were very clear. It didn't crash for me using either approach. On Monday, I'll try using the Nightly from the same day. (I'm on Fedora.)
>
> This is asking a lot, but one way to track this down would be if you packed up an rr recording ( <https://rr-project.org/> ). I could either replay it locally or upload it to Pernosco. But I will continue trying to reproduce locally.

I've recorded the crash with rr w/ command line `./mach run --debugger="rr" --debugger-args="record" --disable-e10s`:

RR recording: <https://drive.google.com/file/d/1GGRhqgwy0avh3xn-o7o3vlK-3QuP2Jar/view?usp=sharing>

Firefox compiled dist folder: <https://drive.google.com/file/d/14hiQumygtivly3vJczma0Fz_1V1S4ok5/view?usp=sharing> (in my case GDB tried to find this, if my external drive unmounted when run rr replay)

The default dist folder path in my laptop is: `/run/media/sourc7/c2fdf084-509b-4e39-9382-44d4b31d173e/external/mozilla-central-valgrind/obj-x86_64-pc-linux-gnu/dist` so when run rr replay, GDB will point to that folder.

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1675755#c13)• 4 years ago |
|  | |

(Darn it, I typed this in yesterday and forgot to hit Save Changes. I'll be trying out that uploaded trace right now.)

Oh, wow, thanks! I kicked off a download, but can you run `rr pack` to get everything it needs to replay into the trace directory? That should remove the need for a separate folder and make sure that everything it needs is in the right place, without worrying about the external drive. It may make it very large, though, even larger than it already is. I probably won't have time to look at this until tomorrow, but as soon as I get a chance I'll try with the existing 2 uploads you provided.

Thank you!

(I was still unable to reproduce the crash with the 2020-11-05 Nightly ASAN build for some reason, so this recording should be very helpful.)

Flags: needinfo?(sphink)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1675755#c14)• 4 years ago |
|  | |

Oh, from the filename it looks like you did use `rr pack`?

Sadly, I'm getting `Trace XCR0 value 0x2e7 != our XCR0 value 0x1f; Replay will probably fail because glibc dynamic loader examines XCR0` followed by an assertion. But I may still be able to use it.

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1675755#c15)• 4 years ago |
|  | |

Ok, I made my way through the submission process, and unfortunately it fails because AVX512 was used. Would you be able to resubmit by running with

`./mach run --debugger="rr" --debugger-args="record --disable-cpuid-features-ext 0xdc230000,0x2c42,0xc" --disable-e10s`

At least, that's what it's asking me to do. Hopefully that isn't dependent on the CPU I am running.

I tried running the binary in your dist upload, but it wants a newer libc than I have. Perhaps it's time for me to upgrade.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1675755#c16)• 4 years ago |
|  | |

(In reply to Steve Fink [:sfink] [:s:] from [comment #15](/show_bug.cgi?id=1675755#c15 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]"))

> Oh, from the filename it looks like you did use rr pack?

Yes I'm run `rr pack` then archive the folder with .tar.lz4

> Ok, I made my way through the submission process, and unfortunately it fails because AVX512 was used. Would you be able to resubmit by running with
>
> `./mach run --debugger="rr" --debugger-args="record --disable-cpuid-features-ext 0xdc230000,0x2c42,0xc" --disable-e10s`
>
> At least, that's what it's asking me to do. Hopefully that isn't dependent on the CPU I am running.
>
> I tried running the binary in your dist upload, but it wants a newer libc than I have. Perhaps it's time for me to upgrade.

Sure, I've launched compiled Firefox with above command line, here the rr packed trace link: <https://drive.google.com/file/d/1hGiuodIAzmNtAKzgO1cZk6hHfXbG97JV/view?usp=sharing> (on this recording, the tab crash on single reload)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a375822_359004)• 4 years ago |

Type: task → defect

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a445404_406194)• 4 years ago |

[Attachment #9186221](/attachment.cgi?id=9186221&action=edit "valgrind.log") -
Attachment mime type: text/x-log → text/plain

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a445411_406194)• 4 years ago |

[Attachment #9186220](/attachment.cgi?id=9186220&action=edit "gdb.log") -
Attachment mime type: text/x-log → text/plain

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a445455_406194)• 4 years ago |

[Attachment #9186222](/attachment.cgi?id=9186222&action=edit "asan.rare.log") -
Attachment mime type: text/x-log → text/plain

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a445468_406194)• 4 years ago |

[Attachment #9186223](/attachment.cgi?id=9186223&action=edit "asan.somecase.log") -
Attachment mime type: text/x-log → text/plain

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a466484_1689)• 4 years ago |

Keywords: [csectype-wildptr](/buglist.cgi?keywords=csectype-wildptr&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a975631_281791)• 4 years ago |

Severity: -- → S3Priority: -- → P1

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1675755#c17)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1675755&comment_id=15136829 "1 revision") |
|  | |

I finally managed to get this uploaded to Pernosco with source code and everything. It was still a pain to track down, but I think I have it.

The problem is that a `Shape` is given a cross-zone pointer to a `BaseShape`. These should very much not be cross-zone edges, and are not handled as such. As a result, there is a GC that does not include the `Shape`'s `Zone`, so nothing marks the `BaseShape` and it gets freed. In detail:

There's `obj`, a `js::LexicalEnvironmentObject`.

* major GC #9: `obj` is traced as the environment chain of an Interpreter frame
* `obj->shape` runs `Shape::cachify`, which creates a new owned `BaseShape*` in the wrong `Zone` (because the `cx`'s is not in the `Shape`'s `Realm`.)
* major GC #10: `obj` is not traced because its zone is not collected. The base shape is freed.
* major GC #11: `obj` is traced as a Realm's global lexical environment, which traces obj->shape->baseShape and crashes.

The stack where the `BaseShape` is constructed is:

```
#0  js::Shape::makeOwnBaseShape (this=0x232b42655600, cx=0x55d7f3ef1630) at js/src/vm/Shape.cpp:136
#1  js::Shape::ensureOwnBaseShape (this=0x232b42655600, cx=<optimized out>) at js/src/vm/Shape.h:1055
#2  js::Shape::cachify (cx=0x55d7f3ef1630, shape=0x232b42655600) at js/src/vm/Shape.cpp:205
#3  0x00007f4d94ec8af7 in js::Shape::maybeCreateCacheForLookup (this=0x232b42655600, cx=0x55d7f3ef1630) at js/src/vm/Shape-inl.h:54
#4  js::Shape::search<(js::MaybeAdding)0> (cx=0x55d7f3ef1630, start=0x232b42655600, id=...) at js/src/vm/Shape-inl.h:83
#5  js::Shape::search (this=0x232b42655600, cx=0x55d7f3ef1630, id=...) at js/src/vm/Shape-inl.h:37
#6  js::LookupOwnPropertyInline<(js::AllowGC)1> (cx=0x55d7f3ef1630, obj=..., id=..., propp=..., donep=<optimized out>) at js/src/vm/NativeObject-inl.h:795
#7  js::LookupPropertyInline<(js::AllowGC)1> (cx=0x55d7f3ef1630, obj=..., id=..., objp=..., propp=...) at js/src/vm/NativeObject-inl.h:881
#8  js::LookupProperty (cx=0x55d7f3ef1630, obj=..., id=..., objp=..., propp=...) at js/src/vm/JSObject.cpp:2174
#9  0x00007f4d950f2419 in js::DebuggerObject::forceLexicalInitializationByName (cx=0x55d7f3ef1630, object=..., id=..., result=@0x7ffde1b170af: false) at js/src/debugger/Object.cpp:2384
#10 0x00007f4d950f20f9 in js::DebuggerObject::CallData::forceLexicalInitializationByNameMethod (this=0x7ffde1b170f0) at js/src/debugger/Object.cpp:1084
#11 0x00007f4d950ffbe3 in js::DebuggerObject::CallData::ToNative<&js::DebuggerObject::CallData::forceLexicalInitializationByNameMethod> (cx=0x55d7f3ef1630, argc=<optimized out>, vp=<optimized out>) at js/src/debugger/Object.cpp:243
#12 0x00007f4d94d2396b in CallJSNative (cx=0x55d7f3ef1630, native=0x7f4d950ffb20 <js::DebuggerObject::CallData::ToNative<&js::DebuggerObject::CallData::forceLexicalInitializationByNameMethod>(JSContext*, unsigned int, JS::Value*)>, reason=<optimized out>, args=...) at js/src/vm/Interpreter.cpp:507
#13 js::InternalCallOrConstruct (cx=0x55d7f3ef1630, args=..., construct=<optimized out>, reason=<optimized out>) at js/src/vm/Interpreter.cpp:599
#14 0x00007f4d94d24227 in InternalCall (cx=<optimized out>, args=..., reason=js::CallReason::Call) at js/src/vm/Interpreter.cpp:664
#15 0x00007f4d952c6ee9 in js::jit::DoCallFallback (cx=0x55d7f3ef1630, frame=0x7ffde1b17690, stub=<optimized out>, argc=<optimized out>, vp=<optimized out>, res=...) at js/src/jit/BaselineIC.cpp:3010
#16 0x000026f80999ed68 in ?? ()

```

I'm honestly not familiar with when the right time is to switch `Realm`s here -- at the low-level, before allocating, or at the semantically meaningful level of looking up a property. But I'll do one and find out via a review. ;-)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1675755#c18)• 4 years ago |
|  | |

Oh. Further note that there is a `MOZ_ASSERT` that would catch this in a debug build: `MOZ_ASSERT(cx->zone() == zone())` in `Shape::makeOwnBaseShape`. So clearly, it is expected that the higher-level code would have entered the correct compartment.

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a995479_359004)• 4 years ago |

Assignee: nobody → sphinkStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1675755#c19)• 4 years ago |
|  | |

Attached file
[Bug 1675755 - Enter correct compartment before we might allocate BaseShape](attachment.cgi?id=9188474)
— [Details](attachment.cgi?id=9188474&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1675755#c20)• 4 years ago |
|  | |

Alright great! After applied [Diff 368924](https://phabricator.services.mozilla.com/D97386) on changeset: [42e7e98c701d3e8c8c66a5acca0f0aeeb5076661](https://hg.mozilla.org/mozilla-central/rev/42e7e98c701d3e8c8c66a5acca0f0aeeb5076661). I confirmed I no longer able to reproduce the crash.

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1675755#c21)• 4 years ago |
|  | |

Attached file
[Bug 1675755 - test](attachment.cgi?id=9191201)
— [Details](attachment.cgi?id=9191201&action=edit)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1675755#c22)• 4 years ago |
|  | |

Comment on [attachment 9188474](/attachment.cgi?id=9188474 "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") [[details]](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape")

[Bug 1675755](/show_bug.cgi?id=1675755 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]") - Enter correct compartment before we might allocate BaseShape

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Given that it requires Debugger, I don't think it can be triggered via content code.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: (I'm guessing all of them)
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should be very easy, hopefully automatic.
* **How likely is this patch to cause regressions; how much testing does it need?**: Not risky. The same thing happens in many other code paths, this one was just lacking it.
[Attachment #9188474](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") -
Flags: sec-approval?

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a2449924_359004)• 4 years ago |

[Attachment #9191201](/attachment.cgi?id=9191201&action=edit "Bug 1675755 - test") -
Flags: sec-approval?

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1675755#c23)• 4 years ago |
|  | |

(sec-approval ping)

Flags: needinfo?(dveditz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1675755#c24)• 4 years ago |
|  | |

Probably not a sec-high if the debugger is needed to trigger it.

[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix)
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox85](/buglist.cgi?f1=cf_tracking_firefox85&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a2800133_1689)• 4 years ago |

Flags: needinfo?(dveditz)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1675755#c25)• 4 years ago |
|  | |

Comment on [attachment 9188474](/attachment.cgi?id=9188474 "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") [[details]](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape")

[Bug 1675755](/show_bug.cgi?id=1675755 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]") - Enter correct compartment before we might allocate BaseShape

sec-approval+, though not technically needed now that I've downgraded the sec severity rating

[Attachment #9188474](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a2800389_1689)• 4 years ago |

[Attachment #9191201](/attachment.cgi?id=9191201&action=edit "Bug 1675755 - test") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1675755#c26)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/06985ffb553f09a87e9e6fb63691d52925745b6d>

<https://hg.mozilla.org/integration/autoland/rev/652b2cbf74eb74d9be090a79163e650ac47d0ae9>

<https://hg.mozilla.org/mozilla-central/rev/06985ffb553f>

<https://hg.mozilla.org/mozilla-central/rev/652b2cbf74eb>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected) → [verified disabled](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified%20disabled)Resolution: --- → FIXEDTarget Milestone: --- → 85 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3397470_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3421801_75935)• 4 years ago |

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[verified disabled](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified%20disabled) → [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1675755#c27)• 4 years ago |
|  | |

Comment on [attachment 9188474](/attachment.cgi?id=9188474 "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") [[details]](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape")

[Bug 1675755](/show_bug.cgi?id=1675755 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]") - Enter correct compartment before we might allocate BaseShape

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: I'm ambivalent as to whether this needs to land in esr78. But it's a crasher that can be hit by typing stuff into the web console.
* **User impact if declined**: If the user uses `let` and `const` for exploratory stuff in the console, it's fairly easy to run into this crash. Given that it requires Debugger, and moreover the only straightforward way to hit it is via interactive commands, it would be very difficult to exploit.
* **Fix Landed on Version**: 85
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: There are many code paths that have to enter the Debuggee realm. There was one place that was missing it. So now it looks more like the rest, and it's hard to come up with a way for it to cause problems.
* **String or UUID changes made by this patch**: none
[Attachment #9188474](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") -
Flags: approval-mozilla-esr78?

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3567550_359004)• 4 years ago |

[Attachment #9191201](/attachment.cgi?id=9191201&action=edit "Bug 1675755 - test") -
Flags: approval-mozilla-esr78?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1675755#c28)• 4 years ago |
|  | |

Comment on [attachment 9188474](/attachment.cgi?id=9188474 "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") [[details]](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape")

[Bug 1675755](/show_bug.cgi?id=1675755 "VERIFIED FIXED - Crash on GC after redeclare let or const on the web console [js::gc::Cell::runtimeFromAnyThread (this=0x4b4b4b4b4b4b4b4b)]") - Enter correct compartment before we might allocate BaseShape

Approved for 78.7esr.

[Attachment #9188474](/attachment.cgi?id=9188474&action=edit "Bug 1675755 - Enter correct compartment before we might allocate BaseShape") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3661436_75935)• 4 years ago |

[Attachment #9191201](/attachment.cgi?id=9191201&action=edit "Bug 1675755 - test") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1675755#c29)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/f325221d3fb2>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/7a7b002ee8f9>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1675755#c30)• 4 years ago |
| backout | |

Backed out from ESR78 for compartment assertions.

<https://hg.mozilla.org/releases/mozilla-esr78/rev/504e1d277a99cff0dd9e768d158a6c24a07eeb13>

<https://treeherder.mozilla.org/logviewer?job_id=324975063&repo=mozilla-esr78&lineNumber=8221>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)Flags: needinfo?(sphink)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3908183_359004)• 4 years ago |

Depends on: [1683736](/show_bug.cgi?id=1683736 "RESOLVED FIXED - DebuggerFrame::getThis does not always enter correct Realm")

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a3975739_458186)• 4 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1675755#c31)• 4 years ago |
| uplift | |

Round 2:

<https://hg.mozilla.org/releases/mozilla-esr78/rev/92cd757558a1>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/d83feceb5efb>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)Flags: needinfo?(sphink)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a5833414_537720)• 4 years ago |

Status: RESOLVED → VERIFIED

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a6467251_428608)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main85+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a6468607_428608)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main85+] → [reporter-external] [client-bounty-form] [verif?][adv-main85+][adv-esr78.7+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1675755#c32)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198099)
— [Details](attachment.cgi?id=9198099&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a6551262_428608)• 4 years ago |

Alias: CVE-2021-23960

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a12921812_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1675755#a112423101_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1675755&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


