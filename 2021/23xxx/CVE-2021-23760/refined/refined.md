- **Root cause of vulnerability**: The `keyget` package is vulnerable to prototype pollution via the `set`, `push`, and `at` methods. This stems from an incomplete fix to a previous vulnerability (CVE-2020-28272).
- **Weaknesses/vulnerabilities present**: Prototype pollution vulnerability due to insecure handling of object properties, particularly the `__proto__` attribute in the `set`, `push`, and `at` methods. The vulnerability stems from the ability to inject properties into existing JavaScript language construct prototypes, such as objects.
- **Impact of exploitation**: An attacker can cause a denial of service (DoS), and potentially achieve remote code execution (RCE) and property injection. DoS can occur by altering crucial object properties like `toString` or `valueOf`, leading to exceptions. RCE can occur if the application evaluates a polluted property and executes it (e.g. using eval()). Property injection can allow attackers to modify application behavior, such as gaining admin privileges.
- **Attack vectors**: The attacker manipulates properties through the `set`, `push`, and `at` methods, by controlling the path to set values, and utilizing the `__proto__` property to modify the prototype of the base object.
- **Required attacker capabilities/position**: The attacker needs to be able to pass crafted input to the vulnerable methods (`set`, `push`, `at`), controlling the "path" value to inject properties into the `__proto__`. No special privileges or user interaction are required for the attack. The attacker may be an external client providing malicious input to an application using the vulnerable package.