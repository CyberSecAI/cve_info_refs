=== Content from github.com_d32d3507_20250115_092253.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Fsecurity%2Fadvisories%2FGHSA-vv2x-vrpj-qqpq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Fsecurity%2Fadvisories%2FGHSA-vv2x-vrpj-qqpq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mozilla%2Fbleach)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mozilla](/mozilla)
/
**[bleach](/mozilla/bleach)**
Public

* [Notifications](/login?return_to=%2Fmozilla%2Fbleach) You must be signed in to change notification settings
* [Fork
  249](/login?return_to=%2Fmozilla%2Fbleach)
* [Star
   2.7k](/login?return_to=%2Fmozilla%2Fbleach)

* [Code](/mozilla/bleach)
* [Issues
  3](/mozilla/bleach/issues)
* [Pull requests
  1](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

Additional navigation options

* [Code](/mozilla/bleach)
* [Issues](/mozilla/bleach/issues)
* [Pull requests](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

# mutation XSS via allowed math or svg; p or br; and style, title, noscript, script, textarea, noframes, iframe, or xmp tags with strip\_comments=False

Moderate

[g-k](/g-k)
published
GHSA-vv2x-vrpj-qqpq
Feb 1, 2021

## Package

bleach
(python)

## Affected versions

<=3.2.3

## Patched versions

3.3.0

## Description

### Impact

A [mutation XSS](https://cure53.de/fp170.pdf) affects users calling `bleach.clean` with all of:

* `svg` or `math` in the allowed tags
* `p` or `br` in allowed tags
* `style`, `title`, `noscript`, `script`, `textarea`, `noframes`, `iframe`, or `xmp` in allowed tags
* the keyword argument `strip_comments=False`

Note: none of the above tags are in the default allowed tags and `strip_comments` defaults to `True`.

### Patches

Users are encouraged to upgrade to bleach v3.3.0 or greater.

Note: bleach v3.3.0 introduces a breaking change to escape HTML comments by default.

### Workarounds

* modify `bleach.clean` calls to at least one of:

  + not allow the `style`, `title`, `noscript`, `script`, `textarea`, `noframes`, `iframe`, or `xmp` tag
  + not allow `svg` or `math` tags
  + not allow `p` or `br` tags
  + set `strip_comments=True`
* A strong [Content-Security-Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) without `unsafe-inline` and `unsafe-eval` [`script-src`s](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src)) will also help mitigate the risk.

### References

* <https://bugzilla.mozilla.org/show_bug.cgi?id=1689399>
* <https://advisory.checkmarx.net/advisory/CX-2021-4303>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23980>
* <https://cure53.de/fp170.pdf>

### Credits

* Reported by [Yaniv Nizry](https://twitter.com/ynizry) from the CxSCA AppSec group at Checkmarx
* Additional eject tags not mentioned in the original advisory and the CSP mitigation line being truncated in the revised advisory reported by [Michał Bentkowski](https://twitter.com/SecurityMB) at Securitum

### For more information

If you have any questions or comments about this advisory:

* Open an issue at <https://github.com/mozilla/bleach/issues>
* Email us at security@mozilla.org

### Severity

Moderate

### CVE ID

CVE-2021-23980

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.mozilla.org_95a0b911_20250115_092252.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1689399)
* [XML](/show_bug.cgi?ctype=xml&id=1689399)

Closed
[Bug 1689399](/show_bug.cgi?id=1689399)
(CVE-2021-23980)

Opened 4 years ago
Closed 4 years ago

# mXSS in Mozilla-bleach with p tag

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

mXSS in Mozilla-bleach with p tag

## Categories

### (Webtools :: Bleach-security, defect)

[Product:](/describecomponents.cgi?product=Webtools)

Webtools
▾

Webtools
For bugs in the tools that mozilla.org uses, including but not limited to Air Mozilla, Pontoon, and SearchFox.
[See Open Bugs in This Product](/buglist.cgi?product=Webtools&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Webtools)
Watch This Product

[Component:](/describecomponents.cgi?product=Webtools&component=Bleach-security#Bleach-security)

Bleach-security
▾

Webtools :: Bleach-security
Security issues for the bleach Python library
[See Open Bugs in This Component](/buglist.cgi?product=Webtools&component=Bleach-security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Webtools&component=Bleach-security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Webtools&component=Bleach-security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: u581815, Assigned: u581815)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/200a2c1eaf45b53085c2036837da96d3?d=mm&size=40)  [u581815](/user_profile?user_id=581815)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/200a2c1eaf45b53085c2036837da96d3?d=mm&size=40)  [u581815](/user_profile?user_id=581815)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

### ( [URL](https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq "https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[github.com/mozilla/bleach/security/ad...](https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq "https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23980

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a956424_1689 "4 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [claudijd](/user_profile?user_id=552376) | [sec-bounty-hof](#a351882_552376 "4 years ago") | + |
| --- | --- | --- |
| [claudijd](/user_profile?user_id=552376) | sec-bounty-hof | + |
| --- | --- | --- |
|  | qe-verify |  |
| --- | --- | --- |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [link to GH patch PR](/attachment.cgi?id=9200428)  [4 years ago](#c5)  [Greg G](/user_profile?user_id=581815)   119 bytes, text/plain | willkg : [review+](#a348211_424160 "4 years ago") | [Details](/attachment.cgi?id=9200428&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1689399#c0)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1689399&comment_id=15238092 "6 revisions") |
|  | |

Copying a report from Yaniv Nizry (CC'd) to security@:

Hello,

My name is Yaniv Nizry and I’m a security analyst at Checkmarx's CxSCA group.

Checkmarx is a global software security company aiming for the safer usage of code and libraries.

I recently found another mXSS vulnerability in Mozilla-bleach.

**Steps to reproduce:**

1. Have strip\_comments set to False and allow `math/svg`, `p`, and `style` tag.
2. Clean the following: `<math></p><style><!--</style><img src/onerror=alert(1)>
3. Bleach output: `<math><p></p><style><!--</style><img src/onerror=alert(1)>--></style></math>`

```
>>> import bleach
>>> bleach.__version__
'3.2.3'
>>> bleach.clean('<math></p><style><!--</style><img src/onerror=alert(1)>', tags=['math', 'p', 'style'], strip_comments=False)
'<math><p></p><style><!--</style><img src/onerror=alert(1)>--></style></math>'

```

4. After parsing it again in the browser:

```
<html>
  <head></head>
  <body>
    <math></math>
    <p></p>
    <style><!--</style>
    <img src(unknown) onerror="alert(1)">
    "-->
    "
  </body>
</html>

```

**Expected results:**

Alert 1 will pop on the browser.

**Details:**

In HTML the ‘p’ tag (and also ‘br’) are the only tags that will be created with just an end tag (e.g. </p> == <p></p> on the other hand </a> == nothing).

Also, in the math/svg namespace there are tags that stop the namespace and breaks out of the namespace, e.g. (using img as a breaker):

`<svg><img></svg> == <svg><img></svg>`

`<svg><style></svg> == <svg><style></style></svg> ==` style is not a breaker

`<svg><img><style></style></svg> == <svg></svg><img><style></style> ==` the breaker ejects elements that come after.

The parsing issue here is when passing p as an end tag it doesn’t count as a namespace breaker, see how parsing twice will change the output:

```
>>> bleach.clean("<math><p>", tags=["math", "p"])
'<math><p></p></math>'
>>> bleach.clean("<math><p></p></math>", tags=["math", "p"])
'<math></math><p></p>'

```

So going back to our PoC, at first the style tag is in svg/math namespace so the comment is like an html comment, then when parsing again on the browser the p tag breaks the style out of the svg/math namespace changing it to and html namespace style.

Now there is no comment and there is an img tag.

Bugzilla account - <https://bugzilla.mozilla.org/user_profile?user_id=657031>

Feel free to contact us for any questions.

Best regards,

Yaniv

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a21_581815)• 4 years ago |

Flags: sec-bounty?

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1689399#c1)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1689399&comment_id=15238161 "3 revisions") |
|  | |

Confirmed on Python 3.8.6, bleach 3.2.3.

edit: and 3.0.0 and 2.0.0 (going to assume all 2.x and 3.x impacted, also suggests it's not limited to html5lib-1.1)

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1689399#c2)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1689399&comment_id=15238189 "2 revisions") |
|  | |

Confirmed the test output does pop an alert on Fx Nightly on the test website with the following HTML:

```
<html>
  <head></head>
  <body>
    <math></math>
    <p></p>
    <style><!--</style>
    <img src="" onerror="alert(1)">
    -->
  </body>
</html>

```

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a12192_581815)• 4 years ago |

URL: [https://github.com/mozilla/bleach/sec...](https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq)

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1689399#c3)• 4 years ago |
|  | |

Huh, so bleach doesn't close `br` in its output: `<svg><br><style><!--</style><img src/onerror=alert(1)>--></style></svg>`

and Nightly parses it as:

```
<html>
  <head></head>
  <body>
    <svg></svg>
    <br>
    <style><!--</style>
    <img src="" onerror="alert(1)">
    -->
  </body>
</html>

```

which still pops an alert.

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1689399#c4)• 4 years ago |
|  | |

OK I have a patch to escape HTML comments: [https://github.com/mozilla/bleach-ghsa-vv2x-vrpj-qqpq/compare/mozilla:master...mozilla:fix-ghsa-vv2x-vrpj-qqpq?expand=1](https://github.com/mozilla/bleach-ghsa-vv2x-vrpj-qqpq/compare/mozilla%3Amaster...mozilla%3Afix-ghsa-vv2x-vrpj-qqpq?expand=1)

For the test vectors bleach will output:

```
<math><br><style><!--&lt;/style&gt;&lt;img src/onerror=alert(1)&gt;--></style></math>
<svg><br><style><!--&lt;/style&gt;&lt;img src/onerror=alert(1)&gt;--></style></svg>
<math><p></p><style><!--&lt;/style&gt;&lt;img src/onerror=alert(1)&gt;--></style></math>
<svg><p></p><style><!--&lt;/style&gt;&lt;img src/onerror=alert(1)&gt;--></style></svg>

```

and Nightly parses the comment in the style tag now:

```
<html>
  <head></head>
  <body>
    <math></math>
    <br>
    <style>
      <!--&lt;/style&gt;&lt;img src/onerror=alert(1)&gt;-->
    </style>
  </body>
</html>

```

Planning to get the patch reviewed and landed early next week.

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1689399#c5)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1689399&comment_id=15243475 "1 revision") |
|  | |

Attached file
[link to GH patch PR](attachment.cgi?id=9200428)
— [Details](attachment.cgi?id=9200428&action=edit)

:willkg can you review [the patch](https://github.com/mozilla/bleach-ghsa-vv2x-vrpj-qqpq/compare/mozilla%3Amaster...mozilla%3Afix-ghsa-vv2x-vrpj-qqpq?expand=1) and [advisory](https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq)?

Flags: needinfo?(willkg)
[Attachment #9200428](/attachment.cgi?id=9200428&action=edit "link to GH patch PR") -
Flags: review?(willkg)

|  | [Will Kahn-Greene [:willkg] ET needinfo? me](/user_profile?user_id=424160) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1689399#c6)• 4 years ago |
|  | |

Greg: Can you create a PR with that patch? If not, I can probably figure out how to review it as is, but it'll be harder.

Flags: needinfo?(willkg) → needinfo?(gguthe)

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1689399#c7)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1689399&comment_id=15243513 "1 revision") |
|  | |

(In reply to Will Kahn-Greene [:willkg] ET needinfo? me from [comment #6](/show_bug.cgi?id=1689399#c6 "RESOLVED FIXED - mXSS in Mozilla-bleach with p tag"))

> Greg: Can you create a PR with that patch? If not, I can probably figure out how to review it as is, but it'll be harder.

Yep: <https://github.com/mozilla/bleach-ghsa-vv2x-vrpj-qqpq/pull/1>

I didn't want to open it earlier than necessary since it makes the issue public (or maybe not, but I wasn't sure).

Flags: needinfo?(gguthe) → needinfo?(willkg)

|  | [Will Kahn-Greene [:willkg] ET needinfo? me](/user_profile?user_id=424160) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1689399#c8)• 4 years ago |
|  | |

I reviewed the PR on GitHub. Looks good! I think the advisory looks good, too. Nice job!

Flags: needinfo?(willkg)

|  | [Will Kahn-Greene [:willkg] ET needinfo? me](/user_profile?user_id=424160) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a348211_424160)• 4 years ago |

[Attachment #9200428](/attachment.cgi?id=9200428&action=edit "link to GH patch PR") -
Flags: review?(willkg) → review+

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1689399#c9)• 4 years ago |
|  | |

<https://pypi.org/project/bleach/3.3.0/> is published along with the advisory <https://github.com/mozilla/bleach/security/advisories/GHSA-vv2x-vrpj-qqpq>

Thanks for your help Will and thanks again for your research and well written report Yaniv.

Status: NEW → RESOLVEDClosed: 4 years agoResolution: --- → FIXED

|  | [Jonathan Claudius [:claudijd] (use NEEDINFO)](/user_profile?user_id=552376) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a351882_552376)• 4 years ago |

Flags: sec-bounty-hof+

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1689399#c10)• 4 years ago |
|  | |

Confirmed with :peterbe that MDN is not using bleach as of Dec. 2020 and AMO is not using the relevant args at either bleach call site:

* <https://github.com/mozilla/addons-server/blob/e61d8b0de79cb601d181099f9341d4bbfa396871/src/olympia/translations/models.py#L170-L188>
* <https://github.com/mozilla/addons-server/blob/cebc412f7fb9a7e280fdf04c3eff732b03887ff9/src/olympia/translations/templatetags/jinja_helpers.py#L110-L113>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a956424_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [Yaniv Nizry](/user_profile?user_id=657031) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1689399#c11)• 4 years ago |
|  | |

Thank you for the quick fix and the advisory,

are we planning to add a CVE on this issue?

Best regards,

Yaniv

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a2243961_581815)• 4 years ago |

Group: webtools-security

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1689399#c12)• 4 years ago |
|  | |

Assigning CVE; Greg could you please add it to to the GH Advisory?

Alias: CVE-2021-23980Flags: needinfo?(gguthe)

|  | [Greg G](/user_profile?user_id=581815)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1689399#c13)• 4 years ago |
|  | |

Yep, added the CVE to the GH Advisory

Flags: needinfo?(gguthe)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1689399#a105238867_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1689399&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Greg G](/user_profile?user_id=581815)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


