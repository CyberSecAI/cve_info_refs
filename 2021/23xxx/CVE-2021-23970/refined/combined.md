=== Content from security.gentoo.org_bed394fc_20250114_191404.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202104-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-78.10.0"

```

All Mozilla Firefox ESR binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-78.10.0"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-88.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-88.0"

```
### References

* [CVE-2021-23961](https://nvd.nist.gov/vuln/detail/CVE-2021-23961)
* [CVE-2021-23968](https://nvd.nist.gov/vuln/detail/CVE-2021-23968)
* [CVE-2021-23969](https://nvd.nist.gov/vuln/detail/CVE-2021-23969)
* [CVE-2021-23970](https://nvd.nist.gov/vuln/detail/CVE-2021-23970)
* [CVE-2021-23971](https://nvd.nist.gov/vuln/detail/CVE-2021-23971)
* [CVE-2021-23972](https://nvd.nist.gov/vuln/detail/CVE-2021-23972)
* [CVE-2021-23973](https://nvd.nist.gov/vuln/detail/CVE-2021-23973)
* [CVE-2021-23974](https://nvd.nist.gov/vuln/detail/CVE-2021-23974)
* [CVE-2021-23975](https://nvd.nist.gov/vuln/detail/CVE-2021-23975)
* [CVE-2021-23976](https://nvd.nist.gov/vuln/detail/CVE-2021-23976)
* [CVE-2021-23977](https://nvd.nist.gov/vuln/detail/CVE-2021-23977)
* [CVE-2021-23978](https://nvd.nist.gov/vuln/detail/CVE-2021-23978)
* [CVE-2021-23981](https://nvd.nist.gov/vuln/detail/CVE-2021-23981)
* [CVE-2021-23982](https://nvd.nist.gov/vuln/detail/CVE-2021-23982)
* [CVE-2021-23983](https://nvd.nist.gov/vuln/detail/CVE-2021-23983)
* [CVE-2021-23984](https://nvd.nist.gov/vuln/detail/CVE-2021-23984)
* [CVE-2021-23985](https://nvd.nist.gov/vuln/detail/CVE-2021-23985)
* [CVE-2021-23986](https://nvd.nist.gov/vuln/detail/CVE-2021-23986)
* [CVE-2021-23987](https://nvd.nist.gov/vuln/detail/CVE-2021-23987)
* [CVE-2021-23988](https://nvd.nist.gov/vuln/detail/CVE-2021-23988)
* [CVE-2021-23994](https://nvd.nist.gov/vuln/detail/CVE-2021-23994)
* [CVE-2021-23995](https://nvd.nist.gov/vuln/detail/CVE-2021-23995)
* [CVE-2021-23998](https://nvd.nist.gov/vuln/detail/CVE-2021-23998)
* [CVE-2021-23999](https://nvd.nist.gov/vuln/detail/CVE-2021-23999)
* [CVE-2021-24002](https://nvd.nist.gov/vuln/detail/CVE-2021-24002)
* [CVE-2021-29945](https://nvd.nist.gov/vuln/detail/CVE-2021-29945)
* [CVE-2021-29946](https://nvd.nist.gov/vuln/detail/CVE-2021-29946)
* [MFSA-2021-08](https://www.mozilla.org/en-US/security/advisories/mfsa2021-08/)
* [MFSA-2021-11](https://www.mozilla.org/en-US/security/advisories/mfsa2021-11/)
* [MFSA-2021-15](https://www.mozilla.org/en-US/security/advisories/mfsa2021-15/)

**Release date**

April 30, 2021

**Latest revision**

April 30, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [772305](https://bugs.gentoo.org/show_bug.cgi?id=772305)
* [778269](https://bugs.gentoo.org/show_bug.cgi?id=778269)
* [784572](https://bugs.gentoo.org/show_bug.cgi?id=784572)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_823f068c_20250114_191403.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1681724)
* [XML](/show_bug.cgi?ctype=xml&id=1681724)

Closed
[Bug 1681724](/show_bug.cgi?id=1681724)
(CVE-2021-23970)

Opened 4 years ago
Closed 4 years ago

# Multithreaded Wasm hits compartment mismatch crash with Warp changes

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Multithreaded Wasm hits compartment mismatch crash with Warp changes

## Categories

### (Core :: JavaScript: WebAssembly, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20WebAssembly#JavaScript%3A%20WebAssembly)

JavaScript: WebAssembly
▾

Core :: JavaScript: WebAssembly
Implementation of the WebAssembly (wasm) standard, including compilation and runtime support.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20WebAssembly)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox85 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix) |
| firefox86 | [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified) |
| firefox87 | [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox85 |  | wontfix |
| firefox86 | + | verified |
| firefox87 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jryans, Assigned: lth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/07d963875f2649f1be70d286f5164fb4?d=mm&size=40)  [lth](/user_profile?user_id=499633)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da74cfd81f892e34f7e3926f2c56f908?d=mm&size=40)  [jryans](/user_profile?user_id=282978)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8db6b22eadf9c098ae78e6d0d0615e29?d=mm&size=40)  [rhunt](/user_profile?user_id=573202)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### (Regression, [URL](https://github.com/jryans/wasm-warp-compartment-mismatch "https://github.com/jryans/wasm-warp-compartment-mismatch") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1660862](/show_bug.cgi?id=1660862 "RESOLVED FIXED - Warp: GuardSpecificFunction captures stale function flags for lazy Wasm stubs")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[github.com/jryans/wasm-warp-compartme...](https://github.com/jryans/wasm-warp-compartment-mismatch "https://github.com/jryans/wasm-warp-compartment-mismatch")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, regression, sec-high, Whiteboard: [adv-main86+][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23970

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main86+][sec-survey]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1681724 - Shared provisional stub. r?jandem](/attachment.cgi?id=9196058)  [4 years ago](#c9)  [Lars T Hansen [:lth]](/user_profile?user_id=499633)   48 bytes, text/x-phabricator-request | jandem : [feedback+](#c19 "4 years ago")  pascalc : [approval-mozilla-beta+](#c32 "4 years ago")  tjr : [sec-approval+](#c25 "4 years ago") | [Details](/attachment.cgi?id=9196058&action=edit) | [Review](/attachment.cgi?id=9196058) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9204117)  [4 years ago](#c36)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   227 bytes, text/plain |  | [Details](/attachment.cgi?id=9204117&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [J. Ryan Stinnett [:jryans] (Use needinfo, replies may be slow)](/user_profile?user_id=282978)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1681724#c0)• 4 years ago |
|  | |

## Summary

A multithreaded Wasm project I am working on has started crashing in recent Firefox versions with a compartment mismatch. `mozregression` identified [bug 1660862](/show_bug.cgi?id=1660862 "RESOLVED FIXED - Warp: GuardSpecificFunction captures stale function flags for lazy Wasm stubs") (<https://hg.mozilla.org/integration/autoland/rev/4d530fda38c294549a80f51db315c9279fdbec77>) as the cause.

## STR

1. Clone the demo repo at <https://github.com/jryans/wasm-warp-compartment-mismatch>
2. `yarn install` (to get a local HTTP server with COOP / COEP headers)
3. `yarn serve`
4. Go to <http://localhost:5000>
5. Wait ~10s for the large Wasm blob to download
6. Crash (reproduces every time)

## Notes

* Opening the browser DevTools somehow prevents the crash (perhaps because the debugger sets the JIT down a different path)

## Crash reports

* <https://crash-stats.mozilla.org/report/index/490a9c3a-53a9-464f-835c-ca7ef0201210>
* <https://crash-stats.mozilla.org/report/index/2fb6a7f8-941e-4574-800c-bc0da0201210>
* <https://crash-stats.mozilla.org/report/index/b7111bdd-e17e-4f03-a329-a06280201210>
* <https://crash-stats.mozilla.org/report/index/f86abc5f-ebb1-4e9d-9c4a-429c30201210>
* <https://crash-stats.mozilla.org/report/index/ba14e939-4ebf-4aa9-9d86-a8cd20201210>
* <https://crash-stats.mozilla.org/report/index/605f946a-437e-4cba-872d-214ee0201210>

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a7853_375297)• 4 years ago |

Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1681724#c1)• 4 years ago |
|  | |

Lars, is it possible Wasm export functions are incorrectly exposed to other Wasm threads? Can you help clarify the threading situation here?

Flags: needinfo?(jdemooij) → needinfo?(lhansen)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1681724#c2)• 4 years ago |
|  | |

(In reply to Jan de Mooij [:jandem] from [comment #1](/show_bug.cgi?id=1681724#c1 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"))

> Lars, is it possible Wasm export functions are incorrectly exposed to other Wasm threads? Can you help clarify the threading situation here?

We are supposed to be sharing code and metadata (because we share the module) but not function objects - those must all be private to the instance, and the instance is private to the thread.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1681724#c3)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1681724&comment_id=15181092 "1 revision") |
|  | |

I'll take a look, possibly related to [bug 1667984](/show_bug.cgi?id=1667984 "RESOLVED FIXED - Clean up locking and documentation around lazy stubs and the jump table"). Won't have time until January.

Assignee: nobody → lhansenGroup: core-securitySeverity: -- → S3Status: NEW → ASSIGNEDComponent: JavaScript Engine: JIT → Javascript: WebAssemblyFlags: needinfo?(lhansen)Priority: -- → P2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a1052043_406194)• 4 years ago |

Group: core-security → javascript-core-securityKeywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)Summary: Multithreaded Wasm hits component mismatch crash with Warp changes → Multithreaded Wasm hits compartment mismatch crash with Warp changes

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1681724#c4)• 4 years ago |
|  | |

In a local Linux debug build:

Assertion failure: cx\_ == cx, at /home/lhansen/m-u/js/src/threading/ProtectedData.cpp:57:

```
#0  0x00007fffee74c5cc in js::CheckContextLocal::check() const (this=0x7fffa80b9838)
    at /home/lhansen/m-u/js/src/threading/ProtectedData.cpp:57
#1  0x00007fffee58566c in js::ProtectedData<js::CheckContextLocal, bool>::ref() const (this=0x7fffa80b9830)
    at /home/lhansen/m-u/js/src/threading/ProtectedData.h:149
#2  0x00007fffee585625 in js::ProtectedData<js::CheckContextLocal, bool>::operator bool const&() const (this=0x7fffa80b9830)
    at /home/lhansen/m-u/js/src/threading/ProtectedData.h:93
#3  0x00007fffee57f61e in JSContext::isExceptionPending() const (this=0x7fffa80b9000) at /home/lhansen/m-u/js/src/vm/JSContext.h:784
#4  0x00007fffee57d9ad in CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::CallReason, JS::CallArgs const&) (cx=0x7fffa80b9000, native=0x7fffefb1a420 <WasmCall(JSContext*, unsigned int, JS::Value*)>, reason=js::CallReason::Call, args=...)
    at /home/lhansen/m-u/js/src/vm/Interpreter.cpp:497
#5  0x00007fffee56a1d0 in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)
    (cx=0x7fffa80b9000, args=..., construct=js::NO_CONSTRUCT, reason=js::CallReason::Call)
    at /home/lhansen/m-u/js/src/vm/Interpreter.cpp:594
#6  0x00007fffee56a98f in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason)
    (cx=0x7fffa80b9000, args=..., reason=js::CallReason::Call) at /home/lhansen/m-u/js/src/vm/Interpreter.cpp:647
#7  0x00007fffee56aa37 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) (cx=0x7fffa80b9000, fval=..., thisv=..., args=..., rval=..., reason=js::CallReason::Call)
    at /home/lhansen/m-u/js/src/vm/Interpreter.cpp:664
#8  0x00007fffef444b64 in js::jit::InvokeFunction(JSContext*, JS::Handle<JSObject*>, bool, bool, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) (cx=0x7fffa80b9000, obj=..., constructing=false, ignoresReturnValue=false, argc=2, argv=0x7fffa66e5540, rval=...)
    at /home/lhansen/m-u/js/src/jit/VMFunctions.cpp:753
#9  0x00007fffef444e77 in js::jit::InvokeFromInterpreterStub(JSContext*, js::jit::InterpreterStubExitFrameLayout*)
    (cx=0x7fffa80b9000, frame=0x7fffa66e5518) at /home/lhansen/m-u/js/src/jit/VMFunctions.cpp:773
#10 0x0000273bc98fb6af in  ()
#11 0x0000381669c9d420 in  ()
#12 0x00007fffa66e5518 in  ()
...
#104 0xfff8800000ca79f0 in  ()
#105 0x00007fffa0feb000 in  ()
#106 0x00007fffefb1ff2c in js::WasmTableObject::get(JSContext*, unsigned int, JS::Value*) (cx=0x2, argc=14358, vp=0x3042)
    at /home/lhansen/m-u/js/src/wasm/WasmJS.cpp:2862

```

(The end of the stack doesn't make a ton of sense.)

Another crash I've seen is this, no more info so far:

```
Assertion failure: *stack == reinterpret_cast<Rooted<detail::RootListEntry*>*>(this), at /home/lhansen/m-u/obj-x86_64-pc-linux-gnu/dist/include/js/RootingAPI.h:1134

```

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1681724#c5)• 4 years ago |
|  | |

My preliminary analysis is that the patch cited in [comment 0](/show_bug.cgi?id=1681724#c0 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") is wrong (specifically line 3.19) because it patches context-specific code into what is, and should be, a shared jump table, and this is wrong. The change I landed afterwards was really not correct either, it just papers over the race problems we ran into with the original patch.

I need to read the code more in depth to be sure, because this is tricky territory; hope to get to that tomorrow.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1681724#c6)• 4 years ago |
|  | |

"The change I landed afterwards" was in [bug 1666568](/show_bug.cgi?id=1666568 "RESOLVED FIXED - WebAssembly threads crash on release assert for CurrentThreadCanAccessZone") and amounts to replacing the setJitEntry in Jan's patch with something that is thread-aware: <https://hg.mozilla.org/integration/autoland/rev/6a81d2da051d9870405d833303567112ccd17e85>

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1681724#c7)• 4 years ago |
|  | |

(In reply to Lars T Hansen [:lth] from [comment #5](/show_bug.cgi?id=1681724#c5 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"))

> My preliminary analysis is that the patch cited in [comment 0](/show_bug.cgi?id=1681724#c0 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") is wrong (specifically line 3.19) because it patches context-specific code into what is, and should be, a shared jump table, and this is wrong. The change I landed afterwards was really not correct either, it just papers over the race problems we ran into with the original patch.
>
> I need to read the code more in depth to be sure, because this is tricky territory; hope to get to that tomorrow.

Specifically, code emitted by generateInterpreterStub computes the context as masm.loadJSContext(), which is defined as

```
  movePtr(ImmPtr(GetJitContext()->runtime->mainContextPtr()), dest);

```

which is almost certainly inappropriate for code shared across threads. For wasm, the correct behavior here is to load the JSContext\* from the wasm tls instead.

This more or less suggests that we could clone getInterpreterStub for wasm with code that gets the context correctly and that this might work with current code, and might not even need my patch, since the code that's patched in would be context-invariant and if we overwrite anything we would be overwriting with the same value.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1681724#c8)• 4 years ago |
|  | |

Ryan, is this program supposed to do something, if it doesn't crash?

Flags: needinfo?(jryans)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1681724#c9)• 4 years ago |
|  | |

Attached file
[Bug 1681724 - Shared provisional stub. r?jandem](attachment.cgi?id=9196058)
— [Details](attachment.cgi?id=9196058&action=edit)

Use a context-agnostic interpreterStub for wasm, so as to allow the

stub to be referenced from a table that's shared between threads.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1681724#c10)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

How about something like this? The patch isn't completely clean yet, I'd want to update the commentary and maybe look for ways of sharing code, and then there's also the question about whether the JS interpreter stub could not be using this code too.

This sits on top of both of the previous fixes: yours to fix Ian's crash and enable better perf, and mine, which is still necessary to avoid the stub->null transition that bit us before. That suggests that there's more work to be done here to clean up how we handle these stubs, but I guess we knew that.

(I also need to check that this does not regress perf again, I guess there's a risk since there's now a different stub address.)

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: feedback?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1681724#c11)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

This makes sense, but the trampoline's JIT code will be thrown out when the JSContext/thread goes away. Is that guaranteed to outlive the callers of the trampoline? The trampoline is being called from other JS threads after all...

Flags: needinfo?(lhansen)
[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: feedback?(jdemooij) → feedback+

|  | [J. Ryan Stinnett [:jryans] (Use needinfo, replies may be slow)](/user_profile?user_id=282978)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1681724#c12)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1681724&comment_id=15210997 "1 revision") |
|  | |

(In reply to Lars T Hansen [:lth] from [comment #8](/show_bug.cgi?id=1681724#c8 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"))

> Ryan, is this program supposed to do something, if it doesn't crash?

It's an early attempt at running [Seshat](https://github.com/matrix-org/seshat) (a Matrix message index for searching) in the browser. At the moment, it does not do much beyond printing a few "Seshat" prefixed messages to the console, but it's possible you might not even see those, as it seems to trigger other Firefox-specific Wasm issues related to too many threads allocating too many `WebAssembly.Instance`s.

I guess that's a long way of saying it might have further unrelated issues, so for the purposes of this bug, as long as it doesn't crash, that seems like success to me. (Sorry it's not the easiest test case to work with... I wasn't sure which parts were necessary to trigger the problem.)

Flags: needinfo?(jryans)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1681724#c13)• 4 years ago |
|  | |

(In reply to Jan de Mooij [:jandem] from [comment #11](/show_bug.cgi?id=1681724#c11 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"))

> Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")
>
> [Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Use a different stub for Wasm.
>
> This makes sense, but the trampoline's JIT code will be thrown out when the JSContext/thread goes away. Is that guaranteed to outlive the callers of the trampoline? The trampoline is being called from other JS threads after all...

Ouch. The module can be sent on a message channel to other contexts in the same agent cluster, and the originating context can go away after that while the module lives on. The trampoline must have a lifetime at least as long as the module's, ideally it's allocated with the module I guess. Maybe that's the trick we're looking for.

Flags: needinfo?(lhansen)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a3126925_406194)• 4 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1681724#c14)• 4 years ago |
|  | |

A wrinkle here is that the work Dmitry is doing on speeding up indirect calls in wasm may want less code to be shared across instances (because the code will bake in the context pointer). I think what I'll do here is find a fix for the current problem quickly, but any larger redesign we'll defer until the consequences of Dmitry's work become clearer.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1681724#c15)• 4 years ago |
|  | |

I think we'll manage code for this trampoline the same way we manage code for builtin thunks: create at startup, destroy at shutdown, everyone shares the same trampoline.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1681724#c16)• 4 years ago |
|  | |

... except, masm.failureLabel() is jumped to if C++ returns an error code, and the code at failureLabel is not context-unaware at all, and is indeed platform-specific, and can't be generated until later (requires a JitRuntime, which we don't have when we generate context-unaware code). I guess this code can possibly be further parameterized by the JSContext\* which might be returned as the error signal from our modified stub (why not?) but there's quite some surgery required.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1681724#c17)• 4 years ago |
|  | |

After chatting with Jan, we're going to try plan B: we generate a stub that calls out to C++ to look up the context-specific interpreter stub and return it, and then we tailcall (jump to) that stub. This is in a sense nicer than what we have already because it is a local change, it does not depend on setting up the callout stackframe partly in machine code and partly in C++.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1681724#c18)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

This should be a lot better, it has sensible storage management and delays looking up the context's interpreter stub until the last moment. With this patch, we could possibly undo my previous change that prevented overwriting a non-null entry in the table, but there's further cleanup to do (in other bugs), so that can wait.

A couple things I still don't like here:

* there's a messy construction of the masm in the generator function in WasmBuiltins.cpp for reasons documented there, I'd like to perhaps do something cleaner if there are options (discuss)
* ditto another cleanup item in that file flagged as TODO
* construction of the context-agnostic stub is being ensured at the latest possible moment, just before we install it in the table (or check it with an assertion); i would like to perhaps move this earlier, but I haven't found a good choke point yet, as not all modules are compiled (they can be deserialized from cache).
[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: feedback+ → feedback?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1681724#c19)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

The approach makes sense to me.

I agree the Wasm-stub-generator is messy. What if we generate this code in `wasm::GenerateStubs` instead? That already emits the throw-stub and a bunch of other things so this one would be a relative small addition there...

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: feedback?(jdemooij) → feedback+

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1681724#c20)• 4 years ago |
|  | |

Memo to self: do I properly understand the semantics of the stubs jump tables, eg, is there any risk that anything is serialized? Because if so, then the stub must indeed be per-module. (This code is very tricky and everyone who knew it well have been laid off or have left. More thought needed.)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a4739478_499633)• 4 years ago |

Priority: P2 → P1

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a4739896_580382)• 4 years ago |

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1681724#c21)• 4 years ago |
|  | |

There's rather a lot of documentation now in a patch on [bug 1667984](/show_bug.cgi?id=1667984 "RESOLVED FIXED - Clean up locking and documentation around lazy stubs and the jump table") (it's still a little WIP, I don't understand eager stubs yet, but that is not important here). In regards to the present bug:

* what we're looking for here is what's called the "provisional jit-entry" in that documentation and the "context-agnostic interpreter stub" in my WIP patch on this bug
* the jit-entry stubs belong to a module (indeed to a code tier), but they are not going to be serialized with their module and could be created standalone as in my WIP patch here or with the module as Jan suggests; all we care is that there's sharing at least within the module so that we only need to generate one, not one per function. There's possibly a slight advantage for a future improvement I'm thinking about for the stub to be shared globally but really I don't think it'll matter in practice.
* both Jan's earlier patch *and* my later improvements to that are necessary for correctness: it is only correct - in the sense of what we intend to have happen - to install the provisional jit-entry if the jit-entry table element is null. If we install it unconditionally then - due to sharing - we racily downgrade a stub. While it may be that that would work, or technically, it would never fail, there are side tables containing stubs that are used to check whether stubs need to be recompiled, for example, and it's probably an intended invariant on those tables that they don't hold stubs that aren't present in the table.

So what I'll do here is try to clean up my patch by moving the code generation into the Module to generate with the other stubs, and then put it up for review again; I want this landed for FF88, and the window is closing, esp wrt sec-review and all that.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1681724#c22)• 4 years ago |
|  | |

(In reply to Jan de Mooij [:jandem] from [comment #19](/show_bug.cgi?id=1681724#c19 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"))

> Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")
>
> I agree the Wasm-stub-generator is messy. What if we generate this code in `wasm::GenerateStubs` instead? That already emits the throw-stub and a bunch of other things so this one would be a relative small addition there...

Yes, and the resulting patch is very clean. Unfortunately it doesn't work (at least not so far) because the generated code bakes in a pointer to C++ (since it needs to call C++) and the code can therefore not be serialized. But if the code is generated with the stubs, it will need to be serialized with the module. Generating it with the builtins solves this problems (since they all have this problem).

Two avenues: Either clean up the existing WIP patch, or try to separate out the initialization code for this one stub while remaining in WasmStubs.cpp. I'll try the latter before I give up and revert to the former.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a4912855_600971)• 4 years ago |

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Attachment description: Bug 1681724 - Use a different stub for Wasm. → Bug 1681724 - Better provisional jit-entry stub for Wasm r?jandem

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1681724#c23)• 4 years ago |
|  | |

Ended up cleaning the current WIP patch significantly, I think the result is pretty clean and could likely be uplifted with little risk if we miss the merge window.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1681724#c24)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Probably hard, we found this because we hit a run-time check in a release build. Even if such checks could be bypassed it's unclear how an exploit would be built.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: FF79 and later
* **If not all supported branches, which bug introduced the flaw?**: Latent problem resulting from enabling SharedArrayBuffer
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I expect a backport to FF85, FF86 would be straightforward
* **How likely is this patch to cause regressions; how much testing does it need?**: Not likely to cause regressions, because it modifies existing logic only slightly.
[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1681724#c25)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

Approved to land and request uplift from Relman.

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: sec-approval? → sec-approval+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a5246673_600971)• 4 years ago |

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Attachment description: Bug 1681724 - Better provisional jit-entry stub for Wasm r?jandem → Bug 1681724 - Shared provisional stub. r?jandem

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1681724#c26)• 4 years ago |
|  | |

Current patch grafts onto beta with no conflicts, I'll file an uplift request when we know the patch has stuck to Nightly.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1681724#c27)• 4 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/71b724bd06812b3e3ca99ac21ca0f941374da358>

Backed out for causing failure at WasmJS.cpp in non-unified builds:

<https://hg.mozilla.org/integration/autoland/rev/a92708095b70aa615871e33dc73fe9dcb5d98bac>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=71b724bd06812b3e3ca99ac21ca0f941374da358>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=329319408&repo=autoland>

/builds/worker/checkouts/gecko/js/src/wasm/WasmJS.cpp:1986:14: error: use of undeclared identifier 'EnsureBuiltinThunksInitialized'; did you mean 'EnsureHelperThreadsInitialized'?

/builds/worker/checkouts/gecko/js/src/wasm/WasmJS.cpp:1989:41: error: use of undeclared identifier 'ProvisionalJitEntryStub'

Flags: needinfo?(lhansen)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1681724#c28)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1681724&comment_id=15256243 "1 revision") |
|  | |

Missing include file for nonunified builds.

Flags: needinfo?(lhansen)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1681724#c29)• 4 years ago |
|  | |

Shared provisional stub. r=jandem

<https://hg.mozilla.org/integration/autoland/rev/d0eef4ce1d433bfa2ce0ef3cb5bdb451e5327a03>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1681724#c30)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d0eef4ce1d43>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 87 Branch

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1681724#c31)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

### Beta/Release Uplift Approval Request

* **User impact if declined**: Some functionality loss (multi-threaded webassembly) due to crashes or compartment errors; slight risk of security exploit. Sec-approval requested uplift.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See [comment 0](/show_bug.cgi?id=1681724#c0 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") on this bug
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch tweaks existing logic only slightly.
* **String changes made/needed**:
[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: approval-mozilla-beta?

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a5334871_499633)• 4 years ago |

Flags: qe-verify+

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a5350652_458186)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1681724#c32)• 4 years ago |
|  | |

Comment on [attachment 9196058](/attachment.cgi?id=9196058 "Bug 1681724 - Shared provisional stub. r?jandem") [[details]](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem")

[Bug 1681724](/show_bug.cgi?id=1681724 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes") - Shared provisional stub. r?jandem

Approved for out last beta, thanks.

[Attachment #9196058](/attachment.cgi?id=9196058&action=edit "Bug 1681724 - Shared provisional stub. r?jandem") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1681724#c33)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1681724) to reply.

Flags: needinfo?(lhansen)Whiteboard: [sec-survey]

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a5375770_499633)• 4 years ago |

Flags: needinfo?(lhansen)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1681724#c34)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/05df9a13e075>

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)
[tracking-firefox86](/buglist.cgi?f1=cf_tracking_firefox86&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B)
[tracking-firefox87](/buglist.cgi?f1=cf_tracking_firefox87&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1681724#c35)• 4 years ago |
|  | |

I was able to reproduce this bug on macOS 10.15, by using the steps from [comment 0](/show_bug.cgi?id=1681724#c0 "VERIFIED FIXED - Multithreaded Wasm hits compartment mismatch crash with Warp changes"), on an affected Nightly build 2020-12-10.

The crash doesn't reproduce anymore on latest Nightly 87 and Beta 86.0b9 (downloaded from treeherder). I've tested this on macOS 10.15, Win 10 x64 and Ubuntu 18 x64.

Status: RESOLVED → VERIFIED
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a6016357_578488)• 4 years ago |

Whiteboard: [sec-survey] → [adv-main86+][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1681724#c36)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9204117)
— [Details](attachment.cgi?id=9204117&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a6100623_578488)• 4 years ago |

Alias: CVE-2021-23970

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a30044228_1689)• 3 years ago |

Group: core-security-release

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1681724#a30044228_546015)• 3 years ago |

Has Regression Range: --- → yes
You need to [log in](/show_bug.cgi?id=1681724&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Lars T Hansen [:lth]](/user_profile?user_id=499633)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_833258de_20250114_191406.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-07

## Security Vulnerabilities fixed in Firefox 86

Announced
February 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 86

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If that’s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Firefox incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23970: Multithreaded WASM triggered assertions validating separation of script domains](#CVE-2021-23970)

Reporter
J. Ryan Stinnett
Impact
high
##### Description

Context-specific code was included in a shared jump table; resulting in assertions being triggered in multithreaded wasm code.

##### References

* [Bug 1681724](https://bugzilla.mozilla.org/show_bug.cgi?id=1681724)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23974: noscript elements could have led to an HTML Sanitizer bypass](#CVE-2021-23974)

Reporter
Masato Kinugawa and Michał Bentkowski
Impact
moderate
##### Description

The DOMParser API did not properly process `<noscript>` elements for escaping. This could be used as an mXSS vector to bypass an HTML Sanitizer.

##### References

* [Bug 1528997, 1683627](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1528997%2C1683627)

#### [#CVE-2021-23971: A website's Referrer-Policy could have been be overridden, potentially resulting in the full URL being sent as a Referrer](#CVE-2021-23971)

Reporter
Luca Moretto
Impact
moderate
##### Description

When processing a redirect with a conflicting Referrer-Policy, Firefox would have adopted the redirect's Referrer-Policy. This would have potentially resulted in more information than intended by the original origin being provided to the destination of the redirect.

##### References

* [Bug 1678545](https://bugzilla.mozilla.org/show_bug.cgi?id=1678545)

#### [#CVE-2021-23976: Local spoofing of web manifests for arbitrary pages in Firefox for Android](#CVE-2021-23976)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When accepting a malicious intent from other installed apps, Firefox for Android accepted manifests from arbitrary file paths and allowed declaring webapp manifests for other origins. This could be used to gain fullscreen access for UI spoofing and could also lead to cross-origin attacks on targeted websites.
*Note: This issue is a different issue from CVE-2020-26954 and only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684627](https://bugzilla.mozilla.org/show_bug.cgi?id=1684627)

#### [#CVE-2021-23977: Malicious application could read sensitive data from Firefox for Android's application directories](#CVE-2021-23977)

Reporter
fatal0
Impact
moderate
##### Description

Firefox for Android suffered from a time-of-check-time-of-use vulnerability that allowed a malicious application to read sensitive data from application directories.
*Note: This issue is only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684761](https://bugzilla.mozilla.org/show_bug.cgi?id=1684761)

#### [#CVE-2021-23972: HTTP Auth phishing warning was omitted when a redirect is cached](#CVE-2021-23972)

Reporter
Vijay Tikudave
Impact
low
##### Description

One phishing tactic on the web is to provide a link with HTTP Auth. For example `https://www.phishingtarget.com@evil.com`. To mitigate this type of attack, Firefox will display a warning dialog; however, this warning dialog would not have been displayed if evil.com used a redirect that was cached by the browser.

##### References

* [Bug 1683536](https://bugzilla.mozilla.org/show_bug.cgi?id=1683536)

#### [#CVE-2021-23975: about:memory Measure function caused an incorrect pointer operation](#CVE-2021-23975)

Reporter
Brian Carpenter of Geeknik Labs & Farm
Impact
low
##### Description

The developer page about:memory has a Measure function for exploring what object types the browser has allocated and their sizes. When this function was invoked we incorrectly called the sizeof function, instead of using the API method that checks for invalid pointers.

##### References

* [Bug 1685145](https://bugzilla.mozilla.org/show_bug.cgi?id=1685145)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](#CVE-2021-23978)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Firefox 85 and Firefox ESR 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

#### [#CVE-2021-23979: Memory safety bugs fixed in Firefox 86](#CVE-2021-23979)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Tyson Smith, Lars T Hansen, Valentin Gosu, and Sebastian Hengst reported memory safety bugs present in Firefox 85. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663222%2C1666607%2C1672120%2C1678463%2C1678927%2C1679560%2C1681297%2C1681684%2C1683490%2C1684377%2C1684902)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


