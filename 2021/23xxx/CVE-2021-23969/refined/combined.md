=== Content from security.gentoo.org_bed394fc_20250114_204334.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities â€” GLSA **202104-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-78.10.0"

```

All Mozilla Firefox ESR binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-78.10.0"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-88.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-88.0"

```
### References

* [CVE-2021-23961](https://nvd.nist.gov/vuln/detail/CVE-2021-23961)
* [CVE-2021-23968](https://nvd.nist.gov/vuln/detail/CVE-2021-23968)
* [CVE-2021-23969](https://nvd.nist.gov/vuln/detail/CVE-2021-23969)
* [CVE-2021-23970](https://nvd.nist.gov/vuln/detail/CVE-2021-23970)
* [CVE-2021-23971](https://nvd.nist.gov/vuln/detail/CVE-2021-23971)
* [CVE-2021-23972](https://nvd.nist.gov/vuln/detail/CVE-2021-23972)
* [CVE-2021-23973](https://nvd.nist.gov/vuln/detail/CVE-2021-23973)
* [CVE-2021-23974](https://nvd.nist.gov/vuln/detail/CVE-2021-23974)
* [CVE-2021-23975](https://nvd.nist.gov/vuln/detail/CVE-2021-23975)
* [CVE-2021-23976](https://nvd.nist.gov/vuln/detail/CVE-2021-23976)
* [CVE-2021-23977](https://nvd.nist.gov/vuln/detail/CVE-2021-23977)
* [CVE-2021-23978](https://nvd.nist.gov/vuln/detail/CVE-2021-23978)
* [CVE-2021-23981](https://nvd.nist.gov/vuln/detail/CVE-2021-23981)
* [CVE-2021-23982](https://nvd.nist.gov/vuln/detail/CVE-2021-23982)
* [CVE-2021-23983](https://nvd.nist.gov/vuln/detail/CVE-2021-23983)
* [CVE-2021-23984](https://nvd.nist.gov/vuln/detail/CVE-2021-23984)
* [CVE-2021-23985](https://nvd.nist.gov/vuln/detail/CVE-2021-23985)
* [CVE-2021-23986](https://nvd.nist.gov/vuln/detail/CVE-2021-23986)
* [CVE-2021-23987](https://nvd.nist.gov/vuln/detail/CVE-2021-23987)
* [CVE-2021-23988](https://nvd.nist.gov/vuln/detail/CVE-2021-23988)
* [CVE-2021-23994](https://nvd.nist.gov/vuln/detail/CVE-2021-23994)
* [CVE-2021-23995](https://nvd.nist.gov/vuln/detail/CVE-2021-23995)
* [CVE-2021-23998](https://nvd.nist.gov/vuln/detail/CVE-2021-23998)
* [CVE-2021-23999](https://nvd.nist.gov/vuln/detail/CVE-2021-23999)
* [CVE-2021-24002](https://nvd.nist.gov/vuln/detail/CVE-2021-24002)
* [CVE-2021-29945](https://nvd.nist.gov/vuln/detail/CVE-2021-29945)
* [CVE-2021-29946](https://nvd.nist.gov/vuln/detail/CVE-2021-29946)
* [MFSA-2021-08](https://www.mozilla.org/en-US/security/advisories/mfsa2021-08/)
* [MFSA-2021-11](https://www.mozilla.org/en-US/security/advisories/mfsa2021-11/)
* [MFSA-2021-15](https://www.mozilla.org/en-US/security/advisories/mfsa2021-15/)

**Release date**

April 30, 2021

**Latest revision**

April 30, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [772305](https://bugs.gentoo.org/show_bug.cgi?id=772305)
* [778269](https://bugs.gentoo.org/show_bug.cgi?id=778269)
* [784572](https://bugs.gentoo.org/show_bug.cgi?id=784572)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_8532e50e_20250114_204336.html ===


---

[[Date Prev](msg00046.html)][[Date Next](msg00048.html)]
[[Thread Prev](msg00046.html)][[Thread Next](msg00048.html)]
[[Date Index](maillist.html#00047)]
[[Thread Index](threads.html#00047)]

# [SECURITY] [DSA 4866-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4866-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 28 Feb 2021 18:49:00 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20210228184900.GA31464%40seger.debian.org)Â [20210228184900.GA31464@seger.debian.org](msg00047.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4866-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
February 28, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2021-23968 CVE-2021-23969 CVE-2021-23973 CVE-2021-23978

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code or information disclosure.

For the stable distribution (buster), these problems have been fixed in
version 1:78.8.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmA75UwACgkQEMKTtsN8
TjblXA//VLhNTEUc0MPpviqVVtz5j5PXXzgGwvIM0nY36VYamyRUOzJOKNdVAZ5j
NhZEp0VvsviYK74by350YiZ+873vRDVwDa2JD9Uqmoi8LBVkmZ0Wnt2eFDki32m9
BxJUhPd8mHMonHcQvLPO7A2RIf9QAWyJl8XcgP2W4ZM3dmN+1rCkqp2Tl0378x5J
fLeNitBY0xFfb7u3Qdfm3BGR/G7auDiypZdQopvGyvOSBn5lfNevolKM/ckyoiQ1
sPL1r9vyA9C2GG0rhUzxN0leJ2jC8mtfbSXUVl0UWTqg65iEBh1GzuPei1BN5vZd
Cto2Mc5xD71BlwAFQJRNXQJw47itW6aFXc+IbNwwydsDtPyO7Bls0/xGaTz9M7RY
jCsOY121cF29uAJwm/EF0VJpwL/vJfq2Kp1QSaMo9lPwcqOX5SOxlrc8YsTr3VG4
lmdFVgZetrHP7B3uidUIuvLa1w64ZE8oSoiTjg5nTFqpSPvBRDT5z49MIkVmICkq
JIobJlBd0KEY0GrSUHvZ64qPoKndo1TjFzVOgdlTvaMJEX6WzgjHGIwAhDhXEZtl
BkM27KW1v2DFGsyOurSTBwyJKoM2myAdxSmDCCVGLqsz1sJN9dT//CXX4YYu3tfU
zGVnTLyDB1m/Dp2V0C7GZnJXA2D8Kav9TePXhKRaNgKE7vH2/3g=
=Fb9o
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_1040bdd2_20250114_204338.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-09

## Security Vulnerabilities fixed in Thunderbird 78.8

Announced
February 23, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.8

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If thatâ€™s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Thunderbird incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Thunderbird 78.8](#CVE-2021-23978)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Thunderbird 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_9dd35175_20250114_204337.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-08

## Security Vulnerabilities fixed in Firefox ESR 78.8

Announced
February 23, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.8

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If thatâ€™s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Firefox incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](#CVE-2021-23978)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Firefox 85 and Firefox ESR 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_fd3fc426_20250114_204333.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 2578-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2578-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 1 Mar 2021 15:44:10 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20210301144410.E35C92A0372%40andromeda)Â [20210301144410.E35C92A0372@andromeda](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2578-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
March 01, 2021                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:78.8.0-1~deb9u1
CVE ID         : CVE-2021-23968 CVE-2021-23969 CVE-2021-23973 CVE-2021-23978

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code or information disclosure.

For Debian 9 stretch, these problems have been fixed in version
1:78.8.0-1~deb9u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmA8/boACgkQnUbEiOQ2
gwJgChAA0dN0xW3qfut3qo5Po1VS7s1CxF5fnmDhDcEXnbajd51q8YQ5qpRalrZ9
oo4oZJwFvc45xKYxVUt4CG+LBXa3+3FcbIjdJPlwPYNpDLzQULDenVv8jQBEMcTr
rk7BAkmqUkWzRPj7NT+oZ4RuAXNJH3krCGkxhlJkmLV+Qb8Z6BHwDodZdw60olvp
Bg3gDc/cxSNQibRiY1Yw7K/w32xWXB+4I/mlQc43IvZ6agRjdpZryVa8jRm4lfBX
Ppx1oy8z10IINk9Ekw1/VkfFqCOn51MTPF8pjzLZGTv8PdcOUWROMkc7IJje+6Qn
MDUiWB++yZgsJbDYZRPgzWke0N0wHYPtYiaNGeQdmDdE3bPPnuYikdU3wBY17v+d
JdnFxFvKs86FaCquqB8ySJNaNnpxv8C0DzP/EdyzDXAqeyA6uzoPfi1E8jeAb85p
1q23QPtCdWYPNsL1pPOLq7bb9grRbgNu96A1JgUaBV+9AB5iicAtpfqjSlQmsrvz
F/cIMt8+v682yrqAIxa0769HBdm0OnzYMZsmuonXxie3kGa1X8XH4U4ERkD8E1TG
fluoBoJGvS3jnWevKXvIAP8v53pH44SnKD/+9Vz27ODnvfpQB7g/p+TRwNULFYY2
JjGr8aZ2d9RAC8ojjl0msnQ8KShFuHp0giU5/hfRXJWx3URy4QQ=
=Ydkk
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_de03d8ab_20250114_204334.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple vulnerabilities â€” GLSA **202104-09**

Multiple vulnerabilities have been found in Mozilla Thunderbird,
the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **78.10.0** |
| Unaffected versions | >= **78.10.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **78.10.0** |
| Unaffected versions | >= **78.10.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the
Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird.
Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-78.10.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-78.10.0"

```
### References

* [CVE-2021-23961](https://nvd.nist.gov/vuln/detail/CVE-2021-23961)
* [CVE-2021-23968](https://nvd.nist.gov/vuln/detail/CVE-2021-23968)
* [CVE-2021-23969](https://nvd.nist.gov/vuln/detail/CVE-2021-23969)
* [CVE-2021-23973](https://nvd.nist.gov/vuln/detail/CVE-2021-23973)
* [CVE-2021-23978](https://nvd.nist.gov/vuln/detail/CVE-2021-23978)
* [CVE-2021-23981](https://nvd.nist.gov/vuln/detail/CVE-2021-23981)
* [CVE-2021-23982](https://nvd.nist.gov/vuln/detail/CVE-2021-23982)
* [CVE-2021-23984](https://nvd.nist.gov/vuln/detail/CVE-2021-23984)
* [CVE-2021-23987](https://nvd.nist.gov/vuln/detail/CVE-2021-23987)
* [CVE-2021-23994](https://nvd.nist.gov/vuln/detail/CVE-2021-23994)
* [CVE-2021-23995](https://nvd.nist.gov/vuln/detail/CVE-2021-23995)
* [CVE-2021-23998](https://nvd.nist.gov/vuln/detail/CVE-2021-23998)
* [CVE-2021-23999](https://nvd.nist.gov/vuln/detail/CVE-2021-23999)
* [CVE-2021-24002](https://nvd.nist.gov/vuln/detail/CVE-2021-24002)
* [CVE-2021-29945](https://nvd.nist.gov/vuln/detail/CVE-2021-29945)
* [CVE-2021-29946](https://nvd.nist.gov/vuln/detail/CVE-2021-29946)
* [CVE-2021-29948](https://nvd.nist.gov/vuln/detail/CVE-2021-29948)
* [MFSA-2021-09](https://www.mozilla.org/en-US/security/advisories/mfsa2021-09/)
* [MFSA-2021-12](https://www.mozilla.org/en-US/security/advisories/mfsa2021-12/)
* [MFSA-2021-14](https://www.mozilla.org/en-US/security/advisories/mfsa2021-14/)

**Release date**

April 30, 2021

**Latest revision**

April 30, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [772287](https://bugs.gentoo.org/show_bug.cgi?id=772287)
* [778272](https://bugs.gentoo.org/show_bug.cgi?id=778272)
* [784578](https://bugs.gentoo.org/show_bug.cgi?id=784578)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_833258de_20250114_204337.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-07

## Security Vulnerabilities fixed in Firefox 86

Announced
February 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 86

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If thatâ€™s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Firefox incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23970: Multithreaded WASM triggered assertions validating separation of script domains](#CVE-2021-23970)

Reporter
J. Ryan Stinnett
Impact
high
##### Description

Context-specific code was included in a shared jump table; resulting in assertions being triggered in multithreaded wasm code.

##### References

* [Bug 1681724](https://bugzilla.mozilla.org/show_bug.cgi?id=1681724)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23974: noscript elements could have led to an HTML Sanitizer bypass](#CVE-2021-23974)

Reporter
Masato Kinugawa and MichaÅ‚ Bentkowski
Impact
moderate
##### Description

The DOMParser API did not properly process `<noscript>` elements for escaping. This could be used as an mXSS vector to bypass an HTML Sanitizer.

##### References

* [Bug 1528997, 1683627](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1528997%2C1683627)

#### [#CVE-2021-23971: A website's Referrer-Policy could have been be overridden, potentially resulting in the full URL being sent as a Referrer](#CVE-2021-23971)

Reporter
Luca Moretto
Impact
moderate
##### Description

When processing a redirect with a conflicting Referrer-Policy, Firefox would have adopted the redirect's Referrer-Policy. This would have potentially resulted in more information than intended by the original origin being provided to the destination of the redirect.

##### References

* [Bug 1678545](https://bugzilla.mozilla.org/show_bug.cgi?id=1678545)

#### [#CVE-2021-23976: Local spoofing of web manifests for arbitrary pages in Firefox for Android](#CVE-2021-23976)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When accepting a malicious intent from other installed apps, Firefox for Android accepted manifests from arbitrary file paths and allowed declaring webapp manifests for other origins. This could be used to gain fullscreen access for UI spoofing and could also lead to cross-origin attacks on targeted websites.
*Note: This issue is a different issue from CVE-2020-26954 and only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684627](https://bugzilla.mozilla.org/show_bug.cgi?id=1684627)

#### [#CVE-2021-23977: Malicious application could read sensitive data from Firefox for Android's application directories](#CVE-2021-23977)

Reporter
fatal0
Impact
moderate
##### Description

Firefox for Android suffered from a time-of-check-time-of-use vulnerability that allowed a malicious application to read sensitive data from application directories.
*Note: This issue is only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684761](https://bugzilla.mozilla.org/show_bug.cgi?id=1684761)

#### [#CVE-2021-23972: HTTP Auth phishing warning was omitted when a redirect is cached](#CVE-2021-23972)

Reporter
Vijay Tikudave
Impact
low
##### Description

One phishing tactic on the web is to provide a link with HTTP Auth. For example `https://www.phishingtarget.com@evil.com`. To mitigate this type of attack, Firefox will display a warning dialog; however, this warning dialog would not have been displayed if evil.com used a redirect that was cached by the browser.

##### References

* [Bug 1683536](https://bugzilla.mozilla.org/show_bug.cgi?id=1683536)

#### [#CVE-2021-23975: about:memory Measure function caused an incorrect pointer operation](#CVE-2021-23975)

Reporter
Brian Carpenter of Geeknik Labs & Farm
Impact
low
##### Description

The developer page about:memory has a Measure function for exploring what object types the browser has allocated and their sizes. When this function was invoked we incorrectly called the sizeof function, instead of using the API method that checks for invalid pointers.

##### References

* [Bug 1685145](https://bugzilla.mozilla.org/show_bug.cgi?id=1685145)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](#CVE-2021-23978)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Firefox 85 and Firefox ESR 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

#### [#CVE-2021-23979: Memory safety bugs fixed in Firefox 86](#CVE-2021-23979)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Tyson Smith, Lars T Hansen, Valentin Gosu, and Sebastian Hengst reported memory safety bugs present in Firefox 85. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663222%2C1666607%2C1672120%2C1678463%2C1678927%2C1679560%2C1681297%2C1681684%2C1683490%2C1684377%2C1684902)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_01999a27_20250114_204332.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1542194)
* [XML](/show_bug.cgi?ctype=xml&id=1542194)

Closed
[Bug 1542194](/show_bug.cgi?id=1542194)
(CVE-2021-23969)

Opened 6 years ago
Closed 4 years ago

# CSP violation information contains URL of redirect started from client-side code

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

CSP violation information contains URL of redirect started from client-side code

## Categories

### (Core :: DOM: Security, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
â–¾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

68 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [86+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=86%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified) |
| firefox85 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix) |
| firefox86 | [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified) |
| firefox87 | [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 86+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox85 |  | wontfix |
| firefox86 | + | verified |
| firefox87 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: masatokinugawa, Assigned: ckerschb)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40)  [ckerschb](/user_profile?user_id=363267)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=40)  [masatokinugawa](/user_profile?user_id=393170)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2021-23968](/show_bug.cgi?id=1687342 "VERIFIED FIXED - Firefox leaks full redirect path via CSP violation reports"), [CVE-2023-25728](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)")

## Details

### (Keywords: csectype-sop, reporter-external, sec-high, Whiteboard: [domsecurity-active][sec-survey][adv-main86+][adv-esr78.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23969

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-active][sec-survey][adv-main86+][adv-esr78.8+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a59642127_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | [in-testsuite](#a64024604_580382 "4 years ago") | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios](/attachment.cgi?id=9200038)  [4 years ago](#c7)  [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c13 "4 years ago") | [Details](/attachment.cgi?id=9200038&action=edit) | [Review](/attachment.cgi?id=9200038) |
| --- | --- | --- |
| [Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios](/attachment.cgi?id=9200480)  [4 years ago](#c9)  [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9200480&action=edit) | [Review](/attachment.cgi?id=9200480) |
| [Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects](/attachment.cgi?id=9200481)  [4 years ago](#c10)  [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c22 "4 years ago")  pascalc : [approval-mozilla-esr78+](#c22 "4 years ago")  tjr : [sec-approval+](#c12 "4 years ago") | [Details](/attachment.cgi?id=9200481&action=edit) | [Review](/attachment.cgi?id=9200481) |
| [advisory.txt](/attachment.cgi?id=9204094)  [4 years ago](#c29)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   573 bytes, text/plain |  | [Details](/attachment.cgi?id=9204094&action=edit) |
| [advisory.txt](/attachment.cgi?id=9204120)  [4 years ago](#c30)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   573 bytes, text/plain |  | [Details](/attachment.cgi?id=9204120&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Masato Kinugawa](/user_profile?user_id=393170)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1542194#c0)â€¢ 6 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

1. Navigate to <https://l0.cm/fx_csp_violation_leak.html> . This page has the following CSP and CSP violation event listener:

```
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' vulnerabledoma.in">

```
```
document.addEventListener('securitypolicyviolation', e => {
        console.dir(e);
        alert(e.blockedURI);
    });

```

In addition, there are three buttons to embed other origin's pages into an iframe. These buttons are for testing the following cases.

TEST 1: Navigate to domain not allowed by CSP via 302 redirect

TEST 2: Navigate to domain not allowed by CSP via JavaScript

TEST 3: Navigate to domain not allowed by CSP via link

2. Click on the "TEST 1" button. "<https://vulnerabledoma.in/fx_csp_violation_leak_302.php>" is popped up. (= Safe. I think this behavior comes from a fix of [bug 1069762](/show_bug.cgi?id=1069762 "VERIFIED FIXED - CSP violation report contains sensitive data of other origin after redirect") )
3. Click on the "TEST 2" button. "<https://www.vulnerabledoma.in/path?query>" is popped up. (= leak of redirect URL )
4. Click on the "TEST 3" button and then click on the displayed link. "<https://www.vulnerabledoma.in/path?query>" is popped up. (= leak of redirect URL )

For your information, also the behavior of "TEST 1" is different from other browsers. Other browsers return "<https://www.vulnerabledoma.in>".

Actual results:

The CSP violation event object ( and CSP violation report ) contains the full redirect URL if the violation happens via a client-side navigation.

Expected results:

The CSP violation event object ( and CSP violation report ) should not contain the full redirect URL in the case of navigation started from a client-side code also. This is because the redirect URL might have sensitive information.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a107_159069)â€¢ 6 years ago |

Group: firefox-core-security â†’ dom-core-securityComponent: Untriaged â†’ DOM: SecurityProduct: Firefox â†’ Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1542194#c1)â€¢ 6 years ago |
|  | |

I assume the information sent to report-uri is the same.

We seem to be calling StripURIForReporting() so not sure how these are leaking through.

Actually, though, if we navigate inside the frame, shouldn't it be the frame's CSP that matters, not the parent's? TEST1 is fine either way (maybe we should strip more?) but TEST2 and TEST3 are a different kind of thing. I guess it must be correct because our blocking behavior does do what Chrome does and the reporter expects, it's just the reporting that's wrong.

Baku: you did the violation events -- can you take a look?

Assignee: nobody â†’ amarchesiniStatus: UNCONFIRMED â†’ NEWEver confirmed: trueFlags: needinfo?(amarchesini)Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Priority: -- â†’ P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a973309_1689)â€¢ 6 years ago |

Whiteboard: [domsecurity-active]

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1542194#c2)â€¢ 6 years ago |
|  | |

I don't see where the spec says that we should do more than stripping the URI ref.

ckerschb, do you know more?

Flags: needinfo?(amarchesini) â†’ needinfo?(ckerschb)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1542194#c3)â€¢ 6 years ago |
|  | |

(In reply to Andrea Marchesini [:baku] from [comment #2](/show_bug.cgi?id=1542194#c2 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"))

> I don't see where the spec says that we should do more than stripping the URI ref.
>
> ckerschb, do you know more?

I chatted with Dan, he offered to provide some guidance for this bug - 302 the ni? to him!

Flags: needinfo?(ckerschb) â†’ needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1542194#c4)â€¢ 6 years ago |
|  | |

> I don't see where the spec says that we should do more than stripping the URI ref.

For a URL the page already knows about that's all we need to do.

In other cases <https://w3c.github.io/webappsec-csp/#create-violation-for-global> says

> Note: User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If thatâ€™s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage.

So there are two valid choices: the URL of the frame (as we do in case 1) or "<https://www.vulnerabledoma.in>" stripped to just the origin (as Chrome does in all 3 cases). Given a choice I'd prefer the first option because then the page author at least has some idea where the violation came from, but if necessary the stripped origin is acceptable.

Valid according to the current not-final version of the spec, anyway. I'm not sure I'm happy about that option because it's still leaking an origin. So maybe it's only a small bit of information, but for example imagine a frame that asks the user to log in using their choice of several SSO sites, a violation event could leak which service the user prefers.

If you do try to do the first option make sure to use the src attribute from the iframe element rather than the source URL of the current non-blocked frame document. We have to be careful of the case where a whitelisted frame src A navigates to another whitelisted src B (unknown to the parent page), which then tries to load something C that is blocked -- don't want to report B back to the parent because that leaks knowledge of where the frame navigated. If we report only the origin then B isn't technically worse than C (both leak an origin), but more confusing because B wasn't what got blocked.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a57395399_1689)â€¢ 4 years ago |

See Also: â†’ [CVE-2021-23968](/show_bug.cgi?id=1687342 "VERIFIED FIXED - Firefox leaks full redirect path via CSP violation reports")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1542194#c5)â€¢ 4 years ago |
|  | |

I don't know why I called it sec-moderate -- this can leak highly sensitive cross-origin information like OAuth tokens

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) â†’ [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1542194#c6)â€¢ 4 years ago |
|  | |

Here's what tipped it from moderate to high for me: TEST1 would clearly be `sec-high` if we failed it. TEST3 seems pretty clearly `sec-moderate` because you've loaded an allowed domain and it doesn't leak origin until the user interacts (still bad, but somewhat mitigated!). TEST2 is the tipping point. I think I considered it more like TEST3 originally, but I can imagine scripted "redirects" might be more common on today's script-heavy sites, rather than using a 302.

(In reply to Andrea Marchesini [:baku] from [comment #2](/show_bug.cgi?id=1542194#c2 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"))

> I don't see where the spec says that we should do more than stripping the URI ref.

See step 3 and note of [Â§2.4.2. Create a violation object for request, and policy.](https://www.w3.org/TR/CSP/#create-violation-for-request)

> 3. Set violationâ€™s resource to requestâ€™s url.
>
> Note: We use requestâ€™s url, and not its current url, as the latter might contain information about redirect targets to which the page MUST NOT be given access.

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a57397820_363267)â€¢ 4 years ago |

Assignee: amarchesini â†’ ckerschbStatus: NEW â†’ ASSIGNED

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1542194#c7)â€¢ 4 years ago |
|  | |

Attached file
[Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios](attachment.cgi?id=9200038)
â€” [Details](attachment.cgi?id=9200038&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1542194#c8)â€¢ 4 years ago |
|  | |

Chrome and Safari consistently show the destination origin and strip the path which is wrong; [Â§2.4.2](https://www.w3.org/TR/CSP/#create-violation-for-request) seems pretty clear on the point. This wrongness has gotten baked into the WPT tests. Rather, Near as I can figure the Chrome and Safari behavior was influenced by [$2.4.1](https://www.w3.org/TR/CSP/#create-violation-for-global), which is about ***script*** violations, and is supposed to apply to the reported `source file`, not the reported `resource`. And even then it's in a dodgy note.

> 2. If the user agent is currently executing script, and can extract a source fileâ€™s URL, line number, and column number from the global, set violationâ€™s *source file*, *line number*, and *column number* accordingly.
>
> Note: User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If thatâ€™s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage.

Elsewhere the spec is careful to [forbid comparing whitelisted paths](https://www.w3.org/TR/CSP/#source-list-paths-and-redirects) on redirects because some services redirect logged-in users to their home directory (e.g. facebook.com -> [www.facebook.com/bobbytables](http://www.facebook.com/bobbytables)). But many services are using subdomains for added isolation (e.g. github.io) so it's easy to imagine a redirect that still leaks interesting bits if you follow the Chrome and Safari behavior, e.g. facebook.com -> bobbytables.facebook.com).

In other words

1. Chrome and Safari are not following Â§2.4.2 correctly
2. The WPT test for this is testing for the broken behavior
3. The spec's "if that's not possible" bit in Â§2.4.1 is dangerous and should be reconsidered.
4. **[this bug]** Firefox is also wrong, but in a completely different--and arguably worse--way

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1542194#c9)â€¢ 4 years ago |
|  | |

Attached file
[Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios](attachment.cgi?id=9200480) (obsolete)
â€” [Details](attachment.cgi?id=9200480&action=edit)

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Update blocked-uri in CSP reporting by treating frame naviations as redirects

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a57735128_600971)â€¢ 4 years ago |

[Attachment #9200480](/attachment.cgi?id=9200480&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Attachment is obsolete: true

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1542194#c10)â€¢ 4 years ago |
|  | |

Attached file
[Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects](attachment.cgi?id=9200481)
â€” [Details](attachment.cgi?id=9200481&action=edit)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a57794271_580382)â€¢ 4 years ago |

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=%3F)
[tracking-firefox86](/buglist.cgi?f1=cf_tracking_firefox86&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B)
[tracking-firefox87](/buglist.cgi?f1=cf_tracking_firefox87&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a57794304_580382)â€¢ 4 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=%3F) â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1542194#c11)â€¢ 4 years ago |
|  | |

Comment on [attachment 9200481](/attachment.cgi?id=9200481 "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") [[details]](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects")

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Update blocked-uri in CSP reporting by treating frame naviations as redirects

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: I think it's fairly straight forward for someone familiar with CSP to identify the problem by looking at the patch.

FWIW, this bug (similar to [Bug 1687342](/show_bug.cgi?id=1687342 "VERIFIED FIXED - Firefox leaks full redirect path via CSP violation reports")) was introduced with the CSP reporting mechanism back in the days.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Not very likely, we have automated tests. On a scale from 1-5 it would be 1. Since it really only affects the CSP reporting mechanism.
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: sec-approval?

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58049905_363267)â€¢ 4 years ago |

[Attachment #9200038](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1542194#c12)â€¢ 4 years ago |
|  | |

Comment on [attachment 9200481](/attachment.cgi?id=9200481 "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") [[details]](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects")

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Update blocked-uri in CSP reporting by treating frame naviations as redirects

Approved to land and request uplift from Relman. Test should land after 4/1

[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1542194#c13)â€¢ 4 years ago |
|  | |

Comment on [attachment 9200038](/attachment.cgi?id=9200038 "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") [[details]](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios")

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Test blockedURI in CSP violation events in certain redirect scenarios

Test should land after 4/1

[Attachment #9200038](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Flags: sec-approval? â†’ sec-approval+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58393798_580382)â€¢ 4 years ago |

Flags: in-testsuite?

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1542194#c14)â€¢ 4 years ago |
|  | |

Comment on [attachment 9200481](/attachment.cgi?id=9200481 "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") [[details]](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects")

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Update blocked-uri in CSP reporting by treating frame naviations as redirects

### Beta/Release Uplift Approval Request

* **User impact if declined**: See <https://bugzilla.mozilla.org/show_bug.cgi?id=1542194#c11>
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String changes made/needed**:

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: see <https://bugzilla.mozilla.org/show_bug.cgi?id=1542194#c11>
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String or UUID changes made by this patch**:
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-esr78?
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-beta?

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58425096_363267)â€¢ 4 years ago |

[Attachment #9200038](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Flags: approval-mozilla-beta? approval-mozilla-esr78?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1542194#c15)â€¢ 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/0abd871c49201221e80bbbfb62043219f796d4e5>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1542194#c16)â€¢ 4 years ago |
|  | |

Backed out for xpcshell failures on test\_ext\_contentscript\_triggeringPrincipal.js.

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=0abd871c49201221e80bbbfb62043219f796d4e5&searchStr=xpc&selectedTaskRun=QYs1jWtjSl6OQSWsH6OeYw.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=329396435&repo=autoland>

Backout link: <https://hg.mozilla.org/integration/autoland/rev/f9fe7a3b62048942a935df05d0c246b43ec094cf>

Flags: needinfo?(ckerschb)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1542194#c17)â€¢ 4 years ago |
|  | |

(In reply to Sebastian Hengst [:aryx] (needinfo on intermittent or backout) from [comment #16](/show_bug.cgi?id=1542194#c16 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"))

> Backed out for xpcshell failures on test\_ext\_contentscript\_triggeringPrincipal.js.

Investigating ...

Flags: needinfo?(ckerschb)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1542194#c18)â€¢ 4 years ago |
|  | |

Hey Kris, within this bug we are updating the [value within the `report-uri`](https://phabricator.services.mozilla.com/D103697) for frame navigations and that change causes problems for the test setup within `test_ext_contentscript_triggeringPrincipal.js`.

In particular, the [patch](https://phabricator.services.mozilla.com/D103697) causes us to truncate the blocked-uri to the prePath so the following loads:

* <http://example.com/iframe.html?origin=page&source=contentScript-content-attr-after-inject>
* <http://example.com/iframe.html?origin=page&source=pageScript-attr-after-inject>
* <http://example.com/iframe.html?origin=page&source=pageScript-prop-after-inject>

get truncated to `http://example.com`.

The test setup is massive and a rewrite of the test setup seems complicated. Given that we want to uplift the change, I was wondering what your take is. One option would be to introduce a pref in the code which enforces the new behavior by default but would allow us to flip it explicitly for the test. I personally think that's the best way to go, but wanted to hear your opinion too.

Flags: needinfo?(kmaglione+bmo)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1542194#c19)â€¢ 4 years ago |
|  | |

(In reply to Christoph Kerschbaumer [:ckerschb] from [comment #18](/show_bug.cgi?id=1542194#c18 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"))

> The test setup is massive and a rewrite of the test setup seems complicated. Given that we want to uplift the change, I was wondering what your take is. One option would be to introduce a pref in the code which enforces the new behavior by default but would allow us to flip it explicitly for the test. I personally think that's the best way to go, but wanted to hear your opinion too.

I think that's probably the best option, yeah. It doesn't affect the integrity of the test, and it sounds like the simplest option. In any case, I can't think of anything better.

Flags: needinfo?(kmaglione+bmo)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1542194#c20)â€¢ 4 years ago |
|  | |

Update blocked-uri in CSP reporting by treating frame naviations as redirects r=freddyb,dveditz,mixedpuppy

<https://hg.mozilla.org/integration/autoland/rev/3d8e81530af6a465731c4dbcc9aeb550da18396b>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1542194#c21)â€¢ 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/3d8e81530af6>

Group: dom-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 87 Branch

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58594815_24572)â€¢ 4 years ago |

[Attachment #9200038](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Flags: approval-mozilla-esr78?
[Attachment #9200038](/attachment.cgi?id=9200038&action=edit "Bug 1542194: Test blockedURI in CSP violation events in certain redirect scenarios") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1542194#c22)â€¢ 4 years ago |
|  | |

Comment on [attachment 9200481](/attachment.cgi?id=9200481 "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") [[details]](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects")

[Bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"): Update blocked-uri in CSP reporting by treating frame naviations as redirects

Approved for our last beta, thanks.

[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-esr78?
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-esr78+
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-beta?
[Attachment #9200481](/attachment.cgi?id=9200481&action=edit "Bug 1542194: Update blocked-uri in CSP reporting by treating frame naviations as redirects") -
Flags: approval-mozilla-beta+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1542194#c23)â€¢ 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/d281a4c14c5b>

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58657884_458186)â€¢ 4 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58908814_553429)â€¢ 4 years ago |

QA Whiteboard: [post-critsmash-triage] â†’ [post-critsmash-triage][qa-triaged]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a58914142_580382)â€¢ 4 years ago |

[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- â†’ [86+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=86%2B)

|  | [Timea Cernea [:tbabos][inactive]](/user_profile?user_id=615271) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1542194#c24)â€¢ 4 years ago |
|  | |

Reproduced the issue on affected Firefox Release 85.0.2, "<https://www.vulnerabledoma.in/path?query>" is popped up for Test2 and Test 3.

Verified-fixed on latest Firefox Nightly 87.0a1 (2021-02-15) (64-bit) and Firefox Beta 86.0b9 on Windows 10 x64, MacOS 10.15 and Ubuntu 20.06 with the following results:

* Test1: "<https://vulnerabledoma.in/fx_csp_violation_leak_302.php>" is popped up.
* Test2: "<https://www.vulnerabledoma.in/>" is popped up
* Test3: "<https://www.vulnerabledoma.in/>" is popped up

Waiting for fix to land in ESR for further verification.

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1542194#c25)â€¢ 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/748f749fda1d>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/70b9086b702c>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Timea Cernea [:tbabos][inactive]](/user_profile?user_id=615271) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1542194#c26)â€¢ 4 years ago |
|  | |

Verified-fixed on the latest ESR 78.8.0esr (64-bit)(20210217034806) version on Windows 10 x64 and MacOS 10.15.

Status: RESOLVED â†’ VERIFIEDQA Whiteboard: [post-critsmash-triage][qa-triaged] â†’ [post-critsmash-triage]
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified)Flags: qe-verify+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1542194#c27)â€¢ 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1542194) to reply.

Flags: needinfo?(ckerschb)Whiteboard: [domsecurity-active] â†’ [domsecurity-active][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a59157362_578488)â€¢ 4 years ago |

Whiteboard: [domsecurity-active][sec-survey] â†’ [domsecurity-active][sec-survey][adv-main86+]

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1542194#c28)â€¢ 4 years ago |
|  | |

(In reply to Release mgmt bot [:sylvestre / :calixte / :marco for bugbug] from [comment #27](/show_bug.cgi?id=1542194#c27 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"))

> Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1542194) to reply.

Done!

Flags: needinfo?(ckerschb)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a59226870_578488)â€¢ 4 years ago |

Whiteboard: [domsecurity-active][sec-survey][adv-main86+] â†’ [domsecurity-active][sec-survey][adv-main86+][adv-esr78.8+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1542194#c29)â€¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9204094) (obsolete)
â€” [Details](attachment.cgi?id=9204094&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1542194#c30)â€¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9204120)
â€” [Details](attachment.cgi?id=9204120&action=edit)

[Attachment #9204094](/attachment.cgi?id=9204094&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a59243061_578488)â€¢ 4 years ago |

Alias: CVE-2021-23969

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a59641721_1689)â€¢ 4 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a59642127_1689)â€¢ 4 years ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1542194#c31)â€¢ 4 years ago |
|  | |

Note that we set the bounty flag on this bug; but in general if the flag is not set we may not notice it, so please ask to have the flag set when appropriate.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1542194#c32)â€¢ 4 years ago |
|  | |

Test blockedURI in CSP violation events in certain redirect scenarios r=dveditz,freddyb

<https://hg.mozilla.org/integration/autoland/rev/76d749938fd3>

<https://hg.mozilla.org/mozilla-central/rev/76d749938fd3>

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a64024604_580382)â€¢ 4 years ago |

Flags: in-testsuite? â†’ in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a83186706_1689)â€¢ 3 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a119222413_1689)â€¢ 2 years ago |

See Also: â†’ [CVE-2023-25728](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1542194#a162622122_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1542194&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


