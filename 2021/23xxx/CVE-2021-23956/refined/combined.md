=== Content from www.mozilla.org_7358fcf7_20250114_190138.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-03

## Security Vulnerabilities fixed in Firefox 85

Announced
January 26, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 85

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2021-23955: Clickjacking across tabs through misusing requestPointerLock](#CVE-2021-23955)

Reporter
Irvan Kurniawan
Impact
high
##### Description

The browser could have been confused into transferring a pointer lock state into another tab, which could have lead to clickjacking attacks.

##### References

* [Bug 1684837](https://bugzilla.mozilla.org/show_bug.cgi?id=1684837)

#### [#CVE-2021-23956: File picker dialog could have been used to disclose a complete directory](#CVE-2021-23956)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An ambiguous file picker design could have confused users who intended to select and upload a single file into uploading a whole directory. This was addressed by adding a new prompt.

##### References

* [Bug 1338637](https://bugzilla.mozilla.org/show_bug.cgi?id=1338637)

#### [#CVE-2021-23957: Iframe sandbox could have been bypassed on Android via the intent URL scheme](#CVE-2021-23957)

Reporter
Eliya Stein
Impact
moderate
##### Description

Navigations through the Android-specific `intent` URL scheme could have been misused to escape iframe sandbox.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1584582](https://bugzilla.mozilla.org/show_bug.cgi?id=1584582)

#### [#CVE-2021-23958: Screen sharing permission leaked across tabs](#CVE-2021-23958)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

The browser could have been confused into transferring a screen sharing state into another tab, which would leak unintended information.

##### References

* [Bug 1642747](https://bugzilla.mozilla.org/show_bug.cgi?id=1642747)

#### [#CVE-2021-23959: Cross-Site Scripting in error pages on Firefox for Android](#CVE-2021-23959)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An XSS bug in internal error pages could have led to various spoofing attacks, including other error pages and the address bar.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1659035](https://bugzilla.mozilla.org/show_bug.cgi?id=1659035)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23962: Use-after-poison in "nsTreeBodyFrame::RowCountChanged"](#CVE-2021-23962)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

Incorrect use of the `RowCountChanged` method could have led to a user-after-poison and a potentially exploitable crash.

##### References

* [Bug 1677194](https://bugzilla.mozilla.org/show_bug.cgi?id=1677194)

#### [#CVE-2021-23963: Permission prompt inaccessible after asking for additional permissions](#CVE-2021-23963)

Reporter
Paul Z√ºhlcke
Impact
low
##### Description

When sharing geolocation during an active WebRTC share, Firefox could have reset the webRTC sharing state in the user interface, leading to loss of control over the currently granted permission

##### References

* [Bug 1680793](https://bugzilla.mozilla.org/show_bug.cgi?id=1680793)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Tyson Smith, Jesse Schwartzentruber, Jon Coppeard, Byron Campen, Andr√© Bargull, Steve Fink, Jason Kratzer, Christian Holler, Alexis Beingessner reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

#### [#CVE-2021-23965: Memory safety bugs fixed in Firefox 85](#CVE-2021-23965)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Sebastian Hengst, Christian Holler, Tyson Smith reported memory safety bugs present in Firefox 84. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1670378%2C1673555%2C1676812%2C1678582%2C1684497)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_4879ec46_20250114_190137.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ¬∑
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary‚ñæ

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ‚ñæ

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1338637)
* [XML](/show_bug.cgi?ctype=xml&id=1338637)

Closed
[Bug 1338637](/show_bug.cgi?id=1338637)
(CVE-2021-23956)

Opened 8 years ago
Closed 4 years ago

# Arbitrary local files disclosure in input[webkitdirectory]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Arbitrary local files disclosure in input[webkitdirectory]

## Categories

### (Core :: Widget, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
‚ñæ

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Widget#Widget)

Widget
‚ñæ

Core :: Widget
Cross platform widget interfaces and cross platform base implementations. Bugs that belong in this component are cross-platform problems and [API](http://lxr.mozilla.org/seamonkey/find?string=widget/public/.*idl) issues. Bugs like this that only occur on one platform belong in the appropriate component listed below.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Widget&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Widget&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Widget)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

52 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

85 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox85 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox85 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: qab, Assigned: emz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=40)  [qab](/user_profile?user_id=550582)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/24794cf906e308aee53a5173f6f1ed09?d=mm&size=40)  [spohl](/user_profile?user_id=456485)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### ( [URL](http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/ "http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1678580](/show_bug.cgi?id=1678580 "RESOLVED FIXED - Check file picker result for errors before showing ConfirmFolderUpload prompt")

Dependency [tree](/showdependencytree.cgi?id=1338637&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1338637)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1443762](/show_bug.cgi?id=1443762 "RESOLVED DUPLICATE - Read all local files using minimal user interaction and gesture laundering"), [1660688](/show_bug.cgi?id=1660688 "VERIFIED DUPLICATE - Arbitrary Local Files Access via \"WebkitDirectory\"")

[1519506](/show_bug.cgi?id=1519506 "RESOLVED DUPLICATE - (Mozilla Firefox stealing local files vulnerability ) HTML file input element accepting directories as its input opens ‚ÄúSelect Folder to Upload‚Äù window in a bad way.")

[1719332](/show_bug.cgi?id=1719332 "RESOLVED DUPLICATE - Local file access affecting FIrefox ESR (Vulnerable to CVE-2021-23956)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[leucosite.com/Chrome-Firefox-Edge-Loc...](http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/ "http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main85+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23956

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[stale-bug](/buglist.cgi?keywords=stale-bug&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main85+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c21 "8 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a132262241_578488 "4 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=8836171)  [8 years ago](#c0)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   684 bytes, text/html |  | [Details](/attachment.cgi?id=8836171&action=edit) |
| --- | --- | --- |
| [Bug 1338637 - Ask user for confirmation before folder upload. r=gijs](/attachment.cgi?id=9184809)  [4 years ago](#c26)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9184809&action=edit) | [Review](/attachment.cgi?id=9184809) |
| [Bug 1338637 - Added test for folder upload confirmation prompt. r=gijs](/attachment.cgi?id=9186841)  [4 years ago](#c27)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9186841&action=edit) | [Review](/attachment.cgi?id=9186841) |
| [Bug 1338637 - Updated webkitdirectory test to handle confirm prompts. r=gijs](/attachment.cgi?id=9188304)  [4 years ago](#c30)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9188304&action=edit) | [Review](/attachment.cgi?id=9188304) |
| [advisory.txt](/attachment.cgi?id=9198097)  [4 years ago](#c33)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   215 bytes, text/plain |  | [Details](/attachment.cgi?id=9198097&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198140)  [4 years ago](#c34)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   282 bytes, text/plain |  | [Details](/attachment.cgi?id=9198140&action=edit) |

Show Obsolete

Bottom ‚Üì
Tags ‚ñæ

* Reset

Timeline ‚ñæ

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1338637#c0)‚Ä¢ 8 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=8836171)
‚Äî [Details](attachment.cgi?id=8836171&action=edit)

User Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36
Steps to reproduce:
Note: This was originally part of [Bug 1319370](/show_bug.cgi?id=1319370 "VERIFIED FIXED - webkitdirectory - OS username disclosure") but this turned to be a separate bug deserving of its own report.
1. Open attached PoC
2. Hold down 'enter'
3. If the last used/default folder is 'my documents' (on windows)
4. All the contents of that folder will be accessible without the explicit permission from the user.
( believe it's the case that this works on more folders in non-windows OS
Actual results:
Once a folder upload prompt appears, IFF a user was holding down the 'enter' key the last used directory/default (if they are within 'My Documents' folder or similar) we are able to trick the user into giving us access to all the files in my documents.
Expected results:
The folder upload button should be blurred from.

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1338637#c1)‚Ä¢ 8 years ago |
|  | |

Could you please test on non-windows Os?

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1338637#c2)‚Ä¢ 8 years ago |
| typo | |

| Comment hidden (typo) |  |
| --- | --- |

(In reply to Abdulrahman Alqabandi[test] from [comment #1](/show_bug.cgi?id=1338637#c1 "RESOLVED FIXED - Arbitrary local files disclosure in input[webkitdirectory]"))
> Could you please test on non-windows Os?
opsFlags: needinfo?(amarchesini)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1338637#c3)‚Ä¢ 8 years ago |
|  | |

On linux the default directory is 'Desktop'. I agree we should not put the focus on the 'OK' button.Flags: needinfo?(amarchesini)

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1338637#c4)‚Ä¢ 8 years ago |
|  | |

I was thinking about a workaround if this was fixed by simply blurring the button and I think there is still a way to do it.
We can theoretically predict where the upload button would appear, with the coordinates at hand we can trick the user into clicking an area on the document repeatedly. After the user is recorded clicking a few times we could insert an input element right where the user is clicking, now since the user is clicking on the coordinates where the upload button will appear, the user could potentially be fooled into pressing the upload file button and disclose all files.
So I think the only safe solution here is to completely disable the button and only enable it once a folder has been selected via click or keyboard keys. Alternatively, always default to a un-uploadable pseudo-folder (for a lack of a better word) similar to Windows' "This PC" location. Hope other operating systems have something similar.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a433912_280903)‚Ä¢ 8 years ago |

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a517279_406194)‚Ä¢ 8 years ago |

Group: firefox-core-security ‚Üí core-securityComponent: Untriaged ‚Üí DOMProduct: Firefox ‚Üí Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a517287_406194)‚Ä¢ 8 years ago |

Group: core-security ‚Üí dom-core-security

|  | [Andrew Overholt [:overholt]](/user_profile?user_id=442218) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a526725_442218)‚Ä¢ 8 years ago |

Assignee: nobody ‚Üí amarchesiniPriority: -- ‚Üí P1

|  | [Andrew Overholt [:overholt]](/user_profile?user_id=442218) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1338637#c5)‚Ä¢ 8 years ago |
|  | |

Andrea, please investigate a fix. Thanks.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a1122803_1689)‚Ä¢ 8 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1338637#c6)‚Ä¢ 8 years ago |
|  | |

It looks like this has been posted publicly in <http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/>URL: [http://leucosite.com/Chrome-Firefox-E...](http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1338637#c7)‚Ä¢ 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Andrew McCreight [:mccr8] from [comment #6](/show_bug.cgi?id=1338637#c6 "RESOLVED FIXED - Arbitrary local files disclosure in input[webkitdirectory]"))
> It looks like this has been posted publicly in
> <http://leucosite.com/Chrome-Firefox-Edge-Local-File-Disclosure/>
So much for the bounty then.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a5438104_280903)‚Ä¢ 8 years ago |

Flags: sec-bounty? ‚Üí sec-bounty-

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1338637#c8)‚Ä¢ 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

Abdulrahman, if it isn't clear. Publicly discussing the details of a security bug that we haven't fixed yet is bad form, especially if you never put any disclosure date warnings in communications with us. 90 days, at least, is the industry standard for people that do put such guidelines on disclosure into place. Finding out via twitter and blogs that you've potentially 0dayed users is not cool.

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1338637#c9)‚Ä¢ 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #8](/show_bug.cgi?id=1338637#c8 "RESOLVED FIXED - Arbitrary local files disclosure in input[webkitdirectory]"))
> Abdulrahman, if it isn't clear. Publicly discussing the details of a
> security bug that we haven't fixed yet is bad form, especially if you never
> put any disclosure date warnings in communications with us. 90 days, at
> least, is the industry standard for people that do put such guidelines on
> disclosure into place. Finding out via twitter and blogs that you've
> potentially 0dayed users is not cool.
I don't think this bug is as severe given [Bug 1319370](/show_bug.cgi?id=1319370 "VERIFIED FIXED - webkitdirectory - OS username disclosure") was fixed, the chances of this affecting any Nightly users is low in my opinion, especially since I disclosed publicly. I definitely should have re-read the bug bounty policy, last I read it it mentioned giving at least 60 days for bugs to be fixed, this was removed. Keep in mind I reported this in [Bug 1319370](/show_bug.cgi?id=1319370 "VERIFIED FIXED - webkitdirectory - OS username disclosure") 5 months ago and its been reported here 2 months ago (the 60 I assumed was minimum), so I hope you see I did not have any bad intent just looked like to me I had the right to publicly disclose given everything. Also, I had reported this to Google 8 months and I was eager to write about it.
I will be sure to give you guys a heads up if I ever intend on doing something like this again now that I re-read the policy. Apologies for any inconvenience.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1338637#c10)‚Ä¢ 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

I do not believe our client bounty policy has ever specified 60 days. I'd love for you to show me where it has. Possibly you are confusing Mozilla with Google or someone else. We haven't substantially changed the wording of the security policy recently, having only done minor edits within the last year.
You should not make "assumptions" about a 60 day policy. Mozilla does not have a 60 (or 90 or 120) day disclosure policy and never has. Sometimes reporters come to us and state "I will disclose this bug in x days" and we try to act with this knowledge. We do not have a policy of "If we don't fix this in 60 days, you should tell the world about it in detail." I have no idea why you thought publicly disclosing this was a good idea at all based on anything we've ever said to you. If we had known that you thought that after 60 days, you were ok to just open this up to the world, we might have acted differently. It kind of burns bridges with us to do things like this with ZERO communication on your part to us. Even giving us a heads up would have allowed us to have a discussion with you about your assumptions and ours.
In any case, this bug isn't fixed. It is hidden as a security issue. You just wrote a detailed blog post about it. This isn't about users of our nightly builds. This is about the fact that this is a security issue affecting \*all\* of our users, potentially.
If you wanted to write a post about an unfixed bug, you would be better served to either ask in the bug if we see any issues doing so or emailing us at security@mozilla.org, rather than handing the world a security issue with details when it isn't fixed.
I really don't care when you reported to Google or Microsoft. That is Google and Microsoft's business, not ours. Their policies and responses are not ours.
What I see here is a 60 day old bug that is now public when we're about to ship a release in several days so we can't fix it in time for Firefox 53 without making it an emergency. As a moderate issue about data disclosure, we're not going to do that because the costs are too high and the impacts too great.

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1338637#c11)‚Ä¢ 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

Again, this bug is 5 months old originally reported in [Bug 1319370](/show_bug.cgi?id=1319370 "VERIFIED FIXED - webkitdirectory - OS username disclosure"). But yes I did confuse the 60 day policy thing that came from Google not you. I also was under the impression that Mozilla did not care about public disclosure, all you ask is sufficient time to fix, I believe after 5 months that is sufficient.
From <https://www.mozilla.org/en-US/security/bug-bounty/faq-webapp/> Q&A:
The question is: "If I report the bug directly to you, do I have to keep the bug confidential and not publish information about it in order to receive a reward?"
Mozillas answer: "No. We‚Äôre rewarding you for finding a bug, not trying to buy your silence... "
As I write this I realize this may be only applicable for website flaws but this was not clear to me before.
I'm really surprised by your reaction to this and am sad that you took this as a bridge burner. I hope you reconsider as I have what I think is a good track record (few hickups), there is even an SOP bypass that is 4 months old and I do not plan on publicly disclosing anytime soon and have been more than patient, plenty other bugs in the same situation. My mistake was communication, but I honestly thought you guys were so busy that I did not want to bother about a less severe bug.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1338637#c12)‚Ä¢ 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Abdulrahman Alqabandi from [comment #11](/show_bug.cgi?id=1338637#c11 "RESOLVED FIXED - Arbitrary local files disclosure in input[webkitdirectory]"))
> From <https://www.mozilla.org/en-US/security/bug-bounty/faq-webapp/> Q&A:
That's not the bounty program that covers Firefox or our client software. That's the one for our websites, which is why it says "Web Application" on the top. The client program is at <https://www.mozilla.org/en-US/security/client-bug-bounty/> The text is largely the same but you should be sure you're referring to the appropriate program since details do differ between them.
And, no, we aren't "buying silence" but we also expect people not to 0day users, especially with zero communication with us that they are about to do so.
Perhaps the bounty committee as a whole with disagree with my decision and still pay a bounty on this issue.
> I'm really surprised by your reaction to this and am sad that you took this as a bridge burner. I hope you reconsider as I have what I think is a good track record (few hickups), there is even an SOP bypass that is 4 months old and I do not plan on publicly disclosing anytime soon and have been more than patient, plenty other bugs in the same situation. My mistake was communication, but I honestly thought you guys were so busy that I did not want to bother about a less severe bug.
It isn't a "bridge burner" in the sense that you're out of the bounty program or something. It is in the fact that we pay attention to the behavior and interactions with security researchers and do note which ones work well with us and which ones, for example, post unfixed bugs in public without telling us. You can still continue to work with us. Up until now, you've been fairly well regarded on our team for the work you've done. The relationship isn't irreparably damaged but this was not a good surprise on a Friday morning.
Further discussions should be held by email if necessary at security@mozilla.org.Flags: sec-bounty- ‚Üí sec-bounty?

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1338637#c13)‚Ä¢ 8 years ago |
|  | |

The bug is not in DOM. we should implement something better at a FilePicker widget level.Component: DOM ‚Üí Widget

|  | [Emma Humphries ‚òïÔ∏èüé∏üßû‚Äç‚ôÄÔ∏è‚ú® (she/they) [:emceeaich] (Pacific Time) use needinfo](/user_profile?user_id=554394) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1338637#c14)‚Ä¢ 7 years ago |
|  | |

This is an assigned P1 bug without activity in two weeks.
If you intend to continue working on this bug for the current release/iteration/sprint, remove the 'stale-bug' keyword.
Otherwise we'll reset the priority of the bug back to '--' on Monday, August 28th.Keywords: [stale-bug](/buglist.cgi?keywords=stale-bug&resolution=---)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a16905463_446257)‚Ä¢ 7 years ago |

Assignee: amarchesini ‚Üí nobody

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1338637#c15)‚Ä¢ 7 years ago |
|  | |

Somebody working on widgets should take it.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1338637#c16)‚Ä¢ 7 years ago |
|  | |

Jim, do you know who might be able to work on this?Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a20486535_279663)‚Ä¢ 7 years ago |

Flags: needinfo?(jmathies)Priority: P1 ‚Üí P2

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1338637#c17)‚Ä¢ 7 years ago |
|  | |

I can reproduce. My default was desktop so nothing happened. I think the idea that the user must hold the enter button (triggering repeat) makes this a bit of an outlier. Will find an owner.Status: UNCONFIRMED ‚Üí NEWEver confirmed: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1338637#c19)‚Ä¢ 7 years ago |
|  | |

So unsurprisingly, "some people" are now reporting dupes based on the publicized stuff from qab (also pinned tweet...) as gone over in previous comments. I think we should assume people will try to exploit this if/when convenient to them given it's all public at this point.
Jim, can you please find someone to own this?Flags: needinfo?(jmathies)

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1338637#c20)‚Ä¢ 7 years ago |
|  | |

I am still ashamed for that. My apologies for making things more complicated. FWIW I unpinned the tweet.
Also, Chrome went with showing a dialog before files are uploaded (along with removing focus from OK button in some OS).

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a34727797_279663)‚Ä¢ 7 years ago |

Flags: needinfo?(jmathies)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1338637#c21)‚Ä¢ 7 years ago |
|  | |

This is bad UI that could be improved to reduce the opportunities for social engineering, but it does not meet the severity level for the Bug Bounty program.Group: dom-core-securityFlags: sec-bounty? ‚Üí sec-bounty-

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1338637#c23)‚Ä¢ 4 years ago |
|  | |

Looks like on Windows you can require interaction with the view in the modal dialog before the OK button is enabled by passing `FOS_OKBUTTONNEEDSINTERACTION` (which is listed as one of the relevant options on the doc site, but with no explanation, so I wonder when that got added and on what OSes it's supported...). That seems to wfm on win10.

However, even Edge does not appear to use it; it instead prompts for confirmation before uploading, as does Chrome - with a dialog that then defaults to `[Cancel]` (despite the styling of the dialog buttons suggesting that "Upload" is the default, which is... weird.)

Dan, what do you think about doing the same?

Flags: needinfo?(dveditz)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a116616838_159069)‚Ä¢ 4 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1338637#c25)‚Ä¢ 4 years ago |
|  | |

Paul, do you have cycles to look at adding a confirmation dialog using the tab-modal dialog infrastructure to mimic Edge/Chrome? Looks like somewhere like <https://searchfox.org/mozilla-central/rev/e1d1f043957191616721b9e8bf811c0aab8a203a/dom/html/HTMLInputElement.cpp#483> would work?

Flags: needinfo?(gijskruitbosch+bugs) ‚Üí needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a117242804_636491)‚Ä¢ 4 years ago |

Assignee: nobody ‚Üí pbzStatus: NEW ‚Üí ASSIGNEDFlags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1338637#c26)‚Ä¢ 4 years ago |
|  | |

Attached file
[Bug 1338637 - Ask user for confirmation before folder upload. r=gijs](attachment.cgi?id=9184809)
‚Äî [Details](attachment.cgi?id=9184809&action=edit)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1338637#c27)‚Ä¢ 4 years ago |
|  | |

Attached file
[Bug 1338637 - Added test for folder upload confirmation prompt. r=gijs](attachment.cgi?id=9186841)
‚Äî [Details](attachment.cgi?id=9186841&action=edit)

This also fixes an issue where MockFilePicker wouldn't set the mode correctly,

which caused it to always use "modeOpen". For this test we need to pass

"modeGetFolder" in order for the prompt to show.

Depends on D95324

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1338637#c28)‚Ä¢ 4 years ago |
|  | |

Pushed by pzuhlcke@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/5c29fd30af97>
Ask user for confirmation before folder upload. r=Gijs,geckoview-reviewers,agi,baku
<https://hg.mozilla.org/integration/autoland/rev/5bddcb99f650>
Added test for folder upload confirmation prompt. r=Gijs

|  | [Razvan Maries](/user_profile?user_id=624917) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1338637#c29)‚Ä¢ 4 years ago |
|  | |

Backed out for perma failures.

Push with failure: <https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=LM0CGoNbT1Kf1udXtFq_Nw.0&resultStatus=testfailed%2Cbusted%2Cexception&revision=5bddcb99f650063907888fe944ac6c3cc7e7ba69>

Log: <https://treeherder.mozilla.org/logviewer?job_id=321917169&repo=autoland&lineNumber=5103>

Backout: <https://hg.mozilla.org/integration/autoland/rev/72c8c0774cee0aac6084838f837186f904f7bb52>

Flags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1338637#c30)‚Ä¢ 4 years ago |
|  | |

Attached file
[Bug 1338637 - Updated webkitdirectory test to handle confirm prompts. r=gijs](attachment.cgi?id=9188304)
‚Äî [Details](attachment.cgi?id=9188304&action=edit)

Depends on D96526

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1338637#c31)‚Ä¢ 4 years ago |
|  | |

Pushed by pzuhlcke@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/fa598dea0903>
Ask user for confirmation before folder upload. r=Gijs,geckoview-reviewers,baku
<https://hg.mozilla.org/integration/autoland/rev/9515d8916527>
Added test for folder upload confirmation prompt. r=Gijs
<https://hg.mozilla.org/integration/autoland/rev/7b898a8dac3c>
Updated webkitdirectory test to handle confirm prompts. r=Gijs

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a119030928_636491)‚Ä¢ 4 years ago |

Flags: needinfo?(pbz)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1338637#c32)‚Ä¢ 4 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/fa598dea0903>

<https://hg.mozilla.org/mozilla-central/rev/9515d8916527>

<https://hg.mozilla.org/mozilla-central/rev/7b898a8dac3c>

Status: ASSIGNED ‚Üí RESOLVEDClosed: 4 years ago
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- ‚Üí [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)Resolution: --- ‚Üí FIXEDTarget Milestone: --- ‚Üí 85 Branch

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a119117252_636491)‚Ä¢ 4 years ago |

Blocks: [1678580](/show_bug.cgi?id=1678580 "RESOLVED FIXED - Check file picker result for errors before showing ConfirmFolderUpload prompt")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a124381423_428608)‚Ä¢ 4 years ago |

Whiteboard: [adv-main85+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1338637#c33)‚Ä¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198097) (obsolete)
‚Äî [Details](attachment.cgi?id=9198097&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1338637#c34)‚Ä¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198140)
‚Äî [Details](attachment.cgi?id=9198140&action=edit)

[Attachment #9198097](/attachment.cgi?id=9198097&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a124464629_428608)‚Ä¢ 4 years ago |

Alias: CVE-2021-2395

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a124464656_428608)‚Ä¢ 4 years ago |

Alias: CVE-2021-2395 ‚Üí CVE-2021-23956

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a132262241_578488)‚Ä¢ 4 years ago |

Flags: sec-bounty-hof+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a138854437_1689)‚Ä¢ 4 years ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a138854898_1689)‚Ä¢ 4 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a141163378_75935)‚Ä¢ 3 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338637#a230333280_5898)‚Ä¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1338637&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ‚Üë

## Attachment

Hide Details

### General

Creator:  [Abdulrahman Alqabandi](/user_profile?user_id=550582)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


