- **Root cause of vulnerability**: The `deepMerge` function in the `deepmergefn` package is vulnerable to prototype pollution due to unsafe recursive merging. When merging objects, it does not properly sanitize the input, allowing an attacker to inject properties into the `Object.prototype` by using a `__proto__` property in the source object.
- **Weaknesses/vulnerabilities present**:
    - Unsafe recursive object merging: The `deepMerge` function recursively merges objects without proper validation, allowing an attacker to inject properties into the prototype.
    - Lack of input sanitization: The function does not sanitize the input to prevent the use of `__proto__` or other potentially dangerous properties.
- **Impact of exploitation**:
    - Denial of service (DoS): By modifying the `Object.prototype`, an attacker can cause JavaScript exceptions, leading to a denial of service.
    - Remote code execution (RCE): In some cases, if the codebase evaluates a specific attribute of an object, and then executes that evaluation an attacker could potentially achieve RCE.
    - Property injection: An attacker can pollute properties that the codebase relies on, such as security properties like `isAdmin` to gain privileges or control application behavior.
- **Attack vectors**:
    - By providing a malicious object containing `__proto__` property to the vulnerable `deepMerge` function.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to control the input data that is passed to the `deepMerge` function. The attacker can be external and can exploit this vulnerability over a network.