- **Root cause of vulnerability:** The `prepareDownloadFile` method creates a temporary file with insecure permissions (`-rw-r--r--`) on Unix-like systems. Since the system's temporary directory is shared between users, the content of the downloaded file is readable by all other users on the same system.
- **Weaknesses/vulnerabilities present:** Insecure temporary file creation with overly permissive file permissions, leading to information disclosure.
- **Impact of exploitation:** Unauthorized users on the same system can read the contents of the downloaded file.
- **Attack vectors:** Local access to the system where the vulnerable application is running. An attacker needs to have the ability to read files in the system's shared temporary directory.
- **Required attacker capabilities/position:** The attacker must have local access to the same system where the vulnerable application is running, and must be able to read files in the system's temporary directory. The attacker requires low privileges that allow basic user capabilities to affect settings and files owned by that user.