Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2021-23998:

**Root Cause of Vulnerability:**

The vulnerability stems from how Firefox handles the secure lock icon in the address bar during complex navigations involving new windows and popups. Specifically, an HTTP page could inherit the secure lock icon from an HTTPS page under certain conditions.

**Weaknesses/Vulnerabilities Present:**

*   **Incorrect Security State Handling:** When a new tab is opened via `window.open().document.write(...)` from a popup, the browser doesn't properly update the security state for the new tab. This can result in the new tab inheriting the security state from the previous page (typically a secure HTTPS page) instead of correctly showing the insecure state of an HTTP page.
*   **Optimization Flaw:** The vulnerability is related to an optimization that skips updating the security state for intermediate `about:blank` loads. This optimization was intended to prevent flickering, but in this case, it leads to an incorrect security state being displayed.
*   **Same-Document Navigation Issue:** The browser doesn't send a new `onSecurityChange` event for same-document navigations, which `document.write` triggers. Consequently, the security state doesn't get updated when the new insecure content is loaded.

**Impact of Exploitation:**

*   **Spoofed Secure Lock Icon:** A malicious HTTP page could display a secure lock icon, which would mislead users into believing the site is secure, leading to a **moderate** impact.
*   **Phishing/MITM:** This could be used to facilitate phishing attacks or man-in-the-middle (MITM) attacks. For instance, a malicious party performing a MITM attack on a Wi-Fi network could replace the content for a legitimate HTTP page like `http://accounts.google.com` and trick users into believing it is the real Google accounts page, without the need for a fraudulent certificate. This would lead the user to interact with a fake page believing that it's secure.

**Attack Vectors:**

*   **Complex Navigations:** The attack requires a series of specific navigations using popups and new tabs.
*   **`document.write`:** The attacker uses `window.open().document.write(...)` to write content into a new tab.
*   **HTTP Page:** The attacker needs to open an HTTP page in a new tab that can be made to inherit the security icon from another HTTPS page.

**Required Attacker Capabilities/Position:**

*   **Malicious Website/Page:** The attacker needs to have a malicious web page, that opens a new window.
*   **User Interaction:** While the initial user interaction is opening the popup, further user interaction inside the popup may not be required.
*   **Specific Browser Conditions:** The vulnerability depends on the described browser behavior.

**Additional details:**

*   The bug was fixed by ensuring that the `onLocationChange` event always updates the security state when coming from `about:blank` or by handling a skipped `onSecurityChange` on the following `onLocationChange`.
*   The fix landed in Firefox 88 and was backported to Firefox ESR 78.10.

This information is more detailed than the initial CVE description and highlights the specific conditions and mechanisms involved in the vulnerability.