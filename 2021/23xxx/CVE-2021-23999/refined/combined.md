=== Content from www.mozilla.org_ab358732_20250114_191934.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-16

## Security Vulnerabilities fixed in Firefox 88

Announced
April 19, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 88

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23996: Content rendered outside of webpage viewport](#CVE-2021-23996)

Reporter
Colin D. Munro
Impact
high
##### Description

By utilizing 3D CSS in conjunction with Javascript, content could have been rendered outside the webpage's viewport, resulting in a spoofing attack that could have been used for phishing or other attacks on a user.

##### References

* [Bug 1701834](https://bugzilla.mozilla.org/show_bug.cgi?id=1701834)

#### [#CVE-2021-23997: Use-after-free when freeing fonts from cache](#CVE-2021-23997)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Due to unexpected data type conversions, a use-after-free could have occurred when interacting with the font cache. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1701942](https://bugzilla.mozilla.org/show_bug.cgi?id=1701942)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24000: requestPointerLock() could be applied to a tab different from the visible tab](#CVE-2021-24000)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A race condition with `requestPointerLock()` and `setTimeout()` could have resulted in a user interacting with one tab when they believed they were on a separate tab. In conjunction with certain elements (such as `<input type="file">`) this could have led to an attack where a user was confused about the origin of the webpage and potentially disclosed information they did not intend to.

##### References

* [Bug 1694698](https://bugzilla.mozilla.org/show_bug.cgi?id=1694698)

#### [#CVE-2021-24001: Testing code could have enabled session history manipulations by a compromised content process](#CVE-2021-24001)

Reporter
Andrew McCreight
Impact
moderate
##### Description

A compromised content process could have performed session history manipulations it should not have been able to due to testing infrastructure that was not restricted to testing-only configurations.

##### References

* [Bug 1694727](https://bugzilla.mozilla.org/show_bug.cgi?id=1694727)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29944: HTML injection vulnerability in Firefox for Android's Reader View](#CVE-2021-29944)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Lack of escaping allowed HTML injection when a webpage was viewed in Reader View. While a Content Security Policy prevents direct code execution, HTML injection is still possible.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1697604](https://bugzilla.mozilla.org/show_bug.cgi?id=1697604)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

#### [#CVE-2021-29947: Memory safety bugs fixed in Firefox 88](#CVE-2021-29947)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Ryan VanderMeulen, Sean Feng, Tyson Smith, Julian Seward, Christian Holler reported memory safety bugs present in Firefox 87. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 88](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651449%2C1674142%2C1693476%2C1696886%2C1700091)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_587a6328_20250114_191931.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1691153)
* [XML](/show_bug.cgi?ctype=xml&id=1691153)

Closed
[Bug 1691153](/show_bug.cgi?id=1691153)
(CVE-2021-23999)

Opened 4 years ago
Closed 4 years ago

# Blob URLs loaded by system principal may be given the incorrect principal

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Blob URLs loaded by system principal may be given the incorrect principal

## Categories

### (Core :: DOM: File, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20File#DOM%3A%20File)

DOM: File
▾

Core :: DOM: File
For bugs in the DOM Blob, DOM File and FileSystem APIs
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20File&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20File&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20File)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

88 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox86 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix) |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | --- | [verified](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 88+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox86 |  | wontfix |
| firefox87 |  | wontfix |
| firefox88 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nika, Assigned: edenchuang)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3afcbed8f1748e0ae0da0bc4cabddcaf?d=mm&size=40)  [edenchuang](/user_profile?user_id=516138)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1694903](/show_bug.cgi?id=1694903 "RESOLVED DUPLICATE - Cross-Origin Restrictions Bypass with Blob and Fetch")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [post-critsmash-triage] [qa-triaged][adv-main88+][adv-esr78.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23999

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage] [qa-triaged][adv-main88+][adv-esr78.10+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jcristau](/user_profile?user_id=580382) | [in-testsuite](#a3576162_580382 "4 years ago") | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [poc](/attachment.cgi?id=9201556)  [4 years ago](#c0)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   175 bytes, text/html |  | [Details](/attachment.cgi?id=9201556&action=edit) |
| --- | --- | --- |
| [Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth](/attachment.cgi?id=9206345)  [4 years ago](#c5)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#a4730375_75935 "4 years ago") | [Details](/attachment.cgi?id=9206345&action=edit) | [Review](/attachment.cgi?id=9206345) |
| [Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth](/attachment.cgi?id=9207771)  [4 years ago](#c7)  [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c18 "4 years ago") | [Details](/attachment.cgi?id=9207771&action=edit) | [Review](/attachment.cgi?id=9207771) |
| [advisory.txt](/attachment.cgi?id=9215555)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   261 bytes, text/plain |  | [Details](/attachment.cgi?id=9215555&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1691153#c0)• 4 years ago |
|  | |

Attached file
[poc](attachment.cgi?id=9201556)
— [Details](attachment.cgi?id=9201556&action=edit)

### STR (from a fresh browser)

1. Load the attached proof of concept. A blob URL will appear in the document, copy it to the clipboard.
2. Open a new tab, paste the blob URL in the address bar, and load it

Expected: The blob should load and display the string `undefined`

Actual: The blob loads and displays the string `[object BrowsingContext]`

### Likely Cause

The reason behind this display being different is that the blob URL's document was loaded with the system principal, and thus has privileged access. This is caused by a series of errors in the code which transmits information about Blob URLs to content processes (thanks :asuth for helping me figure out what's going on here!).

1. The code in `ContentParent::TransmitBlobURLsForPrincipal` includes the wrong principal in the `BlobURLRegistrationData` to be sent to the content process. Specifically the registration is created with the principal `aPrincipal`, which is the principal passed to the function, rather than the principal `aBlobPrincipal` which was used to register the blob. (<https://searchfox.org/mozilla-central/rev/400614dec36182ba6d0bec2a18044c47df960a1f/dom/ipc/ContentParent.cpp#6123,6137>). This means that the wrong principal will be transmitted in cases where these principals don't match.
2. The code uses `aPrincipal->Subsumes(aBlobPrincipal)` instead of `->Equals`, meaning it will pass if `aPrincipal` is an expanded or system principal. This combines with the first issue to mean that if `aPrincipal` is the system principal, a registration will be transmitted with the system principal for all registered Blob URLs (<https://searchfox.org/mozilla-central/rev/400614dec36182ba6d0bec2a18044c47df960a1f/dom/ipc/ContentParent.cpp#6126>)
3. When [bug 1626573](/show_bug.cgi?id=1626573 "VERIFIED FIXED - Opening blob links in new tabs doesn't work (doesn't show their content)") was fixed, logic was added to various codepaths which can cause URLs to load from the parent process to try to force blob URLs to be registered in the content process before the load completes. Unfortunately, this code passes `triggeringPrincipal` as the principal to use (<https://searchfox.org/mozilla-central/rev/400614dec36182ba6d0bec2a18044c47df960a1f/docshell/base/BrowsingContext.cpp#1847-1848>, <https://searchfox.org/mozilla-central/rev/400614dec36182ba6d0bec2a18044c47df960a1f/netwerk/ipc/DocumentLoadListener.cpp#1835>), which is the system principal in the case where the load is triggered by browser UI (e.g. through pasting a URL in the address bar). This combines with the previous two bugs to cause us to register blob URLs with the wrong (potentially system) principal.

### Potential Fix

We should fix all 3 of these core issues in order to make sure we transmit the correct blob URLs with the correct principals. The first issue can be fixed by passing `aBlobPrincipal` instead of `aPrincipal` to the various callsites in the function. The second can be fixed by using `->Equals` instead of `->Subsumes`.

The third bug should be fixed by using the actual principal of the relevant blob URL rather than the triggering principal. This should be doable by removing the `aPrincipal` argument from `TransmitBlobDataIfBlobURL`, and instead implementing it as:

```
nsCOMPtr<nsIPrincipal> blobPrincipal;
if (BlobURLProtocolHandler::GetBlobURLPrincipal(aURI, getter_AddRefs(blobPrincipal))) {
  TransmitBlobURLsForPrincipal(blobPrincipal);
}

```
### Exploitability

While this is a serious issue, we are fortunate that it is somewhat tricky to get full system-principal permissions with it. The user has to load the URL in question in a different process than the original page, and the triggering principal must be the system principal (which hopefully requires direct user intervention), such as the user pasting the blob URL into their address bar.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1691153#c1)• 4 years ago |
|  | |

I'm going to try and dig into understanding and enumerating the motivating use cases for the blob URL transmission to make sure we don't regress any current blob URL use cases without intent in addressing points 2 and 3. The highest priority is addressing point 1 of the Likely Causes, as that's the core of the problem and principal confusion, so if 2/3 look like they'll take longer, we should likely focus on addressing point 1.

Assignee: nobody → bugmailStatus: NEW → ASSIGNEDPriority: -- → P1

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1691153#c2)• 4 years ago |
|  | |

Nika provided a pernosco trace on Friday as well: <https://pernos.co/debug/U3Q4v_1wxjdpsFmKDDiyYw/index.html>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a316843_406194)• 4 years ago |

Group: core-security

|  | [Tom Tung [:tt, :ttung]](/user_profile?user_id=552411) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1691153#c3)• 4 years ago |
|  | |

I am going to set the severity to S2 because the workaround doesn't seem to exist but it requires getting system principal which makes this harder to be exploited.

Andrew, please feel free to adjust the severity if you have different thoughts on this.

Severity: -- → S2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a1639400_1689)• 4 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1691153#c5)• 4 years ago |
|  | |

Attached file
[Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth](attachment.cgi?id=9206345)
— [Details](attachment.cgi?id=9206345&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1691153#c6)• 4 years ago |
|  | |

@asuth: started writing a test because of the dupe. Feel free to steal, when you get to this bug .

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a2709412_516138)• 4 years ago |

Assignee: bugmail → echuang

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1691153#c7)• 4 years ago |
|  | |

Attached file
[Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth](attachment.cgi?id=9207771)
— [Details](attachment.cgi?id=9207771&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3337118_600971)• 4 years ago |

[Attachment #9206345](/attachment.cgi?id=9206345&action=edit "Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth") -
Attachment description: Bug 1691153 - wip test → Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1691153#c8)• 4 years ago |
|  | |

Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r=asuth

<https://hg.mozilla.org/integration/autoland/rev/18e47349b0f0e1df159db0446cf5706b864a4f15>

<https://hg.mozilla.org/mozilla-central/rev/18e47349b0f0>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 88 Branch

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3496263_516138)• 4 years ago |

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3498226_575867)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1691153#c9)• 4 years ago |
|  | |

Why was this reopened? There's no backout listed, is the fix not working?

Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1691153#c10)• 4 years ago |
|  | |

Reopen for landing test.

Flags: needinfo?(echuang)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1691153#c11)• 4 years ago |
|  | |

(In reply to Eden Chuang[:edenchuang] from [comment #10](/show_bug.cgi?id=1691153#c10 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal"))

> Reopen for landing test.

But reopening means that the bug's resolution, release tracking fields and target milestone are all wrong, and will make it harder to deal with regressions from this bug, track backouts, track release notes / CVEs, track QA efforts, and so on.

The easier thing to do is either keep the bug closed and just land tests from the closed bug in a few weeks/months time, assuming you don't forget, or file a new security-sensitive bug for the tests and then move the tests to that bug.

Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1691153#c12)• 4 years ago |
|  | |

Mark it as resolved-fixed. Keep ni for test landing.

Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r=asuth

<https://hg.mozilla.org/integration/autoland/rev/18e47349b0f0e1df159db0446cf5706b864a4f15>

<https://hg.mozilla.org/mozilla-central/rev/18e47349b0f0>

Status: REOPENED → RESOLVEDClosed: 4 years ago → 4 years agoResolution: --- → FIXED

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3534153_516138)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed)Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3534170_516138)• 4 years ago |

Flags: needinfo?(echuang)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1691153#c13)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1691153&comment_id=15318006 "1 revision") |
|  | |

mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth

<https://hg.mozilla.org/integration/autoland/rev/bf0c333ee3906ad5fe9a7a86d6dcd390eacb1e39>

<https://hg.mozilla.org/mozilla-central/rev/bf0c333ee390>

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3576162_580382)• 4 years ago |

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=%3F)Flags: in-testsuite+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a3949092_553429)• 4 years ago |

Flags: qe-verify+Whiteboard: [post-critsmash-triage]

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a4094985_516138)• 4 years ago |

Flags: needinfo?(echuang)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1691153#c14)• 4 years ago |
|  | |

It looks like ESR78 may also be affected by this? If so, we'll probably want a rebased patch and an uplift request please :)

Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1691153#c15)• 4 years ago |
|  | |

Sure, will do that.

Flags: needinfo?(echuang)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a4186973_580382)• 4 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1691153#c16)• 4 years ago |
|  | |

Comment on [attachment 9207771](/attachment.cgi?id=9207771 "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth") [[details]](/attachment.cgi?id=9207771&action=edit "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth")

[Bug 1691153](/show_bug.cgi?id=1691153 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal") - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Blob URLs can be loaded with system principal by a very tricky way.
* **User impact if declined**: A malicious webpage can be loaded with a system principal and hack Firefox.
* **Fix Landed on Version**: 88
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch is not risky since it just uses the correct principal to load the blob URL.
* **String or UUID changes made by this patch**: No
[Attachment #9207771](/attachment.cgi?id=9207771&action=edit "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth") -
Flags: approval-mozilla-esr78?

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a4497167_516138)• 4 years ago |

[Attachment #9206345](/attachment.cgi?id=9206345&action=edit "Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth") -
Flags: approval-mozilla-esr78?

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a4696521_458186)• 4 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage] [qa-triaged]

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1691153#c17)• 4 years ago |
|  | |

Reproduced the initial issue with the attached POC on Firefox 87.0.

Confirming that the expected result is met on Firefox 88.0b5, buildID 20210330185720.

Status: RESOLVED → VERIFIED
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=verified)Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1691153#c18)• 4 years ago |
|  | |

Comment on [attachment 9207771](/attachment.cgi?id=9207771 "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth") [[details]](/attachment.cgi?id=9207771&action=edit "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth")

[Bug 1691153](/show_bug.cgi?id=1691153 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal") - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth

Thanks for rebasing. Approved for 78.10esr.

[Attachment #9207771](/attachment.cgi?id=9207771&action=edit "Bug 1691153 - Using the blob's principal for BlobURLRegistrationData creation in ContentParent::TransmitBlobURLsForPrincipal. r?asuth") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a4730375_75935)• 4 years ago |

[Attachment #9206345](/attachment.cgi?id=9206345&action=edit "Bug 1691153 - mochitest for testing Blob URL data is transmitted with correct principal type. r=asuth") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1691153#c19)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/84e39acf7cdf>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/6bed6549f522>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a5760716_578488)• 4 years ago |

Whiteboard: [post-critsmash-triage] [qa-triaged] → [post-critsmash-triage] [qa-triaged][adv-main88+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1691153#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9215555)
— [Details](attachment.cgi?id=9215555&action=edit)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1691153#c21)• 4 years ago |
|  | |

The advisory seems appropriately scoped for the fix that landed (bullet 1 of [comment 0](/show_bug.cgi?id=1691153#c0 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal")), thank you. I'll be spinning off bug(s) for points 2 and 3 this week(end).

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a5840168_578488)• 4 years ago |

Whiteboard: [post-critsmash-triage] [qa-triaged][adv-main88+] → [post-critsmash-triage] [qa-triaged][adv-main88+][adv-esr78.10+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a5996936_428608)• 4 years ago |

Alias: CVE-2021-23999

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1691153#c22)• 3 years ago |
|  | |

(In reply to Andrew Sutherland [:asuth] (he/him) from [comment #21](/show_bug.cgi?id=1691153#c21 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal"))

> The advisory seems appropriately scoped for the fix that landed (bullet 1 of [comment 0](/show_bug.cgi?id=1691153#c0 "VERIFIED FIXED - Blob URLs loaded by system principal may be given the incorrect principal")), thank you. I'll be spinning off bug(s) for points 2 and 3 this week(end).

These other bullets ended up getting addressed by [bug 1719184](/show_bug.cgi?id=1719184 "RESOLVED FIXED - Transmit blob URLs more accurately when loading") which addressed points 2 and 3 by moving the subsumes check to an [equals-ish check based on origin hash](https://searchfox.org/mozilla-central/rev/2e3b0483e31abffe0b4374480a34c6d23f5186ea/dom/ipc/ContentParent.cpp#6050) and ceasing to use the triggering principal as the basis for anything.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1691153#a25085193_1689)• 3 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1691153&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_5dd0f786_20250114_191932.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-14

## Security Vulnerabilities fixed in Thunderbird 78.10

Announced
April 19, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

#### [#CVE-2021-29948: Race condition when reading from disk while verifying signatures](#CVE-2021-29948)

Reporter
Cure53
Impact
low
##### Description

Signatures are written to disk before and read during verification, which might be subject to a race condition when a malicious local process or user is replacing the file.

##### References

* [Bug 1692899](https://bugzilla.mozilla.org/show_bug.cgi?id=1692899)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_756dce1e_20250114_191933.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-15

## Security Vulnerabilities fixed in Firefox ESR 78.10

Announced
April 19, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.10

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


