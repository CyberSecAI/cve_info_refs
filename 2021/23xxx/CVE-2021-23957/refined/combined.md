=== Content from bugzilla.mozilla.org_e45d4cf0_20250114_194143.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1584582)
* [XML](/show_bug.cgi?ctype=xml&id=1584582)

Closed
[Bug 1584582](/show_bug.cgi?id=1584582)
(CVE-2021-23957)

Opened 5 years ago
Closed 4 years ago

# iframe sandboxing bypass on Android via intent: url scheme

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

iframe sandboxing bypass on Android via intent: url scheme

## Categories

### (Fenix :: General, defect, P1)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### (firefox-esr68 wontfix, firefox84 wontfix, firefox85 fixed, firefox86 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) |
| firefox86 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 |  | wontfix |
| firefox84 |  | wontfix |
| firefox85 |  | fixed |
| firefox86 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: eliya, Assigned: royang)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d2b191d48ae0f07a2e1367002f8c1767?d=mm&size=40)  [royang](/user_profile?user_id=644746)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/94706015af7a47c8d2d19f159978d680?d=mm&size=40)  [eliya](/user_profile?user_id=648016)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

24 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1730854](/show_bug.cgi?id=1730854 "RESOLVED DUPLICATE - HTML5 Sandbox Escape - **iframe** Sandbox Attribute")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [fennec68.3?][post-critsmash-triage][adv-main85+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23957

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [fennec68.3?][post-critsmash-triage][adv-main85+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a22031665_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 2 obsolete files)

| [applinks\_subframe\_request.patch](/attachment.cgi?id=9193055)  [4 years ago](#c18)  [Roger Yang [:royang]](/user_profile?user_id=644746)   914 bytes, patch | csadilek : [review+](#c19 "4 years ago") | [Details](/attachment.cgi?id=9193055&action=edit) | [Diff](/attachment.cgi?id=9193055&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1584582&attachment=9193055) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9198095)  [4 years ago](#c24)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   181 bytes, text/plain |  | [Details](/attachment.cgi?id=9198095&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198121)  [4 years ago](#c25)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   278 bytes, text/plain |  | [Details](/attachment.cgi?id=9198121&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198141)  [4 years ago](#c26)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   300 bytes, text/plain |  | [Details](/attachment.cgi?id=9198141&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Eliya Stein](/user_profile?user_id=648016)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1584582#c0)• 5 years ago |
|  | |

Hi Team,

This bug is actively being exploited by a prolific malvertiser known as Zirconium in order to serve millions of forced mobile redirections via malicious ad campaigns.

Here's a reference for more information about Zirconium:

<https://blog.confiant.com/uncovering-2017s-largest-malvertising-operation-b84cd38d6b85>

The bug:

Consider an iframe with the following sandboxing attributes:

"allow-forms allow-pointer-lock allow-popups-to-escape-sandbox allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"

These are standard sandbox attributes for ad serving, and they're generally meant to mitigate things like forced redirections that are uninitiated. Especially the "allow-top-navigation-by-user-activation" attribute.

Most browsers will block something like this in such an iframe:

top.location.href="<http://malicious_landing_page>";

Firefox on Android will prevent this redirection as well. However, it will not prevent spawning a redirect that's done in this manner:

location.href = "intent://malicious\_landing\_page/#Intent;scheme=https;package=com.android.chrome;end";

This payload will spawn Google Chrome from Firefox and open the malicious page without any user interaction. It will also spawn if the allow-popups attribute isn't present. All other major browser successfully prevent this.

This is currently being heavily abused in an ongoing malvertising campaign which is specifically targeting Firefox on Android. We strongly recommend that this be addressed with some urgency as that will have a direct impact on the malvertiser's financial success with this campaign.

This has been tested in the latest Firefox on Android 9 - Samsung Galaxy S8+ as well as several Browserstack instances.

Happy to answer any questions you might have.

Best,

Eliya

Flags: sec-bounty?

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1584582#c1)• 5 years ago |
|  | |

Chris, Stefan, who is responsible for handling security bugs for Fennec these days? Can you please get this in the right hands? Thank you.

Component: Security → GeneralFlags: needinfo?(sarentz)Flags: needinfo?(cpeterson)Product: Firefox → Firefox for Android

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1584582#c2)• 5 years ago |
|  | |

Thanks for the heads up, Eliya.

> location.href = "intent://malicious\_landing\_page/#Intent;scheme=https;package=com.android.chrome;end";

@ Christoph and James: Fennec allows malicious JS to open ad pages in Chrome (using intent: URIs) without user interaction. Does this sound like a Gecko bug or a Fennec/GeckoView bug?

The Chrome team announced that forced redirects will be blocked in Chrome 64 scheduled for release on January 23.

Group: mobile-core-security
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)Flags: needinfo?(snorp)Flags: needinfo?(sarentz)Flags: needinfo?(cpeterson)Flags: needinfo?(ckerschb)OS: Unspecified → AndroidPriority: -- → P1Summary: iframe sandboxing bypass on firefox android via intent url scheme → iframe sandboxing bypass on firefox android via intent: url schemeWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [fennec68.2?]

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1584582#c3)• 5 years ago |
|  | |

> Chris, Stefan, who is responsible for handling security bugs for Fennec these days?

To answer your question: Stefan (Fennec engineering manager) and Ashley Thomas (Fennec product manager) are currently responsible for Fennec bug triage.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1584582#c4)• 5 years ago |
|  | |

I think we have to call this "sec-moderate", but that doesn't mean it's not important and urgent to address a campaign in progress.

intents are effectively the same kind of evil as external helper apps or external content handlers on Desktop. We shouldn't be loading any that aren't on an explicit whitelist without asking the user first (an option to "remember this" is fine after that first ask).

Group: firefox-core-securityType: task → defectFlags: needinfo?(ckerschb)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a519374_451704)• 5 years ago |

[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F)

|  | [Eliya Stein](/user_profile?user_id=648016)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1584582#c5)• 5 years ago |
|  | |

Hi Daniel,

For what it's worth, I absolutely agree with what your'e saying and the whitelist approach, but it might be more secure to forbid an iframe from loading an intent without any user activation in the first place.

Just for some reference/context, I believe Chrome made a decision along these lines at some point:

<https://developer.chrome.com/multidevice/android/intents>

From my testing, it make sense. The functionality is still there if there's a link in the iframe along the lines of <a href="intent:..., but the scenario where a bad actor can cause forced actions is mitigated. It would still be a bit weird if a third party ad can land on a site and this causes the user to be prompted to open chrome or open slack for example.

Best,

Eliya

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a589579_24572)• 5 years ago |

[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B)

|  | [James Willcox (:snorp) (jwillcox@mozilla.com) (he/him)](/user_profile?user_id=227322) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1584582#c6)• 5 years ago |
|  | |

I think we tried a long time ago to require user interaction here in Fennec but it had some problems. We're facing a similar thing in GeckoView now ([bug 1555337](/show_bug.cgi?id=1555337 "RESOLVED FIXED - Indicate if a URL change has been caused by a user interaction.")), which is why Fenix doesn't support intent urls yet.

Can we just disallow intent urls in iframes entirely? Or will that break some kind of login flow somewhere?

Flags: needinfo?(snorp)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1584582#c7)• 5 years ago |
|  | |

> Can we just disallow intent urls in iframes entirely? Or will that break some kind of login flow somewhere?

Who should make this decision? ckerschb? snorp?

If we don't know of any breakage, we could disable intent URIs in GeckoView Nightly and see if anyone complains. Or we could ask QA to do some manual testing of a build with intent URIs disabled.

Flags: needinfo?(ckerschb)Product: Firefox for Android → GeckoViewSummary: iframe sandboxing bypass on firefox android via intent: url scheme → iframe sandboxing bypass on Android via intent: url scheme

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1584582#c8)• 5 years ago |
|  | |

If we disable intent URIs in GeckoView/Fenix without any big problems, would we backport this patch to Fennec ESR 68?

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)Whiteboard: [reporter-external] [client-bounty-form] [verif?] [fennec68.2?] → [reporter-external] [client-bounty-form] [verif?] [fennec68.3?]

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1584582#c9)• 5 years ago |
|  | |

James says this is a Fenix bug. Fenix is not vulnerable at the moment, but might be after they implement support for intent URIs. This bug can be a reminder to test this case in Fenix then.

firefox-esr68=wontfix because we won't fix for Fennec.

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) → ---
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix) → ---
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected) → ---
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) → ---
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) → ---
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B) → ---Component: General → Security: AndroidProduct: GeckoView → Fenix

|  | [Eliya Stein](/user_profile?user_id=648016)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1584582#c10)• 5 years ago |
|  | |

Hi Team,

We are hoping to publish some research in the next few weeks on how this malvertiser leverages these types of browsers quirks in order to maximize the impact of their campaigns. This example is a great case and we would like to talk about it pubclicly. Can you please let us know if this interferes with your efforts towards a fix? If so, what do you consider a reasonable timeline?

Best,

Eliya

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1584582#c11)• 5 years ago |
|  | |

needinfo Chris for [comment 10](/show_bug.cgi?id=1584582#c10 "RESOLVED FIXED - iframe sandboxing bypass on Android via intent: url scheme"), since the talk would presumably include our shipping product (Fennec) where this is wontfixed and not our not-yet-release Fenix.

> Can we just disallow intent urls in iframes entirely? Or will that break some kind of login flow somewhere?

Without telemetry I don't see how we can answer this (or shipping the change to see what breaks). I suspect most "open me in this app" will be links and not iframes, but that's an uneducated guess.

Flags: needinfo?(ckerschb) → needinfo?(cpeterson)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1584582#c12)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #11](/show_bug.cgi?id=1584582#c11 "RESOLVED FIXED - iframe sandboxing bypass on Android via intent: url scheme"))

> needinfo Chris for [comment 10](/show_bug.cgi?id=1584582#c10 "RESOLVED FIXED - iframe sandboxing bypass on Android via intent: url scheme"), since the talk would presumably include our shipping product (Fennec) where this is wontfixed and not our not-yet-release Fenix.
>
> > Can we just disallow intent urls in iframes entirely? Or will that break some kind of login flow somewhere?
>
> Without telemetry I don't see how we can answer this (or shipping the change to see what breaks). I suspect most "open me in this app" will be links and not iframes, but that's an uneducated guess.

^ redirecting to Emily Toop, GeckoView engineering manager.

(I'm no longer working on GeckoView these days.)

Flags: needinfo?(cpeterson) → needinfo?(etoop)

|  | [Emily Toop (:fluffyemily)](/user_profile?user_id=540010) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1584582#c13)• 5 years ago |
|  | |

This bug does not affect Fenix, only Fennec and so is not required.

Flags: needinfo?(etoop)

|  | [Chenxia Liu [:liuche]](/user_profile?user_id=420448) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a19813252_420448)• 5 years ago |

Status: UNCONFIRMED → RESOLVEDClosed: 5 years agoResolution: --- → INVALID

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1584582#c14)• 5 years ago |
|  | |

It was filed against Fennec and is NOT "invalid" -- it's an active malvertising campaign. It got bounced to GeckoView in the mistaken assumption it was backend code, and then bounced back to the wrong front-end where the abused feature is not (yet?) supported. Moving back. Maybe it's wontfix given our intended migration to Fenix in that case, but not invalid.

Status: RESOLVED → REOPENEDComponent: Security: Android → GeneralEver confirmed: trueProduct: Fenix → Firefox for AndroidResolution: INVALID → ---Version: unspecified → Firefox 68

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a20223510_1689)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a22031665_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1584582#c15)• 4 years ago |
|  | |

Agi/Christian we should verify Fenix/GV example behavior on this. AFIK we have implemented intent handling code in Fenix so this should still apply if we have not made any mitigations.

Status: REOPENED → NEWComponent: General → Security: AndroidFlags: needinfo?(csadilek)Flags: needinfo?(agi)Product: Firefox for Android → FenixVersion: Firefox 68 → unspecified

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1584582#c16)• 4 years ago |
|  | |

Agi is on PTO

Flags: needinfo?(agi)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1584582#c17)• 4 years ago |
|  | |

I've verified that this is reproducible in Fenix and needs a fix in A-C's `AppLinksInterceptor`. We should check if it the load request is a subframe request and not handle/intercept it in this case.

Adding Roger.

Flags: needinfo?(csadilek)

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a38033705_644746)• 4 years ago |

Assignee: nobody → royang

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1584582#c18)• 4 years ago |
|  | |

Attached patch

[applinks\_subframe\_request.patch](attachment.cgi?id=9193055&action=diff)
— [Details](attachment.cgi?id=9193055&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1584582&attachment=9193055)

[Attachment #9193055](/attachment.cgi?id=9193055&action=edit "applinks_subframe_request.patch") -
Flags: review?(csadilek)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1584582#c19)• 4 years ago |
|  | |

Comment on [attachment 9193055](/attachment.cgi?id=9193055 "applinks_subframe_request.patch") [[details]](/attachment.cgi?id=9193055&action=edit "applinks_subframe_request.patch") [[diff]](/attachment.cgi?id=9193055&action=diff "applinks_subframe_request.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1584582&attachment=9193055)
applinks\_subframe\_request.patch
Review of [attachment 9193055](/attachment.cgi?id=9193055 "applinks_subframe_request.patch") [[details]](/attachment.cgi?id=9193055&action=edit "applinks_subframe_request.patch") [[diff]](/attachment.cgi?id=9193055&action=diff "applinks_subframe_request.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1584582&attachment=9193055):
-----------------------------------------------------------------
I've verified this prevents the forced redirect described above. Let's add a unit test for this case before landing on GH.
[Attachment #9193055](/attachment.cgi?id=9193055&action=edit "applinks_subframe_request.patch") -
Flags: review?(csadilek) → review+

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1584582#c20)• 4 years ago |
|  | |

> I've verified this prevents the forced redirect described above. Let's add a
>
> unit test for this case before landing on GH.

Understood. Thanks

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1584582#c21)• 4 years ago |
|  | |

Fix merged in Android Component

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a40525006_644746)• 4 years ago |

Status: NEW → RESOLVEDClosed: 5 years ago → 4 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1584582#c22)• 4 years ago |
|  | |

Can you please include a link to the AC commit that fixed this? Also, which AC version is it shipping in?

Group: mobile-core-security → core-security-release
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)Flags: needinfo?(royang)

|  | [Roger Yang [:royang]](/user_profile?user_id=644746)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1584582#c23)• 4 years ago |
|  | |

Sure, this is the pr <https://github.com/mozilla-mobile/android-components/pull/9218>. This change was merged in AC 70. Thanks,

Flags: needinfo?(royang)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a40775371_75935)• 4 years ago |

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a41096254_458186)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [fennec68.3?] → [reporter-external] [client-bounty-form] [verif?] [fennec68.3?][post-critsmash-triage]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a41527838_428608)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [fennec68.3?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?] [fennec68.3?][post-critsmash-triage][adv-main85+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1584582#c24)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198095) (obsolete)
— [Details](attachment.cgi?id=9198095&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1584582#c25)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198121) (obsolete)
— [Details](attachment.cgi?id=9198121&action=edit)

[Attachment #9198095](/attachment.cgi?id=9198095&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1584582#c26)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198141)
— [Details](attachment.cgi?id=9198141&action=edit)

[Attachment #9198121](/attachment.cgi?id=9198121&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a41612017_428608)• 4 years ago |

Alias: CVE-2021-23957

|  | [Eliya Stein](/user_profile?user_id=648016)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1584582#c27)• 4 years ago |
|  | |

Hey Freddy - Is it appropriate to reference this CVE publicly yet? At what point does this issue become public?

Thanks,

Eliya

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1584582#c28)• 4 years ago |
|  | |

The 85.1.0 and 85.1.1 builds has been at a 25% rollout until about 10 Pacific/18 UTC today. We bumped to 99% and are planning on going to 100% early next week baring any major issues cropping up. Until we push to 100% there is no way for Google Play users to force the update. It is just how the Play Store works.

A few weeks after that should be fine see previous example in [bug 1659381 comment 19](/show_bug.cgi?id=1659381#c19 "RESOLVED WONTFIX - Zero user-interaction triggering of intents over LAN") and [bug 1659381 comment 23](/show_bug.cgi?id=1659381#c23 "RESOLVED WONTFIX - Zero user-interaction triggering of intents over LAN")

|  | [Eliya Stein](/user_profile?user_id=648016)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1584582#c29)• 4 years ago |
|  | |

Thanks Kevin!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a47982595_1689)• 4 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a62134935_1689)• 3 years ago |

See Also: → [1730854](/show_bug.cgi?id=1730854 "RESOLVED DUPLICATE - HTML5 Sandbox Escape - **iframe** Sandbox Attribute")

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a97937256_430528)• 2 years ago |

Component: Security: Android → General

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1584582#a147482680_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1584582&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Roger Yang [:royang]](/user_profile?user_id=644746)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_7358fcf7_20250114_194144.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-03

## Security Vulnerabilities fixed in Firefox 85

Announced
January 26, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 85

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2021-23955: Clickjacking across tabs through misusing requestPointerLock](#CVE-2021-23955)

Reporter
Irvan Kurniawan
Impact
high
##### Description

The browser could have been confused into transferring a pointer lock state into another tab, which could have lead to clickjacking attacks.

##### References

* [Bug 1684837](https://bugzilla.mozilla.org/show_bug.cgi?id=1684837)

#### [#CVE-2021-23956: File picker dialog could have been used to disclose a complete directory](#CVE-2021-23956)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An ambiguous file picker design could have confused users who intended to select and upload a single file into uploading a whole directory. This was addressed by adding a new prompt.

##### References

* [Bug 1338637](https://bugzilla.mozilla.org/show_bug.cgi?id=1338637)

#### [#CVE-2021-23957: Iframe sandbox could have been bypassed on Android via the intent URL scheme](#CVE-2021-23957)

Reporter
Eliya Stein
Impact
moderate
##### Description

Navigations through the Android-specific `intent` URL scheme could have been misused to escape iframe sandbox.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1584582](https://bugzilla.mozilla.org/show_bug.cgi?id=1584582)

#### [#CVE-2021-23958: Screen sharing permission leaked across tabs](#CVE-2021-23958)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

The browser could have been confused into transferring a screen sharing state into another tab, which would leak unintended information.

##### References

* [Bug 1642747](https://bugzilla.mozilla.org/show_bug.cgi?id=1642747)

#### [#CVE-2021-23959: Cross-Site Scripting in error pages on Firefox for Android](#CVE-2021-23959)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An XSS bug in internal error pages could have led to various spoofing attacks, including other error pages and the address bar.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1659035](https://bugzilla.mozilla.org/show_bug.cgi?id=1659035)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23962: Use-after-poison in "nsTreeBodyFrame::RowCountChanged"](#CVE-2021-23962)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

Incorrect use of the `RowCountChanged` method could have led to a user-after-poison and a potentially exploitable crash.

##### References

* [Bug 1677194](https://bugzilla.mozilla.org/show_bug.cgi?id=1677194)

#### [#CVE-2021-23963: Permission prompt inaccessible after asking for additional permissions](#CVE-2021-23963)

Reporter
Paul Zühlcke
Impact
low
##### Description

When sharing geolocation during an active WebRTC share, Firefox could have reset the webRTC sharing state in the user interface, leading to loss of control over the currently granted permission

##### References

* [Bug 1680793](https://bugzilla.mozilla.org/show_bug.cgi?id=1680793)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Tyson Smith, Jesse Schwartzentruber, Jon Coppeard, Byron Campen, André Bargull, Steve Fink, Jason Kratzer, Christian Holler, Alexis Beingessner reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

#### [#CVE-2021-23965: Memory safety bugs fixed in Firefox 85](#CVE-2021-23965)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Sebastian Hengst, Christian Holler, Tyson Smith reported memory safety bugs present in Firefox 84. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1670378%2C1673555%2C1676812%2C1678582%2C1684497)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


