=== Content from www.mozilla.org_7358fcf7_20250114_194829.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-03

## Security Vulnerabilities fixed in Firefox 85

Announced
January 26, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 85

#### [#CVE-2021-23953: Cross-origin information leakage via redirected PDF requests](#CVE-2021-23953)

Reporter
Rob Wu
Impact
high
##### Description

If a user clicked into a specifically crafted PDF, the PDF reader could be confused into leaking cross-origin information, when said information is served as chunked data.

##### References

* [Bug 1683940](https://bugzilla.mozilla.org/show_bug.cgi?id=1683940)

#### [#CVE-2021-23954: Type confusion when using logical assignment operators in JavaScript switch statements](#CVE-2021-23954)

Reporter
Gary Kwong
Impact
high
##### Description

Using the new logical assignment operators in a JavaScript switch statement could have caused a type confusion, leading to a memory corruption and a potentially exploitable crash.

##### References

* [Bug 1684020](https://bugzilla.mozilla.org/show_bug.cgi?id=1684020)

#### [#CVE-2021-23955: Clickjacking across tabs through misusing requestPointerLock](#CVE-2021-23955)

Reporter
Irvan Kurniawan
Impact
high
##### Description

The browser could have been confused into transferring a pointer lock state into another tab, which could have lead to clickjacking attacks.

##### References

* [Bug 1684837](https://bugzilla.mozilla.org/show_bug.cgi?id=1684837)

#### [#CVE-2021-23956: File picker dialog could have been used to disclose a complete directory](#CVE-2021-23956)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An ambiguous file picker design could have confused users who intended to select and upload a single file into uploading a whole directory. This was addressed by adding a new prompt.

##### References

* [Bug 1338637](https://bugzilla.mozilla.org/show_bug.cgi?id=1338637)

#### [#CVE-2021-23957: Iframe sandbox could have been bypassed on Android via the intent URL scheme](#CVE-2021-23957)

Reporter
Eliya Stein
Impact
moderate
##### Description

Navigations through the Android-specific `intent` URL scheme could have been misused to escape iframe sandbox.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1584582](https://bugzilla.mozilla.org/show_bug.cgi?id=1584582)

#### [#CVE-2021-23958: Screen sharing permission leaked across tabs](#CVE-2021-23958)

Reporter
Jan-Ivar Bruaroey
Impact
moderate
##### Description

The browser could have been confused into transferring a screen sharing state into another tab, which would leak unintended information.

##### References

* [Bug 1642747](https://bugzilla.mozilla.org/show_bug.cgi?id=1642747)

#### [#CVE-2021-23959: Cross-Site Scripting in error pages on Firefox for Android](#CVE-2021-23959)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An XSS bug in internal error pages could have led to various spoofing attacks, including other error pages and the address bar.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1659035](https://bugzilla.mozilla.org/show_bug.cgi?id=1659035)

#### [#CVE-2021-23960: Use-after-poison for incorrectly redeclared JavaScript variables during GC](#CVE-2021-23960)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Performing garbage collection on re-declared JavaScript variables resulted in a user-after-poison, and a potentially exploitable crash.

##### References

* [Bug 1675755](https://bugzilla.mozilla.org/show_bug.cgi?id=1675755)

#### [#CVE-2021-23961: More internal network hosts could have been probed by a malicious webpage](#CVE-2021-23961)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Further techniques that built on the slipstream research combined with a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677940](https://bugzilla.mozilla.org/show_bug.cgi?id=1677940)

#### [#CVE-2021-23962: Use-after-poison in "nsTreeBodyFrame::RowCountChanged"](#CVE-2021-23962)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

Incorrect use of the `RowCountChanged` method could have led to a user-after-poison and a potentially exploitable crash.

##### References

* [Bug 1677194](https://bugzilla.mozilla.org/show_bug.cgi?id=1677194)

#### [#CVE-2021-23963: Permission prompt inaccessible after asking for additional permissions](#CVE-2021-23963)

Reporter
Paul Zühlcke
Impact
low
##### Description

When sharing geolocation during an active WebRTC share, Firefox could have reset the webRTC sharing state in the user interface, leading to loss of control over the currently granted permission

##### References

* [Bug 1680793](https://bugzilla.mozilla.org/show_bug.cgi?id=1680793)

#### [#CVE-2021-23964: Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](#CVE-2021-23964)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Tyson Smith, Jesse Schwartzentruber, Jon Coppeard, Byron Campen, André Bargull, Steve Fink, Jason Kratzer, Christian Holler, Alexis Beingessner reported memory safety bugs present in Firefox 84 and Firefox ESR 78.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85 and Firefox ESR 78.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662507%2C1666285%2C1673526%2C1674278%2C1674835%2C1675097%2C1675844%2C1675868%2C1677590%2C1677888%2C1680410%2C1681268%2C1682068%2C1682938%2C1683736%2C1685260%2C1685925)

#### [#CVE-2021-23965: Memory safety bugs fixed in Firefox 85](#CVE-2021-23965)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Sebastian Hengst, Christian Holler, Tyson Smith reported memory safety bugs present in Firefox 84. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 85](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1670378%2C1673555%2C1676812%2C1678582%2C1684497)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e6c6688c_20250114_194827.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1642747)
* [XML](/show_bug.cgi?ctype=xml&id=1642747)

Closed
[Bug 1642747](/show_bug.cgi?id=1642747)
(CVE-2021-23958)

Opened 5 years ago
Closed 4 years ago

# It's possible to screen-capture the next tab after tab close

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

It's possible to screen-capture the next tab after tab close

## Categories

### (Firefox :: Site Permissions, defect, P2)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Site%20Permissions#Site%20Permissions)

Site Permissions
▾

Firefox :: Site Permissions
Bugs and feature requests for the Firefox UI to give or revoke web page permissions to access device functionality such as camera, microphone, geolocation or notifications.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Site%20Permissions)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

86 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox83 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix) |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified) |
| firefox86 | [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr78 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox83 |  | wontfix |
| firefox84 |  | wontfix |
| firefox85 | + | verified |
| firefox86 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jib, Assigned: emz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9362a14d9b87a3935eb16cfc834ed51f?d=mm&size=40)  [jib](/user_profile?user_id=456498)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Blocks 1 open bug, [URL](https://jsfiddle.net/jib1/0sjrmkuh/show "https://jsfiddle.net/jib1/0sjrmkuh/show") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1635254](/show_bug.cgi?id=1635254 "NEW - [meta] Improve permission dialogs and indicators for sharing screens and windows over WebRTC")

Dependency [tree](/showdependencytree.cgi?id=1642747&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1642747)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[jsfiddle.net/jib1/0sjrmkuh/show](https://jsfiddle.net/jib1/0sjrmkuh/show "https://jsfiddle.net/jib1/0sjrmkuh/show")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, privacy, sec-moderate, Whiteboard: [adv-main85+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23958

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main85+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a17188550_75935 "4 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh](/attachment.cgi?id=9187173)  [4 years ago](#c4)  [Emma Zühlcke [:emz]](/user_profile?user_id=636491)   47 bytes, text/x-phabricator-request | jcristau : [approval-mozilla-beta+](#c8 "4 years ago") | [Details](/attachment.cgi?id=9187173&action=edit) | [Review](/attachment.cgi?id=9187173) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9198098)  [4 years ago](#c13)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   244 bytes, text/plain |  | [Details](/attachment.cgi?id=9198098&action=edit) |
| [advisory.txt](/attachment.cgi?id=9198142)  [4 years ago](#c14)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   203 bytes, text/plain |  | [Details](/attachment.cgi?id=9198142&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jan-Ivar Bruaroey [:jib] (needinfo? me)](/user_profile?user_id=456498)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1642747#c0)• 5 years ago |
|  | |

From [bug 1641802 comment 4](/show_bug.cgi?id=1641802#c4 "NEW - The Global Sharing Overlay remains displayed when closing the tab with the screen-sharing web-app because of the appearance of the tab-switch-warning"), when screen-capturing the Firefox window (or the "Entire screen" with Firefox on it), JS may capture a split second ***after*** tab close, capturing the next tab shown. This is not POLA, and could be exploited to put users' privacy at risk.

STRs:

1. Open a random victim tab, e.g. <https://gokitty.com>
2. Open <https://fiddle.jshell.net/jib1/0sjrmkuh/show>
3. Click the `Capture screen!` button, and select the Firefox window (or Entire Desktop) + Allow
4. Close the fiddle tab.
5. Re-open the fiddle tab.

Expected result:

* A screen-grab of the fiddle tab

Actual result:

* A screen-grab of gokitty.com

I've tried it on both Windows 10 and macOS 10.15.4. My success-rate is about 1/5 times.

Similarly, I've tried sending the capture to another tab over WebRTC (open [this](https://jsfiddle.net/jib1/w3L7ujpo/) in two tabs), but not had success reproing that way. Although, this being timing-related, we perhaps shouldn't rule it out.

The repro fiddle doesn't work in release for some reason (`uncaught exception: Object`), it's unclear why. But this weakness is most likely not a regression, and an exploit that works in release could presumably be written.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a164293_1689)• 5 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1642747#c1)• 5 years ago |
|  | |

The severity field is not set for this bug.

:pbz, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(pbz)

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a1277083_522029)• 5 years ago |

Flags: needinfo?(jhofmann)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1642747#c2)• 5 years ago |
|  | |

Thanks! I'll have a look.

Assignee: nobody → pbzSeverity: -- → S3Status: NEW → ASSIGNED
[status-firefox77](/buglist.cgi?f1=cf_status_firefox77&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix)
[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=fix-optional)
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected)Flags: needinfo?(pbz)Priority: -- → P2

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a1892525_636491)• 5 years ago |

[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix)

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1642747#c3)• 4 years ago |
|  | |

I think Paul is still looking at this, I don't have the bandwidth right now :)

Flags: needinfo?(jhofmann)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1642747#c4)• 4 years ago |
|  | |

Attached file
[Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh](attachment.cgi?id=9187173)
— [Details](attachment.cgi?id=9187173&action=edit)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1642747#c5)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/6dd8d66f811619fc0a76152f860ab9d9a54331e6>

URL: <https://jsfiddle.net/jib1/0sjrmkuh/show>Status: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox77](/buglist.cgi?f1=cf_status_firefox77&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix) → ---
[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix) → ---
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected) → ---
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 86 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a17188550_75935)• 4 years ago |

Group: firefox-core-security → core-security-release
[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox85](/buglist.cgi?f1=cf_tracking_firefox85&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B)
[tracking-firefox86](/buglist.cgi?f1=cf_tracking_firefox86&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox86&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B)Flags: in-testsuite+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1642747#c6)• 4 years ago |
|  | |

The patch landed in nightly and beta is affected.

:pbz, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(pbz)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1642747#c7)• 4 years ago |
|  | |

Comment on [attachment 9187173](/attachment.cgi?id=9187173 "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh") [[details]](/attachment.cgi?id=9187173&action=edit "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh")

[Bug 1642747](/show_bug.cgi?id=1642747 "VERIFIED FIXED - It's possible to screen-capture the next tab after tab close") - Don't blur closing active tab early if screensharing. r=johannh

### Beta/Release Uplift Approval Request

* **User impact if declined**: Users expects screen sharing to end immediately when they close a tab with active screen sharing. With this bug sites can briefly capture contents of the next tab before the screen sharing ends, potentially violating the users privacy.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See STR from [comment 0](/show_bug.cgi?id=1642747#c0 "VERIFIED FIXED - It's possible to screen-capture the next tab after tab close"). Working test url is: <https://jsfiddle.net/jib1/0sjrmkuh/show>

  The issue is intermittent, however I was able to reproduce it after a couple of tries on my Windows VM.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Small patch and we only change behavior for closing active tabs with screen sharing. I've added a test to ensure we don't break tab closing for the screen sharing scenario.

  Since the bug is quite intermittent we don't have test coverage for the bug itself.
* **String changes made/needed**:
Flags: needinfo?(pbz)
[Attachment #9187173](/attachment.cgi?id=9187173&action=edit "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh") -
Flags: approval-mozilla-beta?

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a18630523_636491)• 4 years ago |

Flags: qe-verify+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1642747#c8)• 4 years ago |
|  | |

Comment on [attachment 9187173](/attachment.cgi?id=9187173 "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh") [[details]](/attachment.cgi?id=9187173&action=edit "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh")

[Bug 1642747](/show_bug.cgi?id=1642747 "VERIFIED FIXED - It's possible to screen-capture the next tab after tab close") - Don't blur closing active tab early if screensharing. r=johannh

approved for 85.0b5

[Attachment #9187173](/attachment.cgi?id=9187173&action=edit "Bug 1642747 - Don't blur closing active tab early if screensharing. r=johannh") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1642747#c9)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/bcbf5a4d195b>

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a18879348_458186)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1642747#c10)• 4 years ago |
|  | |

Reproduced the initial issue using old Nightly from 2020-06-02, verified that his is no longer an issue using Firefox 85.0b5 and Latest Nightly from today across platforms (Windows 10, macOS 11 and Ubuntu 18.04). Keeping qe-verify+ flag until this will be fixed in ESR as well.

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=verified)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1642747#c11)• 4 years ago |
|  | |

Is this worth uplifting to ESR78? Please nominate for approval if so; it grafts cleanly.

Flags: needinfo?(pbz)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1642747#c12)• 4 years ago |
|  | |

Let's stick to 85 release for now and check back next cycle to ensure we don't regress. Leaving NI for that.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a19322116_580382)• 4 years ago |

[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[85+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=85%2B) → [86+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=86%2B)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a20007821_428608)• 4 years ago |

Whiteboard: [adv-main85+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1642747#c13)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198098) (obsolete)
— [Details](attachment.cgi?id=9198098&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1642747#c14)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9198142)
— [Details](attachment.cgi?id=9198142&action=edit)

[Attachment #9198098](/attachment.cgi?id=9198098&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a20091157_428608)• 4 years ago |

Alias: CVE-2021-23958

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1642747#c15)• 4 years ago |
|  | |

Haven't spotted any regressions from this patch in 85, so uplifting to ESR is an option. However, looking at the uplift request form I can see that we usually only uplift sec-high and sec-crit. I don't see how this bug would be an exception to that.

Happy to discuss this further if you have concerns.

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)Flags: needinfo?(pbz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a22374181_75935)• 4 years ago |

[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[86+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=86%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a22424271_458188)• 4 years ago |

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1642747#a46526094_1689)• 3 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1642747&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Emma Zühlcke [:emz]](/user_profile?user_id=636491)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


