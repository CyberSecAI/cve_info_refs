- **Root cause of vulnerability**: The `trimvideo` function in the `ffmpegdotjs` package uses the `child_process.exec` function without sanitizing user-provided input, allowing for command injection.
- **Weaknesses/vulnerabilities present**: Arbitrary command injection. Specifically, the vulnerability lies in the lack of sanitization when user input is passed to the `exec` function.
- **Impact of exploitation**: An attacker can execute arbitrary commands on the server hosting the application utilizing the vulnerable package. This can lead to a complete loss of confidentiality, integrity, and availability. For example, an attacker could steal data, modify files, or cause a denial of service.
- **Attack vectors**: An attacker can inject malicious commands via the `trimvideo` function's parameters, specifically the file name parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to control the input that is passed to the vulnerable `trimvideo` function. This vulnerability is remotely exploitable (network). No privileges or user interaction are required.