```
{
  "Root cause": "The PostgreSQL server was not properly handling unencrypted data after a TLS/SSL handshake or GSSAPI authentication, allowing a man-in-the-middle attacker to inject arbitrary SQL queries. This happened due to the server collecting data from the client socket before the handshake completed, which would then be treated as decrypted data after the handshake.",
  "Weaknesses": [
    "Improper handling of unencrypted data following an encrypted handshake.",
    "Failure to discard data received prior to successful handshake."
  ],
  "Impact": "A man-in-the-middle attacker could inject arbitrary SQL queries into a database session, potentially leading to unauthorized data access, data manipulation, or other malicious activity. If the server was configured to use trust authentication without requiring authentication data, this could result in direct compromise of the database.",
   "Attack vectors": [
    "Man-in-the-middle attack on the network connection between client and server during session initiation."
   ],
  "Required attacker capabilities/position": [
    "Ability to intercept and inject data into the network traffic between a PostgreSQL client and server.",
        "The server must be configured to use trust authentication with a clientcert requirement, or to use cert authentication."
  ]
}
```