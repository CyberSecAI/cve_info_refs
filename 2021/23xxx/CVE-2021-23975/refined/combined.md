=== Content from bugzilla.mozilla.org_ab2325a7_20250115_083602.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1685145)
* [XML](/show_bug.cgi?ctype=xml&id=1685145)

Closed
[Bug 1685145](/show_bug.cgi?id=1685145)
(CVE-2021-23975)

Opened 4 years ago
Closed 4 years ago

# attempting to call malloc\_usable\_size() for pointer which is not owned

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

attempting to call malloc\_usable\_size() for pointer which is not owned

## Categories

### (Core :: Graphics: WebRender, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20WebRender#Graphics%3A%20WebRender)

Graphics: WebRender
▾

Core :: Graphics: WebRender
Bugs related to the integration of WebRender into Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20WebRender&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20WebRender&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20WebRender)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S4

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix) |
| firefox86 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) |
| firefox87 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox84 |  | wontfix |
| firefox85 |  | wontfix |
| firefox86 |  | fixed |
| firefox87 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: geeknik, Assigned: gw)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2f22cafad5e74490468a55973c7c14fe?d=mm&size=40)  [gw](/user_profile?user_id=504871)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0ed8b7f839fa1a904f993655b53e9d81?d=mm&size=40)  [geeknik](/user_profile?user_id=31466)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2f22cafad5e74490468a55973c7c14fe?d=mm&size=40)  [gw](/user_profile?user_id=504871)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

3 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main86+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23975

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-nullptr](/buglist.cgi?keywords=csectype-nullptr&resolution=---),
[nightly-community](/buglist.cgi?keywords=nightly-community&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main86+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2418758_1689 "4 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a9140778_578488 "4 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | [qe-verify](#a3250002_458186 "4 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1685145 - Fix incorrect usage of memory profiling code.](/attachment.cgi?id=9199966)  [4 years ago](#c1)  [Glenn Watson [:gw]](/user_profile?user_id=504871)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c5 "4 years ago") | [Details](/attachment.cgi?id=9199966&action=edit) | [Review](/attachment.cgi?id=9199966) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9204113)  [4 years ago](#c7)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   383 bytes, text/plain |  | [Details](/attachment.cgi?id=9204113&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Brian Carpenter [:geeknik]](/user_profile?user_id=31466)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1685145#c0)• 4 years ago |
|  | |

Install Firefox Nightly Build ID 20210105094403 (ASAN) and with a clean profile go to `about:memory` and tap measure. The browser crashes.

```
==209471==ERROR: AddressSanitizer: attempting to call malloc_usable_size() for pointer which is not owned: 0x000000000008
    #0 0x5631fe5372bd in malloc_usable_size /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cpp:198:3
    #1 0x5631fe4bed92 in Unwind /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_stacktrace.h:115:5
    #2 0x5631fe4bed92 in __asan::asan_malloc_usable_size(void const*, unsigned long, unsigned long) /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_allocator.cpp:986:5
    #3 0x7f093fe8a876 in webrender::renderer::Renderer::size_of::hc672c0bdf48d101f /builds/worker/checkouts/gecko/gfx/wr/webrender/src/renderer/mod.rs:5302:18
    #4 0x7f093fe8a876 in webrender::renderer::Renderer::report_memory::h72205d5405f85baf /builds/worker/checkouts/gecko/gfx/wr/webrender/src/renderer/mod.rs:5314:36
    #5 0x7f093fe8a876 in wr_renderer_accumulate_memory_report /builds/worker/checkouts/gecko/gfx/webrender_bindings/src/bindings.rs:788:16
    #6 0x7f09333f6c61 in AccumulateMemoryReport /builds/worker/checkouts/gecko/gfx/webrender_bindings/RendererOGL.cpp:412:3
    #7 0x7f09333f6c61 in mozilla::wr::RenderThread::DoAccumulateMemoryReport(mozilla::wr::MemoryReport, RefPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> const&) /builds/worker/checkouts/gecko/gfx/webrender_bindings/RenderThread.cpp:167:15
    #8 0x7f093340bdfa in applyImpl<mozilla::wr::RenderThread, void (mozilla::wr::RenderThread::*)(mozilla::wr::MemoryReport, const RefPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> &), StoreCopyPassByConstLRef<mozilla::wr::MemoryReport>, StoreRefPtrPassByPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> , 0, 1> /builds/worker/workspace/obj-build/dist/include/nsThreadUtils.h:1148:12
    #9 0x7f093340bdfa in apply<mozilla::wr::RenderThread, void (mozilla::wr::RenderThread::*)(mozilla::wr::MemoryReport, const RefPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> &)> /builds/worker/workspace/obj-build/dist/include/nsThreadUtils.h:1154:12
    #10 0x7f093340bdfa in mozilla::detail::RunnableMethodImpl<mozilla::wr::RenderThread*, void (mozilla::wr::RenderThread::*)(mozilla::wr::MemoryReport, RefPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> const&), true, (mozilla::RunnableKind)0, mozilla::wr::MemoryReport, RefPtr<mozilla::MozPromise<mozilla::wr::MemoryReport, bool, true>::Private> >::Run() /builds/worker/workspace/obj-build/dist/include/nsThreadUtils.h:1201:13
    #11 0x7f093161c003 in RunTask /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:465:9
    #12 0x7f093161c003 in MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask&&) /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:473:5
    #13 0x7f093161d73b in MessageLoop::DoWork() /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:548:13
    #14 0x7f093161f009 in base::MessagePumpDefault::Run(base::MessagePump::Delegate*) /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_pump_default.cc:35:31
    #15 0x7f093161a592 in RunInternal /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:334:10
    #16 0x7f093161a592 in RunHandler /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:327:3
    #17 0x7f093161a592 in MessageLoop::Run() /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:309:3
    #18 0x7f0931639ddb in base::Thread::ThreadMain() /builds/worker/checkouts/gecko/ipc/chromium/src/base/thread.cc:191:16
    #19 0x7f093163096c in ThreadFunc(void*) /builds/worker/checkouts/gecko/ipc/chromium/src/base/platform_thread_posix.cc:40:13
    #20 0x7f09478b8431 in start_thread (/lib64/libpthread.so.0+0x9431)
    #21 0x7f0947481912 in clone (/lib64/libc.so.6+0x101912)

Address 0x000000000008 is a wild pointer.
SUMMARY: AddressSanitizer: bad-malloc_usable_size /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cpp:198:3 in malloc_usable_size
Thread T22 (Renderer) created by T0 here:
    #0 0x5631fe52135a in pthread_create /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_interceptors.cpp:214:3
    #1 0x7f093162a48c in CreateThread /builds/worker/checkouts/gecko/ipc/chromium/src/base/platform_thread_posix.cc:123:14
    #2 0x7f093162a48c in PlatformThread::Create(unsigned long, PlatformThread::Delegate*, unsigned long*) /builds/worker/checkouts/gecko/ipc/chromium/src/base/platform_thread_posix.cc:134:10
    #3 0x7f093163942e in base::Thread::StartWithOptions(base::Thread::Options const&) /builds/worker/checkouts/gecko/ipc/chromium/src/base/thread.cc:97:8
    #4 0x7f09333f5290 in mozilla::wr::RenderThread::Start() /builds/worker/checkouts/gecko/gfx/webrender_bindings/RenderThread.cpp:90:16
    #5 0x7f093314ced1 in gfxPlatform::InitLayersIPC() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:1336:7
    #6 0x7f093314855d in gfxPlatform::Init() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:976:3
    #7 0x7f09331465cb in gfxPlatform::GetPlatform() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:509:5
    #8 0x7f093904cf5b in GetPlatform /builds/worker/workspace/obj-build/dist/include/gfxPlatformGtk.h:31:29
    #9 0x7f093904cf5b in nsWindow::nsWindow() /builds/worker/checkouts/gecko/widget/gtk/nsWindow.cpp:440:19
    #10 0x7f093908c35a in nsIWidget::CreateTopLevelWindow() /builds/worker/checkouts/gecko/widget/gtk/nsWindow.cpp:8094:36
    #11 0x7f093c466f89 in mozilla::AppWindow::Initialize(nsIAppWindow*, nsIAppWindow*, int, int, bool, nsWidgetInitData&) /builds/worker/checkouts/gecko/xpfe/appshell/AppWindow.cpp:208:15
    #12 0x7f093c48c00c in nsAppShellService::JustCreateTopWindow(nsIAppWindow*, nsIURI*, unsigned int, int, int, bool, mozilla::AppWindow**) /builds/worker/checkouts/gecko/xpfe/appshell/nsAppShellService.cpp:710:15
    #13 0x7f093c48cff2 in nsAppShellService::CreateTopLevelWindow(nsIAppWindow*, nsIURI*, unsigned int, int, int, nsIAppWindow**) /builds/worker/checkouts/gecko/xpfe/appshell/nsAppShellService.cpp:173:8
    #14 0x7f093cd52c16 in nsAppStartup::CreateChromeWindow(nsIWebBrowserChrome*, unsigned int, nsIOpenWindowInfo*, bool*, nsIWebBrowserChrome**) /builds/worker/checkouts/gecko/toolkit/components/startup/nsAppStartup.cpp:649:15
    #15 0x7f093cefe3a0 in nsWindowWatcher::CreateChromeWindow(nsIWebBrowserChrome*, unsigned int, nsIOpenWindowInfo*, nsIWebBrowserChrome**) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:419:33
    #16 0x7f093cef925f in nsWindowWatcher::OpenWindowInternal(mozIDOMWindowProxy*, nsTSubstring<char> const&, nsTSubstring<char> const&, nsTSubstring<char> const&, bool, bool, bool, nsIArray*, bool, bool, bool, nsPIWindowWatcher::PrintKind, nsDocShellLoadState*, mozilla::dom::BrowsingContext**) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:947:12
    #17 0x7f093cef6578 in nsWindowWatcher::OpenWindow(mozIDOMWindowProxy*, nsTSubstring<char> const&, nsTSubstring<char> const&, nsTSubstring<char> const&, nsISupports*, mozIDOMWindowProxy**) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:293:3
    #18 0x7f093047b7b1 in NS_InvokeByIndex /builds/worker/checkouts/gecko/xpcom/reflect/xptcall/md/unix/xptcinvoke_asm_x86_64_unix.S:101
    #19 0x7f0932359aa1 in Invoke /builds/worker/checkouts/gecko/js/xpconnect/src/XPCWrappedNative.cpp:1620:10
    #20 0x7f0932359aa1 in Call /builds/worker/checkouts/gecko/js/xpconnect/src/XPCWrappedNative.cpp:1176:19
    #21 0x7f0932359aa1 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) /builds/worker/checkouts/gecko/js/xpconnect/src/XPCWrappedNative.cpp:1142:23
    #22 0x7f093235f7bd in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:925:10
    #23 0x7f093d24a06b in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:503:13
    #24 0x7f093d24a06b in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:594:12
    #25 0x7f093d2348ef in InternalCall /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:647:10
    #26 0x7f093d2348ef in CallFromStack /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:651:10
    #27 0x7f093d2348ef in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3309:16
    #28 0x7f093d219e2c in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:473:13
    #29 0x7f093d24fd5f in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>, JS::Handle<JS::Value>, js::AbstractFramePtr, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:839:13
    #30 0x7f093d2e6ca8 in ExecuteInExtensibleLexicalEnvironment(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>) /builds/worker/checkouts/gecko/js/src/builtin/Eval.cpp:492:10
    #31 0x7f093d2e798c in JS::ExecuteInJSMEnvironment(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>, JS::Handle<JS::StackGCVector<JSObject*, js::TempAllocPolicy> >) /builds/worker/checkouts/gecko/js/src/builtin/Eval.cpp:599:10
    #32 0x7f093d2e7471 in JS::ExecuteInJSMEnvironment(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>) /builds/worker/checkouts/gecko/js/src/builtin/Eval.cpp:554:10
    #33 0x7f0932242d2e in mozJSComponentLoader::ObjectForLocation(ComponentLoaderInfo&, nsIFile*, JS::MutableHandle<JSObject*>, JS::MutableHandle<JSScript*>, char**, bool, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/xpconnect/loader/mozJSComponentLoader.cpp:846:19
    #34 0x7f093224ac7a in mozJSComponentLoader::Import(JSContext*, nsTSubstring<char> const&, JS::MutableHandle<JSObject*>, JS::MutableHandle<JSObject*>, bool) /builds/worker/checkouts/gecko/js/xpconnect/loader/mozJSComponentLoader.cpp:1250:12
    #35 0x7f09303cae3a in mozilla::xpcom::ConstructJSMComponent(nsTSubstring<char> const&, char const*, nsISupports**) /builds/worker/workspace/obj-build/xpcom/components/StaticComponents.cpp:1751:3
    #36 0x7f09303b0e44 in mozilla::xpcom::CreateInstanceImpl(mozilla::xpcom::ModuleID, nsISupports*, nsID const&, void**) /builds/worker/workspace/obj-build/xpcom/components/StaticComponents.cpp:10931:7
    #37 0x7f09303e7b1c in CreateInstance /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:176:46
    #38 0x7f09303e7b1c in nsComponentManagerImpl::GetServiceLocked(mozilla::Maybe<mozilla::MonitorAutoLock>&, (anonymous namespace)::EntryWrapper&, nsID const&, void**) /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:1282:17
    #39 0x7f09303ea1bb in nsComponentManagerImpl::GetServiceByContractID(char const*, nsID const&, void**) /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:1471:10
    #40 0x7f09303f00c2 in CallGetService /builds/worker/checkouts/gecko/xpcom/components/nsComponentManagerUtils.cpp:61:43
    #41 0x7f09303f00c2 in nsGetServiceByContractIDWithError::operator()(nsID const&, void**) const /builds/worker/checkouts/gecko/xpcom/components/nsComponentManagerUtils.cpp:253:21
    #42 0x7f0930250dee in nsCOMPtr_base::assign_from_gs_contractid_with_error(nsGetServiceByContractIDWithError const&, nsID const&) /builds/worker/checkouts/gecko/xpcom/base/nsCOMPtr.cpp:91:7
    #43 0x7f093cfcc7c1 in operator= /builds/worker/workspace/obj-build/dist/include/nsCOMPtr.h:1065:5
    #44 0x7f093cfcc7c1 in nsAppStartupNotifier::NotifyObservers(char const*) /builds/worker/checkouts/gecko/toolkit/xre/nsAppStartupNotifier.cpp:46:23
    #45 0x7f093cfbd983 in XREMain::XRE_mainRun() /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:4908:3
    #46 0x7f093cfc08b8 in XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5330:8
    #47 0x7f093cfc1480 in XRE_main(int, char**, mozilla::BootstrapConfig const&) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5389:21
    #48 0x5631fe569954 in do_main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:219:22
    #49 0x5631fe569954 in main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:337:16
    #50 0x7f09473a7041 in __libc_start_main (/lib64/libc.so.6+0x27041)

==209471==ABORTING

```
Flags: sec-bounty?

|  | [Brian Carpenter [:geeknik]](/user_profile?user_id=31466)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a11_31466)• 4 years ago |

Summary: attempting to call malloc\_usable\_size() for pointer which is not owned: → attempting to call malloc\_usable\_size() for pointer which is not owned

|  | [Brian Carpenter [:geeknik]](/user_profile?user_id=31466)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a120_31466)• 4 years ago |

Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-wildptr](/buglist.cgi?keywords=csectype-wildptr&resolution=---),
[nightly-community](/buglist.cgi?keywords=nightly-community&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a3102_575867)• 4 years ago |

Type: task → defect

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a15391_159069)• 4 years ago |

Group: firefox-core-security → gfx-core-securityComponent: Security → Graphics: WebRenderProduct: Firefox → CoreHardware: Unspecified → Desktop

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a96993_1689)• 4 years ago |

Keywords: [csectype-wildptr](/buglist.cgi?keywords=csectype-wildptr&resolution=---) → [csectype-nullptr](/buglist.cgi?keywords=csectype-nullptr&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a1713675_279663)• 4 years ago |

Blocks: [gfx-triage](/show_bug.cgi?id=1632611 "NEW - [Meta] Graphics Triage Tracker")Severity: -- → S4Priority: -- → P3

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a1996465_279663)• 4 years ago |

Flags: needinfo?(gwatson)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1685145#c1)• 4 years ago |
|  | |

Attached file
[Bug 1685145 - Fix incorrect usage of memory profiling code.](attachment.cgi?id=9199966)
— [Details](attachment.cgi?id=9199966&action=edit)

The calling code was directly calling the sizeof function, instead

of going via the API method that checks for invalid pointers first.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a2014960_600971)• 4 years ago |

Assignee: nobody → gwatsonStatus: NEW → ASSIGNED

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a2249402_600971)• 4 years ago |

[Attachment #9199966](/attachment.cgi?id=9199966&action=edit "Bug 1685145 - Fix incorrect usage of memory profiling code.") -
Attachment description: Bug 1685145 - Fix incorrect usage of MallocSizeOfOps. → Bug 1685145 - Fix incorrect usage of memory profiling code.

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a2256562_504871)• 4 years ago |

Flags: needinfo?(gwatson)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1685145#c2)• 4 years ago |
|  | |

Fix incorrect usage of memory profiling code. r=jrmuizel

<https://hg.mozilla.org/integration/autoland/rev/7ce9fbfc137a43a737c159dd174fc0e67ee3ba18>

<https://hg.mozilla.org/mozilla-central/rev/7ce9fbfc137a>

Group: gfx-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 87 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a2329306_75935)• 4 years ago |

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a2418758_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1685145#c3)• 4 years ago |
|  | |

The patch landed in nightly and beta is affected.

:gw, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(gwatson)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1685145#c4)• 4 years ago |
|  | |

Comment on [attachment 9199966](/attachment.cgi?id=9199966 "Bug 1685145 - Fix incorrect usage of memory profiling code.") [[details]](/attachment.cgi?id=9199966&action=edit "Bug 1685145 - Fix incorrect usage of memory profiling code.")

[Bug 1685145](/show_bug.cgi?id=1685145 "RESOLVED FIXED - attempting to call malloc_usable_size() for pointer which is not owned") - Fix incorrect usage of memory profiling code.

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential crash when manually invoking the memory measurement page.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Very small patch, 3 lines I think. Only affects users who are profiling memory usage.
* **String changes made/needed**:
Flags: needinfo?(gwatson)
[Attachment #9199966](/attachment.cgi?id=9199966&action=edit "Bug 1685145 - Fix incorrect usage of memory profiling code.") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1685145#c5)• 4 years ago |
|  | |

Comment on [attachment 9199966](/attachment.cgi?id=9199966 "Bug 1685145 - Fix incorrect usage of memory profiling code.") [[details]](/attachment.cgi?id=9199966&action=edit "Bug 1685145 - Fix incorrect usage of memory profiling code.")

[Bug 1685145](/show_bug.cgi?id=1685145 "RESOLVED FIXED - attempting to call malloc_usable_size() for pointer which is not owned") - Fix incorrect usage of memory profiling code.

Approved for 86 beta 6, thanks.

[Attachment #9199966](/attachment.cgi?id=9199966&action=edit "Bug 1685145 - Fix incorrect usage of memory profiling code.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1685145#c6)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/e75d32f39779>

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a3250002_458186)• 4 years ago |

QA Whiteboard: [qa-triaged]Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a3749383_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main86+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1685145#c7)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9204113)
— [Details](attachment.cgi?id=9204113&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a3834594_578488)• 4 years ago |

Alias: CVE-2021-23975

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a4413045_279663)• 4 years ago |

No longer blocks: [gfx-triage](/show_bug.cgi?id=1632611 "NEW - [Meta] Graphics Triage Tracker")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a9140778_578488)• 4 years ago |

Flags: sec-bounty-hof+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a27778135_1689)• 3 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1685145#a107215206_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1685145&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Glenn Watson [:gw]](/user_profile?user_id=504871)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_bed394fc_20250115_083603.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202104-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-78.10.0"

```

All Mozilla Firefox ESR binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-78.10.0"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-88.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-88.0"

```
### References

* [CVE-2021-23961](https://nvd.nist.gov/vuln/detail/CVE-2021-23961)
* [CVE-2021-23968](https://nvd.nist.gov/vuln/detail/CVE-2021-23968)
* [CVE-2021-23969](https://nvd.nist.gov/vuln/detail/CVE-2021-23969)
* [CVE-2021-23970](https://nvd.nist.gov/vuln/detail/CVE-2021-23970)
* [CVE-2021-23971](https://nvd.nist.gov/vuln/detail/CVE-2021-23971)
* [CVE-2021-23972](https://nvd.nist.gov/vuln/detail/CVE-2021-23972)
* [CVE-2021-23973](https://nvd.nist.gov/vuln/detail/CVE-2021-23973)
* [CVE-2021-23974](https://nvd.nist.gov/vuln/detail/CVE-2021-23974)
* [CVE-2021-23975](https://nvd.nist.gov/vuln/detail/CVE-2021-23975)
* [CVE-2021-23976](https://nvd.nist.gov/vuln/detail/CVE-2021-23976)
* [CVE-2021-23977](https://nvd.nist.gov/vuln/detail/CVE-2021-23977)
* [CVE-2021-23978](https://nvd.nist.gov/vuln/detail/CVE-2021-23978)
* [CVE-2021-23981](https://nvd.nist.gov/vuln/detail/CVE-2021-23981)
* [CVE-2021-23982](https://nvd.nist.gov/vuln/detail/CVE-2021-23982)
* [CVE-2021-23983](https://nvd.nist.gov/vuln/detail/CVE-2021-23983)
* [CVE-2021-23984](https://nvd.nist.gov/vuln/detail/CVE-2021-23984)
* [CVE-2021-23985](https://nvd.nist.gov/vuln/detail/CVE-2021-23985)
* [CVE-2021-23986](https://nvd.nist.gov/vuln/detail/CVE-2021-23986)
* [CVE-2021-23987](https://nvd.nist.gov/vuln/detail/CVE-2021-23987)
* [CVE-2021-23988](https://nvd.nist.gov/vuln/detail/CVE-2021-23988)
* [CVE-2021-23994](https://nvd.nist.gov/vuln/detail/CVE-2021-23994)
* [CVE-2021-23995](https://nvd.nist.gov/vuln/detail/CVE-2021-23995)
* [CVE-2021-23998](https://nvd.nist.gov/vuln/detail/CVE-2021-23998)
* [CVE-2021-23999](https://nvd.nist.gov/vuln/detail/CVE-2021-23999)
* [CVE-2021-24002](https://nvd.nist.gov/vuln/detail/CVE-2021-24002)
* [CVE-2021-29945](https://nvd.nist.gov/vuln/detail/CVE-2021-29945)
* [CVE-2021-29946](https://nvd.nist.gov/vuln/detail/CVE-2021-29946)
* [MFSA-2021-08](https://www.mozilla.org/en-US/security/advisories/mfsa2021-08/)
* [MFSA-2021-11](https://www.mozilla.org/en-US/security/advisories/mfsa2021-11/)
* [MFSA-2021-15](https://www.mozilla.org/en-US/security/advisories/mfsa2021-15/)

**Release date**

April 30, 2021

**Latest revision**

April 30, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [772305](https://bugs.gentoo.org/show_bug.cgi?id=772305)
* [778269](https://bugs.gentoo.org/show_bug.cgi?id=778269)
* [784572](https://bugs.gentoo.org/show_bug.cgi?id=784572)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_833258de_20250115_083605.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-07

## Security Vulnerabilities fixed in Firefox 86

Announced
February 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 86

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If that’s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Firefox incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23970: Multithreaded WASM triggered assertions validating separation of script domains](#CVE-2021-23970)

Reporter
J. Ryan Stinnett
Impact
high
##### Description

Context-specific code was included in a shared jump table; resulting in assertions being triggered in multithreaded wasm code.

##### References

* [Bug 1681724](https://bugzilla.mozilla.org/show_bug.cgi?id=1681724)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23974: noscript elements could have led to an HTML Sanitizer bypass](#CVE-2021-23974)

Reporter
Masato Kinugawa and Michał Bentkowski
Impact
moderate
##### Description

The DOMParser API did not properly process `<noscript>` elements for escaping. This could be used as an mXSS vector to bypass an HTML Sanitizer.

##### References

* [Bug 1528997, 1683627](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1528997%2C1683627)

#### [#CVE-2021-23971: A website's Referrer-Policy could have been be overridden, potentially resulting in the full URL being sent as a Referrer](#CVE-2021-23971)

Reporter
Luca Moretto
Impact
moderate
##### Description

When processing a redirect with a conflicting Referrer-Policy, Firefox would have adopted the redirect's Referrer-Policy. This would have potentially resulted in more information than intended by the original origin being provided to the destination of the redirect.

##### References

* [Bug 1678545](https://bugzilla.mozilla.org/show_bug.cgi?id=1678545)

#### [#CVE-2021-23976: Local spoofing of web manifests for arbitrary pages in Firefox for Android](#CVE-2021-23976)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When accepting a malicious intent from other installed apps, Firefox for Android accepted manifests from arbitrary file paths and allowed declaring webapp manifests for other origins. This could be used to gain fullscreen access for UI spoofing and could also lead to cross-origin attacks on targeted websites.
*Note: This issue is a different issue from CVE-2020-26954 and only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684627](https://bugzilla.mozilla.org/show_bug.cgi?id=1684627)

#### [#CVE-2021-23977: Malicious application could read sensitive data from Firefox for Android's application directories](#CVE-2021-23977)

Reporter
fatal0
Impact
moderate
##### Description

Firefox for Android suffered from a time-of-check-time-of-use vulnerability that allowed a malicious application to read sensitive data from application directories.
*Note: This issue is only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684761](https://bugzilla.mozilla.org/show_bug.cgi?id=1684761)

#### [#CVE-2021-23972: HTTP Auth phishing warning was omitted when a redirect is cached](#CVE-2021-23972)

Reporter
Vijay Tikudave
Impact
low
##### Description

One phishing tactic on the web is to provide a link with HTTP Auth. For example `https://www.phishingtarget.com@evil.com`. To mitigate this type of attack, Firefox will display a warning dialog; however, this warning dialog would not have been displayed if evil.com used a redirect that was cached by the browser.

##### References

* [Bug 1683536](https://bugzilla.mozilla.org/show_bug.cgi?id=1683536)

#### [#CVE-2021-23975: about:memory Measure function caused an incorrect pointer operation](#CVE-2021-23975)

Reporter
Brian Carpenter of Geeknik Labs & Farm
Impact
low
##### Description

The developer page about:memory has a Measure function for exploring what object types the browser has allocated and their sizes. When this function was invoked we incorrectly called the sizeof function, instead of using the API method that checks for invalid pointers.

##### References

* [Bug 1685145](https://bugzilla.mozilla.org/show_bug.cgi?id=1685145)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](#CVE-2021-23978)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Firefox 85 and Firefox ESR 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

#### [#CVE-2021-23979: Memory safety bugs fixed in Firefox 86](#CVE-2021-23979)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Tyson Smith, Lars T Hansen, Valentin Gosu, and Sebastian Hengst reported memory safety bugs present in Firefox 85. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663222%2C1666607%2C1672120%2C1678463%2C1678927%2C1679560%2C1681297%2C1681684%2C1683490%2C1684377%2C1684902)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


