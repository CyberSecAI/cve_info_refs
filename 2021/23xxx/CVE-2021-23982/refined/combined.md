=== Content from www.mozilla.org_2c9cfdf4_20250115_084546.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-12

## Security Vulnerabilities fixed in Thunderbird 78.9

Announced
March 23, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-23981: Texture upload into an unbound backing buffer resulted in an out-of-bound read](#CVE-2021-23981)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A texture upload of a Pixel Buffer Object could have confused the WebGL code to skip binding the buffer used to unpack it, resulting in memory corruption and a potentially exploitable information leak or crash.

##### References

* [Bug 1692832](https://bugzilla.mozilla.org/show_bug.cgi?id=1692832)

#### [#CVE-2021-4127: Angle graphics library out of date](#CVE-2021-4127)

Reporter
Mozilla Developers, Abraruddin Khan and Omair
Impact
high
##### Description

An out of date graphics library (Angle) likely contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1691547](https://bugzilla.mozilla.org/show_bug.cgi?id=1691547)

#### [#CVE-2021-23982: Internal network hosts could have been probed by a malicious webpage](#CVE-2021-23982)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Using techniques that built on the slipstream research, a malicious webpage could have scanned both an internal network's hosts as well as services running on the user's local machine utilizing WebRTC connections.

##### References

* [Bug 1677046](https://bugzilla.mozilla.org/show_bug.cgi?id=1677046)

#### [#CVE-2021-23984: Malicious extensions could have spoofed popup information](#CVE-2021-23984)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious extension could have opened a popup window lacking an address bar. The title of the popup lacking an address bar should not be fully controllable, but in this situation was. This could have been used to spoof a website and attempt to trick the user into providing credentials.

##### References

* [Bug 1693664](https://bugzilla.mozilla.org/show_bug.cgi?id=1693664)

#### [#CVE-2021-23987: Memory safety bugs fixed in Thunderbird 78.9](#CVE-2021-23987)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Alexis Beingessner, Tyson Smith, Julien Wajsberg, and Matthew Gregan reported memory safety bugs present in Thunderbird 78.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1513519%2C1683439%2C1690169%2C1690718)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_3674978e_20250115_084545.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-11

## Security Vulnerabilities fixed in Firefox ESR 78.9

Announced
March 23, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.9

**Note**: This advisory was updated June 8, 2021 to include CVE-2021-29955 which was also fixed in this release.

#### [#CVE-2021-29955: Transient Execution Vulnerability allowed leaking arbitrary memory address](#CVE-2021-29955)

Reporter
Hany Ragab, Enrico Barberis, Herbert Bos, and Cristiano Giuffrida from the VUSec group at VU Amsterdam
Impact
high
##### Description

A transient execution vulnerability, named Floating Point Value Injection (FPVI) allowed an attacker to leak arbitrary memory addresses and may have also enabled JIT type confusion attacks. (A related vulnerability, Speculative Code Store Bypass (SCSB), did not affect Firefox.)

##### References

* [Bug 1692972](https://bugzilla.mozilla.org/show_bug.cgi?id=1692972)

#### [#CVE-2021-23981: Texture upload into an unbound backing buffer resulted in an out-of-bound read](#CVE-2021-23981)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A texture upload of a Pixel Buffer Object could have confused the WebGL code to skip binding the buffer used to unpack it, resulting in memory corruption and a potentially exploitable information leak or crash.

##### References

* [Bug 1692832](https://bugzilla.mozilla.org/show_bug.cgi?id=1692832)

#### [#CVE-2021-4127: Angle graphics library out of date](#CVE-2021-4127)

Reporter
Mozilla Developers, Abraruddin Khan and Omair
Impact
high
##### Description

An out of date graphics library (Angle) likely contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1691547](https://bugzilla.mozilla.org/show_bug.cgi?id=1691547)

#### [#CVE-2021-23982: Internal network hosts could have been probed by a malicious webpage](#CVE-2021-23982)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Using techniques that built on the slipstream research, a malicious webpage could have scanned both an internal network's hosts as well as services running on the user's local machine utilizing WebRTC connections.

##### References

* [Bug 1677046](https://bugzilla.mozilla.org/show_bug.cgi?id=1677046)

#### [#CVE-2021-23984: Malicious extensions could have spoofed popup information](#CVE-2021-23984)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious extension could have opened a popup window lacking an address bar. The title of the popup lacking an address bar should not be fully controllable, but in this situation was. This could have been used to spoof a website and attempt to trick the user into providing credentials.

##### References

* [Bug 1693664](https://bugzilla.mozilla.org/show_bug.cgi?id=1693664)

#### [#CVE-2021-23987: Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](#CVE-2021-23987)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Alexis Beingessner, Tyson Smith, Julien Wajsberg, and Matthew Gregan reported memory safety bugs present in Firefox 86 and Firefox ESR 78.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1513519%2C1683439%2C1690169%2C1690718)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_3b796b51_20250115_084544.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-10

## Security Vulnerabilities fixed in Firefox 87

Announced
March 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 87

**Note**: This advisory was updated May 3, 2021 to include CVE-2021-29951 and again on June 8, 2021 to include CVE-2021-29955 - both were also fixed in this release.

#### [#CVE-2021-29955: Transient Execution Vulnerability allowed leaking arbitrary memory address](#CVE-2021-29955)

Reporter
Hany Ragab, Enrico Barberis, Herbert Bos, and Cristiano Giuffrida from the VUSec group at VU Amsterdam
Impact
high
##### Description

A transient execution vulnerability, named Floating Point Value Injection (FPVI) allowed an attacker to leak arbitrary memory addresses and may have also enabled JIT type confusion attacks. (A related vulnerability, Speculative Code Store Bypass (SCSB), did not affect Firefox.)

##### References

* [Bug 1692972](https://bugzilla.mozilla.org/show_bug.cgi?id=1692972)

#### [#CVE-2021-23981: Texture upload into an unbound backing buffer resulted in an out-of-bound read](#CVE-2021-23981)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A texture upload of a Pixel Buffer Object could have confused the WebGL code to skip binding the buffer used to unpack it, resulting in memory corruption and a potentially exploitable information leak or crash.

##### References

* [Bug 1692832](https://bugzilla.mozilla.org/show_bug.cgi?id=1692832)

#### [#CVE-2021-29951: Mozilla Maintenance Service could have been started or stopped by domain users](#CVE-2021-29951)

Reporter
James Forshaw
Impact
moderate
##### Description

The Mozilla Maintenance Service granted SERVICE\_START access to `BUILTIN|Users` which, in a domain network, grants normal remote users access to start or stop the service. This could be used to prevent the browser update service from operating (if an attacker spammed the 'Stop' command); but also exposed attack surface in the maintenance service.
*Note: This issue only affected Windows operating systems older than Win 10 build 1709. Other operating systems are unaffected.*

##### References

* [Bug 1690062](https://bugzilla.mozilla.org/show_bug.cgi?id=1690062)

#### [#CVE-2021-23982: Internal network hosts could have been probed by a malicious webpage](#CVE-2021-23982)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Using techniques that built on the slipstream research, a malicious webpage could have scanned both an internal network's hosts as well as services running on the user's local machine utilizing WebRTC connections.

##### References

* [Bug 1677046](https://bugzilla.mozilla.org/show_bug.cgi?id=1677046)

#### [#CVE-2021-23983: Transitions for invalid ::marker properties resulted in memory corruption](#CVE-2021-23983)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

By causing a transition on a parent node by removing a CSS rule, an invalid property for a marker could have been applied, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1692684](https://bugzilla.mozilla.org/show_bug.cgi?id=1692684)

#### [#CVE-2021-23984: Malicious extensions could have spoofed popup information](#CVE-2021-23984)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious extension could have opened a popup window lacking an address bar. The title of the popup lacking an address bar should not be fully controllable, but in this situation was. This could have been used to spoof a website and attempt to trick the user into providing credentials.

##### References

* [Bug 1693664](https://bugzilla.mozilla.org/show_bug.cgi?id=1693664)

#### [#CVE-2021-23985: Devtools remote debugging feature could have been enabled without indication to the user](#CVE-2021-23985)

Reporter
Anonymous working with Trend Micro's Zero Day Initiative
Impact
low
##### Description

If an attacker is able to alter specific about:config values (for example malware running on the user's computer), the Devtools remote debugging feature could have been enabled in a way that was unnoticable to the user. This would have allowed a remote attacker (able to make a direct network connection to the victim) to monitor the user's browsing activity and (plaintext) network traffic. This was addressed by providing a visual cue when Devtools has an open network socket.

##### References

* [Bug 1659129](https://bugzilla.mozilla.org/show_bug.cgi?id=1659129)

#### [#CVE-2021-23986: A malicious extension could have performed credential-less same origin policy violations](#CVE-2021-23986)

Reporter
Armin Ebert
Impact
low
##### Description

A malicious extension with the 'search' permission could have installed a new search engine whose favicon referenced a cross-origin URL. The response to this cross-origin request could have been read by the extension, allowing a same-origin policy bypass by the extension, which should not have cross-origin permissions. This cross-origin request was made without cookies, so the sensitive information disclosed by the violation was limited to local-network resources or resources that perform IP-based authentication.

##### References

* [Bug 1692623](https://bugzilla.mozilla.org/show_bug.cgi?id=1692623)

#### [#CVE-2021-23987: Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](#CVE-2021-23987)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Matthew Gregan, Tyson Smith, Julien Wajsberg, and Alexis Beingessner reported memory safety bugs present in Firefox 86 and Firefox ESR 78.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1513519%2C1683439%2C1690169%2C1690718)

#### [#CVE-2021-23988: Memory safety bugs fixed in Firefox 87](#CVE-2021-23988)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Tyson Smith and Christian Holler reported memory safety bugs present in Firefox 86. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 87](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684994%2C1686653)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_93f7066c_20250115_084542.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1677046)
* [XML](/show_bug.cgi?ctype=xml&id=1677046)

Closed
[Bug 1677046](/show_bug.cgi?id=1677046)
(CVE-2021-23982)

Opened 4 years ago
Closed 4 years ago

# Apply existing outgoing port restrictions from Necko to WebRTC code

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Apply existing outgoing port restrictions from Necko to WebRTC code

## Categories

### (Core :: WebRTC: Networking, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Networking#WebRTC%3A%20Networking)

WebRTC: Networking
▾

Core :: WebRTC: Networking
Bugs in the networking portions of WebRTC (PeerConnection dataChannels, SCTP, DTLS, SRTP, ICE, TURN, STUN, etc)
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [87+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=87%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox85 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix) |
| firefox86 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix) |
| firefox87 | [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 87+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox85 |  | wontfix |
| firefox86 |  | wontfix |
| firefox87 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: freddy, Assigned: mjf)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e2a2be17b9bb8a1d4d7427c810996388?d=mm&size=40)  [mjf](/user_profile?user_id=546718)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, sec-moderate, Whiteboard: [post-critsmash-triage][adv-main87+][adv-esr78.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23982

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main87+][adv-esr78.9+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c19 "4 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a7882079_553429 "4 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!](/attachment.cgi?id=9202459)  [4 years ago](#c13)  [Michael Froman [:mjf]](/user_profile?user_id=546718)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c18 "4 years ago") | [Details](/attachment.cgi?id=9202459&action=edit) | [Review](/attachment.cgi?id=9202459) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9209784)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   334 bytes, text/plain |  | [Details](/attachment.cgi?id=9209784&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1677046#c0)• 4 years ago |
|  | |

This is related to [bug 1676868](/show_bug.cgi?id=1676868 "RESOLVED FIXED") (and [bug 1674735](/show_bug.cgi?id=1674735 "RESOLVED FIXED - block port 5060 for outgoing requests (potentially mitigating NAT slipstreaming)")).

We need to find out how to make TURN servers provided for WebRTC / ICE are also subject to existing port restriction for outbound connections.

CCing Nils: Can you please assign someone to ensure that we can apply these restrictions from [Necko's port block list](https://searchfox.org/mozilla-central/rev/7b07725fe9dc5d59a525990fc1dba78bc8b82af1/netwerk/base/nsIOService.cpp#104) into our WebRTC code (e.g., at <https://hg.mozilla.org/mozilla-central/file/abe51ad662bc6efbe8c637c75cd2630788d49446/dom/media/webrtc/jsapi/MediaTransportHandler.cpp#l285>)

Flags: needinfo?(drno)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1677046#c1)• 4 years ago |
|  | |

The comment at <https://bugzilla.mozilla.org/show_bug.cgi?id=1676868#c15> has a noteworthy component about using a slightly different set. This seems necessary, not to break existing functionality.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a257020_428608)• 4 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1677046#c2)• 4 years ago |
|  | |

Dan, it looks like this has been untriaged for almost 3 weeks. Anything I can do to help this move along?

Flags: needinfo?(dminor)

|  | [Dan Minor [:dminor]](/user_profile?user_id=466787) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1677046#c3)• 4 years ago |
|  | |

Sorry about that. I think Byron and Michael are most knowledgeable about this. I'll take an initial guess at setting priority and severity.

Severity: -- → S2Component: WebRTC → WebRTC: NetworkingFlags: needinfo?(mfroman)Flags: needinfo?(drno)Flags: needinfo?(docfaraday)Flags: needinfo?(dminor)Priority: -- → P1

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1677046#c4)• 4 years ago |
|  | |

We are already doing this for local ports, here: <https://searchfox.org/mozilla-central/rev/6bb59b783b193f06d6744c5ccaac69a992e9ee7b/dom/media/webrtc/transport/nr_socket_prsock.cpp#1641-1643>

It should be fairly easy to do the same for remote ports too, but I have some questions:

1. How would JS fool our ICE code into emitting something that looks like a SIP packet to an ALG? I guess you could do that with the STUN username + realm + nonce attributes? My understanding of the attack is that these fields would need to both exceed the MTU, *and* contain the "SIP packet". So I guess if you max out the length of the username (which comes from JS, and is limited to 512 bytes), and then max out both the realm and nonce (which come from the 401 from the TURN server, and are each limited to 763 bytes, and that we validate decodes to at most 128 characters of UTF-8), I guess you could break MTU in our next request, and have the second fragment look enough like a SIP message to fool an ALG into opening a port, all without exceeding our total STUN message size of 2048. It seems plausible, if a bit tricky.
2. Should we do this for UDP as well as TCP? Probably.
3. Should we do this for TLS (STUNS/TURNS)? Probably not, since that would make it impossible to emit something that looks like SIP.
4. Should we do this for plain STUN (as opposed to just TURN)? I think we handle 401 with long-term auth for STUN requests just like we do for TURN, even though it would be unusual to see this in practice, so probably?

Nils, what do you think?

Flags: needinfo?(docfaraday) → needinfo?(drno)

|  | [Samy Kamkar](/user_profile?user_id=674148) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1677046#c5)• 4 years ago |
|  | |

Hi Byron!

Just some thoughts on my side here:

1. Please note the SIP overloading the MTU is just one example but there are other ALGs that do *not* require multiple packets and can be a single line in the middle of a packet with arbitrary data on either end, IRC DCC is an example of this.
2. I'd suggest doing it for UDP for any protocols that specifically support UDP such as DNS (UDP 53) and SIP (UDP 5060/5061).
3. Ben and Greg may have more thoughts. It seems unlikely to be an issue due to the avalanche effect of modern ciphers, but I would suggest blocking the ports if possible regardless as it's a small number of ports and avoids this potentially being revisited, especially if an attacker in the future can control other portions of the cryptographic headers. Another unlikely but potential future attack would be if there's ever a mechanism for the client to recover the AES/symmetric key used or to explicitly set the key, in the case of something like AES-ECB being used, the attacker could align the username portion of the packet to block size boundary, prepare and "decrypt" their ALG attack data (which will really just produce encrypted data), then include that encrypted data at the boundary. The TURNS/STUNS would then "encrypt" the data, in reality reversing the encryption and leaving the decrypted data in the packet while the rest is encrypted and triggering the vulnerability. Again, unlikely, but it's those unlikely things that are the most fun to investigate :)
4. I would highly suggest blocking known ALG ports (for their relevant protocol of TCP or UDP) for all outbound socket mechanisms unless explicitly required, for example allowing TCP 21 for ftp:// URIs, while blocking it everywhere else.

Thanks all!

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a1844076_546718)• 4 years ago |

Flags: needinfo?(mfroman)

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1677046#c6)• 4 years ago |
|  | |

(In reply to Samy Kamkar from [comment #5](/show_bug.cgi?id=1677046#c5 "RESOLVED FIXED - Apply existing outgoing port restrictions from Necko to WebRTC code"))

> 1. Please note the SIP overloading the MTU is just one example but there are other ALGs that do *not* require multiple packets and can be a single line in the middle of a packet with arbitrary data on either end, IRC DCC is an example of this.

Just to be extra clear here: if I'm not mistaken the attacks can work with any protocol which opens additional network ports, correct?

So we are talking about SIP, H323, PPTP, RTSP, IRC. Blocking the default destination ports for these protocols for TURN makes sense as the TURN username and password allow the JS to set the outgoing content.

> 2. I'd suggest doing it for UDP for any protocols that specifically support UDP such as DNS (UDP 53) and SIP (UDP 5060/5061).

I don't fully agree here. Yes blocking the SIP ports for TURN makes sense. Blocking DNS does not make much sense to me as I'm not aware of the DNS protocol containing any other port number, which would result in ALGs opening ports on their public side.

> 3. Ben and Greg may have more thoughts. It seems unlikely to be an issue due to the avalanche effect of modern ciphers, but I would suggest blocking the ports if possible regardless as it's a small number of ports and avoids this potentially being revisited, especially if an attacker in the future can control other portions of the cryptographic headers. Another unlikely but potential future attack would be if there's ever a mechanism for the client to recover the AES/symmetric key used or to explicitly set the key, in the case of something like AES-ECB being used, the attacker could align the username portion of the packet to block size boundary, prepare and "decrypt" their ALG attack data (which will really just produce encrypted data), then include that encrypted data at the boundary. The TURNS/STUNS would then "encrypt" the data, in reality reversing the encryption and leaving the decrypted data in the packet while the rest is encrypted and triggering the vulnerability. Again, unlikely, but it's those unlikely things that are the most fun to investigate :)

I agree with Byron here that blocking encrypted protocols doesn't make that much sense to me. But maybe we should talk to our crypto expert about this.

> 4. I would highly suggest blocking known ALG ports (for their relevant protocol of TCP or UDP) for all outbound socket mechanisms unless explicitly required, for example allowing TCP 21 for ftp:// URIs, while blocking it everywhere else.

In my opinion that whole approach of blocking ports is very limited on one hand and a little bit dangerous on the other.

At least most of the modern service also can be executed on non-default ports. And if the ALGs try to be/become smart about these as well there isn't much we can do about it.

Similarly if there are ALGs which simply look for pieces of known protocols in any packet they pass along there isn't anything we can do about that either.

The reason why I'm not in favor of blocking every outgoing connection is that I'm not aware of any way for the JS to control the content of outgoing STUN packets (binding requests etc) if they are not TURN. JS can control the destination of these requests via the ICE candidates, but not the content as out implementation chooses username and password.

So if I'm not mistaken long term credentials also only apply to the usage of TURN.

Flags: needinfo?(drno)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1677046#c7)• 4 years ago |
|  | |

On the HTTP side we blocked the ports for the encrypted variants mainly out of caution as they could be misconfigured and it matches precedent for ports previously added to the list.

Is anyone in contact with the WebRTC folks at Apple and Google to coordinate a final set of ports to block for TCP and UDP? It seems per <https://w3c.github.io/webrtc-pc/> (some discussion at <https://github.com/w3c/webrtc-pc/issues/2613> too) WebRTC already reuses <https://fetch.spec.whatwg.org/#port-blocking> which would mean that the decision we arrive at in <https://github.com/whatwg/fetch/security/advisories/GHSA-p5q9-g76c-hc6f> would impact WebRTC as well, right? (I will copy Byron and Nils to that security issue shortly.)

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1677046#c8)• 4 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #7](/show_bug.cgi?id=1677046#c7 "RESOLVED FIXED - Apply existing outgoing port restrictions from Necko to WebRTC code"))

> On the HTTP side we blocked the ports for the encrypted variants mainly out of caution as they could be misconfigured and it matches precedent for ports previously added to the list.
>
> Is anyone in contact with the WebRTC folks at Apple and Google to coordinate a final set of ports to block for TCP and UDP? It seems per <https://w3c.github.io/webrtc-pc/> (some discussion at <https://github.com/w3c/webrtc-pc/issues/2613> too) WebRTC already reuses <https://fetch.spec.whatwg.org/#port-blocking> which would mean that the decision we arrive at in <https://github.com/whatwg/fetch/security/advisories/GHSA-p5q9-g76c-hc6f> would impact WebRTC as well, right? (I will copy Byron and Nils to that security issue shortly.)

I'm not sure what you mean by "WebTRC already reuses <https://fetch.spec.whatwg.org/#port-blocking>". Is that only from a spec perspective? Because Firefox WebRTC implementation currently does not block these target ports yet. I believe this is what this bug is about.

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1677046#c9)• 4 years ago |
|  | |

Yeah, I meant that the specification seems to require that.

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a6593663_546718)• 4 years ago |

Assignee: nobody → mfroman

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1677046#c10)• 4 years ago |
|  | |

I don't have access to [Bug 1676868](/show_bug.cgi?id=1676868 "RESOLVED FIXED") so I'm missing a bit of context. Can you add me to that bug?

Flags: needinfo?(fbraun)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1677046#c11)• 4 years ago |
|  | |

I added you Michael.

Flags: needinfo?(fbraun)

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1677046#c12)• 4 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #11](/show_bug.cgi?id=1677046#c11 "RESOLVED FIXED - Apply existing outgoing port restrictions from Necko to WebRTC code"))

> I added you Michael.

Thank you!

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1677046#c13)• 4 years ago |
|  | |

Attached file
[Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!](attachment.cgi?id=9202459)
— [Details](attachment.cgi?id=9202459&action=edit)

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1677046#c14)• 4 years ago |
|  | |

Good try run:

<https://treeherder.mozilla.org/jobs?repo=try&revision=fe9b214810056238fbd4ea5502a19f9f25f6bd4f>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1677046#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/8471b70b4df960d3599dcd951f0b05fb4f7bd420>

<https://hg.mozilla.org/mozilla-central/rev/8471b70b4df9>

Group: media-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 87 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a7882079_553429)• 4 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a7907951_75935)• 4 years ago |

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox87](/buglist.cgi?f1=cf_tracking_firefox87&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox87&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [87+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=87%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a8334773_578488)• 4 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main87+]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1677046#c16)• 4 years ago |
|  | |

Please request uplift to esr78 if you think we should fix this there.

Flags: needinfo?(mfroman)

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1677046#c17)• 4 years ago |
|  | |

Comment on [attachment 9202459](/attachment.cgi?id=9202459 "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!") [[details]](/attachment.cgi?id=9202459&action=edit "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!")

[Bug 1677046](/show_bug.cgi?id=1677046 "RESOLVED FIXED - Apply existing outgoing port restrictions from Necko to WebRTC code") - apply outgoing port restrictions in addNrIceServer. r?bwc!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This improves our ability to block NAT bypass techniques by applying the Necko port block list to outgoing connections.
* **User impact if declined**: Potential exposure to NAT slipstreaming.
* **Fix Landed on Version**: 87
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is a fairly small patch with very localized changes.
* **String or UUID changes made by this patch**: n/a
Flags: needinfo?(mfroman)
[Attachment #9202459](/attachment.cgi?id=9202459&action=edit "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!") -
Flags: approval-mozilla-esr78?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1677046#c18)• 4 years ago |
|  | |

Comment on [attachment 9202459](/attachment.cgi?id=9202459 "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!") [[details]](/attachment.cgi?id=9202459&action=edit "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!")

[Bug 1677046](/show_bug.cgi?id=1677046 "RESOLVED FIXED - Apply existing outgoing port restrictions from Necko to WebRTC code") - apply outgoing port restrictions in addNrIceServer. r?bwc!

Approved for 78.9esr.

[Attachment #9202459](/attachment.cgi?id=9202459&action=edit "Bug 1677046 - apply outgoing port restrictions in addNrIceServer. r?bwc!") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1677046#c19)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/dbfd477ed098>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a10739467_578488)• 4 years ago |

Whiteboard: [post-critsmash-triage][adv-main87+] → [post-critsmash-triage][adv-main87+][adv-esr78.9+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1677046#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9209784)
— [Details](attachment.cgi?id=9209784&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a10916165_578488)• 4 years ago |

Alias: CVE-2021-23982

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677046#a32395652_1689)• 3 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1677046&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Michael Froman [:mjf]](/user_profile?user_id=546718)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


