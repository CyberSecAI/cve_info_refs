=== Content from github.com_629f8cfd_20250114_180429.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fcommit%2F387116f5c72efa42bc3938d946b4c8d2f22181b7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fcommit%2F387116f5c72efa42bc3938d946b4c8d2f22181b7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=carrierwaveuploader%2Fcarrierwave)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[carrierwaveuploader](/carrierwaveuploader)
/
**[carrierwave](/carrierwaveuploader/carrierwave)**
Public

* [Notifications](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)
* [Star
   8.8k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)

* [Code](/carrierwaveuploader/carrierwave)
* [Issues
  33](/carrierwaveuploader/carrierwave/issues)
* [Pull requests
  5](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects
  0](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

Additional navigation options

* [Code](/carrierwaveuploader/carrierwave)
* [Issues](/carrierwaveuploader/carrierwave/issues)
* [Pull requests](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

## Commit

[Permalink](/carrierwaveuploader/carrierwave/commit/387116f5c72efa42bc3938d946b4c8d2f22181b7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix Code Injection vulnerability in CarrierWave::RMagick

[Browse files](/carrierwaveuploader/carrierwave/tree/387116f5c72efa42bc3938d946b4c8d2f22181b7)
Browse the repository at this point in the history

```
Refs. [GHSA-cf3w-g86h-35x4](https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-cf3w-g86h-35x4 "GHSA-cf3w-g86h-35x4")
```

* Loading branch information

[![@mshibuya](https://avatars.githubusercontent.com/u/486678?s=40&v=4)](/mshibuya)

[mshibuya](/carrierwaveuploader/carrierwave/commits?author=mshibuya "View all commits by mshibuya")
committed
Feb 8, 2021

1 parent
[012702e](/carrierwaveuploader/carrierwave/commit/012702eb3ba1663452aa025831caa304d1a665c0)

commit 387116f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**42 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/carrierwave/processing

  + lib/carrierwave/processing/rmagick.rb
    [rmagick.rb](#diff-a1af6219d7949c25424fc179898de81dbface3bba253639706b6b6804758f25b)
* spec/processing

  + spec/processing/rmagick\_spec.rb
    [rmagick\_spec.rb](#diff-ecf2c98a7ef6f73583acc25fd7bcfcfbc3663234671a5eed877d8b223c3c10f0)

## There are no files selected for viewing

12 changes: 9 additions & 3 deletions

12
[lib/carrierwave/processing/rmagick.rb](#diff-a1af6219d7949c25424fc179898de81dbface3bba253639706b6b6804758f25b "lib/carrierwave/processing/rmagick.rb")

Show comments

[View file](/carrierwaveuploader/carrierwave/blob/387116f5c72efa42bc3938d946b4c8d2f22181b7/lib/carrierwave/processing/rmagick.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -378,9 +378,15 @@ def manipulate!(options={}, &block) |
|  |  |  |
|  |  | def create\_info\_block(options) |
|  |  | return nil unless options |
|  |  | assignments = options.map { |k, v| "img.#{k} = #{v}" } |
|  |  | code = "lambda { |img| " + assignments.join(";") + "}" |
|  |  | eval code |
|  |  | proc do |img| |
|  |  | options.each do |k, v| |
|  |  | if v.is\_a?(String) && (matches = v.match(/^["'](.+)["']/)) |
|  |  | ActiveSupport::Deprecation.warn "Passing quoted strings like #{v} to #manipulate! is deprecated, pass them without quoting." |
|  |  | v = matches[1] |
|  |  | end |
|  |  | img.public\_send(:"#{k}=", v) |
|  |  | end |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | def destroy\_image(image) |
| Expand Down | |  |

34 changes: 33 additions & 1 deletion

34
[spec/processing/rmagick\_spec.rb](#diff-ecf2c98a7ef6f73583acc25fd7bcfcfbc3663234671a5eed877d8b223c3c10f0 "spec/processing/rmagick_spec.rb")

Show comments

[View file](/carrierwaveuploader/carrierwave/blob/387116f5c72efa42bc3938d946b4c8d2f22181b7/spec/processing/rmagick_spec.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -208,9 +208,41 @@ |
|  |  |  |
|  |  | instance.manipulate! :read => { |
|  |  | :density => 10, |
|  |  | :size => %{"200x200"} |
|  |  | :size => "200x200" |
|  |  | } |
|  |  | end |
|  |  |  |
|  |  | it 'shows deprecation but still accepts strings enclosed with double quotes' do |
|  |  | expect\_any\_instance\_of(::Magick::Image::Info).to receive(:size=).once.with("200x200") |
|  |  | expect(ActiveSupport::Deprecation).to receive(:warn).with(any\_args) |
|  |  | instance.manipulate! :read => {:size => %{"200x200"}} |
|  |  | end |
|  |  |  |
|  |  | it 'shows deprecation but still accepts strings enclosed with single quotes' do |
|  |  | expect\_any\_instance\_of(::Magick::Image::Info).to receive(:size=).once.with("200x200") |
|  |  | expect(ActiveSupport::Deprecation).to receive(:warn).with(any\_args) |
|  |  | instance.manipulate! :read => {:size => %{'200x200'}} |
|  |  | end |
|  |  |  |
|  |  | it 'does not allow arbitrary code execution' do |
|  |  | expect\_any\_instance\_of(Kernel).not\_to receive(:puts) |
|  |  | expect do |
|  |  | instance.manipulate! :read => { |
|  |  | :density => "1 }; raise; {" |
|  |  | } |
|  |  | end.to raise\_error ArgumentError, /invalid density geometry/ |
|  |  | end |
|  |  |  |
|  |  | it 'does not allow invocation of non-public methods' do |
|  |  | module Kernel |
|  |  | private def foo=(value); raise; end |
|  |  | end |
|  |  | expect do |
|  |  | instance.manipulate! :read => { |
|  |  | :foo => "1" |
|  |  | } |
|  |  | end.to raise\_error NoMethodError, /private method `foo=' called/ |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | describe "#width and #height" do |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `387116f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fcommit%2F387116f5c72efa42bc3938d946b4c8d2f22181b7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d42f2191_20250114_180429.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=carrierwaveuploader%2Fcarrierwave)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[carrierwaveuploader](/carrierwaveuploader)
/
**[carrierwave](/carrierwaveuploader/carrierwave)**
Public

* [Notifications](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)
* [Star
   8.8k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)

* [Code](/carrierwaveuploader/carrierwave)
* [Issues
  33](/carrierwaveuploader/carrierwave/issues)
* [Pull requests
  5](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects
  0](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

Additional navigation options

* [Code](/carrierwaveuploader/carrierwave)
* [Issues](/carrierwaveuploader/carrierwave/issues)
* [Pull requests](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

## Files

 master
## Breadcrumbs

1. [carrierwave](/carrierwaveuploader/carrierwave/tree/master)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/carrierwaveuploader/carrierwave/commits/master/CHANGELOG.md)172 lines (132 loc) · 21.2 KB master
## Breadcrumbs

1. [carrierwave](/carrierwaveuploader/carrierwave/tree/master)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

172 lines (132 loc) · 21.2 KB[Raw](https://github.com/carrierwaveuploader/carrierwave/raw/refs/heads/master/CHANGELOG.md)
# Carrierwave History/Changelog

All notable changes to this project will be documented in this file.
This project adheres to [Semantic Versioning](http://semver.org/).

## [Unreleased]

## 3.1.1 - 2025-01-12

### Fixed

* Stop calling #mb\_chars, as it is no longer necessary (@chaadow [#2773](https://github.com/carrierwaveuploader/carrierwave/pull/2773))
* Fix to raise error when imagemagick is missing on Alpine >= 3.19 (@danwilliams-fl [#2772](https://github.com/carrierwaveuploader/carrierwave/pull/2772))
* Fix #dup with custom serialisation (@nassim-platogo [#2771](https://github.com/carrierwaveuploader/carrierwave/pull/2771))
* Fix SanitizedFile#read to behave in the same way with IO#read with arguments (@mshibuya [9eace1c](https://github.com/carrierwaveuploader/carrierwave/commit/9eace1c7625808565baeb72a52ec293589b62dfe), [#2770](https://github.com/carrierwaveuploader/carrierwave/issues/2770))

## 3.1.0 - 2024-12-14

*No changes.*

## 3.1.0.rc - 2024-12-07

### Added

* Support for AWS S3 FIPS endpoints (@matt-domsch-sp [#2763](https://github.com/carrierwaveuploader/carrierwave/pull/2763), [04bfab3](https://github.com/carrierwaveuploader/carrierwave/commit/04bfab3f00b8290965e72fd944a8beb0477c5e8e), [#2762](https://github.com/carrierwaveuploader/carrierwave/issues/2762))
* Add CarrierWave::Storage::Fog::File#empty? (@mshibuya [2d1af56](https://github.com/carrierwaveuploader/carrierwave/commit/2d1af56cd798da65b16b2285f67ef049f0af8c35), [#1926](https://github.com/carrierwaveuploader/carrierwave/issues/1926))

### Changed

* Show warning when conditionals are used with :convert (@mshibuya [fb287f3](https://github.com/carrierwaveuploader/carrierwave/commit/fb287f326eb6d4e759f56ec1f008c957466b0331), [#2723](https://github.com/carrierwaveuploader/carrierwave/issues/2723))
* Rename #version\_exists? to #version\_active?, to reduce confusion (@mshibuya [21ca90a](https://github.com/carrierwaveuploader/carrierwave/commit/21ca90a1b0ecfd5a10b82af43c03bee6bedf2801), [#1926](https://github.com/carrierwaveuploader/carrierwave/issues/1926))

### Fixed

* Fix incompatibility with MiniMagick >= 5.0 (@mshibuya [a60d8d8](https://github.com/carrierwaveuploader/carrierwave/commit/a60d8d8a33bc2aa6b0ff09c745def6b8e1a892e9), [#2761](https://github.com/carrierwaveuploader/carrierwave/issues/2761))
* Fix incompatibility with uri gem >= 1.0 (@ollym [#2760](https://github.com/carrierwaveuploader/carrierwave/pull/2760), [#2759](https://github.com/carrierwaveuploader/carrierwave/issues/2759))
* Clear download errors on reassigning remote urls (@mshibuya [bb8c6e1](https://github.com/carrierwaveuploader/carrierwave/commit/bb8c6e1f9eccae8650c70ab46ca487ec878cda0b), [#2725](https://github.com/carrierwaveuploader/carrierwave/issues/2725))

## 3.1.0.beta - 2024-09-01

### Added

* Add support for the `crop` processing method (@clickworkorange [#2721](https://github.com/carrierwaveuploader/carrierwave/pull/2721))
* Add global `skip_ssrf_protection` configuration (@rajyan [#2696](https://github.com/carrierwaveuploader/carrierwave/pull/2696), [#2695](https://github.com/carrierwaveuploader/carrierwave/issues/2695))

### Changed

* Show warning if #filename is safeguarded as in the pre-3.x style (@mshibuya [#2718](https://github.com/carrierwaveuploader/carrierwave/pull/2718), [#2708](https://github.com/carrierwaveuploader/carrierwave/issues/2708))

### Fixed

* Fix version names starting with a non-alphabet character lead to NameError (@r7kamura [#2748](https://github.com/carrierwaveuploader/carrierwave/pull/2748), [#2722](https://github.com/carrierwaveuploader/carrierwave/issues/2722))
* Fix Rails 7.2 incompatibility due to incorrect use of ActiveSupport::Deprecation (@mshibuya [b25477d](https://github.com/carrierwaveuploader/carrierwave/commit/b25477d4dc2b32ee3da896714b081e6123737fa3), [8761240](https://github.com/carrierwaveuploader/carrierwave/commit/8761240283abc2e58bd97004f30a9419cad34109), [#2751](https://github.com/carrierwaveuploader/carrierwave/issues/2751))
* Fix assigning a file with the same name not marking the column as changed (@mshibuya [47f1737](https://github.com/carrierwaveuploader/carrierwave/commit/47f1737443f47cd188e555836b26ccdfcee91d49), [#2719](https://github.com/carrierwaveuploader/carrierwave/issues/2719))
* Fix content type magic detection for files packaged in .zip (@dzhikvas [#2705](https://github.com/carrierwaveuploader/carrierwave/pull/2705), [#2704](https://github.com/carrierwaveuploader/carrierwave/issues/2704))

## 3.0.7 - 2024-03-23

### Security

* Fix Content-Type allowlist bypass vulnerability remained (@mshibuya [00676e2](https://github.com/carrierwaveuploader/carrierwave/commit/00676e23d7f4beac12beddee6f2486b686fb7e46), [GHSA-vfmv-jfc5-pjjw](https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-vfmv-jfc5-pjjw))

## 3.0.6 - 2024-03-09

### Fixed

* Fix #derived\_versions and #active\_sibling\_versions returning an Array where Hash is expected (@mshibuya [46e4f20](https://github.com/carrierwaveuploader/carrierwave/commit/46e4f20f8f85f75043cec76aa1f331c55a3ba103))
* Fix incompatibility with Marcel 1.0.3 (@schinery [#2728](https://github.com/carrierwaveuploader/carrierwave/pull/2728), [#2729](https://github.com/carrierwaveuploader/carrierwave/issues/2729))
* Fix assigning a file with the same name not marking the column as changed (@mshibuya [4c65b39](https://github.com/carrierwaveuploader/carrierwave/commit/4c65b393cd85b66bc256d04363cf3e3a97c8fd64), [#2719](https://github.com/carrierwaveuploader/carrierwave/issues/2719))
* Fix failing to remove files with ActiveRecord 7.1 after\_commit order change enabled (@mshibuya [63113e9](https://github.com/carrierwaveuploader/carrierwave/commit/63113e96dc172114cb92af239ba73e50ed8a72f2), [#2713](https://github.com/carrierwaveuploader/carrierwave/issues/2713))

## 3.0.5 - 2023-11-29

### Fixed

* Remove unnecessary if clause within #filename left in the uploader template (@rajyan, [#2711](https://github.com/carrierwaveuploader/carrierwave/pull/2711))

### Security

* Fix Content-Type allowlist bypass vulnerability, possibly leading to XSS (@mshibuya, [863d425](https://github.com/carrierwaveuploader/carrierwave/commit/863d425c76eba12c3294227b39018f6b2dccbbf3), [GHSA-gxhx-g4fq-49hj](https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-gxhx-g4fq-49hj))

## 3.0.4 - 2023-10-08

### Fixed

* Fix model's dirty state remaining after update (@rajyan [#2707](https://github.com/carrierwaveuploader/carrierwave/pull/2707), [#2702](https://github.com/carrierwaveuploader/carrierwave/issues/2702))
* Fix #dup modifying the original object (@rajyan [#2690](https://github.com/carrierwaveuploader/carrierwave/pull/2690), [#2706](https://github.com/carrierwaveuploader/carrierwave/pull/2706), [#2689](https://github.com/carrierwaveuploader/carrierwave/issues/2689), [#2700](https://github.com/carrierwaveuploader/carrierwave/issues/2700))
* Fix #dup not respecting the :mount\_on option, causing MissingAttributeError (@marsz [#2691](https://github.com/carrierwaveuploader/carrierwave/pull/2691))

## 3.0.3 - 2023-08-21

### Fixed

* Fix #dup modifying the original object (@mshibuya [37f36f7](https://github.com/carrierwaveuploader/carrierwave/commit/37f36f7ccf035ffb19cbd3964928b3abf2d5e1b1), [#2687](https://github.com/carrierwaveuploader/carrierwave/issues/2687))
* Fix wrongly removing files on transaction rollback (@mshibuya, @rajyan [eb03fe1](https://github.com/carrierwaveuploader/carrierwave/commit/eb03fe124c3a7acf3ffc913c7d432208ba3aa7ca), [#2686](https://github.com/carrierwaveuploader/carrierwave/pull/2686), [#2685](https://github.com/carrierwaveuploader/carrierwave/issues/2685))

## 3.0.2 - 2023-08-01

### Fixed

* Fix deduplicated filename not being persisted (@mshibuya [#2679](https://github.com/carrierwaveuploader/carrierwave/pull/2679), [#2678](https://github.com/carrierwaveuploader/carrierwave/issues/2678), [#2677](https://github.com/carrierwaveuploader/carrierwave/pull/2677))

## 3.0.1 - 2023-07-22

### Fixed

* Fix not respecting the parent's #enable\_processing value after reading its own (@mshibuya [2df0f53](https://github.com/carrierwaveuploader/carrierwave/commit/2df0f53f1d5fa30a198aa148ef33f1ab924404e4), [#2676](https://github.com/carrierwaveuploader/carrierwave/issues/2676))
* Fix NoMethodError when a record is rolled back (@y-yagi [#2674](https://github.com/carrierwaveuploader/carrierwave/pull/2674), [#2675](https://github.com/carrierwaveuploader/carrierwave/issues/2675))
* Fix filename suffix being removed due to unnecessary deduplication (@mshibuya [d68a111](https://github.com/carrierwaveuploader/carrierwave/commit/d68a1111cfae4309d703caa19d9c19226bc01686), [#2672](https://github.com/carrierwaveuploader/carrierwave/issues/2672))
* Fix #dup causing unintended name deduplication of copied files (@mshibuya [b732acd](https://github.com/carrierwaveuploader/carrierwave/commit/b732acd63209897e6375a3706330df2c38e3f327), [#2670](https://github.com/carrierwaveuploader/carrierwave/issues/2670))
* Fix initialization failing when active\_support/core\_ext is not loaded yet (@mshibuya [875d972](https://github.com/carrierwaveuploader/carrierwave/commit/875d972dc78b8416de7768457793baa4d6220a4f))

## 3.0.0 - 2023-07-02

*No changes.*

## 3.0.0.rc - 2023-06-11

### Added

* Support adding suffix to filename on store when path collides with the existing ones (@mshibuya [07a5632](https://github.com/carrierwaveuploader/carrierwave/commit/07a5632a3f30ddcb21b10a75f003a7eaeaa072ad), [#1855](https://github.com/carrierwaveuploader/carrierwave/issues/1855))
* Add image dimension validation (@TsubasaYoshida [#2592](https://github.com/carrierwaveuploader/carrierwave/pull/2592), [3b1f8b4](https://github.com/carrierwaveuploader/carrierwave/commit/3b1f8b41f8c0896aa6ebe64bac23622c14a8b8d9))
* Provide validation error details via ActiveModel::Errors#details (@mshibuya [9013999](https://github.com/carrierwaveuploader/carrierwave/commit/90139995fc11978da909db71b1d43c0690c7c9d2), [#2150](https://github.com/carrierwaveuploader/carrierwave/issues/2150))
* Support clearing #remote\_urls by assigning nil (@mshibuya [8307f93](https://github.com/carrierwaveuploader/carrierwave/commit/8307f93c29b833d34efaae63c33d36e737d94715), [#2067](https://github.com/carrierwaveuploader/carrierwave/issues/2067))
* Support configuration of download retry wait time (@tricknotes [#2646](https://github.com/carrierwaveuploader/carrierwave/pull/2646))
* Support for ActiveRecord::Base#dup (@mshibuya, @BrianHawley [19b33b8](https://github.com/carrierwaveuploader/carrierwave/commit/19b33b876cd58e7af28dc718fd4f47bb539b78f9), [#2645](https://github.com/carrierwaveuploader/carrierwave/pull/2645), [#1962](https://github.com/carrierwaveuploader/carrierwave/issues/1962))
* Add CarrierWave::Storage::Fog::File#to\_file for interface consistency with SanitizedFile (@mshibuya [68ce83a](https://github.com/carrierwaveuploader/carrierwave/commit/68ce83a7b105d52c6af1b410727dd590c3960f7d), [#1960](https://github.com/carrierwaveuploader/carrierwave/issues/1960))
* Allow SanitizedFile to accept read with an optional length and output\_buffer arguments (@mshibuya [9096459](https://github.com/carrierwaveuploader/carrierwave/commit/90964596aa3d0b7acea584012f0f5888d622ea1b), [#1959](https://github.com/carrierwaveuploader/carrierwave/issues/1959))

### Changed

* Stop relying on ActiveModel::Dirty change tracking for removal of unnecessary files (@mshibuya [aac25c1](https://github.com/carrierwaveuploader/carrierwave/commit/aac25c10af4218d6e1e70f90154b847b54ce0334))
* Create versions lazily to reflect subclass configurations properly (@mshibuya [1531a67](https://github.com/carrierwaveuploader/carrierwave/commit/1531a67366f0e25e3d298133a72c81b6c9c0dc83), [#1957](https://github.com/carrierwaveuploader/carrierwave/issues/1957), [#2619](https://github.com/carrierwaveuploader/carrierwave/issues/2619))
* [BREAKING CHANGE] Use the resulting file extension on changing format by :convert (@mshibuya [#2659](https://github.com/carrierwaveuploader/carrierwave/pull/2659), [#2125](https://github.com/carrierwaveuploader/carrierwave/issues/2125), [#2126](https://github.com/carrierwaveuploader/carrierwave/issues/2126), [#2254](https://github.com/carrierwaveuploader/carrierwave/issues/2254))
* Prioritize Magic-detected content type for spoof-tolerance (@mshibuya [a2ca59c](https://github.com/carrierwaveuploader/carrierwave/commit/a2ca59cbe67046ba7818c64849a9a4ffa90306db), [#2570](https://github.com/carrierwaveuploader/carrierwave/issues/2570))
* Handle assignments in an ActiveModel::Dirty-friendly way (@mshibuya [#2658](https://github.com/carrierwaveuploader/carrierwave/pull/2658), [#2404](https://github.com/carrierwaveuploader/carrierwave/issues/2404), [#2409](https://github.com/carrierwaveuploader/carrierwave/issues/2409), [#2468](https://github.com/carrierwaveuploader/carrierwave/issues/2468))
* Give a stable name to classes created by the mount\_uploader block (@mshibuya [f5b09b8](https://github.com/carrierwaveuploader/carrierwave/commit/f5b09b844d99245a3b4d0ba01efd4972be4ee5be), [#2407](https://github.com/carrierwaveuploader/carrierwave/issues/2407), [#2471](https://github.com/carrierwaveuploader/carrierwave/issues/2471))
* Give a stable name to version classes (@mshibuya [a9de756](https://github.com/carrierwaveuploader/carrierwave/commit/a9de7565eabb4cdca05bb090cdf797eb1720c09c), [#2407](https://github.com/carrierwaveuploader/carrierwave/issues/2407), [#2471](https://github.com/carrierwaveuploader/carrierwave/issues/2471))

### Fixed

* Fix CarrierWave::Storage::Fog::File#read breaking when the file doesn't exist (@mshibuya [246eb01](https://github.com/carrierwaveuploader/carrierwave/commit/246eb012e15a75f7621bf9933f90a0f4742bd6e8), [#2524](https://github.com/carrierwaveuploader/carrierwave/issues/2524))
* Fix to preserve the original URI as much as possible on download (@mshibuya [2f3afaf](https://github.com/carrierwaveuploader/carrierwave/commit/2f3afafb738ae848a8a2d164780571cf9a7eb6ce), [#2631](https://github.com/carrierwaveuploader/carrierwave/issues/2631))
* Fix not to invoke content type detection on #copy\_to as it's costly (@mshibuya [6c6e2dc](https://github.com/carrierwaveuploader/carrierwave/commit/6c6e2dc9cf7747c0c1571d315473b246ef582e1f), [#2465](https://github.com/carrierwaveuploader/carrierwave/issues/2465))
* Fix calling #=~ on non-String breaking in Ruby 3.2 (@aubinlrx [#2653](https://github.com/carrierwaveuploader/carrierwave/pull/2653), [fd03ddd](https://github.com/carrierwaveuploader/carrierwave/commit/fd03dddef55025cab83936fc2957e3c8c58772ae))
* Fix #clean\_cache! to respect the uploader's root, not the global one (@sawasaki-narumi [#2652](https://github.com/carrierwaveuploader/carrierwave/pull/2652), [3cb9992](https://github.com/carrierwaveuploader/carrierwave/commit/3cb9992cc5fb8b113fe5b050651361f35d94adb4), [#2113](https://github.com/carrierwaveuploader/carrierwave/issues/2113))
* Fix to use helper method #fog\_provider instead of checking #fog\_credentials (@joshuamsager [#2660](https://github.com/carrierwaveuploader/carrierwave/pull/2660))
* Fix being unable to delete a file by assigning nil (@mshibuya [f8ea354](https://github.com/carrierwaveuploader/carrierwave/commit/f8ea35445e51c438b8cc8baf3e50079b5d423e34), [#2654](https://github.com/carrierwaveuploader/carrierwave/issues/2654), [#2613](https://github.com/carrierwaveuploader/carrierwave/pull/2613))
* Fix to raise exception when ImageMagick is not installed (@mshibuya [d90c399](https://github.com/carrierwaveuploader/carrierwave/commit/d90c399a6d2338203b1382f4ac4269863444d60d), [#2060](https://github.com/carrierwaveuploader/carrierwave/issues/2060))
* Fix to remove unnecessary floodfill in CarrierWave::RMagick#resize\_and\_pad (@mshibuya [f34a9bd](https://github.com/carrierwaveuploader/carrierwave/commit/f34a9bd26ed3e1006033a783c2ae8d86369993f6))
* Fix `#{column}_cache=` fails to be stored when set as a nested attribute (@mshibuya [e84d11e](https://github.com/carrierwaveuploader/carrierwave/commit/e84d11ec508d286ebab28195da815816abc62e41), [#2206](https://github.com/carrierwaveuploader/carrierwave/issues/2206))
* Fix to use AWS S3 regional endpoints when using virtual-hosted style (@mshibuya [8dace34](https://github.com/carrierwaveuploader/carrierwave/commit/8dace3456b5d1e0c3212ed1dc6c8b47dfd63b8ff), [#2523](https://github.com/carrierwaveuploader/carrierwave/issues/2523))
* Fix to respect condition on processing a derived version (@mshibuya [1fecddc](https://github.com/carrierwaveuploader/carrierwave/commit/1fecddc8ffe43426e9b5044dedfa7ac0b091cad8), [#2516](https://github.com/carrierwaveuploader/carrierwave/issues/2516))
* Fix #recreate\_versions! affecting the original file (@mshibuya [a67bfb6](https://github.com/carrierwaveuploader/carrierwave/commit/a67bfb696dcba14c7cdfa2c1b5481f04d3ef8dae), [5f00715](https://github.com/carrierwaveuploader/carrierwave/commit/5f00715747d44dd7f57ee990a6b471ed786ac764), [#2480](https://github.com/carrierwaveuploader/carrierwave/issues/2480), [#2655](https://github.com/carrierwaveuploader/carrierwave/issues/2655))
* Fix `remove_#{column}!` doesn't remove the file immediately (@mshibuya [b719fb3](https://github.com/carrierwaveuploader/carrierwave/commit/b719fb373c48f23e874dfa1a333a954c01967fc1), [#2540](https://github.com/carrierwaveuploader/carrierwave/issues/2540))
* Fix column value populated without a file when using filename override (@mshibuya [f1eff6e](https://github.com/carrierwaveuploader/carrierwave/commit/f1eff6e212fb0c374c9235968bfc4e7580bf1e2a), [#2284](https://github.com/carrierwaveuploader/carrierwave/issues/2284))
* Fix boolean configurations couldn't be set to false on a per-uploader basis (@megane42 [#2642](https://github.com/carrierwaveuploader/carrierwave/pull/2642))
* Fix #clean\_cache! breaking with directories that doesn't conform to CarrierWave's cache\_id format (@BrianHawley [#2641](https://github.com/carrierwaveuploader/carrierwave/pull/2641))

## 3.0.0.beta - 2022-11-19

### Added

* Add basename and fix extension value for fog file (@leductienttkt [#2587](https://github.com/carrierwaveuploader/carrierwave/pull/2587))
* Allow uploaders to accept unless conditions (@Vpatel1093 [#2588](https://github.com/carrierwaveuploader/carrierwave/pull/2588))
* Add retry option to download from remote url (@tashirosota [#2577](https://github.com/carrierwaveuploader/carrierwave/pull/2577))

### Deprecated

* #denylist was deprecated to prefer explicitly opting-in (@mshibuya [7a40ef7](https://github.com/carrierwaveuploader/carrierwave/commit/7a40ef7c4d5f3033f0f8401323f80bde14ca72b9), [#2536](https://github.com/carrierwaveuploader/carrierwave/issues/2536))

### Changed

* Completely migrate to allowlist/denylist terminology (@mshibuya [7a40ef7](https://github.com/carrierwaveuploader/carrierwave/commit/7a40ef7c4d5f3033f0f8401323f80bde14ca72b9), [#2536](https://github.com/carrierwaveuploader/carrierwave/issues/2536))
* Remove implementation-dependent information from an error message (@akihikodaki [#2499](https://github.com/carrierwaveuploader/carrierwave/pull/2499))
* Replace mini\_mime with marcel (@pjmartorell [#2552](https://github.com/carrierwaveuploader/carrierwave/pull/2552))
* [BREAKING CHANGE] Change to store files on after\_save hook instead of after\_commit, with performing cleanup when transaction is rolled back (@fsateler [#2546](https://github.com/carrierwaveuploader/carrierwave/pull/2546))

### Removed

* Drop support for Ruby < 2.5 and Rails 5.x (@mshibuya [229594f](https://github.com/carrierwaveuploader/carrierwave/commit/229594fb2ac7cfa59586162c0b3fc3d0b5bab978))
* Remove support for Merb (@seuros [#2566](https://github.com/carrierwaveuploader/carrierwave/pull/2566))

### Fixed

* Add Workaround for 'undefined method closed?' error caused by ssrf\_filter 1.1 (@mshibuya [65bf0d9](https://github.com/carrierwaveuploader/carrierwave/commit/65bf0d94759f7d522a36698d4b81e3635b8ca572), [#2628](https://github.com/carrierwaveuploader/carrierwave/issues/2628))
* Fix Ruby 2.7 keyword argument warning in uploader process (@nachiket87 [#2636](https://github.com/carrierwaveuploader/carrierwave/pull/2636), [#2635](https://github.com/carrierwaveuploader/carrierwave/issues/2635))
* Raise DownloadError when no content is returned (@BrianHawley [#2633](https://github.com/carrierwaveuploader/carrierwave/pull/2633), [#2632](https://github.com/carrierwaveuploader/carrierwave/issues/2632))
* Add workaround for the API change in ssrf\_filter 1.1 (@BrianHawley [#2629](https://github.com/carrierwaveuploader/carrierwave/pull/2629), [#2625](https://github.com/carrierwaveuploader/carrierwave/issues/2625))
* Fix Content-Type not being copied when using fog-google (@smnscp [#2614](https://github.com/carrierwaveuploader/carrierwave/pull/2614))
* Fix failing to save after limiting the columns with ActiveRecord's #select (@wonda-tea-coffee [#2613](https://github.com/carrierwaveuploader/carrierwave/pull/2613), [#2608](https://github.com/carrierwaveuploader/carrierwave/issues/2608))
* Fix content type detection for JSON files (@smnscp [#2618](https://github.com/carrierwaveuploader/carrierwave/pull/2618))
* Remove invalid byte sequences from the sanitized filename (@alexdunae [#2606](https://github.com/carrierwaveuploader/carrierwave/pull/2606))
* Fix issue with copying a fog file larger than 5GB (@slonopotamus [#2583](https://github.com/carrierwaveuploader/carrierwave/pull/2583))
* Stop closing StringIO-based file after CarrierWave::SanitizedFile#read (@aleksandrs-ledovskis [#2571](https://github.com/carrierwaveuploader/carrierwave/pull/2571))

Please check [2.x-stable](https://github.com/carrierwaveuploader/carrierwave/blob/2.x-stable/CHANGELOG.md) for previous changes.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b2e0bfad_20250114_180429.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=carrierwaveuploader%2Fcarrierwave)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[carrierwaveuploader](/carrierwaveuploader)
/
**[carrierwave](/carrierwaveuploader/carrierwave)**
Public

* [Notifications](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)
* [Star
   8.8k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)

* [Code](/carrierwaveuploader/carrierwave)
* [Issues
  33](/carrierwaveuploader/carrierwave/issues)
* [Pull requests
  5](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects
  0](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

Additional navigation options

* [Code](/carrierwaveuploader/carrierwave)
* [Issues](/carrierwaveuploader/carrierwave/issues)
* [Pull requests](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

## Files

 master
## Breadcrumbs

1. [carrierwave](/carrierwaveuploader/carrierwave/tree/master)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/carrierwaveuploader/carrierwave/commits/master/CHANGELOG.md)172 lines (132 loc) · 21.2 KB master
## Breadcrumbs

1. [carrierwave](/carrierwaveuploader/carrierwave/tree/master)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

172 lines (132 loc) · 21.2 KB[Raw](https://github.com/carrierwaveuploader/carrierwave/raw/refs/heads/master/CHANGELOG.md)
# Carrierwave History/Changelog

All notable changes to this project will be documented in this file.
This project adheres to [Semantic Versioning](http://semver.org/).

## [Unreleased]

## 3.1.1 - 2025-01-12

### Fixed

* Stop calling #mb\_chars, as it is no longer necessary (@chaadow [#2773](https://github.com/carrierwaveuploader/carrierwave/pull/2773))
* Fix to raise error when imagemagick is missing on Alpine >= 3.19 (@danwilliams-fl [#2772](https://github.com/carrierwaveuploader/carrierwave/pull/2772))
* Fix #dup with custom serialisation (@nassim-platogo [#2771](https://github.com/carrierwaveuploader/carrierwave/pull/2771))
* Fix SanitizedFile#read to behave in the same way with IO#read with arguments (@mshibuya [9eace1c](https://github.com/carrierwaveuploader/carrierwave/commit/9eace1c7625808565baeb72a52ec293589b62dfe), [#2770](https://github.com/carrierwaveuploader/carrierwave/issues/2770))

## 3.1.0 - 2024-12-14

*No changes.*

## 3.1.0.rc - 2024-12-07

### Added

* Support for AWS S3 FIPS endpoints (@matt-domsch-sp [#2763](https://github.com/carrierwaveuploader/carrierwave/pull/2763), [04bfab3](https://github.com/carrierwaveuploader/carrierwave/commit/04bfab3f00b8290965e72fd944a8beb0477c5e8e), [#2762](https://github.com/carrierwaveuploader/carrierwave/issues/2762))
* Add CarrierWave::Storage::Fog::File#empty? (@mshibuya [2d1af56](https://github.com/carrierwaveuploader/carrierwave/commit/2d1af56cd798da65b16b2285f67ef049f0af8c35), [#1926](https://github.com/carrierwaveuploader/carrierwave/issues/1926))

### Changed

* Show warning when conditionals are used with :convert (@mshibuya [fb287f3](https://github.com/carrierwaveuploader/carrierwave/commit/fb287f326eb6d4e759f56ec1f008c957466b0331), [#2723](https://github.com/carrierwaveuploader/carrierwave/issues/2723))
* Rename #version\_exists? to #version\_active?, to reduce confusion (@mshibuya [21ca90a](https://github.com/carrierwaveuploader/carrierwave/commit/21ca90a1b0ecfd5a10b82af43c03bee6bedf2801), [#1926](https://github.com/carrierwaveuploader/carrierwave/issues/1926))

### Fixed

* Fix incompatibility with MiniMagick >= 5.0 (@mshibuya [a60d8d8](https://github.com/carrierwaveuploader/carrierwave/commit/a60d8d8a33bc2aa6b0ff09c745def6b8e1a892e9), [#2761](https://github.com/carrierwaveuploader/carrierwave/issues/2761))
* Fix incompatibility with uri gem >= 1.0 (@ollym [#2760](https://github.com/carrierwaveuploader/carrierwave/pull/2760), [#2759](https://github.com/carrierwaveuploader/carrierwave/issues/2759))
* Clear download errors on reassigning remote urls (@mshibuya [bb8c6e1](https://github.com/carrierwaveuploader/carrierwave/commit/bb8c6e1f9eccae8650c70ab46ca487ec878cda0b), [#2725](https://github.com/carrierwaveuploader/carrierwave/issues/2725))

## 3.1.0.beta - 2024-09-01

### Added

* Add support for the `crop` processing method (@clickworkorange [#2721](https://github.com/carrierwaveuploader/carrierwave/pull/2721))
* Add global `skip_ssrf_protection` configuration (@rajyan [#2696](https://github.com/carrierwaveuploader/carrierwave/pull/2696), [#2695](https://github.com/carrierwaveuploader/carrierwave/issues/2695))

### Changed

* Show warning if #filename is safeguarded as in the pre-3.x style (@mshibuya [#2718](https://github.com/carrierwaveuploader/carrierwave/pull/2718), [#2708](https://github.com/carrierwaveuploader/carrierwave/issues/2708))

### Fixed

* Fix version names starting with a non-alphabet character lead to NameError (@r7kamura [#2748](https://github.com/carrierwaveuploader/carrierwave/pull/2748), [#2722](https://github.com/carrierwaveuploader/carrierwave/issues/2722))
* Fix Rails 7.2 incompatibility due to incorrect use of ActiveSupport::Deprecation (@mshibuya [b25477d](https://github.com/carrierwaveuploader/carrierwave/commit/b25477d4dc2b32ee3da896714b081e6123737fa3), [8761240](https://github.com/carrierwaveuploader/carrierwave/commit/8761240283abc2e58bd97004f30a9419cad34109), [#2751](https://github.com/carrierwaveuploader/carrierwave/issues/2751))
* Fix assigning a file with the same name not marking the column as changed (@mshibuya [47f1737](https://github.com/carrierwaveuploader/carrierwave/commit/47f1737443f47cd188e555836b26ccdfcee91d49), [#2719](https://github.com/carrierwaveuploader/carrierwave/issues/2719))
* Fix content type magic detection for files packaged in .zip (@dzhikvas [#2705](https://github.com/carrierwaveuploader/carrierwave/pull/2705), [#2704](https://github.com/carrierwaveuploader/carrierwave/issues/2704))

## 3.0.7 - 2024-03-23

### Security

* Fix Content-Type allowlist bypass vulnerability remained (@mshibuya [00676e2](https://github.com/carrierwaveuploader/carrierwave/commit/00676e23d7f4beac12beddee6f2486b686fb7e46), [GHSA-vfmv-jfc5-pjjw](https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-vfmv-jfc5-pjjw))

## 3.0.6 - 2024-03-09

### Fixed

* Fix #derived\_versions and #active\_sibling\_versions returning an Array where Hash is expected (@mshibuya [46e4f20](https://github.com/carrierwaveuploader/carrierwave/commit/46e4f20f8f85f75043cec76aa1f331c55a3ba103))
* Fix incompatibility with Marcel 1.0.3 (@schinery [#2728](https://github.com/carrierwaveuploader/carrierwave/pull/2728), [#2729](https://github.com/carrierwaveuploader/carrierwave/issues/2729))
* Fix assigning a file with the same name not marking the column as changed (@mshibuya [4c65b39](https://github.com/carrierwaveuploader/carrierwave/commit/4c65b393cd85b66bc256d04363cf3e3a97c8fd64), [#2719](https://github.com/carrierwaveuploader/carrierwave/issues/2719))
* Fix failing to remove files with ActiveRecord 7.1 after\_commit order change enabled (@mshibuya [63113e9](https://github.com/carrierwaveuploader/carrierwave/commit/63113e96dc172114cb92af239ba73e50ed8a72f2), [#2713](https://github.com/carrierwaveuploader/carrierwave/issues/2713))

## 3.0.5 - 2023-11-29

### Fixed

* Remove unnecessary if clause within #filename left in the uploader template (@rajyan, [#2711](https://github.com/carrierwaveuploader/carrierwave/pull/2711))

### Security

* Fix Content-Type allowlist bypass vulnerability, possibly leading to XSS (@mshibuya, [863d425](https://github.com/carrierwaveuploader/carrierwave/commit/863d425c76eba12c3294227b39018f6b2dccbbf3), [GHSA-gxhx-g4fq-49hj](https://github.com/carrierwaveuploader/carrierwave/security/advisories/GHSA-gxhx-g4fq-49hj))

## 3.0.4 - 2023-10-08

### Fixed

* Fix model's dirty state remaining after update (@rajyan [#2707](https://github.com/carrierwaveuploader/carrierwave/pull/2707), [#2702](https://github.com/carrierwaveuploader/carrierwave/issues/2702))
* Fix #dup modifying the original object (@rajyan [#2690](https://github.com/carrierwaveuploader/carrierwave/pull/2690), [#2706](https://github.com/carrierwaveuploader/carrierwave/pull/2706), [#2689](https://github.com/carrierwaveuploader/carrierwave/issues/2689), [#2700](https://github.com/carrierwaveuploader/carrierwave/issues/2700))
* Fix #dup not respecting the :mount\_on option, causing MissingAttributeError (@marsz [#2691](https://github.com/carrierwaveuploader/carrierwave/pull/2691))

## 3.0.3 - 2023-08-21

### Fixed

* Fix #dup modifying the original object (@mshibuya [37f36f7](https://github.com/carrierwaveuploader/carrierwave/commit/37f36f7ccf035ffb19cbd3964928b3abf2d5e1b1), [#2687](https://github.com/carrierwaveuploader/carrierwave/issues/2687))
* Fix wrongly removing files on transaction rollback (@mshibuya, @rajyan [eb03fe1](https://github.com/carrierwaveuploader/carrierwave/commit/eb03fe124c3a7acf3ffc913c7d432208ba3aa7ca), [#2686](https://github.com/carrierwaveuploader/carrierwave/pull/2686), [#2685](https://github.com/carrierwaveuploader/carrierwave/issues/2685))

## 3.0.2 - 2023-08-01

### Fixed

* Fix deduplicated filename not being persisted (@mshibuya [#2679](https://github.com/carrierwaveuploader/carrierwave/pull/2679), [#2678](https://github.com/carrierwaveuploader/carrierwave/issues/2678), [#2677](https://github.com/carrierwaveuploader/carrierwave/pull/2677))

## 3.0.1 - 2023-07-22

### Fixed

* Fix not respecting the parent's #enable\_processing value after reading its own (@mshibuya [2df0f53](https://github.com/carrierwaveuploader/carrierwave/commit/2df0f53f1d5fa30a198aa148ef33f1ab924404e4), [#2676](https://github.com/carrierwaveuploader/carrierwave/issues/2676))
* Fix NoMethodError when a record is rolled back (@y-yagi [#2674](https://github.com/carrierwaveuploader/carrierwave/pull/2674), [#2675](https://github.com/carrierwaveuploader/carrierwave/issues/2675))
* Fix filename suffix being removed due to unnecessary deduplication (@mshibuya [d68a111](https://github.com/carrierwaveuploader/carrierwave/commit/d68a1111cfae4309d703caa19d9c19226bc01686), [#2672](https://github.com/carrierwaveuploader/carrierwave/issues/2672))
* Fix #dup causing unintended name deduplication of copied files (@mshibuya [b732acd](https://github.com/carrierwaveuploader/carrierwave/commit/b732acd63209897e6375a3706330df2c38e3f327), [#2670](https://github.com/carrierwaveuploader/carrierwave/issues/2670))
* Fix initialization failing when active\_support/core\_ext is not loaded yet (@mshibuya [875d972](https://github.com/carrierwaveuploader/carrierwave/commit/875d972dc78b8416de7768457793baa4d6220a4f))

## 3.0.0 - 2023-07-02

*No changes.*

## 3.0.0.rc - 2023-06-11

### Added

* Support adding suffix to filename on store when path collides with the existing ones (@mshibuya [07a5632](https://github.com/carrierwaveuploader/carrierwave/commit/07a5632a3f30ddcb21b10a75f003a7eaeaa072ad), [#1855](https://github.com/carrierwaveuploader/carrierwave/issues/1855))
* Add image dimension validation (@TsubasaYoshida [#2592](https://github.com/carrierwaveuploader/carrierwave/pull/2592), [3b1f8b4](https://github.com/carrierwaveuploader/carrierwave/commit/3b1f8b41f8c0896aa6ebe64bac23622c14a8b8d9))
* Provide validation error details via ActiveModel::Errors#details (@mshibuya [9013999](https://github.com/carrierwaveuploader/carrierwave/commit/90139995fc11978da909db71b1d43c0690c7c9d2), [#2150](https://github.com/carrierwaveuploader/carrierwave/issues/2150))
* Support clearing #remote\_urls by assigning nil (@mshibuya [8307f93](https://github.com/carrierwaveuploader/carrierwave/commit/8307f93c29b833d34efaae63c33d36e737d94715), [#2067](https://github.com/carrierwaveuploader/carrierwave/issues/2067))
* Support configuration of download retry wait time (@tricknotes [#2646](https://github.com/carrierwaveuploader/carrierwave/pull/2646))
* Support for ActiveRecord::Base#dup (@mshibuya, @BrianHawley [19b33b8](https://github.com/carrierwaveuploader/carrierwave/commit/19b33b876cd58e7af28dc718fd4f47bb539b78f9), [#2645](https://github.com/carrierwaveuploader/carrierwave/pull/2645), [#1962](https://github.com/carrierwaveuploader/carrierwave/issues/1962))
* Add CarrierWave::Storage::Fog::File#to\_file for interface consistency with SanitizedFile (@mshibuya [68ce83a](https://github.com/carrierwaveuploader/carrierwave/commit/68ce83a7b105d52c6af1b410727dd590c3960f7d), [#1960](https://github.com/carrierwaveuploader/carrierwave/issues/1960))
* Allow SanitizedFile to accept read with an optional length and output\_buffer arguments (@mshibuya [9096459](https://github.com/carrierwaveuploader/carrierwave/commit/90964596aa3d0b7acea584012f0f5888d622ea1b), [#1959](https://github.com/carrierwaveuploader/carrierwave/issues/1959))

### Changed

* Stop relying on ActiveModel::Dirty change tracking for removal of unnecessary files (@mshibuya [aac25c1](https://github.com/carrierwaveuploader/carrierwave/commit/aac25c10af4218d6e1e70f90154b847b54ce0334))
* Create versions lazily to reflect subclass configurations properly (@mshibuya [1531a67](https://github.com/carrierwaveuploader/carrierwave/commit/1531a67366f0e25e3d298133a72c81b6c9c0dc83), [#1957](https://github.com/carrierwaveuploader/carrierwave/issues/1957), [#2619](https://github.com/carrierwaveuploader/carrierwave/issues/2619))
* [BREAKING CHANGE] Use the resulting file extension on changing format by :convert (@mshibuya [#2659](https://github.com/carrierwaveuploader/carrierwave/pull/2659), [#2125](https://github.com/carrierwaveuploader/carrierwave/issues/2125), [#2126](https://github.com/carrierwaveuploader/carrierwave/issues/2126), [#2254](https://github.com/carrierwaveuploader/carrierwave/issues/2254))
* Prioritize Magic-detected content type for spoof-tolerance (@mshibuya [a2ca59c](https://github.com/carrierwaveuploader/carrierwave/commit/a2ca59cbe67046ba7818c64849a9a4ffa90306db), [#2570](https://github.com/carrierwaveuploader/carrierwave/issues/2570))
* Handle assignments in an ActiveModel::Dirty-friendly way (@mshibuya [#2658](https://github.com/carrierwaveuploader/carrierwave/pull/2658), [#2404](https://github.com/carrierwaveuploader/carrierwave/issues/2404), [#2409](https://github.com/carrierwaveuploader/carrierwave/issues/2409), [#2468](https://github.com/carrierwaveuploader/carrierwave/issues/2468))
* Give a stable name to classes created by the mount\_uploader block (@mshibuya [f5b09b8](https://github.com/carrierwaveuploader/carrierwave/commit/f5b09b844d99245a3b4d0ba01efd4972be4ee5be), [#2407](https://github.com/carrierwaveuploader/carrierwave/issues/2407), [#2471](https://github.com/carrierwaveuploader/carrierwave/issues/2471))
* Give a stable name to version classes (@mshibuya [a9de756](https://github.com/carrierwaveuploader/carrierwave/commit/a9de7565eabb4cdca05bb090cdf797eb1720c09c), [#2407](https://github.com/carrierwaveuploader/carrierwave/issues/2407), [#2471](https://github.com/carrierwaveuploader/carrierwave/issues/2471))

### Fixed

* Fix CarrierWave::Storage::Fog::File#read breaking when the file doesn't exist (@mshibuya [246eb01](https://github.com/carrierwaveuploader/carrierwave/commit/246eb012e15a75f7621bf9933f90a0f4742bd6e8), [#2524](https://github.com/carrierwaveuploader/carrierwave/issues/2524))
* Fix to preserve the original URI as much as possible on download (@mshibuya [2f3afaf](https://github.com/carrierwaveuploader/carrierwave/commit/2f3afafb738ae848a8a2d164780571cf9a7eb6ce), [#2631](https://github.com/carrierwaveuploader/carrierwave/issues/2631))
* Fix not to invoke content type detection on #copy\_to as it's costly (@mshibuya [6c6e2dc](https://github.com/carrierwaveuploader/carrierwave/commit/6c6e2dc9cf7747c0c1571d315473b246ef582e1f), [#2465](https://github.com/carrierwaveuploader/carrierwave/issues/2465))
* Fix calling #=~ on non-String breaking in Ruby 3.2 (@aubinlrx [#2653](https://github.com/carrierwaveuploader/carrierwave/pull/2653), [fd03ddd](https://github.com/carrierwaveuploader/carrierwave/commit/fd03dddef55025cab83936fc2957e3c8c58772ae))
* Fix #clean\_cache! to respect the uploader's root, not the global one (@sawasaki-narumi [#2652](https://github.com/carrierwaveuploader/carrierwave/pull/2652), [3cb9992](https://github.com/carrierwaveuploader/carrierwave/commit/3cb9992cc5fb8b113fe5b050651361f35d94adb4), [#2113](https://github.com/carrierwaveuploader/carrierwave/issues/2113))
* Fix to use helper method #fog\_provider instead of checking #fog\_credentials (@joshuamsager [#2660](https://github.com/carrierwaveuploader/carrierwave/pull/2660))
* Fix being unable to delete a file by assigning nil (@mshibuya [f8ea354](https://github.com/carrierwaveuploader/carrierwave/commit/f8ea35445e51c438b8cc8baf3e50079b5d423e34), [#2654](https://github.com/carrierwaveuploader/carrierwave/issues/2654), [#2613](https://github.com/carrierwaveuploader/carrierwave/pull/2613))
* Fix to raise exception when ImageMagick is not installed (@mshibuya [d90c399](https://github.com/carrierwaveuploader/carrierwave/commit/d90c399a6d2338203b1382f4ac4269863444d60d), [#2060](https://github.com/carrierwaveuploader/carrierwave/issues/2060))
* Fix to remove unnecessary floodfill in CarrierWave::RMagick#resize\_and\_pad (@mshibuya [f34a9bd](https://github.com/carrierwaveuploader/carrierwave/commit/f34a9bd26ed3e1006033a783c2ae8d86369993f6))
* Fix `#{column}_cache=` fails to be stored when set as a nested attribute (@mshibuya [e84d11e](https://github.com/carrierwaveuploader/carrierwave/commit/e84d11ec508d286ebab28195da815816abc62e41), [#2206](https://github.com/carrierwaveuploader/carrierwave/issues/2206))
* Fix to use AWS S3 regional endpoints when using virtual-hosted style (@mshibuya [8dace34](https://github.com/carrierwaveuploader/carrierwave/commit/8dace3456b5d1e0c3212ed1dc6c8b47dfd63b8ff), [#2523](https://github.com/carrierwaveuploader/carrierwave/issues/2523))
* Fix to respect condition on processing a derived version (@mshibuya [1fecddc](https://github.com/carrierwaveuploader/carrierwave/commit/1fecddc8ffe43426e9b5044dedfa7ac0b091cad8), [#2516](https://github.com/carrierwaveuploader/carrierwave/issues/2516))
* Fix #recreate\_versions! affecting the original file (@mshibuya [a67bfb6](https://github.com/carrierwaveuploader/carrierwave/commit/a67bfb696dcba14c7cdfa2c1b5481f04d3ef8dae), [5f00715](https://github.com/carrierwaveuploader/carrierwave/commit/5f00715747d44dd7f57ee990a6b471ed786ac764), [#2480](https://github.com/carrierwaveuploader/carrierwave/issues/2480), [#2655](https://github.com/carrierwaveuploader/carrierwave/issues/2655))
* Fix `remove_#{column}!` doesn't remove the file immediately (@mshibuya [b719fb3](https://github.com/carrierwaveuploader/carrierwave/commit/b719fb373c48f23e874dfa1a333a954c01967fc1), [#2540](https://github.com/carrierwaveuploader/carrierwave/issues/2540))
* Fix column value populated without a file when using filename override (@mshibuya [f1eff6e](https://github.com/carrierwaveuploader/carrierwave/commit/f1eff6e212fb0c374c9235968bfc4e7580bf1e2a), [#2284](https://github.com/carrierwaveuploader/carrierwave/issues/2284))
* Fix boolean configurations couldn't be set to false on a per-uploader basis (@megane42 [#2642](https://github.com/carrierwaveuploader/carrierwave/pull/2642))
* Fix #clean\_cache! breaking with directories that doesn't conform to CarrierWave's cache\_id format (@BrianHawley [#2641](https://github.com/carrierwaveuploader/carrierwave/pull/2641))

## 3.0.0.beta - 2022-11-19

### Added

* Add basename and fix extension value for fog file (@leductienttkt [#2587](https://github.com/carrierwaveuploader/carrierwave/pull/2587))
* Allow uploaders to accept unless conditions (@Vpatel1093 [#2588](https://github.com/carrierwaveuploader/carrierwave/pull/2588))
* Add retry option to download from remote url (@tashirosota [#2577](https://github.com/carrierwaveuploader/carrierwave/pull/2577))

### Deprecated

* #denylist was deprecated to prefer explicitly opting-in (@mshibuya [7a40ef7](https://github.com/carrierwaveuploader/carrierwave/commit/7a40ef7c4d5f3033f0f8401323f80bde14ca72b9), [#2536](https://github.com/carrierwaveuploader/carrierwave/issues/2536))

### Changed

* Completely migrate to allowlist/denylist terminology (@mshibuya [7a40ef7](https://github.com/carrierwaveuploader/carrierwave/commit/7a40ef7c4d5f3033f0f8401323f80bde14ca72b9), [#2536](https://github.com/carrierwaveuploader/carrierwave/issues/2536))
* Remove implementation-dependent information from an error message (@akihikodaki [#2499](https://github.com/carrierwaveuploader/carrierwave/pull/2499))
* Replace mini\_mime with marcel (@pjmartorell [#2552](https://github.com/carrierwaveuploader/carrierwave/pull/2552))
* [BREAKING CHANGE] Change to store files on after\_save hook instead of after\_commit, with performing cleanup when transaction is rolled back (@fsateler [#2546](https://github.com/carrierwaveuploader/carrierwave/pull/2546))

### Removed

* Drop support for Ruby < 2.5 and Rails 5.x (@mshibuya [229594f](https://github.com/carrierwaveuploader/carrierwave/commit/229594fb2ac7cfa59586162c0b3fc3d0b5bab978))
* Remove support for Merb (@seuros [#2566](https://github.com/carrierwaveuploader/carrierwave/pull/2566))

### Fixed

* Add Workaround for 'undefined method closed?' error caused by ssrf\_filter 1.1 (@mshibuya [65bf0d9](https://github.com/carrierwaveuploader/carrierwave/commit/65bf0d94759f7d522a36698d4b81e3635b8ca572), [#2628](https://github.com/carrierwaveuploader/carrierwave/issues/2628))
* Fix Ruby 2.7 keyword argument warning in uploader process (@nachiket87 [#2636](https://github.com/carrierwaveuploader/carrierwave/pull/2636), [#2635](https://github.com/carrierwaveuploader/carrierwave/issues/2635))
* Raise DownloadError when no content is returned (@BrianHawley [#2633](https://github.com/carrierwaveuploader/carrierwave/pull/2633), [#2632](https://github.com/carrierwaveuploader/carrierwave/issues/2632))
* Add workaround for the API change in ssrf\_filter 1.1 (@BrianHawley [#2629](https://github.com/carrierwaveuploader/carrierwave/pull/2629), [#2625](https://github.com/carrierwaveuploader/carrierwave/issues/2625))
* Fix Content-Type not being copied when using fog-google (@smnscp [#2614](https://github.com/carrierwaveuploader/carrierwave/pull/2614))
* Fix failing to save after limiting the columns with ActiveRecord's #select (@wonda-tea-coffee [#2613](https://github.com/carrierwaveuploader/carrierwave/pull/2613), [#2608](https://github.com/carrierwaveuploader/carrierwave/issues/2608))
* Fix content type detection for JSON files (@smnscp [#2618](https://github.com/carrierwaveuploader/carrierwave/pull/2618))
* Remove invalid byte sequences from the sanitized filename (@alexdunae [#2606](https://github.com/carrierwaveuploader/carrierwave/pull/2606))
* Fix issue with copying a fog file larger than 5GB (@slonopotamus [#2583](https://github.com/carrierwaveuploader/carrierwave/pull/2583))
* Stop closing StringIO-based file after CarrierWave::SanitizedFile#read (@aleksandrs-ledovskis [#2571](https://github.com/carrierwaveuploader/carrierwave/pull/2571))

Please check [2.x-stable](https://github.com/carrierwaveuploader/carrierwave/blob/2.x-stable/CHANGELOG.md) for previous changes.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_31ee44d4_20250114_180430.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fsecurity%2Fadvisories%2FGHSA-cf3w-g86h-35x4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarrierwaveuploader%2Fcarrierwave%2Fsecurity%2Fadvisories%2FGHSA-cf3w-g86h-35x4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=carrierwaveuploader%2Fcarrierwave)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[carrierwaveuploader](/carrierwaveuploader)
/
**[carrierwave](/carrierwaveuploader/carrierwave)**
Public

* [Notifications](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)
* [Star
   8.8k](/login?return_to=%2Fcarrierwaveuploader%2Fcarrierwave)

* [Code](/carrierwaveuploader/carrierwave)
* [Issues
  33](/carrierwaveuploader/carrierwave/issues)
* [Pull requests
  5](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects
  0](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

Additional navigation options

* [Code](/carrierwaveuploader/carrierwave)
* [Issues](/carrierwaveuploader/carrierwave/issues)
* [Pull requests](/carrierwaveuploader/carrierwave/pulls)
* [Actions](/carrierwaveuploader/carrierwave/actions)
* [Projects](/carrierwaveuploader/carrierwave/projects)
* [Wiki](/carrierwaveuploader/carrierwave/wiki)
* [Security](/carrierwaveuploader/carrierwave/security)
* [Insights](/carrierwaveuploader/carrierwave/pulse)

# Code Injection vulnerability in CarrierWave::RMagick

Low

[mshibuya](/mshibuya)
published
GHSA-cf3w-g86h-35x4
Feb 8, 2021

## Package

bundler

carrierwave
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

< 2.1.1 and < 1.3.2

## Patched versions

2.1.1, 1.3.2

## Description

### Impact

[CarrierWave::RMagick](https://github.com/carrierwaveuploader/carrierwave/blob/master/lib/carrierwave/processing/rmagick.rb) has a Code Injection vulnerability. Its `#manipulate!` method inappropriately evals the content of mutation option(`:read`/`:write`), allowing attackers to craft a string that can be executed as a Ruby code.

If an application developer supplies untrusted inputs to the option, it will lead to remote code execution(RCE).

(But supplying untrusted input to the option itself is dangerous even in absence of this vulnerability, since is prone to DoS vulnerability - attackers can try to consume massive amounts of memory by resizing to a very large dimension)

### Proof of Concept

```
class MyUploader < CarrierWave::Uploader::Base
  include CarrierWave::RMagick
end

MyUploader.new.manipulate!({ read: { density: "1 }; p 'Hacked'; {" }}) # => shows "Hacked"
```
### Patches

Upgrade to [2.1.1](https://rubygems.org/gems/carrierwave/versions/2.1.1) or [1.3.2](https://rubygems.org/gems/carrierwave/versions/1.3.2).

### Workarounds

Stop supplying untrusted input to `#manipulate!`'s mutation option.

### References

[Code Injection Software Attack](https://owasp.org/www-community/attacks/Code_Injection)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [CarrierWave repo](https://github.com/carrierwaveuploader/carrierwave)
* Email me at mit.shibuya@gmail.com

### Severity

Low

### CVE ID

CVE-2021-21305

### Weaknesses

No CWEs

### Credits

* [![@wonda-tea-coffee](https://avatars.githubusercontent.com/u/39144575?s=40&v=4)](/wonda-tea-coffee)
  [wonda-tea-coffee](/wonda-tea-coffee)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from rubygems.org_8c0e621c_20250114_180431.html ===


[⬢
RubyGems](/ "RubyGems") Navigation menu

Search Gems…

[Releases](https://rubygems.org/releases)
[Blog](https://blog.rubygems.org)
[Gems](/gems)
[Guides](https://guides.rubygems.org)
[Sign in](/sign_in)
[Sign up](/sign_up)

# [carrierwave](/gems/carrierwave) *3.1.1*

Upload files in your Ruby applications, map them to a range of ORMs, store them on different backends.

## Gemfile: =

## install: =

### Versions:

1. [3.1.1](/gems/carrierwave/versions/3.1.1)
   January 12, 2025
   (53 KB)
2. [3.1.0](/gems/carrierwave/versions/3.1.0)
   December 14, 2024
   (53 KB)
3. [3.1.0.rc](/gems/carrierwave/versions/3.1.0.rc)
   December 07, 2024
   (53 KB)
4. [3.1.0.beta](/gems/carrierwave/versions/3.1.0.beta)
   September 01, 2024
   (53 KB)
5. [3.0.7](/gems/carrierwave/versions/3.0.7)
   March 23, 2024
   (51 KB)

[Show all versions (86 total)](https://rubygems.org/gems/carrierwave/versions)

### Runtime Dependencies (6):

[**activemodel**](/gems/activemodel)
>= 6.0.0

[**activesupport**](/gems/activesupport)
>= 6.0.0

[**addressable**](/gems/addressable)
~> 2.6

[**image\_processing**](/gems/image_processing)
~> 1.1

[**marcel**](/gems/marcel)
~> 1.0.0

[**ssrf\_filter**](/gems/ssrf_filter)
~> 1.0

### Development Dependencies (15):

[**csv**](/gems/csv)
~> 3.0

[**cucumber**](/gems/cucumber)
>= 0

[**fog-aws**](/gems/fog-aws)
>= 0

[**fog-google**](/gems/fog-google)
~> 1.7, != 1.12.1

[**fog-local**](/gems/fog-local)
>= 0

[**generator\_spec**](/gems/generator_spec)
>= 0.9.1

[**mini\_magick**](/gems/mini_magick)
>= 3.6.0

[**pry**](/gems/pry)
>= 0

[**pry-byebug**](/gems/pry-byebug)
>= 0

[**rmagick**](/gems/rmagick)
>= 2.16

[**rspec**](/gems/rspec)
~> 3.4

[**rspec-retry**](/gems/rspec-retry)
>= 0

[**rubocop**](/gems/rubocop)
~> 1.28

[**timecop**](/gems/timecop)
>= 0

[**webmock**](/gems/webmock)
>= 0

[Show all transitive dependencies](/gems/carrierwave/versions/3.1.1/dependencies)

### Owners:

[![](/users/296/avatar.jpeg?size=48&theme=light)](/profiles/jnicklas "jnicklas")[![](/users/349/avatar.jpeg?size=48&theme=light)](/profiles/trevorturk "trevorturk")[![](/users/43692/avatar.jpeg?size=48&theme=light)](/profiles/bensie "bensie")[![](/users/53064/avatar.jpeg?size=48&theme=light)](/profiles/mshibuya "mshibuya")[![](/users/60885/avatar.jpeg?size=48&theme=light)](/profiles/thiagofm "thiagofm")
### Pushed by:

[![](/users/53064/avatar.jpeg?size=48&theme=light)](/profiles/mshibuya "mshibuya")
### Authors:

* Jonas Nicklas

### SHA 256 checksum:

=

[← Previous version](/gems/carrierwave/versions/3.1.0)

## Total downloads 109,632,378

## For this version 4,690

## Version Released: January 12, 2025 9:38am

## License: MIT

## Required Ruby Version: *>= 2.5.0*

### Links:

[Homepage](https://github.com/carrierwaveuploader/carrierwave)
[Source Code](https://github.com/carrierwaveuploader/carrierwave/)
[Documentation](https://www.rubydoc.info/gems/carrierwave/3.1.1)
[Wiki](https://github.com/carrierwaveuploader/carrierwave/wiki)
[Mailing List](http://groups.google.com/group/carrierwave)
[Bug Tracker](https://github.com/carrierwaveuploader/carrierwave/issues)
[Download](/downloads/carrierwave-3.1.1.gem)
[Review changes](https://my.diffend.io/gems/carrierwave/prev/3.1.1)
[Badge](https://badge.fury.io/rb/carrierwave/install)
[Subscribe](/sign_in)
[RSS](/gems/carrierwave/versions.atom)
Report abuse
[Reverse dependencies](/gems/carrierwave/reverse_dependencies)

[Status](https://status.rubygems.org)
[Uptime](https://uptime.rubygems.org)
[Code](https://github.com/rubygems/rubygems.org)
[Data](/pages/data)
[Discuss](https://groups.google.com/group/rubygems-org)
[Stats](/stats)
[Contribute](https://guides.rubygems.org/contributing/)
[About](/pages/about)
Help
[API](https://guides.rubygems.org/rubygems-org-api)
[Security](/pages/security)

RubyGems.org is the Ruby community’s gem hosting service. Instantly [publish your gems](https://guides.rubygems.org/publishing/) and then [install them](https://guides.rubygems.org/command-reference/#gem-install). Use [the API](https://guides.rubygems.org/rubygems-org-api/) to find out more about [available gems](/gems). [Become a contributor](https://guides.rubygems.org/contributing/) and improve the site yourself.

RubyGems.org is made possible through a partnership with the greater Ruby community. [Fastly](https://www.fastly.com/) provides bandwidth and CDN support, [Ruby Central](https://www.rubycentral.org/) covers infrastructure costs, and funds ongoing development and ops work. [Learn more about our sponsors and how they work together](/pages/sponsors).

We need your help to fund the developer time that keeps RubyGems.org running smoothly for everyone. [Join Ruby Central today](https://rubycentral.org/#/portal/signup).

[Supported by
Ruby Central](https://rubycentral.org/)
[Designed by
DockYard](https://dockyard.com/ruby-on-rails-consulting)
[Resolved with
DNSimple](https://dnsimple.link/resolving-rubygems)
[Monitored by
Datadog](https://www.datadoghq.com/)
[Gems served by
Fastly](https://www.fastly.com/)
[Monitored by
Honeybadger](https://www.honeybadger.io/)
[Verified by
Domainr](https://domainr.com/)
[Secured by
Whitesource](https://mend.io/)

[English](/gems/carrierwave?locale=en)

[Nederlands](/gems/carrierwave?locale=nl)

[简体中文](/gems/carrierwave?locale=zh-CN)

[正體中文](/gems/carrierwave?locale=zh-TW)

[Português do Brasil](/gems/carrierwave?locale=pt-BR)

[Français](/gems/carrierwave?locale=fr)

[Español](/gems/carrierwave?locale=es)

[Deutsch](/gems/carrierwave?locale=de)

[日本語](/gems/carrierwave?locale=ja)


