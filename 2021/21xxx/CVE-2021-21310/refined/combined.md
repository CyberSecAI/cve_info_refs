=== Content from github.com_65fa7437_20250115_092548.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fsecurity%2Fadvisories%2FGHSA-pg53-56cg-4m8q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fsecurity%2Fadvisories%2FGHSA-pg53-56cg-4m8q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nextauthjs%2Fnext-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextauthjs](/nextauthjs)
/
**[next-auth](/nextauthjs/next-auth)**
Public

* [Notifications](/login?return_to=%2Fnextauthjs%2Fnext-auth) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)
* [Star
   25.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)

* [Code](/nextauthjs/next-auth)
* [Issues
  309](/nextauthjs/next-auth/issues)
* [Pull requests
  100](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects
  0](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

Additional navigation options

* [Code](/nextauthjs/next-auth)
* [Issues](/nextauthjs/next-auth/issues)
* [Pull requests](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

# Insecure email token verification in Prisma adapter

Critical

[iaincollins](/iaincollins)
published
GHSA-pg53-56cg-4m8q
Feb 11, 2021

## Package

npm

next-auth
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 3.3.0

## Patched versions

3.3.0

## Description

### Impact

Implementations using the **Prisma database adapter** with the **Email provider** **are impacted**.

Implementations using the Prisma database adapter that are not using the Email provider are not impacted.

Implementations using the default database adapter (TypeORM) with the Email provider are not impacted.

Implementations not using a database are not impacted.

### Patches

This issue is fixed in 3.3.0 and newer versions.

### Workarounds

Those not able to upgrade can alternatively disable the Email provider as a workaround.

### Description

The Prisma database adapter was checking the verification token but not the identifier (the email address associated with the token). This made it possible to use a valid token assigned to one user, to sign in as another user when using the Prima adapter in conjunction with the Email provider. The defect is specific to the community-supported Prisma database adapter in versions <3.3.0 and is not present in the default database adapter (TypeORM).

*Note: The current community-supported adapter was not developed by Prisma.*

The defect was a problem in the implementation of verification function the adapter and is not directly related to Prisma.

The flaw may exist in other third party database adapters that do not check both the identifier and token values.

The design of the database adapter API may be revised in future to help reduce the likelyhood of similar defects.

### Timeline

On Monday (2021-02-08) we were notified via responsible disclosure by Alessandro Angelino ([@AlessandroA](https://github.com/AlessandroA)) of a flaw in the implementation of the Prisma database adapter included with NextAuth.js. A detailed write up and proof of concept were provided.

The following day (2021-02-09) we published a fix in v3.3.0 and confirmed through internal testing, and with Alessandro, that the issue was resolved in the new release and prompted users to upgrade.

On 2021-02-10 we received a CVE ID and published this advisory within a few hours of notification.

We would like to thank Alessandro for using responsible disclose to allow us to address the issue promptly and publish this advisory once an update was available that resolved the issue and Balázs Orbán ([@balazsorban44](https://github.com/balazsorban44)) for facilitating a timely release of the fix.

### Severity

Critical

### CVE ID

CVE-2021-21310

### Weaknesses

No CWEs

### Credits

* [![@AlessandroA](https://avatars.githubusercontent.com/u/8617445?s=40&v=4)](/AlessandroA)
  [AlessandroA](/AlessandroA)
  Analyst
* [![@balazsorban44](https://avatars.githubusercontent.com/u/18369201?s=40&v=4)](/balazsorban44)
  [balazsorban44](/balazsorban44)
  Analyst
* [![@iaincollins](https://avatars.githubusercontent.com/u/595695?s=40&v=4)](/iaincollins)
  [iaincollins](/iaincollins)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b20d265e_20250115_092547.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Freleases%2Ftag%2Fv3.3.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Freleases%2Ftag%2Fv3.3.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=nextauthjs%2Fnext-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextauthjs](/nextauthjs)
/
**[next-auth](/nextauthjs/next-auth)**
Public

* [Notifications](/login?return_to=%2Fnextauthjs%2Fnext-auth) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)
* [Star
   25.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)

* [Code](/nextauthjs/next-auth/tree/v3.3.0)
* [Issues
  309](/nextauthjs/next-auth/issues)
* [Pull requests
  100](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects
  0](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

Additional navigation options

* [Code](/nextauthjs/next-auth/tree/v3.3.0)
* [Issues](/nextauthjs/next-auth/issues)
* [Pull requests](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

1. [Releases](/nextauthjs/next-auth/releases)
2. [v3.3.0](/nextauthjs/next-auth/releases/tag/v3.3.0)

# v3.3.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/nextauthjs/next-auth/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.3.0)

 Loading

[View all tags](/nextauthjs/next-auth/tags)

![@balazsorban44](https://avatars.githubusercontent.com/u/18369201?s=40&v=4)
[balazsorban44](/balazsorban44)
released this
09 Feb 15:01

·
[3002 commits](/nextauthjs/next-auth/compare/v3.3.0...main)
to main
since this release

[v3.3.0](/nextauthjs/next-auth/tree/v3.3.0)

[`8bd9d87`](/nextauthjs/next-auth/commit/8bd9d876337b29d473fc9c47258000f078584c77)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

**Features**

* **provider**: update session when signIn/signOut successful ([#1267](https://github.com/nextauthjs/next-auth/pull/1267)) ([f4269f7](https://github.com/nextauthjs/next-auth/commit/f4269f7edb617ed34f9608f1f8fd58ef2f7bb1ac))
* **provider**: add EVE Online provider ([#1227](https://github.com/nextauthjs/next-auth/pull/1227)) ([c387f32](https://github.com/nextauthjs/next-auth/commit/c387f3264ff232ab21e7d02fc5a1f6f247baff1c))
* **provider**: option to disable client-side redirects (credentials) ([#1219](https://github.com/nextauthjs/next-auth/pull/1219)) ([690f81e](https://github.com/nextauthjs/next-auth/commit/690f81ec603304671109f1981ab167a65d089e66))
* **ts**: preliminary work to support TypeScript in the future ([#1223](https://github.com/nextauthjs/next-auth/pull/1223)) ([562bcf2](https://github.com/nextauthjs/next-auth/commit/562bcf216c9c83263027cffad5511cdd36f41f48))

**Bug fixes**

* **page**: fix typo in error page ([748e7b4](https://github.com/nextauthjs/next-auth/commit/748e7b4aef125bab70cef3d8e83068901ddff2be))
* **provider**: add verificationRequest flag to email signIn callback ([#1258](https://github.com/nextauthjs/next-auth/pull/1258)) ([5ee84c5](https://github.com/nextauthjs/next-auth/commit/5ee84c57099222b06a48602f5010b4436214c2f5))
* **ui**: use color text var for input color ([#1260](https://github.com/nextauthjs/next-auth/pull/1260)) ([487906e](https://github.com/nextauthjs/next-auth/commit/487906e9cdab965dd21abf9fbc1a00cea4ced1f1))
* **provider**: okta client authentication ([#1257](https://github.com/nextauthjs/next-auth/pull/1257)) ([cb6f787](https://github.com/nextauthjs/next-auth/commit/cb6f78758ab91942fc71a740a0ff4c20d7a3fc0a))
* **provider**: Fixes for email sign in ([#1285](https://github.com/nextauthjs/next-auth/pull/1285)) ([c5bb0ac](https://github.com/nextauthjs/next-auth/commit/c5bb0ac3646b672047e51a42ebe281d7e7727f02))

**Documentation**

* **provider**: Update Atlassian docs ([#1255](https://github.com/nextauthjs/next-auth/pull/1255)) ([c7f1923](https://github.com/nextauthjs/next-auth/commit/c7f1923a3ff8dc6ceadf437757b2acc4139a6ee8))
* clarify custom pages usage [skip release] ([#1239](https://github.com/nextauthjs/next-auth/pull/1239)) ([afb5082](https://github.com/nextauthjs/next-auth/commit/afb5082ab20ae7c501a69ecb2c9651ff77cfcbed))
* **provider**: Update azure-ad-b2c.md [skip release] ([#1280](https://github.com/nextauthjs/next-auth/pull/1280)) ([cfc6648](https://github.com/nextauthjs/next-auth/commit/cfc66480f1b51a91d6a754eb27460133476602c6))
* **adapter**: Update Prisma docs [skip release] ([#1279](https://github.com/nextauthjs/next-auth/pull/1279)) ([#1283](https://github.com/nextauthjs/next-auth/pull/1283)) ([8121f72](https://github.com/nextauthjs/next-auth/commit/8121f728b1c019cab740d01d51b31654e467ac4f))
* **adapter**: Update Prisma docs ([#1279](https://github.com/nextauthjs/next-auth/pull/1279)) ([6af40e3](https://github.com/nextauthjs/next-auth/commit/6af40e3fe202e1cd3ed001727d08586b6cebefe1))
* Change "docs" to "documentation" ([69cc6bf](https://github.com/nextauthjs/next-auth/commit/69cc6bfa12a301adfe9dc44e71fe00c9027404c1))
* Minor text error fixed [skip release] ([#1263](https://github.com/nextauthjs/next-auth/pull/1263)) ([15e9d9e](https://github.com/nextauthjs/next-auth/commit/15e9d9e021e11b4eb083616c3bc67d35da7325f3))

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_b127ae59_20250115_092550.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## next-authTypeScript icon, indicating that this package has built-in type declarations

4.24.11Â â¢Â PublicÂ â¢Â Published a month ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [9 Dependencies](?activeTab=dependencies)
* [399 Dependents](?activeTab=dependents)
* [715 Versions](?activeTab=versions)

[![](https://camo.githubusercontent.com/243909f00e726430f4d7e31c0f5e5c87e3abde526714482c806445852907d319/68747470733a2f2f6e6578742d617574682e6a732e6f72672f696d672f6c6f676f2f6c6f676f2d736d2e706e67)](https://next-auth.js.org)

### NextAuth.js

Authentication for Next.js

Open Source. Full Stack. Own Your Data.

[![Release](https://github.com/nextauthjs/next-auth/actions/workflows/release.yml/badge.svg)](https://github.com/nextauthjs/next-auth/actions/workflows/release.yml?query=workflow%3ARelease)
[![Bundle Size](https://camo.githubusercontent.com/746983436403932ba706b81846fbd07b052c5db0cee16c4d4cae04ac1b054e3b/68747470733a2f2f7061636b61676570686f6269612e636f6d2f62616467653f703d6e6578742d61757468)](https://packagephobia.com/result?p=next-auth)
[![Downloads](https://camo.githubusercontent.com/dd1d750d25a5c1ec0bf061385aa84af55bed385cf088a4528c810d735d75b514/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f6e6578742d61757468)](https://www.npmtrends.com/next-auth)
[![Github Stars](https://camo.githubusercontent.com/ded857824f572e9cb0b5f05c182e01b3f62444a502a6c9528db471f409c62bbc/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f6e657874617574686a732f6e6578742d61757468)](https://github.com/nextauthjs/next-auth/stargazers)
[![Github Stable Release](https://camo.githubusercontent.com/3c1bbcc0853226af39722eb045982a7e871d39887f37af950bf5806593fe2b31/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f6e657874617574686a732f6e6578742d617574683f6c6162656c3d6c6174657374)](https://www.npmjs.com/package/next-auth)

## Overview

NextAuth.js is a complete open source authentication solution for [Next.js](http://nextjs.org/) applications.

It is designed from the ground up to support Next.js and Serverless.

This is a monorepo containing the following packages / projects:

1. The primary `next-auth` package
2. A development test application
3. All `@next-auth/*-adapter` packages
4. The documentation site

## Getting Started

```
npm install next-auth

```

The easiest way to continue getting started, is to follow the [getting started](https://next-auth.js.org/getting-started/example) section in our docs.

We also have a section of [tutorials](https://next-auth.js.org/tutorials) for those looking for more specific examples.

See [next-auth.js.org](https://next-auth.js.org) for more information and documentation.

## Features

### Flexible and easy to use

* Designed to work with any OAuth service, it supports OAuth 1.0, 1.0A and 2.0
* Built-in support for [many popular sign-in services](https://next-auth.js.org/providers)
* Supports email / passwordless authentication
* Supports stateless authentication with any backend (Active Directory, LDAP, etc)
* Supports both JSON Web Tokens and database sessions
* Designed for Serverless but runs anywhere (AWS Lambda, Docker, Heroku, etcâ¦)

### Own your own data

NextAuth.js can be used with or without a database.

* An open source solution that allows you to keep control of your data
* Supports Bring Your Own Database (BYOD) and can be used with any database
* Built-in support for [MySQL, MariaDB, Postgres, Microsoft SQL Server, MongoDB and SQLite](https://next-auth.js.org/configuration/databases)
* Works great with databases from popular hosting providers
* Can also be used *without a database* (e.g. OAuth + JWT)

### Secure by default

* Promotes the use of passwordless sign-in mechanisms
* Designed to be secure by default and encourage best practices for safeguarding user data
* Uses Cross-Site Request Forgery (CSRF) Tokens on POST routes (sign in, sign out)
* Default cookie policy aims for the most restrictive policy appropriate for each cookie
* When JSON Web Tokens are enabled, they are encrypted by default (JWE) with A256GCM
* Auto-generates symmetric signing and encryption keys for developer convenience
* Features tab/window syncing and session polling to support short lived sessions
* Attempts to implement the latest guidance published by [Open Web Application Security Project](https://owasp.org)

Advanced options allow you to define your own routines to handle controlling what accounts are allowed to sign in, for encoding and decoding JSON Web Tokens and to set custom cookie security policies and session properties, so you can control who is able to sign in and how often sessions have to be re-validated.

### TypeScript

NextAuth.js comes with built-in types. For more information and usage, check out
the [TypeScript section](https://next-auth.js.org/getting-started/typescript) in the documentation.

## Example

### Add API Route

```
// pages/api/auth/[...nextauth].js
import NextAuth from "next-auth"
import AppleProvider from "next-auth/providers/apple"
import GoogleProvider from "next-auth/providers/google"
import EmailProvider from "next-auth/providers/email"

export default NextAuth({
  secret: process.env.SECRET,
  providers: [
    // OAuth authentication providers
    AppleProvider({
      clientId: process.env.APPLE_ID,
      clientSecret: process.env.APPLE_SECRET,
    }),
    GoogleProvider({
      clientId: process.env.GOOGLE_ID,
      clientSecret: process.env.GOOGLE_SECRET,
    }),
    // Sign in with passwordless email link
    EmailProvider({
      server: process.env.MAIL_SERVER,
      from: "<no-reply@example.com>",
    }),
  ],
})
```

### Add React Hook

The `useSession()` React Hook in the NextAuth.js client is the easiest way to check if someone is signed in.

```
import { useSession, signIn, signOut } from "next-auth/react"

export default function Component() {
  const { data: session } = useSession()
  if (session) {
    return (
      <>
        Signed in as {session.user.email} <br />
        <button onClick={() => signOut()}>Sign out</button>
      </>
    )
  }
  return (
    <>
      Not signed in <br />
      <button onClick={() => signIn()}>Sign in</button>
    </>
  )
}
```

### Share/configure session state

Use the `<SessionProvider>` to allow instances of `useSession()` to share the session object across components. It also takes care of keeping the session updated and synced between tabs/windows.

```
import { SessionProvider } from "next-auth/react"

export default function App({
  Component,
  pageProps: { session, ...pageProps },
}) {
  return (
    <SessionProvider session={session}>
      <Component {...pageProps} />
    </SessionProvider>
  )
}
```

## Security

If you think you have found a vulnerability (or not sure) in NextAuth.js or any of the related packages (i.e. Adapters), we ask you to have a read of our [Security Policy](https://github.com/nextauthjs/next-auth/security/policy) to reach out responsibly. Please do not open Pull Requests/Issues/Discussions before consulting with us.

## Acknowledgments

[NextAuth.js is made possible thanks to all of its contributors.](https://next-auth.js.org/contributors)

[![](https://camo.githubusercontent.com/8ba022cd4967f731a9633eb737f976439311f05aa346a26cbe12db1c956b5451/68747470733a2f2f636f6e747269622e726f636b732f696d6167653f7265706f3d6e657874617574686a732f6e6578742d61757468)](https://github.com/nextauthjs/next-auth/graphs/contributors)

### Support

We're happy to announce we've recently created an [OpenCollective](https://opencollective.com/nextauth) for individuals and companies looking to contribute financially to the project!

| [Clerk Logo](https://clerk.com?utm_source=sponsorship&utm_medium=github&utm_campaign=authjs&utm_content=sponsor) Clerk ðµ | [Auth0 Logo](https://a0.to/signup/nextauthjs) Auth0 ðµ | [FusionAuth Logo](https://fusionauth.io) FusionAuth ðµ | [Stytch Logo](https://stytch.com) Stytch ðµ | [Prisma Logo](https://prisma.io) Prisma ðµ | [Neon Logo](https://neon.tech) Neon ðµ |
| --- | --- | --- | --- | --- | --- |
| [Beyond Identity Logo](https://www.beyondidentity.com) Beyond Identity ðµ | [Lowdefy Logo](https://lowdefy.com) Lowdefy ðµ | [Descope Logo](https://www.descope.com) Descope ðµ | [Badass Courses Logo](https://badass.dev) Badass Courses ðµ | [Encore Logo](https://github.com/encoredev/encore) Encore ðµ | [Sent.dm Logo](https://sent.dm/?ref=auth.js) Sent.dm ðµ |
| [Arcjet Logo](https://arcjet.com/?ref=auth.js) Arcjet ðµ | [Route4Me Logo](https://route4me.com/?ref=auth.js) Route4Me ðµ | [Netlight logo](https://www.netlight.com/) Netlight âï¸ | [Checkly Logo](https://checklyhq.com) Checkly âï¸ | [superblog Logo](https://superblog.ai/) superblog âï¸ | [Vercel Logo](https://vercel.com) Vercel âï¸ |

* ðµ Financial Sponsor
* âï¸ Infrastructure Support

## Contributing

We're open to all community contributions! If you'd like to contribute in any way, please first read
our [Contributing Guide](https://github.com/nextauthjs/.github/blob/main/CONTRIBUTING.md).

## License

ISC

## Readme

### Keywords

* [react](/search?q=keywords:react)
* [nodejs](/search?q=keywords:nodejs)
* [oauth](/search?q=keywords:oauth)
* [jwt](/search?q=keywords:jwt)
* [oauth2](/search?q=keywords:oauth2)
* [authentication](/search?q=keywords:authentication)
* [nextjs](/search?q=keywords:nextjs)
* [csrf](/search?q=keywords:csrf)
* [oidc](/search?q=keywords:oidc)
* [nextauth](/search?q=keywords:nextauth)
## Package Sidebar

### Install

`npm i next-auth`

### Repository

[Gitgithub.com/nextauthjs/next-auth](https://github.com/nextauthjs/next-auth)

### Homepage

[authjs.dev](https://authjs.dev)

### DownloadsWeekly Downloads

1,109,102

### Version

4.24.11

### License

ISC

### Unpacked Size

828 kB

### Total Files

486

### Last publish

a month ago

### Collaborators

* [![iaincollins](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84ZDU3NTRjMDQ1MjY3NjhmNGM1MGJhYzRkNjQzOWJmYj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.6x6SaB6y4kj9lanRKYtENY_oiBq8EeVls-bRTM1cB7w "iaincollins")](/~iaincollins)
* [![balazsorban](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lMDg2YjM3NjA3M2QzYzVmNzc5OTlhZjFjMGM3NWVkYj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.e5xff4FGN5xqTg9AGjJ6NjgUP0NCKIAHdC-gaZJDfcw "balazsorban")](/~balazsorban)
* [![thvu](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82ZjA2ODM3MDc2MzJmYTUxY2ZiYjQ5ODQ5ZDZhN2JjZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.w1p7d7YsTsAHHeGfyh3IovZzFwJBqH5WeTB3GKW1-0w "thvu")](/~thvu)
[**Try** on RunKit](https://runkit.com/npm/next-auth)[**Report** malware](/support?inquire=security&security-inquire=malware&package=next-auth&version=4.24.11)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)


