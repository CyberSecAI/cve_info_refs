=== Content from github.com_69161572_20250114_183620.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Freleases%2Ftag%2F1.7.7.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Freleases%2Ftag%2F1.7.7.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=PrestaShop%2FPrestaShop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrestaShop](/PrestaShop)
/
**[PrestaShop](/PrestaShop/PrestaShop)**
Public

* [Notifications](/login?return_to=%2FPrestaShop%2FPrestaShop) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2FPrestaShop%2FPrestaShop)
* [Star
   8.3k](/login?return_to=%2FPrestaShop%2FPrestaShop)

* [Code](/PrestaShop/PrestaShop/tree/1.7.7.2)
* [Issues
  2.6k](/PrestaShop/PrestaShop/issues)
* [Pull requests
  177](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects
  2](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

Additional navigation options

* [Code](/PrestaShop/PrestaShop/tree/1.7.7.2)
* [Issues](/PrestaShop/PrestaShop/issues)
* [Pull requests](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

1. [Releases](/PrestaShop/PrestaShop/releases)
2. [1.7.7.2](/PrestaShop/PrestaShop/releases/tag/1.7.7.2)

# PrestaShop 1.7.7.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/PrestaShop/PrestaShop/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...1.7.7.2)

 Loading

[View all tags](/PrestaShop/PrestaShop/tags)

![@matks](https://avatars.githubusercontent.com/u/3830050?s=40&v=4)
[matks](/matks)
released this
22 Feb 10:33

·
[28435 commits](/PrestaShop/PrestaShop/compare/1.7.7.2...develop)
to develop
since this release

[1.7.7.2](/PrestaShop/PrestaShop/tree/1.7.7.2)

[`6e28275`](/PrestaShop/PrestaShop/commit/6e282755bddaaf3eab6fecdafc3da38d54f75dcc)

This patch release fixes multiple regressions reported on versions 1.7.7.0 and 1.7.7.1 and 2 security issues.

# Security issues fixed

* [#GHSA-557h-hf3c-whcg](https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-557h-hf3c-whcg): Improper session management for soft logout
* [#GHSA-2rw4-2p99-cmx9](https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-2rw4-2p99-cmx9): CSV Injection via csv export

## Main fixes

**Upgrade**

* [When upgrading from 1.6.1.24 to 1.7.7.1, modules crashes the FO](https://github.com/PrestaShop/PrestaShop/issues/22668)
* [When upgrading from 1.7.6.9 to 1.7.7.1 some DB's columns are missing](https://github.com/PrestaShop/PrestaShop/issues/22881)

**SEO**

* [ItemList is incorrect for products blocks of carousels and product list](https://github.com/PrestaShop/PrestaShop/issues/22636)
* [A search with Alias composed with two words doesn't show any results](https://github.com/PrestaShop/PrestaShop/issues/22444)

**Order page**

* [I cannot delete a product when debug mode is enabled](https://github.com/PrestaShop/PrestaShop/issues/22625)
* [The display of the cart rule on FO with free gift + percentage cart rule is incorrect](https://github.com/PrestaShop/PrestaShop/issues/22615)
* [The Shipping price not instantly updated on the Order page](https://github.com/PrestaShop/PrestaShop/issues/21267)
* [The VAT number is missing in order page](https://github.com/PrestaShop/PrestaShop/issues/22830)
* [I cannot search a product when a shop from different Group is selected on create a the Add new order page](https://github.com/PrestaShop/PrestaShop/issues/22460)
* [Symfony ContextErrorException Error 500 when debug enabled](https://github.com/PrestaShop/PrestaShop/issues/22231)
* [The refresh button is not working on details modal of carts on the customer page](https://github.com/PrestaShop/PrestaShop/issues/22105)
* [The gift block is not updated when changing the Address for a discount on the countrie on the Add new Order page](https://github.com/PrestaShop/PrestaShop/issues/22243)
* [An error is displayed in the console when adding a voucher](https://github.com/PrestaShop/PrestaShop/issues/22590)

**Shopping Cart**

* [Reference number of product is incorrect in Shopping Carts](https://github.com/PrestaShop/PrestaShop/issues/22854)
* [Searching and viewing shopping carts in the back office produces an "unexpected error" screen](https://github.com/PrestaShop/PrestaShop/issues/22812)

**Others**

* [Installation Error in Persian (Farsi) Language](https://github.com/PrestaShop/PrestaShop/issues/22657)
* [Customer Group Discounts are not showned on Your voucher page in the front-office](https://github.com/PrestaShop/PrestaShop/issues/22397)

# Full Changelog

Click here to see

* Back Office:
  + Bug fix:
    - [#23289](https://github.com/PrestaShop/PrestaShop/pull/23289): Use default currency when supplier currency setting is incorrect (by [@atomiix](https://github.com/atomiix))
    - [#23078](https://github.com/PrestaShop/PrestaShop/pull/23078): [BC Break] Fixed missing APE/SIRET Code in BackOffice Order View (by [@Progi1984](https://github.com/Progi1984))
    - [#22980](https://github.com/PrestaShop/PrestaShop/pull/22980): Replaced hooks displayAdminList<Before|After> with displayAdminGridTable<Before|After> (by [@Progi1984](https://github.com/Progi1984))
    - [#22997](https://github.com/PrestaShop/PrestaShop/pull/22997): Fix compare function of dashboard's calendar (by [@NeOMakinG](https://github.com/NeOMakinG))
    - [#22947](https://github.com/PrestaShop/PrestaShop/pull/22947): Fix Shopping Cart page in BO throwing an exception (by [@atomiix](https://github.com/atomiix))
    - [#22909](https://github.com/PrestaShop/PrestaShop/pull/22909): BO - Create Order - Updated product list when adresses changed (by [@Progi1984](https://github.com/Progi1984))
    - [#22863](https://github.com/PrestaShop/PrestaShop/pull/22863): Fix reference in Shopping carts view (by [@kpodemski](https://github.com/kpodemski))
    - [#22805](https://github.com/PrestaShop/PrestaShop/pull/22805): BO - Orders page - Cannot delete a product restricted by a cart rule (by [@Progi1984](https://github.com/Progi1984))
    - [#22688](https://github.com/PrestaShop/PrestaShop/pull/22688): Prevent HookDataCollector unserialize() to throw an exception (by [@atomiix](https://github.com/atomiix))
    - [#22685](https://github.com/PrestaShop/PrestaShop/pull/22685): Create Order - Cart details modal - Fix refresh for cart total (by [@sowbiba](https://github.com/sowbiba))
    - [#22673](https://github.com/PrestaShop/PrestaShop/pull/22673): PerfectScrollBar needs available element (by [@PierreRambaud](https://github.com/PierreRambaud))
    - [#22542](https://github.com/PrestaShop/PrestaShop/pull/22542): Handle case where product location is a boolean (by [@atomiix](https://github.com/atomiix))
    - [#22367](https://github.com/PrestaShop/PrestaShop/pull/22367): Order view - Refresh shipping tab when product is added, removed or updated (by [@sowbiba](https://github.com/sowbiba))
    - [#22579](https://github.com/PrestaShop/PrestaShop/pull/22579): Prevent HookDataCollector unserialize() to throw an exception (by [@atomiix](https://github.com/atomiix))
    - [#22161](https://github.com/PrestaShop/PrestaShop/pull/22161): Fix group reduction when specific price is set (by [@sowbiba](https://github.com/sowbiba))
    - [#22249](https://github.com/PrestaShop/PrestaShop/pull/22249): Create Order - Cart details modal - Fix refresh for cart total (by [@sowbiba](https://github.com/sowbiba))
* Front Office:
  + Improvement:
    - [#22528](https://github.com/PrestaShop/PrestaShop/pull/22528): Better handle aliases with space in search (by [@atomiix](https://github.com/atomiix))
  + Bug fix:
    - [#23024](https://github.com/PrestaShop/PrestaShop/pull/23024): Fixed BreadcrumbList Rich Result on FrontOffice (by [@Progi1984](https://github.com/Progi1984))
    - [#22518](https://github.com/PrestaShop/PrestaShop/pull/22518): Define when a voucher should be displayed in 'Your vouchers' (by [@atomiix](https://github.com/atomiix))
* Core:
  + Improvement:
    - [#23224](https://github.com/PrestaShop/PrestaShop/pull/23224): Update PrestaShop's composer dependencies (by [@atomiix](https://github.com/atomiix))
    - [#23220](https://github.com/PrestaShop/PrestaShop/pull/23220): Update composer versions of native modules for 1.7.7.2 (by [@matks](https://github.com/matks))
  + Bug fix:
    - #[GHSA-557h-hf3c-whcg](https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-557h-hf3c-whcg "GHSA-557h-hf3c-whcg"): Improper session management for soft logout (by [@PierreRambaud](https://github.com/PierreRambaud))
    - #[GHSA-2rw4-2p99-cmx9](https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-2rw4-2p99-cmx9 "GHSA-2rw4-2p99-cmx9"): CSV Injection via csv export (by [@PierreRambaud](https://github.com/PierreRambaud))
    - [#23276](https://github.com/PrestaShop/PrestaShop/pull/23276): Update composer version of ps\_categorytree (by [@atomiix](https://github.com/atomiix))
    - [#22682](https://github.com/PrestaShop/PrestaShop/pull/22682): Fix warning/errors from upgrade scripts (by [@atomiix](https://github.com/atomiix))
    - [#23139](https://github.com/PrestaShop/PrestaShop/pull/23139): Update pear/archive\_tar to 1.4.12 (by [@matks](https://github.com/matks))
    - [#22768](https://github.com/PrestaShop/PrestaShop/pull/22768): Exclude gifts from getOrderTotal when selected ONLY\_PRODUCTS (by [@PierreRambaud](https://github.com/PierreRambaud))
    - [#22841](https://github.com/PrestaShop/PrestaShop/pull/22841): Bring back vat number to address on order view (by [@kpodemski](https://github.com/kpodemski))
* Installer:
  + Bug fix:
    - [#22735](https://github.com/PrestaShop/PrestaShop/pull/22735): Fix installation carrier delay Error for Persian Language (by [@matks](https://github.com/matks))
* Tests:
  + Refactoring:
    - [#22875](https://github.com/PrestaShop/PrestaShop/pull/22875): Rename default account var name (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#23129](https://github.com/PrestaShop/PrestaShop/pull/23129): Add test - Enable/Disable demo mode (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#23004](https://github.com/PrestaShop/PrestaShop/pull/23004): Add test 'Languages pagination' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#23023](https://github.com/PrestaShop/PrestaShop/pull/23023): Add test 'Carrier options - order by ascending/descending ' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22953](https://github.com/PrestaShop/PrestaShop/pull/22953): Add test 'Filter, sort and paginaion shops' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22985](https://github.com/PrestaShop/PrestaShop/pull/22985): Add test 'Set required fields for address page' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22954](https://github.com/PrestaShop/PrestaShop/pull/22954): Add test 'Sort shop groups' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22925](https://github.com/PrestaShop/PrestaShop/pull/22925): Add test 'Add and delete shop URL' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22927](https://github.com/PrestaShop/PrestaShop/pull/22927): Fix nightly 21-01-2021 on 1.7.7.x (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#22912](https://github.com/PrestaShop/PrestaShop/pull/22912): Fix nightly tests failing on 20-01-2021 (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#22900](https://github.com/PrestaShop/PrestaShop/pull/22900): Add test 'Test handling charges for carriers in FO' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22856](https://github.com/PrestaShop/PrestaShop/pull/22856): Add test 'Check customer block' in order page (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22855](https://github.com/PrestaShop/PrestaShop/pull/22855): Add test 'View vouchers on FO account Page' (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#22874](https://github.com/PrestaShop/PrestaShop/pull/22874): Add test 'Check number of orders in order history page' (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#22762](https://github.com/PrestaShop/PrestaShop/pull/22762): Add test 'Filter sort pagination shop groups' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22879](https://github.com/PrestaShop/PrestaShop/pull/22879): Add test 'CRUD shop group' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22876](https://github.com/PrestaShop/PrestaShop/pull/22876): Add test 'Filter,sort and pagination logs' (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22792](https://github.com/PrestaShop/PrestaShop/pull/22792): Backport UI tests for 1.7.7.2 (by [@boubkerbribri](https://github.com/boubkerbribri))
    - [#22556](https://github.com/PrestaShop/PrestaShop/pull/22556): Fix nightly 1.7.7.x - 23/12/2020 (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22678](https://github.com/PrestaShop/PrestaShop/pull/22678): Fix nightly 1.7.7.x - 05/01/2021 (by [@nesrineabdmouleh](https://github.com/nesrineabdmouleh))
    - [#22656](https://github.com/PrestaShop/PrestaShop/pull/22656): Delete UI upgrade test (by [@boubkerbribri](https://github.com/boubkerbribri))

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1cd71a22_20250114_183621.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Fsecurity%2Fadvisories%2FGHSA-2rw4-2p99-cmx9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Fsecurity%2Fadvisories%2FGHSA-2rw4-2p99-cmx9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=PrestaShop%2FPrestaShop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrestaShop](/PrestaShop)
/
**[PrestaShop](/PrestaShop/PrestaShop)**
Public

* [Notifications](/login?return_to=%2FPrestaShop%2FPrestaShop) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2FPrestaShop%2FPrestaShop)
* [Star
   8.3k](/login?return_to=%2FPrestaShop%2FPrestaShop)

* [Code](/PrestaShop/PrestaShop)
* [Issues
  2.6k](/PrestaShop/PrestaShop/issues)
* [Pull requests
  177](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects
  2](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

Additional navigation options

* [Code](/PrestaShop/PrestaShop)
* [Issues](/PrestaShop/PrestaShop/issues)
* [Pull requests](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

# CSV Injection via csv export

Moderate

[matks](/matks)
published
GHSA-2rw4-2p99-cmx9
Feb 22, 2021

## Package

No package listed

## Affected versions

> 1.5.0.0

## Patched versions

1.7.7.2

## Description

### Impact

The CSV Injection occurs in shop search keywords via the admin panel.

### Patches

The problem is fixed in 1.7.7.2

### References

<https://cwe.mitre.org/data/definitions/78.html>

### Severity

Moderate

### CVE ID

CVE-2021-21302

### Weaknesses

No CWEs

### Credits

* [![@0xB9](https://avatars.githubusercontent.com/u/33612375?s=40&v=4)](/0xB9)
  [0xB9](/0xB9)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2cf4995e_20250114_183618.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Fcommit%2F782b1368aa4e94dafe28f57485bffbd8893fbb1e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Fcommit%2F782b1368aa4e94dafe28f57485bffbd8893fbb1e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=PrestaShop%2FPrestaShop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrestaShop](/PrestaShop)
/
**[PrestaShop](/PrestaShop/PrestaShop)**
Public

* [Notifications](/login?return_to=%2FPrestaShop%2FPrestaShop) You must be signed in to change notification settings
* [Fork
  4.8k](/login?return_to=%2FPrestaShop%2FPrestaShop)
* [Star
   8.3k](/login?return_to=%2FPrestaShop%2FPrestaShop)

* [Code](/PrestaShop/PrestaShop)
* [Issues
  2.6k](/PrestaShop/PrestaShop/issues)
* [Pull requests
  177](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects
  2](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

Additional navigation options

* [Code](/PrestaShop/PrestaShop)
* [Issues](/PrestaShop/PrestaShop/issues)
* [Pull requests](/PrestaShop/PrestaShop/pulls)
* [Discussions](/PrestaShop/PrestaShop/discussions)
* [Actions](/PrestaShop/PrestaShop/actions)
* [Projects](/PrestaShop/PrestaShop/projects)
* [Security](/PrestaShop/PrestaShop/security)
* [Insights](/PrestaShop/PrestaShop/pulse)

## Commit

[Permalink](/PrestaShop/PrestaShop/commit/782b1368aa4e94dafe28f57485bffbd8893fbb1e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-2rw4-2p99-cmx9](https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-2rw4-2p99-cmx9 "GHSA-2rw4-2p99-cmx9")

[Browse files](/PrestaShop/PrestaShop/tree/782b1368aa4e94dafe28f57485bffbd8893fbb1e)
Browse the repository at this point in the history

```
Escape characters during module csv export
```

* Loading branch information

[![@PierreRambaud](https://avatars.githubusercontent.com/u/1462701?s=40&v=4)](/PierreRambaud)

[PierreRambaud](/PrestaShop/PrestaShop/commits?author=PierreRambaud "View all commits by PierreRambaud")
authored
Feb 22, 2021

2 parents
[3d4817d](/PrestaShop/PrestaShop/commit/3d4817d70040329045e5b6370ed62558cb28d091)
+
[0927534](/PrestaShop/PrestaShop/commit/09275345f369cb1270210ee378d903da1401e254)

commit 782b136

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**117 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* classes/module

  + classes/module/ModuleGraph.php
    [ModuleGraph.php](#diff-4b8e9fb1f1c14d5512d58bb3b79333fde5f0a8067ad01d8850c8309ac4e43a2c)
* tests/Unit/Classes

  + tests/Unit/Classes/ModuleGraphTest.php
    [ModuleGraphTest.php](#diff-798a5b030704955f4dd826f0837bc11d77729f0b7eaab3902360a26b8cdfa1a1)

## There are no files selected for viewing

48 changes: 41 additions & 7 deletions

48
[classes/module/ModuleGraph.php](#diff-4b8e9fb1f1c14d5512d58bb3b79333fde5f0a8067ad01d8850c8309ac4e43a2c "classes/module/ModuleGraph.php")

Show comments

[View file](/PrestaShop/PrestaShop/blob/782b1368aa4e94dafe28f57485bffbd8893fbb1e/classes/module/ModuleGraph.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -89,10 +89,12 @@ protected function setDateGraph($layers, $legend = false) |
|  |  | for ($i = $from\_array['mday']; $i <= $imax; ++$i) { |
|  |  | $days[] = $i; |
|  |  | } |
|  |  |  |
|  |  | for ($i = 1; $i <= $to\_array['mday']; ++$i) { |
|  |  | $days[] = $i; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | foreach ($days as $i) { |
|  |  | if ($layers == 1) { |
|  |  | $this->\_values[$i] = 0; |
| Expand All | | @@ -101,9 +103,11 @@ protected function setDateGraph($layers, $legend = false) |
|  |  | $this->\_values[$j][$i] = 0; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | $this->\_legend[$i] = ($i % 2) ? '' : sprintf('%02d', $i); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (is\_callable([$this, 'setMonthValues'])) { |
|  |  | $this->setMonthValues($layers); |
|  |  | } |
| Expand Down  Expand Up | | @@ -146,6 +150,7 @@ protected function setDateGraph($layers, $legend = false) |
|  |  | for ($i = $from\_array['year']; $i <= $to\_array['year']; ++$i) { |
|  |  | $years[] = $i; |
|  |  | } |
|  |  |  |
|  |  | foreach ($years as $i) { |
|  |  | if ($layers == 1) { |
|  |  | $this->\_values[$i] = 0; |
| Expand All | | @@ -157,6 +162,7 @@ protected function setDateGraph($layers, $legend = false) |
|  |  | $this->\_legend[$i] = sprintf('%04d', $i); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (is\_callable([$this, 'setAllTimeValues'])) { |
|  |  | $this->setAllTimeValues($layers); |
|  |  | } |
| Expand All | | @@ -174,6 +180,7 @@ protected function csvExport($datas) |
|  |  | if (isset($datas['option'])) { |
|  |  | $this->setOption($datas['option'], $layers); |
|  |  | } |
|  |  |  |
|  |  | $this->getData($layers); |
|  |  |  |
|  |  | // @todo use native CSV PHP functions ? |
| Expand All | | @@ -184,32 +191,35 @@ protected function csvExport($datas) |
|  |  | $this->\_csv .= ';'; |
|  |  | } |
|  |  | if (isset($this->\_titles['main'][$i])) { |
|  |  | $this->\_csv .= $this->\_titles['main'][$i]; |
|  |  | $this->\_csv .= $this->escapeCell($this->\_titles['main'][$i]); |
|  |  | } |
|  |  | } |
|  |  | } else { // If there is only one column title, there is in fast two column (the first without title) |
|  |  | $this->\_csv .= ';' . $this->\_titles['main']; |
|  |  | $this->\_csv .= ';' . $this->escapeCell($this->\_titles['main']); |
|  |  | } |
|  |  |  |
|  |  | $this->\_csv .= "\n"; |
|  |  | if (count($this->\_legend)) { |
|  |  | $total = 0; |
|  |  |  |
|  |  | if ($datas['type'] == 'pie') { |
|  |  | foreach ($this->\_legend as $key => $legend) { |
|  |  | for ($i = 0, $total\_main = (is\_array($this->\_titles['main']) ? count($this->\_values) : 1); $i < $total\_main; ++$i) { |
|  |  | $total += (is\_array($this->\_values[$i]) ? $this->\_values[$i][$key] : $this->\_values[$key]); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | foreach ($this->\_legend as $key => $legend) { |
|  |  | $this->\_csv .= $legend . ';'; |
|  |  | $this->\_csv .= $this->escapeCell($legend) . ';'; |
|  |  | for ($i = 0, $total\_main = (is\_array($this->\_titles['main']) ? count($this->\_values) : 1); $i < $total\_main; ++$i) { |
|  |  | if (!isset($this->\_values[$i]) || !is\_array($this->\_values[$i])) { |
|  |  | if (isset($this->\_values[$key])) { |
|  |  | // We don't want strings to be divided. Example: product name |
|  |  | if (is\_numeric($this->\_values[$key])) { |
|  |  | $this->\_csv .= $this->\_values[$key] / (($datas['type'] == 'pie') ? $total : 1); |
|  |  | } else { |
|  |  | $this->\_csv .= $this->\_values[$key]; |
|  |  | $this->\_csv .= $this->escapeCell($this->\_values[$key]); |
|  |  | } |
|  |  | } else { |
|  |  | $this->\_csv .= '0'; |
| Expand All | | @@ -219,14 +229,15 @@ protected function csvExport($datas) |
|  |  | if (is\_numeric($this->\_values[$i][$key])) { |
|  |  | $this->\_csv .= $this->\_values[$i][$key] / (($datas['type'] == 'pie') ? $total : 1); |
|  |  | } else { |
|  |  | $this->\_csv .= $this->\_values[$i][$key]; |
|  |  | $this->\_csv .= $this->escapeCell($this->\_values[$i][$key]); |
|  |  | } |
|  |  | } |
|  |  | $this->\_csv .= ';'; |
|  |  | } |
|  |  | $this->\_csv .= "\n"; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | $this->\_displayCsv(); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -342,12 +353,12 @@ protected static function getEmployee($employee = null, Context $context = null) |
|  |  |  |
|  |  | public function getDate() |
|  |  | { |
|  |  | return ModuleGraph::getDateBetween($this->\_employee); |
|  |  | return static::getDateBetween($this->\_employee); |
|  |  | } |
|  |  |  |
|  |  | public static function getDateBetween($employee = null) |
|  |  | { |
|  |  | if ($employee = ModuleGraph::getEmployee($employee)) { |
|  |  | if ($employee = static::getEmployee($employee)) { |
|  |  | return ' \'' . pSQL($employee->stats\_date\_from) . ' 00:00:00\' AND \'' . pSQL($employee->stats\_date\_to) . ' 23:59:59\' '; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -358,4 +369,27 @@ public function getLang() |
|  |  | { |
|  |  | return $this->\_id\_lang; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Escape cell content. |
|  |  | \* If the content begins with =+-@ a quote is added at the beginning of |
|  |  | \* the string. |
|  |  | \* In all situation, add double quote to encapsulate the content. |
|  |  | \* |
|  |  | \* @param string $content |
|  |  | \* |
|  |  | \* @return string |
|  |  | \*/ |
|  |  | public function escapeCell(string $content): string |
|  |  | { |
|  |  | $escaped = '"'; |
|  |  | if (preg\_match('~^[=+\-@]~', $content)) { |
|  |  | $content = '\'' . $content; |
|  |  | } |
|  |  |  |
|  |  | $escaped .= str\_replace('"', '""', $content); |
|  |  | $escaped .= '"'; |
|  |  |  |
|  |  | return $escaped; |
|  |  | } |
|  |  | } |

76 changes: 76 additions & 0 deletions

76
[tests/Unit/Classes/ModuleGraphTest.php](#diff-798a5b030704955f4dd826f0837bc11d77729f0b7eaab3902360a26b8cdfa1a1 "tests/Unit/Classes/ModuleGraphTest.php")

Show comments

[View file](/PrestaShop/PrestaShop/blob/782b1368aa4e94dafe28f57485bffbd8893fbb1e/tests/Unit/Classes/ModuleGraphTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,76 @@ |
|  |  | <?php |
|  |  | /\*\* |
|  |  | \* Copyright since 2007 PrestaShop SA and Contributors |
|  |  | \* PrestaShop is an International Registered Trademark & Property of PrestaShop SA |
|  |  | \* |
|  |  | \* NOTICE OF LICENSE |
|  |  | \* |
|  |  | \* This source file is subject to the Open Software License (OSL 3.0) |
|  |  | \* that is bundled with this package in the file LICENSE.md. |
|  |  | \* It is also available through the world-wide-web at this URL: |
|  |  | \* https://opensource.org/licenses/OSL-3.0 |
|  |  | \* If you did not receive a copy of the license and are unable to |
|  |  | \* obtain it through the world-wide-web, please send an email |
|  |  | \* to license@prestashop.com so we can send you a copy immediately. |
|  |  | \* |
|  |  | \* DISCLAIMER |
|  |  | \* |
|  |  | \* Do not edit or add to this file if you wish to upgrade PrestaShop to newer |
|  |  | \* versions in the future. If you wish to customize PrestaShop for your |
|  |  | \* needs please refer to https://devdocs.prestashop.com/ for more information. |
|  |  | \* |
|  |  | \* @author PrestaShop SA and Contributors <contact@prestashop.com> |
|  |  | \* @copyright Since 2007 PrestaShop SA and Contributors |
|  |  | \* @license https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0) |
|  |  | \*/ |
|  |  |  |
|  |  | namespace Tests\Unit\Classes; |
|  |  |  |
|  |  | use Error; |
|  |  | use ModuleGraph; |
|  |  | use PHPUnit\Framework\TestCase; |
|  |  |  |
|  |  | class ModuleGraphTest extends TestCase |
|  |  | { |
|  |  | public static $data; |
|  |  |  |
|  |  | protected function setUp() |
|  |  | { |
|  |  | $this->object = new class() extends ModuleGraph { |
|  |  | public function getData($layers) |
|  |  | { |
|  |  | return ModuleGraphTest::$data; |
|  |  | } |
|  |  | }; |
|  |  | } |
|  |  |  |
|  |  | public function testDrawWithoutInitialization() |
|  |  | { |
|  |  | $this->expectException(Error::class); |
|  |  | $this->object->draw(); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @dataProvider getEscapeCellValues |
|  |  | \*/ |
|  |  | public function testEscapeCell($base, $expected) |
|  |  | { |
|  |  | $this->assertEquals( |
|  |  | $this->object->escapeCell($base), |
|  |  | $expected |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | public function getEscapeCellValues() |
|  |  | { |
|  |  | return [ |
|  |  | ['=CMD', '"\'=CMD"'], |
|  |  | ['@here', '"\'@here"'], |
|  |  | ['+something', '"\'+something"'], |
|  |  | ['-thing', '"\'-thing"'], |
|  |  | ['hello world', '"hello world"'], |
|  |  | ['=@+-', '"\'=@+-"'], |
|  |  | ['Hey "you"!', '"Hey ""you""!"'], |
|  |  | ]; |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `782b136`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrestaShop%2FPrestaShop%2Fcommit%2F782b1368aa4e94dafe28f57485bffbd8893fbb1e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


