- **Root cause of vulnerability**: The vulnerability is caused by insufficient sanitization of the `cwd` parameter in the FsTFtp functionality of the Lantronix PremierWave 2050 Web Manager. The `cwd` parameter is used to specify the working directory for file transfers, but it does not properly sanitize path traversal primitives like `../`, allowing an attacker to navigate outside the intended `/ltrx_user/` directory.
- **Weaknesses/vulnerabilities present**:
    - Path Traversal (CWE-22): The vulnerability allows an attacker to traverse the file system beyond the intended directory due to the lack of proper input validation on the `cwd` parameter.
    - Arbitrary File Disclosure: By using the path traversal vulnerability, an attacker can read arbitrary files from the device's filesystem.
    - Arbitrary File Overwrite: The same path traversal vulnerability can also be used to write to and overwrite arbitrary files on the device's filesystem.
- **Impact of exploitation**:
    - Arbitrary file disclosure: Attackers can read sensitive files, such as `/etc/shadow`, exposing credentials.
    - Arbitrary file overwrite: Attackers can overwrite critical system files, such as `authorized_keys` to gain persistent access, overwrite executables, or cause denial of service.
- **Attack vectors**:
    - The vulnerability is exploited by sending a specially crafted HTTP POST request to the `/` endpoint of the Web Manager.
    - The malicious request manipulates the `cwd` parameter with path traversal sequences like `../`.
    - The request includes parameters to initiate a TFTP transfer (either `put` to send a file from the device, or `get` to receive a file to the device).
- **Required attacker capabilities/position**:
    - The attacker needs to be authenticated to the Web Manager, with a user having the `filesystem` privilege.
    - The attacker needs to be able to send HTTP requests to the device's web interface.
    - For file exfiltration the attacker needs a reachable TFTP server.
    - For file overwrite the attacker needs to have a reachable TFTP server that hosts the malicious file to upload.