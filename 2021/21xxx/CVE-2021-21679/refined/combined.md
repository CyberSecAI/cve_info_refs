=== Content from www.openwall.com_e65806d8_20250114_203934.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2021/08/30/1) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <50166790-02D0-4268-BA79-FF5236A664D5@beckweb.net>
Date: Tue, 31 Aug 2021 15:45:02 +0200
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* Azure AD Plugin 180.v8b1e80e6f242
* Code Coverage API Plugin 1.4.1
* Nested View Plugin 1.21
* Nomad Plugin 0.7.5
* SAML Plugin 2.0.8

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://www.jenkins.io/security/advisory/2021-08-31/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-2376 / CVE-2021-21677
Code Coverage API Plugin 1.4.0 and earlier does not apply JEP-200
deserialization protection to Java objects it deserializes from disk.

This results in a remote code execution (RCE) vulnerability exploitable by
attackers able to control agent processes.

SECURITY-2469 / CVE-2021-21678
An extension point in Jenkins allows selectively disabling cross-site
request forgery (CSRF) protection for specific URLs. SAML Plugin implements
this extension point for the URL that users are redirected to after login.

In SAML Plugin 2.0.7 and earlier this implementation is too permissive,
allowing attackers to craft URLs that would bypass the CSRF protection of
any target URL.

SECURITY-2470 / CVE-2021-21679
An extension point in Jenkins allows selectively disabling cross-site
request forgery (CSRF) protection for specific URLs. Azure AD Plugin
implements this extension point for URLs used by a JavaScript component.

In Azure AD Plugin 179.vf6841393099e and earlier this implementation is too
permissive, allowing attackers to craft URLs that would bypass the CSRF
protection of any target URL.

SECURITY-2411 / CVE-2021-21680
Nested View Plugin 1.20 and earlier does not configure its XML transformer
to prevent XML external entity (XXE) attacks.

This allows attackers able to configure views to have Jenkins parse a
crafted view XML definition that uses external entities for extraction of
secrets from the Jenkins controller or server-side request forgery.

SECURITY-2396 / CVE-2021-21681
Nomad Plugin 0.7.4 and earlier stores the passwords to authenticate against
the Docker registry unencrypted in the global `config.xml` file on the
Jenkins controller as part of its worker templates configuration.

These passwords can be viewed by users with access to the Jenkins
controller file system.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.jenkins.io_80174acb_20250114_203934.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2021-08-31

This advisory announces vulnerabilities in the following Jenkins deliverables:

* [Code Coverage
  Plugin](https://plugins.jenkins.io/code-coverage-api)
* [Microsoft Entra ID (previously Azure AD)
  Plugin](https://plugins.jenkins.io/azure-ad)
* [Nested View
  Plugin](https://plugins.jenkins.io/nested-view)
* [Nomad
  Plugin](https://plugins.jenkins.io/nomad)
* [SAML
  Plugin](https://plugins.jenkins.io/saml)

## Descriptions

### RCE vulnerability in Code Coverage Plugin

**SECURITY-2376
/
CVE-2021-21677**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Affected plugin:
[`code-coverage-api`](https://plugins.jenkins.io/code-coverage-api)**

**Description:**

Code Coverage Plugin 1.4.0 and earlier does not apply [JEP-200 deserialization protection](https://github.com/jenkinsci/jep/tree/master/jep/200) to Java objects it deserializes from disk.

This results in a remote code execution (RCE) vulnerability exploitable by attackers able to control agent processes.

Code Coverage Plugin 1.4.1 configures its Java object deserialization to only deserialize safe types.

### SAML Plugin allows bypassing CSRF protection for any URL

**SECURITY-2469
/
CVE-2021-21678**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`saml`](https://plugins.jenkins.io/saml)**

**Description:**

An extension point in Jenkins allows selectively disabling cross-site request forgery (CSRF) protection for specific URLs.
SAML Plugin implements this extension point for the URL that users are redirected to after login.

In SAML Plugin 2.0.7 and earlier this implementation is too permissive, allowing attackers to craft URLs that would bypass the CSRF protection of any target URL.

This vulnerability was originally introduced in SAML Plugin 1.1.3.

SAML Plugin 2.0.8 restricts which URLs it disables cross-site request forgery (CSRF) protection for to the one URL that needs it.

### Microsoft Entra ID (previously Azure AD) Plugin allows bypassing CSRF protection for any URL

**SECURITY-2470
/
CVE-2021-21679**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`azure-ad`](https://plugins.jenkins.io/azure-ad)**

**Description:**

An extension point in Jenkins allows selectively disabling cross-site request forgery (CSRF) protection for specific URLs.
Microsoft Entra ID (previously Azure AD) Plugin implements this extension point for URLs used by a JavaScript component.

In Microsoft Entra ID (previously Azure AD) Plugin 179.vf6841393099e and earlier this implementation is too permissive, allowing attackers to craft URLs that would bypass the CSRF protection of any target URL.

This vulnerability was originally introduced in Microsoft Entra ID (previously Azure AD) Plugin 164.v5b48baa961d2.

Microsoft Entra ID (previously Azure AD) Plugin 180.v8b1e80e6f242 no longer allows bypassing CSRF protection for URLs used by the JavaScript component.
Instead, that component was reconfigured to pass the expected CSRF token.

### XXE vulnerability in Nested View Plugin

**SECURITY-2411
/
CVE-2021-21680**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)

**Affected plugin:
[`nested-view`](https://plugins.jenkins.io/nested-view)**

**Description:**

Nested View Plugin 1.20 and earlier does not configure its XML transformer to prevent XML external entity (XXE) attacks.

This allows attackers able to configure views to have Jenkins parse a crafted view XML definition that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.

Nested View Plugin 1.21 disables external entity resolution for its XML transformer.

### Password stored in plain text by Nomad Plugin

**SECURITY-2396
/
CVE-2021-21681**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`nomad`](https://plugins.jenkins.io/nomad)**

**Description:**

Nomad Plugin 0.7.4 and earlier stores the passwords to authenticate against the Docker registry unencrypted in the global `config.xml` file on the Jenkins controller as part of its worker templates configuration.

These passwords can be viewed by users with access to the Jenkins controller file system.

Nomad Plugin 0.7.5 stores the Docker passwords encrypted.
This change is effective after Jenkins restarts.

## Severity

* SECURITY-2376:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-2396:
  [Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-2411:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)
* SECURITY-2469:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-2470:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

## Affected Versions

* **Code Coverage
  Plugin**
  up to and including
  1.4.0
* **Microsoft Entra ID (previously Azure AD)
  Plugin**
  up to and including
  179.vf6841393099e
* **Nested View
  Plugin**
  up to and including
  1.20
* **Nomad
  Plugin**
  up to and including
  0.7.4
* **SAML
  Plugin**
  up to and including
  2.0.7

## Fix

* **Code Coverage
  Plugin**
  should be updated to version
  1.4.1
* **Microsoft Entra ID (previously Azure AD)
  Plugin**
  should be updated to version
  180.v8b1e80e6f242
* **Nested View
  Plugin**
  should be updated to version
  1.21
* **Nomad
  Plugin**
  should be updated to version
  0.7.5
* **SAML
  Plugin**
  should be updated to version
  2.0.8

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Brian Hysell, Synopsys Software Integrity Group**
  for
  SECURITY-2411
* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-2469, SECURITY-2470


