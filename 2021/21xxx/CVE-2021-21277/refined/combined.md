=== Content from github.com_35aae048_20250115_102446.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeerigon%2Fangular-expressions%2Fsecurity%2Fadvisories%2FGHSA-j6px-jwvv-vpwq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeerigon%2Fangular-expressions%2Fsecurity%2Fadvisories%2FGHSA-j6px-jwvv-vpwq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=peerigon%2Fangular-expressions)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[peerigon](/peerigon)
/
**[angular-expressions](/peerigon/angular-expressions)**
Public

* [Notifications](/login?return_to=%2Fpeerigon%2Fangular-expressions) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fpeerigon%2Fangular-expressions)
* [Star
   95](/login?return_to=%2Fpeerigon%2Fangular-expressions)

* [Code](/peerigon/angular-expressions)
* [Issues
  2](/peerigon/angular-expressions/issues)
* [Pull requests
  0](/peerigon/angular-expressions/pulls)
* [Actions](/peerigon/angular-expressions/actions)
* [Projects
  0](/peerigon/angular-expressions/projects)
* [Wiki](/peerigon/angular-expressions/wiki)
* [Security](/peerigon/angular-expressions/security)
* [Insights](/peerigon/angular-expressions/pulse)

Additional navigation options

* [Code](/peerigon/angular-expressions)
* [Issues](/peerigon/angular-expressions/issues)
* [Pull requests](/peerigon/angular-expressions/pulls)
* [Actions](/peerigon/angular-expressions/actions)
* [Projects](/peerigon/angular-expressions/projects)
* [Wiki](/peerigon/angular-expressions/wiki)
* [Security](/peerigon/angular-expressions/security)
* [Insights](/peerigon/angular-expressions/pulse)

# Angular Expressions - Remote Code Execution

High

[edi9999](/edi9999)
published
GHSA-j6px-jwvv-vpwq
Jan 29, 2021

## Package

npm

angular-expressions
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<1.1.2

## Patched versions

1.1.2

## Description

### Impact

The vulnerability, reported by GoSecure Inc, allows Remote Code Execution, if you call `expressions.compile(userControlledInput)` where `userControlledInput` is text that comes from user input.

This time, the security of the package could be bypassed by using a more complex payload, using a `.constructor.constructor` technique.

* If running angular-expressions in the browser, an attacker could run any browser script when the application code calls expressions.compile(userControlledInput).
* If running angular-expressions on the server, an attacker could run any Javascript expression, thus gaining Remote Code Execution.

### Patches

Users should upgrade to version 1.1.2 of angular-expressions

### Workarounds

A temporary workaround might be either to :

* disable user-controlled input that will be fed into angular-expressions in your application

OR

* allow only following characters in the userControlledInput :

```
if (/^[|a-zA-Z.0-9 :"'+-?]+$/.test(userControlledInput)) {
      var result = expressions.compile(userControlledInput);
}
else {
     result = undefined;
}
```
### References

[Removal of angular-expression sandbox](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [angular-expressions](https://github.com/peerigon/angular-expressions/issues)
* Email us

### Credits

The issue was reported by Maxime Nadeau from GoSecure, Inc.

### Severity

High

### CVE ID

CVE-2021-21277

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_e4a8fe82_20250115_102448.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## angular-expressionsTypeScript icon, indicating that this package has built-in type declarations

1.4.3Â â¢Â PublicÂ â¢Â Published a month ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [70 Dependents](?activeTab=dependents)
* [24 Versions](?activeTab=versions)

# angular-expressions

**[angular's nicest part](https://github.com/angular/angular.js/blob/6b049c74ccc9ee19688bb9bbe504c300e61776dc/src/ng/parse.js) extracted as a standalone module for the browser and node.**

[![build status](https://camo.githubusercontent.com/ab1fa111e052e79c07f6eb1e09184214ef035146d047a1ab91544bc7687bb393/68747470733a2f2f7472617669732d63692e6f72672f7065657269676f6e2f616e67756c61722d65787072657373696f6e732e737667)](http://travis-ci.org/peerigon/angular-expressions)

**angular-expressions** exposes a `.compile()`-method which can be used to compile evaluable expressions:

```
var expressions = require("angular-expressions");

evaluate = expressions.compile("1 + 1");
evaluate(); // returns 2
```

You can also set and get values on a given `scope`:

```
evaluate = expressions.compile("name");
scope = { name: "Jenny" };
evaluate(scope); // returns 'Jenny'

evaluate = expressions.compile("ship.pirate.name = 'StÃ¶rtebeker'");
evaluate(scope); // won't throw an error because angular's expressions are forgiving
console.log(scope.ship.pirate.name); // prints 'StÃ¶rtebeker'
```

For assigning values, you can also use `.assign()`:

```
evaluate = expressions.compile("ship.pirate.name");
evaluate.assign(scope, "StÃ¶rtebeker");
console.log(scope.ship.pirate.name); // prints 'StÃ¶rtebeker'
```

Check out [their readme](http://docs.angularjs.org/guide/expression) for further information.

## Setup

[![npm status](https://camo.githubusercontent.com/99f12f456b2863cb446011feac5c5f0ad5c679fa9037d25d235a4282f1791364/68747470733a2f2f6e6f6465692e636f2f6e706d2f616e67756c61722d65787072657373696f6e732e7376673f646f776e6c6f6164733d747275652673746172733d7472756526646f776e6c6f616452616e6b3d74727565)](https://npmjs.org/package/angular-expressions)

## Filters

Angular provides a mechanism to define filters on expressions:

```
expressions.filters.uppercase = (input) => input.toUpperCase();

expr = expressions.compile("'arr' | uppercase");
expr(); // returns 'ARR'
```

Arguments are evaluated against the scope:

```
expressions.filters.currency = (input, currency, digits) => {
  input = input.toFixed(digits);

  if (currency === "EUR") {
    return input + "â¬";
  } else {
    return input + "$";
  }
};

expr = expressions.compile("1.2345 | currency:selectedCurrency:2");
expr({
  selectedCurrency: "EUR",
}); // returns '1.23â¬'
```

If you need an isolated `filters` object, this can be achieved by setting the `filters` attribute in the `options` argument. Global cache is disabled if using `options.filters`. To setup an isolated cache, you can also set the `cache` attribute in the `options` argument:

```
var isolatedFilters = {
  transform: (input) => input.toLowerCase(),
};
var isolatedCache = {};

var resultOne = expressions.compile("'Foo Bar' | transform", {
  filters: isolatedFilters,
  cache: isolatedCache,
});

console.log(resultOne()); // prints 'foo bar'
console.log(isolatedCache); // prints '{"'Foo Bar' | transform": [Function fn] }'
```

## API

### exports

#### .compile(src): Function

Compiles `src` and returns a function `evaluate()`. The compiled function is cached under `compile.cache[src]` to speed up further calls.

Compiles also export the AST.

Example output of: `compile("tmp + 1").ast`

```
{ type: 'Program',
  body:
   [ { type: 'ExpressionStatement',
       expression:
        { type: 'Identifier',
          name: 'tmp',
          constant: false,
          toWatch: [ [Circular] ] } } ],
  constant: false }

```

*NOTE* angular $parse do not export ast variable it's done by this library.

#### .compile.cache = Object.create(null)

A cache containing all compiled functions. The src is used as key. Set this on `false` to disable the cache.

#### .filters = {}

An empty object where you may define your custom filters.

#### .Lexer

The internal [Lexer](https://github.com/angular/angular.js/blob/6b049c74ccc9ee19688bb9bbe504c300e61776dc/src/ng/parse.js#L116).

#### .Parser

The internal [Parser](https://github.com/angular/angular.js/blob/6b049c74ccc9ee19688bb9bbe504c300e61776dc/src/ng/parse.js#L390).

---

### evaluate(scope?): \*

Evaluates the compiled `src` and returns the result of the expression. Property look-ups or assignments are executed on a given `scope`.

### evaluate.assign(scope, value): \*

Tries to assign the given `value` to the result of the compiled expression on the given `scope` and returns the result of the assignment.

## In the browser

There is no `dist` build because it's not 2005 anymore. Use a module bundler like [webpack](http://webpack.github.io/) or [browserify](http://browserify.org/). They're both capable of CommonJS and AMD.

## Security

The code of angular was not secured from reading prototype, and since version 1.0.1 of angular-expressions, the module disallows reading properties that are not ownProperties. See [this blog post](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html) for more details about the sandbox that got removed completely in angular 1.6.

Comment from `angular.js/src/ng/parse.js`:

---

Angular expressions are generally considered safe because these expressions only have direct
access to $scope and locals. However, one can obtain the ability to execute arbitrary JS code by
obtaining a reference to native JS functions such as the Function constructor.

As an example, consider the following Angular expression:

```
{}.toString.constructor(alert("evil JS code"))
```

We want to prevent this type of access. For the sake of performance, during the lexing phase we
disallow any "dotted" access to any member named "constructor".

For reflective calls (a[b]) we check that the value of the lookup is not the Function constructor
while evaluating the expression, which is a stronger but more expensive test. Since reflective
calls are expensive anyway, this is not such a big deal compared to static dereferencing.
This sandboxing technique is not perfect and doesn't aim to be. The goal is to prevent exploits
against the expression language, but not to prevent exploits that were enabled by exposing
sensitive JavaScript or browser apis on Scope. Exposing such objects on a Scope is never a good
practice and therefore we are not even trying to protect against interaction with an object
explicitly exposed in this way.

A developer could foil the name check by aliasing the Function constructor under a different
name on the scope.

In general, it is not possible to access a Window object from an angular expression unless a
window or some DOM object that has a reference to window is published onto a Scope.

---

## Authorship

Kudos go entirely to the great angular.js team, it's their implementation!

## Contributing

Suggestions and bug-fixes are always appreciated. Don't hesitate to create an issue or pull-request. All contributed code should pass

1. the tests in node.js by running `npm test`
2. the tests in all major browsers by running `npm run test-browser` and then visiting `http://localhost:8080/bundle`

## License

[Unlicense](http://unlicense.org/)

## Sponsors

[![](https://camo.githubusercontent.com/751a0ade3fc2fc795194b845107633400570cdb4a144e4fc13b651db7971b681/68747470733a2f2f6173736574732e7065657269676f6e2e636f6d2f7065657269676f6e2f6c6f676f2f7065657269676f6e2d6c6f676f2d666c61742d7370696e61742e706e67)](https://peerigon.com)

## Readme

### Keywords

* [angular](/search?q=keywords:angular)
* [expression](/search?q=keywords:expression)
* [parser](/search?q=keywords:parser)
* [lexer](/search?q=keywords:lexer)
* [parse](/search?q=keywords:parse)
* [eval](/search?q=keywords:eval)
* [source](/search?q=keywords:source)
## Package Sidebar

### Install

`npm i angular-expressions`

### Repository

[Gitgithub.com/peerigon/angular-expressions](https://github.com/peerigon/angular-expressions)

### Homepage

[github.com/peerigon/angular-expressions#readme](https://github.com/peerigon/angular-expressions#readme)

### DownloadsWeekly Downloads

55,272

### Version

1.4.3

### License

Unlicense

### Unpacked Size

125 kB

### Total Files

14

### Last publish

a month ago

### Collaborators

* [![jhnns](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83NWQzMzRhMzI5NDhiY2JiMTBmZDRjNjMxYWU3OWNlZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.UK0lgvzpFCPAhK4wlWneiwk8aKClJupaoVHJJHObBAs "jhnns")](/~jhnns)
* [![meaku](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci80ZjlmNGIwYjM4NzNkZGMyOGU2ODZhMmVlMGYxMDMyMT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ioRIbatjKz-Toflml-Bk_9cFHceqB8LH1nfIBzgWVTY "meaku")](/~meaku)
* [![peeri](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lOWQ5NDYxNjYzMTY0NGNhZGNlNmI0ZTE0YjYwODNlNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.OTZIwhIeQ3q30GWFEd6FtknlGr5MKOZ_HTnV5PszZBE "peeri")](/~peeri)
* [![matthaias](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yY2RhMTdhMjIxMDg4OGU5NDdiMGQxYjk5NmM1NzU2OT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.xT97xYet8O7-tZq98nOqd8-dwreZ-ilTp6-4zN8pbBA "matthaias")](/~matthaias)
* [![leomelzer](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xMDJkNzYyYWZiMTU3ZmQxZTQ1ODJlY2NhYzgxN2VjNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ibGmgbcw2Ecffa6Hqg1H4ZB3rdWN5qL8ce6Eb82iJn0 "leomelzer")](/~leomelzer)
* [![antosan](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mMDFmNzQ5MjYzMTI2ZDZhODI4OTU2MTBhN2JjYWQzND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.J5_VvhVk78KEy2n0j3aX6ONgcTwGlNxKwuGWj0pe7OI "antosan")](/~antosan)
* [![moritzjacobs](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mYzYzOGUzZDBlNDc2YzczNzgzNDA0YzJhNDI1MTc2NT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.86-4WnY5ZJjx3A2zHwK6eRj3aPjkpclGR11PrZNfi80 "moritzjacobs")](/~moritzjacobs)
* [![hpohlmeyer](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84N2M2MTViOTU1ZjU2MDg4NzEzYzgyYmY4NmY5OWQ3OD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.0kxMCHYMSWTOeW9Pk8FkpH_R6bnzmgOQaKEnF9_y93A "hpohlmeyer")](/~hpohlmeyer)
* [![edi9999](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84YWZmMWI5ZTgwNzk5OTdjY2ExMmY4ZjA4Y2FjYmI2Mj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.hm98bLr7dBmApUNhAuMZa53hw-U0MAaBWplV5yLlxVc "edi9999")](/~edi9999)
[**Try** on RunKit](https://runkit.com/npm/angular-expressions)[**Report** malware](/support?inquire=security&security-inquire=malware&package=angular-expressions&version=1.4.3)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from github.com_4f836370_20250115_102445.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeerigon%2Fangular-expressions%2Fcommit%2F07edb62902b1f6127b3dcc013da61c6316dd0bf1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeerigon%2Fangular-expressions%2Fcommit%2F07edb62902b1f6127b3dcc013da61c6316dd0bf1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=peerigon%2Fangular-expressions)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[peerigon](/peerigon)
/
**[angular-expressions](/peerigon/angular-expressions)**
Public

* [Notifications](/login?return_to=%2Fpeerigon%2Fangular-expressions) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fpeerigon%2Fangular-expressions)
* [Star
   95](/login?return_to=%2Fpeerigon%2Fangular-expressions)

* [Code](/peerigon/angular-expressions)
* [Issues
  2](/peerigon/angular-expressions/issues)
* [Pull requests
  0](/peerigon/angular-expressions/pulls)
* [Actions](/peerigon/angular-expressions/actions)
* [Projects
  0](/peerigon/angular-expressions/projects)
* [Wiki](/peerigon/angular-expressions/wiki)
* [Security](/peerigon/angular-expressions/security)
* [Insights](/peerigon/angular-expressions/pulse)

Additional navigation options

* [Code](/peerigon/angular-expressions)
* [Issues](/peerigon/angular-expressions/issues)
* [Pull requests](/peerigon/angular-expressions/pulls)
* [Actions](/peerigon/angular-expressions/actions)
* [Projects](/peerigon/angular-expressions/projects)
* [Wiki](/peerigon/angular-expressions/wiki)
* [Security](/peerigon/angular-expressions/security)
* [Insights](/peerigon/angular-expressions/pulse)

## Commit

[Permalink](/peerigon/angular-expressions/commit/07edb62902b1f6127b3dcc013da61c6316dd0bf1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix Security Vulnerability by using hasOwnProperty defensively

[Browse files](/peerigon/angular-expressions/tree/07edb62902b1f6127b3dcc013da61c6316dd0bf1)
Browse the repository at this point in the history

* Loading branch information

[![@edi9999](https://avatars.githubusercontent.com/u/2071336?s=40&v=4)](/edi9999)

[edi9999](/peerigon/angular-expressions/commits?author=edi9999 "View all commits by edi9999")
committed
Jan 29, 2021

1 parent
[171f699](/peerigon/angular-expressions/commit/171f699c9dca39d1a366fff10f1fd3eb782a462d)

commit 07edb62

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**90 additions**
and
**48 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* lib

  + lib/parse.js
    [parse.js](#diff-cc0e533610b6395aec57bad8971c3692fbf20950660cc5aa5014e58333a738ba)
* test

  + test/main.test.js
    [main.test.js](#diff-10211e7687c935409636be43040704b68ebaf019021ceefefad7562dab6f1f45)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/peerigon/angular-expressions/blob/07edb62902b1f6127b3dcc013da61c6316dd0bf1/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,3 +1,7 @@ |
|  |  | ### 1.1.2 |
|  |  |  |
|  |  | - Disallow access to prototype chain (CVE-2021-21277) |
|  |  |  |
|  |  | ### 1.1.1 |
|  |  |  |
|  |  | Previous version was published with ES6 feature, now the published JS uses ES5 only |
| Expand All | | @@ -18,7 +22,7 @@ function validChars(ch) { |
|  |  | } |
|  |  | evaluate = compile("être\_embarassé", { |
|  |  | isIdentifierStart: validChars, |
|  |  | isIdentifierContinue: validChars |
|  |  | isIdentifierContinue: validChars, |
|  |  | }); |
|  |  |  |
|  |  | evaluate({ être\_embarassé: "Ping" }); |
| Expand Down | |  |

101 changes: 57 additions & 44 deletions

101
[lib/parse.js](#diff-cc0e533610b6395aec57bad8971c3692fbf20950660cc5aa5014e58333a738ba "lib/parse.js")

Show comments

[View file](/peerigon/angular-expressions/blob/07edb62902b1f6127b3dcc013da61c6316dd0bf1/lib/parse.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1694,44 +1694,6 @@ var isAutoBootstrapAllowed = allowAutoBootstrap(window.document); |
|  |  | </file> |
|  |  | </example> |
|  |  | \*/ |
|  |  | function angularInit(element, bootstrap) { |
|  |  | var appElement, |
|  |  | module, |
|  |  | config = {}; |
|  |  |  |
|  |  | // The element `element` has priority over any other element. |
|  |  | forEach(ngAttrPrefixes, function (prefix) { |
|  |  | var name = prefix + "app"; |
|  |  |  |
|  |  | if (!appElement && element.hasAttribute && element.hasAttribute(name)) { |
|  |  | appElement = element; |
|  |  | module = element.getAttribute(name); |
|  |  | } |
|  |  | }); |
|  |  | forEach(ngAttrPrefixes, function (prefix) { |
|  |  | var name = prefix + "app"; |
|  |  | var candidate; |
|  |  |  |
|  |  | if ( |
|  |  | !appElement && |
|  |  | (candidate = element.querySelector("[" + name.replace(":", "\\:") + "]")) |
|  |  | ) { |
|  |  | appElement = candidate; |
|  |  | module = candidate.getAttribute(name); |
|  |  | } |
|  |  | }); |
|  |  | if (appElement) { |
|  |  | if (!isAutoBootstrapAllowed) { |
|  |  | window.console.error( |
|  |  | "Angular: disabling automatic bootstrap. <script> protocol indicates " + |
|  |  | "an extension, document.location.href does not match." |
|  |  | ); |
|  |  | return; |
|  |  | } |
|  |  | config.strictDi = getNgAttribute(appElement, "strict-di") !== null; |
|  |  | bootstrap(appElement, module ? [module] : [], config); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @ngdoc function |
| Expand Down  Expand Up | | @@ -3232,11 +3194,12 @@ ASTCompiler.prototype = { |
|  |  | intoId = intoId || this.nextId(); |
|  |  | this.if\_( |
|  |  | "i", |
|  |  | this.lazyAssign(intoId, this.computedMember("i", ast.watchId)), |
|  |  | this.lazyAssign(intoId, this.unsafeComputedMember("i", ast.watchId)), |
|  |  | this.lazyRecurse(ast, intoId, nameId, recursionFn, create, true) |
|  |  | ); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | switch (ast.type) { |
|  |  | case AST.Program: |
|  |  | forEach(ast.body, function (expression, pos) { |
| Expand Down  Expand Up | | @@ -3356,11 +3319,20 @@ ASTCompiler.prototype = { |
|  |  | undefined, |
|  |  | function () { |
|  |  | var member = null; |
|  |  | const inAssignment = self.current().inAssignment; |
|  |  | if (ast.computed) { |
|  |  | right = self.nextId(); |
|  |  | member = self.computedMember(left, right); |
|  |  | if (inAssignment || self.state.computing === "assign") { |
|  |  | member = self.unsafeComputedMember(left, right); |
|  |  | } else { |
|  |  | member = self.computedMember(left, right); |
|  |  | } |
|  |  | } else { |
|  |  | member = self.nonComputedMember(left, ast.property.name); |
|  |  | if (inAssignment || self.state.computing === "assign") { |
|  |  | member = self.unsafeNonComputedMember(left, ast.property.name); |
|  |  | } else { |
|  |  | member = self.nonComputedMember(left, ast.property.name); |
|  |  | } |
|  |  | right = ast.property.name; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -3447,7 +3419,13 @@ ASTCompiler.prototype = { |
|  |  | if (left.name) { |
|  |  | var x = self.member(left.context, left.name, left.computed); |
|  |  | expression = |
|  |  | x + ".call(" + [left.context].concat(args).join(",") + ")"; |
|  |  | "(" + |
|  |  | x + |
|  |  | " === null ? null : " + |
|  |  | self.unsafeMember(left.context, left.name, left.computed) + |
|  |  | ".call(" + |
|  |  | [left.context].concat(args).join(",") + |
|  |  | "))"; |
|  |  | } else { |
|  |  | expression = right + "(" + args.join(",") + ")"; |
|  |  | } |
| Expand All | | @@ -3464,6 +3442,7 @@ ASTCompiler.prototype = { |
|  |  | case AST.AssignmentExpression: |
|  |  | right = this.nextId(); |
|  |  | left = {}; |
|  |  | self.current().inAssignment = true; |
|  |  | this.recurse( |
|  |  | ast.left, |
|  |  | undefined, |
| Expand All | | @@ -3489,9 +3468,13 @@ ASTCompiler.prototype = { |
|  |  | recursionFn(intoId || expression); |
|  |  | } |
|  |  | ); |
|  |  | self.current().inAssignment = false; |
|  |  | self.recurse(ast.right, right); |
|  |  | self.current().inAssignment = true; |
|  |  | }, |
|  |  | 1 |
|  |  | ); |
|  |  | self.current().inAssignment = false; |
|  |  | break; |
|  |  | case AST.ArrayExpression: |
|  |  | args = []; |
| Expand Down  Expand Up | | @@ -3532,7 +3515,10 @@ ASTCompiler.prototype = { |
|  |  | } |
|  |  | right = self.nextId(); |
|  |  | self.recurse(property.value, right); |
|  |  | self.assign(self.member(intoId, left, property.computed), right); |
|  |  | self.assign( |
|  |  | self.unsafeMember(intoId, left, property.computed), |
|  |  | right |
|  |  | ); |
|  |  | }); |
|  |  | } else { |
|  |  | forEach(ast.properties, function (property) { |
| Expand Down  Expand Up | | @@ -3666,9 +3652,35 @@ ASTCompiler.prototype = { |
|  |  | return expr; |
|  |  | }, |
|  |  |  |
|  |  | computedMember: function (left, right) { |
|  |  | unsafeComputedMember: function (left, right) { |
|  |  | return left + "[" + right + "]"; |
|  |  | }, |
|  |  | unsafeNonComputedMember: function (left, right) { |
|  |  | return this.nonComputedMember(left, right); |
|  |  | }, |
|  |  |  |
|  |  | computedMember: function (left, right) { |
|  |  | if (this.state.computing === "assign") { |
|  |  | return this.unsafeComputedMember(left, right); |
|  |  | } |
|  |  | // return left + "[" + right + "]"; |
|  |  | return ( |
|  |  | "(" + |
|  |  | left + |
|  |  | ".hasOwnProperty(" + |
|  |  | right + |
|  |  | ") ? " + |
|  |  | left + |
|  |  | "[" + |
|  |  | right + |
|  |  | "] : null)" |
|  |  | ); |
|  |  | }, |
|  |  |  |
|  |  | unsafeMember: function (left, right, computed) { |
|  |  | if (computed) return this.unsafeComputedMember(left, right); |
|  |  | return this.unsafeNonComputedMember(left, right); |
|  |  | }, |
|  |  |  |
|  |  | member: function (left, right, computed) { |
|  |  | if (computed) return this.computedMember(left, right); |
| Expand Down  Expand Up | | @@ -3827,6 +3839,7 @@ ASTInterpreter.prototype = { |
|  |  | right = ast.property.name; |
|  |  | } |
|  |  | if (ast.computed) right = this.recurse(ast.property); |
|  |  |  |
|  |  | return ast.computed |
|  |  | ? this.computedMember(left, right, context, create) |
|  |  | : this.nonComputedMember(left, right, context, create); |
| Expand Down | |  |

31 changes: 28 additions & 3 deletions

31
[test/main.test.js](#diff-10211e7687c935409636be43040704b68ebaf019021ceefefad7562dab6f1f45 "test/main.test.js")

Show comments

[View file](/peerigon/angular-expressions/blob/07edb62902b1f6127b3dcc013da61c6316dd0bf1/test/main.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -152,6 +152,32 @@ describe("expressions", function () { |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | describe("Security", function () { |
|  |  | it("should not leak", function () { |
|  |  | evaluate = compile( |
|  |  | "''['c'+'onstructor']['c'+'onstructor']('return process;')()" |
|  |  | ); |
|  |  | const result = evaluate({}); |
|  |  | expect(result).to.equal(undefined); |
|  |  | }); |
|  |  |  |
|  |  | it("should not leak indirectly with string concatenation", function () { |
|  |  | evaluate = compile( |
|  |  | "a = null; a = ''['c'+'onstructor']['c'+'onstructor']; a = a('return process;'); a();" |
|  |  | ); |
|  |  | const result = evaluate({}); |
|  |  | expect(result).to.equal(undefined); |
|  |  | }); |
|  |  |  |
|  |  | it("should not leak indirectly with literal string", function () { |
|  |  | evaluate = compile( |
|  |  | "a = null; a = ''['constructor']['constructor']; a = a('return process;'); a();" |
|  |  | ); |
|  |  | const result = evaluate({}); |
|  |  | expect(result).to.equal(undefined); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | describe("when evaluating dot-notated assignments", function () { |
|  |  | it("should set the new value on scope", function () { |
|  |  | evaluate = compile("island.pirate.name = 'Störtebeker'"); |
| Expand Down  Expand Up | | @@ -468,7 +494,7 @@ describe("expressions", function () { |
|  |  |  |
|  |  | it("should not leak with computed prop", function () { |
|  |  | evaluate = compile("a['split']"); |
|  |  | expect(evaluate({ a: "" })).to.eql(undefined); |
|  |  | expect(evaluate({ a: "" })).to.eql(null); |
|  |  | }); |
|  |  |  |
|  |  | it("should allow to read string length", function () { |
| Expand All | | @@ -487,8 +513,7 @@ describe("expressions", function () { |
|  |  | // evaluate(scope); |
|  |  | // expect(scope.name.split).to.be.a("function"); |
|  |  | // }); |
|  |  | // |
|  |  | // |
|  |  |  |
|  |  | it("should work with \_\_proto\_\_", function () { |
|  |  | evaluate = compile("\_\_proto\_\_"); |
|  |  | expect(evaluate({})).to.eql(undefined); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `07edb62`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeerigon%2Fangular-expressions%2Fcommit%2F07edb62902b1f6127b3dcc013da61c6316dd0bf1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


