The provided content is a vulnerability report from Talos Intelligence, and it is related to CVE-2021-21822.

**Root cause of vulnerability:**
The vulnerability is a use-after-free in the JavaScript engine of Foxit Reader when handling "FileAttachment" annotations.

**Weaknesses/vulnerabilities present:**
- Use-after-free: The vulnerability occurs when a "FileAttachment" annotation object is freed prematurely and then accessed again later during the annotation creation process. This is triggered when the page is closed before the file selection dialog associated with the "FileAttachment" annotation is dismissed, leading to the destruction of the annotation's backing object and subsequent access to the freed memory.

**Impact of exploitation:**
- Arbitrary code execution: By carefully controlling the freed memory and its reuse, an attacker can hijack the control flow via vtable dereference and execute arbitrary code.

**Attack vectors:**
- Malicious PDF document: An attacker can embed malicious JavaScript in a PDF document that exploits the use-after-free vulnerability.
- Browser plugin extension: If the browser plugin extension is enabled, the attacker can trick the user into opening the malicious PDF through a browser.

**Required attacker capabilities/position:**
- The attacker needs to create a specially crafted PDF document that includes malicious JavaScript to trigger the vulnerability.
- The attacker needs to convince a user to open the malicious document, either directly or through a browser if the plugin is enabled.