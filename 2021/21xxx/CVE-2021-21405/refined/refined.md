Based on the provided information, here's an analysis of CVE-2021-21405:

**Root Cause:**

The vulnerability stems from the way BLS signatures are handled in the `lotus` implementation. The `blst` library's `VerifyCompressed` method accepts BLS signatures in two distinct formats: "serialized" and "compressed." Additionally, `lotus` block validation functions included the block signature (`BlockSig`) in the block header's CID calculation for uniqueness checks.

**Weaknesses/Vulnerabilities:**

1.  **Malleable Signatures:** The `blst` library allows signature verification using both serialized and compressed signature formats. This effectively means that for the same message and public key, two different valid signature byte arrays can be produced.
2.  **CID Calculation:** The `lotus` software used the block signature in its CID calculation. As a result, identical blocks with different signature representations (serialized or compressed) were treated as distinct blocks due to their differing CIDs.

**Impact of Exploitation:**

An attacker could exploit this "malleability" issue to:

*   **Punish miners for valid blocks:** Since two different CIDs could represent the same valid block, a malicious actor could potentially submit a valid block with one signature format, while other honest nodes would see the same block with the alternate signature representation and a different CID. This could lead to the miner being punished by the network as it appears like they are submitting a duplicate block.

**Attack Vectors:**

The attack vector involves manipulating the signature format (serialized or compressed) of valid blocks when they are submitted to the `lotus` network.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to create valid blocks (i.e., be a miner or have access to a miner's keys)
*   The attacker needs to understand how block CIDs are calculated
*   The attacker needs to be able to create both serialized and compressed signatures for the same block

**Additional Details:**

*   The provided proof-of-concept (PoC) code demonstrates that the `VerifyCompressed` function will accept both serialized and compressed signature formats as valid.
*   The fix involved switching from the go-based `blst` bindings to the `filecoin-ffi` bindings, ensuring that all signatures are compressed by size and during deserialization.
*   The vulnerability was found in multiple places in the `lotus` code: `chain/sync.go`, `/chain/vm/syscalls.go`, and `/chain/sub/incoming.go`.