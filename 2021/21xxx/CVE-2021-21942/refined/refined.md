The content is related to CVE-2021-21942.

- **Root cause of vulnerability**: A heap-based buffer overflow vulnerability exists in the TIFF YCbCr image parser functionality of Accusoft ImageGear 19.10 due to a missing size check when converting from YCbCr to RGB. Specifically, the size of the destination buffer is not checked against the amount of data being written based on the YCbCrSubsampleHoriz value, leading to an out-of-bounds write.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflow (CWE-122). The vulnerability occurs in the `TIFF_YCbCr_to_RGB` function during the conversion process, specifically at `[1]`, where RGB values are written into the destination buffer `dst_ptr`. The size of `dst_ptr` is determined by the image width, while the amount of data written is determined by the `YCbCrSubsampleHoriz` tag value.
- **Impact of exploitation**: An attacker can achieve remote code execution by providing a specially crafted TIFF file that triggers the heap-based buffer overflow. The overflow allows overwriting of heap metadata or other allocated buffers, potentially leading to arbitrary code execution.
- **Attack vectors**: The attack vector is a specially crafted TIFF file. An attacker needs to provide a malicious TIFF file to a vulnerable application that uses the Accusoft ImageGear library for image processing.
- **Required attacker capabilities/position**: The attacker needs the ability to provide a malicious TIFF file to a system using the vulnerable library. No special privileges or prior access is needed to trigger the vulnerability, meaning it is remotely exploitable. The attacker has to have a way to get the image processed by the library.