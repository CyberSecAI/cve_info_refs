Here's a breakdown of the vulnerability information related to CVE-2021-21850, extracted from the provided content:

**CVE-2021-21850 - “trun” decoder**

*   **Root Cause:** Integer overflow in the calculation of memory allocation size, leading to a heap-based buffer overflow.

*   **Weakness:** The `trun_box_read` function calculates the required buffer size by multiplying the number of samples by the size of the `GF_TrunEntry` structure, without proper bounds checking. This multiplication can overflow if the number of samples is large, leading to a smaller allocation than necessary.

*   **Impact:** A heap-based buffer overflow can occur during the population of the undersized array. This can lead to memory corruption and potentially arbitrary code execution under the context of the library.

*   **Attack Vector:** A specially crafted MPEG-4 file containing a "trun" atom with a large number of samples can trigger the vulnerability.

*   **Required Attacker Capabilities/Position:** An attacker needs to convince a user to open a malicious MPEG-4 file using an application that uses the vulnerable GPAC library. No special privileges are needed.

**Technical Details:**

1.  The `trun_box_read` function reads flags from the atom, then reads the number of samples as a 32-bit integer.
2.  The function checks if the size of the atom is at least as large as the number of samples multiplied by four, but this check is insufficient for a larger number of samples.
3.  The function allocates memory using `gf_malloc` based on the number of samples multiplied by the size of `GF_TrunEntry`. This multiplication can result in a 32-bit integer overflow causing an undersized allocation.
4.  The code then proceeds to read data into the undersized buffer, resulting in a heap overflow. The specific fields read depend on flags set in the atom, these are: duration, size, flags, and composition time stamp offset.

**Additional Notes:**

*   The report provides crash information using AddressSanitizer (ASan), highlighting the heap-buffer-overflow within `trun_box_read` function and the location of the allocation.
*   The report mentions the vulnerability was patched by the vendor on 2021-08-11.
*   The report indicates this issue along with others were addressed in Debian Security Advisory DSA-4966-1.

This content provides more technical detail compared to a typical CVE description, particularly in terms of code snippets, explanation of the vulnerable logic, and the crash information.