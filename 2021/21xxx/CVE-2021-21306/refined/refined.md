```
{
  "vulnerability": {
    "CVE": "CVE-2021-21306",
    "root_cause": "The vulnerability is due to a regular expression denial of service (ReDoS) vulnerability in the `marked` library when parsing emphasis and strong tags.",
    "weaknesses": [
      "ReDoS"
    ],
    "impact": "A Denial of Service (DoS) attack can occur when user-generated code is run through `marked`. This can result in excessive processing time, causing the server to become unresponsive.",
     "attack_vectors": [
      "The vulnerability can be triggered by providing a specific pattern of underscores in the markdown input. For example, long sequences of underscores can cause the regular expression engine to consume excessive resources when parsing the markdown."
     ],
    "required_capabilities": "The attacker needs to be able to provide the markdown input to be parsed by the `marked` library. This can happen if the application is parsing markdown provided by the user."
  },
  "affected_versions": "versions greater than 1.1.1 and less than 2.0.0",
    "patched_versions": "2.0.0",
  "references": [
    "https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS",
    "https://github.com/markedjs/marked/issues/1927",
    "https://github.com/markedjs/marked/pull/1864",
    "https://github.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd"
  ],
  "additional_notes": "The fix involves a rework of the emphasis/strong tokenizer, combining them into a single tokenizer to properly handle edge cases and prevent ReDoS attacks. The vulnerability was found to be present from version 1.2.0"
}
```