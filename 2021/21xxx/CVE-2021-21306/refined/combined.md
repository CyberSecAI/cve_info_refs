=== Content from togithub.com_2216657c_20250115_111838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fsecurity%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fsecurity%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=markedjs%2Fmarked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markedjs](/markedjs)
/
**[marked](/markedjs/marked)**
Public

* [Notifications](/login?return_to=%2Fmarkedjs%2Fmarked) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fmarkedjs%2Fmarked)
* [Star
   33.6k](/login?return_to=%2Fmarkedjs%2Fmarked)

* [Code](/markedjs/marked)
* [Issues
  15](/markedjs/marked/issues)
* [Pull requests
  1](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects
  1](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

Additional navigation options

* [Code](/markedjs/marked)
* [Issues](/markedjs/marked/issues)
* [Pull requests](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

# Underscore ReDoS

Moderate

[UziTech](/UziTech)
published
GHSA-4r62-v4vq-hr96
Feb 8, 2021

## Package

npm

marked
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

> 1.1.1 < 2.0.0

## Patched versions

2.0.0

## Description

### Impact

*What kind of vulnerability is it? Who is impacted?*

[Regular expression Denial of Service](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches

*Has the problem been patched? What versions should users upgrade to?*

patched in v2.0.0

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

None.

### References

*Are there any links users can visit to find out more?*

[#1927](https://github.com/markedjs/marked/issues/1927)

<https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [marked](https://github.com/markedjs/marked/issues)

### Severity

Moderate

### CVE ID

CVE-2021-21306

### Weaknesses

No CWEs

### Credits

* [![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=40&v=4)](/Xegyn)
  [Xegyn](/Xegyn)
  Analyst
* [![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)
  [calculuschild](/calculuschild)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_28ce14cd_20250114_180952.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fcommit%2F7293251c438e3ee968970f7609f1a27f9007bccd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fcommit%2F7293251c438e3ee968970f7609f1a27f9007bccd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=markedjs%2Fmarked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markedjs](/markedjs)
/
**[marked](/markedjs/marked)**
Public

* [Notifications](/login?return_to=%2Fmarkedjs%2Fmarked) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fmarkedjs%2Fmarked)
* [Star
   33.6k](/login?return_to=%2Fmarkedjs%2Fmarked)

* [Code](/markedjs/marked)
* [Issues
  16](/markedjs/marked/issues)
* [Pull requests
  1](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects
  1](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

Additional navigation options

* [Code](/markedjs/marked)
* [Issues](/markedjs/marked/issues)
* [Pull requests](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

## Commit

[Permalink](/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: Total rework of Emphasis/Strong ([#1864](https://github.com/markedjs/marked/pull/1864))

[Browse files](/markedjs/marked/tree/7293251c438e3ee968970f7609f1a27f9007bccd)
Browse the repository at this point in the history

```
BREAKING CHANGE: `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer
```

* Loading branch information

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

[calculuschild](/markedjs/marked/commits?author=calculuschild "View all commits by calculuschild")
authored
Feb 7, 2021

1 parent
[f848e77](/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0)

commit 7293251

 Show file tree

 Hide file tree

Showing
**14 changed files**
with
**280 additions**
and
**372 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + lib/marked.esm.js
    [marked.esm.js](#diff-5a616dc767d5c7fc4058d7c2f9b1e08e542ea90938a2e3794d95f030f261fcc7)
  + lib/marked.js
    [marked.js](#diff-a2a0bf2ee7f994acf0103efda8aa4766e389e4c783ac7e068fd1c4ffc481fdf9)
* marked.min.js
  [marked.min.js](#diff-27ec2cc1cc6f1a88579c149b6b7036f78bddea67b8e2401477bb8c6a388c746c)
* src

  + src/Lexer.js
    [Lexer.js](#diff-c83c98fa6c1c1f963e5d73263449891bca7c34bffdbde9d1f6193f040163f89d)
  + src/Tokenizer.js
    [Tokenizer.js](#diff-c6ae4e51c94d9a0253c6ca0afc670670f29049d741da446e6b19a22e4871821b)
  + src/rules.js
    [rules.js](#diff-1de7312ecbb8138fea99c0f206d07d4e534c7a513f615d3a54cc66bc9c702c67)
* test/specs

  + bug

    - test/specs/bug/adjacent\_lists.html
      [adjacent\_lists.html](#diff-bba8af4b434543ba1b2d36527bc732b4a93cdfe0debd6630048ab7ad51105a84)
    - test/specs/bug/adjacent\_lists.md
      [adjacent\_lists.md](#diff-c67da67e289e0692b4ed1b8b40d6654613ec4c0ef0ad937ab78ca64654c8c88f)
  + commonmark

    - test/specs/commonmark/commonmark.0.29.json
      [commonmark.0.29.json](#diff-c23b3c13c18c6bdde47a07e3d2e90c98d8c40957ee3480eb784ddad6af6e5049)
  + gfm

    - test/specs/gfm/commonmark.0.29.json
      [commonmark.0.29.json](#diff-70144d47328d8a973cee5b6d029a61cfd96ad7268cf0764455ad2025646fd23e)
  + new

    - test/specs/new/em\_list\_links.html
      [em\_list\_links.html](#diff-baba29d309fab4a468cdd347ba30caba9cabb414dbd7a28c64b36bfdbce54945)
  + original

    - test/specs/original/strong\_and\_em\_together.html
      [strong\_and\_em\_together.html](#diff-a5bba47b9114ea9b3b17043de0c6b51a0046a96edfe3241e7fb1758e38b31a7b)
    - test/specs/original/strong\_and\_em\_together.md
      [strong\_and\_em\_together.md](#diff-a3eb5172c078e56feaeb440c4609f3c166d43810fd06083e81d0f74a70b7c772)
  + redos

    - test/specs/redos/quadratic\_underscores.js
      [quadratic\_underscores.js](#diff-8a9731d7a6a3397064d8f7ac5ad42090076c5ae4c83400d12775429b816769e2)

## There are no files selected for viewing

164 changes: 73 additions & 91 deletions

164
[lib/marked.esm.js](#diff-5a616dc767d5c7fc4058d7c2f9b1e08e542ea90938a2e3794d95f030f261fcc7 "lib/marked.esm.js")

Show comments

[View file](/markedjs/marked/blob/7293251c438e3ee968970f7609f1a27f9007bccd/lib/marked.esm.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -839,46 +839,61 @@ var Tokenizer\_1 = class Tokenizer { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | strong(src, maskedSrc, prevChar = '') { |
|  |  | let match = this.rules.inline.strong.start.exec(src); |
|  |  | emStrong(src, maskedSrc, prevChar = '') { |
|  |  | let match = this.rules.inline.emStrong.lDelim.exec(src); |
|  |  | if (!match) return; |
|  |  |  |
|  |  | if (match && (!match[1] || (match[1] && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))))) { |
|  |  | maskedSrc = maskedSrc.slice(-1 \* src.length); |
|  |  | const endReg = match[0] === '\*\*' ? this.rules.inline.strong.endAst : this.rules.inline.strong.endUnd; |
|  |  | if (match[3] && prevChar.match(/[\p{L}\p{N}]/u)) return; // \_ can't be between two alphanumerics. \p{L}\p{N} includes non-english alphabet/numbers as well |
|  |  |  |
|  |  | const nextChar = match[1] || match[2] || ''; |
|  |  |  |
|  |  | if (!nextChar || (nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar)))) { |
|  |  | const lLength = match[0].length - 1; |
|  |  | let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0; |
|  |  |  |
|  |  | const endReg = match[0][0] === '\*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd; |
|  |  | endReg.lastIndex = 0; |
|  |  |  |
|  |  | let cap; |
|  |  | maskedSrc = maskedSrc.slice(-1 \* src.length + lLength); // Bump maskedSrc to same section of string as src (move to lexer?) |
|  |  |  |
|  |  | while ((match = endReg.exec(maskedSrc)) != null) { |
|  |  | cap = this.rules.inline.strong.middle.exec(maskedSrc.slice(0, match.index + 3)); |
|  |  | if (cap) { |
|  |  | return { |
|  |  | type: 'strong', |
|  |  | raw: src.slice(0, cap[0].length), |
|  |  | text: src.slice(2, cap[0].length - 2) |
|  |  | }; |
|  |  | rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6]; |
|  |  |  |
|  |  | if (!rDelim) continue; // matched the first alternative in rules.js (skip the \* in \_\_abc\*abc\_\_) |
|  |  |  |
|  |  | rLength = rDelim.length; |
|  |  |  |
|  |  | if (match[3] || match[4]) { // found another Left Delim |
|  |  | delimTotal += rLength; |
|  |  | continue; |
|  |  | } else if (match[5] || match[6]) { // either Left or Right Delim |
|  |  | if (lLength % 3 && !((lLength + rLength) % 3)) { |
|  |  | midDelimTotal += rLength; |
|  |  | continue; // CommonMark Emphasis Rules 9-10 |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | em(src, maskedSrc, prevChar = '') { |
|  |  | let match = this.rules.inline.em.start.exec(src); |
|  |  | delimTotal -= rLength; |
|  |  |  |
|  |  | if (match && (!match[1] || (match[1] && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))))) { |
|  |  | maskedSrc = maskedSrc.slice(-1 \* src.length); |
|  |  | const endReg = match[0] === '\*' ? this.rules.inline.em.endAst : this.rules.inline.em.endUnd; |
|  |  | if (delimTotal > 0) continue; // Haven't found enough closing delimiters |
|  |  |  |
|  |  | endReg.lastIndex = 0; |
|  |  | // If this is the last rDelimiter, remove extra characters. \*a\*\*\* -> \*a\* |
|  |  | if (delimTotal + midDelimTotal - rLength <= 0 && !maskedSrc.slice(endReg.lastIndex).match(endReg)) { |
|  |  | rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal); |
|  |  | } |
|  |  |  |
|  |  | let cap; |
|  |  | while ((match = endReg.exec(maskedSrc)) != null) { |
|  |  | cap = this.rules.inline.em.middle.exec(maskedSrc.slice(0, match.index + 2)); |
|  |  | if (cap) { |
|  |  | if (Math.min(lLength, rLength) % 2) { |
|  |  | return { |
|  |  | type: 'em', |
|  |  | raw: src.slice(0, cap[0].length), |
|  |  | text: src.slice(1, cap[0].length - 1) |
|  |  | raw: src.slice(0, lLength + match.index + rLength + 1), |
|  |  | text: src.slice(1, lLength + match.index + rLength) |
|  |  | }; |
|  |  | } |
|  |  | if (Math.min(lLength, rLength) % 2 === 0) { |
|  |  | return { |
|  |  | type: 'strong', |
|  |  | raw: src.slice(0, lLength + match.index + rLength + 1), |
|  |  | text: src.slice(2, lLength + match.index + rLength - 1) |
|  |  | }; |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -1182,74 +1197,41 @@ const inline = { |
|  |  | reflink: /^!?\[(label)\]\[(?!\s\*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/, |
|  |  | nolink: /^!?\[(?!\s\*\])((?:\[[^\[\]]\*\]|\\[\[\]]|[^\[\]])\*)\](?:\[\])?/, |
|  |  | reflinkSearch: 'reflink|nolink(?!\\()', |
|  |  | strong: { |
|  |  | start: /^(?:(\\*\\*(?=[\*punctuation]))|\\*\\*)(?![\s])|\_\_/, // (1) returns if starts w/ punctuation |
|  |  | middle: /^\\*\\*(?:(?:(?!overlapSkip)(?:[^\*]|\\\\*)|overlapSkip)|\\*(?:(?!overlapSkip)(?:[^\*]|\\\\*)|overlapSkip)\*?\\*)+?\\*\\*$|^\_\_(?![\s])((?:(?:(?!overlapSkip)(?:[^\_]|\\\_)|overlapSkip)|\_(?:(?!overlapSkip)(?:[^\_]|\\\_)|overlapSkip)\*?\_)+?)\_\_$/, |
|  |  | endAst: /[^punctuation\s]\\*\\*(?!\\*)|[punctuation]\\*\\*(?!\\*)(?:(?=[punctuation\_\s]|$))/, // last char can't be punct, or final \* must also be followed by punct (or endline) |
|  |  | endUnd: /[^\s]\_\_(?!\_)(?:(?=[punctuation\*\s])|$)/ // last char can't be a space, and final \_ must preceed punct or \s (or endline) |
|  |  | }, |
|  |  | em: { |
|  |  | start: /^(?:(\\*(?=[punctuation]))|\\*)(?![\*\s])|\_/, // (1) returns if starts w/ punctuation |
|  |  | middle: /^\\*(?:(?:(?!overlapSkip)(?:[^\*]|\\\\*)|overlapSkip)|\\*(?:(?!overlapSkip)(?:[^\*]|\\\\*)|overlapSkip)\*?\\*)+?\\*$|^\_(?![\_\s])(?:(?:(?!overlapSkip)(?:[^\_]|\\\_)|overlapSkip)|\_(?:(?!overlapSkip)(?:[^\_]|\\\_)|overlapSkip)\*?\_)+?\_$/, |
|  |  | endAst: /[^punctuation\s]\\*(?!\\*)|[punctuation]\\*(?!\\*)(?:(?=[punctuation\_\s]|$))/, // last char can't be punct, or final \* must also be followed by punct (or endline) |
|  |  | endUnd: /[^\s]\_(?!\_)(?:(?=[punctuation\*\s])|$)/ // last char can't be a space, and final \_ must preceed punct or \s (or endline) |
|  |  | emStrong: { |
|  |  | lDelim: /^(?:\\*+(?:([punct\_])|[^\s\*]))|^\_+(?:([punct\*])|([^\s\_]))/, |
|  |  | // (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left. (5) and (6) can be either Left or Right. |
|  |  | // () Skip other delimiter (1) #\*\*\* (2) a\*\*\*#, a\*\*\* (3) #\*\*\*a, \*\*\*a (4) \*\*\*# (5) #\*\*\*# (6) a\*\*\*a |
|  |  | rDelimAst: /\\_\\_[^\_]\*?\\*[^\_]\*?\\_\\_|[punct\_](\\*+)(?=[\s]|$)|[^punct\*\_\s](\\*+)(?=[punct\_\s]|$)|[punct\_\s](\\*+)(?=[^punct\*\_\s])|[\s](\\*+)(?=[punct\_])|[punct\_](\\*+)(?=[punct\_])|[^punct\*\_\s](\\*+)(?=[^punct\*\_\s])/, |
|  |  | rDelimUnd: /\\*\\*[^\*]\*?\\_[^\*]\*?\\*\\*|[punct\*](\\_+)(?=[\s]|$)|[^punct\*\_\s](\\_+)(?=[punct\*\s]|$)|[punct\*\s](\\_+)(?=[^punct\*\_\s])|[\s](\\_+)(?=[punct\*])|[punct\*](\\_+)(?=[punct\*])/ // ^- Not allowed for \_ |
|  |  | }, |
|  |  | code: /^(`+)([^`]|[^`][\s\S]\*?[^`])\1(?!`)/, |
|  |  | br: /^( {2,}|\\)\n(?!\s\*$)/, |
|  |  | del: noopTest$1, |
|  |  | text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]\*?(?:(?=[\\<!\[`\*]|\b\_|$)|[^ ](?= {2,}\n)))/, |
|  |  | punctuation: /^([\s\*punctuation])/ |
|  |  | text: /^(`+|[^`])(?:(?= {2,}\n)|[\s\S]\*?(?:(?=[\\<!\[`\*\_]|\b\_|$)|[^ ](?= {2,}\n)))/, |
|  |  | punctuation: /^([\spunctuation])/ |
|  |  | }; |
|  |  |  |
|  |  | // list of punctuation marks from common mark spec |
|  |  | // without \* and \_ to workaround cases with double emphasis |
|  |  | // list of punctuation marks from CommonMark spec |
|  |  | // without \* and \_ to handle the different emphasis markers \* and \_ |
|  |  | inline.\_punctuation = '!"#$%&\'()+\\-.,/:;<=>?@\\[\\]`^{|}~'; |
|  |  | inline.punctuation = edit$1(inline.punctuation).replace(/punctuation/g, inline.\_punctuation).getRegex(); |
|  |  |  |
|  |  | // sequences em should skip over [title](link), `code`, <html> |
|  |  | inline.\_blockSkip = '\\[[^\\]]\*?\\]\\([^\\)]\*?\\)|`[^`]\*?`|<[^>]\*?>'; |
|  |  | inline.\_overlapSkip = '\_\_[^\_]\*?\_\_|\\\*\\\*\\[^\\\*\\]\*?\\\*\\\*'; |
|  |  | inline.blockSkip = /\[[^\]]\*?\]\([^\)]\*?\)|`[^`]\*?`|<[^>]\*?>/g; |
|  |  | inline.escapedEmSt = /\\\\*|\\\_/g; |
|  |  |  |
|  |  | inline.\_comment = edit$1(block.\_comment).replace('(?:-->|$)', '-->').getRegex(); |
|  |  |  |
|  |  | inline.em.start = edit$1(inline.em.start) |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | inline.emStrong.lDelim = edit$1(inline.emStrong.lDelim) |
|  |  | .replace(/punct/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.em.middle = edit$1(inline.em.middle) |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .replace(/overlapSkip/g, inline.\_overlapSkip) |
|  |  | inline.emStrong.rDelimAst = edit$1(inline.emStrong.rDelimAst, 'g') |
|  |  | .replace(/punct/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.em.endAst = edit$1(inline.em.endAst, 'g') |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.em.endUnd = edit$1(inline.em.endUnd, 'g') |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.strong.start = edit$1(inline.strong.start) |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.strong.middle = edit$1(inline.strong.middle) |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .replace(/overlapSkip/g, inline.\_overlapSkip) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.strong.endAst = edit$1(inline.strong.endAst, 'g') |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.strong.endUnd = edit$1(inline.strong.endUnd, 'g') |
|  |  | .replace(/punctuation/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.blockSkip = edit$1(inline.\_blockSkip, 'g') |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.overlapSkip = edit$1(inline.\_overlapSkip, 'g') |
|  |  | inline.emStrong.rDelimUnd = edit$1(inline.emStrong.rDelimUnd, 'g') |
|  |  | .replace(/punct/g, inline.\_punctuation) |
|  |  | .getRegex(); |
|  |  |  |
|  |  | inline.\_escapes = /\\([!"#$%&'()\*+,\-./:;<=>?@\[\]\\^\_`{|}~])/g; |
| Expand Down  Expand Up | | @@ -1328,7 +1310,7 @@ inline.gfm = merge$1({}, inline.normal, { |
|  |  | url: /^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]\*|^email/, |
|  |  | \_backpedal: /(?:[^?!.,:;\*\_~()&]+|\([^)]\*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;\*\_~)]+(?!$))+/, |
|  |  | del: /^(~~?)(?=[^\s~])([\s\S]\*?[^\s~])\1(?=[^~]|$)/, |
|  |  | text: /^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]\*?(?:(?=[\\<!\[`\*~]|\b\_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-](?=[a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-]+@))/ |
|  |  | text: /^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]\*?(?:(?=[\\<!\[`\*~\_]|\b\_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-](?=[a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'\*+\/=?\_`{\|}~-]+@))/ |
|  |  | }); |
|  |  |  |
|  |  | inline.gfm.url = edit$1(inline.gfm.url, 'i') |
| Expand Down  Expand Up | | @@ -1704,11 +1686,17 @@ var Lexer\_1 = class Lexer { |
|  |  | maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString$1('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex); |
|  |  | } |
|  |  |  |
|  |  | // Mask out escaped em & strong delimiters |
|  |  | while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) { |
|  |  | maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex); |
|  |  | } |
|  |  |  |
|  |  | while (src) { |
|  |  | if (!keepPrevChar) { |
|  |  | prevChar = ''; |
|  |  | } |
|  |  | keepPrevChar = false; |
|  |  |  |
|  |  | // escape |
|  |  | if (token = this.tokenizer.escape(src)) { |
|  |  | src = src.substring(token.raw.length); |
| Expand Down  Expand Up | | @@ -1757,16 +1745,8 @@ var Lexer\_1 = class Lexer { |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | // strong |
|  |  | if (token = this.tokenizer.strong(src, maskedSrc, prevChar)) { |
|  |  | src = src.substring(token.raw.length); |
|  |  | token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock); |
|  |  | tokens.push(token); |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | // em |
|  |  | if (token = this.tokenizer.em(src, maskedSrc, prevChar)) { |
|  |  | // em & strong |
|  |  | if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) { |
|  |  | src = src.substring(token.raw.length); |
|  |  | token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock); |
|  |  | tokens.push(token); |
| Expand Down  Expand Up | | @@ -1812,7 +1792,9 @@ var Lexer\_1 = class Lexer { |
|  |  | // text |
|  |  | if (token = this.tokenizer.inlineText(src, inRawBlock, smartypants)) { |
|  |  | src = src.substring(token.raw.length); |
|  |  | prevChar = token.raw.slice(-1); |
|  |  | if (token.raw.slice(-1) !== '\_') { // Track prevChar before string of \_\_\_\_ started |
|  |  | prevChar = token.raw.slice(-1); |
|  |  | } |
|  |  | keepPrevChar = true; |
|  |  | lastToken = tokens[tokens.length - 1]; |
|  |  | if (lastToken && lastToken.type === 'text') { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `7293251`

[![@vercel](https://avatars.githubusercontent.com/in/8329?s=80&v=4)](/apps/vercel)

Copy link

### @vercel **[vercel](/apps/vercel) bot** commented on `[7293251](/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)` [Feb 7, 2021](#commitcomment-46859176)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Successfully deployed to the following URLs:

* [markedjs.markedjs.vercel.app](https://markedjs.markedjs.vercel.app)
* [markedjs.now.sh](https://markedjs.now.sh)
* [markedjs.vercel.app](https://markedjs.vercel.app)
* [markedjs-git-master.markedjs.now.sh](https://markedjs-git-master.markedjs.now.sh)
* [marked.js.org](https://marked.js.org)
* [markedjs-git-master.markedjs.vercel.app](https://markedjs-git-master.markedjs.vercel.app)
* [markedjs.markedjs.now.sh](https://markedjs.markedjs.now.sh)

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fcommit%2F7293251c438e3ee968970f7609f1a27f9007bccd) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4e06ba31_20250115_111837.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

**CVE-2021-21306**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2021-21306](/advisories/GHSA-4r62-v4vq-hr96)

## Regular Expression Denial of Service (REDoS) in Marked

Moderate severity

GitHub Reviewed

Published
Feb 8, 2021
in
[markedjs/marked](/markedjs/marked)
•
Updated Feb 1, 2023

[Vulnerability details](/advisories/GHSA-4r62-v4vq-hr96)
[Dependabot alerts
0](/advisories/GHSA-4r62-v4vq-hr96/dependabot)

## Package

npm

marked
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>= 1.1.1, < 2.0.0

## Patched versions

2.0.0

## Description

### Impact

*What kind of vulnerability is it? Who is impacted?*

[Regular expression Denial of Service](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches

*Has the problem been patched? What versions should users upgrade to?*

patched in v2.0.0

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

None.

### References

*Are there any links users can visit to find out more?*

[markedjs/marked#1927](https://github.com/markedjs/marked/issues/1927)

<https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [marked](https://github.com/markedjs/marked/issues)

### References

* [GHSA-4r62-v4vq-hr96](https://github.com/markedjs/marked/security/advisories/GHSA-4r62-v4vq-hr96 "GHSA-4r62-v4vq-hr96")
* [markedjs/marked#1927](https://github.com/markedjs/marked/issues/1927)
* [markedjs/marked#1864](https://github.com/markedjs/marked/pull/1864)
* [markedjs/marked@7293251](https://github.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)
* <https://www.npmjs.com/package/marked>
* <https://nvd.nist.gov/vuln/detail/CVE-2021-21306>

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&v=4)](/UziTech)
[UziTech](/UziTech)
published to
[markedjs/marked](/markedjs/marked/security/advisories/GHSA-4r62-v4vq-hr96)
Feb 8, 2021

Reviewed
Feb 8, 2021

Published to the GitHub Advisory Database
Feb 8, 2021

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2021-21306)
Feb 8, 2021

Last updated
Feb 1, 2023

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

### [EPSS score](https://www.first.org/epss/user-guide)

0.248%
 (64th percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

### CVE ID

CVE-2021-21306

### GHSA ID

GHSA-4r62-v4vq-hr96

### Source code

No known source code

### Credits

* [![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=40&v=4)](/Xegyn)
  [Xegyn](/Xegyn)
  Analyst
* [![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)
  [calculuschild](/calculuschild)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-4r62-v4vq-hr96/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cee5b1d7_20250114_180956.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fpull%2F1864)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fpull%2F1864)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=markedjs%2Fmarked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markedjs](/markedjs)
/
**[marked](/markedjs/marked)**
Public

* [Notifications](/login?return_to=%2Fmarkedjs%2Fmarked) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fmarkedjs%2Fmarked)
* [Star
   33.6k](/login?return_to=%2Fmarkedjs%2Fmarked)

* [Code](/markedjs/marked)
* [Issues
  16](/markedjs/marked/issues)
* [Pull requests
  1](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects
  1](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

Additional navigation options

* [Code](/markedjs/marked)
* [Issues](/markedjs/marked/issues)
* [Pull requests](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmarkedjs%2Fmarked%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmarkedjs%2Fmarked%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: Total rework of Emphasis/Strong #1864

 Merged

[UziTech](/UziTech)
merged 15 commits into
[markedjs:master](/markedjs/marked/tree/master "markedjs/marked:master")
from
[calculuschild:EmStrongRework](/calculuschild/marked/tree/EmStrongRework "calculuschild/marked:EmStrongRework")

Feb 7, 2021

 Merged

# [fix: Total rework of Emphasis/Strong](#top) #1864

[UziTech](/UziTech)
merged 15 commits into
[markedjs:master](/markedjs/marked/tree/master "markedjs/marked:master")
from
[calculuschild:EmStrongRework](/calculuschild/marked/tree/EmStrongRework "calculuschild/marked:EmStrongRework")

Feb 7, 2021

[Conversation
16](/markedjs/marked/pull/1864)
[Commits
15](/markedjs/marked/pull/1864/commits)
[Checks
0](/markedjs/marked/pull/1864/checks)
[Files changed](/markedjs/marked/pull/1864/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![calculuschild](https://avatars.githubusercontent.com/u/5878534?s=60&v=4)](/calculuschild)

Copy link

Contributor

### @calculuschild **[calculuschild](/calculuschild)** commented [Dec 7, 2020](#issue-758140438) • edited Loading

## Description

* Fixes [em and strong (\*\*\*〜\*\*\*) #1860](https://github.com/markedjs/marked/issues/1860), Fixes [Asterisks are not properly escaped #1811](https://github.com/markedjs/marked/issues/1811)
* Also fixes Commonmark/GFM examples:

  + (em & strong) 361, 387, 388, 407, 412, 415, 416, 424, 425, 442, 445, 446, 453, 455, 456, 457, 465, 466, 467, 470
  + This puts us up to 100% compatibility with commonmark specs!
* Noticeable speedup, especially on the GFM benchmark (~8.7 sec -> ~8.1 sec, pretty consistent over 5 runs on my laptop)

## What was attempted

1. Simplify regex for em & strong, combined now into a single tokenizer
2. When masking the `src` string in Lexer, also mask out escaped `\*` and `\_` which further simplifies a lot of regex
3. Track total opening delimiter characters vs closing characters, and ensure they match
4. More closely follow CommonMark spec:
   * Favor `<em><strong>text</strong></em>` over `<strong><em>text</em></strong>`
   * Correct some of the "New" spec tests that had this ^ swapped incorrectly (and delete one that is redundant now)
   * Handle em/strong CommonMark [rules 9-10](https://spec.commonmark.org/0.29/#can-open-emphasis), that left and right delimiters cannot sum to a multiple of 3, unless each is a multiple of 3
   * Handle cases with lots of extra unmatched delimiters, e.g. `*text*********`

Note this involves significant changes in the Lexer and Tokenizer APIs, which should be noted in the update.

The new Regex should be pretty benign compared to the earlier stuff. It literally checks for sequences of the pattern `a***b`, that is, runs of `*` or `_` between a single character on each side.

## Contributor

* Test(s) exist to ensure functionality and minimize regression (if no tests added, list tests covering this PR); or,
* no tests required for this PR.
* If submitting new feature, it has been documented in the appropriate places.

## Committer

In most cases, this should be a different person than the contributor.

* CI is green (no forced merge required).
* Squash and Merge PR following [conventional commit guidelines](https://www.conventionalcommits.org/).

Sorry, something went wrong.

All reactions

 [calculuschild](/calculuschild)
added 3 commits
[December 6, 2020 22:06](#commits-pushed-0293db5)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Passing all tests](/markedjs/marked/pull/1864/commits/0293db51df4b6cb0ae6434846fea2168f8ff4472 "Passing all tests")`

`[0293db5](/markedjs/marked/pull/1864/commits/0293db51df4b6cb0ae6434846fea2168f8ff4472)`

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[console.log's removed & shouldfail: fixed on passing tests](/markedjs/marked/pull/1864/commits/eca1f23659274da1191ea9d3406df098f893224f "console.log's removed & shouldfail: fixed on passing tests")`

`[eca1f23](/markedjs/marked/pull/1864/commits/eca1f23659274da1191ea9d3406df098f893224f)`

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Delete unused rules](/markedjs/marked/pull/1864/commits/d5471d2f80c50d4185423bf8fe8a1996dd22ec27 "Delete unused rules")`

`[d5471d2](/markedjs/marked/pull/1864/commits/d5471d2f80c50d4185423bf8fe8a1996dd22ec27)`

[![@vercel](https://avatars.githubusercontent.com/in/8329?s=80&v=4)](/apps/vercel)

Copy link

### **[vercel](/apps/vercel) bot** commented [Dec 7, 2020](#issuecomment-739652973) • edited Loading

| This pull request is being automatically deployed with Vercel ([learn more](https://vercel.link/github-learn-more)). To see the status of your deployment, click below or on the icon next to each commit.  🔍 Inspect: <https://vercel.com/markedjs/markedjs/7lc52k1xy> ✅ Preview: <https://markedjs-git-fork-calculuschild-emstrongrework.markedjs.vercel.app> |
| --- |

All reactions

Sorry, something went wrong.

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-3taqe1jnl.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-3taqe1jnl.vercel.app)
[December 7, 2020 04:19](#event-4077608931)
[View deployment](https://markedjs-3taqe1jnl.vercel.app)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Tidying up](/markedjs/marked/pull/1864/commits/3f0fbb918b79d9f4e365960006624fcb7d8fc995 "Tidying up")`

`[3f0fbb9](/markedjs/marked/pull/1864/commits/3f0fbb918b79d9f4e365960006624fcb7d8fc995)`

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-p5n6660zb.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-p5n6660zb.vercel.app)
[December 7, 2020 04:59](#event-4077687586)
[View deployment](https://markedjs-p5n6660zb.vercel.app)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Delete test already covered by CommonMark?](/markedjs/marked/pull/1864/commits/e9609ac382535a15a6c44c57182b15075af9ad2c "Delete test already covered by CommonMark?

These tests look like they existed solely to cover the CommonMark examples with Strong and Em together that Marked wasn't passing because it output them backwards:  `<strong><em>` instead of `<em><strong>`.  This is no longer necessary.")`
 …

`[e9609ac](/markedjs/marked/pull/1864/commits/e9609ac382535a15a6c44c57182b15075af9ad2c)`

```
These tests look like they existed solely to cover the CommonMark examples with Strong and Em together that Marked wasn't passing because it output them backwards:  `<strong><em>` instead of `<em><strong>`.  This is no longer necessary.
```

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-genljoxrh.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-genljoxrh.vercel.app)
[December 7, 2020 05:03](#event-4077696343)
[View deployment](https://markedjs-genljoxrh.vercel.app)

 [![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)
[calculuschild](/calculuschild)
requested review from
[UziTech](/UziTech),
[joshbruce](/joshbruce),
[davisjam](/davisjam) and
[styfle](/styfle)
[December 7, 2020 05:06](#event-4077701990)

[![UziTech](https://avatars.githubusercontent.com/u/97994?s=60&v=4)](/UziTech)

**[UziTech](/UziTech)**
reviewed
[Dec 7, 2020](#pullrequestreview-545837663)

 [View reviewed changes](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c)

[src/Lexer.js](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c#diff-c83c98fa6c1c1f963e5d73263449891bca7c34bffdbde9d1f6193f040163f89d)

|  |  | // em |
| --- | --- | --- |
|  |  | if (token = this.tokenizer.em(src, maskedSrc, prevChar)) { |
|  |  | // em & strong |
|  |  | if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) { |

Copy link

Member

### @UziTech **[UziTech](/UziTech)** [Dec 7, 2020](#discussion_r537238433)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This would definitely be a breaking change since the tokenizers are part of the public API. Can we do this without combining them? Can we just switch the order of em and strong to get `<strong><em>a</em></strong>` to switch to `<em><strong>a</strong></em>`?

Sorry, something went wrong.

 👍
1
 styfle reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Contributor

Author

### @calculuschild **[calculuschild](/calculuschild)** [Dec 7, 2020](#discussion_r537243711) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Unfortunately, they kind of need to be tackled together to get the right sequence of `<em><strong>` to work, which isn't just a stylistic thing. Even though it renders the same as `<strong><em>`, the processing to get to that point also clears up several other bugs, especially regarding uneven `**text*****` delimiters on both sides.

**Edit for clarification:** processing em/strong in this way allows following more of the CommonMark specs in a "natural" way that I think will be much easier to maintain (instead of a monstrous, fiddly regex). However, this also means you don't really know if the output is going to be an `em` or a `strong` until the very end of the process (see the very end of the Tokenizer).

This might be worth putting into a v2.

Sorry, something went wrong.

All reactions

Copy link

Member

### @UziTech **[UziTech](/UziTech)** [Dec 7, 2020](#discussion_r537254791)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

After researching quite a few dependants I think it should be fine to combine them since most dependants will change the renderer instead of the tokenizer. This will have to be a major bump to v2 though. I do want to get a few other breaking changes together before releasing v2 so it might be a while before I get to fully reviewing this PR.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @calculuschild **[calculuschild](/calculuschild)** [Dec 7, 2020](#discussion_r537258246)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

That sounds appropriate. I need to review the other PRs you have waiting as well that should go out before this anyway...

There are some other changes I've seen in the issues list that I'd like to lump into a v2 bump as well.

Sorry, something went wrong.

All reactions

[![styfle](https://avatars.githubusercontent.com/u/229881?s=60&v=4)](/styfle)

**[styfle](/styfle)**
reviewed
[Dec 7, 2020](#pullrequestreview-546245022)

 [View reviewed changes](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c)

[lib/marked.js](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c#diff-a2a0bf2ee7f994acf0103efda8aa4766e389e4c783ac7e068fd1c4ffc481fdf9)
Outdated

Show resolved

Hide resolved

[![styfle](https://avatars.githubusercontent.com/u/229881?s=60&v=4)](/styfle)

**[styfle](/styfle)**
reviewed
[Dec 7, 2020](#pullrequestreview-546245092)

 [View reviewed changes](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c)

[lib/marked.esm.js](/markedjs/marked/pull/1864/files/e9609ac382535a15a6c44c57182b15075af9ad2c#diff-5a616dc767d5c7fc4058d7c2f9b1e08e542ea90938a2e3794d95f030f261fcc7)
Outdated

Show resolved

Hide resolved

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Remove Libs and min.js](/markedjs/marked/pull/1864/commits/75c641be4fc63ea50ef9cf7b59642a9be298b285 "Remove Libs and min.js")`

`[75c641b](/markedjs/marked/pull/1864/commits/75c641be4fc63ea50ef9cf7b59642a9be298b285)`

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-qrrznx07t.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-qrrznx07t.vercel.app)
[December 8, 2020 01:06](#event-4082373794)
[View deployment](https://markedjs-qrrznx07t.vercel.app)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Handle non-english chars](/markedjs/marked/pull/1864/commits/5897ade3b534a6210d85696cc025d3d37f8dce04 "Handle non-english chars")`

`[5897ade](/markedjs/marked/pull/1864/commits/5897ade3b534a6210d85696cc025d3d37f8dce04)`

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-c6ruiufsu.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-c6ruiufsu.vercel.app)
[December 9, 2020 18:55](#event-4091485211)
[View deployment](https://markedjs-c6ruiufsu.vercel.app)

[![styfle](https://avatars.githubusercontent.com/u/229881?s=60&v=4)](/styfle)

**[styfle](/styfle)**
reviewed
[Dec 9, 2020](#pullrequestreview-548550748)

 [View reviewed changes](/markedjs/marked/pull/1864/files/5897ade3b534a6210d85696cc025d3d37f8dce04)

[src/Tokenizer.js](/markedjs/marked/pull/1864/files/5897ade3b534a6210d85696cc025d3d37f8dce04#diff-c6ae4e51c94d9a0253c6ca0afc670670f29049d741da446e6b19a22e4871821b)
Outdated

Show resolved

Hide resolved

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Pass more tests involving unbalanced extra asterisks at the end.](/markedjs/marked/pull/1864/commits/c76d17936442f4a6d7b7c12e8f6792e123e0b87c "Pass more tests involving unbalanced extra asterisks at the end.")`

`[c76d179](/markedjs/marked/pull/1864/commits/c76d17936442f4a6d7b7c12e8f6792e123e0b87c)`

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-885zd21ju.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-885zd21ju.vercel.app)
[December 9, 2020 20:57](#event-4091951121)
[View deployment](https://markedjs-885zd21ju.vercel.app)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Lint](/markedjs/marked/pull/1864/commits/6cac4e449c2348eea793b924a7aeae7b846c4301 "Lint")`

`[6cac4e4](/markedjs/marked/pull/1864/commits/6cac4e449c2348eea793b924a7aeae7b846c4301)`

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-j1i0enrpy.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-j1i0enrpy.vercel.app)
[December 9, 2020 20:59](#event-4091959899)
[View deployment](https://markedjs-j1i0enrpy.vercel.app)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild) [![@styfle](https://avatars.githubusercontent.com/u/229881?s=40&v=4)](/styfle)

`[Typo](/markedjs/marked/pull/1864/commits/710205a52707b7c0464d04adf5c2222186867bc7 "Typo

Co-authored-by: Steven <steven@ceriously.com>")`
 …

`[710205a](/markedjs/marked/pull/1864/commits/710205a52707b7c0464d04adf5c2222186867bc7)`

```
Co-authored-by: Steven <steven@ceriously.com>
```

 [![@vercel](https://avatars.githubusercontent.com/in/8329?s=40&v=4)](/apps/vercel)
[vercel](/apps/vercel)
bot
[deployed](https://markedjs-gbf8dmrax.vercel.app "Deployment has completed")
to
[Preview](https://markedjs-gbf8dmrax.vercel.app)
[December 9, 2020 21:00](#event-4091963138)
[View deployment](https://markedjs-gbf8dmrax.vercel.app)

 [calculuschild](/calculuschild)
added 2 commits
[December 9, 2020 16:07](#commits-pushed-0a62ab8)

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Small Rules regex cleanup](/markedjs/marked/pull/1864/commits/0a62ab854cb16b24fac091188ee371034eb69c94 "Small Rules regex cleanup")`

`[0a62ab8](/markedjs/marked/pull/1864/commits/0a62ab854cb16b24fac091188ee371034eb69c94)`

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)

`[Merge branch 'EmStrongRework' of](/markedjs/marked/pull/1864/commits/b5accad1eb3c588ad3ce686784e5cb350ffd7a0e "Merge branch 'EmStrongRework' of https://github.com/calculuschild/marked into EmStrongRework") <https://github.com/calculuschild/marked>`
 …

`[b5accad](/markedjs/marked/pull/1864/commits/b5accad1eb3c588ad3ce686784e5cb350ffd7a0e)`

```
 into EmStrongRework
```

13 hidden items

Load more…

[![UziTech](https://avatars.githubusercontent.com/u/97994?s=60&v=4)](/UziTech)

**[UziTech](/UziTech)**
approved these changes
[Feb 5, 2021](#pullrequestreview-584011464)

 [View reviewed changes](/markedjs/marked/pull/1864/files/b869ed704dddb2782a0b5f472be9364290166adb)

 [![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
requested a review
from [styfle](/styfle)
[February 5, 2021 04:20](#event-4294204330)

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=80&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)

Copy link

Member

### **[UziTech](/UziTech)** commented [Feb 5, 2021](#issuecomment-773777431)

| [@styfle](https://github.com/styfle) We should get this and [#1926](https://github.com/markedjs/marked/pull/1926) released as v2 soon. This PR fixes the security issue in [#1927](https://github.com/markedjs/marked/issues/1927) |
| --- |

 👀
1
 styfle reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![styfle](https://avatars.githubusercontent.com/u/229881?s=60&v=4)](/styfle)

**[styfle](/styfle)**
approved these changes
[Feb 7, 2021](#pullrequestreview-585087280)

 [View reviewed changes](/markedjs/marked/pull/1864/files/b869ed704dddb2782a0b5f472be9364290166adb)

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
changed the title
~~Total rework of Emphasis/Strong~~
fix: Total rework of Emphasis/Strong
[Feb 7, 2021](#event-4300753799)

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
merged commit [`7293251`](/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)
into
markedjs:master

[Feb 7, 2021](https://github.com/markedjs/marked/pull/1864#event-4300753812)

[github-actions](/apps/github-actions) bot
pushed a commit
that referenced
this pull request
[Feb 7, 2021](#ref-commit-8a7502f)
[![@semantic-release-bot](https://avatars.githubusercontent.com/u/32174276?s=40&u=8f06e06a49d30dc120cfc2aa06e01172847e36f1&v=4)](/semantic-release-bot)

`[chore(release): 2.0.0 [skip ci]](/markedjs/marked/commit/8a7502f54fcc236027ae38e5432c4caf30accf23 "chore(release): 2.0.0 [skip ci]

# [2.0.0](https://github.com/markedjs/marked/compare/v1.2.9...v2.0.0) (2021-02-07)

### Bug Fixes

* Join adjacent inlineText tokens ([#1926](https://github.com/markedjs/marked/issues/1926)) ([f848e77](https://github.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0))
* Total rework of Emphasis/Strong ([#1864](https://github.com/markedjs/marked/issues/1864)) ([7293251](https://github.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd))

### BREAKING CHANGES

* `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer")`
…

`[8a7502f](/markedjs/marked/commit/8a7502f54fcc236027ae38e5432c4caf30accf23)`

```
# [2.0.0]([v1.2.9...v2.0.0](https://github.com/markedjs/marked/compare/v1.2.9...v2.0.0)) (2021-02-07)

### Bug Fixes

* Join adjacent inlineText tokens ([[#1926](https://github.com/markedjs/marked/pull/1926)]([#1926](https://github.com/markedjs/marked/pull/1926))) ([[f848e77](https://github.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0)]([f848e77](https://github.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0)))
* Total rework of Emphasis/Strong ([[#1864](https://github.com/markedjs/marked/pull/1864)]([#1864](https://github.com/markedjs/marked/pull/1864))) ([[7293251](https://github.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)]([7293251](https://github.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd)))

### BREAKING CHANGES

* `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Feb 7, 2021](#issuecomment-774779338)

| 🎉 This PR is included in version 2.0.0 🎉  The release is available on:   * [npm package (@latest dist-tag)](https://www.npmjs.com/package/marked/v/2.0.0) * [GitHub release](https://github.com/markedjs/marked/releases/tag/v2.0.0)   Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot 📦🚀 |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[released](/markedjs/marked/labels/released)
label
[Feb 7, 2021](#event-4300755527)

[![@alasdairhurst](https://avatars.githubusercontent.com/u/8441810?s=40&v=4)](/alasdairhurst)
[alasdairhurst](/alasdairhurst)
mentioned this pull request
[Feb 10, 2021](#ref-issue-805495770)

[marked@2.0.0 throws SyntaxError: Invalid regular expression
#1937](/markedjs/marked/issues/1937)

Closed

This was referenced Mar 11, 2021

[build(deps): bump marked from 1.2.9 to 2.0.0
FlorianWoelki/florianwoelki.com#7](/FlorianWoelki/florianwoelki.com/pull/7)
 Merged

[Bump marked from 1.1.1 to 2.0.0 in /client
TheRealSyler/zephyr#12](/TheRealSyler/zephyr/pull/12)
 Merged

[Bump marked from 1.2.7 to 2.0.0
pvharmo/blog-jean-mercier#4](/pvharmo/blog-jean-mercier/pull/4)
 Closed

[Bump marked from 1.2.9 to 2.0.0
jorgearuv/markdown-previewer#10](/jorgearuv/markdown-previewer/pull/10)
 Merged

[Bump marked from 1.2.7 to 2.0.1
sthamizhselvan/postManCollection#9](/sthamizhselvan/postManCollection/pull/9)
 Closed

[Bump marked from 1.2.7 to 2.0.0
fabiofranchino/fabiofranchino.com#8](/fabiofranchino/fabiofranchino.com/pull/8)
 Closed

[chore(deps): bump marked from 1.2.8 to 2.0.0
rfprod/ng-elements-starter#53](/rfprod/ng-elements-starter/pull/53)
 Merged

[Bump marked from 1.2.8 to 2.0.0 in /packages/string-templates
Budibase/budibase#1285](/Budibase/budibase/pull/1285)
 Merged

[Bump marked from 1.1.1 to 2.0.0
portableant/simplemde-markdown-editor#1](/portableant/simplemde-markdown-editor/pull/1)
 Closed

[build(deps): bump marked from 1.2.6 to 2.0.0
ramonbrugman/nodejs.org#2](/ramonbrugman/nodejs.org/pull/2)
 Closed

[build(deps): bump marked from 1.2.6 to 2.0.1
ramonbrugman/nodejs.org#5](/ramonbrugman/nodejs.org/pull/5)
 Closed

[Bump marked from 1.1.1 to 2.0.0 in /mini-vuepress
su37josephxia/learn-vue3#28](/su37josephxia/learn-vue3/pull/28)
 Closed

[⬆️ Bump marked from 1.2.9 to 2.0.0
laymonage/nook#1](/laymonage/nook/pull/1)
 Merged

[Bump marked from 1.2.7 to 2.0.0 in /src/bismarck-web
alkukampela/bismarck#6](/alkukampela/bismarck/pull/6)
 Merged

[Bump marked from 0.8.2 to 2.0.1
rpocklin/phoenix#4](/rpocklin/phoenix/pull/4)
 Closed

[[skip netlify]: Bump marked from 1.2.5 to 2.0.0
wmcadigital/wmca-design-system#117](/wmcadigital/wmca-design-system/pull/117)
 Closed

[Bump marked from 1.1.1 to 2.0.0
vigenere23/gabio-markdown-transpiler#3](/vigenere23/gabio-markdown-transpiler/pull/3)
 Merged

[Bump marked from 1.2.0 to 2.0.0
vigenere23/gabio-design-svelte#7](/vigenere23/gabio-design-svelte/pull/7)
 Merged

[build(deps): bump marked from 1.2.9 to 2.0.0 in /app
emdemir/devnews#13](/emdemir/devnews/pull/13)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fpull%2F1864)

Reviewers

[![@styfle](https://avatars.githubusercontent.com/u/229881?s=40&v=4)](/styfle) [styfle](/styfle)

styfle approved these changes

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&v=4)](/UziTech) [UziTech](/UziTech)

UziTech approved these changes

[![@joshbruce](https://avatars.githubusercontent.com/u/15252830?s=40&v=4)](/joshbruce) [joshbruce](/joshbruce)

 Awaiting requested review from joshbruce

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&v=4)](/davisjam) [davisjam](/davisjam)

 Awaiting requested review from davisjam

Assignees

No one assigned

Labels

[released](/markedjs/marked/labels/released)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Groups of consecutive underscores in a specific pattern hang/take a long time to convert](https://github.com/markedjs/marked/issues/1927)

 [em and strong (\*\*\*〜\*\*\*)](https://github.com/markedjs/marked/issues/1860)

 [Asterisks are not properly escaped](https://github.com/markedjs/marked/issues/1811)

3 participants

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=52&v=4)](/calculuschild) [![@UziTech](https://avatars.githubusercontent.com/u/97994?s=52&v=4)](/UziTech) [![@styfle](https://avatars.githubusercontent.com/u/229881?s=52&v=4)](/styfle)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_90f786cc_20250114_180958.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fsecurity%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fsecurity%2Fadvisories%2FGHSA-4r62-v4vq-hr96)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=markedjs%2Fmarked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markedjs](/markedjs)
/
**[marked](/markedjs/marked)**
Public

* [Notifications](/login?return_to=%2Fmarkedjs%2Fmarked) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fmarkedjs%2Fmarked)
* [Star
   33.6k](/login?return_to=%2Fmarkedjs%2Fmarked)

* [Code](/markedjs/marked)
* [Issues
  16](/markedjs/marked/issues)
* [Pull requests
  1](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects
  1](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

Additional navigation options

* [Code](/markedjs/marked)
* [Issues](/markedjs/marked/issues)
* [Pull requests](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

# Underscore ReDoS

Moderate

[UziTech](/UziTech)
published
GHSA-4r62-v4vq-hr96
Feb 8, 2021

## Package

npm

marked
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

> 1.1.1 < 2.0.0

## Patched versions

2.0.0

## Description

### Impact

*What kind of vulnerability is it? Who is impacted?*

[Regular expression Denial of Service](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches

*Has the problem been patched? What versions should users upgrade to?*

patched in v2.0.0

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

None.

### References

*Are there any links users can visit to find out more?*

[#1927](https://github.com/markedjs/marked/issues/1927)

<https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [marked](https://github.com/markedjs/marked/issues)

### Severity

Moderate

### CVE ID

CVE-2021-21306

### Weaknesses

No CWEs

### Credits

* [![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=40&v=4)](/Xegyn)
  [Xegyn](/Xegyn)
  Analyst
* [![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=40&v=4)](/calculuschild)
  [calculuschild](/calculuschild)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a4e04f6d_20250114_180954.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fissues%2F1927)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fissues%2F1927)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=markedjs%2Fmarked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markedjs](/markedjs)
/
**[marked](/markedjs/marked)**
Public

* [Notifications](/login?return_to=%2Fmarkedjs%2Fmarked) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fmarkedjs%2Fmarked)
* [Star
   33.6k](/login?return_to=%2Fmarkedjs%2Fmarked)

* [Code](/markedjs/marked)
* [Issues
  16](/markedjs/marked/issues)
* [Pull requests
  1](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects
  1](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

Additional navigation options

* [Code](/markedjs/marked)
* [Issues](/markedjs/marked/issues)
* [Pull requests](/markedjs/marked/pulls)
* [Discussions](/markedjs/marked/discussions)
* [Actions](/markedjs/marked/actions)
* [Projects](/markedjs/marked/projects)
* [Security](/markedjs/marked/security)
* [Insights](/markedjs/marked/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmarkedjs%2Fmarked%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmarkedjs%2Fmarked%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Groups of consecutive underscores in a specific pattern hang/take a long time to convert #1927

Closed

[Xegyn](/Xegyn) opened this issue
Feb 5, 2021
· 12 comments
 · Fixed by [#1864](https://github.com/markedjs/marked/pull/1864)

Closed

# [Groups of consecutive underscores in a specific pattern hang/take a long time to convert](#top) #1927

[Xegyn](/Xegyn) opened this issue
Feb 5, 2021
· 12 comments
 · Fixed by [#1864](https://github.com/markedjs/marked/pull/1864)

Labels
[L0 - security](/markedjs/marked/labels/L0%20-%20security)
A security vulnerability within the Marked library is discovered

## Comments

[![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=80&u=83e354d5586f506ebab8b6a08d24cf2ac3d27490&v=4)](/Xegyn)

Copy link

### **[Xegyn](/Xegyn)** commented [Feb 5, 2021](#issue-801767434)

| **Marked version:** 1.2.9  **Describe the bug** 3 or more groups of odd and even-numbered consecutive underscores followed by a character takes a very long time to convert. Example input: `_______________________________ ____________________ __________________________ a` If you click on the Marked Demo link below, you will see that this takes a long time to convert (approximately 2 minutes). The input above is: 31 underscores, 20 underscores, 26 underscores, and an `a`.  Modifying the input in a number of ways changes the conversion time to < 10ms:   * modifying the above input so that the 1st group of underscores is an even number * modifying the 2nd or 3rd group of underscores to be an odd number * removing the trailing `a` character.   It seems that the longer the consecutive underscores are in length, the time increasingly gets longer.  **To Reproduce** Steps to reproduce the behavior:   1. [Marked Demo](https://marked.js.org/demo/?text=_______________________________%20____________________%20__________________________%20a&options=%7B%0A%20%22baseUrl%22%3A%20null%2C%0A%20%22breaks%22%3A%20false%2C%0A%20%22gfm%22%3A%20true%2C%0A%20%22headerIds%22%3A%20true%2C%0A%20%22headerPrefix%22%3A%20%22%22%2C%0A%20%22highlight%22%3A%20null%2C%0A%20%22langPrefix%22%3A%20%22language-%22%2C%0A%20%22mangle%22%3A%20true%2C%0A%20%22pedantic%22%3A%20false%2C%0A%20%22sanitize%22%3A%20false%2C%0A%20%22sanitizer%22%3A%20null%2C%0A%20%22silent%22%3A%20false%2C%0A%20%22smartLists%22%3A%20false%2C%0A%20%22smartypants%22%3A%20false%2C%0A%20%22tokenizer%22%3A%20null%2C%0A%20%22walkTokens%22%3A%20null%2C%0A%20%22xhtml%22%3A%20false%0A%7D&version=1.2.9) 2. [CommonMark Demo](https://spec.commonmark.org/dingus/?text=_______________________________%20____________________%20__________________________%20a)   **Expected behavior** The markdown to html conversion should take roughly the same amount of time as it does as when the above example input is modified such in one of the ways describe above (i.e. < 10ms). |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=80&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)

Copy link

Member

### **[UziTech](/UziTech)** commented [Feb 5, 2021](#issuecomment-773728733) • edited Loading

| Looks like this was introduced in ~~v1.1.2 somehow~~ actually it was [v1.2.0](https://github.com/markedjs/marked/releases/tag/v1.2.0) but our releases around that point were messed up so v1.1.2 is after v1.2.0  [v1.1.1 demo](https://marked.js.org/demo/?text=_______________________________%20____________________%20__________________________%20a&options=%7B%0A%20%22baseUrl%22%3A%20null%2C%0A%20%22breaks%22%3A%20false%2C%0A%20%22gfm%22%3A%20true%2C%0A%20%22headerIds%22%3A%20true%2C%0A%20%22headerPrefix%22%3A%20%22%22%2C%0A%20%22highlight%22%3A%20null%2C%0A%20%22langPrefix%22%3A%20%22language-%22%2C%0A%20%22mangle%22%3A%20true%2C%0A%20%22pedantic%22%3A%20false%2C%0A%20%22sanitize%22%3A%20false%2C%0A%20%22sanitizer%22%3A%20null%2C%0A%20%22silent%22%3A%20false%2C%0A%20%22smartLists%22%3A%20false%2C%0A%20%22smartypants%22%3A%20false%2C%0A%20%22tokenizer%22%3A%20null%2C%0A%20%22walkTokens%22%3A%20null%2C%0A%20%22xhtml%22%3A%20false%0A%7D&version=1.1.1) [v1.1.2 demo](https://marked.js.org/demo/?text=_______________________________%20____________________%20__________________________%20a&options=%7B%0A%20%22baseUrl%22%3A%20null%2C%0A%20%22breaks%22%3A%20false%2C%0A%20%22gfm%22%3A%20true%2C%0A%20%22headerIds%22%3A%20true%2C%0A%20%22headerPrefix%22%3A%20%22%22%2C%0A%20%22highlight%22%3A%20null%2C%0A%20%22langPrefix%22%3A%20%22language-%22%2C%0A%20%22mangle%22%3A%20true%2C%0A%20%22pedantic%22%3A%20false%2C%0A%20%22sanitize%22%3A%20false%2C%0A%20%22sanitizer%22%3A%20null%2C%0A%20%22silent%22%3A%20false%2C%0A%20%22smartLists%22%3A%20false%2C%0A%20%22smartypants%22%3A%20false%2C%0A%20%22tokenizer%22%3A%20null%2C%0A%20%22walkTokens%22%3A%20null%2C%0A%20%22xhtml%22%3A%20false%0A%7D&version=1.1.2) |
| --- |

All reactions

Sorry, something went wrong.

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
added
the
[L0 - security](/markedjs/marked/labels/L0%20-%20security)
A security vulnerability within the Marked library is discovered
label
[Feb 5, 2021](#event-4293908010)

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=80&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)

Copy link

Member

### **[UziTech](/UziTech)** commented [Feb 5, 2021](#issuecomment-773735769)

| After some testing it looks like [#1864](https://github.com/markedjs/marked/pull/1864) fixes it. [@calculuschild](https://github.com/calculuschild) maybe we should release v2 with that fix sooner rather than wait for [#1872](https://github.com/markedjs/marked/pull/1872) and others? |
| --- |

 👍
2
 Xegyn and styfle reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
linked a pull request
[Feb 5, 2021](#event-4293949841)
that will
close
this issue

[fix: Total rework of Emphasis/Strong
#1864](/markedjs/marked/pull/1864)
 Merged

5 tasks

[![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=80&v=4)](/calculuschild)

Copy link

Contributor

### **[calculuschild](/calculuschild)** commented [Feb 5, 2021](#issuecomment-773738046)

| I'm not opposed to that. I'm kind of at a dead end with [#1872](https://github.com/markedjs/marked/pull/1872) for now anyway. |
| --- |

All reactions

Sorry, something went wrong.

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
mentioned this issue
[Feb 5, 2021](#ref-pullrequest-758140438)

[fix: Total rework of Emphasis/Strong
#1864](/markedjs/marked/pull/1864)
 Merged

5 tasks

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
closed this as [completed](/markedjs/marked/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#1864](/markedjs/marked/pull/1864)
[Feb 7, 2021](#event-4300753822)

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=80&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)

Copy link

Member

### **[UziTech](/UziTech)** commented [Feb 7, 2021](#issuecomment-774780993)

| This should be fixed in v2.0.0 |
| --- |

All reactions

Sorry, something went wrong.

[![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=80&u=83e354d5586f506ebab8b6a08d24cf2ac3d27490&v=4)](/Xegyn)

Copy link

Author

### **[Xegyn](/Xegyn)** commented [Feb 8, 2021](#issuecomment-774807806)

| Thank you so much for the speedy response!! 🙇‍♂️ |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Feb 8, 2021

[fix(deps): update dependency marked to v2 [security]
orzyyyy/memo#510](/orzyyyy/memo/pull/510)
 Merged

[fix(deps): update dependency marked to v2 [security]
ganta/marktone#237](/ganta/marktone/pull/237)
 Merged

[fix(deps): update dependency marked to v4 [security] - abandoned
ngx-builders/ngx-bulma#498](/ngx-builders/ngx-bulma/pull/498)
 Open

[Update dependency marked to v2 [SECURITY] - autoclosed
jaywcjlove/linux-command#231](/jaywcjlove/linux-command/pull/231)
 Closed

[Update dependency marked to v2 [SECURITY] - autoclosed
onigoetz/onigoetz.github.io#53](/onigoetz/onigoetz.github.io/pull/53)
 Closed

[fix(deps): update dependency marked to v2 [security] - autoclosed
fisker/blog#908](/fisker/blog/pull/908)
 Closed

[chore(deps): update dependency marked to v2 [security]
carforyou/carforyou-components-pkg#310](/carforyou/carforyou-components-pkg/pull/310)
 Merged

[chore(deps): update dependency marked to v2 [security]
bus-stop/x-terminal#259](/bus-stop/x-terminal/pull/259)
 Merged

[Update dependency marked to v2 [SECURITY]
emmercm/www#144](/emmercm/www/pull/144)
 Merged

[![@stylemistake](https://avatars.githubusercontent.com/u/1516236?s=40&v=4)](/stylemistake)
[stylemistake](/stylemistake)
mentioned this issue
[Feb 8, 2021](#ref-pullrequest-804025634)

[Upgrade marked to 2.0.0, along with the other deps
tgstation/tgstation#56767](/tgstation/tgstation/pull/56767)
 Merged

This was referenced Feb 8, 2021

[Update dependency marked to v2 [SECURITY] - autoclosed
dalcde/matrix-appservice-mattermost#158](/dalcde/matrix-appservice-mattermost/pull/158)
 Closed

[Update dependency marked to 2.0.0 [SECURITY] - autoclosed
doppelganger9/blog#164](/doppelganger9/blog/pull/164)
 Closed

[patch: Update dependency marked to v2 [SECURITY]
product-os/jellyfish-sync#485](/product-os/jellyfish-sync/pull/485)
 Closed

[fix(deps): update dependency marked to v2 [security]
JustinBeckwith/linkinator#271](/JustinBeckwith/linkinator/pull/271)
 Merged

[Update dependency marked to v2 [SECURITY]
transnano/markdown-to-confluence-vscode#158](/transnano/markdown-to-confluence-vscode/pull/158)
 Merged

[fix(deps): update dependency marked to v2 [security]
release-lab/whatchanged#41](/release-lab/whatchanged/pull/41)
 Merged

[Update dependency marked to v4 [SECURITY] - abandoned
umetsu/blog#345](/umetsu/blog/pull/345)
 Open

[Update dependency marked to v2 [SECURITY]
macrat/blanktar#617](/macrat/blanktar/pull/617)
 Merged

[Update dependency marked to ^1.2.9 [SECURITY]
ianwalter/print#177](/ianwalter/print/pull/177)
 Open

[fix(deps): update dependency marked to v2 [security]
zce/m2i-cli#21](/zce/m2i-cli/pull/21)
 Merged

[Update dependency marked to v2 [SECURITY] - autoclosed
hiroxto/utils.hiroxto.net#389](/hiroxto/utils.hiroxto.net/pull/389)
 Closed

91 hidden items

Load more…

This was referenced Apr 26, 2021

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
locona/github-release-qadoc#23](/locona/github-release-qadoc/pull/23)
 Open

[chore(deps): update dependency marked to 2.0.0 [security]
aslafy-z/conventional-pr-title-action#102](/aslafy-z/conventional-pr-title-action/pull/102)
 Closed

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
locona/action-sqlboiler#20](/locona/action-sqlboiler/pull/20)
 Open

[chore(deps): update dependency marked to 2.0.0 [security]
cypress-io/commit-message-install#50](/cypress-io/commit-message-install/pull/50)
 Merged

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
locona/action-mysqldef#23](/locona/action-mysqldef/pull/23)
 Open

[Changed: Update dependency marked to 2.0.0 [SECURITY] - autoclosed
fabulator/commitlint-config-fabulator#11](/fabulator/commitlint-config-fabulator/pull/11)
 Closed

[Changed: Update dependency marked to 2.0.0 [SECURITY] - autoclosed
fabulator/semantic-release-config-fabulator#44](/fabulator/semantic-release-config-fabulator/pull/44)
 Closed

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
locona/action-github-release-qadoc#20](/locona/action-github-release-qadoc/pull/20)
 Open

[Update dependency marked to 2.0.0 [SECURITY]
onXmaps/cypress-iap#10](/onXmaps/cypress-iap/pull/10)
 Merged

[Update dependency marked to v2 [SECURITY]
telemark/micro-dsf#175](/telemark/micro-dsf/pull/175)
 Merged

This was referenced May 3, 2021

[Update dependency marked to 2.0.0 [SECURITY] - autoclosed
chrkaatz/coverage-test#15](/chrkaatz/coverage-test/pull/15)
 Closed

[chore(deps): update dependency marked to 2.0.0 [security] (master) - autoclosed
traverson/semantic-release-config#116](/traverson/semantic-release-config/pull/116)
 Closed

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
crystal-lang-tools/atom-ide-crystal#80](/crystal-lang-tools/atom-ide-crystal/pull/80)
 Closed

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
lddubeau/bootprompt#179](/lddubeau/bootprompt/pull/179)
 Open

[chore(deps): update dependency marked to 2.0.0 [security]
lddubeau/saxes#77](/lddubeau/saxes/pull/77)
 Merged

[chore(deps): update dependency marked to 4.0.10 [security] - autoclosed
TylorS/typed-prelude#426](/TylorS/typed-prelude/pull/426)
 Closed

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
mangalam-research/salve#146](/mangalam-research/salve/pull/146)
 Open

[Update dependency marked to v2 [SECURITY]
sourcegraph/sourcegraph-public-snapshot#20792](/sourcegraph/sourcegraph-public-snapshot/pull/20792)
 Closed

[![@julienw](https://avatars.githubusercontent.com/u/454175?s=80&v=4)](/julienw)

Copy link

### **[julienw](/julienw)** commented [May 11, 2021](#issuecomment-838800406)

| Hey ! Do you think it would be possible to have a fix for the v1 branch as well? Some packages like [docsify](https://github.com/docsifyjs/docsify-cli/issues/136) do not seem quick to upgrade :/ Thanks a lot for your work! |
| --- |

All reactions

Sorry, something went wrong.

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=80&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)

Copy link

Member

### **[UziTech](/UziTech)** commented [May 11, 2021](#issuecomment-838976092)

| The fix has breaking changes. If this was backported to v1 those packages that don't update could break. I think it would be better for them to update their dependency then to totally break. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced May 15, 2021

[chore(deps): update dependency marked to 2.0.0 [security]
cypress-io/snapshot#139](/cypress-io/snapshot/pull/139)
 Merged

[chore(deps): update dependency marked to 4.0.10 [security] - abandoned
kube-js/semantic-release#7](/kube-js/semantic-release/pull/7)
 Open

[chore(deps): update dependency marked to 2.0.0 [security]
HT2-Labs/plop-generators#38](/HT2-Labs/plop-generators/pull/38)
 Open

[chore(deps): update dependency marked to 2.0.0 [security]
GoodwayGroup/circleci-orb#21](/GoodwayGroup/circleci-orb/pull/21)
 Merged

[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/apps/renovate)
[renovate](/apps/renovate)
bot
mentioned this issue
[May 25, 2021](#ref-pullrequest-901449017)

[chore(deps): update dependency marked to 2.0.0 [security]
academydistrict20/analytics#47](/academydistrict20/analytics/pull/47)
 Merged

1 task

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
mentioned this issue
[May 31, 2021](#ref-issue-902813645)

[Uncaught InternalError: too much recursion
#2074](/markedjs/marked/issues/2074)

Closed

[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/apps/renovate)
[renovate](/apps/renovate)
bot
mentioned this issue
[Jun 7, 2021](#ref-pullrequest-913340186)

[chore(deps): update dependency marked to 2.0.0 [security] - autoclosed
geeeger/ws-uploader#208](/geeeger/ws-uploader/pull/208)
 Closed

1 task

[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/apps/renovate)
[renovate](/apps/renovate)
bot
mentioned this issue
[Jul 22, 2021](#ref-pullrequest-950270060)

[fix(deps): update dependency marked to v4 [security]
atom-community/atom-ide-markdown-service#46](/atom-community/atom-ide-markdown-service/pull/46)
 Open

1 task

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=40&u=62a0ac50424c26046bdcf839a82d9ffa15972579&v=4)](/UziTech)
[UziTech](/UziTech)
mentioned this issue
[Nov 1, 2021](#ref-issue-1041403418)

[Performance Issue, feels like infinite loop
#2264](/markedjs/marked/issues/2264)

Closed

[kodiakhq](/apps/kodiakhq) bot
referenced
this issue
in carbon-design-system/carbon-for-ibm-dotcom
[Jan 11, 2022](#ref-commit-fa7a33c)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[fix(deps): update dependency marked to v2 [security] (](/carbon-design-system/carbon-for-ibm-dotcom/commit/fa7a33c100bd9d0195c68af896f6a8e8cdca58e7 "fix(deps): update dependency marked to v2 [security] (#7980)

[![WhiteSource Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [marked](https://marked.js.org) ([source](https://togithub.com/markedjs/marked)) | [`^1.2.9` -> `^2.0.0`](https://renovatebot.com/diffs/npm/marked/1.2.9/2.0.0) | [![age](https://badges.renovateapi.com/packages/npm/marked/2.0.0/age-slim)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://badges.renovateapi.com/packages/npm/marked/2.0.0/adoption-slim)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://badges.renovateapi.com/packages/npm/marked/2.0.0/compatibility-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://badges.renovateapi.com/packages/npm/marked/2.0.0/confidence-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2021-21306](https://togithub.com/markedjs/marked/security/advisories/GHSA-4r62-v4vq-hr96)

### Impact
_What kind of vulnerability is it? Who is impacted?_

[Regular expression Denial of Service](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches
_Has the problem been patched? What versions should users upgrade to?_

patched in v2.0.0

### Workarounds
_Is there a way for users to fix or remediate the vulnerability without upgrading?_

None.

### References
_Are there any links users can visit to find out more?_

[https://github.com/markedjs/marked/issues/1927](https://togithub.com/markedjs/marked/issues/1927)
https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS

### For more information
If you have any questions or comments about this advisory:
* Open an issue in [marked](https://togithub.com/markedjs/marked/issues)

---

### Release Notes

<details>
<summary>markedjs/marked</summary>

### [`v2.0.0`](https://togithub.com/markedjs/marked/releases/v2.0.0)

[Compare Source](https://togithub.com/markedjs/marked/compare/v1.2.9...v2.0.0)

##### Bug Fixes

-   Join adjacent inlineText tokens ([#&#8203;1926](https://togithub.com/markedjs/marked/issues/1926)) ([f848e77](https://togithub.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0))
-   Total rework of Emphasis/Strong ([#&#8203;1864](https://togithub.com/markedjs/marked/issues/1864)) ([7293251](https://togithub.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd))

##### BREAKING CHANGES

-   `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer.
-   `code` and `text` tokenizers do not get passed all tokens as a second parameter.
-   No longer supporting IE 11. IE 11 may still work but we are not committed to making sure it works with every update. We still provide an es5 version in `lib/marked.js` but some pollyfills may be needed for IE 11 in the future.

</details>

---

### Configuration

📅 **Schedule**: \"\" (UTC).

🚦 **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, click this checkbox.

---

This PR has been generated by [WhiteSource Renovate](https://renovate.whitesourcesoftware.com). View repository job log [here](https://app.renovatebot.com/dashboard#github/carbon-design-system/carbon-for-ibm-dotcom).")[#7980](https://github.com/carbon-design-system/carbon-for-ibm-dotcom/pull/7980)[)](/carbon-design-system/carbon-for-ibm-dotcom/commit/fa7a33c100bd9d0195c68af896f6a8e8cdca58e7 "fix(deps): update dependency marked to v2 [security] (#7980)

[![WhiteSource Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [marked](https://marked.js.org) ([source](https://togithub.com/markedjs/marked)) | [`^1.2.9` -> `^2.0.0`](https://renovatebot.com/diffs/npm/marked/1.2.9/2.0.0) | [![age](https://badges.renovateapi.com/packages/npm/marked/2.0.0/age-slim)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://badges.renovateapi.com/packages/npm/marked/2.0.0/adoption-slim)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://badges.renovateapi.com/packages/npm/marked/2.0.0/compatibility-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://badges.renovateapi.com/packages/npm/marked/2.0.0/confidence-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2021-21306](https://togithub.com/markedjs/marked/security/advisories/GHSA-4r62-v4vq-hr96)

### Impact
_What kind of vulnerability is it? Who is impacted?_

[Regular expression Denial of Service](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches
_Has the problem been patched? What versions should users upgrade to?_

patched in v2.0.0

### Workarounds
_Is there a way for users to fix or remediate the vulnerability without upgrading?_

None.

### References
_Are there any links users can visit to find out more?_

[https://github.com/markedjs/marked/issues/1927](https://togithub.com/markedjs/marked/issues/1927)
https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS

### For more information
If you have any questions or comments about this advisory:
* Open an issue in [marked](https://togithub.com/markedjs/marked/issues)

---

### Release Notes

<details>
<summary>markedjs/marked</summary>

### [`v2.0.0`](https://togithub.com/markedjs/marked/releases/v2.0.0)

[Compare Source](https://togithub.com/markedjs/marked/compare/v1.2.9...v2.0.0)

##### Bug Fixes

-   Join adjacent inlineText tokens ([#&#8203;1926](https://togithub.com/markedjs/marked/issues/1926)) ([f848e77](https://togithub.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0))
-   Total rework of Emphasis/Strong ([#&#8203;1864](https://togithub.com/markedjs/marked/issues/1864)) ([7293251](https://togithub.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd))

##### BREAKING CHANGES

-   `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer.
-   `code` and `text` tokenizers do not get passed all tokens as a second parameter.
-   No longer supporting IE 11. IE 11 may still work but we are not committed to making sure it works with every update. We still provide an es5 version in `lib/marked.js` but some pollyfills may be needed for IE 11 in the future.

</details>

---

### Configuration

📅 **Schedule**: \"\" (UTC).

🚦 **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, click this checkbox.

---

This PR has been generated by [WhiteSource Renovate](https://renovate.whitesourcesoftware.com). View repository job log [here](https://app.renovatebot.com/dashboard#github/carbon-design-system/carbon-for-ibm-dotcom).")`
…

`[fa7a33c](/carbon-design-system/carbon-for-ibm-dotcom/commit/fa7a33c100bd9d0195c68af896f6a8e8cdca58e7)`

```
[![WhiteSource Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [marked](<https://marked.js.org>) ([source](<https://togithub.com/markedjs/marked>)) | [`^1.2.9` -> `^2.0.0`](<https://renovatebot.com/diffs/npm/marked/1.2.9/2.0.0>) | [![age]([https://badges.renovateapi.com/packages/npm/marked/2.0.0/age-slim)](https://docs.renovatebot.com/merge-confidence/](https://badges.renovateapi.com/packages/npm/marked/2.0.0/age-slim%29%5D%28https%3A//docs.renovatebot.com/merge-confidence/)) | [![adoption]([https://badges.renovateapi.com/packages/npm/marked/2.0.0/adoption-slim)](https://docs.renovatebot.com/merge-confidence/](https://badges.renovateapi.com/packages/npm/marked/2.0.0/adoption-slim%29%5D%28https%3A//docs.renovatebot.com/merge-confidence/)) | [![passing]([https://badges.renovateapi.com/packages/npm/marked/2.0.0/compatibility-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/](https://badges.renovateapi.com/packages/npm/marked/2.0.0/compatibility-slim/1.2.9%29%5D%28https%3A//docs.renovatebot.com/merge-confidence/)) | [![confidence]([https://badges.renovateapi.com/packages/npm/marked/2.0.0/confidence-slim/1.2.9)](https://docs.renovatebot.com/merge-confidence/](https://badges.renovateapi.com/packages/npm/marked/2.0.0/confidence-slim/1.2.9%29%5D%28https%3A//docs.renovatebot.com/merge-confidence/)) |

### GitHub Vulnerability Alerts

#### [[CVE-2021-21306](https://github.com/advisories/GHSA-4r62-v4vq-hr96 "CVE-2021-21306")](<https://togithub.com/markedjs/marked/security/advisories/GHSA-4r62-v4vq-hr96>)

### Impact
_What kind of vulnerability is it? Who is impacted?_

[Regular expression Denial of Service](<https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>)

A Denial of Service attack can affect anyone who runs user generated code through `marked`.

### Patches
_Has the problem been patched? What versions should users upgrade to?_

patched in v2.0.0

### Workarounds
_Is there a way for users to fix or remediate the vulnerability without upgrading?_

None.

### References
_Are there any links users can visit to find out more?_

[[https://github.com/markedjs/marked/issues/1927](https://togithub.com/markedjs/marked/issues/1927)](https://github.com/markedjs/marked/issues/1927%5D%28https%3A//togithub.com/markedjs/marked/issues/1927%29)
<https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>

### For more information
If you have any questions or comments about this advisory:
* Open an issue in [marked](<https://togithub.com/markedjs/marked/issues>)

---

### Release Notes

<details>
<summary>markedjs/marked</summary>

### [`v2.0.0`](<https://togithub.com/markedjs/marked/releases/v2.0.0>)

[Compare Source](<https://togithub.com/markedjs/marked/compare/v1.2.9...v2.0.0>)

##### Bug Fixes

-   Join adjacent inlineText tokens ([#&[#8203](https://github.com/carbon-design-system/carbon-for-ibm-dotcom/issues/8203);1926](<https://togithub.com/markedjs/marked/issues/1926>)) ([f848e77](<https://togithub.com/markedjs/marked/commit/f848e7703956a6c37871432a7e128f51b1700aa0>))
-   Total rework of Emphasis/Strong ([#&[#8203](https://github.com/carbon-design-system/carbon-for-ibm-dotcom/issues/8203);1864](<https://togithub.com/markedjs/marked/issues/1864>)) ([7293251](<https://togithub.com/markedjs/marked/commit/7293251c438e3ee968970f7609f1a27f9007bccd>))

##### BREAKING CHANGES

-   `em` and `strong` tokenizers have been merged into one `emStrong` tokenizer.
-   `code` and `text` tokenizers do not get passed all tokens as a second parameter.
-   No longer supporting IE 11. IE 11 may still work but we are not committed to making sure it works with every update. We still provide an es5 version in `lib/marked.js` but some pollyfills may be needed for IE 11 in the future.

</details>

---

### Configuration

📅 **Schedule**: "" (UTC).

🚦 **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

♻ **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

🔕 **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, click this checkbox.

---

This PR has been generated by [WhiteSource Renovate](<https://renovate.whitesourcesoftware.com>). View repository job log [here](<https://app.renovatebot.com/dashboard#github/carbon-design-system/carbon-for-ibm-dotcom>).
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkedjs%2Fmarked%2Fissues%2F1927)

Assignees

No one assigned

Labels

[L0 - security](/markedjs/marked/labels/L0%20-%20security)
A security vulnerability within the Marked library is discovered

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [fix: Total rework of Emphasis/Strong](/markedjs/marked/pull/1864)
 [calculuschild/marked](/calculuschild/marked)

5 participants

[![@UziTech](https://avatars.githubusercontent.com/u/97994?s=52&v=4)](/UziTech) [![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=52&v=4)](/XhmikosR) [![@julienw](https://avatars.githubusercontent.com/u/454175?s=52&v=4)](/julienw) [![@Xegyn](https://avatars.githubusercontent.com/u/757802?s=52&v=4)](/Xegyn) [![@calculuschild](https://avatars.githubusercontent.com/u/5878534?s=52&v=4)](/calculuschild)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_94605f48_20250114_180958.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## markedTypeScript icon, indicating that this package has built-in type declarations

15.0.6Â â¢Â PublicÂ â¢Â Published 8 days ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [8,643 Dependents](?activeTab=dependents)
* [187 Versions](?activeTab=versions)

[![](https://camo.githubusercontent.com/3cbc2c83e8970766a734b785bdc273512467ac80682fc66e037f6306f9629be4/68747470733a2f2f6d61726b65642e6a732e6f72672f696d672f6c6f676f2d626c61636b2e737667)](https://marked.js.org)
# Marked

[![npm](https://camo.githubusercontent.com/4c467079ad493aa732ac9f51ccaff8797f6cfe92c8326a6c913a16e3ccdc9365/68747470733a2f2f62616467656e2e6e65742f6e706d2f762f6d61726b6564)](https://www.npmjs.com/package/marked)
[![install size](https://camo.githubusercontent.com/e57cf2947d071ee50b52904053078f758fc3f3b1eb520d3b2216d1b0a35d255d/68747470733a2f2f62616467656e2e6e65742f7061636b61676570686f6269612f696e7374616c6c2f6d61726b6564)](https://packagephobia.now.sh/result?p=marked)
[![downloads](https://camo.githubusercontent.com/e121ed55af713cc6493bd4b25dca9ec5f0efe2050e808456bad16286598d5028/68747470733a2f2f62616467656e2e6e65742f6e706d2f64742f6d61726b6564)](https://www.npmjs.com/package/marked)
[![github actions](https://github.com/markedjs/marked/workflows/Tests/badge.svg)](https://github.com/markedjs/marked/actions)
[![snyk](https://camo.githubusercontent.com/741134a65f82530f2e312b4f197fbbaeb0ebad1e563b0cc3968a650ea5090d8e/68747470733a2f2f736e796b2e696f2f746573742f6e706d2f6d61726b65642f62616467652e737667)](https://snyk.io/test/npm/marked)

* â¡ built for speed
* â¬ï¸ low-level compiler for parsing markdown without caching or blocking for long periods of time
* âï¸ light-weight while implementing all markdown features from the supported flavors & specifications
* ð works in a browser, on a server, or from a command line interface (CLI)

## Demo

Checkout the [demo page](https://marked.js.org/demo/) to see marked in action â¹ï¸

## Docs

Our [documentation pages](https://marked.js.org) are also rendered using marked ð¯

Also read about:

* [Options](https://marked.js.org/using_advanced)
* [Extensibility](https://marked.js.org/using_pro)

## Compatibility

**Node.js:** Only [current and LTS](https://nodejs.org/en/about/releases/) Node.js versions are supported. End of life Node.js versions may become incompatible with Marked at any point in time.

**Browser:** Not IE11 :)

## Installation

**CLI:**

```
npm install -g marked
```

**In-browser:**

```
npm install marked
```

## Usage

### Warning: ð¨ Marked does not [sanitize](https://marked.js.org/using_advanced#options) the output HTML. Please use a sanitize library, like [DOMPurify](https://github.com/cure53/DOMPurify) (recommended), [sanitize-html](https://github.com/apostrophecms/sanitize-html) or [insane](https://github.com/bevacqua/insane) on the *output* HTML! ð¨

```
DOMPurify.sanitize(marked.parse(`<img src="x" onerror="alert('not happening')">`));

```

**CLI**

```
# Example with stdin input
$ marked -o hello.html
hello world
^D
$ cat hello.html
<p>hello world</p>
```

```
# Print all options
$ marked --help
```

**Browser**

```
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Marked in the browser</title>
</head>
<body>
  <div id="content"></div>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.getElementById('content').innerHTML =
      marked.parse('# Marked in the browser\n\nRendered by **marked**.');
  </script>
</body>
</html>
```

or import esm module

```
<script type="module">
  import { marked } from "https://cdn.jsdelivr.net/npm/marked/lib/marked.esm.js";
  document.getElementById('content').innerHTML =
    marked.parse('# Marked in the browser\n\nRendered by **marked**.');
</script>
```

## License

Copyright (c) 2011-2022, Christopher Jeffrey. (MIT License)

## Readme

### Keywords

* [markdown](/search?q=keywords:markdown)
* [markup](/search?q=keywords:markup)
* [html](/search?q=keywords:html)
# Provenance

[Share feedback](https://github.com/npm/feedback)
## Package Sidebar

### Install

`npm i marked`

### Repository

[Gitgithub.com/markedjs/marked](https://github.com/markedjs/marked)

### Homepage

[marked.js.org](https://marked.js.org)

### DownloadsWeekly Downloads

9,640,350

### Version

15.0.6

### License

MIT

### Unpacked Size

962 kB

### Total Files

16

### Last publish

8 days ago

### Collaborators

* [![chjj](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85NjE2MDYyN2RlMWExYzE0MmIzYjVmMTA1OGRmZjA3Zj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.fF5_cQ1txKkMeRkLWMUiINOz1wVz-dGaAheJURZU1PY "chjj")](/~chjj)
* [![styfle](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lMjgxMjU0ZGZkMDdiYzQ1NzFkMmNjODkxMDgxMjQ5ND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.GcN3GuW2yrlsJIxlAUrRG9JoGMGEXbHQUSrgNut0Oa4 "styfle")](/~styfle)
* [![amidknight](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hODA0ZWQzN2M2MzEwN2YyOTEzNDAwMDljYWIzM2FiZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.EJ1y_HzhlfHXgNr9YcifwMIIPdOIrpzdrwb-XqjrpuQ "amidknight")](/~amidknight)
* [![tonybrix](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zYTY2MDUxYzVhMzM4MzM3OWE1Mzk0MmY3YWJiNDcyZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.oc3bRT9LqKoAUmsFix-vK0y4MbLVJDgk7AGKHNbHFY8 "tonybrix")](/~tonybrix)
[**Try** on RunKit](https://runkit.com/npm/marked)[**Report** malware](/support?inquire=security&security-inquire=malware&package=marked&version=15.0.6)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)


