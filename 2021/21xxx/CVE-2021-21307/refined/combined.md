=== Content from packetstormsecurity.com_dacc05a3_20250115_092426.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_14a4fd5f_20250115_092431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttpvoid%2Fwriteups%2Fblob%2Fmain%2FApple-RCE.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttpvoid%2Fwriteups%2Fblob%2Fmain%2FApple-RCE.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=httpvoid%2Fwriteups)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[httpvoid](/httpvoid)
/
**[writeups](/httpvoid/writeups)**
Public

* [Notifications](/login?return_to=%2Fhttpvoid%2Fwriteups) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fhttpvoid%2Fwriteups)
* [Star
   1.2k](/login?return_to=%2Fhttpvoid%2Fwriteups)

* [Code](/httpvoid/writeups)
* [Issues
  3](/httpvoid/writeups/issues)
* [Pull requests
  0](/httpvoid/writeups/pulls)
* [Actions](/httpvoid/writeups/actions)
* [Projects
  0](/httpvoid/writeups/projects)
* [Security](/httpvoid/writeups/security)
* [Insights](/httpvoid/writeups/pulse)

Additional navigation options

* [Code](/httpvoid/writeups)
* [Issues](/httpvoid/writeups/issues)
* [Pull requests](/httpvoid/writeups/pulls)
* [Actions](/httpvoid/writeups/actions)
* [Projects](/httpvoid/writeups/projects)
* [Security](/httpvoid/writeups/security)
* [Insights](/httpvoid/writeups/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a2abc0b2_20250115_092434.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flucee%2FLucee%2Fcommit%2F6208ab7c44c61d26c79e0b0af10382899f57e1ca)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flucee%2FLucee%2Fcommit%2F6208ab7c44c61d26c79e0b0af10382899f57e1ca)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lucee%2FLucee)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lucee](/lucee)
/
**[Lucee](/lucee/Lucee)**
Public

* [Notifications](/login?return_to=%2Flucee%2FLucee) You must be signed in to change notification settings
* [Fork
  183](/login?return_to=%2Flucee%2FLucee)
* [Star
   868](/login?return_to=%2Flucee%2FLucee)

* [Code](/lucee/Lucee)
* [Pull requests
  52](/lucee/Lucee/pulls)
* [Actions](/lucee/Lucee/actions)
* [Projects
  0](/lucee/Lucee/projects)
* [Wiki](/lucee/Lucee/wiki)
* [Security](/lucee/Lucee/security)
* [Insights](/lucee/Lucee/pulse)

Additional navigation options

* [Code](/lucee/Lucee)
* [Pull requests](/lucee/Lucee/pulls)
* [Actions](/lucee/Lucee/actions)
* [Projects](/lucee/Lucee/projects)
* [Wiki](/lucee/Lucee/wiki)
* [Security](/lucee/Lucee/security)
* [Insights](/lucee/Lucee/pulse)

## Commit

[Permalink](/lucee/Lucee/commit/6208ab7c44c61d26c79e0b0af10382899f57e1ca)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fixes LDEV-3119

[Browse files](/lucee/Lucee/tree/6208ab7c44c61d26c79e0b0af10382899f57e1ca)
Browse the repository at this point in the history

* Loading branch information

[![@michaeloffner](https://avatars.githubusercontent.com/u/10769446?s=40&v=4)](/michaeloffner)

[michaeloffner](/lucee/Lucee/commits?author=michaeloffner "View all commits by michaeloffner")
committed
Oct 26, 2020

1 parent
[b53f1a8](/lucee/Lucee/commit/b53f1a8332fdbd2a3b9de4bf3c8a663b1100da9b)

commit 6208ab7

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**13 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/src/main/cfml/context/admin

  + core/src/main/cfml/context/admin/Application.cfc
    [Application.cfc](#diff-52e3e6fa007505cd7a60cf67dc7f07095851975e16b0c0bbe25d1cb20ebd62ec)
* loader

  + loader/build.xml
    [build.xml](#diff-ede1d4ce76cc65121e72564f8a476f1ac791ad55b85a38ffe8ca906430804658)
  + loader/pom.xml
    [pom.xml](#diff-514ca5af29462d2ab337eef4ee820a88669e195288e0c16313a954d7ab532250)

## There are no files selected for viewing

11 changes: 11 additions & 0 deletions

11
[core/src/main/cfml/context/admin/Application.cfc](#diff-52e3e6fa007505cd7a60cf67dc7f07095851975e16b0c0bbe25d1cb20ebd62ec "core/src/main/cfml/context/admin/Application.cfc")

Show comments

[View file](/lucee/Lucee/blob/6208ab7c44c61d26c79e0b0af10382899f57e1ca/core/src/main/cfml/context/admin/Application.cfc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,6 +32,17 @@ this.sessionCookie.httpOnly = true; // prevent access to session cookies from ja |
|  |  | this.sessionCookie.sameSite = "strict"; |
|  |  | this.tag.cookie.sameSite = "strict"; |
|  |  |  |
|  |  | public function onRequestStart() { |
|  |  | // if not logged in, we only allow access to admin|web|server[.cfm] |
|  |  | if(!structKeyExists(session, "passwordWeb") && !structKeyExists(session, "passwordServer")){ |
|  |  | var fileName=listLast(cgi.script\_name,"/"); |
|  |  | if(fileName!="admin.cfm" && fileName!="web.cfm" && fileName!="server.cfm") { |
|  |  | cfheader(statuscode="404" statustext="Invalid access"); |
|  |  | abort; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | public function onApplicationStart(){ |
|  |  | if(structKeyExists(server.system.environment,"LUCEE\_ADMIN\_ENABLED") && server.system.environment.LUCEE\_ADMIN\_ENABLED EQ false){ |
|  |  | cfheader(statuscode="404" statustext="Invalid access"); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[loader/build.xml](#diff-ede1d4ce76cc65121e72564f8a476f1ac791ad55b85a38ffe8ca906430804658 "loader/build.xml")

Show comments

[View file](/lucee/Lucee/blob/6208ab7c44c61d26c79e0b0af10382899f57e1ca/loader/build.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | <?xml version="1.0" encoding="UTF-8"?> |
|  |  | <project default="core" basedir="." name="Lucee" xmlns:artifact="antlib:org.apache.maven.artifact.ant"> |
|  |  |  |
|  |  | <property name="version" value="5.3.8.88-SNAPSHOT"/> |
|  |  | <property name="version" value="5.3.8.89-SNAPSHOT"/> |
|  |  |  |
|  |  | <path id="maven-ant-tasks.classpath" path="../ant/lib/maven-ant-tasks-2.1.3.jar" /> |
|  |  | <typedef resource="org/apache/maven/artifact/ant/antlib.xml" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[loader/pom.xml](#diff-514ca5af29462d2ab337eef4ee820a88669e195288e0c16313a954d7ab532250 "loader/pom.xml")

Show comments

[View file](/lucee/Lucee/blob/6208ab7c44c61d26c79e0b0af10382899f57e1ca/loader/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,7 @@ |
|  |  |  |
|  |  | <groupId>org.lucee</groupId> |
|  |  | <artifactId>lucee</artifactId> |
|  |  | <version>5.3.8.88-SNAPSHOT</version> |
|  |  | <version>5.3.8.89-SNAPSHOT</version> |
|  |  | <packaging>jar</packaging> |
|  |  |  |
|  |  | <name>Lucee Loader Build</name> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6208ab7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flucee%2FLucee%2Fcommit%2F6208ab7c44c61d26c79e0b0af10382899f57e1ca) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from dev.lucee.org_7b77f3e0_20250115_092428.html ===


![Lucee Dev](data:image/svg;base64...)
Loading

[Lucee Dev](/)

# [Lucee Vulnerability Alert - November 2020, CVE-2021-21307](/t/lucee-vulnerability-alert-november-2020-cve-2021-21307/7643)

[news](/c/news/release/8)

[release](/c/news/release/8)

[security](https://dev.lucee.org/tag/security)

[JoyMiller](https://dev.lucee.org/u/JoyMiller)

November 23, 2020, 4:26pm

1

We are aware of a potential security vulnerability related to the Lucee Admin. Details of how to exploit this vulnerability will be made public on December 5th, 2020 by a third party, so we are alerting Lucee users to address this potential issue now.

[![image](https://dev.lucee.org/uploads/default/optimized/2X/9/92df9da205f9c25085fec0034a5eb28fe4bc3bc9_2_689x388.jpeg)image1240×698 333 KB](https://dev.lucee.org/uploads/default/original/2X/9/92df9da205f9c25085fec0034a5eb28fe4bc3bc9.jpeg "image")

If your Lucee Admin is already locked down, this is not an issue. To lock down your admin, follow the recommendations in the [Lucee Lockdown Guide](https://docs.lucee.org/guides/deploying-lucee-server-apps/lockdown-guide.html).

![](https://dev.lucee.org/uploads/default/original/2X/9/92f7d0ebe7f94424002b99037971117eb552d4fd.png)
[docs.lucee.org](https://docs.lucee.org/guides/deploying-lucee-server-apps/lockdown-guide.html)

![](https://dev.lucee.org/uploads/default/original/2X/9/92f7d0ebe7f94424002b99037971117eb552d4fd.png)
### [Lockdown Guide :: Lucee Documentation](https://docs.lucee.org/guides/deploying-lucee-server-apps/lockdown-guide.html)

Table of contents Lockdown Guide Don't forget to lockdown your source control metadata Restricted Access Plus SSH Tunnelling Some Good Resources written for Lucee that can be adapted for Lucee Lockdown Guide A guide to limit access to a Lucee server...

In addition, we strongly recommend updating to one of the following stable releases which have been patched to address the vulnerability:

5.3.5.96

5.3.6.68

5.3.7.47

(Note: JavaMail has been updated to 1.6.2 as this was preventing many people from updating.)

We do not have an installer for 5.3.7 yet and we do not have one for these updates either, so you will need to either update via your (locked down) Lucee Server Admin, or simply drop the relevant Lucee.jar (ie. download <https://cdn.lucee.org/lucee-5.3.7.47.jar> from <https://download.lucee.org/> under Release) into your \tomcat\lucee-server\deploy directory to auto update.

5 Likes

[pfreitag](https://dev.lucee.org/u/pfreitag)

November 23, 2020, 4:58pm

3

Thanks for publishing the advisory Joy! I’ve updated the [HackMyCF](https://hackmycf.com/) service to alert customers for the vulnerable versions of Lucee, though it would have already been warning them if their Lucee admin was public.

I realize that Lucee 4.5 is no longer supported so there won’t be an update, but for the purposes of anyone who might still be using it, do you know if that version is also vulnerable?

Thank You!

Pete Freitag

[Foundeo Inc.](https://foundeo.com/)

3 Likes

[Zackster](https://dev.lucee.org/u/Zackster)

November 23, 2020, 5:15pm

4

I don’t believe Lucee 4.5 is affected.

But as usual, if the admin isn’t locked down, **it should be considered vulnerable unless it’s locked down**.

Anyone locking down access to the admin should make sure their webserver restrictions apply to every site, not just for configured sites, **i.e. not just per virtualhost.**

There is also an environment variable, `LUCEE_ADMIN_ENABLED=false` which disables access to the admin altogether, which was added in 5.3.3.45 (it does require the Lucee to be restarted to pick up any changes to this environment variable)

4 Likes

[Zackster](https://dev.lucee.org/u/Zackster)

December 7, 2020, 11:00am

5

here’s a nice upgrade success story

[web.archive.org](https://web.archive.org/web/20221206015745/http%3A//ciacfug.org/blog/updating-lucee-as-part-of-a-vulnerability-alert-response)

### [Updating Lucee as Part of a Vulnerability Alert Response - Painless as...](https://web.archive.org/web/20221206015745/http%3A//ciacfug.org/blog/updating-lucee-as-part-of-a-vulnerability-alert-response)

While I mainly use Adobe ColdFusion, I do maintain several Lucee installs - most of which are running on auto-pilot and/or hosted/configured/maintained by th

[David\_R](https://dev.lucee.org/u/David_R)

December 9, 2020, 11:23pm

6

Thanks a lot, we have updated all installation and made tomcat optimization.

[Zackster](https://dev.lucee.org/u/Zackster)

January 15, 2021, 6:09pm

7

Here is the story about the vulnerability

![](https://dev.lucee.org/uploads/default/original/2X/1/1b7628cc5c821f23796c1468596813fca817b025.ico)
[The Daily Swig | Cybersecurity news and views – 15 Jan 21](https://portswigger.net/daily-swig/security-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal "04:40PM - 15 January 2021")

![](https://dev.lucee.org/uploads/default/original/2X/a/a18750772a191be98b5013506c87992406f56da1.jpeg)
### [Security researchers earn $50k after exposing critical flaw in Apple travel...](https://portswigger.net/daily-swig/security-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)

Chained exploit leads to shell access

1 Like

[Zackster](https://dev.lucee.org/u/Zackster)

February 9, 2021, 12:27pm

8

Here is the CVE-2021-21307

![](https://dev.lucee.org/uploads/default/original/2X/b/bad3e5f9ad67c1ddf145107ce7032ac1d7b22563.svg)
[GitHub](https://github.com/lucee/Lucee/security/advisories/GHSA-2xvv-723c-8p7r)

![](https://dev.lucee.org/uploads/default/optimized/2X/2/25f235fcfde2db439f03abef5e88b1489dcb8714_2_690x345.png)
### [Remote Code Exploit in Lucee Admin](https://github.com/lucee/Lucee/security/advisories/GHSA-2xvv-723c-8p7r)

### Impact
An unauthenticated Remote Code Exploit chain (RCE) was found in the Lucee Admin code
https://dev.lucee.org/t/lucee-vulnerability-alert-november-2020/7643
### Patches
Upgrade to the...

2 Likes

[andreas](https://dev.lucee.org/u/andreas)

February 9, 2021, 2:42pm

9

I know this is a litte bit late, but there is a part of the installation video series that show how to lock down the admin for a more visual step by step approach:

Windows Server 2019 and IIS:

[![](https://dev.lucee.org/uploads/default/original/2X/4/46715981df4f14d2fc21594e56999debec23b23f.jpeg "Install Lucee on Windows 2019 Server IIS - Step 5: Block Remote Access To Lucee's Server/Web Admin")](https://www.youtube.com/watch?v=wt4Y6uAPbc0)

Ubuntu 20.04LTS with Apache2:

[![](https://dev.lucee.org/uploads/default/original/2X/2/206f5f0ecb0f694c73ddb1ab5cfe0c1c80131daa.jpeg "Installing Lucee on Ubuntu 20.04 LTS Server Apache - Step 6: Blocking Lucee Admin From Public Access")](https://www.youtube.com/watch?v=Y4zKiOSqFGw)

1 Like

[andreas](https://dev.lucee.org/u/andreas)

August 20, 2021, 5:09pm

10

To all who still haven’t updated their Lucee version or closed the public internet access to their Lucee administrators, now it’s really time to get it done. Exploit code has been submited for Metasploit a few days ago. Please see [Lucee Administrator imgProcess.cfm Arbitrary File Write ≈ Packet Storm](https://packetstormsecurity.com/files/163864/lucee_admin_imgprocess_file_write.rb.txt)

1 Like

[LionelHolt](https://dev.lucee.org/u/LionelHolt)

July 1, 2022, 5:43pm

11

Here’s an update for Apache 2.4:

```
<Location "/lucee/">
  Require ip 127.0.0.1
</Location>

```

cPanel root users can apply this globally via:

WHM > Service Configuration > Apache Configuration > Include Editor > Post VirtualHost Include

1 Like

[JFreeman](https://dev.lucee.org/u/JFreeman)

April 27, 2023, 5:51pm

13

Just FYI, this old [ciacfug.org](http://ciacfug.org) link has been taken over by spyware/adware site ![:frowning:](https://dev.lucee.org/images/emoji/twitter/frowning.png?v=12 ":frowning:")

1 Like

[Zackster](https://dev.lucee.org/u/Zackster)

April 27, 2023, 5:59pm

14

thanks, updated the link to [Updating Lucee as Part of a Vulnerability Alert Response - Painless as Promised, or ???](https://web.archive.org/web/20221206015745/http%3A//ciacfug.org/blog/updating-lucee-as-part-of-a-vulnerability-alert-response)

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from github.com_94359c4e_20250115_092436.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flucee%2FLucee%2Fsecurity%2Fadvisories%2FGHSA-2xvv-723c-8p7r)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flucee%2FLucee%2Fsecurity%2Fadvisories%2FGHSA-2xvv-723c-8p7r)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=lucee%2FLucee)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lucee](/lucee)
/
**[Lucee](/lucee/Lucee)**
Public

* [Notifications](/login?return_to=%2Flucee%2FLucee) You must be signed in to change notification settings
* [Fork
  183](/login?return_to=%2Flucee%2FLucee)
* [Star
   868](/login?return_to=%2Flucee%2FLucee)

* [Code](/lucee/Lucee)
* [Pull requests
  52](/lucee/Lucee/pulls)
* [Actions](/lucee/Lucee/actions)
* [Projects
  0](/lucee/Lucee/projects)
* [Wiki](/lucee/Lucee/wiki)
* [Security](/lucee/Lucee/security)
* [Insights](/lucee/Lucee/pulse)

Additional navigation options

* [Code](/lucee/Lucee)
* [Pull requests](/lucee/Lucee/pulls)
* [Actions](/lucee/Lucee/actions)
* [Projects](/lucee/Lucee/projects)
* [Wiki](/lucee/Lucee/wiki)
* [Security](/lucee/Lucee/security)
* [Insights](/lucee/Lucee/pulse)

# Remote Code Exploit in Lucee Admin

Critical

[zspitzer](/zspitzer)
published
GHSA-2xvv-723c-8p7r
Feb 9, 2021

## Package

Lucee Admin

## Affected versions

< 5.3.7.47

## Patched versions

5.3.5.96, 5.3.6.68, 5.3.7.47

## Description

### Impact

An unauthenticated Remote Code Exploit chain (RCE) was found in the Lucee Admin code

<https://dev.lucee.org/t/lucee-vulnerability-alert-november-2020/7643>

### Patches

Upgrade to the latest stable releases 5.3.7.47, 5.3.6.68 or 5.3.5.96

This can be down via the Lucee Server Admin, under Services - > Updates

<https://download.lucee.org/>

### Workarounds

Block access to the Lucee Administrator as recommended

<https://docs.lucee.org/guides/deploying-lucee-server-apps/securing-lucee-server-apps/lucee-lockdown-guide.html>

### References

<https://github.com/httpvoid/writeups/blob/main/Apple-RCE.md>

<https://portswigger.net/daily-swig/security-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal>

### For more information

If you have any questions or comments about this advisory:

* Follow up on the mailing list <https://dev.lucee.org/t/lucee-vulnerability-alert-november-2020/7643>
* Email us at security@lucee.org

### Severity

Critical

### CVE ID

CVE-2021-21307

### Weaknesses

No CWEs

### Credits

* [![@rootxharsh](https://avatars.githubusercontent.com/u/21000421?s=40&v=4)](/rootxharsh)
  [rootxharsh](/rootxharsh)
  Analyst
* [![@iamnoooob](https://avatars.githubusercontent.com/u/31939327?s=40&v=4)](/iamnoooob)
  [iamnoooob](/iamnoooob)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from portswigger.net_f630ccbd_20250115_092438.html ===


[![The Daily Swig](/content/images/banners/the-daily-swig-logo.svg)](/daily-swig)

Latest threats

Bug bounty

For devs

Deep dives

More

[About](https://portswigger.net/daily-swig/about)
[Web security vulnerabilities](https://portswigger.net/daily-swig/vulnerabilities)
[Network security vulnerabilities](https://portswigger.net/daily-swig/network-security)
[Cloud security](https://portswigger.net/daily-swig/cloud-security)
[Zero-day news](https://portswigger.net/daily-swig/zero-day)
[Supply chain attacks](https://portswigger.net/daily-swig/supply-chain-attacks)

[View all web security news](https://portswigger.net/daily-swig/vulnerabilities)

[**Prototype pollution**

Prototype pollution project yields another Parse Server RCE

![Prototype-pollution](/daily-swig-mega-nav/images/latestthreats.png)](https://portswigger.net/daily-swig/prototype-pollution-project-yields-another-parse-server-rce)

[Bug bounty news](https://portswigger.net/daily-swig/bug-bounty)
[VDPs](https://portswigger.net/daily-swig/vdp)
[Bug Bounty Radar](https://portswigger.net/daily-swig/bug-bounty-radar)

[View all bug bounty news](https://portswigger.net/daily-swig/bug-bounty)

[**Bug Bounty Radar**

The latest programs for February 2023

![Bug bounties](/daily-swig-mega-nav/images/bug-bounties.png)](https://portswigger.net/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-february-2023)

[DevSecOps](https://portswigger.net/daily-swig/devsecops)
[Security best practices](https://portswigger.net/daily-swig/security-best-practices)
[Dev stack tech](https://portswigger.net/daily-swig/dev-stack-tech)

[View all dev related news](https://portswigger.net/daily-swig/devsecops)

[**All Day DevOps**

AppSec engineer keynote says Log4j revealed lessons were not learned from the Equifax breach

![DevOps](/daily-swig-mega-nav/images/devsecops.png)](https://portswigger.net/daily-swig/all-day-devops-third-of-log4j-downloads-still-pull-vulnerable-version-despite-threat-of-supply-chain-attacks)

[Deep dives](https://portswigger.net/daily-swig/deep-dives)
[Interviews](https://portswigger.net/daily-swig/interviews)

[View all of the latest features](https://portswigger.net/daily-swig/deep-dives)

[**Infosec beginner?**

A rough guide to launching a career in cybersecurity

![cyber-career](/daily-swig-mega-nav/images/deepdives.png)](https://portswigger.net/daily-swig/a-rough-guide-to-launching-a-career-in-cybersecurity)

[Industry news](https://portswigger.net/daily-swig/industry-news)
[Enterprise security news](https://portswigger.net/daily-swig/enterprise)
[Web hacking tools](https://portswigger.net/daily-swig/hacking-tools)
[Events](https://portswigger.net/daily-swig/events)

[View all infosec industry news](https://portswigger.net/daily-swig/industry-news)

[**Cybersecurity conferences**

A schedule of events in 2022 and beyond

![More topics](/daily-swig-mega-nav/images/more-topics.jpg)](https://portswigger.net/daily-swig/cybersecurity-conferences-a-rundown-of-online-in-person-and-hybrid-events)

# Security researchers earn $50k after exposing critical flaw in Apple travel portal

[John Leyden](/daily-swig/by/john-leyden)
15 January 2021 at 16:40 UTC

Updated: 30 June 2021 at 16:16 UTC

[Bug Bounty](/daily-swig/bug-bounty)
[Apple](/daily-swig/apple)
[Research](/daily-swig/research)

[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal&text=Security+researchers+earn+%2450k+after+exposing+critical+flaw+in+Apple+travel+portal+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
Email

Chained exploit leads to shell access

![Security researchers earned $50k after exposing critical flaw in Apple travel portal](/cms/images/66/42/f956-article-211015-apple-body-text.jpg "Rifky naufaldy / Shutterstock / PortSwigger Ltd")

Security researchers have earned a $50,000 [bug bounty](https://portswigger.net/daily-swig/bug-bounty) after uncovering a critical flaw in Apple’s travel portal.

Rahul Maini and Harsh Jaiswal were able to achieve remote code execution (RCE) by stringing together a string of [vulnerabilities](https://portswigger.net/daily-swig/vulnerabilities) in order to exploit targeted domains.

The bug hunting exercise was inspired by [earlier work by Sam Curry and his associates](https://portswigger.net/daily-swig/researchers-discover-scores-of-security-bugs-in-apples-stem-and-core) that uncovered no fewer than 55 vulnerabilities in Apple’s web infrastructure, earning a cumulative bug bounty of $288,000.

Curry is continuing his work and this week went public with [vulnerabilities in Apple’s domain](https://twitter.com/samwcyo/status/1350025970615529473) that created a means to get billing data from any Apple user.

### Lucee in the sky with exploits

In a detailed [technical write-up](https://github.com/httpvoid/writeups/blob/main/Apple-RCE.md), Maini and Jaiswal explain how the early stage of their bug hunt narrowed their range of targets down to three hosts running on a content management system (CMS) which was back-ended by Lucee, a Java-based tag and scripting language used for web app development.

“We opted to focus on Lucee as it exposed an admin panel and had [a] history of vulnerabilities,” the researchers explain.

READ MORE [Introducing Malvuln.com – the first website dedicated to revealing vulnerabilities in malware](https://portswigger.net/daily-swig/introducing-malvuln-com-the-first-website-exclusively-dedicated-to-revealing-security-vulnerabilities-in-malware)

Lucee’s admin panel was accessible on three different hosts on [Apple](https://portswigger.net/daily-swig/apple), two of which were running an outdated version of the software.

Further investigation by the researchers uncovered Lucee misconfiguration issues that would have allowed an [attacker](https://portswigger.net/daily-swig/cyber-attacks) to access authenticated ColdFusion (CFM) files directly, clearing the way for a skilled hacker to carry out admin actions without being authenticated.

### WAF bypass

Initial attempts to exploit this find were blocked by Apple’s web application firewall (WAF).

But via imgProces.cfm and admin.search.index.cfm functions the researchers were able to overcome this obstacle and achieve RCE on the facilities.apple.com domain.

This attack worked without tripping up the WAF because it could be carried out without attempting a [path traversal](/web-security/file-path-traversal) or other blocked action.

The problematic imgProcess.cfm function was not available on the outdated versions of Lucee present on two travel-related Apple domains.

[Read more of the latest hacking news](https://portswigger.net/daily-swig/hacking-news)

The researchers overcame this hurdle by putting together an exploit based on .lex extensions, which had useful properties in the context of Lucee server exploitation.

“A .lex file is actually nothing but an archive or a zip file with [the] '.lex' extension which is actually a format of Lucee’s extensions which we could upload,” the researchers explained. “Also, there’s no check on the contents, so we can set it to anything.”

“From playing around [with] Lucee, we knew that it allows using protocol/schemes like zip://, file:// etc. (which we utilized in this exploit chain) so we could specify these schemes wherever a FileSystem function had our fully controlled input (luceeArchiveZipPath in this case).”

### Poppin’ shells

By chaining together these various issues it was possible to upload exploit code onto the vulnerable systems and achieve shell access.

The researchers conclude: “Apple promptly fixed the issue but requested us to not disclose the issue before they make some other changes.”

The developers behind Lucee have also acted to address vulnerabilities in their technology.

“[The] Lucee team has also [fixed the bug](https://github.com/lucee/Lucee/commit/6208ab7c44c61d26c79e0b0af10382899f57e1ca) by restricting access to CFM files directly,” the researchers add.

The Daily Swig approached Maini and Jaiswal for comment on their Apple bug hunting project. We’ve not had any word back as yet, but we’ll update this story as and when more information comes to hand.

YOU MIGHT ALSO LIKE [Cisco fixes clutch of high-impact bugs in latest patch cycle](https://portswigger.net/daily-swig/cisco-fixes-clutch-of-high-impact-bugs-in-latest-patch-cycle)

[Bug Bounty](/daily-swig/bug-bounty)
[Apple](/daily-swig/apple)
[Research](/daily-swig/research)
[WAF](/daily-swig/waf)
[Vulnerabilities](/daily-swig/vulnerabilities)
[RCE](/daily-swig/rce)
[Authentication](/daily-swig/authentication)
[Hacking News](/daily-swig/hacking-news)
[Hacking Techniques](/daily-swig/hacking-techniques)

![John Leyden](/cms/profiles/john-leyden.png)
[Twitter](https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal&text=Security+researchers+earn+%2450k+after+exposing+critical+flaw+in+Apple+travel+portal+%7c+The+Daily+Swig%0A)
[WhatsApp](https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[Reddit](https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
[LinkedIn](https://www.linkedin.com/sharing/share-offsite?url=https%3a%2f%2fportswigger.net%2fdaily-swig%2fsecurity-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal)
Email

This page requires JavaScript for an enhanced user experience.

Latest Posts
[### We’re going teetotal – It’s goodbye to The Daily Swig

02 March 2023
We’re going teetotal – It’s goodbye to The Daily Swig
PortSwigger today announces that The Daily Swig is closing down](/daily-swig/were-going-teetotal-its-goodbye-to-the-daily-swig)
[### Bug Bounty Radar

The latest bug bounty programs for March 2023
28 February 2023
Bug Bounty Radar
The latest bug bounty programs for March 2023](/daily-swig/bug-bounty-radar-the-latest-bug-bounty-programs-for-march-2023)
[### Indian gov flaws allowed creation of counterfeit driving licenses

28 February 2023
Indian gov flaws allowed creation of counterfeit driving licenses
Armed with personal data fragments, a researcher could also access 185 million citizens’ PII](/daily-swig/indian-transport-ministry-flaws-potentially-allowed-creation-of-counterfeit-driving-licenses)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.


