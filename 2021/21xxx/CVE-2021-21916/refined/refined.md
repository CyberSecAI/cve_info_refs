The provided content describes three SQL injection vulnerabilities in Advantech R-SeeNet application. This entry focuses on CVE-2021-21916.

**Root cause of vulnerability:**
The vulnerability stems from the misuse of prepared statements combined with SQL concatenation. Variables used to build up a SQL query, are initially sanitized but lose that protection when invoked against the database using stored procedures. The `description_filter` parameter is not properly sanitized before being used in a SQL query.

**Weaknesses/vulnerabilities present:**
- SQL injection vulnerability (CWE-89) exists due to insufficient sanitization of the `description_filter` parameter.
- Prepared statements are not used correctly, leading to SQL injection.
- The application uses dynamic SQL queries, making it vulnerable.

**Impact of exploitation:**
- An attacker can execute arbitrary SQL queries, potentially gaining access to sensitive data, modifying data, or disrupting the application's functionality.
- By injecting SQL statements such as `SLEEP(5)`, an attacker can perform timing attacks to infer database schema or confirm a successful injection.

**Attack vectors:**
- The attack vector is through HTTP requests to the `group_list` page with a specially crafted `description_filter` parameter.

**Required attacker capabilities/position:**
- The attacker needs to be authenticated to the application, or they can perform a cross-site request forgery attack.
- The attacker needs to send a crafted HTTP GET request to `/r-seenet/index.php?page=group_list`
- The attacker needs knowledge of the vulnerable parameter (`description_filter`) to inject malicious SQL.