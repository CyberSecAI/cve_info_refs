```
{
  "vulnerability": {
    "root_cause": "The flatpak-portal service passes caller-specified environment variables to non-sandboxed processes, specifically the `flatpak run` command, when launching a new sandbox instance.",
    "weaknesses": [
      "The flatpak portal service was not properly sanitizing environment variables provided by sandboxed applications.",
      "The `flatpak run` command was trusting caller-specified environment variables."
    ],
    "impact": "A malicious or compromised Flatpak app could set environment variables that are trusted by the `flatpak run` command, allowing it to execute arbitrary code outside of the sandbox on the host system.",
    "attack_vectors": "A compromised or malicious Flatpak application exploits the vulnerability through the Flatpak portal D-Bus service by setting environment variables.",
    "required_capabilities": "The attacker needs to have the ability to run code within a flatpak sandbox and use the flatpak portal D-Bus service (org.freedesktop.portal.Flatpak)."
  },
  "additional_details": {
        "fixes": "The vulnerability is fixed by ensuring that the flatpak-portal service does not pass caller-specified environment variables directly to the flatpak run command. This was done by converting environment variables into bwrap arguments and using a memfd or temporary file to hold the environment variables, preventing them from being exposed to other users.  The fixes were implemented in the following commits: 6d1773d, 6e5ae7a, aeb6a7a, cc14010, 8212498, 39a5621, d19f6c3",
        "workaround":"The vulnerability can be mitigated by preventing the flatpak-portal service from starting, however, this will prevent many Flatpak apps from working correctly."
  }
}
```