=== Content from kb.vmware.com_c4592e22_20250115_114647.html ===


search

cancel

Search

### Guidelines for async application of ESXI hot patch on top of latest VCF supported ESXi build

book
#### Article ID: 313831

calendar\_today
#### Updated On:

#### Products

VMware Cloud Foundation

Show More
Show Less

#### Issue/Introduction

This document is created to provide steps to consume ESXi hot patch asynchronously on top of latest VMware Cloud Foundation (VCF) supported ESXi build.

**Note:**

1. This document is applicable for VSAN Ready Nodes only and should not be applied on VCF on VxRail.
2. This document is for the application of  ESXi 6.7 EP 18 hot patch, all examples given below explains the steps for EP 18 ( 6.7.0-17499825) consumption on top of ESXi 6.7.0-17167734 (released with VCF 3.10.1.2) and should not be used to apply any other patch.

#### Environment

VMware Cloud Foundation 3.10.x

#### Resolution

**Steps to apply ESXi hot patch**
The hot patch can be applied on ESXi hosts using VMware Update Manager (VUM) from vCenter.

The following documentation provides guidelines for updating ESXi hosts using VMware Update Manager: <https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.update_manager.doc/GUID-9E9D146E-40BB-4BB5-8FC6-C9CD735C0F11.html> .

Proceed to the next section only after all hosts required to be patched are updated.

**Steps to update VCF inventory**
The VCF inventory has to be updated for every host on which the hot patch is applied via VUM as an asynchronous update of ESXi host will not update the host version in VCF inventory.

1. To update inventory, first capture the host id of each host on which patch was applied and version of ESXi patch used for update. To get host details from VCF inventory, login to SDDC Manager via SSH and run following command.

curl localhost/inventory/hosts | json\_pp

**Note**: This returns list of all hosts. The field "id" in each host entry, corresponds to host id.

2. From the output, ensure to also note the version for each of the hosts.
3. Update the VCF inventory for each host on which patch was applied using following command

curl -X PATCH 'localhost/inventory/entities/<HOST\_ID> -d '{"version":"<ESXI\_PATCH\_VERSION>", "type":"ESXI"}' -H 'Content-Type:application/json'

<HOST\_ID>  Id of host for which version is to be updated in VCF inventory
<ESXI\_PATCH\_VERSION>  Version of ESXi patch that was applied on hostsExample:
<HOST\_ID> - 65f5f921-768b-4043-8d4e-31b654c7fde4
<ESXI\_PATCH\_VERSION> - 6.7.0-17499825

curl -X PATCH 'localhost/inventory/entities/65f5f921-768b-4043-8d4e-31b654c7fde4' -d '{"version":"6.7.0-17499825", "type":"ESXI"}' -H 'Content-Type:application/json'

**Update Version Alias configuration**

4. To update the version aliases execute the below command.

curl -k 'localhost/v1/system/settings/version-aliases/ESX\_HOST/<Base version of ESXI host>' -X PUT -H
'Content-Type: application/json' -H 'Accept: application/json' -d
'{"aliases" : [ "<Applied ESXI hot patch version>" ], "forceUpdate" : true}

<Base version of ESXI host> ESXI host version of latest release on which hot patch was installed.
<Applied ESXI hot patch version> The ESXI host version after successfully applying the hot patch.

Example:
<Base version of ESXI host> - 6.7.0-17167734
<Applied ESXI hot patch version> - 6.7.0-17499825

curl -k 'http://localhost/v1/system/settings/version-aliases/ESX\_HOST/6.7.0-17167734' -X
PUT -H 'Content-Type: application/json' -H 'Accept: application/json' -d '{"aliases" : ["6.7.0-17499825" ], "forceUpdate" : true }'

#### Feedback

thumb\_up
Yes

thumb\_down
No

Powered by
[![Wolken Software](https://cdn.wolkenservicedesk.com/wolken-footer-image.png)](https://www.wolkensoftware.com/)



=== Content from www.vmware.com_532c5c61_20250114_193311.html ===


Menu

* [Products](https://www.broadcom.com/products/)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/company/about-us/)
* [How To Buy](https://www.broadcom.com/how-to-buy/#sales)

* Log in

  [Log In](/c/portal/login)
  [Register](https://profile.broadcom.com/web/registration)

[Register](https://profile.broadcom.com/web/registration)
[Login](/c/portal/login)

VMSA-2021-0002:VMware ESXi and vCenter Server updates address multiple security vulnerabilities

Product/Component

VMware Cloud Foundation

2 more products

List of Products

3 Products

* VMware Cloud Foundation
* VMware vCenter Server
* VMware vSphere ESXi

Notification Id

23599

Last Updated

21 February 2021

Initial Publication Date

21 February 2021

Status

CLOSED

Severity

CRITICAL

CVSS Base Score

5.3-9.8

WorkAround

Affected CVE

CVE-2021-21972,CVE-2021-21973,CVE-2021-21974

             Advisory ID: VMSA-2021-0002   CVSSv3 Range: 5.3-9.8   Issue Date:2021-02-23   Updated On: 2021-02-23 (Initial Advisory)   CVE(s): CVE-2021-21972, CVE-2021-21973, CVE-2021-21974   Synopsis: VMware ESXi and vCenter Server updates address multiple security vulnerabilities (CVE-2021-21972, CVE-2021-21973, CVE-2021-21974)

 [RSS Feed](https://www.vmware.com/security/advisories/VMSA-2021-0002.xml)

 Download PDF

 Download Text File

Share this page on social media:

##### **1. Impacted Products**

* VMware ESXi
* VMware vCenter Server (vCenter Server)
* VMware Cloud Foundation (Cloud Foundation)

##### **2. Introduction**

Multiple vulnerabilities in VMware ESXi and vSphere Client (HTML5) were privately reported to VMware. Updates are available to remediate these vulnerabilities in affected VMware products.

##### **3a. VMware vCenter Server updates address remote code execution vulnerability in the vSphere Client (CVE-2021-21972)**

**Description**

The vSphere Client (HTML5) contains a remote code execution vulnerability in a vCenter Server plugin. VMware has evaluated the severity of this issue to be in the [Critical severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

**Known Attack Vectors**

A malicious actor with network access to port 443 may exploit this issue to execute commands with unrestricted privileges on the underlying operating system that hosts vCenter Server.

**Resolution**

To remediate CVE-2021-21972 apply the updates listed in the 'Fixed Version' column of the 'Response Matrix' below to affected deployments.

**Workarounds**

Workarounds for CVE-2021-21972 have been listed in the 'Workarounds' column of the 'Response Matrix' below.

**Additional Documentation**

None.

**Notes**

The affected vCenter Server plugin for vROPs is available in all default installations. vROPs does not need be present to have this endpoint available. Follow the workarounds KB to disable it.

**Acknowledgements**

VMware would like to thank Mikhail Klyuchnikov of Positive Technologies for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| vCenter Server | 7.0 | Any | CVE-2021-21972 | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | critical | [7.0 U1c](https://docs.vmware.com/en/VMware-vSphere/7.0/rn/vsphere-vcenter-server-70u1c-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| vCenter Server | 6.7 | Any | CVE-2021-21972 | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | critical | [6.7 U3l](https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-vcenter-server-67u3l-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| vCenter Server | 6.5 | Any | CVE-2021-21972 | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | critical | [6.5 U3n](https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u3n-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |

**Impacted Product Suites that Deploy Response Matrix 3a Components:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Cloud Foundation (vCenter Server) | 4.x | Any | CVE-2021-21972 | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | critical | 4.2 | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| Cloud Foundation (vCenter Server) | 3.x | Any | CVE-2021-21972 | [9.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | critical | 3.10.1.2 | [KB82374](https://kb.vmware.com/s/article/82374) | None |

##### **3b. ESXi OpenSLP heap-overflow vulnerability (CVE-2021-21974)**

**Description**

OpenSLP as used in ESXi has a heap-overflow vulnerability. VMware has evaluated the severity of this issue to be in the [Important severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

**Known Attack Vectors**

A malicious actor residing within the same network segment as ESXi who has access to port 427 may be able to trigger the heap-overflow issue in OpenSLP service resulting in remote code execution.

**Resolution**

To remediate CVE-2021-21974 apply the updates listed in the 'Fixed Version' column of the 'Response Matrix' below to affected deployments.

**Workarounds**

Workarounds for CVE-2021-21974 have been listed in the 'Workarounds' column of the 'Response Matrix' below.

**Additional Documentation**

None.

**Notes**

[1] Per the Security Configuration Guides for VMware vSphere, VMware now recommends disabling the OpenSLP service in ESXi if it is not used. For more information, see our blog posting: <https://blogs.vmware.com/vsphere/2021/02/evolving-the-vmware-vsphere-security-configuration-guides.html>

[2] [KB82705](https://kb.vmware.com/s/article/82705) documents steps to consume ESXi hot patch asynchronously on top of latest VMware Cloud Foundation (VCF) supported ESXi build.

**Acknowledgements**

VMware would like to thank Lucas Leong (@\_wmliang\_) of Trend Micro's Zero Day Initiative for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1] ESXi | 7.0 | Any | CVE-2021-21974 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | important | ESXi70U1c-17325551 | [KB76372](https://kb.vmware.com/s/article/76372) | None |
| [1] ESXi | 6.7 | Any | CVE-2021-21974 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | important | ESXi670-202102401-SG | [KB76372](https://kb.vmware.com/s/article/76372) | None |
| [1] ESXi | 6.5 | Any | CVE-2021-21974 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | important | ESXi650-202102101-SG | [KB76372](https://kb.vmware.com/s/article/76372) | None |

**Impacted Product Suites that Deploy Response Matrix 3b Components:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1] Cloud Foundation (ESXi) | 4.x | Any | CVE-2021-21974 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | important | 4.2 | [KB76372](https://kb.vmware.com/s/article/76372) | None |
| [1] Cloud Foundation (ESXi) | 3.x | Any | CVE-2021-21974 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | important | [[2] KB82705](https://kb.vmware.com/s/article/82705) | [KB76372](https://kb.vmware.com/s/article/76372) | None |

##### **3c. VMware vCenter Server updates address SSRF vulnerability in the vSphere Client (CVE-2021-21973)**

**Description**

The vSphere Client (HTML5) contains an SSRF (Server Side Request Forgery) vulnerability due to improper validation of URLs in a vCenter Server plugin. VMware has evaluated the severity of this issue to be in the [Moderate severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N).

**Known Attack Vectors**

A malicious actor with network access to port 443 may exploit this issue by sending a POST request to vCenter Server plugin leading to information disclosure.

**Resolution**

To remediate CVE-2021-21973 apply the updates listed in the 'Fixed Version' column of the 'Response Matrix' below to affected deployments.

**Workarounds**

Workarounds for CVE-2021-21973 have been listed in the 'Workarounds' column of the 'Response Matrix' below.

**Additional Documentation**

None.

**Notes**

The affected vCenter Server plugin for vROPs is available in all default installations. vROPs does not need be present to have this endpoint available. Follow the workarounds KB to disable it.

**Acknowledgements**

VMware would like to thank Mikhail Klyuchnikov of Positive Technologies for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| vCenter Server | 7.0 | Any | CVE-2021-21973 | [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | moderate | [7.0 U1c](https://docs.vmware.com/en/VMware-vSphere/7.0/rn/vsphere-vcenter-server-70u1c-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| vCenter Server | 6.7 | Any | CVE-2021-21973 | [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | moderate | [6.7 U3l](https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-vcenter-server-67u3l-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| vCenter Server | 6.5 | Any | CVE-2021-21973 | [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | moderate | [6.5 U3n](https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u3n-release-notes.html) | [KB82374](https://kb.vmware.com/s/article/82374) | None |

**Impacted Product Suites that Deploy Response Matrix 3c Components:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Cloud Foundation (vCenter Server) | 4.x | Any | CVE-2021-21973 | [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | moderate | 4.2 | [KB82374](https://kb.vmware.com/s/article/82374) | None |
| Cloud Foundation (vCenter Server) | 3.x | Any | CVE-2021-21973 | [5.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | moderate | 3.10.1.2 | [KB82374](https://kb.vmware.com/s/article/82374) | None |

##### **4. References**

**VMware ESXi 7.0 ESXi70U1c-17325551**
<https://my.vmware.com/group/vmware/patch>
<https://docs.vmware.com/en/VMware-vSphere/7.0/rn/vsphere-esxi-70u1c.html>

**VMware ESXi 6.7 ESXi670-202102401-SG**
<https://my.vmware.com/group/vmware/patch>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/esxi670-202102001.html>

**VMware ESXi 6.5 ESXi650-202102101-SG**
<https://my.vmware.com/group/vmware/patch>
<https://docs.vmware.com/en/VMware-vSphere/6.5/rn/esxi650-202102001.html>

**VMware vCloud Foundation 4.2**
Downloads and Documentation:
<https://docs.vmware.com/en/VMware-Cloud-Foundation/4.2/rn/VMware-Cloud-Foundation-42-Release-Notes.html>

**VMware vCloud Foundation 3.10.1.2**
Downloads and Documentation:
<https://docs.vmware.com/en/VMware-Cloud-Foundation/3.10.1/rn/VMware-Cloud-Foundation-3101-Release-Notes.html>

**vCenter Server 7.0.1 Update 1**
Downloads and Documentation:
<https://my.vmware.com/web/vmware/downloads/details?downloadGroup=VC70U1C&productId=974>
<https://docs.vmware.com/en/VMware-vSphere/7.0/rn/vsphere-vcenter-server-70u1c-release-notes.html>

**vCenter Server 6.7 U3l**
Downloads and Documentation:
<https://my.vmware.com/web/vmware/downloads/details?downloadGroup=VC67U3L&productId=742&rPId=57171>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-vcenter-server-67u3l-release-notes.html>

**vCenter Server 6.5 U3n**
Downloads and Documentation:
<https://my.vmware.com/web/vmware/downloads/details?downloadGroup=VC65U3N&productId=614&rPId=60942>
<https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u3n-release-notes.html>

Mitre CVE Dictionary Links:
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21972>
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21973>
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21974>

FIRST CVSSv3 Calculator:
CVE-2021-21972: <https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H>
CVE-2021-21973: <https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N>
CVE-2021-21974: <https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H>

##### **5. Change Log**

**2021-02-23 VMSA-2021-0002**
Initial security advisory.

##### **6. Contact**

E-mail list for product security notifications and announcements:

<https://lists.vmware.com/cgi-bin/mailman/listinfo/security-announce>

This Security Advisory is posted to the following lists:

[[email protected]](/cdn-cgi/l/email-protection#4536202630372c313c68242b2b2a302b262005292c3631366b3328322437206b262a28)

[[email protected]](/cdn-cgi/l/email-protection#4123342635332030013224223433283538272e2234326f222e2c)

[[email protected]](/cdn-cgi/l/email-protection#a0c6d5ccccc4c9d3c3cccfd3d5d2c5e0d3c5c3ccc9d3d4d38ecfd2c7)

E-mail: [[email protected]](/cdn-cgi/l/email-protection#a5d6c0c6d0d7ccd1dce5d3c8d2c4d7c08bc6cac8)

PGP key at:

<https://kb.vmware.com/kb/1055>

VMware Security Advisories

<https://www.vmware.com/security/advisories>

VMware Security Response Policy

<https://www.vmware.com/support/policies/security_response.html>

VMware Lifecycle Support Phases

<https://www.vmware.com/support/policies/lifecycle.html>

VMware Security & Compliance Blog

<https://blogs.vmware.com/security>

Twitter

<https://twitter.com/VMwareSRC>

Copyright 2021 VMware Inc. All rights reserved.

Hidden

#####

×

It appears your Broadcom Products and Services are

supported by one of our certified Support partners

Click below to be redirected to the appropriate Support

Partner Portal to request support

For non-product related issues (Support Portal / Licensing) Click HERE

Continue

#####

×

For **Technical Support** (issues with products or services)

1. Select **Technical** to be redirected to the My Entitlements page
2. Expand the product you require support on
3. Select the case icon from the case column
4. You will be redirected to the appropriate vendor portal where you can raise your technical request

For **Non-Technical Support** (issues with portal access, license keys, software downloads)

1. Select **Non-Technical** to be redirected to Broadcom's case management portal

Technical
Non-Technical

#####

×

# Access Denied

This feature has been disabled by your administrator.

#####

×

To prevent this message from showing again, please enable pop-up blockers for [support.broadcom.com](https://support.broadcom.com/)
or click Continue to proceed.

Continue

Top

* [Products](https://www.broadcom.com/products)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/)
* [How to Buy](https://www.broadcom.com/how-to-buy)

 Copyright © 2005-2024 Broadcom. All Rights Reserved. The term “Broadcom” refers to Broadcom Inc. and/or its subsidiaries.

* [Accessibility](https://www.broadcom.com/company/legal/accessibility)
* [Privacy](https://www.broadcom.com/company/legal/privacy)
* [Supplier Responsibility](https://www.broadcom.com/company/citizenship/supplier-responsibility)
* [Terms of Use](https://www.broadcom.com/company/legal/terms-of-use)
* [Site Map](https://www.broadcom.com/sitemap)



=== Content from packetstormsecurity.com_a54f2999_20250114_193309.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from kb.vmware.com_da692398_20250115_114646.html ===


search

cancel

Search

### How to Disable/Enable the SLP Service on VMware ESXi

book
#### Article ID: 318790

calendar\_today
#### Updated On:

#### Products

VMware vSphere ESXi

Show More
Show Less

#### Issue/Introduction

OpenSLP vulnerabilities have been disclosed that affect ESXi. These vulnerabilities and their impact on VMware products are documented in the following VMware Security Advisories (VMSAs), please review these before continuing as there may be considerations outside the scope of this document:

[VMSA-2022-0030](https://www.vmware.com/security/advisories/VMSA-2022-0030.html) (CVE-2022-31699)
[VMSA-2021-0014](https://www.vmware.com/security/advisories/VMSA-2021-0014.html) (CVE-2021-21995)
[VMSA-2021-0002](https://www.vmware.com/security/advisories/VMSA-2021-0002.html) (CVE-2021-21974)
[VMSA-2020-0023](https://www.vmware.com/security/advisories/VMSA-2020-0023.html) (CVE-2020-3992)
[VMSA-2019-0022](https://www.vmware.com/security/advisories/VMSA-2019-0022.html) (CVE-2019-5544)

The ESXi team has investigated these vulnerabilities and determined that the possibility of exploitation can be removed by performing the steps detailed in the resolution section of this article. This workaround is meant to be a temporary solution only and customers are advised to deploy the patches documented in the aforementioned VMSAs.

**Warning**:

This workaround is applicable ONLY to ESXi. Do not apply this workaround to other VMware products.

**Functionality Impacts:**

With the workaround, CIM clients which uses SLP to find CIM servers over port #427 will not be able to locate the service.

There is no requirement to reboot the ESXi host to disable/enable the service

#### Resolution

To implement the workaround perform the following steps:

       1 Login to the ESXi hosts using an SSH session (such as putty)

2 Stop the SLP service on the ESXi host with this command:

/etc/init.d/slpd stop

**Note**: The SLP service can only be stopped when the service is not in use. Use the following command to view the operational state of Service Location Protocol Daemon:

esxcli system slp stats get

3 Run the following command to disable the SLP service:

esxcli network firewall ruleset set -r CIMSLP -e 0

To make this change persist across reboots:

chkconfig slpd off

To check if the change is applied across reboots:

chkconfig --list | grep slpd

*output: slpd off*

![](https://api-broadcomcms-software.wolkenservicedesk.com/attachment/get_attachment_content?uniqueFileId=1512273899654)

To remove the workaround perform the following steps:

1. Run the following command to enable the ruleset of SLP service:

esxcli network firewall ruleset set -r CIMSLP -e 1

2. Run the following command to change the current startup information of slpd service:

chkconfig slpd on

Run the following command to check if the change is applied after running the above step (Step 2#):

chkconfig --list | grep slpd

*output:*slpd on

3. Run the following command to start the SLP service:

/etc/init.d/slpd start

4. Disable and enable the CIM agent, see [How to disable or enable the CIM agent on the ESX/ESXi host](https://knowledge.broadcom.com/external/article/313877)

Later versions of ESXi report the SLPD service in the vCenter GUI

        1. To check if you can update the SLP service via the vSphere client, login to the vCenter

        2 Select the ESXi host and click on "Configure"  -- "Services". Look for SLP in the list
            If SLP is not listed, then use the process detailed above

![](https://api-broadcomcms-software.wolkenservicedesk.com/attachment/get_attachment_content?uniqueFileId=1512276587924)

        3 Select SLPD and click on "Stop" and then click "Ok"

![](https://api-broadcomcms-software.wolkenservicedesk.com/attachment/get_attachment_content?uniqueFileId=1512273460105)
           4 Select " Edit Startup Policy" and select "Start and stop manually". Click Ok

![](https://api-broadcomcms-software.wolkenservicedesk.com/attachment/get_attachment_content?uniqueFileId=1512276788978)

             5 Reverse the steps above to re-enable the service

#### Additional Information

[VMware Skyline Health Diagnostics for vSphere - FAQ](https://knowledge.broadcom.com/external/article/345059)

#### Feedback

thumb\_up
Yes

thumb\_down
No

Powered by
[![Wolken Software](https://cdn.wolkenservicedesk.com/wolken-footer-image.png)](https://www.wolkensoftware.com/)



=== Content from www.zerodayinitiative.com_c15b2d6f_20250114_193313.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

February 24th, 2021
## VMware ESXi SLP Heap-based Buffer Overflow Remote Code Execution Vulnerability

### ZDI-21-250ZDI-CAN-12232

| CVE ID | [CVE-2021-21974](https://www.cve.org/CVERecord?id=CVE-2021-21974) |
| --- | --- |
| CVSS SCORE | 8.8, [AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| AFFECTED VENDORS | [VMware](https://www.vmware.com) |
| AFFECTED PRODUCTS | ESXi |
| VULNERABILITY DETAILS | This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of VMware ESXi. Authentication is not required to exploit this vulnerability.  The specific flaw exists within the processing of SLP messages. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a heap-based buffer. An attacker can leverage this vulnerability to execute code in the context of the SLP daemon. |
| ADDITIONAL DETAILS | VMware has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2020-10-30 - Vulnerability reported to vendor * 2021-02-24 - Coordinated public release of advisory |
| CREDIT | Lucas Leong (@\_wmliang\_) of Trend Micro's Zero Day Initiative |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)


