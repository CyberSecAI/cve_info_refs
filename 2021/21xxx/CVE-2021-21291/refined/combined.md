=== Content from pkg.go.dev_56647f23_20250114_185333.html ===


[![Go](/static/shared/logo/go-white.svg)](https://go.dev/)
 [Skip to Main Content](#main-content)

![](/static/shared/icon/search_gm_grey_24dp.svg)

![](/static/shared/icon/search_gm_grey_24dp.svg)

* Why Go
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Case Studies](https://go.dev/solutions#case-studies)

    Common problems companies solve with Go
  + [Use Cases](https://go.dev/solutions#use-cases)

    Stories about how and why companies use Go
  + [Security Policy](https://go.dev/security/policy/)

    How Go can help keep you secure by default
* [Learn](https://go.dev/learn/)
* Docs
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Effective Go](https://go.dev/doc/effective_go)

    Tips for writing clear, performant, and idiomatic Go code
  + [Go User Manual](https://go.dev/doc/)

    A complete introduction to building software with Go
  + [Standard library](https://pkg.go.dev/std)

    Reference documentation for Go's standard library
  + [Release Notes](https://go.dev/doc/devel/release)

    Learn what's new in each Go release
* [Packages](/)
* Community
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Recorded Talks](https://go.dev/talks/)

    Videos from prior events
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)

    Meet other local Go developers
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)

    Learn and network with Go developers from around the world
  + [Go blog](https://go.dev/blog)

    The Go project's official blog.
  + [Go project](https://go.dev/help)

    Get help and stay informed from Go
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts "Get connected with google-groups (Opens in new window)")
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang "Get connected with github (Opens in new window)")
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang "Get connected with twitter (Opens in new window)")
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/ "Get connected with reddit (Opens in new window)")
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/ "Get connected with slack (Opens in new window)")
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

[![Go.](/static/shared/logo/go-blue.svg)](https://go.dev/)

* Why Go
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Why Go
  + [Case Studies](https://go.dev/solutions#case-studies)
  + [Use Cases](https://go.dev/solutions#use-cases)
  + [Security Policy](https://go.dev/security/policy/)
* [Learn](https://go.dev/learn/)
* Docs
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Docs
  + [Effective Go](https://go.dev/doc/effective_go)
  + [Go User Manual](https://go.dev/doc/)
  + [Standard library](https://pkg.go.dev/std)
  + [Release Notes](https://go.dev/doc/devel/release)
* [Packages](/)
* Community
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Community
  + [Recorded Talks](https://go.dev/talks/)
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)
  + [Go blog](https://go.dev/blog)
  + [Go project](https://go.dev/help)
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts)
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang)
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang)
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/)
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/)
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

1. [Discover Packages](/)
2. [github.com/oauth2-proxy/oauth2-proxy/v7](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0)
   ![](/static/shared/icon/content_copy_gm_grey_24dp.svg)

[![Go](/static/shared/logo/go-blue.svg)](https://go.dev/)
# oauth2-proxy

command
module
![](/static/shared/icon/content_copy_gm_grey_24dp.svg)

[Version:
v7.8.0](?tab=versions)
Opens a new window with list of versions in this module.

Latest
Latest
![Warning](/static/shared/icon/alert_gm_grey_24dp.svg)

This package is not in the latest version of its module.

[Go to latest](/github.com/oauth2-proxy/oauth2-proxy/v7)

Published: Jan 14, 2025

License: [MIT](/github.com/oauth2-proxy/oauth2-proxy/v7?tab=licenses)

Opens a new window with license information.

[Imports: 45](/github.com/oauth2-proxy/oauth2-proxy/v7?tab=imports)

Opens a new window with list of imports.

[Imported by: 1](/github.com/oauth2-proxy/oauth2-proxy/v7?tab=importedby)

Opens a new window with list of known importers.

Main
Versions

Licenses

Imports

Imported By

## Details

* ![checked](/static/shared/icon/check_circle_gm_grey_24dp.svg)
  Valid [go.mod](https://github.com/oauth2-proxy/oauth2-proxy/tree/v7.8.0/go.mod) file
  ![](/static/shared/icon/help_gm_grey_24dp.svg)

  The Go module system was introduced in Go 1.11 and is the official dependency management
  solution for Go.
* ![checked](/static/shared/icon/check_circle_gm_grey_24dp.svg)
  Redistributable license
  ![](/static/shared/icon/help_gm_grey_24dp.svg)

  Redistributable licenses place minimal restrictions on how software can be used,
  modified, and redistributed.
* ![checked](/static/shared/icon/check_circle_gm_grey_24dp.svg)
  Tagged version
  ![](/static/shared/icon/help_gm_grey_24dp.svg)

  Modules with tagged versions give importers more predictable builds.
* ![checked](/static/shared/icon/check_circle_gm_grey_24dp.svg)
  Stable version
  ![](/static/shared/icon/help_gm_grey_24dp.svg)

  When a project reaches major version v1 it is considered stable.
* [Learn more about best practices](/about#best-practices)

## Repository

[github.com/oauth2-proxy/oauth2-proxy](https://github.com/oauth2-proxy/oauth2-proxy "https://github.com/oauth2-proxy/oauth2-proxy")

Jump to ...

* [README](#section-readme)
  + [Get Started](#readme-get-started)
  + [Releases](#readme-releases)
    - [Binaries](#readme-binaries)
    - [Images](#readme-images)
  + [Sponsors](#readme-sponsors)
  + [Getting Involved](#readme-getting-involved)
  + [Security](#readme-security)
    - [Security Notice for v6.0.0 and older](#readme-security-notice-for-v6-0-0-and-older)
  + [Repository History](#readme-repository-history)
  + [License](#readme-license)
* [Documentation](#section-documentation)
* [Source Files](#section-sourcefiles)
* [Directories](#section-directories)

README

## README [Â¶](#section-readme "Go to Readme")

[![Continuous Integration](https://github.com/oauth2-proxy/oauth2-proxy/actions/workflows/ci.yaml/badge.svg)](https://github.com/oauth2-proxy/oauth2-proxy/actions/workflows/ci.yaml)
[![Go Report Card](https://goreportcard.com/badge/github.com/oauth2-proxy/oauth2-proxy)](https://goreportcard.com/report/github.com/oauth2-proxy/oauth2-proxy)
[![GoDoc](https://godoc.org/github.com/oauth2-proxy/oauth2-proxy?status.svg)](https://godoc.org/github.com/oauth2-proxy/oauth2-proxy)
[![MIT licensed](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/LICENSE)
[![Maintainability](https://api.codeclimate.com/v1/badges/a58ff79407212e2beacb/maintainability)](https://codeclimate.com/github/oauth2-proxy/oauth2-proxy/maintainability)
[![Test Coverage](https://api.codeclimate.com/v1/badges/a58ff79407212e2beacb/test_coverage)](https://codeclimate.com/github/oauth2-proxy/oauth2-proxy/test_coverage)

![OAuth2 Proxy](https://github.com/oauth2-proxy/oauth2-proxy/raw/v7.8.0/docs/static/img/logos/OAuth2_Proxy_horizontal.svg)

OAuth2-Proxy is a flexible, open-source tool that can act as either a standalone reverse proxy or a middleware component integrated into existing reverse proxy or load balancer setups. It provides a simple and secure way to protect your web applications with OAuth2 / OIDC authentication. As a reverse proxy, it intercepts requests to your application and redirects users to an OAuth2 provider for authentication. As a middleware, it can be seamlessly integrated into your existing infrastructure to handle authentication for multiple applications.

OAuth2-Proxy supports a lot of OAuth2 as well as OIDC providers. Either through a generic OIDC client or a specific implementation for Google, Microsoft Entra ID, GitHub, login.gov and others. Through specialised provider implementations oauth2-proxy can extract more details about the user like preferred usernames and groups. Those details can then be forwarded as HTTP headers to your upstream applications.

![Simplified Architecture](https://github.com/oauth2-proxy/oauth2-proxy/raw/v7.8.0/docs/static/img/simplified-architecture.svg)

### Get Started

OAuth2-Proxy's [Installation Docs](https://oauth2-proxy.github.io/oauth2-proxy/installation) cover how to install and configure your setup. Additionally you can take a further look at the [example setup files](https://github.com/oauth2-proxy/oauth2-proxy/tree/master/contrib/local-environment).

### Releases

#### Binaries

We publish oauth2-proxy as compiled binaries on GitHub for all major architectures as well as more exotic ones like `ppc64le` as well as `s390x`.

Check out the [latest release](https://github.com/oauth2-proxy/oauth2-proxy/releases/latest).

#### Images

From `v7.6.0` and up the base image has been changed from Alpine to [GoogleContainerTools/distroless](https://github.com/GoogleContainerTools/distroless).
This image comes with even fewer installed dependencies and thus should improve security. The image therefore is also slightly smaller than Alpine.
For debugging purposes (and those who really need it. e.g. `armv6`) we still provide images based on Alpine. The tags of these images are suffixed with `-alpine`.

Since 2023-11-18 we build nightly images directly from the `master` branch and provide them at `quay.io/oauth2-proxy/oauth2-proxy-nightly`.
These images are considered unstable and therefore should **NOT** be used for production purposes unless you know what you're doing.

### Sponsors

![Microsoft](https://upload.wikimedia.org/wikipedia/commons/9/96/Microsoft_logo_%282012%29.svg)

Would you like to sponsor the project then please contact us at sponsors@oauth2-proxy.dev

### Getting Involved

[![Slack](https://img.shields.io/badge/slack-Gopher_%23oauth2--proxy-red?logo=slack)](https://gophers.slack.com/archives/CM2RSS25N)

Join the #oauth2-proxy [Slack channel](https://gophers.slack.com/archives/CM2RSS25N) to chat with other users of oauth2-proxy or reach out to the maintainers directly. Use the [public invite link](https://invite.slack.golangbridge.org/) to get an invite for the Gopher Slack space.

OAuth2-Proxy is a community-driven project. We rely on the contributï¸ions of our users to continually improve it. While review times can vary, we appreciate your patience and understanding. As a volunteer-driven project, we strive to keep this project stable and might take longer to merge changes.

If you want to contribute to the project. Please see our [Contributing](https://oauth2-proxy.github.io/oauth2-proxy/community/contribution) guide.

Who uses OAuth2-Proxy? Have a look at our new [ADOPTERS](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/ADOPTERS.md) file and
feel free to open a PR to add your organisation.

Thanks to all the people who already contributed â¤

[![](https://contrib.rocks/image?repo=oauth2-proxy/oauth2-proxy&columns=15&max=75)](https://github.com/oauth2-proxy/oauth2-proxy/graphs/contributors)

Made with [contrib.rocks](https://contrib.rocks).

### Security

If you believe you have found a vulnerability within OAuth2 Proxy or any of its dependencies, please do **NOT** open an issue or PR on GitHub, please do **NOT** post any details publicly.

Security disclosures **MUST** be done in private. If you have found an issue that you would like to bring to the attention of the maintainers, please compose an email and send it to the list of people listed in our [MAINTAINERS](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/MAINTAINERS) file.

For more details read our full [Security Docs](https://oauth2-proxy.github.io/oauth2-proxy/community/security#security-disclosures)

#### Security Notice for v6.0.0 and older

If you are running a version older than v6.0.0 we **strongly recommend** to the current version.

See [open redirect vulnerability](https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-5m6c-jp6f-2vcv) for details.

### Repository History

**2018-11-27:** This repository was forked from [bitly/OAuth2\_Proxy](https://github.com/bitly/oauth2_proxy). Versions v3.0.0 and up are from this fork and will have diverged from any changes in the original fork. A list of changes can be seen in the [CHANGELOG](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/CHANGELOG.md).

**2020-03-29:** This project was formerly hosted as `pusher/oauth2_proxy` but has been renamed to `oauth2-proxy/oauth2-proxy`. Going forward, all images shall be available at `quay.io/oauth2-proxy/oauth2-proxy` and binaries will be named `oauth2-proxy`.

### License

OAuth2-Proxy is distributed under [The MIT License](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/LICENSE).

Expand â¾
Collapse â´

## Documentation [Â¶](#section-documentation "Go to Documentation")

![The Go Gopher](/static/shared/gopher/airplane-1200x945.svg)

## Source Files [Â¶](#section-sourcefiles "Go to Source Files")

[View all Source files](https://github.com/oauth2-proxy/oauth2-proxy/tree/v7.8.0)

* [main.go](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/main.go "main.go")
* [oauthproxy.go](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/oauthproxy.go "oauthproxy.go")
* [validator.go](https://github.com/oauth2-proxy/oauth2-proxy/blob/v7.8.0/validator.go "validator.go")

## Directories [Â¶](#section-directories "Go to Directories")

Show internal

Expand all

| Path | Synopsis |
| --- | --- |
| pkg |  |
| [apis/ip](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/ip) |  || [apis/middleware](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/middleware) |  || [apis/options](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/options) |  || [apis/options/testutil](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/options/testutil) |  || [apis/options/util](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/options/util) |  || [apis/sessions](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/apis/sessions) |  || [app/pagewriter](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/app/pagewriter) |  || [app/redirect](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/app/redirect) |  || [authentication/basic](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/authentication/basic) |  || [clock](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/clock) |  || [cookies](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/cookies) |  || [encryption](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/encryption) |  || [header](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/header) |  || [http](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/http) |  || [ip](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/ip) |  || [logger](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/logger) |  || [middleware](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/middleware) |  || [providers/oidc](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/providers/oidc) |  || [providers/util](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/providers/util) |  || [requests](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/requests) |  || [requests/util](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/requests/util) |  || [sessions](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/sessions) |  || [sessions/cookie](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/sessions/cookie) |  || [sessions/persistence](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/sessions/persistence) |  || [sessions/redis](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/sessions/redis) |  || [sessions/tests](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/sessions/tests) |  || [upstream](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/upstream) |  || [util](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/util) |  || [validation](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/validation) |  || [version](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/version) |  || [watcher](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/pkg/watcher) |  |
| [providers](/github.com/oauth2-proxy/oauth2-proxy/v7%40v7.8.0/providers) |  |

 Click to show internal directories.
 Click to hide internal directories.

[Why Go](https://go.dev/solutions)
[Use Cases](https://go.dev/solutions#use-cases)
[Case Studies](https://go.dev/solutions#case-studies)

[Get Started](https://learn.go.dev/)
[Playground](https://play.golang.org)
[Tour](https://tour.golang.org)
[Stack Overflow](https://stackoverflow.com/questions/tagged/go?tab=Newest)
[Help](https://go.dev/help)

[Packages](https://pkg.go.dev)
[Standard Library](/std)
[Sub-repositories](/golang.org/x)
[About Go Packages](https://pkg.go.dev/about)

[About](https://go.dev/project)
[Download](https://go.dev/dl/)
[Blog](https://go.dev/blog)
[Issue Tracker](https://github.com/golang/go/issues)
[Release Notes](https://go.dev/doc/devel/release.html)
[Brand Guidelines](https://blog.golang.org/go-brand)
[Code of Conduct](https://go.dev/conduct)

[Connect](https://www.twitter.com/golang)
[Twitter](https://www.twitter.com/golang)
[GitHub](https://github.com/golang)
[Slack](https://invite.slack.golangbridge.org/)
[r/golang](https://reddit.com/r/golang)
[Meetup](https://www.meetup.com/pro/go)
[Golang Weekly](https://golangweekly.com/)

![Gopher in flight goggles](/static/shared/gopher/pilot-bust-1431x901.svg)

* [Copyright](https://go.dev/copyright)
* [Terms of Service](https://go.dev/tos)
* [Privacy Policy](http://www.google.com/intl/en/policies/privacy/)
* [Report an Issue](https://go.dev/s/pkgsite-feedback)
* ![System theme](/static/shared/icon/brightness_6_gm_grey_24dp.svg)
  ![Dark theme](/static/shared/icon/brightness_2_gm_grey_24dp.svg)
  ![Light theme](/static/shared/icon/light_mode_gm_grey_24dp.svg)

  Theme Toggle
* ![](/static/shared/icon/keyboard_grey_24dp.svg)

  Shortcuts Modal

[![Google logo](/static/shared/logo/google-white.svg)](https://google.com)

## Jump to

![](/static/shared/icon/close_gm_grey_24dp.svg)

Close

## Keyboard shortcuts

![](/static/shared/icon/close_gm_grey_24dp.svg)

| **?** | : This menu |
| --- | --- |
| **/** | : Search site |
| **f** or **F** | : Jump to |
| **y** or **Y** | : Canonical URL |

Close

go.dev uses cookies from Google to deliver and enhance the quality of its services and to
analyze traffic. [Learn more.](https://policies.google.com/technologies/cookies)
Okay



=== Content from github.com_591fdf34_20250114_185331.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Freleases%2Ftag%2Fv7.0.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Freleases%2Ftag%2Fv7.0.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=oauth2-proxy%2Foauth2-proxy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[oauth2-proxy](/oauth2-proxy)
/
**[oauth2-proxy](/oauth2-proxy/oauth2-proxy)**
Public

* [Notifications](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)
* [Star
   10.2k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)

* [Code](/oauth2-proxy/oauth2-proxy/tree/v7.0.0)
* [Issues
  125](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests
  56](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects
  2](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

Additional navigation options

* [Code](/oauth2-proxy/oauth2-proxy/tree/v7.0.0)
* [Issues](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

1. [Releases](/oauth2-proxy/oauth2-proxy/releases)
2. [v7.0.0](/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0)

# v7.0.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/oauth2-proxy/oauth2-proxy/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v7.0.0)

 Loading

[View all tags](/oauth2-proxy/oauth2-proxy/tags)

![@JoelSpeed](https://avatars.githubusercontent.com/u/9232216?s=40&v=4)
[JoelSpeed](/JoelSpeed)
released this
01 Feb 18:18

Â·
[689 commits](/oauth2-proxy/oauth2-proxy/compare/v7.0.0...master)
to master
since this release

[v7.0.0](/oauth2-proxy/oauth2-proxy/tree/v7.0.0)

[`0698587`](/oauth2-proxy/oauth2-proxy/commit/06985879e19c3d47ed73ff650b67e2e775f88feb)

This commit was created on GitHub.com and signed with GitHubâs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Release Highlights

* Major internal improvements to provider interfaces
* Added group authorization support
* Improved support for external auth for Traefik
* Introduced alpha configuration format to allow users to trial new configuration format and alpha features
* GitLab provider now supports restricting to members of a project
* Keycloak provider now supports restricting users to members of a set of groups
* (Alpha) Flexible header configuration allowing user defined mapping of session claims to header values

## Important Notes

* [GHSA-4mf2-f3wh-gvf2](https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2) The whitelist domain feature has been updated to fix a vulnerability that was identified, please see the linked advisory for details
* [#964](https://github.com/oauth2-proxy/oauth2-proxy/pull/964) Redirect URL generation will attempt secondary strategies

  in the priority chain if any fail the `IsValidRedirect` security check. Previously any failures fell back to `/`.
* [#953](https://github.com/oauth2-proxy/oauth2-proxy/pull/953) Keycloak will now use `--profile-url` if set for the userinfo endpoint

  instead of `--validate-url`. `--validate-url` will still work for backwards compatibility.
* [#957](https://github.com/oauth2-proxy/oauth2-proxy/pull/957) To use X-Forwarded-{Proto,Host,Uri} on redirect detection, `--reverse-proxy` must be `true`.
* [#936](https://github.com/oauth2-proxy/oauth2-proxy/pull/936) `--user-id-claim` option is deprecated and replaced by `--oidc-email-claim`
* [#630](https://github.com/oauth2-proxy/oauth2-proxy/pull/630) Gitlab projects needs a Gitlab application with the extra `read_api` enabled
* [#849](https://github.com/oauth2-proxy/oauth2-proxy/pull/849) `/oauth2/auth` `allowed_groups` querystring parameter can be paired with the `allowed-groups` configuration option.
  + The `allowed_groups` querystring parameter can specify multiple comma delimited groups.
  + In this scenario, the user must have a group (from their multiple groups) present in both lists to not get a 401 or 403 response code.
  + Example:
    - OAuth2-Proxy globally sets the `allowed_groups` as `engineering`.
    - An application using Kubernetes ingress uses the `/oauth2/auth` endpoint with `allowed_groups` querystring set to `backend`.
    - A user must have a session with the groups `["engineering", "backend"]` to pass authorization.
    - Another user with the groups `["engineering", "frontend"]` would fail the querystring authorization portion.
* [#905](https://github.com/oauth2-proxy/oauth2-proxy/pull/905) Existing sessions from v6.0.0 or earlier are no longer valid. They will trigger a reauthentication.
* [#826](https://github.com/oauth2-proxy/oauth2-proxy/pull/826) `skip-auth-strip-headers` now applies to all requests, not just those where authentication would be skipped.
* [#797](https://github.com/oauth2-proxy/oauth2-proxy/pull/797) The behavior of the Google provider Groups restriction changes with this
  + Either `--google-group` or the new `--allowed-group` will work for Google now (`--google-group` will be used if both are set)
  + Group membership lists will be passed to the backend with the `X-Forwarded-Groups` header
  + If you change the list of allowed groups, existing sessions that now don't have a valid group will be logged out immediately.
    - Previously, group membership was only checked on session creation and refresh.
* [#789](https://github.com/oauth2-proxy/oauth2-proxy/pull/789) `--skip-auth-route` is (almost) backwards compatible with `--skip-auth-regex`
  + We are marking `--skip-auth-regex` as DEPRECATED and will remove it in the next major version.
  + If your regex contains an `=` and you want it for all methods, you will need to add a leading `=` (this is the area where `--skip-auth-regex` doesn't port perfectly)
* [#575](https://github.com/oauth2-proxy/oauth2-proxy/pull/575) Sessions from v5.1.1 or earlier will no longer validate since they were not signed with SHA1.
  + Sessions from v6.0.0 or later had a graceful conversion to SHA256 that resulted in no reauthentication
  + Upgrading from v5.1.1 or earlier will result in a reauthentication
* [#616](https://github.com/oauth2-proxy/oauth2-proxy/pull/616) Ensure you have configured oauth2-proxy to use the `groups` scope.
  + The user may be logged out initially as they may not currently have the `groups` claim however after going back through login process wil be authenticated.
* [#839](https://github.com/oauth2-proxy/oauth2-proxy/pull/839) Enables complex data structures for group claim entries, which are output as Json by default.

## Breaking Changes

* [#964](https://github.com/oauth2-proxy/oauth2-proxy/pull/964) `--reverse-proxy` must be true to trust `X-Forwarded-*` headers as canonical.

  These are used throughout the application in redirect URLs, cookie domains and host logging logic. These are the headers:
  + `X-Forwarded-Proto` instead of `req.URL.Scheme`
  + `X-Forwarded-Host` instead of `req.Host`
  + `X-Forwarded-Uri` instead of `req.URL.RequestURI()`
* [#953](https://github.com/oauth2-proxy/oauth2-proxy/pull/953) In config files & envvar configs, `keycloak_group` is now the plural `keycloak_groups`.

  Flag configs are still `--keycloak-group` but it can be passed multiple times.
* [#911](https://github.com/oauth2-proxy/oauth2-proxy/pull/911) Specifying a non-existent provider will cause OAuth2-Proxy to fail on startup instead of defaulting to "google".
* [#797](https://github.com/oauth2-proxy/oauth2-proxy/pull/797) Security changes to Google provider group authorization flow
  + If you change the list of allowed groups, existing sessions that now don't have a valid group will be logged out immediately.
    - Previously, group membership was only checked on session creation and refresh.
* [#722](https://github.com/oauth2-proxy/oauth2-proxy/pull/722) When a Redis session store is configured, OAuth2-Proxy will fail to start up unless connection and health checks to Redis pass
* [#800](https://github.com/oauth2-proxy/oauth2-proxy/pull/800) Fix import path for v7. The import path has changed to support the go get installation.
  + You can now `go get github.com/oauth2-proxy/oauth2-proxy/v7` to get the latest `v7` version of OAuth2 Proxy
  + Import paths for package are now under `v7`, eg `github.com/oauth2-proxy/oauth2-proxy/v7/pkg/<module>`
* [#753](https://github.com/oauth2-proxy/oauth2-proxy/pull/753) A bug in the Azure provider prevented it from properly passing the configured protected `--resource`

  via the login url. If this option was used in the past, behavior will change with this release as it will

  affect the tokens returned by Azure. In the past, the tokens were always for `https://graph.microsoft.com` (the default)

  and will now be for the configured resource (if it exists, otherwise it will run into errors)
* [#754](https://github.com/oauth2-proxy/oauth2-proxy/pull/754) The Azure provider now has token refresh functionality implemented. This means that there won't

  be any redirects in the browser anymore when tokens expire, but instead a token refresh is initiated

  in the background, which leads to new tokens being returned in the cookies.
  + Please note that `--cookie-refresh` must be 0 (the default) or equal to the token lifespan configured in Azure AD to make

    Azure token refresh reliable. Setting this value to 0 means that it relies on the provider implementation

    to decide if a refresh is required.

## Changes since v6.1.1

* [GHSA-4mf2-f3wh-gvf2](https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2) Subdomain checking of whitelisted domains could allow unintended redirects ([@NickMeves](https://github.com/NickMeves))
* [#1002](https://github.com/oauth2-proxy/oauth2-proxy/pull/1002) Use logger for logging refreshed session in azure and gitlab provider ([@Bibob7](https://github.com/Bibob7))
* [#799](https://github.com/oauth2-proxy/oauth2-proxy/pull/799) Use comma separated multiple values for header ([@lilida](https://github.com/lilida))
* [#903](https://github.com/oauth2-proxy/oauth2-proxy/pull/903) Add docs and generated reference for Alpha configuration ([@JoelSpeed](https://github.com/JoelSpeed))
* [#995](https://github.com/oauth2-proxy/oauth2-proxy/pull/995) Add Security Policy ([@JoelSpeed](https://github.com/JoelSpeed))
* [#964](https://github.com/oauth2-proxy/oauth2-proxy/pull/964) Require `--reverse-proxy` true to trust `X-Forwareded-*` type headers ([@NickMeves](https://github.com/NickMeves))
* [#970](https://github.com/oauth2-proxy/oauth2-proxy/pull/970) Fix joined cookie name for those containing underline in the suffix ([@peppered](https://github.com/peppered))
* [#953](https://github.com/oauth2-proxy/oauth2-proxy/pull/953) Migrate Keycloak to EnrichSession & support multiple groups for authorization ([@NickMeves](https://github.com/NickMeves))
* [#957](https://github.com/oauth2-proxy/oauth2-proxy/pull/957) Use X-Forwarded-{Proto,Host,Uri} on redirect as last resort ([@linuxgemini](https://github.com/linuxgemini))
* [#630](https://github.com/oauth2-proxy/oauth2-proxy/pull/630) Add support for Gitlab project based authentication ([@factorysh](https://github.com/factorysh))
* [#907](https://github.com/oauth2-proxy/oauth2-proxy/pull/907) Introduce alpha configuration option to enable testing of structured configuration ([@JoelSpeed](https://github.com/JoelSpeed))
* [#938](https://github.com/oauth2-proxy/oauth2-proxy/pull/938) Cleanup missed provider renaming refactor methods ([@NickMeves](https://github.com/NickMeves))
* [#816](https://github.com/oauth2-proxy/oauth2-proxy/pull/816) (via [#936](https://github.com/oauth2-proxy/oauth2-proxy/pull/936)) Support non-list group claims ([@loafoe](https://github.com/loafoe))
* [#936](https://github.com/oauth2-proxy/oauth2-proxy/pull/936) Refactor OIDC Provider and support groups from Profile URL ([@NickMeves](https://github.com/NickMeves))
* [#869](https://github.com/oauth2-proxy/oauth2-proxy/pull/869) Streamline provider interface method names and signatures ([@NickMeves](https://github.com/NickMeves))
* [#849](https://github.com/oauth2-proxy/oauth2-proxy/pull/849) Support group authorization on `oauth2/auth` endpoint via `allowed_groups` querystring ([@NickMeves](https://github.com/NickMeves))
* [#925](https://github.com/oauth2-proxy/oauth2-proxy/pull/925) Fix basic auth legacy header conversion ([@JoelSpeed](https://github.com/JoelSpeed))
* [#916](https://github.com/oauth2-proxy/oauth2-proxy/pull/916) Add AlphaOptions struct to prepare for alpha config loading ([@JoelSpeed](https://github.com/JoelSpeed))
* [#923](https://github.com/oauth2-proxy/oauth2-proxy/pull/923) Support TLS 1.3 ([@aajisaka](https://github.com/aajisaka))
* [#918](https://github.com/oauth2-proxy/oauth2-proxy/pull/918) Fix log header output ([@JoelSpeed](https://github.com/JoelSpeed))
* [#911](https://github.com/oauth2-proxy/oauth2-proxy/pull/911) Validate provider type on startup. ([@arcivanov](https://github.com/arcivanov))
* [#906](https://github.com/oauth2-proxy/oauth2-proxy/pull/906) Set up v6.1.x versioned documentation as default documentation ([@JoelSpeed](https://github.com/JoelSpeed))
* [#905](https://github.com/oauth2-proxy/oauth2-proxy/pull/905) Remove v5 legacy sessions support ([@NickMeves](https://github.com/NickMeves))
* [#904](https://github.com/oauth2-proxy/oauth2-proxy/pull/904) Set `skip-auth-strip-headers` to `true` by default ([@NickMeves](https://github.com/NickMeves))
* [#826](https://github.com/oauth2-proxy/oauth2-proxy/pull/826) Integrate new header injectors into project ([@JoelSpeed](https://github.com/JoelSpeed))
* [#797](https://github.com/oauth2-proxy/oauth2-proxy/pull/797) Create universal Authorization behavior across providers ([@NickMeves](https://github.com/NickMeves))
* [#898](https://github.com/oauth2-proxy/oauth2-proxy/pull/898) Migrate documentation to Docusaurus ([@JoelSpeed](https://github.com/JoelSpeed))
* [#754](https://github.com/oauth2-proxy/oauth2-proxy/pull/754) Azure token refresh ([@codablock](https://github.com/codablock))
* [#850](https://github.com/oauth2-proxy/oauth2-proxy/pull/850) Increase session fields in `/oauth2/userinfo` endpoint ([@NickMeves](https://github.com/NickMeves))
* [#825](https://github.com/oauth2-proxy/oauth2-proxy/pull/825) Fix code coverage reporting on GitHub actions([@JoelSpeed](https://github.com/JoelSpeed))
* [#796](https://github.com/oauth2-proxy/oauth2-proxy/pull/796) Deprecate GetUserName & GetEmailAdress for EnrichSessionState ([@NickMeves](https://github.com/NickMeves))
* [#705](https://github.com/oauth2-proxy/oauth2-proxy/pull/705) Add generic Header injectors for upstream request and response headers ([@JoelSpeed](https://github.com/JoelSpeed))
* [#753](https://github.com/oauth2-proxy/oauth2-proxy/pull/753) Pass resource parameter in login url ([@codablock](https://github.com/codablock))
* [#789](https://github.com/oauth2-proxy/oauth2-proxy/pull/789) Add `--skip-auth-route` configuration option for `METHOD=pathRegex` based allowlists ([@NickMeves](https://github.com/NickMeves))
* [#575](https://github.com/oauth2-proxy/oauth2-proxy/pull/575) Stop accepting legacy SHA1 signed cookies ([@NickMeves](https://github.com/NickMeves))
* [#722](https://github.com/oauth2-proxy/oauth2-proxy/pull/722) Validate Redis configuration options at startup ([@NickMeves](https://github.com/NickMeves))
* [#791](https://github.com/oauth2-proxy/oauth2-proxy/pull/791) Remove GetPreferredUsername method from provider interface ([@NickMeves](https://github.com/NickMeves))
* [#764](https://github.com/oauth2-proxy/oauth2-proxy/pull/764) Document bcrypt encryption for htpasswd (and hide SHA) ([@lentzi90](https://github.com/lentzi90))
* [#778](https://github.com/oauth2-proxy/oauth2-proxy/pull/778) Use display-htpasswd-form flag
* [#616](https://github.com/oauth2-proxy/oauth2-proxy/pull/616) Add support to ensure user belongs in required groups when using the OIDC provider ([@stefansedich](https://github.com/stefansedich))
* [#800](https://github.com/oauth2-proxy/oauth2-proxy/pull/800) Fix import path for v7 ([@johejo](https://github.com/johejo))
* [#783](https://github.com/oauth2-proxy/oauth2-proxy/pull/783) Update Go to 1.15 ([@johejo](https://github.com/johejo))
* [#813](https://github.com/oauth2-proxy/oauth2-proxy/pull/813) Fix build ([@thiagocaiubi](https://github.com/thiagocaiubi))
* [#801](https://github.com/oauth2-proxy/oauth2-proxy/pull/801) Update go-redis/redis to v8 ([@johejo](https://github.com/johejo))
* [#750](https://github.com/oauth2-proxy/oauth2-proxy/pull/750) ci: Migrate to Github Actions ([@shinebayar-g](https://github.com/shinebayar-g))
* [#829](https://github.com/oauth2-proxy/oauth2-proxy/pull/820) Rename test directory to testdata ([@johejo](https://github.com/johejo))
* [#819](https://github.com/oauth2-proxy/oauth2-proxy/pull/819) Improve CI ([@johejo](https://github.com/johejo))
* [#989](https://github.com/oauth2-proxy/oauth2-proxy/pull/989) Adapt isAjax to support mimetype lists ([@rassie](https://github.com/rassie))
* [#1013](https://github.com/oauth2-proxy/oauth2-proxy/pull/1013) Update alpine version to 3.13 ([@nishanth-pinnapareddy](https://github.com/nishanth-pinnapareddy))

 Assets
14

 Loading

 ð
1
 deerfoxl0l reacted with laugh emoji

All reactions

* ð
  1 reaction

 1 person reacted

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_f07a8515_20250114_185330.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Fcommit%2F780ae4f3c99b579cb2ea9845121caebb6192f725)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Fcommit%2F780ae4f3c99b579cb2ea9845121caebb6192f725)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=oauth2-proxy%2Foauth2-proxy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[oauth2-proxy](/oauth2-proxy)
/
**[oauth2-proxy](/oauth2-proxy/oauth2-proxy)**
Public

* [Notifications](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)
* [Star
   10.2k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)

* [Code](/oauth2-proxy/oauth2-proxy)
* [Issues
  125](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests
  56](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects
  2](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

Additional navigation options

* [Code](/oauth2-proxy/oauth2-proxy)
* [Issues](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

## Commit

[Permalink](/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4mf2-f3wh-gvf2](https://github.com/advisories/GHSA-4mf2-f3wh-gvf2 "GHSA-4mf2-f3wh-gvf2")

[Browse files](/oauth2-proxy/oauth2-proxy/tree/780ae4f3c99b579cb2ea9845121caebb6192f725)
Browse the repository at this point in the history

* Loading branch information

Nick Meves
authored
Feb 1, 2021

1 parent
[48b1658](/oauth2-proxy/oauth2-proxy/commit/48b1658e5d3df3dd4321da5a5de011b5d25b6382)

commit 780ae4f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**14 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* oauthproxy.go
  [oauthproxy.go](#diff-7e1e132991c10dc0110f813e8e1057f24288bfb9d7d5bdd54d468c496e01110b)
* oauthproxy\_test.go
  [oauthproxy\_test.go](#diff-5391075a81db21342eb96dd272ba55de4a981f521b6bc8647d1ab8be5d5d5754)

## There are no files selected for viewing

16 changes: 9 additions & 7 deletions

16
[oauthproxy.go](#diff-7e1e132991c10dc0110f813e8e1057f24288bfb9d7d5bdd54d468c496e01110b "oauthproxy.go")

Show comments

[View file](/oauth2-proxy/oauth2-proxy/blob/780ae4f3c99b579cb2ea9845121caebb6192f725/oauthproxy.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -437,21 +437,23 @@ func (p \*OAuthProxy) IsValidRedirect(redirect string) bool { |
|  |  | } |
|  |  | redirectHostname := redirectURL.Hostname() |
|  |  |  |
|  |  | for \_, domain := range p.whitelistDomains { |
|  |  | domainHostname, domainPort := splitHostPort(strings.TrimLeft(domain, ".")) |
|  |  | if domainHostname == "" { |
|  |  | for \_, allowedDomain := range p.whitelistDomains { |
|  |  | allowedHost, allowedPort := splitHostPort(allowedDomain) |
|  |  | if allowedHost == "" { |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | if (redirectHostname == domainHostname) || (strings.HasPrefix(domain, ".") && strings.HasSuffix(redirectHostname, domainHostname)) { |
|  |  | if redirectHostname == strings.TrimPrefix(allowedHost, ".") || |
|  |  | (strings.HasPrefix(allowedHost, ".") && |
|  |  | strings.HasSuffix(redirectHostname, allowedHost)) { |
|  |  | // the domain names match, now validate the ports |
|  |  | // if the whitelisted domain's port is '\*', allow all ports |
|  |  | // if the whitelisted domain contains a specific port, only allow that port |
|  |  | // if the whitelisted domain doesn't contain a port at all, only allow empty redirect ports ie http and https |
|  |  | redirectPort := redirectURL.Port() |
|  |  | if (domainPort == "\*") || |
|  |  | (domainPort == redirectPort) || |
|  |  | (domainPort == "" && redirectPort == "") { |
|  |  | if allowedPort == "\*" || |
|  |  | allowedPort == redirectPort || |
|  |  | (allowedPort == "" && redirectPort == "") { |
|  |  | return true |
|  |  | } |
|  |  | } |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[oauthproxy\_test.go](#diff-5391075a81db21342eb96dd272ba55de4a981f521b6bc8647d1ab8be5d5d5754 "oauthproxy_test.go")

Show comments

[View file](/oauth2-proxy/oauth2-proxy/blob/780ae4f3c99b579cb2ea9845121caebb6192f725/oauthproxy_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -298,6 +298,11 @@ func TestIsValidRedirect(t \*testing.T) { |
|  |  | Redirect: "/\t/\t\\evil.com", |
|  |  | ExpectedResult: false, |
|  |  | }, |
|  |  | { |
|  |  | Desc: "openRedirectPartialSubdomain", |
|  |  | Redirect: "http://evilbar.foo", |
|  |  | ExpectedResult: false, |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | for \_, tc := range testCases { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `780ae4f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Fcommit%2F780ae4f3c99b579cb2ea9845121caebb6192f725) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_e2625fa8_20250114_185332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Fsecurity%2Fadvisories%2FGHSA-4mf2-f3wh-gvf2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foauth2-proxy%2Foauth2-proxy%2Fsecurity%2Fadvisories%2FGHSA-4mf2-f3wh-gvf2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=oauth2-proxy%2Foauth2-proxy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[oauth2-proxy](/oauth2-proxy)
/
**[oauth2-proxy](/oauth2-proxy/oauth2-proxy)**
Public

* [Notifications](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)
* [Star
   10.2k](/login?return_to=%2Foauth2-proxy%2Foauth2-proxy)

* [Code](/oauth2-proxy/oauth2-proxy)
* [Issues
  125](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests
  56](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects
  2](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

Additional navigation options

* [Code](/oauth2-proxy/oauth2-proxy)
* [Issues](/oauth2-proxy/oauth2-proxy/issues)
* [Pull requests](/oauth2-proxy/oauth2-proxy/pulls)
* [Actions](/oauth2-proxy/oauth2-proxy/actions)
* [Projects](/oauth2-proxy/oauth2-proxy/projects)
* [Security](/oauth2-proxy/oauth2-proxy/security)
* [Insights](/oauth2-proxy/oauth2-proxy/pulse)

# Subdomain checking of whitelisted domains could allow unintended redirects

Moderate

[JoelSpeed](/JoelSpeed)
published
GHSA-4mf2-f3wh-gvf2
Feb 1, 2021

## Package

No package listed

## Affected versions

3.0.0 < 6.1.1

## Patched versions

> 7.0.0

## Description

### Impact

*What kind of vulnerability is it? Who is impacted?*

For users that use the whitelist domain feature, a domain that ended in a similar way to the intended domain could have been allowed as a redirect.

For example, if a whitelist domain was configured for `.example.com`, the intention is that subdomains of `example.com` are allowed.

Instead, `example.com` and `badexample.com` could also match.

### Patches

*Has the problem been patched? What versions should users upgrade to?*

This is fixed in version 7.0.0 onwards.

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

Disable the whitelist domain feature and run separate OAuth2 Proxy instances for each subdomain.

# Original Issue Posted by [@semoac](https://github.com/semoac):

Whitelist Domain feature is not working as expected because is not matching a dot to ensure the redirect is a subdomain.

## Expected Behavior

If whitelist domain is set to `.example.com` , then `hack.alienexample.com` should be rejected as a valid redirect.

## Current Behavior

The code is removing the `dot` from `.example.com` and only checking if the redirect string end with `example.com`

## Possible Solution

Here

[oauth2-proxy/oauthproxy.go](https://github.com/oauth2-proxy/oauth2-proxy/blob/c377466411f2aee180a732187edb638f2f7e57fb/oauthproxy.go#L661)

Line 661
in
[c377466](/oauth2-proxy/oauth2-proxy/commit/c377466411f2aee180a732187edb638f2f7e57fb)

|  | if (redirectHostname == domainHostname) || (strings.HasPrefix(domain, ".") && strings.HasSuffix(redirectHostname, domainHostname)) { |
| --- | --- |

Include the dot when checking the string:

```
strings.HasSuffix(redirectHostname, "." + domainHostname)

```
## Steps to Reproduce (for bugs)

```
package main

import (
	"fmt"
	"strings"
)

func validOptionalPort(port string) bool {
	if port == "" || port == ":*" {
		return true
	}
	if port[0] != ':' {
		return false
	}
	for _, b := range port[1:] {
		if b < '0' || b > '9' {
			return false
		}
	}
	return true
}

func splitHostPort(hostport string) (host, port string) {
	host = hostport

	colon := strings.LastIndexByte(host, ':')
	if colon != -1 && validOptionalPort(host[colon:]) {
		host, port = host[:colon], host[colon+1:]
	}

	if strings.HasPrefix(host, "[") && strings.HasSuffix(host, "]") {
		host = host[1 : len(host)-1]
	}

	return
}

func main() {
	domain := ".example.com"
	domainHostname, _ := splitHostPort(strings.TrimLeft(domain, "."))
	redirectHostname := "https://hack.alienexample.com"
	if (strings.HasPrefix(domain, ".") && strings.HasSuffix(redirectHostname, domainHostname)) { fmt.Println("This should not have happen.")}
}

```

### Severity

Moderate

### CVE ID

CVE-2021-21291

### Weaknesses

No CWEs

### Credits

* [![@semoac](https://avatars.githubusercontent.com/u/20688668?s=40&v=4)](/semoac)
  [semoac](/semoac)
  Analyst

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


