=== Content from www.rtcsec.com_d74e9b7b_20250114_181143.html ===
[Skip to main content](#content)[![Enable Security logo](https://www.enablesecurity.com/assets/img/logo-header-white.min.ac2c259ad95c9e369b3d7e44d9986a07c2c45fec663fbceaefe184e92011793a.svg)](/)

* [Get in touch](/contact/)

* Security Testing
  + [VoIP Penetration Testing](/voip-penetration-testing/)
  + [Penetration Testing](/penetration-testing/)
  + [DDoS Resilience Testing](/ddos-testing/)
  + [Code & Config Analysis](/code-and-config-analysis/)
  + [Fuzz Testing](/fuzz-testing/)
* [SIPVicious](/sipvicious/)
* [Consultancy](/consultancy/)
* [Research](/research/)
* [Blog](/blog/)
* [Newsletter](/newsletter/)
* [About](/about/)
* [Contact](/contact/)
![Sandro Gauci](https://www.enablesecurity.com/assets/img/sandro-thumb_hubedf31446211def026ce81cb6e7c2636_36362_60x60_resize_q75_box.jpg)

[**Sandro Gauci**](#author-sandrogauci), Enable Security

# Details about CVE-2020-26262, bypass of Coturn’s default access control protection

Published on Jan 11, 2021
in
*[webrtc security](https://www.enablesecurity.com/tags/webrtc-security/)*,
*[bug bounty](https://www.enablesecurity.com/tags/bug-bounty/)*,
*[research](https://www.enablesecurity.com/tags/research/)*,
*[TURN security](https://www.enablesecurity.com/tags/turn-security/)*

## Video demonstration

The following demonstration shows the security bypass of the default coturn configuration on IPv4:

**Note**

Turn on the captions by clicking on the CC button and watch on full screen for optimal viewing experience.
## Background: why does coturn have default access control rules in the first place?

TURN servers are an important part of many WebRTC infrastructures because they make it possible to relay the media even for hosts behind restrictive NAT. We wrote about this extensively in the post called *[How we abused Slack’s TURN servers to gain access to internal services](https://www.enablesecurity.com/blog/slack-webrtc-turn-compromise-and-bug-bounty/)*. To summarize: from the perspective of a pentester, a TURN server is very similar to a proxy server, allowing relaying of TCP connections and UDP packets. One somewhat obvious problem is that attackers can abuse these TURN servers to connect to network services behind the firewall, such as those on the TURN server itself. To address this problem, coturn prevents connections to loopback IP addresses `127.0.0.1` on IPv4 and `[::1]` on IPv6. This default protection mechanism has been there since coturn version 4.5.1.0 ‘dan Eider’ which was released back in November 2018.

Do keep in mind that coturn can also block relaying to peers by using the `denied-peer-ip` setting. Therefore, coturn has both a default block for loopback addresses, and can be configured to further block peer addresses by using the settings.

## Technical details: how was this protection mechanism bypassed?

During testing of [stunner](https://www.enablesecurity.com/research/), our internal STUN and TURN security testing tool, we noticed that the default protection mechanism to protect against connections to `127.0.0.1` worked fine but the same effect could be achieved by specifying `0.0.0.0` as IP instead of `127.0.0.1`. On Linux systems (and possibly other operating systems), socket connections to `0.0.0.0` get connected to the local machine, which, for our purposes, has exactly the same effect as connecting to `127.0.0.1`. Therefore, we had found a way to bypass the default block on IPv4. However, we were not sure that this would be the only way to connect to local services via coturn.

So, we (finally!) implemented IPv6 support for TURN and noticed that even if coturn is supposed to also block loopback IPv6 addresses, it did not actually work. In fact, although coturn contained code that appeared to block IPv6 loopback addresses, strangely we could still specify `[::1]` as peer address and get connected to local services without getting the standard *403, Forbidden IP* response. On top of that, there was no code to protect against `[::]`, which is the IPv6 equivalent of `0.0.0.0`.

Our advisory can be found at the following location: <https://github.com/EnableSecurity/advisories/tree/master/ES2021-01-coturn-access-control-bypass>.

## Fix: available upstream

After these issues were found in coturn version 4.5.1.3, we worked with the coturn developers to get them addressed so that loopback peer addresses can be blocked by coturn once and for all (one can hope!). Therefore, we submitted patches to the coturn project to do the following:

* block `0.0.0.0/8` by default
* block `[::]` by default
* Correctly parse IPv6 loopback address `[::1]`

The vulnerability itself was assigned CVE-2020-26262 and the fixes are to be found in coturn version [4.5.2](https://github.com/coturn/coturn/releases/tag/4.5.2).

## Mitigation until fix is applied

If your organisation uses coturn server but cannot deploy the latest and greatest version of coturn immediately, the following mitigation methods would address these issues:

* Set the `-L` flag or `listening-ip` configuration with the value of an IPv4 address; this will unfortunately stop relaying of IPv6 traffic too
* Explicitly block special IP addresses as specified in the [below example configuration](#further-concerns-what-else)

## Bug bounty time: how widespread is this problem?

We tried to understand how widespread this issue is by probing the organisations that have bug bounties and a publicly accessible TURN server. In this case, only one live environment was found to allow connections to localhost and only on UDP. This allowed access to the TURN server’s RPC port 111 for example. We reported this and that should have been fixed too. Additionally, we also found this issue in a pentest engagement. The rest of the services that we probed had already addressed these issues by:

* not supporting IPv6 (this happens when coturn explicitly listens on an IPv4 address such as `0.0.0.0`)
* explicitly blocking `0.0.0.0/8` as we instructed in the [Slack compromise blog post](https://www.enablesecurity.com/blog/slack-webrtc-turn-compromise-and-bug-bounty/#how-to-fix-an-open-turn-relay-to-address-this-vulnerability)

It seems that our past recommendations have had some positive effect!

What we also noticed is that various service providers have also disabled TCP relaying for many TURN servers since TCP may be unnecessary for many normal RTP media streams. This reduces exposure for further potential abuse.

## Further concerns: what else?

One might realize that this default access control rule does not actually protect against access to internal IP addresses. For that reason, we recommend making use of `denied-peer-ip` to block special purpose addresses. Here we include an updated configuration for coturn that includes both IPv4 and IPv6 special addresses that can be blocked:

```
no-multicast-peers
denied-peer-ip=0.0.0.0-0.255.255.255
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=100.64.0.0-100.127.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=169.254.0.0-169.254.255.255
denied-peer-ip=172.16.0.0-172.31.255.255
denied-peer-ip=192.0.0.0-192.0.0.255
denied-peer-ip=192.0.2.0-192.0.2.255
denied-peer-ip=192.88.99.0-192.88.99.255
denied-peer-ip=192.168.0.0-192.168.255.255
denied-peer-ip=198.18.0.0-198.19.255.255
denied-peer-ip=198.51.100.0-198.51.100.255
denied-peer-ip=203.0.113.0-203.0.113.255
denied-peer-ip=240.0.0.0-255.255.255.255
denied-peer-ip=::1
denied-peer-ip=64:ff9b::-64:ff9b::ffff:ffff
denied-peer-ip=::ffff:0.0.0.0-::ffff:255.255.255.255
denied-peer-ip=100::-100::ffff:ffff:ffff:ffff
denied-peer-ip=2001::-2001:1ff:ffff:ffff:ffff:ffff:ffff:ffff
denied-peer-ip=2002::-2002:ffff:ffff:ffff:ffff:ffff:ffff:ffff
denied-peer-ip=fc00::-fdff:ffff:ffff:ffff:ffff:ffff:ffff:ffff
denied-peer-ip=fe80::-febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff

```

Do note that we have not extensively tested this so, as always, if deploying such rules on live, do test in your environment. Please let us know if anything is wrong so that we can update our post.

What else could go wrong? One thing that we noticed is that external IP addresses of the TURN server and perhaps adjacent servers (i.e. those on the same network) might be reachable and perhaps in some cases, firewall rules that apply to external addresses do not apply to the TURN server. Although we have only demonstrated this in lab environment and not actually abused it in our client engagements, this is certainly a valid concern.

Our recommendation is to avoid all of this and deploy your TURN servers on an isolated environment that has no special access to your internal systems.

## FAQ

### Would blocking *current network* addresses using denied-peer-ip prevent this bypass?

Yes, if you explicitly blocked `0.0.0.0-0.255.255.255` and `[::1]` it would block that. Do note, however, that there is a bug with using `denied-peer-ip` to block `[::]` which seems to actually block everything thus making the TURN server useless. Since the fixed version 4.5.2, rules blocking loopback and *current network* addresses are no longer needed. So our main recommendation is to upgrade to the latest fixed version.

## Timeline

* 2020-10-28: bypass for `0.0.0.0` discovered while preparing for [TADSummit presentation](https://www.youtube.com/watch?v=je959kV-MrY)
* 2020-11-05: initial contact with coturn developers; delay in reporting because we realize that IPv6 might be another venue
* 2020-11-06: exploration of TURN and IPv6 for access control bypassing purposes; intial support for IPv6 added to our toolset
* 2020-11-11: confirmation of vulnerabilities in lab environment
* 2020-11-20: reporting upstream
* 2020-11-30: security fixes provided to coturn project
* 2020-12-07: security fixes refactored by coturn project
* 2020-12-09: CVE obtained
* 2021-01-11: joint publication of advisory by [coturn project](https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p) and [Enable Security](https://github.com/EnableSecurity/advisories/tree/master/ES2021-01-coturn-access-control-bypass)

## Thanks

A special thanks goes to [@misi](https://github.com/misi), coturn who has been very receptive and helpful in getting this resolved!

---

![Sandro Gauci](https://www.enablesecurity.com/assets/img/sandro-thumb_hubedf31446211def026ce81cb6e7c2636_36362_180x180_resize_q75_box.jpg)

Sandro Gauci

CEO, Chief Mischief Officer at Enable Security

Sandro Gauci leads the operations and research at
[Enable Security](https://www.enablesecurity.com). He is the original developer of
[SIPVicious OSS](https://www.enablesecurity.com/sipvicious/), the SIP security testing
toolset. His role is to focus on the vision of the company, design offensive security
tools and engage in security research and testing. Therefore, he is the proud owner of
the title of *Chief Mischief Officer* at Enable Security.

He offers public office hours and is reachable [here](https://savvycal.com/sandrogauci/pub).

###### Contents

* [Video demonstration](#video-demonstration)
* [Background: why does coturn have default access control rules in the first place?](#background-why-does-coturn-have-default-access-control-rules-in-the-first-place)
* [Technical details: how was this protection mechanism bypassed?](#technical-details-how-was-this-protection-mechanism-bypassed)
* [Fix: available upstream](#fix-available-upstream)
* [Mitigation until fix is applied](#mitigation-until-fix-is-applied)
* [Bug bounty time: how widespread is this problem?](#bug-bounty-time-how-widespread-is-this-problem)
* [Further concerns: what else?](#further-concerns-what-else)
* [FAQ](#faq)
  + [Would blocking *current network* addresses using denied-peer-ip prevent this bypass?](#would-blocking-_current-network_-addresses-using-denied-peer-ip-prevent-this-bypass)
* [Timeline](#timeline)
* [Thanks](#thanks)
[![Enable Security GmbH logo](https://www.enablesecurity.com/assets/img/logo-white.min.ac2c259ad95c9e369b3d7e44d9986a07c2c45fec663fbceaefe184e92011793a.svg)](https://www.enablesecurity.com/)

* [Contact](/contact/)
* [Blog](/blog/)
* [Newsletter](/newsletter/)

* [SIPVicious](/sipvicious/)
* [Consultancy](/consultancy/)
* [Penetration Testing](/penetration-testing/)

* [VoIP Pentesting](/voip-penetration-testing/)
* [Code Analysis](/code-and-config-analysis/)
* [DDoS Testing](/ddos-testing/)

* [Fuzz Testing](/fuzz-testing/)
* [About](/about/)

© Enable Security GmbH · 2024

* [Privacy policy](/privacy/)
* [Impressum](/impressum/)
`User-Agent: friendly-scanner`**Cookie settings**
We use cookies to personalize content and analyze access to our website. For more information, please refer to our [privacy policy](/privacy/).Got it
No thanks



=== Content from github.com_0aee83e0_20250114_181140.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Frestund%2Fpull%2F7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Frestund%2Fpull%2F7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=wireapp%2Frestund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 21, 2024. It is now read-only.

[wireapp](/wireapp)
/
**[restund](/wireapp/restund)**
Public archive

* [Notifications](/login?return_to=%2Fwireapp%2Frestund) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2Fwireapp%2Frestund)
* [Star
   2](/login?return_to=%2Fwireapp%2Frestund)

* [Code](/wireapp/restund)
* [Issues
  1](/wireapp/restund/issues)
* [Pull requests
  1](/wireapp/restund/pulls)
* [Actions](/wireapp/restund/actions)
* [Security](/wireapp/restund/security)
* [Insights](/wireapp/restund/pulse)

Additional navigation options

* [Code](/wireapp/restund)
* [Issues](/wireapp/restund/issues)
* [Pull requests](/wireapp/restund/pulls)
* [Actions](/wireapp/restund/actions)
* [Security](/wireapp/restund/security)
* [Insights](/wireapp/restund/pulse)

# turn: block forwarding to loopback/any #7

 Merged

[arianvp](/arianvp)
merged 9 commits into
[master](/wireapp/restund/tree/master "wireapp/restund:master")
from
[block\_local\_any](/wireapp/restund/tree/block_local_any "wireapp/restund:block_local_any")

Mar 12, 2021

 Merged

# [turn: block forwarding to loopback/any](#top) #7

[arianvp](/arianvp)
merged 9 commits into
[master](/wireapp/restund/tree/master "wireapp/restund:master")
from
[block\_local\_any](/wireapp/restund/tree/block_local_any "wireapp/restund:block_local_any")

Mar 12, 2021

[Conversation
8](/wireapp/restund/pull/7)
[Commits
9](/wireapp/restund/pull/7/commits)
[Checks
0](/wireapp/restund/pull/7/checks)
[Files changed](/wireapp/restund/pull/7/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![z-dule](https://avatars.githubusercontent.com/u/2952716?s=60&v=4)](/z-dule)

Copy link

Contributor

### @z-dule **[z-dule](/z-dule)** commented [Mar 11, 2021](#issue-829020542)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@z-dule](https://avatars.githubusercontent.com/u/2952716?s=40&v=4)](/z-dule)

`[turn: block forwarding to loopback/any](/wireapp/restund/pull/7/commits/ffa2d56cac3d37715fe1381df81802774240da92 "turn: block forwarding to loopback/any")`

`[ffa2d56](/wireapp/restund/pull/7/commits/ffa2d56cac3d37715fe1381df81802774240da92)`

[![julialongtin](https://avatars.githubusercontent.com/u/16826370?s=60&v=4)](/julialongtin)

**[julialongtin](/julialongtin)**
reviewed
[Mar 11, 2021](#pullrequestreview-609621399)

 [View reviewed changes](/wireapp/restund/pull/7/files/ffa2d56cac3d37715fe1381df81802774240da92)

[modules/turn/turn.c](/wireapp/restund/pull/7/files/ffa2d56cac3d37715fe1381df81802774240da92#diff-0d811487c70667fc4b878c36a8d57668f5c306d8dc9cbd477e251898ae0c5cb2)
Outdated

Show resolved

Hide resolved

[![julialongtin](https://avatars.githubusercontent.com/u/16826370?s=60&v=4)](/julialongtin)

**[julialongtin](/julialongtin)**
approved these changes
[Mar 11, 2021](#pullrequestreview-609625512)

 [View reviewed changes](/wireapp/restund/pull/7/files/ffa2d56cac3d37715fe1381df81802774240da92)

[![@z-dule](https://avatars.githubusercontent.com/u/2952716?s=40&v=4)](/z-dule)

`[turn: also don't forward linklocal addresses](/wireapp/restund/pull/7/commits/e2f4094e23c73d4563a55f0de72244f34bb5b702 "turn: also don't forward linklocal addresses")`

`[e2f4094](/wireapp/restund/pull/7/commits/e2f4094e23c73d4563a55f0de72244f34bb5b702)`

[![franziskuskiefer](https://avatars.githubusercontent.com/u/890105?s=60&v=4)](/franziskuskiefer)

**[franziskuskiefer](/franziskuskiefer)**
reviewed
[Mar 11, 2021](#pullrequestreview-609637178)

 [View reviewed changes](/wireapp/restund/pull/7/files/e2f4094e23c73d4563a55f0de72244f34bb5b702)

Copy link

### @franziskuskiefer **[franziskuskiefer](/franziskuskiefer)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

lgtm if these are all the places this has to happen.

Do we have a way to test this?

Sorry, something went wrong.

All reactions

[![arianvp](https://avatars.githubusercontent.com/u/628387?s=60&v=4)](/arianvp)

**[arianvp](/arianvp)**
suggested changes
[Mar 11, 2021](#pullrequestreview-609679630)

 [View reviewed changes](/wireapp/restund/pull/7/files/e2f4094e23c73d4563a55f0de72244f34bb5b702)

[modules/turn/turn.c](/wireapp/restund/pull/7/files/e2f4094e23c73d4563a55f0de72244f34bb5b702#diff-0d811487c70667fc4b878c36a8d57668f5c306d8dc9cbd477e251898ae0c5cb2)
Outdated

Show resolved

Hide resolved

[![@z-dule](https://avatars.githubusercontent.com/u/2952716?s=40&v=4)](/z-dule)

`[turn: block whole loopback range, also block broadcast](/wireapp/restund/pull/7/commits/955064fc220b5739010a2e207a8561ea44f974d3 "turn: block whole loopback range, also block broadcast")`

`[955064f](/wireapp/restund/pull/7/commits/955064fc220b5739010a2e207a8561ea44f974d3)`

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
requested review from
[arianvp](/arianvp) and
[julialongtin](/julialongtin)
[March 11, 2021 12:22](#event-4444386250)

[![arianvp](https://avatars.githubusercontent.com/u/628387?s=60&v=4)](/arianvp)

**[arianvp](/arianvp)**
approved these changes
[Mar 11, 2021](#pullrequestreview-609701752)

 [View reviewed changes](/wireapp/restund/pull/7/files/955064fc220b5739010a2e207a8561ea44f974d3)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=80&v=4)](/arianvp)

Copy link

Contributor

### **[arianvp](/arianvp)** commented [Mar 11, 2021](#issuecomment-796851740) • edited Loading

| Using coturn's testing tools I'm checking if the relaying is being blocked. On the current build of restund indeed still relaying the addresses.:  ``` $ nix run nixpkgs.coturn $ turnutils_uclient  -X 192.168.0.136 -u test -w secret -e 127.0.0.2 & turnutils_uclient  -X 192.168.0.136 -u test -w secret -e 255.255.255.255 &  turnutils_uclient  -X 192.168.0.136 -u test -w secret -e 169.254.0.1   ```  `turn` command on `status` interface shows 127.0.0.2, 255.255.255.255 and 169.254.0.1 being relayed  ``` TURN relay=192.168.0.136 relay6=? (err 5/0) - 34295 UDP/192.168.0.136:34159/192.168.0.136:3478 - 192.168.0.136:38566 "test" 594s (drop 0/0)     permissions: (169.254.0.1 295s relay 5/0)     channels:    (0x59c7 169.254.0.1:3481 595s) - 37255 UDP/192.168.0.136:37119/192.168.0.136:3478 - 192.168.0.136:35496 "test" 655s (drop 0/0)     permissions:     channels:    - 37268 UDP/192.168.0.136:37132/192.168.0.136:3478 - 192.168.0.136:34725 "test" 594s (drop 0/0)     permissions: (127.0.0.2 295s relay 5/0)     channels:    (0x6db7 127.0.0.2:3481 595s) (0x6fce 127.0.0.2:3480 595s) - 37472 UDP/192.168.0.136:37336/192.168.0.136:3478 - 192.168.0.136:34724 "test" 771s (drop 0/0)     permissions:     channels:    - 42726 UDP/192.168.0.136:42590/192.168.0.136:3478 - 192.168.0.136:35114 "test" 156s (drop 0/0)     permissions:     channels:    - 43796 UDP/192.168.0.136:43660/192.168.0.136:3478 - 192.168.0.136:52394 "test" 594s (drop 0/0)     permissions: (255.255.255.255 295s relay 0/0)     channels:    (0x701e 255.255.255.255:3481 595s) - 47256 UDP/192.168.0.136:47120/192.168.0.136:3478 - 192.168.0.136:52854 "test" 594s (drop 0/0)     permissions: (127.0.0.2 295s relay 5/0)     channels:    (0x6719 127.0.0.2:3481 595s) - 47291 UDP/192.168.0.136:47155/192.168.0.136:3478 - 192.168.0.136:43029 "test" 594s (drop 0/0)     permissions: (169.254.0.1 295s relay 5/0)     channels:    (0x45b8 169.254.0.1:3481 595s) (0x54fb 169.254.0.1:3480 595s) - 52136 UDP/192.168.0.136:52000/192.168.0.136:3478 - 192.168.0.136:47978 "test" 631s (drop 0/0)     permissions:     channels:    - 52855 UDP/192.168.0.136:52719/192.168.0.136:3478 - 192.168.0.136:43028 "test" 771s (drop 0/0)     permissions:     channels:    - 54504 UDP/192.168.0.136:54368/192.168.0.136:3478 - 192.168.0.136:37080 "test" 771s (drop 0/0)     permissions:     channels:    - 55756 UDP/192.168.0.136:55620/192.168.0.136:3478 - 192.168.0.136:37081 "test" 594s (drop 0/0)     permissions: (255.255.255.255 295s relay 0/0)     channels:    (0x77f2 255.255.255.255:3480 595s) (0x5455 255.255.255.255:3481 595s) - 57837 UDP/192.168.0.136:57701/192.168.0.136:3478 - 192.168.0.136:46828 "test" 179s (drop 0/0)     permissions:     channels:    ```  I will now make a new build and see if the issue is mitigated |
| --- |

All reactions

Sorry, something went wrong.

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
[force-pushed](/wireapp/restund/compare/53cffc720447fde36eef5e6f4fd27e77e2b282bf..c887de053ed527379e921fb1cc034f853074eddd)
the
block\_local\_any

branch
2 times, most recently
from
[`53cffc7`](/wireapp/restund/commit/53cffc720447fde36eef5e6f4fd27e77e2b282bf) to
[`c887de0`](/wireapp/restund/commit/c887de053ed527379e921fb1cc034f853074eddd)  [Compare](/wireapp/restund/compare/53cffc720447fde36eef5e6f4fd27e77e2b282bf..c887de053ed527379e921fb1cc034f853074eddd)
[March 11, 2021 17:35](#event-4446515052)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)

`[Add Dockerfile and github action](/wireapp/restund/pull/7/commits/c30f2f579b57394c380ad3b7f13be3cb84574a2f "Add Dockerfile and github action

So that we can easily see if pull requests build")`
 …

`[c30f2f5](/wireapp/restund/pull/7/commits/c30f2f579b57394c380ad3b7f13be3cb84574a2f)`

```
So that we can easily see if pull requests build
```

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
[force-pushed](/wireapp/restund/compare/c887de053ed527379e921fb1cc034f853074eddd..c30f2f579b57394c380ad3b7f13be3cb84574a2f)
the
block\_local\_any

branch
from
[`c887de0`](/wireapp/restund/commit/c887de053ed527379e921fb1cc034f853074eddd) to
[`c30f2f5`](/wireapp/restund/commit/c30f2f579b57394c380ad3b7f13be3cb84574a2f)  [Compare](/wireapp/restund/compare/c887de053ed527379e921fb1cc034f853074eddd..c30f2f579b57394c380ad3b7f13be3cb84574a2f)
[March 11, 2021 17:38](#event-4446529819)

 [arianvp](/arianvp)
added 2 commits
[March 11, 2021 18:43](#commits-pushed-20b0b9a)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)

`[Also build the zrest and drain modules by default](/wireapp/restund/pull/7/commits/20b0b9a31234ad4a82aabc7e0916b54f42872c55 "Also build the zrest and drain modules by default")`

`[20b0b9a](/wireapp/restund/pull/7/commits/20b0b9a31234ad4a82aabc7e0916b54f42872c55)`

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)

`[Add entrypoint to dockerfile](/wireapp/restund/pull/7/commits/1d4b671127f434968258e6308c805df1e7f6f217 "Add entrypoint to dockerfile")`

`[1d4b671](/wireapp/restund/pull/7/commits/1d4b671127f434968258e6308c805df1e7f6f217)`

[![arianvp](https://avatars.githubusercontent.com/u/628387?s=60&v=4)](/arianvp)

**[arianvp](/arianvp)**
suggested changes
[Mar 11, 2021](#pullrequestreview-610111353)

 [View reviewed changes](/wireapp/restund/pull/7/files/1d4b671127f434968258e6308c805df1e7f6f217)

Copy link

Contributor

### @arianvp **[arianvp](/arianvp)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@z-dule](https://github.com/z-dule) I tried to see if the issue at hand is fixed with this build; but I'm still able to succesfully open a channel-bind on `127.0.0.1`.

[![image](https://user-images.githubusercontent.com/628387/110838587-edbf9280-82a2-11eb-8a18-5aec9866f903.png)](https://user-images.githubusercontent.com/628387/110838587-edbf9280-82a2-11eb-8a18-5aec9866f903.png)

Maybe I'm missing something here. but it doesn't seem fixed.

Sorry, something went wrong.

All reactions

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=80&v=4)](/arianvp)

Copy link

Contributor

### **[arianvp](/arianvp)** commented [Mar 11, 2021](#issuecomment-796966562) • edited Loading

| Aaaah looking at the code where we add the check we're already past the channel-bind and at the "send data packets" part and we simply drop the packets on the floor. Is that correct?  But could we also add the check to   [restund/modules/turn/chan.c](https://github.com/wireapp/restund/blob/edd4abd92f2a8b08a4ef4b704b84dcb13fb28231/modules/turn/chan.c#L232)  Line 232 in [edd4abd](/wireapp/restund/commit/edd4abd92f2a8b08a4ef4b704b84dcb13fb28231)   |  | void chanbind\_request(struct allocation \*al, struct restund\_msgctx \*ctx, | | --- | --- |    so that the channel-bind actually fails instead of accepting and silently dropping packets?   In short; also add the check to `request_handler`; not just `raw_handler` and `indication_handler`  would that make sense?  NOTE: This is me not knowing a lot about TURN so please tell me when I'm saying stupid things =) |
| --- | --- | --- |

 👍
2
 franziskuskiefer and GingerAdonis reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@z-dule](https://avatars.githubusercontent.com/u/2952716?s=40&v=4)](/z-dule)

`[Disallow channel binding on blocked addresses](/wireapp/restund/pull/7/commits/deaef9ca241d9e68237cdce948c3c33a209cb312 "Disallow channel binding on blocked addresses")`

`[deaef9c](/wireapp/restund/pull/7/commits/deaef9ca241d9e68237cdce948c3c33a209cb312)`

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
[force-pushed](/wireapp/restund/compare/384630e7e4b6c9fe5878173fb92cb79b183bb5e8..3c2ec5060d940b9a6d834ae24e4a22deb8404185)
the
block\_local\_any

branch
5 times, most recently
from
[`384630e`](/wireapp/restund/commit/384630e7e4b6c9fe5878173fb92cb79b183bb5e8) to
[`3c2ec50`](/wireapp/restund/commit/3c2ec5060d940b9a6d834ae24e4a22deb8404185)  [Compare](/wireapp/restund/compare/384630e7e4b6c9fe5878173fb92cb79b183bb5e8..3c2ec5060d940b9a6d834ae24e4a22deb8404185)
[March 12, 2021 11:34](#event-4450231371)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)

`[Add test to check relaying](/wireapp/restund/pull/7/commits/22a5994f7bfbf77479634810c52d255332fc5b20 "Add test to check relaying")`

`[22a5994](/wireapp/restund/pull/7/commits/22a5994f7bfbf77479634810c52d255332fc5b20)`

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
[force-pushed](/wireapp/restund/compare/3c2ec5060d940b9a6d834ae24e4a22deb8404185..22a5994f7bfbf77479634810c52d255332fc5b20)
the
block\_local\_any

branch
from
[`3c2ec50`](/wireapp/restund/commit/3c2ec5060d940b9a6d834ae24e4a22deb8404185) to
[`22a5994`](/wireapp/restund/commit/22a5994f7bfbf77479634810c52d255332fc5b20)  [Compare](/wireapp/restund/compare/3c2ec5060d940b9a6d834ae24e4a22deb8404185..22a5994f7bfbf77479634810c52d255332fc5b20)
[March 12, 2021 11:43](#event-4450265634)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)

`[Also still check for ::1](/wireapp/restund/pull/7/commits/87ca8fcf490cf1094c9107094db7c8f2e62d13ed "Also still check for ::1

Do this by calling sa_is_loopback which checks for 127.0.0.1 and ::1
(but not 127.0.0.0/8)")`
 …

`[87ca8fc](/wireapp/restund/pull/7/commits/87ca8fcf490cf1094c9107094db7c8f2e62d13ed)`

```
Do this by calling sa_is_loopback which checks for 127.0.0.1 and ::1
(but not 127.0.0.0/8)
```

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
[force-pushed](/wireapp/restund/compare/29ea22c4b1bb737fa015bc56ba1c5f7d700f7d7c..87ca8fcf490cf1094c9107094db7c8f2e62d13ed)
the
block\_local\_any

branch
from
[`29ea22c`](/wireapp/restund/commit/29ea22c4b1bb737fa015bc56ba1c5f7d700f7d7c) to
[`87ca8fc`](/wireapp/restund/commit/87ca8fcf490cf1094c9107094db7c8f2e62d13ed)  [Compare](/wireapp/restund/compare/29ea22c4b1bb737fa015bc56ba1c5f7d700f7d7c..87ca8fcf490cf1094c9107094db7c8f2e62d13ed)
[March 12, 2021 12:02](#event-4450339783)

[![franziskuskiefer](https://avatars.githubusercontent.com/u/890105?s=60&v=4)](/franziskuskiefer)

**[franziskuskiefer](/franziskuskiefer)**
approved these changes
[Mar 12, 2021](#pullrequestreview-610718323)

 [View reviewed changes](/wireapp/restund/pull/7/files/87ca8fcf490cf1094c9107094db7c8f2e62d13ed)

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
merged commit [`5c0ed84`](/wireapp/restund/commit/5c0ed84b578c6af7cadd80d6c7b36681d7a3a0fc)
into
master

[Mar 12, 2021](https://github.com/wireapp/restund/pull/7#event-4450377283)

 [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp)
[arianvp](/arianvp)
deleted the
block\_local\_any

branch
[March 12, 2021 12:11](#event-4450377533)

[![@micmac1](https://avatars.githubusercontent.com/u/10446172?s=40&v=4)](/micmac1)
[micmac1](/micmac1)
mentioned this pull request
[Dec 3, 2021](#ref-issue-1071014772)

[restund: status and open CVE
openwrt/telephony#714](/openwrt/telephony/issues/714)

Closed

[micmac1](/micmac1)
added a commit
to micmac1/telephony
that referenced
this pull request
[Dec 6, 2021](#ref-commit-dec6316)
[![@micmac1](https://avatars.githubusercontent.com/u/10446172?s=40&v=4)](/micmac1)

`[restund: fix CVE-2021-21382](/micmac1/telephony/commit/dec6316f2f9204f3c34fadc7616435ddecf19e6c "restund: fix CVE-2021-21382

Patches taken from [1].

[1] https://github.com/wireapp/restund/pull/7

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>")`
…

`[dec6316](/micmac1/telephony/commit/dec6316f2f9204f3c34fadc7616435ddecf19e6c)`

```
Patches taken from [1].

[1] [wireapp/restund#7](https://github.com/wireapp/restund/pull/7)

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>
```

[micmac1](/micmac1)
added a commit
to micmac1/telephony
that referenced
this pull request
[Dec 6, 2021](#ref-commit-4ca76cb)
[![@micmac1](https://avatars.githubusercontent.com/u/10446172?s=40&v=4)](/micmac1)

`[restund: fix CVE-2021-21382](/micmac1/telephony/commit/4ca76cbccd2c9380ebd794a19ab1bbb55c98972e "restund: fix CVE-2021-21382

Patches taken from [1].

[1] https://github.com/wireapp/restund/pull/7

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>
(cherry picked from commit dec6316f2f9204f3c34fadc7616435ddecf19e6c)")`
…

`[4ca76cb](/micmac1/telephony/commit/4ca76cbccd2c9380ebd794a19ab1bbb55c98972e)`

```
Patches taken from [1].

[1] [wireapp/restund#7](https://github.com/wireapp/restund/pull/7)

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>
(cherry picked from commit [dec6316](https://github.com/micmac1/telephony/commit/dec6316f2f9204f3c34fadc7616435ddecf19e6c))
```

This was referenced Dec 6, 2021

[[21.02] restund: fix CVE-2021-21382
openwrt/telephony#716](/openwrt/telephony/pull/716)
 Merged

[[19.07] restund: fix CVE-2021-21382
openwrt/telephony#717](/openwrt/telephony/pull/717)
 Merged

[micmac1](/micmac1)
added a commit
to micmac1/telephony
that referenced
this pull request
[Dec 8, 2021](#ref-commit-612a753)
[![@micmac1](https://avatars.githubusercontent.com/u/10446172?s=40&v=4)](/micmac1)

`[restund: fix CVE-2021-21382](/micmac1/telephony/commit/612a7535eed4bf9d6617eb71c30e6ed28fa89563 "restund: fix CVE-2021-21382

Patches taken from [1].

Added a postinstall note about the upcoming deletion of this package.

[1] https://github.com/wireapp/restund/pull/7

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>
(cherry picked from commit dec6316f2f9204f3c34fadc7616435ddecf19e6c)")`
…

`[612a753](/micmac1/telephony/commit/612a7535eed4bf9d6617eb71c30e6ed28fa89563)`

```
Patches taken from [1].

Added a postinstall note about the upcoming deletion of this package.

[1] [wireapp/restund#7](https://github.com/wireapp/restund/pull/7)

Signed-off-by: Sebastian Kemper <sebastian_ml@gmx.net>
(cherry picked from commit [dec6316](https://github.com/micmac1/telephony/commit/dec6316f2f9204f3c34fadc7616435ddecf19e6c))
```

[![@micmac1](https://avatars.githubusercontent.com/u/10446172?s=40&v=4)](/micmac1)
[micmac1](/micmac1)
mentioned this pull request
[Dec 8, 2021](#ref-pullrequest-1074933935)

[restund: fix CVE-2021-21382
openwrt/telephony#720](/openwrt/telephony/pull/720)
 Merged

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Frestund%2Fpull%2F7).

Reviewers

[![@arianvp](https://avatars.githubusercontent.com/u/628387?s=40&v=4)](/arianvp) [arianvp](/arianvp)

arianvp requested changes

[![@franziskuskiefer](https://avatars.githubusercontent.com/u/890105?s=40&v=4)](/franziskuskiefer) [franziskuskiefer](/franziskuskiefer)

franziskuskiefer approved these changes

[![@julialongtin](https://avatars.githubusercontent.com/u/16826370?s=40&v=4)](/julialongtin) [julialongtin](/julialongtin)

 Awaiting requested review from julialongtin

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@z-dule](https://avatars.githubusercontent.com/u/2952716?s=52&v=4)](/z-dule) [![@arianvp](https://avatars.githubusercontent.com/u/628387?s=52&v=4)](/arianvp) [![@franziskuskiefer](https://avatars.githubusercontent.com/u/890105?s=52&v=4)](/franziskuskiefer) [![@julialongtin](https://avatars.githubusercontent.com/u/16826370?s=52&v=4)](/julialongtin)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_401362f6_20250114_181137.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoturn%2Fcoturn%2Fsecurity%2Fadvisories%2FGHSA-6g6j-r9rf-cm7p)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoturn%2Fcoturn%2Fsecurity%2Fadvisories%2FGHSA-6g6j-r9rf-cm7p)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=coturn%2Fcoturn)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[coturn](/coturn)
/
**[coturn](/coturn/coturn)**
Public

* [Notifications](/login?return_to=%2Fcoturn%2Fcoturn) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fcoturn%2Fcoturn)
* [Star
   11.7k](/login?return_to=%2Fcoturn%2Fcoturn)

* [Code](/coturn/coturn)
* [Issues
  361](/coturn/coturn/issues)
* [Pull requests
  35](/coturn/coturn/pulls)
* [Discussions](/coturn/coturn/discussions)
* [Actions](/coturn/coturn/actions)
* [Projects
  0](/coturn/coturn/projects)
* [Wiki](/coturn/coturn/wiki)
* [Security](/coturn/coturn/security)
* [Insights](/coturn/coturn/pulse)

Additional navigation options

* [Code](/coturn/coturn)
* [Issues](/coturn/coturn/issues)
* [Pull requests](/coturn/coturn/pulls)
* [Discussions](/coturn/coturn/discussions)
* [Actions](/coturn/coturn/actions)
* [Projects](/coturn/coturn/projects)
* [Wiki](/coturn/coturn/wiki)
* [Security](/coturn/coturn/security)
* [Insights](/coturn/coturn/pulse)

# Loopback bypass by using 0.0.0.0, [::1] or [::] as the peer address

High

[misi](/misi)
published
GHSA-6g6j-r9rf-cm7p
Jan 11, 2021

## Package

No package listed

## Affected versions

<4.5.2

## Patched versions

4.5.2

## Description

## Description

By default coturn does not allow peers to connect and relay packets to loopback addresses in the range of `127.x.x.x`. However, it was observed that when sending a `CONNECT` request with the `XOR-PEER-ADDRESS` value of `0.0.0.0`, a successful response was received and subsequently, `CONNECTIONBIND` also received a successful response. Coturn then is able to relay packets to the loopback interface.

Additionally, when coturn is listening on IPv6, which is default, the loopback interface can also be reached by making use of either `[::1]` or `[::]` as the peer address.

## Impact

By using the address `0.0.0.0` as the peer address, a malicious user will be able to relay packets to the loopback interface, unless `--denied-peer-ip=0.0.0.0` (or similar) has been specified. Since the default configuration implies that loopback peers are not allowed, coturn administrators may choose to not set the `denied-peer-ip` setting.

## How we reproduced the issue

1. Run coturn using the following command:

   ```
   turnserver -v --user=username1:password1

   ```
2. Run our internal tool `stunner`, acting as a socks5 proxy which uses TURN.

   ```
   stunner turn peer proxy socks5 tcp://172.17.0.2:3478 \
       --local-bind 0.0.0.0:9999 -u username1:password1

   ```
3. Run a cURL command to connect to `127.0.0.1:80`.

   ```
   curl -x socks5h://127.0.0.1:9999 http://127.0.0.1

   ```
4. The following log was observed, confirming that 127.0.0.1 is being blocked:

   ```
   725: IPv4. tcp or tls connected to: 172.17.0.1:36504
   725: session 011000000000000001: realm <172.17.0.2> user <>:
       incoming packet message processed, error 401: Unauthorized
   725: IPv4. Local relay addr: 172.17.0.2:51705
   725: session 011000000000000001: new, realm=<172.17.0.2>, username=<username1>,
       lifetime=600
   725: session 011000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet ALLOCATE processed, success
   725: session 011000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet CONNECT processed, error 403: Forbidden IP
   725: session 011000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet message processed, error 403: Forbidden IP

   ```
5. Run a cURL command to connect to `0.0.0.0:80`.

   ```
   curl -x socks5h://127.0.0.1:9999 http://0.0.0.0

   ```
6. The following log was observed, confirming that the loopback protection has been bypassed:

   ```
   1010: IPv4. tcp or tls connected to: 172.17.0.1:37240
   1010: session 005000000000000001: realm <172.17.0.2> user <>:
       incoming packet message processed, error 401: Unauthorized
   1010: IPv4. Local relay addr: 172.17.0.2:62504
   1010: session 005000000000000001: new, realm=<172.17.0.2>,
       username=<username1>, lifetime=600
   1010: session 005000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet ALLOCATE processed, success
   1010: session 005000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet CONNECT processed, success
   1010: IPv4. tcp or tls connected to: 172.17.0.1:37242
   1010: session 000000000000000001: client socket to be closed in client handler
   1010: session 000000000000000001: usage: realm=<172.17.0.2>, username=<>
   1010: session 005000000000000001: realm <172.17.0.2> user <username1>:
       incoming packet CONNECTION_BIND processed, success
   1010: session 000000000000000001: peer usage: realm=<172.17.0.2>
   1010: session 000000000000000001: closed (2nd stage), user <>
       realm <172.17.0.2> origin <>, local 172.17.0.2:3478,
       remote 172.17.0.1:37242, reason: general

   ```

The 5th step could be repeated with the URL of `http://[::1]` and `http://[::]` where a similar behaviour can be observed of bypassing the default protection against loopback connections.

## Workarounds: Solution and recommendations

The addresses in the address block `0.0.0.0/8`, `[::1]` and `[::]` should be denied by default unless `--allow-loopback-peers` has been specified.

### Patches

The issue patched in version 4.5.2.

Users should upgrade to 4.5.2.

## CVSS 3.1

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N

<https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N>

## CWE

* IPv6 loopback [::1] is not matched correctly. Wrongly the 8-th byte matched for 1 not the correct 16-th.

  <https://cwe.mitre.org/data/definitions/682.html>
* All zero IP was allowed as peer IP by default

  <https://cwe.mitre.org/data/definitions/441.html>

## Credits: About Enable Security

[Enable Security](https://www.enablesecurity.com) develops offensive security tools and provides quality penetration testing to help protect your real-time communications systems against attack.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [coturn](https://github.com/coturn/coturn/issues)

### Severity

High

### CVE ID

CVE-2020-26262

### Weaknesses

No CWEs

### Credits

* [![@sandrogauci](https://avatars.githubusercontent.com/u/1313984?s=40&v=4)](/sandrogauci)
  [sandrogauci](/sandrogauci)
  Analyst
* [![@alfredfarrugia](https://avatars.githubusercontent.com/u/75253439?s=40&v=4)](/alfredfarrugia)
  [alfredfarrugia](/alfredfarrugia)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from talosintelligence.com_f285d388_20250114_181141.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0732

## coTURN TURN server unsafe loopback forwarding default configuration vulnerability

##### January 29, 2018

##### CVE Number

CVE-2018-4058

### Summary

An exploitable unsafe default configuration vulnerability exists in the TURN server functionality of coTURN prior to 4.5.0.9. By default, the TURN server allows relaying external traffic to the loopback interface of its own host. This can provide access to other private services running on that host, which can lead to further attacks. An attacker can set up a relay with a loopback address as the peer on an affected TURN server to trigger this vulnerability.

### Tested Versions

coTURN 4.5.0.5

### Product URLs

<https://github.com/coturn/coturn>

### CVSSv3 Score

7.7 - CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N

### CWE

CWE-250: Execution with Unnecessary Privileges

### Details

coTURN is an open-source implementation of TURN and STUN servers that can be used as a general-purpose networking traffic TURN server. TURN servers are usually deployed in so-called “DMZ” zones — any server reachable by the internet — to provide firewall traversal solutions. Attackers who are able to take over such servers may be able to bypass firewalls and conduct further attacks.

According to Shodawn, thousands of coTURN servers are directly reachable on the internet.

The default options of affected coTURN servers allow TURN clients to set up peers being a loopback address. This setup forwards traffic from an external interface to a loopback interface of the server, and provides access to other services running on the loopback interface that would otherwise be private.

### Mitigation

Run the coTURN server with the following option to disable loopback forwarding:

```
--no-loopback-peers				Disallow peers on the loopback addresses (127.x.x.x and ::1)

```
### Timeline

2017-09-04 - Vendor Disclosure

2019-01-28 - Vendor Patched

2019-01-29 - Public Release

##### Credit

Discovered by Nicolas Edet of Cisco.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0733](/vulnerability_reports/TALOS-2018-0733) [Previous Report

TALOS-2018-0730](/vulnerability_reports/TALOS-2018-0730)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from github.com_e6fea11d_20250114_181141.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Frestund%2Fsecurity%2Fadvisories%2FGHSA-96j5-w9jq-pv2x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Frestund%2Fsecurity%2Fadvisories%2FGHSA-96j5-w9jq-pv2x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=wireapp%2Frestund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 21, 2024. It is now read-only.

[wireapp](/wireapp)
/
**[restund](/wireapp/restund)**
Public archive

* [Notifications](/login?return_to=%2Fwireapp%2Frestund) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2Fwireapp%2Frestund)
* [Star
   2](/login?return_to=%2Fwireapp%2Frestund)

* [Code](/wireapp/restund)
* [Issues
  1](/wireapp/restund/issues)
* [Pull requests
  1](/wireapp/restund/pulls)
* [Actions](/wireapp/restund/actions)
* [Security](/wireapp/restund/security)
* [Insights](/wireapp/restund/pulse)

Additional navigation options

* [Code](/wireapp/restund)
* [Issues](/wireapp/restund/issues)
* [Pull requests](/wireapp/restund/pulls)
* [Actions](/wireapp/restund/actions)
* [Security](/wireapp/restund/security)
* [Insights](/wireapp/restund/pulse)

# Unsafe loopback forwarding interface

High

[franziskuskiefer](/franziskuskiefer)
published
GHSA-96j5-w9jq-pv2x
Jun 11, 2021

## Package

No package listed

## Affected versions

<0.4.15

## Patched versions

0.4.15

## Description

### Impact

The restund TURN server can be instructed to open a relay to the loopback address range. This allows you to reach any other service running on localhost which you might consider private. In the configuration that we ship (<https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43>) the `status` interface of restund is enabled and is listening on `127.0.0.1`.The `status` interface allows users to issue administrative commands to `restund` like listing open relays or draining connections. It would be possible for an attacker to contact the status interface and issue administrative commands by setting `XOR-PEER-ADDRESS` to `127.0.0.1:{{restund_udp_status_port}}` when opening a TURN channel.

### Mitigation

We now explicitly disallow relaying to loopback addresses, 'any' addresses, link local addresses, and the broadcast address.

See [#7](https://github.com/wireapp/restund/pull/7)

### Workarounds

* Disable the `status` module in your restund configuration. However there might still be other services running on `127.0.0.0/8` that you do not want to have exposed.
* The `turn` module can be disabled. Restund will still perform STUN and this might already be enough for initiating calls in your environments. TURN is only used as a last resort when other NAT traversal options do not work.

### Further notes

One should also make sure that the TURN server is set up with firewall rules so that it cannot relay to other addresses that you don't want the TURN server to relay to. For example other services in the same VPC where the TURN server is running. Ideally TURN servers should be deployed in an isolated fashion where they can only reach what they need to reach to perform their task of assisting NAT-traversal.

Also see <https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else>

### References

A more detailed analysis of the issue in coturn: <https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/> and <https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732>

### For more information

This is the same issue that was recently fixed in coturn: [GHSA-6g6j-r9rf-cm7p](https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p "GHSA-6g6j-r9rf-cm7p")

### Severity

High

### CVE ID

CVE-2021-21382

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.wire.com_eac286dd_20250114_181135.html ===

[![Logo](../_static/Wire_logo.svg)](../index.html)

Contents:

* [Security responses](../security-responses/index.html)
* [Release Notes](../changelog/index.html)
* [Installation](../how-to/install/index.html)
* [Administration](../how-to/administrate/index.html)
* [Reference](index.html)
  + [Architecture Overview](overview.html)
  + [Single Sign-On and User Provisioning](single-sign-on/index.html)
  + Audio/video calling, restund servers (TURN/STUN)
    - [Introduction](#introduction)
    - [Architecture](#architecture)
    - [What is it used for](#what-is-it-used-for)
    - [Network](#network)
    - [Protocols and open ports](#protocols-and-open-ports)
      * [Control ports](#control-ports)
    - [Amount of users and file descriptors](#amount-of-users-and-file-descriptors)
    - [Load balancing and high-availability](#load-balancing-and-high-availability)
    - [Discovery and establishing a call](#discovery-and-establishing-a-call)
    - [DNS](#dns)
  + [Conference Calling 2.0 (aka SFT)](sft.html)
  + [Federated Conference Calling](sft.html#federated-conference-calling)
  + [Minio](minio.html)
  + [Helm](helm.html)
  + [Federation](federation/index.html)
  + [Connecting Wire Clients](associate/index.html)
  + [Client API documentation](api-client-perspective/index.html)
  + [Crypto libraries and sources of randomness](crypto-libs.html)
  + [Block personal user creation](block-user-creation.html)
  + [Classified Domains](classified-domains.html)
  + [Federation](configure-federation.html)
  + [Installing and setting up Legal Hold](legalhold.html)
  + [Messaging Layer Security (MLS)](mls.html)
  + [User Searchability](searchability.html)
  + [Server and team feature settings](team-feature-settings.html)
* [Developers Notes](../developer/index.html)

[Wire](../index.html)

* [Reference](index.html)
* Restund (TURN) servers
* [Edit on GitHub](https://github.com/wireapp/wire-server/blob/develop/docs/src/understand/restund.md)

---

# Restund (TURN) servers[ï](#restund-turn-servers "Link to this heading")

## Introduction[ï](#introduction "Link to this heading")

Restund servers allow two users on different networks (for
example Alice who is in an office connected to an office router and Bob
who is at home connected to a home router) to have a Wire audio or video
call. More precisely:

> Restund is a modular and flexible
> [STUN](https://en.wikipedia.org/wiki/STUN) and
> [TURN](https://en.wikipedia.org/wiki/Traversal_Using_Relays_around_NAT)
> Server, with IPv4 and IPv6 support.

## Architecture[ï](#architecture "Link to this heading")

Since the restund servers help establishing a connection between two
users, they need to be reachable by both of these users, which usually
means they need to have a **public IP address**.

While one server is enough to get started, two servers provide
high-availability in case one server gets into trouble. A
Restund instance may communicate with other Restund instances.

You can either have restund servers directly exposed to the public
internet:

![../_images/architecture-restund.png](../_images/architecture-restund.png)

Or you can have them reachable by fronting them with a firewall or load
balancer machine that may have a different IP than the server where
restund is installed:

![../_images/architecture-restund-lb.png](../_images/architecture-restund-lb.png)

## What is it used for[ï](#what-is-it-used-for "Link to this heading")

Restund is used to assist in NAT-traversal. Its goal is to connect two clients
who are (possibly both) behind NAT directly in a peer to peer fashion, for
optimal call quality and lowest latency.

client A sends a UDP packet to Restund; which will get address-translated by
the router. Restund then sends back to the client what the source IP and the
source port was that Restund observed. If the client then communicates this to
Client B, Client B will be able to send data to that IP,port pair over UDP if
it does so quickly enough. Client A and B will then have a peer-to-peer leg.

This is not always possible (e.g. symmetric NAT makes this technique
impossible, as the router will NAT a different source-port for each
connection). In that case clients fall back to TURN, which asks Restund to
allocate a relay address which relays packets between nodes A and B.

Restund servers need to have a wide range of ports open to allocate such relay
addresses.

## Network[ï](#network "Link to this heading")

As briefly mentioned above, a TURN server functions as a bridge between
networks. Networks which donât have a direct route defined between them,
usually have distinct address blocks. Depending on the address block they
are configured with - such block is either considered to be *public* or *private*
(aka special-purpose addresses [[RFC 6890]](https://tools.ietf.org/html/rfc6890))

* [IPv4 private blocks](https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml)
* [IPv6 private blocks](https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml)

In cases where a machine, that is hosting the TURN server, also connects
to a *private* network in which other services are running, chances are
that these services are being indirectly exposed through that TURN server.

To prevent this kind of exposure, a TURN server has to be configured with an inclusive
or exclusive list of address blocks to prevents undesired connections from being
established [[1]](#footnote-1). At the moment (Feb. 2021), this functionality is not yet available
with *Restund* on the application-level. Instead, the system-level firewall capabilities
must be utilized. The [IP ranges](https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else)
mentioned in the article [[1]](#footnote-1) should be blocked for egress and, depending on the scenario,
also for ingress traffic. Tools like `iptables` or `ufw` can be used to set this up.

## Protocols and open ports[ï](#protocols-and-open-ports "Link to this heading")

Restund servers provide the best audio/video connections if end-user devices
can connect to them via UDP.

In this case, a firewall (if any) needs to allow and/or forward the complete [default port range](notes/port-ranges.html#port-ranges) for incoming UDP traffic.

Ports for allocations are allocated from the [default port range](notes/port-ranges.html#port-ranges), for more information on this port range, how to read and change it, and how to configure your firewall, see [this note](notes/port-ranges.html#port-ranges).

In case e.g. office firewall rules disallow UDP traffic in this range, there is a possibility to use TCP instead, at the expense of call quality.

Port `3478` is the default control port,
however one UDP port per active connection is required, so a whole port
range must be available and reachable from the outside.

If *Conference Calling 2.0* ([SFT](sft.html#understand-sft)) is enabled, a Restund instance,
additionally, must be allowed to communicate with :[SFT instances](../how-to/install/sft.html#install-sft-firewall-rules)
on the same UDP ports mentioned above. In this scenario a Restund server becomes sort
of a proxy for the client, if the client is not able to establish a media channel between
itself and the SFT server.

*For more information, please refer to the source code of the Ansible role:* [restund](https://github.com/wireapp/ansible-restund/blob/master/tasks/firewall.yml).

### Control ports[ï](#control-ports "Link to this heading")

Restund listens for control messages on port `3478` on both UDP and TCP. It
also can listen on port `5349` which uses TLS. One can reconfigure both ports.
For example, port `5349` can be reconfigured to be port `443`; so that TURN
traffic can not be distinguished from any other TLS traffic. This might help
with overcoming certain firewall restrictions. You can instead use (if thatâs
easier with firewall rules) for example ports `80` and `443` (requires to
run restund as root) or do a redirect from a load balancer (if using one) to
redirect `443 -> 5349` and `80 -> 3478`.

## Amount of users and file descriptors[ï](#amount-of-users-and-file-descriptors "Link to this heading")

Each allocation (active connection by one participant) requires 1 or 2
file descriptors, so ensure you increase your file descriptor limits in
case you have many users.

Currently one restund server can have a maximum of 64000 allocations. If
you have more users than that in an active call, you need to deploy more
restund servers.

## Load balancing and high-availability[ï](#load-balancing-and-high-availability "Link to this heading")

Load balancing is not possible, since STUN/TURN is a stateful protocol,
so UDP packets addressed to `restund server 1`, if by means of a load
balancer were to end up at `restund server 2`, would get dropped, as
the second server doesnât know the source address.

High-availability is nevertheless ensured by having and advertising more
than one restund server. Instead of the load balancer, the clients will
switch their server if it fails.

## Discovery and establishing a call[ï](#discovery-and-establishing-a-call "Link to this heading")

A simplified flow of how restund servers, along with the wire-server are
used to establish a call:

![../_images/flow-restund.png](../_images/flow-restund.png)

## DNS[ï](#dns "Link to this heading")

Usually DNS records are used which point to the public IPs of the
restund servers (or of the respective firewall or load balancer
machines). These DNS names are then used when configuring wire-server.

---

[1]
([1](#id1),[2](#id2))

[Details about CVE-2020-26262, bypass of Coturnâs default access control protection](https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/)

 [Previous](../developer/reference/spar-braindump.html "Spar braindump")
[Next](sft.html "Conference Calling 2.0 (aka SFT)")

---

© Copyright 2019 - 2023, Wire Swiss GmbH.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).



=== Content from github.com_68af3d57_20250114_181138.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fansible-restund%2Fblob%2Fmaster%2Ftemplates%2Frestund.conf.j2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fansible-restund%2Fblob%2Fmaster%2Ftemplates%2Frestund.conf.j2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=wireapp%2Fansible-restund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 21, 2024. It is now read-only.

[wireapp](/wireapp)
/
**[ansible-restund](/wireapp/ansible-restund)**
Public archive

* [Notifications](/login?return_to=%2Fwireapp%2Fansible-restund) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fwireapp%2Fansible-restund)
* [Star
   0](/login?return_to=%2Fwireapp%2Fansible-restund)

* [Code](/wireapp/ansible-restund)
* [Issues
  2](/wireapp/ansible-restund/issues)
* [Pull requests
  4](/wireapp/ansible-restund/pulls)
* [Actions](/wireapp/ansible-restund/actions)
* [Projects
  0](/wireapp/ansible-restund/projects)
* [Security](/wireapp/ansible-restund/security)
* [Insights](/wireapp/ansible-restund/pulse)

Additional navigation options

* [Code](/wireapp/ansible-restund)
* [Issues](/wireapp/ansible-restund/issues)
* [Pull requests](/wireapp/ansible-restund/pulls)
* [Actions](/wireapp/ansible-restund/actions)
* [Projects](/wireapp/ansible-restund/projects)
* [Security](/wireapp/ansible-restund/security)
* [Insights](/wireapp/ansible-restund/pulse)

## Files

 master
## Breadcrumbs

1. [ansible-restund](/wireapp/ansible-restund/tree/master)
2. /[templates](/wireapp/ansible-restund/tree/master/templates)
/
# restund.conf.j2

Copy path Blame  Blame
## Latest commit

## History

[History](/wireapp/ansible-restund/commits/master/templates/restund.conf.j2)executable file·46 lines (39 loc) · 1.84 KB master
## Breadcrumbs

1. [ansible-restund](/wireapp/ansible-restund/tree/master)
2. /[templates](/wireapp/ansible-restund/tree/master/templates)
/
# restund.conf.j2

Top
## File metadata and controls

* Code
* Blame

executable file·46 lines (39 loc) · 1.84 KB[Raw](https://github.com/wireapp/ansible-restund/raw/refs/heads/master/templates/restund.conf.j2)12345678910111213141516171819202122232425262728293031323334353637383940414243444546# coredaemon nodebug norealm dummy.iosyncinterval 600udp\_listen {{ hostvars[inventory\_hostname]['ansible\_' + restund\_network\_interface].ipv4.address }}:{{ restund\_udp\_listen\_port }}udp\_sockbuf\_size 524288tcp\_listen {{ hostvars[inventory\_hostname]['ansible\_' + restund\_network\_interface].ipv4.address }}:{{ restund\_tcp\_listen\_port }}{% if restund\_tls\_certificate is defined %}tls\_listen {{ hostvars[inventory\_hostname]['ansible\_' + restund\_network\_interface].ipv4.address }}:{{ restund\_tls\_listen\_port }},/usr/local/etc/restund/restund.pem{% endif %}
# modulesmodule\_path /usr/local/lib/restund/modulesmodule stat.somodule drain.somodule binding.somodule auth.somodule turn.somodule zrest.somodule status.so
# authauth\_nonce\_expiry 3600
# turnturn\_max\_allocations 64000turn\_max\_lifetime 3600turn\_relay\_addr {{ hostvars[inventory\_hostname]['ansible\_' + restund\_network\_interface].ipv4.address }}
{% if restund\_peer\_udp\_advertise\_addr is defined and hostvars[inventory\_hostname]['ansible\_' + restund\_network\_interface].ipv4.address != restund\_peer\_udp\_advertise\_addr %}# turn\_public\_addr is an IP which must be reachable for UDP traffic from other restund servers (and from this server itself). If unset, defaults to 'turn\_relay\_addr'turn\_public\_addr {{ restund\_peer\_udp\_advertise\_addr }}{% endif %}
# syslogsyslog\_facility 24
# statusstatus\_udp\_addr 127.0.0.1status\_udp\_port {{ restund\_udp\_status\_port }}status\_http\_addr 127.0.0.1status\_http\_port {{ restund\_http\_status\_port }}
# zrestzrest\_secret {{ restund\_zrest\_secret }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


