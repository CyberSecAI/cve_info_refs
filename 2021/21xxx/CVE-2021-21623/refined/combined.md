=== Content from www.openwall.com_c4be3d93_20250114_191047.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20241D7D-8489-4A8A-82BE-7CFD4F92E1F8@beckweb.net>
Date: Thu, 18 Mar 2021 14:28:59 +0100
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* CloudBees AWS Credentials Plugin 1.28.1
* Libvirt Agents Plugin 1.9.1
* Matrix Authorization Strategy Plugin 2.6.6
* Role-based Authorization Strategy Plugin 3.1.1
* Warnings Next Generation Plugin 8.5.0

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://www.jenkins.io/security/advisory/2021-03-18/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-2180 / CVE-2021-21623
Items (like jobs) can be organized hierarchically in Jenkins, using the
Folders Plugin or something similar. An item is expected to be accessible
only if all its ancestors are accessible as well.

Matrix Authorization Strategy Plugin 2.6.5 and earlier does not correctly
perform permission checks to determine whether an item should be
accessible.

This allows attackers with Item/Read permission on nested items to access
them, even if they lack Item/Read permission for parent folders.

SECURITY-2182 / CVE-2021-21624
Items (like jobs) can be organized hierarchically in Jenkins, using the
Folders Plugin or something similar. An item is expected to be accessible
only if all its ancestors are accessible as well.

Role-based Authorization Strategy Plugin 3.1 and earlier does not correctly
perform permission checks to determine whether an item should be
accessible.

This allows attackers with Item/Read permission on nested items to access
them, even if they lack Item/Read permission for parent folders.

SECURITY-2032 / CVE-2021-21625
CloudBees AWS Credentials Plugin 1.28 and earlier does not perform a
permission check in a helper method for HTTP endpoints.

This allows attackers with Overall/Read permission to enumerate credentials
IDs of AWS credentials stored in Jenkins if any of the following plugins
are installed:

* Amazon Elastic Container Service (ECS) / Fargate
* AWS Parameter Store Build Wrapper
* AWS SAM

Further plugins may use this helper method as well without performing a
permission check themselves.

Credentials IDs obtained this way can be used as part of an attack to
capture the credentials using another vulnerability.

SECURITY-2041 / CVE-2021-21626
Warnings Next Generation Plugin 8.4.4 and earlier does not perform
permission checks in methods implementing form validation.

This allows attackers with Item/Read permission but without Item/Workspace
or Item/Configure permission to check whether attacker-specified file
patterns match workspace contents. A sequence of requests can be used to
effectively list workspace contents.

SECURITY-1764 / CVE-2021-21627
Libvirt Agents Plugin 1.9.0 and earlier does not require POST requests for
a form submission endpoint, resulting in a cross-site request forgery
(CSRF) vulnerability.

This vulnerability allows attackers to stop hypervisor domains.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.jenkins.io_f5884728_20250114_191048.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2021-03-18

This advisory announces vulnerabilities in the following Jenkins deliverables:

* [AWS Credentials
  Plugin](https://plugins.jenkins.io/aws-credentials)
* [Libvirt Agents
  Plugin](https://plugins.jenkins.io/libvirt-slave)
* [Matrix Authorization Strategy
  Plugin](https://plugins.jenkins.io/matrix-auth)
* [Role-based Authorization Strategy
  Plugin](https://plugins.jenkins.io/role-strategy)
* [Warnings
  Plugin](https://plugins.jenkins.io/warnings-ng)

## Descriptions

### Incorrect permission checks in Matrix Authorization Strategy Plugin may allow accessing some items

**SECURITY-2180
/
CVE-2021-21623**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N)

**Affected plugin:
[`matrix-auth`](https://plugins.jenkins.io/matrix-auth)**

**Description:**

Items (like jobs) can be organized hierarchically in Jenkins, using the Folders Plugin or something similar.
An item is expected to be accessible only if all its ancestors are accessible as well.

Matrix Authorization Strategy Plugin 2.6.5 and earlier does not correctly perform permission checks to determine whether an item should be accessible.

This allows attackers with Item/Read permission on nested items to access them, even if they lack Item/Read permission for parent folders.

Matrix Authorization Strategy Plugin 2.6.6 requires Item/Read permission on parent items to grant Item/Read permission on an individual item.

As a workaround in older releases, do not grant permissions on individual items to users who do not have access to parent items.

In case of problems, the [Java system property](/doc/book/managing/system-properties/) `hudson.security.AuthorizationMatrixProperty.checkParentPermissions` can be set to `false`, completely disabling this fix.

### Incorrect permission checks in Role-based Authorization Strategy Plugin may allow accessing some items

**SECURITY-2182
/
CVE-2021-21624**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N)

**Affected plugin:
[`role-strategy`](https://plugins.jenkins.io/role-strategy)**

**Description:**

Items (like jobs) can be organized hierarchically in Jenkins, using the Folders Plugin or something similar.
An item is expected to be accessible only if all its ancestors are accessible as well.

Role-based Authorization Strategy Plugin 3.1 and earlier does not correctly perform permission checks to determine whether an item should be accessible.

This allows attackers with Item/Read permission on nested items to access them, even if they lack Item/Read permission for parent folders.

Role-based Authorization Strategy Plugin 3.1.1 requires Item/Read permission on parent items to grant Item/Read permission on an individual item.

As a workaround in older releases, do not grant permissions on individual items to users who do not have access to parent items.

In case of problems, the [Java system property](/doc/book/managing/system-properties/) `com.michelin.cio.hudson.plugins.rolestrategy.RoleMap.checkParentPermissions` can be set to `false`, completely disabling this fix.

### Missing permission checks in AWS Credentials Plugin allows enumerating credentials IDs

**SECURITY-2032
/
CVE-2021-21625**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`aws-credentials`](https://plugins.jenkins.io/aws-credentials)**

**Description:**

AWS Credentials Plugin 1.28 and earlier does not perform a permission check in a helper method for HTTP endpoints.

This allows attackers with Overall/Read permission to enumerate credentials IDs of AWS credentials stored in Jenkins if any of the following plugins are installed:

* [Amazon Elastic Container Service (ECS) / Fargate](https://plugins.jenkins.io/amazon-ecs)
* [AWS Parameter Store Build Wrapper](https://plugins.jenkins.io/aws-parameter-store)
* [AWS SAM](https://plugins.jenkins.io/aws-sam)

Further plugins may use this helper method as well without performing a permission check themselves.

Credentials IDs obtained this way can be used as part of an attack to capture the credentials using another vulnerability.

AWS Credentials Plugin 1.28.1 performs permission checks in the helper method for HTTP endpoints.

### Missing permission checks in Warnings Plugin allow listing workspace contents

**SECURITY-2041
/
CVE-2021-21626**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`warnings-ng`](https://plugins.jenkins.io/warnings-ng)**

**Description:**

Warnings Plugin 8.4.4 and earlier does not perform permission checks in methods implementing form validation.

This allows attackers with Item/Read permission but without Item/Workspace or Item/Configure permission to check whether attacker-specified file patterns match workspace contents.
A sequence of requests can be used to effectively list workspace contents.

Warnings Plugin 8.5.0 requires Item/Configure permission to validate patterns with workspace contents.

### CSRF vulnerability in Libvirt Agents Plugin

**SECURITY-1764
/
CVE-2021-21627**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Affected plugin:
[`libvirt-slave`](https://plugins.jenkins.io/libvirt-slave)**

**Description:**

Libvirt Agents Plugin 1.9.0 and earlier does not require POST requests for a form submission endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to stop hypervisor domains.

Libvirt Agents Plugin 1.9.1 requires POST requests for the affected HTTP endpoint.

## Severity

* SECURITY-1764:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L)
* SECURITY-2032:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-2041:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-2180:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N)
* SECURITY-2182:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N)

## Affected Versions

* **AWS Credentials
  Plugin**
  up to and including
  1.28
* **Libvirt Agents
  Plugin**
  up to and including
  1.9.0
* **Matrix Authorization Strategy
  Plugin**
  up to and including
  2.6.5
* **Role-based Authorization Strategy
  Plugin**
  up to and including
  3.1
* **Warnings
  Plugin**
  up to and including
  8.4.4

## Fix

* **AWS Credentials
  Plugin**
  should be updated to version
  1.28.1
* **Libvirt Agents
  Plugin**
  should be updated to version
  1.9.1
* **Matrix Authorization Strategy
  Plugin**
  should be updated to version
  2.6.6
* **Role-based Authorization Strategy
  Plugin**
  should be updated to version
  3.1.1
* **Warnings
  Plugin**
  should be updated to version
  8.5.0

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-2032, SECURITY-2041, SECURITY-2182
* **Wadeck Follonier, CloudBees, Inc.**
  for
  SECURITY-1764


