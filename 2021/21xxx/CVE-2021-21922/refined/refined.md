The content is related to CVE-2021-21922.

**Root cause of vulnerability:**
The vulnerability lies in the improper use of prepared statements in conjunction with stored procedures. Specifically, variables used to construct SQL queries are not properly sanitized when invoked against the database, even after initial sanitization attempts. The `username_filter` parameter is concatenated into an SQL query without proper protection.

**Weaknesses/vulnerabilities present:**
SQL Injection vulnerability (CWE-89). The application fails to properly sanitize user-supplied input (`username_filter`) before using it in an SQL query.

**Impact of exploitation:**
An attacker can inject arbitrary SQL code, potentially leading to:
*   Data exfiltration (reading sensitive data from the database)
*   Data modification (altering or deleting data)
*   Denial of service
*   Potentially gaining access to the underlying operating system

**Attack vectors:**
By crafting a malicious HTTP GET request to the `/r-seenet/index.php?page=user_list` page, an attacker can inject SQL code via the `username_filter` parameter.

**Required attacker capabilities/position:**
*   The attacker needs to be authenticated with an administrative account or be able to use Cross-Site Request Forgery (CSRF) to trigger the vulnerability.
*   The attacker needs to be able to send HTTP requests to the vulnerable application.