```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by improper handling of absolute paths within the `php_zip_make_relative_path()` function in the PHP zip extension. On Windows, a path starting with a forward slash is not an absolute path but rather a relative path pointing to the current volume, which can be exploited by crafting a malicious zip archive to extract files outside the intended destination directory.",
    "weaknesses": [
      "Path traversal vulnerability due to incorrect path sanitization on Windows.",
       "The `php_zip_make_relative_path()` function incorrectly identifies Windows paths starting with a forward slash as relative rather than absolute."
    ],
    "impact": "An attacker can craft a malicious ZIP archive that, when extracted using `ZipArchive::extractTo()`, can write files outside the specified destination directory, potentially overwriting system files or other sensitive data. This can lead to arbitrary code execution, data modification or denial of service. ",
    "attack_vectors": [
      "Crafting a ZIP archive with file paths that start with a forward slash, followed by directory traversal sequences like `..\\` or `..\/`."
    ],
    "required_capabilities": "An attacker needs to be able to create or modify zip archives and have the ability to trigger the extraction with `ZipArchive::extractTo()` on a vulnerable PHP instance."
  },
    "additional_details": {
        "affected_versions": "PHP versions 7.3.x prior to 7.3.31, 7.4.x prior to 7.4.24, and 8.0.x prior to 8.0.11.",
    "fix": "The fix was implemented by correcting the path sanitization logic using the `IS_ABSOLUTE_PATH` macro and the `COPY_WHEN_ABSOLUTE` macro, which are defined differently on Windows and non-Windows systems. This change ensures that paths starting with a forward slash are correctly identified as relative or absolute and handled accordingly.",
        "notes": "The vulnerability was initially reported via a comment on a commit and later confirmed to be reproducible on Windows platforms. The vulnerability does not seem to be exploitable on Linux systems due to different behaviour of path handling."
    }
}
```