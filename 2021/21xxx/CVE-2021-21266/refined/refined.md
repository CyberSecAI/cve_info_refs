```
{
  "cve": "CVE-2021-21266",
  "content": [
    {
      "type": "article",
      "source": "www.contrastsecurity.com_151b792c_20250114_212808.html",
      "vulnerability": "XML External Entity (XXE) Attack",
      "description": "The article discusses the risk of XML External Entity (XXE) attacks in Java applications using JAXB and other XML parsing technologies. It highlights that relying on default secure configurations of JAXB implementations is unreliable and can lead to vulnerabilities.",
      "details": {
        "root_cause": "The root cause is the insecure default configuration of many XML parsers that allow external entity resolution, combined with the flexibility of Java XML technologies which allows developers to accidentally replace secure implementations with insecure ones.",
        "weaknesses": [
          "XML External Entity (XXE) vulnerability",
          "Insecure default configurations of XML parsers",
          "Accidental replacement of secure XML parsing libraries with insecure ones",
          "Unsafe usage of JAXB APIs"
        ],
        "impact": "Successful exploitation of the XXE vulnerability allows an attacker to access sensitive files on the server, potentially leading to information disclosure.",
        "attack_vectors": "An attacker sends a crafted XML document to a vulnerable application that uses an XML parser allowing external entity resolution.",
        "attacker_capabilities": "An attacker needs to be able to send a malicious XML document to the vulnerable application."
      },
      "remediation": "The article recommends configuring XML parsers to disallow external entities and doctype declarations, and explicitly setting security controls for the parsers used by JAXB to process XML data. It also recommends using Contrast Assess to detect vulnerabilities and Contrast Protect to block attacks.",
        "additional_information": "The article gives an example of an XXE attack and provides guidance on securing JAXB by configuring the underlying XML parsers using SAXParserFactory. It also provides code snippets that show how to disable external entities. It mentions that OpenJDK 1.8 JAXB runtime uses a secure configuration by default, but this configuration is brittle. It also discusses how including a rogue JAXB runtime or replacing the SAX parser can bypass the secure configuration."
    },
    {
      "type": "commit",
      "source": "github.com_201512ed_20250114_212800.html",
        "vulnerability": "XML External Entity (XXE) vulnerability",
      "description": "This commit fixes XXE vulnerabilities in multiple openHAB add-ons by applying security configurations to the XML parsers.",
      "details": {
        "root_cause": "The root cause is the use of XML parsers (SAX and JAXB) with default settings that allow external entity resolution, making them vulnerable to XXE attacks.",
         "weaknesses": [
          "XML External Entity (XXE) vulnerability",
            "Insecure default configurations of XML parsers",
            "Use of vulnerable XML parsing libraries (JAXB, SAX)"
          ],
         "impact": "Successful exploitation of the XXE vulnerability could allow an attacker to access sensitive files from the file system on the openHAB server.",
        "attack_vectors": "An attacker sends a crafted XML document to a vulnerable openHAB add-on.",
          "attacker_capabilities":"The attacker needs to be able to send malicious XML data to the affected openHAB add-ons."
      },
       "remediation": "The commit remediates the vulnerability by setting the `setFeature` method of the XML parsers to `false` for features that allow external entities, and by using an `XMLInputFactory` that has `IS_SUPPORTING_EXTERNAL_ENTITIES` and `SUPPORT_DTD` set to false.",
        "additional_information":"The commit modifies multiple files across various add-ons, including `avmfritz`, `bosesoundtouch`, `denonmarantz`, `dlinksmarthome`, `enigma2`, `fmiweather`, `fsinternetradio`, `gce`, `homematic`, `hpprinter`, `ihc`, `insteon`, `onkyo`, `samsungtv`, `sonos`, `tellstick`, `vitotronic`, `wemo`, `yamahareceiver`, and `xpath`. The changes involve disabling external entity resolution in the XML parsers used by these add-ons."
    },
      {
      "type": "advisory",
       "source": "github.com_9eb813d4_20250114_212800.html",
      "vulnerability": "XML External Entity (XXE) vulnerability",
      "description": "This GitHub Security Advisory describes XXE vulnerabilities in multiple add-ons of openHAB, which could allow an attacker in the same network to retrieve internal information.",
      "details": {
        "root_cause": "The root cause is the usage of SAX or JAXB parsing of externally received XML without proper configuration to prevent XXE attacks.",
         "weaknesses": [
          "XML External Entity (XXE) vulnerability",
            "Insecure parsing of XML data",
             "Use of vulnerable XML parsing libraries (JAXB, SAX)"
          ],
        "impact": "Successful exploitation of the XXE vulnerability could allow an attacker to retrieve internal information like the contents of files from the file system.",
        "attack_vectors": "An attacker sends a crafted XML document via SSDP requests or other input mechanisms to a vulnerable openHAB add-on.",
        "attacker_capabilities": "The attacker needs to be in the same network as the openHAB instance and be able to send malicious XML data."
      },
        "remediation": "The advisory mentions that the vulnerabilities have been fixed by a stricter configuration of the used XML parser in openHAB versions 2.5.12 and 3.0.1.",
      "additional_information":"The advisory lists several openHAB add-ons potentially impacted by the XXE vulnerability, including `AvmFritz`, `BoseSoundtouch`, `DenonMarantz`, `DLinkSmarthome`, `Enigma2`, `FmiWeather`, `FSInternetRadio`, `Gce`, `Homematic`, `HPPrinter`, `IHC`, `Insteon`, `Onkyo`, `Roku`, `SamsungTV`, `Sonos`, `Tellstick`, `TR064`, `UPnPControl`, `Vitotronic`, `Wemo`, `YamahaReceiver`, and `XPath Transformation`."
    },
    {
      "type":"article",
      "source": "dev.to_d3989f50_20250114_212758.html",
      "vulnerability": "XML External Entity (XXE) Attack",
        "description": "The article provides a general overview of XXE vulnerabilities in Java applications and how to prevent them by disabling external entities in XML parsers.",
        "details": {
         "root_cause": "The root cause is that most XML parsers have external entities enabled by default, which can be exploited to read arbitrary files.",
        "weaknesses": [
          "XML External Entity (XXE) vulnerability",
           "Insecure default configurations of XML parsers"
          ],
        "impact": "Successful exploitation of the XXE vulnerability could allow an attacker to read the content of arbitrary files on the machine.",
           "attack_vectors": "An attacker sends a crafted XML document to a vulnerable application.",
        "attacker_capabilities":"The attacker needs to be able to send a malicious XML document to a vulnerable application."
      },
       "remediation": "The article recommends disabling external entities by setting the appropriate features in the `SAXParserFactory` and `XMLReader` objects.",
      "additional_information":"The article provides a sample XML payload that can be used to trigger an XXE vulnerability and sample code of a vulnerable SAX parser. It also gives an example of how to disable external entities using  `setFeature` method on `SAXParserFactory` and `XMLReader` objects and provides link to OWASP XXE Cheatsheet and Snyk's blog post about 10 Java Security Best Practices"
    }
  ]
}
```