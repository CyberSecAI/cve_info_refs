- **Root cause of vulnerability**: The `home_security` binary in Anker Eufy Homebase 2 fails to properly sanitize user-supplied input within the `wifi_country_code_update` command handler. Specifically, the `country_code` field extracted from a JSON payload is directly inserted into a system command without any sanitization, resulting in OS command injection.
- **Weaknesses/vulnerabilities present**: OS command injection (CWE-78). Lack of input sanitization when processing the `country_code` parameter from JSON data within the `wifi_country_code_update` command handler.
- **Impact of exploitation**: Arbitrary command execution as root on the affected device, allowing for full compromise and potential malicious activity.
- **Attack vectors**: Network packets sent to the device via UDP port 8006 to the IP address `18.224.66.194` containing a crafted JSON payload with a malicious `country_code` value when using the `wifi_country_code_update` command.
- **Required attacker capabilities/position**: An attacker needs to be able to send network packets to the device on the local network or have the ability to perform a man-in-the-middle attack. Additionally, they need to be able to bypass the authentication requirement for this command, possibly using previously discovered vulnerabilities.