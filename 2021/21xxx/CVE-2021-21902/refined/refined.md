The provided content is related to CVE-2021-21902.

**Root Cause:**
A race condition exists in the `run_server_6877` functionality of Garrett Metal Detectors iC Module CMA Version 5.0. The software maintains separate lists for authenticated and unauthenticated connections. When a valid password is provided by an unauthenticated connection, certain fields are copied to an authenticated structure. However, a flaw in the spawning of authenticated threads allows an attacker to supplant themselves as the socket associated with the recently authenticated connection. Specifically, the socket associated with the new thread is set to the most recently accepted socket, not the socket which supplied the password.

**Weaknesses/Vulnerabilities:**
- **Authentication Bypass:** Due to the race condition, an attacker can gain access to the authenticated CLI without knowing the password.
- **Incorrect Implementation of Authentication Algorithm (CWE-303):** The vulnerability is caused by a flawed implementation of the authentication process.

**Impact of Exploitation:**
- An attacker can gain full access to the CLI interface of the iC Module.
- This allows the attacker to monitor statistics (alarm and visitor counts) in real-time and make configuration changes to the metal detectors.

**Attack Vectors:**
- The attack vector is network-based, targeting TCP port 6877 of the vulnerable device.

**Required Attacker Capabilities/Position:**
- The attacker must be on the network and be able to establish a connection to TCP port 6877 of the target device.
- The attacker needs to establish a connection between the time a legitimate user connects and when the user provides the correct password
- No knowledge of the device password is required.