Based on the provided information, here's a breakdown of the vulnerabilities related to CVE-2021-4372:

**Root Cause:**

*   The WooCommerce Dynamic Pricing and Discounts plugin (versions 2.4.1 and below) has two main vulnerabilities:
    *   **Unauthenticated Settings Import:** The plugin's `import` function lacks capability checks and security nonces, allowing unauthenticated users to import settings.
    *   **Unauthenticated Settings Export:** The plugin's `export` function lacks capability checks, allowing unauthenticated users to export settings.
*   The `import` function does not sanitize certain fields, allowing injection of malicious Javascript code within the imported JSON file.

**Weaknesses/Vulnerabilities:**

*   **Missing Access Control:** The `import` and `export` functions can be accessed without authentication.
*   **Missing Security Nonce:** The `import` function lacks a security nonce, making it vulnerable to CSRF attacks.
*   **Stored Cross-Site Scripting (XSS):**  The lack of sanitization in the `import` function allows for the injection of malicious JavaScript code within settings data.

**Impact of Exploitation:**

*   **Stored XSS:** An attacker can inject malicious JavaScript into the plugin's settings. This code is then executed on every product page, affecting the e-shop's frontend.
    *   This can result in:
        *   Redirecting visitors to malicious websites using meta refresh tags.
        *   Executing arbitrary JavaScript code in the context of the affected website.
*   **Information Disclosure:** While not the primary impact, the export vulnerability allows an attacker to export the plugin's settings, which could expose sensitive information or configuration details.

**Attack Vectors:**

*   **Network:** The vulnerabilities can be exploited remotely over the network.
*   **HTTP Request:** The `import` function is triggered by a file upload, and the `export` function by a specific request parameter.

**Required Attacker Capabilities/Position:**

*   **No Authentication Required:** The attacker does not need to be logged into the WordPress site to exploit these vulnerabilities.
*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable WordPress site.
*   For the XSS, the attacker needs to be able to craft a malicious settings file with injected javascript and upload it.

**Additional Details:**

*   The `import` function loads if a file is uploaded with the name `$_FILES['rp_wcdpd_settings']['rp_wcdpd_import']`.
*   The `export` function is triggered if `$_REQUEST['rp_wcdpd_export_settings']` is not empty.
*   The issue was reported on August 18, 2021, and a patched version (2.4.2) was released on August 22, 2021. However, the initial patch did not fully address CSRF issues.
*  The exported settings can be reimported using the import vulnerability.

This information is consistent with the description of CVE-2021-4372 as it details a stored XSS vulnerability, caused by missing sanitization of imported settings. The lack of authentication required for both import and export functionalities of the plugin also contributes to the severity of this CVE.