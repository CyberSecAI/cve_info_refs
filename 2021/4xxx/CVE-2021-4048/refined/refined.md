```
{
  "cveId": "CVE-2021-4048",
  "description": "An out-of-bounds read flaw was found in the CLARRV, DLARRV, SLARRV, and ZLARRV functions in lapack through version 3.10.0, as also used in OpenBLAS before version 0.3.18. Specially crafted inputs passed to these functions could cause an application using lapack to crash or possibly disclose portions of its memory.",
  "vulnerabilityDetails": {
    "rootCause": "The vulnerability stems from insufficient input validation within the `CLARRV`, `DLARRV`, `SLARRV`, and `ZLARRV` functions. Specifically, the code does not properly handle cases where the number of input eigenvalues (`M`) is zero or invalid. This lack of validation leads to an out-of-bounds read during the execution of the function.",
    "weaknesses": [
      "Out-of-bounds read"
    ],
    "impact": "A specially crafted input to the vulnerable functions could lead to a crash, potentially allowing an attacker to disclose portions of the memory.",
    "attackVectors": [
      "Specially crafted inputs to vulnerable LAPACK functions (`CLARRV`, `DLARRV`, `SLARRV`, and `ZLARRV`)."
    ],
      "requiredCapabilities": "An attacker needs the ability to provide specially crafted numerical input data to an application that uses a vulnerable version of LAPACK or OpenBLAS.",
      "position": "The attacker does not need to be in any specific location, they just need to be able to provide the malformed input to the application using LAPACK."
  },
  "affectedSoftware": {
    "products": [
        "LAPACK",
        "OpenBLAS"
     ],
    "versions": [
      "LAPACK versions up to 3.10.0",
        "OpenBLAS versions before 0.3.18"
    ]
  },
  "additionalNotes": "The fix involves adding a check at the beginning of the affected functions to handle cases where N or M is less than or equal to 0, causing an early return and preventing out-of-bounds reads. The fix was applied to the `s`, `d`, `c`, and `z` versions of `xlarrv` functions. This vulnerability is triggered when requesting eigenvectors corresponding to an interval that doesn't contain any eigenvalues, leading to M=0 in the vulnerable function."
}
```