Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2021-4073:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the insecure implementation of the AJAX action `wp_ajax_nopriv_rm_login_social_user`, intended for social logins. This action, mapped to the function `social_login_using_email`, does not properly authenticate the user-supplied email address.

**Weaknesses/Vulnerabilities Present:**

*   **Authentication Bypass:** The core issue is the lack of authentication or validation of the email address provided in the POST request. The function checks if an email exists in the database and then directly logs in as that user by setting an authentication cookie (`wp_set_auth_cookie`) without further verification.
*   **Insecure Direct Object Reference:** The function directly operates on user data (email) provided by the attacker without proper authorization checks.
*   **Nonce check bypassable:** The nonce needed to exploit the vulnerability could be easily obtained from the source code of a login/registration page with a form generated by RegistrationMagic.

**Impact of Exploitation:**

*   **Complete Account Takeover:** An unauthenticated attacker can log in as any user, including administrator accounts, on the affected website. This allows an attacker to completely take over and control the vulnerable WordPress instance.
*  **Data Breach**: An attacker with admin privileges can also extract sensitive database information.

**Attack Vectors:**

*   **Direct POST Request:** An attacker sends a crafted POST request to the WordPress AJAX endpoint (`/wp-admin/admin-ajax.php`) with the following parameters:
    *   `action`: set to `rm_login_social_user`
    *   `email`: the target user's email address (or username, which is then converted to email)
    *   `security`: valid nonce
*   **Unauthenticated Attack:** No prior authentication is required to exploit this vulnerability.

**Required Attacker Capabilities/Position:**

*   **Knowledge of a Valid Email or Username:** The attacker needs to know a valid email address or username registered on the website.
*   **Access to a RegistrationMagic Login Form:** The attacker must have access to a login page using a form generated by the vulnerable plugin, to obtain a valid nonce.
* **Ability to Enumerate Usernames (Optional)**: If the attacker doesn't know a valid email or username, they may attempt to enumerate the users on the affected site.

**Additional Information:**

*   **CVSS Score:** 9.8 (Critical)
*   **Affected Plugin:** RegistrationMagic â€“ Custom Registration Forms, User Registration and User Login Plugin
*   **Affected Versions:** <= 5.0.1.7
*   **Fully Patched Version:** 5.0.1.8
*  **Wordfence firewall rule:** A firewall rule to protect from this vulnerability was deployed on September 15, 2021 for Wordfence premium users, and 30 days later for free users.

**Technical Details**

The vulnerable function:

```php
public function social_login_using_email($user_email = null, $user_fname = null,$type=null) {
	$ajax_check = check_ajax_referer('rm-social-login-security', 'security'); // Check referer validity
	if($ajax_check == false) {
		$resp = array('code' => 'denied', 'msg' => __('Request denied','custom-registration-form-builder-with-submission-manager'));
		echo json_encode($resp);
		die;
	}
	if (isset($_POST['email']))
		$user_email = $_POST['email'];
	if (isset($_POST['first_name']))
		$user_fname = $_POST['first_name'];
	else
		$user_fname = null;
	$type= isset($_POST['type']) ? $_POST['type'] : '';
	$user_model= new RM_User;
	$gopts = new RM_Options;
	$resp = array('code' => 'allowed', 'msg' => '');
	$login_service= new RM_Login_Service();
	// error_log($user_email); error_log($user_fname);
	$user = $user_email;
	if ($user_email != null) {
		if (email_exists($user_email)) { // user is a member
			$user = get_user_by('email', $user_email);
			$user_id = (int) $user->data->ID;
			$is_disabled = (int) get_user_meta($user_id, 'rm_user_status', true);

			if (!$is_disabled){
				//$login_service->insert_login_log(array('email'=>$user->user_email,'ip'=> $_SERVER['REMOTE_ADDR'],'time'=> current_time('timestamp'),'status'=>1,'type'=>'social:'.$type,'result'=>'success'));
				$login_service->insert_login_log(array('email'=>$user->user_email,'username_used'=>$user_email,'ip'=> $_SERVER['REMOTE_ADDR'],'time'=> current_time('timestamp'),'status'=>1,'type'=>'social','result'=>'success','social_type'=>$type));
				wp_set_auth_cookie($user_id, true);
			}
```

The code checks if a user exists with the provided email using `email_exists` and then sets the auth cookie based on the user ID without performing additional authorization checks.

This summary provides a comprehensive overview of the vulnerability as described in the provided content.