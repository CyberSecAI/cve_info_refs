=== Content from github.com_bf431cd0_20250114_203955.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fcommit%2Fbb4e33bf68bf89cad44d386192cbed201f35b241)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fcommit%2Fbb4e33bf68bf89cad44d386192cbed201f35b241)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=go-yaml%2Fyaml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[go-yaml](/go-yaml)
/
**[yaml](/go-yaml/yaml)**
Public

* [Notifications](/login?return_to=%2Fgo-yaml%2Fyaml) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fgo-yaml%2Fyaml)
* [Star
   6.9k](/login?return_to=%2Fgo-yaml%2Fyaml)

* [Code](/go-yaml/yaml)
* [Issues
  294](/go-yaml/yaml/issues)
* [Pull requests
  129](/go-yaml/yaml/pulls)
* [Actions](/go-yaml/yaml/actions)
* [Security](/go-yaml/yaml/security)
* [Insights](/go-yaml/yaml/pulse)

Additional navigation options

* [Code](/go-yaml/yaml)
* [Issues](/go-yaml/yaml/issues)
* [Pull requests](/go-yaml/yaml/pulls)
* [Actions](/go-yaml/yaml/actions)
* [Security](/go-yaml/yaml/security)
* [Insights](/go-yaml/yaml/pulse)

## Commit

[Permalink](/go-yaml/yaml/commit/bb4e33bf68bf89cad44d386192cbed201f35b241)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add logic to catch cases of alias abuse.

[Browse files](/go-yaml/yaml/tree/bb4e33bf68bf89cad44d386192cbed201f35b241)
Browse the repository at this point in the history

```
Backport of [caeefd8](https://github.com/go-yaml/yaml/commit/caeefd850a4388b005740feb8a31067e8654497f).
```

* Loading branch information

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=40&v=4)](/niemeyer)

[niemeyer](/go-yaml/yaml/commits?author=niemeyer "View all commits by niemeyer")
committed
Sep 30, 2019

1 parent
[7b8349a](/go-yaml/yaml/commit/7b8349ac747c6a24702b762d2c4fd9266cf4f1d6)

commit bb4e33b

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**25 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* decode.go
  [decode.go](#diff-7f87da95366e3cf56cfcb5904ee3127a3e89e6152a6a004a7e3de529e3a8a937)
* decode\_test.go
  [decode\_test.go](#diff-373fb23355f8ed601aa2d3c450033ccd8cf067b36ae6255cb9d2af857bf71f55)

## There are no files selected for viewing

13 changes: 13 additions & 0 deletions

13
[decode.go](#diff-7f87da95366e3cf56cfcb5904ee3127a3e89e6152a6a004a7e3de529e3a8a937 "decode.go")

Show comments

[View file](/go-yaml/yaml/blob/bb4e33bf68bf89cad44d386192cbed201f35b241/decode.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -229,6 +229,10 @@ type decoder struct { |
|  |  | mapType reflect.Type |
|  |  | terrors []string |
|  |  | strict bool |
|  |  |  |
|  |  | decodeCount int |
|  |  | aliasCount int |
|  |  | aliasDepth int |
|  |  | } |
|  |  |  |
|  |  | var ( |
| Expand Down  Expand Up | | @@ -315,6 +319,13 @@ func (d \*decoder) prepare(n \*node, out reflect.Value) (newout reflect.Value, unm |
|  |  | } |
|  |  |  |
|  |  | func (d \*decoder) unmarshal(n \*node, out reflect.Value) (good bool) { |
|  |  | d.decodeCount++ |
|  |  | if d.aliasDepth > 0 { |
|  |  | d.aliasCount++ |
|  |  | } |
|  |  | if d.aliasCount > 100 && d.decodeCount > 1000 && float64(d.aliasCount)/float64(d.decodeCount) > 0.99 { |
|  |  | failf("document contains excessive aliasing") |
|  |  | } |
|  |  | switch n.kind { |
|  |  | case documentNode: |
|  |  | return d.document(n, out) |
| Expand Down  Expand Up | | @@ -353,7 +364,9 @@ func (d \*decoder) alias(n \*node, out reflect.Value) (good bool) { |
|  |  | failf("anchor '%s' value contains itself", n.value) |
|  |  | } |
|  |  | d.aliases[n] = true |
|  |  | d.aliasDepth++ |
|  |  | good = d.unmarshal(n.alias, out) |
|  |  | d.aliasDepth-- |
|  |  | delete(d.aliases, n) |
|  |  | return good |
|  |  | } |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[decode\_test.go](#diff-373fb23355f8ed601aa2d3c450033ccd8cf067b36ae6255cb9d2af857bf71f55 "decode_test.go")

Show comments

[View file](/go-yaml/yaml/blob/bb4e33bf68bf89cad44d386192cbed201f35b241/decode_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -854,6 +854,18 @@ var unmarshalErrorTests = []struct { |
|  |  | {"{{.}}", `yaml: invalid map key: map\[interface\ \{\}\]interface \{\}\{".":interface \{\}\(nil\)\}`}, |
|  |  | {"b: \*a\na: &a {c: 1}", `yaml: unknown anchor 'a' referenced`}, |
|  |  | {"%TAG !%79! tag:yaml.org,2002:\n---\nv: !%79!int '1'", "yaml: did not find expected whitespace"}, |
|  |  | { |
|  |  | "a: &a [00,00,00,00,00,00,00,00,00]\n" + |
|  |  | "b: &b [\*a,\*a,\*a,\*a,\*a,\*a,\*a,\*a,\*a]\n" + |
|  |  | "c: &c [\*b,\*b,\*b,\*b,\*b,\*b,\*b,\*b,\*b]\n" + |
|  |  | "d: &d [\*c,\*c,\*c,\*c,\*c,\*c,\*c,\*c,\*c]\n" + |
|  |  | "e: &e [\*d,\*d,\*d,\*d,\*d,\*d,\*d,\*d,\*d]\n" + |
|  |  | "f: &f [\*e,\*e,\*e,\*e,\*e,\*e,\*e,\*e,\*e]\n" + |
|  |  | "g: &g [\*f,\*f,\*f,\*f,\*f,\*f,\*f,\*f,\*f]\n" + |
|  |  | "h: &h [\*g,\*g,\*g,\*g,\*g,\*g,\*g,\*g,\*g]\n" + |
|  |  | "i: &i [\*h,\*h,\*h,\*h,\*h,\*h,\*h,\*h,\*h]\n", |
|  |  | "yaml: document contains excessive aliasing", |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | func (s \*S) TestUnmarshalErrors(c \*C) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bb4e33b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fcommit%2Fbb4e33bf68bf89cad44d386192cbed201f35b241) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from pkg.go.dev_fda7bad7_20250114_203959.html ===


[![Go](/static/shared/logo/go-white.svg)](https://go.dev/)
 [Skip to Main Content](#main-content)

![](/static/shared/icon/search_gm_grey_24dp.svg)

![](/static/shared/icon/search_gm_grey_24dp.svg)

* Why Go
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Case Studies](https://go.dev/solutions#case-studies)

    Common problems companies solve with Go
  + [Use Cases](https://go.dev/solutions#use-cases)

    Stories about how and why companies use Go
  + [Security Policy](https://go.dev/security/policy/)

    How Go can help keep you secure by default
* [Learn](https://go.dev/learn/)
* Docs
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Effective Go](https://go.dev/doc/effective_go)

    Tips for writing clear, performant, and idiomatic Go code
  + [Go User Manual](https://go.dev/doc/)

    A complete introduction to building software with Go
  + [Standard library](https://pkg.go.dev/std)

    Reference documentation for Go's standard library
  + [Release Notes](https://go.dev/doc/devel/release)

    Learn what's new in each Go release
* [Packages](/)
* Community
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Recorded Talks](https://go.dev/talks/)

    Videos from prior events
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)

    Meet other local Go developers
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)

    Learn and network with Go developers from around the world
  + [Go blog](https://go.dev/blog)

    The Go project's official blog.
  + [Go project](https://go.dev/help)

    Get help and stay informed from Go
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts "Get connected with google-groups (Opens in new window)")
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang "Get connected with github (Opens in new window)")
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang "Get connected with twitter (Opens in new window)")
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/ "Get connected with reddit (Opens in new window)")
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/ "Get connected with slack (Opens in new window)")
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

[![Go.](/static/shared/logo/go-blue.svg)](https://go.dev/)

* Why Go
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Why Go
  + [Case Studies](https://go.dev/solutions#case-studies)
  + [Use Cases](https://go.dev/solutions#use-cases)
  + [Security Policy](https://go.dev/security/policy/)
* [Learn](https://go.dev/learn/)
* Docs
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Docs
  + [Effective Go](https://go.dev/doc/effective_go)
  + [Go User Manual](https://go.dev/doc/)
  + [Standard library](https://pkg.go.dev/std)
  + [Release Notes](https://go.dev/doc/devel/release)
* [Packages](/)
* Community
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Community
  + [Recorded Talks](https://go.dev/talks/)
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)
  + [Go blog](https://go.dev/blog)
  + [Go project](https://go.dev/help)
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts)
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang)
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang)
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/)
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/)
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

1. [Vulnerability Database](/vuln)
2. [All Reports](/vuln/list)
3. GO-2021-0061

# Vulnerability Report: GO-2021-0061

* CVE-2021-4235, GHSA-r88r-gmrh-7j83
* Affects:
  gopkg.in/yaml.v2, github.com/go-yaml/yaml
* Published: Apr 14, 2021
* Modified: May 20, 2024

Due to unbounded alias chasing, a maliciously crafted YAML file can cause the system to consume significant system resources. If parsing user input, this may be used as a denial of service vector.

## Affected Packages

* Path
  Go Versions
  Symbols
* [gopkg.in/yaml.v2](/gopkg.in/yaml.v2)
  before v2.2.3
  + [Decoder.Decode](/gopkg.in/yaml.v2#Decoder.Decode)
  + [Unmarshal](/gopkg.in/yaml.v2#Unmarshal)
  + [UnmarshalStrict](/gopkg.in/yaml.v2#UnmarshalStrict)
* [github.com/go-yaml/yaml](/github.com/go-yaml/yaml)
  all versions, no known fixed
  + [Decoder.Decode](/github.com/go-yaml/yaml#Decoder.Decode)
  + [Unmarshal](/github.com/go-yaml/yaml#Unmarshal)
  + [UnmarshalStrict](/github.com/go-yaml/yaml#UnmarshalStrict)

## Aliases

* [CVE-2021-4235](https://www.cve.org/CVERecord?id=CVE-2021-4235)
* [GHSA-r88r-gmrh-7j83](https://github.com/advisories/GHSA-r88r-gmrh-7j83)

## References

* <https://github.com/go-yaml/yaml/pull/375>
* <https://github.com/go-yaml/yaml/commit/bb4e33bf68bf89cad44d386192cbed201f35b241>
* <https://vuln.go.dev/ID/GO-2021-0061.json>

## Credits

* @simonferquel

## Feedback

See anything missing or incorrect?
[Suggest an edit to this report.](https://github.com/golang/vulndb/issues/new?assignees=&labels=Needs+Triage%2CSuggested+Edit&template=suggest_edit.yaml&title=x%2Fvulndb%3A+suggestion+regarding+GO-2021-0061&report=GO-2021-0061)

[Why Go](https://go.dev/solutions)
[Use Cases](https://go.dev/solutions#use-cases)
[Case Studies](https://go.dev/solutions#case-studies)

[Get Started](https://learn.go.dev/)
[Playground](https://play.golang.org)
[Tour](https://tour.golang.org)
[Stack Overflow](https://stackoverflow.com/questions/tagged/go?tab=Newest)
[Help](https://go.dev/help)

[Packages](https://pkg.go.dev)
[Standard Library](/std)
[Sub-repositories](/golang.org/x)
[About Go Packages](https://pkg.go.dev/about)

[About](https://go.dev/project)
[Download](https://go.dev/dl/)
[Blog](https://go.dev/blog)
[Issue Tracker](https://github.com/golang/go/issues)
[Release Notes](https://go.dev/doc/devel/release.html)
[Brand Guidelines](https://blog.golang.org/go-brand)
[Code of Conduct](https://go.dev/conduct)

[Connect](https://www.twitter.com/golang)
[Twitter](https://www.twitter.com/golang)
[GitHub](https://github.com/golang)
[Slack](https://invite.slack.golangbridge.org/)
[r/golang](https://reddit.com/r/golang)
[Meetup](https://www.meetup.com/pro/go)
[Golang Weekly](https://golangweekly.com/)

![Gopher in flight goggles](/static/shared/gopher/pilot-bust-1431x901.svg)

* [Copyright](https://go.dev/copyright)
* [Terms of Service](https://go.dev/tos)
* [Privacy Policy](http://www.google.com/intl/en/policies/privacy/)
* [Report an Issue](https://go.dev/s/pkgsite-feedback)
* ![System theme](/static/shared/icon/brightness_6_gm_grey_24dp.svg)
  ![Dark theme](/static/shared/icon/brightness_2_gm_grey_24dp.svg)
  ![Light theme](/static/shared/icon/light_mode_gm_grey_24dp.svg)

  Theme Toggle
* ![](/static/shared/icon/keyboard_grey_24dp.svg)

  Shortcuts Modal

[![Google logo](/static/shared/logo/google-white.svg)](https://google.com)

## Jump to

![](/static/shared/icon/close_gm_grey_24dp.svg)

Close

## Keyboard shortcuts

![](/static/shared/icon/close_gm_grey_24dp.svg)

| **?** | : This menu |
| --- | --- |
| **/** | : Search site |
| **f** or **F** | : Jump to |
| **y** or **Y** | : Canonical URL |

Close

go.dev uses cookies from Google to deliver and enhance the quality of its services and to
analyze traffic. [Learn more.](https://policies.google.com/technologies/cookies)
Okay



=== Content from github.com_b2ac1638_20250114_203958.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fpull%2F375)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fpull%2F375)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=go-yaml%2Fyaml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[go-yaml](/go-yaml)
/
**[yaml](/go-yaml/yaml)**
Public

* [Notifications](/login?return_to=%2Fgo-yaml%2Fyaml) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fgo-yaml%2Fyaml)
* [Star
   6.9k](/login?return_to=%2Fgo-yaml%2Fyaml)

* [Code](/go-yaml/yaml)
* [Issues
  294](/go-yaml/yaml/issues)
* [Pull requests
  129](/go-yaml/yaml/pulls)
* [Actions](/go-yaml/yaml/actions)
* [Security](/go-yaml/yaml/security)
* [Insights](/go-yaml/yaml/pulse)

Additional navigation options

* [Code](/go-yaml/yaml)
* [Issues](/go-yaml/yaml/issues)
* [Pull requests](/go-yaml/yaml/pulls)
* [Actions](/go-yaml/yaml/actions)
* [Security](/go-yaml/yaml/security)
* [Insights](/go-yaml/yaml/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgo-yaml%2Fyaml%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgo-yaml%2Fyaml%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add a decoder option to limit the number of unmarshalled values #375

 Closed

[simonferquel](/simonferquel)
wants to merge
2
commits into
[go-yaml:v2](/go-yaml/yaml/tree/v2 "go-yaml/yaml:v2")
from
[simonferquel:limit-recursion](/simonferquel/yaml/tree/limit-recursion "simonferquel/yaml:limit-recursion")

 Closed

# [Add a decoder option to limit the number of unmarshalled values](#top) #375

[simonferquel](/simonferquel)
wants to merge
2
commits into
[go-yaml:v2](/go-yaml/yaml/tree/v2 "go-yaml/yaml:v2")
from
[simonferquel:limit-recursion](/simonferquel/yaml/tree/limit-recursion "simonferquel/yaml:limit-recursion")

+64

‚àí11

[Conversation
15](/go-yaml/yaml/pull/375)
[Commits
2](/go-yaml/yaml/pull/375/commits)
[Checks
0](/go-yaml/yaml/pull/375/checks)
[Files changed
3](/go-yaml/yaml/pull/375/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![simonferquel](https://avatars.githubusercontent.com/u/1677333?s=60&v=4)](/simonferquel)

Copy link

### @simonferquel **[simonferquel](/simonferquel)** commented [Jun 14, 2018](#issue-332347436)

This PR gives user code the opportunity to limit the number of values unmarshalled while decoding a yaml payload.

This is very usefull to protect programs from malicious external yaml documents such as these:

```
version: "3"
services: &services ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*services,*services,*services,*services,*services,*services,*services,*services,*services]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]

```

This is a valid document, but parsing this will crash the program with an out of memory panic at some point.

Sorry, something went wrong.

All reactions

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=40&v=4)](/simonferquel)

`[Add a decoder option to limit the number of marshalled values](/go-yaml/yaml/pull/375/commits/c86e64ed9581b7588e736f0c3e6ecc02cc22996e "Add a decoder option to limit the number of marshalled values

Signed-off-by: Simon Ferquel <simon.ferquel@docker.com>")`
 ‚Ä¶

`[c86e64e](/go-yaml/yaml/pull/375/commits/c86e64ed9581b7588e736f0c3e6ecc02cc22996e)`

```
Signed-off-by: Simon Ferquel <simon.ferquel@docker.com>
```

[![silvin-lubecki](https://avatars.githubusercontent.com/u/31478878?s=60&v=4)](/silvin-lubecki)

**[silvin-lubecki](/silvin-lubecki)**
reviewed
[Jun 14, 2018](#pullrequestreview-128769900)

 [View reviewed changes](/go-yaml/yaml/pull/375/files/c86e64ed9581b7588e736f0c3e6ecc02cc22996e)

[decode\_test.go](/go-yaml/yaml/pull/375/files/c86e64ed9581b7588e736f0c3e6ecc02cc22996e#diff-373fb23355f8ed601aa2d3c450033ccd8cf067b36ae6255cb9d2af857bf71f55)
Outdated

|  |  | d = yaml.NewDecoder(bytes.NewBuffer([]byte(ordinalCase)), yaml.WithLimitDecodedValuesCount(3)) |
| --- | --- | --- |
|  |  | // decoded values are [Hello, World, [Hello:World pair]] |
|  |  | err = d.Decode(&v) |
|  |  | c.Assert(err, Equals, nil) |

Copy link

### @silvin-lubecki **[silvin-lubecki](/silvin-lubecki)** [Jun 14, 2018](#discussion_r195407204)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

c.Assert(err, IsNil)

Sorry, something went wrong.

All reactions

[yaml.go](/go-yaml/yaml/pull/375/files/c86e64ed9581b7588e736f0c3e6ecc02cc22996e#diff-acfe93d173e77894feaede834d0927584abe0fc551dba248d191e16edaa63611)
Outdated

|  |  | @@ -89,26 +89,45 @@ func UnmarshalStrict(in []byte, out interface{}) (err error) { | |
| --- | --- | --- | --- |
|  |  | return unmarshal(in, out, true) |
|  |  | } |
|  |  |  |
|  |  | // DecoderOption is an option to apply to modyfy a decoder's behavior |

Copy link

### @silvin-lubecki **[silvin-lubecki](/silvin-lubecki)** [Jun 14, 2018](#discussion_r195407362)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

typo: s/modyfy/modify

Sorry, something went wrong.

All reactions

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=40&v=4)](/simonferquel)

`[nits](/go-yaml/yaml/pull/375/commits/69d7a9804db8b5ff0515d2689ad34b6e55065fa9 "nits

Signed-off-by: Simon Ferquel <simon.ferquel@docker.com>")`
 ‚Ä¶

`[69d7a98](/go-yaml/yaml/pull/375/commits/69d7a9804db8b5ff0515d2689ad34b6e55065fa9)`

```
Signed-off-by: Simon Ferquel <simon.ferquel@docker.com>
```

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=80&u=6794a82ef9e3836b7d5ec98e63e65c46384c91a4&v=4)](/simonferquel)

Copy link

Author

### **[simonferquel](/simonferquel)** commented [Jun 14, 2018](#issuecomment-397356505)

| [@silvin-lubecki](https://github.com/silvin-lubecki) fixed, thanks :) |
| --- |

 üëç
1
 silvin-lubecki reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=80&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)

Copy link

### **[thaJeztah](/thaJeztah)** commented [Jul 3, 2018](#issuecomment-402067310)

| ping [@rogpeppe](https://github.com/rogpeppe) [@niemeyer](https://github.com/niemeyer) PTAL |
| --- |

All reactions

Sorry, something went wrong.

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=40&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)
[thaJeztah](/thaJeztah)
mentioned this pull request
[Aug 14, 2018](#ref-pullrequest-350373802)

[Make docker/app not exposed to yaml bomb
docker/app#346](/docker/app/pull/346)
 Merged

[![@eclipseo](https://avatars.githubusercontent.com/u/30413512?s=40&v=4)](/eclipseo)
[eclipseo](/eclipseo)
mentioned this pull request
[Jul 3, 2019](#ref-issue-463993944)

[Build error: too many arguments in call to yaml.NewDecoder
docker/compose-on-kubernetes#115](/docker/compose-on-kubernetes/issues/115)

Closed

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=40&u=6794a82ef9e3836b7d5ec98e63e65c46384c91a4&v=4)](/simonferquel)
[simonferquel](/simonferquel)
mentioned this pull request
[Sep 30, 2019](#ref-issue-499548171)

[CVE-2019-11253: Kubernetes API Server JSON/YAML parsing vulnerable to resource exhaustion attack
kubernetes/kubernetes#83253](/kubernetes/kubernetes/issues/83253)

Closed

[![@tedyu](https://avatars.githubusercontent.com/u/235188?s=80&v=4)](/tedyu)

Copy link

### **[tedyu](/tedyu)** commented [Sep 30, 2019](#issuecomment-536674022)

| [@rogpeppe](https://github.com/rogpeppe) [@niemeyer](https://github.com/niemeyer) Can you review this ?  The fix would help mitigate the CVE linked above. |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Sep 30, 2019](#issuecomment-536685668)

| The issue has been addressed in v3 without additional API changes. The proper fix for v2 would be to backport that over. Closing this one on that basis. |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=40&v=4)](/niemeyer)
[niemeyer](/niemeyer)
closed this
[Sep 30, 2019](#event-2674286421)

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=80&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)

Copy link

### **[thaJeztah](/thaJeztah)** commented [Sep 30, 2019](#issuecomment-536691416)

| [@niemeyer](https://github.com/niemeyer) do you know which PR fixed it in v3? Happy to open a backport/cherry-pick (if possible) |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Sep 30, 2019](#issuecomment-536692825)

| [@thaJeztah](https://github.com/thaJeztah) Thanks! That was addressed with [caeefd8](https://github.com/go-yaml/yaml/commit/caeefd850a4388b005740feb8a31067e8654497f) |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Sep 30, 2019](#issuecomment-536709327)

| It's been backported to v2 with [bb4e33b](https://github.com/go-yaml/yaml/commit/bb4e33bf68bf89cad44d386192cbed201f35b241). |
| --- |

All reactions

Sorry, something went wrong.

[![@omeid](https://avatars.githubusercontent.com/u/1453118?s=80&u=54b0f5e2d463bbcc185b2c577c8ee5a79f926444&v=4)](/omeid)

Copy link

### **[omeid](/omeid)** commented [Oct 18, 2019](#issuecomment-543471156)

| You literally copied his contribution without attribution. While it would have been best if the commit was cherry-picked, but the least [@simonferquel](https://github.com/simonferquel) should get credited for this fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Oct 18, 2019](#issuecomment-543564970)

| His proposal:  <https://github.com/go-yaml/yaml/pull/375/files>  What was committed:  [caeefd8](https://github.com/go-yaml/yaml/commit/caeefd850a4388b005740feb8a31067e8654497f)  Enjoy your day. |
| --- |

All reactions

Sorry, something went wrong.

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=80&u=6794a82ef9e3836b7d5ec98e63e65c46384c91a4&v=4)](/simonferquel)

Copy link

Author

### **[simonferquel](/simonferquel)** commented [Oct 18, 2019](#issuecomment-543567275)

| Don't fight over me and this PR please, I don't care if I am mentioned in anything. This commit just allowed to workaround the issue for a project I had, and I made a PR in case it could help others. |
| --- |

 üëç
1
 gZack reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=80&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)

Copy link

### **[thaJeztah](/thaJeztah)** commented [Oct 18, 2019](#issuecomment-543568466)

| [@omeid](https://github.com/omeid) the implementation that was merged is different; this PR suggested a configurable limit, whereas the code merged has a hard coded limit.  The test case looks similar, because both are based on the same YAML exploit (the example can be found on WikiPedia: <https://en.m.wikipedia.org/wiki/Billion_laughs_attack>)  That said, it would've been nice if this PR had gotten attention earlier. |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Oct 18, 2019](#issuecomment-543569639)

| [@simonferquel](https://github.com/simonferquel) You are right, and your help was appreciated. Even if we got something else in, you gave a plave for people to organize around the issue and think about it. Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=80&v=4)](/niemeyer)

Copy link

Contributor

### **[niemeyer](/niemeyer)** commented [Oct 18, 2019](#issuecomment-543572585) ‚Ä¢ edited Loading

| [@thaJeztah](https://github.com/thaJeztah) Yeah, it's internally handled, but it's not quite hardcoded. We consider the percentage of aliases in the overall document. And we also look at the depth since that's where the issue happens. You are also right that this should have been looked into before. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgo-yaml%2Fyaml%2Fpull%2F375)

Reviewers

[![@silvin-lubecki](https://avatars.githubusercontent.com/u/31478878?s=40&v=4)](/silvin-lubecki) [silvin-lubecki](/silvin-lubecki)

silvin-lubecki left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

6 participants

[![@simonferquel](https://avatars.githubusercontent.com/u/1677333?s=52&v=4)](/simonferquel) [![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=52&v=4)](/thaJeztah) [![@tedyu](https://avatars.githubusercontent.com/u/235188?s=52&v=4)](/tedyu) [![@niemeyer](https://avatars.githubusercontent.com/u/378683?s=52&v=4)](/niemeyer) [![@omeid](https://avatars.githubusercontent.com/u/1453118?s=52&v=4)](/omeid) [![@silvin-lubecki](https://avatars.githubusercontent.com/u/31478878?s=52&v=4)](/silvin-lubecki)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_17e81994_20250114_203958.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3479-1] golang-yaml.v2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3479-1] golang-yaml.v2 security update
* *From*: Roberto C. S√°nchez <roberto@debian.org>
* *Date*: Wed, 5 Jul 2023 16:29:31 -0400
* *Message-id*: <[[üîé]](/msgid-search/ZKXSq68Jc92wa7BC%40connexer.com)¬†[ZKXSq68Jc92wa7BC@connexer.com](msg00001.html)>
* *Mail-followup-to*: Roberto C. S√°nchez <roberto@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3479-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                  Roberto C. S√°nchez
July 05, 2023                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : golang-yaml.v2
Version        : 2.2.2-1+deb10u1
CVE ID         : CVE-2021-4235 CVE-2022-3064

Two denial of service vulnerabilities have been discovered in
golang-yaml.v2, a library which provides YAML support for the Go
language.

CVE-2021-4235

    Due to unbounded alias chasing, a maliciously crafted YAML file can
    cause the system to consume significant system resources. If parsing
    user input, this may be used as a denial of service vector.

CVE-2022-3064

    Parsing malicious or large YAML documents can consume excessive
    amounts of CPU or memory.

Thanks to Scarlett Moore for working on preparing this update.

For Debian 10 buster, these problems have been fixed in version
2.2.2-1+deb10u1.

We recommend that you upgrade your golang-yaml.v2 packages.

For the detailed security status of golang-yaml.v2 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/golang-yaml.v2>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpmk11xI1dPY.pgp)**

*Description:* PGP signature

---


