Based on the provided information, here's a breakdown of the vulnerability described by CVE-2021-4090:

**Root Cause of Vulnerability:**
- An out-of-bounds write vulnerability exists in the `nfsd4_decode_bitmap4` function within the Linux kernel's Network File System (NFS) server (NFSD) implementation.
- The function `nfsd4_decode_bitmap4` in `fs/nfsd/nfs4xdr.c` does not properly validate the input `count` value against the provided bitmap length `bmlen`. This allows a malicious client to specify a `count` value larger than `bmlen`.
- When the function iterates to fill the `bmval` array using the `count` value, it can write beyond the allocated space `bmval[bmlen - 1]`.

**Weaknesses/Vulnerabilities Present:**
- **Out-of-bounds write:** The core issue is the lack of proper input validation allowing writes past the boundary of the `bmval` array. This is a classic buffer overflow vulnerability.
- **Lack of input sanitization:** The function does not check if the provided 'count' value is within acceptable bounds of the buffer 'bmval' it is writing into.

**Impact of Exploitation:**
- **Information disclosure:** By writing out-of-bounds, an attacker can potentially overwrite adjacent memory locations. This overwritten memory could contain sensitive information which can then be accessed by the attacker.
- **Data modification:** This overwrite can lead to arbitrary data corruption. This could allow the attacker to modify critical kernel data structures.
- **System compromise:** Ultimately, by modifying kernel data an attacker could potentially escalate their privileges or cause the system to crash, leading to a denial-of-service (DoS) condition or achieve arbitrary code execution.

**Attack Vectors:**
- **Network:** The vulnerability is triggered by a specially crafted NFS request sent to the vulnerable server. An attacker would need to be able to reach the affected server over the network and interact with its NFS service.
- **Local:** According to the Red Hat Bugzilla entry, a "local attacker with user privilege" can trigger this vulnerability.

**Required Attacker Capabilities/Position:**
- **Network access (for network vector):** An attacker would need network access to an NFS server.
- **User privilege (for local vector):** A local attacker with a low-privileged user account on the server can exploit this.
- **Knowledge of NFS protocol:** An attacker would require understanding of the NFSv4 protocol and the structure of the related XDR data to craft a malicious request.

**Additional Information:**
- **Affected Products:** NetApp products using Linux kernel versions prior to 5.16 are vulnerable, specifically some NetApp HCI Baseboard Management Controller (BMC).
- **Fix:** The issue is resolved by a code change to the loop within nfsd4\_decode\_bitmap4 which ensures it does not write past the bounds of the provided buffer. This is included in Linux kernel version 5.16-rc2.
- **CVSS Score:** The vulnerability has a CVSS v3.1 score of 7.1 (HIGH) with vector CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N. This indicates local attack vector, low attack complexity and low privileges required, and high impact to confidentiality and integrity, and no impact to availability.
- **Red Hat Bugzilla:**  Red Hat has tracked this vulnerability as Bug 2025101, marked as "CLOSED NOTABUG."
- **Upstream Patch:** The vulnerability was addressed by commit `479d3452ce6c` which modifies the loop in `nfsd4_decode_bitmap4`.