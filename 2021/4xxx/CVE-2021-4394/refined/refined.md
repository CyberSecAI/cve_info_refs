```
{
  "CVE-2021-4394": {
    "related_content": [
      {
        "source": "blog.nintechnet.com_07c44c34_20250115_092443.html",
        "vulnerability": "CSRF",
        "details": "The 'Locations' plugin, version 3.2.1 and below, is vulnerable to CSRF. The nonce check in `gold-framework/gold-plugins-custom-post-type.php#L291` is only performed if `$_POST[ 'my-custom-fields_wpnonce' ]` is set, allowing an attacker to bypass it if the parameter is absent from the request."
      },
       {
        "source": "blog.nintechnet.com_5b527821_20250115_092439.html",
        "vulnerability": "CSRF",
         "details": "This article mentions a vulnerability in the 'Locations' plugin as part of a list of plugins vulnerable to CSRF, and links to a detailed description."
      },
      {
        "source": "blog.nintechnet.com_c2ec115a_20250115_092438.html",
        "vulnerability": "CSRF",
         "details":"This article mentions the 'Locations' plugin as one of 25 WordPress plugins vulnerable to CSRF attacks, and links to a detailed description. "
      },
      {
        "source": "www.wordfence.com_a06aaabd_20250115_092449.html",
         "vulnerability": "CSRF",
        "details": "The Locations plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 3.2.1. This is due to missing or incorrect nonce validation on the saveCustomFields() function. This makes it possible for unauthenticated attackers to update custom field meta data via a forged request granted they can trick a site administrator into performing an action such as clicking on a link."
      },
        {
        "source": "blog.nintechnet.com_4eb58b52_20250115_092441.html",
         "vulnerability": "CSRF",
         "details": "This article references  the 'Locations' plugin and its CSRF vulnerability as part of a series about CSRF vulnerabilities in multiple wordpress plugins."
      },
        {
        "source": "blog.nintechnet.com_370ffbfd_20250115_092439.html",
        "vulnerability":"CSRF",
          "details": "This article references  the 'Locations' plugin and its CSRF vulnerability as part of a series about CSRF vulnerabilities in multiple wordpress plugins."
      },
     {
        "source": "plugins.trac.wordpress.org_1f24cb63_20250115_092446.html",
        "vulnerability": "CSRF",
        "details": "This is the commit log which details the fix to the CSRF vulnerability, specifically the change from `isset($_POST[ 'my-custom-fields_wpnonce' ]) && !wp_verify_nonce(...)` to `!isset($_POST[ 'my-custom-fields_wpnonce' ]) || !wp_verify_nonce(...)` in `gold-framework/gold-plugins-custom-post-type.php`."
      }
    ],
    "summary": "The Locations plugin for WordPress is vulnerable to Cross-Site Request Forgery (CSRF) due to missing or incorrect nonce validation in the saveCustomFields() function. This allows unauthenticated attackers to update custom field metadata if they can trick a site administrator into clicking a link or performing a similar action.",
    "details": {
        "root_cause": "The vulnerability arises from an incorrect implementation of nonce validation. The code checks for the nonce's validity only if it is present, allowing attackers to bypass this check by omitting the nonce parameter from a request.",
      "weaknesses": [
        "Cross-Site Request Forgery (CSRF)",
        "Missing or incorrect nonce validation"
      ],
      "impact": "An unauthenticated attacker could modify custom field metadata, leading to potential data manipulation.",
      "attack_vectors": [
        "Forged HTTP requests",
        "Social engineering to trick administrators"
      ],
      "attacker_capabilities": "The attacker needs to be able to craft a malicious request and trick a logged-in administrator into performing an action that triggers the forged request, such as clicking a link."
    }
  }
}
```