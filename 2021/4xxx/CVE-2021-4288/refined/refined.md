The provided content relates to CVE-2021-4288.

**Root cause of vulnerability:**
The vulnerability is caused by the usage of `escapeJs` which is less secure compared to `encodeJavaScript`.

**Weaknesses/vulnerabilities present:**
The code was vulnerable to cross-site scripting (XSS) due to the usage of `escapeJs` for escaping user-provided input.

**Impact of exploitation:**
An attacker could potentially inject malicious JavaScript code, leading to XSS attacks.

**Attack vectors:**
The attack vector is through user-provided input that is not properly sanitized using `encodeJavaScript` in the `userApp.appId` field.

**Required attacker capabilities/position:**
The attacker would need to be able to provide input to the `appId` field that contains malicious JavaScript.