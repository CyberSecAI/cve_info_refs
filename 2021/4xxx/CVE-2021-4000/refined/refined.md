The provided content is a commit diff from a GitHub repository related to the 'showdoc' project. It includes changes to several files, most notably `Login.vue`. The changes in `Login.vue` are focused on sanitizing the `redirect` parameter, seemingly to prevent URL injection.

Here's a breakdown based on the provided diff:

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient sanitization of the `redirect` parameter used during login. Without proper validation, an attacker could potentially inject malicious URLs into the redirect parameter.

**Weaknesses/Vulnerabilities Present:**
The vulnerability present is a URL injection vulnerability via the `redirect` parameter in the login functionality.  Prior to the fix, the application was likely vulnerable to Open Redirect attacks.

**Impact of Exploitation:**
A successful exploitation of this vulnerability could lead to:
    *   **Phishing:** An attacker could redirect a user to a malicious website disguised as the legitimate application, potentially capturing user credentials or other sensitive information.
    *   **Data theft:** Users could be redirected to a site that is designed to steal data or personal information.
    *   **Malware infection:** Users could be redirected to a website that delivers malware.

**Attack Vectors:**
The attack vector is through manipulation of the `redirect` query parameter in the URL of the login page.

**Required Attacker Capabilities/Position:**
An attacker would need to be able to craft a malicious URL and trick a victim into visiting this URL to trigger the redirect to the attacker's chosen destination. No special system access is required, and the attack could be conducted remotely.

**Detailed Changes:**

The core of the fix is in the `web_src/src/components/user/Login.vue` file:

*   **Before:** There appears to have been a vulnerability because there was no effective sanitization of the `redirect` parameter, this can be seen in that there are two "redirect.indexOf('.') > -1" checks, which is likely a typo and thus did not sanitize input correctly.
*   **After:** The commit introduced a stronger sanitization mechanism:
    *   It uses `decodeURIComponent` to decode the `redirect` parameter which was likely URL encoded in the query
    *   The `redirect` parameter is checked using a regular expression and the following character limitations, `/[^A-Za-z0-9/:\?\.\_\\*\+\-]+.\*/i`
    *    It checks that the `redirect` does not contain `.` or `//`
    *   If these conditions are met, the application will display an 'illegal redirect' alert and abort the redirect.

**In summary, the commit addresses a potential Open Redirect vulnerability by implementing a more secure sanitization approach for the redirect parameter. This prevents the attacker from redirecting users to malicious URLs, mitigating the risks of phishing, data theft, and malware infection.**