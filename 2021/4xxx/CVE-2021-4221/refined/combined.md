=== Content from www.mozilla.org_4e13d29b_20250115_084438.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-38

## Security Vulnerabilities fixed in Firefox 92

Announced
September 7, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 92

#### [#CVE-2021-29993: Handling custom intents could lead to crashes and UI spoofs](#CVE-2021-29993)

Reporter
Amy Burnett working with Include Security
Impact
high
##### Description

Firefox for Android allowed navigations through the `intent://` protocol, which could be used to cause crashes and UI spoofs.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1712242, 1708767, 1712240, 1708544, 1729259](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1712242%2C1708767%2C1712240%2C1708544%2C1729259)

#### [#CVE-2021-38491: Mixed-Content-Blocking was unable to check opaque origins](#CVE-2021-38491)

Reporter
Jonathan Kingston
Impact
moderate
##### Description

Mixed-content checks were unable to analyze opaque origins which led to some mixed content being loaded.

##### References

* [Bug 1551886](https://bugzilla.mozilla.org/show_bug.cgi?id=1551886)

#### [#CVE-2021-38492: Navigating to "mk:" URL scheme could load Internet Explorer](#CVE-2021-38492)

Reporter
James Lee
Impact
moderate
##### Description

When delegating navigations to the operating system, Firefox would accept the `mk` scheme which might allow attackers to launch pages and execute scripts in Internet Explorer in unprivileged mode.

*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1721107](https://bugzilla.mozilla.org/show_bug.cgi?id=1721107)

#### [#CVE-2021-4221: Address bar spoofing on Firefox for Android due to RTL characters](#CVE-2021-4221)

Reporter
Rohan Sharma
Impact
moderate
##### Description

If a domain name contained a RTL character, it would cause the domain to be rendered to the right of the path. This could lead to user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*
*Note*: Due to a clerical error this advisory was not included in the original announcement, and was added in Feburary 2022.

##### References

* [Bug 1704422](https://bugzilla.mozilla.org/show_bug.cgi?id=1704422)

#### [#CVE-2021-38493: Memory safety bugs fixed in Firefox 92, Firefox ESR 78.14 and Firefox ESR 91.1](#CVE-2021-38493)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto and Tyson Smith reported memory safety bugs present in Firefox 91 and Firefox ESR 78.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 92, Firefox ESR 78.14 and Firefox ESR 91.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1723391%2C1724101%2C1724107)

#### [#CVE-2021-38494: Memory safety bugs fixed in Firefox 92](#CVE-2021-38494)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christian Holler and Lars T Hansen reported memory safety bugs present in Firefox 91. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 92](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1723920%2C1725638)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_0e3431bc_20250115_084437.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1704422)
* [XML](/show_bug.cgi?ctype=xml&id=1704422)

Closed
[Bug 1704422](/show_bug.cgi?id=1704422)
(CVE-2021-4221)

Opened 4 years ago
Closed 3 years ago

# Address Bar Spoofing due to Arabic RTL characters

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address Bar Spoofing due to Arabic RTL characters

## Categories

### (Fenix :: Toolbar, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=Toolbar#Toolbar)

Toolbar
▾

Fenix :: Toolbar
Bugs related to the address bar (AwesomeBar) text input and buttons
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=Toolbar&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=Toolbar&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=Toolbar)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: rohansharma.rohan27, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ca01a9c048a909177b5e76e720c5cee5?d=mm&size=40)  [rohansharma.rohan27](/user_profile?user_id=683445)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/d2b191d48ae0f07a2e1367002f8c1767?d=mm&size=40)  [royang](/user_profile?user_id=644746)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-37205](/show_bug.cgi?id=1704420 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"), [CVE-2016-5267](/show_bug.cgi?id=1284372 "VERIFIED FIXED - Firefox Mobile Address Bar Spoofing"), [CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")

[github.com/mozilla-mobile/android-com...](https://github.com/mozilla-mobile/android-components/issues/10598 "https://github.com/mozilla-mobile/android-components/issues/10598")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: desktop version is bug 1704420[fixed in Fenix 92])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-4221

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

desktop version is bug 1704420[fixed in Fenix 92]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a27353720_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [firefox-android-poc.html](/attachment.cgi?id=9215018)  [4 years ago](#c0)  [Rohan Sharma](/user_profile?user_id=683445)   264 bytes, text/html |  | [Details](/attachment.cgi?id=9215018&action=edit) |
| --- | --- | --- |
| [firefox-android-poc.html](/attachment.cgi?id=9215019)  [4 years ago](#c1)  [Rohan Sharma](/user_profile?user_id=683445)   247 bytes, text/html |  | [Details](/attachment.cgi?id=9215019&action=edit) |
| [OnlyForDisplay.mp4](/attachment.cgi?id=9231286)  [4 years ago](#c8)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   4.43 MB, video/mp4 |  | [Details](/attachment.cgi?id=9231286&action=edit) |
| [advisory.txt](/attachment.cgi?id=9264550)  [3 years ago](#c16)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   338 bytes, text/plain |  | [Details](/attachment.cgi?id=9264550&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1704422#c0)• 4 years ago |
|  | |

Attached file
[firefox-android-poc.html](attachment.cgi?id=9215018) (obsolete)
— [Details](attachment.cgi?id=9215018&action=edit)

User Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0

Steps to reproduce:

STEP 1: Click on "run" in attached file ("firefox-desktop-PoC.html")

The address bar will point to "www.mozilla.org", however the actual content is being delivered by "اختبار.اختبار"

The URL is not handled properly. Arabic characters in the domain name are being rendered from Right to Left(RTL) direction rather than Left to Right(LTR).

Actual results:

[http://www.mozilla.org/hello/1/index.html/رابتخا.رابتخا](http://www.mozilla.org/hello/1/index.html/%D8%B1%D8%A7%D8%A8%D8%AA%D8%AE%D8%A7.%D8%B1%D8%A7%D8%A8%D8%AA%D8%AE%D8%A7)

Expected results:

[http://اختبار.اختبار/www.mozilla.org/hello/1/index.html](http://%D8%A7%D8%AE%D8%AA%D8%A8%D8%A7%D8%B1.%D8%A7%D8%AE%D8%AA%D8%A8%D8%A7%D8%B1/www.mozilla.org/hello/1/index.html)

The address bar should point to "اختبار.اختبار" instead of "www.mozilla.org"

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1704422#c1)• 4 years ago |
|  | |

Attached file
[firefox-android-poc.html](attachment.cgi?id=9215019)
— [Details](attachment.cgi?id=9215019&action=edit)

[Attachment #9215018](/attachment.cgi?id=9215018&action=edit "firefox-android-poc.html") -
Attachment is obsolete: true

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a39921_406670)• 4 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(amoya)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a150850_406194)• 4 years ago |

See Also: → [CVE-2023-37205](/show_bug.cgi?id=1704420 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a233477_1689)• 4 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a233499_1689)• 4 years ago |

Whiteboard: desktop version is bug 1704420

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1704422#c2)• 4 years ago |
|  | |

The reporter has submitted this for bounty consideration

Flags: sec-bounty?

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1704422#c3)• 4 years ago |
|  | |

Hi, we have passed 60 days for this vulnerability report. Any updates?

|  | [Amedyne Moya [:amoya]](/user_profile?user_id=666738) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1704422#c4)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1704422&comment_id=15482151 "1 revision") |
|  | |

Adding this to the team's current sprint to work on. Also refer to: <https://mozilla-hub.atlassian.net/browse/FNXV2-17223>

Flags: needinfo?(amoya)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a7976647_613831)• 4 years ago |

Assignee: nobody → petru.lingurar

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1704422#c5)• 4 years ago |
|  | |

Seems like this is happening because of us removing the http(s) protocol for URLs displayed in the url bar [here](https://github.com/mozilla-mobile/android-components/blob/bfaf514793dd20f9f12d3f551f9ff3e470f52727/components/support/utils/src/main/java/mozilla/components/support/utils/URLStringUtils.kt#L102).

There “http ://اختبار.اختبار/www.mozilla.org/1” would become "اختبار.اختبار/www.mozilla.org/1" as expected but by default the arabic characters need to be read from right to left so that string will actually be displayed as “www.mozilla.org/1/اختبار.اختبار“.

To enforce left to right we need to prepend the "\u200E” left-to-right mark to the string which I did in [this PR](https://github.com/mozilla-mobile/android-components/pull/10599).

The same solution should probably be used on desktop also which shows the same issue.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1704422#c6)• 4 years ago |
|  | |

Is this "display" version of the URL used strictly for display only, or is the modified version exposed to the user in the sense of being able to select&copy it, or otherwise interact with its contents? E.g. if the user does "select all", "copy" in the URL bar, will they get the original URL or the edited version?

Flags: needinfo?(petru.lingurar)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1704422#c7)• 4 years ago |
|  | |

That is indeed only used for display.

The problem arise because for display we remove the the protocols so end up beginning the displayed URL with arabic characters which are read (and as such will be displayed) from right to left.

But when interacting with the url we are using the full URL of the current page.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1704422#c8)• 4 years ago |
|  | |

Attached video
[OnlyForDisplay.mp4](attachment.cgi?id=9231286)
— [Details](attachment.cgi?id=9231286&action=edit)

Flags: needinfo?(petru.lingurar)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a8164273_613831)• 4 years ago |

URL: <1284372>

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a8164284_613831)• 4 years ago |

URL: <1284372>See Also: → [CVE-2016-5267](/show_bug.cgi?id=1284372 "VERIFIED FIXED - Firefox Mobile Address Bar Spoofing")

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1704422#c9)• 4 years ago |
|  | |

(In reply to Petru-Mugurel Lingurar [:petru] from [comment #7](/show_bug.cgi?id=1704422#c7 "RESOLVED FIXED - Address Bar Spoofing due to Arabic RTL characters"))

> That is indeed only used for display.
>
> The problem arise because for display we remove the the protocols so end up beginning the displayed URL with arabic characters which are read (and as such will be displayed) from right to left.
>
> But when interacting with the url we are using the full URL of the current page.

Thanks, that sounds like the right thing to do.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1704422#c10)• 3 years ago |
|  | |

Adding Lorand from QA to see the poc and verify the fix.

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1704422#c11)• 3 years ago |
|  | |

Verified that this is fixed <https://github.com/mozilla-mobile/android-components/issues/10598#issuecomment-884892669>

Status: NEW → RESOLVEDClosed: 3 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a26819901_75935)• 3 years ago |

Group: mobile-core-security → core-security-release

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1704422#c12)• 3 years ago |
|  | |

When would you process the CVE assignment?

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1704422#c13)• 3 years ago |
|  | |

NI for [comment 12](/show_bug.cgi?id=1704422#c12 "RESOLVED FIXED - Address Bar Spoofing due to Arabic RTL characters")

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1704422#c14)• 3 years ago |
|  | |

This should have been marked fixed and had the appropriate tracking flags set at the time so we could process the CVE and include it in the advisory. I will assign a CVE and update the prior advisory - to confirm this was fixed in Firefox for Android 92?

Flags: needinfo?(tom) → needinfo?(kbrosnan)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a26930625_1689)• 3 years ago |

See Also: → <https://github.com/mozilla-mobile/android-components/issues/10598>Whiteboard: desktop version is bug 1704420 → desktop version is bug 1704420[fixed in Fenix 92]

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1704422#c15)• 3 years ago |
|  | |

Yes that looks correct.

Flags: needinfo?(kbrosnan)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1704422#c16)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9264550)
— [Details](attachment.cgi?id=9264550&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a26990894_578488)• 3 years ago |

Alias: CVE-2021-4221

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a27353720_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a27354094_1689)• 3 years ago |

See Also: → [CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a43461139_1689)• 2 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a49338446_430528)• 2 years ago |

Component: Security: Android → Toolbar

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704422#a98885903_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1704422&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rohan Sharma](/user_profile?user_id=683445)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


