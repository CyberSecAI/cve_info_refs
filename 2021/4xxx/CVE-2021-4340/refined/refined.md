Based on the provided content, here's a breakdown of the vulnerabilities associated with CVE-2021-4340, which affects the uListing WordPress plugin:

**Root Cause:**

The primary root cause is the lack of proper input sanitization and authorization checks within the uListing plugin. This allowed unauthenticated users to interact with the plugin's API and database directly.

**Weaknesses/Vulnerabilities:**

1.  **Unauthenticated Arbitrary Account Creation:**
    *   The `stm_listing_register` AJAX action allows users to create new accounts, and it does not validate the `role` parameter, allowing unauthenticated users to create administrator accounts.
2.  **Unauthenticated Arbitrary Account Change:**
    *   The `stm_listing_profile_edit` AJAX action allows users to edit their profile. Lack of authentication and authorization check allows an unauthenticated user to edit any account, including changing email addresses, profile pictures, and `usermeta` values.
3.  **Unauthenticated WordPress Options Change (via AJAX):**
    *   The `stm_update_email_data` AJAX action allows users to update email template settings, however, it lacks security checks which allows an unauthenticated user to modify any WordPress option by sending specific POST requests.
4.  **Unauthenticated WordPress Options Change (via WP_Route):**
    *   The `/1/api/ulisting-builder/listing-single-layout/new-layout` route allows unauthenticated users to update WordPress options by uploading a crafted file.
5.  **Unauthenticated Information Disclosure:**
    *   The `/1/api/ulisting-user/search` route allows unauthenticated users to retrieve the list of all users and their email addresses.
6.  **Unauthenticated Arbitrary Roles and Capabilities Creation/Deletion:**
    *   The `/1/api/ulisting-user/role/save` route allows unauthenticated users to add/remove user roles and capabilities.
7.  **Unauthenticated SQL Injection #1:**
    *   The `/1/api/ulisting-page-statistics/listing` route is vulnerable to SQL injection via the `listing_id` and/or `user_id` GET parameters, as they are directly inserted into a SQL query without sanitization.
8.  **Unauthenticated SQL Injection #2:**
    *   The `UlistingPageStatistics::page_statistics_for_listing` method is vulnerable to SQL injection because it retrieves the user IP address from untrusted sources without sanitization, and then inserts it into a SQL query.
9.  **Unauthenticated Arbitrary Post/Page Deletion:**
    *   The `/1/api/ulisting-user/deletelisting` route allows unauthenticated users to delete any post or page by supplying the `user_id` and `listing_id`.
10. **Additional issues:**
    *   Unauthenticated WordPress options deletion
    *   Unauthenticated plugin settings change
    *   Unauthenticated arbitrary post/page status change
    *   Unauthenticated arbitrary post meta deletion and change

**Impact of Exploitation:**

*   **Complete site compromise:** Creation of admin accounts, arbitrary modification of options and data, and deletion of pages/posts.
*   **Data breach:**  Exposure of user information including email addresses.
*   **Denial of Service:** Deletion of content and modification of site configuration may lead to a denial of service.
*   **Privilege Escalation:** Unauthenticated users can grant themselves admin privileges.
*   **Arbitrary Code Execution:** Through modification of site options.
*   **Database manipulation:** Injection of arbitrary SQL queries.

**Attack Vectors:**

*   **HTTP Requests:** Directly sending crafted HTTP requests to vulnerable API endpoints and AJAX actions.
*   **URL Encoding:** Exploiting the WP_Route API's acceptance of URL encoded characters to bypass security filters.

**Required Attacker Capabilities/Position:**

*   **No authentication is required.** Attackers can exploit these vulnerabilities remotely.
*   **Basic knowledge of HTTP requests:** Attackers need to know how to send HTTP requests to interact with the vulnerable API endpoints and parameters.

**Additional Details:**

*   The plugin's custom API (WP\_Route) is more permissive than the WordPress REST API, allowing for character encoding that may be used to bypass poorly configured security measures.
*   The vendor was unresponsive, the vulnerability report was escalated to the WordPress Plugins team, which led to the release of version 1.7 addressing the vulnerabilities.

This information provides a detailed view of the multiple vulnerabilities present in the uListing plugin, going beyond the general description found in the CVE entry.