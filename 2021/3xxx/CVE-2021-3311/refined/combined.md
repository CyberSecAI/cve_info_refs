=== Content from github.com_d5b057ec_20250115_091820.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foctobercms%2Flibrary%2Fcommit%2F642f597489e6f644d4bd9a0c267e864cabead024)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foctobercms%2Flibrary%2Fcommit%2F642f597489e6f644d4bd9a0c267e864cabead024)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=octobercms%2Flibrary)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[octobercms](/octobercms)
/
**[library](/octobercms/library)**
Public

* [Notifications](/login?return_to=%2Foctobercms%2Flibrary) You must be signed in to change notification settings
* [Fork
  170](/login?return_to=%2Foctobercms%2Flibrary)
* [Star
   157](/login?return_to=%2Foctobercms%2Flibrary)

* [Code](/octobercms/library)
* [Pull requests
  0](/octobercms/library/pulls)
* [Actions](/octobercms/library/actions)
* [Security](/octobercms/library/security)
* [Insights](/octobercms/library/pulse)

Additional navigation options

* [Code](/octobercms/library)
* [Pull requests](/octobercms/library/pulls)
* [Actions](/octobercms/library/actions)
* [Security](/octobercms/library/security)
* [Insights](/octobercms/library/pulse)

## Commit

[Permalink](/octobercms/library/commit/642f597489e6f644d4bd9a0c267e864cabead024)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Invalidate the session ID to prevent reuse

[Browse files](/octobercms/library/tree/642f597489e6f644d4bd9a0c267e864cabead024)
Browse the repository at this point in the history

```
1. Good logs in
2. Bad captures Good's session cookie
3. Good logs out
4. Session cookie no longer works
5. Good logs in a second time
6. ORIGINAL session cookie works (Bad is also signed in)
```

* Loading branch information

[![@daftspunk](https://avatars.githubusercontent.com/u/1392869?s=40&v=4)](/daftspunk)

[daftspunk](/octobercms/library/commits?author=daftspunk "View all commits by daftspunk")
committed
Jan 30, 2021

1 parent
[e292d79](/octobercms/library/commit/e292d79ef2090f4d67a7d913d89c9d3597b0d334)

commit 642f597

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/Auth/Manager.php](#diff-3e1c47e35058a3cf20026e0ebcbcfe5bdad29d36c7cd525ceb1bbbcb8d0511c7 "src/Auth/Manager.php")

Show comments

[View file](/octobercms/library/blob/642f597489e6f644d4bd9a0c267e864cabead024/src/Auth/Manager.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -686,7 +686,7 @@ public function logout() |
|  |  |  |
|  |  | $this->user = null; |
|  |  |  |
|  |  | Session::flush(); |
|  |  | Session::invalidate(); |
|  |  | Cookie::queue(Cookie::forget($this->sessionKey)); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `642f597`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Foctobercms%2Flibrary%2Fcommit%2F642f597489e6f644d4bd9a0c267e864cabead024) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from octobercms.com_9183bf94_20250115_091823.html ===


![October Talk](data:image/svg;base64...)
Loading

[October Talk](/)

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [How to Update October v1 to v2/v3 with Deploy plugin](https://talk.octobercms.com/t/how-to-update-october-v1-to-v2-v3-with-deploy-plugin/369)  [Tips and Tricks](/c/tips-and-tricks/6)   Hello, I thought, I will make a short instruction here on how to update october v1 to v2 with deploy plugin, because I experienced some issues, which got solved with the help of the october team. I thought, I could shar… |  | 2 | 2453 | March 9, 2024 |
| [Welcome to the October CMS Community](https://talk.octobercms.com/t/welcome-to-the-october-cms-community/7) |  | 0 | 2643 | May 18, 2022 |
| [Repeater fields are not updated in drafts](https://talk.octobercms.com/t/repeater-fields-are-not-updated-in-drafts/3094)  [Need Help](/c/need-help/2) [tailor](https://talk.octobercms.com/tag/tailor) |  | 2 | 144 | January 14, 2025 |
| [Attaching Emails To email-templates](https://talk.octobercms.com/t/attaching-emails-to-email-templates/3197)  [Need Help](/c/need-help/2) |  | 3 | 20 | January 14, 2025 |
| [Populate the options of a dropdown of a snippet programmatically](https://talk.octobercms.com/t/populate-the-options-of-a-dropdown-of-a-snippet-programmatically/3190)  [Need Help](/c/need-help/2) |  | 4 | 100 | January 12, 2025 |
| [Rainlab blog - how to save post programmatically?](https://talk.octobercms.com/t/rainlab-blog-how-to-save-post-programmatically/3193)  [Need Help](/c/need-help/2) |  | 1 | 54 | January 11, 2025 |
| [SVG use removed from froala editor](https://talk.octobercms.com/t/svg-use-removed-from-froala-editor/3191)  [Need Help](/c/need-help/2) |  | 2 | 78 | January 10, 2025 |
| [Override controller ajax Handler function](https://talk.octobercms.com/t/override-controller-ajax-handler-function/2861)  [Need Help](/c/need-help/2) |  | 13 | 211 | January 10, 2025 |
| [Outer join for a pivot table](https://talk.octobercms.com/t/outer-join-for-a-pivot-table/3176)  [Need Help](/c/need-help/2) |  | 2 | 115 | January 10, 2025 |
| [Anyone using the code editor Nova App?](https://talk.octobercms.com/t/anyone-using-the-code-editor-nova-app/3130)  [Tips and Tricks](/c/tips-and-tricks/6) |  | 2 | 132 | January 10, 2025 |
| [Generating url on other sites [multisite]](https://talk.octobercms.com/t/generating-url-on-other-sites-multisite/3117)  [Need Help](/c/need-help/2) |  | 2 | 106 | January 10, 2025 |
| [Dropdown dropup in backned](https://talk.octobercms.com/t/dropdown-dropup-in-backned/3120)  [Need Help](/c/need-help/2) |  | 2 | 105 | January 10, 2025 |
| [Location Plugin - Issue in Backend Tabs](https://talk.octobercms.com/t/location-plugin-issue-in-backend-tabs/3137)  [Need Help](/c/need-help/2) |  | 1 | 139 | January 10, 2025 |
| [Turbo page loading question](https://talk.octobercms.com/t/turbo-page-loading-question/3140)  [Need Help](/c/need-help/2) [ajax](https://talk.octobercms.com/tag/ajax) |  | 1 | 141 | January 10, 2025 |
| [Navigation with tailor + plugin menu](https://talk.octobercms.com/t/navigation-with-tailor-plugin-menu/3166)  [Need Help](/c/need-help/2) [tailor](https://talk.octobercms.com/tag/tailor) |  | 1 | 115 | January 10, 2025 |
| [Question about converting from MySQL to MongoDB](https://talk.octobercms.com/t/question-about-converting-from-mysql-to-mongodb/3164)  [Questions](/c/questions/9) |  | 1 | 117 | January 10, 2025 |
| [Super admin don't have access to all sites when you restrict to roles](https://talk.octobercms.com/t/super-admin-dont-have-access-to-all-sites-when-you-restrict-to-roles/3175)  [Known Issues](/c/known-issues/8) [permissions](https://talk.octobercms.com/tag/permissions) |  | 1 | 99 | January 10, 2025 |
| [Invalid Link in the Rainlab User RecoverPassword Mails](https://talk.octobercms.com/t/invalid-link-in-the-rainlab-user-recoverpassword-mails/3173)  [Need Help](/c/need-help/2) |  | 2 | 130 | January 10, 2025 |
| [Pausing AJAX requests](https://talk.octobercms.com/t/pausing-ajax-requests/2024)  [Questions](/c/questions/9) |  | 11 | 1323 | January 9, 2025 |
| [Richeditor/Froala - custom plugin with popup](https://talk.octobercms.com/t/richeditor-froala-custom-plugin-with-popup/3142)  [Need Help](/c/need-help/2) |  | 8 | 243 | January 7, 2025 |
| [Prevent media deletion](https://talk.octobercms.com/t/prevent-media-deletion/3182)  [Need Help](/c/need-help/2) |  | 2 | 137 | January 3, 2025 |
| [Multisite and Static Pages translations](https://talk.octobercms.com/t/multisite-and-static-pages-translations/3184)  [Need Help](/c/need-help/2) |  | 4 | 104 | January 2, 2025 |
| [Og Docker image + Free License Key + Update => broken error code 500](https://talk.octobercms.com/t/og-docker-image-free-license-key-update-broken-error-code-500/3179)  [Need Help](/c/need-help/2) |  | 4 | 132 | December 30, 2024 |
| [OctoberCMS x Cloudflare](https://talk.octobercms.com/t/octobercms-x-cloudflare/3169)  [Questions](/c/questions/9) |  | 4 | 168 | December 29, 2024 |
| [Tailor unique slug](https://talk.octobercms.com/t/tailor-unique-slug/1986)  [Need Help](/c/need-help/2) [tailor](https://talk.octobercms.com/tag/tailor) |  | 10 | 923 | December 21, 2024 |
| [RainLab Builder modules(plugins) doesn't work PHP 8.1 Apache Octobercms v 3.0](https://talk.octobercms.com/t/rainlab-builder-modules-plugins-doesnt-work-php-8-1-apache-octobercms-v-3-0/415)  [Need Help](/c/need-help/2) |  | 4 | 767 | December 19, 2024 |
| [Failed to open stream: No such file or directory (file\_put\_contents)](https://talk.octobercms.com/t/failed-to-open-stream-no-such-file-or-directory-file-put-contents/3121)  [Need Help](/c/need-help/2) |  | 5 | 221 | December 18, 2024 |
| [403 Forbidden Error on Saving Pages/Partials in Backend Editor](https://talk.octobercms.com/t/403-forbidden-error-on-saving-pages-partials-in-backend-editor/3168)  [Need Help](/c/need-help/2) |  | 1 | 100 | December 18, 2024 |
| [Save and preview](https://talk.octobercms.com/t/save-and-preview/3138)  [Need Help](/c/need-help/2) |  | 3 | 166 | December 17, 2024 |
| [Problem with user menu](https://talk.octobercms.com/t/problem-with-user-menu/3158)  [Need Help](/c/need-help/2) |  | 3 | 141 | December 17, 2024 |

**[next page →](/latest?no_definitions=true&page=1)**

* [Home](/)
* [Categories](/categories)
* [FAQ/Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from anisiosantos.me_539ef119_20250115_091819.html ===


[![Anisio Santos Logo](/img/chips.png)
# Anísio Santos](/)

## CVE: 2021-3311 October CMS Token Reactivation

23 Feb 2021

![](/img/october.jpg)

Don’t get me wrong, but I believe that ‘luck’ many times is really a thing in the cybersecurity field. I’m not talking just about the normal luck, that makes you hit a jackpot on a slot machine, I’m talking about another kind of luck, an ‘experience luck’, that comes just with knowledge. Many bounties and many pieces of researches emerge just by looking at the right amount of code at the right path number and them BOOM! Been able o have that feeling and timing is something that I believe comes with experience, time and familiarity.

I think I have much more to learn about knowledge and experience to get the ‘experience luck’ feeling, but sometimes I come across many normal luck moments, and the bug that I will talk about today is one of those moments. That’s not a deep technical knowledge bug, but it gave me this lucky feeling of being at the right place at the right time.

# The Bug

The bug here is simple. I was lost on a rabbit hole, trying to explore an upload field on an [October CMS](https://octobercms.com) based site on a pentest, besides some teammates here at [Conviso](https://www.convisoappsec.com/), and I ended up logging out now and then. I noticed that my Burp repeater tabs with the upload post request stopped work when I log out, but since I log in again the same old session token will be reactivated.

So the flux is basically:

1. Victim logs in
2. Attacker captures victim’s session cookie
3. Victim logs out
4. Session cookie no longer works
5. Victim logs in a second time
6. ORIGINAL session cookie works (Attacker is also signed in)

That’s really strange behavior, the victim receives a different session token but the old disabled one becomes available again.
It’s important to say that, to do this attack, the attacker has to find some way to get the session token of the victim, and the token last use must be on the time gap of the October CMS framework (the default is 2 hours), so the scenario is really strict, but the simple fact that this can happen makes it a vulnerability.

# Why This Happens?

Since October is an open-source platform, my teammates and I started to look for some explication about this behavior on the source code. Let’s take a look at [October CMS Logout function](https://github.com/octobercms/library/blob/4066b84b45f8daebf97b452a7e24ff09f87fac61/src/Auth/Manager.php#L669-L691):

```

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  ``` | ``` public function logout() {     // Initialize the current auth session before trying to remove it     if (is_null($this->user) && !$this->check()) {         return;     }      if ($this->isImpersonator()) {         $this->user = $this->getImpersonator();         $this->stopImpersonate();         return;     }      if ($this->user) {         $this->user->setRememberToken(null);         $this->user->forceSave();     }      $this->user = null;      Session::flush();     Cookie::queue(Cookie::forget($this->sessionKey)); }  ``` |
| --- | --- |

```

The part that caught our attention was that *Session::flush();* part. October is based on Laravel, and if you look [how Laravel implements this flush function](https://github.com/laravel/framework/blob/c62385a23c639742b3b74a4a78640da25e6b782b/src/Illuminate/Session/Store.php#L450-L435) you can see why just flush the session can cause bad behavior.

```

| ``` 1 2 3 4  ``` | ``` public function flush() {     $this->attributes = []; }  ``` |
| --- | --- |

```

This function call basically just cleans the attributes of the session, without invalidating it.

# The Correction

My suggestion for the October CMS team was to remove the flush and call *Session:invalidate*, as we can see on the [same Laravel file](https://github.com/laravel/framework/blob/c62385a23c639742b3b74a4a78640da25e6b782b/src/Illuminate/Session/Store.php#L460-L465), the invalidate method calls a method named migrate passing true as an argument.

```

| ``` 1 2 3 4 5 6 7 8 9 10 11 12  ``` | ``` public function migrate($destroy = false) {     if ($destroy) {         $this->handler->destroy($this->getId());     }      $this->setExists(false);      $this->setId($this->generateSessionId());      return true; }  ``` |
| --- | --- |

```

Since the invalidate function passes true, the old token will be destroyed and this bug will no longer work.
That’s exactly what was changed on this [October commit](https://github.com/octobercms/library/commit/642f597489e6f644d4bd9a0c267e864cabead024).

That’s basically it, A huge thanks to the October team and my Conviso teammates, hope that sharing this story with you brings any kind of luck to your journey! Thanks for the reading!

### Referencies

* **CVE 2021-3311** - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3311
* **Conviso Application Security** - https://www.convisoappsec.com/
* **October correction commit** - https://github.com/octobercms/library/commit/642f597489e6f644d4bd9a0c267e864cabead024
* **Owasp Broken Authentication** - https://owasp.org/www-project-top-ten/2017/A2\_2017-Broken\_Authentication


