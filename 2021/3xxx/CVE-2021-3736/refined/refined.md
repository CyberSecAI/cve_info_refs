Based on the provided information, here's an analysis of CVE-2021-3736:

**Root Cause of Vulnerability:**
The vulnerability stems from a memory leak in the `mbochs_ioctl` function within the `samples/vfio-mdev/mbochs.c` file of the Linux kernel's Virtual Function I/O (VFIO) mediated devices subsystem.  Additionally, there's a missing error unwind, and a missing kfree of `mdev_state->pages`.

**Weaknesses/Vulnerabilities Present:**
- **Memory Leak:** The primary issue is a memory leak within the `mbochs_ioctl` function. This leak occurs when memory allocated for a mediated device is not properly released when an error occurs during device probing, specifically when allocation fails at `mdev_state = kzalloc(sizeof(struct mdev_state), GFP_KERNEL);`.
- **Race Condition:** There were also race conditions related to probing the mbochs device.
- **Missing Error Unwind:** The code was missing an error unwind when allocating the memory.
- **Missing kfree**: The code was also missing a `kfree` on `mdev_state->pages`.

**Impact of Exploitation:**
- **Information Disclosure:** A local attacker could exploit this memory leak to potentially access internal kernel memory, leading to the disclosure of sensitive information.
- **Resource Exhaustion:** Repeated exploitation of the memory leak could potentially lead to resource exhaustion.

**Attack Vectors:**
- **Local Access:** The attacker needs local access to the system to trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- A local user with the ability to interact with the VFIO mediated device subsystem is required.
- The attacker would need to be able to probe or interact with the `mbochs` device in a manner that would trigger the memory leak.

**Additional Notes:**
- The fix for this issue involves converting mbochs to use an atomic scheme for managing memory, similar to what was done for mtty, to address the race conditions during probing.
- Additionally, the fix includes adding the missing error unwind, and the missing kfree for `mdev_state->pages`.
- The commit `de5494af4815a4c9328536c72741229b7de88e7f` addresses this vulnerability.
- The fix involves changes to `samples/vfio-mdev/mbochs.c`.
- The vulnerability was reported by Cornelia Huck.