=== Content from kaisersource.github.io_012e077e_20250114_192128.html ===

[# KaiserSource@home:~$](/)
[## Archive](/archive)
[## About](/about)
[## RSS](/atom.xml)

## CVE-2021-3166

17 Jan 2021
## Affected products

We have not yet tested Asus models other than those listed. However we suspect it may also work on other models with the same firmware version.

```
    DSL-N14U_B1 V.1.1.2.3_805

```
## Overview

An issue was discovered on Asus DSL-N14U\_B1 v.1.1.2.3\_805. An attacker can upload any file to the Firmware box as long as it is renamed as Settings\_ProductName.trx (eg. Settings\_DSL-N14U-B1.trx). Once the file is loaded, shutdown measures on a wide range of services are triggered as if it were a real update, resulting in DoS condition.

## POC

**This PoC can result in a DoS.**

**Given the vendor’s policies, we don’t show the Source Code of the binary scripts. However, we’ll inspect the web page source. We’ll notice the differences before and after the exploitation using reconnaissance tools.**

## Details

We proceed with the reconnaissance part by performing a mere portscan.

![](/assets/asus/nmap-1.png)

As we can see, services like ssh and jetdirect are up and running.
Now let’s let’s head back to the firmware update page.

![](/assets/asus/firmware_update_page.png)

Let’s analyze the code and look for an “upload” field in order to find the access point used to laod the firmware.

```
function uiDoUpdate()
{
	var form=document.uiPostUpdateForm;
	var string4 = form.tools_FW_UploadFile.value.search(/DSL-N14U-B1/);

	if (form.tools_FW_UploadFile.value=="") {
		alert("You must select a firmware file to upload.");
	}
	else {
		if (string4 >= 0) {
			form.postflag.value = "1";
			if(model_name == "DSL-N66U" || model_name == "DSL-AC52U")
			{
				showLoading(220);
				setTimeout("redirect();", 220000);
			}
			else if(model_name == "DSL-N55U-C1" || model_name == "DSL-N16U")
			{
				showLoading(152);
				setTimeout("redirect();", 152000);
			}
			else //DSL-N14U ...
			{
				showLoading(182);
				setTimeout("redirect();", 182000);
			}
			setTimeout("chk_upgrade();", 5000);
			form.submit();
		}
		else
			alert("Nuovo file firmware non è valido.");
	}
}

```

Given the checks, it seems that it can accept firmware belonging to different asus models.
What changes visually seems to be the wait time for loading.
Loading an image generates the “Invalid Firmware” alert.

![](/assets/asus/not_valid.png)

But what if we decide to change the name of the image like “Settings\_DSL-N14U-B1.trx”?

![](/assets/asus/rename.png)

So we upload the appropriately crafted file, and it gets accepted to the back-end.

![](/assets/asus/upload_progress.png)

## Showdown

Once the loading is complete, we can notice a strange behaviour, As if some services have been been suddenly stopped working as if it was a normal firmware upgrade.

![](/assets/asus/nmap-2.png)

As long as the router is turned on, the services won’t restart. So, a Physical intervention is required in order to restart services properly.

[**{KaiserSource}**

© 2025](https://creativecommons.org/licenses/by-nc/3.0/deed.en_US)



=== Content from github.com_b3d98761_20250114_192128.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaisersource%2Fkaisersource.github.io%2Fblob%2Fmain%2F_posts%2F2021-01-17-dsl-n14u.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaisersource%2Fkaisersource.github.io%2Fblob%2Fmain%2F_posts%2F2021-01-17-dsl-n14u.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kaisersource%2Fkaisersource.github.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kaisersource](/kaisersource)
/
**[kaisersource.github.io](/kaisersource/kaisersource.github.io)**
Public

* [Notifications](/login?return_to=%2Fkaisersource%2Fkaisersource.github.io) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fkaisersource%2Fkaisersource.github.io)
* [Star
   0](/login?return_to=%2Fkaisersource%2Fkaisersource.github.io)

* [Code](/kaisersource/kaisersource.github.io)
* [Issues
  0](/kaisersource/kaisersource.github.io/issues)
* [Pull requests
  0](/kaisersource/kaisersource.github.io/pulls)
* [Actions](/kaisersource/kaisersource.github.io/actions)
* [Projects
  0](/kaisersource/kaisersource.github.io/projects)
* [Security](/kaisersource/kaisersource.github.io/security)
* [Insights](/kaisersource/kaisersource.github.io/pulse)

Additional navigation options

* [Code](/kaisersource/kaisersource.github.io)
* [Issues](/kaisersource/kaisersource.github.io/issues)
* [Pull requests](/kaisersource/kaisersource.github.io/pulls)
* [Actions](/kaisersource/kaisersource.github.io/actions)
* [Projects](/kaisersource/kaisersource.github.io/projects)
* [Security](/kaisersource/kaisersource.github.io/security)
* [Insights](/kaisersource/kaisersource.github.io/pulse)

## Files

 main
## Breadcrumbs

1. [kaisersource.github.io](/kaisersource/kaisersource.github.io/tree/main)
2. /[\_posts](/kaisersource/kaisersource.github.io/tree/main/_posts)
/
# 2021-01-17-dsl-n14u.md

Copy path Blame  Blame
## Latest commit

## History

[History](/kaisersource/kaisersource.github.io/commits/main/_posts/2021-01-17-dsl-n14u.md)99 lines (70 loc) · 2.88 KB main
## Breadcrumbs

1. [kaisersource.github.io](/kaisersource/kaisersource.github.io/tree/main)
2. /[\_posts](/kaisersource/kaisersource.github.io/tree/main/_posts)
/
# 2021-01-17-dsl-n14u.md

Top
## File metadata and controls

* Preview
* Code
* Blame

99 lines (70 loc) · 2.88 KB[Raw](https://github.com/kaisersource/kaisersource.github.io/raw/refs/heads/main/_posts/2021-01-17-dsl-n14u.md)

| layout | title | date | comments | categories |
| --- | --- | --- | --- | --- |
| post | CVE-2021-3166 | 2021-01-17 | true | vulnerability |

## Affected products

We have not yet tested Asus models other than those listed. However we suspect it may also work on other models with the same firmware version.

```
    DSL-N14U_B1 V.1.1.2.3_805

```

## Overview

An issue was discovered on Asus DSL-N14U\_B1 v.1.1.2.3\_805. An attacker can upload any file to the Firmware box as long as it is renamed as Settings\_ProductName.trx (eg. Settings\_DSL-N14U-B1.trx). Once the file is loaded, shutdown measures on a wide range of services are triggered as if it were a real update, resulting in DoS condition.

## POC

**This PoC can result in a DoS.**

**Given the vendor's policies, we don't show the Source Code of the binary scripts. However, we'll inspect the web page source. We'll notice the differences before and after the exploitation using reconnaissance tools.**

## Details

We proceed with the reconnaissance part by performing a mere portscan.

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/nmap-1.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/nmap-1.png)

As we can see, services like ssh and jetdirect are up and running.
Now let's let's head back to the firmware update page.

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/firmware_update_page.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/firmware_update_page.png)

Let's analyze the code and look for an "upload" field in order to find the access point used to laod the firmware.

```
function uiDoUpdate()
{
	var form=document.uiPostUpdateForm;
	var string4 = form.tools_FW_UploadFile.value.search(/DSL-N14U-B1/);

	if (form.tools_FW_UploadFile.value=="") {
		alert("You must select a firmware file to upload.");
	}
	else {
		if (string4 >= 0) {
			form.postflag.value = "1";
			if(model_name == "DSL-N66U" || model_name == "DSL-AC52U")
			{
				showLoading(220);
				setTimeout("redirect();", 220000);
			}
			else if(model_name == "DSL-N55U-C1" || model_name == "DSL-N16U")
			{
				showLoading(152);
				setTimeout("redirect();", 152000);
			}
			else //DSL-N14U ...
			{
				showLoading(182);
				setTimeout("redirect();", 182000);
			}
			setTimeout("chk_upgrade();", 5000);
			form.submit();
		}
		else
			alert("Nuovo file firmware non è valido.");
	}
}

```

Given the checks, it seems that it can accept firmware belonging to different asus models.
What changes visually seems to be the wait time for loading.
Loading an image generates the "Invalid Firmware" alert.

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/not_valid.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/not_valid.png)

But what if we decide to change the name of the image like "Settings\_DSL-N14U-B1.trx"?

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/rename.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/rename.png)

So we upload the appropriately crafted file, and it gets accepted to the back-end.

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/upload_progress.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/upload_progress.png)

## Showdown

Once the loading is complete, we can notice a strange behaviour, As if some services have been been suddenly stopped working as if it was a normal firmware upgrade.

[![](/kaisersource/kaisersource.github.io/raw/main/assets/asus/nmap-2.png)](/kaisersource/kaisersource.github.io/blob/main/assets/asus/nmap-2.png)

As long as the router is turned on, the services won't restart. So, a Physical intervention is required in order to restart services properly.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


