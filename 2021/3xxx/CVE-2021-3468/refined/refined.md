```
{
  "CVE-2021-3468": {
    "description": "A flaw was found in avahi in versions 0.6 up to 0.8. The event used to signal the termination of the client connection on the avahi Unix socket is not correctly handled in the client_work function, allowing a local attacker to trigger an infinite loop. The highest threat from this vulnerability is to the availability of the avahi service, which becomes unresponsive after this flaw is triggered.",
    "vulnerability": {
      "root_cause": "The `client_work` function in avahi doesn't properly handle the `AVAHI_WATCH_HUP` event which is triggered when a client terminates a connection after filling the input buffer. This leads to an infinite loop.",
      "weaknesses": [
        "Improper handling of connection termination events",
        "Lack of input buffer overflow handling",
        "Missing checks to interrupt connection when input buffer is full and no newline is found"
      ],
      "impact": "Local Denial of Service (DoS) of the avahi service, making it unresponsive.",
      "attack_vectors": [
        "Writing long lines to the avahi Unix socket (/run/avahi-daemon/socket)",
         "Sending malformed hostnames through the avahi socket or dbus"
      ],
        "required_capabilities": [
        "Local user access to the avahi socket",
         "Ability to send data to the avahi socket or through the dbus API"
      ]
    },
    "affected_products": [
      "avahi versions 0.6 up to 0.8",
      "Red Hat Enterprise Linux 8",
       "Red Hat Enterprise Linux 9",
        "Red Hat Enterprise Linux 8.6 Extended Update Support",
        "Red Hat Enterprise Linux 8.8 Extended Update Support",
        "Red Hat Enterprise Linux 9"
        , "Debian 9 stretch", "Debian 10 buster", "Debian 11 bullseye"
    ],
    "patches": [
       "https://github.com/lathiat/avahi/pull/330",
      "https://github.com/lathiat/avahi/commit/447affe29991ee99c6b9732fc5f2c1048a611d3b",
      "avahi 0.7-4+deb10u3",
      "avahi 0.8-5+deb11u2",
      "avahi 0.8-7",
      "avahi-0.7-21.el8_9.1",
        "avahi-0.8-5+deb11u2"
       
    ]
  }
}
```