=== Content from lists.debian.org_588c7b51_20250114_224616.html ===


---

[[Date Prev](msg00025.html)][[Date Next](msg00027.html)]
[[Thread Prev](msg00025.html)][[Thread Next](msg00027.html)]
[[Date Index](maillist.html#00026)]
[[Thread Index](threads.html#00026)]

# [SECURITY] [DLA 3399-1] 389-ds-base security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3399-1] 389-ds-base security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Mon, 24 Apr 2023 07:25:20 +0200
* *Message-id*: <[[🔎]](/msgid-search/20230424052520.924624A0204%40localhost.localdomain) [20230424052520.924624A0204@localhost.localdomain](msg00026.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3399-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
April 24, 2023                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : 389-ds-base
Version        : 1.4.0.21-1+deb10u1
CVE ID         : CVE-2019-3883 CVE-2019-10224 CVE-2019-14824 CVE-2021-3514
                 CVE-2021-3652 CVE-2021-4091 CVE-2022-0918 CVE-2022-0996
                 CVE-2022-2850

Multiple security issues were discovered in 389-ds-base: an open source LDAP
server for Linux.

CVE-2019-3883

    SSL/TLS requests do not enforce ioblocktimeout limit, leading to DoS
    vulnerability by hanging all workers with hanging LDAP requests.

CVE-2019-10224

    The vulnerability may disclose sensitive information, such as the Directory
    Manager password, when the dscreate and dsconf commands are executed in
    verbose mode. An attacker who can view the screen or capture the terminal
    standard error output can exploit thisvulnerability to obtain confidential information.

CVE-2019-14824

    The 'deref' plugin of 389-ds-base has a vulnerability that enables it to
    disclose attribute values using the 'search' permission. In certain setups,
    an authenticated attacker can exploit this flaw to access confidential
    attributes, including password hashes.

CVE-2021-3514

    If a sync_repl client is used, an authenticated attacker can trigger a crash
    by exploiting a specially crafted query that leads to a NULL pointer
    dereference.

CVE-2021-3652

    Importing an asterisk as password hashes enables successful authentication
    with any password, allowing attackers to access accounts with disabled
    passwords.

CVE-2021-4091

    A double free was found in the way 389-ds-base handles virtual attributes
    context in persistent searches. An attacker could send a series of search
    requests, forcing the server to behave unexpectedly, and crash.

CVE-2022-0918

    An unauthenticated attacker with network access to the LDAP port can cause a
    denial of service. The denial of service is triggered by a single message
    sent over a TCP connection, no bind or other authentication is required. The
    message triggers a segmentation fault that results in slapd crashing.

CVE-2022-0996

    Expired password was still allowed to access the database. A user whose
    password was expired was still allowed to access the database as if the
    password was not expired.  Once a password is expired, and "grace logins"
    have been used up, the account is basically supposed to be locked out and
    should not be allowed to perform any privileged action.

CVE-2022-2850

    The vulnerability in content synchronization plugin enables an authenticated attacker to trigger a denial of service via a crafted query through a NULL
    pointer dereference.

For Debian 10 buster, these problems have been fixed in version
1.4.0.21-1+deb10u1.

We recommend that you upgrade your 389-ds-base packages.

For the detailed security status of 389-ds-base please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/389-ds-base>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmRGErYACgkQ0+Fzg8+n
/wZqwhAAhec1oVkYCADWDJgb8CKmFwqtqwffRJPOdDZ/V6PEdxp4RmC7+YuVCgD7
aBGv+p0uTxqGfW69wlOKExHfakyR/GDAS695agPOrVoOv/+0S3l5rRz/qAT5YaNX
YSYYeKuFBaG6S8KmW3ur834eXcLylyFuwZND6waez72FWECM5wi9lmB1/5D1Zjn1
14CegrFXYzAIPiXLnTK6pX2a0GUbLZCGH6fNIAY+ensAZMLyiVrU0tJ89OV04hvw
E3XmQH3VB17KuThYPUp5X7Ricl+i6AhoA7Dx1owIzLqWNtTTzdWEhMPhE4iGG9Q2
GidwMWBbmooilT6lvU581aeLtfzTUhWOd7Ty5+nJiNIDFY5EDcMbNIioK5zwGqW0
YR1kwPD2am44/ZqrOlqkaUUJ1dzXJ/IHed/ybW4ozsjHTQ25cLYftC91DCaMSn6r
/vaYDDcnSFGbz/C3av5QAf/PbkrYq3wf815X52KM3Vzqd+b/9dhlwuzO60Ky8geb
uDnJJeK0E2iqdfLHhEtWidGagYTkFV0FWdepU/7RWQVmLaIgdHBKX6eyEEIfEDK/
936j8iclt79YOhdcH/xk6dKoGwd4AL4x2OYwzeGll8kCEh6YNlyzlwrpFHH/y1Cy
XV3ZrGUdyR6QYaFRjaivrXymOQdFwHkGP2xhEZzdocEQTYzWEh8=
=/mMk
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_7b894406_20250114_224615.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F389ds%2F389-ds-base%2Fissues%2F4711)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F389ds%2F389-ds-base%2Fissues%2F4711)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=389ds%2F389-ds-base)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[389ds](/389ds)
/
**[389-ds-base](/389ds/389-ds-base)**
Public

* [Notifications](/login?return_to=%2F389ds%2F389-ds-base) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2F389ds%2F389-ds-base)
* [Star
   224](/login?return_to=%2F389ds%2F389-ds-base)

* [Code](/389ds/389-ds-base)
* [Issues
  502](/389ds/389-ds-base/issues)
* [Pull requests
  20](/389ds/389-ds-base/pulls)
* [Discussions](/389ds/389-ds-base/discussions)
* [Actions](/389ds/389-ds-base/actions)
* [Projects
  0](/389ds/389-ds-base/projects)
* [Security](/389ds/389-ds-base/security)
* [Insights](/389ds/389-ds-base/pulse)

Additional navigation options

* [Code](/389ds/389-ds-base)
* [Issues](/389ds/389-ds-base/issues)
* [Pull requests](/389ds/389-ds-base/pulls)
* [Discussions](/389ds/389-ds-base/discussions)
* [Actions](/389ds/389-ds-base/actions)
* [Projects](/389ds/389-ds-base/projects)
* [Security](/389ds/389-ds-base/security)
* [Insights](/389ds/389-ds-base/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2F389ds%2F389-ds-base%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2F389ds%2F389-ds-base%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SIGSEV with sync\_repl #4711

Closed

[tbordaz](/tbordaz) opened this issue
Apr 1, 2021
· 10 comments

Closed

# [SIGSEV with sync\_repl](#top) #4711

[tbordaz](/tbordaz) opened this issue
Apr 1, 2021
· 10 comments

Assignees
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)

Labels
[In JIRA](/389ds/389-ds-base/labels/In%20JIRA)
ticket is in JIRA
[priority\_high](/389ds/389-ds-base/labels/priority_high)
need urgent fix / highly valuable / easy to fix

Milestone
[1.4.2](/389ds/389-ds-base/milestone/132 "1.4.2")

## Comments

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=80&v=4)](/tbordaz)

Copy link

Contributor

### **[tbordaz](/tbordaz)** commented [Apr 1, 2021](#issue-848525499)

| **Issue Description** When running a sync\_repl client, it crashes current master  ``` ================================================================= ==2268384==ERROR: AddressSanitizer: SEGV on unknown address 0x000041b58abb (pc 0x7f2c75c6c68d bp 0x7f2be7fc3d60 sp 0x7f2be7fc3d40 T12) ==2268384==The signal is caused by a READ memory access.     #0 0x7f2c75c6c68c in slapi_value_get_string ldap/servers/slapd/value.c:371     #1 0x7f2c71534436 in sync_create_state_control ldap/servers/plugins/sync/sync_util.c:194     #2 0x7f2c7153a89f in sync_srch_refresh_pre_entry ldap/servers/plugins/sync/sync_refresh.c:275     #3 0x7f2c75bb7365 in plugin_call_func ldap/servers/slapd/plugin.c:2002     #4 0x7f2c75bb6fb6 in plugin_call_list ldap/servers/slapd/plugin.c:1945     #5 0x7f2c75baf71c in plugin_call_plugins ldap/servers/slapd/plugin.c:414     #6 0x7f2c75bf9a6a in send_ldap_search_entry_ext ldap/servers/slapd/result.c:1488     #7 0x7f2c75bf75e6 in send_ldap_search_entry ldap/servers/slapd/result.c:1050     #8 0x7f2c75b82664 in send_entry ldap/servers/slapd/opshared.c:1140     #9 0x7f2c75b83687 in iterate ldap/servers/slapd/opshared.c:1326     #10 0x7f2c75b8493b in send_results_ext ldap/servers/slapd/opshared.c:1543     #11 0x7f2c75b7fffe in op_shared_search ldap/servers/slapd/opshared.c:882     #12 0x4700b1 in do_search ldap/servers/slapd/search.c:388     #13 0x4243c7 in connection_dispatch_operation ldap/servers/slapd/connection.c:659     #14 0x42a5f5 in connection_threadmain ldap/servers/slapd/connection.c:1777     #15 0x7f2c75549b33  (/lib64/libnspr4.so+0x2bb33)     #16 0x7f2c754de4e1 in start_thread (/lib64/libpthread.so.0+0x94e1)     #17 0x7f2c753966a2 in clone (/lib64/libc.so.6+0x1016a2)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV ldap/servers/slapd/value.c:371 in slapi_value_get_string Thread T12 created by T0 here:     #0 0x7f2c75de9955 in pthread_create (/lib64/libasan.so.5+0x3a955)     #1 0x7f2c7554981a  (/lib64/libnspr4.so+0x2b81a)  ```  **Package Version and Platform:**   * Platform: fedora   **Steps to Reproduce** Steps to reproduce the behavior:   1. run sync\_repl suite 2. start standalone 3. launch: ldapsearch ...-E sync=rp -b 'cn=config' 'objectclass=extensibleobject'   **Expected results** Should not crash |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
added
the
[needs triage](/389ds/389-ds-base/labels/needs%20triage)
The issue will be triaged during scrum
label
[Apr 1, 2021](#event-4541720390)

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
mentioned this issue
[Apr 26, 2021](#ref-pullrequest-867925887)

[Issue 4711 - SIGSEV with sync\_repl
#4738](/389ds/389-ds-base/pull/4738)
 Merged

[tbordaz](/tbordaz)
added a commit
to tbordaz/389-ds-base
that referenced
this issue
[Apr 27, 2021](#ref-commit-55b4575)
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)

`[Issue 4711 - SIGSEV with sync_repl](/tbordaz/389-ds-base/commit/55b457588d98efa3f1f3c97c52adca983818b69d "Issue 4711 - SIGSEV with sync_repl

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")`
…

`[55b4575](/tbordaz/389-ds-base/commit/55b457588d98efa3f1f3c97c52adca983818b69d)`

```
Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: [389ds#4711](https://github.com/389ds/389-ds-base/issues/4711)

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33
```

[tbordaz](/tbordaz)
added a commit
that referenced
this issue
[Apr 27, 2021](#ref-commit-d7eef2f)
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)

`[Issue 4711 - SIGSEV with sync_repl (](/389ds/389-ds-base/commit/d7eef2fcfbab2ef8aa6ee0bf60f0a9b16ede66e0 "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")[#4738](https://github.com/389ds/389-ds-base/pull/4738)[)](/389ds/389-ds-base/commit/d7eef2fcfbab2ef8aa6ee0bf60f0a9b16ede66e0 "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")`
…

`[d7eef2f](/389ds/389-ds-base/commit/d7eef2fcfbab2ef8aa6ee0bf60f0a9b16ede66e0)`

```
Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: [#4711](https://github.com/389ds/389-ds-base/issues/4711)

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33
```

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
self-assigned this
[Apr 27, 2021](#event-4649105644)

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
added
[Need BZ](/389ds/389-ds-base/labels/Need%20BZ)
The ticket needs to be cloned to a BZ
[priority\_high](/389ds/389-ds-base/labels/priority_high)
need urgent fix / highly valuable / easy to fix
and removed
[needs triage](/389ds/389-ds-base/labels/needs%20triage)
The issue will be triaged during scrum
labels
[Apr 27, 2021](#event-4649108880)

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
added this to the [1.4.3](/389ds/389-ds-base/milestone/50) milestone
[Apr 27, 2021](#event-4649110197)

[tbordaz](/tbordaz)
added a commit
that referenced
this issue
[Apr 27, 2021](#ref-commit-58dbf08)
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)

`[Issue 4711 - SIGSEV with sync_repl (](/389ds/389-ds-base/commit/58dbf084a63e6dbbd999bf6a70475fad8255f26a "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")[#4738](https://github.com/389ds/389-ds-base/pull/4738)[)](/389ds/389-ds-base/commit/58dbf084a63e6dbbd999bf6a70475fad8255f26a "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")`
…

`[58dbf08](/389ds/389-ds-base/commit/58dbf084a63e6dbbd999bf6a70475fad8255f26a)`

```
Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: [#4711](https://github.com/389ds/389-ds-base/issues/4711)

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33
```

[tbordaz](/tbordaz)
added a commit
that referenced
this issue
[Apr 27, 2021](#ref-commit-2e5b526)
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)

`[Issue 4711 - SIGSEV with sync_repl (](/389ds/389-ds-base/commit/2e5b526012612d1d6ccace46398bee679a730271 "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")[#4738](https://github.com/389ds/389-ds-base/pull/4738)[)](/389ds/389-ds-base/commit/2e5b526012612d1d6ccace46398bee679a730271 "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")`
…

`[2e5b526](/389ds/389-ds-base/commit/2e5b526012612d1d6ccace46398bee679a730271)`

```
Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: [#4711](https://github.com/389ds/389-ds-base/issues/4711)

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33
```

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=80&v=4)](/tbordaz)

Copy link

Contributor

Author

### **[tbordaz](/tbordaz)** commented [Apr 27, 2021](#issuecomment-827394622)

| [0a399a2](https://github.com/389ds/389-ds-base/commit/0a399a2b4bd3c414035e8b91ea767614a3ef6504)..[d7eef2f](https://github.com/389ds/389-ds-base/commit/d7eef2fcfbab2ef8aa6ee0bf60f0a9b16ede66e0) master [91c1c4d](https://github.com/389ds/389-ds-base/commit/91c1c4d08f277275b3e00c2580b403f7388f8cb7)..[58dbf08](https://github.com/389ds/389-ds-base/commit/58dbf084a63e6dbbd999bf6a70475fad8255f26a) 389-ds-base-1.4.4 [942cc16](https://github.com/389ds/389-ds-base/commit/942cc16d24590c19bc7108fd7e84353693c427a5)..[2e5b526](https://github.com/389ds/389-ds-base/commit/2e5b526012612d1d6ccace46398bee679a730271) 389-ds-base-1.4.3 |
| --- |

All reactions

Sorry, something went wrong.

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
added
[In JIRA](/389ds/389-ds-base/labels/In%20JIRA)
ticket is in JIRA
and removed
[Need BZ](/389ds/389-ds-base/labels/Need%20BZ)
The ticket needs to be cloned to a BZ
labels
[Apr 27, 2021](#event-4649402258)

[mreynolds389](/mreynolds389)
pushed a commit
that referenced
this issue
[May 14, 2021](#ref-commit-0bdc258)
[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz) [![@mreynolds389](https://avatars.githubusercontent.com/u/3912140?s=40&v=4)](/mreynolds389)

`[Issue 4711 - SIGSEV with sync_repl (](/389ds/389-ds-base/commit/0bdc258b9405e2b652490023a3241db25ce3165e "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")[#4738](https://github.com/389ds/389-ds-base/pull/4738)[)](/389ds/389-ds-base/commit/0bdc258b9405e2b652490023a3241db25ce3165e "Issue 4711 - SIGSEV with sync_repl (#4738)

Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: https://github.com/389ds/389-ds-base/issues/4711

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33")`
…

`[0bdc258](/389ds/389-ds-base/commit/0bdc258b9405e2b652490023a3241db25ce3165e)`

```
Bug description:
	sync_repl sends back entries identified with a unique
	identifier that is 'nsuniqueid'. If 'nsuniqueid' is
	missing, then it may crash

Fix description:
	Check a nsuniqueid is available else returns OP_ERR

relates: [#4711](https://github.com/389ds/389-ds-base/issues/4711)

Reviewed by: Pierre Rogier, James Chapman, William Brown (Thanks!)

Platforms tested:  F33
```

[![@mreynolds389](https://avatars.githubusercontent.com/u/3912140?s=80&v=4)](/mreynolds389)

Copy link

Contributor

### **[mreynolds389](/mreynolds389)** commented [May 14, 2021](#issuecomment-841356990)

| [39891cd](https://github.com/389ds/389-ds-base/commit/39891cd7ae5a7b632c05e76e62fd3b35f787121f)..[0bdc258](https://github.com/389ds/389-ds-base/commit/0bdc258b9405e2b652490023a3241db25ce3165e) 389-ds-base-1.4.2 -> 389-ds-base-1.4.2 |
| --- |

All reactions

Sorry, something went wrong.

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
modified the milestones:
[1.4.3](/389ds/389-ds-base/milestone/50),
[1.4.2](/389ds/389-ds-base/milestone/132)
[May 17, 2021](#event-4752382930)

[![@johnkeates](https://avatars.githubusercontent.com/u/5306980?s=80&u=0a5b73c19d3fb0bf263aea2737fd7ae56c4a22d1&v=4)](/johnkeates)

Copy link

### **[johnkeates](/johnkeates)** commented [Jun 17, 2021](#issuecomment-863439622)

| I ran into this issue today, any way to bypass this, short of replacing the entire replica? |
| --- |

All reactions

Sorry, something went wrong.

[![@mreynolds389](https://avatars.githubusercontent.com/u/3912140?s=80&v=4)](/mreynolds389)

Copy link

Contributor

### **[mreynolds389](/mreynolds389)** commented [Jun 17, 2021](#issuecomment-863463094)

| I ran into this issue today, any way to bypass this, short of replacing the entire replica?  [@johnkeates](https://github.com/johnkeates) Really you just need to upgrade to the latest version that has this fix. Otherwise disable Sync Repl plugin, but then you lose that functionality (probably not an option).  What version and platform are you on? |
| --- |

All reactions

Sorry, something went wrong.

[![@johnkeates](https://avatars.githubusercontent.com/u/5306980?s=80&u=0a5b73c19d3fb0bf263aea2737fd7ae56c4a22d1&v=4)](/johnkeates)

Copy link

### **[johnkeates](/johnkeates)** commented [Jun 17, 2021](#issuecomment-863482502) • edited Loading

| I ran into this issue today, any way to bypass this, short of replacing the entire replica?  [@johnkeates](https://github.com/johnkeates) Really you just need to upgrade to the latest version that has this fix. Otherwise disable Sync Repl plugin, but then you lose that functionality (probably not an option).  What version and platform are you on?  I'm beholden to whatever version is in the CentOS 8 Stream DL1 module repo so I suppose it's a matter of wanting for what Red Hat wants to do. RPM version is 389-ds-base-1.4.3.16-8.module\_el8.4.0+644+ed25d39e.x86\_64 and the startup line in the logs is 389-Directory/1.4.3.16 B2021.020.1847. (accidentally created a duplicate BZ @ <https://bugzilla.redhat.com/show_bug.cgi?id=1973337> )  There are plenty of other nodes that can serve requests so it's not a big deal right now. |
| --- |

All reactions

Sorry, something went wrong.

[![@Firstyear](https://avatars.githubusercontent.com/u/271005?s=80&u=e021bd5ec5f2ff26f0b3a8487bf19266c598e1a4&v=4)](/Firstyear)

Copy link

Contributor

### **[Firstyear](/Firstyear)** commented [Jun 17, 2021](#issuecomment-863627711)

| [@johnkeates](https://github.com/johnkeates) Quite a few members of this team work for RH, and they care a lot to make sure these fixes get to these platforms :) while the process may take a little while, it will happen. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnkeates](https://avatars.githubusercontent.com/u/5306980?s=80&u=0a5b73c19d3fb0bf263aea2737fd7ae56c4a22d1&v=4)](/johnkeates)

Copy link

### **[johnkeates](/johnkeates)** commented [Jun 17, 2021](#issuecomment-863633164)

| [@johnkeates](https://github.com/johnkeates) Quite a few members of this team work for RH, and they care a lot to make sure these fixes get to these platforms :) while the process may take a little while, it will happen.  I figured as much :) Since the system is still serving requests just fine with the remaining nodes I will just leave it be for now and drop the DNS records to speed up skipping the non-functional node. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnkeates](https://avatars.githubusercontent.com/u/5306980?s=80&u=0a5b73c19d3fb0bf263aea2737fd7ae56c4a22d1&v=4)](/johnkeates)

Copy link

### **[johnkeates](/johnkeates)** commented [Jun 22, 2021](#issuecomment-865485484)

| Looks like it's in the Stream 8 repo and works well now! |
| --- |

 🎉
1
 Firstyear reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@Firstyear](https://avatars.githubusercontent.com/u/271005?s=40&u=e021bd5ec5f2ff26f0b3a8487bf19266c598e1a4&v=4)](/Firstyear)
[Firstyear](/Firstyear)
closed this as [completed](/389ds/389-ds-base/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 22, 2021](#event-4920046072)

[![@vashirov](https://avatars.githubusercontent.com/u/1745018?s=80&u=ee31a6b9e5b8311538d56b2ca4589e5d94809843&v=4)](/vashirov)

Copy link

Member

### **[vashirov](/vashirov)** commented [Aug 4, 2022](#issuecomment-1205100979)

| This is still broken and crashes in  ``` Thread 14 "ns-slapd" received signal SIGSEGV, Segmentation fault. 0x00007f7802ba38d6 in __strcmp_evex () from target:/lib64/libc.so.6 (gdb) bt #0  0x00007f7802ba38d6 in __strcmp_evex () at target:/lib64/libc.so.6 #1  0x00007f77fe926e9f in sync_cookie_isvalid (refcookie=0x7f77febfaba0, testcookie=0x7f77febfab80)     at ldap/servers/plugins/sync/sync_util.c:796 #2  sync_cookie_isvalid (testcookie=0x7f77febfab80, refcookie=0x7f77febfaba0) at ldap/servers/plugins/sync/sync_util.c:789 #3  0x00007f77fe92aa7d in sync_srch_refresh_pre_search (pb=0x7f77feb9fd00) at ldap/servers/plugins/sync/sync_refresh.c:135 #4  0x00007f7802e297d9 in plugin_call_func     (list=0x7f77fe9ed800, operation=operation@entry=403, pb=pb@entry=0x7f77feb9fd00, call_one=call_one@entry=0)     at ldap/servers/slapd/plugin.c:2001 #5  0x00007f7802e299e6 in plugin_call_list (pb=0x7f77feb9fd00, operation=403, list=<optimized out>) at ldap/servers/slapd/plugin.c:1944 #6  plugin_call_plugins (pb=0x7f77feb9fd00, whichfunction=403) at ldap/servers/slapd/plugin.c:414 #7  0x00007f7802e222a9 in op_shared_search (pb=pb@entry=0x7f77feb9fd00, send_result=send_result@entry=1) at ldap/servers/slapd/opshared.c:586 #8  0x0000556eb3f0db14 in do_search (pb=<optimized out>) at ldap/servers/slapd/search.c:388 #9  0x0000556eb3efcb7f in connection_dispatch_operation (pb=0x7f77feb9fd00, op=<optimized out>, conn=<optimized out>)     at ldap/servers/slapd/connection.c:659 #10 connection_threadmain () at ldap/servers/slapd/connection.c:1785 #11 0x00007f780290ec34 in _pt_root () at target:/lib64/libnspr4.so #12 0x00007f7802b75802 in start_thread () at target:/lib64/libc.so.6 #13 0x00007f7802b15450 in clone3 () at target:/lib64/libc.so.6  ```  Steps to reproduce are the same except cookie should be malformed: `-E sync=rp/foo` We have a reproducer in our test suite: <https://github.com/389ds/389-ds-base/blob/main/dirsrvtests/tests/tickets/ticket48013_test.py> |
| --- |

All reactions

Sorry, something went wrong.

[![@vashirov](https://avatars.githubusercontent.com/u/1745018?s=40&u=ee31a6b9e5b8311538d56b2ca4589e5d94809843&v=4)](/vashirov)
[vashirov](/vashirov)
reopened this
[Aug 4, 2022](#event-7126772595)

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=80&v=4)](/tbordaz)

Copy link

Contributor

Author

### **[tbordaz](/tbordaz)** commented [Aug 16, 2022](#issuecomment-1216937465)

| To track the crash reported in [#4711 (comment)](https://github.com/389ds/389-ds-base/issues/4711#issuecomment-1205100979), I opened [#5418](https://github.com/389ds/389-ds-base/issues/5418).  They are different issues. RC of [#4711](https://github.com/389ds/389-ds-base/issues/4711) is handling of entries that have no nsuniqueid. RC of [#5418](https://github.com/389ds/389-ds-base/issues/5418) is handling of specific cookie  Closing the ticket |
| --- |

All reactions

Sorry, something went wrong.

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz)
[tbordaz](/tbordaz)
closed this as [completed](/389ds/389-ds-base/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 16, 2022](#event-7199166282)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2F389ds%2F389-ds-base%2Fissues%2F4711)

Assignees

[![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=40&v=4)](/tbordaz) [tbordaz](/tbordaz)

Labels

[In JIRA](/389ds/389-ds-base/labels/In%20JIRA)
ticket is in JIRA
[priority\_high](/389ds/389-ds-base/labels/priority_high)
need urgent fix / highly valuable / easy to fix

Projects

None yet

Milestone

 [**1.4.2**](/389ds/389-ds-base/milestone/132 "1.4.2")

Development

No branches or pull requests

5 participants

[![@Firstyear](https://avatars.githubusercontent.com/u/271005?s=52&v=4)](/Firstyear) [![@vashirov](https://avatars.githubusercontent.com/u/1745018?s=52&v=4)](/vashirov) [![@mreynolds389](https://avatars.githubusercontent.com/u/3912140?s=52&v=4)](/mreynolds389) [![@tbordaz](https://avatars.githubusercontent.com/u/5040926?s=52&v=4)](/tbordaz) [![@johnkeates](https://avatars.githubusercontent.com/u/5306980?s=52&v=4)](/johnkeates)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


