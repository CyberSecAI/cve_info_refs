=== Content from www.telekom.com_3b6e24ee_20250115_092834.html ===
New critical denial of service vulnerability
in the SQLCipher SQL command processing
(CVE-2021-3119)
Peter Samarin (e-mail: peter.samarin@t-systems.com)
Robert Hörr (e-mail: robert.hoerr@t-systems.com)
(Penetration Testers of the Deutsche Telekom Security GmbH)

A new critical denial of service vulnerability (CVE-2021-3119) in the SQLCipher SQL
command  processing  of  the  master  branch  (https://github.com/sqlcipher)  was
discovered  with  a  self-developed  SQLCipher-FAST (Fast  Automated  Software
Testing)  framework.  The  versions  4.4.2,  4.4.1,  4.4.0,  4.3.0,  4.2.0,  4.1.0  include  the
vulnerability,  too.  The  vulnerability  cause  a  segmentation  fault  and  thus  a  denial  of
service.

What is the SQLCipher library?
The company Zetetic provides several security frameworks. One of them is the open
source  SQLCipher  library.  It  is  an  extension  for  the  open  source  SQLite  database
providing complete  database  encryption.  Several  companies
like  Samsung,
Motorola and  SAP  are  using  this library.  According  to  Zetetic,  "SQLCipher is widely
used, protecting data for thousands of apps on hundreds of millions of devices[...] ."
(https://www.zetetic.net/sqlcipher/)

How is the SQLCipher library tested?
The code size of SQLite and SQLCipher library is roughly 250,000 lines of code. It is
hardly  possible  to  check  all  code  paths  by  a  manual  source  code  review.  Hence,
dynamic automated machine testing must be performed. An efficient way to perform
this kind of testing is the code coverage fuzzing approach. For that, the SQLCipher-
FAST framework  was  developed.  This  framework  unites  the  strengths  of  several
fuzzing tools and detects issues like buffer overflows.

Which issue was discovered?
The  SQLCipher-FAST  framework  detects  several  issues  in  the  SQL  command
processing. One of the issues is a read memory access of a variable initialized with
NULL. This issue occurs if the following specially crafted SQL command sequence is
executed in the API function sqlite3_exec(...):

select sqlcipher_export(:0);

The issue involves the following code in the sqlcipher_export(…) function:

if(targetDb_idx == 0 && sqlite3StrICmp("main", targetDb) != 0) {...}

The  code  tries  to  match  a  constant  string  "main"  in  the  targetDb  variable  that  is
assumed  to  be  a  string.  However,  with  a  special  query,  targetDb  is  NULL,  which
causes a segmentation fault.

How is the discovered issue exploitable?
Exploiting  this issue  can  result  in  a  remote denial  of  service  attack.  For example,  a
SQL injection can be used to execute the specially crafted SQL command sequence.
The command sequence causes a segmentation fault that crashes the program, which
results in a denial of service.



=== Content from github.com_d224fd50_20250115_092832.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlcipher%2Fsqlcipher%2Fcommit%2Fcb71f53e8cea4802509f182fa5bead0ac6ab0e7f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlcipher%2Fsqlcipher%2Fcommit%2Fcb71f53e8cea4802509f182fa5bead0ac6ab0e7f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sqlcipher%2Fsqlcipher)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sqlcipher](/sqlcipher)
/
**[sqlcipher](/sqlcipher/sqlcipher)**
Public

* [Notifications](/login?return_to=%2Fsqlcipher%2Fsqlcipher) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fsqlcipher%2Fsqlcipher)
* [Star
   6.4k](/login?return_to=%2Fsqlcipher%2Fsqlcipher)

* [Code](/sqlcipher/sqlcipher)
* [Issues
  7](/sqlcipher/sqlcipher/issues)
* [Pull requests
  4](/sqlcipher/sqlcipher/pulls)
* [Actions](/sqlcipher/sqlcipher/actions)
* [Projects
  0](/sqlcipher/sqlcipher/projects)
* [Security](/sqlcipher/sqlcipher/security)
* [Insights](/sqlcipher/sqlcipher/pulse)

Additional navigation options

* [Code](/sqlcipher/sqlcipher)
* [Issues](/sqlcipher/sqlcipher/issues)
* [Pull requests](/sqlcipher/sqlcipher/pulls)
* [Actions](/sqlcipher/sqlcipher/actions)
* [Projects](/sqlcipher/sqlcipher/projects)
* [Security](/sqlcipher/sqlcipher/security)
* [Insights](/sqlcipher/sqlcipher/pulse)

## Commit

[Permalink](/sqlcipher/sqlcipher/commit/cb71f53e8cea4802509f182fa5bead0ac6ab0e7f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix sqlcipher\_export handling of NULL parameters

[Browse files](/sqlcipher/sqlcipher/tree/cb71f53e8cea4802509f182fa5bead0ac6ab0e7f)
Browse the repository at this point in the history

* Loading branch information

[![@sjlombardo](https://avatars.githubusercontent.com/u/10047?s=40&v=4)](/sjlombardo)

[sjlombardo](/sqlcipher/sqlcipher/commits?author=sjlombardo "View all commits by sjlombardo")
committed
Jan 13, 2021

1 parent
[ba14070](/sqlcipher/sqlcipher/commit/ba14070de11985bbe9b8a0cca21a957a7cb8e999)

commit cb71f53

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**45 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/crypto.c
    [crypto.c](#diff-9305215a9a0ea69300281fc4af90bc7f3437e34a0e1745d030213152993ddae4)
* test

  + test/sqlcipher-compatibility.test
    [sqlcipher-compatibility.test](#diff-8c1754b7f5a9d4c40bd03c860d94544eeb185412a042042c92e6c9ecfc6a998d)

## There are no files selected for viewing

22 changes: 19 additions & 3 deletions

22
[src/crypto.c](#diff-9305215a9a0ea69300281fc4af90bc7f3437e34a0e1745d030213152993ddae4 "src/crypto.c")

Show comments

[View file](/sqlcipher/sqlcipher/blob/cb71f53e8cea4802509f182fa5bead0ac6ab0e7f/src/crypto.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1075,13 +1075,29 @@ void sqlcipher\_exportFunc(sqlite3\_context \*context, int argc, sqlite3\_value \*\*ar |
|  |  | goto end\_of\_export; |
|  |  | } |
|  |  |  |
|  |  | targetDb = (const char\*) sqlite3\_value\_text(argv[0]); |
|  |  | sourceDb = (argc == 2) ? (char \*) sqlite3\_value\_text(argv[1]) : "main"; |
|  |  | if(sqlite3\_value\_type(argv[0]) == SQLITE\_NULL) { |
|  |  | rc = SQLITE\_ERROR; |
|  |  | pzErrMsg = sqlite3\_mprintf("target database can't be NULL"); |
|  |  | goto end\_of\_export; |
|  |  | } |
|  |  |  |
|  |  | targetDb = (const char\*) sqlite3\_value\_text(argv[0]); |
|  |  | sourceDb = "main"; |
|  |  |  |
|  |  | if(argc == 2) { |
|  |  | if(sqlite3\_value\_type(argv[1]) == SQLITE\_NULL) { |
|  |  | rc = SQLITE\_ERROR; |
|  |  | pzErrMsg = sqlite3\_mprintf("target database can't be NULL"); |
|  |  | goto end\_of\_export; |
|  |  | } |
|  |  | sourceDb = (char \*) sqlite3\_value\_text(argv[1]); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\* if the name of the target is not main, but the index returned is zero |
|  |  | there is a mismatch and we should not proceed \*/ |
|  |  | targetDb\_idx = sqlcipher\_find\_db\_index(db, targetDb); |
|  |  | if(targetDb\_idx == 0 && sqlite3StrICmp("main", targetDb) != 0) { |
|  |  | if(targetDb\_idx == 0 && targetDb != NULL && sqlite3StrICmp("main", targetDb) != 0) { |
|  |  | rc = SQLITE\_ERROR; |
|  |  | pzErrMsg = sqlite3\_mprintf("unknown database %s", targetDb); |
|  |  | goto end\_of\_export; |
| Expand Down | |  |

26 changes: 26 additions & 0 deletions

26
[test/sqlcipher-compatibility.test](#diff-8c1754b7f5a9d4c40bd03c860d94544eeb185412a042042c92e6c9ecfc6a998d "test/sqlcipher-compatibility.test")

Show comments

[View file](/sqlcipher/sqlcipher/blob/cb71f53e8cea4802509f182fa5bead0ac6ab0e7f/test/sqlcipher-compatibility.test)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -444,6 +444,32 @@ do\_test export-error { |
|  |  | db close |
|  |  | file delete -force test.db |
|  |  |  |
|  |  | # verify sqlcipher\_export with NULL parameters |
|  |  | do\_test export-nulls { |
|  |  | sqlite\_orig db test.db |
|  |  |  |
|  |  | catchsql { |
|  |  | SELECT sqlcipher\_export(NULL); |
|  |  | } |
|  |  |  |
|  |  | } {1 {target database can't be NULL}} |
|  |  | db close |
|  |  | file delete -force test.db |
|  |  |  |
|  |  | do\_test export-nulls { |
|  |  | sqlite\_orig db test.db |
|  |  |  |
|  |  | catchsql { |
|  |  | SELECT sqlcipher\_export('main', NULL); |
|  |  | } |
|  |  |  |
|  |  | } {1 {target database can't be NULL}} |
|  |  | db close |
|  |  | file delete -force test.db |
|  |  |  |
|  |  |  |
|  |  | # use the sqlcipher\_export function |
|  |  |  |
|  |  | # use the sqlcipher\_export function |
|  |  | # to copy a complicated database. |
|  |  | # tests autoincrement fields, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cb71f53`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsqlcipher%2Fsqlcipher%2Fcommit%2Fcb71f53e8cea4802509f182fa5bead0ac6ab0e7f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


