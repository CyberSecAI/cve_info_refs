=== Content from github.com_d0ce68b9_20250114_225840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHadiMed%2FDSL-2750U-Full-chain%2Fblob%2Fmain%2FDSL-2750U%2520%2528firmware%2520version%25201.6%2529%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHadiMed%2FDSL-2750U-Full-chain%2Fblob%2Fmain%2FDSL-2750U%2520%2528firmware%2520version%25201.6%2529%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=HadiMed%2FDSL-2750U-Full-chain)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[HadiMed](/HadiMed)
/
**[DSL-2750U-Full-chain](/HadiMed/DSL-2750U-Full-chain)**
Public

* [Notifications](/login?return_to=%2FHadiMed%2FDSL-2750U-Full-chain) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2FHadiMed%2FDSL-2750U-Full-chain)
* [Star
   19](/login?return_to=%2FHadiMed%2FDSL-2750U-Full-chain)

* [Code](/HadiMed/DSL-2750U-Full-chain)
* [Issues
  0](/HadiMed/DSL-2750U-Full-chain/issues)
* [Pull requests
  0](/HadiMed/DSL-2750U-Full-chain/pulls)
* [Actions](/HadiMed/DSL-2750U-Full-chain/actions)
* [Projects
  0](/HadiMed/DSL-2750U-Full-chain/projects)
* [Security](/HadiMed/DSL-2750U-Full-chain/security)
* [Insights](/HadiMed/DSL-2750U-Full-chain/pulse)

Additional navigation options

* [Code](/HadiMed/DSL-2750U-Full-chain)
* [Issues](/HadiMed/DSL-2750U-Full-chain/issues)
* [Pull requests](/HadiMed/DSL-2750U-Full-chain/pulls)
* [Actions](/HadiMed/DSL-2750U-Full-chain/actions)
* [Projects](/HadiMed/DSL-2750U-Full-chain/projects)
* [Security](/HadiMed/DSL-2750U-Full-chain/security)
* [Insights](/HadiMed/DSL-2750U-Full-chain/pulse)

## Files

 main
## Breadcrumbs

1. [DSL-2750U-Full-chain](/HadiMed/DSL-2750U-Full-chain/tree/main)
2. /[DSL-2750U (firmware version 1.6)](/HadiMed/DSL-2750U-Full-chain/tree/main/DSL-2750U%20%28firmware%20version%201.6%29)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/HadiMed/DSL-2750U-Full-chain/commits/main/DSL-2750U%20%28firmware%20version%201.6%29/README.md)145 lines (138 loc) · 7.75 KB main
## Breadcrumbs

1. [DSL-2750U-Full-chain](/HadiMed/DSL-2750U-Full-chain/tree/main)
2. /[DSL-2750U (firmware version 1.6)](/HadiMed/DSL-2750U-Full-chain/tree/main/DSL-2750U%20%28firmware%20version%201.6%29)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

145 lines (138 loc) · 7.75 KB[Raw](https://github.com/HadiMed/DSL-2750U-Full-chain/raw/refs/heads/main/DSL-2750U%20%28firmware%20version%201.6%29/README.md)
# Analysis and PoC

## ***Update*** :

This bug was patched by D-link : 26/07/2021

New firmware is released check the link : <https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10230>

### The following CVE numbers have been assigned:

* [CVE-2021-3707](https://nvd.nist.gov/vuln/detail/CVE-2021-3707)
* [CVE-2021-3708](https://nvd.nist.gov/vuln/detail/CVE-2021-3708)

### Device Informations :

*Brand : D-link

Model : DSL-2750U

Hardware ID : GAN9.ET235B-B

Version : ME\_1.16

firmware : GAN9.ET235B-B-DL-DSL2750U-R5B028-ME.EN\_2T2R*
### firmware basic information gathering

*I started looking into the firmware for backdoor accounts , the **/etc/shadow**  file contains only 2 users root and sshuser , after bruteforcing the passwords , the root user has root as password , and sshuser : admin , but looks like web/telnet and ssh authentication is configured somewhere else , in the file **/etc/config.xml**  ,but looks like there is only one user for each service , so nothinng intresting .
 now for the web server , they are using a **mini\_httpd** webserver and passing requests and actions through **/usr/www/cgi-bin/webproc**(Authentication , web pages ...) , now in the cgi-bin directory I found another file **webupg** its also a binary that handle certain type of requests .*

### reversing webupg

*file command says it s a stripped binary , importing file in ghidra , basic auto analysis , first it's checking for some headers in the request , and the request method : (all functions and symbols were reversed)*

```
  iVar2 = getenv("REQUEST_METHOD");
  if ((iVar2 == 0) || (iVar2 = FUN_00401880(iVar2,"POST"), iVar2 != 0)) {
    iVar2 = 4;
    pcVar6 = "Unsupported Request Method";
LAB_0040343c:
    FUN_00401dfc(pcVar6);
  }
  else {
    iVar2 = getenv("CONTENT_TYPE");
    if (iVar2 == 0) {
LAB_004032bc:
      iVar2 = 5;
      pcVar6 = "Unsupported Content Type";
      goto LAB_0040343c;
    }
    iVar5 = FUN_00401100(iVar2,"application/x-www-form-urlencoded",0x21);
    if (iVar5 == 0) {
      iVar5 = 1;
    }
    else {
      iVar5 = 2;
      iVar2 = FUN_00401100(iVar2,"multipart/form-data",0x13);
      if (iVar2 != 0) goto LAB_004032bc;
    }
    bVar1 = false;
```

*Then its checking if we provided a valid session id*

```
    iVar2 = getenv("HTTP_COOKIE");
    if (iVar2 != 0) {
      uVar9 = FUN_00401160(iVar2);
      iVar2 = FUN_00401250(uVar9,0x3d);
      if (iVar2 != 0) {
        iVar2 = FUN_00401130(uVar9,&DAT_00404ee4);
        while (iVar2 != 0) {
          iVar2 = FUN_004010d0(iVar2,"sessionid");
          if (iVar2 != 0) {
            iVar2 = FUN_00401250(iVar2,0x3d);
            if ((iVar2 != 0) && (iVar2 = FUN_004018a8(iVar2 + 1), iVar2 == 0)) {
              bVar1 = true;
```

 *if we have ,it let us run some actions , depending on what we provided in a POST variable called name*

```
            iVar5 = FUN_00401160(iVar2 + 5);
            iVar2 = func_0x004011c0(iVar5,"ShowSysEvtLogFile");
            uVar9 = 0;
            if (iVar2 == 0) {
LAB_004034f0:
              iVar2 = FUN_00402160(uVar9);
            }
            else {
              iVar2 = func_0x004011c0(iVar5,"ShowFirewallLogFile");
              if (iVar2 == 0) {
                iVar2 = FUN_00403148();
              }
              else {
                iVar2 = func_0x004011c0(iVar5,"downloadSysEvtLogFile");
                if (iVar2 == 0) {
                  uVar9 = 1;
                  goto LAB_004034f0;
                }
                iVar2 = func_0x004011c0(iVar5,"downloadConfig");
                if (iVar2 == 0) {
                  iVar2 = FUN_00401fc8();
                }
                else {
                  iVar2 = func_0x004011c0(iVar5,"mac");
                  if (iVar2 == 0) {
                    iVar2 = FUN_00402eec();
                  }
                  else {
                    iVar2 = func_0x004011c0(iVar5,"protest");
                    if (iVar2 == 0) {
                      iVar2 = FUN_00402cdc();
                    }
```

*So depending on what we provided in the name variable it will run the apropriate function , I started looking in every function for vulns ,now the function that gets executed when we ask for action : **mac** is interesting , the purpose of this function is to change the MAC address of the router , its doing that by overwritting the old mac address (our input) by the one in the file **" /proc/llconfig/macadd "** :*

```
    snprintf(auStack536,"echo %s>/proc/llconfig/macaddr",puVar3);
    system(auStack536,0);
```

*Hmm , so it snprintf our new mac address ( unsanitized input ) into that string and passing it to LIBC system , okey I found a way to do some command injection , I shall note that the mini\_httpd server runs as root , so any command we pass will run as root .*

```
  583 root       1728 SW  /usr/sbin/mini_httpd -d /usr/www -c /cgi-bin/* -u roo

```

 *so the only problem here is to get a valid session id ...*

### Web Authentication

*Authentication on the web server : the client generate a random 4 byte number and send the username and the password to the CGI webproc , now if the username and password are valid the session id is set on both the server and client and I can invoke every previous action mentioned in the previous section , but no luck to get a session id without a valid username and password , I tried the root , sshuser but no luck ...*

## misconfiguration of the tftp server (backdoor)

*nmap scans shows that tftp (trivial file transfer protocol) protocol is running on the router port 69*

```
ftp-data        20/tcp
ftp             21/tcp
telnet          23/tcp
tftp            69/udp
netbios-ssn     139/tcp
netbios-ns      137/udp

```

*tftp is very limited , and its generally used for simple tasks get , put some files via UDP , I looked in the configuration file of tftpd , I found that anonymous user is enabled , but the only files that let me download are **cfg.xml** and **image.img** , the cfg.xml turns out its the backup file for settings in router but its encrypted , I looked on the firmware how its encrypting the config file , but looks like a lot of work , and then I said well I will try to resend the same file with the command put , I doubt it will accept it ?? but it did and the router rebooted and did set those settings , So lets just overwrite the old configuration with a configuration I craft with my username and password .*
### Poc

*okey now we have a way to overwrite the config file with my username and password (the router will do it for me , easy just login to my router saving the backup file with username:pwned , password:pwned , now I have a configuration file that I can send to any DSL-2750 router with the same firmware and the same bug ),and reach to the CGI **webproc** get authenticated , and get a valid session id , and use it to call the CGI **webupg** with appropriate headers , and param names to inject any command to run as root , and that's what I did , the file **exploit.sh** will send my crafted config file overwritting the config file through tftp ,call the file **exploit.py** get authenticated and send command to the router (since there is no netcat , filesystem is read-only , and I'm lazy to compile netcat for a MIPS LEXRA architecture) I sent only reboot command .*
### Pwned !

before exploit :

[![](/HadiMed/DSL-2750U-Full-chain/raw/main/DSL-2750U%20(firmware%20version%201.6)/img/before.jpg)](/HadiMed/DSL-2750U-Full-chain/blob/main/DSL-2750U%20%28firmware%20version%201.6%29/img/before.jpg)

After exploit :

[![](/HadiMed/DSL-2750U-Full-chain/raw/main/DSL-2750U%20(firmware%20version%201.6)/img/after.jpg)](/HadiMed/DSL-2750U-Full-chain/blob/main/DSL-2750U%20%28firmware%20version%201.6%29/img/after.jpg)

now we can access admin panel

[![](/HadiMed/DSL-2750U-Full-chain/raw/main/DSL-2750U%20(firmware%20version%201.6)/img/main.jpg)](/HadiMed/DSL-2750U-Full-chain/blob/main/DSL-2750U%20%28firmware%20version%201.6%29/img/main.jpg)

## Security annoucement and relevant links :

* D-link Advisory : <https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10230>
* JAPAN / CC Disclosure : <https://jvn.jp/en/vu/JVNVU92088210/>

## end.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from supportannouncement.us.dlink.com_ec28e6bd_20250114_225849.html ===


Search by product, keyword, model.

* [Home](http://us.dlink.com/)
  [Support](http://support.dlink.com/index.aspx)
  [Forums](http://forums.dlink.com)
  [Security Advisories](http://support.dlink.com/securityadvisories.aspx)
  [Shop](https://shop.us.dlink.com/)
  US
  ![](https://supportannouncement.us.dlink.com/images/US.gif)
  English
  []

      English | French

Support Announcement

Announcement
>
SAP10230

(Non-US) DSL-2750U :: H/W Rev. Ax :: F/W vME\_1.16 :: Unauthenticated Config access

**Overview**

On May 31, 2021, a 3rd party researcher accused a non-US SKU DSL-2750U with firwmare vME1.16 of a security vulnerability that allows a user access to device's configuration without credentials on the local network.

Once the device was fully booted , it gave access to connected clients over LAN to upload or dowload the cfg file over tftp. This access can elevate security issues by allowing a malicious users to change the devices configuration.

The new firmware patch doesn't allow downloading or uploading config files by disabling the functionality to change or download the 2 files in the old firmware:\* cfg.xml , \*.img ).

**3rd Party Report information**

         **- The report provided by**

                  MOHAMMED HADI

mohammed.hadi \_at\_ ump \_dot\_ ac \_dot\_ ma

         **- Reference :**

**-**Public Disclosure::

- [Link](https://github.com/HadiMed/firmware-analysis/blob/main/DSL-2750U%20%28firmware%20version%201.6%29/README.md) to Github Post

- JPCERT/CC :: [CVE-2021-3707](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3707) :: Unauthorized configuration modification and CVE-2021-3708 :: [Link](https://jvn.jp/en/vu/JVNVU92088210/)

                                                    : [CVE-2021-3708](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3708) :: :OS command injection : [Link](https://jvn.jp/en/vu/JVNVU92088210/)

 **Affected Models**

| **Model** | **Region** | **Hardware Revision** | **Affected FW** | **Fixed FW** | **Recommendation** | **Last Updated** |
| --- | --- | --- | --- | --- | --- | --- |
| DSL-2750U | WorldWide | All Revisions with Open firmware | vME1.16 and below | [vME\_1.22](https://support.dlink.com/resource/SECURITY_ADVISEMENTS/DSL-2750U/REVA/DSL-2750U_REVA_FIRMWARE_v1.22_ME_HOTFIX.zip) | Download and Upgrade | 07/26/21 |

**Regarding Security patch for your D-Link Devices**

Firmware updates address the security vulnerabilities in affected D-Link devices. D-Link will update this continually, and we strongly recommend all users to install the relevant updates.

Please note that this is a device beta software, beta firmware, or hot-fix release, which is still undergoing final testing before its official release. The beta software, beta firmware, or hot-fix is provided on an “as is” and “as available” basis, and the user assumes all risk and liability for use thereof. D-Link does not offer any warranties, whether express or implied, as to the suitability or usability of the beta firmware. D-Link will not be liable for any loss, whether such loss is direct, indirect, special or consequential, suffered by any party as a result of their use of the beta firmware.

As there are different hardware revisions on our products, please check this on your device before downloading the correct corresponding firmware update. The hardware revision information can usually be found on the product label on the underside of the product next to the serial number. Alternatively, they can also be found on the device web configuration.

* [Contact Us](http://support.dlink.com/Search.aspx)
* Do Not Sell My Info – CA Residents Only
* Privacy
* Terms of Use
* End of Product Life-Cycle
* [GPL Source Code](http://tsd.dlink.com.tw/gpl2008.asp)



=== Content from jvn.jp_32ad11a6_20250115_203117.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2021/08/16  Last Updated:2021/08/16
# JVNVU#92088210 Multiple vulnerabilities in D-Link router DSL-2750U

## Overview

D-Link router DSL-2750U is vulnerable to unauthorized configuration modification and OS command injection.

## Products Affected

* D-Link DSL-2750U, with firmware vME1.16 or prior versions

## Description

D-Link router DSL-2750U is vulnerable to unauthorized configuration modification ([CWE-15](https://cwe.mitre.org/data/definitions/15.html), [CVE-2021-3707](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3707)) and OS command injection ([CWE-78](https://cwe.mitre.org/data/definitions/78.html), [CVE-2021-3708](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3708)).

## Impact

An unauthenticated attacker on the local network may execute any OS commands on the vulnerable device.

## Solution

**Update Firmware**

Apply the appropriate firmware upgrade according to the information provided by D-Link.

D-Link released the fixed firmware vME\_1.22.

## Vendor Status

| Vendor | Link |
| --- | --- |
| D-Link | [(Non-US) DSL-2750U :: H/W Rev. Ax :: F/W vME\_1.16 :: Unauthenticated Config access](https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10230) |

## References

1. [GitHub / HadiMed / firmware-analysis](https://github.com/HadiMed/firmware-analysis/blob/main/DSL-2750U%20%28firmware%20version%201.6%29/README.md)
   DSL-2750U (firmware version 1.6)

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
Base Score:
8.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:A/AC:L/Au:N/C:C/I:C/A:C
Base Score:
8.3

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This CVSS score reflects CVE-2021-3707.

## Credit

Mohammed Hadi reported this vulnerability to JPCERT/CC.

JPCERT/CC coordinated with the developer.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2021-3707](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3707) |
|  | [CVE-2021-3708](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3708) |
| JVN iPedia |  |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2021 JPCERT/CC and IPA. All rights reserved.


