=== Content from lists.debian.org_928c272e_20250114_232618.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 2742-1] ffmpeg security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2742-1] ffmpeg security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Sun, 15 Aug 2021 06:58:19 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20210815045819.3B4714A0284%40thinkpad.localdomain)Â [20210815045819.3B4714A0284@thinkpad.localdomain](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2742-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
August 14, 2021                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ffmpeg
Version        : 7:3.2.15-0+deb9u3
CVE ID         : CVE-2020-21041 CVE-2020-22015 CVE-2020-22016 CVE-2020-22020
                 CVE-2020-22021 CVE-2020-22022 CVE-2020-22023 CVE-2020-22025
                 CVE-2020-22026 CVE-2020-22028 CVE-2020-22031 CVE-2020-22032
                 CVE-2020-22036 CVE-2021-3566 CVE-2021-38114

Multiple issues have been discovered in ffmpeg.

CVE-2020-21041

    Buffer Overflow vulnerability exists via apng_do_inverse_blend in
    libavcodec/pngenc.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22015

    Buffer Overflow vulnerability in mov_write_video_tag due to the out of
    bounds in libavformat/movenc.c, which could let a remote malicious user
    obtain sensitive information, cause a Denial of Service, or execute
    arbitrary code.

CVE-2020-22016

    A heap-based Buffer Overflow vulnerability at libavcodec/get_bits.h when
    writing .mov files, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22020

    Buffer Overflow vulnerability in the build_diff_map function in
    libavfilter/vf_fieldmatch.c, which could let a remote malicious user cause
    a Denial of Service.

CVE-2020-22021

    Buffer Overflow vulnerability at filter_edges function in
    libavfilter/vf_yadif.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22022

    A heap-based Buffer Overflow vulnerability exists in filter_frame at
    libavfilter/vf_fieldorder.c, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22023

    A heap-based Buffer Overflow vulnerabililty exists in filter_frame at
    libavfilter/vf_bitplanenoise.c, which might lead to memory corruption and
    other potential consequences.

CVE-2020-22025

    A heap-based Buffer Overflow vulnerability exists in gaussian_blur at
    libavfilter/vf_edgedetect.c, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22026

    Buffer Overflow vulnerability exists in the config_input function at
    libavfilter/af_tremolo.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22028

    Buffer Overflow vulnerability in filter_vertically_8 at
    libavfilter/vf_avgblur.c, which could cause a remote Denial of Service.

CVE-2020-22031

    A Heap-based Buffer Overflow vulnerability in filter16_complex_low, which
    might lead to memory corruption and other potential consequences.

CVE-2020-22032

    A heap-based Buffer Overflow vulnerability in gaussian_blur, which might
    lead to memory corruption and other potential consequences.

CVE-2020-22036

    A heap-based Buffer Overflow vulnerability in filter_intra at
    libavfilter/vf_bwdif.c, which might lead to memory corruption and other
    potential consequences.

CVE-2021-3566

    The tty demuxer did not have a 'read_probe' function assigned to it. By
    crafting a legitimate "ffconcat" file that references an image, followed by
    a file the triggers the tty demuxer, the contents of the second file will be
    copied into the output file verbatim (as long as the `-vcodec copy` option
    is passed to ffmpeg).

CVE-2021-38114

    libavcodec/dnxhddec.c does not check the return value of the  init_vlc
    function. Crafted DNxHD data can cause unspecified impact.

For Debian 9 stretch, these problems have been fixed in version
7:3.2.15-0+deb9u3.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmEYnuUACgkQ0+Fzg8+n
/wZjLw//SqRxR5dxNq3k6PHU198Mj9rVuPinsKS1yucBMslAznMYYpIC0PWptNVH
Dv/5ZFLZg6lMmZJ/okNtwBs/ctJF2mBGUlp8xFgmKJlVmKszM4H2WJzvLivN4nAt
IlWCiuS1ODdQEtZOKBiTVi9OEUvjjRZdRFdvmtNlz36ng4mGe2e70sg+leexfhhN
lwCuGP1Zq4u/OuxitlP8VlLciGuFPbxnKhN26pHykrdMnkd1VwE3tyDK1T2jKzZX
hVbpqhDgxTseo5P7g/+Ciz9rm4yYRTA2njzEN+eyA6AQV8ZrYF259BaWaJLqWvLI
RdQmaFeZ3K0DpW3k0PX2BWb0aeV5rltdWjCq12sJr0bMkosEbx2MK0pYdVtCdF1t
uo9DmGLpu1ihwF09BpyQ91dC0NYb8n6opB7bGmif76pkLNROmCNqn2G+AKSwSCig
w9pY+KFf8U6+888fcjI4I9kupbqDuRIOSvtkdVOxcQF6tmkT+mw8nWsUi2WnAux3
DITYEPQvHPxHcfNCSqwoIRVX17gD1S3CbBfpwYJTMEQMHRbdNaybVmdLQGbzGFwL
vxinW2Psd+wRym+pJKGIvLg167GVTDCbH0yRbI1BCG1K4xO1TO8JtGyQSOhR0GPB
4OCMi3/WNTZ+KlBVBjHauqZ34YIaaJ0xxNwL5l+gDgpojIB2+Tw=
=zUxe
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_7dca9225_20250114_232616.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFFmpeg%2FFFmpeg%2Fcommit%2F3bce9e9b3ea35c54bacccc793d7da99ea5157532)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFFmpeg%2FFFmpeg%2Fcommit%2F3bce9e9b3ea35c54bacccc793d7da99ea5157532)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=FFmpeg%2FFFmpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FFmpeg](/FFmpeg)
/
**[FFmpeg](/FFmpeg/FFmpeg)**
Public

* [Notifications](/login?return_to=%2FFFmpeg%2FFFmpeg) You must be signed in to change notification settings
* [Fork
  12.3k](/login?return_to=%2FFFmpeg%2FFFmpeg)
* [Star
   47.3k](/login?return_to=%2FFFmpeg%2FFFmpeg)

* [Code](/FFmpeg/FFmpeg)
* [Pull requests
  1](/FFmpeg/FFmpeg/pulls)
* [Actions](/FFmpeg/FFmpeg/actions)
* [Security](/FFmpeg/FFmpeg/security)
* [Insights](/FFmpeg/FFmpeg/pulse)

Additional navigation options

* [Code](/FFmpeg/FFmpeg)
* [Pull requests](/FFmpeg/FFmpeg/pulls)
* [Actions](/FFmpeg/FFmpeg/actions)
* [Security](/FFmpeg/FFmpeg/security)
* [Insights](/FFmpeg/FFmpeg/pulse)

## Commit

[Permalink](/FFmpeg/FFmpeg/commit/3bce9e9b3ea35c54bacccc793d7da99ea5157532)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

avformat/tty: add probe function

[Browse files](/FFmpeg/FFmpeg/tree/3bce9e9b3ea35c54bacccc793d7da99ea5157532)
Browse the repository at this point in the history

* Loading branch information

[![@richardpl](https://avatars.githubusercontent.com/u/469155?s=40&v=4)](/richardpl)

[richardpl](/FFmpeg/FFmpeg/commits?author=richardpl "View all commits by richardpl")
committed
Jan 29, 2020

1 parent
[47d5d0c](/FFmpeg/FFmpeg/commit/47d5d0cc74d047ce49c0d89878dadb09e8fb8b9c)

commit 3bce9e9

Showing
**1 changed file**
with
**20 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

21 changes: 20 additions & 1 deletion

21
[libavformat/tty.c](#diff-74f6b92a0541378ad15de9c29c0a2b0c69881ad9ffc71abe568b88b535e00a7f "libavformat/tty.c")

Show comments

[View file](/FFmpeg/FFmpeg/blob/3bce9e9b3ea35c54bacccc793d7da99ea5157532/libavformat/tty.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,13 @@ |
|  |  | #include "internal.h" |
|  |  | #include "sauce.h" |
|  |  |  |
|  |  | static int isansicode(int x) |
|  |  | { |
|  |  | return x == 0x1B || x == 0x0A || x == 0x0D || (x >= 0x20 && x < 0x7f); |
|  |  | } |
|  |  |  |
|  |  | static const char tty\_extensions[31] = "ans,art,asc,diz,ice,nfo,txt,vt"; |
|  |  |  |
|  |  | typedef struct TtyDemuxContext { |
|  |  | AVClass \*class; |
|  |  | int chars\_per\_frame; |
| Expand All | | @@ -42,6 +49,17 @@ typedef struct TtyDemuxContext { |
|  |  | AVRational framerate; /\*\*< Set by a private option. \*/ |
|  |  | } TtyDemuxContext; |
|  |  |  |
|  |  | static int read\_probe(const AVProbeData \*p) |
|  |  | { |
|  |  | int cnt = 0; |
|  |  |  |
|  |  | for (int i = 0; i < p->buf\_size; i++) |
|  |  | cnt += !!isansicode(p->buf[i]); |
|  |  |  |
|  |  | return (cnt \* 100LL / p->buf\_size) \* (cnt > 400) \* |
|  |  | !!av\_match\_ext(p->filename, tty\_extensions); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Parse EFI header |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -153,8 +171,9 @@ AVInputFormat ff\_tty\_demuxer = { |
|  |  | .name = "tty", |
|  |  | .long\_name = NULL\_IF\_CONFIG\_SMALL("Tele-typewriter"), |
|  |  | .priv\_data\_size = sizeof(TtyDemuxContext), |
|  |  | .read\_probe = read\_probe, |
|  |  | .read\_header = read\_header, |
|  |  | .read\_packet = read\_packet, |
|  |  | .extensions = "ans,art,asc,diz,ice,nfo,txt,vt", |
|  |  | .extensions = tty\_extensions, |
|  |  | .priv\_class = &tty\_demuxer\_class, |
|  |  | }; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3bce9e9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFFmpeg%2FFFmpeg%2Fcommit%2F3bce9e9b3ea35c54bacccc793d7da99ea5157532) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


