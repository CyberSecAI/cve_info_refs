=== Content from access.redhat.com_22e4199e_20250115_182257.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Fran√ßais](https://access.redhat.com/changeLanguage?language=fr)
* [ÌïúÍµ≠Ïñ¥](https://access.redhat.com/changeLanguage?language=ko)
* [Êó•Êú¨Ë™û](https://access.redhat.com/changeLanguage?language=ja)
* [‰∏≠Êñá (‰∏≠ÂõΩ)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 ¬© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.gnu.org_ffb94faf_20250115_120709.html ===


| | **qemu-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=qemu-devel)

---

[[Date Prev](msg00487.html)][[Date Next](msg00489.html)][[Thread Prev](msg00483.html)][[Thread Next](msg02377.html)][[Date Index](index.html#00488)][[Thread Index](threads.html#00488)]

## [PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-20

---

| **From**: | P J P |
| --- | --- |

| **Subject**: | [PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-2021-3392) |
| **Date**: | Tue, 2 Feb 2021 18:51:03 +0530 |

---

```
From: Prasad J Pandit <pjp@fedoraproject.org>

While processing SCSI i/o requests in mptsas_process_scsi_io_request(),
the Megaraid emulator appends new MPTSASRequest object 'req' to
the 's->pending' queue. In case of an error, this same object gets
dequeued in mptsas_free_request() only if SCSIRequest object
'req->sreq' is initialised. This may lead to a use-after-free issue.
Unconditionally dequeue 'req' object from 's->pending' to avoid it.

Fixes: CVE-2021-3392
Buglink: [https://bugs.launchpad.net/qemu/+bug/1914236](https://bugs.launchpad.net/qemu/%2Bbug/1914236)
Reported-by: Cheolwoo Myung <cwmyung@snu.ac.kr>
Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
---
 hw/scsi/mptsas.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/hw/scsi/mptsas.c b/hw/scsi/mptsas.c
index f86616544b..adff5b0bf2 100644
--- a/hw/scsi/mptsas.c
+++ b/hw/scsi/mptsas.c
@@ -257,8 +257,8 @@ static void mptsas_free_request(MPTSASRequest *req)
         req->sreq->hba_private = NULL;
         scsi_req_unref(req->sreq);
         req->sreq = NULL;
-        QTAILQ_REMOVE(&s->pending, req, next);
     }
+    QTAILQ_REMOVE(&s->pending, req, next);
     qemu_sglist_destroy(&req->qsg);
     g_free(req);
 }
--
2.29.2

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg02377.html)] |
| --- | --- | --- |

* **[PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-2021-3392)**,
  *P J P*¬†**<=**
  + **[Re: [PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-2021-3392)](msg02377.html)**, *Li Qiang*, 2021/02/07
  + **[Re: [PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-2021-3392)](msg02660.html)**, *Paolo Bonzini*, 2021/02/08

---

* Prev by Date:
  **[Re: [PULL 10/11] trace: document how to specify multiple --trace patterns](msg00487.html)**
* Next by Date:
  **[Re: [PATCH] configure: Escape non-numbers in version\_ge()](msg00489.html)**
* Previous by thread:
  **[[PATCH] dbus-vmstate: Increase the size of input stream buffer used during load](msg00483.html)**
* Next by thread:
  **[Re: [PATCH] scsi: mptsas: dequeue request object in case of an error (CVE-2021-3392)](msg02377.html)**
* Index(es):
  + [**Date**](index.html#00488)
  + [**Thread**](threads.html#00488)



=== Content from bugzilla.redhat.com_1c24ea0a_20250114_203335.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1924042)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1924042)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1924042)+ Login using a Red Hat Bugzilla account
  + Forgot¬†Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla ‚Äì Bug¬†1924042

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug¬†1924042**](show_bug.cgi?id=1924042)
(CVE-2021-3392)
- [CVE-2021-3392](https://access.redhat.com/security/cve/CVE-2021-3392) QEMU: scsi: mptsas: use-after-free while processing io requests

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3392 QEMU: scsi: mptsas: use-after-free while processing io requests

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3392 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1924043](show_bug.cgi?id=1924043 "CLOSED EOL - CVE-2021-3392 qemu: scsi: mptsas: use-after-free while processing io requests [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1908264](show_bug.cgi?id=1908264) [1939717](show_bug.cgi?id=1939717) | | TreeView+ | [depends on](buglist.cgi?bug_id=1924042&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1924042&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-02-02 13:22 UTC by Prasad Pandit | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-08-04 08:14 UTC ([History](show_activity.cgi?id=1924042)) | | [CC List:](page.cgi?id=fields.html#cclist) | 47 users (show)  acaringi ailan berrange bhu bmasney brdeoliv cfergeau dbecker dhoward drjones dvlasenk fhrbata hkrzesin imammedo itamar jen jferlan jforbes jjoyce jmaloy jschluet jshortt jstancek knoel lhh lpeer m.a.young mburns mkenneth mrezanin mst nmurray ondrejj pbonzini philmd ptalbert ribarry rjones robinlee.sysu rvrbovsk sclewis slinaber virt-maint virt-maint vkuznets walters xen-maint | | Fixed In Version: | qemu 6.0.0 | | | Doc Type: | --- | | | Doc Text: | A use-after-free flaw was found in the MegaRAID emulator of QEMU. This issue occurs while processing SCSI I/O requests in the case of an error mptsas\_free\_request() that does not dequeue the request object 'req' from a pending requests queue. This flaw allows a privileged guest user to crash the QEMU process on the host, resulting in a denial of service. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-02-02 14:42:25 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1924042#c0)  Prasad Pandit    2021-02-02 13:22:04 UTC  ``` A use-after-free issue was found in the Megaraid emulator of the QEMU. It occurs while processing SCSI i/o requests because in case of an error mptsas_free_request() does not dequeue request object 'req' from a pending requests' queue. Which later gets processed resulting in the said use-after-free issue. A privileged guest user may use this flaw to crash the QEMU process on the host resulting in DoS scenario.  Upstream patch: ---------------   -> <https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg00488.html>   ```  [Comment 1](show_bug.cgi?id=1924042#c1)  Prasad Pandit    2021-02-02 13:22:14 UTC  ``` Acknowledgments:  Name: Cheolwoo Myung (Seoul National University)   ```  [Comment 3](show_bug.cgi?id=1924042#c3)  Prasad Pandit    2021-02-02 13:24:47 UTC  ``` Created qemu tracking bugs for this issue:  Affects: fedora-all [[bug 1924043](show_bug.cgi?id=1924043 "CLOSED EOL - CVE-2021-3392 qemu: scsi: mptsas: use-after-free while processing io requests [fedora-all]")]   ```  [Comment 4](show_bug.cgi?id=1924042#c4)  Product Security DevOps Team    2021-02-02 14:42:25 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2021-3392>   ```  [Comment 5](show_bug.cgi?id=1924042#c5)  Mauro Matteo Cascella    2021-02-02 16:00:08 UTC  ``` Statement:  This issue does not affect the versions of `qemu-kvm` as shipped with Red Hat products, as they do not include support for the LSI SAS1068 controller emulation.   ```  [Comment 6](show_bug.cgi?id=1924042#c6)  Mauro Matteo Cascella    2021-04-20 07:29:06 UTC  ``` Upstream fix: <https://git.qemu.org/?p=qemu.git;a=commit;h=3791642c8d60029adf9b00bcb4e34d7d8a1aea4d>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1924042&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from wiki.debian.org_8d48714b_20250115_182306.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Espa√±ol](/es/LTS) - [Fran√ßais](/fr/LTS) - [Italiano](/it/LTS) - [ÌïúÍµ≠Ïñ¥](/ko/LTS) - [Portugu√™s](/pt/LTS) - [Portugu√™s (Brasil)](/pt_BR/LTS) - [–†—É—Å—Å–∫–∏–π](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from lists.debian.org_4507892b_20250114_203336.html ===


---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)]
[[Thread Prev](msg00008.html)][[Thread Next](msg00010.html)]
[[Date Index](maillist.html#00009)]
[[Thread Index](threads.html#00009)]

# [SECURITY] [DLA 2623-1] qemu security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2623-1] qemu security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Sat, 10 Apr 2021 23:21:02 +0200
* *Message-id*: <[[üîé]](/msgid-search/fc0847aae3f8257a16aee882289230de21027f7e.camel%40debian.org)¬†[fc0847aae3f8257a16aee882289230de21027f7e.camel@debian.org](msg00009.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2623-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
April 10, 2021                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : qemu
Version        : 1:2.8+dfsg-6+deb9u14
CVE ID         : CVE-2020-17380 CVE-2021-3392 CVE-2021-3409 CVE-2021-3416
                 CVE-2021-20203 CVE-2021-20255 CVE-2021-20257
Debian Bug     : 984450 984451 984452 984448 984449 970937

Several security vulnerabilities have been discovered in QEMU, a fast processor
emulator.

CVE-2021-20257

    net: e1000: infinite loop while processing transmit descriptors

CVE-2021-20255

    A stack overflow via an infinite recursion vulnerability was found in the
    eepro100 i8255x device emulator of QEMU. This issue occurs while processing
    controller commands due to a DMA reentry issue. This flaw allows a guest
    user or process to consume CPU cycles or crash the QEMU process on the
    host, resulting in a denial of service.

CVE-2021-20203

    An integer overflow issue was found in the vmxnet3 NIC emulator of the
    QEMU. It may occur if a guest was to supply invalid values for rx/tx queue
    size or other NIC parameters. A privileged guest user may use this flaw to
    crash the QEMU process on the host resulting in DoS scenario.

CVE-2021-3416

    A potential stack overflow via infinite loop issue was found in various NIC
    emulators of QEMU in versions up to and including 5.2.0. The issue occurs
    in loopback mode of a NIC wherein reentrant DMA checks get bypassed. A
    guest user/process may use this flaw to consume CPU cycles or crash the
    QEMU process on the host resulting in DoS scenario.

CVE-2021-3416

    The patch for CVE-2020-17380/CVE-2020-25085 was found to be ineffective,
    thus making QEMU vulnerable to the out-of-bounds read/write access issues
    previously found in the SDHCI controller emulation code. This flaw allows a
    malicious privileged guest to crash the QEMU process on the host, resulting
    in a denial of service or potential code execution.

For Debian 9 stretch, these problems have been fixed in version
1:2.8+dfsg-6+deb9u14.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpaKbXQc0upx.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from git.qemu.org_b71eff76_20250115_120708.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

![QEMU](/uploads/-/system/group/avatar/3038080/logo.png?width=48)
# QEMU

QEMU Project repositories

Read more



=== Content from access.redhat.com_a04255ce_20250115_120709.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Fran√ßais](https://access.redhat.com/changeLanguage?language=fr)
* [ÌïúÍµ≠Ïñ¥](https://access.redhat.com/changeLanguage?language=ko)
* [Êó•Êú¨Ë™û](https://access.redhat.com/changeLanguage?language=ja)
* [‰∏≠Êñá (‰∏≠ÂõΩ)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 ¬© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.debian.org_c98311a9_20250114_203336.html ===


---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)]
[[Thread Prev](msg00007.html)][[Thread Next](msg00009.html)]
[[Date Index](maillist.html#00008)]
[[Thread Index](threads.html#00008)]

# [SECURITY] [DLA 3099-1] qemu security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3099-1] qemu security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Mon, 5 Sep 2022 08:58:05 +0530
* *Message-id*: <YxVsxXlWx/Sdg4MV@debian.org>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3099-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
September 05, 2022                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : qemu
Version        : 1:3.1+dfsg-8+deb10u9
CVE ID         : CVE-2020-13253 CVE-2020-15469 CVE-2020-15859 CVE-2020-25084
                 CVE-2020-25085 CVE-2020-25624 CVE-2020-25625 CVE-2020-25723
                 CVE-2020-27617 CVE-2020-27821 CVE-2020-28916 CVE-2020-29129
                 CVE-2020-29443 CVE-2020-35504 CVE-2020-35505 CVE-2021-3392
                 CVE-2021-3416 CVE-2021-3507 CVE-2021-3527 CVE-2021-3582
                 CVE-2021-3607 CVE-2021-3608 CVE-2021-3682 CVE-2021-3713
                 CVE-2021-3748 CVE-2021-3930 CVE-2021-4206 CVE-2021-4207
                 CVE-2021-20181 CVE-2021-20196 CVE-2021-20203 CVE-2021-20221
                 CVE-2021-20257 CVE-2022-26354 CVE-2022-35414

Multiple security issues were discovered in QEMU, a fast processor
emulator, which could result in denial of service or the the execution
of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:3.1+dfsg-8+deb10u9.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmMVbMUACgkQhj1N8u2c
KO+N6w//XuvPOvMxGsDw3swppKApkL1ECz7NC1L4xRouPyHhh0JZrqwovd5miY6M
mmIq2zeurtEVhf6kkhw1NP3ywrfgURyf7RhpcLN3z/o8aqjLoxL6fIJGzv9URulC
6xDpu1n5mKTI/EX8Zeqy9ks3+HgHNAg9jr5s5TWIYlJLhhlYvrvMbUAeM04V8Zaw
XGXJj0Jx1f83CMFVNXDJ6shBzfUZII3taZIjUFcME5DUFNxaG8492nYisRcwlDNy
Z1AOGbhehZlgbk5t4cX2kOMq/qp9EiAqrBUZgqXtT+zCRBr4hQjK5OOmaq69p4N5
RsS8MA3/Rtvt9b3xuNXnDy28O50yvlQJK9GJa/p8KM894pn2fMTu3pxFVAn4xIsp
umcx4LbxSYaBDygtK81xhxK3ODfakR8YGmXUffeRasPw/mFncdN9kTxCvuSgdoUO
rgqcmJ+D38JAzV+ALjEnMZkrGYzscM6GzKHA5DR37qmdG/JNNKpqy3TRWBpNY4ZL
QYmAIW5MvCx3SEgZBeAkUwPpfam6d3DwKm7RUvmvL5ul/UDcyowYRCpZGwgtyL57
8N3yu0V9IA0L04yuiUcd9RE3qXGsFQU7YvzpB7hEj2WQIV2i9LDb+5D2qnUJmdCR
+dCiSgxf0qi14Rbhv9gZ4/jCAC4fWHHGuyCO4ySyLVmDgtgBpQo=
=EhD5
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.launchpad.net_0021cc04_20250115_182257.html ===

[Log in / Register](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Blogin)

[![](https://launchpadlibrarian.net/27372372/qemu_64.png)](https://launchpad.net/qemu)

## [QEMU](https://launchpad.net/qemu)

* [Overview](https://launchpad.net/qemu)
* [Code](https://code.launchpad.net/qemu)
* [Bugs](https://bugs.launchpad.net/qemu)
* [Blueprints](https://blueprints.launchpad.net/qemu)
* [Translations](https://translations.launchpad.net/qemu)
* [Answers](https://answers.launchpad.net/qemu)

# QEMU: scsi: use-after-free in mptsas\_process\_scsi\_io\_request() of mptsas1068 emulator

Bug #1914236 reported by
[P J P](https://launchpad.net/~pjps)
on 2021-02-02

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [QEMU](https://bugs.launchpad.net/qemu) | Fix Released | Undecided | Unassigned |  |

### Bug Description

\* Cheolwoo Myung of Seoul National University reported a use-after-free issue in the SCSI Megaraid

¬†¬†emulator of the QEMU.

\* It occurs while handling mptsas\_process\_scsi\_io\_request(), as it does not

¬†¬†check a list in s->pending.

\* This was found in version 5.2.0 (master)

==31872==ERROR: AddressSanitizer: heap-use-after-free on address

0x60c000107568 at pc 0x564514950c7c bp 0x7fff524ef4b0 sp 0x7fff524ef4a0 WRITE of size 8 at 0x60c000107568 thread T0

#0 0x564514950c7b in mptsas\_process\_scsi\_io\_request ../hw/scsi/mptsas.c:306

#1 0x564514950c7b in mptsas\_fetch\_request ../hw/scsi/mptsas.c:775

#2 0x564514950c7b in mptsas\_fetch\_requests ../hw/scsi/mptsas.c:790

#3 0x56451585c25d in aio\_bh\_poll ../util/async.c:164

#4 0x5645158d7e7d in aio\_dispatch ../util/aio-posix.c:381

#5 0x56451585be2d in aio\_ctx\_dispatch ../util/async.c:306

#6 0x7f1cc8af4416 in g\_main\_context\_dispatch

(/usr/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x4c416)

#7 0x56451583f059 in glib\_pollfds\_poll ../util/main-loop.c:221

#8 0x56451583f059 in os\_host\_main\_loop\_wait ../util/main-loop.c:244

#9 0x56451583f059 in main\_loop\_wait ../util/main-loop.c:520

#10 0x56451536b181 in qemu\_main\_loop ../softmmu/vl.c:1537

#11 0x5645143ddd3d in main ../softmmu/main.c:50

#12 0x7f1cc2650b96 in \_\_libc\_start\_main

(/lib/x86\_64-linux-gnu/libc.so.6+0x21b96)

#13 0x5645143eece9 in \_start

(/home/cwmyung/prj/hyfuzz/src/qemu-repro/build/qemu-system-i386+0x1d55ce9)

0x60c000107568 is located 104 bytes inside of 120-byte region

[0x60c000107500,0x60c000107578)

freed by thread T0 here:

#0 0x7f1cca9777a8 in \_\_interceptor\_free

(/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xde7a8)

#1 0x56451495008b in mptsas\_process\_scsi\_io\_request ../hw/scsi/mptsas.c:358

#2 0x56451495008b in mptsas\_fetch\_request ../hw/scsi/mptsas.c:775

#3 0x56451495008b in mptsas\_fetch\_requests ../hw/scsi/mptsas.c:790

#4 0x7fff524ef8bf (<unknown module>)

previously allocated by thread T0 here:

#0 0x7f1cca977d28 in \_\_interceptor\_calloc

(/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xded28)

#1 0x7f1cc8af9b10 in g\_malloc0

(/usr/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x51b10)

#2 0x7fff524ef8bf (<unknown module>)

SUMMARY: AddressSanitizer: heap-use-after-free ../hw/scsi/mptsas.c:306

in mptsas\_process\_scsi\_io\_request

Shadow bytes around the buggy address:

0x0c1880018e50: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd

0x0c1880018e60: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa

0x0c1880018e70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd

0x0c1880018e80: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd

0x0c1880018e90: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa

=>0x0c1880018ea0: fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]fd fa

0x0c1880018eb0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00

0x0c1880018ec0: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa

0x0c1880018ed0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c1880018ee0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c1880018ef0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

Addressable: 00

Partially addressable: 01 02 03 04 05 06 07

Heap left redzone: fa

Freed heap region: fd

Stack left redzone: f1

Stack mid redzone: f2

Stack right redzone: f3

Stack after return: f5

Stack use after scope: f8

Global redzone: f9

Global init order: f6

Poisoned by user: f7

Container overflow: fc

Array cookie: ac

Intra object redzone: bb

ASan internal: fe

Left alloca redzone: ca

Right alloca redzone: cb

==31872==ABORTING

To reproduce this issue, please run the QEMU with the following command

line.

# To enable ASan option, please set configuration with the following command

$ ./configure --target-list=i386-softmmu --disable-werror --enable-sanitizers

$ make

# To reproduce this issue, please run the QEMU process with the

following command line.

$ ./qemu-system-i386 -m 512 -drive

file=./hyfuzz.img,index=0,media=disk,format=raw -device

mptsas1068,id=scsi -device scsi-hd,drive=SysDisk -drive

id=SysDisk,if=none,file=./disk.img

Tags:

[cve](/qemu/%2Bbugs?field.tag=cve)
[security](/qemu/%2Bbugs?field.tag=security)

## CVE References

* [2021-3392](/bugs/cve/2021-3392 "A use-after-free flaw was found in th...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-02-02: |  |  | [#1](/qemu/%2Bbug/1914236/comments/1) |
| --- | --- | --- | --- |

CVE-2021-3392 assigned by Red Hat In.c

CVE-2021-3392 assigned by Red Hat In.c

[P J P (pjps)](https://launchpad.net/~pjps)
on 2021-02-02

| **information type**: | Private Security ‚Üí Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-02-02: |  |  | [#2](/qemu/%2Bbug/1914236/comments/2) |
| --- | --- | --- | --- |

Upstream patch

¬†¬†-> <https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg00488.html>

Upstream patch
-> https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg00488.html

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mauro Matteo Cascella (mauro-cascella)](https://launchpad.net/~mauro-cascella) wrote on 2021-04-20: |  |  | [#3](/qemu/%2Bbug/1914236/comments/3) |
| --- | --- | --- | --- |

Upstream commit:

<https://git.qemu.org/?p=qemu.git;a=commit;h=3791642c8d60029adf9b00bcb4e34d7d8a1aea4d>

Upstream commit:
https://git.qemu.org/?p=qemu.git;a=commit;h=3791642c8d60029adf9b00bcb4e34d7d8a1aea4d

| Changed in qemu: | |
| --- | --- |
| **status**: | New ‚Üí Fix Committed |

[Thomas Huth (th-huth)](https://launchpad.net/~th-huth)
on 2021-04-30

| Changed in qemu: | |
| --- | --- |
| **status**: | Fix Committed ‚Üí Fix Released |

[See full activity log](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/qemu/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/qemu/%2Bbug/1914236/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
¬†‚Ä¢
[Take the tour](https://launchpad.net/%2Btour)
¬†‚Ä¢
[Read the guide](https://help.launchpad.net/)

¬© 2004
[Canonical¬†Ltd.](http://canonical.com/)
¬†‚Ä¢
[Terms of use](https://launchpad.net/legal)
¬†‚Ä¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
¬†‚Ä¢
[Contact Launchpad Support](/feedback)
¬†‚Ä¢
[Blog](http://blog.launchpad.net/)
¬†‚Ä¢
[Careers](https://canonical.com/careers)
¬†‚Ä¢
[System status](https://ubuntu.social/%40launchpadstatus)
¬†‚Ä¢
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_373135e2_20250115_182307.html ===

[Log in / Register](https://launchpad.net/~pjps/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~pjps)

## [P J P](https://launchpad.net/~pjps)

* Overview
* [Code](https://code.launchpad.net/~pjps)
* [Bugs](https://bugs.launchpad.net/~pjps)
* [Blueprints](https://blueprints.launchpad.net/~pjps)
* [Translations](https://translations.launchpad.net/~pjps)
* [Answers](https://answers.launchpad.net/~pjps)

* [Related packages](https://launchpad.net/~pjps/%2Brelated-packages)
* [Related projects](https://launchpad.net/~pjps/%2Brelated-projects)

## User information

Launchpad Id:
pjps

Email:
[Log in](%2Blogin) for email information.

Member since:
2020-05-22

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~pjps/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

P J P is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
¬†‚Ä¢
[Take the tour](https://launchpad.net/%2Btour)
¬†‚Ä¢
[Read the guide](https://help.launchpad.net/)

¬© 2004
[Canonical¬†Ltd.](http://canonical.com/)
¬†‚Ä¢
[Terms of use](https://launchpad.net/legal)
¬†‚Ä¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
¬†‚Ä¢
[Contact Launchpad Support](/feedback)
¬†‚Ä¢
[Blog](http://blog.launchpad.net/)
¬†‚Ä¢
[Careers](https://canonical.com/careers)
¬†‚Ä¢
[System status](https://ubuntu.social/%40launchpadstatus)
¬†‚Ä¢
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from security.netapp.com_51c39730_20250114_203337.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
√¶¬ó¬•√¶¬ú¬¨√®¬™¬û

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2021 QEMU Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20210507-0001)

## March 2021 QEMU Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close √ó

#### Subscribe to NTAP-20210507-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20210507-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close √ó

#### Unsubscribe from NTAP-20210507-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20210507-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20210507-0001
**Version:**
1.0

**Last updated:**
05/07/2021

**Status:**
Final.

**CVEs:** CVE-2021-3392, CVE-2021-3409

Overview
#### Summary

Multiple NetApp products incorporate QEMU. QEMU versions 2.10.0 through 5.2.0 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-3392](https://nvd.nist.gov/vuln/detail/CVE-2021-3392) | 3.2 (LOW) | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L |
| [CVE-2021-3409](https://nvd.nist.gov/vuln/detail/CVE-2021-3409) | 5.7 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

None.

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series BIOS
* E-Series SANtricity OS Controller Baseboard Management Controller (BMC) - EF600A
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Python SDK
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC)
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire BIOS
* NetApp SolidFire Baseboard Management Controller (BMC)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.6 and above
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SANtricity Unified Manager
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* SolidFire Storage Replication Adapter
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.6 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Trident
* Virtual Storage Console for VMware vSphere 9.6 and above

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20210507-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20210507 | Initial Public Release, Final status |

This document is provided solely for informational purposes. All information is based upon NetApp√¢¬Ä¬ôs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. √Ç¬© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ¬©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from bugs.launchpad.net_0c05760d_20250115_182256.html ===

[Log in / Register](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Blogin)

[![](https://launchpadlibrarian.net/27372372/qemu_64.png)](https://launchpad.net/qemu)

## [QEMU](https://launchpad.net/qemu)

* [Overview](https://launchpad.net/qemu)
* [Code](https://code.launchpad.net/qemu)
* [Bugs](https://bugs.launchpad.net/qemu)
* [Blueprints](https://blueprints.launchpad.net/qemu)
* [Translations](https://translations.launchpad.net/qemu)
* [Answers](https://answers.launchpad.net/qemu)

# QEMU: scsi: use-after-free in mptsas\_process\_scsi\_io\_request() of mptsas1068 emulator

Bug #1914236 reported by
[P J P](https://launchpad.net/~pjps)
on 2021-02-02

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [QEMU](https://bugs.launchpad.net/qemu) | Fix Released | Undecided | Unassigned |  |

### Bug Description

\* Cheolwoo Myung of Seoul National University reported a use-after-free issue in the SCSI Megaraid

¬†¬†emulator of the QEMU.

\* It occurs while handling mptsas\_process\_scsi\_io\_request(), as it does not

¬†¬†check a list in s->pending.

\* This was found in version 5.2.0 (master)

==31872==ERROR: AddressSanitizer: heap-use-after-free on address

0x60c000107568 at pc 0x564514950c7c bp 0x7fff524ef4b0 sp 0x7fff524ef4a0 WRITE of size 8 at 0x60c000107568 thread T0

#0 0x564514950c7b in mptsas\_process\_scsi\_io\_request ../hw/scsi/mptsas.c:306

#1 0x564514950c7b in mptsas\_fetch\_request ../hw/scsi/mptsas.c:775

#2 0x564514950c7b in mptsas\_fetch\_requests ../hw/scsi/mptsas.c:790

#3 0x56451585c25d in aio\_bh\_poll ../util/async.c:164

#4 0x5645158d7e7d in aio\_dispatch ../util/aio-posix.c:381

#5 0x56451585be2d in aio\_ctx\_dispatch ../util/async.c:306

#6 0x7f1cc8af4416 in g\_main\_context\_dispatch

(/usr/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x4c416)

#7 0x56451583f059 in glib\_pollfds\_poll ../util/main-loop.c:221

#8 0x56451583f059 in os\_host\_main\_loop\_wait ../util/main-loop.c:244

#9 0x56451583f059 in main\_loop\_wait ../util/main-loop.c:520

#10 0x56451536b181 in qemu\_main\_loop ../softmmu/vl.c:1537

#11 0x5645143ddd3d in main ../softmmu/main.c:50

#12 0x7f1cc2650b96 in \_\_libc\_start\_main

(/lib/x86\_64-linux-gnu/libc.so.6+0x21b96)

#13 0x5645143eece9 in \_start

(/home/cwmyung/prj/hyfuzz/src/qemu-repro/build/qemu-system-i386+0x1d55ce9)

0x60c000107568 is located 104 bytes inside of 120-byte region

[0x60c000107500,0x60c000107578)

freed by thread T0 here:

#0 0x7f1cca9777a8 in \_\_interceptor\_free

(/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xde7a8)

#1 0x56451495008b in mptsas\_process\_scsi\_io\_request ../hw/scsi/mptsas.c:358

#2 0x56451495008b in mptsas\_fetch\_request ../hw/scsi/mptsas.c:775

#3 0x56451495008b in mptsas\_fetch\_requests ../hw/scsi/mptsas.c:790

#4 0x7fff524ef8bf (<unknown module>)

previously allocated by thread T0 here:

#0 0x7f1cca977d28 in \_\_interceptor\_calloc

(/usr/lib/x86\_64-linux-gnu/libasan.so.4+0xded28)

#1 0x7f1cc8af9b10 in g\_malloc0

(/usr/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x51b10)

#2 0x7fff524ef8bf (<unknown module>)

SUMMARY: AddressSanitizer: heap-use-after-free ../hw/scsi/mptsas.c:306

in mptsas\_process\_scsi\_io\_request

Shadow bytes around the buggy address:

0x0c1880018e50: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd

0x0c1880018e60: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa

0x0c1880018e70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd

0x0c1880018e80: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd

0x0c1880018e90: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa

=>0x0c1880018ea0: fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]fd fa

0x0c1880018eb0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00

0x0c1880018ec0: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa

0x0c1880018ed0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c1880018ee0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c1880018ef0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

Addressable: 00

Partially addressable: 01 02 03 04 05 06 07

Heap left redzone: fa

Freed heap region: fd

Stack left redzone: f1

Stack mid redzone: f2

Stack right redzone: f3

Stack after return: f5

Stack use after scope: f8

Global redzone: f9

Global init order: f6

Poisoned by user: f7

Container overflow: fc

Array cookie: ac

Intra object redzone: bb

ASan internal: fe

Left alloca redzone: ca

Right alloca redzone: cb

==31872==ABORTING

To reproduce this issue, please run the QEMU with the following command

line.

# To enable ASan option, please set configuration with the following command

$ ./configure --target-list=i386-softmmu --disable-werror --enable-sanitizers

$ make

# To reproduce this issue, please run the QEMU process with the

following command line.

$ ./qemu-system-i386 -m 512 -drive

file=./hyfuzz.img,index=0,media=disk,format=raw -device

mptsas1068,id=scsi -device scsi-hd,drive=SysDisk -drive

id=SysDisk,if=none,file=./disk.img

Tags:

[cve](/qemu/%2Bbugs?field.tag=cve)
[security](/qemu/%2Bbugs?field.tag=security)

## CVE References

* [2021-3392](/bugs/cve/2021-3392 "A use-after-free flaw was found in th...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-02-02: |  |  | [#1](/qemu/%2Bbug/1914236/comments/1) |
| --- | --- | --- | --- |

CVE-2021-3392 assigned by Red Hat In.c

CVE-2021-3392 assigned by Red Hat In.c

[P J P (pjps)](https://launchpad.net/~pjps)
on 2021-02-02

| **information type**: | Private Security ‚Üí Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-02-02: |  |  | [#2](/qemu/%2Bbug/1914236/comments/2) |
| --- | --- | --- | --- |

Upstream patch

¬†¬†-> <https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg00488.html>

Upstream patch
-> https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg00488.html

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mauro Matteo Cascella (mauro-cascella)](https://launchpad.net/~mauro-cascella) wrote on 2021-04-20: |  |  | [#3](/qemu/%2Bbug/1914236/comments/3) |
| --- | --- | --- | --- |

Upstream commit:

<https://git.qemu.org/?p=qemu.git;a=commit;h=3791642c8d60029adf9b00bcb4e34d7d8a1aea4d>

Upstream commit:
https://git.qemu.org/?p=qemu.git;a=commit;h=3791642c8d60029adf9b00bcb4e34d7d8a1aea4d

| Changed in qemu: | |
| --- | --- |
| **status**: | New ‚Üí Fix Committed |

[Thomas Huth (th-huth)](https://launchpad.net/~th-huth)
on 2021-04-30

| Changed in qemu: | |
| --- | --- |
| **status**: | Fix Committed ‚Üí Fix Released |

[See full activity log](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/qemu/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/qemu/%2Bbug/1914236/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/qemu/%2Bbug/1914236/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
¬†‚Ä¢
[Take the tour](https://launchpad.net/%2Btour)
¬†‚Ä¢
[Read the guide](https://help.launchpad.net/)

¬© 2004
[Canonical¬†Ltd.](http://canonical.com/)
¬†‚Ä¢
[Terms of use](https://launchpad.net/legal)
¬†‚Ä¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
¬†‚Ä¢
[Contact Launchpad Support](/feedback)
¬†‚Ä¢
[Blog](http://blog.launchpad.net/)
¬†‚Ä¢
[Careers](https://canonical.com/careers)
¬†‚Ä¢
[System status](https://ubuntu.social/%40launchpadstatus)
¬†‚Ä¢
6394e03
([Get the code!](https://dev.launchpad.net/))


