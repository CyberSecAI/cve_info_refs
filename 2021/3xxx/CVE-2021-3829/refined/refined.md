Based on the provided information, this commit addresses a security vulnerability related to URL redirection.

**Root Cause:**

The vulnerability stems from an insufficient check on the redirect URL, allowing an attacker to craft a disguised URL that could redirect users to a malicious domain.

**Weaknesses/Vulnerabilities:**

- **Insufficient URL Validation:** The original code didn't properly validate the redirect URL, allowing for manipulation. Specifically, it appears that the application was not checking for the case where the redirect URL contained the application's prefix followed by an "@" symbol and then the malicious URL.
- **Open Redirect:** Although not a traditional "open redirect" where an arbitrary URL can be provided, the vulnerability allows a crafted URL to bypass the intended redirect domain check.

**Impact of Exploitation:**

- **Phishing Attacks:** Attackers could redirect users to fake login pages or other malicious sites, potentially stealing credentials or other sensitive information.
- **Reputation Damage:** If users are redirected to malicious content, it can damage the reputation of the legitimate website.

**Attack Vectors:**

- **Crafted URLs:** The attacker crafts a URL that appears to be within the legitimate domain but redirects to a different site.  Specifically, by using the application's URL prefix followed by an "@" symbol, then the malicious domain.
- **Parameter Manipulation:** The attacker manipulates a parameter (likely the `redirect` parameter) that controls the redirect target.

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to inject or control the `redirect` parameter in the application
- No specific privilege is needed, this can likely be done by a normal user.
- No special network access needed.

**Technical Details:**

The fix introduces the `safeRedirect` function, which performs the following checks:
- It creates a full URL using the provided URL and the application's prefix
- It checks if the created URL string starts with the application's prefix.
- It ensures that the protocol and host of the generated URL matches the applications URL prefix. This effectively blocks redirect URLs that contain an `@` symbol after the application's URL prefix

Additionally, the fix includes a test case to verify that redirection to a disguised domain is blocked, using the `@` symbol in the constructed malicious URL (`${URL_PREFIX}@google.com`)