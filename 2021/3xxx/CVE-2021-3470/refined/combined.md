=== Content from github.com_7527415c_20250115_135834.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fpull%2F7963)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fpull%2F7963)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=redis%2Fredis)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[redis](/redis)
/
**[redis](/redis/redis)**
Public

* [Notifications](/login?return_to=%2Fredis%2Fredis) You must be signed in to change notification settings
* [Fork
  23.9k](/login?return_to=%2Fredis%2Fredis)
* [Star
   67.7k](/login?return_to=%2Fredis%2Fredis)

* [Code](/redis/redis)
* [Issues
  2.1k](/redis/redis/issues)
* [Pull requests
  465](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects
  10](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

Additional navigation options

* [Code](/redis/redis)
* [Issues](/redis/redis/issues)
* [Pull requests](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fredis%2Fredis%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fredis%2Fredis%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix wrong zmalloc\_size() assumption. #7963

 Merged

[yossigo](/yossigo)
merged 1 commit into
[redis:unstable](/redis/redis/tree/unstable "redis/redis:unstable")
from
[yossigo:fix-zmalloc\_size](/yossigo/redis/tree/fix-zmalloc_size "yossigo/redis:fix-zmalloc_size")

Oct 26, 2020

 Merged

# [Fix wrong zmalloc\_size() assumption.](#top) #7963

[yossigo](/yossigo)
merged 1 commit into
[redis:unstable](/redis/redis/tree/unstable "redis/redis:unstable")
from
[yossigo:fix-zmalloc\_size](/yossigo/redis/tree/fix-zmalloc_size "yossigo/redis:fix-zmalloc_size")

Oct 26, 2020

[Conversation
0](/redis/redis/pull/7963)
[Commits
1](/redis/redis/pull/7963/commits)
[Checks
0](/redis/redis/pull/7963/checks)
[Files changed](/redis/redis/pull/7963/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![yossigo](https://avatars.githubusercontent.com/u/1481195?s=60&v=4)](/yossigo)

Copy link

Member

### @yossigo **[yossigo](/yossigo)** commented [Oct 26, 2020](#issue-729527496)

When using a system with no malloc\_usable\_size(), zmalloc\_size() assumed

that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc\_size()

returning a size that is bigger than allocated. At least in one case

this leads to out of bound write, process crash and a potential security

vulnerability.

Effectively this does not affect the vast majority of users, who use

jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

Sorry, something went wrong.

All reactions

[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&v=4)](/yossigo)

`[Fix wrong zmalloc_size() assumption.](/redis/redis/pull/7963/commits/4fe70d16b2837fabae262dccba16620d523ea72e "Fix wrong zmalloc_size() assumption.

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.")`
 …

`[4fe70d1](/redis/redis/pull/7963/commits/4fe70d16b2837fabae262dccba16620d523ea72e)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.
```

[![oranagra](https://avatars.githubusercontent.com/u/7045099?s=60&v=4)](/oranagra)

**[oranagra](/oranagra)**
approved these changes
[Oct 26, 2020](#pullrequestreview-516735197)

 [View reviewed changes](/redis/redis/pull/7963/files/4fe70d16b2837fabae262dccba16620d523ea72e)

[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo)
[yossigo](/yossigo)
merged commit [`9824fe3`](/redis/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95)
into
redis:unstable

[Oct 26, 2020](https://github.com/redis/redis/pull/7963#event-3920522860)

 [![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo)
[yossigo](/yossigo)
deleted the
fix-zmalloc\_size

branch
[October 26, 2020 12:49](#event-3920523234)

This was referenced Oct 26, 2020

[release 5.0.10
#7964](/redis/redis/pull/7964)
 Merged

[release 6.0.9
#7965](/redis/redis/pull/7965)
 Merged

[oranagra](/oranagra)
pushed a commit
that referenced
this pull request
[Oct 27, 2020](#ref-commit-3cf3bef)
[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo) [![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=40&v=4)](/oranagra)

`[Fix wrong zmalloc_size() assumption. (](/redis/redis/commit/3cf3beff2c339f3ceaff70e5c225aa9c2ad6f8d0 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)")[#7963](https://github.com/redis/redis/pull/7963)[)](/redis/redis/commit/3cf3beff2c339f3ceaff70e5c225aa9c2ad6f8d0 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)")`
…

`[3cf3bef](/redis/redis/commit/3cf3beff2c339f3ceaff70e5c225aa9c2ad6f8d0)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit [9824fe3](https://github.com/redis/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95))
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)
```

[oranagra](/oranagra)
pushed a commit
that referenced
this pull request
[Oct 27, 2020](#ref-commit-3cc673b)
[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo) [![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=40&v=4)](/oranagra)

`[Fix wrong zmalloc_size() assumption. (](/redis/redis/commit/3cc673bdd87d7d31bae0b4288b29e1c163981416 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)")[#7963](https://github.com/redis/redis/pull/7963)[)](/redis/redis/commit/3cc673bdd87d7d31bae0b4288b29e1c163981416 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)")`
…

`[3cc673b](/redis/redis/commit/3cc673bdd87d7d31bae0b4288b29e1c163981416)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit [9824fe3](https://github.com/redis/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95))
```

[netbsd-srcmastr](/netbsd-srcmastr)
pushed a commit
to NetBSD/pkgsrc
that referenced
this pull request
[Oct 27, 2020](#ref-commit-d766b87)

`[redis: updated to 6.0.9](/NetBSD/pkgsrc/commit/d766b876049a63dcde8cac31adb1e847c0de7db1 "redis: updated to 6.0.9

Redis 6.0.9
===========

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

New:
* Memory reporting of clients argv
* Add redis-cli control on raw format line delimiter
* Add redis-cli support for rediss:// -u prefix
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC
* Correct OBJECT ENCODING response for stream type
* Allow blocked XREAD on a cluster replica
* TLS: Do not require CA config if not used

Bug fixes:
* INFO report real peak memory (before eviction)
* Allow requirepass config to clear the password
* Fix config rewrite file handling to make it really atomic
* Fix excessive categories being displayed from ACLs
* Add fsync in replica when full RDB payload was received
* Don't write replies to socket when output buffer limit reached
* Fix redis-check-rdb support for modules aux data
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks
* Add RM_GetClientCertificate
* Add RM_GetDetachedThreadSafeContext
* Add RM_GetCommandKeys
* Add Swapdb Module Event
* RM_GetContextFlags provides indication of being in a fork child
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD
* Expose real client on connection events
* Minor improvements to module blocked on keys")`
…

`[d766b87](/NetBSD/pkgsrc/commit/d766b876049a63dcde8cac31adb1e847c0de7db1)`

```
Redis 6.0.9
===========

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

New:
* Memory reporting of clients argv
* Add redis-cli control on raw format line delimiter
* Add redis-cli support for rediss:// -u prefix
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC
* Correct OBJECT ENCODING response for stream type
* Allow blocked XREAD on a cluster replica
* TLS: Do not require CA config if not used

Bug fixes:
* INFO report real peak memory (before eviction)
* Allow requirepass config to clear the password
* Fix config rewrite file handling to make it really atomic
* Fix excessive categories being displayed from ACLs
* Add fsync in replica when full RDB payload was received
* Don't write replies to socket when output buffer limit reached
* Fix redis-check-rdb support for modules aux data
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks
* Add RM_GetClientCertificate
* Add RM_GetDetachedThreadSafeContext
* Add RM_GetCommandKeys
* Add Swapdb Module Event
* RM_GetContextFlags provides indication of being in a fork child
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD
* Expose real client on connection events
* Minor improvements to module blocked on keys
```

[JackieXie168](/JackieXie168)
pushed a commit
to JackieXie168/redis
that referenced
this pull request
[Nov 4, 2020](#ref-commit-a4b5697)
[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo)

`[Fix wrong zmalloc_size() assumption. (](/JackieXie168/redis/commit/a4b56979066fb12b782ff035f6d7d116580924b1 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.")[redis#7963](https://github.com/redis/redis/pull/7963)[)](/JackieXie168/redis/commit/a4b56979066fb12b782ff035f6d7d116580924b1 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.")`
…

`[a4b5697](/JackieXie168/redis/commit/a4b56979066fb12b782ff035f6d7d116580924b1)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.
```

[![@jannfis](https://avatars.githubusercontent.com/u/3942683?s=40&v=4)](/jannfis)
[jannfis](/jannfis)
mentioned this pull request
[Nov 4, 2020](#ref-issue-735904855)

[Update redis version
argoproj/argo-cd#4748](/argoproj/argo-cd/issues/4748)

Closed

3 tasks

[jschmieg](/jschmieg)
pushed a commit
to memKeyDB/memKeyDB
that referenced
this pull request
[Nov 6, 2020](#ref-commit-d749cd2)
[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo) [![@jschmieg](https://avatars.githubusercontent.com/u/13744385?s=40&v=4)](/jschmieg)

`[Fix wrong zmalloc_size() assumption. (](/memKeyDB/memKeyDB/commit/d749cd2e3dac427d538d2d9391684a69acf3d7e5 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)")[redis#7963](https://github.com/redis/redis/pull/7963)[)](/memKeyDB/memKeyDB/commit/d749cd2e3dac427d538d2d9391684a69acf3d7e5 "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)")`
…

`[d749cd2](/memKeyDB/memKeyDB/commit/d749cd2e3dac427d538d2d9391684a69acf3d7e5)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit [9824fe3](https://github.com/memKeyDB/memKeyDB/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95))
```

[buildroot-auto-update](/buildroot-auto-update)
pushed a commit
to buildroot/buildroot
that referenced
this pull request
[Nov 16, 2020](#ref-commit-f1bce08)
[![@ffontaine](https://avatars.githubusercontent.com/u/1485263?s=40&v=4)](/ffontaine) [![@jacmet](https://avatars.githubusercontent.com/u/6599?s=40&v=4)](/jacmet)

`[package/redis: security bump to version 6.0.9](/buildroot/buildroot/commit/f1bce086f6eb174e154a753c6608b3636345fd62 "package/redis: security bump to version 6.0.9

This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>")`
…

`[f1bce08](/buildroot/buildroot/commit/f1bce086f6eb174e154a753c6608b3636345fd62)`

```
This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

<https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES>

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
```

[buildroot-auto-update](/buildroot-auto-update)
pushed a commit
to buildroot/buildroot
that referenced
this pull request
[Nov 16, 2020](#ref-commit-bd21b79)
[![@jacmet](https://avatars.githubusercontent.com/u/6599?s=40&u=9fe70d3f87b3e89e02b065a383742e42f37a3e16&v=4)](/jacmet)

`[package/redis: security bump to version 5.0.10](/buildroot/buildroot/commit/bd21b79f1fc87a81a216117ee2aa2e0c2d293c43 "package/redis: security bump to version 5.0.10

This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

https://raw.githubusercontent.com/redis/redis/5.0/00-RELEASENOTES

Signed-off-by: Peter Korsgaard <peter@korsgaard.com>")`
…

`[bd21b79](/buildroot/buildroot/commit/bd21b79f1fc87a81a216117ee2aa2e0c2d293c43)`

```
This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

<https://raw.githubusercontent.com/redis/redis/5.0/00-RELEASENOTES>

Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
```

[buildroot-auto-update](/buildroot-auto-update)
pushed a commit
to buildroot/buildroot
that referenced
this pull request
[Nov 16, 2020](#ref-commit-4a76009)
[![@ffontaine](https://avatars.githubusercontent.com/u/1485263?s=40&v=4)](/ffontaine) [![@jacmet](https://avatars.githubusercontent.com/u/6599?s=40&v=4)](/jacmet)

`[package/redis: security bump to version 6.0.9](/buildroot/buildroot/commit/4a76009d7393854ad15aae1e94a1049c88b4bce7 "package/redis: security bump to version 6.0.9

This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
(cherry picked from commit f1bce086f6eb174e154a753c6608b3636345fd62)
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>")`
…

`[4a76009](/buildroot/buildroot/commit/4a76009d7393854ad15aae1e94a1049c88b4bce7)`

```
This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

<https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES>

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
(cherry picked from commit [f1bce08](https://github.com/buildroot/buildroot/commit/f1bce086f6eb174e154a753c6608b3636345fd62))
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
```

[fifteenhex](/fifteenhex)
pushed a commit
to fifteenhex/buildroot
that referenced
this pull request
[Nov 26, 2020](#ref-commit-8d7c85b)
[![@ffontaine](https://avatars.githubusercontent.com/u/1485263?s=40&v=4)](/ffontaine) [![@fifteenhex](https://avatars.githubusercontent.com/u/682372?s=40&v=4)](/fifteenhex)

`[package/redis: security bump to version 6.0.9](/fifteenhex/buildroot/commit/8d7c85b286d80b3e7e80bb8b90c39139e9964728 "package/redis: security bump to version 6.0.9

This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>")`
…

`[8d7c85b](/fifteenhex/buildroot/commit/8d7c85b286d80b3e7e80bb8b90c39139e9964728)`

```
This release fixes a potential heap overflow when using a heap allocator
other than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

<https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES>

Signed-off-by: Fabrice Fontaine <fontaine.fabrice@gmail.com>
Signed-off-by: Peter Korsgaard <peter@korsgaard.com>
```

[uqs](/uqs)
pushed a commit
to freebsd/freebsd-ports
that referenced
this pull request
[Jan 13, 2021](#ref-commit-492d1a9)

`[Update from 6.0.8 to 6.0.10.](/freebsd/freebsd-ports/commit/492d1a9566c3e953e83471151e2e03c0d8ad9dc2 "Update from 6.0.8 to 6.0.10.

<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561473 35697150-7ecd-e111-bb59-0022644237b5")`
…

`[492d1a9](/freebsd/freebsd-ports/commit/492d1a9566c3e953e83471151e2e03c0d8ad9dc2)`

```
<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561473 35697150-7ecd-e111-bb59-0022644237b5
```

[uqs](/uqs)
pushed a commit
to freebsd/freebsd-ports
that referenced
this pull request
[Jan 13, 2021](#ref-commit-81da774)
[![@osokin](https://avatars.githubusercontent.com/u/130814?s=40&u=39f557a7d7b0664199e8cb04d8d52a51d19b4532&v=4)](/osokin)

`[Update from 6.0.8 to 6.0.10.](/freebsd/freebsd-ports/commit/81da77462c77160434012d5ddbaea2b00426f98d "Update from 6.0.8 to 6.0.10.

<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>")`
…

`[81da774](/freebsd/freebsd-ports/commit/81da77462c77160434012d5ddbaea2b00426f98d)`

```
<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>
```

[Jehops](/Jehops)
pushed a commit
to Jehops/freebsd-ports-legacy
that referenced
this pull request
[Jan 13, 2021](#ref-commit-98b8df3)
[![@osokin](https://avatars.githubusercontent.com/u/130814?s=40&u=39f557a7d7b0664199e8cb04d8d52a51d19b4532&v=4)](/osokin)

`[Update from 6.0.8 to 6.0.10.](/Jehops/freebsd-ports-legacy/commit/98b8df31889a37b97b90e9977367f8e7eddbf31e "Update from 6.0.8 to 6.0.10.

<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561473 35697150-7ecd-e111-bb59-0022644237b5")`
…

`[98b8df3](/Jehops/freebsd-ports-legacy/commit/98b8df31889a37b97b90e9977367f8e7eddbf31e)`

```
<ChangeLog>

================================================================================
Redis 6.0.10     Released Tue Jan 12 16:20:20 IST 2021
================================================================================

Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Here is a comprehensive list of changes in this release compared to 6.0.9.

Command behavior changes:
* SWAPDB invalidates WATCHed keys (#8239)
* SORT command behaves differently when used on a writable replica (#8283)
* EXISTS should not alter LRU (#8016)
  In Redis 5.0 and 6.0 it would have touched the LRU/LFU of the key.
* OBJECT should not reveal logically expired keys (#8016)
  Will now behave the same TYPE or any other non-DEBUG command.
* GEORADIUS[BYMEMBER] can fail with -OOM if Redis is over the memory limit (#8107)

Other behavior changes:
* Sentinel: Fix missing updates to the config file after SENTINEL SET command (#8229)
* CONFIG REWRITE is atomic and safer, but requires write access to the config file's folder (#7824, #8051)
  This change was already present in 6.0.9, but was missing from the release notes.

Bug fixes with compatibility implications (bugs introduced in Redis 6.0):
* Fix RDB CRC64 checksum on big-endian systems (#8270)
  If you're using big-endian please consider the compatibility implications with
  RESTORE, replication and persistence.
* Fix wrong order of key/value in Lua's map response (#8266)
  If your scripts use redis.setresp() or return a map (new in Redis 6.0), please
  consider the implications.

Bug fixes:
* Fix an issue where a forked process deletes the parent's pidfile (#8231)
* Fix crashes when enabling io-threads-do-reads (#8230)
* Fix a crash in redis-cli after executing cluster backup (#8267)
* Handle output buffer limits for module blocked clients (#8141)
  Could result in a module sending reply to a blocked client to go beyond the limit.
* Fix setproctitle related crashes. (#8150, #8088)
  Caused various crashes on startup, mainly on Apple M1 chips or under instrumentation.
* Backup/restore cluster mode keys to slots map for repl-diskless-load=swapdb (#8108)
  In cluster mode with repl-diskless-load, when loading failed, slot map wouldn't
  have been restored.
* Fix oom-score-adj-values range, and bug when used in config file (#8046)
  Enabling setting this in the config file in a line after enabling it, would
  have been buggy.
* Reset average ttl when empty databases (#8106)
  Just causing misleading metric in INFO
* Disable rehash when Redis has child process (#8007)
  This could have caused excessive CoW during BGSAVE, replication or AOFRW.
* Further improved ACL algorithm for picking categories (#7966)
  Output of ACL GETUSER is now more similar to the one provided by ACL SETUSER.
* Fix bug with module GIL being released prematurely (#8061)
  Could in theory (and rarely) cause multi-threaded modules to corrupt memory.
* Reduce effect of client tracking causing feedback loop in key eviction (#8100)
* Fix cluster access to unaligned memory (SIGBUS on old ARM) (#7958)
* Fix saving of strings larger than 2GB into RDB files (#8306)

Additional improvements:
* Avoid wasteful transient memory allocation in certain cases (#8286, #5954)

Platform / toolchain support related improvements:
* Fix crash log registers output on ARM. (#8020)
* Add a check for an ARM64 Linux kernel bug (#8224)
  Due to the potential severity of this issue, Redis will print log warning on startup.
* Raspberry build fix. (#8095)

New configuration options:
* oom-score-adj-values config can now take absolute values (besides relative ones) (#8046)

Module related fixes:
* Moved RMAPI_FUNC_SUPPORTED so that it's usable (#8037)
* Improve timer accuracy (#7987)
* Allow '\0' inside of result of RM_CreateStringPrintf (#6260)

================================================================================
Redis 6.0.9     Released Mon Oct 26 10:37:47 IST 2020
================================================================================

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

New:
* Memory reporting of clients argv (#7874)
* Add redis-cli control on raw format line delimiter (#7841)
* Add redis-cli support for rediss:// -u prefix (#7900)
* Get rss size support for NetBSD and DragonFlyBSD

Behavior changes:
* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
* Correct OBJECT ENCODING response for stream type (#7797)
* Allow blocked XREAD on a cluster replica (#7881)
* TLS: Do not require CA config if not used (#7862)

Bug fixes:
* INFO report real peak memory (before eviction) (#7894)
* Allow requirepass config to clear the password (#7899)
* Fix config rewrite file handling to make it really atomic (#7824)
* Fix excessive categories being displayed from ACLs (#7889)
* Add fsync in replica when full RDB payload was received (#7839)
* Don't write replies to socket when output buffer limit reached (#7202)
* Fix redis-check-rdb support for modules aux data (#7826)
* Other smaller bug fixes

Modules API:
* Add APIs for version and compatibility checks (#7865)
* Add RM_GetClientCertificate (#7866)
* Add RM_GetDetachedThreadSafeContext (#7886)
* Add RM_GetCommandKeys (#7884)
* Add Swapdb Module Event (#7804)
* RM_GetContextFlags provides indication of being in a fork child (#7783)
* RM_GetContextFlags document missing flags: MULTI_DIRTY, IS_CHILD (#7821)
* Expose real client on connection events (#7867)
* Minor improvements to module blocked on keys (#7903)

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561473 35697150-7ecd-e111-bb59-0022644237b5
```

[uqs](/uqs)
pushed a commit
to freebsd/freebsd-ports
that referenced
this pull request
[Jan 14, 2021](#ref-commit-1ca6f97)

`[Update to the latest release 5.0.10.](/freebsd/freebsd-ports/commit/1ca6f97ecd46861225f93bbedcaaee0dd29e7bb6 "Update to the latest release 5.0.10.

<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561525 35697150-7ecd-e111-bb59-0022644237b5")`
…

`[1ca6f97](/freebsd/freebsd-ports/commit/1ca6f97ecd46861225f93bbedcaaee0dd29e7bb6)`

```
<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561525 35697150-7ecd-e111-bb59-0022644237b5
```

[uqs](/uqs)
pushed a commit
to freebsd/freebsd-ports
that referenced
this pull request
[Jan 14, 2021](#ref-commit-4d2453a)
[![@osokin](https://avatars.githubusercontent.com/u/130814?s=40&u=39f557a7d7b0664199e8cb04d8d52a51d19b4532&v=4)](/osokin)

`[Update to the latest release 5.0.10.](/freebsd/freebsd-ports/commit/4d2453a208fe7002cf66cae30a3ef0a58607500f "Update to the latest release 5.0.10.

<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>")`
…

`[4d2453a](/freebsd/freebsd-ports/commit/4d2453a208fe7002cf66cae30a3ef0a58607500f)`

```
<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>
```

[Jehops](/Jehops)
pushed a commit
to Jehops/freebsd-ports-legacy
that referenced
this pull request
[Jan 14, 2021](#ref-commit-f248c7f)
[![@osokin](https://avatars.githubusercontent.com/u/130814?s=40&u=39f557a7d7b0664199e8cb04d8d52a51d19b4532&v=4)](/osokin)

`[Update to the latest release 5.0.10.](/Jehops/freebsd-ports-legacy/commit/f248c7f623d947c9400c6c0e5b09f612a4faf721 "Update to the latest release 5.0.10.

<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561525 35697150-7ecd-e111-bb59-0022644237b5")`
…

`[f248c7f](/Jehops/freebsd-ports-legacy/commit/f248c7f623d947c9400c6c0e5b09f612a4faf721)`

```
<ChangeLog>

Upgrade urgency: SECURITY if you use an affected platform (see below).
                 Otherwise the upgrade urgency is MODERATE.

This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Other fixes in this release:

* Avoid case of Lua scripts being consistently aborted due to OOM
* XPENDING will not update consumer's seen-time
* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
* UNLINK support for streams
* RESTORE ABSTTL won't store expired keys into the DB
* Hide AUTH from MONITOR
* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
* Cluster: Fix case of clusters mixing accidentally by gossip
* Cluster: Allow blocked XREAD on a cluster replica
* Cluster: Optimize memory usage CLUSTER SLOTS command
* RedisModule_ValueLength support for stream data type
* Minor fixes in redis-check-rdb and redis-cli
* Fix redis-check-rdb support for modules aux data
* Add fsync in replica when full RDB payload was received

</ChangeLog>

git-svn-id: svn+ssh://svn.freebsd.org/ports/head@561525 35697150-7ecd-e111-bb59-0022644237b5
```

[halstead](/halstead)
pushed a commit
to openembedded/meta-openembedded
that referenced
this pull request
[Nov 7, 2021](#ref-commit-6be10fe)
[![@akuster](https://avatars.githubusercontent.com/u/2244798?s=40&u=be3bc1afff8b9a1807f3e252d5d7f473e39ebaa0&v=4)](/akuster)

`[redis: update to 5.0.14](/openembedded/meta-openembedded/commit/6be10fe608c09653416ae8c85377056ccaa9f1b9 "redis: update to 5.0.14

Bug fix only updates. see: https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Signed-off-by: Armin Kuster <akuster808@gmail.com>")`
…

`[6be10fe](/openembedded/meta-openembedded/commit/6be10fe608c09653416ae8c85377056ccaa9f1b9)`

```
Bug fix only updates. see: <https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES>

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Signed-off-by: Armin Kuster <akuster808@gmail.com>
```

[jpuhlman](/jpuhlman)
pushed a commit
to MontaVista-OpenSourceTechnology/meta-openembedded
that referenced
this pull request
[Nov 8, 2021](#ref-commit-2702f95)
[![@akuster](https://avatars.githubusercontent.com/u/2244798?s=40&u=be3bc1afff8b9a1807f3e252d5d7f473e39ebaa0&v=4)](/akuster) [![@jpuhlman](https://avatars.githubusercontent.com/u/786636?s=40&v=4)](/jpuhlman)

`[redis: update to 5.0.14](/MontaVista-OpenSourceTechnology/meta-openembedded/commit/2702f950ee9f755588eb36b86ce8abb9e753f24d "redis: update to 5.0.14

Source: meta-openembedded
MR: 113447
Type: Integration
Disposition: Merged from meta-openembedded
ChangeID: 6be10fe608c09653416ae8c85377056ccaa9f1b9
Description:

Bug fix only updates. see: https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Signed-off-by: Armin Kuster <akuster808@gmail.com>
Signed-off-by: Jeremy Puhlman <jpuhlman@mvista.com>")`
…

`[2702f95](/MontaVista-OpenSourceTechnology/meta-openembedded/commit/2702f950ee9f755588eb36b86ce8abb9e753f24d)`

```
Source: meta-openembedded
MR: 113447
Type: Integration
Disposition: Merged from meta-openembedded
ChangeID: [6be10fe](https://github.com/MontaVista-OpenSourceTechnology/meta-openembedded/commit/6be10fe608c09653416ae8c85377056ccaa9f1b9)
Description:

Bug fix only updates. see: <https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES>

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Signed-off-by: Armin Kuster <akuster808@gmail.com>
Signed-off-by: Jeremy Puhlman <jpuhlman@mvista.com>
```

[jpuhlman](/jpuhlman)
pushed a commit
to MontaVista-OpenSourceTechnology/meta-openembedded
that referenced
this pull request
[Nov 9, 2021](#ref-commit-8c57208)
[![@akuster](https://avatars.githubusercontent.com/u/2244798?s=40&u=be3bc1afff8b9a1807f3e252d5d7f473e39ebaa0&v=4)](/akuster) [![@jpuhlman](https://avatars.githubusercontent.com/u/786636?s=40&v=4)](/jpuhlman)

`[redis: update to 5.0.14](/MontaVista-OpenSourceTechnology/meta-openembedded/commit/8c572085e8dae6582f7a7c3a782f456df873e97c "redis: update to 5.0.14

Source: meta-openembedded
MR: 113447
Type: Integration
Disposition: Merged from meta-openembedded
ChangeID: 6be10fe608c09653416ae8c85377056ccaa9f1b9
Description:

Bug fix only updates. see: https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963

Signed-off-by: Armin Kuster <akuster808@gmail.com>
Signed-off-by: Jeremy Puhlman <jpuhlman@mvista.com>")`
…

`[8c57208](/MontaVista-OpenSourceTechnology/meta-openembedded/commit/8c572085e8dae6582f7a7c3a782f456df873e97c)`

```
Source: meta-openembedded
MR: 113447
Type: Integration
Disposition: Merged from meta-openembedded
ChangeID: [6be10fe](https://github.com/MontaVista-OpenSourceTechnology/meta-openembedded/commit/6be10fe608c09653416ae8c85377056ccaa9f1b9)
Description:

Bug fix only updates. see: <https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES>

Including these cves:

5.0.14
Security Fixes:
* (CVE-2021-41099) Integer to heap buffer overflow handling certain string
commands and network payloads, when proto-max-bulk-len is manually configured
to a non-default, very large value [reported by yiyuaner].
* (CVE-2021-32762) Integer to heap buffer overflow issue in redis-cli and
redis-sentinel parsing large multi-bulk replies on some older and less common
platforms [reported by Microsoft Vulnerability Research].
* (CVE-2021-32687) Integer to heap buffer overflow with intsets, when
set-max-intset-entries is manually configured to a non-default, very large
value [reported by Pawel Wieczorkiewicz, AWS].
* (CVE-2021-32675) Denial Of Service when processing RESP request payloads with
a large number of elements on many connections.
* (CVE-2021-32672) Random heap reading issue with Lua Debugger [reported by
Meir Shpilraien].
* (CVE-2021-32628) Integer to heap buffer overflow handling ziplist-encoded
data types, when configuring a large, non-default value for
hash-max-ziplist-entries, hash-max-ziplist-value, zset-max-ziplist-entries
or zset-max-ziplist-value [reported by sundb].
* (CVE-2021-32627) Integer to heap buffer overflow issue with streams, when
configuring a non-default, large value for proto-max-bulk-len and
client-query-buffer-limit [reported by sundb].
* (CVE-2021-32626) Specially crafted Lua scripts may result with Heap buffer
overflow [reported by Meir Shpilraien].

5.0.11
Integer overflow on 32-bit systems (CVE-2021-21309):
Redis 4.0 or newer uses a configurable limit for the maximum supported bulk
input size. By default, it is 512MB which is a safe value for all platforms.
If the limit is significantly increased, receiving a large request from a client
may trigger several integer overflow scenarios, which would result with buffer
overflow and heap corruption.

5.0.10
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
[redis/redis#7963](https://github.com/redis/redis/pull/7963)

Signed-off-by: Armin Kuster <akuster808@gmail.com>
Signed-off-by: Jeremy Puhlman <jpuhlman@mvista.com>
```

[![@sundb](https://avatars.githubusercontent.com/u/965798?s=40&v=4)](/sundb)
[sundb](/sundb)
mentioned this pull request
[Jul 15, 2022](#ref-issue-1305465246)

[How to solve CVE-2021-3470 in Windowserver system?
#10980](/redis/redis/issues/10980)

Closed

[pulllock](/pulllock)
pushed a commit
to pulllock/redis
that referenced
this pull request
[Jun 28, 2023](#ref-commit-73d553a)
[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&u=928c15688dec41a036e28cbabd7829850f901893&v=4)](/yossigo) [![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=40&v=4)](/oranagra)

`[Fix wrong zmalloc_size() assumption. (](/pulllock/redis/commit/73d553ab03fe86f8e6c54f72e43d0abb7bbe1ccf "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)")[redis#7963](https://github.com/redis/redis/pull/7963)[)](/pulllock/redis/commit/73d553ab03fe86f8e6c54f72e43d0abb7bbe1ccf "Fix wrong zmalloc_size() assumption. (#7963)

When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit 9824fe3e392caa04dc1b4071886e9ac402dd6d95)
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)")`
…

`[73d553a](/pulllock/redis/commit/73d553ab03fe86f8e6c54f72e43d0abb7bbe1ccf)`

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.

(cherry picked from commit [9824fe3](https://github.com/pulllock/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95))
(cherry picked from commit ce0d74d8fdff55d07929f562ec9acf2d00caf893)
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fpull%2F7963)

Reviewers

[![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=40&v=4)](/oranagra) [oranagra](/oranagra)

oranagra approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=52&v=4)](/yossigo) [![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=52&v=4)](/oranagra)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b068a5d4_20250115_135830.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=redis%2Fredis)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[redis](/redis)
/
**[redis](/redis/redis)**
Public

* [Notifications](/login?return_to=%2Fredis%2Fredis) You must be signed in to change notification settings
* [Fork
  23.9k](/login?return_to=%2Fredis%2Fredis)
* [Star
   67.7k](/login?return_to=%2Fredis%2Fredis)

Redis is an in-memory database that persists on disk. The data model is key-value, but many different kind of values are supported: Strings, Lists, Sets, Sorted Sets, Hashes, Streams, HyperLogLogs, Bitmaps.

[redis.io](http://redis.io "http://redis.io")

### License

[View license](/redis/redis/blob/unstable/LICENSE.txt)

[67.7k
stars](/redis/redis/stargazers) [23.9k
forks](/redis/redis/forks) [Branches](/redis/redis/branches) [Tags](/redis/redis/tags) [Activity](/redis/redis/activity)
 [Star](/login?return_to=%2Fredis%2Fredis)

 [Notifications](/login?return_to=%2Fredis%2Fredis) You must be signed in to change notification settings

* [Code](/redis/redis)
* [Issues
  2.1k](/redis/redis/issues)
* [Pull requests
  465](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects
  10](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

Additional navigation options

* [Code](/redis/redis)
* [Issues](/redis/redis/issues)
* [Pull requests](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

# redis/redis

    unstable[Branches](/redis/redis/branches)[Tags](/redis/redis/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[12,315 Commits](/redis/redis/commits/unstable/) | | |
| [.codespell](/redis/redis/tree/unstable/.codespell ".codespell") | | [.codespell](/redis/redis/tree/unstable/.codespell ".codespell") |  |  |
| [.github](/redis/redis/tree/unstable/.github ".github") | | [.github](/redis/redis/tree/unstable/.github ".github") |  |  |
| [deps](/redis/redis/tree/unstable/deps "deps") | | [deps](/redis/redis/tree/unstable/deps "deps") |  |  |
| [modules](/redis/redis/tree/unstable/modules "modules") | | [modules](/redis/redis/tree/unstable/modules "modules") |  |  |
| [src](/redis/redis/tree/unstable/src "src") | | [src](/redis/redis/tree/unstable/src "src") |  |  |
| [tests](/redis/redis/tree/unstable/tests "tests") | | [tests](/redis/redis/tree/unstable/tests "tests") |  |  |
| [utils](/redis/redis/tree/unstable/utils "utils") | | [utils](/redis/redis/tree/unstable/utils "utils") |  |  |
| [.gitattributes](/redis/redis/blob/unstable/.gitattributes ".gitattributes") | | [.gitattributes](/redis/redis/blob/unstable/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/redis/redis/blob/unstable/.gitignore ".gitignore") | | [.gitignore](/redis/redis/blob/unstable/.gitignore ".gitignore") |  |  |
| [00-RELEASENOTES](/redis/redis/blob/unstable/00-RELEASENOTES "00-RELEASENOTES") | | [00-RELEASENOTES](/redis/redis/blob/unstable/00-RELEASENOTES "00-RELEASENOTES") |  |  |
| [BUGS](/redis/redis/blob/unstable/BUGS "BUGS") | | [BUGS](/redis/redis/blob/unstable/BUGS "BUGS") |  |  |
| [CODE\_OF\_CONDUCT.md](/redis/redis/blob/unstable/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/redis/redis/blob/unstable/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [CONTRIBUTING.md](/redis/redis/blob/unstable/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/redis/redis/blob/unstable/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [INSTALL](/redis/redis/blob/unstable/INSTALL "INSTALL") | | [INSTALL](/redis/redis/blob/unstable/INSTALL "INSTALL") |  |  |
| [LICENSE.txt](/redis/redis/blob/unstable/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/redis/redis/blob/unstable/LICENSE.txt "LICENSE.txt") |  |  |
| [MANIFESTO](/redis/redis/blob/unstable/MANIFESTO "MANIFESTO") | | [MANIFESTO](/redis/redis/blob/unstable/MANIFESTO "MANIFESTO") |  |  |
| [Makefile](/redis/redis/blob/unstable/Makefile "Makefile") | | [Makefile](/redis/redis/blob/unstable/Makefile "Makefile") |  |  |
| [README.md](/redis/redis/blob/unstable/README.md "README.md") | | [README.md](/redis/redis/blob/unstable/README.md "README.md") |  |  |
| [REDISCONTRIBUTIONS.txt](/redis/redis/blob/unstable/REDISCONTRIBUTIONS.txt "REDISCONTRIBUTIONS.txt") | | [REDISCONTRIBUTIONS.txt](/redis/redis/blob/unstable/REDISCONTRIBUTIONS.txt "REDISCONTRIBUTIONS.txt") |  |  |
| [SECURITY.md](/redis/redis/blob/unstable/SECURITY.md "SECURITY.md") | | [SECURITY.md](/redis/redis/blob/unstable/SECURITY.md "SECURITY.md") |  |  |
| [TLS.md](/redis/redis/blob/unstable/TLS.md "TLS.md") | | [TLS.md](/redis/redis/blob/unstable/TLS.md "TLS.md") |  |  |
| [redis.conf](/redis/redis/blob/unstable/redis.conf "redis.conf") | | [redis.conf](/redis/redis/blob/unstable/redis.conf "redis.conf") |  |  |
| [runtest](/redis/redis/blob/unstable/runtest "runtest") | | [runtest](/redis/redis/blob/unstable/runtest "runtest") |  |  |
| [runtest-cluster](/redis/redis/blob/unstable/runtest-cluster "runtest-cluster") | | [runtest-cluster](/redis/redis/blob/unstable/runtest-cluster "runtest-cluster") |  |  |
| [runtest-moduleapi](/redis/redis/blob/unstable/runtest-moduleapi "runtest-moduleapi") | | [runtest-moduleapi](/redis/redis/blob/unstable/runtest-moduleapi "runtest-moduleapi") |  |  |
| [runtest-sentinel](/redis/redis/blob/unstable/runtest-sentinel "runtest-sentinel") | | [runtest-sentinel](/redis/redis/blob/unstable/runtest-sentinel "runtest-sentinel") |  |  |
| [sentinel.conf](/redis/redis/blob/unstable/sentinel.conf "sentinel.conf") | | [sentinel.conf](/redis/redis/blob/unstable/sentinel.conf "sentinel.conf") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* License
* Security

This README is just a fast *quick start* document. You can find more detailed documentation at [redis.io](https://redis.io).

## What is Redis?

Redis is often referred to as a *data structures* server. What this means is that Redis provides access to mutable data structures via a set of commands, which are sent using a *server-client* model with TCP sockets and a simple protocol. So different processes can query and modify the same data structures in a shared way.

Data structures implemented into Redis have a few special properties:

* Redis cares to store them on disk, even if they are always served and modified into the server memory. This means that Redis is fast, but that it is also non-volatile.
* The implementation of data structures emphasizes memory efficiency, so data structures inside Redis will likely use less memory compared to the same data structure modelled using a high-level programming language.
* Redis offers a number of features that are natural to find in a database, like replication, tunable levels of durability, clustering, and high availability.

Another good example is to think of Redis as a more complex version of memcached, where the operations are not just SETs and GETs, but operations that work with complex data types like Lists, Sets, ordered data structures, and so forth.

If you want to know more, this is a list of selected starting points:

* Introduction to Redis data types. <https://redis.io/docs/latest/develop/data-types/>
* The full list of Redis commands. <https://redis.io/commands>
* There is much more inside the official Redis documentation. <https://redis.io/documentation>

## What is Redis Community Edition?

Redis OSS was renamed Redis Community Edition (CE) with the v7.4 release.

Redis Ltd. also offers [Redis Software](https://redis.io/enterprise/), a self-managed software with additional compliance, reliability, and resiliency for enterprise scaling,
and [Redis Cloud](https://redis.io/cloud/), a fully managed service integrated with Google Cloud, Azure, and AWS for production-ready apps.

Read more about the differences between Redis Community Edition and Redis [here](https://redis.io/comparisons/oss-vs-enterprise/).

## Building Redis

Redis can be compiled and used on Linux, OSX, OpenBSD, NetBSD, FreeBSD.
We support big endian and little endian architectures, and both 32 bit
and 64 bit systems.

It may compile on Solaris derived systems (for instance SmartOS) but our
support for this platform is *best effort* and Redis is not guaranteed to
work as well as in Linux, OSX, and \*BSD.

It is as simple as:

```
% make

```

To build with TLS support, you'll need OpenSSL development libraries (e.g.
libssl-dev on Debian/Ubuntu) and run:

```
% make BUILD_TLS=yes

```

To build with systemd support, you'll need systemd development libraries (such
as libsystemd-dev on Debian/Ubuntu or systemd-devel on CentOS) and run:

```
% make USE_SYSTEMD=yes

```

To append a suffix to Redis program names, use:

```
% make PROG_SUFFIX="-alt"

```

You can build a 32 bit Redis binary using:

```
% make 32bit

```

After building Redis, it is a good idea to test it using:

```
% make test

```

If TLS is built, running the tests with TLS enabled (you will need `tcl-tls`
installed):

```
% ./utils/gen-test-certs.sh
% ./runtest --tls

```

## Fixing build problems with dependencies or cached build options

Redis has some dependencies which are included in the `deps` directory.
`make` does not automatically rebuild dependencies even if something in
the source code of dependencies changes.

When you update the source code with `git pull` or when code inside the
dependencies tree is modified in any other way, make sure to use the following
command in order to really clean everything and rebuild from scratch:

```
% make distclean

```

This will clean: jemalloc, lua, hiredis, linenoise and other dependencies.

Also if you force certain build options like 32bit target, no C compiler
optimizations (for debugging purposes), and other similar build time options,
those options are cached indefinitely until you issue a `make distclean`
command.

## Fixing problems building 32 bit binaries

If after building Redis with a 32 bit target you need to rebuild it
with a 64 bit target, or the other way around, you need to perform a
`make distclean` in the root directory of the Redis distribution.

In case of build errors when trying to build a 32 bit binary of Redis, try
the following steps:

* Install the package libc6-dev-i386 (also try g++-multilib).
* Try using the following command line instead of `make 32bit`:
  `make CFLAGS="-m32 -march=native" LDFLAGS="-m32"`

## Allocator

Selecting a non-default memory allocator when building Redis is done by setting
the `MALLOC` environment variable. Redis is compiled and linked against libc
malloc by default, with the exception of jemalloc being the default on Linux
systems. This default was picked because jemalloc has proven to have fewer
fragmentation problems than libc malloc.

To force compiling against libc malloc, use:

```
% make MALLOC=libc

```

To compile against jemalloc on Mac OS X systems, use:

```
% make MALLOC=jemalloc

```

## Monotonic clock

By default, Redis will build using the POSIX clock\_gettime function as the
monotonic clock source. On most modern systems, the internal processor clock
can be used to improve performance. Cautions can be found here:
<http://oliveryang.net/2015/09/pitfalls-of-TSC-usage/>

To build with support for the processor's internal instruction clock, use:

```
% make CFLAGS="-DUSE_PROCESSOR_CLOCK"

```

## Verbose build

Redis will build with a user-friendly colorized output by default.
If you want to see a more verbose output, use the following:

```
% make V=1

```

## Running Redis

To run Redis with the default configuration, just type:

```
% cd src
% ./redis-server

```

If you want to provide your redis.conf, you have to run it using an additional
parameter (the path of the configuration file):

```
% cd src
% ./redis-server /path/to/redis.conf

```

It is possible to alter the Redis configuration by passing parameters directly
as options using the command line. Examples:

```
% ./redis-server --port 9999 --replicaof 127.0.0.1 6379
% ./redis-server /etc/redis/6379.conf --loglevel debug

```

All the options in redis.conf are also supported as options using the command
line, with exactly the same name.

## Running Redis with TLS

Please consult the [TLS.md](/redis/redis/blob/unstable/TLS.md) file for more information on
how to use Redis with TLS.

## Playing with Redis

You can use redis-cli to play with Redis. Start a redis-server instance,
then in another terminal try the following:

```
% cd src
% ./redis-cli
redis> ping
PONG
redis> set foo bar
OK
redis> get foo
"bar"
redis> incr mycounter
(integer) 1
redis> incr mycounter
(integer) 2
redis>

```

You can find the list of all the available commands at <https://redis.io/commands>.

## Installing Redis

In order to install Redis binaries into /usr/local/bin, just use:

```
% make install

```

You can use `make PREFIX=/some/other/directory install` if you wish to use a
different destination.

`make install` will just install binaries in your system, but will not configure
init scripts and configuration files in the appropriate place. This is not
needed if you just want to play a bit with Redis, but if you are installing
it the proper way for a production system, we have a script that does this
for Ubuntu and Debian systems:

```
% cd utils
% ./install_server.sh

```

*Note*: `install_server.sh` will not work on Mac OSX; it is built for Linux only.

The script will ask you a few questions and will setup everything you need
to run Redis properly as a background daemon that will start again on
system reboots.

You'll be able to stop and start Redis using the script named
`/etc/init.d/redis_<portnumber>`, for instance `/etc/init.d/redis_6379`.

## Code contributions

By contributing code to the Redis project in any form, including sending a pull request via GitHub,
a code fragment or patch via private email or public discussion groups, you agree to release your
code under the terms of the [Redis Software Grant and Contributor License Agreement](https://github.com/redis/redis/blob/unstable/CONTRIBUTING.md). Redis software
contains contributions to the original Redis core project, which are owned by their contributors and
licensed under the 3BSD license. Any copy of that license in this repository applies only to those
contributions. Redis releases all Redis Community Edition versions from 7.4.x and thereafter under the
RSALv2/SSPL dual-license as described in the [LICENSE.txt](https://github.com/redis/redis/blob/unstable/LICENSE.txt) file included in the Redis Community Edition source distribution.

Please see the [CONTRIBUTING.md](https://github.com/redis/redis/blob/unstable/CONTRIBUTING.md) file in this source distribution for more information. For
security bugs and vulnerabilities, please see [SECURITY.md](https://github.com/redis/redis/blob/unstable/SECURITY.md).

## Redis Trademarks

The purpose of a trademark is to identify the goods and services of a person or company without
causing confusion. As the registered owner of its name and logo, Redis accepts certain limited uses
of its trademarks but it has requirements that must be followed as described in its Trademark
Guidelines available at: <https://redis.com/legal/trademark-guidelines/>.

# Redis internals

If you are reading this README you are likely in front of a GitHub page
or you just untarred the Redis distribution tar ball. In both the cases
you are basically one step away from the source code, so here we explain
the Redis source code layout, what is in each file as a general idea, the
most important functions and structures inside the Redis server and so forth.
We keep all the discussion at a high level without digging into the details
since this document would be huge otherwise and our code base changes
continuously, but a general idea should be a good starting point to
understand more. Moreover most of the code is heavily commented and easy
to follow.

## Source code layout

The Redis root directory just contains this README, the Makefile which
calls the real Makefile inside the `src` directory and an example
configuration for Redis and Redis Sentinel. You can find a few shell
scripts that are used in order to execute the Redis, Redis Cluster and
Redis Sentinel unit tests, which are implemented inside the `tests`
directory.

Inside the root are the following important directories:

* `src`: contains the Redis implementation, written in C.
* `tests`: contains the unit tests, implemented in Tcl.
* `deps`: contains libraries Redis uses. Everything needed to compile Redis is inside this directory; your system just needs to provide `libc`, a POSIX compatible interface and a C compiler. Notably `deps` contains a copy of `jemalloc`, which is the default allocator of Redis under Linux. Note that under `deps` there are also things which started with the Redis project, but for which the main repository is not `redis/redis`.

There are a few more directories but they are not very important for our goals
here. We'll focus mostly on `src`, where the Redis implementation is contained,
exploring what there is inside each file. The order in which files are
exposed is the logical one to follow in order to disclose different layers
of complexity incrementally.

Note: lately Redis was refactored quite a bit. Function names and file
names have been changed, so you may find that this documentation reflects the
`unstable` branch more closely. For instance, in Redis 3.0 the `server.c`
and `server.h` files were named `redis.c` and `redis.h`. However the overall
structure is the same. Keep in mind that all the new developments and pull
requests should be performed against the `unstable` branch.

## server.h

The simplest way to understand how a program works is to understand the
data structures it uses. So we'll start from the main header file of
Redis, which is `server.h`.

All the server configuration and in general all the shared state is
defined in a global structure called `server`, of type `struct redisServer`.
A few important fields in this structure are:

* `server.db` is an array of Redis databases, where data is stored.
* `server.commands` is the command table.
* `server.clients` is a linked list of clients connected to the server.
* `server.master` is a special client, the master, if the instance is a replica.

There are tons of other fields. Most fields are commented directly inside
the structure definition.

Another important Redis data structure is the one defining a client.
In the past it was called `redisClient`, now just `client`. The structure
has many fields, here we'll just show the main ones:

```
struct client {
    int fd;
    sds querybuf;
    int argc;
    robj **argv;
    redisDb *db;
    int flags;
    list *reply;
    // ... many other fields ...
    char buf[PROTO_REPLY_CHUNK_BYTES];
}
```

The client structure defines a *connected client*:

* The `fd` field is the client socket file descriptor.
* `argc` and `argv` are populated with the command the client is executing, so that functions implementing a given Redis command can read the arguments.
* `querybuf` accumulates the requests from the client, which are parsed by the Redis server according to the Redis protocol and executed by calling the implementations of the commands the client is executing.
* `reply` and `buf` are dynamic and static buffers that accumulate the replies the server sends to the client. These buffers are incrementally written to the socket as soon as the file descriptor is writable.

As you can see in the client structure above, arguments in a command
are described as `robj` structures. The following is the full `robj`
structure, which defines a *Redis object*:

```
struct redisObject {
    unsigned type:4;
    unsigned encoding:4;
    unsigned lru:LRU_BITS; /* LRU time (relative to global lru_clock) or
                            * LFU data (least significant 8 bits frequency
                            * and most significant 16 bits access time). */
    int refcount;
    void *ptr;
};
```

Basically this structure can represent all the basic Redis data types like
strings, lists, sets, sorted sets and so forth. The interesting thing is that
it has a `type` field, so that it is possible to know what type a given
object has, and a `refcount`, so that the same object can be referenced
in multiple places without allocating it multiple times. Finally the `ptr`
field points to the actual representation of the object, which might vary
even for the same type, depending on the `encoding` used.

Redis objects are used extensively in the Redis internals, however in order
to avoid the overhead of indirect accesses, recently in many places
we just use plain dynamic strings not wrapped inside a Redis object.

## server.c

This is the entry point of the Redis server, where the `main()` function
is defined. The following are the most important steps in order to startup
the Redis server.

* `initServerConfig()` sets up the default values of the `server` structure.
* `initServer()` allocates the data structures needed to operate, setup the listening socket, and so forth.
* `aeMain()` starts the event loop which listens for new connections.

There are two special functions called periodically by the event loop:

1. `serverCron()` is called periodically (according to `server.hz` frequency), and performs tasks that must be performed from time to time, like checking for timed out clients.
2. `beforeSleep()` is called every time the event loop fired, Redis served a few requests, and is returning back into the event loop.

Inside server.c you can find code that handles other vital things of the Redis server:

* `call()` is used in order to call a given command in the context of a given client.
* `activeExpireCycle()` handles eviction of keys with a time to live set via the `EXPIRE` command.
* `performEvictions()` is called when a new write command should be performed but Redis is out of memory according to the `maxmemory` directive.
* The global variable `redisCommandTable` defines all the Redis commands, specifying the name of the command, the function implementing the command, the number of arguments required, and other properties of each command.

## commands.c

This file is auto generated by utils/generate-command-code.py, the content is based on the JSON files in the src/commands folder.
These are meant to be the single source of truth about the Redis commands, and all the metadata about them.
These JSON files are not meant to be used by anyone directly, instead that metadata can be obtained via the `COMMAND` command.

## networking.c

This file defines all the I/O functions with clients, masters and replicas
(which in Redis are just special clients):

* `createClient()` allocates and initializes a new client.
* The `addReply*()` family of functions are used by command implementations in order to append data to the client structure, that will be transmitted to the client as a reply for a given command executed.
* `writeToClient()` transmits the data pending in the output buffers to the client and is called by the *writable event handler* `sendReplyToClient()`.
* `readQueryFromClient()` is the *readable event handler* and accumulates data read from the client into the query buffer.
* `processInputBuffer()` is the entry point in order to parse the client query buffer according to the Redis protocol. Once commands are ready to be processed, it calls `processCommand()` which is defined inside `server.c` in order to actually execute the command.
* `freeClient()` deallocates, disconnects and removes a client.

## aof.c and rdb.c

As you can guess from the names, these files implement the RDB and AOF
persistence for Redis. Redis uses a persistence model based on the `fork()`
system call in order to create a process with the same (shared) memory
content of the main Redis process. This secondary process dumps the content
of the memory on disk. This is used by `rdb.c` to create the snapshots
on disk and by `aof.c` in order to perform the AOF rewrite when the
append only file gets too big.

The implementation inside `aof.c` has additional functions in order to
implement an API that allows commands to append new commands into the AOF
file as clients execute them.

The `call()` function defined inside `server.c` is responsible for calling
the functions that in turn will write the commands into the AOF.

## db.c

Certain Redis commands operate on specific data types; others are general.
Examples of generic commands are `DEL` and `EXPIRE`. They operate on keys
and not on their values specifically. All those generic commands are
defined inside `db.c`.

Moreover `db.c` implements an API in order to perform certain operations
on the Redis dataset without directly accessing the internal data structures.

The most important functions inside `db.c` which are used in many command
implementations are the following:

* `lookupKeyRead()` and `lookupKeyWrite()` are used in order to get a pointer to the value associated to a given key, or `NULL` if the key does not exist.
* `dbAdd()` and its higher level counterpart `setKey()` create a new key in a Redis database.
* `dbDelete()` removes a key and its associated value.
* `emptyData()` removes an entire single database or all the databases defined.

The rest of the file implements the generic commands exposed to the client.

## object.c

The `robj` structure defining Redis objects was already described. Inside
`object.c` there are all the functions that operate with Redis objects at
a basic level, like functions to allocate new objects, handle the reference
counting and so forth. Notable functions inside this file:

* `incrRefCount()` and `decrRefCount()` are used in order to increment or decrement an object reference count. When it drops to 0 the object is finally freed.
* `createObject()` allocates a new object. There are also specialized functions to allocate string objects having a specific content, like `createStringObjectFromLongLong()` and similar functions.

This file also implements the `OBJECT` command.

## replication.c

This is one of the most complex files inside Redis, it is recommended to
approach it only after getting a bit familiar with the rest of the code base.
In this file there is the implementation of both the master and replica role
of Redis.

One of the most important functions inside this file is `replicationFeedSlaves()` that writes commands to the clients representing replica instances connected
to our master, so that the replicas can get the writes performed by the clients:
this way their data set will remain synchronized with the one in the master.

This file also implements both the `SYNC` and `PSYNC` commands that are
used in order to perform the first synchronization between masters and
replicas, or to continue the replication after a disconnection.

## Script

The script unit is composed of 3 units:

* `script.c` - integration of scripts with Redis (commands execution, set replication/resp, ...)
* `script_lua.c` - responsible to execute Lua code, uses `script.c` to interact with Redis from within the Lua code.
* `function_lua.c` - contains the Lua engine implementation, uses `script_lua.c` to execute the Lua code.
* `functions.c` - contains Redis Functions implementation (`FUNCTION` command), uses `functions_lua.c` if the function it wants to invoke needs the Lua engine.
* `eval.c` - contains the `eval` implementation using `script_lua.c` to invoke the Lua code.

## Other C files

* `t_hash.c`, `t_list.c`, `t_set.c`, `t_string.c`, `t_zset.c` and `t_stream.c` contains the implementation of the Redis data types. They implement both an API to access a given data type, and the client command implementations for these data types.
* `ae.c` implements the Redis event loop, it's a self contained library which is simple to read and understand.
* `sds.c` is the Redis string library, check <https://github.com/antirez/sds> for more information.
* `anet.c` is a library to use POSIX networking in a simpler way compared to the raw interface exposed by the kernel.
* `dict.c` is an implementation of a non-blocking hash table which rehashes incrementally.
* `cluster.c` implements the Redis Cluster. Probably a good read only after being very familiar with the rest of the Redis code base. If you want to read `cluster.c` make sure to read the [Redis Cluster specification](https://redis.io/docs/latest/operate/oss_and_stack/reference/cluster-spec/).

## Anatomy of a Redis command

All the Redis commands are defined in the following way:

```
void foobarCommand(client *c) {
    printf("%s",c->argv[1]->ptr); /* Do something with the argument. */
    addReply(c,shared.ok); /* Reply something to the client. */
}
```

The command function is referenced by a JSON file, together with its metadata, see `commands.c` described above for details.
The command flags are documented in the comment above the `struct redisCommand` in `server.h`.
For other details, please refer to the `COMMAND` command. <https://redis.io/commands/command/>

After the command operates in some way, it returns a reply to the client,
usually using `addReply()` or a similar function defined inside `networking.c`.

There are tons of command implementations inside the Redis source code
that can serve as examples of actual commands implementations (e.g. pingCommand). Writing
a few toy commands can be a good exercise to get familiar with the code base.

There are also many other files not described here, but it is useless to
cover everything. We just want to help you with the first steps.
Eventually you'll find your way inside the Redis code base :-)

Enjoy!

## About

Redis is an in-memory database that persists on disk. The data model is key-value, but many different kind of values are supported: Strings, Lists, Sets, Sorted Sets, Hashes, Streams, HyperLogLogs, Bitmaps.

[redis.io](http://redis.io "http://redis.io")

### Topics

[redis](/topics/redis "Topic: redis")
[database](/topics/database "Topic: database")
[nosql](/topics/nosql "Topic: nosql")
[key-value](/topics/key-value "Topic: key-value")
[cache](/topics/cache "Topic: cache")
[message-broker](/topics/message-broker "Topic: message-broker")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/redis/redis/activity)
[Custom properties](/redis/redis/custom-properties)
### Stars

[**67.7k**
stars](/redis/redis/stargazers)
### Watchers

[**2.5k**
watching](/redis/redis/watchers)
### Forks

[**23.9k**
forks](/redis/redis/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fredis%2Fredis&report=redis+%28user%29)

## [Releases 77](/redis/redis/releases)

[7.4.2
Latest

Jan 6, 2025](/redis/redis/releases/tag/7.4.2)
[+ 76 releases](/redis/redis/releases)

## [Packages 0](/orgs/redis/packages?repo_name=redis)

No packages published

## [Contributors 732](/redis/redis/graphs/contributors)

* [![@antirez](https://avatars.githubusercontent.com/u/65632?s=64&v=4)](https://github.com/antirez)
* [![@oranagra](https://avatars.githubusercontent.com/u/7045099?s=64&v=4)](https://github.com/oranagra)
* [![@pietern](https://avatars.githubusercontent.com/u/9845?s=64&v=4)](https://github.com/pietern)
* [![@enjoy-binbin](https://avatars.githubusercontent.com/u/22811481?s=64&v=4)](https://github.com/enjoy-binbin)
* [![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=64&v=4)](https://github.com/yossigo)
* [![@soloestoy](https://avatars.githubusercontent.com/u/24804835?s=64&v=4)](https://github.com/soloestoy)
* [![@sundb](https://avatars.githubusercontent.com/u/965798?s=64&v=4)](https://github.com/sundb)
* [![@madolson](https://avatars.githubusercontent.com/u/34459052?s=64&v=4)](https://github.com/madolson)
* [![@guybe7](https://avatars.githubusercontent.com/u/19590683?s=64&v=4)](https://github.com/guybe7)
* [![@hwware](https://avatars.githubusercontent.com/u/51993843?s=64&v=4)](https://github.com/hwware)
* [![@mattsta](https://avatars.githubusercontent.com/u/15594?s=64&v=4)](https://github.com/mattsta)
* [![@artix75](https://avatars.githubusercontent.com/u/408145?s=64&v=4)](https://github.com/artix75)
* [![@itamarhaber](https://avatars.githubusercontent.com/u/6059516?s=64&v=4)](https://github.com/itamarhaber)
* [![@MeirShpilraien](https://avatars.githubusercontent.com/u/28348822?s=64&v=4)](https://github.com/MeirShpilraien)

[+ 718 contributors](/redis/redis/graphs/contributors)

## Languages

* [C
  73.7%](/redis/redis/search?l=c)
* [Tcl
  25.0%](/redis/redis/search?l=tcl)
* [Python
  0.4%](/redis/redis/search?l=python)
* [Makefile
  0.3%](/redis/redis/search?l=makefile)
* [Shell
  0.3%](/redis/redis/search?l=shell)
* [Ruby
  0.2%](/redis/redis/search?l=ruby)
* Other
  0.1%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c5c53583_20250115_135835.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fcommit%2F9824fe3e392caa04dc1b4071886e9ac402dd6d95)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fcommit%2F9824fe3e392caa04dc1b4071886e9ac402dd6d95)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=redis%2Fredis)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[redis](/redis)
/
**[redis](/redis/redis)**
Public

* [Notifications](/login?return_to=%2Fredis%2Fredis) You must be signed in to change notification settings
* [Fork
  23.9k](/login?return_to=%2Fredis%2Fredis)
* [Star
   67.7k](/login?return_to=%2Fredis%2Fredis)

* [Code](/redis/redis)
* [Issues
  2.1k](/redis/redis/issues)
* [Pull requests
  465](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects
  10](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

Additional navigation options

* [Code](/redis/redis)
* [Issues](/redis/redis/issues)
* [Pull requests](/redis/redis/pulls)
* [Discussions](/redis/redis/discussions)
* [Actions](/redis/redis/actions)
* [Projects](/redis/redis/projects)
* [Security](/redis/redis/security)
* [Insights](/redis/redis/pulse)

## Commit

[Permalink](/redis/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix wrong zmalloc\_size() assumption. ([#7963](https://github.com/redis/redis/pull/7963))

[Browse files](/redis/redis/tree/9824fe3e392caa04dc1b4071886e9ac402dd6d95)
Browse the repository at this point in the history

```
When using a system with no malloc_usable_size(), zmalloc_size() assumed
that the heap allocator always returns blocks that are long-padded.

This may not always be the case, and will result with zmalloc_size()
returning a size that is bigger than allocated. At least in one case
this leads to out of bound write, process crash and a potential security
vulnerability.

Effectively this does not affect the vast majority of users, who use
jemalloc or glibc.

This problem along with a (different) fix was reported by Drew DeVault.
```

* Loading branch information

[![@yossigo](https://avatars.githubusercontent.com/u/1481195?s=40&v=4)](/yossigo)

[yossigo](/redis/redis/commits?author=yossigo "View all commits by yossigo")
authored
Oct 26, 2020

1 parent
[4e2e5be](/redis/redis/commit/4e2e5be201439cae4c0a03cfc8b6a60be4bff625)

commit 9824fe3

Showing
**1 changed file**
with
**0 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 0 additions & 3 deletions

3
[src/zmalloc.c](#diff-b601b5ff4c0d077e82c78d4059ce3d10de7a54a8965ec9e7b6515b799f930ac8 "src/zmalloc.c")

Show comments

[View file](/redis/redis/blob/9824fe3e392caa04dc1b4071886e9ac402dd6d95/src/zmalloc.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -236,9 +236,6 @@ void \*zrealloc\_usable(void \*ptr, size\_t size, size\_t \*usable) { |
|  |  | size\_t zmalloc\_size(void \*ptr) { |
|  |  | void \*realptr = (char\*)ptr-PREFIX\_SIZE; |
|  |  | size\_t size = \*((size\_t\*)realptr); |
|  |  | /\* Assume at least that all the allocations are padded at sizeof(long) by |
|  |  | \* the underlying allocator. \*/ |
|  |  | if (size&(sizeof(long)-1)) size += sizeof(long)-(size&(sizeof(long)-1)); |
|  |  | return size+PREFIX\_SIZE; |
|  |  | } |
|  |  | size\_t zmalloc\_usable\_size(void \*ptr) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9824fe3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fredis%2Fredis%2Fcommit%2F9824fe3e392caa04dc1b4071886e9ac402dd6d95) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from raw.githubusercontent.com_4900c194_20250115_135831.html ===
Redis 5.0 release notes
=======================
--------------------------------------------------------------------------------
Upgrade urgency levels:
LOW: No need to upgrade unless there are new features you want to use.
MODERATE: Program an upgrade of the server, but it's not urgent.
HIGH: There is a critical bug that may affect a subset of users. Upgrade!
CRITICAL: There is a critical bug affecting MOST USERS. Upgrade ASAP.
SECURITY: There are security fixes in the release.
--------------------------------------------------------------------------------
================================================================================
Redis 5.0.10 Released Mon Oct 26 09:21:49 IST 2020
================================================================================
Upgrade urgency: SECURITY if you use an affected platform (see below).
Otherwise the upgrade urgency is MODERATE.
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963
Other fixes in this release:
\* Avoid case of Lua scripts being consistently aborted due to OOM
\* XPENDING will not update consumer's seen-time
\* A blocked XREADGROUP didn't propagated the XSETID to replicas / AOF
\* UNLINK support for streams
\* RESTORE ABSTTL won't store expired keys into the DB
\* Hide AUTH from MONITOR
\* Cluster: reduce spurious PFAIL/FAIL states upon delayed PONG receival
\* Cluster: Fix case of clusters mixing accidentally by gossip
\* Cluster: Allow blocked XREAD on a cluster replica
\* Cluster: Optimize memory usage CLUSTER SLOTS command
\* RedisModule\_ValueLength support for stream data type
\* Minor fixes in redis-check-rdb and redis-cli
\* Fix redis-check-rdb support for modules aux data
\* Add fsync in replica when full RDB payload was received
Full list of commits:
Yossi Gottlieb in commit ce0d74d8f:
Fix wrong zmalloc\_size() assumption. (#7963)
1 file changed, 3 deletions(-)
Yossi Gottlieb in commit 066699240:
Backport Lua 5.2.2 stack overflow fix. (#7733)
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 8a90c7ef3:
Add fsync to readSyncBulkPayload(). (#7839)
1 file changed, 11 insertions(+)
Ariel Shtul in commit f0df2bb3c:
Fix redis-check-rdb support for modules aux data (#7826)
3 files changed, 21 insertions(+), 1 deletion(-)
hwware in commit 7add2a412:
fix memory leak in sentinel connection sharing
1 file changed, 1 insertion(+)
Oran Agra in commit 315e648f8:
Allow blocked XREAD on a cluster replica (#7881)
3 files changed, 100 insertions(+), 2 deletions(-)
guybe7 in commit 4967ee94e:
Modules: Invalidate saved\_oparray after use (#7688)
1 file changed, 2 insertions(+)
antirez in commit 065003e8f:
Modules: remove spurious call from moduleHandleBlockedClients().
1 file changed, 1 deletion(-)
Angus Pearson in commit 6cdf62928:
Fix broken interval and repeat bahaviour in redis-cli (incluing cluster mode)
1 file changed, 11 insertions(+), 6 deletions(-)
antirez in commit cb6a4971c:
Cluster: introduce data\_received field.
2 files changed, 27 insertions(+), 10 deletions(-)
Madelyn Olson in commit 83f4de865:
Hide AUTH from monitor
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Benoish in commit 3ba08d185:
Support streams in general module API functions
3 files changed, 11 insertions(+), 1 deletion(-)
Itamar Haber in commit 109c0635c:
Expands lazyfree's effort estimate to include Streams (#5794)
1 file changed, 24 insertions(+)
huangzhw in commit 235210d5b:
defrag.c activeDefragSdsListAndDict when defrag sdsele, We can't use (#7492)
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit fdd3162fe:
RESTORE ABSTTL skip expired keys - leak (#7511)
1 file changed, 1 insertion(+)
Oran Agra in commit 6139d6d18:
RESTORE ABSTTL won't store expired keys into the db (#7472)
4 files changed, 45 insertions(+), 15 deletions(-)
Liu Zhen in commit 0f502c58d:
fix clusters mixing accidentally by gossip
1 file changed, 10 insertions(+), 2 deletions(-)
Guy Benoish in commit 37fd50718:
XPENDING should not update consumer's seen-time
4 files changed, 30 insertions(+), 18 deletions(-)
antirez in commit a3ca53e4a:
Also use propagate() in streamPropagateGroupID().
1 file changed, 11 insertions(+), 1 deletion(-)
yanhui13 in commit 7a62eb96e:
optimize the output of cluster slots
1 file changed, 7 insertions(+), 4 deletions(-)
srzhao in commit 0efb93d0c:
Check OOM at script start to get stable lua OOM state.
3 files changed, 11 insertions(+), 4 deletions(-)
================================================================================
Redis 5.0.9 Released Thu Apr 17 12:41:00 CET 2020
================================================================================
Upgrade urgency:CRITICAL if you use Streams with AOF ore replicas.
Otherwise the upgrade urgency is LOW.
This release has a speed improvement and a critical fix:
\* FIX: XREADGROUP when fetching data in a blocking way, would not
emit the XCLAIM in the AOF file and to replicas. This means
that the last ID is not updated, and that restarting the server
will have the effect of reprocessing some entries.
\* NEW: Clients blocked on the same key are now unblocked on
O(1) time. Backported from Redis 6.
Commits:
1fc8ef81a Fix XCLAIM propagation in AOF/replicas for blocking XREADGROUP.
a5e24eabc Speedup: unblock clients on keys in O(1).
================================================================================
Redis 5.0.8 Released Thu Mar 12 16:05:41 CET 2020
================================================================================
Upgrade urgency HIGH: This release fixes security issues.
This is a list of fixes in this release:
Salvatore Sanfilippo in commit 2bea502d:
Merge pull request #6975 from dustinmm80/add-arm-latomic-linking
Dustin Collins in commit b5931405:
Fix Pi building needing -latomic, backport
1 file changed, 9 insertions(+)
srzhao in commit fd441300:
fix impl of aof-child whitelist SIGUSR1 feature.
1 file changed, 5 insertions(+), 4 deletions(-)
Ariel in commit 77ff332b:
fix ThreadSafeContext lock/unlock function names
1 file changed, 2 insertions(+), 2 deletions(-)
Guy Benoish in commit 4f0f799c:
XREADGROUP should propagate XCALIM/SETID in MULTI/EXEC
1 file changed, 2 insertions(+), 2 deletions(-)
Oran Agra in commit 0c1273c3:
Fix client flags to be int64 in module.c
1 file changed, 3 insertions(+), 3 deletions(-)
Guy Benoish in commit 708a4e8a:
Fix small bugs related to replica and monitor ambiguity
2 files changed, 8 insertions(+), 6 deletions(-)
WuYunlong in commit eac4115d:
Fix lua related memory leak.
1 file changed, 1 insertion(+)
antirez in commit d075df17:
Simplify #6379 changes.
2 files changed, 4 insertions(+), 9 deletions(-)
WuYunlong in commit 80a49c37:
Free allocated sds in pfdebugCommand() to avoid memory leak.
1 file changed, 1 insertion(+)
antirez in commit 60870d3a:
Jump to right label on AOF parsing error.
1 file changed, 6 insertions(+), 4 deletions(-)
antirez in commit d90f599b:
Free fakeclient argv on AOF error.
1 file changed, 11 insertions(+), 3 deletions(-)
WuYunlong in commit 8ee3bddf:
Fix potential memory leak of rioWriteBulkStreamID().
1 file changed, 4 insertions(+), 1 deletion(-)
WuYunlong in commit 4780fe78:
Fix potential memory leak of clusterLoadConfig().
1 file changed, 20 insertions(+), 5 deletions(-)
Leo Murillo in commit f3b77510:
Fix bug on KEYS command where pattern starts with \* followed by \x00 (null char).
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Benoish in commit 7f3fcedb:
Blocking XREAD[GROUP] should always reply with valid data (or timeout)
3 files changed, 44 insertions(+), 10 deletions(-)
antirez in commit f93b2fa5:
XCLAIM: Create the consumer only on successful claims.
1 file changed, 4 insertions(+), 2 deletions(-)
Guy Benoish in commit 89682d96:
Stream: Handle streamID-related edge cases
4 files changed, 54 insertions(+), 4 deletions(-)
antirez in commit 920e108f:
Fix ip and missing mode in RM\_GetClusterNodeInfo().
1 file changed, 5 insertions(+), 2 deletions(-)
antirez in commit 7569b210:
Inline protocol: handle empty strings well.
1 file changed, 2 insertions(+), 6 deletions(-)
Khem Raj in commit 3c610b4e:
Mark extern definition of SDS\_NOINIT in sds.h
1 file changed, 1 insertion(+), 1 deletion(-)
Seunghoon Woo in commit 16b2d07f:
[FIX] revisit CVE-2015-8080 vulnerability
1 file changed, 6 insertions(+), 4 deletions(-)
yz1509 in commit 19f33585:
avoid sentinel changes promoted\_slave to be its own replica.
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0.7 Released Tue Nov 19 17:52:44 CET 2019
================================================================================
Upgrade urgency HIGH: many issues fixed, some may have an impact.
Hi all, Redis 5.0.7 fixes a number of bugs, none is very critical, however
there are a few that may have an impact. It's a good idea to upgrade.
There are fixes in the area of replication from modules commands and
callbacks, AOF fsync (non critical issue), memory leaks (very rare and small),
streams beahvior (non critical), and a potential crash in commands
processing multiple keys at the same time that is there for years, and happens
very rarely, but is not impossible to trigger.
The following is the list of commits in this release.
antirez in commit 4d2a31ae:
Test: fix implementation-dependent test after code change.
1 file changed, 2 insertions(+), 2 deletions(-)
Oran Agra in commit 9f63fc98:
RED-31295 - redis: avoid race between dlopen and thread creation
2 files changed, 17 insertions(+)
antirez in commit 1a9e70c1:
Cluster: fix memory leak of cached master.
2 files changed, 9 insertions(+), 4 deletions(-)
Guy Benoish in commit 69b1b5be:
Fix usage of server.stream\_node\_max\_\*
1 file changed, 3 insertions(+), 3 deletions(-)
喜欢兰花山丘 in commit 1fd97ee7:
Update mkreleasehdr.sh
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1a9855d7:
Remove additional space from comment.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 32a6e3e4:
Fix stream test after addition of 0-0 ID test.
1 file changed, 3 insertions(+), 3 deletions(-)
Yuan Zhou in commit c9e6cda9:
aof: fix assignment for aof\_fsync\_offset
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit d3eeacf9:
Merge branch '5.0' of github.com:/antirez/redis into 5.0
antirez in commit da5dc458:
Rename var to fixed\_time\_expire now that is more general.
4 files changed, 7 insertions(+), 8 deletions(-)
antirez in commit 0fefed25:
Fix patch provided in #6554.
1 file changed, 8 insertions(+), 1 deletion(-)
zhaozhao.zz in commit e9fbc960:
expires & blocking: handle ready keys as call()
1 file changed, 5 insertions(+)
Guy Benoish in commit 08ec8f71:
XADD with ID 0-0 stores an empty key
2 files changed, 14 insertions(+)
Loris Cro in commit 09e1fe27:
fix unreported overflow in autogerenared stream IDs
2 files changed, 19 insertions(+), 10 deletions(-)
Salvatore Sanfilippo in commit 09f9e4b0:
Merge pull request #6600 from oranagra/5\_module\_flags
Oran Agra in commit 8d8d68dd:
module documentation mismatches: loading and fork child for 5.0 branch
3 files changed, 11 insertions(+)
antirez in commit 7a7fbe70:
Modules: RM\_GetContextFlags(): remove non Redis 5 features.
1 file changed, 3 deletions(-)
antirez in commit b5830486:
Modules: fix moduleCreateArgvFromUserFormat() casting bug.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit b7a2a53a:
module: fix propagation API bug.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 278bd6e3:
Modules: add new flags to context, replica state + more.
2 files changed, 48 insertions(+), 1 deletion(-)
antirez in commit 61d9a154:
Modules: RM\_Call(): give pointer to documentation.
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit 0e7ea0aa:
Modules: RM\_Call/Replicate() ability to exclude AOF/replicas.
1 file changed, 28 insertions(+), 9 deletions(-)
antirez in commit 3b38164e:
Modules: RM\_Replicate() in thread safe contexts.
1 file changed, 26 insertions(+), 4 deletions(-)
antirez in commit ef9fe9b0:
Modules: implement RM\_Replicate() from async callbacks.
2 files changed, 33 insertions(+), 2 deletions(-)
antirez in commit 8066d2a1:
Modules: handle propagation when ctx is freed. Flag modules commands ctx.
1 file changed, 23 insertions(+), 19 deletions(-)
antirez in commit d3f4dec4:
Update PR #6537: use a fresh time outside call().
3 files changed, 27 insertions(+), 7 deletions(-)
antirez in commit 33f42665:
Update PR #6537 patch to for generality.
4 files changed, 40 insertions(+), 23 deletions(-)
zhaozhao.zz in commit 68d71d83:
expires: refactoring judgment about whether a key is expired
3 files changed, 3 insertions(+), 1 deletion(-)
antirez in commit 62588dbf:
Modules: fix thread safe context creation crash.
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0.6 Released Wed Sep 25 12:33:56 CEST 2019
================================================================================
Upgrade urgency CRITICAL: Only in case of exposed instances to untrusted users.
This Redis release, 5.0.6, is a bugfix and enhancement release. The most
important bugfix is a corruption related to the HyperLogLog. A malformed
HyperLogLog string could cause an invalid access to the memory. At a first
glance the vulnerability appears to be not exploitable but just a DoS. The
way to trigger the issue is complex, we'll not provide any information about
how to do that for the users safety.
Other significant changes in this release:
\* New modules APIs merged from Redis unstable to Redis 5.
\* Some memory optimization related to objects creation.
\* Fixes to flushSlaveOutputBuffer() that make sure that SHUTDOWN will
transfer pending buffers to replicas.
This is the full list of commits:
antirez in commit 7a41047a:
RDB: fix MODULE\_AUX loading by continuing to next opcode.
1 file changed, 1 insertion(+)
Oran Agra in commit 4eb3028b:
missing per-skiplist overheads in MEMORY USAGE
1 file changed, 3 insertions(+), 1 deletion(-)
Oran Agra in commit 5d09f9bc:
RM\_Log - add support for logging without a context or context without module
1 file changed, 6 insertions(+), 4 deletions(-)
antirez in commit 2810de9f:
Cluster: abort loading nodes data if vars arguments are unbalanced.
1 file changed, 1 insertion(+)
antirez in commit f5c63ce0:
More strict checks and better comments in flushSlaveOutputBuffers().
1 file changed, 18 insertions(+), 7 deletions(-)
antirez in commit 7f289c3b:
Improve comment in flushSlavesOutputBuffers().
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 7ab62d4b:
Replication: clarify why repl\_put\_online\_on\_ack exists at all.
2 files changed, 34 insertions(+), 10 deletions(-)
zhaozhao.zz in commit 495dd0da:
networking: flushSlavesOutputBuffers bugfix
1 file changed, 2 insertions(+), 4 deletions(-)
Salvatore Sanfilippo in commit c1ccf0f1:
Merge pull request #6366 from oranagra/5.0\_rm\_reply\_cstring
Salvatore Sanfilippo in commit a50dad73:
Merge pull request #6365 from oranagra/5.0\_module\_aux
Oran Agra in commit d6294d05:
RM\_ReplyWithCString was missing registration
1 file changed, 1 insertion(+)
Oran Agra in commit 8c56fc86:
Fix to module aux data rdb format for backwards compatibility with old check-rdb
1 file changed, 9 insertions(+), 1 deletion(-)
Oran Agra in commit 98b1314f:
Implement module api for aux data in rdb
9 files changed, 431 insertions(+), 18 deletions(-)
antirez in commit 08b03e23:
redis-cli: always report server errors on read errors.
1 file changed, 8 insertions(+), 1 deletion(-)
wubostc in commit 239069de:
Reduce the calling stack
1 file changed, 2 insertions(+), 3 deletions(-)
antirez in commit 90bf6313:
Make EMBSTR case of #6261 more obvious.
1 file changed, 1 insertion(+), 1 deletion(-)
chendianqiang in commit 2f8a0749:
make memory usage consistent of robj with OBJ\_ENCODING\_INT
1 file changed, 9 insertions(+), 4 deletions(-)
antirez in commit 436ed56d:
HyperLogLog: fix the fix of a corruption bug.
1 file changed, 1 insertion(+), 2 deletions(-)
John Sully in commit 680f89fb:
Fix HLL corruption bug
1 file changed, 1 insertion(+)
swilly22 in commit 388efbf8:
Extend REDISMODULE\_CTX\_FLAGS to indicate if redis is currently loading from either RDB or AOF
2 files changed, 5 insertions(+)
Itamar Haber in commit 0ccbdcee:
Uses addReplyBulkCString
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit 707a59c6:
Adds RedisModule\_ReplyWithCString
2 files changed, 13 insertions(+)
================================================================================
Redis 5.0.5 Released Wed May 15 17:57:41 CEST 2019
================================================================================
Upgrade urgency CRITICAL: This release fixes an important AOF fysnc bug
and other less critical issues.
Dear user,
Redis 5.0.5 fixes an important issue with AOF and adds multiple very useful
modules APIs. Moreover smaller bugs in other parts of Redis are fixed in
this release.
The AOF bug
-----------
The AOF bug happens when the fsync policy is set to "everysec", which is the
default: if the write load in the server drops immediately, the commands
executed in the latest second may not be fsync-ed to disk as it should.
This may lead to data loss in case the write load drops immediately and
successively a server crash happens.
Other things in this release
----------------------------
\* Streams: a bug in the iterator could prevent certain items to be returned in
range queries under specific conditions.
\* Memleak in bitfieldCommand fixed.
\* Modules API: Preserve client->id for blocked clients.
\* Fix memory leak when rewriting config file in case of write errors.
\* New modules API: RedisModule\_GetKeyNameFromIO().
\* Fix non critical bugs in diskless replication.
\* New mdouels API: command filtering. See RedisModule\_RegisterCommandFilter();
\* Tests improved to be more deterministic.
\* Fix a Redis Cluster bug, manual failover may abort because of the master
sending PINGs to the replicas.
The following is the full list of commmits.
Regards,
Salvatore
Christian Zeller in commit 1cac9b4b:
Typo fixes in CONTRIBUTING
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit f63c5c7b:
Update CONTRIBUTING with present info.
1 file changed, 15 insertions(+), 5 deletions(-)
antirez in commit 668661da:
Narrow the effects of PR #6029 to the exact state.
1 file changed, 17 insertions(+), 5 deletions(-)
chendianqiang in commit 3c2800e3:
stop ping when client pause
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 7ac7ffd5:
Test: fix slowlog test false positive.
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit cc101721:
Make comment in getClientOutputBufferMemoryUsage() describing the present.
1 file changed, 1 insertion(+), 8 deletions(-)
WuYunlong in commit 72420b0d:
Do not active expire keys in the background when the switch is off.
1 file changed, 6 insertions(+), 4 deletions(-)
liaotonglang in commit 33a50d24:
delete sdsTest() from REDIS\_TEST
1 file changed, 2 deletions(-)
zhaozhao.zz in commit 6a92836f:
test cases: skiptill -> skip-till
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit f179f71e:
make replication tests more stable on slow machines
3 files changed, 34 insertions(+), 4 deletions(-)
Yossi Gottlieb in commit 1825a4ec:
Add runtest-moduleapi with commandfilter coverage.
5 files changed, 63 insertions(+), 28 deletions(-)
Yossi Gottlieb in commit 9d20fdb4:
fix: missing initialization.
3 files changed, 1 insertion(+)
antirez in commit ded1980e:
Test: disable module testing for now.
1 file changed, 1 deletion(-)
Yossi Gottlieb in commit c3df78c2:
CommandFilter API: REDISMODULE\_CMDFILTER\_NOSELF.
4 files changed, 62 insertions(+), 15 deletions(-)
Yossi Gottlieb in commit 8d38ef20:
CommandFilter API: fix UnregisterCommandFilter.
1 file changed, 2 insertions(+), 3 deletions(-)
Yossi Gottlieb in commit 9b7009b1:
CommandFilter API: Add unregister option.
4 files changed, 126 insertions(+), 32 deletions(-)
Yossi Gottlieb in commit 05802442:
CommandFilter API: Extend documentation.
1 file changed, 43 insertions(+), 5 deletions(-)
Yossi Gottlieb in commit d5194daf:
CommandFilter API: hellofilter and tests.
2 files changed, 47 insertions(+), 5 deletions(-)
Yossi Gottlieb in commit 8897c154:
CommandFilter API: Support Lua and RM\_call() flows.
2 files changed, 18 insertions(+), 7 deletions(-)
Yossi Gottlieb in commit 6dd5bad4:
CommandFilter API: More cleanup.
2 files changed, 10 insertions(+), 29 deletions(-)
Yossi Gottlieb in commit 83026101:
Add command filter Module API tests.
2 files changed, 28 insertions(+)
Yossi Gottlieb in commit dc5edc7b:
Add command filtering argument handling API.
3 files changed, 132 insertions(+), 13 deletions(-)
Yossi Gottlieb in commit 5f29e2e2:
Initial command filter experiment.
6 files changed, 161 insertions(+), 2 deletions(-)
Oran Agra in commit e1839ab3:
diskless fork kept streaming RDB to a disconnected slave
1 file changed, 10 insertions(+)
Oran Agra in commit 3b207b89:
diskless replication - notify slave when rdb transfer failed
1 file changed, 1 insertion(+)
antirez in commit 7e350b09:
More sensible name for function: restartAOFAfterSYNC().
1 file changed, 7 insertions(+), 3 deletions(-)
antirez in commit 91238a60:
Mostly aesthetic changes to restartAOF().
1 file changed, 7 insertions(+), 3 deletions(-)
oranagra in commit ee2da67c:
bugfix to restartAOF, exit will never happen since retry will get negative.
1 file changed, 5 insertions(+), 4 deletions(-)
Oran Agra in commit 78022492:
Add log when server dies of SIGTERM during loading
1 file changed, 1 insertion(+)
Yossi Gottlieb in commit 232dca7f:
Add RedisModule\_GetKeyNameFromIO().
8 files changed, 30 insertions(+), 17 deletions(-)
antirez in commit 7f98129a:
MANIFESTO: simplicity and lock-in.
1 file changed, 5 insertions(+), 1 deletion(-)
antirez in commit 71265fe3:
MANIFESTO v2.
1 file changed, 41 insertions(+), 6 deletions(-)
yongman in commit 8115be6e:
Fix uint64\_t hash value in active defrag
1 file changed, 3 insertions(+), 3 deletions(-)
Angus Pearson in commit 90e7b5a9:
Enlarge error buffer in redis-check-aof.c to remove compiler warning of output truncation through snprintf format string
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 43151baf:
fix memory leak when rewrite config file
1 file changed, 3 insertions(+), 4 deletions(-)
唐权 in commit d3c17c9d:
Update ziplist.c
1 file changed, 1 insertion(+), 1 deletion(-)
stan011 in commit 296bd097:
change the comments there may have a mis type
1 file changed, 1 insertion(+), 1 deletion(-)
Yossi Gottlieb in commit e08c9c15:
Preserve client->id for blocked clients.
1 file changed, 4 insertions(+), 1 deletion(-)
zhaozhao.zz in commit c6b1252f:
aof: enhance AOF\_FSYNC\_EVERYSEC, more details in #5985
2 files changed, 32 insertions(+), 3 deletions(-)
David Carlier in commit ce54e299:
build fix
1 file changed, 1 insertion(+)
yongman in commit c9274498:
Fix memleak in bitfieldCommand
1 file changed, 8 insertions(+), 2 deletions(-)
James Rouzier in commit 635d8d83:
Fix start and end key initialize
1 file changed, 2 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit 7c23e534:
Merge pull request #6047 from abhaynahar/removed-obsolete-warning-5.0
abhay in commit 9ea8ec42:
removed obsolete warning as per - https://github.com/antirez/redis/issues/5291
1 file changed, 1 insertion(+), 7 deletions(-)
antirez in commit 1b7407fa:
Aesthetic change to #5962 to conform to Redis style.
1 file changed, 1 insertion(+), 3 deletions(-)
Oran Agra in commit 3bbf9747:
slave corrupts replication stream when module blocked client uses large reply (or POSTPONED\_ARRAY)
3 files changed, 15 insertions(+), 6 deletions(-)
================================================================================
Redis 5.0.4 Released Mon Mar 18 17:12:53 CET 2019
================================================================================
Upgrade urgency HIGH: This release fixes several Redis stability issues.
Dear Redis users, this release includes a number of fixes for bugs that may
result in Redis crashing in special conditions (not normal usage, but specific
artificial conditions), fixes to certain Redis behaviors especially around
Redis streams, and finally a set of new APIs for Redis Modules.
Specifically:
\* Hyperloglog different coding errors leading to potential crashes were fixed.
\* A replication bug leading to a potential crash in case of plain misuse of handshake commands was fixed.
\* XCLAIM command incrementing of number of deliveries was fixed.
\* LFU field management in objects was improved.
\* A potential overflow in the redis-check-aof was fixed.
\* A memory leak in case of API misuse was fixed.
\* ZPOP\* behavior when count is 0 is fixed.
\* A few redis-cli --cluster bugs were fixed, plus a few improvements.
\* Many other smaller bugs.
We suggest to upgrade Redis, especially in case your instance is facing
untrusted users (for instance Cloud providers) because several of these
bugs could result in unwanted crashes.
This is the list of commits:
antirez in commit 84bdd440:
HyperLogLog: fix comment in hllCount().
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit ef1833b3:
HyperLogLog: handle wrong offset in the base case.
1 file changed, 2 insertions(+), 6 deletions(-)
antirez in commit 623afd5e:
HyperLogLog: speedup fuzz test.
1 file changed, 1 insertion(+), 2 deletions(-)
antirez in commit 12b5ff10:
HyperLogLog: enlarge reghisto variable for safety.
1 file changed, 6 insertions(+), 1 deletion(-)
antirez in commit 254d897e:
HyperLogLog: dense/sparse repr parsing fuzz test.
1 file changed, 29 insertions(+)
John Sully in commit 7f79849c:
Fix hyperloglog corruption
1 file changed, 6 insertions(+)
Brad Solomon in commit 3ef2c831:
Provide an uninstall target in Makefile
1 file changed, 3 insertions(+)
antirez in commit 57aea463:
redis-check-aof: fix potential overflow.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit ba5145b8:
Fix objectSetLRUOrLFU() when LFU underflows.
1 file changed, 11 insertions(+), 7 deletions(-)
antirez in commit 76c59f0e:
Fix ZPOP return type when COUNT=0. Related to #5799.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1c636714:
Improve comments after merging #5834.
2 files changed, 14 insertions(+), 8 deletions(-)
Guy Benoish in commit 6a3fca4c:
Trim SDS free space of retained module strings
4 files changed, 28 insertions(+), 5 deletions(-)
Guy Benoish in commit 9ec144ea:
Fix mismatching keyspace notification classes
2 files changed, 2 insertions(+), 2 deletions(-)
Guy Benoish in commit d04b5211:
Fix zlexrangespec mem-leak in genericZrangebylexCommand
1 file changed, 4 insertions(+), 1 deletion(-)
Guy Benoish in commit 516f1c77:
Use memtoll() in 'CONFIG SET client-output-buffer-limit'
1 file changed, 2 insertions(+), 2 deletions(-)
Guy Benoish in commit 8db67a55:
Increase string2ld's buffer size (and fix HINCRBYFLOAT)
2 files changed, 5 insertions(+), 1 deletion(-)
Guy Benoish in commit db3d626b:
Check server.verbosity in RM\_LogRaw
1 file changed, 2 insertions(+)
Guy Benoish in commit 71439a07:
ZPOP should return an empty array if COUNT=0
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit c8a26834:
Modules shared API: export new core APIs.
2 files changed, 6 insertions(+)
antirez in commit a13ba750:
Modules shared API: also unregister the module as user.
1 file changed, 23 insertions(+)
antirez in commit 500e5117:
Modules shared API: prevent unloading of used modules.
1 file changed, 10 insertions(+), 4 deletions(-)
antirez in commit 7854daa1:
Modules shared API: unregister APIs function.
1 file changed, 25 insertions(+)
antirez in commit d38d82af:
Modules shared API: initial core functions.
2 files changed, 89 insertions(+), 1 deletion(-)
antirez in commit 4d747bb8:
Revert shared APIs to modify the design.
3 files changed, 120 deletions(-)
MeirShpilraien in commit 8824b509:
added module ability to register api to be used by other modules
3 files changed, 120 insertions(+)
zhaozhao.zz in commit 000b055b:
Streams: checkType before XGROUP CREATE
1 file changed, 7 insertions(+), 5 deletions(-)
antirez in commit 9b2a0d54:
Fix BZPOP arity, backport from fix in cd2743c.
1 file changed, 2 insertions(+), 2 deletions(-)
chendianqiang in commit 134b2582:
optimize cluster failover
1 file changed, 1 insertion(+)
Steve Webster in commit 1293e2a5:
Only increment delivery count if JUSTID option is omitted
2 files changed, 18 insertions(+), 3 deletions(-)
Steve Webster in commit 3cc4f469:
Increment delivery counter on XCLAIM unless RETRYCOUNT specified
2 files changed, 35 insertions(+), 2 deletions(-)
antirez in commit f4edd2b9:
Merge branch '5.0' of github.com:/antirez/redis into 5.0
swilly22 in commit cedcc54e:
document additional flag of RM\_GetContextFlags
1 file changed, 3 insertions(+)
swilly22 in commit 26e98da2:
Extend REDISMODULE\_CTX\_FLAGS to indicate if command was sent by master
2 files changed, 6 insertions(+)
Salvatore Sanfilippo in commit 0e910939:
Merge pull request #5879 from meierfra-ergon/redis-cli-assume-yes
antirez in commit 67452e91:
Make comment in #5911 stay inside 80 cols.
1 file changed, 2 insertions(+), 1 deletion(-)
John Sully in commit 30f666ef:
Replicas aren't allowed to run the replicaof command
1 file changed, 8 insertions(+)
Frank Meier in commit bc6c1c40:
extend use of cluster-yes option to other confimation questions
1 file changed, 9 insertions(+)
antirez in commit 76419d8d:
Merge branch '5.0' of github.com:/antirez/redis into 5.0
Oran Agra in commit 72ba6069:
redis-cli add support for --memkeys, fix --bigkeys for module types
1 file changed, 132 insertions(+), 81 deletions(-)
chendianqiang in commit 2ca21753:
fix replicationid will not change for server.masterhost==NULL in cluster mode when restart slave
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit bd7ddd79:
Merge pull request #5870 from fengweiyuan/5.0
varianfeng in commit d13bc143:
fix corrupt\_rdb.c bug.Let the name of input rdb file name be valid.
1 file changed, 2 insertions(+), 1 deletion(-)
artix in commit 44c5bce0:
Cluster Manager: fix replica assigment anti-affinity (create)
1 file changed, 6 insertions(+)
artix in commit f066e526:
Cluster Manager: remove unused code elements
1 file changed, 8 insertions(+), 13 deletions(-)
Zhicheng Wei in commit 23214966:
fix clusterManagerGetAntiAffinityScore double free otypes
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 80bccd71:
Remove debugging printf from replication.tcl test.
1 file changed, 1 deletion(-)
================================================================================
Redis 5.0.3 Released Tue Dec 11 18:17:26 CET 2018
================================================================================
Upgrade urgency HIGH: Redis 5 is consolidating, upgrading is a good idea.
However there is nothing very critical here, but certain
issues resolved could lead to very rare crashes.
Welcome to Redis 5.0.3, several interesting bug fixes here:
\* Redis no longer panics when you send data to a replica-mode connection that
is in MONITOR or SYNC mode.
\* Fixes to certain sorted set edge cases. You are unlikely to ever notice those
issues, but now it is more correct.
\* Certain BSD variants now are better supported: build & register logging
on crash.
\* The networking core now recovers if an IPv6 address is listed in bind but
is actually not able to work because there is no such protocol in the
system.
\* redis-cli cluster mode improved in many ways. Especially the fix subcommand
work was enhanced to cover other edge cases that were still not covered
after the work done for Redis 5.
\* MEMORY USAGE is now more accurate.
\* DEBUG DIGEST-VALUE added in case you want to make sure a given set of keys
(and not the whole DB) are excatly the same between two instances.
\* Fix a potential crash in the networking code related to recent changes
to the way the reply is consumed.
\* Reject EXEC containing write commands against an instance that changed role
from master to replica during our transaction.
\* Fix a crash in KEYS and other commands using pattern matching, in an edge
case where the pattern contains a zero byte.
\* Fix eviction during AOF loading due to maxmemory triggered by commands
executed in loading state.
The following is the list of commmits if you want to check credits or dig
further in the details.
commit 2c6ee0f9b3d9ca48c6da8bd18796186784216bff
Author: antirez
Date: Wed Dec 12 11:37:15 2018 +0100
freeMemoryIfNeeded() small refactoring.
Related to issue #5686 and PR #5689.
commit 107e93e75acfd5def0252efb6870751940816395
Author: zhaozhao.zz
Date: Wed Dec 12 00:25:24 2018 +0800
evict: don't care about mem if loading
When loading data, we call processEventsWhileBlocked
to process events and execute commands.
But if we are loading AOF it's dangerous, because
processCommand would call freeMemoryIfNeeded to evict,
and that will break data consistency, see issue #5686.
antirez in commit ee93dc0b:
Crashing is too much in addReplyErrorLength().
1 file changed, 6 deletions(-)
hdmg in commit c55254a5:
fix comments fault discription
1 file changed, 1 insertion(+), 1 deletion(-)
lsytj0413 in commit dfd25013:
fix a typo: craeted -> created
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 392a2566:
stringmatchlen() fuzz test added.
3 files changed, 22 insertions(+)
antirez in commit 7602f695:
Fix stringmatchlen() read past buffer bug.
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit c4f3585e:
multi: ignore multiState's cmd\_flags when loading AOF
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit d037e987:
Reject EXEC containing write commands against RO replica.
2 files changed, 20 insertions(+)
artix in commit e00ab324:
Cluster Manager: - Multiple owners checking in 'fix'/'check' commands is
now optional (using --cluster-search-multiple-owners). - Updated help.
1 file changed, 14 insertions(+), 5 deletions(-)
artix in commit 94f64de3:
Cluster Manager: FixOpenSlot now correctly updates in-memory cluster
configuration. Improved output messages.
1 file changed, 17 insertions(+), 5 deletions(-)
artix in commit 752d636f:
Cluster Manager: 'fix' command now handles open slots with migrating state
in one node and importing state in multiple nodes.
1 file changed, 74 insertions(+), 6 deletions(-)
artix in commit 552091f9:
Cluster Manager: setting new slot owner is now handled atomically in
'fix' command.
1 file changed, 72 insertions(+), 31 deletions(-)
artix in commit 2280f4f7:
Cluster Manager: code cleanup.
1 file changed, 41 insertions(+), 87 deletions(-)
artix in commit e084b8cc:
Cluster Manager: check/fix commands now handle multiple owners even
if all slots are covered and not open.
1 file changed, 129 insertions(+), 6 deletions(-)
zhaozhao.zz in commit fa726e2a:
remove useless tryObjectEncoding in debug assert
1 file changed, 1 deletion(-)
Oran Agra in commit 40244b10:
fix #5580, display fragmentation and rss overhead bytes as signed
2 files changed, 6 insertions(+), 6 deletions(-)
zhaozhao.zz in commit beab3151:
networking: current\_client should not be NULL when trim qb\_pos
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 07ccb642:
Remove no longer relevant comment in processCommand().
1 file changed, 2 insertions(+), 6 deletions(-)
antirez in commit 60fdaf07:
DEBUG DIGEST-VALUE implemented.
1 file changed, 17 insertions(+), 3 deletions(-)
antirez in commit 48b31b0d:
DEBUG DIGEST refactoring: extract function to digest a value.
1 file changed, 142 insertions(+), 131 deletions(-)
yura in commit ef3ff402:
redis-cli reshard/rebalance: ability to force replacement on existing keys
1 file changed, 6 insertions(+), 5 deletions(-)
Thomas Orozco in commit ee223fb8:
cli: pass auth through REDISCLI\_AUTH
1 file changed, 14 insertions(+)
yongman in commit 41295e55:
Fix cluster call reply format readable
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 0ed3970f:
fix small test suite race conditions
3 files changed, 11 insertions(+)
zhaozhao.zz in commit 605dddbb:
MEMORY command: make USAGE more accurate
1 file changed, 7 insertions(+), 6 deletions(-)
yongman in commit 1f43bf29:
Fix choose a random master node for slot assignment
1 file changed, 29 insertions(+), 5 deletions(-)
Weiliang Li in commit 69f0c678:
fix comment typo in util.c
1 file changed, 1 insertion(+), 1 deletion(-)
Chris Lamb in commit bc53a3ab:
Clarify the "Creating Server TCP listening socket" error.
1 file changed, 1 insertion(+), 1 deletion(-)
Chris Lamb in commit fefe5460:
Don't treat unsupported protocols as fatal errors
1 file changed, 4 insertions(+)
David Carlier in commit a8862972:
OpenBSD support.
3 files changed, 74 insertions(+), 1 deletion(-)
David Carlier in commit 5e86daf9:
Backtrace/register dump on BSD.
3 files changed, 97 insertions(+), 3 deletions(-)
Guy Benoish in commit 7c8cf5ac:
Don't call sdscmp() with shared.maxstring or shared.minstring
2 files changed, 23 insertions(+), 9 deletions(-)
Qu Chen in commit 39e9eda3:
Add unit test for stream XCLAIM command.
1 file changed, 48 insertions(+)
antirez in commit 62485232:
Abort instead of crashing when loading bad stream master key.
1 file changed, 3 insertions(+)
Madelyn Olson in commit a5487309:
Fixed a serverPanic when sending an invalid command to a monitor client
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0.2 Released Thu Nov 22 11:22:37 CET 2018
================================================================================
Upgrade urgency: CRITICAL if you use streams and consumer groups.
HIGH if you use redis-cli with Redis Cluster.
LOW otherwise.
Welcome to Redis 5.0.2. This release fixes two issues with Streams consumer
groups, where items could be returned duplicated by XREADGROUP when accessing
the history, and another bug where XREADGROUP can report some history even
if the comsumer pending list is empty. Both problems were addressed and unit
tests to avoid regressions implemented. Moreover this release fixes some
issue with redis-cli when in cluster mode. Finally some FreeBSD and DragonFly
build problems are now resolved. The list of the commits is below.
Enjoy,
Salvatore
David Carlier in commit e8b4291a:
DragonFlyBSD little build fix
2 files changed, 6 insertions(+), 1 deletion(-)
yongman in commit 8fcfd374:
skip slave nodes when sending cluster setslot command
1 file changed, 1 insertion(+)
yongman in commit d7089ddd:
Fix pointer access and memory leak in redis-cli.
1 file changed, 6 insertions(+), 3 deletions(-)
antirez in commit 17b4cd83:
Test: regression test for #5570.
1 file changed, 15 insertions(+)
antirez in commit 45123169:
Stream: fix XREADGROUP history reading of deleted messages.
1 file changed, 1 insertion(+), 1 deletion(-)
David Carlier in commit 5ad588f0:
only FreeBSD change/little warning addressing
2 files changed, 7 insertions(+), 4 deletions(-)
David Carlier in commit 11801e1a:
tweak form feedback
1 file changed, 1 insertion(+), 1 deletion(-)
David Carlier in commit c1f13575:
allow flavors
1 file changed, 1 insertion(+), 1 deletion(-)
David Carlier in commit 275a2d49:
Fix clang build.
1 file changed, 5 insertions(+), 1 deletion(-)
antirez in commit 44ad5141:
Test: regression test for #5577.
1 file changed, 24 insertions(+)
antirez in commit c7951f43:
Streams: fix XREADGROUP history reading when CG last\_id is low.
1 file changed, 12 insertions(+), 9 deletions(-)
antirez in commit a69bc5be:
t\_stream.c comment resized to 80 cols.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 5314099d:
Redis 5 changelog: don't expect Lua replies to be ordered.
1 file changed, 14 insertions(+), 5 deletions(-)
================================================================================
Redis 5.0.1 Released Wed Nov 07 13:09:30 CET 2018
================================================================================
Upgrade urgency: URGENT if you use Redis Streams. MODERATE otherwise.
Hi all, this is the first patch level release of Redis 5. It contains
both fixes and improvements. Here there is a list of the major ones, however
read the commit messages at the end of the changelog if you want to know
more about the smaller things. Let's start with the new features:
\* Sentinel now supports authentication! Check the Sentinel official doc
for more info.
\* Redis-cli cluster "fix" is now able to fix a big number of clusters put
in a bad condition. Previously many corner cases were not covered.
Now the critical fixes:
1. Fix RESTORE mismatch reply when certain keys already expired.
2. Fix an XCLAIM non trivial issue: sometimes the command returned a wrong
entry or desynchronized the protocol.
And now the other fixes:
3. Stack trace generation on the Raspberry PI (and 32bit ARM) fixed.
4. Don't evict expired keys when the KEYS command is called, in order to
avoid a mass deletion event. However expired keys are not displayed
by KEYS as usually.
5. Improvements in the computation of the memory used, when estimating
the AOF buffers.
6. XRANGE COUNT of 0 fixed.
7. "key misses" stats accounting fixed. Many cache misses were not counted.
8. When in MULTI state, return OOM while accumulating commands and there
is no longer memory available.
9. Fix build on FreeBSD and possibly others.
10. Fix a crash in Redis modules, thread safe context reply accumulation.
11. Fix a race condition when producing the RDB file for full SYNC.
12. Disable protected mode in Sentinel.
13. More commands now have the HELP subcommand.
14. Fixed an issue about adaptive server HZ timer.
15. Fix cluster-replica-no-failover option name.
Finally, this is the list of commits. Enjoy Redis 5.0.1!
antirez in commit c801283f:
Fix cluster-replica-no-failover option name.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 4c4f50e1:
MEMORY command: make strcasecmp() conditional like the following.
1 file changed, 1 insertion(+), 2 deletions(-)
Itamar Haber in commit a7b46e0e:
Uppercases subcommands in MEMORY HELP
1 file changed, 5 insertions(+), 5 deletions(-)
Itamar Haber in commit 80e129d9:
Standardizes `MEMORY HELP` subcommand
1 file changed, 13 insertions(+), 14 deletions(-)
valentino in commit 88805cbb:
fix short period of server.hz being uninitialized
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit 6b402733:
Adds HELP to LATENCY
1 file changed, 14 insertions(+), 2 deletions(-)
yongman in commit 1c637de9:
fix malloc in clusterManagerComputeReshardTable
1 file changed, 1 insertion(+), 1 deletion(-)
artix in commit 90b52fde:
Cluster Manager: removed unused var.
1 file changed, 1 insertion(+), 2 deletions(-)
artix in commit 89cbb5df:
Cluster Manager: further improvements to "fix": - clusterManagerFixOpenSlot: ensure that the slot is unassigned before ADDSLOTS - clusterManagerFixSlotsCoverage: after cold migration, the slot configuration is now updated on all the nodes.
1 file changed, 49 insertions(+), 10 deletions(-)
artix in commit 175515c9:
Cluster Manager: fixed string parsing issue in clusterManagerGetConfigSignature
1 file changed, 3 insertions(+), 3 deletions(-)
artix in commit 3997dd6e:
Cluster Manager: better fix subcommand.
1 file changed, 78 insertions(+), 20 deletions(-)
artix in commit bd80291c:
Cluster Manager: fixed typos in comments.
1 file changed, 3 insertions(+), 3 deletions(-)
artix in commit 4369cbce:
Cluster Manager: fixed 'DELSLOT' subcommand typo.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1ed821e2:
Fix XCLAIM missing entry bug.
1 file changed, 3 insertions(+), 2 deletions(-)
michael-grunder in commit b49bcd01:
Use typedef'd mstime\_t instead of time\_t
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 09d1849e:
Improve streamReplyWithRange() top comment.
1 file changed, 9 insertions(+), 5 deletions(-)
antirez in commit bdf6306f:
Add support for Sentinel authentication.
1 file changed, 17 insertions(+), 3 deletions(-)
antirez in commit 50222af5:
Disable protected mode in Sentinel mode.
1 file changed, 1 insertion(+)
antirez in commit 643ee6e3:
When replica kills a pending RDB save during SYNC, log it.
1 file changed, 6 insertions(+)
Andrey Bugaevskiy in commit 8b609c99:
Move child termination to readSyncBulkPayload
1 file changed, 6 insertions(+), 7 deletions(-)
Andrey Bugaevskiy in commit 27102605:
Prevent RDB autosave from overwriting full resync results
1 file changed, 7 insertions(+)
antirez in commit a677923d:
asyncCloseClientOnOutputBufferLimitReached(): don't free fake clients.
1 file changed, 1 insertion(+)
David Carlier in commit 427e440a:
needs it for the global
1 file changed, 1 insertion(+)
David Carlier in commit 28f9ca4e:
Fix non Linux build.
3 files changed, 20 insertions(+), 1 deletion(-)
zhaozhao.zz in commit 4bf9efe2:
MULTI: OOM err if cannot free enough memory in MULTI/EXEC context
1 file changed, 5 insertions(+), 2 deletions(-)
antirez in commit 4fbd7a39:
Add command fingerprint comment for XSETID.
1 file changed, 3 insertions(+), 1 deletion(-)
Itamar Haber in commit 2480db53:
Plugs a potential underflow
1 file changed, 1 insertion(+)
Itamar Haber in commit e5e4d2ef:
Corrects inline documentation of syntax
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 713800d2:
if we read a expired key, misses++
1 file changed, 5 insertions(+), 1 deletion(-)
antirez in commit e79ee263:
Fix XRANGE COUNT option for value of 0.
1 file changed, 8 insertions(+), 2 deletions(-)
antirez in commit 505cc70f:
Fix typo in streamReplyWithRange() top comment.
1 file changed, 1 insertion(+), 1 deletion(-)
Damien Tournoud in commit 3c36561d:
Overhead is the allocated size of the AOF buffer, not its length
2 files changed, 2 insertions(+), 2 deletions(-)
antirez in commit 3761582f:
Simplify part of the #5470 patch.
1 file changed, 11 insertions(+), 12 deletions(-)
zhaozhao.zz in commit edc47a3a:
do not delete expired keys in KEYS command
1 file changed, 34 insertions(+), 27 deletions(-)
antirez in commit 9872af6d:
Use guide comments to make changes in #5462 more obvious.
1 file changed, 6 insertions(+)
youjiali1995 in commit 3f399c3b:
migrate: fix mismatch of RESTORE reply when some keys have expired.
1 file changed, 8 insertions(+), 6 deletions(-)
hujie in commit eaaff621:
fix typo in config.c
1 file changed, 1 insertion(+), 1 deletion(-)
hujiecs in commit 43ebb7ee:
several typos fixed, optimize MSETNX to avoid unnecessary loop
4 files changed, 4 insertions(+), 4 deletions(-)
antirez in commit de8fdaac:
Remove useless complexity from MSET implementation.
1 file changed, 5 insertions(+), 7 deletions(-)
antirez in commit dc8f1112:
Fix again stack generation on the Raspberry Pi.
1 file changed, 4 insertions(+)
antirez in commit 83a6e81d:
Get rid of the word slave in the release note of Redis 5.
1 file changed, 2 insertions(+), 2 deletions(-)
================================================================================
Redis 5.0.0 Released Wed Oct 17 13:28:26 CEST 2018
================================================================================
Upgrade urgency CRITICAL: Several fixes to streams AOF and replication.
Hi all and welcome to the first stable release of Redis 5! \o/
To start a quick recap of what's new in Redis 5:
1. The new Stream data type. https://redis.io/topics/streams-intro
2. New Redis modules APIs: Timers, Cluster and Dictionary APIs.
3. RDB now store LFU and LRU information.
4. The cluster manager was ported from Ruby (redis-trib.rb) to C code
inside redis-cli. Check `redis-cli --cluster help` for more info.
5. New sorted set commands: ZPOPMIN/MAX and blocking variants.
6. Active defragmentation version 2.
7. Improvemenets in HyperLogLog implementations.
8. Better memory reporting capabilities.
9. Many commands with sub-commands now have an HELP subcommand.
10. Better performances when clients connect and disconnect often.
11. Many bug fixes and other random improvements.
12. Jemalloc was upgraded to version 5.1
13. CLIENT UNBLOCK and CLIENT ID.
14. The LOLWUT command was added. http://antirez.com/news/123
15. We no longer use the "slave" word if not for API backward compatibility.
16. Differnet optimizations in the networking layer.
17. Lua improvements:
- Better propagation of Lua scripts to replicas / AOF.
- Lua scripts can now timeout and get in -BUSY state in the replica as well.
18. Dynamic HZ to balance idle CPU usage with responsiveness.
19. The Redis core was refactored and improved in many ways.
However the list above really does not do justice to the changes of Redis 5
since the core was improved in many ways during the development of the new
version. However certain changes were back ported into Redis 4 once they were
sensed as safe, because many improvements were hard to distinguish from fixes.
The most important user facing improvement is without doubts the introduction
of the new general purpose data type after years: the streams.
Note that we worked to improve and fix streams till a few hours ago, so while
we are not aware of critical bugs in this release, surely there is to handle it
with some care for the first weeks. Bug reporting will be highly appreciated and
we are ready to work immediately to release 5.0.1 once there is enough important
stuff to justify a new release (probably soon).
People not using the streams can have probably a better production-ready
experience with Redis 5, also because many internals are shared with Redis 4
so the jump is not as big as it was between 3.2 and 4 in terms of how things
internally work.
Well, many thanks to the Redis community and the developers that made
this release possible, contributing bug reports, patches, new features, working
on the clients, sometimes debugging problems for days. Also thank to everybody
that adopted Redis for their use cases making things work for users worldwide.
The list of commits in this release follows.
Cheers,
Salvatore
antirez in commit bcc0916d:
Fix conditional in XGROUP.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1b2f23f3:
Update help.h for redis-cli.
1 file changed, 57 insertions(+), 7 deletions(-)
antirez in commit de0ae56c:
Tests for XGROUP CREATE MKSTREAM.
1 file changed, 11 insertions(+)
antirez in commit 56c3dfa1:
Fix XGROUP CREATE MKSTREAM handling of .
1 file changed, 7 insertions(+), 2 deletions(-)
antirez in commit 2687f228:
Process MKSTREAM option of XGROUP CREATE at a later time.
1 file changed, 28 insertions(+), 17 deletions(-)
zhaozhao.zz in commit cfbaf8f1:
Scripting & Streams: some commands need right flags
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit 4e4099b9:
XGROUP CREATE: MKSTREAM option for automatic stream creation.
1 file changed, 29 insertions(+), 5 deletions(-)
zhaozhao.zz in commit 6dd4d864:
Streams: Tests modified XSTREAM -> XSETID
1 file changed, 2 insertions(+), 2 deletions(-)
zhaozhao.zz in commit 3aff0e8c:
Streams: rewrite empty streams with certain lastid
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 880b563e:
Tests modified to use XADD MAXLEN 0 + XSETID.
1 file changed, 12 insertions(+), 26 deletions(-)
antirez in commit 83c87835:
Streams: rewrite empty streams with XADD MAXLEN 0. Use XSETID.
1 file changed, 18 insertions(+), 12 deletions(-)
antirez in commit fd22e3ac:
XSETID: accept IDs based on last entry.
1 file changed, 18 insertions(+), 5 deletions(-)
antirez in commit dfab3cba:
Streams: XSTREAM SETID -> XSETID.
3 files changed, 17 insertions(+), 67 deletions(-)
zhaozhao.zz in commit a3fb28ed:
Streams: rewrite id in XSTREAM CREATE \*
1 file changed, 4 insertions(+)
zhaozhao.zz in commit f4b4db13:
Streams: add tests for aof rewrite
1 file changed, 23 insertions(+)
zhaozhao.zz in commit d22f1ef0:
Stream & AOF: rewrite stream in correct way
1 file changed, 32 insertions(+), 16 deletions(-)
zhaozhao.zz in commit 6455274d:
Streams: add tests for XSTREAM command
1 file changed, 39 insertions(+)
zhaozhao.zz in commit 0edbe953:
Streams: add a new command XTREAM
3 files changed, 67 insertions(+)
Hamid Alaei in commit 9714bba2:
fix timer context selected database
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit eb53f15a:
Make comment about nack->consumer test for minidle more obvious.
1 file changed, 4 insertions(+), 2 deletions(-)
antirez in commit a77f836e:
Streams: use propagate\_last\_id itself as streamPropagateGroupID trigger.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 0f0610eb:
Streams: better naming: lastid\_updated -> propagate\_last\_id.
1 file changed, 6 insertions(+), 6 deletions(-)
zhaozhao.zz in commit a745e423:
Streams: panic if streamID invalid after check, should not be possible.
1 file changed, 2 insertions(+), 1 deletion(-)
zhaozhao.zz in commit 9974be13:
Streams: propagate lastid in XCLAIM when it has effect
1 file changed, 13 insertions(+), 6 deletions(-)
zhaozhao.zz in commit 69a628d0:
Streams: XCLAIM ignore minidle if NACK is created by FORCE
1 file changed, 4 insertions(+), 2 deletions(-)
zhaozhao.zz in commit a04b43c7:
Streams: bugfix XCLAIM should propagate group name not consumer name
1 file changed, 1 insertion(+), 1 deletion(-)
Sergey Chupov in commit 8977a90c:
fixed typos in readme
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 3a745674:
redis.conf typo fixed: ingore -> ignore.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 22770d76:
Rax: radix tree updated to latest version from antirez/rax.
2 files changed, 233 insertions(+), 68 deletions(-)
antirez in commit fbac534f:
Test: avoid time related false positive in RESTORE test.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 49872337:
LOLWUT: capitalize Nees.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 80c471f5:
Test: cgroup propagation test also for NOACK variant.
1 file changed, 39 insertions(+), 29 deletions(-)
antirez in commit 8defa5da:
Test: consumer group last ID slave propagation test.
1 file changed, 39 insertions(+)
zhaozhao.zz in commit e1e3eaca:
Avoid recreate write handler for protected client.
1 file changed, 4 insertions(+)
antirez in commit b501fd5d:
Fix propagation of consumer groups last ID.
3 files changed, 56 insertions(+), 9 deletions(-)
================================================================================
Redis 5.0-rc6 Released Wed Oct 10 11:03:54 CEST 2018
================================================================================
Upgrade urgency HIGH: Many bugs fixed especially in the context of streams.
This is probably the last release candidate of Redis 5. The Redis 5 GA version
will be released 17th of October. The main highlights of this release are:
\* Critical AOF bug, as old as AOF itself: if an open MULTI/EXEC block is at
the end of the AOF file, Redis would still read the half-transaction when
reloading back the AOF.
\* The slave name was removed from logs and documentation, now replica is used
instead.
\* LOLWUT command added.
\* New modules APIs: Disable Redis Cluster redirection.
\* New modules APIs: Sorted dictionaries data type.
\* Modules APIs fixes: timer / cluster messages callback now can call RM\_Call().
\* Fix for #5024 - commandstats for multi-exec were logged as EXEC.
\* A number of optimizations and fixes for the stream data type.
\* Many other stability improvements.
This is the list of comments and contributors:
antirez in commit 9a6fa7d0:
changelog.tcl: get optional argument for number of commits.
1 file changed, 8 insertions(+), 3 deletions(-)
antirez in commit 101e419f:
Free protected clients asynchronously.
1 file changed, 7 insertions(+)
antirez in commit 726debb8:
Actually use the protectClient() API where needed.
2 files changed, 8 insertions(+), 9 deletions(-)
antirez in commit 0b87f78a:
Introduce protectClient() + some refactoring.
2 files changed, 60 insertions(+), 18 deletions(-)
zhaozhao.zz in commit 6aa8ac70:
debug: avoid free client unexpectedly when reload & loadaof
1 file changed, 8 insertions(+), 2 deletions(-)
antirez in commit 48040b02:
aof.c: improve indentation and change warning message.
1 file changed, 11 insertions(+), 4 deletions(-)
zhaozhao.zz in commit 7cc20569:
AOF: discard if we lost EXEC when loading aof
2 files changed, 14 insertions(+), 3 deletions(-)
antirez in commit 2007d30c:
Refactoring of XADD / XTRIM MAXLEN rewriting.
1 file changed, 15 insertions(+), 22 deletions(-)
zhaozhao.zz in commit 6a298110:
Streams: add test cases for XADD/XTRIM maxlen
1 file changed, 46 insertions(+)
zhaozhao.zz in commit 041161b7:
Streams: propagate specified MAXLEN instead of approximated
1 file changed, 35 insertions(+), 6 deletions(-)
zhaozhao.zz in commit f04d799b:
Streams: reset approx\_maxlen in every maxlen loop
1 file changed, 2 insertions(+)
zhaozhao.zz in commit affd9365:
Streams: XTRIM will return an error if MAXLEN with a count < 0
1 file changed, 6 insertions(+), 1 deletion(-)
zhaozhao.zz in commit 4c405ad0:
Streams: propagate original MAXLEN argument in XADD context
1 file changed, 3 insertions(+), 12 deletions(-)
antirez in commit 5c6d4b4a:
Fix typo in replicationCron() comment.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit a67a8dbf:
Fix typo in design comment of bio.c.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit c4ab5a05:
xclaimCommand(): fix comment typos.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit dc0b628a:
streamAppendItem(): Update the radix tree pointer only if changed.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 4566fbc7:
Listpack: optionally force reallocation on inserts.
1 file changed, 20 insertions(+)
antirez in commit 5eca170c:
Fix printf type mismatch in genRedisInfoString().
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 260b53a2:
streamIteratorRemoveEntry(): set back lp only if pointer changed.
1 file changed, 2 insertions(+), 1 deletion(-)
zhaozhao.zz in commit 5d12f9d9:
Streams: update listpack with new pointer in XDEL
1 file changed, 3 insertions(+)
zhaozhao.zz in commit 6b7ad838:
bugfix: replace lastcmd with cmd when rewrite BRPOPLPUSH as RPOPLPUSH
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 3454a043:
script cache memory in INFO and MEMORY includes both script code and overheads
2 files changed, 3 insertions(+), 3 deletions(-)
Oran Agra in commit d6aeca86:
fix #5024 - commandstats for multi-exec were logged as EXEC.
2 files changed, 63 insertions(+), 2 deletions(-)
antirez in commit a996b2a2:
Fix XINFO comment for consistency.
1 file changed, 1 insertion(+), 1 deletion(-)
Bruce Merry in commit 1a8447b6:
Fix invalid use of sdsZmallocSize on an embedded string
1 file changed, 1 insertion(+), 1 deletion(-)
Bruce Merry in commit 8dde46ad:
Fix incorrect memory usage accounting in zrealloc
3 files changed, 24 insertions(+), 2 deletions(-)
Hamid Alaei in commit b362a1b7:
fix dict get on not found
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 55e9df8a:
Try to avoid issues with GCC pragmas and older compilers.
1 file changed, 7 insertions(+), 4 deletions(-)
antirez in commit b0d22702:
Modules: hellodict example WIP #3: KEYRANGE.
1 file changed, 40 insertions(+)
antirez in commit af2f6682:
Modules: Modules: dictionary API WIP #13: Compare API exported.
2 files changed, 6 insertions(+)
antirez in commit f9a3e6ef:
Modules: Modules: dictionary API WIP #12: DictCompare API.
1 file changed, 8 insertions(+)
antirez in commit 01e0341a:
Modules: Modules: dictionary API WIP #11: DictCompareC API.
1 file changed, 18 insertions(+)
antirez in commit f9b3ce9a:
Modules: hellodict example WIP #1: GET command.
1 file changed, 18 insertions(+)
antirez in commit 36e66d86:
Modules: hellodict example WIP #1: SET command.
1 file changed, 74 insertions(+)
antirez in commit e33fdbe8:
Modules: remove useless defines in hellotimer.c
2 files changed, 6 insertions(+), 4 deletions(-)
antirez in commit 1c8b2248:
Modules: fix top comment of hellotimer.c
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Korland in commit 7ded552d:
add missing argument to function doc
1 file changed, 1 insertion(+), 1 deletion(-)
Pavel Skuratovich in commit f92b3273:
Fix typo in comment
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 57b6c343:
Modules: dictionary API WIP #10: export API to modules.
2 files changed, 60 insertions(+)
antirez in commit 3f82e59c:
Modules: dictionary API WIP #9: iterator returning string object.
1 file changed, 23 insertions(+), 6 deletions(-)
antirez in commit 6a73aca3:
Modules: dictionary API WIP #8: Iterator next/prev.
1 file changed, 42 insertions(+)
antirez in commit ef8413db:
Modules: dictionary API WIP #7: don't store the context.
1 file changed, 7 insertions(+), 8 deletions(-)
antirez in commit 05579e38:
Modules: dictionary API WIP #6: implement automatic memory management.
1 file changed, 21 insertions(+), 7 deletions(-)
antirez in commit 11c53f8c:
Modules: dictionary API work in progress #5: rename API for consistency.
1 file changed, 25 insertions(+), 25 deletions(-)
antirez in commit 0bd7091b:
Modules: change RedisModuleString API to allow NULL context.
1 file changed, 33 insertions(+), 12 deletions(-)
antirez in commit 5fc16f17:
Modules: dictionary API work in progress #4: reseek API.
1 file changed, 25 insertions(+), 6 deletions(-)
antirez in commit 45b7f779:
Modules: dictionary API work in progress #3: Iterator creation.
1 file changed, 41 insertions(+), 1 deletion(-)
antirez in commit 8576b0ae:
Modules: dictionary API work in progress #2: Del API.
1 file changed, 17 insertions(+), 2 deletions(-)
antirez in commit 4b0fa7a7:
Modules: dictionary API work in progress #1.
2 files changed, 95 insertions(+), 1 deletion(-)
antirez in commit 28210760:
Module cluster flags: use RM\_SetClusterFlags() in the example.
2 files changed, 11 insertions(+)
antirez in commit 18c5ab93:
Module cluster flags: add RM\_SetClusterFlags() API.
3 files changed, 33 insertions(+)
antirez in commit 4ce6bff2:
Module cluster flags: add hooks for NO\_FAILOVER flag.
1 file changed, 4 insertions(+), 2 deletions(-)
antirez in commit 2ba52889:
Module cluster flags: add hooks for NO\_REDIRECTION flag.
3 files changed, 14 insertions(+), 4 deletions(-)
antirez in commit 6a39ece6:
Module cluster flags: initial vars / defines added.
5 files changed, 20 insertions(+)
antirez in commit 0ff35370:
Modules: rename the reused static client to something more general.
1 file changed, 10 insertions(+), 8 deletions(-)
antirez in commit 2d11ee95:
Modules: associate a fake client to timer context callback.
1 file changed, 2 insertions(+)
antirez in commit 851b2ed3:
Modules: associate a fake client to cluster message context callback.
1 file changed, 2 insertions(+)
artix in commit 148e4911:
Cluster Manager: clusterManagerFixOpenSlot now counts node's keys in slot if node is neither migrating nor importing.
1 file changed, 20 insertions(+), 1 deletion(-)
Guy Korland in commit 8afca145:
No need to return "OK"
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Korland in commit 9a278db2:
typo fix
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 26479036:
Revert "fix repeat argument issue and reduce unnessary loop times for redis-cli."
1 file changed, 7 insertions(+), 12 deletions(-)
Guy Korland in commit 27b7fb5a:
Fix few typos
1 file changed, 10 insertions(+), 10 deletions(-)
Guy Korland in commit 233aa2d3:
RedisModule\_HashSet call must end with NULL
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit a8494072:
Sentinel: document how to undo a renamed command.
1 file changed, 6 insertions(+), 1 deletion(-)
antirez in commit 6c8a8f2e:
LOLWUT: split the command from version-specific implementations.
3 files changed, 297 insertions(+), 241 deletions(-)
antirez in commit 5c758406:
Slave removal: add a few forgotten aliases for CONFIG SET.
1 file changed, 10 insertions(+)
antirez in commit 2da823c4:
LOLWUT: add Redis version in the output.
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit bfcba420:
LOLWUT: Ness -> Nees.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit efed898a:
LOLWUT: Limit maximum CPU effort.
1 file changed, 5 insertions(+)
antirez in commit eb0fbd71:
LOLWUT: change padding conditional to a more direct one.
1 file changed, 1 insertion(+), 1 deletion(-)
Slobodan Mišković in commit ed08feb7:
Fix spelling descrive -> describe
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 2ffb4413:
LOLWUT: fix crash when col < 2.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 55dae693:
LOLWUT: fix structure typo in comment.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 9b3098b9:
LOLWUT: Fix license copyright year.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 263dbadc:
LOLWUT: increase the translation factor.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit a622f6c0:
LOLWUT: change default size to fit a normal terminal better.
1 file changed, 6 insertions(+), 6 deletions(-)
antirez in commit 38b0d25a:
LOLWUT: wrap it into a proper command.
4 files changed, 40 insertions(+), 15 deletions(-)
antirez in commit 34ebd898:
LOLWUT: draw Schotter by Georg Nees.
1 file changed, 47 insertions(+), 3 deletions(-)
antirez in commit 46286e64:
LOLWUT: draw rotated squares using trivial trigonometry.
1 file changed, 44 insertions(+)
antirez in commit 2d4143fd:
LOLWUT: draw lines using Bresenham algorithm.
1 file changed, 26 insertions(+), 2 deletions(-)
antirez in commit 3546d9ce:
LOLWUT: Rendering of the virtual canvas to a string.
1 file changed, 78 insertions(+), 7 deletions(-)
antirez in commit b404a6ce:
LOLWUT: show the output verbatim in redis-cli.
1 file changed, 1 insertion(+)
antirez in commit e30ba94f:
LOLWUT: canvas structure and BSD license on top.
1 file changed, 46 insertions(+)
antirez in commit 9c771145:
LOLWUT: Emit Braille unicode according to pixel pattern.
1 file changed, 23 insertions(+)
Jakub Vrana in commit 4a1d6c7d:
Slave removal: capitalize Replica
2 files changed, 5 insertions(+), 5 deletions(-)
antirez in commit 72e0368a:
Slave removal: remove slave from integration tests descriptions.
8 files changed, 36 insertions(+), 36 deletions(-)
antirez in commit c7841c2b:
Slave removal: remove slave from top-level tests descriptions.
3 files changed, 12 insertions(+), 12 deletions(-)
antirez in commit 1b9b19ba:
Slave removal: remove slave from object.c.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 7da266e6:
Slave removal: remove slave from the README.
1 file changed, 7 insertions(+), 7 deletions(-)
antirez in commit 93d803c9:
Slave removal: server.c logs fixed.
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit 89434032:
Slave removal: remove slave from sentinel.conf when possible.
1 file changed, 18 insertions(+), 18 deletions(-)
antirez in commit 7673d88d:
Slave removal: replace very few things in Sentinel.
1 file changed, 12 insertions(+), 8 deletions(-)
antirez in commit f1de29b3:
Slave removal: scripting.c logs and other stuff fixed.
1 file changed, 6 insertions(+), 2 deletions(-)
antirez in commit 53fe558e:
Slave removal: replication.c logs fixed.
1 file changed, 35 insertions(+), 35 deletions(-)
antirez in commit c92b02dd:
Slave removal: networking.c logs fixed.
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit be76ed0c:
Slave removal: blocked.c logs fixed.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 3fd73151:
Slave removal: Make obvious in redis.conf what a replica is.
1 file changed, 5 insertions(+)
antirez in commit a22168e4:
Slave removal: slave mode -> replica mode text in redis-cli.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 0e222fbe:
Slave removal: fix typo of replicaof.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 34a5615e:
Slave removal: slave -> replica in redis.conf and output buffer option.
3 files changed, 132 insertions(+), 129 deletions(-)
antirez in commit 1d2fcf6f:
Slave removal: Convert cluster.c log messages and command names.
1 file changed, 12 insertions(+), 11 deletions(-)
antirez in commit 2546158d:
Slave removal: config.c converted + config rewriting hacks.
1 file changed, 117 insertions(+), 38 deletions(-)
antirez in commit c0952c0d:
Slave removal: redis-cli --slave -> --replica.
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit 1f37f1dd:
Slave removal: SLAVEOF -> REPLICAOF. SLAVEOF is now an alias.
3 files changed, 4 insertions(+), 3 deletions(-)
Amin Mesbah in commit 7928f578:
Use geohash limit defines in constraint check
1 file changed, 2 insertions(+), 2 deletions(-)
Jeffrey Lovitz in commit bb2bed78:
CLI Help text loop verifies arg count
1 file changed, 1 insertion(+), 1 deletion(-)
youjiali1995 in commit 246980d0:
sentinel: fix randomized sentinelTimer.
1 file changed, 1 insertion(+), 3 deletions(-)
youjiali1995 in commit fa7de8c4:
bio: fix bioWaitStepOfType.
1 file changed, 3 insertions(+), 3 deletions(-)
Weiliang Li in commit 7642f9d5:
fix usage typo in redis-cli
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0 RC5 Released Thu Sep 06 12:54:29 CEST 2018
================================================================================
Upgrade urgency HIGH: Several imporant bugs fixed.
Hi all,
This is the release candidate number five, and has a lot of bug fixes inside,
together with a few big changes to the Redis behavior from the point of view
of replication of scripts and handling of the maxmemory directive in slaves.
Make sure to read the whole list!
\* BREAKING BEHAVIOR: Slaves now ignore maxmemory by default.
\* BREAKING BEHAVIOR: Now scripts are always replicated for their effects, and
never sending the script itself to slaves/AOF.
\* Improvement: Big pipelining performances improved significantly.
\* Fix: Rewrite BRPOPLPUSH as RPOPLPUSH to propagate.
\* Fix: False positives in tests.
\* Fix: Certain command flags were modified because not correct.
\* Fix: Fix blocking XREAD for streams that are empty.
\* Improvement: Allow scripts to timeout on slaves as well.
\* Fix: Different corner cases due to CLIENT PAUSE are now fixed.
\* Improvement: Optimize parsing large bulk greater than 32k.
\* Fix: Propagate read-only scripts as SCRIPT LOAD, not as EVAL.
The following is the list of commits, so that you can read the details and
check the credits of the commits.
antirez in commit 1d1bf7f0:
Document that effects replication is Redis 5 default.
1 file changed, 8 insertions(+)
antirez in commit cfd969c7:
Fix scripting tests now that we default to commands repl.
1 file changed, 8 insertions(+), 1 deletion(-)
antirez in commit 3e1fb5ff:
Use commands (effects) replication by default in scripts.
3 files changed, 8 insertions(+), 1 deletion(-)
antirez in commit c6c71abe:
Safer script stop condition on OOM.
1 file changed, 5 insertions(+), 2 deletions(-)
antirez in commit dfbce91a:
Propagate read-only scripts as SCRIPT LOAD.
1 file changed, 16 insertions(+), 3 deletions(-)
antirez in commit 1705e42e:
Don't perform eviction when re-entering the event loop.
1 file changed, 7 insertions(+), 2 deletions(-)
antirez in commit a0dd6f82:
Clarify why remaining may be zero in readQueryFromClient().
1 file changed, 2 insertions(+)
zhaozhao.zz in commit 2eed31a5:
networking: fix unexpected negative or zero readlen
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 37fb606c:
Merge branch '5.0' of github.com:/antirez/redis into 5.0
zhaozhao.zz in commit 1898e6ce:
networking: optimize parsing large bulk greater than 32k
1 file changed, 13 insertions(+), 10 deletions(-)
antirez in commit 82fc63d1:
Unblocked clients API refactoring. See #4418.
4 files changed, 33 insertions(+), 15 deletions(-)
zhaozhao.zz in commit 839bb52c:
if master is already unblocked, do not unblock it twice
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 2e1cd82d:
fix multiple unblock for clientsArePaused()
1 file changed, 3 insertions(+), 3 deletions(-)
antirez in commit 17233080:
Make pending buffer processing safe for CLIENT\_MASTER client.
3 files changed, 22 insertions(+), 13 deletions(-)
antirez in commit 42bce87a:
Test: processing of master stream in slave -BUSY state.
1 file changed, 44 insertions(+)
antirez in commit 8bf42f60:
After slave Lua script leaves busy state, re-process the master buffer.
2 files changed, 5 insertions(+), 2 deletions(-)
antirez in commit c2b104c7:
While the slave is busy, just accumulate master input.
2 files changed, 6 insertions(+), 1 deletion(-)
antirez in commit 7b75f4ae:
Allow scripts to timeout even if from the master instance.
1 file changed, 6 insertions(+), 11 deletions(-)
antirez in commit adc4e031:
Allow scripts to timeout on slaves as well.
2 files changed, 10 insertions(+), 3 deletions(-)
dejun.xdj in commit 20ec1f0c:
Revise the comments of latency command.
1 file changed, 2 insertions(+), 1 deletion(-)
Chris Lamb in commit 8e5423eb:
Correct "did not received" -> "did not receive" typos/grammar.
6 files changed, 10 insertions(+), 10 deletions(-)
zhaozhao.zz in commit 395063d7:
remove duplicate bind in sentinel.conf
1 file changed, 10 deletions(-)
Salvatore Sanfilippo in commit b221ca41:
Merge pull request #5300 from SaschaRoland/xread-block-5299
Sascha Roland in commit eea0d3c5:
#5299 Fix blocking XREAD for streams that ran dry
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 4cb9ee11:
Add maxmemory slave behavior change in the change log.
1 file changed, 8 insertions(+)
zhaozhao.zz in commit 5ad888ba:
Supplement to PR #4835, just take info/memory/command as random commands
1 file changed, 3 insertions(+), 3 deletions(-)
zhaozhao.zz in commit d928487f:
some commands' flags should be set correctly, issue #4834
1 file changed, 14 insertions(+), 14 deletions(-)
Oran Agra in commit af675f0a:
Fix unstable tests on slow machines.
3 files changed, 23 insertions(+), 17 deletions(-)
antirez in commit f2cd16be:
Document slave-ignore-maxmemory in redis.conf.
1 file changed, 20 insertions(+)
antirez in commit 02d729b4:
Make slave-ignore-maxmemory configurable.
1 file changed, 9 insertions(+)
antirez in commit 447da44d:
Introduce repl\_slave\_ignore\_maxmemory flag internally.
3 files changed, 7 insertions(+)
antirez in commit 868b2925:
Better variable meaning in processCommand().
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 319f2ee6:
Re-apply rebased #2358.
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 22c166da:
block: format code
1 file changed, 2 insertions(+), 2 deletions(-)
zhaozhao.zz in commit c03c5913:
block: rewrite BRPOPLPUSH as RPOPLPUSH to propagate
3 files changed, 5 insertions(+), 1 deletion(-)
zhaozhao.zz in commit fcd5ef16:
networking: make setProtocolError simple and clear
1 file changed, 11 insertions(+), 13 deletions(-)
zhaozhao.zz in commit 656e4b2f:
networking: just move qb\_pos instead of sdsrange in processInlineBuffer
1 file changed, 2 insertions(+), 3 deletions(-)
zhaozhao.zz in commit 2c7972ce:
networking: just return C\_OK if multibulk processing saw a <= 0 length.
1 file changed, 2 insertions(+), 5 deletions(-)
zhaozhao.zz in commit 1203a04f:
adjust qbuf to 26 in test case for client list
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit aff86fa1:
pipeline: do not sdsrange querybuf unless all commands processed
2 files changed, 48 insertions(+), 40 deletions(-)
Chris Lamb in commit 45a6c5be:
Use SOURCE\_DATE\_EPOCH over unreproducible uname + date calls.
1 file changed, 3 insertions(+)
Chris Lamb in commit 186df148:
Make some defaults explicit in the sentinel.conf for package maintainers
1 file changed, 25 insertions(+)
dejun.xdj in commit b59f04a0:
Streams: ID of xclaim command starts from the sixth argument.
1 file changed, 1 insertion(+), 1 deletion(-)
shenlongxing in commit a3f2437b:
Fix stream command paras
2 files changed, 7 insertions(+), 7 deletions(-)
antirez in commit df911235:
Fix AOF comment to report the current behavior.
1 file changed, 3 insertions(+), 1 deletion(-)
================================================================================
Redis 5.0 RC4 Released Fri Aug 03 13:51:02 CEST 2018
================================================================================
Upgrade urgency
HIGH: Many non critical but important issues fixed.
CRITICAL for Stream users: Many important bugs fixed.
Hi all, welcome to Redis 5.0 RC4.
This release is a huge step forward in Redis 5 maturity and fixes a number
of issues. It also provides interesting improvements. Here I'll summarize
the biggest one, but laster you can find the full list of commits:
Fixes:
\* A number of fixes related to Streams: stability and correctnes.
\* Fix dbRandomKey() potential infinite loop.
\* Improve eviction LFU/LRU when keys are created by INCR commands family.
\* Active defragmentation is now working on Redis 5.
\* Fix corner case in Redis CLuster / Sentinel failover, by resetting the
disconnection time with master in a more appropriate place.
\* Use a private version of localtime() to avoid potential deadlocks.
\* Different redis-cli non critical fixes.
\* Fix rare replication stream corruption with disk-based replication.
Improvements:
\* Sentinel: add an option to deny online script reconfiguration.
\* Improved RESTORE command.
\* Sentinel command renaming: allows to use Sentinel with Redis instances
that have non standard command names.
\* CLIENT ID and CLIENT UNBLOCK.
\* CLIENT LIST now supports a TYPE option.
\* redis-cli --cluster now supports authentication.
\* redis-trib is now deprecated (use redis-cli --cluster).
\* Better slaves output buffers efficiency.
\* Faster INFO when there are many clients connected.
\* Dynamic HZ feature.
\* Improvements in what the MEMORY command is able to report.
\* Add year in log. (WARNING: may be incompatible with log scraping tools)
\* Lazy freeing now works even when values are overwritten (for instance SET).
\* Faster ZADD when elements scores are updated.
\* Improvements to the test suite, including many new options.
antirez in commit a4d1201e:
Test suite: add --loop option.
1 file changed, 12 insertions(+), 5 deletions(-)
antirez in commit 273d8191:
Test suite: new --stop option.
1 file changed, 13 insertions(+), 4 deletions(-)
antirez in commit fbbcc6a6:
Streams IDs parsing refactoring.
1 file changed, 32 insertions(+), 17 deletions(-)
antirez in commit 70c4bcb7:
Test: new sorted set skiplist order consistency.
1 file changed, 26 insertions(+)
antirez in commit 63addc5c:
Fix zslUpdateScore() edge case.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 724740cc:
More commenting of zslUpdateScore().
1 file changed, 2 insertions(+)
antirez in commit ddc87eef:
Explain what's the point of zslUpdateScore() in top comment.
1 file changed, 5 insertions(+)
antirez in commit 741f29ea:
Remove old commented zslUpdateScore() from source.
1 file changed, 13 deletions(-)
antirez in commit 20116836:
Optimize zslUpdateScore() as asked in #5179.
1 file changed, 44 insertions(+)
antirez in commit 8c297e8b:
zsetAdd() refactored adding zslUpdateScore().
1 file changed, 18 insertions(+), 7 deletions(-)
dejun.xdj in commit bd2f3f6b:
Streams: rearrange the usage of '-' and '+' IDs in stream commands.
1 file changed, 13 insertions(+), 13 deletions(-)
dejun.xdj in commit c0c06b84:
Streams: add mmid\_supp argument in streamParseIDOrReply().
1 file changed, 6 insertions(+), 2 deletions(-)
antirez in commit ab237a8e:
Minor improvements to PR #5187.
2 files changed, 13 insertions(+), 6 deletions(-)
Oran Agra in commit 1ce3cf7a:
test suite conveniency improvements
3 files changed, 79 insertions(+), 3 deletions(-)
Oran Agra in commit 36622899:
add DEBUG LOG, to to assist test suite debugging
1 file changed, 4 insertions(+)
antirez in commit 83d4311a:
Cluster cron announce IP minor refactoring.
1 file changed, 6 insertions(+), 3 deletions(-)
shenlongxing in commit a633f8e1:
Fix cluster-announce-ip memory leak
1 file changed, 3 insertions(+), 2 deletions(-)
antirez in commit 24c45538:
Tranfer -> transfer typo fixed.
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit c609f240:
refactor dbOverwrite to make lazyfree work
4 files changed, 27 insertions(+), 12 deletions(-)
antirez in commit 9e971739:
Refactoring: replace low-level checks with writeCommandsDeniedByDiskError().
2 files changed, 6 insertions(+), 13 deletions(-)
antirez in commit 0e77cef0:
Fix writeCommandsDeniedByDiskError() inverted return value.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit acfe9d13:
Better top comment for writeCommandsDeniedByDiskError().
1 file changed, 8 insertions(+), 1 deletion(-)
antirez in commit 4e933e00:
Introduce writeCommandsDeniedByDiskError().
2 files changed, 24 insertions(+)
WuYunlong in commit 41607dfd:
Consider aof write error as well as rdb in lua script.
1 file changed, 14 insertions(+), 4 deletions(-)
Salvatore Sanfilippo in commit 1d073a64:
Merge pull request #5168 from rpv-tomsk/issue-5033
Guy Korland in commit 2db31fd4:
Few typo fixes
1 file changed, 13 insertions(+), 13 deletions(-)
antirez in commit 64242757:
Add year in log.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 50be4a1f:
Document dynamic-hz in the example redis.conf.
1 file changed, 16 insertions(+)
antirez in commit 9a76472d:
Make dynamic hz actually configurable.
1 file changed, 9 insertions(+)
antirez in commit a330d06c:
Control dynamic HZ via server configuration.
2 files changed, 13 insertions(+), 6 deletions(-)
antirez in commit d42602ff:
Dynamic HZ: adapt cron frequency to number of clients.
2 files changed, 17 insertions(+), 5 deletions(-)
antirez in commit 7b5f0223:
Dynamic HZ: separate hz from the configured hz.
3 files changed, 15 insertions(+), 9 deletions(-)
antirez in commit 037b00de:
Remove useless conditional from emptyDb().
1 file changed, 1 deletion(-)
antirez in commit 0e97ae79:
Make emptyDb() change introduced in #4852 simpler to read.
1 file changed, 8 insertions(+), 3 deletions(-)
zhaozhao.zz in commit f7740faf:
optimize flushdb, avoid useless loops
1 file changed, 5 insertions(+), 2 deletions(-)
zhaozhao.zz in commit 0c008376:
Streams: fix xdel memory leak
1 file changed, 1 insertion(+)
antirez in commit dc600a25:
Example the magic +1 in migrateCommand().
1 file changed, 4 insertions(+)
antirez in commit d6827ab6:
Make changes of PR #5154 hopefully simpler.
1 file changed, 10 insertions(+), 5 deletions(-)
WuYunlong in commit 89ec1453:
Do not migrate already expired keys.
1 file changed, 6 insertions(+), 2 deletions(-)
Pavel Rochnyack in commit cd25ed17:
INFO CPU: higher precision of reported values
1 file changed, 8 insertions(+), 8 deletions(-)
antirez in commit 6bfb4745:
Streams: refactoring of next entry seek in the iterator.
1 file changed, 11 insertions(+), 7 deletions(-)
zhaozhao.zz in commit 4724548e:
Streams: skip master fileds only when we are going forward in streamIteratorGetID
1 file changed, 8 insertions(+), 5 deletions(-)
Oran Agra in commit 4b79fdf1:
fix slave buffer test suite false positives
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit a1e081f7:
string2ll(): better commenting.
1 file changed, 6 insertions(+)
dsomeshwar in commit 8b4fe752:
removing redundant check
1 file changed, 3 deletions(-)
antirez in commit 9e5bf047:
Restore string2ll() to original version.
1 file changed, 7 insertions(+), 2 deletions(-)
Oran Agra in commit c2ecdcde:
fix recursion typo in zmalloc\_usable
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 4f742bd6:
string2ll(): remove duplicated check for special case.
1 file changed, 1 insertion(+), 6 deletions(-)
antirez in commit a4efac00:
string2ll(): test for NULL pointer in all the cases.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 2c07c107:
Change 42 to 1000 as warning level for cached scripts.
1 file changed, 3 insertions(+), 3 deletions(-)
Itamar Haber in commit 270903d6:
Adds Lua overheads to MEMORY STATS, smartens the MEMORY DOCTOR
3 files changed, 30 insertions(+), 4 deletions(-)
Itamar Haber in commit faf3dbfc:
Adds memory information about the script's cache to INFO
3 files changed, 12 insertions(+)
antirez in commit 49841a54:
Fix merge errors.
2 files changed, 7 deletions(-)
antirez in commit 77a7ec72:
Merge branch 'unstable' into 5.0 branch
antirez in commit 4ff47a0b:
Top comment clientsCron().
1 file changed, 19 insertions(+), 4 deletions(-)
antirez in commit aba68552:
Clarify that clientsCronTrackExpansiveClients() indexes may jump ahead.
1 file changed, 9 insertions(+), 1 deletion(-)
antirez in commit be88c0b1:
Rename INFO CLIENT max buffers field names for correctness.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 0cf3794e:
Fix wrong array index variable in getExpansiveClientsInfo().
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit ea3a20c5:
Change INFO CLIENTS sections to report pre-computed max/min client buffers.
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit 8f7e496b:
Rename var in clientsCronTrackExpansiveClients() for clarity.
1 file changed, 3 insertions(+), 3 deletions(-)
antirez in commit 8d617596:
Implement a function to retrieve the expansive clients mem usage.
1 file changed, 12 insertions(+)
antirez in commit 85a1b4f8:
clientsCronTrackExpansiveClients() actual implementation.
1 file changed, 14 insertions(+), 1 deletion(-)
antirez in commit d4c5fc57:
clientsCronTrackExpansiveClients() skeleton and ideas.
1 file changed, 23 insertions(+)
antirez in commit 1c95c075:
Make vars used only by INFO CLIENTS local to the block.
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit 16b8d364:
Merge pull request #4727 from kingpeterpaule/redis-fix-info-cli
antirez in commit 0aca977c:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 313b2240:
In addReplyErrorLength() only panic when replying to slave.
1 file changed, 4 insertions(+), 3 deletions(-)
antirez in commit 6183f059:
Refine comment in addReplyErrorLength() about replying to masters/slaves.
1 file changed, 11 insertions(+)
Salvatore Sanfilippo in commit 22e9321c:
Merge pull request #5138 from oranagra/improve\_defrag\_test
Oran Agra in commit f89c93c8:
make active defrag test more stable
2 files changed, 6 insertions(+), 5 deletions(-)
Salvatore Sanfilippo in commit 8213f64d:
Merge pull request #5122 from trevor211/allowWritesWhenAofDisabled
Salvatore Sanfilippo in commit 46fd9278:
Merge pull request #4237 from aspirewit/update-comment
antirez in commit 6201f7b4:
Streams: better error when $ is given with XREADGROUP.
1 file changed, 5 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit 4bff45c7:
Merge pull request #5136 from 0xtonyxia/fix-xread-id-parse
antirez in commit afc7e08a:
Panic when we are sending an error to our master/slave.
1 file changed, 5 insertions(+)
Salvatore Sanfilippo in commit e03358c0:
Merge pull request #5135 from oranagra/rare\_repl\_corruption
dejun.xdj in commit 846cf12a:
Streams: remove meaningless if condition.
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit 6501b6bb:
Streams: return an error message if using xreadgroup with '$' ID.
1 file changed, 5 insertions(+)
Oran Agra in commit d5559898:
fix rare replication stream corruption with disk-based replication
3 files changed, 18 insertions(+), 9 deletions(-)
antirez in commit cefe21d2:
dict.c: remove a few trailing spaces.
1 file changed, 2 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit 4fc20992:
Merge pull request #5128 from kingpeterpaule/remove-one-loop-in-freeMemoryIfNeeded
Salvatore Sanfilippo in commit 9fbd49bb:
Merge pull request #5113 from 0xtonyxia/using-compare-func-instead
Salvatore Sanfilippo in commit cab39676:
Merge pull request #5127 from oranagra/sds\_req\_type
antirez in commit f9c84d6d:
Hopefully improve commenting of #5126.
2 files changed, 22 insertions(+), 10 deletions(-)
Salvatore Sanfilippo in commit e22a1218:
Merge pull request #5126 from oranagra/slave\_buf\_memory\_2
Salvatore Sanfilippo in commit 28dd8dd1:
Merge pull request #5132 from soloestoy/propagate-xdel-correctly
Oran Agra in commit bf680b6f:
slave buffers were wasteful and incorrectly counted causing eviction
10 files changed, 182 insertions(+), 50 deletions(-)
zhaozhao.zz in commit 73306c6f:
Streams: correctly propagate xdel if needed
1 file changed, 7 insertions(+), 3 deletions(-)
antirez in commit 103c5a1a:
Add a few comments to streamIteratorRemoveEntry().
1 file changed, 4 insertions(+)
Salvatore Sanfilippo in commit a317f55d:
Merge pull request #5131 from soloestoy/optimize-xdel
antirez in commit 185e0d9c:
Modify XINFO field from last-id to last-generated-id.
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit 4215e74b:
Merge pull request #5129 from soloestoy/xinfo-show-last-id
zhaozhao.zz in commit c9324f81:
Streams: free lp if all elements are deleted
1 file changed, 9 insertions(+), 4 deletions(-)
paule in commit b6ce7d5d:
Update dict.c
1 file changed, 4 insertions(+), 2 deletions(-)
zhaozhao.zz in commit b4ba5ac8:
Streams: show last id for streams and groups
1 file changed, 6 insertions(+), 2 deletions(-)
peterpaule in commit 816fc6cb:
remove one ineffective loop in dictGetSomeKeys.
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit b05a22e2:
bugfix in sdsReqType creating 64bit sds headers on 32bit systems
1 file changed, 3 insertions(+), 1 deletion(-)
dejun.xdj in commit 491682a6:
Streams: using streamCompareID() instead of direct compare in block.c.
1 file changed, 1 insertion(+), 4 deletions(-)
dejun.xdj in commit a2177cd2:
Streams: add streamCompareID() declaration in stream.h.
1 file changed, 1 insertion(+)
dejun.xdj in commit 0484dbcf:
Streams: using streamCompareID() instead of direct compare.
1 file changed, 2 insertions(+), 6 deletions(-)
WuYunlong in commit 2d4366c5:
Accept write commands if persisting is disabled, event if we do have problems persisting on disk previously.
1 file changed, 2 insertions(+), 1 deletion(-)
Salvatore Sanfilippo in commit ab33bcd3:
Merge pull request #5120 from andrewsensus/leap-year-comment-patch-1
antirez in commit 2352a519:
Test: XDEL fuzz testing. Remove and check stage.
1 file changed, 15 insertions(+)
antirez in commit 3d7d20b7:
Test: fix lshuffle by providing the "K" combinator.
1 file changed, 2 insertions(+)
antirez in commit 967ad364:
Test: add lshuffle in the Tcl utility functions set.
1 file changed, 14 insertions(+)
antirez in commit d6efd5fc:
Test: XDEL fuzz testing, stream creation.
1 file changed, 20 insertions(+)
andrewsensus in commit 8dc08ae2:
update leap year comment
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 69997153:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit a93f8f09:
Test: XDEL basic test.
1 file changed, 12 insertions(+)
Salvatore Sanfilippo in commit a44a5934:
Merge pull request #5119 from trevor211/fixSlowlogConfig
WuYunlong in commit d6ba4fd5:
Fix config set slowlog-log-slower-than and condition in createLatencyReport
2 files changed, 2 insertions(+), 2 deletions(-)
WuYunlong in commit b3660be8:
Add test in slowlog.tcl
1 file changed, 10 insertions(+)
artix in commit d4182a0a:
Cluster Manager: more checks on --cluster-weight option.
1 file changed, 12 insertions(+), 2 deletions(-)
artix in commit d222eda9:
Redis-trib deprecated: it no longer works and it outputs a warning to the user.
1 file changed, 103 insertions(+), 1804 deletions(-)
artix in commit 513eb572:
Cluster Manager: auth support (-a argument).
1 file changed, 41 insertions(+), 19 deletions(-)
Salvatore Sanfilippo in commit f3980bb9:
Merge pull request #5115 from shenlongxing/patch-1
Shen Longxing in commit c2a85fb3:
Delete unused role checking.
1 file changed, 2 insertions(+), 6 deletions(-)
Salvatore Sanfilippo in commit 4cb5bd4e:
Merge pull request #4820 from charpty/wip-serverc-simplify
antirez in commit 8d6b7861:
Add regression test for #5111.
1 file changed, 15 insertions(+)
antirez in commit b6260a02:
Streams: when re-delivering because of SETID, reset deliveries counter.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit a7c180e5:
Simplify duplicated NACK #5112 fix.
1 file changed, 18 insertions(+), 21 deletions(-)
Salvatore Sanfilippo in commit bf4def0f:
Merge pull request #5112 from 0xtonyxia/fix-xreadgroup-crash-after-setid
Salvatore Sanfilippo in commit 16770551:
Merge pull request #5114 from oranagra/defrag\_32
Oran Agra in commit 920158ec:
Active defrag fixes for 32bit builds (again)
1 file changed, 2 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit f45e7901:
Merge pull request #4967 from JingchengLi/unstable
tengfeng in commit 9505dd20:
fix repeat argument issue and reduce unnessary loop times for redis-cli.
1 file changed, 12 insertions(+), 7 deletions(-)
antirez in commit 0420c327:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 28e95c7c:
Streams: fix typo "consumer".
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit a8c1bb31:
Streams: fix new XREADGROUP sync logic.
1 file changed, 13 insertions(+), 3 deletions(-)
antirez in commit 1a02b5f6:
Streams: make blocking for > a truly special case.
1 file changed, 29 insertions(+), 4 deletions(-)
antirez in commit a71e8148:
Streams: send an error to consumers blocked on non-existing group.
1 file changed, 5 insertions(+), 1 deletion(-)
antirez in commit 09327f11:
Streams: fix unblocking logic into a consumer group.
1 file changed, 24 insertions(+), 14 deletions(-)
dejun.xdj in commit 3f8a3efe:
Streams: fix xreadgroup crash after xgroup SETID is sent.
1 file changed, 20 insertions(+), 15 deletions(-)
Salvatore Sanfilippo in commit 7239e9ca:
Merge pull request #5095 from 0xtonyxia/fix-indentation
dejun.xdj in commit 61f12973:
Bugfix: PEL is incorrect when consumer is blocked using xreadgroup with NOACK option.
4 files changed, 6 insertions(+), 1 deletion(-)
antirez in commit b67f0276:
redis-cli: fix #4990 additional argument in help.
1 file changed, 1 insertion(+)
antirez in commit 18d65849:
redis-cli: fix #5096 double error message.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 84620327:
redis-cli: cliConnect() flags CC\_FORCE and CC\_QUIET.
1 file changed, 23 insertions(+), 13 deletions(-)
Amit Dey in commit a3a5a25f:
fixing broken link in CONTRIBUTING
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit 289d8d9c:
CLIENT UNBLOCK: fix client unblock help message.
1 file changed, 1 insertion(+), 1 deletion(-)
minkikim89 in commit 62a4a8c1:
fix whitespace in redis-cli.c
1 file changed, 362 insertions(+), 362 deletions(-)
WuYunlong in commit 0a5805d7:
fix compile warning in addReplySubcommandSyntaxError
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit cb78c842:
Use nolocks\_localtime() for safer logging.
2 files changed, 8 insertions(+), 2 deletions(-)
antirez in commit 81778d91:
Cache timezone and daylight active flag for safer logging.
2 files changed, 14 insertions(+), 1 deletion(-)
antirez in commit 18d8205b:
Localtime: clarify is\_leap\_year() working with comments.
1 file changed, 4 insertions(+), 4 deletions(-)
antirez in commit 29644144:
Localtime: fix comment about leap year.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 0ea39aa4:
Localtime: fix daylight saving adjustment. Use \* not +.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 6614d305:
Localtime: fix daylight time documentation and computation.
1 file changed, 14 insertions(+), 4 deletions(-)
dejun.xdj in commit 46f5a2ca:
Fix indentation.
2 files changed, 14 insertions(+), 14 deletions(-)
antirez in commit 243c5a7a:
Localtime: add a test main() function to check the output.
1 file changed, 15 insertions(+), 1 deletion(-)
antirez in commit c25ee35a:
Localtime: day of month is 1 based. Convert from 0 based "days".
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit b9f33830:
Localtime: fix timezone adjustment.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 0c12cbed:
Localtime: compute year, month and day of the month.
1 file changed, 26 insertions(+)
antirez in commit 06ca400f:
Localtime: basics initial calculations. Year missing.
1 file changed, 30 insertions(+), 2 deletions(-)
antirez in commit 6a529067:
Localtime function skeleton and file added.
1 file changed, 44 insertions(+)
Jack Drogon in commit 93238575:
Fix typo
40 files changed, 99 insertions(+), 99 deletions(-)
antirez in commit 94b3ee61:
Clarify the pending\_querybuf field of clients.
1 file changed, 4 insertions(+), 3 deletions(-)
antirez in commit 549b8b99:
Improve style of PR #5084.
1 file changed, 8 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit 526b30a7:
Merge pull request #5084 from chendq8/pending-querybuf
antirez in commit 677d10b2:
Set repl\_down\_since to zero on state change.
1 file changed, 2 insertions(+), 1 deletion(-)
Salvatore Sanfilippo in commit 02e38516:
Merge pull request #5081 from trevor211/fixClusterFailover
chendianqiang in commit cbb2ac07:
Merge branch 'unstable' into pending-querybuf
antirez in commit 2edcafb3:
addReplySubSyntaxError() renamed to addReplySubcommandSyntaxError().
12 files changed, 14 insertions(+), 14 deletions(-)
Salvatore Sanfilippo in commit bc6a0045:
Merge pull request #4998 from itamarhaber/module\_command\_help
Salvatore Sanfilippo in commit ee09b5ed:
Merge pull request #5071 from akshaynagpal/patch-2
Salvatore Sanfilippo in commit f03ad962:
Merge pull request #5068 from shenlongxing/fix-rename-command
Salvatore Sanfilippo in commit e4881cd0:
Merge pull request #5090 from trevor211/test\_helper\_tcl
WuYunlong in commit 2833cfbe:
fix tests/test\_helper.tcl with --wait-server option. Issue #5063 added --wait-server option, but can not work.
1 file changed, 1 deletion(-)
chendianqiang in commit 7de1ada0:
limit the size of pending-querybuf in masterclient
4 files changed, 48 insertions(+)
WuYunlong in commit 2e167f7d:
fix server.repl\_down\_since resetting, so that slaves could failover automatically as expected.
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit aeb7bc3e:
cluster.tcl: Add master consecutively down test.
1 file changed, 77 insertions(+)
antirez in commit d751d98b:
Change CLIENT LIST TYPE help string.
1 file changed, 2 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit a0b05a04:
Merge pull request #5075 from soloestoy/client-list-types
Salvatore Sanfilippo in commit aa2c390e:
Merge pull request #5074 from soloestoy/fix-compile-warning
Salvatore Sanfilippo in commit a4ef94d2:
Merge pull request #5076 from 0xtonyxia/add-no-auth-warning-option
dejun.xdj in commit 9f185626:
Check if password is used on command line interface.
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit 1139070a:
Fix trailing white space.
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit bbd0ca95:
Fix code format issue.
1 file changed, 4 insertions(+), 4 deletions(-)
dejun.xdj in commit 7becf54e:
Don't output password warning message when --no-auth-warning is used.
1 file changed, 10 insertions(+), 1 deletion(-)
dejun.xdj in commit bde05e9c:
Avoid -Woverlength-strings compile warning.
1 file changed, 5 insertions(+), 3 deletions(-)
antirez in commit 5baf50d8:
Rax library updated (node callback).
2 files changed, 19 insertions(+), 5 deletions(-)
dejun.xdj in commit 0b74fd67:
Add --no-auth-warning help message.
1 file changed, 2 insertions(+)
zhaozhao.zz in commit b9cbd04b:
clients: add type option for client list
4 files changed, 20 insertions(+), 6 deletions(-)
zhaozhao.zz in commit f5538642:
clients: show pubsub flag in client list
1 file changed, 1 insertion(+)
zhaozhao.zz in commit 1fcf2737:
fix some compile warnings
2 files changed, 2 insertions(+), 2 deletions(-)
Akshay Nagpal in commit 007e3cbd:
Added link to Google Group
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit ab55f9da:
Make CLIENT HELP output nicer to the eyes.
1 file changed, 11 insertions(+), 11 deletions(-)
antirez in commit 75f1a7bd:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 4a70ff74:
Add unblock in CLIENT HELP.
1 file changed, 1 insertion(+)
shenlongxing in commit 3c27db1c:
fix empty string for sentinel rename-command
1 file changed, 5 insertions(+)
Salvatore Sanfilippo in commit f7b21bc7:
Merge pull request #5066 from oranagra/defrag\_jemalloc5\_fix
Salvatore Sanfilippo in commit 730a4cfa:
Merge pull request #5067 from mpaltun/mpaltun-doc-fix
antirez in commit 2214043b:
CLIENT UNBLOCK: support unblocking by error.
1 file changed, 22 insertions(+), 3 deletions(-)
Mustafa Paltun in commit 010dc172:
Update t\_stream.c
1 file changed, 2 insertions(+), 2 deletions(-)
Mustafa Paltun in commit 6d0acb33:
Update help.h
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit de495ee7:
minor fix in creating a stream NACK for rdb and defrag tests
2 files changed, 2 insertions(+), 2 deletions(-)
antirez in commit 71295ee3:
CLIENT UNBLOCK implemented.
1 file changed, 22 insertions(+)
antirez in commit fb39bfd7:
Take clients in a ID -> Client handle dictionary.
3 files changed, 6 insertions(+)
antirez in commit ed65d734:
CLIENT ID implemented.
1 file changed, 4 insertions(+)
Salvatore Sanfilippo in commit 345b4809:
Merge pull request #5063 from oranagra/test\_suite\_improvements
Salvatore Sanfilippo in commit 35c5f3fa:
Merge pull request #5065 from oranagra/defrag\_jemalloc5
Oran Agra in commit 5616d4c6:
add active defrag support for streams
6 files changed, 230 insertions(+), 25 deletions(-)
Oran Agra in commit e8099cab:
add defrag hint support into jemalloc 5
3 files changed, 43 insertions(+)
Oran Agra in commit 751eea24:
test suite infra improvements and fix
2 files changed, 19 insertions(+)
Salvatore Sanfilippo in commit bb666d44:
Merge pull request #5027 from tigertv/unstable
antirez in commit b9058c73:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 43831779:
Sentinel: test command renaming feature.
1 file changed, 10 insertions(+)
Salvatore Sanfilippo in commit eb052ba9:
Merge pull request #5059 from guybe7/fix\_restore\_warning
antirez in commit 27178a3f:
Fix type of argslen in sendSynchronousCommand().
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1f1e724f:
Remove black space.
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit aa5eaad4:
Merge pull request #5037 from madolson/repl-auth-fix
antirez in commit 3cf8dd2c:
Sentinel: fix SENTINEL SET error reporting.
1 file changed, 18 insertions(+), 9 deletions(-)
Madelyn Olson in commit 45731edc:
Addressed comments
1 file changed, 1 insertion(+), 1 deletion(-)
Madelyn Olson in commit e8d68b6b:
Fixed replication authentication with whitespace in password
1 file changed, 12 insertions(+), 5 deletions(-)
antirez in commit fc0c9c80:
Sentinel: drop the renamed-command entry in a more natural way.
1 file changed, 4 insertions(+), 7 deletions(-)
antirez in commit 8ba670f5:
Sentinel command renaming: document it into sentinel.conf.
1 file changed, 19 insertions(+)
antirez in commit a8a76bda:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 2358de68:
Sentinel command renaming: use case sensitive hashing for the dict.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit a9c50088:
Sentinel command renaming: fix CONFIG SET event logging.
1 file changed, 17 insertions(+), 1 deletion(-)
antirez in commit b72cecd7:
Sentinel command renaming: fix CONFIG SET after refactoring.
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit 91a384a5:
Sentinel command renaming: implement SENTINEL SET.
1 file changed, 19 insertions(+)
antirez in commit 903582dd:
Sentinel: make SENTINEL SET able to handle different arities.
1 file changed, 19 insertions(+), 12 deletions(-)
antirez in commit c303e768:
Sentinel command renaming: config rewriting.
1 file changed, 12 insertions(+)
antirez in commit 60df7dbe:
Sentinel command renaming: rename-command option parsing.
1 file changed, 11 insertions(+)
antirez in commit 72e8a33b:
Sentinel command renaming: base machanism implemented.
1 file changed, 64 insertions(+), 15 deletions(-)
Guy Benoish in commit dfcc20f4:
Fix compiler warning in restoreCommand
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit cf7fcdbe:
Merge pull request #4634 from soloestoy/special-auth
Salvatore Sanfilippo in commit 70b7fa2c:
Merge pull request #5049 from youjiali1995/fix-load-rdb
Salvatore Sanfilippo in commit 54d66d39:
Merge pull request #5053 from michael-grunder/zpopminmax-keypos
Salvatore Sanfilippo in commit 199e704a:
Merge pull request #5050 from shenlongxing/fix-typo
michael-grunder in commit db6b99f9:
Update ZPOPMIN/ZPOPMAX command declaration
1 file changed, 2 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit a16aa03a:
Merge pull request #5051 from oranagra/streams\_mem\_estimate
Oran Agra in commit 20e10dc7:
fix streams memory estimation, missing raxSeek
1 file changed, 2 insertions(+), 1 deletion(-)
shenlongxing in commit ec55df11:
fix typo
4 files changed, 4 insertions(+), 4 deletions(-)
youjiali1995 in commit df6644fe:
Fix rdbLoadIntegerObject() to create shared objects when needed.
1 file changed, 1 insertion(+), 1 deletion(-)
Salvatore Sanfilippo in commit 1527bcad:
Merge pull request #5036 from bepahol/unstable
Salvatore Sanfilippo in commit c1e82405:
Merge pull request #5039 from oranagra/rdb\_dbsize\_hint
Salvatore Sanfilippo in commit 79f55eed:
Merge pull request #5040 from oranagra/memrev64ifbe\_fix
Salvatore Sanfilippo in commit c6f4118c:
Merge pull request #5045 from guybe7/restore\_fix
Guy Benoish in commit b5197f1f:
Enhance RESTORE with RDBv9 new features
5 files changed, 100 insertions(+), 22 deletions(-)
Salvatore Sanfilippo in commit c6fdebf5:
Merge pull request #5042 from oranagra/malloc\_usable\_size\_libc
Oran Agra in commit 482785ac:
add malloc\_usable\_size for libc malloc
2 files changed, 8 insertions(+), 3 deletions(-)
Salvatore Sanfilippo in commit 4da29630:
Merge pull request #5023 from FX-HAO/unstable
antirez in commit e7219025:
Test RDB stream encoding saving/loading.
1 file changed, 17 insertions(+)
Salvatore Sanfilippo in commit 5f5e1199:
Merge pull request #5041 from oranagra/redis-rdb-check\_rdbLoadMillisecondTime
antirez in commit 4848fbec:
Modules: convert hash to hash table for big objects.
1 file changed, 3 insertions(+)
Oran Agra in commit f31b0405:
fix redis-rdb-check to provide proper arguments to rdbLoadMillisecondTime
2 files changed, 3 insertions(+), 2 deletions(-)
antirez in commit 333c98c4:
AOF: remove no longer used variable "now".
1 file changed, 1 deletion(-)
antirez in commit e94b2053:
Modify clusterRedirectClient() to handle ZPOP and XREAD.
1 file changed, 5 insertions(+), 1 deletion(-)
Oran Agra in commit 26229aa6:
use safe macro (non empty) in memrev64ifbe to eliminate empty if warning
1 file changed, 3 insertions(+), 3 deletions(-)
Oran Agra in commit 5cd3c952:
64 bit RDB\_OPCODE\_RESIZEDB in rdb saving
1 file changed, 3 insertions(+), 7 deletions(-)
antirez in commit ba92b517:
Remove AOF optimization to skip expired keys.
1 file changed, 3 deletions(-)
Benjamin Holst in commit 36524060:
Update README.md
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 44571088:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit 6967d0bd:
Revert fix #4976 just leaving the flush() part.
1 file changed, 1 insertion(+), 5 deletions(-)
antirez in commit 0ed0dc3c:
Fix incrDecrCommand() to create shared objects when needed.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit bd92389c:
Refactor createObjectFromLongLong() to be suitable for value objects.
2 files changed, 33 insertions(+), 2 deletions(-)
Salvatore Sanfilippo in commit 3518bb66:
Merge pull request #5020 from shenlongxing/fix-config
antirez in commit 20766608:
Streams: fix xreadGetKeys() for correctness.
1 file changed, 19 insertions(+), 5 deletions(-)
Salvatore Sanfilippo in commit e670ccff:
Merge pull request #4857 from youjiali1995/fix-command-getkeys
antirez in commit a0b27dae:
Streams: fix xreadGetKeys() buffer overflow.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 62f9ac6f:
Streams: Change XADD MAXLEN handling of values <= 0.
1 file changed, 3 insertions(+), 3 deletions(-)
Max Vetrov in commit d4c4f20a:
Update sort.c
1 file changed, 1 insertion(+), 3 deletions(-)
antirez in commit 79a1c19a:
XADD MAXLEN should return an error for values < 0.
1 file changed, 5 insertions(+)
Salvatore Sanfilippo in commit 2e0ab4a8:
Merge pull request #4976 from trevor211/fixDebugLoadaof
Salvatore Sanfilippo in commit 94658303:
Merge pull request #4758 from soloestoy/rdb-save-incremental-fsync
antirez in commit 6a66b93b:
Sentinel: add an option to deny online script reconfiguration.
2 files changed, 41 insertions(+)
antirez in commit d353023a:
Merge branch 'unstable' of github.com:/antirez/redis into unstable
antirez in commit d6e8fe77:
Fix infinite loop in dbRandomKey().
1 file changed, 13 insertions(+)
Salvatore Sanfilippo in commit 40d5df65:
Merge pull request #5008 from zwkno1/unstable
Salvatore Sanfilippo in commit 8bc3ffcb:
Merge pull request #5021 from soloestoy/fix-exists
Salvatore Sanfilippo in commit 6c7847a1:
Merge pull request #5018 from soloestoy/optimize-reply
antirez in commit 1e92fde3:
Fix SCAN bug regression test, avoiding empty SREM call.
1 file changed, 1 insertion(+), 1 deletion(-)
Fuxin Hao in commit a4f658b2:
Fix update\_zmalloc\_stat\_alloc in zrealloc
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0 RC3 Released Wed Jun 14 9:51:44 CEST 2018
================================================================================
Upgrade urgency LOW:
This release fixes compilation of Redis RC2. For an error the commit from unstable
updating the Rax library was not merged into the 5.0 branch.
================================================================================
Redis 5.0 RC2 Released Wed Jun 13 12:49:13 CEST 2018
================================================================================
Upgrade urgency CRITICAL: This release fixes important security issues.
HIGH: This release fixes a SCAN commands family bug.
MODERATE: This release fixes a PSYNC2 edge case with expires.
MODERATE: Sentinel related fixes.
LOW: All the other issues
NOTE: This release breaks API compatibility with certain APIs that were
introduced in Redis 5.0 RC1. Notably ZPOP\* now returns score/element in reverse
order. XINFO  special form was removed, now XINFO STREAM  must be
used to obtain general information about the stream.
Redis 5.0 RC2 ixes a number of important issues:
\* Important security issues related to the Lua scripting engine.
Please check https://github.com/antirez/redis/issues/5017
for more information.
\* A bug with SCAN, SSCAN, HSCAN and ZSCAN, that may not return all the elements.
We also add a regression test that can trigger the issue often when present, and
may in theory be able to find unrelated regressions.
\* A PSYNC2 bug is fixed: Redis should not expire keys when saving RDB files
because otherwise it is no longer possible to use such RDB file as a base
for partial resynchronization. It no longer represents the right state.
\* Compatibility of AOF with RDB preamble when the RDB checksum is disabled.
\* Sentinel bug that in some cases prevented Sentinel to detect that the master
was down immediately. A delay was added to the detection.
\* XREADGROUP would crash when the master had attacked slaves.
\* Replication and events generation of several streams command were fixed.
\* XREVRANGE fixed, in some cases it could not return elements, or crash the
server, or in general not behave correctly.
\* ZPOP can now unblock multiple clients in a sane way.
\* Other minor issues.
Moreover this release adds new features:
\* XGROUP DESTROY and XGROUP SETID.
\* RDB loading speedup.
\* Configurable stream macro node limits (number of elements / bytes).
\* More smaller improvements.
The following is the list of commits composing the release, please check
the commit messages and authors for credits.
antirez in commit 9fdcc159:
Security: fix redis-cli buffer overflow.
1 file changed, 16 insertions(+), 11 deletions(-)
antirez in commit cf760071:
Security: fix Lua struct package offset handling.
1 file changed, 6 insertions(+), 2 deletions(-)
antirez in commit a57595ca:
Security: more cmsgpack fixes by @soloestoy.
1 file changed, 7 insertions(+)
antirez in commit 8783fb94:
Security: update Lua struct package for security.
1 file changed, 23 insertions(+), 23 deletions(-)
antirez in commit 8cb9344b:
Security: fix Lua cmsgpack library stack overflow.
1 file changed, 3 insertions(+)
赵磊 in commit 59080f60:
Fix dictScan(): It can't scan all buckets when dict is shrinking.
1 file changed, 14 insertions(+), 11 deletions(-)
dejun.xdj in commit ac2a824a:
Fix redis-cli memory leak when sending set preference command.
1 file changed, 2 insertions(+)
dejun.xdj in commit c7197ff5:
Check if the repeat value is positive in while loop of cliSendCommand().
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit 3f77777f:
Change the type of repeat argument to long for function cliSendCommand.
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit 7a565d72:
Fix negtive repeat command value issue.
1 file changed, 11 insertions(+), 3 deletions(-)
dejun.xdj in commit 64bf60fb:
Detect and stop saving history for auth command with repeat option.
1 file changed, 17 insertions(+), 10 deletions(-)
dejun.xdj in commit 5bed12aa:
Change the warning message a little bit to avoid trademark issuses.
1 file changed, 1 insertion(+), 1 deletion(-)
dejun.xdj in commit d71c4961:
Stop saving auth command in redis-cli history.
1 file changed, 4 insertions(+), 2 deletions(-)
dejun.xdj in commit fca99e41:
Add warning message when using password on command line
1 file changed, 1 insertion(+)
antirez in commit 01407a3a:
Don't expire keys while loading RDB from AOF preamble.
3 files changed, 5 insertions(+), 5 deletions(-)
WuYunlong in commit fb5408cf:
Fix rdb save by allowing dumping of expire keys, so that when we add a new slave, and do a failover, eighter by manual or not, other local slaves will delete the expired keys properly.
2 files changed, 3 insertions(+), 7 deletions(-)
antirez in commit 0b8b6df4:
Backport hiredis issue 525 fix to compile on FreeBSD.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit e98627c5:
Add INIT INFO to the provided init script.
1 file changed, 8 insertions(+)
antirez in commit 17f5de89:
Fix ae.c when a timer finalizerProc adds an event.
2 files changed, 10 insertions(+), 6 deletions(-)
antirez in commit 266e6423:
Sentinel: fix delay in detecting ODOWN.
1 file changed, 9 insertions(+), 5 deletions(-)
zhaozhao.zz in commit eafaf172:
AOF & RDB: be compatible with rdbchecksum no
1 file changed, 9 insertions(+), 7 deletions(-)
huijing.whj in commit 4630da37:
fix int overflow problem in freeMemoryIfNeeded
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 5.0 RC1 Released Tue May 29 14:14:11 CEST 2018
================================================================================
Upgrade urgency LOW: This is the first RC of Redis 5.
Introduction to the Redis 5 release
===================================
Redis 5 is a release focused on a few important features. While Redis 4
was very very focused on operations, Redis 5 changes are mostly user-facing,
with the implementation of new data types and operations on top of existing
types. The following are the major features of this release:
1. The new Stream data type. https://redis.io/topics/streams-intro
2. New Redis modules APIs: Timers, Cluster and Dictionary APIs.
3. RDB now store LFU and LRU information.
4. The cluster manager was ported from Ruby (redis-trib.rb) to C code
inside redis-cli. Check `redis-cli --cluster help` for more info.
5. New sorted set commands: ZPOPMIN/MAX and blocking variants.
6. Active defragmentation version 2.
7. Improvemenets in HyperLogLog implementations.
8. Better memory reporting capabilities.
9. Many commands with sub-commands now have an HELP subcommand.
10. Better performances when clients connect and disconnect often.
11. Many bug fixes and other random improvements.
12. Jemalloc was upgraded to version 5.1
13. CLIENT UNBLOCK and CLIENT ID.
14. The LOLWUT command was added. http://antirez.com/news/123
15. We no longer use the "slave" word if not for API backward compatibility.
16. Differnet optimizations in the networking layer.
17. Lua improvements:
- Better propagation of Lua scripts to slaves / AOF.
- Lua scripts can now timeout and get in -BUSY state in the slave as well.
18. Dynamic HZ to balance idle CPU usage with responsiveness.
19. The Redis core was refactored and improved in many ways.
Thanks to all the users and developers who made this release possible.
We'll follow up with more RC releases, until the code looks production ready
and we don't get reports of serious issues for a while.
A special thank you for the amount of work put into this release
(in decreasing number of commits) by:
Fabio Nicotra,
Soloestoy
Itamar Haber
Oran Agra
Dvir Volk
dejun.xdj
Guy Benoish
Charsyam
Otmar Ertl
Jan-Erik Rediger
Spinlock
Migrating from 4.0 to 5.0
=========================
Redis 4.0 is mostly a strict subset of 5.0, you should not have any problem
upgrading your application from 4.0 to 5.0. However this is a list of small
non-backward compatible changes introduced in the 5.0 release:
\* redis-cli now implements the cluster management tool. We still ship the
old redis-trib, but new fixes will be implemented only in redis-cli.
See `redis-cli --cluster help` for more info.
\* The RDB format changed. Redis 5.0 is still able to read 4.0 (and all the
past versions) files, but not the other way around.
\* Certain log formats and sentences are different in Redis 5.0.
\* Now by default maxmemory is ignored by slaves, and used only once a slave
is promoted to master. It means that in setups where you want slaves to
enforce maxmemory in an independent way from the master (that will anyway
stream the key eviction DEL commands), you should active this feature manually
and make sure you understand that it breaks consistency if writes are not
always idempotent. TLDR: the new behavior is much better for 99.999% of use
cases, revert it if you really know what you are doing.
\* Scripts are only replicated by their \*effects\* and not by sending EVAL/EVALSHA
to slaves or the AOF log itself. This is much better in the general case
and in the future we want to totally remove the other possiblity of
propagating scripts the old way (as EVAL). However you can still turn this
back to the default via the non-documented (if not here) Redis configuration
directive "lua-replicate-commands yes" or
"DEBUG lua-always-replicate-commands 0". However note that Redis 6 may
completely remove such feature.
\* Because of the above change related to scripts replication, certain Redis
commands that in Redis 4 had their result ordered lexicographically before
being passed to Lua via the return value of redis.call(), now have a behavior
more similar to calling the commands directly from a normal client. For
instance the ordering of elements returned by SMEMBERS or SDIFF is now
undetermined in Lua, exactly as it is by default when calling the commands
from a non-scripting context.
--------------------------------------------------------------------------------
Credits: For each release, a list of changes with the relative author is
provided. Where not specified the implementation and design is done by
Salvatore Sanfilippo. Thanks to Redis Labs for making all this possible.
Also many thanks to all the other contributors and the amazing community
we have.
Commit messages may contain additional credits.
Enjoy,
Salvatore


=== Content from raw.githubusercontent.com_8babbc78_20250115_135836.html ===
Redis 6.0 release notes
=======================
--------------------------------------------------------------------------------
Upgrade urgency levels:
LOW: No need to upgrade unless there are new features you want to use.
MODERATE: Program an upgrade of the server, but it's not urgent.
HIGH: There is a critical bug that may affect a subset of users. Upgrade!
CRITICAL: There is a critical bug affecting MOST USERS. Upgrade ASAP.
SECURITY: There are security fixes in the release.
--------------------------------------------------------------------------------
================================================================================
Redis 6.0.9 Released Mon Oct 26 10:37:47 IST 2020
================================================================================
Upgrade urgency: SECURITY if you use an affected platform (see below).
Otherwise the upgrade urgency is MODERATE.
This release fixes a potential heap overflow when using a heap allocator other
than jemalloc or glibc's malloc. See:
https://github.com/redis/redis/pull/7963
Other fixes in this release:
New:
\* Memory reporting of clients argv (#7874)
\* Add redis-cli control on raw format line delimiter (#7841)
\* Add redis-cli support for rediss:// -u prefix (#7900)
\* Get rss size support for NetBSD and DragonFlyBSD
Behavior changes:
\* WATCH no longer ignores keys which have expired for MULTI/EXEC (#7920)
\* Correct OBJECT ENCODING response for stream type (#7797)
\* Allow blocked XREAD on a cluster replica (#7881)
\* TLS: Do not require CA config if not used (#7862)
Bug fixes:
\* INFO report real peak memory (before eviction) (#7894)
\* Allow requirepass config to clear the password (#7899)
\* Fix config rewrite file handling to make it really atomic (#7824)
\* Fix excessive categories being displayed from ACLs (#7889)
\* Add fsync in replica when full RDB payload was received (#7839)
\* Don't write replies to socket when output buffer limit reached (#7202)
\* Fix redis-check-rdb support for modules aux data (#7826)
\* Other smaller bug fixes
Modules API:
\* Add APIs for version and compatibility checks (#7865)
\* Add RM\_GetClientCertificate (#7866)
\* Add RM\_GetDetachedThreadSafeContext (#7886)
\* Add RM\_GetCommandKeys (#7884)
\* Add Swapdb Module Event (#7804)
\* RM\_GetContextFlags provides indication of being in a fork child (#7783)
\* RM\_GetContextFlags document missing flags: MULTI\_DIRTY, IS\_CHILD (#7821)
\* Expose real client on connection events (#7867)
\* Minor improvements to module blocked on keys (#7903)
Full list of commits:
Yossi Gottlieb in commit ce0d74d8f:
Fix wrong zmalloc\_size() assumption. (#7963)
1 file changed, 3 deletions(-)
Oran Agra in commit d3ef26822:
Attempt to fix sporadic test failures due to wait\_for\_log\_messages (#7955)
1 file changed, 2 insertions(+)
David CARLIER in commit 76993a0d4:
cpu affinity: DragonFlyBSD support (#7956)
2 files changed, 9 insertions(+), 2 deletions(-)
Zach Fewtrell in commit b23cdc14a:
fix invalid 'failover' identifier in cluster slave selection test (#7942)
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 99a4cb401:
Update rdb\_last\_bgsave\_time\_sec in INFO on diskless replication (#7917)
1 file changed, 11 insertions(+), 14 deletions(-)
Wen Hui in commit 258287c35:
do not add save parameter during config rewrite in sentinel mode (#7945)
1 file changed, 6 insertions(+)
Qu Chen in commit 6134279e2:
WATCH no longer ignores keys which have expired for MULTI/EXEC. (#7920)
2 files changed, 3 insertions(+), 3 deletions(-)
Oran Agra in commit d15ec67c6:
improve verbose logging on failed test. print log file lines (#7938)
1 file changed, 4 insertions(+)
Yossi Gottlieb in commit 8a2e6d24f:
Add a --no-latency tests flag. (#7939)
5 files changed, 23 insertions(+), 9 deletions(-)
filipe oliveira in commit 0a1737dc5:
Fixed bug concerning redis-benchmark non clustered benchmark forcing always the same hash tag {tag} (#7931)
1 file changed, 31 insertions(+), 24 deletions(-)
Oran Agra in commit 6d9b3df71:
fix 32bit build warnings (#7926)
2 files changed, 3 insertions(+), 3 deletions(-)
Wen Hui in commit ed6f7a55e:
fix double fclose in aofrewrite (#7919)
1 file changed, 6 insertions(+), 5 deletions(-)
Oran Agra in commit 331d73c92:
INFO report peak memory before eviction (#7894)
1 file changed, 11 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit e88e13528:
Fix tests failure on busybox systems. (#7916)
2 files changed, 2 insertions(+), 2 deletions(-)
Oran Agra in commit b7f53738e:
Allow requirepass config to clear the password (#7899)
1 file changed, 18 insertions(+), 8 deletions(-)
Wang Yuan in commit 2ecb28b68:
Remove temporary aof and rdb files in a background thread (#7905)
2 files changed, 3 insertions(+), 3 deletions(-)
guybe7 in commit 7bc605e6b:
Minor improvements to module blocked on keys (#7903)
3 files changed, 15 insertions(+), 9 deletions(-)
Andreas Lind in commit 1b484608d:
Support redis-cli -u rediss://... (#7900)
1 file changed, 9 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 95095d680:
Modules: fix RM\_GetCommandKeys API. (#7901)
3 files changed, 4 insertions(+), 7 deletions(-)
Meir Shpilraien (Spielrein) in commit cd3ae2f2c:
Add Module API for version and compatibility checks (#7865)
9 files changed, 180 insertions(+), 3 deletions(-)
Yossi Gottlieb in commit 1d723f734:
Module API: Add RM\_GetClientCertificate(). (#7866)
6 files changed, 88 insertions(+)
Yossi Gottlieb in commit d72172752:
Modules: Add RM\_GetDetachedThreadSafeContext(). (#7886)
4 files changed, 52 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit e4f9aff19:
Modules: add RM\_GetCommandKeys().
6 files changed, 238 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 6682b913e:
Introduce getKeysResult for getKeysFromCommand.
7 files changed, 170 insertions(+), 121 deletions(-)
Madelyn Olson in commit 9db65919c:
Fixed excessive categories being displayed from acls (#7889)
2 files changed, 29 insertions(+), 2 deletions(-)
Oran Agra in commit f34c50cf6:
Add some additional signal info to the crash log (#7891)
1 file changed, 4 insertions(+), 1 deletion(-)
Oran Agra in commit 300bb4701:
Allow blocked XREAD on a cluster replica (#7881)
3 files changed, 43 insertions(+)
Oran Agra in commit bc5cf0f1a:
memory reporting of clients argv (#7874)
5 files changed, 55 insertions(+), 5 deletions(-)
DvirDukhan in commit 13d2e6a57:
redis-cli add control on raw format line delimiter (#7841)
1 file changed, 8 insertions(+), 6 deletions(-)
Oran Agra in commit d54e25620:
Include internal sds fragmentation in MEMORY reporting (#7864)
2 files changed, 7 insertions(+), 7 deletions(-)
Oran Agra in commit ac2c2b74e:
Fix crash in script timeout during AOF loading (#7870)
2 files changed, 47 insertions(+), 4 deletions(-)
Rafi Einstein in commit 00d2082e7:
Makefile: enable program suffixes via PROG\_SUFFIX (#7868)
2 files changed, 10 insertions(+), 6 deletions(-)
nitaicaro in commit d2c2c26e7:
Fixed Tracking test “The other connection is able to get invalidations” (#7871)
1 file changed, 3 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 2c172556f:
Modules: expose real client on conn events.
1 file changed, 11 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 2972d0c1f:
Module API: Fail ineffective auth calls.
1 file changed, 5 insertions(+)
Yossi Gottlieb in commit aeb2a3b6a:
TLS: Do not require CA config if not used. (#7862)
1 file changed, 5 insertions(+), 3 deletions(-)
Oran Agra in commit d8e64aeb8:
warning: comparison between signed and unsigned integer in 32bit build (#7838)
1 file changed, 2 insertions(+), 2 deletions(-)
David CARLIER in commit 151209982:
Add support for Haiku OS (#7435)
3 files changed, 16 insertions(+)
Gavrie Philipson in commit b1d3e169f:
Fix typo in module API docs (#7861)
1 file changed, 2 insertions(+), 2 deletions(-)
David CARLIER in commit 08e3b8d13:
getting rss size implementation for netbsd (#7293)
1 file changed, 20 insertions(+)
Oran Agra in commit 0377a889b:
Fix new obuf-limits tests to work with TLS (#7848)
2 files changed, 29 insertions(+), 13 deletions(-)
caozb in commit a057ad9b1:
ignore slaveof no one in redis.conf (#7842)
1 file changed, 10 insertions(+), 1 deletion(-)
Wang Yuan in commit 87ecee645:
Don't support Gopher if enable io threads to read queries (#7851)
2 files changed, 8 insertions(+), 5 deletions(-)
Wang Yuan in commit b92902236:
Set 'loading' and 'shutdown\_asap' to volatile sig\_atomic\_t type (#7845)
1 file changed, 2 insertions(+), 2 deletions(-)
Uri Shachar in commit ee0875a02:
Fix config rewrite file handling to make it really atomic (#7824)
1 file changed, 49 insertions(+), 47 deletions(-)
WuYunlong in commit d577519e1:
Add fsync to readSyncBulkPayload(). (#7839)
1 file changed, 11 insertions(+)
Wen Hui in commit 104e0ea3e:
rdb.c: handle fclose error case differently to avoid double fclose (#7307)
1 file changed, 7 insertions(+), 6 deletions(-)
Wang Yuan in commit 0eb015ac6:
Don't write replies if close the client ASAP (#7202)
7 files changed, 144 insertions(+), 2 deletions(-)
Guy Korland in commit 08a03e32c:
Fix RedisModule\_HashGet examples (#6697)
1 file changed, 4 insertions(+), 4 deletions(-)
Oran Agra in commit 09551645d:
fix recently broken TLS build error, and add coverage for CI (#7833)
2 files changed, 4 insertions(+), 3 deletions(-)
David CARLIER in commit c545ba5d0:
Further NetBSD update and build fixes. (#7831)
3 files changed, 72 insertions(+), 3 deletions(-)
WuYunlong in commit ec9050053:
Fix redundancy use of semicolon in do-while macros in ziplist.c. (#7832)
1 file changed, 3 insertions(+), 3 deletions(-)
yixiang in commit 27a4d1314:
Fix connGetSocketError usage (#7811)
2 files changed, 6 insertions(+), 4 deletions(-)
Oran Agra in commit 30795dcae:
RM\_GetContextFlags - document missing flags (#7821)
1 file changed, 6 insertions(+)
Yossi Gottlieb in commit 14a12849f:
Fix occasional hangs on replication reconnection. (#7830)
2 files changed, 14 insertions(+), 3 deletions(-)
Ariel Shtul in commit d5a1b06dc:
Fix redis-check-rdb support for modules aux data (#7826)
3 files changed, 21 insertions(+), 1 deletion(-)
Wen Hui in commit 39f793693:
refactor rewriteStreamObject code for adding missing streamIteratorStop call (#7829)
1 file changed, 36 insertions(+), 18 deletions(-)
WuYunlong in commit faad29bfb:
Make IO threads killable so that they can be canceled at any time.
1 file changed, 1 insertion(+)
WuYunlong in commit b3f1b5830:
Make main thread killable so that it can be canceled at any time. Refine comment of makeThreadKillable().
3 files changed, 11 insertions(+), 4 deletions(-)
Oran Agra in commit 0f43d1f55:
RM\_GetContextFlags provides indication that we're in a fork child (#7783)
8 files changed, 28 insertions(+), 18 deletions(-)
Wen Hui in commit a55ea9cdf:
Add Swapdb Module Event (#7804)
5 files changed, 52 insertions(+)
Daniel Dai in commit 1d8f72bef:
fix make warnings in debug.c MacOS (#7805)
2 files changed, 3 insertions(+), 2 deletions(-)
David CARLIER in commit 556953d93:
debug.c: NetBSD build warning fix. (#7810)
1 file changed, 4 insertions(+), 3 deletions(-)
Wang Yuan in commit d02435b66:
Remove tmp rdb file in background thread (#7762)
6 files changed, 82 insertions(+), 8 deletions(-)
Oran Agra in commit 1bd7bfdc0:
Add printf attribute and fix warnings and a minor bug (#7803)
2 files changed, 12 insertions(+), 4 deletions(-)
WuYunlong in commit d25147b4c:
bio: doFastMemoryTest should try to kill io threads as well.
3 files changed, 19 insertions(+)
WuYunlong in commit 4489ba081:
bio: fix doFastMemoryTest.
4 files changed, 25 insertions(+), 3 deletions(-)
Wen Hui in commit cf85def67:
correct OBJECT ENCODING response for stream type (#7797)
1 file changed, 1 insertion(+)
WuYunlong in commit cf5bcf892:
Clarify help text of tcl scripts. (#7798)
1 file changed, 1 insertion(+)
Mykhailo Pylyp in commit f72665c65:
Recalculate hardcoded variables from $::instances\_count in sentinel tests (#7561)
3 files changed, 15 insertions(+), 13 deletions(-)
Oran Agra in commit c67b19e7a:
Fix failing valgrind installation in github actions (#7792)
1 file changed, 1 insertion(+)
Oran Agra in commit 92763fd2a:
fix broken PEXPIREAT test (#7791)
1 file changed, 10 insertions(+), 6 deletions(-)
Wang Yuan in commit f5b4c0ccb:
Remove dead global variable 'lru\_clock' (#7782)
1 file changed, 1 deletion(-)
Oran Agra in commit 82d431fd6:
Squash merging 125 typo/grammar/comment/doc PRs (#7773)
80 files changed, 436 insertions(+), 416 deletions(-)
================================================================================
Redis 6.0.8 Released Wed Sep 09 23:34:17 IDT 2020
================================================================================
Upgrade urgency HIGH: Anyone who's using Redis 6.0.7 with Sentinel or
CONFIG REWRITE command is affected and should upgrade ASAP, see #7760.
Bug fixes:
\* CONFIG REWRITE after setting oom-score-adj-values either via CONFIG SET or
loading it from a config file, will generate a corrupt config file that will
cause Redis to fail to start
\* Fix issue with redis-cli --pipe on MacOS
\* Fix RESP3 response for HKEYS/HVALS on non-existing key
\* Various small bug fixes
New features / Changes:
\* Remove THP warning when set to madvise
\* Allow EXEC with read commands on readonly replica in cluster
\* Add masters/replicas options to redis-cli --cluster call command
Module API:
\* Add RedisModule\_ThreadSafeContextTryLock
Full list of commits:
Oran Agra in commit cdabf696a:
Fix RESP3 response for HKEYS/HVALS on non-existing key
1 file changed, 3 insertions(+), 1 deletion(-)
Oran Agra in commit ec633c716:
Fix leak in new blockedclient module API test
1 file changed, 3 insertions(+)
Yossi Gottlieb in commit 6bac07c5c:
Tests: fix oom-score-adj false positives. (#7772)
1 file changed, 1 insertion(+), 1 deletion(-)
杨博东 in commit 6043dc614:
Tests: Add aclfile load and save tests (#7765)
2 files changed, 41 insertions(+)
Roi Lipman in commit c0b5f9bf0:
RM\_ThreadSafeContextTryLock a non-blocking method for acquiring GIL (#7738)
7 files changed, 122 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 5780a1599:
Tests: validate CONFIG REWRITE for all params. (#7764)
6 files changed, 43 insertions(+), 6 deletions(-)
Oran Agra in commit e3c14b25d:
Change THP warning to use madvise rather than never (#7771)
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit 28929917b:
Documents RM\_Call's fmt (#5448)
1 file changed, 25 insertions(+)
Jan-Erik Rediger in commit 9146402c2:
Check that THP is not set to always (madvise is ok) (#4001)
1 file changed, 1 insertion(+), 1 deletion(-)
Yossi Gottlieb in commit d05089429:
Tests: clean up stale .cli files. (#7768)
1 file changed, 2 insertions(+)
Eran Liberty in commit 8861c1bae:
Allow exec with read commands on readonly replica in cluster (#7766)
3 files changed, 59 insertions(+), 3 deletions(-)
Yossi Gottlieb in commit 2cf2ff2f6:
Fix CONFIG REWRITE of oom-score-adj-values. (#7761)
1 file changed, 2 insertions(+), 1 deletion(-)
Oran Agra in commit 1386c80f7:
handle cur\_test for nested tests
1 file changed, 3 insertions(+)
Oran Agra in commit c7d4945f0:
Add daily CI for MacOS (#7759)
1 file changed, 18 insertions(+)
bodong.ybd in commit 32548264c:
Tests: Some fixes for macOS
3 files changed, 26 insertions(+), 11 deletions(-)
Oran Agra in commit 1e17f9812:
Fix cluster consistency-check test (#7754)
1 file changed, 55 insertions(+), 29 deletions(-)
Yossi Gottlieb in commit f4ecdf86a:
Tests: fix unmonitored servers. (#7756)
1 file changed, 5 insertions(+)
Oran Agra in commit 9f020050d:
fix broken cluster/sentinel tests by recent commit (#7752)
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit fdbabb496:
Improve valgrind support for cluster tests (#7725)
3 files changed, 83 insertions(+), 23 deletions(-)
Oran Agra in commit 35a6a0bbc:
test infra - add durable mode to work around test suite crashing
3 files changed, 35 insertions(+), 3 deletions(-)
Oran Agra in commit e3136b13f:
test infra - wait\_done\_loading
2 files changed, 16 insertions(+), 36 deletions(-)
Oran Agra in commit 83c75dbd9:
test infra - flushall between tests in external mode
1 file changed, 1 insertion(+)
Oran Agra in commit 265f5d3cf:
test infra - improve test skipping ability
3 files changed, 91 insertions(+), 36 deletions(-)
Oran Agra in commit fcd3a9908:
test infra - reduce disk space usage
3 files changed, 33 insertions(+), 11 deletions(-)
Oran Agra in commit b6ea4699f:
test infra - write test name to logfile
3 files changed, 35 insertions(+)
Yossi Gottlieb in commit 4a4b07fc6:
redis-cli: fix writeConn() buffer handling. (#7749)
1 file changed, 37 insertions(+), 6 deletions(-)
Oran Agra in commit f2d08de2e:
Print server startup messages after daemonization (#7743)
1 file changed, 4 insertions(+), 4 deletions(-)
Thandayuthapani in commit 77541d555:
Add masters/replicas options to redis-cli --cluster call command (#6491)
1 file changed, 13 insertions(+), 2 deletions(-)
Oran Agra in commit 91d13a854:
fix README about BUILD\_WITH\_SYSTEMD usage (#7739)
1 file changed, 1 insertion(+), 1 deletion(-)
Yossi Gottlieb in commit 88d03d965:
Fix double-make issue with make && make install. (#7734)
1 file changed, 2 insertions(+)
================================================================================
Redis 6.0.7 Released Fri Aug 28 11:05:09 IDT 2020
================================================================================
Upgrade urgency MODERATE: several bugs with moderate impact are fixed,
Specifically the first two listed below which cause protocol errors for clients.
Bug fixes:
\* CONFIG SET could hung the client when arrives during RDB/ROF loading (When
processed after another command that was also rejected with -LOADING error)
\* LPOS command when RANK is greater than matches responded wiht broken protocol
(negative multi-bulk count)
\* UNLINK / Lazyfree for stream type key would have never do async freeing
\* PERSIST should invalidate WATCH (Like EXPIRE does)
\* EXEC with only read commands could have be rejected when OOM
\* TLS: relax verification on CONFIG SET (Don't error if some configs are set
and tls isn't enabled)
\* TLS: support cluster/replication without tls-port
\* Systemd startup after network is online
\* Redis-benchmark improvements
\* Various small bug fixes
New features:
\* Add oom-score-adj configuration option to control Linux OOM killer
\* Show IO threads statistics and status in INFO output
\* Add optional tls verification mode (see tls-auth-clients)
Module API:
\* Add RedisModule\_HoldString
\* Add loaded keyspace event
\* Fix RedisModuleEvent\_LoadingProgress
\* Fix RedisModuleEvent\_MasterLinkChange hook missing on successful psync
\* Fix missing RM\_CLIENTINFO\_FLAG\_SSL
\* Refactor redismodule.h for use with -fno-common / extern
Full list of commits:
Oran Agra in commit c26394e4f:
Reduce the probability of failure when start redis in runtest-cluster #7554 (#7635)
1 file changed, 23 insertions(+), 5 deletions(-)
Leoš Literák in commit 745d5e802:
Update README.md with instructions how to build with systemd support (#7730)
1 file changed, 5 insertions(+)
Yossi Gottlieb in commit 03f1d208a:
Fix oom-score-adj on older distros. (#7724)
1 file changed, 2 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 941174d9c:
Backport Lua 5.2.2 stack overflow fix. (#7733)
1 file changed, 1 insertion(+), 1 deletion(-)
Wang Yuan in commit c897dba14:
Fix wrong format specifiers of 'sdscatfmt' for the INFO command (#7706)
1 file changed, 1 insertion(+), 1 deletion(-)
Wen Hui in commit 5e3fab5e7:
fix make warnings (#7692)
1 file changed, 4 insertions(+), 3 deletions(-)
Nathan Scott in commit a2b09c13f:
Annotate module API functions in redismodule.h for use with -fno-common (#6900)
1 file changed, 265 insertions(+), 241 deletions(-)
Yossi Gottlieb in commit bf244273f:
Add oom-score-adj configuration option to control Linux OOM killer. (#1690)
8 files changed, 306 insertions(+), 1 deletion(-)
Meir Shpilraien (Spielrein) in commit b5a6ab98f:
see #7544, added RedisModule\_HoldString api. (#7577)
4 files changed, 83 insertions(+), 8 deletions(-)
ShooterIT in commit ff04cf62b:
[Redis-benchmark] Remove zrem test, add zpopmin test
1 file changed, 5 insertions(+), 5 deletions(-)
ShooterIT in commit 0f3260f31:
[Redis-benchmark] Support zset type
1 file changed, 16 insertions(+)
Arun Ranganathan in commit 45d0b94fc:
Show threading configuration in INFO output (#7446)
3 files changed, 46 insertions(+), 14 deletions(-)
Meir Shpilraien (Spielrein) in commit a22f61e12:
This PR introduces a new loaded keyspace event (#7536)
8 files changed, 135 insertions(+), 4 deletions(-)
Oran Agra in commit 1c9ca1030:
Fix rejectCommand trims newline in shared error objects, hung clients (#7714)
4 files changed, 42 insertions(+), 23 deletions(-)
valentinogeron in commit 217471795:
EXEC with only read commands should not be rejected when OOM (#7696)
2 files changed, 51 insertions(+), 8 deletions(-)
Itamar Haber in commit 6e6c47d16:
Expands lazyfree's effort estimate to include Streams (#5794)
1 file changed, 24 insertions(+)
Yossi Gottlieb in commit da6813623:
Add language servers stuff, test/tls to gitignore. (#7698)
1 file changed, 4 insertions(+)
Valentino Geron in commit de7fb126e:
Assert that setDeferredAggregateLen isn't called with negative value
1 file changed, 1 insertion(+)
Valentino Geron in commit 6cf27f25f:
Fix LPOS command when RANK is greater than matches
2 files changed, 9 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 9bba54ace:
Tests: fix redis-cli with remote hosts. (#7693)
3 files changed, 5 insertions(+), 5 deletions(-)
huangzhw in commit 0fec2cb81:
RedisModuleEvent\_LoadingProgress always at 100% progress (#7685)
1 file changed, 2 insertions(+), 2 deletions(-)
guybe7 in commit 931e19aa6:
Modules: Invalidate saved\_oparray after use (#7688)
1 file changed, 2 insertions(+)
杨博东 in commit 6f2065570:
Fix flock cluster config may cause failure to restart after kill -9 (#7674)
4 files changed, 31 insertions(+), 7 deletions(-)
Raghav Muddur in commit 200149a2a:
Update clusterMsgDataPublish to clusterMsgModule (#7682)
1 file changed, 1 insertion(+), 1 deletion(-)
Madelyn Olson in commit 72daa1b4e:
Fixed hset error since it's shared with hmset (#7678)
1 file changed, 1 insertion(+), 1 deletion(-)
guybe7 in commit 3bf9ac994:
PERSIST should signalModifiedKey (Like EXPIRE does) (#7671)
1 file changed, 1 insertion(+)
Oran Agra in commit b37501684:
OOM Crash log include size of allocation attempt. (#7670)
1 file changed, 2 insertions(+), 1 deletion(-)
Wen Hui in commit 2136cb68f:
[module] using predefined REDISMODULE\_NO\_EXPIRE in RM\_GetExpire (#7669)
1 file changed, 2 insertions(+), 1 deletion(-)
Oran Agra in commit f56aee4bc:
Trim trailing spaces in error replies coming from rejectCommand (#7668)
1 file changed, 5 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 012d7506a:
Module API: fix missing RM\_CLIENTINFO\_FLAG\_SSL. (#7666)
6 files changed, 82 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit a0adbc857:
TLS: relax verification on CONFIG SET. (#7665)
2 files changed, 24 insertions(+), 7 deletions(-)
Madelyn Olson in commit 2ef29715b:
Fixed timer warning (#5953)
1 file changed, 1 insertion(+), 1 deletion(-)
Wagner Francisco Mezaroba in commit b76f171f5:
allow --pattern to be used along with --bigkeys (#3586)
1 file changed, 9 insertions(+), 2 deletions(-)
zhaozhao.zz in commit cc7b57765:
redis-benchmark: fix wrong random key for hset (#4895)
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 479c1ba77:
CLIENT\_MASTER should ignore server.proto\_max\_bulk\_len
1 file changed, 2 insertions(+), 1 deletion(-)
zhaozhao.zz in commit f61ce8a52:
config: proto-max-bulk-len must be 1mb or greater
2 files changed, 2 insertions(+), 2 deletions(-)
zhaozhao.zz in commit 0350f597a:
using proto-max-bulk-len in checkStringLength for SETRANGE and APPEND
1 file changed, 2 insertions(+), 2 deletions(-)
YoongHM in commit eea63548d:
Start redis after network is online (#7639)
1 file changed, 2 insertions(+)
Yossi Gottlieb in commit aef6d74fb:
Run daily workflow on main repo only (no forks). (#7646)
1 file changed, 7 insertions(+)
WuYunlong in commit 917b4d241:
see #7250, fix signature of RedisModule\_DeauthenticateAndCloseClient (#7645)
1 file changed, 1 insertion(+), 1 deletion(-)
Wang Yuan in commit efab7fd54:
Print error info if failed opening config file (#6943)
1 file changed, 2 insertions(+), 1 deletion(-)
Wen Hui in commit 8c4468bcf:
fix memory leak in ACLLoadFromFile error handling (#7623)
1 file changed, 1 insertion(+)
Oran Agra in commit 89724e1d2:
redis-cli --cluster-yes - negate force flag for clarity
1 file changed, 9 insertions(+), 9 deletions(-)
Frank Meier in commit c813739af:
reintroduce REDISCLI\_CLUSTER\_YES env variable in redis-cli
1 file changed, 6 insertions(+)
Frank Meier in commit 7e3b86c18:
add force option to 'create-cluster create' script call (#7612)
1 file changed, 6 insertions(+), 2 deletions(-)
Oran Agra in commit 3f7fa4312:
fix new rdb test failing on timing issues (#7604)
1 file changed, 2 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 417976d7a:
Fix test-centos7-tls daily job. (#7598)
1 file changed, 2 insertions(+), 2 deletions(-)
Oran Agra in commit c41818c51:
module hook for master link up missing on successful psync (#7584)
2 files changed, 22 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit 6ef3fc185:
CI: Add daily CentOS 7.x jobs. (#7582)
1 file changed, 50 insertions(+), 4 deletions(-)
WuYunlong in commit 002c37482:
Fix running single test 14-consistency-check.tcl (#7587)
1 file changed, 1 insertion(+)
Yossi Gottlieb in commit 66cbbb6ad:
Clarify RM\_BlockClient() error condition. (#6093)
1 file changed, 9 insertions(+)
namtsui in commit 22aba2207:
Avoid an out-of-bounds read in the redis-sentinel (#7443)
1 file changed, 2 insertions(+), 2 deletions(-)
Wen Hui in commit af08887dc:
Add SignalModifiedKey hook in XGROUP CREATE with MKSTREAM option (#7562)
1 file changed, 1 insertion(+)
Wen Hui in commit a5e0a64b0:
fix leak in error handling of debug populate command (#7062)
1 file changed, 3 insertions(+), 4 deletions(-)
Yossi Gottlieb in commit cbfdfa231:
Fix TLS cluster tests. (#7578)
1 file changed, 4 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 6d5376d30:
TLS: Propagate and handle SSL\_new() failures. (#7576)
4 files changed, 48 insertions(+), 6 deletions(-)
Oran Agra in commit a662cd577:
Fix failing tests due to issues with wait\_for\_log\_message (#7572)
3 files changed, 38 insertions(+), 34 deletions(-)
Jiayuan Chen in commit 2786a4b5e:
Add optional tls verification (#7502)
6 files changed, 40 insertions(+), 5 deletions(-)
Oran Agra in commit 3ef3d3612:
Daily github action: run cluster and sentinel tests with tls (#7575)
1 file changed, 2 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit f20f63322:
TLS: support cluster/replication without tls-port.
2 files changed, 5 insertions(+), 4 deletions(-)
grishaf in commit 3c9ae059d:
Fix prepareForShutdown function declaration (#7566)
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 3f4803af9:
Stabilize bgsave test that sometimes fails with valgrind (#7559)
1 file changed, 20 insertions(+), 2 deletions(-)
Madelyn Olson in commit 1a3c51a1f:
Properly reset errno for rdbLoad (#7542)
1 file changed, 1 insertion(+)
Oran Agra in commit 92d80b13a:
testsuite may leave servers alive on error (#7549)
1 file changed, 3 insertions(+)
Yossi Gottlieb in commit 245582ba7:
Tests: drop TCL 8.6 dependency. (#7548)
1 file changed, 27 insertions(+), 22 deletions(-)
Oran Agra in commit f20e1ba2d:
Fixes to release scripts (#7547)
2 files changed, 2 insertions(+), 2 deletions(-)
Remi Collet in commit 60ff56993:
Fix deprecated tail syntax in tests (#7543)
1 file changed, 1 insertion(+), 1 deletion(-)
Wen Hui in commit 34e8541b9:
Add missing calls to raxStop (#7532)
4 files changed, 63 insertions(+), 19 deletions(-)
Wen Hui in commit 2f7bc5435:
add missing caching command in client help (#7399)
1 file changed, 1 insertion(+)
zhaozhao.zz in commit c15be9ffe:
replication: need handle -NOPERM error after send ping (#7538)
1 file changed, 1 insertion(+)
Scott Brenner in commit 1b29152c3:
GitHub Actions workflows - use latest version of actions/checkout (#7534)
2 files changed, 10 insertions(+), 10 deletions(-)
================================================================================
Redis 6.0.6 Released Mon Jul 20 09:31:30 IDT 2020
================================================================================
Upgrade urgency MODERATE: several bugs with moderate impact are fixed here.
The most important issues are listed here:
\* Fix crash when enabling CLIENT TRACKING with prefix
\* EXEC always fails with EXECABORT and multi-state is cleared
\* RESTORE ABSTTL won't store expired keys into the db
\* redis-cli better handling of non-pritable key names
\* TLS: Ignore client cert when tls-auth-clients off
\* Tracking: fix invalidation message on flush
\* Notify systemd on Sentinel startup
\* Fix crash on a misuse of STRALGO
\* Few fixes in module API
\* Fix a few rare leaks (STRALGO error misuse, Sentinel)
\* Fix a possible invalid access in defrag of scripts (unlikely to cause real harm)
New features:
\* LPOS command to search in a list
\* Use user+pass for MIGRATE in redis-cli and redis-benchmark in cluster mode
\* redis-cli support TLS for --pipe, --rdb and --replica options
\* TLS: Session caching configuration support
And this is the full list of commits:
Itamar Haber in commit 50548cafc:
Adds SHA256SUM to redis-stable tarball upload
1 file changed, 1 insertion(+)
yoav-steinberg in commit 3a4c6684f:
Support passing stack allocated module strings to moduleCreateArgvFromUserFormat (#7528)
1 file changed, 4 insertions(+), 1 deletion(-)
Luke Palmer in commit 2fd0b2bd6:
Send null for invalidate on flush (#7469)
1 file changed, 14 insertions(+), 10 deletions(-)
dmurnane in commit c3c81e1a8:
Notify systemd on sentinel startup (#7168)
1 file changed, 4 insertions(+)
Developer-Ecosystem-Engineering in commit e2770f29b:
Add registers dump support for Apple silicon (#7453)
1 file changed, 54 insertions(+), 2 deletions(-)
Wen Hui in commit b068eae97:
correct error msg for num connections reaching maxclients in cluster mode (#7444)
1 file changed, 2 insertions(+), 2 deletions(-)
WuYunlong in commit e6169ae5c:
Fix command help for unexpected options (#7476)
6 files changed, 20 insertions(+), 3 deletions(-)
WuYunlong in commit abf08fc02:
Refactor RM\_KeyType() by using macro. (#7486)
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 11b83076a:
diskless master disconnect replicas when rdb child failed (#7518)
1 file changed, 6 insertions(+), 5 deletions(-)
Oran Agra in commit 8f27f2f7d:
redis-cli tests, fix valgrind timing issue (#7519)
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 180b588e8:
Fix out of update help info in tcl tests. (#7516)
1 file changed, 2 deletions(-)
Qu Chen in commit 417c60bdc:
Replica always reports master's config epoch in CLUSTER NODES output. (#7235)
1 file changed, 5 insertions(+), 1 deletion(-)
Oran Agra in commit 72a242419:
RESTORE ABSTTL skip expired keys - leak (#7511)
1 file changed, 1 insertion(+)
Oran Agra in commit 2ca45239f:
fix recently added time sensitive tests failing with valgrind (#7512)
2 files changed, 12 insertions(+), 6 deletions(-)
Oran Agra in commit 123dc8b21:
runtest --stop pause stops before terminating the redis server (#7513)
2 files changed, 8 insertions(+), 2 deletions(-)
Oran Agra in commit a6added45:
update release scripts for new hosts, and CI to run more tests (#7480)
5 files changed, 68 insertions(+), 26 deletions(-)
jimgreen2013 in commit cf4869f9e:
fix description about ziplist, the code is ok (#6318)
1 file changed, 2 insertions(+), 2 deletions(-)
马永泽 in commit d548f219b:
fix benchmark in cluster mode fails to authenticate (#7488)
1 file changed, 56 insertions(+), 40 deletions(-)
Abhishek Soni in commit e58eb7b89:
fix: typo in CI job name (#7466)
1 file changed, 1 insertion(+), 1 deletion(-)
Jiayuan Chen in commit 6def10a2b:
Fix typo in deps README (#7500)
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 8af61afef:
Add missing latency-monitor tcl test to test\_helper.tcl. (#6782)
1 file changed, 1 insertion(+)
Yossi Gottlieb in commit a419f400e:
TLS: Session caching configuration support. (#7420)
6 files changed, 56 insertions(+), 16 deletions(-)
Yossi Gottlieb in commit 2e4bb2667:
TLS: Ignore client cert when tls-auth-clients off. (#7457)
1 file changed, 1 insertion(+), 3 deletions(-)
James Hilliard in commit f0b1aee9e:
Use pkg-config to properly detect libssl and libcrypto libraries (#7452)
1 file changed, 15 insertions(+), 3 deletions(-)
Yossi Gottlieb in commit e92b99564:
TLS: Add missing redis-cli options. (#7456)
3 files changed, 166 insertions(+), 52 deletions(-)
Oran Agra in commit 1f3db5bf5:
redis-cli --hotkeys fixed to handle non-printable key names
1 file changed, 11 insertions(+), 5 deletions(-)
Oran Agra in commit c3044f369:
redis-cli --bigkeys fixed to handle non-printable key names
1 file changed, 24 insertions(+), 16 deletions(-)
Oran Agra in commit b3f75527b:
RESTORE ABSTTL won't store expired keys into the db (#7472)
4 files changed, 46 insertions(+), 16 deletions(-)
huangzhw in commit 6f87fc92f:
defrag.c activeDefragSdsListAndDict when defrag sdsele, We can't use (#7492)
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit d8e6a3e5b:
skip a test that uses +inf on valgrind (#7440)
1 file changed, 12 insertions(+), 9 deletions(-)
Oran Agra in commit 28fd1a110:
stabilize tests that look for log lines (#7367)
3 files changed, 33 insertions(+), 11 deletions(-)
Oran Agra in commit a513b4ed9:
tests/valgrind: don't use debug restart (#7404)
4 files changed, 114 insertions(+), 57 deletions(-)
Oran Agra in commit 70e72fc1b:
change references to the github repo location (#7479)
5 files changed, 7 insertions(+), 7 deletions(-)
zhaozhao.zz in commit c63e533cc:
BITOP: propagate only when it really SET or DEL targetkey (#5783)
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 31040ff54:
Update comment to clarify change in #7398.
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit b605fe827:
LPOS: option FIRST renamed RANK.
2 files changed, 19 insertions(+), 19 deletions(-)
Dave Nielsen in commit 8deb24954:
updated copyright year
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit a61c2930c:
EXEC always fails with EXECABORT and multi-state is cleared
6 files changed, 204 insertions(+), 91 deletions(-)
antirez in commit 3c8041637:
Include cluster.h for getClusterConnectionsCount().
1 file changed, 1 insertion(+)
antirez in commit 5be673ee8:
Fix BITFIELD i64 type handling, see #7417.
1 file changed, 8 insertions(+), 6 deletions(-)
antirez in commit 5f289df9b:
Clarify maxclients and cluster in conf. Remove myself too.
2 files changed, 9 insertions(+), 1 deletion(-)
hwware in commit 000f928d6:
fix memory leak in sentinel connection sharing
1 file changed, 1 insertion(+)
chenhui0212 in commit d9a3c0171:
Fix comments in function raxLowWalk of listpack.c
1 file changed, 2 insertions(+), 2 deletions(-)
Tomasz Poradowski in commit 7526e4506:
ensure SHUTDOWN\_NOSAVE in Sentinel mode
2 files changed, 9 insertions(+), 8 deletions(-)
chenhui0212 in commit 6487cbc33:
fix comments in listpack.c
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 69b66bfca:
Use cluster connections too, to limit maxclients.
3 files changed, 23 insertions(+), 8 deletions(-)
antirez in commit 5a960a033:
Tracking: fix enableBcastTrackingForPrefix() invalid sdslen() call.
1 file changed, 1 insertion(+), 1 deletion(-)
root in commit 1c2e50de3:
cluster.c remove if of clusterSendFail in markNodeAsFailingIfNeeded
1 file changed, 1 insertion(+), 1 deletion(-)
meir@redislabs.com in commit 040efb697:
Fix RM\_ScanKey module api not to return int encoded strings
3 files changed, 24 insertions(+), 7 deletions(-)
antirez in commit 1b8b7941d:
Fix LCS object type checking. Related to #7379.
1 file changed, 17 insertions(+), 10 deletions(-)
hwware in commit 6b571b45a:
fix memory leak
1 file changed, 11 insertions(+), 12 deletions(-)
hwware in commit 674759062:
fix server crash in STRALGO command
1 file changed, 7 insertions(+)
Benjamin Sergeant in commit a05ffefdc:
Update redis-cli.c
1 file changed, 19 insertions(+), 6 deletions(-)
Jamie Scott in commit 870b63733:
minor fix
1 file changed, 2 insertions(+), 3 deletions(-)
================================================================================
Redis 6.0.5 Released Tue Jun 09 11:56:08 CEST 2020
================================================================================
Upgrade urgency MODERATE: several bugs with moderate impact are fixed here.
The most important issues are listed here:
\* Fix handling of speical chars in ACL LOAD.
\* Make Redis Cluster more robust about operation errors that may lead
to two clusters to mix together.
\* Revert the sendfile() implementation of RDB transfer. It causes some delay.
\* Fix TLS certificate loading for chained certificates.
\* Fix AOF rewirting of KEEPTTL SET option.
\* Fix MULTI/EXEC behavior during -BUSY script errors.
And this is the full list of commits:
antirez in commit ee8dd01bb:
Temporary fix for #7353 issue about EVAL during -BUSY.
1 file changed, 9 insertions(+)
xhe in commit a4a856d53:
return the correct proto version HELLO should return the current proto version, while the code hardcoded 3
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit e2046b300:
Don't queue commands in an already aborted MULTI state
1 file changed, 7 insertions(+)
Oran Agra in commit b35fdf1de:
Avoid rejecting WATCH / UNWATCH, like MULTI/EXEC/DISCARD
1 file changed, 4 insertions(+), 2 deletions(-)
zhaozhao.zz in commit 1d7bf208c:
AOF: append origin SET if no expire option
2 files changed, 23 insertions(+), 8 deletions(-)
Oran Agra in commit 676445ad9:
fix disconnectSlaves, to try to free each slave.
1 file changed, 1 deletion(-)
zhaozhao.zz in commit 4846c0c8a:
donot free protected client in freeClientsInAsyncFreeQueue
1 file changed, 9 insertions(+), 3 deletions(-)
Oran Agra in commit f33de403e:
fix pingoff test race
1 file changed, 1 insertion(+)
Kevin Fwu in commit 49af4d07e:
Fix TLS certificate loading for chained certificates.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 329fddbda:
Revert "Implements sendfile for redis."
2 files changed, 2 insertions(+), 55 deletions(-)
antirez in commit 925a2cd5a:
Revert "avoid using sendfile if tls-replication is enabled"
1 file changed, 27 insertions(+), 34 deletions(-)
Liu Zhen in commit 84a7a9058:
fix clusters mixing accidentally by gossip
1 file changed, 10 insertions(+), 2 deletions(-)
antirez in commit cd63359a1:
Fix handling of special chars in ACL LOAD.
1 file changed, 8 insertions(+), 4 deletions(-)
================================================================================
Redis 6.0.4 Released Thu May 28 11:36:45 CEST 2020
================================================================================
Upgrade urgency CRITICAL: this release fixes a severe replication bug.
Redis 6.0.4 fixes a critical replication bug caused by a new feature introduced
in Redis 6. The feature, called "meaningful offset" and strongly wanted by
myself (antirez) was an improvement that avoided that masters were no longer
able, during a failover where they were demoted to replicas, to partially
synchronize with the new master. In short the feature was able to avoid full
synchronizations with RDB. How did it work? By trimming the replication backlog
of the final "PING" commands the master was sending in the replication channel:
this way the replication offset would no longer go "after" the one of the
promoted replica, allowing the master to just continue in the same replication
history, receiving only a small data difference.
However after the introduction of the feature we (the Redis core team) quickly
understood there was something wrong: the apparently harmless feature had
many bugs, and the last bug we discovered, after a joined effort of multiple
people, we were not even able to fully understand after fixing it. Enough was
enough, we decided that the complexity cost of this feature was too high.
So Redis 6.0.4 removes the feature entirely, and fixes the data corruption that
it was able to cause.
However there are two facts to take in mind.
Fact 1: Setups using chained replication, that means that certain replicas
are replicating from other replicas, up to Redis 6.0.3 can experience data
corruption. For chained replication we mean that:
+--------+ +---------+ +-------------+
| master |--------->| replica |-------->| sub-replica |
+--------+ +---------+ +-------------+
People using chained replication SHOULD UPGRADE ASAP away from Redis 6.0.0,
6.0.1, 6.0.2 or 6.0.3 to Redis 6.0.4.
To be clear, people NOT using this setup, but having just replicas attached
directly to the master, SHOUDL NOT BE in danger of any problem. But we
are no longer confident on 6.0.x replication implementation complexities
so we suggest to upgrade to 6.0.4 to everybody using an older 6.0.3 release.
We just so far didn't find any bug that affects Redis 6.0.3 that does not
involve chained replication.
People starting with Redis 6.0.4 are fine. People with Redis 5 are fine.
People upgrading from Redis 5 to Redis 6.0.4 are fine.
TLDR: The problem is with users of 6.0.0, 6.0.1, 6.0.2, 6.0.3.
Fact 2: Upgrading from Redis 6.0.x to Redis 6.0.4, IF AND ONLY IF you
use chained replication, requires some extra care:
1. Once you attach your new Redis 6.0.4 instance as a replica of the current
Redis 6.0.x master, you should wait for the first full synchronization,
then you should promote it right away, if your setup involves chained
replication. Don't give it the time to do a new partial synchronization
in the case the link between the master and the replica will break in
the mean time.
2. As an additional care, you may want to set the replication ping period
to a very large value (for instance 1000000) using the following command:
CONFIG SET repl-ping-replica-period 1000000
Note that if you do "1" with care, "2" is not needed.
However if you do it, make sure to later restore it to its default:
CONFIG SET repl-ping-replica-period 10
So this is the main change in Redis 6. Later we'll find a different way in
order to achieve what we wanted to achieve with the Meaningful Offset feature,
but without the same complexity.
Other changes in this release:
\* PSYNC2 tests improved.
\* Fix a rare active defrag edge case bug leading to stagnation
\* Fix Redis 6 asserting at startup in 32 bit systems.
\* Redis 6 32 bit is now added back to our testing environments.
\* Fix server crash for STRALGO command,
\* Implement sendfile for RDB transfer.
\* TLS fixes.
\* Make replication more resistant by disconnecting the master if we
detect a protocol error. Basically we no longer accept inline protocol
from the master.
\* Other improvements in the tests.
Regards,
antirez
This is the full list of commits:
antirez in commit 59cd4c9f6:
Test: take PSYNC2 test master timeout high during switch.
1 file changed, 1 deletion(-)
antirez in commit 6c1bb7b19:
Test: add the tracking unit as default.
1 file changed, 1 insertion(+)
Oran Agra in commit 1aee695e5:
tests: find\_available\_port start search from next port
1 file changed, 12 insertions(+), 7 deletions(-)
Oran Agra in commit a2ae46352:
tests: each test client work on a distinct port range
5 files changed, 39 insertions(+), 27 deletions(-)
Oran Agra in commit 86e562d69:
32bit CI needs to build modules correctly
2 files changed, 7 insertions(+), 2 deletions(-)
Oran Agra in commit ab2984b1e:
adjust revived meaningful offset tests
1 file changed, 39 insertions(+), 20 deletions(-)
Oran Agra in commit 1ff5a222d:
revive meaningful offset tests
2 files changed, 213 insertions(+)
antirez in commit cc549b46a:
Replication: showLatestBacklog() refactored out.
3 files changed, 36 insertions(+), 25 deletions(-)
antirez in commit 377dd0515:
Drop useless line from replicationCacheMaster().
1 file changed, 2 deletions(-)
antirez in commit 3f8d113f1:
Another meaningful offset test removed.
1 file changed, 100 deletions(-)
antirez in commit d4541349d:
Remove the PSYNC2 meaningful offset test.
2 files changed, 113 deletions(-)
antirez in commit 2112a5702:
Remove the meaningful offset feature.
4 files changed, 10 insertions(+), 93 deletions(-)
antirez in commit d2eb6e0b4:
Set a protocol error if master use the inline protocol.
1 file changed, 17 insertions(+), 2 deletions(-)
Oran Agra in commit 9c1df3b76:
daily CI test with tls
1 file changed, 15 insertions(+)
Oran Agra in commit 115ed1911:
avoid using sendfile if tls-replication is enabled
1 file changed, 34 insertions(+), 27 deletions(-)
antirez in commit 11c748aac:
Replication: log backlog creation event.
1 file changed, 3 insertions(+)
antirez in commit 8f1013722:
Test: PSYNC2 test can now show server logs.
1 file changed, 88 insertions(+), 25 deletions(-)
antirez in commit 2e591fc4a:
Clarify what is happening in PR #7320.
1 file changed, 5 insertions(+), 1 deletion(-)
zhaozhao.zz in commit cbb51fb8f:
PSYNC2: second\_replid\_offset should be real meaningful offset
1 file changed, 3 insertions(+), 3 deletions(-)
Oran Agra in commit e0fc88b4d:
add CI for 32bit build
2 files changed, 34 insertions(+)
antirez in commit e3f864b5f:
Make disconnectSlaves() synchronous in the base case.
3 files changed, 20 insertions(+), 9 deletions(-)
ShooterIT in commit 8af1e513f:
Implements sendfile for redis.
2 files changed, 55 insertions(+), 2 deletions(-)
antirez in commit 3c21418cd:
Fix #7306 less aggressively.
2 files changed, 29 insertions(+), 17 deletions(-)
Madelyn Olson in commit e201f83ce:
EAGAIN for tls during diskless load
1 file changed, 4 insertions(+)
Qu Chen in commit 58fc456cb:
Disconnect chained replicas when the replica performs PSYNC with the master always to avoid replication offset mismatch between master and chained replicas.
2 files changed, 60 insertions(+), 3 deletions(-)
hwware in commit 3febc5c29:
using moreargs variable
1 file changed, 2 insertions(+), 2 deletions(-)
hwware in commit 8d6738559:
fix server crash for STRALGO command
1 file changed, 2 insertions(+), 2 deletions(-)
ShooterIT in commit 7a35eec54:
Replace addDeferredMultiBulkLength with addReplyDeferredLen in comment
1 file changed, 2 insertions(+), 2 deletions(-)
Yossi Gottlieb in commit f93e1417b:
TLS: Improve tls-protocols clarity in redis.conf.
1 file changed, 3 insertions(+), 2 deletions(-)
ShooterIT in commit d0c9e4454:
Fix reply bytes calculation error
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit 1cde6a060:
Tracking: flag CLIENT\_TRACKING\_BROKEN\_REDIR when redir broken
1 file changed, 1 insertion(+)
Oran Agra in commit 436be3498:
fix a rare active defrag edge case bug leading to stagnation
4 files changed, 146 insertions(+), 23 deletions(-)
Oran Agra in commit f9d2ffdc5:
improve DEBUG MALLCTL to be able to write to write only fields.
1 file changed, 27 insertions(+), 7 deletions(-)
hujie in commit d7968ee92:
fix clear USER\_FLAG\_ALLCOMMANDS flag in acl
1 file changed, 5 insertions(+), 4 deletions(-)
ShooterIT in commit a902e6b25:
Redis Benchmark: generate random test data
1 file changed, 12 insertions(+), 1 deletion(-)
hwware in commit 9564ed7c3:
Redis-Benchmark: avoid potentical memmory leaking
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 2e4182743:
Handle keys with hash tag when computing hash slot using tcl cluster client.
1 file changed, 23 insertions(+), 2 deletions(-)
WuYunlong in commit eb2c8b2c6:
Add a test to prove current tcl cluster client can not handle keys with hash tag.
1 file changed, 7 insertions(+), 1 deletion(-)
ShooterIT in commit 928e6976b:
Use dictSize to get the size of dict in dict.c
1 file changed, 2 insertions(+), 2 deletions(-)
Madelyn Olson in commit cdcf5af5a:
Converge hash validation for adding and removing
1 file changed, 21 insertions(+), 14 deletions(-)
Benjamin Sergeant in commit e8b09d220:
do not handle --cluster-yes for cluster fix mode
1 file changed, 16 insertions(+), 7 deletions(-)
Benjamin Sergeant in commit 57b4fb0d8:
fix typo ...
1 file changed, 1 insertion(+), 1 deletion(-)
Benjamin Sergeant in commit 29f25e411:
Redis-cli 6.0.1 `--cluster-yes` doesn't work (fix #7246)
1 file changed, 5 insertions(+), 1 deletion(-)
Oran Agra in commit 00d8b92b8:
fix valgrind test failure in replication test
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 5e17e6276:
add regression test for the race in #7205
1 file changed, 52 insertions(+)
antirez in commit 96e7c011e:
Improve the PSYNC2 test reliability.
1 file changed, 33 insertions(+), 15 deletions(-)
================================================================================
Redis 6.0.3 Released Sat May 16 18:10:21 CEST 2020
================================================================================
Upgrade urgency CRITICAL: a crash introduced in 6.0.2 is now fixed.
1eab62f7e Remove the client from CLOSE\_ASAP list before caching the master.
================================================================================
Redis 6.0.2 Released Fri May 15 22:24:36 CEST 2020
================================================================================
Upgrade urgency MODERATE: many not critical bugfixes in different areas.
Critical fix to client side caching when
keys are evicted from the tracking table but
no notifications are sent.
The following are the most serious fix:
\* XPENDING should not update consumer's seen-time
\* optimize memory usage of deferred replies - fixed
\* Fix CRC64 initialization outside the Redis server itself.
\* stringmatchlen() should not expect null terminated strings.
\* Cluster nodes availability checks improved when there is
high Pub/Sub load on the cluster bus.
\* Redis Benchmark: Fix coredump because of double free
\* Tracking: send eviction messages when evicting entries.
\* rax.c updated from upstream antirez/rax.
\* fix redis 6.0 not freeing closed connections during loading.
New features:
\* Support setcpuaffinity on linux/bsd
\* Client Side Caching: Add Tracking Prefix Number Stats in Server Info
\* Add --user argument to redis-benchmark.c (ACL)
Full list of commits:
Yossi Gottlieb in commit 16ba33c05:
TLS: Fix test failures on recent Debian/Ubuntu.
1 file changed, 20 deletions(-)
Yossi Gottlieb in commit 77ae66930:
TLS: Add crypto locks for older OpenSSL support.
1 file changed, 45 insertions(+)
David Carlier in commit 389697988:
NetBSD build update.
3 files changed, 30 insertions(+), 1 deletion(-)
Madelyn Olson in commit 2435341d7:
Added a refcount on timer events to prevent deletion of recursive timer calls
2 files changed, 12 insertions(+)
antirez in commit 80c906bd3:
Cache master without checking of deferred close flags.
3 files changed, 11 insertions(+), 8 deletions(-)
antirez in commit 74249be4a:
Track events processed while blocked globally.
5 files changed, 32 insertions(+), 17 deletions(-)
antirez in commit 8bf660af9:
Some rework of #7234.
4 files changed, 77 insertions(+), 65 deletions(-)
Oran Agra in commit 9da134cd8:
fix redis 6.0 not freeing closed connections during loading.
3 files changed, 133 insertions(+), 58 deletions(-)
antirez in commit f7f219a13:
Regression test for #7249.
1 file changed, 22 insertions(+)
antirez in commit 693629585:
rax.c updated from upstream antirez/rax.
1 file changed, 4 insertions(+), 2 deletions(-)
antirez in commit e3b5648df:
Tracking: send eviction messages when evicting entries.
2 files changed, 29 insertions(+), 12 deletions(-)
Oran Agra in commit 5c41802d5:
fix unstable replication test
1 file changed, 2 insertions(+), 2 deletions(-)
ShooterIT in commit a23cdbb94:
Redis Benchmark: Fix coredump because of double free
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 1276058ea:
Cluster: clarify we always resolve the sender.
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit 002fcde3d:
Cluster: refactor ping/data delay handling.
1 file changed, 13 insertions(+), 11 deletions(-)
antirez in commit 960186a71:
Cluster: introduce data\_received field.
2 files changed, 27 insertions(+), 10 deletions(-)
antirez in commit 3672875b4:
stringmatchlen() should not expect null terminated strings.
1 file changed, 2 insertions(+), 2 deletions(-)
Brad Dunbar in commit 24e12641d:
Remove unreachable branch.
1 file changed, 2 deletions(-)
hwware in commit c7edffbd5:
add jemalloc-bg-thread config in redis conf
1 file changed, 3 insertions(+)
hwware in commit 8a9c84f4a:
add include guard for lolwut.h
1 file changed, 6 insertions(+)
antirez in commit cb683a84f:
Don't propagate spurious MULTI on DEBUG LOADAOF.
2 files changed, 6 insertions(+), 3 deletions(-)
antirez in commit 84d9766d6:
Dump recent backlog on master query generating errors.
1 file changed, 29 insertions(+)
Titouan Christophe in commit ec1e106ec:
make struct user anonymous (only typedefed)
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit e48c37316:
Test: --dont-clean should do first cleanup.
1 file changed, 2 insertions(+), 5 deletions(-)
Benjamin Sergeant in commit 1e561cfaa:
Add --user argument to redis-benchmark.c (ACL)
1 file changed, 15 insertions(+), 2 deletions(-)
antirez in commit d1af82a88:
Drop not needed part from #7194.
1 file changed, 1 insertion(+), 1 deletion(-)
Muhammad Zahalqa in commit 897a360d0:
Fix compiler warnings on function rev(unsigned long)
1 file changed, 3 insertions(+), 3 deletions(-)
antirez in commit ac316d8cc:
Move CRC64 initialization in main().
2 files changed, 1 insertion(+), 4 deletions(-)
antirez in commit fc7bc3204:
Fix CRC64 initialization outside the Redis server itself.
1 file changed, 3 insertions(+)
hwware in commit a6e55c096:
Client Side Caching: Add Tracking Prefix Number Stats in Server Info
3 files changed, 8 insertions(+)
antirez in commit b062fd523:
Fix NetBSD build by fixing redis\_set\_thread\_title() support.
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit 4efb25d9c:
Rework a bit the documentation for CPU pinning.
2 files changed, 18 insertions(+), 8 deletions(-)
zhenwei pi in commit d6436eb7c:
Support setcpuaffinity on linux/bsd
12 files changed, 180 insertions(+), 1 deletion(-)
Guy Benoish in commit 3a441c7d9:
XPENDING should not update consumer's seen-time
4 files changed, 33 insertions(+), 20 deletions(-)
Oran Agra in commit 75addb4fe:
optimize memory usage of deferred replies - fixed
1 file changed, 29 insertions(+)
Deliang Yang in commit c57d9146f:
reformat code
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 3d3861dd8:
add daily github actions with libc malloc and valgrind
5 files changed, 106 insertions(+), 18 deletions(-)
================================================================================
Redis 6.0.1 Released Sat May 02 00:06:07 CEST 2020
================================================================================
Upgrade urgency HIGH: This release fixes a crash when builiding against
Libc malloc.
Here we revert 8110ba888, an optimization that causes a crash due to a
bug in the code. It does not happen with the default allocator because of
differences between Jemalloc and libc malloc, so this escaped all our
testing but was reported by a user. We'll add back the original optimization
that was reverted here later, after checking what happens: it is not a
critical optimization.
The other commits are minor stuff:
antirez in commit db73d0998:
Cast printf() argument to the format specifier.
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit 7c0fe7271:
Revert "optimize memory usage of deferred replies"
1 file changed, 31 deletions(-)
antirez in commit 8fe25edc7:
Save a call to stopThreadedIOIfNeeded() for the base case.
1 file changed, 3 insertions(+), 3 deletions(-)
================================================================================
Redis 6.0.0 GA Released Thu Apr 30 14:55:02 CEST 2020
================================================================================
Upgrade urgency CRITICAL: many bugs fixed compared to the last release
candidate. Better to upgrade if you see things
affecting your environment in the changelog.
Hi all, finally we have Redis 6.0.0 GA! Enjoy this new Redis release.
Most of the documentation was updated today so that you can likely
find what you are looking for about the new features at redis.io.
This is the list of what changed compared to the previoius release candidate:
\* XCLAIM AOF/replicas propagation fixed.
\* Client side caching: new NOLOOP option to avoid getting notified about
changes performed by ourselves.
\* ACL GENPASS now uses HMAC-SHA256 and have an optional "bits" argument.
It means you can use it as a general purpose "secure random strings"
primitive!
\* Cluster "SLOTS" subcommand memory optimization.
\* The LCS command is now a subcommand of STRALGO.
\* Meaningful offset for replicas as well. More successful partial
resynchronizations.
\* Optimize memory usage of deferred replies.
\* Faster CRC64 algorithm for faster RDB loading.
\* XINFO STREAM FULL, a new subcommand to get the whole stream state.
\* CLIENT KILL USER .
\* MIGRATE AUTH2 option, for ACL style authentication support.
\* Other random bugfixes.
Enjoy Redis 6! :-)
Goodbye antirez
List of commits in this release:
antirez in commit 1f9b82bd5:
Update help.h again before Redis 6 GA.
1 file changed, 17 insertions(+), 12 deletions(-)
antirez in commit 3fcffe7d0:
redis-cli: fix hints with subcommands.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 455d8a05c:
redis-cli command help updated.
1 file changed, 165 insertions(+), 25 deletions(-)
zhaozhao.zz in commit 70287bbc9:
lazyfree & eviction: record latency generated by lazyfree eviction
1 file changed, 18 insertions(+), 13 deletions(-)
antirez in commit 7be21139a:
MIGRATE AUTH2 for ACL support.
1 file changed, 19 insertions(+), 5 deletions(-)
antirez in commit e1ee1a49d:
CLIENT KILL USER .
1 file changed, 11 insertions(+)
antirez in commit d56f058c0:
Fix tracking table max keys option in redis.conf.
1 file changed, 12 insertions(+), 9 deletions(-)
antirez in commit 96dd5fc93:
redis-cli: safer cluster fix with unreachalbe masters.
1 file changed, 26 insertions(+), 1 deletion(-)
antirez in commit 5b59d9c5d:
redis-cli: simplify cluster nodes coverage display.
1 file changed, 10 insertions(+), 17 deletions(-)
antirez in commit c163d4add:
redis-cli: try to make clusterManagerFixOpenSlot() more readable.
1 file changed, 25 insertions(+), 6 deletions(-)
Guy Benoish in commit aab74b715:
XINFO STREAM FULL should have a default COUNT of 10
1 file changed, 8 insertions(+), 4 deletions(-)
antirez in commit 606134f9d:
Comment clearly why we moved some code in #6623.
1 file changed, 4 insertions(+), 1 deletion(-)
srzhao in commit ee627bb66:
fix pipelined WAIT performance issue.
1 file changed, 13 insertions(+), 13 deletions(-)
antirez in commit 47b8a7f9b:
Fix create-cluster BIN\_PATH.
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Benoish in commit 6c0bc608a:
Extend XINFO STREAM output
2 files changed, 226 insertions(+), 34 deletions(-)
hwware in commit 5bfc18950:
Fix not used marco in cluster.c
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit 56d628f85:
Update create-cluster
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit cac9d7cf7:
Adds `BIN\_PATH` to create-cluster
1 file changed, 8 insertions(+), 6 deletions(-)
Oran Agra in commit b712fba17:
hickup, re-fix dictEncObjKeyCompare
1 file changed, 4 insertions(+), 4 deletions(-)
Oran Agra in commit ea63aea72:
fix loading race in psync2 tests
3 files changed, 15 insertions(+), 1 deletion(-)
antirez in commit 64e588bfa:
Rework comment in dictEncObjKeyCompare().
1 file changed, 8 insertions(+), 9 deletions(-)
Oran Agra in commit 0d1e8c93b:
allow dictFind using static robj
1 file changed, 9 insertions(+), 4 deletions(-)
Madelyn Olson in commit a1bed447b:
Added crcspeed library
2 files changed, 341 insertions(+)
Madelyn Olson in commit a75fa3aad:
Made crc64 test consistent
1 file changed, 3 insertions(+), 2 deletions(-)
Madelyn Olson in commit 52c75e9db:
Implemented CRC64 based on slice by 4
5 files changed, 124 insertions(+), 157 deletions(-)
Oran Agra in commit 8110ba888:
optimize memory usage of deferred replies
1 file changed, 31 insertions(+)
Oran Agra in commit e4d2bb62b:
Keep track of meaningful replication offset in replicas too
5 files changed, 212 insertions(+), 92 deletions(-)
antirez in commit fea9788cc:
Fix STRALGO command flags.
1 file changed, 1 insertion(+), 1 deletion(-)
Dave-in-lafayette in commit 2144047e1:
fix for unintended crash during panic response
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Benoish in commit 43329c9b6:
Add the stream tag to XSETID tests
1 file changed, 1 insertion(+), 1 deletion(-)
Dave-in-lafayette in commit 1e17d3de7:
fix for crash during panic before all threads are up
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 3722f89f4:
LCS -> STRALGO LCS.
4 files changed, 28 insertions(+), 15 deletions(-)
antirez in commit 373ae6061:
Also use propagate() in streamPropagateGroupID().
1 file changed, 11 insertions(+), 1 deletion(-)
yanhui13 in commit f03f1fad6:
add tcl test for cluster slots
1 file changed, 44 insertions(+)
yanhui13 in commit 374ffdf1c:
optimize the output of cluster slots
1 file changed, 7 insertions(+), 4 deletions(-)
antirez in commit 4db38d2ef:
Minor aesthetic changes to #7135.
1 file changed, 5 insertions(+), 7 deletions(-)
Valentino Geron in commit f0a261448:
XREADGROUP with NOACK should propagate only one XGROUP SETID command
1 file changed, 13 insertions(+), 7 deletions(-)
antirez in commit fbdef6a9b:
ACL: re-enable command execution of disabled users.
1 file changed, 4 deletions(-)
antirez in commit 05a41da75:
getRandomBytes(): use HMAC-SHA256.
1 file changed, 30 insertions(+), 10 deletions(-)
antirez in commit 345c3768d:
ACL GENPASS: take number of bits as argument.
1 file changed, 21 insertions(+), 6 deletions(-)
antirez in commit 639c8a1d9:
ACL GENPASS: emit 256 bits instead of 128.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 321acea03:
ACL: deny commands execution of disabled users.
1 file changed, 4 insertions(+)
Theo Buehler in commit b0920e6e8:
TLS: Fix build with SSL\_OP\_NO\_CLIENT\_RENEGOTIATION
1 file changed, 1 insertion(+), 1 deletion(-)
Yossi Gottlieb in commit 149b658b5:
TLS: Fix build on older verisons of OpenSSL.
1 file changed, 2 insertions(+)
antirez in commit 06917e581:
Tracking: test expired keys notifications.
1 file changed, 13 insertions(+)
antirez in commit e434b2ce4:
Tracking: NOLOOP tests.
1 file changed, 32 insertions(+)
antirez in commit f3a172887:
Tracking: signal key as modified when evicting.
1 file changed, 1 insertion(+)
antirez in commit e63bb7ec8:
Tracking: NOLOOP further implementation and fixes.
2 files changed, 21 insertions(+), 6 deletions(-)
antirez in commit 6791ff052:
Tracking: NOLOOP internals implementation.
17 files changed, 174 insertions(+), 112 deletions(-)
antirez in commit 725b8cc68:
Implement redis\_set\_thread\_title for MacOS.
1 file changed, 6 insertions(+)
zhenwei pi in commit 3575b8706:
Threaded IO: set thread name for redis-server
3 files changed, 28 insertions(+)
antirez in commit a76c67578:
Sentinel: small refactoring of sentinelCollectTerminatedScripts().
1 file changed, 1 insertion(+), 2 deletions(-)
omg-by in commit 3a27064c4:
fix(sentinel): sentinel.running\_scripts will always increase more times and not reset
1 file changed, 1 insertion(+)
antirez in commit 5c4c73e2c:
A few comments and name changes for #7103.
1 file changed, 13 insertions(+), 4 deletions(-)
Oran Agra in commit 6148f9493:
testsuite run the defrag latency test solo
3 files changed, 42 insertions(+), 2 deletions(-)
Jamie Scott in commit 51d3012d4:
Adding acllog-max-len to Redis.conf
1 file changed, 9 insertions(+)
antirez in commit c39f16c42:
Fix XCLAIM propagation in AOF/replicas for blocking XREADGROUP.
2 files changed, 8 insertions(+), 3 deletions(-)
================================================================================
Redis 6.0-rc4 Released Thu Apr 16 16:10:35 CEST 2020
================================================================================
Upgrade urgency LOW: If you are using RC3 without issues, don't rush.
Hi all, this the latest release candidate of Redis 6. This is likely to
be very similar to what you'll see in Redis 6 GA. Please test it and
report any issue :-)
Main changes in this release:
\* Big INFO speedup when using a lot of of clients.
\* Big speedup on all the blocking commands: now blocking
on the same key is O(1) instead of being O(N).
\* Stale replicas now allow MULTI/EXEC.
\* New command: LCS (Longest Common Subsequence).
\* Add a new configuration to make DEL like UNLINK.
\* RDB loading speedup.
\* Many bugs fixed (see the commit messages at the end of this node)
See you in 14 days for Redis 6 GA.
List of commits:
antirez in commit 9f594e243:
Update SDS to latest version.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 48781dd95:
RESP3: fix HELLO map len in Sentinel mode.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 371ab0cff:
Don't allow empty spaces in ACL usernames.
1 file changed, 36 insertions(+), 8 deletions(-)
antirez in commit b86140ac5:
Don't allow empty spaces in ACL key patterns.
1 file changed, 12 insertions(+), 1 deletion(-)
liumiuyong in commit a7ee3c3e7:
FIX: truncate max/min longitude,latitude related geo\_point (ex: {180, 85.05112878} )
1 file changed, 4 insertions(+)
Guy Benoish in commit e5b9eb817:
Typo in getTimeoutFromObjectOrReply's error reply
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 0f31bb5c1:
Fix HELLO reply in Sentinel mode, see #6160.
1 file changed, 1 insertion(+), 1 deletion(-)
hwware in commit b92d9a895:
fix spelling in acl.c
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit 8f896e57a:
Fix zsetAdd() top comment spelling.
1 file changed, 3 insertions(+), 3 deletions(-)
hayleeliu in commit 8f5157058:
fix spelling mistake in bitops.c
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit ddeda9ceb:
Fix function names in zslDeleteNode() top comment.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit bde1f0a8e:
RESP3: change streams items from maps to arrays.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit bec68bff2:
Use the special static refcount for stack objects.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 0f239e51b:
RDB: refactor some RDB loading code into dbAddRDBLoad().
3 files changed, 22 insertions(+), 4 deletions(-)
antirez in commit f855db61b:
incrRefCount(): abort on statically allocated object.
2 files changed, 12 insertions(+), 2 deletions(-)
antirez in commit 23094ba01:
More powerful DEBUG RELOAD.
3 files changed, 55 insertions(+), 16 deletions(-)
antirez in commit 8161a7a3e:
RDB: clarify a condition in rdbLoadRio().
2 files changed, 9 insertions(+), 2 deletions(-)
antirez in commit 61b153073:
RDB: load files faster avoiding useless free+realloc.
7 files changed, 40 insertions(+), 28 deletions(-)
antirez in commit 414debfd0:
Speedup: unblock clients on keys in O(1).
4 files changed, 50 insertions(+), 23 deletions(-)
antirez in commit cbcd07777:
Fix ACL HELP table missing comma.
1 file changed, 12 insertions(+), 12 deletions(-)
mymilkbottles in commit 2437455f2:
Judge the log level in advance
1 file changed, 1 insertion(+)
antirez in commit 35c64b898:
Speedup INFO by counting client memory incrementally.
4 files changed, 52 insertions(+), 26 deletions(-)
qetu3790 in commit c3ac71748:
fix comments about RESIZE DB opcode in rdb.c
1 file changed, 1 insertion(+), 4 deletions(-)
antirez in commit c8dbcff9d:
Clarify redis.conf comment about lazyfree-lazy-user-del.
1 file changed, 9 insertions(+), 5 deletions(-)
zhaozhao.zz in commit abd5156f2:
lazyfree: add a new configuration lazyfree-lazy-user-del
4 files changed, 7 insertions(+), 2 deletions(-)
antirez in commit 5719b3054:
LCS: more tests.
1 file changed, 8 insertions(+)
antirez in commit c89e1f293:
LCS: allow KEYS / STRINGS to be anywhere.
1 file changed, 6 deletions(-)
antirez in commit 0b16f8d44:
LCS tests.
1 file changed, 22 insertions(+)
antirez in commit 9254a805d:
LCS: get rid of STOREIDX option. Fix get keys helper.
2 files changed, 20 insertions(+), 21 deletions(-)
antirez in commit a4c490703:
LCS: fix stale comment.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit cb92c23de:
LCS: output LCS len as well in IDX mode.
1 file changed, 6 insertions(+), 1 deletion(-)
antirez in commit 56a52e804:
LCS: MINMATCHLEN and WITHMATCHLEN options.
1 file changed, 24 insertions(+), 11 deletions(-)
antirez in commit ebb09a5c3:
LCS: 7x speedup by accessing the array with better locality.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit a9f8a8cba:
LCS: implement KEYS option.
1 file changed, 18 insertions(+), 2 deletions(-)
antirez in commit 4aa24e62a:
LCS: other fixes to range emission.
1 file changed, 20 insertions(+), 16 deletions(-)
antirez in commit 2b67b6b87:
LCS: fix emission of last range starting at index 0.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 420aac727:
LCS: implement range indexes option.
1 file changed, 59 insertions(+), 9 deletions(-)
antirez in commit a518a9a76:
LCS: initial functionality implemented.
4 files changed, 156 insertions(+), 1 deletion(-)
srzhao in commit 026cc11b0:
Check OOM at script start to get stable lua OOM state.
3 files changed, 11 insertions(+), 4 deletions(-)
Oran Agra in commit 02b594f6a:
diffrent fix for runtest --host --port
2 files changed, 13 insertions(+), 13 deletions(-)
Guy Benoish in commit f695d1830:
Try to fix time-sensitive tests in blockonkey.tcl
1 file changed, 54 insertions(+), 1 deletion(-)
Guy Benoish in commit 0e42cfc36:
Use \_\_attribute\_\_ only if \_\_GNUC\_\_ is defined
1 file changed, 12 insertions(+), 3 deletions(-)
Guy Benoish in commit 91ed9b3c4:
Modules: Perform printf-like format checks in variadic API
1 file changed, 3 insertions(+), 3 deletions(-)
Valentino Geron in commit 3e0d20962:
XREAD and XREADGROUP should not be allowed from scripts when BLOCK option is being used
3 files changed, 18 insertions(+), 2 deletions(-)
Guy Benoish in commit 240094c9b:
Stale replica should allow MULTI/EXEC
1 file changed, 3 insertions(+), 3 deletions(-)
Xudong Zhang in commit 209f3a1eb:
fix integer overflow
1 file changed, 2 insertions(+), 2 deletions(-)
Guy Benoish in commit 024c380b9:
Fix no-negative-zero test
1 file changed, 1 insertion(+)
Oran Agra in commit a38ff404b:
modules don't signalModifiedKey in setKey() since that's done (optionally) in RM\_CloseKey
4 files changed, 8 insertions(+), 8 deletions(-)
Oran Agra in commit 814874d68:
change CI to build and run the module api tests
1 file changed, 2 insertions(+)
Oran Agra in commit 061616c1b:
fix possible warning on incomplete struct init
1 file changed, 1 insertion(+), 1 deletion(-)
Guy Benoish in commit 7764996be:
Make sure Redis does not reply with negative zero
2 files changed, 10 insertions(+)
Guy Benoish in commit eba28e2ce:
DEBUG OBJECT should pass keyname to module when loading
3 files changed, 4 insertions(+), 4 deletions(-)
David Carlier in commit 15c9e79a7:
debug, dump registers on arm too.
1 file changed, 55 insertions(+), 27 deletions(-)
hwware in commit cd2b5df97:
fix spelling in cluster.c
1 file changed, 1 insertion(+), 1 deletion(-)
Valentino Geron in commit 8cdc153f5:
XACK should be executed in a "all or nothing" fashion.
2 files changed, 23 insertions(+), 1 deletion(-)
hwware in commit b35407fa7:
add check for not switching between optin optout mode directly
1 file changed, 12 insertions(+), 1 deletion(-)
hwware in commit 4395889c9:
add check for not providing both optin optout flag
1 file changed, 8 insertions(+)
Guy Benoish in commit 1907e0f18:
PERSIST should notify a keyspace event
1 file changed, 1 insertion(+)
Guy Benoish in commit c35a53169:
streamReplyWithRange: Redundant XSETIDs to replica
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 6fe66e096:
Simplify comment in moduleTryServeClientBlockedOnKey().
1 file changed, 3 insertions(+), 12 deletions(-)
Guy Benoish in commit 193fc241c:
Fix memory corruption in moduleHandleBlockedClients
3 files changed, 149 insertions(+), 46 deletions(-)
================================================================================
Redis 6.0-rc3 Released Tue Mar 31 17:42:39 CEST 2020
================================================================================
Upgrade urgency CRITICAL: A connection management bug introduced with the
SSL implementation can crash Redis easily.
Dear users, this is a list of the major changes in this release, please check
the list of commits for detail:
\* Fix crash due to refactoring for SSL, for the connection code.
\* Precise timeouts for blocking commands. Now the timeouts have HZ
resolution regardless of the number of connected clinets. New timeouts
are stored in a radix tree and sorted by expire time.
\* Fix rare crash when resizing the event loop because of CONFIG maxclients.
\* Fix systemd readiness after successful partial resync.
\* Redis-cli ask password mode to be prompted at startup (for additional safety).
\* Keyspace notifications added to MIGRATE / RESTORE.
\* Threaded I/O bugs fixed.
\* Implement new ACL style AUTH in Sentinel.
\* Make 'requirepass' more backward compatible with Redis <= 5.
\* ACL: Handle default user as disabled if it's off regardless of "nopass".
\* Fix a potential inconsistency when upgrading an instance in Redis Cluster
and restarting it. The instance will act as a replica but will actually be
set as a master immediately. However the choice of what to do with already
expired keys, on loading, was made from the POV of replicas.
\* Abort transactions after -READONLY error.
\* Many different fixes to module APIs.
\* BITFIELD\_RO added to call the command on read only replicas.
\* PSYNC2: meaningful offset implementation. Allow the disconnected master
that is still sending PINGs to replicas, to be able to successfully
PSYNC incrementally to new slaves, discarding the last part of the
replication backlog consisting only of PINGs.
\* Fix pipelined MULTI/EXEC during Lua scripts are in BUSY state.
\* Re-fix propagation API in modules, broken again after other changes.
antirez in commit ef1b1f01:
cast raxSize() to avoid warning with format spec.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 9f347fab:
Minor changes to #7037.
2 files changed, 14 insertions(+), 5 deletions(-)
Guy Benoish in commit a509400d:
Modules: Test MULTI/EXEC replication of RM\_Replicate
6 files changed, 49 insertions(+), 9 deletions(-)
Guy Benoish in commit 805c8c94:
RENAME can unblock XREADGROUP
3 files changed, 25 insertions(+), 1 deletion(-)
antirez in commit 97b80b57:
Fix the propagate Tcl test after module changes.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 4f6b6b80:
Modify the propagate unit test to show more cases.
1 file changed, 30 insertions(+), 2 deletions(-)
antirez in commit 616b1cb7:
Fix module commands propagation double MULTI bug.
4 files changed, 25 insertions(+), 8 deletions(-)
antirez in commit 08fdef4b:
Fix RM\_Call() stale comment due to cut&paste.
1 file changed, 1 insertion(+), 3 deletions(-)
OMG-By in commit 26b79ca1:
fix: dict.c->dictResize()->minimal type
1 file changed, 1 insertion(+), 1 deletion(-)
zhaozhao.zz in commit fa418637:
PSYNC2: reset backlog\_idx and master\_repl\_offset correctly
1 file changed, 10 insertions(+), 5 deletions(-)
antirez in commit bbbc80ac:
Precise timeouts: reference client pointer directly.
1 file changed, 13 insertions(+), 16 deletions(-)
antirez in commit c3b268a0:
timeout.c created: move client timeouts code there.
5 files changed, 198 insertions(+), 167 deletions(-)
Oran Agra in commit 0f7dfc37:
AOFRW on an empty stream created with MKSTREAM loads badkly
2 files changed, 15 insertions(+), 1 deletion(-)
antirez in commit 67643ead:
Precise timeouts: cleaup the table on unblock.
3 files changed, 21 insertions(+), 2 deletions(-)
antirez in commit ad94066e:
Precise timeouts: fix comments after functional change.
2 files changed, 6 insertions(+), 6 deletions(-)
antirez in commit a443ec2e:
Precise timeouts: use only radix tree for timeouts.
3 files changed, 15 insertions(+), 38 deletions(-)
antirez in commit 6862fd70:
Precise timeouts: fast exit for clientsHandleShortTimeout().
1 file changed, 1 insertion(+)
antirez in commit 30f1df8c:
Precise timeouts: fix bugs in initial implementation.
2 files changed, 5 insertions(+), 1 deletion(-)
antirez in commit 7add0f24:
Precise timeouts: working initial implementation.
3 files changed, 110 insertions(+), 28 deletions(-)
antirez in commit 9d6d1779:
Precise timeouts: refactor unblocking on timeout.
2 files changed, 33 insertions(+), 13 deletions(-)
antirez in commit 316a8f15:
PSYNC2: fix backlog\_idx when adjusting for meaningful offset
1 file changed, 3 insertions(+)
伯成 in commit 11db53f8:
Boost up performance for redis PUB-SUB patterns matching
3 files changed, 43 insertions(+), 11 deletions(-)
antirez in commit e257f121:
PSYNC2: meaningful offset test.
2 files changed, 62 insertions(+)
antirez in commit 5f72f696:
PSYNC2: meaningful offset implemented.
3 files changed, 40 insertions(+), 1 deletion(-)
antirez in commit 8caa2714:
Explain why we allow transactions in -BUSY state.
1 file changed, 9 insertions(+), 2 deletions(-)
Oran Agra in commit e43cd831:
MULTI/EXEC during LUA script timeout are messed up
2 files changed, 73 insertions(+)
antirez in commit 34b89832:
Improve comments of replicationCacheMasterUsingMyself().
1 file changed, 6 insertions(+), 1 deletion(-)
antirez in commit 70a98a43:
Fix BITFIELD\_RO test.
2 files changed, 5 insertions(+), 5 deletions(-)
antirez in commit 8783304a:
Abort transactions after -READONLY error. Fix #7014.
1 file changed, 1 insertion(+)
antirez in commit ec9cf002:
Minor changes to BITFIELD\_RO PR #6951.
1 file changed, 9 insertions(+), 6 deletions(-)
bodong.ybd in commit b3e4abf0:
Added BITFIELD\_RO variants for read-only operations.
4 files changed, 54 insertions(+), 1 deletion(-)
antirez in commit 50f8f950:
Modules: updated function doc after #7003.
1 file changed, 6 insertions(+), 1 deletion(-)
Guy Benoish in commit f2f3dc5e:
Allow RM\_GetContextFlags to work with ctx==NULL
1 file changed, 16 insertions(+), 14 deletions(-)
hwware in commit eb808879:
fix potentical memory leak in redis-cli
1 file changed, 2 insertions(+)
Yossi Gottlieb in commit cdcab0e8:
Fix crashes related to failed/rejected accepts.
1 file changed, 6 insertions(+), 5 deletions(-)
Yossi Gottlieb in commit 50dcd9f9:
Cluster: fix misleading accept errors.
1 file changed, 4 insertions(+), 3 deletions(-)
Yossi Gottlieb in commit 87dbd8f5:
Conns: Fix connClose() / connAccept() behavior.
3 files changed, 48 insertions(+), 32 deletions(-)
hwware in commit 81e8686c:
remove redundant Semicolon
1 file changed, 1 insertion(+), 1 deletion(-)
hwware in commit c7524a7e:
clean CLIENT\_TRACKING\_CACHING flag when disabled caching
1 file changed, 1 insertion(+), 1 deletion(-)
hwware in commit 2dd1ca6a:
add missing commands in cluster help
1 file changed, 2 insertions(+), 1 deletion(-)
artix in commit 95324b81:
Support Redis Cluster Proxy PROXY INFO command
1 file changed, 5 insertions(+), 1 deletion(-)
박승현 in commit 04c53fa1:
Update redis.conf
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit 0578157d:
Fix master replica inconsistency for upgrading scenario.
3 files changed, 9 insertions(+), 2 deletions(-)
WuYunlong in commit 299f1d02:
Add 14-consistency-check.tcl to prove there is a data consistency issue.
1 file changed, 87 insertions(+)
antirez in commit 61b98f32:
Regression test for #7011.
1 file changed, 7 insertions(+)
antirez in commit 34ea2f4e:
ACL: default user off should not allow automatic authentication.
2 files changed, 3 insertions(+), 2 deletions(-)
antirez in commit cbbf9b39:
Sentinel: document auth-user directive.
1 file changed, 12 insertions(+)
antirez in commit 9c2e42dd:
ACL: Make Redis 6 more backward compatible with requirepass.
4 files changed, 17 insertions(+), 15 deletions(-)
antirez in commit d387f67d:
Sentinel: implement auth-user directive for ACLs.
1 file changed, 38 insertions(+), 7 deletions(-)
zhaozhao.zz in commit 7c078416:
Threaded IO: bugfix client kill may crash redis
1 file changed, 11 insertions(+), 5 deletions(-)
zhaozhao.zz in commit 9cc7038e:
Threaded IO: handle pending reads clients ASAP after event loop
1 file changed, 3 insertions(+), 1 deletion(-)
antirez in commit da8c7c49:
Example sentinel conf: document requirepass.
1 file changed, 8 insertions(+)
antirez in commit bdb338cf:
Aesthetic changes in PR #6989.
1 file changed, 9 insertions(+), 5 deletions(-)
zhaozhao.zz in commit b3e03054:
Threaded IO: bugfix #6988 process events while blocked
1 file changed, 5 insertions(+)
antirez in commit e628f944:
Restore newline at the end of redis-cli.c
1 file changed, 2 insertions(+), 1 deletion(-)
chendianqiang in commit 5d4c4df3:
use correct list for moduleUnregisterUsedAPI
1 file changed, 1 insertion(+), 1 deletion(-)
guodongxiaren in commit da14982d:
string literal should be const char\*
1 file changed, 1 insertion(+), 1 deletion(-)
Itamar Haber in commit dc8885a1:
Adds keyspace notifications to migrate and restore
1 file changed, 3 insertions(+), 1 deletion(-)
bodong.ybd in commit bfb18e55:
Remove duplicate obj files in Makefile
1 file changed, 2 insertions(+), 2 deletions(-)
bodong.ybd in commit 76d57161:
Fix bug of tcl test using external server
2 files changed, 8 insertions(+), 2 deletions(-)
fengpf in commit 0e5820d8:
fix comments in latency.c
2 files changed, 2 insertions(+), 1 deletion(-)
antirez in commit 916dd79f:
Update linenoise.
1 file changed, 2 insertions(+), 1 deletion(-)
lifubang in commit c0c67c9b:
add askpass mode
1 file changed, 19 insertions(+), 1 deletion(-)
lifubang in commit e1c29434:
update linenoise to https://github.com/antirez/linenoise/tree/fc9667a81d43911a6690fb1e68c16e6e3bb8df05
4 files changed, 59 insertions(+), 4 deletions(-)
Jamie Scott in commit e5a063bc:
Remove default guidance in Redis.conf
1 file changed, 1 insertion(+), 2 deletions(-)
Jamie Scott in commit d28cbaf7:
Update Redis.conf to improve TLS usability
1 file changed, 2 insertions(+), 1 deletion(-)
Johannes Truschnigg in commit 23d5e8b8:
Signal systemd readiness atfer Partial Resync
1 file changed, 4 insertions(+)
Oran Agra in commit 61738154:
fix for flaky psync2 test
1 file changed, 21 insertions(+)
antirez in commit 70e0e499:
ae.c: fix crash when resizing the event loop.
1 file changed, 6 insertions(+), 2 deletions(-)
antirez in commit b3e4aa67:
Fix release notes spelling mistake.
1 file changed, 1 insertion(+), 1 deletion(-)
================================================================================
Redis 6.0 RC2 Released Thu Mar 05 15:40:53 CET 2020
================================================================================
Upgrade urgency MODERATE: Normal bugfixing release of a non-GA branch.
Hi Redis users, Redis 6 is approaching and will be released 30th of April.
New release candidates will be released at the end of March, then another
one mid April, to finally reach the GA at the end of April.
Redis 6 RC2 brings many fixes and new things, especially in the area of
client side caching. This is the list of big changes in this release. As
usually you can find the full list of commits at the end:
New features and improvements:
\* ACL LOG: log denied commands, keys accesses and authentications.
\* Client side caching redesigned. Now we use keys not caching slots.
\* Client side caching: Broadcasting mode implemented.
\* Client side caching: OPTIN/OPTOUT modes implemented.
\* Remove RDB files used for replication in persistence-less instances (option).
Fixes (only selected ones, see commits for all the fixes):
\* Different fixes to streams in edge cases.
\* Fix duplicated CLIENT SETNAME reply because of RESP3 changes.
\* Fix crash due to new active expire division by zero.
\* Avoid sentinel changes promoted\_slave to be its own replica.
\* Fix bug on KEYS command where pattern starts with \* followed by \x00.
\* Threaded I/O: now the main thread is used as well to do I/O.
\* Many fixes to modules APIs, and more to come in the next RCs.
\* ld2string should fail if string contains \0 in the middle.
\* Make the Redis test more reliable.
\* Fix SPOP returning nil (see #4709). WARNING: API change.
qetu3790 in commit 4af0d7fd:
Fix not used constant in lru\_test\_mode.
1 file changed, 1 insertion(+), 1 deletion(-)
hwware in commit 6ef01878:
add missing file marco
1 file changed, 5 insertions(+)
ShooterIT in commit fe81d5c8:
Avoid compiler warnings
1 file changed, 1 insertion(+)
antirez in commit c2f01d7f:
RDB deletion: document it in example redis.conf.
1 file changed, 13 insertions(+)
antirez in commit 127e09bc:
Make sync RDB deletion configurable. Default to no.
3 files changed, 22 insertions(+), 4 deletions(-)
antirez in commit a20303c6:
Check that the file exists in removeRDBUsedToSyncReplicas().
1 file changed, 8 insertions(+), 4 deletions(-)
antirez in commit 7a23b945:
Log RDB deletion in persistence-less instances.
1 file changed, 15 insertions(+), 2 deletions(-)
antirez in commit baaf869f:
Introduce bg\_unlink().
1 file changed, 31 insertions(+), 3 deletions(-)
antirez in commit be4bc1a5:
Remove RDB files used for replication in persistence-less instances.
3 files changed, 56 insertions(+), 1 deletion(-)
antirez in commit 07dc1b42:
Use a smaller getkeys global buffer.
1 file changed, 1 insertion(+), 1 deletion(-)
Oran Agra in commit 10e71b3d:
Optimize temporary memory allocations for getKeysFromCommand mechanism
1 file changed, 31 insertions(+), 10 deletions(-)
antirez in commit edc0ed14:
Modules: reformat RM\_Scan() top comment a bit.
1 file changed, 21 insertions(+), 12 deletions(-)
antirez in commit c5319612:
Modules: more details in RM\_Scan API top comment.
1 file changed, 22 insertions(+), 6 deletions(-)
Oran Agra in commit fff6b26a:
RM\_Scan disable dict rehashing
2 files changed, 21 insertions(+), 6 deletions(-)
Guy Benoish in commit 65048460:
Add RM\_CreateStringFromDouble
2 files changed, 14 insertions(+)
Oran Agra in commit 3144a278:
add no\_auth to COMMAND INFO
1 file changed, 1 insertion(+)
Oran Agra in commit afe0b16c:
module api docs for aux\_save and aux\_load
2 files changed, 7 insertions(+), 1 deletion(-)
Guy Benoish in commit df152b0c:
streamReplyWithRangeFromConsumerPEL: Redundant streamDecodeID
1 file changed, 1 insertion(+), 3 deletions(-)
antirez in commit e3c1f439:
Show Redis version when not understanding a config directive.
1 file changed, 2 insertions(+), 1 deletion(-)
antirez in commit 141c0679:
Changelog: explain Redis 6 SPOP change.
1 file changed, 4 insertions(+), 1 deletion(-)
bodong.ybd in commit fe902461:
Fix spop return nil #4709
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 9d4219eb:
Fix SDS misuse in enumConfigSet(). Related to #6778.
1 file changed, 3 insertions(+), 3 deletions(-)
antirez in commit 84243064:
Remove useless comment from enumConfigSet().
1 file changed, 1 deletion(-)
Ponnuvel Palaniyappan in commit dafb94db:
Fix a potential overflow with strncpy
1 file changed, 5 insertions(+), 5 deletions(-)
antirez in commit ea697b63:
Improve aeDeleteEventLoop() top comment grammar.
1 file changed, 2 insertions(+), 1 deletion(-)
wangyuan21 in commit dd479880:
free time event when delete eventloop
1 file changed, 7 insertions(+)
srzhao in commit ecf3b2ef:
fix impl of aof-child whitelist SIGUSR1 feature.
1 file changed, 5 insertions(+), 4 deletions(-)
meir@redislabs.com in commit 2966132c:
Changed log level for module fork api from 'notice' to 'verbos'.
1 file changed, 2 insertions(+), 2 deletions(-)
hwware in commit 7277e5d8:
format fix
1 file changed, 1 insertion(+), 1 deletion(-)
hwware in commit 1bb5ee9c:
fix potentical memory leaks
1 file changed, 4 insertions(+), 1 deletion(-)
Hengjian Tang in commit 97329733:
modify the read buf size according to the write buf size PROTO\_IOBUF\_LEN defined before
1 file changed, 1 insertion(+), 1 deletion(-)
Ariel in commit 15ea1324:
fix ThreadSafeContext lock/unlock function names
1 file changed, 2 insertions(+), 2 deletions(-)
Guy Benoish in commit 4d12c37c:
XREADGROUP should propagate XCALIM/SETID in MULTI/EXEC
1 file changed, 2 insertions(+), 2 deletions(-)
Oran Agra in commit 12626ce9:
fix race in module api test for fork
2 files changed, 2 insertions(+), 3 deletions(-)
Guy Benoish in commit 2ecab0b6:
Modules: Do not auto-unblock clients if not blocked on keys
1 file changed, 22 insertions(+), 7 deletions(-)
Oran Agra in commit 635321d4:
fix github actions failing latency test for active defrag - part 2
2 files changed, 5 insertions(+), 4 deletions(-)
Oran Agra in commit 0b988fa9:
fix github actions failing latency test for active defrag
2 files changed, 14 insertions(+), 13 deletions(-)
Oran Agra in commit 60096bc1:
Fix latency sensitivity of new defrag test
1 file changed, 32 insertions(+), 8 deletions(-)
antirez in commit b4395426:
Tracking: optin/out implemented.
3 files changed, 82 insertions(+), 16 deletions(-)
antirez in commit ef3551d1:
Test engine: experimental change to avoid busy port problems.
1 file changed, 84 insertions(+), 49 deletions(-)
antirez in commit 72c05351:
Test engine: detect timeout when checking for Redis startup.
1 file changed, 11 insertions(+), 1 deletion(-)
antirez in commit 294c9af4:
Test engine: better tracking of what workers are doing.
2 files changed, 12 insertions(+), 4 deletions(-)
hwware in commit ba027079:
add missing subcommand description for debug oom
1 file changed, 1 insertion(+)
Guy Benoish in commit 5d0890c0:
Fix memory leak in test\_ld\_conv
1 file changed, 4 insertions(+)
Madelyn Olson in commit d1f22eac:
Give an error message if you specify redirect twice
1 file changed, 7 insertions(+)
Madelyn Olson in commit 762fbcb6:
Minor CSC fixes and fixed documentation
2 files changed, 16 insertions(+), 17 deletions(-)
Oran Agra in commit 349aa245:
Defrag big lists in portions to avoid latency and freeze
4 files changed, 350 insertions(+), 34 deletions(-)
Guy Benoish in commit b4ddc7b7:
XGROUP DESTROY should unblock XREADGROUP with -NOGROUP
2 files changed, 11 insertions(+)
hayashier in commit 73806f74:
fix typo from fss to rss
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit b6129f86:
Test is more complex now, increase default timeout.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit f15fb727:
Tracking: fix max-keys configuration directive.
2 files changed, 2 insertions(+), 2 deletions(-)
Itamar Haber in commit e374573f:
Fixes segfault on calling trackingGetTotalKeys
1 file changed, 1 insertion(+)
antirez in commit 73d47d57:
Signal key as modified when expired on-access.
1 file changed, 4 insertions(+), 2 deletions(-)
antirez in commit b7cb28d5:
Tracking: first set of tests for the feature.
1 file changed, 66 insertions(+)
antirez in commit 1db72571:
Tracking: fix operators precedence error in bcast check.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit fe96e29d:
Tracking: fix behavior when switchinig from normal to BCAST.
1 file changed, 11 insertions(+), 1 deletion(-)
antirez in commit f21be1ec:
Tracking: fix sending messages bug + tracking off bug.
2 files changed, 28 insertions(+), 20 deletions(-)
antirez in commit 6fb1aa23:
Tracking: BCAST: basic feature now works.
3 files changed, 55 insertions(+), 40 deletions(-)
antirez in commit d4fe79a1:
Tracking: BCAST: broadcasting of keys in prefixes implemented.
2 files changed, 94 insertions(+), 9 deletions(-)
antirez in commit abb81c63:
Tracking: BCAST: registration in the prefix table.
3 files changed, 67 insertions(+), 20 deletions(-)
antirez in commit 77da9608:
Tracking: BCAST: parsing of the options + skeleton.
4 files changed, 73 insertions(+), 19 deletions(-)
antirez in commit 3e8c69a9:
Tracking: always reply with an array of keys.
2 files changed, 10 insertions(+), 3 deletions(-)
antirez in commit a788c373:
Tracking: minor change of names and new INFO field.
4 files changed, 11 insertions(+), 4 deletions(-)
antirez in commit df838927:
Rax.c: populate data field after random walk.
1 file changed, 1 insertion(+)
antirez in commit 0517da36:
Tracking: rename INFO field with total items.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 3c16d6b3:
Tracking: first conversion from hashing to key names.
3 files changed, 84 insertions(+), 114 deletions(-)
Oran Agra in commit 3b4f1477:
add no-slowlog option to RM\_CreateCommand
1 file changed, 3 insertions(+)
Khem Raj in commit 5e762d84:
Mark extern definition of SDS\_NOINIT in sds.h
1 file changed, 1 insertion(+), 1 deletion(-)
lifubang in commit 54f5499a:
correct help info for --user and --pass
1 file changed, 2 insertions(+), 2 deletions(-)
Seunghoon Woo in commit 0c952b13:
[FIX] revisit CVE-2015-8080 vulnerability
1 file changed, 6 insertions(+), 4 deletions(-)
Guy Benoish in commit dd34f703:
Diskless-load emptyDb-related fixes
3 files changed, 44 insertions(+), 28 deletions(-)
lifubang in commit 5e042dbc:
fix ssl flag check for redis-cli
1 file changed, 10 insertions(+), 9 deletions(-)
Guy Benoish in commit dcbe8bfa:
Exclude "keymiss" notification from NOTIFY\_ALL
5 files changed, 12 insertions(+), 7 deletions(-)
Oran Agra in commit 36caf2e4:
update RM\_SignalModifiedKey doc comment
1 file changed, 2 insertions(+), 1 deletion(-)
Oran Agra in commit 3067352a:
Add handling of short read of module id in rdb
1 file changed, 4 insertions(+), 1 deletion(-)
Yossi Gottlieb in commit 9baaf858:
TLS: Update documentation.
2 files changed, 32 insertions(+), 31 deletions(-)
Oran Agra in commit 4440133e:
A few non-data commands that should be allowed while loading or stale
1 file changed, 8 insertions(+), 8 deletions(-)
Oran Agra in commit c9577941:
Memory leak when bind config is provided twice
1 file changed, 4 insertions(+)
Oran Agra in commit 1333a46b:
fix maxmemory config warning
1 file changed, 3 insertions(+), 2 deletions(-)
Oran Agra in commit 8e7282eb:
Fix client flags to be int64 in module.c
1 file changed, 3 insertions(+), 3 deletions(-)
Oran Agra in commit a678390e:
moduleRDBLoadError, add key name, and use panic rather than exit
1 file changed, 5 insertions(+), 4 deletions(-)
Oran Agra in commit 919fbf42:
reduce repeated calls to use\_diskless\_load
1 file changed, 3 insertions(+), 4 deletions(-)
Oran Agra in commit 22e45d46:
freeClientAsync don't lock mutex if there's just one thread
1 file changed, 6 insertions(+), 1 deletion(-)
Oran Agra in commit ba289244:
move restartAOFAfterSYNC from replicaofCommand to replicationUnsetMaster
1 file changed, 4 insertions(+), 3 deletions(-)
Oran Agra in commit f42ce57d:
stopAppendOnly resets aof\_rewrite\_scheduled
1 file changed, 1 insertion(+)
Oran Agra in commit df096bc9:
add SAVE subcommand to ACL HELP and top comment
1 file changed, 2 insertions(+)
Oran Agra in commit a55e5847:
DEBUG HELP - add PROTOCOL
1 file changed, 3 insertions(+), 2 deletions(-)
Guy Benoish in commit 5a6cfbf4:
Some refactroing using getClientType instead of CLIENT\_SLAVE
2 files changed, 18 insertions(+), 26 deletions(-)
Guy Benoish in commit fae306b3:
Fix small bugs related to replica and monitor ambiguity
2 files changed, 8 insertions(+), 6 deletions(-)
Yossi Gottlieb in commit 73630966:
TLS: Some redis.conf clarifications.
1 file changed, 10 insertions(+), 11 deletions(-)
Oran Agra in commit 488e1947:
config.c verbose error replies for CONFIG SET, like config file parsing
1 file changed, 31 insertions(+), 97 deletions(-)
Oran Agra in commit c82ccf06:
memoryGetKeys helper function so that ACL can limit access to keys for MEMORY command
3 files changed, 18 insertions(+), 1 deletion(-)
antirez in commit 51c1a9f8:
ACL LOG: make max log entries configurable.
4 files changed, 19 insertions(+)
antirez in commit ea1e1b12:
ACL LOG: test for AUTH reason.
1 file changed, 9 insertions(+)
antirez in commit 7379c78a:
ACL LOG: log failed auth attempts.
5 files changed, 34 insertions(+), 12 deletions(-)
antirez in commit 9f6e84f6:
ACL LOG: implement a few basic tests.
1 file changed, 87 insertions(+)
antirez in commit 82790e51:
ACL LOG: also log ACL errors in the scripting/MULTI ctx.
2 files changed, 6 insertions(+), 2 deletions(-)
antirez in commit 943008eb:
ACL LOG: implement LOG RESET.
1 file changed, 6 insertions(+), 2 deletions(-)
antirez in commit e271a611:
ACL LOG: group similar entries in a given time delta.
1 file changed, 58 insertions(+), 3 deletions(-)
antirez in commit f1974d5d:
ACL LOG: actually emit entries.
3 files changed, 34 insertions(+), 5 deletions(-)
antirez in commit d9b153c9:
ACL LOG: implement ACL LOG subcommadn skeleton.
1 file changed, 37 insertions(+)
antirez in commit 577fc438:
ACL LOG: data structures and initial functions.
5 files changed, 54 insertions(+), 5 deletions(-)
Leo Murillo in commit f7a94526:
Set ZSKIPLIST\_MAXLEVEL to optimal value given 2^64 elements and p=0.25
1 file changed, 1 insertion(+), 1 deletion(-)
WuYunlong in commit eecfa979:
Fix lua related memory leak.
1 file changed, 1 insertion(+)
WuYunlong in commit d2509811:
Add tcl regression test in scripting.tcl to reproduce memory leak.
1 file changed, 5 insertions(+)
Yossi Gottlieb in commit 29d4a150:
TLS: Fix missing initialization in redis-cli.
1 file changed, 9 insertions(+)
Oran Agra in commit ec0c61da:
fix uninitialized info\_cb var in module.c
1 file changed, 1 insertion(+)
Guy Benoish in commit 6fe55c2f:
ld2string should fail if string contains \0 in the middle
5 files changed, 20 insertions(+), 11 deletions(-)
antirez in commit bbce3ba9:
Add more info in the unblockClientFromModule() function.
1 file changed, 7 insertions(+), 1 deletion(-)
Guy Benoish in commit 40295fb3:
Modules: Fix blocked-client-related memory leak
3 files changed, 51 insertions(+), 6 deletions(-)
antirez in commit 8e9d19bc:
Change error message for #6775.
1 file changed, 2 insertions(+), 2 deletions(-)
Vasyl Melnychuk in commit ba146d4c:
Make error when submitting command in incorrect context more explicit
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit 721a39dd:
Document I/O threads in redis.conf.
1 file changed, 46 insertions(+)
antirez in commit 5be3a15a:
Setting N I/O threads should mean N-1 additional + 1 main thread.
1 file changed, 25 insertions(+), 22 deletions(-)
antirez in commit cbabf779:
Simplify #6379 changes.
2 files changed, 4 insertions(+), 9 deletions(-)
WuYunlong in commit 658749cc:
Free allocated sds in pfdebugCommand() to avoid memory leak.
1 file changed, 1 insertion(+)
WuYunlong in commit 47988c96:
Fix potential memory leak of clusterLoadConfig().
1 file changed, 20 insertions(+), 5 deletions(-)
WuYunlong in commit cc90f79b:
Fix potential memory leak of rioWriteBulkStreamID().
1 file changed, 4 insertions(+), 1 deletion(-)
antirez in commit ecd17e81:
Jump to right label on AOF parsing error.
1 file changed, 6 insertions(+), 4 deletions(-)
antirez in commit 1927932b:
Port PR #6110 to new connection object code.
1 file changed, 2 insertions(+), 2 deletions(-)
antirez in commit f2df5773:
A few comments about main thread serving I/O as well.
1 file changed, 7 insertions(+), 1 deletion(-)
zhaozhao.zz in commit b3ff8a4b:
Threaded IO: use main thread to handle read work
1 file changed, 8 insertions(+), 1 deletion(-)
zhaozhao.zz in commit b1f2c510:
Threaded IO: use main thread to handle write work
1 file changed, 10 insertions(+), 2 deletions(-)
ShooterIT in commit 7bbafc56:
Rename rdb asynchronously
1 file changed, 7 insertions(+)
Leo Murillo in commit c7f75266:
Fix bug on KEYS command where pattern starts with \* followed by \x00 (null char).
1 file changed, 1 insertion(+), 1 deletion(-)
Jamie Scott in commit ed7ea13a:
Update to directive in redis.conf (missing s)
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 3be77623:
Free fakeclient argv on AOF error.
1 file changed, 11 insertions(+), 3 deletions(-)
antirez in commit 15f6b748:
Git ignore: ignore more files.
1 file changed, 2 insertions(+)
Guy Benoish in commit 1b5bf40c:
Blocking XREAD[GROUP] should always reply with valid data (or timeout)
3 files changed, 44 insertions(+), 10 deletions(-)
John Sully in commit 954c20ed:
Add support for incremental build with header files
2 files changed, 6 insertions(+), 1 deletion(-)
WuYunlong in commit 11c3afd7:
Fix petential cluster link error.
1 file changed, 4 insertions(+)
Yossi Gottlieb in commit b752e83d:
Add REDISMODULE\_CTX\_FLAGS\_MULTI\_DIRTY.
2 files changed, 8 insertions(+)
hwware in commit e16eb874:
typo fix in acl.c
1 file changed, 2 insertions(+), 2 deletions(-)
Itamar Haber in commit 35ea9d23:
Adjusts 'io\_threads\_num' max to 128
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 38729126:
XCLAIM: Create the consumer only on successful claims.
1 file changed, 4 insertions(+), 2 deletions(-)
yz1509 in commit b9a15303:
avoid sentinel changes promoted\_slave to be its own replica.
1 file changed, 1 insertion(+), 1 deletion(-)
antirez in commit 5e7e5e6b:
Fix active expire division by zero.
1 file changed, 7 insertions(+), 4 deletions(-)
antirez in commit e61dde88:
Fix duplicated CLIENT SETNAME reply.
1 file changed, 1 deletion(-)
Guy Benoish in commit cddf1da2:
Stream: Handle streamID-related edge cases
4 files changed, 54 insertions(+), 4 deletions(-)
Oran Agra in commit 52ea44e5:
config.c adjust config limits and mutable
2 files changed, 7 insertions(+), 7 deletions(-)
antirez in commit 0f28ea16:
Inline protocol: handle empty strings well.
1 file changed, 2 insertions(+), 6 deletions(-)
antirez in commit 00e5fefe:
Fix ip and missing mode in RM\_GetClusterNodeInfo().
1 file changed, 5 insertions(+), 2 deletions(-)
================================================================================
Redis 6.0 RC1 Released Thu Dec 19 09:58:24 CEST 2019
================================================================================
Upgrade urgency LOW: This is the first RC of Redis 6.
Introduction to the Redis 6 release
===================================
Redis 6 improves Redis in a number of key areas and is one of the largest
Redis releases in the history of the project, so here we'll list only
the biggest features in this release:
\* The modules system now has a number of new APIs that allow module authors
to make things otherwise not possible in the past. It is possible to
store arbitrary module private data in RDB files, to hook on different
server events, capture and rewrite commands executions, block clients on
keys, and so forth.
\* The Redis active expire cycle was rewritten for much faster eviction of keys
that are already expired. Now the effort is tunable.
\* Redis now supports SSL on all channels.
\* ACL support, you can define users that can run only certain commands and/or
can only access only certain keys patterns.
\* Redis now supports a new protocol called RESP3, which returns more
semantical replies: new clients using this protocol can understand just
from the reply what type to return to the calling program.
\* There is server-side support for client-side caching of key values. This
feature is still experimental and will get more changes during the next
release candidates, but you can already test it and read about it here:
https://redis.io/topics/client-side-caching
\* Redis can now optionally use threads to handle I/O, allowing to serve
2 times as much operations per second in a single instance when
pipelining cannot be used.
\* Diskless replication is now supported even on replicas: a replica is now
able, under certain conditions the user can configure, to load the RDB
in the first synchronization directly from the socket to the memory.
\* Redis-benchmark now supports a Redis Cluster mode.
\* SRANDMEMBER and similar commands have a better distribution.
\* Redis-cli improvements.
\* Systemd support rewritten.
\* A Redis Cluster proxy was released here:
https://github.com/artix75/redis-cluster-proxy
\* A Disque module for Redis was released here:
https://github.com/antirez/disque-module
Thanks to all the users and developers who made this release possible.
We'll follow up with more RC releases, until the code looks production ready
and we don't get reports of serious issues for a while.
A special thank you for the amount of work put into this release
(in decreasing number of commits, only listing contributors with more
than a single commit) by:
685 antirez
81 zhaozhao.zz
76 Oran Agra
51 artix
28 Madelyn Olson
27 Yossi Gottlieb
15 David Carlier
14 Guy Benoish
14 Guy Korland
13 Itamar Haber
9 Angus Pearson
8 WuYunlong
8 yongman
7 vattezhang
7 Chris Lamb
5 Dvir Volk
5 meir@redislabs.com
5 chendianqiang
5 John Sully
4 dejun.xdj
4 Daniel Dai
4 Johannes Truschnigg
4 swilly22
3 Bruce Merry
3 filipecosta90
3 youjiali1995
2 James Rouzier
2 Andrey Bugaevskiy
2 Brad Solomon
2 Hamid Alaei
2 Michael Chaten
2 Steve Webster
2 Wander Hillen
2 Weiliang Li
2 Yuan Zhou
2 charsyam
2 hujie
2 jem
2 shenlongxing
2 valentino
2 zhudacai 00228490
2 喜欢兰花山丘
Migrating from 5.0 to 6.0
=========================
Redis 6.0 is mostly a strict superset of 5.0, you should not have any problem
upgrading your application from 5.0 to 6.0. However this is a list of small
non-backward compatible changes introduced in the 6.0 release:
\* The SPOP  command no longer returns null when the set key does not
exist. Now it returns the empty set as it should and as happens when it is
called with a 0 argument. This is technically a fix, however it changes the
old behavior.
--------------------------------------------------------------------------------
Credits: For each release, a list of changes with the relative author is
provided. Where not specified the implementation and design is done by
Salvatore Sanfilippo. Thanks to Redis Labs for making all this possible.
Also many thanks to all the other contributors and the amazing community
we have.
Commit messages may contain additional credits.
Enjoy,
Salvatore


=== Content from bugzilla.redhat.com_73e0e1d6_20250115_095902.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1943623)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1943623)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1943623)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1943623

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1943623**](show_bug.cgi?id=1943623)
(CVE-2021-3470)
- [CVE-2021-3470](https://access.redhat.com/security/cve/CVE-2021-3470) redis: potential heap overflow when using a heap allocator other than jemalloc or glibc's malloc

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3470 redis: potential heap overflow when using a heap allocator othe...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3470 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1946481](show_bug.cgi?id=1946481) [1944790](show_bug.cgi?id=1944790) [1944791](show_bug.cgi?id=1944791) [1946482](show_bug.cgi?id=1946482) [1948630](show_bug.cgi?id=1948630) [1948631](show_bug.cgi?id=1948631) [1948632](show_bug.cgi?id=1948632) [1948769](show_bug.cgi?id=1948769 "CLOSED EOL - CVE-2021-3470 redis: potential heap overflow when using a heap allocator other than jemalloc or glibc's malloc [epel-all]") [1948770](show_bug.cgi?id=1948770 "CLOSED EOL - CVE-2021-3470 redis: potential heap overflow when using a heap allocator other than jemalloc or glibc's malloc [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1930427](show_bug.cgi?id=1930427) [1943663](show_bug.cgi?id=1943663) | | TreeView+ | [depends on](buglist.cgi?bug_id=1943623&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1943623&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-03-26 16:30 UTC by Mauro Matteo Cascella | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-02-23 00:35 UTC ([History](show_activity.cgi?id=1943623)) | | [CC List:](page.cgi?id=fields.html#cclist) | 43 users (show)  13752555653 apevec bcoca chousekn cmeyers davidn fabian.deutsch fpercoco gblomqui gghezzo gparvin hhorak jal233 jcammara jhardy jjoyce jobarker jorton jramanat jschluet jweiser kaycoth lberk lhh lpeer mabashia mburns mgoodwin nathans notting osapryki ppengjin rcollet redis-maint relrod sclewis sdoran slinaber smcdonal stcannon thee tkuratom vmugicag | | Fixed In Version: | redis 5.0.10, redis 6.0.9, redis 6.2.0 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A heap overflow issue was found in Redis when using a heap allocator other than jemalloc or glibc's malloc, leading to potential out of bound write or process crash. Effectively this flaw does not affect the vast majority of users, who use jemalloc or glibc. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-10-29 08:48:41 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1943623#c0)  Mauro Matteo Cascella    2021-03-26 16:30:19 UTC  ``` When using a system with no malloc_usable_size(), zmalloc_size() assumed that the heap allocator always returns blocks that are long-padded. This may not always be the case, and will result with zmalloc_size() returning a size that is bigger than allocated. At least in one case this leads to out of bound write, process crash and a potential security vulnerability. Effectively this does not affect the vast majority of users, who use jemalloc or glibc.  Upstream pull request: <https://github.com/redis/redis/pull/7963>  Upstream commit: <https://github.com/redis/redis/commit/9824fe3e392caa04dc1b4071886e9ac402dd6d95>  Release notes: <https://raw.githubusercontent.com/redis/redis/5.0.10/00-RELEASENOTES> <https://raw.githubusercontent.com/redis/redis/6.0.9/00-RELEASENOTES>   ```  [Comment 1](show_bug.cgi?id=1943623#c1)  Mauro Matteo Cascella    2021-03-26 16:35:08 UTC  ``` It is worth noting that the default Redis heap allocator on Linux is jemalloc: <https://github.com/redis/redis#allocator>.   ```  [Comment 7](show_bug.cgi?id=1943623#c7)  Tapas Jena    2021-04-12 16:19:21 UTC  ``` Completed the analysis of the concerned vulnerability for both AAP 1.2 and Ansible Tower and below is my observation: - Ansible Tower uses the RHEL Redis where both jemalloc() and zmalloc() are in use. However, "jemalloc()" being used as default Heap allocator. - Ansible Core doesn't use redis, by default. There is the cache plugin that is optional and it doesn't directly make any choices about the heap allocator redis would use.  Hence, marking AAP 1.2 and Tower as "Affected" and "delegated".  Kind Regards, Tapas J   ```  [Comment 9](show_bug.cgi?id=1943623#c9)  Mauro Matteo Cascella    2021-04-12 21:08:32 UTC  ``` Created redis tracking bugs for this issue:  Affects: epel-all [[bug 1948769](show_bug.cgi?id=1948769 "CLOSED EOL - CVE-2021-3470 redis: potential heap overflow when using a heap allocator other than jemalloc or glibc's malloc [epel-all]")] Affects: fedora-all [[bug 1948770](show_bug.cgi?id=1948770 "CLOSED EOL - CVE-2021-3470 redis: potential heap overflow when using a heap allocator other than jemalloc or glibc's malloc [fedora-all]")]   ```  [Comment 12](show_bug.cgi?id=1943623#c12)  Nick Tait    2021-05-08 19:12:57 UTC  ``` Statement:  The following products are not affected by this flaw because they use `jemalloc` as default heap allocator: * Red Hat Enterprise Linux 8 * Red Hat Software Collections * Red Hat Advanced Cluster Management for Kubernetes  In Red Hat OpenStack Platform, because the flaw has a lower impact and the fix would require a substantial amount of development, no update will be provided at this time for the RHOSP redis package.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1943623&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from avatars.githubusercontent.com_08c4e1a9_20250115_224726.html ===
�PNG

   
IHDR   (   (   �/:  
��E %�@$��!��!2G�H�͖��v���9�:���G�@k7~���(Rd�(�,7B!��!L)j Ab5��� �!b$R�@�A E���T�0��/�k��zG=�������J�w����"ϕVY���)RQRjB$"@ �P+DA�DƤHBD��%Նp�lЏ����^���������;��䝾[�z�pg^im��1&Eb�<�Df���D��9]����823����9]P+ �Fs�T�i��|�^S��E�Ʒ�`F�\�.J�e`�2V# �(��R}�X�@+m�B@��C�6b�)��'�S�8�d�g����x��#�z�|�+�<}�0��po��p:U9
E�!� �M�
��L��s���� J"1nJ."
EC22!F�
����ɇ��MU4�U�W�6\_��I��ՀFa�D@�,!x�o��9}Ô�7?���1��׫+����ȕ�{tT�6��H��1%S�t�R�j���:)��f�d�)�!DN�O)o�M�7 ���(J�zrt����I�YSX����FRi��0aDPJi f0i^�gڤ�1&�p~��榒VNt�~�[��D�y���:���F�B�\�ώ///�v�\_��n
[�yY�Z+��t�s�{�,���zH� JAauf��J�oL�d$��:zv�n���
����>}t�����O+�v��P3��z���S���)�(�9"}�>>a{9���o�δN�Ei����4�6e]pv�N�t��m��U���q��E�,� ���S�/�8�t]� � B��Ӫ����t��/�-�27��"��-"�:/3e�u�g��3/�"Ƙ!��ږA���>fe1���Y6
2\*�"�U>k��j���~��@m51��1�\*
c2�l�����[o����5<�Yn��`]e�#M���$up!� "zQ�ea��+D��L6V��(����$B��jDSeir��6y��\�ߟ�W�^}i?�l���"��r�����q���=>��g��v�&������n� � �x��O������ښ�r������ ��\*ˌeNO�>����������dQںȴ1L �}���퟽��ѧ���ap^��,���
����uε��0�b��U��?���2"6�g�8����`Q+��5i��s�??|�������P��JP(���??9��+\_��W������ӓKv^k=�����Da�c�ua]�M̋��������4z���p��9���ཱY��{���89��|������&� �^���Zs�n�V,�^�3{�����B�i4+�<�9�������J�J�mPeEQ�lf�5�h@u��'I��Ɲk�o� "��ɹ~յ��}h�ō[�����YQW
9p �\���Z'��26�Hk����������b#ѕ흩������]~�pB
�T^�S������b~t���L]V��5u��v���l-��4�eBVT��0$Tw>,�ΚŶ�뇇�w\_�@�\*�����G�kN>�M��Zʊ�`,N��q��~x�/��n�/�ժ}~��!Ve�1\_.�U��d��a�g�U"�9����ș�������Pqe�Z~p���/���RZB�B�vgg��v�2�ؚ�a|���L��zZ�Ӑ6M�C?����V����=�$�J��u����O�G�֧���Y�����w@��ȬD�$!�~�/��E7�SX�����Ӌ��\_�ݽ{���즇��;��vcI0i�Da~���i��l�"N�e�`o��9z&���:�J!���O��
�n�]@kvv������\_?|aݭۮ/���b�΋�ٛ��B��I��'Gt>�"3��7���َ������6{7���<ҟ+7�q���^lo�uU��v��
��n��Z�m��\*)��"h䨂��HCH�I Sqr�a�e{���R�N�������w��ѫ���sm��b�S�@,�S�Iy�c�H'�'~�k" �
Œ�ۇ�k?�)#�����׫���߻�:���o>��1ݱ�zE�WZ��\*k6� @a|q��e�M. ��b�N�/�B04z?�,��yJ7�хɧ�s��tL������{׋����ڭ�Bă1�}v�8<�y��N��5�����I�TJgJO�4�й0Er�}�:7Me�.
�\�4Ma��S�YCZ+���Y�'ǐ �����v�
�O�兟B���eєe?X�ʭ+ۇ�۳y& ��e�%�H�s]�^H��u�yJ��� �X������Y�� n/v�����o��oG������\_��~�y�^)e�,�3kt]����;�[E>�J�a��y�Yd�\��b^%�XY�J9G|򎢒!T��+w���'ǧge^//�����ɳq�E�~��3[��7NI�Z
�:��۩�
�|�.9$),�Qg�(��\*&Cˮo�aHuN�+�+7n����j�ƭo��u��v��`χ�W�������4Mɉ%Ϡ��lfMY�I!"��ϋ�ɛYU�y�'z�~t�~<�l��4��u��|�ko��>?5������Ʀ,���������Y���^N���\*\�~�H�Z��y Y�<2`��ѹ�7Z���S�!���LN�ƪ��x�ɵRDGcL�����.�3�\���t�p~|��3.�S�vZ���y���c��cׯ;�c���W�4�A��։"D)�������w�<��V�E���׉  "'|��ށ�8u��lvΏ��n�8!&���5U�(�q�¶k׍n�|7:��I������W�?�B��G9��
�!��ЌE&�X��@K�]�H���g��]\��c��\*�'�]SdU�)�����G7��'G��Emb��^��a�6��\*����I�3�[S�U������������Hrc�B�/��eAs�����
F�~��G�牻�(FJ���yda��QȜD>0Y�f�buv�7�۬�>g'ߟ)�%\*Y���S]�L.a.��+O��}�y�f�������·�˵Fh2]Z�H[���rH>os��f�/fMS��N??ٽ~ݻ����  ���H"n�    IEND�B`�

=== Content from access.redhat.com_ad8aff5b_20250115_224727.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


