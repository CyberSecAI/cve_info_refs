Based on the provided content, here's an analysis of CVE-2021-3461:

**Root Cause of Vulnerability:**

*   The vulnerability stems from how Keycloak handles backchannel logout requests when interacting with external SAML Identity Providers (IdPs). Specifically, when the Principal Type is set to "Attribute Name" instead of the "Subject Name ID," Keycloak fails to properly invalidate user sessions upon receiving a logout request from the external IdP.

**Weaknesses/Vulnerabilities Present:**

*   **Incomplete Logout Processing:** Keycloak's SAML endpoint fails to correctly identify and terminate user sessions when the Principal Type for an external SAML IdP is configured to use attribute names. This indicates an issue with how the session lookup/invalidation is handled in this specific scenario.
*   **Incorrect SAML Identity Mapping**: The vulnerability is caused by Keycloak not properly mapping the session when the principal type is set to "Attribute Name". This implies that it relies on the "Subject Name ID" for logout, which is not used when the IdP is configured to use attribute names.

**Impact of Exploitation:**

*   **Session Persistence:** User sessions remain active even after a logout request is initiated from an external SAML IdP. This means that the user may not be properly logged out and their session might still be available, posing a security risk.
*   **Potential for Unauthorized Access:**  If a user believes they have logged out but their session remains active, this could open a window for unauthorized access if their computer is left unattended, or via other attack vectors.

**Attack Vectors:**

*   **SAML Backchannel Logout:** The vulnerability is triggered via the SAML backchannel logout process initiated by an external IdP.
*   **Specific Configuration:** The vulnerability is only present when the Keycloak configuration specifies "Attribute Name" as the Principal Type for the external SAML IdP.

**Required Attacker Capabilities/Position:**

*   **External SAML IdP Configuration:** An attacker would likely need control or knowledge of how the external SAML IdP is configured and how its logout requests are processed.
*   **User Interaction:** The attack likely requires an initial user interaction with an application that is connected to the affected Keycloak instance, followed by a logout request from the external SAML IdP.
*   **Access to the service:** The attacker would need to have access to a service that relies on the vulnerable Keycloak setup.

**Additional Details from Content:**

*   The issue is present in the `org.keycloak.broker.saml.SAMLEndpoint.java` class within the `keycloak-services` jar.
*   This vulnerability specifically affects Red Hat Single Sign-On (RHSSO) and not other Red Hat products.
*   The vulnerability has been addressed in Red Hat Single Sign-On 7.4 via RHSA-2021:2063, RHSA-2021:2064, RHSA-2021:2065 and RHSA-2021:2070
*   The fix was included in the rh-sso7-keycloak version 9.0.13.