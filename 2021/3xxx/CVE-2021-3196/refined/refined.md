Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-3196

**Root Cause:**
The vulnerability stems from an XML Signature Wrapping (XSW) attack. When Hitachi ID Bravura Security Fabric uses federated identity management with SAML through a third-party provider, the application incorrectly handles signed and unsigned data within the SAML response.

**Weaknesses/Vulnerabilities Present:**
- **Improper Verification of Cryptographic Signature (CWE-347):** The application validates the signature of the SAML response but then uses unsigned malicious values. This indicates a failure to properly verify the integrity of all data within the signed response.
- **XML Signature Wrapping (XSW):** An attacker can inject additional data into the SAML response. Although the signed portion is still validated, the application processes the injected, unsigned data, leading to exploitation.

**Impact of Exploitation:**
- **Privilege Escalation:** A lower-privileged attacker can inject the username of a high-privilege user, allowing them to impersonate the high-privilege user. This can lead to unauthorized access to sensitive data or system functionality.
- **Impersonation:** Attackers can effectively bypass authentication and assume the identity of any user whose username they can insert into the SAML response.

**Attack Vectors:**
- **Network-based:** The attack occurs during the transmission of a SAML response from a third-party identity provider to the Hitachi ID Bravura Security Fabric service provider.
- **SAML Manipulation:** The attacker manipulates the SAML response by injecting unsigned data.

**Required Attacker Capabilities/Position:**
- **Lower-Privilege Access:** The attacker needs to have some level of access to the application.
- **Interception/Manipulation of SAML Response:** The attacker needs the ability to intercept or modify the SAML response before it reaches the service provider. This could potentially be achieved through a man-in-the-middle attack or by exploiting a vulnerability in the SAML communication chain.

**Affected Systems:**
- Hitachi ID Bravura Security Fabric versions: 11.0.0 - 11.1.3, 12.0.0 - 12.0.2, and 12.1.0, specifically when using SAML authentication with a third-party Identity Provider (e.g., Okta, Azure, SecureAuth).

**Mitigation/Solution:**
- Apply the official patch provided by Bravura Security.
- If patching isn't immediately feasible, disable SAML integration with third-party Identity Providers and rely on built-in authentication methods as a temporary workaround.

The provided information gives a more in depth description of the vulnerability than is provided in the standard CVE description.