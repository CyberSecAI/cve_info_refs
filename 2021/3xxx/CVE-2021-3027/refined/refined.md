Based on the provided content, here's an analysis related to a potential LDAP injection vulnerability:

**Root cause of vulnerability:**

The initial code used the `escape_rdn` function to sanitize user input (`login`) before using it in an LDAP query. However, `escape_rdn` is intended for escaping distinguished names and not necessarily for LDAP filter strings. This allowed for potential LDAP injection.

**Weaknesses/vulnerabilities present:**

*   **LDAP Injection:** The primary vulnerability is the potential for LDAP injection due to insufficient sanitization of the `login` variable. The `escape_rdn` function was not adequate to prevent malicious characters from being included in the LDAP filter, allowing an attacker to manipulate the query.

**Impact of exploitation:**

*   **Information Disclosure:** An attacker could potentially modify the LDAP query to retrieve sensitive information from the LDAP directory.
*   **Authentication Bypass:** The attacker could craft an LDAP query that always returns true, bypassing the authentication process.
*   **Data Manipulation:** It is possible that an attacker could modify or delete entries within the LDAP directory, depending on permissions.

**Attack vectors:**

*   **User Input:** The attack vector is through the `login` variable, which is user-controlled input. This input is used to create the LDAP filter.
*   **LDAP Query:** By injecting special characters, the attacker can modify the constructed LDAP filter and search for different users or perform malicious operations.

**Required attacker capabilities/position:**

*   **User Account:** The attacker needs to have an account or be able to provide input to the login form of the application
*   **Understanding of LDAP Syntax:** The attacker would need some knowledge of LDAP filter syntax to craft a successful injection.

**Additional Details**

*   The vulnerability was addressed by replacing the `escape_rdn` function with the `escape_filter_chars` function. The `escape_filter_chars` function is specifically designed to sanitize input for use within LDAP filter strings.
*   The commit log also reveals an issue with double escaping the input.
*   The related pull request [Polish LDAP Injection fix #562](https://github.com/LibrIT/passhport/pull/562) and the issue [\[Python] CWE-090: LDAP Injection github/securitylab#319](https://github.com/github/securitylab/issues/319) confirm the LDAP injection vulnerability and its mitigation.

This information aligns with the general description of LDAP injection vulnerabilities, suggesting that the content is relevant to CVE-2021-3027, although the CVE itself is a placeholder.