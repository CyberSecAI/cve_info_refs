=== Content from wordpress.org_a010893d_20250114_195756.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Contact Form DB ‚Äì Elementor

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fsb-elementor-contact-form-db&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fsb-elementor-contact-form-db&locale=en_US)

Search plugins

![](https://ps.w.org/sb-elementor-contact-form-db/assets/banner-772x250.jpg?rev=2089308)

This plugin **hasn‚Äôt been tested with the latest 3 major releases of WordPress**. It may no longer be maintained or supported and may have compatibility issues when used with more recent versions of WordPress.

![](https://ps.w.org/sb-elementor-contact-form-db/assets/icon.svg?rev=2089308)
# Contact Form DB ‚Äì Elementor

By [Web Ace Tech Services](https://webacetechs.in)

[Download](https://downloads.wordpress.org/plugin/sb-elementor-contact-form-db.1.8.1.zip)

* [Details](https://wordpress.org/plugins/sb-elementor-contact-form-db/#description)
* [Reviews](https://wordpress.org/plugins/sb-elementor-contact-form-db/#reviews)
* [Installation](https://wordpress.org/plugins/sb-elementor-contact-form-db/#installation)
* [Development](https://wordpress.org/plugins/sb-elementor-contact-form-db/#developers)

[Support](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/)

## Description

A simple plugin to store Elementor Pro Form submissions

This plugin stores contact form submissions from the Elementor Pro Form Module in a handy interface on the back end of WP.

To make things even better, this plugin both notifies admin users of unread messages via a banner but also allows you to convert these contact form requests into any other post type. This means you could use a contact form to get people to submit testimonials, case studies or even front end submitted content.

It makes a simple contact form into a very versatile module indeed.

You can also export your stored contact form data to a CSV file by page submitted on or by form name (if specified in the form module).

## Screenshots

* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-1.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-1.png?rev=2966403)

  Submission List
* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-2.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-2.png?rev=2966403)

  Individual Submission
* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-3.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-3.png?rev=2966403)

  Copy to post type options
* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-4.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-4.png?rev=2966403)

  Settings Page
* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-5.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-5.png?rev=2966403)

  Export Page
* [![](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-6.png?rev=2966403)](https://ps.w.org/sb-elementor-contact-form-db/trunk/screenshot-6.png?rev=2966403)

  Interface

## Installation

Install the plugin like any other. All contact forms using the Elementor Pro Form module will thereafter automatically be recorded in the system. Emails will still be sent as normal so don‚Äôt worry about that either!

Visit the admin page and you‚Äôll see a list of form submissions with their dates, page they were submitted on, number of times cloned, etc‚Ä¶

## Reviews

![](https://secure.gravatar.com/avatar/d37312b910c9d2ee4f2026e1112e1c8bc64307aaae0c09d7c2a207a6733c92cb?s=60&d=retro&r=g)
### [Export as CSV does not work](https://wordpress.org/support/topic/export-as-csv-does-not-work/)

[danielbrueckner](https://profiles.wordpress.org/danielbrueckner/ "Posts by danielbrueckner")
March 26, 2024

The plugin could be still useful as it doesn¬¥t save IP addresses of users when filling out a form. But unfortunately the export as csv function does not work. So I cannot use the data in any way.

![](https://secure.gravatar.com/avatar/ffec634a089491759329312d9020901283a8980569af8282662f5305c24d3b14?s=60&d=retro&r=g)
### [Perfectly working](https://wordpress.org/support/topic/perfectly-working-17/)

[Filippo Tinnirello](https://profiles.wordpress.org/tinnydev/ "Posts by Filippo Tinnirello")
August 3, 2023

Awesome plugin, works perfectly and saved me from the hassle of converting an existing form to CF7 just to save submission data to Flamingo.

![](https://secure.gravatar.com/avatar/163b73a03481389235fd9e2ba4326acc13c4eef32a47489b80c05067afc881d7?s=60&d=retro&r=g)
### [Causes fatal php errors in the admin backend](https://wordpress.org/support/topic/causes-fatal-php-errors-in-the-admin-backend/)

[austenozzy](https://profiles.wordpress.org/austenozzy/ "Posts by austenozzy")
June 6, 2022

Site worked ok, but i couldn‚Äôt load any backend pages until this plugin was deactivated.

![](https://secure.gravatar.com/avatar/9e2fc3dc36dac08835701e42887b81850b580b69d501fa3dbee610215ec3d438?s=60&d=retro&r=g)
### [Plugin slows down the admin panel ‚Äî solution inside!](https://wordpress.org/support/topic/plugin-slows-down-the-admin-panel-solution-inside/)

[dependencyinjection](https://profiles.wordpress.org/dependencyinjection/ "Posts by dependencyinjection")
July 30, 2021

The plugin is great! Saved life before Elementor added native form submission save, but still üôÇ
For anyone, who facing the Critical error issue in wp-admin panel, check the count of the saved submissions. While I have 3k+ saved submissions, WP memory limit was set to 768M and it hardly handled it.
There are 3 simple solutions:
1. Delete old submissions you don‚Äôt need
2. increase WP\_MEMORY\_LIMIT more, like: define( ‚ÄòWP\_MEMORY\_LIMIT‚Äô, ‚Äò512M‚Äô ); (add or update it in your wp-config.php)
3. in the wp-content/plugins/sb-elementor-contact-form-db/sb\_elementor\_contact\_form\_db.php file in line 564 change posts\_per\_page to 50 instead of -1
‚Äòposts\_per\_page‚Äô => 50,//- 1,

![](https://secure.gravatar.com/avatar/33906ad458c5b4568a13436421d4670e1377d1d3b08bb286bfd29da41d96c41f?s=60&d=retro&r=g)
### [Great Plugin](https://wordpress.org/support/topic/great-plugin-31402/)

[rahimjeetu](https://profiles.wordpress.org/rahimjeetu/ "Posts by rahimjeetu")
July 3, 2021

It‚Äôs a great plugin for elementor form. Very useful. Thank you.

![](https://secure.gravatar.com/avatar/5a0b09f4a31afbe51652bcfb08951921eaecf6e7df1d7cdba2e32d5287cc0281?s=60&d=retro&r=g)
### [Amazing!](https://wordpress.org/support/topic/amazing-2971/)

[coldsense](https://profiles.wordpress.org/coldsense/ "Posts by coldsense")
February 8, 2021

Saved me from buying expensive other Plugins! You will for sure get from me a donation, so simple, so nice. Love it!

[Read all 18 reviews](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/)
## Contributors & Developers

‚ÄúContact Form DB ‚Äì Elementor‚Äù is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/1b0a3db133d41311d8b39c188ea705969699c1d82c865de5324a046fe8c8d467?s=32&d=mm&r=g) [Web Ace Tech Services](https://profiles.wordpress.org/webacetechs/)

‚ÄúContact Form DB ‚Äì Elementor‚Äù has been translated into 4 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/sb-elementor-contact-form-db/contributors) for their contributions.

[Translate ‚ÄúContact Form DB ‚Äì Elementor‚Äù into your language.](https://translate.wordpress.org/projects/wp-plugins/sb-elementor-contact-form-db)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/sb-elementor-contact-form-db/), check out the [SVN repository](https://plugins.svn.wordpress.org/sb-elementor-contact-form-db/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/sb-elementor-contact-form-db/) by [RSS](https://plugins.trac.wordpress.org/log/sb-elementor-contact-form-db/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### V1.8.1 (2023-09-13)

* Bug Fixes
* Updated Compatibility with latest elementor 3.16+
* Updated Compatibility with PHP 8.1+

#### V1.8.0

* Bug Fixes

#### V1.7 (2021-02-12)

* Added options to settings page which allow you to change the labels on the admin menu. Better for white labelling

#### V1.6 (2021-01-12)

* Added better handling of back end admin pages based on a report of a security exploit (CSRF). Suggest update to a minimum of this plugin version asap

#### V1.5 (2019-11-07)

* Vastly improved the speed of the exports. Better for databases of more than 1000 submissions. Tested on a DB of 37k

#### V1.4 (2019-05-21)

* Minor preventative security related fixes

#### V1.3 (2019-05-13)

* Fixed conflict with new Elementor versions
* Added ability to show Export page to non admins (new setting on the settings page)
* Fixed issue whereby if more than one email was specified as an action then it would save two records

#### V1.2 (2018-09-15)

* Added export functionality by Form ID and by page submitted on
* Removed limiting CSS so that paging and bulk delete is possible
* Added settings page housing an option to hide the ‚Äúnag‚Äù, the red bar notifying of submissions

#### V1.1

* Fixed for latest version of Elementor Pro

## Meta

* Version **1.8.1**
* Last updated **1 year ago**
* Active installations **30,000+**
* WordPress version **4.0 or higher**
* Tested up to **6.3.5**
* Languages
  See all 5

  Close

  [Dutch](https://nl.wordpress.org/plugins/sb-elementor-contact-form-db/), [English (US)](https://wordpress.org/plugins/sb-elementor-contact-form-db/), [French (France)](https://fr.wordpress.org/plugins/sb-elementor-contact-form-db/), [German](https://de.wordpress.org/plugins/sb-elementor-contact-form-db/), and [Spanish (Spain)](https://es.wordpress.org/plugins/sb-elementor-contact-form-db/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/sb-elementor-contact-form-db)
* Tags [elementor](https://wordpress.org/plugins/tags/elementor/)[elementor forms](https://wordpress.org/plugins/tags/elementor-forms/)
* [Advanced View](https://wordpress.org/plugins/sb-elementor-contact-form-db/advanced/)

## Ratings

4.6 out of 5 stars.

* [16 5-star reviews
  5 stars

  16](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/?filter=3)
* [1 2-star review
  2 stars

  1](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/?filter=2)
* [1 1-star review
  1 star

  1](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/1b0a3db133d41311d8b39c188ea705969699c1d82c865de5324a046fe8c8d467?s=32&d=mm&r=g) [Web Ace Tech Services](https://profiles.wordpress.org/webacetechs/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/sb-elementor-contact-form-db/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_3097df5a_20250114_195755.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ‚ÜóÔ∏é](https://central.wordcamp.org/)
  + [Meetups ‚ÜóÔ∏é](https://www.meetup.com/pro/wordpress/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ‚ÜóÔ∏é](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2454670)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ‚Üê [Previous Changeset](/changeset/2454669 "Changeset 2454669")
* [Next Changeset](/changeset/2454671 "Changeset 2454671") ‚Üí

---

# Changeset 2454670

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
01/12/2021 11:18:22 AM
([4 years](/timeline?from=2021-01-12T11%3A18%3A22Z&precision=second "See timeline at 01/12/2021 11:18:22 AM") ago)

Author:
seanbarton
Message:

Updated to 1.6, Fixed a couple of issues. See changelog for more info

Location:
[sb-elementor-contact-form-db/trunk](/browser/sb-elementor-contact-form-db/trunk?rev=2454670)
Files:

2 edited

* [readme.txt](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2454670 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [sb\_elementor\_contact\_form\_db.php](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670 "Show entry in browser")
  (modified)
  ([58 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [sb-elementor-contact-form-db/trunk/readme.txt](/changeset/2454670/sb-elementor-contact-form-db/trunk/readme.txt "Show the changeset 2454670 restricted to sb-elementor-contact-form-db/trunk/readme.txt")

  | [r2088234](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2088234#L3 "Show revision 2088234 of this file in browser") | [r2454670](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2454670#L3 "Show revision 2454670 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Donate link: http://paypal.me/seanbarton |
  | 4 | 4 | Tags: elementor, elementor forms |
  | 5 |  | Requires at least: 4.~~7~~ |
  | 6 |  | Tested up to: 5.~~2~~ |
  | 7 |  | Requires PHP: ~~5.6~~ |
  |  | 5 | Requires at least: 4.0 |
  |  | 6 | Tested up to: 5.6 |
  |  | 7 | Requires PHP: 7.2 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2088234#L38) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2454670#L38) |  |
  | 38 | 38 | == Changelog == |
  | 39 | 39 |  |
  | 40 |  | ~~\*~~ |
  | 41 |  | ~~\* < V1.0~~ |
  | 42 |  | ~~\* - Initial Version~~ |
  | 43 |  | ~~\*~~ |
  | 44 | 40 | \* < V1.1 |
  | 45 | 41 | \* - Fixed for latest version of Elementor Pro |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2088234#L53) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/readme.txt?rev=2454670#L49) |  |
  | 53 | 49 | \* - Fixed conflict with new Elementor versions |
  | 54 | 50 | \* - Added ability to show Export page to non admins (new setting on the settings page) |
  | 55 |  | \* - |
  |  | 51 | \* - Fixed issue whereby if more than one email was specified as an action then it would save two records |
  |  | 52 | \* |
  |  | 53 | \* V1.4 (2019-05-21) |
  |  | 54 | \* - Minor preventative security related fixes |
  |  | 55 | \* |
  |  | 56 | \* V1.5 (2019-11-07) |
  |  | 57 | \* - Vastly improved the speed of the exports. Better for databases of more than 1000 submissions. Tested on a DB of 37k |
  |  | 58 | \* |
  |  | 59 | \* V1.6 (2021-01-12) |
  |  | 60 | \* - Added better handling of back end admin pages based on a report of a security exploit (CSRF). Suggest update to a minimum of this plugin version asap |
* ## [sb-elementor-contact-form-db/trunk/sb\_elementor\_contact\_form\_db.php](/changeset/2454670/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php "Show the changeset 2454670 restricted to sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php")

  | [r2187370](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L6 "Show revision 2187370 of this file in browser") | [r2454670](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L6 "Show revision 2454670 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Description: A simple plugin to save contact form submissions in the database, designed for the Elementor Form Module |
  | 7 | 7 | \* Author:¬† ¬† ¬† Sean Barton - Tortoise IT |
  | 8 |  | \* Version:¬† ¬† ¬†1.~~5~~ |
  |  | 8 | \* Version:¬† ¬† ¬†1.6 |
  | 9 | 9 | \* Author URI:¬† http://www.sean-barton.co.uk |
  | 10 | 10 | \* |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L33) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L33) |  |
  | 33 | 33 | \* - Vastly improved the speed of the exports. Better for databases of more than 1000 submissions. Tested on a DB of 37k |
  | 34 | 34 | \* |
  |  | 35 | \* V1.6 (2021-01-12) |
  |  | 36 | \* - Added better handling of back end admin pages based on a report of a security exploit. Suggest update to a minimum of this plugin version asap |
  |  | 37 | \* |
  | 35 | 38 | \*/ |
  | 36 | 39 |  |
  | 37 |  | if~~( ! defined( 'WPINC' )~~ ) { |
  |  | 40 | if(!defined( 'WPINC' )) { |
  | 38 | 41 | die; |
  | 39 | 42 | } |
  | 40 | 43 |  |
  | 41 | 44 | define( 'SB\_ELEM\_CFD\_DB\_ITEM\_NAME', 'Elementor Contact Form DB' ); |
  | 42 |  | define( 'SB\_ELEM\_CFD\_DB\_VERSION', '1.~~5~~' ); |
  |  | 45 | define( 'SB\_ELEM\_CFD\_DB\_VERSION', '1.6' ); |
  | 43 | 46 |  |
  | 44 | 47 | add\_action( 'plugins\_loaded', 'sb\_elem\_cfd\_init' ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L63) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L66) |  |
  | 63 | 66 |  |
  | 64 | 67 | $sb\_elem\_cfd = get\_option( 'sb\_elem\_cfd' ); |
  | 65 |  | $min\_role¬† ¬† = ( isset( $sb\_elem\_cfd['records\_min\_role'] ) ? $sb\_elem\_cfd['records\_min\_role'] : 'administrator' ); |
  | 66 |  |  |
  | 67 |  | add\_submenu\_page( |
  | 68 |  | 'edit.php?post\_type=elementor\_cf\_db', |
  | 69 |  | 'Export', |
  | 70 |  | 'Export', |
  | 71 |  | $min\_role, |
  | 72 |  | 'sb\_elem\_cfd', |
  | 73 |  | 'sb\_elem\_cfd\_submenu\_cb' ); |
  | 74 |  |  |
  | 75 |  | add\_submenu\_page( |
  | 76 |  | 'edit.php?post\_type=elementor\_cf\_db', |
  | 77 |  | 'Settings', |
  | 78 |  | 'Settings', |
  | 79 |  | 'manage\_options', |
  | 80 |  | 'sb\_elem\_cfd\_settings', |
  | 81 |  | 'sb\_elem\_cfd\_settings\_submenu\_cb' ); |
  |  | 68 | $min\_role¬† ¬† = (isset( $sb\_elem\_cfd['records\_min\_role'] ) ? $sb\_elem\_cfd['records\_min\_role'] : 'administrator'); |
  |  | 69 |  |
  |  | 70 | add\_submenu\_page( 'edit.php?post\_type=elementor\_cf\_db', 'Export', 'Export', $min\_role, 'sb\_elem\_cfd', 'sb\_elem\_cfd\_submenu\_cb' ); |
  |  | 71 | add\_submenu\_page( 'edit.php?post\_type=elementor\_cf\_db', 'Settings', 'Settings', 'manage\_options', 'sb\_elem\_cfd\_settings', 'sb\_elem\_cfd\_settings\_submenu\_cb' ); |
  | 82 | 72 |  |
  | 83 | 73 | sb\_elem\_cfd\_disable\_add\_new(); |
  | 84 |  |  |
  | 85 | 74 | } |
  | 86 | 75 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L92) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L81) |  |
  | 92 | 81 | } |
  | 93 | 82 |  |
  | 94 |  | function sb\_elem\_cfd\_box\_start(~~$title~~ ) { |
  |  | 83 | function sb\_elem\_cfd\_box\_start($title) { |
  | 95 | 84 | return '<div class="postbox"> |
  | 96 | 85 | <h2 class="hndle">' . $title . '</h2> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L100) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L89) |  |
  | 100 | 89 | function sb\_elem\_cfd\_download\_csv() { |
  | 101 | 90 |  |
  | 102 |  | if ( isset( $\_REQUEST['download\_csv'] ) ) { |
  | 103 |  | if ( isset( $\_REQUEST['form\_name'] ) ) { |
  | 104 |  | if ( $rows = sb\_elem\_cfd\_get\_export\_rows( $\_REQUEST['form\_name'] ) ) { |
  | 105 |  |  |
  | 106 |  | header( 'Content-Type: application/csv' ); |
  | 107 |  | header( 'Content-Disposition: attachment; filename=' . sanitize\_title( $\_REQUEST['form\_name'] ) . '.csv' ); |
  | 108 |  | header( 'Pragma: no-cache' ); |
  | 109 |  | echo implode( "\n", $rows ); |
  | 110 |  | die; |
  | 111 |  | } |
  | 112 |  | } |
  | 113 |  |  |
  | 114 |  | if ( isset( $\_REQUEST['form\_id'] ) ) { |
  | 115 |  | if ( $rows = sb\_elem\_cfd\_get\_export\_rows\_by\_form\_id( $\_REQUEST['form\_id'] ) ) { |
  | 116 |  |  |
  | 117 |  | header( 'Content-Type: application/csv' ); |
  | 118 |  | header( 'Content-Disposition: attachment; filename=' . sanitize\_title( $\_REQUEST['form\_id'] ) . '.csv' ); |
  | 119 |  | header( 'Pragma: no-cache' ); |
  | 120 |  | echo implode( "\n", $rows ); |
  | 121 |  | die; |
  |  | 91 | if(isset( $\_REQUEST['download\_csv'] )) { |
  |  | 92 | if(!empty( $\_POST['sb\_elem\_cfd\_export'] )) { |
  |  | 93 | if(wp\_verify\_nonce( $\_POST['sb\_elem\_cfd\_export'], 'sb\_elem\_cfd\_export' )) { |
  |  | 94 | echo '<input name="sb\_elem\_cfd\_export" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_export' ) . '" />'; |
  |  | 95 |  |
  |  | 96 | if(isset( $\_REQUEST['form\_name'] )) { |
  |  | 97 | if($rows = sb\_elem\_cfd\_get\_export\_rows( $\_REQUEST['form\_name'] )) { |
  |  | 98 |  |
  |  | 99 | header( 'Content-Type: application/csv' ); |
  |  | 100 | header( 'Content-Disposition: attachment; filename=' . sanitize\_title( $\_REQUEST['form\_name'] ) . '.csv' ); |
  |  | 101 | header( 'Pragma: no-cache' ); |
  |  | 102 | echo implode( "\n", $rows ); |
  |  | 103 | die; |
  |  | 104 | } |
  |  | 105 | } |
  |  | 106 |  |
  |  | 107 | if(isset( $\_REQUEST['form\_id'] )) { |
  |  | 108 | if($rows = sb\_elem\_cfd\_get\_export\_rows\_by\_form\_id( $\_REQUEST['form\_id'] )) { |
  |  | 109 |  |
  |  | 110 | header( 'Content-Type: application/csv' ); |
  |  | 111 | header( 'Content-Disposition: attachment; filename=' . sanitize\_title( $\_REQUEST['form\_id'] ) . '.csv' ); |
  |  | 112 | header( 'Pragma: no-cache' ); |
  |  | 113 | echo implode( "\n", $rows ); |
  |  | 114 | die; |
  |  | 115 | } |
  |  | 116 | } |
  | 122 | 117 | } |
  | 123 | 118 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L170) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L165) |  |
  | 170 | 165 | echo '<p>Use this simple form to export your contact data to CSV file. This is fairly crude but we don\'t have names for forms but we do have the page it was submitted from. Elementor has the facility to give a form an ID (in the additional tab of the builder). If set then you can also export by Form ID which is perhaps more useful!</p>'; |
  | 171 | 166 |  |
  | 172 |  | if~~( $form\_names = $wpdb->get\_results( $sql )~~ ) { |
  | 173 |  | foreach~~( $form\_names as $form\_name~~ ) { |
  | 174 |  | $forms2[~~$form\_name->form\_name~~ ] = $form\_name->form\_name; |
  | 175 |  | } |
  | 176 |  | } |
  | 177 |  |  |
  | 178 |  | if~~( $submitted\_ids = $wpdb->get\_results( $sql2 )~~ ) { |
  | 179 |  | foreach~~( $submitted\_ids as $submitted\_id~~ ) { |
  | 180 |  | $forms[~~$submitted\_id->submitted\_id~~ ] = get\_the\_title( $submitted\_id->submitted\_id ); |
  | 181 |  | } |
  | 182 |  | } |
  | 183 |  |  |
  | 184 |  | if~~( get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=1' )~~ ) { //get one record only. we don't need it but just to show there is a single submission |
  |  | 167 | if($form\_names = $wpdb->get\_results( $sql )) { |
  |  | 168 | foreach($form\_names as $form\_name) { |
  |  | 169 | $forms2[$form\_name->form\_name] = $form\_name->form\_name; |
  |  | 170 | } |
  |  | 171 | } |
  |  | 172 |  |
  |  | 173 | if($submitted\_ids = $wpdb->get\_results( $sql2 )) { |
  |  | 174 | foreach($submitted\_ids as $submitted\_id) { |
  |  | 175 | $forms[$submitted\_id->submitted\_id] = get\_the\_title( $submitted\_id->submitted\_id ); |
  |  | 176 | } |
  |  | 177 | } |
  |  | 178 |  |
  |  | 179 | if(get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=1' )) { //get one record only. we don't need it but just to show there is a single submission |
  | 185 | 180 |  |
  | 186 | 181 | set\_time\_limit( 0 ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L188) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L183) |  |
  | 188 | 183 |  |
  | 189 | 184 | //updating old data for a faster structure |
  | 190 |  | if~~( ! get\_option( 'sb\_elem\_cfd\_record\_update\_v15' )~~ ) { |
  | 191 |  | if~~( $posts = get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=4000&meta\_key=sb\_elem\_cfd\_submitted\_on\_id&meta\_compare=NOT EXISTS' )~~ ) { |
  |  | 185 | if(!get\_option( 'sb\_elem\_cfd\_record\_update\_v15' )) { |
  |  | 186 | if($posts = get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=4000&meta\_key=sb\_elem\_cfd\_submitted\_on\_id&meta\_compare=NOT EXISTS' )) { |
  | 192 | 187 | echo 'Found ' . count( $posts ) . ' Items to convert.<br />'; |
  | 193 | 188 |  |
  | 194 |  | foreach~~( $posts as $post~~ ) { |
  | 195 |  | if~~( $data = sb\_elem\_cfd\_get\_meta( $post->ID )~~ ) { |
  | 196 |  | $forms[~~$data['extra']['submitted\_on\_id']~~ ] = $data['extra']['submitted\_on']; |
  |  | 189 | foreach($posts as $post) { |
  |  | 190 | if($data = sb\_elem\_cfd\_get\_meta( $post->ID )) { |
  |  | 191 | $forms[$data['extra']['submitted\_on\_id']] = $data['extra']['submitted\_on']; |
  | 197 | 192 | update\_post\_meta( $post->ID, 'sb\_elem\_cfd\_submitted\_on\_id', $data['extra']['submitted\_on\_id'] ); |
  | 198 | 193 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L213) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L208) |  |
  | 213 | 208 |  |
  | 214 | 209 | ksort( $forms ); |
  | 215 |  | foreach~~( $forms as $form => $label~~ ) { |
  | 216 |  | echo '<option ' . (~~isset( $\_REQUEST['form\_name'] ) && $\_REQUEST['form\_name'] == $form ? 'selected="selected"' : ''~~ ) . ' value="' . $form . '">' . $label . '</option>'; |
  |  | 210 | foreach($forms as $form => $label) { |
  |  | 211 | echo '<option ' . (isset( $\_REQUEST['form\_name'] ) && $\_REQUEST['form\_name'] == $form ? 'selected="selected"' : '') . ' value="' . $form . '">' . $label . '</option>'; |
  | 217 | 212 | } |
  | 218 | 213 |  |
  | 219 | 214 | echo '</select>'; |
  | 220 | 215 | echo '<input type="submit" name="" class="button-primary" value="Export Form" />'; |
  |  | 216 | echo '<input name="sb\_elem\_cfd\_export" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_export' ) . '" />'; |
  | 221 | 217 | echo '</form>'; |
  | 222 | 218 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L226) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L222) |  |
  | 226 | 222 |  |
  | 227 | 223 | ksort( $forms2 ); |
  | 228 |  | foreach~~( $forms2 as $form~~ ) { |
  | 229 |  | echo '<option ' . (~~isset( $\_REQUEST['form\_id'] ) && $\_REQUEST['form\_id'] == $form ? 'selected="selected"' : ''~~ ) . ' value="' . $form . '">' . $form . '</option>'; |
  |  | 224 | foreach($forms2 as $form) { |
  |  | 225 | echo '<option ' . (isset( $\_REQUEST['form\_id'] ) && $\_REQUEST['form\_id'] == $form ? 'selected="selected"' : '') . ' value="' . $form . '">' . $form . '</option>'; |
  | 230 | 226 | } |
  | 231 | 227 |  |
  | 232 | 228 | echo '</select>'; |
  | 233 | 229 | echo '<input type="submit" name="" class="button-primary" value="Export Form" />'; |
  |  | 230 | echo '<input name="sb\_elem\_cfd\_export" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_export' ) . '" />'; |
  | 234 | 231 | echo '</form>'; |
  | 235 | 232 |  |
  | 236 | 233 | echo '<div style="clear: both;">&nbsp;</div>'; |
  | 237 | 234 |  |
  | 238 |  | if~~( isset( $\_REQUEST['form\_name'] )~~ ) { |
  |  | 235 | if(isset( $\_REQUEST['form\_name'] )) { |
  | 239 | 236 |  |
  | 240 | 237 | $rows = sb\_elem\_cfd\_get\_export\_rows( $\_REQUEST['form\_name'], 50 ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L247) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L244) |  |
  | 247 | 244 | echo '<input type="hidden" name="form\_name" value="' . $\_REQUEST['form\_name'] . '" />'; |
  | 248 | 245 | echo '<input type="submit" name="download\_csv" class="button-primary" value="Download CSV File" />'; |
  |  | 246 | echo '<input name="sb\_elem\_cfd\_export" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_export' ) . '" />'; |
  | 249 | 247 | echo '</form>'; |
  | 250 |  | } else~~if ( isset( $\_REQUEST['form\_id'] )~~ ) { |
  |  | 248 | } elseif(isset( $\_REQUEST['form\_id'] )) { |
  | 251 | 249 |  |
  | 252 | 250 | $rows = sb\_elem\_cfd\_get\_export\_rows\_by\_form\_id( $\_REQUEST['form\_id'], 50 ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L259) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L257) |  |
  | 259 | 257 | echo '<input type="hidden" name="form\_id" value="' . $\_REQUEST['form\_id'] . '" />'; |
  | 260 | 258 | echo '<input type="submit" name="download\_csv" class="button-primary" value="Download CSV File" />'; |
  |  | 259 | echo '<input name="sb\_elem\_cfd\_export" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_export' ) . '" />'; |
  | 261 | 260 | echo '</form>'; |
  | 262 | 261 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L283) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L282) |  |
  | 283 | 282 | echo '<div id="post-body" class="metabox-holder columns-2">'; |
  | 284 | 283 |  |
  | 285 |  | if ( isset( $\_POST['sb\_elem\_cfd\_save'] ) ) { |
  | 286 |  | //echo 'updating'; |
  | 287 |  |  |
  | 288 |  | update\_option( 'sb\_elem\_cfd', array\_map( 'sanitize\_text\_field', @$\_POST['sb\_elem\_cfd'] ) ); |
  | 289 |  |  |
  | 290 |  | echo '<div id="message" class="updated fade"><p>Settings saved successfully</p></div>'; |
  |  | 284 | if(isset( $\_POST['sb\_elem\_cfd\_save'] )) { |
  |  | 285 | if(!empty( $\_POST['sb\_elem\_cfd\_save\_settings'] )) { |
  |  | 286 | if(wp\_verify\_nonce( $\_POST['sb\_elem\_cfd\_save\_settings'], 'sb\_elem\_cfd\_save\_settings' )) { |
  |  | 287 | update\_option( 'sb\_elem\_cfd', array\_map( 'sanitize\_text\_field', @$\_POST['sb\_elem\_cfd'] ) ); |
  |  | 288 | echo '<div id="message" class="updated fade"><p>Settings saved successfully</p></div>'; |
  |  | 289 | } |
  |  | 290 | } |
  | 291 | 291 | } |
  | 292 | 292 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L304) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L304) |  |
  | 304 | 304 | <td>Disable Admin Nag?</td> |
  | 305 | 305 | <td> |
  | 306 |  | <input type="checkbox" name="sb\_elem\_cfd[disable\_admin\_nag]" ' . checked( 1, (~~isset( $sb\_elem\_cfd['disable\_admin\_nag'] ) ? 1 : 0~~ ), false ) . ' value="1" /> |
  |  | 306 | <input type="checkbox" name="sb\_elem\_cfd[disable\_admin\_nag]" ' . checked( 1, (isset( $sb\_elem\_cfd['disable\_admin\_nag'] ) ? 1 : 0), false ) . ' value="1" /> |
  | 307 | 307 | </td> |
  | 308 | 308 | <td> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L326) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L326) |  |
  | 326 | 326 |  |
  | 327 | 327 | echo '<p>'; |
  |  | 328 | echo '<input name="sb\_elem\_cfd\_save\_settings" type="hidden" value="' . wp\_create\_nonce( 'sb\_elem\_cfd\_save\_settings' ) . '" />'; |
  | 328 | 329 | echo '<input type="submit" name="sb\_elem\_cfd\_save" class="button-primary" value="Save Settings" />'; |
  | 329 | 330 | echo '</p>'; |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L339) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L340) |  |
  | 339 | 340 | } |
  | 340 | 341 |  |
  | 341 |  | function sb\_elem\_cfd\_get\_export\_rows(~~$submitted\_id, $limit = - 1~~ ) { |
  |  | 342 | function sb\_elem\_cfd\_get\_export\_rows($submitted\_id, $limit = - 1) { |
  | 342 | 343 | $rows = array(); |
  | 343 | 344 | $args = 'post\_type=elementor\_cf\_db&meta\_key=sb\_elem\_cfd\_submitted\_on\_id&posts\_per\_page=' . $limit . '&meta\_value=' . $submitted\_id; |
  | 344 | 345 |  |
  | 345 |  | if~~( $posts = get\_posts( $args )~~ ) { |
  |  | 346 | if($posts = get\_posts( $args )) { |
  | 346 | 347 |  |
  | 347 | 348 | $first\_post = current( $posts ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L350) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L351) |  |
  | 350 | 351 | $row .= '"Date","Submitted On","Form ID","Submitted By",'; |
  | 351 | 352 |  |
  | 352 |  | if~~( $data = sb\_elem\_cfd\_get\_meta( $first\_post->ID )~~ ) { |
  | 353 |  | foreach~~( $data['data'] as $field~~ ) { |
  |  | 353 | if($data = sb\_elem\_cfd\_get\_meta( $first\_post->ID )) { |
  |  | 354 | foreach($data['data'] as $field) { |
  | 354 | 355 | $row .= '"' . $field['label'] . '",'; |
  | 355 | 356 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L358) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L359) |  |
  | 358 | 359 | $rows[] = rtrim( $row, ',' ); |
  | 359 | 360 |  |
  | 360 |  | foreach~~( $posts as $post~~ ) { |
  | 361 |  | if~~( $data = sb\_elem\_cfd\_get\_meta( $post->ID )~~ ) { |
  |  | 361 | foreach($posts as $post) { |
  |  | 362 | if($data = sb\_elem\_cfd\_get\_meta( $post->ID )) { |
  | 362 | 363 | $row = ''; |
  | 363 | 364 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L365) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L366) |  |
  | 365 | 366 | $row¬† ¬† ¬†.= '"' . $post->post\_date . '","' . $data['extra']['submitted\_on'] . '","' . $form\_id . '","' . $data['extra']['submitted\_by'] . '",'; |
  | 366 | 367 |  |
  | 367 |  | foreach~~( $data['data'] as $field~~ ) { |
  |  | 368 | foreach($data['data'] as $field) { |
  | 368 | 369 | $row .= '"' . addslashes( $field['value'] ) . '",'; |
  | 369 | 370 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L377) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L378) |  |
  | 377 | 378 | } |
  | 378 | 379 |  |
  | 379 |  | function sb\_elem\_cfd\_get\_meta(~~$sub\_id~~ ) { |
  |  | 380 | function sb\_elem\_cfd\_get\_meta($sub\_id) { |
  | 380 | 381 | global $wpdb; |
  | 381 | 382 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L388) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L389) |  |
  | 388 | 389 | AND post\_id = ' . $sub\_id; |
  | 389 | 390 |  |
  | 390 |  | if~~( $meta = $wpdb->get\_var( $sql )~~ ) { |
  |  | 391 | if($meta = $wpdb->get\_var( $sql )) { |
  | 391 | 392 | $return = unserialize( $meta ); |
  | 392 | 393 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L395) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L396) |  |
  | 395 | 396 | } |
  | 396 | 397 |  |
  | 397 |  | function sb\_elem\_cfd\_get\_export\_rows\_by\_form\_id( $form\_id, $limit = - 1 ) { |
  | 398 |  |  |
  |  | 398 | function sb\_elem\_cfd\_get\_export\_rows\_by\_form\_id($form\_id, $limit = - 1) { |
  | 399 | 399 |  |
  | 400 | 400 | $rows = array(); |
  | 401 | 401 |  |
  | 402 |  | if~~( $posts = get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=' . $limit . '&meta\_key=sb\_elem\_cfd\_form\_id&meta\_value=' . $form\_id )~~ ) { |
  |  | 402 | if($posts = get\_posts( 'post\_type=elementor\_cf\_db&posts\_per\_page=' . $limit . '&meta\_key=sb\_elem\_cfd\_form\_id&meta\_value=' . $form\_id )) { |
  | 403 | 403 | $row = ''; |
  | 404 | 404 | $row .= '"Date","Submitted On","Form ID","Submitted By",'; |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L408) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L408) |  |
  | 408 | 408 | $data¬† ¬† ¬† ¬†= sb\_elem\_cfd\_get\_meta( $first\_post->ID ); |
  | 409 | 409 |  |
  | 410 |  | foreach~~( $data['data'] as $field~~ ) { |
  |  | 410 | foreach($data['data'] as $field) { |
  | 411 | 411 | $row .= '"' . $field['label'] . '",'; |
  | 412 | 412 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L415) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L415) |  |
  | 415 | 415 |  |
  | 416 | 416 | //fields |
  | 417 |  | foreach~~( $posts as $post~~ ) { |
  |  | 417 | foreach($posts as $post) { |
  | 418 | 418 | $data = sb\_elem\_cfd\_get\_meta( $post->ID ); |
  | 419 | 419 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L421) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L421) |  |
  | 421 | 421 | $row .= '"' . $post->post\_date . '","' . $data['extra']['submitted\_on'] . '","' . $form\_id . '","' . $data['extra']['submitted\_by'] . '",'; |
  | 422 | 422 |  |
  | 423 |  | foreach~~( $data['data'] as $field~~ ) { |
  |  | 423 | foreach($data['data'] as $field) { |
  | 424 | 424 | $row .= '"' . addslashes( $field['value'] ) . '",'; |
  | 425 | 425 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L435) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L435) |  |
  | 435 | 435 | global $current\_screen; |
  | 436 | 436 |  |
  | 437 |  | if~~( $current\_screen->id == 'elementor\_cf\_db'~~ ) { |
  |  | 437 | if($current\_screen->id == 'elementor\_cf\_db') { |
  | 438 | 438 | wp\_enqueue\_script( 'sb\_elem\_cfd\_js', plugins\_url( '/script.js', \_\_FILE\_\_ ) ); |
  | 439 | 439 | } |
  | 440 | 440 | } |
  | 441 | 441 |  |
  | 442 |  | function sb\_elem\_cfd\_columns\_head(~~$defaults~~ ) { |
  |  | 442 | function sb\_elem\_cfd\_columns\_head($defaults) { |
  | 443 | 443 | unset( $defaults['date'] ); |
  | 444 | 444 | //unset($defaults['cb']); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L457) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L457) |  |
  | 457 | 457 |  |
  | 458 | 458 | // SHOW THE FEATURED IMAGE |
  | 459 |  | function sb\_elem\_cfd\_columns\_content(~~$column\_name, $post\_id~~ ) { |
  |  | 459 | function sb\_elem\_cfd\_columns\_content($column\_name, $post\_id) { |
  | 460 | 460 | $contact = get\_post( $post\_id ); |
  | 461 | 461 | $data¬† ¬† = get\_post\_meta( $post\_id, 'sb\_elem\_cfd', true ); |
  | 462 | 462 |  |
  | 463 |  | if~~( $column\_name == 'cf\_elementor\_title'~~ ) { |
  |  | 463 | if($column\_name == 'cf\_elementor\_title') { |
  | 464 | 464 | echo '<a href="' . admin\_url( 'post.php?action=edit&post=' . $post\_id ) . '">View Submission</a>'; |
  | 465 |  | } else~~if ( $column\_name == 'read'~~ ) { |
  | 466 |  | if~~( $read = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_read', true )~~ ) { |
  |  | 465 | } elseif($column\_name == 'read') { |
  |  | 466 | if($read = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_read', true )) { |
  | 467 | 467 | echo '<span style="color: green;">' . $read['by\_name'] . '<br />' . date( 'Y-m-d H:i', $read['on'] ) . '</span>'; |
  | 468 | 468 | } else { |
  | 469 | 469 | echo '<span class="dashicons dashicons-email-alt"></span>'; |
  | 470 | 470 | } |
  | 471 |  | } else~~if ( $column\_name == 'sub\_on'~~ ) { |
  | 472 |  | if~~( $data['extra']['submitted\_on']~~ ) { |
  |  | 471 | } elseif($column\_name == 'sub\_on') { |
  |  | 472 | if($data['extra']['submitted\_on']) { |
  | 473 | 473 | echo '<a href="' . get\_permalink( $data['extra']['submitted\_on\_id'] ) . '">' . $data['extra']['submitted\_on'] . '</a>'; |
  | 474 | 474 | } |
  | 475 |  | } else~~if ( $column\_name == 'sub\_date'~~ ) { |
  |  | 475 | } elseif($column\_name == 'sub\_date') { |
  | 476 | 476 | echo $contact->post\_date; |
  | 477 |  | } else~~if ( $column\_name == 'cloned'~~ ) { |
  | 478 |  | if~~( $cloned = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_cloned', true )~~ ) { |
  |  | 477 | } elseif($column\_name == 'cloned') { |
  |  | 478 | if($cloned = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_cloned', true )) { |
  | 479 | 479 | $cloned\_count = count( $cloned ); |
  | 480 | 480 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L483) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L483) |  |
  | 483 | 483 | echo '<span class="dashicons dashicons-no-alt"></span>'; |
  | 484 | 484 | } |
  | 485 |  | } else~~if ( $column\_name == 'email'~~ ) { |
  | 486 |  | if~~( $email = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_email', true )~~ ) { |
  |  | 485 | } elseif($column\_name == 'email') { |
  |  | 486 | if($email = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_email', true )) { |
  | 487 | 487 | $email = '<a href="mailto:' . $email . '" target="\_blank">' . $email . '</a>'; |
  | 488 | 488 | } else { |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L490) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L490) |  |
  | 490 | 490 | } |
  | 491 | 491 | echo $email; |
  | 492 |  | } else~~if ( $column\_name == 'form\_id'~~ ) { |
  | 493 |  | if~~( ! $form\_id = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_form\_id', true )~~ ) { |
  |  | 492 | } elseif($column\_name == 'form\_id') { |
  |  | 493 | if(!$form\_id = get\_post\_meta( $post\_id, 'sb\_elem\_cfd\_form\_id', true )) { |
  | 494 | 494 | $form\_id = '-'; |
  | 495 | 495 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L503) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L503) |  |
  | 503 | 503 |  |
  | 504 | 504 | // Hide link on listing page |
  | 505 |  | if~~( ( isset( $\_GET['post\_type'] ) && $\_GET['post\_type'] == 'elementor\_cf\_db' ) || ( isset( $\_GET['post'] ) && get\_post\_type( $\_GET['post'] ) == 'elementor\_cf\_db' )~~ ) { |
  |  | 505 | if((isset( $\_GET['post\_type'] ) && $\_GET['post\_type'] == 'elementor\_cf\_db') || (isset( $\_GET['post'] ) && get\_post\_type( $\_GET['post'] ) == 'elementor\_cf\_db')) { |
  | 506 | 506 | echo '<style type="text/css"> |
  | 507 | 507 | .page-title-action, #favorite-actions, .add-new-h2 { display:none; } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L509) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L509) |  |
  | 509 | 509 | } |
  | 510 | 510 |  |
  | 511 |  | if~~( isset( $\_GET['sb-action'] )~~ ) { |
  |  | 511 | if(isset( $\_GET['sb-action'] )) { |
  | 512 | 512 | $action = $\_GET['sb-action']; |
  | 513 | 513 |  |
  | 514 |  | if~~( $action == 'mark-all-read'~~ ) { |
  |  | 514 | if($action == 'mark-all-read') { |
  | 515 | 515 | $args = array( |
  | 516 | 516 | 'posts\_per\_page' => - 1, |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L521) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L521) |  |
  | 521 | 521 | ); |
  | 522 | 522 |  |
  | 523 |  | if~~( $other\_contacts = get\_posts( $args )~~ ) { |
  | 524 |  | foreach~~( $other\_contacts as $other\_contact~~ ) { |
  |  | 523 | if($other\_contacts = get\_posts( $args )) { |
  |  | 524 | foreach($other\_contacts as $other\_contact) { |
  | 525 | 525 | $read = array( |
  | 526 | 526 | 'by\_name' => $current\_user->display\_name, |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L536) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L536) |  |
  | 536 | 536 |  |
  | 537 | 537 | function sb\_elem\_cfd\_admin\_notice() { |
  | 538 |  | if~~( ! current\_user\_can( 'administrator' )~~ ) { |
  |  | 538 | if(!current\_user\_can( 'administrator' )) { |
  | 539 | 539 | return; |
  | 540 | 540 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L542) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L542) |  |
  | 542 | 542 | $sb\_elem\_cfd = get\_option( 'sb\_elem\_cfd' ); |
  | 543 | 543 |  |
  | 544 |  | if~~( isset( $sb\_elem\_cfd['disable\_admin\_nag'] ) && $sb\_elem\_cfd['disable\_admin\_nag']~~ ) { |
  |  | 544 | if(isset( $sb\_elem\_cfd['disable\_admin\_nag'] ) && $sb\_elem\_cfd['disable\_admin\_nag']) { |
  | 545 | 545 | return; |
  | 546 | 546 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L554) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L554) |  |
  | 554 | 554 | ); |
  | 555 | 555 |  |
  | 556 |  | if~~( $other\_contacts = get\_posts( $args )~~ ) { |
  |  | 556 | if($other\_contacts = get\_posts( $args )) { |
  | 557 | 557 | //Use notice-warning for a yellow/orange, and notice-info for a blue left border. |
  | 558 | 558 | $class¬† ¬†= 'notice notice-error is-dismissible'; |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L578) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L578) |  |
  | 578 | 578 | $submission = get\_post( get\_the\_ID() ); |
  | 579 | 579 |  |
  | 580 |  | if~~( ! $read = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd\_read', true )~~ ) { |
  | 581 |  | $read = array(~~'by\_name' => $current\_user->display\_name, 'by' => $current\_user->ID, 'on' => time()~~ ); |
  |  | 580 | if(!$read = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd\_read', true )) { |
  |  | 581 | $read = array('by\_name' => $current\_user->display\_name, 'by' => $current\_user->ID, 'on' => time()); |
  | 582 | 582 | update\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd\_read', $read ); |
  | 583 | 583 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L587) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L587) |  |
  | 587 | 587 | printf( '<div class="%1$s"><p>%2$s</p></div>', $class, $message ); |
  | 588 | 588 |  |
  | 589 |  | if~~( $data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )~~ ) { |
  | 590 |  |  |
  | 591 |  | if~~( $fields = $data['data']~~ ) { |
  |  | 589 | if($data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )) { |
  |  | 590 |  |
  |  | 591 | if($fields = $data['data']) { |
  | 592 | 592 | echo '<table class="widefat"> |
  | 593 | 593 | <thead> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L599) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L599) |  |
  | 599 | 599 | <tbody>'; |
  | 600 | 600 |  |
  | 601 |  | foreach~~( $fields as $field~~ ) { |
  |  | 601 | foreach($fields as $field) { |
  | 602 | 602 | $value = $field['value']; |
  | 603 | 603 |  |
  | 604 |  | if~~( is\_email( $value )~~ ) { |
  |  | 604 | if(is\_email( $value )) { |
  | 605 | 605 | $value = '<a href="mailto:' . $value . '" target="\_blank">' . $value . '</a>'; |
  | 606 | 606 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L627) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L627) |  |
  | 627 | 627 | $other\_submissions = ''; |
  | 628 | 628 |  |
  | 629 |  | if~~( $data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )~~ ) { |
  | 630 |  | if~~( $extra = $data['extra']~~ ) { |
  |  | 629 | if($data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )) { |
  |  | 630 | if($extra = $data['extra']) { |
  | 631 | 631 | echo '<table class="widefat"> |
  | 632 | 632 | <thead> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L638) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L638) |  |
  | 638 | 638 | <tbody>'; |
  | 639 | 639 |  |
  | 640 |  | foreach~~( $extra as $key => $value~~ ) { |
  | 641 |  |  |
  | 642 |  | switch~~( $key~~ ) { |
  |  | 640 | foreach($extra as $key => $value) { |
  |  | 641 |  |
  |  | 642 | switch($key) { |
  | 643 | 643 | case 'submitted\_on\_id': |
  | 644 | 644 | case 'submitted\_by\_id': |
  | 645 |  | continue(~~2~~ ); //we don't really care about these ones |
  |  | 645 | continue(2); //we don't really care about these ones |
  | 646 | 646 | break; |
  | 647 | 647 | case 'submitted\_on': |
  | 648 |  | if~~( $extra['submitted\_on\_id']~~ ) { |
  |  | 648 | if($extra['submitted\_on\_id']) { |
  | 649 | 649 | $value = $value . ' (<a href="' . get\_permalink( $extra['submitted\_on\_id'] ) . '" target="\_blank">View Page</a> | <a href="' . admin\_url( 'post.php?action=edit&post=' . $extra['submitted\_on\_id'] ) . '" target="\_blank">Edit Page</a>)'; |
  | 650 | 650 | } else { |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L653) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L653) |  |
  | 653 | 653 | break; |
  | 654 | 654 | case 'submitted\_by': |
  | 655 |  | if~~( $extra['submitted\_by\_id']~~ ) { |
  |  | 655 | if($extra['submitted\_by\_id']) { |
  | 656 | 656 | $value = $value . ' (<a href="' . admin\_url( 'user-edit.php?user\_id=' . $extra['submitted\_by\_id'] ) . '" target="\_blank">View User Profiile</a>'; |
  | 657 | 657 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L664) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L664) |  |
  | 664 | 664 | ); |
  | 665 | 665 |  |
  | 666 |  | if~~( $other\_contacts = get\_posts( $args )~~ ) { |
  |  | 666 | if($other\_contacts = get\_posts( $args )) { |
  | 667 | 667 | $value¬† ¬† ¬† ¬† ¬† ¬† ¬†.= ' | <a style="cursor: pointer;" onclick="jQuery(\'.other\_submissions\').slideToggle();">View ' . count( $other\_contacts ) . ' more submissions by this user</a>'; |
  | 668 | 668 | $other\_submissions .= '<div style="display: none;" class="other\_submissions"> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L670) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L670) |  |
  | 670 | 670 | $other\_submissions .= '<table class="widefat">'; |
  | 671 | 671 |  |
  | 672 |  | foreach~~( $other\_contacts as $other\_contact~~ ) { |
  |  | 672 | foreach($other\_contacts as $other\_contact) { |
  | 673 | 673 | $other\_submissions .= '<tr><td><a href="' . admin\_url( 'post.php?action=edit&post=' . $other\_contact->ID ) . '">' . $other\_contact->post\_title . '</a></td></tr>'; |
  | 674 | 674 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L707) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L707) |  |
  | 707 | 707 | $data¬† ¬† ¬† ¬†= get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true ); |
  | 708 | 708 |  |
  | 709 |  | if~~( isset( $\_POST['sb\_elem\_cfd\_map\_to'] )~~ ) { |
  |  | 709 | if(isset( $\_POST['sb\_elem\_cfd\_map\_to'] )) { |
  | 710 | 710 | $map\_to¬† ¬† ¬† ¬†= $\_POST['sb\_elem\_cfd\_map\_to']; |
  | 711 | 711 | $map\_to\_other = $\_POST['sb\_elem\_cfd\_map\_to\_other']; |
  | 712 | 712 |  |
  | 713 |  | if~~( $fields = $data['data']~~ ) { |
  |  | 713 | if($fields = $data['data']) { |
  | 714 | 714 | $mapped\_fields = array(); |
  | 715 | 715 | $custom\_fields = array(); |
  | 716 | 716 |  |
  | 717 |  | foreach~~( $fields as $field~~ ) { |
  | 718 |  | $mapped\_fields[~~$field['label']~~ ] = $field['value']; |
  |  | 717 | foreach($fields as $field) { |
  |  | 718 | $mapped\_fields[$field['label']] = $field['value']; |
  | 719 | 719 | } |
  | 720 | 720 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L726) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L726) |  |
  | 726 | 726 | ); |
  | 727 | 727 |  |
  | 728 |  | if~~( isset( $\_POST['sb\_elem\_cfd\_date'] )~~ ) { |
  |  | 728 | if(isset( $\_POST['sb\_elem\_cfd\_date'] )) { |
  | 729 | 729 | $db\_ins['post\_date'] = $\_POST['sb\_elem\_cfd\_date']; |
  | 730 | 730 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L732) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L732) |  |
  | 732 | 732 | $found = 0; |
  | 733 | 733 |  |
  | 734 |  | foreach~~( $map\_to as $key => $field~~ ) { |
  | 735 |  | if~~( $field~~ ) { |
  |  | 734 | foreach($map\_to as $key => $field) { |
  |  | 735 | if($field) { |
  | 736 | 736 | $found ++; |
  | 737 | 737 |  |
  | 738 |  | if~~( $field == 'custom\_field'~~ ) { |
  | 739 |  | if~~( $map\_to\_other[ $key ]~~ ) { |
  | 740 |  | $custom\_fields[~~$map\_to\_other[ $key ] ] = $mapped\_fields[ $key~~ ]; |
  |  | 738 | if($field == 'custom\_field') { |
  |  | 739 | if($map\_to\_other[$key]) { |
  |  | 740 | $custom\_fields[$map\_to\_other[$key]] = $mapped\_fields[$key]; |
  | 741 | 741 | } |
  | 742 | 742 | } else { |
  | 743 |  | $db\_ins[~~$field ] = $mapped\_fields[ $key~~ ]; |
  |  | 743 | $db\_ins[$field] = $mapped\_fields[$key]; |
  | 744 | 744 | } |
  | 745 | 745 | } |
  | 746 | 746 | } |
  | 747 | 747 |  |
  | 748 |  | if~~( $found~~ ) { |
  |  | 748 | if($found) { |
  | 749 | 749 | // Insert the post into the database |
  | 750 |  | if~~( $post\_id = wp\_insert\_post( $db\_ins )~~ ) { |
  | 751 |  | if~~( ! is\_wp\_error( $post\_id )~~ ) { |
  | 752 |  | foreach~~( $custom\_fields as $key => $value~~ ) { |
  |  | 750 | if($post\_id = wp\_insert\_post( $db\_ins )) { |
  |  | 751 | if(!is\_wp\_error( $post\_id )) { |
  |  | 752 | foreach($custom\_fields as $key => $value) { |
  | 753 | 753 | update\_post\_meta( $post\_id, $key, $value ); |
  | 754 | 754 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L758) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L758) |  |
  | 758 | 758 | </div>'; |
  | 759 | 759 |  |
  | 760 |  | if~~( ! $cloned = get\_post\_meta( $\_GET['post'], 'sb\_elem\_cfd\_cloned', true )~~ ) { |
  |  | 760 | if(!$cloned = get\_post\_meta( $\_GET['post'], 'sb\_elem\_cfd\_cloned', true )) { |
  | 761 | 761 | $cloned = array(); |
  | 762 | 762 | } |
  | 763 | 763 |  |
  | 764 |  | $cloned[~~$post\_id~~ ] = time(); |
  |  | 764 | $cloned[$post\_id] = time(); |
  | 765 | 765 |  |
  | 766 | 766 | update\_post\_meta( $\_GET['post'], 'sb\_elem\_cfd\_cloned', $cloned ); |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L789) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L789) |  |
  | 789 | 789 | $map\_to\_options = array(); |
  | 790 | 790 | $maps¬† ¬† ¬† ¬† ¬† ¬†= array( |
  | 791 |  | 'post\_title'¬† ¬†=> 'Title' |
  | 792 |  | , |
  | 793 |  | 'post\_content' => 'Content' |
  | 794 |  | , |
  |  | 791 | 'post\_title'¬† ¬†=> 'Title', |
  |  | 792 | 'post\_content' => 'Content', |
  | 795 | 793 | 'custom\_field' => 'Custom Field' |
  | 796 | 794 | ); |
  | 797 | 795 |  |
  | 798 |  | foreach~~( $maps as $key => $value~~ ) { |
  |  | 796 | foreach($maps as $key => $value) { |
  | 799 | 797 | $map\_to\_options[] = '<option value="' . $key . '">' . $value . '</option>'; |
  | 800 | 798 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L803) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L801) |  |
  | 803 | 801 | $type\_options = array(); |
  | 804 | 802 |  |
  | 805 |  | foreach~~( $types as $type2~~ ) { |
  |  | 803 | foreach($types as $type2) { |
  | 806 | 804 | $type\_obj2 = get\_post\_type\_object( $type2 ); |
  | 807 | 805 |  |
  | 808 |  | if~~( ! $type\_obj2->public~~ ) { |
  |  | 806 | if(!$type\_obj2->public) { |
  | 809 | 807 | continue; |
  | 810 | 808 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L815) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L813) |  |
  | 815 | 813 | echo '<p>'; |
  | 816 | 814 |  |
  | 817 |  | if~~( $email = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd\_email', true )~~ ) { |
  |  | 815 | if($email = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd\_email', true )) { |
  | 818 | 816 | echo '<a style="margin-right: 10px;" class="button-primary" target="\_blank" href="mailto:' . $email . '">Reply via Email</a>'; |
  | 819 | 817 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L834) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L832) |  |
  | 834 | 832 | echo '<table class="widefat">'; |
  | 835 | 833 |  |
  | 836 |  | foreach~~( $data['fields\_original']['form\_fields'] as $field~~ ) { |
  |  | 834 | foreach($data['fields\_original']['form\_fields'] as $field) { |
  | 837 | 835 | echo '<tr> |
  | 838 | 836 | <td>' . $field['field\_label'] . '</td> |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L855) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L853) |  |
  | 855 | 853 | echo '</div>'; |
  | 856 | 854 |  |
  | 857 |  | if~~( $cloned = get\_post\_meta( $\_GET['post'], 'sb\_elem\_cfd\_cloned', true )~~ ) { |
  |  | 855 | if($cloned = get\_post\_meta( $\_GET['post'], 'sb\_elem\_cfd\_cloned', true )) { |
  | 858 | 856 | echo '<h3>Clone History</h3>'; |
  | 859 | 857 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L868) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L866) |  |
  | 868 | 866 | </thead>'; |
  | 869 | 867 |  |
  | 870 |  | foreach~~( $cloned as $cloned\_id => $date~~ ) { |
  | 871 |  | if~~( $cloned\_post = get\_post( $cloned\_id )~~ ) { |
  |  | 868 | foreach($cloned as $cloned\_id => $date) { |
  |  | 869 | if($cloned\_post = get\_post( $cloned\_id )) { |
  | 872 | 870 | $type\_obj¬† = get\_post\_type\_object( $cloned\_post->post\_type ); |
  | 873 | 871 | $type\_name = $type\_obj->labels->name; |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L889) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L887) |  |
  | 889 | 887 | function sb\_elem\_cfd\_meta\_box\_callback\_debug() { |
  | 890 | 888 |  |
  | 891 |  | if~~( $data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )~~ ) { |
  |  | 889 | if($data = get\_post\_meta( get\_the\_ID(), 'sb\_elem\_cfd', true )) { |
  | 892 | 890 | echo '<div style="display: none; overflow: scroll;" class="sb\_elem\_cfd\_debug">'; |
  | 893 | 891 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L935) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L933) |  |
  | 935 | 933 | 'menu\_position'¬† ¬† ¬† => null, |
  | 936 | 934 | 'menu\_icon'¬† ¬† ¬† ¬† ¬† => 'dashicons-admin-comments', |
  | 937 |  | 'supports'¬† ¬† ¬† ¬† ¬† ¬†=> array(~~'title'~~ ) |
  |  | 935 | 'supports'¬† ¬† ¬† ¬† ¬† ¬†=> array('title') |
  | 938 | 936 | ); |
  | 939 | 937 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L941) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L939) |  |
  | 941 | 939 | } |
  | 942 | 940 |  |
  | 943 |  | function sb\_elem\_cfd\_new\_record(~~$record, $form\_class~~ ) { |
  | 944 |  |  |
  | 945 |  | if~~( $fields = $record->get\_formatted\_data()~~ ) { |
  |  | 941 | function sb\_elem\_cfd\_new\_record($record, $form\_class) { |
  |  | 942 |  |
  |  | 943 | if($fields = $record->get\_formatted\_data()) { |
  | 946 | 944 | $data¬† = array(); |
  | 947 | 945 | $email = false; |
  | 948 | 946 |  |
  | 949 |  | foreach~~( $fields as $label => $value~~ ) { |
  | 950 |  |  |
  | 951 |  | if~~( stripos( $label, 'email' ) !== false~~ ) { |
  |  | 947 | foreach($fields as $label => $value) { |
  |  | 948 |  |
  |  | 949 | if(stripos( $label, 'email' ) !== false) { |
  | 952 | 950 | $email = $value; |
  | 953 | 951 | } |
  | 954 | 952 |  |
  | 955 |  | $data[] = array(~~'label' => $label, 'value' => sanitize\_text\_field( $value )~~ ); |
  |  | 953 | $data[] = array('label' => $label, 'value' => sanitize\_text\_field( $value )); |
  | 956 | 954 | } |
  | 957 | 955 |  |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L960) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L958) |  |
  | 960 | 958 | $current\_user = get\_current\_user\_id(); |
  | 961 | 959 |  |
  | 962 |  | if~~( $this\_user\_id = ( $current\_user ? $current\_user : 0 )~~ ) { |
  | 963 |  | if~~( $this\_user = get\_userdata( $this\_user\_id )~~ ) { |
  |  | 960 | if($this\_user\_id = ($current\_user ? $current\_user : 0)) { |
  |  | 961 | if($this\_user = get\_userdata( $this\_user\_id )) { |
  | 964 | 962 | $this\_user = $this\_user->display\_name; |
  | 965 | 963 | } |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L980) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L978) |  |
  | 980 | 978 |  |
  | 981 | 979 | // Insert the post into the database |
  | 982 |  | if~~( $post\_id = wp\_insert\_post( $db\_ins )~~ ) { |
  |  | 980 | if($post\_id = wp\_insert\_post( $db\_ins )) { |
  | 983 | 981 | update\_post\_meta( $post\_id, 'sb\_elem\_cfd', array( |
  | 984 | 982 | 'data'¬† ¬† ¬† ¬† ¬† ¬† => $data, |
  | 985 | 983 | 'extra'¬† ¬† ¬† ¬† ¬† ¬†=> $extra, |
  | 986 |  | 'fields\_original' => array(~~'form\_fields' => $record->get\_form\_settings( 'form\_fields' )~~ ), |
  |  | 984 | 'fields\_original' => array('form\_fields' => $record->get\_form\_settings( 'form\_fields' )), |
  | 987 | 985 | 'record\_original' => $record, |
  | 988 | 986 | 'post'¬† ¬† ¬† ¬† ¬† ¬† => array\_map( 'sanitize\_text\_field', $\_POST ), |
  | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2187370#L990) | [‚Ä¶](/browser/sb-elementor-contact-form-db/trunk/sb_elementor_contact_form_db.php?rev=2454670#L988) |  |
  | 990 | 988 | ) ); |
  | 991 | 989 |  |
  | 992 |  | if~~( $this\_user\_id~~ ) { |
  |  | 990 | if($this\_user\_id) { |
  | 993 | 991 | update\_post\_meta( $post\_id, 'sb\_elem\_cfd\_submitted\_by', $this\_user\_id ); |
  | 994 | 992 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2454670)
* [Zip Archive](?format=zip&new=2454670)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from advisory.checkmarx.net_947d72e7_20250114_195741.html ===
![](data:image/svg+xml...)![logo](data:image/gif;base64...)![logo](/_next/static/media/logo.4a80e7ce.png)

* [Advisories](/)
* [Disclosure Policy](/disclosure-policy/)
* [Contact Us](https://www.checkmarx.com/contact-us/)
* [Check with SCA](https://checkmarx.com/product/cxsca-open-source-scanning/)
Defend your code against√Ç¬†SpringShell√Ç¬†in two ways: read our√Ç¬†[blog post](https://checkmarx.com/blog/springshell-remote-code-execution-via-spring-web/)with what-to-do advice, and use√Ç¬†Checkmarx SCA√Ç¬†to test your applications.

From time to time, our security researchers find zero-day vulnerabilities in open source projects. When this happens, we inform the relevant maintaners of the package and publish our findings here only after they√¢¬Ä¬ôve been remediated, or when a patch is available.

* 1
* 2
* 3
* 4
* 5
* 6
* 7
* 8
* 9
* 10
* 11
* 12
* 13
* 14
√Ç¬© 2024 Checkmarx Ltd.

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)

* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)
* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

√Ç¬© 2024 Checkmarx Ltd.
