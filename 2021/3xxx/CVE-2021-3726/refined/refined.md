The provided content relates to CVE-2021-3726.

**Root cause of vulnerability:**
- The `title` function in `lib/termsupport.zsh` unsafely prints its input without sanitization, which, if used with custom user code, could trigger command injection.
- The `spectrum_ls` and `spectrum_bls` functions in `lib/spectrum.zsh` could be exploited if a variable is changed in the user's shell environment with a crafted value.

**Weaknesses/vulnerabilities present:**
- Command injection in the `title` function due to lack of sanitization of input.
- Potential command injection in `spectrum_ls` and `spectrum_bls` due to unsanitized variable expansion.

**Impact of exploitation:**
- An attacker could execute arbitrary commands on the user's system by injecting malicious code through the vulnerable functions.

**Attack vectors:**
- For the `title` function, an attacker would need to control the input to the `title` function. This is possible when the function is called with user defined variables.
- For the `spectrum_ls` and `spectrum_bls` functions, an attacker would need to modify the `ZSH_SPECTRUM_TEXT` variable within the user's shell environment with a malicious value.

**Required attacker capabilities/position:**
- For the `title` function, the attacker needs to have the ability to influence the arguments passed to the `title` function, typically through a crafted ZSH theme or configuration.
- For `spectrum_ls` and `spectrum_bls`, the attacker needs to be able to modify shell environment variables or inject a malicious theme with customized variables.