=== Content from security.paloaltonetworks.com_3208d0b8_20250115_080353.html ===


* [Get support](https://support.paloaltonetworks.com/support)
* [Security advisories](/)
* [Report vulnerabilities](/report)
* [Bug Bounty](/scope)
* [Subscribe](https://support.paloaltonetworks.com/SupportAccount/Preferences)
* [RSS feed](/rss.xml)
[Palo Alto Networks Security Advisories](/) /
CVE-2021-3041
## CVE-2021-3041 Cortex XDR Agent: Improper control of user-controlled file leads to local privilege escalation

047910
[Severity
7.8 ·
HIGH](https://cvssjs.github.io/#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H "CVSS-B: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H")Attack Vector
**LOCAL**Scope
**UNCHANGED**Attack Complexity
**LOW**Confidentiality Impact
**HIGH**Privileges Required
**LOW**Integrity Impact
**HIGH**User Interaction
**NONE**Availability Impact
**HIGH**[CVE](https://www.cve.org/CVERecord?id=CVE-2021-3041 "See CVE.org record")
[JSON](/json/CVE-2021-3041 "Download the information in this advisory in CVE-JSON format")
[CSAF](/csaf/CVE-2021-3041 "Download the information in this advisory in CSAF format")

 Published
**2021-06-09** Updated
**2022-01-14**Reference
**CPATR-12634,
CPATR-12507,
CPATR-11927**Discovered
**internally**
### Description

A local privilege escalation vulnerability exists in the Palo Alto Networks Cortex XDR agent on Windows platforms that enables an authenticated local Windows user to execute programs with SYSTEM privileges.

This requires the user to have the privilege to create files in the Windows root directory or to manipulate key registry values.

This issue impacts:

Cortex XDR agent 5.0 versions earlier than Cortex XDR agent 5.0.11 on Windows;

Cortex XDR agent 6.1 versions earlier than Cortex XDR agent 6.1.8 on Windows;

Cortex XDR agent 7.2 versions earlier than Cortex XDR agent 7.2.3 on Windows;

All versions of Cortex XDR agent 7.2 without content update release 171 or a later version on Windows.

### Product Status

| Versions | Affected | Unaffected |
| Cortex XDR Agent 7.2 | < 7.2.3 or without content update 171 or later on Windows | >= 7.2.3 with content update 171 or later on Windows |
| Cortex XDR Agent 6.1 | < 6.1.8 on Windows | >= 6.1.8 on Windows |
| Cortex XDR Agent 5.0 | < 5.0.11 on Windows | >= 5.0.11 on Windows |

### Severity: HIGH

CVSSv3.1
Base Score:
7.8 ([CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://cvssjs.github.io/#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H))

### Exploitation Status

Palo Alto Networks is not aware of any malicious exploitation of this issue.

### Weakness Type

[CWE-427 Uncontrolled Search Path Element](https://cwe.mitre.org/data/definitions/427 "More at https://cwe.mitre.org/data/definitions/427")

### Solution

This issue is fixed in Cortex XDR agent 5.0.11, Cortex XDR agent 6.1.8, Cortex XDR agent 7.2.3, and all later Cortex XDR agent versions.

Content updates are required to resolve this issue and are automatically applied for the agent.

### Workarounds and Mitigations

This issue is mitigated by preventing local authenticated Windows users from creating files in the Windows root directory (such as C:\) and ensuring they are unable to manipulate the Windows registry.

### Acknowledgments

This issue was found by Robert McCallum of Palo Alto Networks during internal security review.
### Timeline

2022-01-14
Update to affected platforms2021-06-09
Initial publication[Terms of use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)[Privacy](https://www.paloaltonetworks.com/legal-notices/privacy)[Product Security Assurance and Vulnerability Disclosure Policy](https://paloaltonetworks.com/product-security-assurance)[Report vulnerabilities](/report)[Manage subscriptions](https://support.paloaltonetworks.com/SupportAccount/Preferences)© 2025 Palo Alto Networks, Inc. All rights reserved.
