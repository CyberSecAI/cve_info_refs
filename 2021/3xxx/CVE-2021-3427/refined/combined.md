=== Content from groups.google.com_08ad1b08_20250115_094512.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## Deluge Dev

[Conversations](./g/deluge-dev)[About](./g/deluge-dev/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# [Deluge] #3460: XSS via malicious .torrent file

 92 viewsSkip to first unread message![Deluge's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### Deluge

unread,Mar 1, 2021, 8:23:05 PM3/1/21Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto delug...@googlegroups.com#3460: XSS via malicious .torrent file
----------------------------+--------------------
 Reporter: jasperla | Type: bug
 Status: new | Priority: major
Milestone: needs verified | Component: Web UI
 Version: develop | Keywords:
----------------------------+--------------------
 The Deluge web ui is vulnerable to XSS through a crafted torrent file.

As the data from torrent files is not properly sanitised it's interpreted
 directly as HTML. As such someone who supplies the user with a malicious
 torrent can execute arbitrary Javascript code in the context of the user's
 browser session. It should be noted that the Tornado webserver is not
 configured to send any `Content-Security-Policy` headers which can help to
 mitigate some of the impact. Due to this omission, the attacker can
 download/upload arbitrary data from/to remote endpoints.

It should be noted there is some basic filtering such that a `<script>`
 doesn't work, but this can be trivially bypassed by using a construct such
 as `<img src="#" onerror=` or just a hidden, remote iframe which loads the
 Javascript payload (see the PoC script for an example).

This script creates a PoC torrent to demonstrate the vulnerability:
 <https://gist.github.com/jasperla/4e6e06034e1cc4131f62839b46b697ef>
 the attached screenshot is taken after uploading a .torrent file generated
 by that script.

Additionally there are several HTML injection bugs, for example in the
 ''Connection Manager'', but these are merely bugs as the local user
 injects the payload as opposed to a remote attacker who uploads a
 malicious torrent to a public search engine.

--
Ticket URL: <<https://dev.deluge-torrent.org/ticket/3460>>
Deluge <<https://deluge-torrent.org/>>
Deluge Project

![Deluge's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### Deluge

unread,Mar 1, 2021, 8:23:22 PM3/1/21Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto delug...@googlegroups.com#3460: XSS via malicious .torrent file
-----------------------+----------------------------
 Reporter: jasperla | Owner:
 Type: bug | Status: new
 Priority: major | Milestone: needs verified
 Component: Web UI | Version: develop
Resolution: | Keywords:
-----------------------+----------------------------
Changes (by jasperla):

\* Attachment "deluge xss.png" added.

![Deluge's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### Deluge

unread,Mar 1, 2021, 8:25:32 PM3/1/21Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto delug...@googlegroups.com#3460: XSS via malicious .torrent file
-----------------------+----------------------------
 Reporter: jasperla | Owner:
 Type: bug | Status: new
 Priority: major | Milestone: needs verified
 Component: Web UI | Version: develop
Resolution: | Keywords:
-----------------------+----------------------------

Comment (by jasperla):

Please close this ticket, it's a duplicate of #3459.

--
Ticket URL: <<https://dev.deluge-torrent.org/ticket/3460#comment:1>>

Reply allReply to authorForward0 new messages

=== Content from security.gentoo.org_981446d7_20250115_094512.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Deluge: Cross-Site Scripting — GLSA **202210-07**

A vulnerability has been found in Deluge which could result in XSS.

### Affected packages

| Package | **net-p2p/deluge** on all architectures |
| --- | --- |
| Affected versions | < **2.1.1** |
| Unaffected versions | >= **2.1.1** |

### Background

Deluge is a BitTorrent client.

### Description

Deluge does not sufficiently sanitize crafted torrent file data, leading to the application interpreting untrusted data as HTML.

### Impact

An attacker can achieve XSS via a crafted torrent file.

### Workaround

There is no known workaround at this time.

### Resolution

All Deluge users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-p2p/deluge-2.1.1"

```
### References

* [CVE-2021-3427](https://nvd.nist.gov/vuln/detail/CVE-2021-3427)

**Release date**

October 16, 2022

**Latest revision**

October 16, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [866842](https://bugs.gentoo.org/show_bug.cgi?id=866842)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from dev.deluge-torrent.org_4b91b560_20250115_094510.html ===


[![](https://www.deluge-torrent.org/images/spacer.gif)](https://deluge-torrent.org/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [About Trac](/about)
* [Forgot your password?](/reset_password)

* [Timeline](/timeline)
* [Roadmap](/roadmap)
* [Browse Source](http://git.deluge-torrent.org/deluge/)
* [View Tickets](/report/1)
* [Search](/search)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ← [Previous Ticket](/ticket/3458 "Ticket #3458")
* [Next Ticket](/ticket/3460 "Ticket #3460") →

---

Opened [4 years ago](/timeline?from=2021-03-01T20%3A22%3A55Z&precision=second "See timeline at 03/01/2021 08:22:55 PM")

Last modified [3 years ago](/timeline?from=2022-07-08T07%3A45%3A43Z&precision=second "See timeline at 07/08/2022 07:45:43 AM")

## [#3459](/ticket/3459) [new](/query?status=new) [bug](/query?status=!closed&type=bug)

# XSS via malicious .torrent file

| Reported by: | [Jasper Lievisse Adriaanse](/query?status=!closed&reporter=jasperla) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [major](/query?status=!closed&priority=major) | Milestone: | [2.1.1](/milestone/2.1.1 "No date set") |
| Component: | [Web UI](/query?status=!closed&component=Web+UI) | Version: | [develop](/query?status=!closed&version=develop "Released 01/01/2019 12:00:00 AM") |
| Keywords: | [security](/query?status=!closed&keywords=~security) [xss](/query?status=!closed&keywords=~xss) | Cc: |  |

## Description

The Deluge web ui is vulnerable to XSS through a crafted torrent file.

As the data from torrent files is not properly sanitised it's interpreted directly as HTML. As such someone who supplies the user with a malicious torrent can execute arbitrary Javascript code in the context of the user's browser session. It should be noted that the Tornado webserver is not configured to send any `Content-Security-Policy` headers which can help to mitigate some of the impact. Due to this omission, the attacker can download/upload arbitrary data from/to remote endpoints.

It should be noted there is some basic filtering such that a `<script>` doesn't work, but this can be trivially bypassed by using a construct such as `<img src="#" onerror=` or just a hidden, remote iframe which loads the Javascript payload (see the PoC script for an example).

This script creates a PoC torrent to demonstrate the vulnerability: [​https://gist.github.com/jasperla/4e6e06034e1cc4131f62839b46b697ef](https://gist.github.com/jasperla/4e6e06034e1cc4131f62839b46b697ef)
the attached screenshot is taken after uploading a .torrent file generated by that script.

Additionally there are several HTML injection bugs, for example in the *Connection Manager*, but these are merely bugs as the local user injects the payload as opposed to a remote attacker who uploads a malicious torrent to a public search engine.

### Attachments (1)

[deluge xss.png](/attachment/ticket/3459/deluge%20xss.png "View attachment")[​](/raw-attachment/ticket/3459/deluge%20xss.png "Download")
(83.1 KB
) - added by Jasper Lievisse Adriaanse [4 years ago](/timeline?from=2021-03-01T20%3A25%3A07Z&precision=second "See timeline at 03/01/2021 08:25:07 PM").

Download all attachments as:
[.zip](/zip-attachment/ticket/3459/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (5)

### by Jasper Lievisse Adriaanse, [4 years ago](/timeline?from=2021-03-01T20%3A25%3A07Z&precision=second "See timeline at 03/01/2021 08:25:07 PM")

| Attachment: | [*deluge xss.png*](/attachment/ticket/3459/deluge%20xss.png)[​](/raw-attachment/ticket/3459/deluge%20xss.png "Download") added |
| --- | --- |

### [comment:1](#comment:1) by Jasper Lievisse Adriaanse, [4 years ago](/timeline?from=2021-03-03T18%3A39%3A36Z&precision=second "See timeline at 03/03/2021 06:39:36 PM")

| Keywords: | security xss added |
| --- | --- |

### [comment:2](#comment:2) by Calum, [3 years ago](/timeline?from=2022-02-14T21%3A52%3A04Z&precision=second "See timeline at 02/14/2022 09:52:04 PM")

Fixed XSS issues in [[8ece03677]](/changeset/8ece03677 "[WebUI] Move HTML entity encoding to client

We should not be mangling ...") and [[a5503c0c606]](/changeset/a5503c0c606 "[WebUI] Fix encoding HTML entities for torrent attributes

Ensure all ...")

I'll leave open to consider how to implement CSP

Thanks Jasper for reporting and let me know if I missed something or anything else that should be looked at.

### [comment:3](#comment:3) by Calum, [3 years ago](/timeline?from=2022-02-15T15%3A33%3A15Z&precision=second "See timeline at 02/15/2022 03:33:15 PM")

| Milestone: | needs verified → 2.1.0 |
| --- | --- |

### [comment:4](#comment:4) by Calum, [3 years ago](/timeline?from=2022-07-08T07%3A45%3A43Z&precision=second "See timeline at 07/08/2022 07:45:43 AM")

| Milestone: | 2.1.0 → 2.1.1 |
| --- | --- |

Ticket retargeted after milestone closed

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/3459?format=rss)
* [Comma-delimited Text](/ticket/3459?format=csv)
* [Tab-delimited Text](/ticket/3459?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.4.4**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>


