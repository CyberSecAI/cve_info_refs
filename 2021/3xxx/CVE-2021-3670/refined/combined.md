=== Content from access.redhat.com_9cb4073e_20250115_220813.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [FranÃ§ais](https://access.redhat.com/changeLanguage?language=fr)
* [í•œêµ­ì–´](https://access.redhat.com/changeLanguage?language=ko)
* [æ—¥æœ¬èª](https://access.redhat.com/changeLanguage?language=ja)
* [ä¸­æ–‡ (ä¸­å›½)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 Â© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security.gentoo.org_d0636a05_20250115_090425.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities â€” GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from gitlab.com_63b46786_20250115_090418.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
1d5b1556**

authored
Sep 27, 2021
by
**[![Andrew Bartlett's avatar](/uploads/-/system/user/avatar/365757/avatar.png?width=48 "Andrew Bartlett")](/abartlet)
[Andrew Bartlett](/abartlet)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/1d5b155619bc532c46932965b215bd73a920e56f)

### CVE-2021-3670 ldb: Confirm the request has not yet timed out in ldb filter processing

```

The LDB filter processing is where the time is spent in the LDB stack
but the timeout event will not get run while this is ongoing, so we
must confirm we have not yet timed out manually.

RN: Ensure that the LDB request has not timed out during filter processing
as the LDAP server MaxQueryDuration is otherwise not honoured.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/7d7f40b7d902e131fbd5e5d49e7670236792af381bcba9b9ff5d35a8c11fe698?s=32&d=identicon)Andrew Bartlett <abartlet@samba.org>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[e1ab0c43](/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049)

Loading

Loading

Loading

* [Changes
  5](/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f)

[Hide whitespace changes](/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f?action=show&controller=projects%2Fcommit&id=1d5b155619bc532c46932965b215bd73a920e56f&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f?view=inline)
[Side-by-side](/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f?view=parallel)

Loading

* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [4f1dbaf6](/samba-team/samba/-/commit/4f1dbaf60b83967a0f60464ec4f803271e9915f1 "CVE-2021-3670 ldb: Confirm the request has not yet timed out in ldb filter processing")

  Â·

  [Dec 02, 2021](#note_750376715)

  mentioned in commit [4f1dbaf6](/samba-team/samba/-/commit/4f1dbaf60b83967a0f60464ec4f803271e9915f1 "CVE-2021-3670 ldb: Confirm the request has not yet timed out in ldb filter processing")

  mentioned in commit 4f1dbaf60b83967a0f60464ec4f803271e9915f1

  Toggle commit list
* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [08c9016c](/samba-team/samba/-/commit/08c9016cb9f25105c39488770113a1b00f8a4223 "CVE-2021-3670 ldb: Confirm the request has not yet timed out in ldb filter processing")

  Â·

  [Dec 02, 2021](#note_750412397)

  mentioned in commit [08c9016c](/samba-team/samba/-/commit/08c9016cb9f25105c39488770113a1b00f8a4223 "CVE-2021-3670 ldb: Confirm the request has not yet timed out in ldb filter processing")

  mentioned in commit 08c9016cb9f25105c39488770113a1b00f8a4223

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.com_e1e91ef8_20250115_090424.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
dcfcafdb**

authored
Aug 26, 2021
by
**[![Jennifer Sutton's avatar](https://secure.gravatar.com/avatar/89c4b74a19a35f9b0ac054fdafaf82dadcc63f9b6c9bf77d4547e420f052a11f?s=96&d=identicon "Jennifer Sutton")](/jsutton24)
[Jennifer Sutton](/jsutton24)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/dcfcafdbf756e12d9077ad7920eea25478c29f81)

### CVE-2021-3670 tests/krb5/test\_ldap.py: Add test for LDAP timeouts

```

We allow a timeout of 2x over to avoid this being a flapping test.
Samba is not very accurate on the timeout, which is not otherwise an
issue but makes this test fail sometimes.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/f5353edc752a420aa8af10980ed46ce3418a335fb1e9fcbc1085620f64bb8764?s=32&d=identicon)Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[b5e0f33e](/samba-team/samba/-/commit/b5e0f33e8296d6312efadd8a78d752b788d66f54)

Loading

Loading

Loading

* [Changes
  2](/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81)

[Hide whitespace changes](/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81?action=show&controller=projects%2Fcommit&id=dcfcafdbf756e12d9077ad7920eea25478c29f81&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81?view=inline)
[Side-by-side](/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81?view=parallel)

Loading

* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [5d39c5b5](/samba-team/samba/-/commit/5d39c5b54b95a3bafadd2144f1c3250fbb1ac059 "CVE-2021-3670 tests/krb5/test_ldap.py: Add test for LDAP timeouts")

  Â·

  [Dec 02, 2021](#note_750376718)

  mentioned in commit [5d39c5b5](/samba-team/samba/-/commit/5d39c5b54b95a3bafadd2144f1c3250fbb1ac059 "CVE-2021-3670 tests/krb5/test_ldap.py: Add test for LDAP timeouts")

  mentioned in commit 5d39c5b54b95a3bafadd2144f1c3250fbb1ac059

  Toggle commit list
* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [dc71ae17](/samba-team/samba/-/commit/dc71ae17782ef4c6cac51e51b0b8b7ad77b556a0 "CVE-2021-3670 tests/krb5/test_ldap.py: Add test for LDAP timeouts")

  Â·

  [Dec 02, 2021](#note_750412419)

  mentioned in commit [dc71ae17](/samba-team/samba/-/commit/dc71ae17782ef4c6cac51e51b0b8b7ad77b556a0 "CVE-2021-3670 tests/krb5/test_ldap.py: Add test for LDAP timeouts")

  mentioned in commit dc71ae17782ef4c6cac51e51b0b8b7ad77b556a0

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from bugzilla.redhat.com_c975d731_20250115_090416.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2077533)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2077533)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2077533)+ Login using a Red Hat Bugzilla account
  + ForgotÂ Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla â€“ BugÂ 2077533

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**BugÂ 2077533**](show_bug.cgi?id=2077533)
(CVE-2021-3670)
- [CVE-2021-3670](https://access.redhat.com/security/cve/CVE-2021-3670) samba: MaxQueryDuration not honoured in Samba AD DC LDAP

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3670 samba: MaxQueryDuration not honoured in Samba AD DC LDAP

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3670 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nobody | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2077534](show_bug.cgi?id=2077534 "CLOSED CURRENTRELEASE - CVE-2021-3670 samba: MaxQueryDuration not honoured in Samba AD DC LDAP [fedora-all]") [2077647](show_bug.cgi?id=2077647) [2077648](show_bug.cgi?id=2077648) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2077535](show_bug.cgi?id=2077535) | | TreeView+ | [depends on](buglist.cgi?bug_id=2077533&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2077533&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-04-21 14:30 UTC by Michael Kaplan | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-07-07 08:30 UTC ([History](show_activity.cgi?id=2077533)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  abokovoy anoopcs askrabec asn dkarpele gdeschner iboukris jstephen lmohanty michal.skrivanek mperina pfilipen rhs-smb sbose ssorce | | Fixed In Version: |  | | | Doc Type: | No Doc Update | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2077533#c0)  Michael Kaplan    2022-04-21 14:30:29 UTC  ``` Samba's AD DC does not seem to honour MaxQueryDuration  References:  <https://github.com/samba-team/samba/commit/86fe9d48883f87c928bf31ccbd275db420386803> <https://bugzilla.samba.org/show_bug.cgi?id=14694>   ```  [Comment 1](show_bug.cgi?id=2077533#c1)  Michael Kaplan    2022-04-21 14:30:46 UTC  ``` Created samba tracking bugs for this issue:  Affects: fedora-all [[bug 2077534](show_bug.cgi?id=2077534 "CLOSED CURRENTRELEASE - CVE-2021-3670 samba: MaxQueryDuration not honoured in Samba AD DC LDAP [fedora-all]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2077533&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from secure.gravatar.com_fea9ef24_20250115_220817.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½  P P" ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ (ï¿½ï¿½ï¿½ï¿½ fï¿½ï¿½.ï¿½ã™sï¿½jï¿½ï¿½ï¿½7ï¿½ï¿½ï¿½ï¿½`ï¿½<ï¿½2 mï¿½
ï¿½ dï¿½ï¿½ï¿½ï¿½
{ï¿½ï¿½ ï¿½ï¿½İï¿½ï¿½;ï¿½yï¿½ï¿½^ï¿½$ï¿½ï’˜ï¿½ï¿½yï¿½ï¿½UtjOUï¿½ï¿½ï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½\*ï¿½ï¿½Jï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½^ï¿½ï¿½Oï¿½ï¿½ï¿½ï¿½ï¿½ï¿½C5ï¿½ï¿½1ï¿½zDyfï¿½ï¿½ÉFï¿½ï¿½ï¿½\_sï¿½ï¿½xï¿½9ï¿½Vï¿½&ï¿½\*ï¿½dï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½9Bï¿½+ï¿½ï¿½ d\_ï¿½Pï¿½Tï¿½ï¿½cï¿½"mICï¿½ï¿½#ï¿½ï¿½Hï¿½}C9\ï¿½ï¿½ï¿½ï¿½5á…£\*ï¿½ï¿½\*ï¿½V<]xPï¿½ï¿½ï¿½ï¿½kï¿½ï¿½bm+[ï¿½Å¿ï¿½>!ï¿½ï¿½Lï¿½ï¿½%ï¿½ï¿½ï¿½Wï¿½Gï¿½<ï¿½Hmï¿½ï¿½(#ï¿½Iï¿½ï¿½ï¿½ï¿½ï¿½ï¿½uï¿½>ï¿½ï¿½ï¿½O:ï¿½NiÅµÍ„Ò™Deï¿½\*ï¿½Í–ï¿½ ï¿½ï¿½bï¿½Aï¿½ï¿½Qtï¿½ï¿½ï¿½q\_ï¿½ï¿½ï¿½Æ…ï¿½'ï¿½4ï¿½ï¿½ï¿½ï¿½Iyp2ï¿½cï¿½rr}xï¿½ï¿½ï¿½ï¿½faï¿½cï¿½%'ï¿½ï¿½}ï¿½ï¿½?ï¿½~ï¿½ï¿½eï¿½n[ï¿½ï¿½Jï¿½dï¿½Ó—ï¿½æ¶±ï¿½ï¿½:1ï¿½:ï¿½ï¿½ï¿½wï¿½ ï¿½Ş½ï¿½ï¿½Vï¿½ï¿½Â»ï¿½$ï¿½^%ï¿½Éºï¿½\_ï¿½ï¿½wï¿½ ï¿½Ş¹ï¿½vï¿½h>ï¿½Tï¿½ï¿½Í³+ï¿½ï¿½Dï¿½ï¿½kï¿½ï¿½ï¿½ï¿½ï¿½i:7ï¿½4ï¿½ï¿½ï¿½ï¿½:ï¿½ Uï¿½ï¿½×µï¿½iï¿½oHï¿½N<qï¿½ï¿½0s\_~ï¿½ï¿½ ï¿½Í¸ï¿½ï¿½ï¿½ï¿½ï¿½[kÈï¿½ï¿½Mï¿½pï¿½ï¿½Vï¿½5u\*>ï¿½^ï¿½yd/Ú¾ï¿½ï¿½\ï¿½ï¿½Gï¿½/ï¿½]ï¿½ï¿½MÕ§lï¿½$?vOï¿½nï¿½yï¿½ï¿½Aeï¿½ï¿½ï¿½nï¿½ï¿½ï¿½\*ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½(ï¿½Ä˜'ï¿½ï¿½ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½+Ô¿i?ï¿½qï¿½9ï¿½ï¿½}ï¿½B-3Q\_ï¿½["ï¿½\*n$:ï¿½ï¿½ï¿½ï¿½-ï¿½ï¿½0ï¿½áŠ£ï¿½ï¿½Jï¿½ï¿½8ï¿½4ï¿½uï¿½Bï¿½ï¿½v
ï¿½ï¿½ï¿½ Ç¢ï¿½ï¿½ï¿½gï¿½miï¿½ï¿½ï¿½ï¿½\*#6?9?Jï¿½Vï¿½ï¿½ï¿½ ï¿½qï¿½QKï¿½ï¿½9h.ï¿½ï¿½Ü«ï¿½.8ï¿½ Zï¿½ï¿½ï¿½ï¿½ï¿½6ï¿½ï¿½ï¿½4}ï¿½ï¿½ jSï¿½ï¿½+}ï¿½ï¿½ï¿½ï¿½Ä²ï¿½gï¿½ZŞ£ß²ï¿½ï¿½tï¿½\*ï¿½~Tï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½9,ï¿½ï¿½%ï¿½ï¿½\_ï¿½ï¿½ |''ï¿½|ï¿½iï¿½ï¿½ï¿½ï¿½ï¿½ï¿½nï¿½ï¿½fBï¿½dWï¿½ ï¿½ï¿½fï¿½Thï¿½BQÑ†
ï¿½ï¿½z×‰ï¿½\ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½}sï¿½J?ï¿½gï¿½ï¿½ï¿½ï¿½.ï¿½ï¿½ï¿½`ï¿½ï¿½JUï¿½Xï¿½ï¿½ï¿½G(ï¿½7ï¿½[ï¿½e?ï¿½pï¿½ï¿½ï¿½u(Ã€ï¿½\Û¢ï¿½Gï¿½Vï¿½ï¿½ï¿½Â¾Hï¿½aï¿½Å¿dï¿½ï¿½Dï¿½ï¿½!ï¿½ï¿½ï¿½O2 ÛCcï¿½ï¿½ï¿½5Oï¿½7Å|Tï¿½ï¿½mzï¿½6ï¿½Z+Kdï¿½ï¿½F=[$ï¿½rMhï¿½ï¿½ ÚŸZï¿½\ï¿½ï¿½ï¿½{ï¿½ï¿½2\Gï¿½YGï¿½ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½×¿ï¿½ï¿½rpM%ï¿½ï¿½ï¿½ï¿½SFï¿½ï¿½ï¿½á•ï¿½ ï¿½ï¿½`ï¿½ï¿½ï¿½ï¿½mï¿½ï¿½ï¿½zï¿½ï¿½yÚ–ï¿½ou. vï¿½KÌšï¿½|ï¿½ .fï¿½cifï¿½ï¿½" ï¿½f' ï¿½ï¿½ï¿½ï¿½sï¿½ï¿½ï¿½Gï¿½/hscï¿½ï¿½tï¿½-ï¿½ ï¿½]cï¿½ï¿½ï¿½j8ï¿½ï¿½ï¿½ï¿½ï¿½kï¿½ï¿½Kï¿½ï¿½ï¿½\_?ï¿½ï¿½oï¿½ï¿½ï»·ï¿½|gï¿½yï¿½Qï¿½|9ï¿½Hï¿½ï¿½ï¿½Ï¨t
ï¿½ ï¿½ï¿½ Zï¿½ï¿½ï¿½ï¿½ï¿½uï¿½ï¿½Oiá’Kï¿½n1ï¿½ï¿½ jWÉ•ï¿½pï¿½7ï¿½t/ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½ï¿½Rvï¿½ï¿½ ï¿½kÚ¿d\_ï¿½ï¿½ï¿½+ï¿½ï¿½c-ï¿½ï¿½VCï¿½^;,{ï¿½1ï¿½}ï¿½\ï¿½ï¿½Zï¿½Vï¿½ï¿½{Øšï¿½Qï¿½ï¿½%cï¿½0ï¿½ï¿½ï¿½+Â½=ï¿½ï¿½~ï¿½jVI}nï¿½p}+ï¿½Úï¿½Oï¿½Nï¿½yï¿½ï¿½ï¿½5ï¿½ï¿½1ï¿½ï¿½ Kï¿½s&ï¿½ï¿½Ä¿Åï¿½G9ï¿½g'Gï¿½ï¿½][]ï¿½^
ï¿½è·¾ï¿½V
;Uï¿½l%ï¿½)ï¿½qï¿½xaï¿½~oï¿½ï¿½ï¿½ï¿½ï¿½ï¿½rE~@ï¿½/ ï¿½ï¿½ï¿½ï¿½%ï¿½}ï¿½ï¿½ï¿½`ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Lï¿½]ï¿½'ï¿½gï¿½Thï¿½BUï¿½qï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½3G(ï¿½ï¿½#Hï¿½ï¿½ï¿½ï¿½ M~ï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½ dï¿½GOÖ¬ï¿½qï¿½&ï¿½ï¿½+ ï¿½ï¿½"ï¿½q/ï¿½ï¿½3Jï¿½Ã·ï¿½ï¿½ï¿½8'ï¿½ï¿½kï¿½ï¿½iÎ»ï¿½ï¿½3Rk^,ï¿½ï¿½amï¿½ï¿½ï¿½\_~Ó¿ï¿½ï¿½ï¿½ï¿½ï¿½^ï¿½ï¿½Iï¿½ï¿½/ï¿½lï¿½Ğ¢ï¿½ï¿½BGï¿½ï¿½ï¿½ï¿½YKï¿½ï¿½Öšï¿½\_ï¿½ï¿½}ï¿½cï¿½ï¿½ï¿½ï¿½Oï¿½Oï¿½ï¿½ï¿½ï¿½ï¿½ï¿½~ï¿½ï¿½&^ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½vï¿½ï¿½ï¿½ï¿½>ï¿½Npyï¿½ï¿½Hï¿½@ Rï¿½ï¿½ï¿½\ï¿½ï¿½ï¿½ ï¿½vï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½I\*ï¿½ï¿½ ï¿½ï¿½ï¿½~ï¿½K
7ï¿½Wï¿½HGjï¿½Hï¿½ï¿½ ï¿½CWï¿½ï¿½Wï¿½ï¿½ï¿½eï¿½ï¿½ï¿½{ï¿½ 3ï¿½ÖŒÓ—ï¿½ï¿½/[/ï¿½=7ï¿½'ï¿½ï¿½Oï¿½ï¿½-ï¿½ï¿½ï¿½ï¿½Zlï¿½5ï¿½ï¿½ï¿½ï¿½=ï¿½,}ï¿½@>ï¿½ï¿½\*ï¿½F ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>ï¿½ï¿½bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½Q]')ï¿½ï¿½

=== Content from gitlab.com_687564c5_20250115_090420.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
3507e96b**

authored
Nov 18, 2021
by
**[![Andrew Bartlett's avatar](/uploads/-/system/user/avatar/365757/avatar.png?width=48 "Andrew Bartlett")](/abartlet)
[Andrew Bartlett](/abartlet)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393)

### CVE-2021-3670 ldap\_server: Clearly log LDAP queries and timeouts

```

This puts all the detail on one line so it can be searched
by IP address and connecting SID.

This relies on the anr handling as otherwise this log
becomes the expanded query, not the original one.

RN: Provide clear logs of the LDAP search and who made it, including
a warning (at log level 3) for queries that are 1/4 of the hard timeout.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/7d7f40b7d902e131fbd5e5d49e7670236792af381bcba9b9ff5d35a8c11fe698?s=32&d=identicon)Andrew Bartlett <abartlet@samba.org>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>

Autobuild-User(master): Douglas Bagnall <dbagnall@samba.org>
Autobuild-Date(master): Thu Nov 25 02:30:42 UTC 2021 on sn-devel-184
```

parent
[5f059036](/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b)

Loading

Loading

Loading

Loading

* [Changes
  1](/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393)
* [Pipelines
  2](/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393/pipelines)

[Hide whitespace changes](/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393?action=show&controller=projects%2Fcommit&id=3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393?view=inline)
[Side-by-side](/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393?view=parallel)

Loading

* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [9aa03f40](/samba-team/samba/-/commit/9aa03f402b7af97384e44dd4417587ccf98e138d "CVE-2021-3670 ldap_server: Clearly log LDAP queries and timeouts")

  Â·

  [Dec 02, 2021](#note_750376722)

  mentioned in commit [9aa03f40](/samba-team/samba/-/commit/9aa03f402b7af97384e44dd4417587ccf98e138d "CVE-2021-3670 ldap_server: Clearly log LDAP queries and timeouts")

  mentioned in commit 9aa03f402b7af97384e44dd4417587ccf98e138d

  Toggle commit list
* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [3e8d6e68](/samba-team/samba/-/commit/3e8d6e681f8dbe79e4595549f78c42649b3573a2 "CVE-2021-3670 ldap_server: Clearly log LDAP queries and timeouts")

  Â·

  [Dec 02, 2021](#note_750412408)

  mentioned in commit [3e8d6e68](/samba-team/samba/-/commit/3e8d6e681f8dbe79e4595549f78c42649b3573a2 "CVE-2021-3670 ldap_server: Clearly log LDAP queries and timeouts")

  mentioned in commit 3e8d6e681f8dbe79e4595549f78c42649b3573a2

  Toggle commit list
* [Ralph BÃ¶hme

  ğŸ”œ](/slowfranklin)
  @slowfranklin

  mentioned in merge request [!2259 (closed)](/samba-team/samba/-/merge_requests/2259 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  Â·

  [Dec 03, 2021](#note_751725005)

  mentioned in merge request [!2259 (closed)](/samba-team/samba/-/merge_requests/2259 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  mentioned in merge request !2259

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.com_31c3cfa9_20250115_090423.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
86fe9d48**

authored
Aug 26, 2021
by
**[![Jennifer Sutton's avatar](https://secure.gravatar.com/avatar/89c4b74a19a35f9b0ac054fdafaf82dadcc63f9b6c9bf77d4547e420f052a11f?s=96&d=identicon "Jennifer Sutton")](/jsutton24)
[Jennifer Sutton](/jsutton24)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/86fe9d48883f87c928bf31ccbd275db420386803)

### CVE-2021-3670 ldap\_server: Set timeout on requests based on MaxQueryDuration

```

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/f5353edc752a420aa8af10980ed46ce3418a335fb1e9fcbc1085620f64bb8764?s=32&d=identicon)Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[dcfcafdb](/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81)

Loading

Loading

Loading

* [Changes
  1](/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803)

[Hide whitespace changes](/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803?action=show&controller=projects%2Fcommit&id=86fe9d48883f87c928bf31ccbd275db420386803&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803?view=inline)
[Side-by-side](/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803?view=parallel)

Loading

* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [12702424](/samba-team/samba/-/commit/127024249351b42f5f5c72f5614d51d3c8a1b8d0 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  Â·

  [Dec 02, 2021](#note_750376720)

  mentioned in commit [12702424](/samba-team/samba/-/commit/127024249351b42f5f5c72f5614d51d3c8a1b8d0 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  mentioned in commit 127024249351b42f5f5c72f5614d51d3c8a1b8d0

  Toggle commit list
* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [f7209006](/samba-team/samba/-/commit/f72090064bd674ea3a6d6b2e7556a9a85bb01df6 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  Â·

  [Dec 02, 2021](#note_750412409)

  mentioned in commit [f7209006](/samba-team/samba/-/commit/f72090064bd674ea3a6d6b2e7556a9a85bb01df6 "CVE-2021-3670 ldap_server: Set timeout on requests based on MaxQueryDuration")

  mentioned in commit f72090064bd674ea3a6d6b2e7556a9a85bb01df6

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from secure.gravatar.com_b5a900d4_20250115_220816.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½  P P" ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½\*(ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½( ï¿½ï¿½ï¿½ï¿½ï¿½dï¿½ï¿½ï¿½:]Î½ï¿½jï¿½hï¿½ï¿½coï¿½0ï¿½\ï¿½ ï¿½ï¿½ï¿½2H99ï¿½×°ï¿½ï¿½N=!ï¿½ï¿½ï¿½3ï¿½ï¿½ï¿½ï¿½ï¿½Lï¿½ï¿½ï¿½)ï¿½ï¿½kï¿½5WFï¿½ï¿½[ï¿½İï¿½ï¿½pï¿½cï¿½ï¿½ï¿½Ò§î½µJï¿½ {>ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ß…ï¿½ï¿½{=ï¿½zŞ“Yï¿½ï¿½ï¿½dï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½^4zWï¿½CGz2R^Gï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½×ƒï¿½ï¿½ï¿½(ï¿½ï¿½ï¿½(ï¿½ï¿½ï¿½ï¿½Dï¿½Uï¿½Oï¿½61\_ï¿½&ï¿½ï¿½ï¿½:ï¿½ï¿½0ï¿½É´ï¿½gï¿½3ï¿½ï¿½î¡«ï¿½^Z2ï¿½=ï¿½ï¿½uapï¿½ï¿½×…
{ï¿½ï¿½ï¿½ï¿½Ù·ï¿½%Òµï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½|ï¿½KM%hDqCï¿½Tï¿½ï¿½Ãï¿½ï¿½ï¿½'ï¿½k?ï¿½ï¿½@ï¿½]ï¿½ï¿½ï¿½s\kï¿½ ï¿½2ï¿½ï¿½ï¿½Ñ›-ï¿½0A'ï¿½+ï¿½#\_ï¿½Iï¿½y ï¿½ï¿½ï¿½ï¿½ï¿½Y|h\_k2xSO!ï¿½,nDï¿½ï¿½ ï¿½ï¿½ï¿½#\_eï¿½Ï¿ï¿½ï¿½ï¿½,ï¿½3~bï¿½ï¿½ï¿½zï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½lï¿½-ï¿½rï¿½ Aslï¿½ï¿½rï¿½ï¿½ï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½ï¿½cï¿½ï¿½ï¿½ \_7ï¿½=ï¿½ï¿½nï¿½Xm+ï¿½ï¿½rkÄ¿aï¿½ï¿½7]ï¿½ï¿½nï¿½ ï¿½{ï¿½#ï¿½nï¿½MÂ½Pï¿½+ï¿½ï¿½slï¿½ï¿½ï¿½YHï¿½0A
xï¿½ï¿½?Xï¿½'Fï¿½ï¿½\_{>ï¿½\_ï¿½=:ï¿½ï¿½-4ï¿½ï¿½ï¿½Ç=BFkï¿½ï¿½Ú¿ï¿½Yï¿½^xï¿½ï¿½6Koy3\_ï¿½.uï¿½ï¿½Fï¿½ï¿½ï¿½ï¿½ï¿½ï¿½sï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½uï¿½/xï¿½ï¿½ï¿½éº´ï¿½2 ?ï¿½[ï¿½ï¿½tV<ï¿½ ï¿½ ï¿½ï¿½<A`ï¿½vNqï¿½Z5ï¿½ï¿½1~ï¿½ï¿½ï¿½ï¿½FX.$ï¿½=4ï¿½bï¿½ ï¿½ï¿½ï¿½`ï¿½2:R×©~ï¿½ï¿½ï¿½uï¿½Jï¿½Hï¿½Zfï¿½ï¿½nï¿½ETï¿½HtFï¿½+^[\_ï¿½ï¿½ï¿½Qï¿½hm%sï¿½^xJï¿½Sxï¿½}ï¿½ï¿½ ï¿½Ñ£ï¿½ï¿½^3Õ¶ï¿½4ï¿½pZï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½kï¿½ï¿½'ï¿½ï¿½ñ“¸ ï¿½ï¿½ï¿½ï¿½orï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ex|Gï¿½ï¿½ï¿½;y~hï¿½ï¿½ï¿½Ô§ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½eï¿½Ï‚ï¿½ï¿½F/ï¿½ec4ï¿½BÊ„ï¿½ï¿½ï¿½\_ï¿½!ï¿½Rdï¿½Ì’9.ï¿½ï¿½%ï¿½ï¿½I5ï¿½ï¿½ï¿½ï¿½ï¿½Rï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ofd!Oï¿½E~Pï¿½ï¿½hï¿½Fï¿½Xï¿½GF\*Ã‚ï¿½ï¿½ï¿½ï¿½9\*ï¿½ 5ï¿½ï¿½ï¿½\ï¿½ï¿½ÓŸï¿½Qï¿½[?ï¿½Oï¿½ï¿½wï¿½7{ï¿½ï¿½ï¿½ï¿½ï¿½\*ï¿½[ï¿½ï¿½ï¿½(ï¿½7ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½Ûšï¿½ï¿½2Ô£ï¿½ i.mï¿½?xï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Wï¿½>7xï¿½ï¿½ï¿½\_ï¿½Z]ï¿½ï¿½Ü§ï¿½ï¿½8
ï¿½ï¿½eH>ï¿½Oï¿½7Å|Sï¿½ï¿½mvï¿½6ï¿½Z+Kdï¿½ï¿½F=[$ï¿½rOï¿½hï¿½ï¿½ ÚŸZï¿½\ï¿½ï¿½ï¿½{ï¿½ï¿½2\Gï¿½YGï¿½ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½×¿ï¿½ï¿½A4ï¿½ï¿½G4.ï¿½KGCï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½qï¿½Gï¿½ï¿½?
ï¿½cï¿½Ô´ï¿½.e pï¿½ï¿½ï¿½ï¿½M~>Aï¿½3ï¿½(ï¿½ï¿½#DAï¿½ï¿½N ï¿½ï¿½ï¿½?ï¿½>|2ï¿½ï¿½6<ï¿½7Lï¿½ï¿½R:Xï¿½cï¿½æ£‹y=ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\_?ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½ß©ï¿½ï¿½ï¿½F!ï¿½ï¿½ Eu5ï¿½}Cï¿½oï¿½ï¿½\_#Wï¿½ï¿½nï¿½ï¿½ï¿½ï¿½<0/%Ô·ï¿½ï¿½ï¿½ï¿½|ï¿½^ï¿½sgBï¿½ï¿½ï¿½x|Sï¿½ï¿½ï¿½Rİ•ï¿½ï¿½ï¿½\_ï¿½/ï¿½h~ï¿½aï¿½ï¿½ï¿½aï¿½ï¿½!Ó¯ï¿½=ï¿½ï¿½>ï¿½\.Oe-^+E{ï¿½ï¿½ï¿½Qï¿½ï¿½%cï¿½pï¿½ï¿½ï¿½+Â½=ï¿½ï¿½~ï¿½ï¿½6+nPï¿½ï¿½ï¿½|/ï¿½Qï¿½ï¿½ï¿½ï¿½kï¿½.ï¿½}ï¿½Ş­ï¿½2ï¿½ï¿½p.dï¿½ï¿½Xï¿½ï¿½ï¿½Õ”sï¿½Frqï¿½ï¿½É¿ï¿½ÕµŞ›eï¿½Ş­ï¿½ï¿½
ï¿½iÚ­ï¿½a.pï¿½HÇ£ï¿½ cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½k{ï¿½ï¿½+ï¿½ï¿½y/ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\Iï¿½Zï¿½ï¿½ï¿½ï¿½ \_yï¿½ï¿½4Oo3ï¿½\*4Rï¿½\*ï¿½!ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½3$0ï¿½ï¿½ï¿½#Hï¿½K3ï¿½ :ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ xï¿½\_7\ï¿½Î‘ï¿½ÍŒ ï¿½,ï¿½Aï¿½b3ï¿½ï¿½ï¿½oá¿ƒ|'ï¿½ï¿½ï¿½oGï¿½ï¿½ï¿½ï¿½vqï¿½!ï¿½ ï¿½ï¿½Ö¾ï¿½ï¿½mï¿½ï¿½ï¿½'ï¿½ï¿½ï¿½ï¿½>?ï¿½Kï¿½ï¿½olï¿½}5ï¿½ï¿½ï¿½ï¿½'ï¿½ï¿½ï¿½ ï¿½>ï¿½ï¿½ï¿½V^8ï¿½Å“Y}ï¿½ï¿½ï¿½ï¿½"uÄ¦Oï¿½Uï¿½ï¿½UO9ï¿½8ï¿½ï¿½kqï¿½sï¿½ï¿½ï¿½?Zï¿½eï¿½ï¿½mpÏŠï¿½ï¿½ï¿½ï¿½ï¿½Æ .ï¿½5á«±5Ì™ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
!\ï¿½$}ß¯Oï¿½ï¿½ï¿½yï¿½-iï¿½ï¿½ï¿½}ï¿½ï¿½F8.ï¿½=tï¿½dï¿½ ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½ï¿½eï¿½Å´ï¿½nï¿½`>ï¿½nï¿½ï¿½>ï¿½Kï¿½ï¿½ï¿½8=ï¿½ï¿½ï¿½ï¿½Rï¿½ï¿½ï¿½l<0ï¿½cFEXï¿½Gï¿½ï¿½2ï¿½ï¿½ï¿½ï¿½Nï¿½EWQï¿½!ï¿½\_ï¿½iï¿½Sï¿½ï¿½ï¿½YC~ï¿½Î“
ï¿½Zï¿½dï¿½ï¿½ï¿½ï¿½=Hï¿½ï¿½4W5|5T9+EIyï¿½X|U|$ï¿½ï¿½ ï¿½ï¿½#ï¿½/ï¿½
jï¿½ï¿½ï¿½ï¿½ï¿½mï¿½ï¿½?dï¿½ITï¿½ ï¿½Ajï¿½ï¿½ï¿½|A,,4ï¿½
^ï¿½!}ï¿½ï¿½"ï¿½ï¿½
\_Q^ï¿½ï¿½ï¿½s\_ï¿½ï¿½ï¿½ï¿½Ï¢ï¿½ Z3N^\_hï¿½lï¿½ï¿½ï¿½ßˆï¿½ï¿½\_ï¿½>#G-ï¿½ï¿½ï¿½ï¿½Zlï¿½
iï¿½ï¿½7ï¿½GrKqï¿½ï¿½yï¿½ï¿½Aï¿½0)hï¿½wï¿½ï¿½ï¿½ï¿½%ï¿½ï¿½#ï¿½q8ï¿½ï¿½ï¿½ï¿½Jï¿½r~aEWIï¿½ï¿½ï¿½

=== Content from secure.gravatar.com_6946829b_20250115_220818.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½  P P" ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½\*(ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½( ï¿½ï¿½ï¿½ï¿½ï¿½dï¿½ï¿½ï¿½:]Î½ï¿½jï¿½hï¿½ï¿½coï¿½0ï¿½\ï¿½ ï¿½ï¿½ï¿½2H99ï¿½×°ï¿½ï¿½N=!ï¿½ï¿½ï¿½3ï¿½ï¿½ï¿½ï¿½ï¿½Lï¿½ï¿½ï¿½)ï¿½ï¿½kï¿½5WFï¿½ï¿½[ï¿½İï¿½ï¿½pï¿½cï¿½ï¿½ï¿½Ò§î½µJï¿½ {>ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ß…ï¿½ï¿½{=ï¿½zŞ“Yï¿½ï¿½ï¿½dï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½^4zWï¿½CGz2R^Gï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½×ƒï¿½ï¿½ï¿½(ï¿½ï¿½ï¿½(ï¿½ï¿½ï¿½ï¿½Dï¿½Uï¿½Oï¿½61\_ï¿½&ï¿½ï¿½ï¿½:ï¿½ï¿½0ï¿½É´ï¿½gï¿½3ï¿½ï¿½î¡«ï¿½^Z2ï¿½=ï¿½ï¿½uapï¿½ï¿½×…
{ï¿½ï¿½ï¿½ï¿½Ù·ï¿½%Òµï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½|ï¿½KM%hDqCï¿½Tï¿½ï¿½Ãï¿½ï¿½ï¿½'ï¿½k?ï¿½ï¿½@ï¿½]ï¿½ï¿½ï¿½s\kï¿½ ï¿½2ï¿½ï¿½ï¿½Ñ›-ï¿½0A'ï¿½+ï¿½#\_ï¿½Iï¿½y ï¿½ï¿½ï¿½ï¿½ï¿½Y|h\_k2xSO!ï¿½,nDï¿½ï¿½ ï¿½ï¿½ï¿½#\_eï¿½Ï¿ï¿½ï¿½ï¿½,ï¿½3~bï¿½ï¿½ï¿½zï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½lï¿½-ï¿½rï¿½ Aslï¿½ï¿½rï¿½ï¿½ï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½ï¿½cï¿½ï¿½ï¿½ \_7ï¿½=ï¿½ï¿½nï¿½Xm+ï¿½ï¿½rkÄ¿aï¿½ï¿½7]ï¿½ï¿½nï¿½ ï¿½{ï¿½#ï¿½nï¿½MÂ½Pï¿½+ï¿½ï¿½slï¿½ï¿½ï¿½YHï¿½0A
xï¿½ï¿½?Xï¿½'Fï¿½ï¿½\_{>ï¿½\_ï¿½=:ï¿½ï¿½-4ï¿½ï¿½ï¿½Ç=BFkï¿½ï¿½Ú¿ï¿½Yï¿½^xï¿½ï¿½6Koy3\_ï¿½.uï¿½ï¿½Fï¿½ï¿½ï¿½ï¿½ï¿½ï¿½sï¿½ï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½uï¿½/xï¿½ï¿½ï¿½éº´ï¿½2 ?ï¿½[ï¿½ï¿½tV<ï¿½ ï¿½ ï¿½ï¿½<A`ï¿½vNqï¿½Z5ï¿½ï¿½1~ï¿½ï¿½ï¿½ï¿½FX.$ï¿½=4ï¿½bï¿½ ï¿½ï¿½ï¿½`ï¿½2:R×©~ï¿½ï¿½ï¿½uï¿½Jï¿½Hï¿½Zfï¿½ï¿½nï¿½ETï¿½HtFï¿½+^[\_ï¿½ï¿½ï¿½Qï¿½hm%sï¿½^xJï¿½Sxï¿½}ï¿½ï¿½ ï¿½Ñ£ï¿½ï¿½^3Õ¶ï¿½4ï¿½pZï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½kï¿½ï¿½'ï¿½ï¿½ñ“¸ ï¿½ï¿½ï¿½ï¿½orï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ex|Gï¿½ï¿½ï¿½;y~hï¿½ï¿½ï¿½Ô§ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½eï¿½Ï‚ï¿½ï¿½F/ï¿½ec4ï¿½BÊ„ï¿½ï¿½ï¿½\_ï¿½!ï¿½Rdï¿½Ì’9.ï¿½ï¿½%ï¿½ï¿½I5ï¿½ï¿½ï¿½ï¿½ï¿½Rï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ofd!Oï¿½E~Pï¿½ï¿½hï¿½Fï¿½Xï¿½GF\*Ã‚ï¿½ï¿½ï¿½ï¿½9\*ï¿½ 5ï¿½ï¿½ï¿½\ï¿½ï¿½ÓŸï¿½Qï¿½[?ï¿½Oï¿½ï¿½wï¿½7{ï¿½ï¿½ï¿½ï¿½ï¿½\*ï¿½[ï¿½ï¿½ï¿½(ï¿½7ï¿½[ï¿½ï¿½ï¿½ï¿½ï¿½Ûšï¿½ï¿½2Ô£ï¿½ i.mï¿½?xï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Wï¿½>7xï¿½ï¿½ï¿½\_ï¿½Z]ï¿½ï¿½Ü§ï¿½ï¿½8
ï¿½ï¿½eH>ï¿½Oï¿½7Å|Sï¿½ï¿½mvï¿½6ï¿½Z+Kdï¿½ï¿½F=[$ï¿½rOï¿½hï¿½ï¿½ ÚŸZï¿½\ï¿½ï¿½ï¿½{ï¿½ï¿½2\Gï¿½YGï¿½ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½×¿ï¿½ï¿½A4ï¿½ï¿½G4.ï¿½KGCï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½qï¿½Gï¿½ï¿½?
ï¿½cï¿½Ô´ï¿½.e pï¿½ï¿½ï¿½ï¿½M~>Aï¿½3ï¿½(ï¿½ï¿½#DAï¿½ï¿½N ï¿½ï¿½ï¿½?ï¿½>|2ï¿½ï¿½6<ï¿½7Lï¿½ï¿½R:Xï¿½cï¿½æ£‹y=ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\_?ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½ß©ï¿½ï¿½ï¿½F!ï¿½ï¿½ Eu5ï¿½}Cï¿½oï¿½ï¿½\_#Wï¿½ï¿½nï¿½ï¿½ï¿½ï¿½<0/%Ô·ï¿½ï¿½ï¿½ï¿½|ï¿½^ï¿½sgBï¿½ï¿½ï¿½x|Sï¿½ï¿½ï¿½Rİ•ï¿½ï¿½ï¿½\_ï¿½/ï¿½h~ï¿½aï¿½ï¿½ï¿½aï¿½ï¿½!Ó¯ï¿½=ï¿½ï¿½>ï¿½\.Oe-^+E{ï¿½ï¿½ï¿½Qï¿½ï¿½%cï¿½pï¿½ï¿½ï¿½+Â½=ï¿½ï¿½~ï¿½ï¿½6+nPï¿½ï¿½ï¿½|/ï¿½Qï¿½ï¿½ï¿½ï¿½kï¿½.ï¿½}ï¿½Ş­ï¿½2ï¿½ï¿½p.dï¿½ï¿½Xï¿½ï¿½ï¿½Õ”sï¿½Frqï¿½ï¿½É¿ï¿½ÕµŞ›eï¿½Ş­ï¿½ï¿½
ï¿½iÚ­ï¿½a.pï¿½HÇ£ï¿½ cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½k{ï¿½ï¿½+ï¿½ï¿½y/ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\Iï¿½Zï¿½ï¿½ï¿½ï¿½ \_yï¿½ï¿½4Oo3ï¿½\*4Rï¿½\*ï¿½!ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½3$0ï¿½ï¿½ï¿½#Hï¿½K3ï¿½ :ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ xï¿½\_7\ï¿½Î‘ï¿½ÍŒ ï¿½,ï¿½Aï¿½b3ï¿½ï¿½ï¿½oá¿ƒ|'ï¿½ï¿½ï¿½oGï¿½ï¿½ï¿½ï¿½vqï¿½!ï¿½ ï¿½ï¿½Ö¾ï¿½ï¿½mï¿½ï¿½ï¿½'ï¿½ï¿½ï¿½ï¿½>?ï¿½Kï¿½ï¿½olï¿½}5ï¿½ï¿½ï¿½ï¿½'ï¿½ï¿½ï¿½ ï¿½>ï¿½ï¿½ï¿½V^8ï¿½Å“Y}ï¿½ï¿½ï¿½ï¿½"uÄ¦Oï¿½Uï¿½ï¿½UO9ï¿½8ï¿½ï¿½kqï¿½sï¿½ï¿½ï¿½?Zï¿½eï¿½ï¿½mpÏŠï¿½ï¿½ï¿½ï¿½ï¿½Æ .ï¿½5á«±5Ì™ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
!\ï¿½$}ß¯Oï¿½ï¿½ï¿½yï¿½-iï¿½ï¿½ï¿½}ï¿½ï¿½F8.ï¿½=tï¿½dï¿½ ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½ï¿½eï¿½Å´ï¿½nï¿½`>ï¿½nï¿½ï¿½>ï¿½Kï¿½ï¿½ï¿½8=ï¿½ï¿½ï¿½ï¿½Rï¿½ï¿½ï¿½l<0ï¿½cFEXï¿½Gï¿½ï¿½2ï¿½ï¿½ï¿½ï¿½Nï¿½EWQï¿½!ï¿½\_ï¿½iï¿½Sï¿½ï¿½ï¿½YC~ï¿½Î“
ï¿½Zï¿½dï¿½ï¿½ï¿½ï¿½=Hï¿½ï¿½4W5|5T9+EIyï¿½X|U|$ï¿½ï¿½ ï¿½ï¿½#ï¿½/ï¿½
jï¿½ï¿½ï¿½ï¿½ï¿½mï¿½ï¿½?dï¿½ITï¿½ ï¿½Ajï¿½ï¿½ï¿½|A,,4ï¿½
^ï¿½!}ï¿½ï¿½"ï¿½ï¿½
\_Q^ï¿½ï¿½ï¿½s\_ï¿½ï¿½ï¿½ï¿½Ï¢ï¿½ Z3N^\_hï¿½lï¿½ï¿½ï¿½ßˆï¿½ï¿½\_ï¿½>#G-ï¿½ï¿½ï¿½ï¿½Zlï¿½
iï¿½ï¿½7ï¿½GrKqï¿½ï¿½yï¿½ï¿½Aï¿½0)hï¿½wï¿½ï¿½ï¿½ï¿½%ï¿½ï¿½#ï¿½q8ï¿½ï¿½ï¿½ï¿½Jï¿½r~aEWIï¿½ï¿½ï¿½

=== Content from github.com_282d3f31_20250115_133601.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F86fe9d48883f87c928bf31ccbd275db420386803)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F86fe9d48883f87c928bf31ccbd275db420386803)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=samba-team%2Fsamba)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[samba-team](/samba-team)
/
**[samba](/samba-team/samba)**
Public

* [Notifications](/login?return_to=%2Fsamba-team%2Fsamba) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2Fsamba-team%2Fsamba)
* [Star
   932](/login?return_to=%2Fsamba-team%2Fsamba)

* [Code](/samba-team/samba)
* [Pull requests
  0](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

Additional navigation options

* [Code](/samba-team/samba)
* [Pull requests](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

## Commit

[Permalink](/samba-team/samba/commit/86fe9d48883f87c928bf31ccbd275db420386803)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[CVE-2021-3670](https://github.com/advisories/GHSA-p9j9-qqwf-j574 "CVE-2021-3670") ldap\_server: Set timeout on requests based on MaxQueryDâ€¦

[Browse files](/samba-team/samba/tree/86fe9d48883f87c928bf31ccbd275db420386803)
Browse the repository at this point in the history

```
â€¦uration

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

* Loading branch information

[![@jsutton24](https://avatars.githubusercontent.com/u/86935448?s=40&v=4)](/jsutton24) [![@douglasbagnall](https://avatars.githubusercontent.com/u/131030?s=40&v=4)](/douglasbagnall)

[jsutton24](/samba-team/samba/commits?author=jsutton24 "View all commits by jsutton24")
authored and
[douglasbagnall](/samba-team/samba/commits?author=douglasbagnall "View all commits by douglasbagnall")
committed
Nov 25, 2021

1 parent
[dcfcafd](/samba-team/samba/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81)

commit 86fe9d4

Showing
**1 changed file**
with
**11 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 11 additions & 1 deletion

12
[source4/ldap\_server/ldap\_backend.c](#diff-c906c667ffb95428b46126c7fc918fc2e3d67a53639d5ae9a061aeb39183b9a0 "source4/ldap_server/ldap_backend.c")

Show comments

[View file](/samba-team/samba/blob/86fe9d48883f87c928bf31ccbd275db420386803/source4/ldap_server/ldap_backend.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -869,7 +869,17 @@ static NTSTATUS ldapsrv\_SearchRequest(struct ldapsrv\_call \*call) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | ldb\_set\_timeout(samdb, lreq, req->timelimit); |
|  |  | { |
|  |  | time\_t timeout = call->conn->limits.search\_timeout; |
|  |  |  |
|  |  | if (timeout == 0 |
|  |  | || (req->timelimit != 0 |
|  |  | && req->timelimit < timeout)) |
|  |  | { |
|  |  | timeout = req->timelimit; |
|  |  | } |
|  |  | ldb\_set\_timeout(samdb, lreq, timeout); |
|  |  | } |
|  |  |  |
|  |  | if (!call->conn->is\_privileged) { |
|  |  | ldb\_req\_mark\_untrusted(lreq); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `86fe9d4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F86fe9d48883f87c928bf31ccbd275db420386803) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from gitlab.com_145d0bc7_20250115_090421.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
5f059036**

authored
Nov 18, 2021
by
**[![Andrew Bartlett's avatar](/uploads/-/system/user/avatar/365757/avatar.png?width=48 "Andrew Bartlett")](/abartlet)
[Andrew Bartlett](/abartlet)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/5f0590362c5c0c5ee20503a67467f9be2d50e73b)

### CVE-2021-3670 dsdb/anr: Do a copy of the potentially anr query before starting to modify it

```

RN: Do not modify the caller-supplied memory in the anr=* handling to
allow clear logging of the actual caller request after it has been processed.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/7d7f40b7d902e131fbd5e5d49e7670236792af381bcba9b9ff5d35a8c11fe698?s=32&d=identicon)Andrew Bartlett <abartlet@samba.org>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[2b3af3b5](/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002)

Loading

Loading

Loading

* [Changes
  1](/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b)

[Hide whitespace changes](/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b?action=show&controller=projects%2Fcommit&id=5f0590362c5c0c5ee20503a67467f9be2d50e73b&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b?view=inline)
[Side-by-side](/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b?view=parallel)

Loading

* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [9f4c89d0](/samba-team/samba/-/commit/9f4c89d0d3f530f7729f28b3183ade581e76f37a "CVE-2021-3670 dsdb/anr: Do a copy of the potentially anr query before starting to modify it")

  Â·

  [Dec 02, 2021](#note_750376714)

  mentioned in commit [9f4c89d0](/samba-team/samba/-/commit/9f4c89d0d3f530f7729f28b3183ade581e76f37a "CVE-2021-3670 dsdb/anr: Do a copy of the potentially anr query before starting to modify it")

  mentioned in commit 9f4c89d0d3f530f7729f28b3183ade581e76f37a

  Toggle commit list
* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [3a4eb50c](/samba-team/samba/-/commit/3a4eb50cf74671de3442d179bd2d44afd5bc52c1 "CVE-2021-3670 dsdb/anr: Do a copy of the potentially anr query before starting to modify it")

  Â·

  [Dec 02, 2021](#note_750412400)

  mentioned in commit [3a4eb50c](/samba-team/samba/-/commit/3a4eb50cf74671de3442d179bd2d44afd5bc52c1 "CVE-2021-3670 dsdb/anr: Do a copy of the potentially anr query before starting to modify it")

  mentioned in commit 3a4eb50cf74671de3442d179bd2d44afd5bc52c1

  Toggle commit list
* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [c67534fe](/samba-team/samba/-/commit/c67534fe3ff1652dcf95eac2030778b066cdf7a4 "selftest: Add test for combination of anr and paged_results")

  Â·

  [Aug 02, 2023](#note_1496992341)

  mentioned in commit [c67534fe](/samba-team/samba/-/commit/c67534fe3ff1652dcf95eac2030778b066cdf7a4 "selftest: Add test for combination of anr and paged_results")

  mentioned in commit c67534fe3ff1652dcf95eac2030778b066cdf7a4

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from github.com_6315c8c6_20250115_220816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-p9j9-qqwf-j574)

**CVE-2021-3670**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-p9j9-qqwf-j574)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2021-3670](/advisories/GHSA-p9j9-qqwf-j574)

## MaxQueryDuration not honoured in Samba AD DC LDAP

Moderate severity

Unreviewed

Published
Aug 24, 2022
to the GitHub Advisory Database
â€¢
Updated Sep 17, 2023

## Package

No package listedâ€”
[Suggest a package](/advisories/GHSA-p9j9-qqwf-j574/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

MaxQueryDuration not honoured in Samba AD DC LDAP

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2021-3670>
* <https://bugzilla.redhat.com/show_bug.cgi?id=2077533>
* <https://bugzilla.samba.org/show_bug.cgi?id=14694>
* <https://gitlab.com/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f>
* <https://gitlab.com/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002>
* <https://gitlab.com/samba-team/samba/-/commit/3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393>
* <https://gitlab.com/samba-team/samba/-/commit/5f0590362c5c0c5ee20503a67467f9be2d50e73b>
* <https://gitlab.com/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803>
* <https://gitlab.com/samba-team/samba/-/commit/dcfcafdbf756e12d9077ad7920eea25478c29f81>
* <https://gitlab.com/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049>
* <https://security.gentoo.org/glsa/202309-06>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
Aug 23, 2022

Published to the GitHub Advisory Database
Aug 24, 2022

Last updated
Sep 17, 2023

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.228%
 (61st percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

### CVE ID

CVE-2021-3670

### GHSA ID

GHSA-p9j9-qqwf-j574

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-p9j9-qqwf-j574/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from gitlab.com_b12238df_20250115_090425.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
e1ab0c43**

authored
Sep 28, 2021
by
**[![Jennifer Sutton's avatar](https://secure.gravatar.com/avatar/89c4b74a19a35f9b0ac054fdafaf82dadcc63f9b6c9bf77d4547e420f052a11f?s=96&d=identicon "Jennifer Sutton")](/jsutton24)
[Jennifer Sutton](/jsutton24)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/e1ab0c43629686d1d2c0b0b2bcdc90057a792049)

### CVE-2021-3670 ldap\_server: Ensure value of MaxQueryDuration is greater than zero

```

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/f5353edc752a420aa8af10980ed46ce3418a335fb1e9fcbc1085620f64bb8764?s=32&d=identicon)Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[86fe9d48](/samba-team/samba/-/commit/86fe9d48883f87c928bf31ccbd275db420386803)

Loading

Loading

Loading

* [Changes
  1](/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049)

[Hide whitespace changes](/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049?action=show&controller=projects%2Fcommit&id=e1ab0c43629686d1d2c0b0b2bcdc90057a792049&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049?view=inline)
[Side-by-side](/samba-team/samba/-/commit/e1ab0c43629686d1d2c0b0b2bcdc90057a792049?view=parallel)

Loading

* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [6b5cb85c](/samba-team/samba/-/commit/6b5cb85c2cc395020b29e20dc7292692c0ac781b "CVE-2021-3670 ldap_server: Ensure value of MaxQueryDuration is greater than zero")

  Â·

  [Dec 02, 2021](#note_750376712)

  mentioned in commit [6b5cb85c](/samba-team/samba/-/commit/6b5cb85c2cc395020b29e20dc7292692c0ac781b "CVE-2021-3670 ldap_server: Ensure value of MaxQueryDuration is greater than zero")

  mentioned in commit 6b5cb85c2cc395020b29e20dc7292692c0ac781b

  Toggle commit list
* [Samba Team GitLab Bot](/samba-team-bot)
  @samba-team-bot

  mentioned in commit [f9b2267c](/samba-team/samba/-/commit/f9b2267c6eb8138fc94df7a138ad5d87526f1d79 "CVE-2021-3670 ldap_server: Ensure value of MaxQueryDuration is greater than zero")

  Â·

  [Dec 02, 2021](#note_750412398)

  mentioned in commit [f9b2267c](/samba-team/samba/-/commit/f9b2267c6eb8138fc94df7a138ad5d87526f1d79 "CVE-2021-3670 ldap_server: Ensure value of MaxQueryDuration is greater than zero")

  mentioned in commit f9b2267c6eb8138fc94df7a138ad5d87526f1d79

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from bugzilla.samba.org_89ecf89b_20250115_220818.html ===


The Samba-Bugzilla â€“ BugÂ 14694
CVE-2021-3670 [SECURITY] MaxQueryDuration not honoured in Samba AD DC LDAP
Last modified: 2022-07-19 22:26:54 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [NewÂ Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=14694&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=14694&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**BugÂ 14694**](show_bug.cgi?id=14694)
(CVE-2021-3670)
- CVE-2021-3670 [SECURITY] MaxQueryDuration not honoured in Samba AD DC LDAP

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3670 [SECURITY] MaxQueryDuration not honoured in Samba AD DC LDAP

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3670 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Samba 4.1 and newer | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Samba 4.1 and newer "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | AD: LDB/DSDB/SAMDB ([show other bugs](buglist.cgi?component=AD%3A%20LDB%2FDSDB%2FSAMDB&product=Samba%204.1%20and%20newer&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.14.3 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 normal ([vote](page.cgi?id=voting/user.html&bug_id=14694#vote_14694)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Jule Anger | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Samba QA Contact | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2021-04-26 21:00 UTC by Andrew Bartlett | | --- | --- | | Modified: | 2022-07-19 22:26 UTC ([History](show_activity.cgi?id=14694)) | | CC List: | 4 users (show)  abartlet dbagnall kwinkelhane upw\_btaylor | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**patch from master backported to 4.15, 4.14 and 4.13**](attachment.cgi?id=17032 "View the content of the attachment") (12.69 KB, patch)  [2021-11-30 06:39 UTC](#attach_17032 "Go to the comment associated with the attachment"), Andrew Bartlett | dbagnall: review+ | [Details](attachment.cgi?id=17032&action=edit) | | [**v2 patch series with all 7 patches**](attachment.cgi?id=17034 "View the content of the attachment") (22.89 KB, patch)  [2021-11-30 23:27 UTC](#attach_17034 "Go to the comment associated with the attachment"), Douglas Bagnall | abartlet: review+ | [Details](attachment.cgi?id=17034&action=edit) | | [**v3 patch, with cherry-pick markers**](attachment.cgi?id=17038 "View the content of the attachment") (23.36 KB, patch)  [2021-12-01 21:36 UTC](#attach_17038 "Go to the comment associated with the attachment"), Douglas Bagnall | abartlet: review+ | [Details](attachment.cgi?id=17038&action=edit) | | [**Patch to only avoid modify of filter in anr (for 4.12)**](attachment.cgi?id=17430 "View the content of the attachment") (3.74 KB, patch)  [2022-07-19 22:26 UTC](#attach_17430 "Go to the comment associated with the attachment"), Andrew Bartlett | *no flags* | [Details](attachment.cgi?id=17430&action=edit) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=14694&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=14694&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=14694&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14694#c0)  Andrew Bartlett    2021-04-26 21:00:09 UTC  ``` Samba's AD DC does not seem to honour MaxQueryDuration ```  [Comment 1](show_bug.cgi?id=14694#c1)  Andrew Bartlett    2021-04-26 21:35:48 UTC  ``` In ldapsrv_SearchRequest() we do:  	ldb_set_timeout(samdb, lreq, req->timelimit);  But we don't cap it to the global policy.  We should also detect any requests that go over the global timeout and log them. ```  [Comment 2](show_bug.cgi?id=14694#c2)  Andrew Bartlett    2021-09-27 10:15:06 UTC  ``` Created [attachment 16825](attachment.cgi?id=16825) [[details]](attachment.cgi?id=16825&action=edit) initial advisory (v01) ```  [Comment 3](show_bug.cgi?id=14694#c3)  Douglas Bagnall    2021-09-28 22:34:06 UTC  ``` Comment on [attachment 16825](attachment.cgi?id=16825) [[details]](attachment.cgi?id=16825&action=edit) initial advisory (v01)  Advisory text loks fine to me, though I would re-wrap the first paragraph of _Description_. ```  [Comment 4](show_bug.cgi?id=14694#c4)  Andrew Bartlett    2021-11-18 03:29:21 UTC  ``` Comment on [attachment 16825](attachment.cgi?id=16825) [[details]](attachment.cgi?id=16825&action=edit) initial advisory (v01)  Removing advisory as this is just confusing as we won't do a security release for this any more, as this has been downgraded to a hardening.   CVE kept in case others want to track the hardening as something more significant, but as a Denial of Service and one where a determined attacker could just increase the request rate Samba won't do a specific release for this. ```  [Comment 5](show_bug.cgi?id=14694#c5)  Andrew Bartlett    2021-11-18 03:31:17 UTC  ``` Removing embargo, as while this is a very worthwhile fix, a coordinated disclosure etc implies that the fix would be total and sufficient, whereas in this case even after patching, the attacker could just use a little more effort and continue to deny service.  Therefore it is better and safer to just patch as normal in a maintenance release.  However the issue is real, so keep the CVE in case others want to track it. ```  [Comment 6](show_bug.cgi?id=14694#c6)  Andrew Bartlett    2021-11-18 03:36:51 UTC  ``` Some more context on this issue:  LDAP search filters can be very complex, search filters are not limited to indexed attributes and they can also include complext extended match rules like LDAP_MATCHING_RULE_IN_CHAIN.  The LDAP Policy setting "lDAPAdminLimits: MaxQueryDuration=120" (by default) should have provided a generous upper bound, however the policy was previously not considered in setting the timeout.  Additionally, no interuption points were set in the filter handling to check if the operation was over-time.  ================== CVSSv3 calculation ==================  (given that all LDAP threads could be locked up):  CVSS:3.1:AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H (6.5) ```  [Comment 7](show_bug.cgi?id=14694#c7)  Samba QA Contact    2021-11-25 02:31:04 UTC  ``` This bug was referenced in samba master:  dcfcafdbf756e12d9077ad7920eea25478c29f81 86fe9d48883f87c928bf31ccbd275db420386803 e1ab0c43629686d1d2c0b0b2bcdc90057a792049 1d5b155619bc532c46932965b215bd73a920e56f 2b3af3b560c9617a233c131376c870fce146c002 5f0590362c5c0c5ee20503a67467f9be2d50e73b 3507e96b3dcf0c0b8eff7b2c08ffccaf0812a393 ```  [Comment 8](show_bug.cgi?id=14694#c8)  Andrew Bartlett    2021-11-30 06:39:48 UTC  ``` Created [attachment 17032](attachment.cgi?id=17032 "patch from master backported to 4.15, 4.14 and 4.13") [[details]](attachment.cgi?id=17032&action=edit "patch from master backported to 4.15, 4.14 and 4.13") patch from master backported to 4.15, 4.14 and 4.13  NOTE: While this has a CVE- marker, 4.13 is not taking this level of security patch.  This has a CVE for tracking, but we are not doing an embargoed release for this.  The issue is similar to our rule against a CVE for a crash in a re-starting server, just as eventually the service will restart, eventually the LDAP request will finish. ```  [Comment 9](show_bug.cgi?id=14694#c9)  Douglas Bagnall    2021-11-30 21:55:40 UTC  ``` Comment on [attachment 17032](attachment.cgi?id=17032 "patch from master backported to 4.15, 4.14 and 4.13") [[details]](attachment.cgi?id=17032&action=edit "patch from master backported to 4.15, 4.14 and 4.13") patch from master backported to 4.15, 4.14 and 4.13  CVE-2021-3670-ldap_spin-v4-15.patch contains the first 4 patches of the 7 patch series on master (otherwise unchanged).  The dropped 3 patches tidy up logging, which is nice but not critical, so it's ok and perhaps preferable to drop them from the security backport. ```  [Comment 10](show_bug.cgi?id=14694#c10)  Andrew Bartlett    2021-11-30 22:26:13 UTC  ``` (In reply to Douglas Bagnall from [comment #9](show_bug.cgi?id=14694#c9)) Thanks for checking that.  Sorry I missed those, I'll re-do, the logging is important to allow fine-tuning of this work. ```  [Comment 11](show_bug.cgi?id=14694#c11)  Douglas Bagnall    2021-11-30 23:27:47 UTC  ``` Created [attachment 17034](attachment.cgi?id=17034 "v2 patch series with all 7 patches") [[details]](attachment.cgi?id=17034&action=edit "v2 patch series with all 7 patches") v2 patch series with all 7 patches  In that case you want this patch.  It applies back to 4.11. ```  [Comment 12](show_bug.cgi?id=14694#c12)  Andrew Bartlett    2021-12-01 00:12:05 UTC  ``` Re-assiging to Jule for 4.15.next and 4.14.next ```  [Comment 13](show_bug.cgi?id=14694#c13)  Jule Anger    2021-12-01 07:49:53 UTC  ``` (In reply to Andrew Bartlett from [comment #12](show_bug.cgi?id=14694#c12)) The cherry-picked marker is missing. Please add :-) ```  [Comment 14](show_bug.cgi?id=14694#c14)  Douglas Bagnall    2021-12-01 21:36:47 UTC  ``` Created [attachment 17038](attachment.cgi?id=17038 "v3 patch, with cherry-pick markers") [[details]](attachment.cgi?id=17038&action=edit "v3 patch, with cherry-pick markers") v3 patch, with cherry-pick markers  thanks Jule. Here you go. ```  [Comment 15](show_bug.cgi?id=14694#c15)  Andrew Bartlett    2021-12-01 23:48:12 UTC  ``` Sorry about that, this time should be better. ```  [Comment 16](show_bug.cgi?id=14694#c16)  Jule Anger    2021-12-02 10:25:10 UTC  ``` Thanks! Pushed to autobuild-v4-{15,14}-test. ```  [Comment 17](show_bug.cgi?id=14694#c17)  Samba QA Contact    2021-12-02 11:53:04 UTC  ``` This bug was referenced in samba v4-14-test:  dc71ae17782ef4c6cac51e51b0b8b7ad77b556a0 f72090064bd674ea3a6d6b2e7556a9a85bb01df6 f9b2267c6eb8138fc94df7a138ad5d87526f1d79 08c9016cb9f25105c39488770113a1b00f8a4223 d92dfb0dabf9cfccb86f2b1146d6c353af2e1435 3a4eb50cf74671de3442d179bd2d44afd5bc52c1 3e8d6e681f8dbe79e4595549f78c42649b3573a2 ```  [Comment 18](show_bug.cgi?id=14694#c18)  Samba QA Contact    2021-12-02 11:55:23 UTC  ``` This bug was referenced in samba v4-15-test:  5d39c5b54b95a3bafadd2144f1c3250fbb1ac059 127024249351b42f5f5c72f5614d51d3c8a1b8d0 6b5cb85c2cc395020b29e20dc7292692c0ac781b 4f1dbaf60b83967a0f60464ec4f803271e9915f1 1142f18ff1d8e8b66e51fe5a1f591f55ba5f0d13 9f4c89d0d3f530f7729f28b3183ade581e76f37a 9aa03f402b7af97384e44dd4417587ccf98e138d ```  [Comment 19](show_bug.cgi?id=14694#c19)  Jule Anger    2021-12-02 15:38:11 UTC  ``` Closing out bug report.  Thanks! ```  [Comment 20](show_bug.cgi?id=14694#c20)  Samba QA Contact    2021-12-08 14:40:13 UTC  ``` This bug was referenced in samba v4-15-stable (Release samba-4.15.3):  5d39c5b54b95a3bafadd2144f1c3250fbb1ac059 127024249351b42f5f5c72f5614d51d3c8a1b8d0 6b5cb85c2cc395020b29e20dc7292692c0ac781b 4f1dbaf60b83967a0f60464ec4f803271e9915f1 1142f18ff1d8e8b66e51fe5a1f591f55ba5f0d13 9f4c89d0d3f530f7729f28b3183ade581e76f37a 9aa03f402b7af97384e44dd4417587ccf98e138d ```  [Comment 21](show_bug.cgi?id=14694#c21)  Andrew Bartlett    2021-12-15 06:58:10 UTC  ``` Details on log levels and the timeout information given.  At Log level 1, we will log when a request has triggered a timeout, along with the IP address and authenticated SID.  At log level 3, we will log when a request has take more than 1/4 the timeout.   At log level 5, we will log all queries and the time they take.  This is all on the 'main' log level, not under a distinct debug class. ```  [Comment 22](show_bug.cgi?id=14694#c22)  Andrew Bartlett    2021-12-15 07:00:00 UTC  ``` The policy is stored here:  dn: CN=Default Query Policy,CN=Query-Policies,CN=Directory Service,CN=Windows NT,CN=Services,${CONFIGDN} lDAPAdminLimits: MaxQueryDuration=120 ```  [Comment 23](show_bug.cgi?id=14694#c23)  Samba QA Contact    2021-12-15 14:53:18 UTC  ``` This bug was referenced in samba v4-14-stable (Release samba-4.14.11):  dc71ae17782ef4c6cac51e51b0b8b7ad77b556a0 f72090064bd674ea3a6d6b2e7556a9a85bb01df6 f9b2267c6eb8138fc94df7a138ad5d87526f1d79 08c9016cb9f25105c39488770113a1b00f8a4223 d92dfb0dabf9cfccb86f2b1146d6c353af2e1435 3a4eb50cf74671de3442d179bd2d44afd5bc52c1 3e8d6e681f8dbe79e4595549f78c42649b3573a2 ```  [Comment 24](show_bug.cgi?id=14694#c24)  Samba QA Contact    2022-01-24 12:45:04 UTC  ``` This bug was referenced in samba v4-15-test:  d93892d2e8ed69758c15ab18bc03bba09e715bc6 ```  [Comment 25](show_bug.cgi?id=14694#c25)  Samba QA Contact    2022-01-24 14:01:04 UTC  ``` This bug was referenced in samba v4-14-test:  6417cadc2770f5abc8aa78f32e1c25b83c4063f1 ```  [Comment 26](show_bug.cgi?id=14694#c26)  Stefan Metzmacher    2022-01-24 14:05:50 UTC  ``` The ldb part is now also available in standalone releases 2.5.0, 2.4.2 and 2.3.3 ```  [Comment 27](show_bug.cgi?id=14694#c27)  Samba QA Contact    2022-03-15 13:25:59 UTC  ``` This bug was referenced in samba v4-15-stable (Release samba-4.15.6):  d93892d2e8ed69758c15ab18bc03bba09e715bc6 ```  [Comment 28](show_bug.cgi?id=14694#c28)  Samba QA Contact    2022-04-04 12:49:50 UTC  ``` This bug was referenced in samba v4-14-stable (Release samba-4.14.13):  6417cadc2770f5abc8aa78f32e1c25b83c4063f1 ```  [Comment 29](show_bug.cgi?id=14694#c29)  Andrew Bartlett    2022-07-19 22:26:16 UTC  ``` Created [attachment 17430](attachment.cgi?id=17430 "Patch to only avoid modify of filter in anr (for 4.12)") [[details]](attachment.cgi?id=17430&action=edit "Patch to only avoid modify of filter in anr (for 4.12)") Patch to only avoid modify of filter in anr (for 4.12)  Samba 4.12 did not get the security patch for the long query time, but in case this is valuable for others, here is the backport to not modify the caller memory of the LDAP filter in anr. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14694)
* -Â [XML](show_bug.cgi?ctype=xml&id=14694)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=14694)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [NewÂ Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=14694&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=14694&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from gitlab.com_c06ba1b4_20250115_090419.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
2b3af3b5**

authored
Nov 18, 2021
by
**[![Andrew Bartlett's avatar](/uploads/-/system/user/avatar/365757/avatar.png?width=48 "Andrew Bartlett")](/abartlet)
[Andrew Bartlett](/abartlet)**
Committed by
Douglas Bagnall
Nov 25, 2021

[Browse files](/samba-team/samba/-/tree/2b3af3b560c9617a233c131376c870fce146c002)

### CVE-2021-3670 ldap\_server: Remove duplicate print of LDAP search details

```

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14694>

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/7d7f40b7d902e131fbd5e5d49e7670236792af381bcba9b9ff5d35a8c11fe698?s=32&d=identicon)Andrew Bartlett <abartlet@samba.org>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/334366639d15d7dcfaada6b1139d721185667984446656a0b831c5b333b75391?s=32&d=identicon)Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

parent
[1d5b1556](/samba-team/samba/-/commit/1d5b155619bc532c46932965b215bd73a920e56f)

Loading

Loading

Loading

* [Changes
  1](/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002)

[Hide whitespace changes](/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002?action=show&controller=projects%2Fcommit&id=2b3af3b560c9617a233c131376c870fce146c002&namespace_id=samba-team&project_id=samba&w=1)
[Inline](/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002?view=inline)
[Side-by-side](/samba-team/samba/-/commit/2b3af3b560c9617a233c131376c870fce146c002?view=parallel)

Loading

* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [1142f18f](/samba-team/samba/-/commit/1142f18ff1d8e8b66e51fe5a1f591f55ba5f0d13 "CVE-2021-3670 ldap_server: Remove duplicate print of LDAP search details")

  Â·

  [Dec 02, 2021](#note_750376713)

  mentioned in commit [1142f18f](/samba-team/samba/-/commit/1142f18ff1d8e8b66e51fe5a1f591f55ba5f0d13 "CVE-2021-3670 ldap_server: Remove duplicate print of LDAP search details")

  mentioned in commit 1142f18ff1d8e8b66e51fe5a1f591f55ba5f0d13

  Toggle commit list
* [Andrew Bartlett](/abartlet)
  @abartlet

  mentioned in commit [d92dfb0d](/samba-team/samba/-/commit/d92dfb0dabf9cfccb86f2b1146d6c353af2e1435 "CVE-2021-3670 ldap_server: Remove duplicate print of LDAP search details")

  Â·

  [Dec 02, 2021](#note_750412403)

  mentioned in commit [d92dfb0d](/samba-team/samba/-/commit/d92dfb0dabf9cfccb86f2b1146d6c353af2e1435 "CVE-2021-3670 ldap_server: Remove duplicate print of LDAP search details")

  mentioned in commit d92dfb0dabf9cfccb86f2b1146d6c353af2e1435

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


