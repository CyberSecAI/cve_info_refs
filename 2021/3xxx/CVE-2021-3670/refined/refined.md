```
{
  "CVE-2021-3670": {
    "description": "Samba's AD DC does not honor the MaxQueryDuration setting, which could allow a malicious actor to cause a denial of service by issuing long running queries.",
    "root_cause": "The LDAP policy setting 'lDAPAdminLimits: MaxQueryDuration' was not being considered when setting the timeout for LDAP requests. Additionally, no interruption points were set in the filter handling to check if the operation was over-time.",
    "weaknesses": [
      "The MaxQueryDuration setting is not enforced, allowing queries to run indefinitely",
	  "Lack of interruption during filter processing allows long queries to continue without timeout."
    ],
    "impact": "A malicious actor can cause a denial of service by issuing long running LDAP queries which could lock up all LDAP threads. The server will eventually recover after the query is complete or the service is restarted.",
    "attack_vectors": [
      "Sending a specially crafted LDAP query to a Samba AD DC."
    ],
    "required_attacker_capabilities": "An attacker needs to have the ability to send LDAP requests to the Samba server. This could be from a low-privileged account."
  }
}
```